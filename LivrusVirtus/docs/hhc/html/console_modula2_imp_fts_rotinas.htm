<html>
<head>
<title>Livrus Virtus - Console - Modula-2 - Implementação - FTS - Rotinas</title>
</head>
<!-- Generated by ConTEXT HTML exporter -->
<body text="#000000" bgcolor="#FFFFFF">
<pre>
<code><font  face="Courier New"><font color="#0000FF">IMPLEMENTATION MODULE </font>Rotinas<font color="#808080">;

</font><font color="#0000FF">FROM </font>ASCII <font color="#0000FF">IMPORT </font>nul<font color="#808080">, </font>lf<font color="#808080">, </font>cr<font color="#808080">;
</font><font color="#0000FF">FROM </font>NumberConversion <font color="#0000FF">IMPORT </font>StringToCard<font color="#808080">, </font>StringToInt<font color="#808080">, </font>CardToString<font color="#808080">;
</font><font color="#0000FF">FROM </font>RealConversions <font color="#0000FF">IMPORT </font>StringToReal<font color="#808080">;
</font><font color="#0000FF">FROM </font>TimeDate <font color="#0000FF">IMPORT </font>GetTime<font color="#808080">, </font>Time<font color="#808080">;
</font><font color="#0000FF">FROM </font>Strings <font color="#0000FF">IMPORT </font>Length<font color="#808080">, </font>Append<font color="#808080">, </font>Copy<font color="#808080">, </font>CompareStr<font color="#808080">;
</font><font color="#0000FF">FROM </font>Terminal <font color="#0000FF">IMPORT </font>WriteString<font color="#808080">;
</font><font color="#0000FF">FROM </font>InOut <font color="#0000FF">IMPORT </font>Read<font color="#808080">, </font>WriteLn<font color="#808080">;
</font><font color="#0000FF">FROM </font>Keyboard <font color="#0000FF">IMPORT </font>GetKeyCh<font color="#808080">;

(*------------------------------------------------------------------------------
</font>Escreve uma linha na tela com retorno de carro.
sTexto <font color="#808080">- </font>o texto a ser escrito
<font color="#808080">------------------------------------------------------------------------------*)
</font><font color="#0000FF">PROCEDURE </font>WriteLinha<font color="#808080">(</font>sTexto<font color="#808080">: </font><font color="#0000FF">ARRAY OF CHAR</font><font color="#808080">);
</font><font color="#0000FF">BEGIN
</font>WriteString<font color="#808080">(</font>sTexto<font color="#808080">); 
</font>WriteLn<font color="#808080">;
</font><font color="#0000FF">END </font>WriteLinha<font color="#808080">;

(*------------------------------------------------------------------------------
</font>Le uma linha do prompt<font color="#808080">, </font>foi necess<font color="#808080">&aacute;</font>rio para pegar strings com espa<font color="#808080">&ccedil;</font>o em branco.
sTexto <font color="#808080">- </font>o texto a ser lido
<font color="#808080">------------------------------------------------------------------------------*)
</font><font color="#0000FF">PROCEDURE </font>ReadLinha<font color="#808080">(</font><font color="#0000FF">VAR </font>sTexto<font color="#808080">: </font><font color="#0000FF">ARRAY OF CHAR</font><font color="#808080">);
</font><font color="#0000FF">VAR </font>sLetra<font color="#808080">: </font><font color="#0000FF">CHAR</font><font color="#808080">;
    </font>ncont<font color="#808080">: </font><font color="#0000FF">CARDINAL</font><font color="#808080">;
</font><font color="#0000FF">BEGIN
  </font>ncont<font color="#808080">:=</font><font color="#FF0000">0</font><font color="#808080">;
  </font>sLetra<font color="#808080">:=</font>nul<font color="#808080">;
  </font><font color="#0000FF">WHILE </font><font color="#808080">(</font>sLetra<font color="#808080">&lt;&gt;</font>lf<font color="#808080">) </font><font color="#0000FF">DO
    </font>Read<font color="#808080">(</font>sLetra<font color="#808080">);
    </font><font color="#0000FF">IF </font><font color="#808080">(</font>sLetra<font color="#808080">&lt;&gt;</font>lf<font color="#808080">) </font><font color="#0000FF">OR </font><font color="#808080">(</font>sLetra<font color="#808080">&lt;&gt;</font>cr<font color="#808080">) </font><font color="#0000FF">THEN
       </font>sTexto<font color="#808080">[</font>ncont<font color="#808080">]:=</font>sLetra<font color="#808080">;
       </font>ncont<font color="#808080">:=</font>ncont<font color="#808080">+</font><font color="#FF0000">1</font><font color="#808080">;
    </font><font color="#0000FF">END</font><font color="#808080">;
  </font><font color="#0000FF">END</font><font color="#808080">;
  </font>sTexto<font color="#808080">[</font>ncont<font color="#808080">-</font><font color="#FF0000">1</font><font color="#808080">]:=</font>nul<font color="#808080">;
</font><font color="#0000FF">END </font>ReadLinha<font color="#808080">;

(*------------------------------------------------------------------------------
</font>fun<font color="#808080">&ccedil;&atilde;</font>o que concatena strings e retorna o resultado
str1 <font color="#808080">- </font>indica a string1
str2 <font color="#808080">- </font>indica a string2
retorna <font color="#808080">- </font>as strings concatenadas
<font color="#808080">------------------------------------------------------------------------------*)
</font><font color="#0000FF">PROCEDURE </font>Ss<font color="#808080">(</font>str1<font color="#808080">,</font>str2<font color="#808080">:</font><font color="#0000FF">ARRAY OF CHAR</font><font color="#808080">):</font>String<font color="#808080">;
</font><font color="#0000FF">VAR </font>str3<font color="#808080">:</font>String<font color="#808080">;
</font><font color="#0000FF">BEGIN
 </font>str3<font color="#808080">[</font><font color="#FF0000">0</font><font color="#808080">]:=</font>nul<font color="#808080">;
 </font>Append<font color="#808080">(</font>str1<font color="#808080">,</font>str3<font color="#808080">);
 </font>Append<font color="#808080">(</font>str2<font color="#808080">,</font>str3<font color="#808080">);
 </font><font color="#0000FF">RETURN</font><font color="#808080">(</font>str3<font color="#808080">);
</font><font color="#0000FF">END </font>Ss<font color="#808080">;

(*------------------------------------------------------------------------------
</font>Fun<font color="#808080">&ccedil;&atilde;</font>o que soma determinado n<font color="#808080">&uacute;</font>mero de strings.
num <font color="#808080">- </font>indica o n<font color="#808080">&uacute;</font>mero de strings
strs <font color="#808080">- </font>as strings a serem somadas
retorna <font color="#808080">- </font>as strings somadas
<font color="#808080">------------------------------------------------------------------------------*)
</font><font color="#0000FF">PROCEDURE </font>SomaStr<font color="#808080">(</font>num<font color="#808080">: </font><font color="#0000FF">CARDINAL</font><font color="#808080">; </font>strs<font color="#808080">: </font><font color="#0000FF">ARRAY OF </font>String<font color="#808080">): </font>String<font color="#808080">;
</font><font color="#0000FF">VAR </font>str1<font color="#808080">: </font>String<font color="#808080">; 
    </font>cont<font color="#808080">: </font><font color="#0000FF">CARDINAL</font><font color="#808080">;
</font><font color="#0000FF">BEGIN
 </font>str1<font color="#808080">[</font><font color="#FF0000">0</font><font color="#808080">]:=</font>nul<font color="#808080">;
 </font><font color="#0000FF">FOR </font>cont<font color="#808080">:=</font><font color="#FF0000">0 </font><font color="#0000FF">TO </font>num<font color="#808080">-</font><font color="#FF0000">1 </font><font color="#0000FF">DO  
   </font>Append<font color="#808080">(</font>strs<font color="#808080">[</font>cont<font color="#808080">],</font>str1<font color="#808080">);
 </font><font color="#0000FF">END</font><font color="#808080">;  
 </font><font color="#0000FF">RETURN</font><font color="#808080">(</font>str1<font color="#808080">);
</font><font color="#0000FF">END </font>SomaStr<font color="#808080">;

(*------------------------------------------------------------------------------
</font>Fun<font color="#808080">&ccedil;&atilde;</font>o que retorna um peda<font color="#808080">&ccedil;</font>o de uma string.
str <font color="#808080">- </font>indica a string
ini <font color="#808080">- </font>indica a posicao inicial do pedaco
tam <font color="#808080">- </font>indica o tamanho do pedaco
retorna <font color="#808080">- </font>o peda<font color="#808080">&ccedil;</font>o da string
<font color="#808080">------------------------------------------------------------------------------*)
</font><font color="#0000FF">PROCEDURE </font>copy<font color="#808080">(</font>str<font color="#808080">: </font>String<font color="#808080">; </font>ini<font color="#808080">,</font>tam<font color="#808080">: </font><font color="#0000FF">CARDINAL</font><font color="#808080">): </font>String<font color="#808080">;
</font><font color="#0000FF">VAR </font>str1<font color="#808080">: </font>String<font color="#808080">;
</font><font color="#0000FF">BEGIN
</font>ini<font color="#808080">:=</font>ini<font color="#808080">-</font><font color="#FF0000">1</font><font color="#808080">;
</font>Copy<font color="#808080">(</font>str<font color="#808080">,</font>ini<font color="#808080">,</font>tam<font color="#808080">,</font>str1<font color="#808080">);
</font><font color="#0000FF">RETURN </font>str1<font color="#808080">;
</font><font color="#0000FF">END </font>copy<font color="#808080">;

(*------------------------------------------------------------------------------
</font>Retira os espa<font color="#808080">&ccedil;</font>os em branco antes ou depois do texto.
sTexto <font color="#808080">- </font>o texto a ser retirado os espa<font color="#808080">&ccedil;</font>os em branco
retorna <font color="#808080">- </font>o texto sem os espa<font color="#808080">&ccedil;</font>os em branco
<font color="#808080">------------------------------------------------------------------------------*)
</font><font color="#0000FF">PROCEDURE </font>trim<font color="#808080">(</font>sTexto<font color="#808080">: </font>String<font color="#808080">): </font>String<font color="#808080">;
</font><font color="#0000FF">VAR </font>ncont<font color="#808080">, </font>nPosIni<font color="#808080">, </font>nPosFim<font color="#808080">: </font><font color="#0000FF">CARDINAL</font><font color="#808080">;
    </font>sret<font color="#808080">: </font>String<font color="#808080">;
    </font>bQuebra<font color="#808080">: </font><font color="#0000FF">BOOLEAN</font><font color="#808080">;
</font><font color="#0000FF">BEGIN
IF </font>Length<font color="#808080">(</font>sTexto<font color="#808080">) &gt; </font><font color="#FF0000">1 </font><font color="#0000FF">THEN
  </font>nPosIni<font color="#808080">:=</font><font color="#FF0000">0</font><font color="#808080">;
  </font>nPosFim<font color="#808080">:=</font><font color="#FF0000">0</font><font color="#808080">;
  </font>ncont<font color="#808080">:=</font><font color="#FF0000">0</font><font color="#808080">;
  </font>bQuebra<font color="#808080">:=</font>FALSE<font color="#808080">;
  </font><font color="#0000FF">WHILE </font><font color="#808080">(</font>ncont<font color="#808080">&lt;=(</font>Length<font color="#808080">(</font>sTexto<font color="#808080">)-</font><font color="#FF0000">1</font><font color="#808080">)) </font><font color="#0000FF">AND </font><font color="#808080">(</font>bQuebra<font color="#808080">=</font>FALSE<font color="#808080">) </font><font color="#0000FF">DO
    IF </font>sTexto<font color="#808080">[</font>ncont<font color="#808080">]&lt;&gt;</font><font color="#800000">' ' </font><font color="#0000FF">THEN
       </font>nPosIni<font color="#808080">:=</font>ncont<font color="#808080">;
       </font>bQuebra<font color="#808080">:=</font>TRUE<font color="#808080">;
    </font><font color="#0000FF">END</font><font color="#808080">;
    </font>ncont<font color="#808080">:=</font>ncont<font color="#808080">+</font><font color="#FF0000">1</font><font color="#808080">;
  </font><font color="#0000FF">END</font><font color="#808080">;
  </font>ncont<font color="#808080">:=</font>Length<font color="#808080">(</font>sTexto<font color="#808080">)-</font><font color="#FF0000">1</font><font color="#808080">;
  </font>bQuebra<font color="#808080">:=</font>FALSE<font color="#808080">;
  </font><font color="#0000FF">WHILE </font><font color="#808080">(</font>ncont <font color="#808080">&gt; </font><font color="#FF0000">0</font><font color="#808080">) </font><font color="#0000FF">AND </font><font color="#808080">(</font>bQuebra<font color="#808080">=</font>FALSE<font color="#808080">) </font><font color="#0000FF">DO 
    IF </font>sTexto<font color="#808080">[</font>ncont<font color="#808080">]&lt;&gt;</font><font color="#800000">' ' </font><font color="#0000FF">THEN 
       </font>nPosFim<font color="#808080">:=</font>ncont<font color="#808080">;
       </font>bQuebra<font color="#808080">:=</font>TRUE<font color="#808080">;
    </font><font color="#0000FF">END</font><font color="#808080">;  
    </font>ncont<font color="#808080">:=</font>ncont<font color="#808080">-</font><font color="#FF0000">1</font><font color="#808080">;
  </font><font color="#0000FF">END</font><font color="#808080">;
  </font>sret<font color="#808080">:=</font>copy<font color="#808080">(</font>sTexto<font color="#808080">,</font>nPosIni<font color="#808080">+</font><font color="#FF0000">1</font><font color="#808080">,(</font>nPosFim<font color="#808080">-</font>nPosIni<font color="#808080">)+</font><font color="#FF0000">1</font><font color="#808080">);
</font><font color="#0000FF">ELSE
 IF </font>CompareStr<font color="#808080">(</font>sTexto<font color="#808080">,</font><font color="#800000">' '</font><font color="#808080">)=</font>equal <font color="#0000FF">THEN
    </font>sret<font color="#808080">:=</font><font color="#800000">''</font><font color="#808080">;
 </font><font color="#0000FF">ELSE
    </font>sret<font color="#808080">:=</font>sTexto<font color="#808080">;
 </font><font color="#0000FF">END</font><font color="#808080">;
</font><font color="#0000FF">END</font><font color="#808080">;
</font><font color="#0000FF">RETURN </font>sret<font color="#808080">;
</font><font color="#0000FF">END </font>trim<font color="#808080">;

(*------------------------------------------------------------------------------
</font>Repete um texto um n<font color="#808080">&uacute;</font>mero determinado de vezes.
sTexto <font color="#808080">- </font>o texto a ser repetido
nQtd <font color="#808080">- </font>a quantidade de vezes
retorna <font color="#808080">- </font>o texto repetido
<font color="#808080">------------------------------------------------------------------------------*)
</font><font color="#0000FF">PROCEDURE </font>repete<font color="#808080">(</font>sTexto<font color="#808080">: </font>String<font color="#808080">; </font>nQtd<font color="#808080">: </font><font color="#0000FF">INTEGER</font><font color="#808080">): </font>String<font color="#808080">;
</font><font color="#0000FF">VAR </font>ncont<font color="#808080">: </font><font color="#0000FF">INTEGER</font><font color="#808080">;
    </font>sret<font color="#808080">: </font>String<font color="#808080">;
</font><font color="#0000FF">BEGIN
</font>sret<font color="#808080">:=</font><font color="#800000">''</font><font color="#808080">;
</font><font color="#0000FF">FOR </font>ncont<font color="#808080">:=</font><font color="#FF0000">1 </font><font color="#0000FF">TO </font>nQtd <font color="#0000FF">DO 
    </font>Append<font color="#808080">(</font>sTexto<font color="#808080">, </font>sret<font color="#808080">);
</font><font color="#0000FF">END</font><font color="#808080">;
</font><font color="#0000FF">RETURN </font>sret<font color="#808080">;
</font><font color="#0000FF">END </font>repete<font color="#808080">;
(*------------------------------------------------------------------------------
</font>Coloca espa<font color="#808080">&ccedil;</font>os em branco a mais de acordo com o tamanho m<font color="#808080">&aacute;</font>ximo do texto.
sTexto <font color="#808080">- </font>o texto
nTam <font color="#808080">- </font>tamanho m<font color="#808080">&aacute;</font>ximo do texto
retorna <font color="#808080">- </font>o texto com espa<font color="#808080">&ccedil;</font>os em branco a mais
<font color="#808080">------------------------------------------------------------------------------*)
</font><font color="#0000FF">PROCEDURE </font>esp<font color="#808080">(</font>sTexto<font color="#808080">: </font>String<font color="#808080">; </font>nTam<font color="#808080">: </font><font color="#0000FF">CARDINAL</font><font color="#808080">):</font>String<font color="#808080">;
</font><font color="#0000FF">VAR </font>sret<font color="#808080">: </font>String<font color="#808080">;
</font><font color="#0000FF">BEGIN
</font>sret<font color="#808080">:=</font>repete<font color="#808080">(</font><font color="#800000">' '</font><font color="#808080">,</font>nTam<font color="#808080">-</font>Length<font color="#808080">(</font>sTexto<font color="#808080">));
</font>Append<font color="#808080">(</font>sret<font color="#808080">, </font>sTexto<font color="#808080">);
</font><font color="#0000FF">RETURN </font>sTexto<font color="#808080">;
</font><font color="#0000FF">END </font>esp<font color="#808080">;
(*------------------------------------------------------------------------------
</font>Escreve zeros na frente de um texto.
stexto <font color="#808080">- </font>o texto para receber zeros a frente
ntam <font color="#808080">- </font>o tamanho da string
retorna <font color="#808080">- </font>o texto com o zeros antes
<font color="#808080">------------------------------------------------------------------------------*)
</font><font color="#0000FF">PROCEDURE </font>zeros<font color="#808080">(</font>stexto<font color="#808080">:</font>String<font color="#808080">; </font>ntam<font color="#808080">: </font><font color="#0000FF">CARDINAL</font><font color="#808080">): </font>String<font color="#808080">;
</font><font color="#0000FF">VAR </font>saux<font color="#808080">, </font>stemp<font color="#808080">: </font>String<font color="#808080">;
</font><font color="#0000FF">BEGIN  
  </font>saux<font color="#808080">[</font><font color="#FF0000">0</font><font color="#808080">]:=</font>nul<font color="#808080">;
  </font><font color="#0000FF">IF </font>ntam <font color="#808080">&gt; </font>Length<font color="#808080">(</font>stexto<font color="#808080">) </font><font color="#0000FF">THEN
     </font>stemp <font color="#808080">:= </font>repete<font color="#808080">(</font><font color="#800000">'0'</font><font color="#808080">,</font>ntam <font color="#808080">- </font>Length<font color="#808080">(</font>stexto<font color="#808080">));
     </font>Append<font color="#808080">(</font>stemp<font color="#808080">, </font>saux<font color="#808080">);
     </font>Append<font color="#808080">(</font>stexto<font color="#808080">, </font>saux<font color="#808080">);
  </font><font color="#0000FF">ELSE
     </font>saux<font color="#808080">:=</font>stexto<font color="#808080">;
  </font><font color="#0000FF">END</font><font color="#808080">;
  </font><font color="#0000FF">RETURN </font>saux<font color="#808080">;
</font><font color="#0000FF">END </font>zeros<font color="#808080">;
(*------------------------------------------------------------------------------
</font>Faz uma pesquisa relativa de um texto atrav<font color="#808080">&eacute;</font>s de um valor chave.
sTexto <font color="#808080">- </font>o texto
sChave <font color="#808080">- </font>a chave a ser pesquisada
retorna <font color="#808080">- </font>se achou ou n<font color="#808080">&atilde;</font>o a chave dentro do texto
<font color="#808080">------------------------------------------------------------------------------*)
</font><font color="#0000FF">PROCEDURE </font>strRelativa<font color="#808080">(</font>sTexto<font color="#808080">, </font>sChave<font color="#808080">: </font>String<font color="#808080">):</font><font color="#0000FF">BOOLEAN</font><font color="#808080">;
</font><font color="#0000FF">VAR </font>nCont<font color="#808080">, </font>nTamChave<font color="#808080">, </font>nTamTexto<font color="#808080">: </font><font color="#0000FF">INTEGER</font><font color="#808080">;
    </font>bret<font color="#808080">: </font><font color="#0000FF">BOOLEAN</font><font color="#808080">;
    </font>sPedaco<font color="#808080">: </font>String<font color="#808080">;
</font><font color="#0000FF">BEGIN
</font>bret<font color="#808080">:=</font>FALSE<font color="#808080">;
</font>nCont<font color="#808080">:=</font><font color="#FF0000">1</font><font color="#808080">;
</font>nTamChave<font color="#808080">:=</font>Length<font color="#808080">(</font>sChave<font color="#808080">);
</font>nTamTexto<font color="#808080">:=</font>Length<font color="#808080">(</font>sTexto<font color="#808080">);
</font><font color="#0000FF">IF </font>nTamChave <font color="#808080">&lt;= </font>nTamTexto <font color="#0000FF">THEN 
  WHILE </font>nCont <font color="#808080">&lt;= (</font>nTamTexto<font color="#808080">-</font>nTamChave<font color="#808080">+</font><font color="#FF0000">1</font><font color="#808080">) </font><font color="#0000FF">DO 
     </font>sPedaco<font color="#808080">:=</font>copy<font color="#808080">(</font>sTexto<font color="#808080">,</font>nCont<font color="#808080">,</font>nTamChave<font color="#808080">);
     </font><font color="#0000FF">IF </font>CompareStr<font color="#808080">(</font>sPedaco<font color="#808080">,</font>sChave<font color="#808080">)=</font>equal <font color="#0000FF">THEN
        </font>bret<font color="#808080">:=</font>TRUE<font color="#808080">;
     </font><font color="#0000FF">END</font><font color="#808080">;
     </font>nCont<font color="#808080">:=</font>nCont<font color="#808080">+</font><font color="#FF0000">1</font><font color="#808080">;
  </font><font color="#0000FF">END</font><font color="#808080">;
</font><font color="#0000FF">END</font><font color="#808080">;
</font><font color="#0000FF">RETURN </font>bret<font color="#808080">;
</font><font color="#0000FF">END </font>strRelativa<font color="#808080">;
(*------------------------------------------------------------------------------
</font>Calcula o modulo11 de um valor qualquer.
svalor <font color="#808080">- </font>a String com o n<font color="#808080">&uacute;</font>mero a ser calculado
ndig <font color="#808080">- </font>d<font color="#808080">&iacute;</font>gito do valor a ser calculado
retorna <font color="#808080">- </font>o d<font color="#808080">&iacute;</font>gito correto
<font color="#808080">------------------------------------------------------------------------------*)
</font><font color="#0000FF">PROCEDURE </font>modulo11<font color="#808080">(</font>svalor<font color="#808080">: </font>String<font color="#808080">; </font>ndig<font color="#808080">: </font><font color="#0000FF">INTEGER</font><font color="#808080">): </font><font color="#0000FF">INTEGER</font><font color="#808080">;
</font><font color="#0000FF">VAR </font>nsoma<font color="#808080">, </font>nvalor<font color="#808080">, </font>npos<font color="#808080">: </font><font color="#0000FF">INTEGER</font><font color="#808080">;
    </font>ncont<font color="#808080">: </font><font color="#0000FF">CARDINAL</font><font color="#808080">; 
    </font>sres<font color="#808080">, </font>slocal<font color="#808080">: </font>String<font color="#808080">;
    </font>nStatus<font color="#808080">: </font><font color="#0000FF">BOOLEAN</font><font color="#808080">;
</font><font color="#0000FF">BEGIN
 </font>ncont<font color="#808080">:=</font><font color="#FF0000">1</font><font color="#808080">;
 </font><font color="#0000FF">WHILE </font>ncont <font color="#808080">&lt;= </font><font color="#FF0000">11 </font><font color="#0000FF">DO
   </font>slocal<font color="#808080">:=</font>Ss<font color="#808080">(</font>copy<font color="#808080">(</font>svalor<font color="#808080">,</font>ncont<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">), </font>slocal<font color="#808080">);
   </font>ncont<font color="#808080">:=</font>ncont<font color="#808080">+</font><font color="#FF0000">1</font><font color="#808080">;
 </font><font color="#0000FF">END</font><font color="#808080">;
 </font>nsoma<font color="#808080">:=</font><font color="#FF0000">0</font><font color="#808080">;
 </font><font color="#0000FF">IF </font>ndig<font color="#808080">=</font><font color="#FF0000">1 </font><font color="#0000FF">THEN
   </font>ncont<font color="#808080">:=</font><font color="#FF0000">3
 </font><font color="#0000FF">ELSE
   </font>ncont<font color="#808080">:=</font><font color="#FF0000">2</font><font color="#808080">;
 </font><font color="#0000FF">END</font><font color="#808080">;
 </font>npos<font color="#808080">:=</font><font color="#FF0000">2</font><font color="#808080">;
 </font><font color="#0000FF">WHILE </font>ncont <font color="#808080">&lt;= </font><font color="#FF0000">11 </font><font color="#0000FF">DO
   </font>sres<font color="#808080">:=</font>copy<font color="#808080">(</font>slocal<font color="#808080">,</font>ncont<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">);
   </font>StringToInt<font color="#808080">(</font>sres<font color="#808080">, </font>nvalor<font color="#808080">, </font>nStatus<font color="#808080">);
   </font>nsoma<font color="#808080">:=</font>nsoma <font color="#808080">+ (</font>nvalor <font color="#808080">* </font>npos<font color="#808080">);
   </font>ncont<font color="#808080">:=</font>ncont<font color="#808080">+</font><font color="#FF0000">1</font><font color="#808080">;
   </font>npos<font color="#808080">:=</font>npos<font color="#808080">+</font><font color="#FF0000">1</font><font color="#808080">;
 </font><font color="#0000FF">END</font><font color="#808080">;
 </font>nsoma<font color="#808080">:=(</font><font color="#FF0000">11 </font><font color="#808080">- (</font>nsoma <font color="#0000FF">MOD </font><font color="#FF0000">11</font><font color="#808080">));

 </font><font color="#0000FF">IF </font>nsoma <font color="#808080">&gt; </font><font color="#FF0000">9 </font><font color="#0000FF">THEN
   RETURN </font><font color="#FF0000">0
 </font><font color="#0000FF">ELSE
   RETURN </font>nsoma<font color="#808080">;
 </font><font color="#0000FF">END</font><font color="#808080">;
</font><font color="#0000FF">END </font>modulo11<font color="#808080">;
(*------------------------------------------------------------------------------
</font>Valida<font color="#808080">&ccedil;&atilde;</font>o de um n<font color="#808080">&uacute;</font>mero de CPF qualquer.
cpf <font color="#808080">- </font>a String com o n<font color="#808080">&uacute;</font>mero do CPF
retorna <font color="#808080">- </font>se <font color="#808080">&eacute; </font>valido ou n<font color="#808080">&atilde;</font>o
<font color="#808080">------------------------------------------------------------------------------*)
</font><font color="#0000FF">PROCEDURE </font>validaCPF<font color="#808080">(</font>cpf<font color="#808080">: </font>String<font color="#808080">): </font><font color="#0000FF">BOOLEAN</font><font color="#808080">;
</font><font color="#0000FF">VAR </font>scpf<font color="#808080">, </font>sres<font color="#808080">: </font>String<font color="#808080">;
    </font>nvalor1<font color="#808080">, </font>nvalor2<font color="#808080">: </font><font color="#0000FF">INTEGER</font><font color="#808080">;
    </font>nStatus<font color="#808080">: </font><font color="#0000FF">BOOLEAN</font><font color="#808080">;
</font><font color="#0000FF">BEGIN
IF </font><font color="#808080">(</font>Length<font color="#808080">(</font>cpf<font color="#808080">)=</font><font color="#FF0000">14</font><font color="#808080">) </font><font color="#0000FF">THEN   
  </font>scpf<font color="#808080">:=</font>Ss<font color="#808080">(</font>Ss<font color="#808080">(</font>Ss<font color="#808080">(</font>copy<font color="#808080">(</font>cpf<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#FF0000">3</font><font color="#808080">),</font>copy<font color="#808080">(</font>cpf<font color="#808080">,</font><font color="#FF0000">5</font><font color="#808080">,</font><font color="#FF0000">3</font><font color="#808080">)),</font>copy<font color="#808080">(</font>cpf<font color="#808080">,</font><font color="#FF0000">9</font><font color="#808080">,</font><font color="#FF0000">3</font><font color="#808080">)),</font>copy<font color="#808080">(</font>cpf<font color="#808080">,</font><font color="#FF0000">13</font><font color="#808080">,</font><font color="#FF0000">2</font><font color="#808080">));
  </font>sres<font color="#808080">:=</font>copy<font color="#808080">(</font>cpf<font color="#808080">,</font><font color="#FF0000">13</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">);
  </font>StringToInt<font color="#808080">(</font>sres<font color="#808080">, </font>nvalor1<font color="#808080">, </font>nStatus<font color="#808080">);
  </font>sres<font color="#808080">:=</font>copy<font color="#808080">(</font>cpf<font color="#808080">,</font><font color="#FF0000">14</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">);
  </font>StringToInt<font color="#808080">(</font>sres<font color="#808080">, </font>nvalor2<font color="#808080">, </font>nStatus<font color="#808080">);
  </font><font color="#0000FF">IF </font><font color="#808080">((</font>modulo11<font color="#808080">(</font>scpf<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">)=</font>nvalor1<font color="#808080">) </font><font color="#0000FF">AND </font><font color="#808080">(</font>modulo11<font color="#808080">(</font>scpf<font color="#808080">,</font><font color="#FF0000">2</font><font color="#808080">)=</font>nvalor2<font color="#808080">)) </font><font color="#0000FF">THEN
    RETURN </font>TRUE<font color="#808080">;
  </font><font color="#0000FF">ELSE
    RETURN </font>FALSE<font color="#808080">;
  </font><font color="#0000FF">END</font><font color="#808080">;
</font><font color="#0000FF">ELSE
  RETURN </font>FALSE<font color="#808080">;
</font><font color="#0000FF">END</font><font color="#808080">;
</font><font color="#0000FF">END </font>validaCPF<font color="#808080">;
(*------------------------------------------------------------------------------
</font>Valida<font color="#808080">&ccedil;&atilde;</font>o de um n<font color="#808080">&uacute;</font>mero ISBN qualquer.
isbn <font color="#808080">- </font>a String com o n<font color="#808080">&uacute;</font>mero do ISBN
retorna <font color="#808080">- </font>se <font color="#808080">&eacute; </font>valido ou n<font color="#808080">&atilde;</font>o
<font color="#808080">------------------------------------------------------------------------------*)
</font><font color="#0000FF">PROCEDURE </font>validaISBN<font color="#808080">(</font>isbn<font color="#808080">: </font>String<font color="#808080">): </font><font color="#0000FF">BOOLEAN</font><font color="#808080">;
</font><font color="#0000FF">VAR </font>sisbn<font color="#808080">, </font>snum<font color="#808080">, </font>sdigito<font color="#808080">, </font>stemp<font color="#808080">: </font>String<font color="#808080">;
    </font>ncont<font color="#808080">, </font>nvalor<font color="#808080">, </font>nsoma<font color="#808080">: </font><font color="#0000FF">CARDINAL</font><font color="#808080">;
    </font>nStatus<font color="#808080">: </font><font color="#0000FF">BOOLEAN</font><font color="#808080">;
</font><font color="#0000FF">BEGIN
IF </font><font color="#808080">(</font>Length<font color="#808080">(</font>isbn<font color="#808080">)=</font><font color="#FF0000">13</font><font color="#808080">) </font><font color="#0000FF">THEN
  </font>sdigito <font color="#808080">:= </font>copy<font color="#808080">(</font>isbn<font color="#808080">, </font>Length<font color="#808080">(</font>isbn<font color="#808080">), </font><font color="#FF0000">1</font><font color="#808080">);
  </font>sisbn<font color="#808080">:=</font><font color="#800000">''</font><font color="#808080">;
  </font><font color="#0000FF">FOR </font>ncont<font color="#808080">:=</font><font color="#FF0000">1 </font><font color="#0000FF">TO </font>Length<font color="#808080">(</font>isbn<font color="#808080">)-</font><font color="#FF0000">1 </font><font color="#0000FF">DO
    IF </font><font color="#808080">(</font>CompareStr<font color="#808080">(</font>copy<font color="#808080">(</font>isbn<font color="#808080">,</font>ncont<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">),</font><font color="#800000">'-'</font><font color="#808080">)&lt;&gt;</font>equal<font color="#808080">) </font><font color="#0000FF">THEN
      </font>stemp <font color="#808080">:= </font>copy<font color="#808080">(</font>isbn<font color="#808080">,</font>ncont<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">);
      </font>Append<font color="#808080">(</font>stemp<font color="#808080">, </font>sisbn<font color="#808080">);
    </font><font color="#0000FF">END</font><font color="#808080">;
  </font><font color="#0000FF">END</font><font color="#808080">;
  </font><font color="#0000FF">IF </font>CompareStr<font color="#808080">(</font>sdigito<font color="#808080">, </font><font color="#800000">'X'</font><font color="#808080">)=</font>equal <font color="#0000FF">THEN
    </font>nsoma <font color="#808080">:= </font><font color="#FF0000">10
  </font><font color="#0000FF">ELSE
    </font>StringToCard<font color="#808080">(</font>sdigito<font color="#808080">, </font>nvalor<font color="#808080">, </font>nStatus<font color="#808080">);
    </font>nsoma <font color="#808080">:= </font>nvalor<font color="#808080">;
  </font><font color="#0000FF">END</font><font color="#808080">;
  </font><font color="#0000FF">FOR </font>ncont<font color="#808080">:=</font><font color="#FF0000">1 </font><font color="#0000FF">TO </font><font color="#FF0000">9 </font><font color="#0000FF">DO
    </font>snum<font color="#808080">:=</font>copy<font color="#808080">(</font>sisbn<font color="#808080">, </font>ncont<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">);
    </font>StringToCard<font color="#808080">(</font>snum<font color="#808080">, </font>nvalor<font color="#808080">, </font>nStatus<font color="#808080">);
    </font>nsoma<font color="#808080">:=</font>nsoma <font color="#808080">+ (</font>nvalor <font color="#808080">* (</font><font color="#FF0000">11 </font><font color="#808080">- </font>ncont<font color="#808080">));
  </font><font color="#0000FF">END</font><font color="#808080">;
  </font><font color="#0000FF">IF </font><font color="#808080">(</font>nsoma <font color="#0000FF">MOD </font><font color="#FF0000">11</font><font color="#808080">) = </font><font color="#FF0000">0 </font><font color="#0000FF">THEN
    RETURN </font>TRUE<font color="#808080">;
  </font><font color="#0000FF">ELSE
    RETURN </font>FALSE<font color="#808080">;
  </font><font color="#0000FF">END</font><font color="#808080">;
</font><font color="#0000FF">ELSE
  RETURN </font>FALSE<font color="#808080">;
</font><font color="#0000FF">END</font><font color="#808080">;
</font><font color="#0000FF">END </font>validaISBN<font color="#808080">;
(*------------------------------------------------------------------------------
</font>Esconde a digita<font color="#808080">&ccedil;&atilde;</font>o da senha
retorna <font color="#808080">- </font>a senha digitada
<font color="#808080">------------------------------------------------------------------------------*)
</font><font color="#0000FF">PROCEDURE </font>digitaSenha<font color="#808080">(</font>sRotulo<font color="#808080">: </font>String<font color="#808080">; </font>nTamSenha<font color="#808080">: </font><font color="#0000FF">INTEGER</font><font color="#808080">): </font>String<font color="#808080">;
</font><font color="#0000FF">VAR </font>sSenha<font color="#808080">: </font>String<font color="#808080">;
    </font>sLetra<font color="#808080">: </font><font color="#0000FF">CHAR</font><font color="#808080">;
    </font>ncont<font color="#808080">: </font><font color="#0000FF">INTEGER</font><font color="#808080">;
</font><font color="#0000FF">BEGIN
  </font>WriteString<font color="#808080">(</font>sRotulo<font color="#808080">);
  </font>ncont <font color="#808080">:= </font><font color="#FF0000">0</font><font color="#808080">;
  </font>sSenha<font color="#808080">:=</font><font color="#800000">''</font><font color="#808080">;
  </font>sLetra<font color="#808080">:=</font>nul<font color="#808080">;
  </font><font color="#0000FF">WHILE </font><font color="#808080">((</font>sLetra<font color="#808080">&lt;&gt;</font>lf<font color="#808080">) </font><font color="#0000FF">AND </font><font color="#808080">(</font>ncont <font color="#808080">&lt; </font>nTamSenha<font color="#808080">)) </font><font color="#0000FF">DO 
    </font>GetKeyCh<font color="#808080">(</font>sLetra<font color="#808080">);
    </font><font color="#0000FF">IF </font>sLetra<font color="#808080">&lt;&gt;</font>lf <font color="#0000FF">THEN
       </font>sSenha<font color="#808080">[</font>ncont<font color="#808080">]:=</font>sLetra<font color="#808080">;
    </font><font color="#0000FF">END</font><font color="#808080">;
    </font>ncont<font color="#808080">:=</font>ncont<font color="#808080">+</font><font color="#FF0000">1</font><font color="#808080">;
  </font><font color="#0000FF">END</font><font color="#808080">;
  </font>sSenha<font color="#808080">[</font>ncont<font color="#808080">-</font><font color="#FF0000">1</font><font color="#808080">]:=</font>nul<font color="#808080">;
  </font>WriteLn<font color="#808080">;
  </font><font color="#0000FF">RETURN </font>sSenha<font color="#808080">;
</font><font color="#0000FF">END </font>digitaSenha<font color="#808080">;
(*------------------------------------------------------------------------------
</font>Valida<font color="#808080">&ccedil;&atilde;</font>o de um n<font color="#808080">&uacute;</font>mero qualquer.
sRotulo <font color="#808080">- </font>o texto antes de se digitar o n<font color="#808080">&uacute;</font>mero
sNumero <font color="#808080">- </font>a String com o valor do n<font color="#808080">&uacute;</font>mero
retorna <font color="#808080">- </font>o sNumero
<font color="#808080">------------------------------------------------------------------------------*)
</font><font color="#0000FF">PROCEDURE </font>validaNumero<font color="#808080">(</font>sRotulo<font color="#808080">, </font>sNumero<font color="#808080">: </font>String<font color="#808080">): </font>String<font color="#808080">;
</font><font color="#0000FF">VAR </font>nnum<font color="#808080">: </font><font color="#0000FF">REAL</font><font color="#808080">;
    </font>nStatus<font color="#808080">, </font>bQuebra<font color="#808080">: </font><font color="#0000FF">BOOLEAN</font><font color="#808080">;
</font><font color="#0000FF">BEGIN
</font>bQuebra<font color="#808080">:=</font>FALSE<font color="#808080">;
</font><font color="#0000FF">WHILE </font><font color="#808080">(</font>bQuebra<font color="#808080">=</font>FALSE<font color="#808080">) </font><font color="#0000FF">DO 
  </font>WriteString<font color="#808080">(</font>sRotulo<font color="#808080">);
  </font>ReadLinha<font color="#808080">(</font>sNumero<font color="#808080">);
  </font>StringToReal<font color="#808080">(</font>sNumero<font color="#808080">,</font>nnum<font color="#808080">,</font>nStatus<font color="#808080">);
  </font><font color="#0000FF">IF </font>nStatus <font color="#0000FF">THEN
    IF </font><font color="#808080">(</font>nnum <font color="#808080">&lt; </font><font color="#FF0000">0</font>.01<font color="#808080">) </font><font color="#0000FF">THEN
       </font>WriteLinha<font color="#808080">(</font>MSG_NUMINV<font color="#808080">);
    </font><font color="#0000FF">ELSE
       </font>bQuebra<font color="#808080">:=</font>TRUE<font color="#808080">;
    </font><font color="#0000FF">END</font><font color="#808080">;
  </font><font color="#0000FF">ELSE
    </font>WriteLinha<font color="#808080">(</font>MSG_NUMINV<font color="#808080">);
  </font><font color="#0000FF">END</font><font color="#808080">;
</font><font color="#0000FF">END</font><font color="#808080">;
</font><font color="#0000FF">RETURN </font>sNumero<font color="#808080">;
</font><font color="#0000FF">END </font>validaNumero<font color="#808080">;
(*------------------------------------------------------------------------------
</font>Valida<font color="#808080">&ccedil;&atilde;</font>o de uma data ou data<font color="#808080">/</font>hora qualquer.
sRotulo <font color="#808080">- </font>o texto antes de se digitar a data<font color="#808080">/</font>hora
sDataHora <font color="#808080">- </font>a String com o valor da data<font color="#808080">/</font>hora
bSoData <font color="#808080">- </font>indica se vai validar somente uma data sem a hora
retorna <font color="#808080">- </font>a sDataHora
<font color="#808080">------------------------------------------------------------------------------*)
</font><font color="#0000FF">PROCEDURE </font>validaDataHora<font color="#808080">(</font>sRotulo<font color="#808080">, </font>sDataHora<font color="#808080">: </font>String<font color="#808080">; </font>bSoData<font color="#808080">: </font><font color="#0000FF">BOOLEAN</font><font color="#808080">): </font>String<font color="#808080">;
</font><font color="#0000FF">VAR </font>bvalida<font color="#808080">, </font>bdatavalida<font color="#808080">, </font>bhoravalida<font color="#808080">: </font><font color="#0000FF">BOOLEAN</font><font color="#808080">;
    </font>sdia<font color="#808080">, </font>smes<font color="#808080">, </font>sano<font color="#808080">, </font>shora<font color="#808080">, </font>smin<font color="#808080">, </font>sseg<font color="#808080">: </font>String<font color="#808080">;
    </font>ndia<font color="#808080">, </font>nmes<font color="#808080">, </font>nano<font color="#808080">, </font>nhora<font color="#808080">, </font>nmin<font color="#808080">, </font>nseg<font color="#808080">, </font>nudiames<font color="#808080">: </font><font color="#0000FF">INTEGER</font><font color="#808080">;
    </font>ntam<font color="#808080">: </font><font color="#0000FF">CARDINAL</font><font color="#808080">;
    </font>nStatus<font color="#808080">: </font><font color="#0000FF">BOOLEAN</font><font color="#808080">;
</font><font color="#0000FF">BEGIN
</font>bvalida<font color="#808080">:=</font>FALSE<font color="#808080">;
</font>bdatavalida<font color="#808080">:=</font>FALSE<font color="#808080">;
</font>bhoravalida<font color="#808080">:=</font>FALSE<font color="#808080">;
</font>nudiames<font color="#808080">:=</font><font color="#FF0000">0</font><font color="#808080">;

</font><font color="#0000FF">IF </font>bSoData<font color="#808080">=</font>TRUE <font color="#0000FF">THEN </font>ntam<font color="#808080">:=</font><font color="#FF0000">10</font><font color="#808080">;
</font><font color="#0000FF">ELSE </font>ntam<font color="#808080">:=</font><font color="#FF0000">19</font><font color="#808080">;
</font><font color="#0000FF">END</font><font color="#808080">;
</font><font color="#0000FF">WHILE </font><font color="#808080">(</font>bvalida<font color="#808080">=</font>FALSE<font color="#808080">) </font><font color="#0000FF">DO 
  </font>WriteString<font color="#808080">(</font>sRotulo<font color="#808080">);
  </font>ReadLinha<font color="#808080">(</font>sDataHora<font color="#808080">);
  </font><font color="#0000FF">IF </font>Length<font color="#808080">(</font>sDataHora<font color="#808080">)=</font>ntam <font color="#0000FF">THEN 
    </font>sdia<font color="#808080">:=</font>copy<font color="#808080">(</font>sDataHora<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#FF0000">2</font><font color="#808080">);
    </font>StringToInt<font color="#808080">(</font>sdia<font color="#808080">, </font>ndia<font color="#808080">, </font>nStatus<font color="#808080">);
    </font>smes<font color="#808080">:=</font>copy<font color="#808080">(</font>sDataHora<font color="#808080">,</font><font color="#FF0000">4</font><font color="#808080">,</font><font color="#FF0000">2</font><font color="#808080">);
    </font>StringToInt<font color="#808080">(</font>smes<font color="#808080">, </font>nmes<font color="#808080">, </font>nStatus<font color="#808080">);
    </font>sano<font color="#808080">:=</font>copy<font color="#808080">(</font>sDataHora<font color="#808080">,</font><font color="#FF0000">7</font><font color="#808080">,</font><font color="#FF0000">4</font><font color="#808080">);
    </font>StringToInt<font color="#808080">(</font>sano<font color="#808080">, </font>nano<font color="#808080">, </font>nStatus<font color="#808080">);
  
    </font><font color="#0000FF">IF </font><font color="#808080">(</font>nano <font color="#808080">&gt;= </font><font color="#FF0000">1</font><font color="#808080">) </font><font color="#0000FF">AND </font><font color="#808080">(</font>nano <font color="#808080">&lt;= </font><font color="#FF0000">9999</font><font color="#808080">) </font><font color="#0000FF">THEN 
      IF </font><font color="#808080">(</font>nmes <font color="#808080">&gt;= </font><font color="#FF0000">1</font><font color="#808080">) </font><font color="#0000FF">AND </font><font color="#808080">(</font>nmes <font color="#808080">&lt;= </font><font color="#FF0000">31</font><font color="#808080">) </font><font color="#0000FF">THEN 
          CASE </font>nmes <font color="#0000FF">OF
          </font><font color="#808080">| </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">, </font><font color="#FF0000">5</font><font color="#808080">, </font><font color="#FF0000">7</font><font color="#808080">, </font><font color="#FF0000">8</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">, </font><font color="#FF0000">12</font><font color="#808080">: </font>nudiames<font color="#808080">:=</font><font color="#FF0000">31</font><font color="#808080">;
          | </font><font color="#FF0000">2</font><font color="#808080">: (* ano bissexto *)
               </font><font color="#0000FF">IF </font><font color="#808080">(</font>nano <font color="#0000FF">MOD </font><font color="#FF0000">4</font><font color="#808080">)=</font><font color="#FF0000">0 </font><font color="#0000FF">THEN </font>nudiames<font color="#808080">:=</font><font color="#FF0000">29</font><font color="#808080">;
               </font><font color="#0000FF">ELSE </font>nudiames<font color="#808080">:=</font><font color="#FF0000">28</font><font color="#808080">;
               </font><font color="#0000FF">END</font><font color="#808080">;
          | </font><font color="#FF0000">4</font><font color="#808080">, </font><font color="#FF0000">6</font><font color="#808080">, </font><font color="#FF0000">9</font><font color="#808080">, </font><font color="#FF0000">11</font><font color="#808080">: </font>nudiames<font color="#808080">:=</font><font color="#FF0000">30</font><font color="#808080">;
          </font><font color="#0000FF">END</font><font color="#808080">;
          </font><font color="#0000FF">IF </font><font color="#808080">(</font>ndia <font color="#808080">&gt;=</font><font color="#FF0000">1</font><font color="#808080">) </font><font color="#0000FF">AND </font><font color="#808080">(</font>ndia <font color="#808080">&lt;=</font>nudiames<font color="#808080">) </font><font color="#0000FF">THEN
             </font>bdatavalida<font color="#808080">:=</font>TRUE<font color="#808080">;
          </font><font color="#0000FF">END</font><font color="#808080">;
      </font><font color="#0000FF">END</font><font color="#808080">;
    </font><font color="#0000FF">END</font><font color="#808080">;
  
    </font><font color="#0000FF">IF </font>bSoData <font color="#0000FF">THEN 
       IF </font>bdatavalida <font color="#0000FF">THEN </font>bvalida<font color="#808080">:=</font>TRUE<font color="#808080">;
       </font><font color="#0000FF">ELSE </font>WriteLinha<font color="#808080">(</font>MSG_DATAINV<font color="#808080">);
       </font><font color="#0000FF">END</font><font color="#808080">;
    </font><font color="#0000FF">ELSE 
      IF </font>bdatavalida <font color="#0000FF">THEN 
          </font>shora<font color="#808080">:=</font>copy<font color="#808080">(</font>sDataHora<font color="#808080">,</font><font color="#FF0000">12</font><font color="#808080">,</font><font color="#FF0000">2</font><font color="#808080">);
          </font>StringToInt<font color="#808080">(</font>shora<font color="#808080">, </font>nhora<font color="#808080">, </font>nStatus<font color="#808080">);
          </font>smin<font color="#808080">:=</font>copy<font color="#808080">(</font>sDataHora<font color="#808080">,</font><font color="#FF0000">15</font><font color="#808080">,</font><font color="#FF0000">2</font><font color="#808080">);
          </font>StringToInt<font color="#808080">(</font>smin<font color="#808080">, </font>nmin<font color="#808080">, </font>nStatus<font color="#808080">);
          </font>sseg<font color="#808080">:=</font>copy<font color="#808080">(</font>sDataHora<font color="#808080">,</font><font color="#FF0000">18</font><font color="#808080">,</font><font color="#FF0000">2</font><font color="#808080">);
          </font>StringToInt<font color="#808080">(</font>sseg<font color="#808080">, </font>nseg<font color="#808080">, </font>nStatus<font color="#808080">);
  
          </font><font color="#0000FF">IF </font><font color="#808080">(</font>nhora <font color="#808080">&gt;= </font><font color="#FF0000">0</font><font color="#808080">) </font><font color="#0000FF">AND </font><font color="#808080">(</font>nhora <font color="#808080">&lt;= </font><font color="#FF0000">23</font><font color="#808080">) </font><font color="#0000FF">THEN 
            IF </font><font color="#808080">(</font>nmin <font color="#808080">&gt;= </font><font color="#FF0000">0</font><font color="#808080">) </font><font color="#0000FF">AND </font><font color="#808080">(</font>nmin <font color="#808080">&lt;= </font><font color="#FF0000">59</font><font color="#808080">) </font><font color="#0000FF">THEN 
              IF </font><font color="#808080">(</font>nseg <font color="#808080">&gt;= </font><font color="#FF0000">0</font><font color="#808080">) </font><font color="#0000FF">AND </font><font color="#808080">(</font>nseg <font color="#808080">&lt;= </font><font color="#FF0000">59</font><font color="#808080">) </font><font color="#0000FF">THEN
                 </font>bhoravalida<font color="#808080">:=</font>TRUE<font color="#808080">;
              </font><font color="#0000FF">END</font><font color="#808080">;
            </font><font color="#0000FF">END</font><font color="#808080">;
          </font><font color="#0000FF">END</font><font color="#808080">;
  
          </font><font color="#0000FF">IF </font>bhoravalida <font color="#0000FF">THEN </font>bvalida<font color="#808080">:=</font>TRUE<font color="#808080">;
          </font><font color="#0000FF">ELSE </font>WriteLinha<font color="#808080">(</font>MSG_DTHRINV<font color="#808080">);
          </font><font color="#0000FF">END</font><font color="#808080">;
      </font><font color="#0000FF">ELSE
        </font>WriteLinha<font color="#808080">(</font>MSG_DTHRINV<font color="#808080">);
      </font><font color="#0000FF">END</font><font color="#808080">;
    </font><font color="#0000FF">END</font><font color="#808080">;
  </font><font color="#0000FF">ELSE 
    IF </font>bSoData<font color="#808080">=</font>TRUE <font color="#0000FF">THEN </font>WriteLinha<font color="#808080">(</font>MSG_DATAINV<font color="#808080">);
    </font><font color="#0000FF">ELSE </font>WriteLinha<font color="#808080">(</font>MSG_DTHRINV<font color="#808080">);
    </font><font color="#0000FF">END</font><font color="#808080">; 
  </font><font color="#0000FF">END</font><font color="#808080">;
</font><font color="#0000FF">END</font><font color="#808080">;
</font><font color="#0000FF">RETURN </font>sDataHora<font color="#808080">;
</font><font color="#0000FF">END </font>validaDataHora<font color="#808080">;
(*------------------------------------------------------------------------------
</font>Retorna a Data e a hora do sistema.
retorna <font color="#808080">- </font>a data e a hora
<font color="#808080">------------------------------------------------------------------------------*)
</font><font color="#0000FF">PROCEDURE </font>retDataHora<font color="#808080">(): </font>String<font color="#808080">;
</font><font color="#0000FF">VAR </font>datahora<font color="#808080">: </font>Time<font color="#808080">;
    </font>dia<font color="#808080">,</font>mes<font color="#808080">,</font>ano<font color="#808080">,</font>hora<font color="#808080">,</font>min<font color="#808080">,</font>seg<font color="#808080">,</font>strdh<font color="#808080">: </font>String<font color="#808080">;
</font><font color="#0000FF">BEGIN
  </font>GetTime<font color="#808080">(</font>datahora<font color="#808080">);

  </font>CardToString<font color="#808080">(</font>datahora.day<font color="#808080">, </font>dia<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">);
  </font>CardToString<font color="#808080">(</font>datahora.minute<font color="#808080">, </font>min<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">);
  </font>CardToString<font color="#808080">(</font>datahora.millisec<font color="#808080">, </font>seg<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">);

  </font>stemp<font color="#808080">[</font><font color="#FF0000">0</font><font color="#808080">]:=</font>zeros<font color="#808080">(</font>trim<font color="#808080">(</font>dia<font color="#808080">),</font><font color="#FF0000">2</font><font color="#808080">);
  </font>stemp<font color="#808080">[</font><font color="#FF0000">1</font><font color="#808080">]:=</font><font color="#800000">'/'</font><font color="#808080">;
(*  </font>stemp<font color="#808080">[</font><font color="#FF0000">2</font><font color="#808080">]:=</font>zeros<font color="#808080">(</font>trim<font color="#808080">(</font>mes<font color="#808080">),</font><font color="#FF0000">2</font><font color="#808080">);
  </font>stemp<font color="#808080">[</font><font color="#FF0000">3</font><font color="#808080">]:=</font><font color="#800000">'/'</font><font color="#808080">;
  </font>stemp<font color="#808080">[</font><font color="#FF0000">4</font><font color="#808080">]:=</font>zeros<font color="#808080">(</font>trim<font color="#808080">(</font>ano<font color="#808080">),</font><font color="#FF0000">4</font><font color="#808080">);
  </font>stemp<font color="#808080">[</font><font color="#FF0000">5</font><font color="#808080">]:=</font><font color="#800000">' '</font><font color="#808080">;
  </font>stemp<font color="#808080">[</font><font color="#FF0000">6</font><font color="#808080">]:=</font>zeros<font color="#808080">(</font>trim<font color="#808080">(</font>hora<font color="#808080">),</font><font color="#FF0000">2</font><font color="#808080">);*)

  </font><font color="#0000FF">RETURN </font>SomaStr<font color="#808080">(</font><font color="#FF0000">2</font><font color="#808080">, </font>stemp<font color="#808080">);
</font><font color="#0000FF">END </font>retDataHora<font color="#808080">;

</font><font color="#0000FF">END </font>Rotinas.

</font>
</code></pre>
</body>
</html>