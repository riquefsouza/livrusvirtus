<html>
<head>
<title>Livrus Virtus - Console - Clipper</title>
</head>
<!-- Generated by ConTEXT HTML exporter -->
<body text="#000000" bgcolor="#FFFFFF">
<pre>
<code><font  face="Courier New"><font color="#808080"><i>/*------------------------------------------------------------------------------
 Sistema integrante do projeto Livrus Virtus.
 Todos os direitos reservados para Henrique F. de Souza.
 Vers&atilde;o programada na linguagem clipper.
------------------------------------------------------------------------------*/
/* programa Livrus */

</i></font><font color="#0000FF">#include &quot;Inkey.ch&quot;
#include &quot;Fileio.ch&quot;

</font><font color="#808080"><i>/* registros */
</i></font><font color="#0000FF">static </font>tAssunto_codigo <font color="#808080"><i>/* 10 */
</i></font><font color="#0000FF">static </font>tAssunto_assunto <font color="#808080"><i>/* 30 */ 

</i></font><font color="#0000FF">static </font>tAutor_codigo <font color="#808080"><i>/* 10 */ 
</i></font><font color="#0000FF">static </font>tAutor_autor <font color="#808080"><i>/* 30 */ 

</i></font><font color="#0000FF">static </font>tEditora_codigo <font color="#808080"><i>/* 10 */ 
</i></font><font color="#0000FF">static </font>tEditora_editora <font color="#808080"><i>/* 50 */ 

</i></font><font color="#0000FF">static </font>tIdioma_codigo <font color="#808080"><i>/* 10 */ 
</i></font><font color="#0000FF">static </font>tIdioma_idioma <font color="#808080"><i>/* 20 */ 

</i></font><font color="#0000FF">static </font>tUsuario_login <font color="#808080"><i>/* 10 */ 
</i></font><font color="#0000FF">static </font>tUsuario_senha <font color="#808080"><i>/* 10 */ 

</i></font><font color="#0000FF">static </font>tPais_codigo <font color="#808080"><i>/* 3 */ 
</i></font><font color="#0000FF">static </font>tPais_pais <font color="#808080"><i>/* 50 */ 

</i></font><font color="#0000FF">static </font>tProfiss_codigo <font color="#808080"><i>/* 10 */ 
</i></font><font color="#0000FF">static </font>tProfiss_profissao <font color="#808080"><i>/* 50 */ 

</i></font><font color="#0000FF">static </font>tLiv_isbn <font color="#808080"><i>/* 13 */ 
</i></font><font color="#0000FF">static </font>tLiv_titulo <font color="#808080"><i>/* 50 */ 
</i></font><font color="#0000FF">static </font>tLiv_edicao <font color="#808080"><i>/* 10 */ 
</i></font><font color="#0000FF">static </font>tLiv_anopubli <font color="#808080"><i>/* 10 */ 
</i></font><font color="#0000FF">static </font>tLiv_codeditora <font color="#808080"><i>/* 10 */
</i></font><font color="#0000FF">static </font>tLiv_volume <font color="#808080"><i>/* 10 */ 
</i></font><font color="#0000FF">static </font>tLiv_codidioma <font color="#808080"><i>/* 10 */ 
</i></font><font color="#0000FF">static </font>tLiv_npaginas <font color="#808080"><i>/* 10 */ 
</i></font><font color="#0000FF">static </font>tLiv_preco <font color="#808080"><i>/* 10 */ 
</i></font><font color="#0000FF">static </font>tLiv_qtdestoque <font color="#808080"><i>/* 10 */ 

</i></font><font color="#0000FF">static </font>tLivAss_isbn <font color="#808080"><i>/* 13 */ 
</i></font><font color="#0000FF">static </font>tLivAss_codassunto <font color="#808080"><i>/* 10 */ 

</i></font><font color="#0000FF">static </font>tLivAut_isbn <font color="#808080"><i>/* 13 */
</i></font><font color="#0000FF">static </font>tLivAut_codautor <font color="#808080"><i>/* 10 */ 

</i></font><font color="#0000FF">static </font>tCli_cpf <font color="#808080"><i>/* 14 */ 
</i></font><font color="#0000FF">static </font>tCli_nome <font color="#808080"><i>/* 30 */ 
</i></font><font color="#0000FF">static </font>tCli_email <font color="#808080"><i>/* 30 */ 
</i></font><font color="#0000FF">static </font>tCli_identidade <font color="#808080"><i>/* 10 */ 
</i></font><font color="#0000FF">static </font>tCli_sexo <font color="#808080"><i>/* 1 */ 
</i></font><font color="#0000FF">static </font>tCli_telefone <font color="#808080"><i>/* 17 */ 
</i></font><font color="#0000FF">static </font>tCli_dtnascimento <font color="#808080"><i>/* 10 */ 
</i></font><font color="#0000FF">static </font>tCli_codendereco <font color="#808080"><i>/* 10 */ 
</i></font><font color="#0000FF">static </font>tCli_codpais <font color="#808080"><i>/* 3 */ 
</i></font><font color="#0000FF">static </font>tCli_codprofissao <font color="#808080"><i>/* 10 */ 

</i></font><font color="#0000FF">static </font>tEnd_codigo <font color="#808080"><i>/* 10 */ 
</i></font><font color="#0000FF">static </font>tEnd_logradouro <font color="#808080"><i>/* 40 */ 
</i></font><font color="#0000FF">static </font>tEnd_bairro <font color="#808080"><i>/* 15 */ 
</i></font><font color="#0000FF">static </font>tEnd_cep <font color="#808080"><i>/* 8 */ 
</i></font><font color="#0000FF">static </font>tEnd_cidade <font color="#808080"><i>/* 30 */ 
</i></font><font color="#0000FF">static </font>tEnd_estado <font color="#808080"><i>/* 20 */ 

</i></font><font color="#0000FF">static </font>tVenda_dthrvenda <font color="#808080"><i>/* 19 */   /* data/hora da venda dd/mm/yyyy hh:mm:ss */
</i></font><font color="#0000FF">static </font>tVenda_cpf <font color="#808080"><i>/* 14 */ 
</i></font><font color="#0000FF">static </font>tVenda_isbn <font color="#808080"><i>/* 13 */ 
</i></font><font color="#0000FF">static </font>tVenda_precovenda <font color="#808080"><i>/* 10 */ 

/* constantes */

/* ctTipo */ 
</i></font><font color="#0000FF">#define opTexto 1 
#define opNumero 2
#define opData 3
#define opDataHora 4
#define opSenha 5
</font><font color="#808080"><i>/* ctArqs */
</i></font><font color="#0000FF">#define opAssunto 1
#define opAutor 2
#define opEditora 3
#define opEndereco 4
#define opIdioma 5
#define opPais 6
#define opProfissao 7
#define opCliente 8
#define opLivro 9
#define opLivroAss 10
#define opLivroAut 11
#define opUsuario 12
#define opVenda 13
</font><font color="#808080"><i>/* ctAcao */ 
</i></font><font color="#0000FF">#define opNovo 1
#define opAlterar 2
#define opPesquisar 3
#define opSalvarInclusao 4
#define opSalvarAlteracao 5
#define opExcluir 6
#define opConfirmaExclusao 7
#define opListarTodos 8

#define CRLF chr(13)+chr(10) /* windows */
#define TAM_CRLF 2
</font><font color="#808080"><i>/* #define CRLF chr(10)
   #define TAM_CRLF 1 */ /* unix */
/* #define CRLF chr(13)
   #define TAM_CRLF 1 */ /* macintosh */

</i></font><font color="#0000FF">#define QTD_MAX_LINHA 18

#define MSG_ARQERRO &quot;Erro: O arquivo n&atilde;o pode ser aberto.&quot;
#define MSG_ARQCERRO &quot;Erro: O arquivo n&atilde;o pode ser criado.&quot;
#define MSG_ERRO &quot;Erro: op&ccedil;&atilde;o inv&aacute;lida digite de novo&quot;
#define MSG_OPCAO &quot;Escolha uma op&ccedil;&atilde;o: &quot;
#define MSG_PRESS &quot;pressione para continuar...&quot;

#define MSG_REGINC &quot;registro incluido!&quot;
#define MSG_REGNINC &quot;registro n&atilde;o incluido!&quot;
#define MSG_REGALT &quot;registro alterado!&quot;
#define MSG_REGNALT &quot;registro n&atilde;o alterado!&quot;
#define MSG_REGEXC &quot;registro excluido!&quot;
#define MSG_REGNEXC &quot;registro n&atilde;o excluido!&quot;
#define MSG_REGEXST &quot;registro j&aacute; existe!&quot;

#define MSG_NUMINV &quot;N&uacute;mero inv&aacute;lido ou menor do que 1!&quot;
#define MSG_DATAINV &quot;Data inv&aacute;lida!, formato correto (dd/mm/yyyy)&quot;
#define MSG_DTHRINV &quot;Data/hora inv&aacute;lida!, formato correto (dd/mm/yyyy hh:mm:ss)&quot;
#define MSG_ISBNINV &quot;ISBN inv&aacute;lido!&quot;
#define MSG_CPFINV &quot;CPF inv&aacute;lido!&quot;
#define MSG_SENCONFERE &quot;senha n&atilde;o confere com a senha atual!&quot;
#define MSG_SENCONFIRM &quot;nova senha n&atilde;o confere com a senha confirmada!&quot;
#define MSG_LOGINENCON &quot;login n&atilde;o encontrado!&quot;
#define MSG_SEMESTOQUE &quot;livro n&atilde;o existe no estoque!&quot;

#define ARQ_ASSUNTO &quot;assunto.dat&quot;
#define ARQ_AUTOR &quot;autor.dat&quot;
#define ARQ_EDITORA &quot;editora.dat&quot;
#define ARQ_IDIOMA &quot;idioma.dat&quot;
#define ARQ_USUARIO &quot;usuario.dat&quot;
#define ARQ_PAIS &quot;pais.dat&quot;
#define ARQ_PROFISSAO &quot;profiss.dat&quot;
#define ARQ_LIVRO &quot;livro.dat&quot;
#define ARQ_LIVASS &quot;livroass.dat&quot;
#define ARQ_LIVAUT &quot;livroaut.dat&quot;
#define ARQ_CLIENTE &quot;cliente.dat&quot;
#define ARQ_ENDERECO &quot;endereco.dat&quot;
#define ARQ_VENDA &quot;venda.dat&quot;

#define TAM_ASSUNTO 40
#define TAM_AUTOR 40
#define TAM_EDITORA 60
#define TAM_IDIOMA 30
#define TAM_USUARIO 20
#define TAM_PAIS 53
#define TAM_PROFISSAO 60
#define TAM_LIVRO 143
#define TAM_LIVASS 23
#define TAM_LIVAUT 23
#define TAM_CLIENTE 135
#define TAM_ENDERECO 123
#define TAM_VENDA 56

</font><font color="#808080"><i>/* vari&aacute;veis globais */
</i></font><font color="#0000FF">static </font>bopcao
<font color="#0000FF">static </font>opmenu
<font color="#0000FF">static </font>g_nPosChave<font color="#808080">, </font>g_nTamChave
<font color="#0000FF">static </font>g_nPreco
<font color="#0000FF">static </font>g_SalvarInclusao

<font color="#0000FF">static </font>tfAssunto<font color="#808080">, </font>tfAutor<font color="#808080">, </font>tfEditora<font color="#808080">, </font>tfIdioma<font color="#808080">, </font>tfEndereco<font color="#808080">, </font>tfPais<font color="#808080">, </font>tfProfissao<font color="#808080">,;
 </font>tfLivro<font color="#808080">, </font>tfLivroAss<font color="#808080">, </font>tfLivroAut<font color="#808080">, </font>tfCliente<font color="#808080">, </font>tfUsuario<font color="#808080">, </font>tfVenda

<font color="#808080"><i>/*------------------------------------------------------------------------------
Parte inicial do c&oacute;digo
------------------------------------------------------------------------------*/
</i></font><font color="#0000FF">Function </font>Main<font color="#808080">() 

<i>/* Defini&ccedil;&otilde;es do programa */

</i></font><font color="#0000FF">set </font><font color="#000080">date </font><font color="#0000FF">to </font>british
<font color="#0000FF">set century on
set console on
set scoreboard off
set device to screen

</font><font color="#808080"><i>/* if ParamStr(1)=&quot;-cria&quot;
     abrecriaArqs(.f.)
 else */
   </i></font>frmSplash<font color="#808080">()
   </font>abrecriaArqs<font color="#808080">(.</font>t<font color="#808080">.)
   </font><font color="#0000FF">if </font>frmLogin<font color="#808080">() 
     </font>bopcao<font color="#808080">:=.</font>t<font color="#808080">.
     </font><font color="#0000FF">do while</font><font color="#808080">(</font>bopcao<font color="#808080">)      
       </font><font color="#0000FF">accept menu</font><font color="#808080">(</font><font color="#FF0000">1</font><font color="#808080">) </font><font color="#0000FF">to </font>opmenu
       <font color="#0000FF">if </font><font color="#808080">(</font>opmenu<font color="#808080">=&quot;</font>C<font color="#808080">&quot;) .</font>or<font color="#808080">. (</font>opmenu<font color="#808080">=&quot;</font>c<font color="#808080">&quot;) 
         </font>usaMenu<font color="#808080">(</font><font color="#FF0000">1</font><font color="#808080">)
       </font><font color="#0000FF">elseif </font><font color="#808080">(</font>opmenu<font color="#808080">=&quot;</font>P<font color="#808080">&quot;) .</font>or<font color="#808080">. (</font>opmenu<font color="#808080">=&quot;</font>p<font color="#808080">&quot;) 
         </font>usaMenu<font color="#808080">(</font><font color="#FF0000">2</font><font color="#808080">)
       </font><font color="#0000FF">elseif </font><font color="#808080">(</font>opmenu<font color="#808080">=&quot;</font>V<font color="#808080">&quot;) .</font>or<font color="#808080">. (</font>opmenu<font color="#808080">=&quot;</font>v<font color="#808080">&quot;) 
         </font>usaMenu<font color="#808080">(</font><font color="#FF0000">3</font><font color="#808080">)
       </font><font color="#0000FF">elseif </font><font color="#808080">(</font>opmenu<font color="#808080">=&quot;</font>O<font color="#808080">&quot;) .</font>or<font color="#808080">. (</font>opmenu<font color="#808080">=&quot;</font>o<font color="#808080">&quot;) 
         </font>usaMenu<font color="#808080">(</font><font color="#FF0000">4</font><font color="#808080">)
       </font><font color="#0000FF">else 
         </font><font color="#000080">qout</font><font color="#808080">(</font>MSG_ERRO<font color="#808080">)
       </font><font color="#0000FF">endif 
     enddo
   else 
     </font>fechaArqs<font color="#808080">()
     </font><font color="#0000FF">quit
   endif
</font><font color="#808080"><i>/* endif*/

</i></font><font color="#0000FF">return</font><font color="#808080">(</font>nil<font color="#808080">)

<i>/*--- Rotinas b&aacute;sicas ---------------------------------------------------------*/

/*------------------------------------------------------------------------------
Coloca espa&ccedil;os em branco a mais de acordo com o tamanho m&aacute;ximo do texto.
sTexto - o texto
nTam - tamanho m&aacute;ximo do texto
retorna - o texto com espa&ccedil;os em branco a mais
------------------------------------------------------------------------------*/
</i></font><font color="#0000FF">function </font>esp<font color="#808080">(</font>sTexto<font color="#808080">, </font>nTam<font color="#808080">)
</font><font color="#0000FF">return</font><font color="#808080">(</font>sTexto<font color="#808080">+</font><font color="#000080">space</font><font color="#808080">(</font>nTam<font color="#808080">-</font><font color="#000080">len</font><font color="#808080">(</font>sTexto<font color="#808080">)))
<i>/*------------------------------------------------------------------------------
Escreve zeros na frente de um texto.
stexto - o texto para receber zeros a frente
ntam - o tamanho da string
retorna - o texto com o zeros antes
------------------------------------------------------------------------------*/
</i></font><font color="#0000FF">function </font>zeros<font color="#808080">(</font>stexto<font color="#808080">, </font>ntam<font color="#808080">)
</font><font color="#0000FF">local </font>ncont<font color="#808080">, </font>saux

  saux<font color="#808080">:=&quot;&quot;
  </font><font color="#0000FF">if </font>ntam<font color="#808080">&lt;&gt;</font><font color="#000080">len</font><font color="#808080">(</font>stexto<font color="#808080">) 
      </font><font color="#0000FF">for </font>ncont<font color="#808080">:=</font><font color="#FF0000">1 </font><font color="#0000FF">to </font>ntam<font color="#808080">-</font><font color="#000080">len</font><font color="#808080">(</font>stexto<font color="#808080">)
        </font>saux<font color="#808080">:=</font>saux <font color="#808080">+ &quot;</font><font color="#FF0000">0</font><font color="#808080">&quot;
      </font><font color="#0000FF">next  
  endif
return</font><font color="#808080">(</font>saux<font color="#808080">+</font>stexto<font color="#808080">)
<i>/*------------------------------------------------------------------------------
Faz uma pesquisa relativa de um texto atrav&eacute;s de um valor chave.
sTexto - o texto
sChave - a chave a ser pesquisada
retorna - se achou ou n&atilde;o a chave dentro do texto
------------------------------------------------------------------------------*/
</i></font><font color="#0000FF">function </font>strRelativa<font color="#808080">(</font>sTexto<font color="#808080">, </font>sChave<font color="#808080">)
</font><font color="#0000FF">local </font>nCont<font color="#808080">, </font>nTamChave<font color="#808080">, </font>nTamTexto<font color="#808080">, </font>bret<font color="#808080">, </font>sPedaco

bret<font color="#808080">:=.</font>f<font color="#808080">.
</font>nCont<font color="#808080">:=</font><font color="#FF0000">1
</font>nTamChave<font color="#808080">:=</font><font color="#000080">len</font><font color="#808080">(</font>sChave<font color="#808080">)
</font>nTamTexto<font color="#808080">:=</font><font color="#000080">len</font><font color="#808080">(</font>sTexto<font color="#808080">)
</font><font color="#0000FF">if </font>nTamChave <font color="#808080">&lt;= </font>nTamTexto 
  <font color="#0000FF">do while </font>nCont <font color="#808080">&lt;= (</font>nTamTexto<font color="#808080">-</font>nTamChave<font color="#808080">+</font><font color="#FF0000">1</font><font color="#808080">)
     </font>sPedaco<font color="#808080">:=</font><font color="#000080">substr</font><font color="#808080">(</font>sTexto<font color="#808080">,</font>nCont<font color="#808080">,</font>nTamChave<font color="#808080">)
     </font><font color="#0000FF">if </font>sPedaco<font color="#808080">==</font>sChave
        bret<font color="#808080">:=.</font>t<font color="#808080">.
     </font><font color="#0000FF">endif
     </font>nCont<font color="#808080">++
  </font><font color="#0000FF">enddo 
endif
return</font><font color="#808080">(</font>bret<font color="#808080">)
<i>/*------------------------------------------------------------------------------
Calcula o modulo11 de um valor qualquer.
svalor - a mstring com o n&uacute;mero a ser calculado
ndig - d&iacute;gito do valor a ser calculado
retorna - o d&iacute;gito correto
------------------------------------------------------------------------------*/
</i></font><font color="#0000FF">function </font>modulo11<font color="#808080">(</font>svalor<font color="#808080">, </font>ndig<font color="#808080">)
</font><font color="#0000FF">local </font>nmodulo11<font color="#808080">, </font>ncont<font color="#808080">, </font>nsoma<font color="#808080">, </font>nvalor<font color="#808080">, </font>npos<font color="#808080">, </font>sres<font color="#808080">, </font>slocal

 ncont<font color="#808080">:=</font><font color="#FF0000">1
 </font>slocal<font color="#808080">:=&quot;&quot;
 </font><font color="#0000FF">do while </font>ncont <font color="#808080">&lt;= </font><font color="#FF0000">11
   </font>slocal<font color="#808080">:=</font><font color="#000080">substr</font><font color="#808080">(</font>svalor<font color="#808080">,</font>ncont<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">) + </font>slocal
   ncont<font color="#808080">:=</font>ncont<font color="#808080">+</font><font color="#FF0000">1
 </font><font color="#0000FF">enddo
 </font>nsoma<font color="#808080">:=</font><font color="#FF0000">0
 </font><font color="#0000FF">if </font>ndig<font color="#808080">=</font><font color="#FF0000">1
   </font>ncont<font color="#808080">:=</font><font color="#FF0000">3
 </font><font color="#0000FF">else
   </font>ncont<font color="#808080">:=</font><font color="#FF0000">2
 </font><font color="#0000FF">endif
 </font>npos<font color="#808080">:=</font><font color="#FF0000">2
 </font><font color="#0000FF">do while </font>ncont <font color="#808080">&lt;= </font><font color="#FF0000">11
   </font>sres<font color="#808080">:=</font><font color="#000080">substr</font><font color="#808080">(</font>slocal<font color="#808080">,</font>ncont<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">)
   </font>nvalor<font color="#808080">:=</font><font color="#000080">Val</font><font color="#808080">(</font>sres<font color="#808080">)
   </font>nsoma<font color="#808080">:=</font>nsoma <font color="#808080">+ (</font>nvalor <font color="#808080">* </font>npos<font color="#808080">)
   </font>ncont<font color="#808080">++
   </font>npos<font color="#808080">++
 </font><font color="#0000FF">enddo
 </font>nsoma<font color="#808080">:=(</font><font color="#FF0000">11 </font><font color="#808080">- (</font>nsoma <font color="#808080">% </font><font color="#FF0000">11</font><font color="#808080">))

</font><font color="#0000FF">if </font>nsoma <font color="#808080">&gt; </font><font color="#FF0000">9
  </font>nmodulo11<font color="#808080">:=</font><font color="#FF0000">0
</font><font color="#0000FF">else
  </font>nmodulo11<font color="#808080">:=</font>nsoma
<font color="#0000FF">endif
return</font><font color="#808080">(</font>nmodulo11<font color="#808080">)

<i>/*------------------------------------------------------------------------------
Valida&ccedil;&atilde;o de um n&uacute;mero de CPF qualquer.
cpf - a mstring com o n&uacute;mero do CPF
retorna - se &eacute; valido ou n&atilde;o
------------------------------------------------------------------------------*/
</i></font><font color="#0000FF">function </font>validaCPF<font color="#808080">(</font>cpf<font color="#808080">)
</font><font color="#0000FF">local </font>scpf<font color="#808080">, </font>sres<font color="#808080">, </font>bvalidaCPF
<font color="#0000FF">local </font>nstatus<font color="#808080">, </font>nvalor1<font color="#808080">, </font>nvalor2

<font color="#0000FF">if </font><font color="#808080">(</font><font color="#000080">len</font><font color="#808080">(</font>cpf<font color="#808080">)=</font><font color="#FF0000">14</font><font color="#808080">) 
  </font>scpf<font color="#808080">:=</font><font color="#000080">substr</font><font color="#808080">(</font>cpf<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#FF0000">3</font><font color="#808080">)+</font><font color="#000080">substr</font><font color="#808080">(</font>cpf<font color="#808080">,</font><font color="#FF0000">5</font><font color="#808080">,</font><font color="#FF0000">3</font><font color="#808080">)+</font><font color="#000080">substr</font><font color="#808080">(</font>cpf<font color="#808080">,</font><font color="#FF0000">9</font><font color="#808080">,</font><font color="#FF0000">3</font><font color="#808080">)+</font><font color="#000080">substr</font><font color="#808080">(</font>cpf<font color="#808080">,</font><font color="#FF0000">13</font><font color="#808080">,</font><font color="#FF0000">2</font><font color="#808080">)
  </font>sres<font color="#808080">:=</font><font color="#000080">substr</font><font color="#808080">(</font>cpf<font color="#808080">,</font><font color="#FF0000">13</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">)
  </font>nvalor1<font color="#808080">:=</font><font color="#000080">Val</font><font color="#808080">(</font>sres<font color="#808080">)
  </font>sres<font color="#808080">:=</font><font color="#000080">substr</font><font color="#808080">(</font>cpf<font color="#808080">,</font><font color="#FF0000">14</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">)
  </font>nvalor2<font color="#808080">:=</font><font color="#000080">Val</font><font color="#808080">(</font>sres<font color="#808080">)
  </font><font color="#0000FF">if </font><font color="#808080">((</font>modulo11<font color="#808080">(</font>scpf<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">)=</font>nvalor1<font color="#808080">) .</font>and<font color="#808080">. (</font>modulo11<font color="#808080">(</font>scpf<font color="#808080">,</font><font color="#FF0000">2</font><font color="#808080">)=</font>nvalor2<font color="#808080">))
    </font>bvalidaCPF<font color="#808080">:=.</font>t<font color="#808080">.
  </font><font color="#0000FF">else
    </font>bvalidaCPF<font color="#808080">:=.</font>f<font color="#808080">.
  </font><font color="#0000FF">endif
else
  </font>bvalidaCPF<font color="#808080">:=.</font>f<font color="#808080">.
</font><font color="#0000FF">endif
return</font><font color="#808080">(</font>bvalidaCPF<font color="#808080">)
<i>/*------------------------------------------------------------------------------
Valida&ccedil;&atilde;o de um n&uacute;mero ISBN qualquer.
isbn - a mstring com o n&uacute;mero do ISBN
retorna - se &eacute; valido ou n&atilde;o
------------------------------------------------------------------------------*/
</i></font><font color="#0000FF">function </font>validaISBN<font color="#808080">(</font>isbn<font color="#808080">)
</font><font color="#0000FF">local </font>snum<font color="#808080">, </font>sdigito<font color="#808080">, </font>sisbn<font color="#808080">, </font>bvalidaISBN
<font color="#0000FF">local </font>nvalor<font color="#808080">, </font>nsoma<font color="#808080">, </font>ncont


<font color="#0000FF">if </font><font color="#808080">(</font><font color="#000080">len</font><font color="#808080">(</font>isbn<font color="#808080">)=</font><font color="#FF0000">13</font><font color="#808080">) 
  </font>sdigito <font color="#808080">:= </font><font color="#000080">substr</font><font color="#808080">(</font>isbn<font color="#808080">, </font><font color="#000080">len</font><font color="#808080">(</font>isbn<font color="#808080">), </font><font color="#FF0000">1</font><font color="#808080">)
  </font>sisbn<font color="#808080">:=&quot;&quot;
  </font><font color="#0000FF">for </font>ncont<font color="#808080">:=</font><font color="#FF0000">1 </font><font color="#0000FF">to </font><font color="#000080">len</font><font color="#808080">(</font>isbn<font color="#808080">)-</font><font color="#FF0000">1
    </font><font color="#0000FF">if </font><font color="#808080">(</font><font color="#000080">substr</font><font color="#808080">(</font>isbn<font color="#808080">,</font>ncont<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">)&lt;&gt;&quot;-&quot;) 
      </font>sisbn<font color="#808080">:=</font>sisbn<font color="#808080">+</font><font color="#000080">substr</font><font color="#808080">(</font>isbn<font color="#808080">,</font>ncont<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">)
    </font><font color="#0000FF">endif 
  next
  if </font>sdigito <font color="#808080">= &quot;</font>X<font color="#808080">&quot;
    </font>nsoma <font color="#808080">:= </font><font color="#FF0000">10
  </font><font color="#0000FF">else
    </font>nvalor<font color="#808080">:=</font><font color="#000080">Val</font><font color="#808080">(</font>sdigito<font color="#808080">)
    </font>nsoma<font color="#808080">:=</font>nvalor
  <font color="#0000FF">endif
  for </font>ncont<font color="#808080">:=</font><font color="#FF0000">1 </font><font color="#0000FF">to </font><font color="#FF0000">9
    </font>snum<font color="#808080">:=</font><font color="#000080">substr</font><font color="#808080">(</font>sisbn<font color="#808080">, </font>ncont<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">)
    </font>nvalor<font color="#808080">:=</font><font color="#000080">Val</font><font color="#808080">(</font>snum<font color="#808080">)
    </font>nsoma<font color="#808080">:=</font>nsoma <font color="#808080">+ (</font>nvalor <font color="#808080">* (</font><font color="#FF0000">11 </font><font color="#808080">- </font>ncont<font color="#808080">))
  </font><font color="#0000FF">next
  If </font><font color="#808080">(</font>nsoma <font color="#808080">% </font><font color="#FF0000">11</font><font color="#808080">) = </font><font color="#FF0000">0
    </font>bvalidaISBN<font color="#808080">:=.</font>t<font color="#808080">.
  </font><font color="#0000FF">else
    </font>bvalidaISBN<font color="#808080">:=.</font>f<font color="#808080">.
  </font><font color="#0000FF">endif
else
  </font>bvalidaISBN<font color="#808080">:=.</font>f<font color="#808080">.
</font><font color="#0000FF">endif
return</font><font color="#808080">(</font>bvalidaISBN<font color="#808080">)
<i>/*------------------------------------------------------------------------------
Esconde a digita&ccedil;&atilde;o da senha
retorna - a senha digitada
------------------------------------------------------------------------------*/
</i></font><font color="#0000FF">function </font>digitaSenha<font color="#808080">(</font>sRotulo<font color="#808080">, </font>nTamSenha<font color="#808080">)
</font><font color="#0000FF">local </font>sSenha<font color="#808080">, </font>ncont<font color="#808080">, </font>nLetra
  
  <font color="#000080">qout</font><font color="#808080">(</font>sRotulo<font color="#808080">)
  </font>ncont <font color="#808080">:= </font><font color="#FF0000">0
  </font>sSenha<font color="#808080">:=&quot;&quot;
  </font>nLetra<font color="#808080">:=</font><font color="#FF0000">0
  </font><font color="#0000FF">do while</font><font color="#808080">((</font>nLetra<font color="#808080">&lt;&gt;</font>K_ENTER<font color="#808080">) .</font>and<font color="#808080">. (</font>ncont <font color="#808080">&lt; </font>nTamSenha<font color="#808080">))    
    </font>nLetra<font color="#808080">:=</font><font color="#000080">inkey</font><font color="#808080">(</font><font color="#FF0000">0</font><font color="#808080">)
    </font><font color="#0000FF">if </font>nLetra<font color="#808080">&lt;&gt;</font>K_ENTER 
      sSenha<font color="#808080">:=</font>sSenha<font color="#808080">+</font><font color="#000080">chr</font><font color="#808080">(</font>nLetra<font color="#808080">)
    </font><font color="#0000FF">endif
    </font>ncont<font color="#808080">++
  </font><font color="#0000FF">enddo
return</font><font color="#808080">(</font>sSenha<font color="#808080">)
<i>/*------------------------------------------------------------------------------
Valida&ccedil;&atilde;o de um n&uacute;mero qualquer.
sRotulo - o texto antes de se digitar o n&uacute;mero
sNumero - a mstring com o valor do n&uacute;mero
retorna - o sNumero
------------------------------------------------------------------------------*/
</i></font><font color="#0000FF">function </font>validaNumero<font color="#808080">(</font>sRotulo<font color="#808080">, </font>sNumero<font color="#808080">)
</font><font color="#0000FF">local </font>nnum<font color="#808080">, </font>nStatus

nStatus<font color="#808080">:=-</font><font color="#FF0000">1
</font><font color="#0000FF">do while </font><font color="#808080">(</font>nStatus<font color="#808080">&lt;&gt;</font><font color="#FF0000">0</font><font color="#808080">)
  </font><font color="#0000FF">accept </font>sRotulo <font color="#0000FF">to </font>sNumero
  nnum<font color="#808080">:=</font><font color="#000080">Val</font><font color="#808080">(</font>sNumero<font color="#808080">)
  </font><font color="#0000FF">if </font><font color="#808080">(</font><font color="#000080">ValType</font><font color="#808080">(</font>nnum<font color="#808080">)&lt;&gt;&quot;</font>N<font color="#808080">&quot;) .</font>or<font color="#808080">. (</font>nnum <font color="#808080">&lt; </font><font color="#FF0000">1</font><font color="#808080">)
     </font><font color="#000080">qout</font><font color="#808080">(</font>MSG_NUMINV<font color="#808080">)
  </font><font color="#0000FF">else
     </font>nStatus <font color="#808080">= </font><font color="#FF0000">0
  </font><font color="#0000FF">endif
enddo
return</font><font color="#808080">(</font>sNumero<font color="#808080">)
<i>/*------------------------------------------------------------------------------
Valida&ccedil;&atilde;o de uma data ou data/hora qualquer.
sRotulo - o texto antes de se digitar a data/hora
sDataHora - a mstring com o valor da data/hora
bSoData - indica se vai validar somente uma data sem a hora
retorna - a sDataHora
------------------------------------------------------------------------------*/
</i></font><font color="#0000FF">function </font>validaDataHora<font color="#808080">(</font>sRotulo<font color="#808080">, </font>sDataHora<font color="#808080">, </font>bSoData<font color="#808080">)
</font><font color="#0000FF">local </font>bvalida<font color="#808080">, </font>bdatavalida<font color="#808080">, </font>bhoravalida
<font color="#0000FF">local </font>sdia<font color="#808080">, </font>smes<font color="#808080">, </font>sano<font color="#808080">, </font>shora<font color="#808080">, </font>smin<font color="#808080">, </font>sseg
<font color="#0000FF">local </font>ndia<font color="#808080">, </font>nmes<font color="#808080">, </font>nano<font color="#808080">, </font>nhora<font color="#808080">, </font>nmin<font color="#808080">, </font>nseg<font color="#808080">, </font>nudiames
<font color="#0000FF">local </font>nStatus<font color="#808080">, </font>ntam

bvalida<font color="#808080">:=.</font>f<font color="#808080">.
</font>bdatavalida<font color="#808080">:=.</font>f<font color="#808080">.
</font>bhoravalida<font color="#808080">:=.</font>f<font color="#808080">.
</font>nudiames<font color="#808080">:=</font><font color="#FF0000">0

</font><font color="#0000FF">if </font>bSoData<font color="#808080">=.</font>t<font color="#808080">. 
  </font>ntam<font color="#808080">:=</font><font color="#FF0000">10
</font><font color="#0000FF">else 
  </font>ntam<font color="#808080">:=</font><font color="#FF0000">19
</font><font color="#0000FF">endif
do while </font><font color="#808080">(</font>bvalida<font color="#808080">=.</font>f<font color="#808080">.)
  </font><font color="#0000FF">accept </font>sRotulo <font color="#0000FF">to </font>sDataHora
  <font color="#0000FF">if </font><font color="#000080">len</font><font color="#808080">(</font>sDataHora<font color="#808080">)=</font>ntam 
    sdia<font color="#808080">:=</font><font color="#000080">substr</font><font color="#808080">(</font>sDataHora<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#FF0000">2</font><font color="#808080">)
    </font>ndia<font color="#808080">:=</font><font color="#000080">Val</font><font color="#808080">(</font>sdia<font color="#808080">)
    </font>smes<font color="#808080">:=</font><font color="#000080">substr</font><font color="#808080">(</font>sDataHora<font color="#808080">,</font><font color="#FF0000">4</font><font color="#808080">,</font><font color="#FF0000">2</font><font color="#808080">)
    </font>nmes<font color="#808080">:=</font><font color="#000080">Val</font><font color="#808080">(</font>smes<font color="#808080">)
    </font>sano<font color="#808080">:=</font><font color="#000080">substr</font><font color="#808080">(</font>sDataHora<font color="#808080">,</font><font color="#FF0000">7</font><font color="#808080">,</font><font color="#FF0000">4</font><font color="#808080">)
    </font>nano<font color="#808080">:=</font><font color="#000080">Val</font><font color="#808080">(</font>sano<font color="#808080">)
  
    </font><font color="#0000FF">if </font><font color="#808080">(</font>nano <font color="#808080">&gt;= </font><font color="#FF0000">1</font><font color="#808080">) .</font>and<font color="#808080">. (</font>nano <font color="#808080">&lt;= </font><font color="#FF0000">9999</font><font color="#808080">) 
      </font><font color="#0000FF">if </font><font color="#808080">(</font>nmes <font color="#808080">&gt;= </font><font color="#FF0000">1</font><font color="#808080">) .</font>and<font color="#808080">. (</font>nmes <font color="#808080">&lt;= </font><font color="#FF0000">31</font><font color="#808080">) 
          </font><font color="#0000FF">do case 
           case </font>nmes <font color="#808080">= </font><font color="#FF0000">1 </font><font color="#808080">.</font>or<font color="#808080">. </font>nmes <font color="#808080">= </font><font color="#FF0000">3 </font><font color="#808080">.</font>or<font color="#808080">. </font>nmes <font color="#808080">= </font><font color="#FF0000">5 </font><font color="#808080">.</font>or<font color="#808080">. </font>nmes <font color="#808080">= </font><font color="#FF0000">7 </font><font color="#808080">.</font>or<font color="#808080">.;
                </font>nmes <font color="#808080">= </font><font color="#FF0000">8 </font><font color="#808080">.</font>or<font color="#808080">. </font>nmes <font color="#808080">= </font><font color="#FF0000">10 </font><font color="#808080">.</font>or<font color="#808080">. </font>nmes <font color="#808080">= </font><font color="#FF0000">12
               </font>nudiames<font color="#808080">:=</font><font color="#FF0000">31
           </font><font color="#0000FF">case </font>nmes <font color="#808080">= </font><font color="#FF0000">2
               </font><font color="#808080"><i>/* ano bissexto */
               </i></font><font color="#0000FF">if </font><font color="#808080">(</font>nano <font color="#808080">% </font><font color="#FF0000">4</font><font color="#808080">)=</font><font color="#FF0000">0 
                 </font>nudiames<font color="#808080">:=</font><font color="#FF0000">29
               </font><font color="#0000FF">else 
                 </font>nudiames<font color="#808080">:=</font><font color="#FF0000">28
               </font><font color="#0000FF">endif
           case </font>nmes <font color="#808080">= </font><font color="#FF0000">4 </font><font color="#808080">.</font>or<font color="#808080">. </font>nmes <font color="#808080">= </font><font color="#FF0000">6 </font><font color="#808080">.</font>or<font color="#808080">. </font>nmes <font color="#808080">= </font><font color="#FF0000">9 </font><font color="#808080">.</font>or<font color="#808080">. </font>nmes <font color="#808080">= </font><font color="#FF0000">11 
              </font>nudiames<font color="#808080">:=</font><font color="#FF0000">30
          </font><font color="#0000FF">endcase
          if </font><font color="#808080">(</font>ndia <font color="#808080">&gt;=</font><font color="#FF0000">1</font><font color="#808080">) .</font>and<font color="#808080">. (</font>ndia <font color="#808080">&lt;=</font>nudiames<font color="#808080">)
             </font>bdatavalida<font color="#808080">:=.</font>t<font color="#808080">.
          </font><font color="#0000FF">endif
      endif
    endif
  
    if </font>bSoData 
       <font color="#0000FF">if </font>bdatavalida 
          bvalida<font color="#808080">:=.</font>t<font color="#808080">.
       </font><font color="#0000FF">else 
          </font><font color="#000080">qout</font><font color="#808080">(</font>MSG_DATAINV<font color="#808080">)
       </font><font color="#0000FF">endif
    else 
      if </font>bdatavalida 
          shora<font color="#808080">:=</font><font color="#000080">substr</font><font color="#808080">(</font>sDataHora<font color="#808080">,</font><font color="#FF0000">12</font><font color="#808080">,</font><font color="#FF0000">2</font><font color="#808080">)
          </font>nhora<font color="#808080">:=</font><font color="#000080">Val</font><font color="#808080">(</font>shora<font color="#808080">)
          </font>smin<font color="#808080">:=</font><font color="#000080">substr</font><font color="#808080">(</font>sDataHora<font color="#808080">,</font><font color="#FF0000">15</font><font color="#808080">,</font><font color="#FF0000">2</font><font color="#808080">)
          </font>nmin<font color="#808080">:=</font><font color="#000080">Val</font><font color="#808080">(</font>smin<font color="#808080">)
          </font>sseg<font color="#808080">:=</font><font color="#000080">substr</font><font color="#808080">(</font>sDataHora<font color="#808080">,</font><font color="#FF0000">18</font><font color="#808080">,</font><font color="#FF0000">2</font><font color="#808080">)
          </font>nseg<font color="#808080">:=</font><font color="#000080">Val</font><font color="#808080">(</font>sseg<font color="#808080">)
  
          </font><font color="#0000FF">if </font><font color="#808080">(</font>nhora <font color="#808080">&gt;= </font><font color="#FF0000">0</font><font color="#808080">) .</font>and<font color="#808080">. (</font>nhora <font color="#808080">&lt;= </font><font color="#FF0000">23</font><font color="#808080">) 
            </font><font color="#0000FF">if </font><font color="#808080">(</font>nmin <font color="#808080">&gt;= </font><font color="#FF0000">0</font><font color="#808080">) .</font>and<font color="#808080">. (</font>nmin <font color="#808080">&lt;= </font><font color="#FF0000">59</font><font color="#808080">) 
              </font><font color="#0000FF">if </font><font color="#808080">(</font>nseg <font color="#808080">&gt;= </font><font color="#FF0000">0</font><font color="#808080">) .</font>and<font color="#808080">. (</font>nseg <font color="#808080">&lt;= </font><font color="#FF0000">59</font><font color="#808080">)
                 </font>bhoravalida<font color="#808080">:=.</font>t<font color="#808080">.
              </font><font color="#0000FF">endif 
            endif
          endif
  
          if </font>bhoravalida 
            bvalida<font color="#808080">:=.</font>t<font color="#808080">.
          </font><font color="#0000FF">else 
            </font><font color="#000080">qout</font><font color="#808080">(</font>MSG_DTHRINV<font color="#808080">)
          </font><font color="#0000FF">endif
      else
        </font><font color="#000080">qout</font><font color="#808080">(</font>MSG_DTHRINV<font color="#808080">)
      </font><font color="#0000FF">endif
    endif
  else 
    if </font>bSoData<font color="#808080">=.</font>t<font color="#808080">. 
       </font><font color="#000080">qout</font><font color="#808080">(</font>MSG_DATAINV<font color="#808080">)
    </font><font color="#0000FF">else 
       </font><font color="#000080">qout</font><font color="#808080">(</font>MSG_DTHRINV<font color="#808080">)
    </font><font color="#0000FF">endif
  endif
enddo
return</font><font color="#808080">(</font>sDataHora<font color="#808080">)
<i>/*------------------------------------------------------------------------------
Retorna a Data e a hora do sistema.
retorna - a data e a hora
------------------------------------------------------------------------------*/
</i></font><font color="#0000FF">function </font>retDataHora<font color="#808080">()
</font><font color="#0000FF">return</font><font color="#808080">(</font><font color="#000080">dtoc</font><font color="#808080">(</font><font color="#000080">date</font><font color="#808080">())+&quot; &quot;+</font><font color="#000080">time</font><font color="#808080">())

<i>/*--- Rotinas de manipula&ccedil;&atilde;o de arquivos --------------------------------------*/

/*------------------------------------------------------------------------------
Calcula o tamanho do arquivo.
sArq - o arquivo
retorna - o tamanho do arquivo
------------------------------------------------------------------------------*/
</i></font><font color="#0000FF">function </font>tamArq<font color="#808080">(</font>sArq<font color="#808080">)
</font><font color="#0000FF">local </font>npos<font color="#808080">, </font>ntam

npos <font color="#808080">:= </font><font color="#000080">fseek</font><font color="#808080">( </font>sArq<font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font>FS_RELATIVE <font color="#808080">)
</font>ntam <font color="#808080">:= </font><font color="#000080">fseek</font><font color="#808080">( </font>sArq<font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font>FS_END <font color="#808080">)
</font><font color="#000080">fseek</font><font color="#808080">(</font>sArq<font color="#808080">, </font>npos<font color="#808080">)
</font><font color="#0000FF">return</font><font color="#808080">(</font>ntam<font color="#808080">)

<i>/*------------------------------------------------------------------------------
Verifica se chegou no fim do arquivo.
sArq - o arquivo
retorna - se chegou ou n&atilde;o o fim de arquivo
------------------------------------------------------------------------------*/
</i></font><font color="#0000FF">function </font>fimArq<font color="#808080">(</font>sArq<font color="#808080">)
</font><font color="#0000FF">local </font>bret

<font color="#0000FF">if </font>tamArq<font color="#808080">(</font>sArq<font color="#808080">) == </font><font color="#000080">fseek</font><font color="#808080">(</font>sArq<font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font>FS_RELATIVE<font color="#808080">)
   </font>bret<font color="#808080">:=.</font>t<font color="#808080">.
</font><font color="#0000FF">else
   </font>bret<font color="#808080">:=.</font>f<font color="#808080">.
</font><font color="#0000FF">endif
return</font><font color="#808080">(</font>bret<font color="#808080">)

<i>/*------------------------------------------------------------------------------
Abre ou cria os arquivos do sistema.
bAbre - condi&ccedil;&atilde;o para abrir ou criar os arquivos do sistema
------------------------------------------------------------------------------*/
</i></font><font color="#0000FF">procedure </font>abrecriaArqs<font color="#808080">(</font>bAbre<font color="#808080">)
</font><font color="#0000FF">if </font>bAbre 
    <font color="#0000FF">if </font><font color="#808080">(</font>tfAssunto<font color="#808080">:=</font><font color="#000080">fopen</font><font color="#808080">(</font>ARQ_ASSUNTO<font color="#808080">,</font>FO_READWRITE<font color="#808080">)) = -</font><font color="#FF0000">1
     </font><font color="#000080">qout</font><font color="#808080">(</font>MSG_ARQERRO<font color="#808080">+&quot; --&gt; &quot;+</font>ARQ_ASSUNTO<font color="#808080">)
    </font><font color="#0000FF">endif
    if </font><font color="#808080">(</font>tfAutor<font color="#808080">:=</font><font color="#000080">fopen</font><font color="#808080">(</font>ARQ_AUTOR<font color="#808080">,</font>FO_READWRITE<font color="#808080">)) = -</font><font color="#FF0000">1
     </font><font color="#000080">qout</font><font color="#808080">(</font>MSG_ARQERRO<font color="#808080">+&quot; --&gt; &quot;+</font>ARQ_AUTOR<font color="#808080">)
    </font><font color="#0000FF">endif
    if </font><font color="#808080">(</font>tfEditora<font color="#808080">:=</font><font color="#000080">fopen</font><font color="#808080">(</font>ARQ_EDITORA<font color="#808080">,</font>FO_READWRITE<font color="#808080">)) = -</font><font color="#FF0000">1
     </font><font color="#000080">qout</font><font color="#808080">(</font>MSG_ARQERRO<font color="#808080">+&quot; --&gt; &quot;+</font>ARQ_EDITORA<font color="#808080">)
    </font><font color="#0000FF">endif
    if </font><font color="#808080">(</font>tfIdioma<font color="#808080">:=</font><font color="#000080">fopen</font><font color="#808080">(</font>ARQ_IDIOMA<font color="#808080">,</font>FO_READWRITE<font color="#808080">)) = -</font><font color="#FF0000">1
     </font><font color="#000080">qout</font><font color="#808080">(</font>MSG_ARQERRO<font color="#808080">+&quot; --&gt; &quot;+</font>ARQ_IDIOMA<font color="#808080">)
    </font><font color="#0000FF">endif
    if </font><font color="#808080">(</font>tfEndereco<font color="#808080">:=</font><font color="#000080">fopen</font><font color="#808080">(</font>ARQ_ENDERECO<font color="#808080">,</font>FO_READWRITE<font color="#808080">)) = -</font><font color="#FF0000">1
     </font><font color="#000080">qout</font><font color="#808080">(</font>MSG_ARQERRO<font color="#808080">+&quot; --&gt; &quot;+</font>ARQ_ENDERECO<font color="#808080">)
    </font><font color="#0000FF">endif
    if </font><font color="#808080">(</font>tfPais<font color="#808080">:=</font><font color="#000080">fopen</font><font color="#808080">(</font>ARQ_PAIS<font color="#808080">,</font>FO_READWRITE<font color="#808080">)) = -</font><font color="#FF0000">1
     </font><font color="#000080">qout</font><font color="#808080">(</font>MSG_ARQERRO<font color="#808080">+&quot; --&gt; &quot;+</font>ARQ_PAIS<font color="#808080">)
    </font><font color="#0000FF">endif
    if </font><font color="#808080">(</font>tfProfissao<font color="#808080">:=</font><font color="#000080">fopen</font><font color="#808080">(</font>ARQ_PROFISSAO<font color="#808080">,</font>FO_READWRITE<font color="#808080">)) = -</font><font color="#FF0000">1
     </font><font color="#000080">qout</font><font color="#808080">(</font>MSG_ARQERRO<font color="#808080">+&quot; --&gt; &quot;+</font>ARQ_PROFISSAO<font color="#808080">)
    </font><font color="#0000FF">endif
    if </font><font color="#808080">(</font>tfLivro<font color="#808080">:=</font><font color="#000080">fopen</font><font color="#808080">(</font>ARQ_LIVRO<font color="#808080">,</font>FO_READWRITE<font color="#808080">)) = -</font><font color="#FF0000">1
     </font><font color="#000080">qout</font><font color="#808080">(</font>MSG_ARQERRO<font color="#808080">+&quot; --&gt; &quot;+</font>ARQ_LIVRO<font color="#808080">)
    </font><font color="#0000FF">endif
    if </font><font color="#808080">(</font>tfLivroAss<font color="#808080">:=</font><font color="#000080">fopen</font><font color="#808080">(</font>ARQ_LIVASS<font color="#808080">,</font>FO_READWRITE<font color="#808080">)) = -</font><font color="#FF0000">1
     </font><font color="#000080">qout</font><font color="#808080">(</font>MSG_ARQERRO<font color="#808080">+&quot; --&gt; &quot;+</font>ARQ_LIVASS<font color="#808080">)
    </font><font color="#0000FF">endif
    if </font><font color="#808080">(</font>tfLivroAut<font color="#808080">:=</font><font color="#000080">fopen</font><font color="#808080">(</font>ARQ_LIVAUT<font color="#808080">,</font>FO_READWRITE<font color="#808080">)) = -</font><font color="#FF0000">1
     </font><font color="#000080">qout</font><font color="#808080">(</font>MSG_ARQERRO<font color="#808080">+&quot; --&gt; &quot;+</font>ARQ_LIVAUT<font color="#808080">)
    </font><font color="#0000FF">endif
    if </font><font color="#808080">(</font>tfCliente<font color="#808080">:=</font><font color="#000080">fopen</font><font color="#808080">(</font>ARQ_CLIENTE<font color="#808080">,</font>FO_READWRITE<font color="#808080">)) = -</font><font color="#FF0000">1
     </font><font color="#000080">qout</font><font color="#808080">(</font>MSG_ARQERRO<font color="#808080">+&quot; --&gt; &quot;+</font>ARQ_CLIENTE<font color="#808080">)
    </font><font color="#0000FF">endif
    if </font><font color="#808080">(</font>tfUsuario<font color="#808080">:=</font><font color="#000080">fopen</font><font color="#808080">(</font>ARQ_USUARIO<font color="#808080">,</font>FO_READWRITE<font color="#808080">)) = -</font><font color="#FF0000">1
     </font><font color="#000080">qout</font><font color="#808080">(</font>MSG_ARQERRO<font color="#808080">+&quot; --&gt; &quot;+</font>ARQ_USUARIO<font color="#808080">)
    </font><font color="#0000FF">endif
    if </font><font color="#808080">(</font>tfVenda<font color="#808080">:=</font><font color="#000080">fopen</font><font color="#808080">(</font>ARQ_VENDA<font color="#808080">,</font>FO_READWRITE<font color="#808080">)) = -</font><font color="#FF0000">1
     </font><font color="#000080">qout</font><font color="#808080">(</font>MSG_ARQERRO<font color="#808080">+&quot; --&gt; &quot;+</font>ARQ_VENDA<font color="#808080">)
    </font><font color="#0000FF">endif
else 
    if </font><font color="#808080">(</font>tfAssunto<font color="#808080">:=</font><font color="#000080">fcreate</font><font color="#808080">(</font>ARQ_ASSUNTO<font color="#808080">,</font>FC_NORMAL<font color="#808080">)) = -</font><font color="#FF0000">1
     </font><font color="#000080">qout</font><font color="#808080">(</font>MSG_ARQCERRO<font color="#808080">+&quot; --&gt; &quot;+</font>ARQ_ASSUNTO<font color="#808080">)
    </font><font color="#0000FF">endif 
    if </font><font color="#808080">(</font>tfAutor<font color="#808080">:=</font><font color="#000080">fcreate</font><font color="#808080">(</font>ARQ_AUTOR<font color="#808080">,</font>FC_NORMAL<font color="#808080">)) = -</font><font color="#FF0000">1
     </font><font color="#000080">qout</font><font color="#808080">(</font>MSG_ARQCERRO<font color="#808080">+&quot; --&gt; &quot;+</font>ARQ_AUTOR<font color="#808080">)
    </font><font color="#0000FF">endif
    if </font><font color="#808080">(</font>tfEditora<font color="#808080">:=</font><font color="#000080">fcreate</font><font color="#808080">(</font>ARQ_EDITORA<font color="#808080">,</font>FC_NORMAL<font color="#808080">)) = -</font><font color="#FF0000">1
     </font><font color="#000080">qout</font><font color="#808080">(</font>MSG_ARQCERRO<font color="#808080">+&quot; --&gt; &quot;+</font>ARQ_EDITORA<font color="#808080">)
    </font><font color="#0000FF">endif
    if </font><font color="#808080">(</font>tfIdioma<font color="#808080">:=</font><font color="#000080">fcreate</font><font color="#808080">(</font>ARQ_IDIOMA<font color="#808080">,</font>FC_NORMAL<font color="#808080">)) = -</font><font color="#FF0000">1
     </font><font color="#000080">qout</font><font color="#808080">(</font>MSG_ARQCERRO<font color="#808080">+&quot; --&gt; &quot;+</font>ARQ_IDIOMA<font color="#808080">)
    </font><font color="#0000FF">endif 
    if </font><font color="#808080">(</font>tfEndereco<font color="#808080">:=</font><font color="#000080">fcreate</font><font color="#808080">(</font>ARQ_ENDERECO<font color="#808080">,</font>FC_NORMAL<font color="#808080">)) = -</font><font color="#FF0000">1
     </font><font color="#000080">qout</font><font color="#808080">(</font>MSG_ARQCERRO<font color="#808080">+&quot; --&gt; &quot;+</font>ARQ_ENDERECO<font color="#808080">)
    </font><font color="#0000FF">endif 
    if </font><font color="#808080">(</font>tfPais<font color="#808080">:=</font><font color="#000080">fcreate</font><font color="#808080">(</font>ARQ_PAIS<font color="#808080">,</font>FC_NORMAL<font color="#808080">)) = -</font><font color="#FF0000">1
     </font><font color="#000080">qout</font><font color="#808080">(</font>MSG_ARQCERRO<font color="#808080">+&quot; --&gt; &quot;+</font>ARQ_PAIS<font color="#808080">)
    </font><font color="#0000FF">endif 
    if </font><font color="#808080">(</font>tfProfissao<font color="#808080">:=</font><font color="#000080">fcreate</font><font color="#808080">(</font>ARQ_PROFISSAO<font color="#808080">,</font>FC_NORMAL<font color="#808080">)) = -</font><font color="#FF0000">1
     </font><font color="#000080">qout</font><font color="#808080">(</font>MSG_ARQCERRO<font color="#808080">+&quot; --&gt; &quot;+</font>ARQ_PROFISSAO<font color="#808080">)
    </font><font color="#0000FF">endif 
    if </font><font color="#808080">(</font>tfLivro<font color="#808080">:=</font><font color="#000080">fcreate</font><font color="#808080">(</font>ARQ_LIVRO<font color="#808080">,</font>FC_NORMAL<font color="#808080">)) = -</font><font color="#FF0000">1
     </font><font color="#000080">qout</font><font color="#808080">(</font>MSG_ARQCERRO<font color="#808080">+&quot; --&gt; &quot;+</font>ARQ_LIVRO<font color="#808080">)
    </font><font color="#0000FF">endif 
    if </font><font color="#808080">(</font>tfLivroAss<font color="#808080">:=</font><font color="#000080">fcreate</font><font color="#808080">(</font>ARQ_LIVASS<font color="#808080">,</font>FC_NORMAL<font color="#808080">)) = -</font><font color="#FF0000">1
     </font><font color="#000080">qout</font><font color="#808080">(</font>MSG_ARQCERRO<font color="#808080">+&quot; --&gt; &quot;+</font>ARQ_LIVASS<font color="#808080">)
    </font><font color="#0000FF">endif 
    if </font><font color="#808080">(</font>tfLivroAut<font color="#808080">:=</font><font color="#000080">fcreate</font><font color="#808080">(</font>ARQ_LIVAUT<font color="#808080">,</font>FC_NORMAL<font color="#808080">)) = -</font><font color="#FF0000">1
     </font><font color="#000080">qout</font><font color="#808080">(</font>MSG_ARQCERRO<font color="#808080">+&quot; --&gt; &quot;+</font>ARQ_LIVAUT<font color="#808080">)
    </font><font color="#0000FF">endif
    if </font><font color="#808080">(</font>tfCliente<font color="#808080">:=</font><font color="#000080">fcreate</font><font color="#808080">(</font>ARQ_CLIENTE<font color="#808080">,</font>FC_NORMAL<font color="#808080">)) = -</font><font color="#FF0000">1
     </font><font color="#000080">qout</font><font color="#808080">(</font>MSG_ARQCERRO<font color="#808080">+&quot; --&gt; &quot;+</font>ARQ_CLIENTE<font color="#808080">)
    </font><font color="#0000FF">endif
    if </font><font color="#808080">(</font>tfUsuario<font color="#808080">:=</font><font color="#000080">fcreate</font><font color="#808080">(</font>ARQ_USUARIO<font color="#808080">,</font>FC_NORMAL<font color="#808080">)) = -</font><font color="#FF0000">1
     </font><font color="#000080">qout</font><font color="#808080">(</font>MSG_ARQCERRO<font color="#808080">+&quot; --&gt; &quot;+</font>ARQ_USUARIO<font color="#808080">)
    </font><font color="#0000FF">endif 
    if </font><font color="#808080">(</font>tfVenda<font color="#808080">:=</font><font color="#000080">fcreate</font><font color="#808080">(</font>ARQ_VENDA<font color="#808080">,</font>FC_NORMAL<font color="#808080">)) = -</font><font color="#FF0000">1
     </font><font color="#000080">qout</font><font color="#808080">(</font>MSG_ARQCERRO<font color="#808080">+&quot; --&gt; &quot;+</font>ARQ_VENDA<font color="#808080">)
    </font><font color="#0000FF">endif
endif
return
</font><font color="#808080"><i>/*------------------------------------------------------------------------------
Fecha todos os arquivos abertos.
------------------------------------------------------------------------------*/
</i></font><font color="#0000FF">procedure </font>fechaArqs<font color="#808080">()
  </font><font color="#000080">fclose</font><font color="#808080">(</font>tfAssunto<font color="#808080">)
  </font><font color="#000080">fclose</font><font color="#808080">(</font>tfAutor<font color="#808080">)
  </font><font color="#000080">fclose</font><font color="#808080">(</font>tfEditora<font color="#808080">)
  </font><font color="#000080">fclose</font><font color="#808080">(</font>tfIdioma<font color="#808080">)
  </font><font color="#000080">fclose</font><font color="#808080">(</font>tfEndereco<font color="#808080">)
  </font><font color="#000080">fclose</font><font color="#808080">(</font>tfPais<font color="#808080">)
  </font><font color="#000080">fclose</font><font color="#808080">(</font>tfProfissao<font color="#808080">)
  </font><font color="#000080">fclose</font><font color="#808080">(</font>tfLivro<font color="#808080">)
  </font><font color="#000080">fclose</font><font color="#808080">(</font>tfLivroAss<font color="#808080">)
  </font><font color="#000080">fclose</font><font color="#808080">(</font>tfLivroAut<font color="#808080">)
  </font><font color="#000080">fclose</font><font color="#808080">(</font>tfCliente<font color="#808080">)
  </font><font color="#000080">fclose</font><font color="#808080">(</font>tfUsuario<font color="#808080">)
  </font><font color="#000080">fclose</font><font color="#808080">(</font>tfVenda<font color="#808080">)
</font><font color="#0000FF">return
</font><font color="#808080"><i>/*------------------------------------------------------------------------------
Pesquisa um registro atrav&eacute;s de um valor chave num arquivo.
sArq - o arquivo
sChave - a chave a ser pesquisada
nPosChave - a posicao inicial da chave dentro do registro
nTamChave - o tamanho da chave dentro do registro
nTamLinha - o tamanho do registro
retorna - o registro pesquisado
------------------------------------------------------------------------------*/
</i></font><font color="#0000FF">function </font>pesqArq<font color="#808080">(</font>sArq<font color="#808080">, </font>sChave<font color="#808080">, </font>nPosChave<font color="#808080">, </font>nTamChave<font color="#808080">, </font>nTamLinha<font color="#808080">)
</font><font color="#0000FF">local </font>spesqArq<font color="#808080">, </font>sres<font color="#808080">, </font>bQuebra<font color="#808080">, </font>nStatus<font color="#808080">, </font>nPosicao<font color="#808080">, </font>nler<font color="#808080">, </font>slinha

nler<font color="#808080">:=</font>nTamLinha <font color="#808080">+ </font>TAM_CRLF
slinha<font color="#808080">:=</font><font color="#000080">space</font><font color="#808080">(</font>nler<font color="#808080">)
</font>bQuebra<font color="#808080">:=.</font>f<font color="#808080">.
</font><font color="#000080">fseek</font><font color="#808080">(</font>sArq<font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font>FS_SET<font color="#808080">)
</font><font color="#0000FF">do while </font><font color="#808080">(!</font>fimArq<font color="#808080">(</font>sArq<font color="#808080">)) .</font>and<font color="#808080">. (</font>bQuebra<font color="#808080">=.</font>f<font color="#808080">.) 
  </font><font color="#000080">fread</font><font color="#808080">(</font>sArq<font color="#808080">, @</font>slinha<font color="#808080">, </font>nler<font color="#808080">)
  </font>sres<font color="#808080">:=</font><font color="#000080">alltrim</font><font color="#808080">(</font><font color="#000080">substr</font><font color="#808080">(</font>slinha<font color="#808080">,</font>nPosChave<font color="#808080">,</font>nTamChave<font color="#808080">))
  </font><font color="#0000FF">if </font>sres <font color="#808080">== </font>sChave
     bQuebra<font color="#808080">:=.</font>t<font color="#808080">.
  </font><font color="#0000FF">endif
enddo
</font>nPosicao<font color="#808080">:=</font><font color="#000080">fseek</font><font color="#808080">(</font>sArq<font color="#808080">,</font><font color="#FF0000">0</font><font color="#808080">,</font>FS_RELATIVE<font color="#808080">)-(</font>nTamLinha <font color="#808080">+ </font>TAM_CRLF<font color="#808080">)
</font><font color="#0000FF">if </font>nPosicao <font color="#808080">&gt; </font><font color="#FF0000">0
   </font><font color="#000080">fseek</font><font color="#808080">(</font>sArq<font color="#808080">, </font>nPosicao<font color="#808080">, </font>FS_SET<font color="#808080">)
</font><font color="#0000FF">else
   </font><font color="#000080">fseek</font><font color="#808080">(</font>sArq<font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font>FS_SET<font color="#808080">)
</font><font color="#0000FF">endif
if </font>sres<font color="#808080">==</font>sChave
   spesqArq<font color="#808080">:=</font><font color="#000080">substr</font><font color="#808080">(</font>slinha<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font>nTamLinha<font color="#808080">)
</font><font color="#0000FF">else
   </font>spesqArq<font color="#808080">:=&quot;&quot;
</font><font color="#0000FF">endif
return</font><font color="#808080">(</font>spesqArq<font color="#808080">)
<i>/*------------------------------------------------------------------------------
Pesquisa se tem linha exclu&iacute;da sen&atilde;o vai para a &uacute;ltima linha do arquivo.
sArq - o arquivo
nTamLinha - o tamanho do registro
------------------------------------------------------------------------------*/
</i></font><font color="#0000FF">procedure </font>pesqLinhaExcluida<font color="#808080">(</font>sArq<font color="#808080">, </font>nTamLinha<font color="#808080">)
</font><font color="#0000FF">local </font>sExcluido

sExcluido<font color="#808080">:=</font>pesqArq<font color="#808080">(</font>sArq<font color="#808080">, &quot;*&quot;, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font>nTamLinha<font color="#808080">)
</font><font color="#0000FF">if </font><font color="#000080">empty</font><font color="#808080">(</font>sExcluido<font color="#808080">)
   </font><font color="#000080">fseek</font><font color="#808080">(</font>sArq<font color="#808080">, </font>tamArq<font color="#808080">(</font>sArq<font color="#808080">), </font>FS_SET<font color="#808080">)
</font><font color="#0000FF">endif
return
</font><font color="#808080"><i>/*------------------------------------------------------------------------------
Pesquisa o maior c&oacute;digo num arquivo.
sArq - o arquivo
nPosChave - a posicao inicial da chave dentro do registro
nTamChave - o tamanho da chave dentro do registro
nTamLinha - o tamanho do registro
retorna - o maior c&oacute;digo
------------------------------------------------------------------------------*/
</i></font><font color="#0000FF">function </font>pesqMaxCod<font color="#808080">(</font>sArq<font color="#808080">, </font>nPosChave<font color="#808080">, </font>nTamChave<font color="#808080">, </font>nTamLinha<font color="#808080">)
</font><font color="#0000FF">local </font>slinha<font color="#808080">, </font>sRes<font color="#808080">, </font>nler
<font color="#0000FF">local </font>bQuebra<font color="#808080">, </font>nStatus<font color="#808080">, </font>nMaior<font color="#808080">, </font>nCod

nler<font color="#808080">:=</font>nTamLinha <font color="#808080">+ </font>TAM_CRLF
slinha<font color="#808080">:=</font><font color="#000080">space</font><font color="#808080">(</font>nler<font color="#808080">)
</font>bQuebra<font color="#808080">:=.</font>f<font color="#808080">.
</font>nMaior<font color="#808080">:=</font><font color="#FF0000">0
</font><font color="#000080">fseek</font><font color="#808080">(</font>sArq<font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font>FS_SET<font color="#808080">)
</font><font color="#0000FF">do while </font><font color="#808080">(!</font>fimArq<font color="#808080">(</font>sArq<font color="#808080">)) .</font>and<font color="#808080">. (</font>bQuebra<font color="#808080">=.</font>f<font color="#808080">.) 
  </font><font color="#000080">fread</font><font color="#808080">(</font>sArq<font color="#808080">, @</font>slinha<font color="#808080">, </font>nler<font color="#808080">)
  </font>sres<font color="#808080">:=</font><font color="#000080">alltrim</font><font color="#808080">(</font><font color="#000080">substr</font><font color="#808080">(</font>slinha<font color="#808080">,</font>nPosChave<font color="#808080">,</font>nTamChave<font color="#808080">))
  </font>ncod<font color="#808080">:=</font><font color="#000080">Val</font><font color="#808080">(</font>sres<font color="#808080">)
  </font><font color="#0000FF">if </font>nCod <font color="#808080">&gt; </font>nMaior
     nMaior<font color="#808080">:=</font>nCod
  <font color="#0000FF">endif
enddo
</font>pesqLinhaExcluida<font color="#808080">(</font>sArq<font color="#808080">, </font>nTamLinha<font color="#808080">)
</font>sres<font color="#808080">:=</font><font color="#000080">alltrim</font><font color="#808080">(</font><font color="#000080">str</font><font color="#808080">(</font>nMaior<font color="#808080">+</font><font color="#FF0000">1</font><font color="#808080">))
</font><font color="#0000FF">return</font><font color="#808080">(</font>sres<font color="#808080">)
<i>/*------------------------------------------------------------------------------
Grava os registros num determinado arquivo.
sArq - o arquivo
sTexto - o registro a ser gravado
sMsgAcerto - a mensagem caso o registro foi gravado
sMsgErro - a mensagem caso o registro n&atilde;o foi gravado
------------------------------------------------------------------------------*/
</i></font><font color="#0000FF">procedure </font>escreveArq<font color="#808080">(</font>sArq<font color="#808080">,</font>sTexto<font color="#808080">, </font>sMsgAcerto<font color="#808080">, </font>sMsgErro<font color="#808080">)

</font>sTexto<font color="#808080">:=</font>sTexto<font color="#808080">+</font>CRLF
<font color="#0000FF">if </font><font color="#000080">fwrite</font><font color="#808080">(</font>sArq<font color="#808080">, </font>sTexto<font color="#808080">, </font><font color="#000080">len</font><font color="#808080">(</font>sTexto<font color="#808080">)) = </font><font color="#000080">len</font><font color="#808080">(</font>sTexto<font color="#808080">)
   </font><font color="#000080">qout</font><font color="#808080">(</font>sMsgAcerto<font color="#808080">)
</font><font color="#0000FF">else 
   </font><font color="#000080">qout</font><font color="#808080">(</font>sMsgErro<font color="#808080">)
</font><font color="#0000FF">endif
return

</font><font color="#808080"><i>/*--- Rotinas de implementa&ccedil;&atilde;o do sistema e de interface ----------------------*/

/*------------------------------------------------------------------------------
Monta o tamanho do registro no arquivo de acordo com o tipo de arquivo.
sreg - o tipo de arquivo
retorna - o registro montado
------------------------------------------------------------------------------*/
</i></font><font color="#0000FF">function </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">)
</font><font color="#0000FF">local </font>slinha

slinha<font color="#808080">:=&quot;&quot;
</font><font color="#0000FF">if </font>sreg <font color="#808080">= </font>opAssunto
   slinha<font color="#808080">:=</font>esp<font color="#808080">(</font>tAssunto_codigo<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">)+</font>esp<font color="#808080">(</font>tAssunto_assunto<font color="#808080">,</font><font color="#FF0000">30</font><font color="#808080">)
</font><font color="#0000FF">elseif </font>sreg <font color="#808080">= </font>opAutor
   slinha<font color="#808080">:=</font>esp<font color="#808080">(</font>tAutor_codigo<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">)+</font>esp<font color="#808080">(</font>tAutor_autor<font color="#808080">,</font><font color="#FF0000">30</font><font color="#808080">)
</font><font color="#0000FF">elseif </font>sreg <font color="#808080">= </font>opEditora
   slinha<font color="#808080">:=</font>esp<font color="#808080">(</font>tEditora_codigo<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">)+</font>esp<font color="#808080">(</font>tEditora_editora<font color="#808080">,</font><font color="#FF0000">50</font><font color="#808080">)
</font><font color="#0000FF">elseif </font>sreg <font color="#808080">= </font>opEndereco
   slinha<font color="#808080">:=</font>esp<font color="#808080">(</font>tEnd_codigo<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">)+</font>esp<font color="#808080">(</font>tEnd_logradouro<font color="#808080">,</font><font color="#FF0000">40</font><font color="#808080">)+;
   </font>esp<font color="#808080">(</font>tEnd_bairro<font color="#808080">,</font><font color="#FF0000">15</font><font color="#808080">)+</font>esp<font color="#808080">(</font>tEnd_cep<font color="#808080">,</font><font color="#FF0000">8</font><font color="#808080">)+</font>esp<font color="#808080">(</font>tEnd_cidade<font color="#808080">,</font><font color="#FF0000">30</font><font color="#808080">)+;
   </font>esp<font color="#808080">(</font>tEnd_estado<font color="#808080">,</font><font color="#FF0000">20</font><font color="#808080">)
</font><font color="#0000FF">elseif </font>sreg <font color="#808080">= </font>opIdioma
   slinha<font color="#808080">:=</font>esp<font color="#808080">(</font>tIdioma_codigo<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">)+</font>esp<font color="#808080">(</font>tIdioma_idioma<font color="#808080">,</font><font color="#FF0000">20</font><font color="#808080">)
</font><font color="#0000FF">elseif </font>sreg <font color="#808080">= </font>opPais
   slinha<font color="#808080">:=</font>esp<font color="#808080">(</font>tPais_codigo<font color="#808080">,</font><font color="#FF0000">3</font><font color="#808080">)+</font>esp<font color="#808080">(</font>tPais_pais<font color="#808080">,</font><font color="#FF0000">50</font><font color="#808080">)
</font><font color="#0000FF">elseif </font>sreg <font color="#808080">= </font>opProfissao
   slinha<font color="#808080">:=</font>esp<font color="#808080">(</font>tProfiss_codigo<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">)+</font>esp<font color="#808080">(</font>tProfiss_profissao<font color="#808080">,</font><font color="#FF0000">50</font><font color="#808080">)
</font><font color="#0000FF">elseif </font>sreg <font color="#808080">= </font>opUsuario
   slinha<font color="#808080">:=</font>esp<font color="#808080">(</font>tUsuario_login<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">)+</font>esp<font color="#808080">(</font>tUsuario_senha<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">)
</font><font color="#0000FF">elseif </font>sreg <font color="#808080">= </font>opLivro
   slinha<font color="#808080">:=</font>esp<font color="#808080">(</font>tLiv_isbn<font color="#808080">,</font><font color="#FF0000">13</font><font color="#808080">)+</font>esp<font color="#808080">(</font>tLiv_titulo<font color="#808080">,</font><font color="#FF0000">50</font><font color="#808080">)+</font>esp<font color="#808080">(</font>tLiv_edicao<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">)+;
   </font>esp<font color="#808080">(</font>tLiv_anopubli<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">)+</font>esp<font color="#808080">(</font>tLiv_codeditora<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">)+</font>esp<font color="#808080">(</font>tLiv_volume<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">)+;
   </font>esp<font color="#808080">(</font>tLiv_codidioma<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">)+</font>esp<font color="#808080">(</font>tLiv_npaginas<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">)+</font>esp<font color="#808080">(</font>tLiv_preco<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">)+;
   </font>esp<font color="#808080">(</font>tLiv_qtdestoque<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">)
</font><font color="#0000FF">elseif </font>sreg <font color="#808080">= </font>opLivroAss
   slinha<font color="#808080">:=</font>esp<font color="#808080">(</font>tLivAss_isbn<font color="#808080">,</font><font color="#FF0000">13</font><font color="#808080">)+</font>esp<font color="#808080">(</font>tLivAss_codassunto<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">)
</font><font color="#0000FF">elseif </font>sreg <font color="#808080">= </font>opLivroAut
   slinha<font color="#808080">:=</font>esp<font color="#808080">(</font>tLivAut_isbn<font color="#808080">,</font><font color="#FF0000">13</font><font color="#808080">)+</font>esp<font color="#808080">(</font>tLivAut_codautor<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">)
</font><font color="#0000FF">elseif </font>sreg <font color="#808080">= </font>opCliente
   slinha<font color="#808080">:=</font>esp<font color="#808080">(</font>tCli_cpf<font color="#808080">,</font><font color="#FF0000">14</font><font color="#808080">)+</font>esp<font color="#808080">(</font>tCli_nome<font color="#808080">,</font><font color="#FF0000">30</font><font color="#808080">)+</font>esp<font color="#808080">(</font>tCli_email<font color="#808080">,</font><font color="#FF0000">30</font><font color="#808080">)+;
   </font>esp<font color="#808080">(</font>tCli_identidade<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">)+</font>esp<font color="#808080">(</font>tCli_sexo<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">)+</font>esp<font color="#808080">(</font>tCli_telefone<font color="#808080">,</font><font color="#FF0000">17</font><font color="#808080">)+;
   </font>esp<font color="#808080">(</font>tCli_dtnascimento<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">)+</font>esp<font color="#808080">(</font>tCli_codendereco<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">)+;
   </font>esp<font color="#808080">(</font>tCli_codpais<font color="#808080">,</font><font color="#FF0000">3</font><font color="#808080">)+</font>esp<font color="#808080">(</font>tCli_codprofissao<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">)
</font><font color="#0000FF">elseif </font>sreg <font color="#808080">= </font>opVenda
   slinha<font color="#808080">:=</font>esp<font color="#808080">(</font>tVenda_dthrvenda<font color="#808080">,</font><font color="#FF0000">19</font><font color="#808080">)+</font>esp<font color="#808080">(</font>tVenda_cpf<font color="#808080">,</font><font color="#FF0000">14</font><font color="#808080">)+</font>esp<font color="#808080">(</font>tVenda_isbn<font color="#808080">,</font><font color="#FF0000">13</font><font color="#808080">)+;
   </font>esp<font color="#808080">(</font>tVenda_precovenda<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">)
</font><font color="#0000FF">endif
return</font><font color="#808080">(</font>slinha<font color="#808080">)
<i>/*------------------------------------------------------------------------------
Retorna o tamanho do registro no arquivo de acordo com o tipo de arquivo.
sreg - o tipo de arquivo
retorna - o tamanho do registro
------------------------------------------------------------------------------*/
</i></font><font color="#0000FF">function </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">)
</font><font color="#0000FF">local </font>nret

nret<font color="#808080">:=</font><font color="#FF0000">0
</font><font color="#0000FF">if </font>sreg <font color="#808080">= </font>opAssunto 
   nret<font color="#808080">:=</font>TAM_ASSUNTO
<font color="#0000FF">elseif </font>sreg <font color="#808080">= </font>opAutor 
   nret<font color="#808080">:=</font>TAM_AUTOR
<font color="#0000FF">elseif </font>sreg <font color="#808080">= </font>opEditora 
   nret<font color="#808080">:=</font>TAM_EDITORA
<font color="#0000FF">elseif </font>sreg <font color="#808080">= </font>opEndereco 
   nret<font color="#808080">:=</font>TAM_ENDERECO
<font color="#0000FF">elseif </font>sreg <font color="#808080">= </font>opIdioma 
   nret<font color="#808080">:=</font>TAM_IDIOMA
<font color="#0000FF">elseif </font>sreg <font color="#808080">= </font>opPais 
   nret<font color="#808080">:=</font>TAM_PAIS
<font color="#0000FF">elseif </font>sreg <font color="#808080">= </font>opProfissao 
   nret<font color="#808080">:=</font>TAM_PROFISSAO
<font color="#0000FF">elseif </font>sreg <font color="#808080">= </font>opUsuario 
   nret<font color="#808080">:=</font>TAM_USUARIO
<font color="#0000FF">elseif </font>sreg <font color="#808080">= </font>opLivro 
   nret<font color="#808080">:=</font>TAM_LIVRO
<font color="#0000FF">elseif </font>sreg <font color="#808080">= </font>opLivroAss 
   nret<font color="#808080">:=</font>TAM_LIVASS
<font color="#0000FF">elseif </font>sreg <font color="#808080">= </font>opLivroAut 
   nret<font color="#808080">:=</font>TAM_LIVAUT
<font color="#0000FF">elseif </font>sreg <font color="#808080">= </font>opCliente 
   nret<font color="#808080">:=</font>TAM_CLIENTE
<font color="#0000FF">elseif </font>sreg <font color="#808080">= </font>opVenda 
   nret<font color="#808080">:=</font>TAM_VENDA
<font color="#0000FF">endif
return</font><font color="#808080">(</font>nret<font color="#808080">)
<i>/*------------------------------------------------------------------------------
Seleciona o rotulo de cada campo de acordo com o tipo de arquivo.
sreg - o tipo de arquivo
nNum - indica qual rotulo ser&aacute; retornado
retorna - o rotulo
------------------------------------------------------------------------------*/
</i></font><font color="#0000FF">function </font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font>nNum<font color="#808080">)
</font><font color="#0000FF">local </font>sret

sret<font color="#808080">:=&quot;&quot;
</font><font color="#0000FF">if </font>sreg <font color="#808080">= </font>opAssunto 
   <font color="#0000FF">do case
     case </font>nNum <font color="#808080">= </font><font color="#FF0000">0 
       </font>sret<font color="#808080">:=&quot;</font>Assunto<font color="#808080">(</font>s<font color="#808080">) </font>n<font color="#808080">&atilde;</font>o encontrado<font color="#808080">(</font>s<font color="#808080">)!&quot;
     </font><font color="#0000FF">case </font>nNum <font color="#808080">= </font><font color="#FF0000">1
         </font>sret<font color="#808080">:=&quot;</font>C<font color="#808080">&oacute;</font>digo <font color="#0000FF">do </font>assunto<font color="#808080">: &quot;
         </font>g_nPosChave<font color="#808080">:=</font><font color="#FF0000">1
         </font>g_nTamChave<font color="#808080">:=</font><font color="#FF0000">10
     </font><font color="#0000FF">case </font>nNum <font color="#808080">= </font><font color="#FF0000">2
         </font>sret<font color="#808080">:=&quot;</font>Assunto<font color="#808080">: &quot;
         </font>g_nPosChave<font color="#808080">:=</font><font color="#FF0000">11
         </font>g_nTamChave<font color="#808080">:=</font><font color="#FF0000">30
   </font><font color="#0000FF">endcase
elseif </font>sreg <font color="#808080">= </font>opAutor
   <font color="#0000FF">do case
     case </font>nNum <font color="#808080">= </font><font color="#FF0000">0 
        </font>sret<font color="#808080">:=&quot;</font>Autor<font color="#808080">(</font>es<font color="#808080">) </font>n<font color="#808080">&atilde;</font>o encontrado<font color="#808080">(</font>s<font color="#808080">)!&quot;
     </font><font color="#0000FF">case </font>nNum <font color="#808080">= </font><font color="#FF0000">1 
         </font>sret<font color="#808080">:=&quot;</font>C<font color="#808080">&oacute;</font>digo <font color="#0000FF">do </font>autor<font color="#808080">: &quot;
         </font>g_nPosChave<font color="#808080">:=</font><font color="#FF0000">1
         </font>g_nTamChave<font color="#808080">:=</font><font color="#FF0000">10
     </font><font color="#0000FF">case </font>nNum <font color="#808080">= </font><font color="#FF0000">2
         </font>sret<font color="#808080">:=&quot;</font>Autor<font color="#808080">: &quot;
         </font>g_nPosChave<font color="#808080">:=</font><font color="#FF0000">11
         </font>g_nTamChave<font color="#808080">:=</font><font color="#FF0000">30
   </font><font color="#0000FF">endcase
elseif </font>sreg <font color="#808080">= </font>opEditora 
   <font color="#0000FF">do case
     case </font>nNum <font color="#808080">= </font><font color="#FF0000">0 
         </font>sret<font color="#808080">:=&quot;</font>Editora<font color="#808080">(</font>s<font color="#808080">) </font>n<font color="#808080">&atilde;</font>o encontrada<font color="#808080">(</font>s<font color="#808080">)!&quot;
     </font><font color="#0000FF">case </font>nNum <font color="#808080">= </font><font color="#FF0000">1 
         </font>sret<font color="#808080">:=&quot;</font>C<font color="#808080">&oacute;</font>digo da editora<font color="#808080">: &quot;
         </font>g_nPosChave<font color="#808080">:=</font><font color="#FF0000">1
         </font>g_nTamChave<font color="#808080">:=</font><font color="#FF0000">10
     </font><font color="#0000FF">case </font>nNum <font color="#808080">= </font><font color="#FF0000">2 
         </font>sret<font color="#808080">:=&quot;</font>Editora<font color="#808080">: &quot;
         </font>g_nPosChave<font color="#808080">:=</font><font color="#FF0000">11
         </font>g_nTamChave<font color="#808080">:=</font><font color="#FF0000">50
   </font><font color="#0000FF">endcase
elseif </font>sreg <font color="#808080">= </font>opEndereco 
   <font color="#0000FF">do case
     case </font>nNum <font color="#808080">= </font><font color="#FF0000">0 
       </font>sret<font color="#808080">:=&quot;</font>Endere<font color="#808080">&ccedil;</font>o<font color="#808080">(</font>s<font color="#808080">) </font>n<font color="#808080">&atilde;</font>o encontrado<font color="#808080">(</font>s<font color="#808080">)!&quot;
     </font><font color="#0000FF">case </font>nNum <font color="#808080">= </font><font color="#FF0000">1
         </font>sret<font color="#808080">:=&quot;</font>C<font color="#808080">&oacute;</font>digo <font color="#0000FF">do </font>endere<font color="#808080">&ccedil;</font>o<font color="#808080">: &quot;
         </font>g_nPosChave<font color="#808080">:=</font><font color="#FF0000">1
         </font>g_nTamChave<font color="#808080">:=</font><font color="#FF0000">10
     </font><font color="#0000FF">case </font>nNum <font color="#808080">= </font><font color="#FF0000">2
         </font>sret<font color="#808080">:=&quot;</font>Logradouro<font color="#808080">: &quot;
         </font>g_nPosChave<font color="#808080">:=</font><font color="#FF0000">11
         </font>g_nTamChave<font color="#808080">:=</font><font color="#FF0000">40
     </font><font color="#0000FF">case </font>nNum <font color="#808080">= </font><font color="#FF0000">3
         </font>sret<font color="#808080">:=&quot;</font>Bairro<font color="#808080">: &quot;
         </font>g_nPosChave<font color="#808080">:=</font><font color="#FF0000">51
         </font>g_nTamChave<font color="#808080">:=</font><font color="#FF0000">15
     </font><font color="#0000FF">case </font>nNum <font color="#808080">= </font><font color="#FF0000">4
         </font>sret<font color="#808080">:=&quot;</font>CEP<font color="#808080">: &quot;
         </font>g_nPosChave<font color="#808080">:=</font><font color="#FF0000">66
         </font>g_nTamChave<font color="#808080">:=</font><font color="#FF0000">8
     </font><font color="#0000FF">case </font>nNum <font color="#808080">= </font><font color="#FF0000">5
         </font>sret<font color="#808080">:=&quot;</font>Cidade<font color="#808080">: &quot;
         </font>g_nPosChave<font color="#808080">:=</font><font color="#FF0000">74
         </font>g_nTamChave<font color="#808080">:=</font><font color="#FF0000">30
     </font><font color="#0000FF">case </font>nNum <font color="#808080">= </font><font color="#FF0000">6
         </font>sret<font color="#808080">:=&quot;</font>Estado<font color="#808080">: &quot;
         </font>g_nPosChave<font color="#808080">:=</font><font color="#FF0000">104
         </font>g_nTamChave<font color="#808080">:=</font><font color="#FF0000">20
   </font><font color="#0000FF">endcase
elseif </font>sreg <font color="#808080">= </font>opIdioma 
   <font color="#0000FF">do case
     case </font>nNum <font color="#808080">= </font><font color="#FF0000">0
         </font>sret<font color="#808080">:=&quot;</font>Idioma<font color="#808080">(</font>s<font color="#808080">) </font>n<font color="#808080">&atilde;</font>o encontrado<font color="#808080">(</font>s<font color="#808080">)!&quot;
     </font><font color="#0000FF">case </font>nNum <font color="#808080">= </font><font color="#FF0000">1 
         </font>sret<font color="#808080">:=&quot;</font>C<font color="#808080">&oacute;</font>digo <font color="#0000FF">do </font>idioma<font color="#808080">: &quot;
         </font>g_nPosChave<font color="#808080">:=</font><font color="#FF0000">1
         </font>g_nTamChave<font color="#808080">:=</font><font color="#FF0000">10
     </font><font color="#0000FF">case </font>nNum <font color="#808080">= </font><font color="#FF0000">2 
         </font>sret<font color="#808080">:=&quot;</font>Idioma<font color="#808080">: &quot;
         </font>g_nPosChave<font color="#808080">:=</font><font color="#FF0000">11
         </font>g_nTamChave<font color="#808080">:=</font><font color="#FF0000">20
   </font><font color="#0000FF">endcase
elseif </font>sreg <font color="#808080">= </font>opPais 
   <font color="#0000FF">do case
     case </font>nNum <font color="#808080">= </font><font color="#FF0000">0
         </font>sret<font color="#808080">:=&quot;</font>Pa<font color="#808080">&iacute;</font>s<font color="#808080">(</font>es<font color="#808080">) </font>n<font color="#808080">&atilde;</font>o encontrado<font color="#808080">(</font>s<font color="#808080">)!&quot;
     </font><font color="#0000FF">case </font>nNum <font color="#808080">= </font><font color="#FF0000">1 
         </font>sret<font color="#808080">:=&quot;</font>C<font color="#808080">&oacute;</font>digo <font color="#0000FF">do </font>pa<font color="#808080">&iacute;</font>s<font color="#808080">: &quot;
         </font>g_nPosChave<font color="#808080">:=</font><font color="#FF0000">1
         </font>g_nTamChave<font color="#808080">:=</font><font color="#FF0000">3
     </font><font color="#0000FF">case </font>nNum <font color="#808080">= </font><font color="#FF0000">2 
         </font>sret<font color="#808080">:=&quot;</font>Pa<font color="#808080">&iacute;</font>s<font color="#808080">: &quot;
         </font>g_nPosChave<font color="#808080">:=</font><font color="#FF0000">4
         </font>g_nTamChave<font color="#808080">:=</font><font color="#FF0000">50
   </font><font color="#0000FF">endcase
elseif </font>sreg <font color="#808080">= </font>opProfissao 
   <font color="#0000FF">do case
     case </font>nNum <font color="#808080">= </font><font color="#FF0000">0
         </font>sret<font color="#808080">:=&quot;</font>Profiss<font color="#808080">&atilde;</font>o<font color="#808080">(</font>es<font color="#808080">) </font>n<font color="#808080">&atilde;</font>o encontrada<font color="#808080">(</font>s<font color="#808080">)!&quot;
     </font><font color="#0000FF">case </font>nNum <font color="#808080">= </font><font color="#FF0000">1 
         </font>sret<font color="#808080">:=&quot;</font>C<font color="#808080">&oacute;</font>digo da profiss<font color="#808080">&atilde;</font>o<font color="#808080">: &quot;
         </font>g_nPosChave<font color="#808080">:=</font><font color="#FF0000">1
         </font>g_nTamChave<font color="#808080">:=</font><font color="#FF0000">10
     </font><font color="#0000FF">case </font>nNum <font color="#808080">= </font><font color="#FF0000">2 
         </font>sret<font color="#808080">:=&quot;</font>Profiss<font color="#808080">&atilde;</font>o<font color="#808080">: &quot;
         </font>g_nPosChave<font color="#808080">:=</font><font color="#FF0000">11
         </font>g_nTamChave<font color="#808080">:=</font><font color="#FF0000">50
   </font><font color="#0000FF">endcase
elseif </font>sreg <font color="#808080">= </font>opUsuario 
   <font color="#0000FF">do case
     case </font>nNum <font color="#808080">= </font><font color="#FF0000">0
         </font>sret<font color="#808080">:=&quot;</font>login ou senha incorreta<font color="#808080">, </font>tente de novo<font color="#808080">!&quot;
     </font><font color="#0000FF">case </font>nNum <font color="#808080">= </font><font color="#FF0000">1
         </font>sret<font color="#808080">:=&quot;</font>Login<font color="#808080">: &quot;
         </font>g_nPosChave<font color="#808080">:=</font><font color="#FF0000">1
         </font>g_nTamChave<font color="#808080">:=</font><font color="#FF0000">10
     </font><font color="#0000FF">case </font>nNum <font color="#808080">= </font><font color="#FF0000">2 
         </font>sret<font color="#808080">:=&quot;</font>Senha<font color="#808080">: &quot;
         </font>g_nPosChave<font color="#808080">:=</font><font color="#FF0000">11
         </font>g_nTamChave<font color="#808080">:=</font><font color="#FF0000">10
   </font><font color="#0000FF">endcase
elseif </font>sreg <font color="#808080">= </font>opLivro 
   <font color="#0000FF">do case
     case </font>nNum <font color="#808080">= </font><font color="#FF0000">0
         </font>sret<font color="#808080">:=&quot;</font>Livro<font color="#808080">(</font>s<font color="#808080">) </font>n<font color="#808080">&atilde;</font>o encontrado<font color="#808080">(</font>s<font color="#808080">)!&quot;
     </font><font color="#0000FF">case </font>nNum <font color="#808080">= </font><font color="#FF0000">1 
         </font>sret<font color="#808080">:=&quot;</font>ISBN<font color="#808080">: &quot;
         </font>g_nPosChave<font color="#808080">:=</font><font color="#FF0000">1
         </font>g_nTamChave<font color="#808080">:=</font><font color="#FF0000">13
     </font><font color="#0000FF">case </font>nNum <font color="#808080">= </font><font color="#FF0000">2
         </font>sret<font color="#808080">:=&quot;</font>T<font color="#808080">&iacute;</font>tulo<font color="#808080">: &quot;
         </font>g_nPosChave<font color="#808080">:=</font><font color="#FF0000">14
         </font>g_nTamChave<font color="#808080">:=</font><font color="#FF0000">50
     </font><font color="#0000FF">case </font>nNum <font color="#808080">= </font><font color="#FF0000">3
         </font>sret<font color="#808080">:=&quot;</font>Edi<font color="#808080">&ccedil;&atilde;</font>o<font color="#808080">: &quot;
         </font>g_nPosChave<font color="#808080">:=</font><font color="#FF0000">64
         </font>g_nTamChave<font color="#808080">:=</font><font color="#FF0000">10
     </font><font color="#0000FF">case </font>nNum <font color="#808080">= </font><font color="#FF0000">4 
         </font>sret<font color="#808080">:=&quot;</font>Ano de Publica<font color="#808080">&ccedil;&atilde;</font>o<font color="#808080">: &quot;
         </font>g_nPosChave<font color="#808080">:=</font><font color="#FF0000">74
         </font>g_nTamChave<font color="#808080">:=</font><font color="#FF0000">10
     </font><font color="#0000FF">case </font>nNum <font color="#808080">= </font><font color="#FF0000">5 
         </font>sret<font color="#808080">:=&quot;</font>C<font color="#808080">&oacute;</font>digo da editora<font color="#808080">: &quot;
         </font>g_nPosChave<font color="#808080">:=</font><font color="#FF0000">84
         </font>g_nTamChave<font color="#808080">:=</font><font color="#FF0000">10
     </font><font color="#0000FF">case </font>nNum <font color="#808080">= </font><font color="#FF0000">6 
         </font>sret<font color="#808080">:=&quot;</font>Volume<font color="#808080">: &quot;
         </font>g_nPosChave<font color="#808080">:=</font><font color="#FF0000">94
         </font>g_nTamChave<font color="#808080">:=</font><font color="#FF0000">10
     </font><font color="#0000FF">case </font>nNum <font color="#808080">= </font><font color="#FF0000">7 
         </font>sret<font color="#808080">:=&quot;</font>C<font color="#808080">&oacute;</font>digo <font color="#0000FF">do </font>idioma<font color="#808080">: &quot;
         </font>g_nPosChave<font color="#808080">:=</font><font color="#FF0000">104
         </font>g_nTamChave<font color="#808080">:=</font><font color="#FF0000">10
     </font><font color="#0000FF">case </font>nNum <font color="#808080">= </font><font color="#FF0000">8 
         </font>sret<font color="#808080">:=&quot;</font>N<font color="#808080">&uacute;</font>mero de p<font color="#808080">&aacute;</font>ginas<font color="#808080">: &quot;
         </font>g_nPosChave<font color="#808080">:=</font><font color="#FF0000">114
         </font>g_nTamChave<font color="#808080">:=</font><font color="#FF0000">10
     </font><font color="#0000FF">case </font>nNum <font color="#808080">= </font><font color="#FF0000">9 
         </font>sret<font color="#808080">:=&quot;</font>Pre<font color="#808080">&ccedil;</font>o<font color="#808080">: &quot;
         </font>g_nPosChave<font color="#808080">:=</font><font color="#FF0000">124
         </font>g_nTamChave<font color="#808080">:=</font><font color="#FF0000">10
     </font><font color="#0000FF">case </font>nNum <font color="#808080">= </font><font color="#FF0000">10 
          </font>sret<font color="#808080">:=&quot;</font>Qtd<font color="#808080">. </font>Estoque<font color="#808080">: &quot;
          </font>g_nPosChave<font color="#808080">:=</font><font color="#FF0000">134
          </font>g_nTamChave<font color="#808080">:=</font><font color="#FF0000">10
   </font><font color="#0000FF">endcase
elseif </font>sreg <font color="#808080">= </font>opLivroAss 
   <font color="#0000FF">do case
     case </font>nNum <font color="#808080">= </font><font color="#FF0000">0
         </font>sret<font color="#808080">:=&quot;</font>Assunto<font color="#808080">(</font>s<font color="#808080">) </font>n<font color="#808080">&atilde;</font>o encontrado<font color="#808080">(</font>s<font color="#808080">)!&quot;
     </font><font color="#0000FF">case </font>nNum <font color="#808080">= </font><font color="#FF0000">1 
         </font>sret<font color="#808080">:=&quot;</font>ISBN<font color="#808080">: &quot;
         </font>g_nPosChave<font color="#808080">:=</font><font color="#FF0000">1
         </font>g_nTamChave<font color="#808080">:=</font><font color="#FF0000">13
     </font><font color="#0000FF">case </font>nNum <font color="#808080">= </font><font color="#FF0000">2 
         </font>sret<font color="#808080">:=&quot;</font>C<font color="#808080">&oacute;</font>digo <font color="#0000FF">do </font>assunto<font color="#808080">: &quot;
         </font>g_nPosChave<font color="#808080">:=</font><font color="#FF0000">14
         </font>g_nTamChave<font color="#808080">:=</font><font color="#FF0000">10
   </font><font color="#0000FF">endcase
elseif </font>sreg <font color="#808080">= </font>opLivroAut
   <font color="#0000FF">do case
     case </font>nNum <font color="#808080">= </font><font color="#FF0000">0
         </font>sret<font color="#808080">:=&quot;</font>Autor<font color="#808080">(</font>s<font color="#808080">) </font>n<font color="#808080">&atilde;</font>o encontrado<font color="#808080">(</font>s<font color="#808080">)!&quot;
     </font><font color="#0000FF">case </font>nNum <font color="#808080">= </font><font color="#FF0000">1 
         </font>sret<font color="#808080">:=&quot;</font>ISBN<font color="#808080">: &quot;
         </font>g_nPosChave<font color="#808080">:=</font><font color="#FF0000">1
         </font>g_nTamChave<font color="#808080">:=</font><font color="#FF0000">13
     </font><font color="#0000FF">case </font>nNum <font color="#808080">= </font><font color="#FF0000">2 
         </font>sret<font color="#808080">:=&quot;</font>C<font color="#808080">&oacute;</font>digo <font color="#0000FF">do </font>autor<font color="#808080">: &quot;
         </font>g_nPosChave<font color="#808080">:=</font><font color="#FF0000">14
         </font>g_nTamChave<font color="#808080">:=</font><font color="#FF0000">10
   </font><font color="#0000FF">endcase
elseif </font>sreg <font color="#808080">= </font>opCliente 
   <font color="#0000FF">do case
     case </font>nNum <font color="#808080">= </font><font color="#FF0000">0
         </font>sret<font color="#808080">:=&quot;</font>Cliente<font color="#808080">(</font>s<font color="#808080">) </font>n<font color="#808080">&atilde;</font>o encontrado<font color="#808080">(</font>s<font color="#808080">)!&quot;
     </font><font color="#0000FF">case </font>nNum <font color="#808080">= </font><font color="#FF0000">1 
         </font>sret<font color="#808080">:=&quot;</font>CPF<font color="#808080">: &quot;
         </font>g_nPosChave<font color="#808080">:=</font><font color="#FF0000">1
         </font>g_nTamChave<font color="#808080">:=</font><font color="#FF0000">14
     </font><font color="#0000FF">case </font>nNum <font color="#808080">= </font><font color="#FF0000">2 
         </font>sret<font color="#808080">:=&quot;</font>Nome<font color="#808080">: &quot;
         </font>g_nPosChave<font color="#808080">:=</font><font color="#FF0000">15
         </font>g_nTamChave<font color="#808080">:=</font><font color="#FF0000">30
     </font><font color="#0000FF">case </font>nNum <font color="#808080">= </font><font color="#FF0000">3
         </font>sret<font color="#808080">:=&quot;</font>E<font color="#808080">-</font>mail<font color="#808080">: &quot;
         </font>g_nPosChave<font color="#808080">:=</font><font color="#FF0000">45
         </font>g_nTamChave<font color="#808080">:=</font><font color="#FF0000">30
     </font><font color="#0000FF">case </font>nNum <font color="#808080">= </font><font color="#FF0000">4 
         </font>sret<font color="#808080">:=&quot;</font>Identidade<font color="#808080">: &quot;
         </font>g_nPosChave<font color="#808080">:=</font><font color="#FF0000">75
         </font>g_nTamChave<font color="#808080">:=</font><font color="#FF0000">10
     </font><font color="#0000FF">case </font>nNum <font color="#808080">= </font><font color="#FF0000">5 
         </font>sret<font color="#808080">:=&quot;</font>Sexo<font color="#808080">: &quot;
         </font>g_nPosChave<font color="#808080">:=</font><font color="#FF0000">85
         </font>g_nTamChave<font color="#808080">:=</font><font color="#FF0000">1
     </font><font color="#0000FF">case </font>nNum <font color="#808080">= </font><font color="#FF0000">6 
         </font>sret<font color="#808080">:=&quot;</font>Telefone<font color="#808080">: &quot;
         </font>g_nPosChave<font color="#808080">:=</font><font color="#FF0000">86
         </font>g_nTamChave<font color="#808080">:=</font><font color="#FF0000">17
     </font><font color="#0000FF">case </font>nNum <font color="#808080">= </font><font color="#FF0000">7 
         </font>sret<font color="#808080">:=&quot;</font>Dt<font color="#808080">. </font>Nascimento<font color="#808080">: &quot;
         </font>g_nPosChave<font color="#808080">:=</font><font color="#FF0000">103
         </font>g_nTamChave<font color="#808080">:=</font><font color="#FF0000">10
     </font><font color="#0000FF">case </font>nNum <font color="#808080">= </font><font color="#FF0000">8 
         </font>sret<font color="#808080">:=&quot;</font>C<font color="#808080">&oacute;</font>digo <font color="#0000FF">do </font>endere<font color="#808080">&ccedil;</font>o<font color="#808080">: &quot;
         </font>g_nPosChave<font color="#808080">:=</font><font color="#FF0000">113
         </font>g_nTamChave<font color="#808080">:=</font><font color="#FF0000">10
     </font><font color="#0000FF">case </font>nNum <font color="#808080">= </font><font color="#FF0000">9 
         </font>sret<font color="#808080">:=&quot;</font>C<font color="#808080">&oacute;</font>digo <font color="#0000FF">do </font>pa<font color="#808080">&iacute;</font>s<font color="#808080">: &quot;
         </font>g_nPosChave<font color="#808080">:=</font><font color="#FF0000">123
         </font>g_nTamChave<font color="#808080">:=</font><font color="#FF0000">3
     </font><font color="#0000FF">case </font>nNum <font color="#808080">= </font><font color="#FF0000">10 
          </font>sret<font color="#808080">:=&quot;</font>C<font color="#808080">&oacute;</font>digo da Profiss<font color="#808080">&atilde;</font>o<font color="#808080">: &quot;
          </font>g_nPosChave<font color="#808080">:=</font><font color="#FF0000">126
          </font>g_nTamChave<font color="#808080">:=</font><font color="#FF0000">10
   </font><font color="#0000FF">endcase
elseif </font>sreg <font color="#808080">= </font>opVenda 
   <font color="#0000FF">do case
     case </font>nNum <font color="#808080">= </font><font color="#FF0000">0
         </font>sret<font color="#808080">:=&quot;</font>Venda<font color="#808080">(</font>s<font color="#808080">) </font>n<font color="#808080">&atilde;</font>o encontrada<font color="#808080">(</font>s<font color="#808080">)!&quot;
     </font><font color="#0000FF">case </font>nNum <font color="#808080">= </font><font color="#FF0000">1
         </font>sret<font color="#808080">:=&quot;</font>Data<font color="#808080">/</font>Hora venda<font color="#808080">: &quot;
         </font>g_nPosChave<font color="#808080">:=</font><font color="#FF0000">1
         </font>g_nTamChave<font color="#808080">:=</font><font color="#FF0000">19
     </font><font color="#0000FF">case </font>nNum <font color="#808080">= </font><font color="#FF0000">2
         </font>sret<font color="#808080">:=&quot;</font>CPF<font color="#808080">: &quot;
         </font>g_nPosChave<font color="#808080">:=</font><font color="#FF0000">20
         </font>g_nTamChave<font color="#808080">:=</font><font color="#FF0000">14
     </font><font color="#0000FF">case </font>nNum <font color="#808080">= </font><font color="#FF0000">3
         </font>sret<font color="#808080">:=&quot;</font>ISBN<font color="#808080">: &quot;
         </font>g_nPosChave<font color="#808080">:=</font><font color="#FF0000">34
         </font>g_nTamChave<font color="#808080">:=</font><font color="#FF0000">13
     </font><font color="#0000FF">case </font>nNum <font color="#808080">= </font><font color="#FF0000">4
         </font>sret<font color="#808080">:=&quot;</font>Pre<font color="#808080">+</font>o de venda<font color="#808080">: &quot;
         </font>g_nPosChave<font color="#808080">:=</font><font color="#FF0000">47
         </font>g_nTamChave<font color="#808080">:=</font><font color="#FF0000">10
   </font><font color="#0000FF">endcase
endif

return</font><font color="#808080">(</font>sret<font color="#808080">)
<i>/*------------------------------------------------------------------------------
Indica se continua ou n&atilde;o mostrando um n&uacute;mero m&aacute;ximo de linhas.
nlinha - a linha a ser continuada
nQtdLinha - a quantidade de linhas a serem mostradas
retorna - se continua ou n&atilde;o
------------------------------------------------------------------------------*/
</i></font><font color="#0000FF">function </font>ContinuaSN<font color="#808080">(</font>nlinha<font color="#808080">, </font>nQtdLinha<font color="#808080">)
</font><font color="#0000FF">local </font>bSOp<font color="#808080">, </font>bret<font color="#808080">, </font>opCSubMenu

bret<font color="#808080">:=.</font>f<font color="#808080">.
</font><font color="#0000FF">if </font>nlinha <font color="#808080">&gt; </font><font color="#FF0000">0 
  </font><font color="#0000FF">if </font><font color="#808080">(</font>nlinha <font color="#808080">% </font>nQtdLinha<font color="#808080">) = </font><font color="#FF0000">0 
    </font>bSOp<font color="#808080">:=.</font>t<font color="#808080">.
    </font><font color="#0000FF">do while</font><font color="#808080">(</font>bSOp<font color="#808080">)      
       </font><font color="#0000FF">accept menu</font><font color="#808080">(</font><font color="#FF0000">13</font><font color="#808080">) </font><font color="#0000FF">to </font>opCSubMenu
       <font color="#0000FF">if </font><font color="#808080">(</font>opCSubMenu<font color="#808080">=&quot;</font>S<font color="#808080">&quot;) .</font>or<font color="#808080">. (</font>opCSubMenu<font color="#808080">=&quot;</font>s<font color="#808080">&quot;) 
          </font>bSOp<font color="#808080">:=.</font>f<font color="#808080">.
       </font><font color="#0000FF">elseif </font><font color="#808080">(</font>opCSubMenu<font color="#808080">=&quot;</font>N<font color="#808080">&quot;) .</font>or<font color="#808080">. (</font>opCSubMenu<font color="#808080">=&quot;</font>n<font color="#808080">&quot;) 
          </font>bret<font color="#808080">:=.</font>t<font color="#808080">.
          </font>bSOp<font color="#808080">:=.</font>f<font color="#808080">.
       </font><font color="#0000FF">else 
          </font><font color="#000080">qout</font><font color="#808080">(</font>MSG_ERRO<font color="#808080">)
       </font><font color="#0000FF">endif
    enddo
  endif
endif

return</font><font color="#808080">(</font>bret<font color="#808080">)
<i>/*------------------------------------------------------------------------------
Lista v&aacute;rios registros de acordo com a pesquisa feita.
sArq - o arquivo
sreg - o tipo de arquivo
sChave - a chave a ser pesquisada
nPosChave - a posicao inicial da chave dentro do registro
nTamChave - o tamanho da chave dentro do registro
nTamLinha - o tamanho do registro
nQtdLinha - a quantidade de linhas a serem mostradas
retorna - se encontrou algum registro
------------------------------------------------------------------------------*/
</i></font><font color="#0000FF">function </font>ListarTodos<font color="#808080">(</font>sArq<font color="#808080">, </font>sreg<font color="#808080">, </font>sChave<font color="#808080">,;
   </font>nPosChave<font color="#808080">, </font>nTamChave<font color="#808080">, </font>nTamLinha<font color="#808080">, </font>nQtdLinha<font color="#808080">, </font>bPesqRelativa<font color="#808080">)
</font><font color="#0000FF">local </font>slinha<font color="#808080">, </font>bQuebra<font color="#808080">, </font>bAchou<font color="#808080">, </font>bRet
<font color="#0000FF">local </font>nStatus<font color="#808080">, </font>nCont<font color="#808080">, </font>sres<font color="#808080">, </font>nler

nler<font color="#808080">:=</font>nTamLinha <font color="#808080">+ </font>TAM_CRLF
slinha<font color="#808080">:=</font><font color="#000080">space</font><font color="#808080">(</font>nler<font color="#808080">)
</font>bRet<font color="#808080">:=.</font>f<font color="#808080">.
</font>bQuebra<font color="#808080">:=.</font>f<font color="#808080">.
</font>nCont<font color="#808080">:=</font><font color="#FF0000">0
</font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, &quot;&quot;, </font><font color="#FF0000">2</font><font color="#808080">)
</font><font color="#000080">fseek</font><font color="#808080">(</font>sArq<font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font>FS_SET<font color="#808080">)
</font><font color="#0000FF">do while </font><font color="#808080">(!</font>fimArq<font color="#808080">(</font>sArq<font color="#808080">)) .</font>and<font color="#808080">. (</font>bQuebra<font color="#808080">=.</font>f<font color="#808080">.) 
  </font><font color="#000080">fread</font><font color="#808080">(</font>sArq<font color="#808080">, @</font>slinha<font color="#808080">, </font>nler<font color="#808080">)
  </font><font color="#0000FF">if </font>bPesqRelativa 
    sres<font color="#808080">:=</font><font color="#000080">alltrim</font><font color="#808080">(</font><font color="#000080">substr</font><font color="#808080">(</font>slinha<font color="#808080">,</font>nPosChave<font color="#808080">,</font>nTamChave<font color="#808080">))
    </font><font color="#0000FF">if </font>strRelativa<font color="#808080">(</font>sres<font color="#808080">,</font>sChave<font color="#808080">) 
       </font>bAchou<font color="#808080">:=.</font>t<font color="#808080">.
       </font>bRet<font color="#808080">:=.</font>t<font color="#808080">.
    </font><font color="#0000FF">else
       </font>bAchou<font color="#808080">:=.</font>f<font color="#808080">.
    </font><font color="#0000FF">endif 
  else
    </font>bAchou<font color="#808080">:=.</font>t<font color="#808080">.
    </font>bRet<font color="#808080">:=.</font>t<font color="#808080">.
  </font><font color="#0000FF">endif

  if </font>bAchou
    mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#000080">substr</font><font color="#808080">(</font>slinha<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font>nTamLinha<font color="#808080">), </font><font color="#FF0000">3</font><font color="#808080">)
    </font>nCont<font color="#808080">++
  </font><font color="#0000FF">endif

  </font>bQuebra<font color="#808080">:=</font>ContinuaSN<font color="#808080">(</font>nCont<font color="#808080">, </font>nQtdLinha<font color="#808080">)
</font><font color="#0000FF">enddo
return</font><font color="#808080">(</font>bret<font color="#808080">)
<i>/*------------------------------------------------------------------------------
Lista v&aacute;rios registros entre arquivos de acordo com a pesquisa feita.
sArq1 - o arquivo de liga&ccedil;&atilde;o
sreg1 - o tipo de arquivo de liga&ccedil;&atilde;o
nPosChave1 - a posicao inicial da primeira chave no arquivo de liga&ccedil;&atilde;o
nTamChave1 - o tamanho da primeira chave no arquivo de liga&ccedil;&atilde;o
nPosChave2 - a posicao inicial da segunda chave do arquivo de liga&ccedil;&atilde;o
nTamChave2 - o tamanho da segunda chave do arquivo de liga&ccedil;&atilde;o
sChave - a chave a ser pesquisada no arquivo de liga&ccedil;&atilde;o
sArq2 - o arquivo a ser pesquisado
sreg2 - o tipo de arquivo a ser pesquisado
nPosChave3 - a posicao inicial da chave do arquivo pesquisado
nQtdLinha - a quantidade de linhas a serem mostradas
------------------------------------------------------------------------------*/
</i></font><font color="#0000FF">procedure </font>ListarRegLigados<font color="#808080">(</font>sArq1<font color="#808080">, </font>sreg1<font color="#808080">, </font>nPosChave1<font color="#808080">,;
</font>nTamChave1<font color="#808080">, </font>nPosChave2<font color="#808080">, </font>nTamChave2<font color="#808080">, </font>sChave<font color="#808080">,;
</font>sArq2<font color="#808080">, </font>sreg2<font color="#808080">, </font>nPosChave3<font color="#808080">, </font>nQtdLinha<font color="#808080">)
</font><font color="#0000FF">local </font>slinha1<font color="#808080">, </font>bQuebra<font color="#808080">, </font>bRet<font color="#808080">, </font>nler
<font color="#0000FF">local </font>nStatus<font color="#808080">, </font>nCont<font color="#808080">, </font>sCodigo1<font color="#808080">, </font>sCodigo2<font color="#808080">, </font>slinha2

nler<font color="#808080">:=</font>tamReg<font color="#808080">(</font>sreg1<font color="#808080">) + </font>TAM_CRLF
slinha1<font color="#808080">:=</font><font color="#000080">space</font><font color="#808080">(</font>nler<font color="#808080">)
</font>bRet<font color="#808080">:=.</font>f<font color="#808080">.
</font>nCont<font color="#808080">:=</font><font color="#FF0000">0
</font>bQuebra<font color="#808080">:=.</font>f<font color="#808080">.
</font>mostrarDados<font color="#808080">(</font>sreg2<font color="#808080">, &quot;&quot;, </font><font color="#FF0000">2</font><font color="#808080">)
</font><font color="#000080">fseek</font><font color="#808080">(</font>sArq1<font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font>FS_SET<font color="#808080">)
</font><font color="#0000FF">do while </font><font color="#808080">(!</font>fimArq<font color="#808080">(</font>sArq1<font color="#808080">)) .</font>and<font color="#808080">. (</font>bQuebra<font color="#808080">=.</font>f<font color="#808080">.) 
  </font><font color="#000080">fread</font><font color="#808080">(</font>sArq1<font color="#808080">, @</font>slinha1<font color="#808080">, </font>nler<font color="#808080">)
  </font>sCodigo1<font color="#808080">:=</font><font color="#000080">alltrim</font><font color="#808080">(</font><font color="#000080">substr</font><font color="#808080">(</font>slinha1<font color="#808080">,</font>nPosChave1<font color="#808080">,</font>nTamChave1<font color="#808080">))
  </font><font color="#0000FF">if </font>sCodigo1<font color="#808080">==</font>sChave 
    sCodigo2<font color="#808080">:=</font><font color="#000080">alltrim</font><font color="#808080">(</font><font color="#000080">substr</font><font color="#808080">(</font>slinha1<font color="#808080">,</font>nPosChave2<font color="#808080">,</font>nTamChave2<font color="#808080">))
    </font>slinha2<font color="#808080">:=</font>pesqArq<font color="#808080">(</font>sArq2<font color="#808080">, </font>sCodigo2<font color="#808080">, </font>nPosChave3<font color="#808080">, </font>nTamChave2<font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg2<font color="#808080">))
    </font>mostrarDados<font color="#808080">(</font>sreg2<font color="#808080">, </font><font color="#000080">substr</font><font color="#808080">(</font>slinha2<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg2<font color="#808080">)), </font><font color="#FF0000">3</font><font color="#808080">)
    </font>bRet<font color="#808080">:=.</font>t<font color="#808080">.
    </font>nCont<font color="#808080">++
  </font><font color="#0000FF">endif
  </font>bQuebra<font color="#808080">:=</font>ContinuaSN<font color="#808080">(</font>nCont<font color="#808080">, </font>nQtdLinha<font color="#808080">)
</font><font color="#0000FF">enddo
if </font>bRet<font color="#808080">=.</font>f<font color="#808080">.
   </font><font color="#000080">qout</font><font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg2<font color="#808080">,</font><font color="#FF0000">0</font><font color="#808080">))
</font><font color="#0000FF">endif
return
</font><font color="#808080"><i>/*------------------------------------------------------------------------------
Valida a entrada de registros de acordo com a pesquisa feita.
sArq - o arquivo
sreg - o tipo de arquivo
nTexto - o numero do r&oacute;tulo da entrada
sEntrada - a chave a ser pesquisada e validada
nTentativas - o n&uacute;mero m&aacute;ximo de tentativas
bPesqRelativa - indica se vai realizar uma pesquisa relativa
bTipoEntrada - indica o tipo de entrada
retorna - o registro pesquisado e validado
------------------------------------------------------------------------------*/
</i></font><font color="#0000FF">function </font>validaEntrada<font color="#808080">(</font>sArq<font color="#808080">, </font>sreg<font color="#808080">, </font>nTexto<font color="#808080">,;
        </font>sEntrada<font color="#808080">, </font>nTentativas<font color="#808080">, </font>bPesqRelativa<font color="#808080">, </font>bTipoEntrada<font color="#808080">)
</font><font color="#0000FF">local </font>bQuebra<font color="#808080">, </font>sres<font color="#808080">, </font>sTexto<font color="#808080">, </font>sMsgErro
<font color="#0000FF">local </font>ncont<font color="#808080">, </font>nPosChave<font color="#808080">, </font>nTamChave<font color="#808080">, </font>nTamLinha

nTamLinha<font color="#808080">:=</font>tamReg<font color="#808080">(</font>sreg<font color="#808080">)
</font>sMsgErro<font color="#808080">:=</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">,</font><font color="#FF0000">0</font><font color="#808080">)
</font>sTexto<font color="#808080">:=</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">,</font>nTexto<font color="#808080">)
</font>nPosChave<font color="#808080">:=</font>g_nPosChave
nTamChave<font color="#808080">:=</font>g_nTamChave

ncont<font color="#808080">:=</font><font color="#FF0000">1
</font>bQuebra<font color="#808080">:=.</font>f<font color="#808080">.
  </font><font color="#0000FF">do while </font><font color="#808080">(</font>bQuebra<font color="#808080">=.</font>f<font color="#808080">.) .</font>and<font color="#808080">. (</font>ncont <font color="#808080">&lt;= </font>nTentativas <font color="#808080">)
    </font><font color="#0000FF">if </font>bTipoEntrada <font color="#808080">= </font>opTexto 
      <font color="#0000FF">accept </font>sTexto <font color="#0000FF">to </font>sEntrada
    <font color="#0000FF">elseif </font>bTipoEntrada <font color="#808080">= </font>opNumero
       sEntrada<font color="#808080">:=</font>validaNumero<font color="#808080">(</font>sTexto<font color="#808080">,</font>sEntrada<font color="#808080">)
    </font><font color="#0000FF">elseif </font>bTipoEntrada <font color="#808080">= </font>opData
       sEntrada<font color="#808080">:=</font>validaDataHora<font color="#808080">(</font>sTexto<font color="#808080">,</font>sEntrada<font color="#808080">,.</font>t<font color="#808080">.)
    </font><font color="#0000FF">elseif </font>bTipoEntrada <font color="#808080">= </font>opDataHora
       sEntrada<font color="#808080">:=</font>validaDataHora<font color="#808080">(</font>sTexto<font color="#808080">,</font>sEntrada<font color="#808080">,.</font>f<font color="#808080">.)
    </font><font color="#0000FF">elseif </font>bTipoEntrada <font color="#808080">= </font>opSenha
       sEntrada<font color="#808080">:=</font>digitaSenha<font color="#808080">(</font>sTexto<font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">)
    </font><font color="#0000FF">endif

    if </font>bPesqRelativa 
       <font color="#0000FF">if </font>ListarTodos<font color="#808080">(</font>sArq<font color="#808080">, </font>sreg<font color="#808080">, </font>sEntrada<font color="#808080">, </font>nPosChave<font color="#808080">, </font>nTamChave<font color="#808080">,;
          </font>nTamLinha<font color="#808080">, </font>QTD_MAX_LINHA<font color="#808080">, .</font>t<font color="#808080">.)
          </font>sres<font color="#808080">:=&quot;</font><font color="#FF0000">0</font><font color="#808080">&quot;
       </font><font color="#0000FF">endif
    else
       </font>sres<font color="#808080">:=</font>pesqArq<font color="#808080">(</font>sArq<font color="#808080">, </font>sEntrada<font color="#808080">, </font>nPosChave<font color="#808080">, </font>nTamChave<font color="#808080">, </font>nTamLinha<font color="#808080">)
    </font><font color="#0000FF">endif

    if </font><font color="#000080">empty</font><font color="#808080">(</font>sres<font color="#808080">)
       </font><font color="#000080">qout</font><font color="#808080">(</font>sMsgErro<font color="#808080">)
    </font><font color="#0000FF">else
       </font>bQuebra<font color="#808080">:=.</font>t<font color="#808080">.
    </font><font color="#0000FF">endif
     
    </font>ncont<font color="#808080">++
  </font><font color="#0000FF">enddo
return</font><font color="#808080">(</font>sres<font color="#808080">)
<i>/*------------------------------------------------------------------------------
Mostra a tela de splash do sistema.
------------------------------------------------------------------------------*/
</i></font><font color="#0000FF">procedure </font>frmSplash<font color="#808080">()
</font><font color="#0000FF">local </font>cont

 <font color="#000080">qout</font><font color="#808080">(&quot;*---------------------------------------&quot;+;
 &quot;-------------------------------------*&quot;)
 </font><font color="#000080">qout</font><font color="#808080">(&quot;| </font>LL    II VV   VV RRRRR  UU  UU   SSSS <font color="#808080">&quot;+;
 &quot;</font>VV   VV II RRRRR  TTTT UU  UU   SSSS <font color="#808080">|&quot;)
 </font><font color="#000080">qout</font><font color="#808080">(&quot;| </font>LL    II  VV VV  RR   R UU  UU  SS    <font color="#808080">&quot;+;
 &quot; </font>VV VV  II RR   R  TT  UU  UU  SS    <font color="#808080">|&quot;)
 </font><font color="#000080">qout</font><font color="#808080">(&quot;| </font>LL    II   VVV   RRRRR  UU  UU    SS  <font color="#808080">&quot;+;
 &quot;  </font>VVV   II RRRRR   TT  UU  UU    SS  <font color="#808080">|&quot;)
 </font><font color="#000080">qout</font><font color="#808080">(&quot;| </font>LLLLL II    V    RR   R  UUUU  SSSS   <font color="#808080">&quot;+;
 &quot;   </font>V    II RR   R  TT   UUUU  SSSS   <font color="#808080">|&quot;)
 </font><font color="#000080">qout</font><font color="#808080">(&quot;*---------------------------------------&quot;+;
 &quot;-------------------------------------*&quot;)
 </font><font color="#0000FF">for </font>cont<font color="#808080">:=</font><font color="#FF0000">1 </font><font color="#0000FF">to </font><font color="#FF0000">18 
   </font><font color="#000080">qout</font><font color="#808080">()
 </font><font color="#0000FF">next
 </font><font color="#000080">qqout</font><font color="#808080">(</font>MSG_PRESS<font color="#808080">)
 </font><font color="#000080">inkey</font><font color="#808080">(</font><font color="#FF0000">0</font><font color="#808080">)
</font><font color="#0000FF">return
</font><font color="#808080"><i>/*------------------------------------------------------------------------------
Mostra a tela de sobre do sistema.
------------------------------------------------------------------------------*/
</i></font><font color="#0000FF">procedure </font>frmSobre<font color="#808080">()
</font><font color="#0000FF">local </font>cont

 <font color="#000080">qout</font><font color="#808080">(&quot;*------------------------------------------------------------*&quot;)
 </font><font color="#000080">qout</font><font color="#808080">(&quot;|  </font>LL        II  VV       VV  RRRRRRR   UU    UU   SSSSSSS   <font color="#808080">|&quot;)
 </font><font color="#000080">qout</font><font color="#808080">(&quot;|  </font>LL        II   VV     VV   RR     R  UU    UU  SS         <font color="#808080">|&quot;)
 </font><font color="#000080">qout</font><font color="#808080">(&quot;|  </font>LL        II    VV   VV    RR     R  UU    UU   SSSS      <font color="#808080">|&quot;)
 </font><font color="#000080">qout</font><font color="#808080">(&quot;|  </font>LL        II     VV VV     RRRRRRR   UU    UU     SSSS    <font color="#808080">|&quot;)
 </font><font color="#000080">qout</font><font color="#808080">(&quot;|  </font>LLLL      II      VVV      RR RR     UU    UU        SS   <font color="#808080">|&quot;)
 </font><font color="#000080">qout</font><font color="#808080">(&quot;|  </font>LLLLLLLL  II       V       RR   RR    UUUUUU   SSSSSSSS   <font color="#808080">|&quot;)
 </font><font color="#000080">qout</font><font color="#808080">(&quot;|                                                            |&quot;)
 </font><font color="#000080">qout</font><font color="#808080">(&quot;|  </font>VV       VV  II  RRRRRRR   TTTTTTTT  UU    UU   SSSSSSS   <font color="#808080">|&quot;)
 </font><font color="#000080">qout</font><font color="#808080">(&quot;|   </font>VV     VV   II  RR     R     TT     UU    UU  SS         <font color="#808080">|&quot;)
 </font><font color="#000080">qout</font><font color="#808080">(&quot;|    </font>VV   VV    II  RR     R     TT     UU    UU   SSSS      <font color="#808080">|&quot;)
 </font><font color="#000080">qout</font><font color="#808080">(&quot;|     </font>VV VV     II  RRRRRRR      TT     UU    UU     SSSS    <font color="#808080">|&quot;)
 </font><font color="#000080">qout</font><font color="#808080">(&quot;|      </font>VVV      II  RR RR        TT     UU    UU        SS   <font color="#808080">|&quot;)
 </font><font color="#000080">qout</font><font color="#808080">(&quot;|       </font>V       II  RR   RR      TT      UUUUUU   SSSSSSSS   <font color="#808080">|&quot;)
 </font><font color="#000080">qout</font><font color="#808080">(&quot;|                                                            |&quot;)
 </font><font color="#000080">qout</font><font color="#808080">(&quot;|                                               </font>Versao <font color="#FF0000">1.0.0 </font><font color="#808080">|&quot;)
 </font><font color="#000080">qout</font><font color="#808080">(&quot;| </font>Sistema integrante <font color="#0000FF">do </font>projeto Livrus Virtus<font color="#808080">.               |&quot;)
 </font><font color="#000080">qout</font><font color="#808080">(&quot;| </font>Todos <font color="#000080">os </font>direitos reservados para Henrique F<font color="#808080">. </font>de Souza<font color="#808080">.    |&quot;)
 </font><font color="#000080">qout</font><font color="#808080">(&quot;| </font>Versao programada na linguagem clipper<font color="#808080">.                    |&quot;)
 </font><font color="#000080">qout</font><font color="#808080">(&quot;*------------------------------------------------------------*&quot;)
 </font><font color="#0000FF">for </font>cont<font color="#808080">:=</font><font color="#FF0000">1 </font><font color="#0000FF">to </font><font color="#FF0000">4 
   </font><font color="#000080">qout</font><font color="#808080">()
 </font><font color="#0000FF">next
 </font><font color="#000080">qqout</font><font color="#808080">(</font>MSG_PRESS<font color="#808080">)
 </font><font color="#000080">inkey</font><font color="#808080">(</font><font color="#FF0000">0</font><font color="#808080">)
</font><font color="#0000FF">return
</font><font color="#808080"><i>/*------------------------------------------------------------------------------
Mostra a tela de login do sistema.
retorna - se o login foi validado corretamente
------------------------------------------------------------------------------*/
</i></font><font color="#0000FF">function </font>frmLogin<font color="#808080">()
</font><font color="#0000FF">local </font>bret<font color="#808080">, </font>slinha

  bret<font color="#808080">:=.</font>f<font color="#808080">.
  </font><font color="#000080">qout</font><font color="#808080">(&quot;*--------------------------------------------------------------*&quot;)
  </font><font color="#000080">qout</font><font color="#808080">(&quot;| </font>Login <font color="#0000FF">do </font>sistema                                             <font color="#808080">|&quot;)
  </font><font color="#000080">qout</font><font color="#808080">(&quot;*--------------------------------------------------------------*&quot;)
  </font>slinha<font color="#808080">:=</font>validaEntrada<font color="#808080">(</font>tfUsuario<font color="#808080">, </font>opUsuario<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font>tUsuario_login<font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">,;
        .</font>f<font color="#808080">., </font>opTexto<font color="#808080">)
  </font><font color="#0000FF">if </font><font color="#808080">!</font><font color="#000080">empty</font><font color="#808080">(</font>slinha<font color="#808080">)
     </font>slinha<font color="#808080">:=</font>validaEntrada<font color="#808080">(</font>tfUsuario<font color="#808080">, </font>opUsuario<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">, </font>tUsuario_senha<font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">,;
        .</font>f<font color="#808080">., </font>opSenha<font color="#808080">)
     </font><font color="#0000FF">if </font><font color="#808080">!</font><font color="#000080">empty</font><font color="#808080">(</font>slinha<font color="#808080">)
        </font>tUsuario_login<font color="#808080">:=</font><font color="#000080">alltrim</font><font color="#808080">(</font><font color="#000080">substr</font><font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">))
        </font>tUsuario_senha<font color="#808080">:=</font><font color="#000080">alltrim</font><font color="#808080">(</font><font color="#000080">substr</font><font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">11</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">))
        </font>bret<font color="#808080">:=.</font>t<font color="#808080">.
     </font><font color="#0000FF">endif
  endif
  </font><font color="#000080">qout</font><font color="#808080">()
</font><font color="#0000FF">return</font><font color="#808080">(</font>bret<font color="#808080">)
<i>/*------------------------------------------------------------------------------
Mostra os menus do sistema.
num - o n&uacute;mero do menu
------------------------------------------------------------------------------*/
</i></font><font color="#0000FF">function menu</font><font color="#808080">(</font>num<font color="#808080">)

 </font><font color="#0000FF">if </font><font color="#808080">(</font>num<font color="#808080">=</font><font color="#FF0000">1</font><font color="#808080">) 
  </font><font color="#000080">qout</font><font color="#808080">(&quot;*--------------------------------------------------------------*&quot;)
  </font><font color="#000080">qout</font><font color="#808080">(&quot;| (</font>C<font color="#808080">)</font>adastros        <font color="#808080">(</font>P<font color="#808080">)</font>esquisas     <font color="#808080">(</font>V<font color="#808080">)</font>endas        <font color="#808080">(</font>O<font color="#808080">)</font>p<font color="#808080">&ccedil;&otilde;</font>es  <font color="#808080">|&quot;)
  </font><font color="#000080">qout</font><font color="#808080">(&quot;*--------------------------------------------------------------*&quot;)
 </font><font color="#0000FF">elseif </font><font color="#808080">(</font>num<font color="#808080">=</font><font color="#FF0000">2</font><font color="#808080">) 
   </font><font color="#000080">qout</font><font color="#808080">(&quot;*---------------------------------*&quot;)
   </font><font color="#000080">qout</font><font color="#808080">(&quot;| </font><font color="#FF0000">01. </font>Cadastro de Assuntos        <font color="#808080">|&quot;)
   </font><font color="#000080">qout</font><font color="#808080">(&quot;| </font><font color="#FF0000">02. </font>Cadastro de Autores         <font color="#808080">|&quot;)
   </font><font color="#000080">qout</font><font color="#808080">(&quot;| </font><font color="#FF0000">03. </font>Cadastro de Editoras        <font color="#808080">|&quot;)
   </font><font color="#000080">qout</font><font color="#808080">(&quot;| </font><font color="#FF0000">04. </font>Cadastro de Endere<font color="#808080">&ccedil;</font><font color="#000080">os       </font><font color="#808080">|&quot;)
   </font><font color="#000080">qout</font><font color="#808080">(&quot;| </font><font color="#FF0000">05. </font>Cadastro de Idiomas         <font color="#808080">|&quot;)
   </font><font color="#000080">qout</font><font color="#808080">(&quot;| </font><font color="#FF0000">06. </font>Cadastro de Pa<font color="#808080">&iacute;</font>ses          <font color="#808080">|&quot;)
   </font><font color="#000080">qout</font><font color="#808080">(&quot;| </font><font color="#FF0000">07. </font>Cadastro de Profiss<font color="#808080">&otilde;</font>es      <font color="#808080">|&quot;)
   </font><font color="#000080">qout</font><font color="#808080">(&quot;| </font><font color="#FF0000">08. </font>Cadastro de Clientes        <font color="#808080">|&quot;)
   </font><font color="#000080">qout</font><font color="#808080">(&quot;| </font><font color="#FF0000">09. </font>Cadastro de Livros          <font color="#808080">|&quot;)
   </font><font color="#000080">qout</font><font color="#808080">(&quot;| </font><font color="#FF0000">10. </font>Voltar ao <font color="#0000FF">menu              </font><font color="#808080">|&quot;)
   </font><font color="#000080">qout</font><font color="#808080">(&quot;*---------------------------------*&quot;)
 </font><font color="#0000FF">elseif </font><font color="#808080">(</font>num<font color="#808080">=</font><font color="#FF0000">3</font><font color="#808080">) 
   </font><font color="#000080">qout</font><font color="#808080">(&quot;*---------------------------------*&quot;)
   </font><font color="#000080">qout</font><font color="#808080">(&quot;| </font><font color="#FF0000">01. </font>Consulta de Assuntos        <font color="#808080">|&quot;)
   </font><font color="#000080">qout</font><font color="#808080">(&quot;| </font><font color="#FF0000">02. </font>Consulta de Autores         <font color="#808080">|&quot;)
   </font><font color="#000080">qout</font><font color="#808080">(&quot;| </font><font color="#FF0000">03. </font>Consulta de Editoras        <font color="#808080">|&quot;)
   </font><font color="#000080">qout</font><font color="#808080">(&quot;| </font><font color="#FF0000">04. </font>Consulta de Endere<font color="#808080">&ccedil;</font><font color="#000080">os       </font><font color="#808080">|&quot;)
   </font><font color="#000080">qout</font><font color="#808080">(&quot;| </font><font color="#FF0000">05. </font>Consulta de Idiomas         <font color="#808080">|&quot;)
   </font><font color="#000080">qout</font><font color="#808080">(&quot;| </font><font color="#FF0000">06. </font>Consulta de Pa<font color="#808080">&iacute;</font>ses          <font color="#808080">|&quot;)
   </font><font color="#000080">qout</font><font color="#808080">(&quot;| </font><font color="#FF0000">07. </font>Consulta de Profiss<font color="#808080">&otilde;</font>es      <font color="#808080">|&quot;)
   </font><font color="#000080">qout</font><font color="#808080">(&quot;| </font><font color="#FF0000">08. </font>Consulta de Clientes        <font color="#808080">|&quot;)
   </font><font color="#000080">qout</font><font color="#808080">(&quot;| </font><font color="#FF0000">09. </font>Consulta de Livros          <font color="#808080">|&quot;)
   </font><font color="#000080">qout</font><font color="#808080">(&quot;| </font><font color="#FF0000">10. </font>Voltar ao <font color="#0000FF">menu              </font><font color="#808080">|&quot;)
   </font><font color="#000080">qout</font><font color="#808080">(&quot;*---------------------------------*&quot;)
 </font><font color="#0000FF">elseif </font><font color="#808080">(</font>num<font color="#808080">=</font><font color="#FF0000">4</font><font color="#808080">) 
   </font><font color="#000080">qout</font><font color="#808080">(&quot;*---------------------------------*&quot;)
   </font><font color="#000080">qout</font><font color="#808080">(&quot;| </font><font color="#FF0000">01. </font>Vender Livros               <font color="#808080">|&quot;)
   </font><font color="#000080">qout</font><font color="#808080">(&quot;| </font><font color="#FF0000">02. </font>Vendas Realizadas           <font color="#808080">|&quot;)
   </font><font color="#000080">qout</font><font color="#808080">(&quot;| </font><font color="#FF0000">03. </font>Voltar ao <font color="#0000FF">menu              </font><font color="#808080">|&quot;)
   </font><font color="#000080">qout</font><font color="#808080">(&quot;*---------------------------------*&quot;)
 </font><font color="#0000FF">elseif </font><font color="#808080">(</font>num<font color="#808080">=</font><font color="#FF0000">5</font><font color="#808080">) 
   </font><font color="#000080">qout</font><font color="#808080">(&quot;*---------------------------------*&quot;)
   </font><font color="#000080">qout</font><font color="#808080">(&quot;| </font><font color="#FF0000">01. </font>Alterar senha               <font color="#808080">|&quot;)
   </font><font color="#000080">qout</font><font color="#808080">(&quot;| </font><font color="#FF0000">02. </font>Sobre o sistema             <font color="#808080">|&quot;)
   </font><font color="#000080">qout</font><font color="#808080">(&quot;| </font><font color="#FF0000">03. </font>Sair <font color="#0000FF">do </font>sistema             <font color="#808080">|&quot;)
   </font><font color="#000080">qout</font><font color="#808080">(&quot;| </font><font color="#FF0000">04. </font>Voltar ao <font color="#0000FF">menu              </font><font color="#808080">|&quot;)
   </font><font color="#000080">qout</font><font color="#808080">(&quot;*---------------------------------*&quot;)
 </font><font color="#0000FF">elseif </font><font color="#808080">(</font>num<font color="#808080">=</font><font color="#FF0000">6</font><font color="#808080">) 
   </font><font color="#000080">qout</font><font color="#808080">(&quot;*--------------------------------------------------------------*&quot;)
   </font><font color="#000080">qout</font><font color="#808080">(&quot;| (</font><font color="#FF0000">1</font><font color="#808080">) </font>Novo  <font color="#808080">(</font><font color="#FF0000">2</font><font color="#808080">) </font>Pesquisar   <font color="#808080">(</font><font color="#FF0000">3</font><font color="#808080">) </font>Voltar ao <font color="#0000FF">menu                 </font><font color="#808080">|&quot;)
   </font><font color="#000080">qout</font><font color="#808080">(&quot;*--------------------------------------------------------------*&quot;)
 </font><font color="#0000FF">elseif </font><font color="#808080">(</font>num<font color="#808080">=</font><font color="#FF0000">7</font><font color="#808080">) 
   </font><font color="#000080">qout</font><font color="#808080">(&quot;*--------------------------------------------------------------*&quot;)
   </font><font color="#000080">qout</font><font color="#808080">(&quot;| (</font><font color="#FF0000">1</font><font color="#808080">) </font>Salvar inclus<font color="#808080">&atilde;</font>o       <font color="#808080">(</font><font color="#FF0000">2</font><font color="#808080">) </font>Voltar ao <font color="#0000FF">menu                 </font><font color="#808080">|&quot;)
   </font><font color="#000080">qout</font><font color="#808080">(&quot;*--------------------------------------------------------------*&quot;)
 </font><font color="#0000FF">elseif </font><font color="#808080">(</font>num<font color="#808080">=</font><font color="#FF0000">8</font><font color="#808080">) 
   </font><font color="#000080">qout</font><font color="#808080">(&quot;*--------------------------------------------------------------*&quot;)
   </font><font color="#000080">qout</font><font color="#808080">(&quot;| (</font><font color="#FF0000">1</font><font color="#808080">) </font>Alterar       <font color="#808080">(</font><font color="#FF0000">2</font><font color="#808080">) </font>Excluir     <font color="#808080">(</font><font color="#FF0000">3</font><font color="#808080">) </font>Voltar ao <font color="#0000FF">menu         </font><font color="#808080">|&quot;)
   </font><font color="#000080">qout</font><font color="#808080">(&quot;*--------------------------------------------------------------*&quot;)
 </font><font color="#0000FF">elseif </font><font color="#808080">(</font>num<font color="#808080">=</font><font color="#FF0000">9</font><font color="#808080">)
   </font><font color="#000080">qout</font><font color="#808080">(&quot;*--------------------------------------------------------------*&quot;)
   </font><font color="#000080">qout</font><font color="#808080">(&quot;| (</font><font color="#FF0000">1</font><font color="#808080">) </font>Salvar altera<font color="#808080">&ccedil;&atilde;</font>o      <font color="#808080">(</font><font color="#FF0000">2</font><font color="#808080">) </font>Voltar ao <font color="#0000FF">menu                 </font><font color="#808080">|&quot;)
   </font><font color="#000080">qout</font><font color="#808080">(&quot;*--------------------------------------------------------------*&quot;)
 </font><font color="#0000FF">elseif </font><font color="#808080">(</font>num<font color="#808080">=</font><font color="#FF0000">10</font><font color="#808080">) 
   </font><font color="#000080">qout</font><font color="#808080">(&quot;*--------------------------------------------------------------*&quot;)
   </font><font color="#000080">qout</font><font color="#808080">(&quot;| </font>Certeza de excluir<font color="#808080">? (</font>S<font color="#808080">/</font>N<font color="#808080">)                                    |&quot;)
   </font><font color="#000080">qout</font><font color="#808080">(&quot;*--------------------------------------------------------------*&quot;)
 </font><font color="#0000FF">elseif </font><font color="#808080">(</font>num<font color="#808080">=</font><font color="#FF0000">11</font><font color="#808080">) 
   </font><font color="#000080">qout</font><font color="#808080">(&quot;*--------------------------------------------------------------*&quot;)
   </font><font color="#000080">qout</font><font color="#808080">(&quot;| </font>Deseja sair <font color="#0000FF">do </font>sistema<font color="#808080">? (</font>S<font color="#808080">/</font>N<font color="#808080">)                                |&quot;)
   </font><font color="#000080">qout</font><font color="#808080">(&quot;*--------------------------------------------------------------*&quot;)
 </font><font color="#0000FF">elseif </font><font color="#808080">(</font>num<font color="#808080">=</font><font color="#FF0000">12</font><font color="#808080">) 
   </font><font color="#000080">qout</font><font color="#808080">(&quot;*--------------------------------------------------------------*&quot;)
   </font><font color="#000080">qout</font><font color="#808080">(&quot;| (</font><font color="#FF0000">1</font><font color="#808080">) </font>Pesquisar  <font color="#808080">(</font><font color="#FF0000">2</font><font color="#808080">) </font>Listar todos   <font color="#808080">(</font><font color="#FF0000">3</font><font color="#808080">) </font>Voltar ao <font color="#0000FF">menu         </font><font color="#808080">|&quot;)
   </font><font color="#000080">qout</font><font color="#808080">(&quot;*--------------------------------------------------------------*&quot;)
 </font><font color="#0000FF">elseif </font><font color="#808080">(</font>num<font color="#808080">=</font><font color="#FF0000">13</font><font color="#808080">) 
   </font><font color="#000080">qout</font><font color="#808080">(&quot;*--------------------------------------------------------------*&quot;)
   </font><font color="#000080">qout</font><font color="#808080">(&quot;| </font>Deseja continuar<font color="#808080">? (</font>S<font color="#808080">/</font>N<font color="#808080">)                                      |&quot;)
   </font><font color="#000080">qout</font><font color="#808080">(&quot;*--------------------------------------------------------------*&quot;)
 </font><font color="#0000FF">elseif </font><font color="#808080">(</font>num<font color="#808080">=</font><font color="#FF0000">14</font><font color="#808080">) 
   </font><font color="#000080">qout</font><font color="#808080">(&quot;*--------------------------------------------------------------*&quot;)
   </font><font color="#000080">qout</font><font color="#808080">(&quot;| </font>Salvar inclus<font color="#808080">&atilde;</font>o <font color="#808080">(</font>S<font color="#808080">/</font>N<font color="#808080">)                                        |&quot;)
   </font><font color="#000080">qout</font><font color="#808080">(&quot;*--------------------------------------------------------------*&quot;)
 </font><font color="#0000FF">endif
return</font><font color="#808080">(</font>MSG_OPCAO<font color="#808080">)
<i>/*------------------------------------------------------------------------------
Realiza os cadastros de acordo com o tipo de arquivo.
sreg - o tipo de arquivo
sacao - a a&ccedil;&atilde;o a ser realizada
------------------------------------------------------------------------------*/
</i></font><font color="#0000FF">procedure </font>frmCadastros<font color="#808080">(</font>sreg<font color="#808080">, </font>sacao<font color="#808080">)
</font><font color="#0000FF">local </font>slinha

<font color="#0000FF">if </font>sreg <font color="#808080">= </font>opAssunto 
   <font color="#0000FF">if </font>sacao <font color="#808080">= </font>opNovo 
      tAssunto_codigo<font color="#808080">:=</font>pesqMaxCod<font color="#808080">(</font>tfAssunto<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">))
      </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, &quot;&quot;, </font><font color="#FF0000">1</font><font color="#808080">)
      </font>subMenu<font color="#808080">(</font><font color="#FF0000">7</font><font color="#808080">, </font>sreg<font color="#808080">)
   </font><font color="#0000FF">elseif </font>sacao <font color="#808080">= </font>opPesquisar 
     slinha<font color="#808080">:=</font>validaEntrada<font color="#808080">(</font>tfAssunto<font color="#808080">,</font>sreg<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font>tAssunto_codigo<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,.</font>f<font color="#808080">.,</font>opNumero<font color="#808080">)
      </font><font color="#0000FF">if </font><font color="#808080">!</font><font color="#000080">empty</font><font color="#808080">(</font>slinha<font color="#808080">) 
        </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, &quot;&quot;, </font><font color="#FF0000">2</font><font color="#808080">)
        </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font>slinha<font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">)
        </font>subMenu<font color="#808080">(</font><font color="#FF0000">8</font><font color="#808080">, </font>sreg<font color="#808080">)
      </font><font color="#0000FF">endif
   elseif </font>sacao <font color="#808080">= </font>opAlterar 
      mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, &quot;&quot;, </font><font color="#FF0000">1</font><font color="#808080">)
      </font>subMenu<font color="#808080">(</font><font color="#FF0000">9</font><font color="#808080">, </font>sreg<font color="#808080">)
   </font><font color="#0000FF">elseif </font>sacao <font color="#808080">= </font>opExcluir 
      subMenu<font color="#808080">(</font><font color="#FF0000">10</font><font color="#808080">, </font>sreg<font color="#808080">)
   </font><font color="#0000FF">endif
elseif </font>sreg <font color="#808080">= </font>opAutor 
   <font color="#0000FF">if </font>sacao <font color="#808080">= </font>opNovo 
      tAutor_codigo<font color="#808080">:=</font>pesqMaxCod<font color="#808080">(</font>tfAutor<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">))
      </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, &quot;&quot;, </font><font color="#FF0000">1</font><font color="#808080">)
      </font>subMenu<font color="#808080">(</font><font color="#FF0000">7</font><font color="#808080">, </font>sreg<font color="#808080">)
   </font><font color="#0000FF">elseif </font>sacao <font color="#808080">= </font>opPesquisar 
      slinha<font color="#808080">:=</font>validaEntrada<font color="#808080">(</font>tfAutor<font color="#808080">, </font>sreg<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font>tAutor_codigo<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,.</font>f<font color="#808080">.,</font>opNumero<font color="#808080">)
      </font><font color="#0000FF">if </font><font color="#808080">!</font><font color="#000080">empty</font><font color="#808080">(</font>slinha<font color="#808080">) 
        </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, &quot;&quot;, </font><font color="#FF0000">2</font><font color="#808080">)
        </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font>slinha<font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">)
        </font>subMenu<font color="#808080">(</font><font color="#FF0000">8</font><font color="#808080">, </font>sreg<font color="#808080">)
      </font><font color="#0000FF">endif
   elseif </font>sacao <font color="#808080">= </font>opAlterar 
      mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, &quot;&quot;, </font><font color="#FF0000">1</font><font color="#808080">)
      </font>subMenu<font color="#808080">(</font><font color="#FF0000">9</font><font color="#808080">, </font>sreg<font color="#808080">)
   </font><font color="#0000FF">elseif </font>sacao <font color="#808080">= </font>opExcluir 
      subMenu<font color="#808080">(</font><font color="#FF0000">10</font><font color="#808080">, </font>sreg<font color="#808080">)
   </font><font color="#0000FF">endif
elseif </font>sreg <font color="#808080">= </font>opEditora 
   <font color="#0000FF">if </font>sacao <font color="#808080">= </font>opNovo 
      tEditora_codigo<font color="#808080">:=</font>pesqMaxCod<font color="#808080">(</font>tfEditora<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">))
      </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, &quot;&quot;, </font><font color="#FF0000">1</font><font color="#808080">)
      </font>subMenu<font color="#808080">(</font><font color="#FF0000">7</font><font color="#808080">, </font>sreg<font color="#808080">)
   </font><font color="#0000FF">elseif </font>sacao <font color="#808080">= </font>opPesquisar 
     slinha<font color="#808080">:=</font>validaEntrada<font color="#808080">(</font>tfEditora<font color="#808080">,</font>sreg<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font>tEditora_codigo<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,.</font>f<font color="#808080">.,</font>opNumero<font color="#808080">)
      </font><font color="#0000FF">if </font><font color="#808080">!</font><font color="#000080">empty</font><font color="#808080">(</font>slinha<font color="#808080">) 
        </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, &quot;&quot;, </font><font color="#FF0000">2</font><font color="#808080">)
        </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font>slinha<font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">)
        </font>subMenu<font color="#808080">(</font><font color="#FF0000">8</font><font color="#808080">, </font>sreg<font color="#808080">)
      </font><font color="#0000FF">endif
   elseif </font>sacao <font color="#808080">= </font>opAlterar 
      mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, &quot;&quot;, </font><font color="#FF0000">1</font><font color="#808080">)
      </font>subMenu<font color="#808080">(</font><font color="#FF0000">9</font><font color="#808080">, </font>sreg<font color="#808080">)
   </font><font color="#0000FF">elseif </font>sacao <font color="#808080">= </font>opExcluir 
      subMenu<font color="#808080">(</font><font color="#FF0000">10</font><font color="#808080">, </font>sreg<font color="#808080">)
   </font><font color="#0000FF">endif
elseif </font>sreg <font color="#808080">= </font>opEndereco 
   <font color="#0000FF">if </font>sacao <font color="#808080">= </font>opNovo 
      tEnd_codigo<font color="#808080">:=</font>pesqMaxCod<font color="#808080">(</font>tfEndereco<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">))
      </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, &quot;&quot;, </font><font color="#FF0000">1</font><font color="#808080">)
      </font>subMenu<font color="#808080">(</font><font color="#FF0000">7</font><font color="#808080">, </font>sreg<font color="#808080">)
   </font><font color="#0000FF">elseif </font>sacao <font color="#808080">= </font>opPesquisar 
      slinha<font color="#808080">:=</font>validaEntrada<font color="#808080">(</font>tfEndereco<font color="#808080">,</font>sreg<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font>tEnd_codigo<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,;
              .</font>f<font color="#808080">.,</font>opNumero<font color="#808080">)
      </font><font color="#0000FF">if </font><font color="#808080">!</font><font color="#000080">empty</font><font color="#808080">(</font>slinha<font color="#808080">) 
        </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, &quot;&quot;, </font><font color="#FF0000">2</font><font color="#808080">)
        </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font>slinha<font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">)
        </font>subMenu<font color="#808080">(</font><font color="#FF0000">8</font><font color="#808080">, </font>sreg<font color="#808080">)
      </font><font color="#0000FF">endif
   elseif </font>sacao <font color="#808080">= </font>opAlterar 
      mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, &quot;&quot;, </font><font color="#FF0000">1</font><font color="#808080">)
      </font>subMenu<font color="#808080">(</font><font color="#FF0000">9</font><font color="#808080">, </font>sreg<font color="#808080">)
   </font><font color="#0000FF">elseif </font>sacao <font color="#808080">= </font>opExcluir 
      subMenu<font color="#808080">(</font><font color="#FF0000">10</font><font color="#808080">, </font>sreg<font color="#808080">)
   </font><font color="#0000FF">endif
elseif </font>sreg <font color="#808080">= </font>opIdioma 
   <font color="#0000FF">if </font>sacao <font color="#808080">= </font>opNovo
      tIdioma_codigo<font color="#808080">:=</font>pesqMaxCod<font color="#808080">(</font>tfIdioma<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">))
      </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, &quot;&quot;, </font><font color="#FF0000">1</font><font color="#808080">)
      </font>subMenu<font color="#808080">(</font><font color="#FF0000">7</font><font color="#808080">, </font>sreg<font color="#808080">)
   </font><font color="#0000FF">elseif </font>sacao <font color="#808080">= </font>opPesquisar 
      slinha<font color="#808080">:=</font>validaEntrada<font color="#808080">(</font>tfIdioma<font color="#808080">,</font>sreg<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font>tIdioma_codigo<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,.</font>f<font color="#808080">.,</font>opNumero<font color="#808080">)
      </font><font color="#0000FF">if </font><font color="#808080">!</font><font color="#000080">empty</font><font color="#808080">(</font>slinha<font color="#808080">) 
        </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, &quot;&quot;, </font><font color="#FF0000">2</font><font color="#808080">)
        </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font>slinha<font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">)
        </font>subMenu<font color="#808080">(</font><font color="#FF0000">8</font><font color="#808080">, </font>sreg<font color="#808080">)
      </font><font color="#0000FF">endif
   elseif </font>sacao <font color="#808080">= </font>opAlterar 
      mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, &quot;&quot;, </font><font color="#FF0000">1</font><font color="#808080">)
      </font>subMenu<font color="#808080">(</font><font color="#FF0000">9</font><font color="#808080">, </font>sreg<font color="#808080">)
   </font><font color="#0000FF">elseif </font>sacao <font color="#808080">= </font>opExcluir 
      subMenu<font color="#808080">(</font><font color="#FF0000">10</font><font color="#808080">, </font>sreg<font color="#808080">)
   </font><font color="#0000FF">endif
elseif </font>sreg <font color="#808080">= </font>opPais 
   <font color="#0000FF">if </font>sacao <font color="#808080">= </font>opNovo 
      <font color="#0000FF">accept </font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">) </font><font color="#0000FF">to </font>tPais_codigo
      slinha<font color="#808080">:=</font>pesqArq<font color="#808080">(</font>tfPais<font color="#808080">, </font>tPais_codigo<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">))
      </font><font color="#0000FF">if </font><font color="#000080">empty</font><font color="#808080">(</font>slinha<font color="#808080">)
         </font>pesqLinhaExcluida<font color="#808080">(</font>tfPais<font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">))
         </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, &quot;&quot;, </font><font color="#FF0000">1</font><font color="#808080">)
         </font>subMenu<font color="#808080">(</font><font color="#FF0000">7</font><font color="#808080">, </font>sreg<font color="#808080">)
      </font><font color="#0000FF">else 
         </font><font color="#000080">qout</font><font color="#808080">(</font>MSG_REGEXST<font color="#808080">)
      </font><font color="#0000FF">endif
   elseif </font>sacao <font color="#808080">= </font>opPesquisar 
      slinha<font color="#808080">:=</font>validaEntrada<font color="#808080">(</font>tfPais<font color="#808080">, </font>sreg<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font>tPais_codigo<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, .</font>f<font color="#808080">., </font>opTexto<font color="#808080">)
      </font><font color="#0000FF">if </font><font color="#808080">!</font><font color="#000080">empty</font><font color="#808080">(</font>slinha<font color="#808080">) 
        </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, &quot;&quot;, </font><font color="#FF0000">2</font><font color="#808080">)
        </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font>slinha<font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">)
        </font>subMenu<font color="#808080">(</font><font color="#FF0000">8</font><font color="#808080">, </font>sreg<font color="#808080">)
      </font><font color="#0000FF">endif
   elseif </font>sacao <font color="#808080">= </font>opAlterar 
      <font color="#000080">qout</font><font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">)+ </font>tPais_codigo<font color="#808080">)
      </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, &quot;&quot;, </font><font color="#FF0000">1</font><font color="#808080">)
      </font>subMenu<font color="#808080">(</font><font color="#FF0000">9</font><font color="#808080">, </font>sreg<font color="#808080">)
   </font><font color="#0000FF">elseif </font>sacao <font color="#808080">= </font>opExcluir 
      subMenu<font color="#808080">(</font><font color="#FF0000">10</font><font color="#808080">, </font>sreg<font color="#808080">)
   </font><font color="#0000FF">endif
elseif </font>sreg <font color="#808080">= </font>opProfissao 
   <font color="#0000FF">if </font>sacao <font color="#808080">= </font>opNovo 
      tProfiss_codigo<font color="#808080">:=</font>pesqMaxCod<font color="#808080">(</font>tfProfissao<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">))
      </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, &quot;&quot;, </font><font color="#FF0000">1</font><font color="#808080">)
      </font>subMenu<font color="#808080">(</font><font color="#FF0000">7</font><font color="#808080">, </font>sreg<font color="#808080">)
   </font><font color="#0000FF">elseif </font>sacao <font color="#808080">= </font>opPesquisar 
      slinha<font color="#808080">:=</font>validaEntrada<font color="#808080">(</font>tfProfissao<font color="#808080">,</font>sreg<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font>tProfiss_codigo<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,;
              .</font>f<font color="#808080">.,</font>opNumero<font color="#808080">)
      </font><font color="#0000FF">if </font><font color="#808080">!</font><font color="#000080">empty</font><font color="#808080">(</font>slinha<font color="#808080">) 
        </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, &quot;&quot;, </font><font color="#FF0000">2</font><font color="#808080">)
        </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font>slinha<font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">)
        </font>subMenu<font color="#808080">(</font><font color="#FF0000">8</font><font color="#808080">, </font>sreg<font color="#808080">)
      </font><font color="#0000FF">endif
   elseif </font>sacao <font color="#808080">= </font>opAlterar 
      mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, &quot;&quot;, </font><font color="#FF0000">1</font><font color="#808080">)
      </font>subMenu<font color="#808080">(</font><font color="#FF0000">9</font><font color="#808080">, </font>sreg<font color="#808080">)
   </font><font color="#0000FF">elseif </font>sacao <font color="#808080">= </font>opExcluir 
      subMenu<font color="#808080">(</font><font color="#FF0000">10</font><font color="#808080">, </font>sreg<font color="#808080">)
   </font><font color="#0000FF">endif
elseif </font>sreg <font color="#808080">= </font>opLivro 
   <font color="#0000FF">if </font>sacao <font color="#808080">= </font>opNovo 
      <font color="#0000FF">accept </font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">) </font><font color="#0000FF">to </font>tLiv_isbn
      <font color="#0000FF">if </font>validaISBN<font color="#808080">(</font>tLiv_isbn<font color="#808080">) 
          </font>slinha<font color="#808080">:=</font>pesqArq<font color="#808080">(</font>tfLivro<font color="#808080">, </font>tLiv_isbn<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">13</font><font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">))
          </font><font color="#0000FF">if </font><font color="#000080">empty</font><font color="#808080">(</font>slinha<font color="#808080">)
             </font>pesqLinhaExcluida<font color="#808080">(</font>tfLivro<font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">))
             </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, &quot;&quot;, </font><font color="#FF0000">1</font><font color="#808080">)
             </font>subMenu<font color="#808080">(</font><font color="#FF0000">7</font><font color="#808080">, </font>sreg<font color="#808080">)
             </font>frmCadLigados<font color="#808080">(</font>opLivroAss<font color="#808080">, </font>opNovo<font color="#808080">, </font>tLiv_isbn<font color="#808080">)
             </font>frmCadLigados<font color="#808080">(</font>opLivroAut<font color="#808080">, </font>opNovo<font color="#808080">, </font>tLiv_isbn<font color="#808080">)
          </font><font color="#0000FF">else
             </font><font color="#000080">qout</font><font color="#808080">(</font>MSG_REGEXST<font color="#808080">)
          </font><font color="#0000FF">endif
      else 
        </font><font color="#000080">qout</font><font color="#808080">(</font>MSG_ISBNINV<font color="#808080">)
      </font><font color="#0000FF">endif
   elseif </font>sacao <font color="#808080">= </font>opPesquisar 
      slinha<font color="#808080">:=</font>validaEntrada<font color="#808080">(</font>tfLivro<font color="#808080">, </font>sreg<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font>tLiv_isbn<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">,.</font>f<font color="#808080">.,</font>opTexto<font color="#808080">)
      </font><font color="#0000FF">if </font><font color="#808080">!</font><font color="#000080">empty</font><font color="#808080">(</font>slinha<font color="#808080">) 
         </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, &quot;&quot;, </font><font color="#FF0000">2</font><font color="#808080">)
         </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font>slinha<font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">)
         </font>subMenu<font color="#808080">(</font><font color="#FF0000">8</font><font color="#808080">, </font>sreg<font color="#808080">)
      </font><font color="#0000FF">endif
   elseif </font>sacao <font color="#808080">= </font>opAlterar 
      <font color="#000080">qout</font><font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">)+ </font>tLiv_isbn<font color="#808080">)
      </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, &quot;&quot;, </font><font color="#FF0000">1</font><font color="#808080">)
      </font>subMenu<font color="#808080">(</font><font color="#FF0000">9</font><font color="#808080">, </font>sreg<font color="#808080">)
      </font>frmCadLigados<font color="#808080">(</font>opLivroAss<font color="#808080">, </font>opExcluir<font color="#808080">, </font>tLiv_isbn<font color="#808080">)
      </font><font color="#000080">qout</font><font color="#808080">(&quot;</font>Assuntos dos livros exclu<font color="#808080">&iacute;</font>dos<font color="#808080">, </font>inclua novos<font color="#808080">!&quot;)
      </font>frmCadLigados<font color="#808080">(</font>opLivroAss<font color="#808080">, </font>opNovo<font color="#808080">, </font>tLiv_isbn<font color="#808080">)
      </font>frmCadLigados<font color="#808080">(</font>opLivroAut<font color="#808080">, </font>opExcluir<font color="#808080">, </font>tLiv_isbn<font color="#808080">)
      </font><font color="#000080">qout</font><font color="#808080">(&quot;</font>Autores dos livros exclu<font color="#808080">&iacute;</font>dos<font color="#808080">, </font>inclua novos<font color="#808080">!&quot;)
      </font>frmCadLigados<font color="#808080">(</font>opLivroAut<font color="#808080">, </font>opNovo<font color="#808080">, </font>tLiv_isbn<font color="#808080">)
   </font><font color="#0000FF">elseif </font>sacao <font color="#808080">= </font>opExcluir 
      subMenu<font color="#808080">(</font><font color="#FF0000">10</font><font color="#808080">, </font>sreg<font color="#808080">)
      </font><font color="#000080">qout</font><font color="#808080">(&quot;</font>Assuntos dos livros sendo exclu<font color="#808080">&iacute;</font>dos<font color="#808080">!&quot;)
      </font>frmCadLigados<font color="#808080">(</font>opLivroAss<font color="#808080">, </font>opExcluir<font color="#808080">, </font>tLiv_isbn<font color="#808080">)
      </font><font color="#000080">qout</font><font color="#808080">(&quot;</font>Autores dos livros sendo exclu<font color="#808080">&iacute;</font>dos<font color="#808080">!&quot;)
      </font>frmCadLigados<font color="#808080">(</font>opLivroAut<font color="#808080">, </font>opExcluir<font color="#808080">, </font>tLiv_isbn<font color="#808080">)
   </font><font color="#0000FF">endif
elseif </font>sreg <font color="#808080">= </font>opCliente 
   <font color="#0000FF">if </font>sacao <font color="#808080">= </font>opNovo 
      <font color="#0000FF">accept </font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">) </font><font color="#0000FF">to </font>tCli_cpf
      <font color="#0000FF">if </font>validaCPF<font color="#808080">(</font>tCli_cpf<font color="#808080">) 
          </font>slinha<font color="#808080">:=</font>pesqArq<font color="#808080">(</font>tfCliente<font color="#808080">, </font>tCli_cpf<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">14</font><font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">))
          </font><font color="#0000FF">if </font><font color="#000080">empty</font><font color="#808080">(</font>slinha<font color="#808080">)
             </font>pesqLinhaExcluida<font color="#808080">(</font>tfCliente<font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">))
             </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, &quot;&quot;, </font><font color="#FF0000">1</font><font color="#808080">)
             </font>subMenu<font color="#808080">(</font><font color="#FF0000">7</font><font color="#808080">, </font>sreg<font color="#808080">)
          </font><font color="#0000FF">else 
            </font><font color="#000080">qout</font><font color="#808080">(</font>MSG_REGEXST<font color="#808080">)
          </font><font color="#0000FF">endif
      else 
        </font><font color="#000080">qout</font><font color="#808080">(</font>MSG_CPFINV<font color="#808080">)
      </font><font color="#0000FF">endif 
   elseif </font>sacao <font color="#808080">= </font>opPesquisar 
      slinha<font color="#808080">:=</font>validaEntrada<font color="#808080">(</font>tfCliente<font color="#808080">, </font>sreg<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font>tCli_cpf<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,.</font>f<font color="#808080">.,</font>opTexto<font color="#808080">)
      </font><font color="#0000FF">if </font><font color="#808080">!</font><font color="#000080">empty</font><font color="#808080">(</font>slinha<font color="#808080">) 
         </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, &quot;&quot;, </font><font color="#FF0000">2</font><font color="#808080">)
         </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font>slinha<font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">)
         </font>subMenu<font color="#808080">(</font><font color="#FF0000">8</font><font color="#808080">, </font>sreg<font color="#808080">)
      </font><font color="#0000FF">endif
   elseif </font>sacao <font color="#808080">= </font>opAlterar 
      <font color="#000080">qout</font><font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">)+ </font>tCli_cpf<font color="#808080">)
      </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, &quot;&quot;, </font><font color="#FF0000">1</font><font color="#808080">)
      </font>subMenu<font color="#808080">(</font><font color="#FF0000">9</font><font color="#808080">, </font>sreg<font color="#808080">)
   </font><font color="#0000FF">elseif </font>sacao <font color="#808080">= </font>opExcluir 
      subMenu<font color="#808080">(</font><font color="#FF0000">10</font><font color="#808080">, </font>sreg<font color="#808080">)
   </font><font color="#0000FF">endif
elseif </font>sreg <font color="#808080">= </font>opVenda 
   <font color="#0000FF">if </font>sacao <font color="#808080">= </font>opNovo 
      tVenda_dthrvenda<font color="#808080">:=</font>retDataHora<font color="#808080">()
      </font><font color="#000080">qout</font><font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">)+ </font>tVenda_dthrvenda<font color="#808080">)
      </font>slinha<font color="#808080">:=</font>pesqArq<font color="#808080">(</font>tfVenda<font color="#808080">, </font>tVenda_dthrvenda<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">19</font><font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">))
      </font><font color="#0000FF">if </font><font color="#000080">empty</font><font color="#808080">(</font>slinha<font color="#808080">) 
         </font>slinha<font color="#808080">:=</font>validaEntrada<font color="#808080">(</font>tfCliente<font color="#808080">,</font>opCliente<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font>tVenda_cpf<font color="#808080">,</font><font color="#FF0000">3</font><font color="#808080">,;
                 .</font>f<font color="#808080">.,</font>opTexto<font color="#808080">)
         </font><font color="#0000FF">if </font><font color="#808080">!</font><font color="#000080">empty</font><font color="#808080">(</font>slinha<font color="#808080">) 
            </font>tVenda_cpf<font color="#808080">:=</font><font color="#000080">alltrim</font><font color="#808080">(</font><font color="#000080">substr</font><font color="#808080">(</font>slinha<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#FF0000">14</font><font color="#808080">))
            </font><font color="#0000FF">if </font>validaCPF<font color="#808080">(</font>tVenda_cpf<font color="#808080">) 
               </font><font color="#000080">qout</font><font color="#808080">(&quot; &quot;+</font>rotulo<font color="#808080">(</font>opCliente<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">)) <i>/* Nome */
               </i></font><font color="#000080">qqout</font><font color="#808080">(</font><font color="#000080">substr</font><font color="#808080">(</font>slinha<font color="#808080">, </font>g_nPosChave<font color="#808080">, </font>g_nTamChave<font color="#808080">))
               </font>frmCadLigados<font color="#808080">(</font>opVenda<font color="#808080">, </font>opNovo<font color="#808080">, </font>tVenda_cpf<font color="#808080">)
            </font><font color="#0000FF">else 
               </font><font color="#000080">qout</font><font color="#808080">(</font>MSG_CPFINV<font color="#808080">)
            </font><font color="#0000FF">endif
         endif
      else 
         </font><font color="#000080">qout</font><font color="#808080">(</font>MSG_REGEXST<font color="#808080">)
      </font><font color="#0000FF">endif
   elseif </font>sacao <font color="#808080">= </font>opPesquisar 
      slinha<font color="#808080">:=</font>validaEntrada<font color="#808080">(</font>tfVenda<font color="#808080">, </font>sreg<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font>tVenda_dthrvenda<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,;
              .</font>f<font color="#808080">.,</font>opDataHora<font color="#808080">)
      </font><font color="#0000FF">if </font><font color="#808080">!</font><font color="#000080">empty</font><font color="#808080">(</font>slinha<font color="#808080">) 
        </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, &quot;&quot;, </font><font color="#FF0000">2</font><font color="#808080">)
        </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font>slinha<font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">)
        </font>subMenu<font color="#808080">(</font><font color="#FF0000">8</font><font color="#808080">, </font>sreg<font color="#808080">)
      </font><font color="#0000FF">endif
   endif
endif

return
</font><font color="#808080"><i>/*------------------------------------------------------------------------------
Realiza as consultas de acordo com o tipo de arquivo.
sreg - o tipo de arquivo
sacao - a a&ccedil;&atilde;o a ser realizada
------------------------------------------------------------------------------*/
</i></font><font color="#0000FF">procedure </font>frmConsultas<font color="#808080">(</font>sreg<font color="#808080">, </font>sacao<font color="#808080">)
</font><font color="#0000FF">local </font>slinha

<font color="#0000FF">if </font>sreg <font color="#808080">= </font>opAssunto 
   <font color="#0000FF">if </font>sacao <font color="#808080">= </font>opPesquisar
      slinha<font color="#808080">:=</font>validaEntrada<font color="#808080">(</font>tfAssunto<font color="#808080">,</font>sreg<font color="#808080">,</font><font color="#FF0000">2</font><font color="#808080">,</font>tAssunto_assunto<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,.</font>t<font color="#808080">.,</font>opTexto<font color="#808080">)
   </font><font color="#0000FF">elseif </font>sacao <font color="#808080">= </font>opListarTodos 
      <font color="#0000FF">if </font>ListarTodos<font color="#808080">(</font>tfAssunto<font color="#808080">, </font>sreg<font color="#808080">, &quot;&quot;, </font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">),;
        </font>QTD_MAX_LINHA<font color="#808080">, .</font>f<font color="#808080">.) = .</font>f<font color="#808080">.
        </font><font color="#000080">qout</font><font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">))
      </font><font color="#0000FF">endif
   endif
elseif </font>sreg <font color="#808080">= </font>opAutor 
   <font color="#0000FF">if </font>sacao <font color="#808080">= </font>opPesquisar
      slinha<font color="#808080">:=</font>validaEntrada<font color="#808080">(</font>tfAutor<font color="#808080">,</font>sreg<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">, </font>tAutor_autor<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, .</font>t<font color="#808080">.,</font>opTexto<font color="#808080">)
   </font><font color="#0000FF">elseif </font>sacao <font color="#808080">= </font>opListarTodos 
      <font color="#0000FF">if </font>ListarTodos<font color="#808080">(</font>tfAutor<font color="#808080">, </font>sreg<font color="#808080">, &quot;&quot;, </font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">),;
        </font>QTD_MAX_LINHA<font color="#808080">, .</font>f<font color="#808080">.) = .</font>f<font color="#808080">.
        </font><font color="#000080">qout</font><font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">))
      </font><font color="#0000FF">endif
   endif
elseif </font>sreg <font color="#808080">= </font>opEditora 
   <font color="#0000FF">if </font>sacao <font color="#808080">= </font>opPesquisar
      slinha<font color="#808080">:=</font>validaEntrada<font color="#808080">(</font>tfEditora<font color="#808080">,</font>sreg<font color="#808080">,</font><font color="#FF0000">2</font><font color="#808080">,</font>tEditora_editora<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,.</font>t<font color="#808080">.,</font>opTexto<font color="#808080">)
   </font><font color="#0000FF">elseif </font>sacao <font color="#808080">= </font>opListarTodos 
      <font color="#0000FF">if </font>ListarTodos<font color="#808080">(</font>tfEditora<font color="#808080">, </font>sreg<font color="#808080">, &quot;&quot;, </font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">),;
        </font>QTD_MAX_LINHA<font color="#808080">, .</font>f<font color="#808080">.) = .</font>f<font color="#808080">.
        </font><font color="#000080">qout</font><font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">))
      </font><font color="#0000FF">endif
   endif
elseif </font>sreg <font color="#808080">= </font>opEndereco 
   <font color="#0000FF">if </font>sacao <font color="#808080">= </font>opPesquisar
      slinha<font color="#808080">:=</font>validaEntrada<font color="#808080">(</font>tfEndereco<font color="#808080">,</font>sreg<font color="#808080">,</font><font color="#FF0000">2</font><font color="#808080">,</font>tEnd_Logradouro<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,;
              .</font>t<font color="#808080">.,</font>opTexto<font color="#808080">)
   </font><font color="#0000FF">elseif </font>sacao <font color="#808080">= </font>opListarTodos 
      <font color="#0000FF">if </font>ListarTodos<font color="#808080">(</font>tfEndereco<font color="#808080">, </font>sreg<font color="#808080">, &quot;&quot;, </font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">),;
         </font><font color="#FF0000">3</font><font color="#808080">, .</font>f<font color="#808080">.) = .</font>f<font color="#808080">.
        </font><font color="#000080">qout</font><font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">))
      </font><font color="#0000FF">endif
   endif
elseif </font>sreg <font color="#808080">= </font>opIdioma 
   <font color="#0000FF">if </font>sacao <font color="#808080">= </font>opPesquisar
      slinha<font color="#808080">:=</font>validaEntrada<font color="#808080">(</font>tfIdioma<font color="#808080">, </font>sreg<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">, </font>tIdioma_idioma<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,.</font>t<font color="#808080">.,</font>opTexto<font color="#808080">)
   </font><font color="#0000FF">elseif </font>sacao <font color="#808080">= </font>opListarTodos 
      <font color="#0000FF">if </font>ListarTodos<font color="#808080">(</font>tfIdioma<font color="#808080">, </font>sreg<font color="#808080">, &quot;&quot;, </font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">),;
        </font>QTD_MAX_LINHA<font color="#808080">, .</font>f<font color="#808080">.) = .</font>f<font color="#808080">.
        </font><font color="#000080">qout</font><font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">))
      </font><font color="#0000FF">endif
   endif
elseif </font>sreg <font color="#808080">= </font>opPais 
   <font color="#0000FF">if </font>sacao <font color="#808080">= </font>opPesquisar
      slinha<font color="#808080">:=</font>validaEntrada<font color="#808080">(</font>tfPais<font color="#808080">, </font>sreg<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">, </font>tPais_pais<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, .</font>t<font color="#808080">.,</font>opTexto<font color="#808080">)
   </font><font color="#0000FF">elseif </font>sacao <font color="#808080">= </font>opListarTodos 
      <font color="#0000FF">if </font>ListarTodos<font color="#808080">(</font>tfPais<font color="#808080">, </font>sreg<font color="#808080">, &quot;&quot;, </font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">),;
        </font>QTD_MAX_LINHA<font color="#808080">, .</font>f<font color="#808080">.) = .</font>f<font color="#808080">.
        </font><font color="#000080">qout</font><font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">))
      </font><font color="#0000FF">endif
   endif
elseif </font>sreg <font color="#808080">= </font>opProfissao 
   <font color="#0000FF">if </font>sacao <font color="#808080">= </font>opPesquisar
     slinha<font color="#808080">:=</font>validaEntrada<font color="#808080">(</font>tfProfissao<font color="#808080">,</font>sreg<font color="#808080">,</font><font color="#FF0000">2</font><font color="#808080">,</font>tProfiss_profissao<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,;
             .</font>t<font color="#808080">.,</font>opTexto<font color="#808080">)
   </font><font color="#0000FF">elseif </font>sacao <font color="#808080">= </font>opListarTodos 
      <font color="#0000FF">if </font>ListarTodos<font color="#808080">(</font>tfProfissao<font color="#808080">, </font>sreg<font color="#808080">, &quot;&quot;, </font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">),;
        </font>QTD_MAX_LINHA<font color="#808080">, .</font>f<font color="#808080">.) = .</font>f<font color="#808080">.
        </font><font color="#000080">qout</font><font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">))
      </font><font color="#0000FF">endif
   endif
elseif </font>sreg <font color="#808080">= </font>opLivro 
   <font color="#0000FF">if </font>sacao <font color="#808080">= </font>opPesquisar
      slinha<font color="#808080">:=</font>validaEntrada<font color="#808080">(</font>tfLivro<font color="#808080">, </font>sreg<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">, </font>tLiv_titulo<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, .</font>t<font color="#808080">.,</font>opTexto<font color="#808080">)
   </font><font color="#0000FF">elseif </font>sacao <font color="#808080">= </font>opListarTodos 
      <font color="#0000FF">if </font>ListarTodos<font color="#808080">(</font>tfLivro<font color="#808080">, </font>sreg<font color="#808080">, &quot;&quot;, </font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">),;
        </font><font color="#FF0000">1</font><font color="#808080">, .</font>f<font color="#808080">.) = .</font>f<font color="#808080">.
        </font><font color="#000080">qout</font><font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">))
      </font><font color="#0000FF">endif
   endif
elseif </font>sreg <font color="#808080">= </font>opCliente 
   <font color="#0000FF">if </font>sacao <font color="#808080">= </font>opPesquisar
      slinha<font color="#808080">:=</font>validaEntrada<font color="#808080">(</font>tfCliente<font color="#808080">, </font>sreg<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">, </font>tCli_nome<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,.</font>t<font color="#808080">.,</font>opTexto<font color="#808080">)
   </font><font color="#0000FF">elseif </font>sacao <font color="#808080">= </font>opListarTodos 
      <font color="#0000FF">if </font>ListarTodos<font color="#808080">(</font>tfCliente<font color="#808080">, </font>sreg<font color="#808080">, &quot;&quot;, </font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">),;
        </font><font color="#FF0000">1</font><font color="#808080">, .</font>f<font color="#808080">.) = .</font>f<font color="#808080">.
        </font><font color="#000080">qout</font><font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">))
      </font><font color="#0000FF">endif
   endif
elseif </font>sreg <font color="#808080">= </font>opVenda 
   <font color="#0000FF">if </font>sacao <font color="#808080">= </font>opPesquisar
      slinha<font color="#808080">:=</font>validaEntrada<font color="#808080">(</font>tfVenda<font color="#808080">, </font>sreg<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">, </font>tVenda_cpf<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, .</font>t<font color="#808080">.,</font>opTexto<font color="#808080">)
   </font><font color="#0000FF">elseif </font>sacao <font color="#808080">= </font>opListarTodos 
      <font color="#0000FF">if </font>ListarTodos<font color="#808080">(</font>tfVenda<font color="#808080">, </font>sreg<font color="#808080">, &quot;&quot;, </font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">),;
        </font>QTD_MAX_LINHA<font color="#808080">, .</font>f<font color="#808080">.) = .</font>f<font color="#808080">.
        </font><font color="#000080">qout</font><font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">))
      </font><font color="#0000FF">endif
   endif
endif
if </font><font color="#000080">empty</font><font color="#808080">(</font>slinha<font color="#808080">)
   </font><font color="#000080">qqout</font><font color="#808080">(&quot;&quot;)
</font><font color="#0000FF">endif
return
</font><font color="#808080"><i>/*------------------------------------------------------------------------------
Mostra a tela de altera&ccedil;&atilde;o de senha do sistema e realiza a altera&ccedil;&atilde;o.
------------------------------------------------------------------------------*/
</i></font><font color="#0000FF">procedure </font>frmAlterarSenha<font color="#808080">()
</font><font color="#0000FF">local </font>bQuebra<font color="#808080">, </font>sres<font color="#808080">, </font>sSenhaAtual<font color="#808080">, </font>sNovaSenha<font color="#808080">, </font>sConfirmaSenha<font color="#808080">, </font>nopcao

<font color="#000080">qout</font><font color="#808080">(</font>rotulo<font color="#808080">(</font>opUsuario<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">)+ </font>tUsuario_login<font color="#808080">)
</font>nopcao<font color="#808080">:=</font><font color="#FF0000">1
</font>bQuebra<font color="#808080">:=.</font>f<font color="#808080">.
</font><font color="#0000FF">do while </font><font color="#808080">(</font>bQuebra<font color="#808080">=.</font>f<font color="#808080">.)
  </font><font color="#0000FF">do case
   case </font>nopcao <font color="#808080">= </font><font color="#FF0000">1 
       </font>sSenhaAtual<font color="#808080">:=</font>digitaSenha<font color="#808080">(&quot;</font>Senha Atual<font color="#808080">: &quot;,</font><font color="#FF0000">10</font><font color="#808080">)
       </font><font color="#0000FF">if </font>sSenhaAtual<font color="#808080">&lt;&gt;</font>tUsuario_senha 
          <font color="#000080">qout</font><font color="#808080">(</font>MSG_SENCONFERE<font color="#808080">)
          </font>bQuebra<font color="#808080">:=.</font>t<font color="#808080">.
       </font><font color="#0000FF">else 
          </font>nopcao<font color="#808080">:=</font><font color="#FF0000">2
       </font><font color="#0000FF">endif
   case </font>nopcao <font color="#808080">= </font><font color="#FF0000">2
       </font>sNovaSenha<font color="#808080">:=</font>digitaSenha<font color="#808080">(&quot;</font>Nova Senha<font color="#808080">: &quot;,</font><font color="#FF0000">10</font><font color="#808080">)
       </font>sConfirmaSenha<font color="#808080">:=</font>digitaSenha<font color="#808080">(&quot;</font>Confirma Senha<font color="#808080">: &quot;,</font><font color="#FF0000">10</font><font color="#808080">)
       </font><font color="#0000FF">if </font>sNovaSenha<font color="#808080">&lt;&gt;</font>sConfirmaSenha 
          <font color="#000080">qout</font><font color="#808080">(</font>MSG_SENCONFIRM<font color="#808080">)
          </font>bQuebra<font color="#808080">:=.</font>t<font color="#808080">.
       </font><font color="#0000FF">else 
          </font>nopcao<font color="#808080">:=</font><font color="#FF0000">3
       </font><font color="#0000FF">endif
   case </font>nopcao <font color="#808080">= </font><font color="#FF0000">3
       </font>sres<font color="#808080">:=</font>pesqArq<font color="#808080">(</font>tfUsuario<font color="#808080">, </font>tUsuario_login<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">, </font>tamReg<font color="#808080">(</font>opUsuario<font color="#808080">))
       </font><font color="#0000FF">if </font><font color="#000080">empty</font><font color="#808080">(</font>sres<font color="#808080">)
         </font><font color="#000080">qout</font><font color="#808080">(</font>MSG_LOGINENCON<font color="#808080">)
       </font><font color="#0000FF">else 
         </font>tUsuario_senha<font color="#808080">:=</font>sConfirmaSenha
         subMenu<font color="#808080">(</font><font color="#FF0000">9</font><font color="#808080">,</font>opUsuario<font color="#808080">)
         </font>bQuebra<font color="#808080">:=.</font>t<font color="#808080">.
       </font><font color="#0000FF">endif
  endcase
enddo

return
</font><font color="#808080"><i>/*------------------------------------------------------------------------------
Executa uma a&ccedil;&atilde;o de grava&ccedil;&atilde;o de acordo com o tipo de arquivo.
sreg - o tipo de arquivo
sacao - a a&ccedil;&atilde;o a ser realizada
------------------------------------------------------------------------------*/
</i></font><font color="#0000FF">procedure </font>btnAcao<font color="#808080">(</font>sreg<font color="#808080">, </font>sacao<font color="#808080">)

</font><font color="#0000FF">if </font>sreg <font color="#808080">= </font>opAssunto 
   <font color="#0000FF">if </font>sacao <font color="#808080">= </font>opSalvarInclusao
      escreveArq<font color="#808080">(</font>tfAssunto<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGINC<font color="#808080">, </font>MSG_REGNINC<font color="#808080">)
   </font><font color="#0000FF">elseif </font>sacao <font color="#808080">= </font>opSalvarAlteracao
      escreveArq<font color="#808080">(</font>tfAssunto<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGALT<font color="#808080">, </font>MSG_REGNALT<font color="#808080">)
   </font><font color="#0000FF">elseif </font>sacao <font color="#808080">= </font>opConfirmaExclusao
      escreveArq<font color="#808080">(</font>tfAssunto<font color="#808080">, </font><font color="#000080">replicate</font><font color="#808080">(&quot;*&quot;,</font>tamReg<font color="#808080">(</font>sreg<font color="#808080">)), </font>MSG_REGEXC<font color="#808080">, </font>MSG_REGNEXC<font color="#808080">)
   </font><font color="#0000FF">endif
elseif </font>sreg <font color="#808080">= </font>opAutor 
   <font color="#0000FF">if </font>sacao <font color="#808080">= </font>opSalvarInclusao
      escreveArq<font color="#808080">(</font>tfAutor<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGINC<font color="#808080">, </font>MSG_REGNINC<font color="#808080">)
   </font><font color="#0000FF">elseif </font>sacao <font color="#808080">= </font>opSalvarAlteracao
      escreveArq<font color="#808080">(</font>tfAutor<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGALT<font color="#808080">, </font>MSG_REGNALT<font color="#808080">)
   </font><font color="#0000FF">elseif </font>sacao <font color="#808080">= </font>opConfirmaExclusao
      escreveArq<font color="#808080">(</font>tfAutor<font color="#808080">, </font><font color="#000080">replicate</font><font color="#808080">(&quot;*&quot;,</font>tamReg<font color="#808080">(</font>sreg<font color="#808080">)), </font>MSG_REGEXC<font color="#808080">, </font>MSG_REGNEXC<font color="#808080">)
   </font><font color="#0000FF">endif
elseif </font>sreg <font color="#808080">= </font>opEditora 
   <font color="#0000FF">if </font>sacao <font color="#808080">= </font>opSalvarInclusao
      escreveArq<font color="#808080">(</font>tfEditora<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGINC<font color="#808080">, </font>MSG_REGNINC<font color="#808080">)
   </font><font color="#0000FF">elseif </font>sacao <font color="#808080">= </font>opSalvarAlteracao
      escreveArq<font color="#808080">(</font>tfEditora<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGALT<font color="#808080">, </font>MSG_REGNALT<font color="#808080">)
   </font><font color="#0000FF">elseif </font>sacao <font color="#808080">= </font>opConfirmaExclusao
      escreveArq<font color="#808080">(</font>tfEditora<font color="#808080">, </font><font color="#000080">replicate</font><font color="#808080">(&quot;*&quot;,</font>tamReg<font color="#808080">(</font>sreg<font color="#808080">)), </font>MSG_REGEXC<font color="#808080">, </font>MSG_REGNEXC<font color="#808080">)
   </font><font color="#0000FF">endif
elseif </font>sreg <font color="#808080">= </font>opEndereco 
   <font color="#0000FF">if </font>sacao <font color="#808080">= </font>opSalvarInclusao
      escreveArq<font color="#808080">(</font>tfEndereco<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGINC<font color="#808080">, </font>MSG_REGNINC<font color="#808080">)
   </font><font color="#0000FF">elseif </font>sacao <font color="#808080">= </font>opSalvarAlteracao
      escreveArq<font color="#808080">(</font>tfEndereco<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGALT<font color="#808080">, </font>MSG_REGNALT<font color="#808080">)
   </font><font color="#0000FF">elseif </font>sacao <font color="#808080">= </font>opConfirmaExclusao
      escreveArq<font color="#808080">(</font>tfEndereco<font color="#808080">, </font><font color="#000080">replicate</font><font color="#808080">(&quot;*&quot;,</font>tamReg<font color="#808080">(</font>sreg<font color="#808080">)), </font>MSG_REGEXC<font color="#808080">, </font>MSG_REGNEXC<font color="#808080">)
   </font><font color="#0000FF">endif
elseif </font>sreg <font color="#808080">= </font>opIdioma 
   <font color="#0000FF">if </font>sacao <font color="#808080">= </font>opSalvarInclusao
      escreveArq<font color="#808080">(</font>tfIdioma<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGINC<font color="#808080">, </font>MSG_REGNINC<font color="#808080">)
   </font><font color="#0000FF">elseif </font>sacao <font color="#808080">= </font>opSalvarAlteracao
      escreveArq<font color="#808080">(</font>tfIdioma<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGALT<font color="#808080">, </font>MSG_REGNALT<font color="#808080">)
   </font><font color="#0000FF">elseif </font>sacao <font color="#808080">= </font>opConfirmaExclusao
      escreveArq<font color="#808080">(</font>tfIdioma<font color="#808080">, </font><font color="#000080">replicate</font><font color="#808080">(&quot;*&quot;,</font>tamReg<font color="#808080">(</font>sreg<font color="#808080">)), </font>MSG_REGEXC<font color="#808080">, </font>MSG_REGNEXC<font color="#808080">)
   </font><font color="#0000FF">endif
elseif </font>sreg <font color="#808080">= </font>opPais 
   <font color="#0000FF">if </font>sacao <font color="#808080">= </font>opSalvarInclusao
      escreveArq<font color="#808080">(</font>tfPais<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGINC<font color="#808080">, </font>MSG_REGNINC<font color="#808080">)
   </font><font color="#0000FF">elseif </font>sacao <font color="#808080">= </font>opSalvarAlteracao
      escreveArq<font color="#808080">(</font>tfPais<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGALT<font color="#808080">, </font>MSG_REGNALT<font color="#808080">)
   </font><font color="#0000FF">elseif </font>sacao <font color="#808080">= </font>opConfirmaExclusao
      escreveArq<font color="#808080">(</font>tfPais<font color="#808080">, </font><font color="#000080">replicate</font><font color="#808080">(&quot;*&quot;,</font>tamReg<font color="#808080">(</font>sreg<font color="#808080">)), </font>MSG_REGEXC<font color="#808080">, </font>MSG_REGNEXC<font color="#808080">)
   </font><font color="#0000FF">endif
elseif </font>sreg <font color="#808080">= </font>opProfissao 
   <font color="#0000FF">if </font>sacao <font color="#808080">= </font>opSalvarInclusao
      escreveArq<font color="#808080">(</font>tfProfissao<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGINC<font color="#808080">, </font>MSG_REGNINC<font color="#808080">)
   </font><font color="#0000FF">elseif </font>sacao <font color="#808080">= </font>opSalvarAlteracao
      escreveArq<font color="#808080">(</font>tfProfissao<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGALT<font color="#808080">, </font>MSG_REGNALT<font color="#808080">)
   </font><font color="#0000FF">elseif </font>sacao <font color="#808080">= </font>opConfirmaExclusao
      escreveArq<font color="#808080">(</font>tfProfissao<font color="#808080">, </font><font color="#000080">replicate</font><font color="#808080">(&quot;*&quot;,</font>tamReg<font color="#808080">(</font>sreg<font color="#808080">)), </font>MSG_REGEXC<font color="#808080">, </font>MSG_REGNEXC<font color="#808080">)
   </font><font color="#0000FF">endif
elseif </font>sreg <font color="#808080">= </font>opLivro 
   <font color="#0000FF">if </font>sacao <font color="#808080">= </font>opSalvarInclusao
      escreveArq<font color="#808080">(</font>tfLivro<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGINC<font color="#808080">, </font>MSG_REGNINC<font color="#808080">)
   </font><font color="#0000FF">elseif </font>sacao <font color="#808080">= </font>opSalvarAlteracao
      escreveArq<font color="#808080">(</font>tfLivro<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGALT<font color="#808080">, </font>MSG_REGNALT<font color="#808080">)
   </font><font color="#0000FF">elseif </font>sacao <font color="#808080">= </font>opConfirmaExclusao
      escreveArq<font color="#808080">(</font>tfLivro<font color="#808080">, </font><font color="#000080">replicate</font><font color="#808080">(&quot;*&quot;,</font>tamReg<font color="#808080">(</font>sreg<font color="#808080">)), </font>MSG_REGEXC<font color="#808080">, </font>MSG_REGNEXC<font color="#808080">)
   </font><font color="#0000FF">endif
elseif </font>sreg <font color="#808080">= </font>opLivroAss 
   <font color="#0000FF">if </font>sacao <font color="#808080">= </font>opSalvarInclusao
      escreveArq<font color="#808080">(</font>tfLivroAss<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGINC<font color="#808080">, </font>MSG_REGNINC<font color="#808080">)
   </font><font color="#0000FF">elseif </font>sacao <font color="#808080">= </font>opSalvarAlteracao
      escreveArq<font color="#808080">(</font>tfLivroAss<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGALT<font color="#808080">, </font>MSG_REGNALT<font color="#808080">)
   </font><font color="#0000FF">elseif </font>sacao <font color="#808080">= </font>opConfirmaExclusao
      escreveArq<font color="#808080">(</font>tfLivroAss<font color="#808080">, </font><font color="#000080">replicate</font><font color="#808080">(&quot;*&quot;,</font>tamReg<font color="#808080">(</font>sreg<font color="#808080">)), </font>MSG_REGEXC<font color="#808080">, </font>MSG_REGNEXC<font color="#808080">)
   </font><font color="#0000FF">endif
elseif </font>sreg <font color="#808080">= </font>opLivroAut 
   <font color="#0000FF">if </font>sacao <font color="#808080">= </font>opSalvarInclusao
      escreveArq<font color="#808080">(</font>tfLivroAut<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGINC<font color="#808080">, </font>MSG_REGNINC<font color="#808080">)
   </font><font color="#0000FF">elseif </font>sacao <font color="#808080">= </font>opSalvarAlteracao
      escreveArq<font color="#808080">(</font>tfLivroAut<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGALT<font color="#808080">, </font>MSG_REGNALT<font color="#808080">)
   </font><font color="#0000FF">elseif </font>sacao <font color="#808080">= </font>opConfirmaExclusao
      escreveArq<font color="#808080">(</font>tfLivroAut<font color="#808080">, </font><font color="#000080">replicate</font><font color="#808080">(&quot;*&quot;,</font>tamReg<font color="#808080">(</font>sreg<font color="#808080">)), </font>MSG_REGEXC<font color="#808080">, </font>MSG_REGNEXC<font color="#808080">)
   </font><font color="#0000FF">endif
elseif </font>sreg <font color="#808080">= </font>opCliente 
   <font color="#0000FF">if </font>sacao <font color="#808080">= </font>opSalvarInclusao
      escreveArq<font color="#808080">(</font>tfCliente<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGINC<font color="#808080">, </font>MSG_REGNINC<font color="#808080">)
   </font><font color="#0000FF">elseif </font>sacao <font color="#808080">= </font>opSalvarAlteracao
      escreveArq<font color="#808080">(</font>tfCliente<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGALT<font color="#808080">, </font>MSG_REGNALT<font color="#808080">)
   </font><font color="#0000FF">elseif </font>sacao <font color="#808080">= </font>opConfirmaExclusao
      escreveArq<font color="#808080">(</font>tfCliente<font color="#808080">, </font><font color="#000080">replicate</font><font color="#808080">(&quot;*&quot;,</font>tamReg<font color="#808080">(</font>sreg<font color="#808080">)), </font>MSG_REGEXC<font color="#808080">, </font>MSG_REGNEXC<font color="#808080">)
   </font><font color="#0000FF">endif
elseif </font>sreg <font color="#808080">= </font>opVenda 
   <font color="#0000FF">if </font>sacao <font color="#808080">= </font>opSalvarInclusao
      escreveArq<font color="#808080">(</font>tfVenda<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGINC<font color="#808080">, </font>MSG_REGNINC<font color="#808080">)
   </font><font color="#0000FF">elseif </font>sacao <font color="#808080">= </font>opSalvarAlteracao
      escreveArq<font color="#808080">(</font>tfVenda<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGALT<font color="#808080">, </font>MSG_REGNALT<font color="#808080">)
   </font><font color="#0000FF">elseif </font>sacao <font color="#808080">= </font>opConfirmaExclusao
      escreveArq<font color="#808080">(</font>tfVenda<font color="#808080">, </font><font color="#000080">replicate</font><font color="#808080">(&quot;*&quot;,</font>tamReg<font color="#808080">(</font>sreg<font color="#808080">)), </font>MSG_REGEXC<font color="#808080">, </font>MSG_REGNEXC<font color="#808080">)
   </font><font color="#0000FF">endif
elseif </font>sreg <font color="#808080">= </font>opUsuario 
   <font color="#0000FF">if </font>sacao <font color="#808080">= </font>opSalvarAlteracao
      escreveArq<font color="#808080">(</font>tfUsuario<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGALT<font color="#808080">, </font>MSG_REGNALT<font color="#808080">)
   </font><font color="#0000FF">endif
endif
return
</font><font color="#808080"><i>/*------------------------------------------------------------------------------
Seleciona o menu e/ou a tela certa de acordo com o tipo de arquivo.
nmenu - o n&uacute;mero do menu
sreg - o tipo de arquivo
------------------------------------------------------------------------------*/
</i></font><font color="#0000FF">procedure </font>subMenu<font color="#808080">(</font>nmenu<font color="#808080">, </font>sreg<font color="#808080">)
</font><font color="#0000FF">local </font>opSubMenu<font color="#808080">, </font>opCSubMenu<font color="#808080">, </font>bSOp

bSOp<font color="#808080">:=.</font>t<font color="#808080">.
</font><font color="#0000FF">do case
 case </font>nmenu <font color="#808080">= </font><font color="#FF0000">6
    </font><font color="#0000FF">do while</font><font color="#808080">(</font>bSOp<font color="#808080">)    
     </font><font color="#0000FF">accept menu</font><font color="#808080">(</font>nmenu<font color="#808080">) </font><font color="#0000FF">to </font>opSubMenu
     <font color="#0000FF">do case
        case </font>opSubMenu <font color="#808080">= &quot;</font><font color="#FF0000">1</font><font color="#808080">&quot; 
          </font>frmCadastros<font color="#808080">(</font>sreg<font color="#808080">, </font>opNovo<font color="#808080">)
        </font><font color="#0000FF">case </font>opSubMenu <font color="#808080">= &quot;</font><font color="#FF0000">2</font><font color="#808080">&quot; 
          </font>frmCadastros<font color="#808080">(</font>sreg<font color="#808080">, </font>opPesquisar<font color="#808080">)
        </font><font color="#0000FF">case </font>opSubMenu <font color="#808080">= &quot;</font><font color="#FF0000">3</font><font color="#808080">&quot; 
          </font>bSOp<font color="#808080">:=.</font>f<font color="#808080">.
        </font><font color="#0000FF">otherwise 
          </font><font color="#000080">qout</font><font color="#808080">(</font>MSG_ERRO<font color="#808080">)
     </font><font color="#0000FF">endcase
    enddo
 case </font>nmenu <font color="#808080">= </font><font color="#FF0000">7
    </font><font color="#0000FF">do while</font><font color="#808080">(</font>bSOp<font color="#808080">)    
     </font><font color="#0000FF">accept menu</font><font color="#808080">(</font>nmenu<font color="#808080">) </font><font color="#0000FF">to </font>opSubMenu
     <font color="#0000FF">do case
        case </font>opSubMenu <font color="#808080">= &quot;</font><font color="#FF0000">1</font><font color="#808080">&quot;  
          </font>btnAcao<font color="#808080">(</font>sreg<font color="#808080">, </font>opSalvarInclusao<font color="#808080">) 
          </font>bSOp<font color="#808080">:=.</font>f<font color="#808080">.
        </font><font color="#0000FF">case </font>opSubMenu <font color="#808080">= &quot;</font><font color="#FF0000">2</font><font color="#808080">&quot;
          </font>bSOp<font color="#808080">:=.</font>f<font color="#808080">.
        </font><font color="#0000FF">otherwise
          </font><font color="#000080">qout</font><font color="#808080">(</font>MSG_ERRO<font color="#808080">)
     </font><font color="#0000FF">endcase
    enddo
 case </font>nmenu <font color="#808080">= </font><font color="#FF0000">8
    </font><font color="#0000FF">do while</font><font color="#808080">(</font>bSOp<font color="#808080">)    
     </font><font color="#0000FF">accept menu</font><font color="#808080">(</font>nmenu<font color="#808080">) </font><font color="#0000FF">to </font>opSubMenu
     <font color="#0000FF">do case
        case </font>opSubMenu <font color="#808080">= &quot;</font><font color="#FF0000">1</font><font color="#808080">&quot;  
          </font>frmCadastros<font color="#808080">(</font>sreg<font color="#808080">, </font>opAlterar<font color="#808080">) 
          </font>bSOp<font color="#808080">:=.</font>f<font color="#808080">.
        </font><font color="#0000FF">case </font>opSubMenu <font color="#808080">= &quot;</font><font color="#FF0000">2</font><font color="#808080">&quot; 
          </font>frmCadastros<font color="#808080">(</font>sreg<font color="#808080">, </font>opExcluir<font color="#808080">) 
          </font>bSOp<font color="#808080">:=.</font>f<font color="#808080">.
        </font><font color="#0000FF">case </font>opSubMenu <font color="#808080">= &quot;</font><font color="#FF0000">3</font><font color="#808080">&quot; 
          </font>bSOp<font color="#808080">:=.</font>f<font color="#808080">.
        </font><font color="#0000FF">otherwise
          </font><font color="#000080">qout</font><font color="#808080">(</font>MSG_ERRO<font color="#808080">)
     </font><font color="#0000FF">endcase
    enddo
 case </font>nmenu <font color="#808080">= </font><font color="#FF0000">9
    </font><font color="#0000FF">do while</font><font color="#808080">(</font>bSOp<font color="#808080">)    
     </font><font color="#0000FF">accept menu</font><font color="#808080">(</font>nmenu<font color="#808080">) </font><font color="#0000FF">to </font>opSubMenu
     <font color="#0000FF">do case
        case </font>opSubMenu <font color="#808080">= &quot;</font><font color="#FF0000">1</font><font color="#808080">&quot;  
          </font>btnAcao<font color="#808080">(</font>sreg<font color="#808080">, </font>opSalvarAlteracao<font color="#808080">) 
          </font>bSOp<font color="#808080">:=.</font>f<font color="#808080">.
        </font><font color="#0000FF">case </font>opSubMenu <font color="#808080">= &quot;</font><font color="#FF0000">2</font><font color="#808080">&quot; 
          </font>bSOp<font color="#808080">:=.</font>f<font color="#808080">.
        </font><font color="#0000FF">otherwise 
          </font><font color="#000080">qout</font><font color="#808080">(</font>MSG_ERRO<font color="#808080">)
     </font><font color="#0000FF">endcase
    enddo
 case </font>nmenu <font color="#808080">= </font><font color="#FF0000">10
    </font><font color="#0000FF">do while</font><font color="#808080">(</font>bSOp<font color="#808080">)      
       </font><font color="#0000FF">accept menu</font><font color="#808080">(</font>nmenu<font color="#808080">) </font><font color="#0000FF">to </font>opCSubMenu
       <font color="#0000FF">if </font><font color="#808080">(</font>opCSubMenu<font color="#808080">=&quot;</font>S<font color="#808080">&quot;) .</font>or<font color="#808080">. (</font>opCSubMenu<font color="#808080">=&quot;</font>s<font color="#808080">&quot;) 
          </font>btnAcao<font color="#808080">(</font>sreg<font color="#808080">, </font>opConfirmaExclusao<font color="#808080">)
          </font>bSOp<font color="#808080">:=.</font>f<font color="#808080">.
       </font><font color="#0000FF">elseif </font><font color="#808080">(</font>opCSubMenu<font color="#808080">=&quot;</font>N<font color="#808080">&quot;) .</font>or<font color="#808080">. (</font>opCSubMenu<font color="#808080">=&quot;</font>n<font color="#808080">&quot;) 
          </font>bSOp<font color="#808080">:=.</font>f<font color="#808080">.
       </font><font color="#0000FF">else 
          </font><font color="#000080">qout</font><font color="#808080">(</font>MSG_ERRO<font color="#808080">)
       </font><font color="#0000FF">endif
    enddo
 case </font>nmenu <font color="#808080">= </font><font color="#FF0000">12
    </font><font color="#0000FF">do while</font><font color="#808080">(</font>bSOp<font color="#808080">)    
     </font><font color="#0000FF">accept menu</font><font color="#808080">(</font>nmenu<font color="#808080">) </font><font color="#0000FF">to </font>opSubMenu
     <font color="#0000FF">do case
        case </font>opSubMenu <font color="#808080">= &quot;</font><font color="#FF0000">1</font><font color="#808080">&quot; 
          </font>frmConsultas<font color="#808080">(</font>sreg<font color="#808080">, </font>opPesquisar<font color="#808080">)
        </font><font color="#0000FF">case </font>opSubMenu <font color="#808080">= &quot;</font><font color="#FF0000">2</font><font color="#808080">&quot;
          </font>frmConsultas<font color="#808080">(</font>sreg<font color="#808080">, </font>opListarTodos<font color="#808080">)
        </font><font color="#0000FF">case </font>opSubMenu <font color="#808080">= &quot;</font><font color="#FF0000">3</font><font color="#808080">&quot; 
          </font>bSOp<font color="#808080">:=.</font>f<font color="#808080">.
        </font><font color="#0000FF">otherwise 
          </font><font color="#000080">qout</font><font color="#808080">(</font>MSG_ERRO<font color="#808080">)
     </font><font color="#0000FF">endcase
    enddo
 case </font>nmenu <font color="#808080">= </font><font color="#FF0000">14
    </font><font color="#0000FF">do while</font><font color="#808080">(</font>bSOp<font color="#808080">)    
     </font><font color="#0000FF">accept menu</font><font color="#808080">(</font>nmenu<font color="#808080">) </font><font color="#0000FF">to </font>opCSubMenu
     <font color="#0000FF">if </font><font color="#808080">(</font>opCSubMenu<font color="#808080">=&quot;</font>S<font color="#808080">&quot;) .</font>or<font color="#808080">. (</font>opCSubMenu<font color="#808080">=&quot;</font>s<font color="#808080">&quot;) 
        </font>btnAcao<font color="#808080">(</font>sreg<font color="#808080">, </font>opSalvarInclusao<font color="#808080">)
        </font>bSOp<font color="#808080">:=.</font>f<font color="#808080">.
        </font>g_SalvarInclusao<font color="#808080">:=.</font>t<font color="#808080">.
     </font><font color="#0000FF">elseif </font><font color="#808080">(</font>opCSubMenu<font color="#808080">=&quot;</font>N<font color="#808080">&quot;) .</font>or<font color="#808080">. (</font>opCSubMenu<font color="#808080">=&quot;</font>n<font color="#808080">&quot;) 
       </font>bSOp<font color="#808080">:=.</font>f<font color="#808080">.
     </font><font color="#0000FF">else 
       </font><font color="#000080">qout</font><font color="#808080">(</font>MSG_ERRO<font color="#808080">)
     </font><font color="#0000FF">endif 
    enddo
endcase

return
</font><font color="#808080"><i>/*------------------------------------------------------------------------------
Seleciona o submenu e/ou a tela certa de acordo com n&uacute;mero do menu.
nmenu - o n&uacute;mero do menu
------------------------------------------------------------------------------*/
</i></font><font color="#0000FF">procedure </font>usaMenu<font color="#808080">(</font>num<font color="#808080">)
</font><font color="#0000FF">local </font>opSubMenu<font color="#808080">, </font>bSOp<font color="#808080">, </font>opSair

 bSOp<font color="#808080">:=.</font>t<font color="#808080">.
 </font><font color="#0000FF">if </font>num <font color="#808080">= </font><font color="#FF0000">1  </font><font color="#808080"><i>/* Cadastros */
   </i></font><font color="#0000FF">do while</font><font color="#808080">(</font>bSOp<font color="#808080">)    
     </font><font color="#0000FF">accept menu</font><font color="#808080">(</font><font color="#FF0000">2</font><font color="#808080">) </font><font color="#0000FF">to </font>opSubMenu
     <font color="#0000FF">do case
      case </font>opSubMenu <font color="#808080">== &quot;</font><font color="#FF0000">1</font><font color="#808080">&quot; 
        </font>subMenu<font color="#808080">(</font><font color="#FF0000">6</font><font color="#808080">, </font>opAssunto<font color="#808080">)
      </font><font color="#0000FF">case </font>opSubMenu <font color="#808080">== &quot;</font><font color="#FF0000">2</font><font color="#808080">&quot; 
        </font>subMenu<font color="#808080">(</font><font color="#FF0000">6</font><font color="#808080">, </font>opAutor<font color="#808080">)
      </font><font color="#0000FF">case </font>opSubMenu <font color="#808080">== &quot;</font><font color="#FF0000">3</font><font color="#808080">&quot; 
        </font>subMenu<font color="#808080">(</font><font color="#FF0000">6</font><font color="#808080">, </font>opEditora<font color="#808080">)
      </font><font color="#0000FF">case </font>opSubMenu <font color="#808080">== &quot;</font><font color="#FF0000">4</font><font color="#808080">&quot; 
        </font>subMenu<font color="#808080">(</font><font color="#FF0000">6</font><font color="#808080">, </font>opEndereco<font color="#808080">)
      </font><font color="#0000FF">case </font>opSubMenu <font color="#808080">== &quot;</font><font color="#FF0000">5</font><font color="#808080">&quot; 
        </font>subMenu<font color="#808080">(</font><font color="#FF0000">6</font><font color="#808080">, </font>opIdioma<font color="#808080">)
      </font><font color="#0000FF">case </font>opSubMenu <font color="#808080">== &quot;</font><font color="#FF0000">6</font><font color="#808080">&quot; 
        </font>subMenu<font color="#808080">(</font><font color="#FF0000">6</font><font color="#808080">, </font>opPais<font color="#808080">)
      </font><font color="#0000FF">case </font>opSubMenu <font color="#808080">== &quot;</font><font color="#FF0000">7</font><font color="#808080">&quot; 
        </font>subMenu<font color="#808080">(</font><font color="#FF0000">6</font><font color="#808080">, </font>opProfissao<font color="#808080">)
      </font><font color="#0000FF">case </font>opSubMenu <font color="#808080">== &quot;</font><font color="#FF0000">8</font><font color="#808080">&quot; 
        </font>subMenu<font color="#808080">(</font><font color="#FF0000">6</font><font color="#808080">, </font>opCliente<font color="#808080">)
      </font><font color="#0000FF">case </font>opSubMenu <font color="#808080">== &quot;</font><font color="#FF0000">9</font><font color="#808080">&quot; 
        </font>subMenu<font color="#808080">(</font><font color="#FF0000">6</font><font color="#808080">, </font>opLivro<font color="#808080">)
      </font><font color="#0000FF">case </font>opSubMenu <font color="#808080">== &quot;</font><font color="#FF0000">10</font><font color="#808080">&quot; 
        </font>bSOp<font color="#808080">:=.</font>f<font color="#808080">.
      </font><font color="#0000FF">otherwise 
        </font><font color="#000080">qout</font><font color="#808080">(</font>MSG_ERRO<font color="#808080">)
     </font><font color="#0000FF">endcase
   enddo
 elseif </font>num <font color="#808080">= </font><font color="#FF0000">2  </font><font color="#808080"><i>/* Pesquisas */
   </i></font><font color="#0000FF">do while</font><font color="#808080">(</font>bSOp<font color="#808080">)    
     </font><font color="#0000FF">accept menu</font><font color="#808080">(</font><font color="#FF0000">3</font><font color="#808080">) </font><font color="#0000FF">to </font>opSubMenu
     <font color="#0000FF">do case
      case </font>opSubMenu <font color="#808080">== &quot;</font><font color="#FF0000">1</font><font color="#808080">&quot; 
        </font>subMenu<font color="#808080">(</font><font color="#FF0000">12</font><font color="#808080">, </font>opAssunto<font color="#808080">)
      </font><font color="#0000FF">case </font>opSubMenu <font color="#808080">== &quot;</font><font color="#FF0000">2</font><font color="#808080">&quot; 
        </font>subMenu<font color="#808080">(</font><font color="#FF0000">12</font><font color="#808080">, </font>opAutor<font color="#808080">)
      </font><font color="#0000FF">case </font>opSubMenu <font color="#808080">== &quot;</font><font color="#FF0000">3</font><font color="#808080">&quot; 
        </font>subMenu<font color="#808080">(</font><font color="#FF0000">12</font><font color="#808080">, </font>opEditora<font color="#808080">)
      </font><font color="#0000FF">case </font>opSubMenu <font color="#808080">== &quot;</font><font color="#FF0000">4</font><font color="#808080">&quot; 
        </font>subMenu<font color="#808080">(</font><font color="#FF0000">12</font><font color="#808080">, </font>opEndereco<font color="#808080">)
      </font><font color="#0000FF">case </font>opSubMenu <font color="#808080">== &quot;</font><font color="#FF0000">5</font><font color="#808080">&quot; 
        </font>subMenu<font color="#808080">(</font><font color="#FF0000">12</font><font color="#808080">, </font>opIdioma<font color="#808080">)
      </font><font color="#0000FF">case </font>opSubMenu <font color="#808080">== &quot;</font><font color="#FF0000">6</font><font color="#808080">&quot; 
        </font>subMenu<font color="#808080">(</font><font color="#FF0000">12</font><font color="#808080">, </font>opPais<font color="#808080">)
      </font><font color="#0000FF">case </font>opSubMenu <font color="#808080">== &quot;</font><font color="#FF0000">7</font><font color="#808080">&quot; 
        </font>subMenu<font color="#808080">(</font><font color="#FF0000">12</font><font color="#808080">, </font>opProfissao<font color="#808080">)
      </font><font color="#0000FF">case </font>opSubMenu <font color="#808080">== &quot;</font><font color="#FF0000">8</font><font color="#808080">&quot; 
        </font>subMenu<font color="#808080">(</font><font color="#FF0000">12</font><font color="#808080">, </font>opCliente<font color="#808080">)
      </font><font color="#0000FF">case </font>opSubMenu <font color="#808080">== &quot;</font><font color="#FF0000">9</font><font color="#808080">&quot; 
        </font>subMenu<font color="#808080">(</font><font color="#FF0000">12</font><font color="#808080">, </font>opLivro<font color="#808080">)
      </font><font color="#0000FF">case </font>opSubMenu <font color="#808080">== &quot;</font><font color="#FF0000">10</font><font color="#808080">&quot; 
        </font>bSOp<font color="#808080">:=.</font>f<font color="#808080">.
      </font><font color="#0000FF">otherwise 
        </font><font color="#000080">qout</font><font color="#808080">(</font>MSG_ERRO<font color="#808080">)
     </font><font color="#0000FF">endcase
   enddo
 elseif </font>num <font color="#808080">= </font><font color="#FF0000">3  </font><font color="#808080"><i>/* Vendas */
   </i></font><font color="#0000FF">do while</font><font color="#808080">(</font>bSOp<font color="#808080">)    
     </font><font color="#0000FF">accept menu</font><font color="#808080">(</font><font color="#FF0000">4</font><font color="#808080">) </font><font color="#0000FF">to </font>opSubMenu
     <font color="#0000FF">do case
      case </font>opSubMenu <font color="#808080">== &quot;</font><font color="#FF0000">1</font><font color="#808080">&quot; 
        </font>subMenu<font color="#808080">(</font><font color="#FF0000">6</font><font color="#808080">, </font>opVenda<font color="#808080">)
      </font><font color="#0000FF">case </font>opSubMenu <font color="#808080">== &quot;</font><font color="#FF0000">2</font><font color="#808080">&quot; 
        </font>subMenu<font color="#808080">(</font><font color="#FF0000">12</font><font color="#808080">, </font>opVenda<font color="#808080">)
      </font><font color="#0000FF">case </font>opSubMenu <font color="#808080">== &quot;</font><font color="#FF0000">3</font><font color="#808080">&quot;
        </font>bSOp<font color="#808080">:=.</font>f<font color="#808080">.
      </font><font color="#0000FF">otherwise
        </font><font color="#000080">qout</font><font color="#808080">(</font>MSG_ERRO<font color="#808080">)
     </font><font color="#0000FF">endcase
   enddo
 elseif </font>num <font color="#808080">= </font><font color="#FF0000">4  </font><font color="#808080"><i>/* Opcoes */
   </i></font><font color="#0000FF">do while</font><font color="#808080">(</font>bSOp<font color="#808080">)    
     </font><font color="#0000FF">accept menu</font><font color="#808080">(</font><font color="#FF0000">5</font><font color="#808080">) </font><font color="#0000FF">to </font>opSubMenu
     <font color="#0000FF">do case
      case </font>opSubMenu <font color="#808080">== &quot;</font><font color="#FF0000">1</font><font color="#808080">&quot;
        </font>frmAlterarSenha<font color="#808080">()
      </font><font color="#0000FF">case </font>opSubMenu <font color="#808080">== &quot;</font><font color="#FF0000">2</font><font color="#808080">&quot;
        </font>frmSobre<font color="#808080">()
      </font><font color="#0000FF">case </font>opSubMenu <font color="#808080">== &quot;</font><font color="#FF0000">3</font><font color="#808080">&quot;          
           </font><font color="#0000FF">accept menu</font><font color="#808080">(</font><font color="#FF0000">11</font><font color="#808080">) </font><font color="#0000FF">to </font>opSair
           <font color="#0000FF">if </font><font color="#808080">(</font>opSair<font color="#808080">=&quot;</font>S<font color="#808080">&quot;) .</font>or<font color="#808080">. (</font>opSair<font color="#808080">=&quot;</font>s<font color="#808080">&quot;) 
              </font>fechaArqs<font color="#808080">()
              </font><font color="#0000FF">quit
           endif
      case </font>opSubMenu <font color="#808080">== &quot;</font><font color="#FF0000">4</font><font color="#808080">&quot;
        </font>bSOp<font color="#808080">:=.</font>f<font color="#808080">.
      </font><font color="#0000FF">otherwise 
        </font><font color="#000080">qout</font><font color="#808080">(</font>MSG_ERRO<font color="#808080">)
     </font><font color="#0000FF">endcase
   enddo
 endif
return
</font><font color="#808080"><i>/*------------------------------------------------------------------------------
Mostra as entradas e as sa&iacute;das do sistema.
sreg - o tipo de arquivo
slinha - o registro com os dados
nOpcao - indica qual op&ccedil;&atilde;o ser&aacute; mostrada
------------------------------------------------------------------------------*/
</i></font><font color="#0000FF">procedure </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font>slinha<font color="#808080">, </font>nOpcao<font color="#808080">)

</font><font color="#0000FF">if </font>sreg <font color="#808080">= </font>opAssunto 
   <font color="#0000FF">do case
    case </font>nOpcao <font color="#808080">= </font><font color="#FF0000">1
        </font><font color="#000080">qout</font><font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">)+ </font>tAssunto_codigo<font color="#808080">)
        </font><font color="#0000FF">accept </font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">) </font><font color="#0000FF">to </font>tAssunto_assunto
    <font color="#0000FF">case </font>nOpcao <font color="#808080">= </font><font color="#FF0000">2
        </font><font color="#000080">qout</font><font color="#808080">(&quot;</font>C<font color="#808080">&oacute;</font>digo     Assunto<font color="#808080">&quot;)
        </font><font color="#000080">qout</font><font color="#808080">(&quot;------     -------&quot;)
    </font><font color="#0000FF">case </font>nOpcao <font color="#808080">= </font><font color="#FF0000">3
        </font>tAssunto_codigo<font color="#808080">:=</font><font color="#000080">substr</font><font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">)
        </font>tAssunto_assunto<font color="#808080">:=</font><font color="#000080">substr</font><font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">11</font><font color="#808080">, </font><font color="#FF0000">30</font><font color="#808080">)
        </font><font color="#000080">qout</font><font color="#808080">(</font>tAssunto_codigo<font color="#808080">+&quot; &quot;+</font>tAssunto_assunto<font color="#808080">)
   </font><font color="#0000FF">endcase
elseif </font>sreg <font color="#808080">= </font>opAutor
   <font color="#0000FF">do case
    case </font>nOpcao <font color="#808080">= </font><font color="#FF0000">1 
        </font><font color="#000080">qout</font><font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">)+ </font>tAutor_codigo<font color="#808080">)
        </font><font color="#0000FF">accept </font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">) </font><font color="#0000FF">to </font>tAutor_autor
    <font color="#0000FF">case </font>nOpcao <font color="#808080">= </font><font color="#FF0000">2
        </font><font color="#000080">qout</font><font color="#808080">(&quot;</font>C<font color="#808080">&oacute;</font>digo     Autor<font color="#808080">&quot;)
        </font><font color="#000080">qout</font><font color="#808080">(&quot;------     -----&quot;)
    </font><font color="#0000FF">case </font>nOpcao <font color="#808080">= </font><font color="#FF0000">3
        </font>tAutor_codigo<font color="#808080">:=</font><font color="#000080">substr</font><font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">)
        </font>tAutor_autor<font color="#808080">:=</font><font color="#000080">substr</font><font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">11</font><font color="#808080">, </font><font color="#FF0000">30</font><font color="#808080">)
        </font><font color="#000080">qout</font><font color="#808080">(</font>tAutor_codigo<font color="#808080">+&quot; &quot;+</font>tAutor_autor<font color="#808080">)
   </font><font color="#0000FF">endcase
elseif </font>sreg <font color="#808080">= </font>opEditora 
   <font color="#0000FF">do case
    case </font>nOpcao <font color="#808080">= </font><font color="#FF0000">1 
        </font><font color="#000080">qout</font><font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">)+ </font>tEditora_codigo<font color="#808080">)
        </font><font color="#0000FF">accept </font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">) </font><font color="#0000FF">to </font>tEditora_editora
    <font color="#0000FF">case </font>nOpcao <font color="#808080">= </font><font color="#FF0000">2 
        </font><font color="#000080">qout</font><font color="#808080">(&quot;</font>C<font color="#808080">&oacute;</font>digo     Editora<font color="#808080">&quot;)
        </font><font color="#000080">qout</font><font color="#808080">(&quot;------     -------&quot;)
    </font><font color="#0000FF">case </font>nOpcao <font color="#808080">= </font><font color="#FF0000">3 
        </font>tEditora_codigo<font color="#808080">:=</font><font color="#000080">substr</font><font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">)
        </font>tEditora_editora<font color="#808080">:=</font><font color="#000080">substr</font><font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">11</font><font color="#808080">, </font><font color="#FF0000">50</font><font color="#808080">)
        </font><font color="#000080">qout</font><font color="#808080">(</font>tEditora_codigo<font color="#808080">+&quot; &quot;+</font>tEditora_editora<font color="#808080">)     
   </font><font color="#0000FF">endcase
elseif </font>sreg <font color="#808080">= </font>opEndereco 
   <font color="#0000FF">do case
    case </font>nOpcao <font color="#808080">= </font><font color="#FF0000">1 
        </font><font color="#000080">qout</font><font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">)+ </font>tEnd_codigo<font color="#808080">)
        </font><font color="#0000FF">accept </font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">) </font><font color="#0000FF">to </font>tEnd_Logradouro
        <font color="#0000FF">accept </font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">) </font><font color="#0000FF">to </font>tEnd_bairro
        <font color="#0000FF">input </font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">4</font><font color="#808080">) </font><font color="#0000FF">to </font>tEnd_cep
        <font color="#0000FF">accept </font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">5</font><font color="#808080">) </font><font color="#0000FF">to </font>tEnd_cidade
        <font color="#0000FF">accept </font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">6</font><font color="#808080">) </font><font color="#0000FF">to </font>tEnd_estado
    <font color="#0000FF">case </font>nOpcao <font color="#808080">= </font><font color="#FF0000">3 
        </font>tEnd_codigo<font color="#808080">:=</font><font color="#000080">alltrim</font><font color="#808080">(</font><font color="#000080">substr</font><font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">))
        </font>tEnd_logradouro<font color="#808080">:=</font><font color="#000080">alltrim</font><font color="#808080">(</font><font color="#000080">substr</font><font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">11</font><font color="#808080">, </font><font color="#FF0000">40</font><font color="#808080">))
        </font>tEnd_bairro<font color="#808080">:=</font><font color="#000080">alltrim</font><font color="#808080">(</font><font color="#000080">substr</font><font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">51</font><font color="#808080">, </font><font color="#FF0000">15</font><font color="#808080">))
        </font>tEnd_cep<font color="#808080">:=</font><font color="#000080">alltrim</font><font color="#808080">(</font><font color="#000080">substr</font><font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">66</font><font color="#808080">, </font><font color="#FF0000">8</font><font color="#808080">))
        </font>tEnd_cidade<font color="#808080">:=</font><font color="#000080">alltrim</font><font color="#808080">(</font><font color="#000080">substr</font><font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">74</font><font color="#808080">, </font><font color="#FF0000">30</font><font color="#808080">))
        </font>tEnd_estado<font color="#808080">:=</font><font color="#000080">alltrim</font><font color="#808080">(</font><font color="#000080">substr</font><font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">104</font><font color="#808080">, </font><font color="#FF0000">20</font><font color="#808080">))
        </font><font color="#000080">qout</font><font color="#808080">(&quot;--------------------&quot;)
        </font><font color="#000080">qout</font><font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">)+ </font>tEnd_codigo<font color="#808080">)
        </font><font color="#000080">qout</font><font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">)+ </font>tEnd_Logradouro<font color="#808080">)
        </font><font color="#000080">qout</font><font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">)+ </font>tEnd_bairro<font color="#808080">)
        </font><font color="#000080">qout</font><font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">4</font><font color="#808080">)+ </font>tEnd_cep<font color="#808080">)
        </font><font color="#000080">qout</font><font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">5</font><font color="#808080">)+ </font>tEnd_cidade<font color="#808080">)
        </font><font color="#000080">qout</font><font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">6</font><font color="#808080">)+ </font>tEnd_estado<font color="#808080">)
   </font><font color="#0000FF">endcase
elseif </font>sreg <font color="#808080">= </font>opIdioma 
   <font color="#0000FF">do case
    case </font>nOpcao <font color="#808080">= </font><font color="#FF0000">1 
        </font><font color="#000080">qout</font><font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">)+ </font>tIdioma_codigo<font color="#808080">)
        </font><font color="#0000FF">accept </font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">) </font><font color="#0000FF">to </font>tIdioma_idioma
    <font color="#0000FF">case </font>nOpcao <font color="#808080">= </font><font color="#FF0000">2 
        </font><font color="#000080">qout</font><font color="#808080">(&quot;</font>C<font color="#808080">&oacute;</font>digo     Idioma<font color="#808080">&quot;)
        </font><font color="#000080">qout</font><font color="#808080">(&quot;------     ------&quot;)
    </font><font color="#0000FF">case </font>nOpcao <font color="#808080">= </font><font color="#FF0000">3
        </font>tIdioma_codigo<font color="#808080">:=</font><font color="#000080">substr</font><font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">)
        </font>tIdioma_idioma<font color="#808080">:=</font><font color="#000080">substr</font><font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">11</font><font color="#808080">, </font><font color="#FF0000">20</font><font color="#808080">)
        </font><font color="#000080">qout</font><font color="#808080">(</font>tIdioma_codigo<font color="#808080">+&quot; &quot;+</font>tIdioma_idioma<font color="#808080">)
   </font><font color="#0000FF">endcase
elseif </font>sreg <font color="#808080">= </font>opPais 
   <font color="#0000FF">do case
    case </font>nOpcao <font color="#808080">= </font><font color="#FF0000">1 
        </font><font color="#0000FF">accept </font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">) </font><font color="#0000FF">to </font>tPais_pais
    <font color="#0000FF">case </font>nOpcao <font color="#808080">= </font><font color="#FF0000">2 
        </font><font color="#000080">qout</font><font color="#808080">(&quot;</font>C<font color="#808080">&oacute;</font>digo Pa<font color="#808080">&iacute;</font>s<font color="#808080">&quot;)
        </font><font color="#000080">qout</font><font color="#808080">(&quot;------ ----&quot;)
    </font><font color="#0000FF">case </font>nOpcao <font color="#808080">= </font><font color="#FF0000">3 
        </font>tPais_codigo<font color="#808080">:=</font><font color="#000080">substr</font><font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">)
        </font>tPais_pais<font color="#808080">:=</font><font color="#000080">substr</font><font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">4</font><font color="#808080">, </font><font color="#FF0000">50</font><font color="#808080">)
        </font><font color="#000080">qout</font><font color="#808080">(</font>tPais_codigo<font color="#808080">+&quot;    &quot;+</font>tPais_pais<font color="#808080">)
   </font><font color="#0000FF">endcase
elseif </font>sreg <font color="#808080">= </font>opProfissao 
   <font color="#0000FF">do case
    case </font>nOpcao <font color="#808080">= </font><font color="#FF0000">1 
        </font><font color="#000080">qout</font><font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">)+ </font>tProfiss_codigo<font color="#808080">)
        </font><font color="#0000FF">accept </font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">) </font><font color="#0000FF">to </font>tProfiss_profissao
    <font color="#0000FF">case </font>nOpcao <font color="#808080">= </font><font color="#FF0000">2 
        </font><font color="#000080">qout</font><font color="#808080">(&quot;</font>C<font color="#808080">&oacute;</font>digo     Profiss<font color="#808080">&atilde;</font>o<font color="#808080">&quot;)
        </font><font color="#000080">qout</font><font color="#808080">(&quot;------     ---------&quot;)
    </font><font color="#0000FF">case </font>nOpcao <font color="#808080">= </font><font color="#FF0000">3 
        </font>tProfiss_codigo<font color="#808080">:=</font><font color="#000080">substr</font><font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">)
        </font>tProfiss_profissao<font color="#808080">:=</font><font color="#000080">substr</font><font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">11</font><font color="#808080">, </font><font color="#FF0000">50</font><font color="#808080">)
        </font><font color="#000080">qout</font><font color="#808080">(</font>tProfiss_codigo<font color="#808080">+&quot; &quot;+</font>tProfiss_profissao<font color="#808080">)
   </font><font color="#0000FF">endcase
elseif </font>sreg <font color="#808080">= </font>opLivro 
   <font color="#0000FF">do case
    case </font>nOpcao <font color="#808080">= </font><font color="#FF0000">1 
        </font><font color="#0000FF">accept </font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">) </font><font color="#0000FF">to </font>tLiv_titulo
        tLiv_edicao<font color="#808080">:=</font>validaNumero<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">), </font>tLiv_edicao<font color="#808080">)
        </font>tLiv_anopubli<font color="#808080">:=</font>validaNumero<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">4</font><font color="#808080">), </font>tLiv_anopubli<font color="#808080">)
        </font>mostrarSubDados<font color="#808080">(</font>opLivro<font color="#808080">, </font>opEditora<font color="#808080">, .</font>f<font color="#808080">.)
        </font>tLiv_volume<font color="#808080">:=</font>validaNumero<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">6</font><font color="#808080">), </font>tLiv_volume<font color="#808080">)
        </font>mostrarSubDados<font color="#808080">(</font>opLivro<font color="#808080">, </font>opIdioma<font color="#808080">, .</font>f<font color="#808080">.)
        </font>tLiv_npaginas<font color="#808080">:=</font>validaNumero<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">8</font><font color="#808080">), </font>tLiv_npaginas<font color="#808080">)
        </font>tLiv_preco<font color="#808080">:=</font>validaNumero<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">9</font><font color="#808080">), </font>tLiv_preco<font color="#808080">)
        </font>tLiv_qtdestoque<font color="#808080">:=</font>validaNumero<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">), </font>tLiv_qtdestoque<font color="#808080">)
    </font><font color="#0000FF">case </font>nOpcao <font color="#808080">= </font><font color="#FF0000">3 
        </font>tLiv_isbn<font color="#808080">:=</font><font color="#000080">alltrim</font><font color="#808080">(</font><font color="#000080">substr</font><font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">13</font><font color="#808080">))
        </font>tLiv_titulo<font color="#808080">:=</font><font color="#000080">alltrim</font><font color="#808080">(</font><font color="#000080">substr</font><font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">14</font><font color="#808080">, </font><font color="#FF0000">50</font><font color="#808080">))
        </font>tLiv_edicao<font color="#808080">:=</font><font color="#000080">alltrim</font><font color="#808080">(</font><font color="#000080">substr</font><font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">64</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">))
        </font>tLiv_anopubli<font color="#808080">:=</font><font color="#000080">alltrim</font><font color="#808080">(</font><font color="#000080">substr</font><font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">74</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">))
        </font>tLiv_codeditora<font color="#808080">:=</font><font color="#000080">alltrim</font><font color="#808080">(</font><font color="#000080">substr</font><font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">84</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">))
        </font>tLiv_volume<font color="#808080">:=</font><font color="#000080">alltrim</font><font color="#808080">(</font><font color="#000080">substr</font><font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">94</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">))
        </font>tLiv_codidioma<font color="#808080">:=</font><font color="#000080">alltrim</font><font color="#808080">(</font><font color="#000080">substr</font><font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">104</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">))
        </font>tLiv_npaginas<font color="#808080">:=</font><font color="#000080">alltrim</font><font color="#808080">(</font><font color="#000080">substr</font><font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">114</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">))
        </font>tLiv_preco<font color="#808080">:=</font><font color="#000080">alltrim</font><font color="#808080">(</font><font color="#000080">substr</font><font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">124</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">))
        </font>tLiv_qtdestoque<font color="#808080">:=</font><font color="#000080">alltrim</font><font color="#808080">(</font><font color="#000080">substr</font><font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">134</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">))
        </font><font color="#000080">qout</font><font color="#808080">(&quot;--------------------&quot;)
        </font><font color="#000080">qout</font><font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">)+ </font>tLiv_isbn<font color="#808080">)
        </font><font color="#000080">qout</font><font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">)+ </font>tLiv_titulo<font color="#808080">)
        </font><font color="#000080">qout</font><font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">)+ </font>tLiv_edicao<font color="#808080">)
        </font><font color="#000080">qout</font><font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">4</font><font color="#808080">)+ </font>tLiv_anopubli<font color="#808080">)
        </font><font color="#000080">qout</font><font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">5</font><font color="#808080">)+ </font>tLiv_codeditora<font color="#808080">)
        </font>mostrarSubDados<font color="#808080">(</font>opLivro<font color="#808080">, </font>opEditora<font color="#808080">, .</font>t<font color="#808080">.)
        </font><font color="#000080">qout</font><font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">6</font><font color="#808080">)+ </font>tLiv_volume<font color="#808080">)
        </font><font color="#000080">qout</font><font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">7</font><font color="#808080">)+ </font>tLiv_codidioma<font color="#808080">)
        </font>mostrarSubDados<font color="#808080">(</font>opLivro<font color="#808080">, </font>opIdioma<font color="#808080">, .</font>t<font color="#808080">.)
        </font><font color="#000080">qout</font><font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">8</font><font color="#808080">)+ </font>tLiv_npaginas<font color="#808080">)
        </font><font color="#000080">qout</font><font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">9</font><font color="#808080">)+ </font>tLiv_preco<font color="#808080">)
        </font><font color="#000080">qout</font><font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">)+ </font>tLiv_qtdestoque<font color="#808080">)
        </font>ListarRegLigados<font color="#808080">(</font>tfLivroAss<font color="#808080">, </font>opLivroAss<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">13</font><font color="#808080">, </font><font color="#FF0000">14</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">, </font>tLiv_isbn<font color="#808080">,;
                         </font>tfAssunto<font color="#808080">, </font>opAssunto<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">4</font><font color="#808080">)
        </font>ListarRegLigados<font color="#808080">(</font>tfLivroAut<font color="#808080">, </font>opLivroAut<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">13</font><font color="#808080">, </font><font color="#FF0000">14</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">, </font>tLiv_isbn<font color="#808080">,;
                         </font>tfAutor<font color="#808080">, </font>opAutor<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">4</font><font color="#808080">)
   </font><font color="#0000FF">endcase
elseif </font>sreg <font color="#808080">= </font>opCliente 
   <font color="#0000FF">do case
    case </font>nOpcao <font color="#808080">= </font><font color="#FF0000">1 
        </font><font color="#0000FF">accept </font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">) </font><font color="#0000FF">to </font>tCli_nome
        <font color="#0000FF">accept </font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">) </font><font color="#0000FF">to </font>tCli_email 
        <font color="#0000FF">accept </font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">4</font><font color="#808080">) </font><font color="#0000FF">to </font>tCli_identidade
        <font color="#0000FF">accept </font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">5</font><font color="#808080">) </font><font color="#0000FF">to </font>tCli_sexo
        <font color="#0000FF">accept </font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">6</font><font color="#808080">) </font><font color="#0000FF">to </font>tCli_telefone
        tCli_dtnascimento<font color="#808080">:=;
                </font>validaDataHora<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">7</font><font color="#808080">), </font>tCli_dtnascimento<font color="#808080">, .</font>t<font color="#808080">.)
        </font>mostrarSubDados<font color="#808080">(</font>opCliente<font color="#808080">, </font>opEndereco<font color="#808080">, .</font>f<font color="#808080">.)
        </font>mostrarSubDados<font color="#808080">(</font>opCliente<font color="#808080">, </font>opPais<font color="#808080">, .</font>f<font color="#808080">.)
        </font>mostrarSubDados<font color="#808080">(</font>opCliente<font color="#808080">, </font>opProfissao<font color="#808080">, .</font>f<font color="#808080">.)
    </font><font color="#0000FF">case </font>nOpcao <font color="#808080">= </font><font color="#FF0000">3 
        </font>tCli_cpf<font color="#808080">:=</font><font color="#000080">alltrim</font><font color="#808080">(</font><font color="#000080">substr</font><font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">14</font><font color="#808080">))
        </font>tCli_nome<font color="#808080">:=</font><font color="#000080">alltrim</font><font color="#808080">(</font><font color="#000080">substr</font><font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">15</font><font color="#808080">, </font><font color="#FF0000">30</font><font color="#808080">))
        </font>tCli_email<font color="#808080">:=</font><font color="#000080">alltrim</font><font color="#808080">(</font><font color="#000080">substr</font><font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">45</font><font color="#808080">, </font><font color="#FF0000">30</font><font color="#808080">))
        </font>tCli_identidade<font color="#808080">:=</font><font color="#000080">alltrim</font><font color="#808080">(</font><font color="#000080">substr</font><font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">75</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">))
        </font>tCli_sexo<font color="#808080">:=</font><font color="#000080">alltrim</font><font color="#808080">(</font><font color="#000080">substr</font><font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">85</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">))
        </font>tCli_telefone<font color="#808080">:=</font><font color="#000080">alltrim</font><font color="#808080">(</font><font color="#000080">substr</font><font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">86</font><font color="#808080">, </font><font color="#FF0000">17</font><font color="#808080">))
        </font>tCli_dtnascimento<font color="#808080">:=</font><font color="#000080">alltrim</font><font color="#808080">(</font><font color="#000080">substr</font><font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">103</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">))
        </font>tCli_codendereco<font color="#808080">:=</font><font color="#000080">alltrim</font><font color="#808080">(</font><font color="#000080">substr</font><font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">113</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">))
        </font>tCli_codpais<font color="#808080">:=</font><font color="#000080">alltrim</font><font color="#808080">(</font><font color="#000080">substr</font><font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">123</font><font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">))
        </font>tCli_codprofissao<font color="#808080">:=</font><font color="#000080">alltrim</font><font color="#808080">(</font><font color="#000080">substr</font><font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">126</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">))
        </font><font color="#000080">qout</font><font color="#808080">(&quot;--------------------&quot;)
        </font><font color="#000080">qout</font><font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">)+ </font>tCli_cpf<font color="#808080">)
        </font><font color="#000080">qout</font><font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">)+ </font>tCli_nome<font color="#808080">)
        </font><font color="#000080">qout</font><font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">)+ </font>tCli_email<font color="#808080">)
        </font><font color="#000080">qout</font><font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">4</font><font color="#808080">)+ </font>tCli_identidade<font color="#808080">)
        </font><font color="#000080">qout</font><font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">5</font><font color="#808080">)+ </font>tCli_sexo<font color="#808080">)
        </font><font color="#000080">qout</font><font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">6</font><font color="#808080">)+ </font>tCli_telefone<font color="#808080">)
        </font><font color="#000080">qout</font><font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">7</font><font color="#808080">)+ </font>tCli_dtnascimento<font color="#808080">)
        </font><font color="#000080">qout</font><font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">8</font><font color="#808080">)+ </font>tCli_codendereco<font color="#808080">)
        </font>mostrarSubDados<font color="#808080">(</font>opCliente<font color="#808080">, </font>opEndereco<font color="#808080">, .</font>t<font color="#808080">.)
        </font><font color="#000080">qout</font><font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">9</font><font color="#808080">)+ </font>tCli_codpais<font color="#808080">)
        </font>mostrarSubDados<font color="#808080">(</font>opCliente<font color="#808080">, </font>opPais<font color="#808080">, .</font>t<font color="#808080">.)
        </font><font color="#000080">qout</font><font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">)+ </font>tCli_codprofissao<font color="#808080">)
        </font>mostrarSubDados<font color="#808080">(</font>opCliente<font color="#808080">, </font>opProfissao<font color="#808080">, .</font>t<font color="#808080">.)
   </font><font color="#0000FF">endcase
elseif </font>sreg <font color="#808080">= </font>opVenda 
   <font color="#0000FF">do case
    case </font>nOpcao <font color="#808080">= </font><font color="#FF0000">1
        </font>mostrarSubDados<font color="#808080">(</font>opVenda<font color="#808080">,</font>opVenda<font color="#808080">, .</font>f<font color="#808080">.)
    </font><font color="#0000FF">case </font>nOpcao <font color="#808080">= </font><font color="#FF0000">2
        </font><font color="#000080">qout</font><font color="#808080">(&quot;</font>DataHoraVenda       CPF            ISBN          <font color="#808080">&quot;+;
        &quot;</font>Pre<font color="#808080">&ccedil;</font>oVenda<font color="#808080">&quot;)
        </font><font color="#000080">qout</font><font color="#808080">(&quot;-------------       ---            ----          &quot;+;
        &quot;----------&quot;)
    </font><font color="#0000FF">case </font>nOpcao <font color="#808080">= </font><font color="#FF0000">3 
        </font>tVenda_dthrvenda<font color="#808080">:=</font><font color="#000080">substr</font><font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">19</font><font color="#808080">)
        </font>tVenda_cpf<font color="#808080">:=</font><font color="#000080">substr</font><font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">20</font><font color="#808080">, </font><font color="#FF0000">14</font><font color="#808080">)
        </font>tVenda_isbn<font color="#808080">:=</font><font color="#000080">substr</font><font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">34</font><font color="#808080">, </font><font color="#FF0000">13</font><font color="#808080">)
        </font>tVenda_precovenda<font color="#808080">:=</font><font color="#000080">substr</font><font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">47</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">)
        </font><font color="#000080">qout</font><font color="#808080">(</font>tVenda_dthrvenda<font color="#808080">+&quot; &quot;+</font>tVenda_cpf<font color="#808080">+&quot; &quot;+</font>tVenda_isbn<font color="#808080">+&quot; &quot;+;
        </font>tVenda_precovenda<font color="#808080">)
   </font><font color="#0000FF">endcase
endif

return
</font><font color="#808080"><i>/*------------------------------------------------------------------------------
Mostra as sub inform&ccedil;&otilde;es de entrada e de sa&iacute;da.
sreg - o tipo de arquivo
ssubreg - o subtipo de arquivo
bSoMostrar - se vai s&oacute; mostrar na sa&iacute;da 
------------------------------------------------------------------------------*/
</i></font><font color="#0000FF">procedure </font>mostrarSubDados<font color="#808080">(</font>sreg<font color="#808080">, </font>ssubreg<font color="#808080">, </font>bSoMostrar<font color="#808080">)
</font><font color="#0000FF">local </font>sRegistro<font color="#808080">, </font>sPreco<font color="#808080">, </font>nStatus<font color="#808080">, </font>nMaxTentativas

nMaxTentativas<font color="#808080">:=</font><font color="#FF0000">3
</font><font color="#0000FF">if </font>sreg <font color="#808080">= </font>opLivro 
  <font color="#0000FF">if </font>ssubreg <font color="#808080">= </font>opEditora
    <font color="#0000FF">if </font>bSoMostrar
       sRegistro<font color="#808080">:=</font>pesqArq<font color="#808080">(</font>tfEditora<font color="#808080">,</font>tLiv_codeditora<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">,</font>tamReg<font color="#808080">(</font>opEditora<font color="#808080">))
    </font><font color="#0000FF">else
       </font>sRegistro<font color="#808080">:=</font>validaEntrada<font color="#808080">(</font>tfEditora<font color="#808080">,</font>ssubreg<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font>tLiv_codeditora<font color="#808080">,;
                  </font>nMaxTentativas<font color="#808080">,.</font>f<font color="#808080">.,</font>opNumero<font color="#808080">)
    </font><font color="#0000FF">endif
    if </font><font color="#808080">!</font><font color="#000080">empty</font><font color="#808080">(</font>sRegistro<font color="#808080">) 
      </font>tLiv_codeditora<font color="#808080">:=</font><font color="#000080">alltrim</font><font color="#808080">(</font><font color="#000080">substr</font><font color="#808080">(</font>sRegistro<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">))
      </font><font color="#000080">qout</font><font color="#808080">(&quot; &quot;+</font>rotulo<font color="#808080">(</font>opEditora<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">))
      </font><font color="#000080">qqout</font><font color="#808080">(</font><font color="#000080">substr</font><font color="#808080">(</font>sRegistro<font color="#808080">, </font>g_nPosChave<font color="#808080">, </font>g_nTamChave<font color="#808080">))
    </font><font color="#0000FF">endif
  elseif </font>ssubreg <font color="#808080">= </font>opIdioma
    <font color="#0000FF">if </font>bSoMostrar
       sRegistro<font color="#808080">:=</font>pesqArq<font color="#808080">(</font>tfIdioma<font color="#808080">, </font>tLiv_codidioma<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">,</font>tamReg<font color="#808080">(</font>opIdioma<font color="#808080">))
    </font><font color="#0000FF">else
       </font>sRegistro<font color="#808080">:=</font>validaEntrada<font color="#808080">(</font>tfIdioma<font color="#808080">,</font>ssubreg<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font>tLiv_codidioma<font color="#808080">,;
                  </font>nMaxTentativas<font color="#808080">,.</font>f<font color="#808080">.,</font>opNumero<font color="#808080">)
    </font><font color="#0000FF">endif
    if </font><font color="#808080">!</font><font color="#000080">empty</font><font color="#808080">(</font>sRegistro<font color="#808080">) 
      </font>tLiv_codidioma<font color="#808080">:=</font><font color="#000080">alltrim</font><font color="#808080">(</font><font color="#000080">substr</font><font color="#808080">(</font>sRegistro<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">))
      </font><font color="#000080">qout</font><font color="#808080">(&quot; &quot;+</font>rotulo<font color="#808080">(</font>opIdioma<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">))
      </font><font color="#000080">qqout</font><font color="#808080">(</font><font color="#000080">substr</font><font color="#808080">(</font>sRegistro<font color="#808080">, </font>g_nPosChave<font color="#808080">, </font>g_nTamChave<font color="#808080">))
    </font><font color="#0000FF">endif
  endif
elseif </font>sreg <font color="#808080">= </font>opCliente 
  <font color="#0000FF">if </font>ssubreg <font color="#808080">= </font>opEndereco
    <font color="#0000FF">if </font>bSoMostrar
       sRegistro<font color="#808080">:=</font>pesqArq<font color="#808080">(</font>tfEndereco<font color="#808080">, </font>tCli_codendereco<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">,;
                  </font>tamReg<font color="#808080">(</font>opEndereco<font color="#808080">))
    </font><font color="#0000FF">else
       </font>sRegistro<font color="#808080">:=</font>validaEntrada<font color="#808080">(</font>tfEndereco<font color="#808080">,</font>ssubreg<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font>tCli_codendereco<font color="#808080">,;
                  </font>nMaxTentativas<font color="#808080">,.</font>f<font color="#808080">.,</font>opNumero<font color="#808080">)
    </font><font color="#0000FF">endif
    if </font><font color="#808080">!</font><font color="#000080">empty</font><font color="#808080">(</font>sRegistro<font color="#808080">) 
      </font>tCli_codendereco<font color="#808080">:=</font><font color="#000080">alltrim</font><font color="#808080">(</font><font color="#000080">substr</font><font color="#808080">(</font>sRegistro<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">))
      </font><font color="#000080">qout</font><font color="#808080">(&quot; &quot;+</font>rotulo<font color="#808080">(</font>opEndereco<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">))
      </font><font color="#000080">qqout</font><font color="#808080">(</font><font color="#000080">substr</font><font color="#808080">(</font>sRegistro<font color="#808080">, </font>g_nPosChave<font color="#808080">, </font>g_nTamChave<font color="#808080">))
      </font><font color="#000080">qout</font><font color="#808080">(&quot; &quot;+</font>rotulo<font color="#808080">(</font>opEndereco<font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">))
      </font><font color="#000080">qqout</font><font color="#808080">(</font><font color="#000080">substr</font><font color="#808080">(</font>sRegistro<font color="#808080">, </font>g_nPosChave<font color="#808080">, </font>g_nTamChave<font color="#808080">))
      </font><font color="#000080">qout</font><font color="#808080">(&quot; &quot;+</font>rotulo<font color="#808080">(</font>opEndereco<font color="#808080">, </font><font color="#FF0000">4</font><font color="#808080">))
      </font><font color="#000080">qqout</font><font color="#808080">(</font><font color="#000080">substr</font><font color="#808080">(</font>sRegistro<font color="#808080">, </font>g_nPosChave<font color="#808080">, </font>g_nTamChave<font color="#808080">))
      </font><font color="#000080">qout</font><font color="#808080">(&quot; &quot;+</font>rotulo<font color="#808080">(</font>opEndereco<font color="#808080">, </font><font color="#FF0000">5</font><font color="#808080">))
      </font><font color="#000080">qqout</font><font color="#808080">(</font><font color="#000080">substr</font><font color="#808080">(</font>sRegistro<font color="#808080">, </font>g_nPosChave<font color="#808080">, </font>g_nTamChave<font color="#808080">))
      </font><font color="#000080">qout</font><font color="#808080">(&quot; &quot;+</font>rotulo<font color="#808080">(</font>opEndereco<font color="#808080">, </font><font color="#FF0000">6</font><font color="#808080">))
      </font><font color="#000080">qqout</font><font color="#808080">(</font><font color="#000080">substr</font><font color="#808080">(</font>sRegistro<font color="#808080">, </font>g_nPosChave<font color="#808080">, </font>g_nTamChave<font color="#808080">))
    </font><font color="#0000FF">endif
  elseif </font>ssubreg <font color="#808080">= </font>opPais
    <font color="#0000FF">if </font>bSoMostrar
       sRegistro<font color="#808080">:=</font>pesqArq<font color="#808080">(</font>tfPais<font color="#808080">, </font>tCli_codpais<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">, </font>tamReg<font color="#808080">(</font>opPais<font color="#808080">))
    </font><font color="#0000FF">else
       </font>sRegistro<font color="#808080">:=</font>validaEntrada<font color="#808080">(</font>tfPais<font color="#808080">,</font>ssubreg<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font>tCli_codpais<font color="#808080">,;
                  </font>nMaxTentativas<font color="#808080">,.</font>f<font color="#808080">.,</font>opTexto<font color="#808080">)
    </font><font color="#0000FF">endif
    if </font><font color="#808080">!</font><font color="#000080">empty</font><font color="#808080">(</font>sRegistro<font color="#808080">) 
      </font>tCli_codpais<font color="#808080">:=</font><font color="#000080">alltrim</font><font color="#808080">(</font><font color="#000080">substr</font><font color="#808080">(</font>sRegistro<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#FF0000">3</font><font color="#808080">))
      </font><font color="#000080">qout</font><font color="#808080">(&quot; &quot;+</font>rotulo<font color="#808080">(</font>opPais<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">))
      </font><font color="#000080">qqout</font><font color="#808080">(</font><font color="#000080">substr</font><font color="#808080">(</font>sRegistro<font color="#808080">, </font>g_nPosChave<font color="#808080">, </font>g_nTamChave<font color="#808080">))
    </font><font color="#0000FF">endif
  elseif </font>ssubreg <font color="#808080">= </font>opProfissao
    <font color="#0000FF">if </font>bSoMostrar
       sRegistro<font color="#808080">:=</font>pesqArq<font color="#808080">(</font>tfProfissao<font color="#808080">, </font>tCli_codprofissao<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">,;
                  </font>tamReg<font color="#808080">(</font>opProfissao<font color="#808080">))
    </font><font color="#0000FF">else
       </font>sRegistro<font color="#808080">:=</font>validaEntrada<font color="#808080">(</font>tfProfissao<font color="#808080">,</font>ssubreg<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font>tCli_codprofissao<font color="#808080">,;
                  </font>nMaxTentativas<font color="#808080">,.</font>f<font color="#808080">.,</font>opNumero<font color="#808080">)
    </font><font color="#0000FF">endif
    if </font><font color="#808080">!</font><font color="#000080">empty</font><font color="#808080">(</font>sRegistro<font color="#808080">) 
      </font>tCli_codprofissao<font color="#808080">:=</font><font color="#000080">alltrim</font><font color="#808080">(</font><font color="#000080">substr</font><font color="#808080">(</font>sRegistro<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">))
      </font><font color="#000080">qout</font><font color="#808080">(&quot; &quot;+</font>rotulo<font color="#808080">(</font>opProfissao<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">))
      </font><font color="#000080">qqout</font><font color="#808080">(</font><font color="#000080">substr</font><font color="#808080">(</font>sRegistro<font color="#808080">, </font>g_nPosChave<font color="#808080">, </font>g_nTamChave<font color="#808080">))
    </font><font color="#0000FF">endif
  endif
elseif </font>sreg <font color="#808080">= </font>opVenda 
  sRegistro<font color="#808080">:=</font>pesqArq<font color="#808080">(</font>tfLivro<font color="#808080">, </font>tVenda_isbn<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">13</font><font color="#808080">, </font>tamReg<font color="#808080">(</font>opLivro<font color="#808080">))
  </font><font color="#0000FF">if </font><font color="#808080">!</font><font color="#000080">empty</font><font color="#808080">(</font>sRegistro<font color="#808080">) 
    </font><font color="#000080">qout</font><font color="#808080">(&quot; &quot;+</font>rotulo<font color="#808080">(</font>opLivro<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">)) <i>/* Titulo */
    </i></font><font color="#000080">qqout</font><font color="#808080">(</font><font color="#000080">substr</font><font color="#808080">(</font>sRegistro<font color="#808080">, </font>g_nPosChave<font color="#808080">, </font>g_nTamChave<font color="#808080">))
    </font><font color="#000080">qout</font><font color="#808080">(&quot; &quot;+</font>rotulo<font color="#808080">(</font>opLivro<font color="#808080">, </font><font color="#FF0000">9</font><font color="#808080">)) <i>/* Preco */
    </i></font>sPreco<font color="#808080">:=</font><font color="#000080">substr</font><font color="#808080">(</font>sRegistro<font color="#808080">, </font>g_nPosChave<font color="#808080">, </font>g_nTamChave<font color="#808080">)
    </font>g_nPreco<font color="#808080">:=</font><font color="#000080">val</font><font color="#808080">(</font>sPreco<font color="#808080">)
    </font><font color="#000080">qqout</font><font color="#808080">(</font>sPreco<font color="#808080">)
  </font><font color="#0000FF">endif
endif
return
</font><font color="#808080"><i>/*------------------------------------------------------------------------------
Realiza os cadastros dos arquivos que se ligam a outros arquivos.
sreg - o tipo de arquivo
sacao - a a&ccedil;&atilde;o a ser realizada
sCodigo - um das chaves do arquivo de liga&ccedil;&atilde;o
------------------------------------------------------------------------------*/
</i></font><font color="#0000FF">procedure </font>frmCadLigados<font color="#808080">(</font>sreg<font color="#808080">, </font>sacao<font color="#808080">, </font>sCodigo<font color="#808080">)
</font><font color="#0000FF">local </font>nQtd<font color="#808080">, </font>nCont<font color="#808080">, </font>nQtdEstoque<font color="#808080">, </font>nStatus
<font color="#0000FF">local </font>nTotalPreco<font color="#808080">, </font>slinha<font color="#808080">, </font>sTotalPreco<font color="#808080">, </font>sPreco<font color="#808080">, </font>sQtd

<font color="#0000FF">if </font>sacao <font color="#808080">= </font>opNovo 
  nCont<font color="#808080">:=</font><font color="#FF0000">1
  </font><font color="#0000FF">if </font>sreg <font color="#808080">= </font>opLivroAss 
    sQtd<font color="#808080">:=</font>validaNumero<font color="#808080">(&quot;</font>Quantos assuntos quer cadastrar<font color="#808080">?: &quot;, </font>sQtd<font color="#808080">)
    </font>nQtd<font color="#808080">:=</font><font color="#000080">Val</font><font color="#808080">(</font>sQtd<font color="#808080">)
    </font><font color="#000080">fseek</font><font color="#808080">(</font>tfLivroAss<font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font>FS_SET<font color="#808080">)
    </font><font color="#0000FF">do while </font>nCont <font color="#808080">&lt;= </font>nQtd
      tLivAss_isbn<font color="#808080">:=</font>sCodigo
      <font color="#0000FF">accept </font>rotulo<font color="#808080">(</font>opLivroAss<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">) </font><font color="#0000FF">to </font>tLivAss_codassunto
      slinha<font color="#808080">:=</font>pesqArq<font color="#808080">(</font>tfAssunto<font color="#808080">, </font>tLivAss_codassunto<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">,</font>tamReg<font color="#808080">(</font>opAssunto<font color="#808080">))
      </font><font color="#000080">qqout</font><font color="#808080">(&quot; &quot;+</font>rotulo<font color="#808080">(</font>opAssunto<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">))
      </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#000080">substr</font><font color="#808080">(</font>slinha<font color="#808080">, </font>g_nPosChave<font color="#808080">, </font>g_nTamChave<font color="#808080">))
      </font>pesqLinhaExcluida<font color="#808080">(</font>tfLivroAss<font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">))
      </font>subMenu<font color="#808080">(</font><font color="#FF0000">14</font><font color="#808080">, </font>sreg<font color="#808080">)
      </font>nCont<font color="#808080">++
    </font><font color="#0000FF">enddo
  elseif </font>sreg <font color="#808080">= </font>opLivroAut 
    sQtd<font color="#808080">:=</font>validaNumero<font color="#808080">(&quot;</font>Quantos autores quer cadastrar<font color="#808080">?: &quot;,</font>sQtd<font color="#808080">)
    </font>nQtd<font color="#808080">:=</font><font color="#000080">Val</font><font color="#808080">(</font>sQtd<font color="#808080">)
    </font><font color="#000080">fseek</font><font color="#808080">(</font>tfLivroAut<font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font>FS_SET<font color="#808080">)
    </font><font color="#0000FF">do while </font>nCont <font color="#808080">&lt;= </font>nQtd
      tLivAut_isbn<font color="#808080">:=</font>sCodigo
      <font color="#0000FF">accept </font>rotulo<font color="#808080">(</font>opLivroAut<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">) </font><font color="#0000FF">to </font>tLivAut_codautor
      slinha<font color="#808080">:=</font>pesqArq<font color="#808080">(</font>tfAutor<font color="#808080">, </font>tLivAut_codautor<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">,</font>tamReg<font color="#808080">(</font>opAutor<font color="#808080">))
      </font><font color="#000080">qqout</font><font color="#808080">(&quot; &quot;+</font>rotulo<font color="#808080">(</font>opAutor<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">))
      </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#000080">substr</font><font color="#808080">(</font>slinha<font color="#808080">, </font>g_nPosChave<font color="#808080">, </font>g_nTamChave<font color="#808080">))
      </font>pesqLinhaExcluida<font color="#808080">(</font>tfLivroAut<font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">))
      </font>subMenu<font color="#808080">(</font><font color="#FF0000">14</font><font color="#808080">, </font>sreg<font color="#808080">)
      </font>nCont<font color="#808080">++
    </font><font color="#0000FF">enddo
  elseif </font>sreg <font color="#808080">= </font>opVenda
    sQtd<font color="#808080">:=</font>validaNumero<font color="#808080">(&quot;</font>Quantos livros quer vender<font color="#808080">?: &quot;,</font>sQtd<font color="#808080">)
    </font>nQtd<font color="#808080">:=</font><font color="#000080">Val</font><font color="#808080">(</font>sQtd<font color="#808080">)
    </font>nTotalPreco<font color="#808080">:=</font><font color="#FF0000">0
    </font><font color="#0000FF">do while </font>nCont <font color="#808080">&lt;= </font>nQtd
      slinha<font color="#808080">:=</font>validaEntrada<font color="#808080">(</font>tfLivro<font color="#808080">,</font>opLivro<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font>tVenda_isbn<font color="#808080">,</font><font color="#FF0000">3</font><font color="#808080">,.</font>f<font color="#808080">.,</font>opTexto<font color="#808080">)
      </font><font color="#0000FF">if </font><font color="#808080">!</font><font color="#000080">empty</font><font color="#808080">(</font>slinha<font color="#808080">) 
        </font>tVenda_isbn<font color="#808080">:=</font><font color="#000080">alltrim</font><font color="#808080">(</font><font color="#000080">substr</font><font color="#808080">(</font>slinha<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#FF0000">13</font><font color="#808080">))
        </font><font color="#0000FF">if </font>validaISBN<font color="#808080">(</font>tVenda_isbn<font color="#808080">) 
          </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, &quot;&quot;, </font><font color="#FF0000">1</font><font color="#808080">)
          </font>tLiv_qtdestoque<font color="#808080">:=</font><font color="#000080">alltrim</font><font color="#808080">(</font><font color="#000080">substr</font><font color="#808080">(</font>slinha<font color="#808080">,</font><font color="#FF0000">134</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">))
          </font>nQtdEstoque<font color="#808080">:=</font><font color="#000080">val</font><font color="#808080">(</font>tLiv_qtdestoque<font color="#808080">)
          </font><font color="#0000FF">if </font>nQtdEstoque <font color="#808080">&gt; </font><font color="#FF0000">0 
             </font>nTotalPreco<font color="#808080">:=</font>nTotalPreco <font color="#808080">+ </font>g_nPreco
             sPreco<font color="#808080">:=</font><font color="#000080">alltrim</font><font color="#808080">(</font><font color="#000080">str</font><font color="#808080">(</font>g_nPreco<font color="#808080">,</font><font color="#FF0000">7</font><font color="#808080">,</font><font color="#FF0000">2</font><font color="#808080">))
             </font>tVenda_precovenda<font color="#808080">:=</font>sPreco
             g_SalvarInclusao<font color="#808080">:=.</font>f<font color="#808080">.
             </font>subMenu<font color="#808080">(</font><font color="#FF0000">14</font><font color="#808080">, </font>sreg<font color="#808080">)
             </font><font color="#0000FF">if </font>g_SalvarInclusao 
                slinha<font color="#808080">:=</font>pesqArq<font color="#808080">(</font>tfLivro<font color="#808080">, </font>tVenda_isbn<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">13</font><font color="#808080">, </font>tamReg<font color="#808080">(</font>opLivro<font color="#808080">))
                </font><font color="#0000FF">if </font><font color="#808080">!</font><font color="#000080">empty</font><font color="#808080">(</font>slinha<font color="#808080">) 
                   </font>nQtdEstoque<font color="#808080">:=</font>nQtdEstoque<font color="#808080">-</font><font color="#FF0000">1
                   </font>tLiv_qtdestoque<font color="#808080">:=</font><font color="#000080">alltrim</font><font color="#808080">(</font><font color="#000080">str</font><font color="#808080">(</font>nQtdEstoque<font color="#808080">))
                   </font>slinha<font color="#808080">:=</font><font color="#000080">substr</font><font color="#808080">(</font>slinha<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#FF0000">133</font><font color="#808080">)+</font>esp<font color="#808080">(</font>tLiv_qtdestoque<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">)
                   </font>escreveArq<font color="#808080">(</font>tfLivro<font color="#808080">, </font>slinha<font color="#808080">, &quot;&quot;, &quot;&quot;)
                </font><font color="#0000FF">endif
             endif
             </font>nCont<font color="#808080">++
          </font><font color="#0000FF">else 
            </font><font color="#000080">qout</font><font color="#808080">(</font>MSG_SEMESTOQUE<font color="#808080">)
          </font><font color="#0000FF">endif
        else 
          </font><font color="#000080">qout</font><font color="#808080">(</font>MSG_ISBNINV<font color="#808080">)
        </font><font color="#0000FF">endif    
      endif
    enddo
    </font>sTotalPreco<font color="#808080">:=</font><font color="#000080">alltrim</font><font color="#808080">(</font><font color="#000080">str</font><font color="#808080">(</font>nTotalPreco<font color="#808080">,</font><font color="#FF0000">7</font><font color="#808080">,</font><font color="#FF0000">2</font><font color="#808080">))
    </font><font color="#000080">qout</font><font color="#808080">(&quot;</font><font color="#0000FF">Total </font>de <font color="#808080">&quot;+</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">,</font><font color="#FF0000">4</font><font color="#808080">)+</font>sTotalPreco<font color="#808080">)
  </font><font color="#0000FF">endif
elseif </font>sacao <font color="#808080">= </font>opExcluir 
  <font color="#0000FF">if </font>sreg <font color="#808080">= </font>opLivroAss 
     ExcluirRegLigados<font color="#808080">(</font>tfLivroAss<font color="#808080">, </font>sreg<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">13</font><font color="#808080">, </font>sCodigo<font color="#808080">)
  </font><font color="#0000FF">elseif </font>sreg <font color="#808080">= </font>opLivroAut 
     ExcluirRegLigados<font color="#808080">(</font>tfLivroAut<font color="#808080">, </font>sreg<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">13</font><font color="#808080">, </font>sCodigo<font color="#808080">)
  </font><font color="#0000FF">endif
endif

return
</font><font color="#808080"><i>/*------------------------------------------------------------------------------
Realiza a exclus&atilde;o dos arquivos de liga&ccedil;&atilde;o.
sArq - o arquivo de liga&ccedil;&atilde;o
sreg - o tipo de arquivo de liga&ccedil;&atilde;o
nPosChave - a posicao inicial da chave dentro do registro
nTamChave - o tamanho da chave dentro do registro
sChave - a chave a ser excluida
------------------------------------------------------------------------------*/
</i></font><font color="#0000FF">procedure </font>ExcluirRegLigados<font color="#808080">(</font>sArq<font color="#808080">, </font>sreg<font color="#808080">, </font>nPosChave<font color="#808080">, </font>nTamChave<font color="#808080">, </font>sChave<font color="#808080">)
</font><font color="#0000FF">local </font>slinha<font color="#808080">, </font>sCodigo<font color="#808080">, </font>nStatus<font color="#808080">, </font>nler

  nler <font color="#808080">:= </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">) + </font>TAM_CRLF
  slinha<font color="#808080">:=</font><font color="#000080">space</font><font color="#808080">(</font>nler<font color="#808080">)
  </font><font color="#000080">fseek</font><font color="#808080">(</font>sArq<font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font>FS_SET<font color="#808080">)
  </font><font color="#0000FF">do while </font><font color="#808080">!</font>fimArq<font color="#808080">(</font>sArq<font color="#808080">)
    </font><font color="#000080">fread</font><font color="#808080">(</font>sArq<font color="#808080">, @</font>slinha<font color="#808080">, </font>nler<font color="#808080">)
    </font>sCodigo<font color="#808080">:=</font><font color="#000080">alltrim</font><font color="#808080">(</font><font color="#000080">substr</font><font color="#808080">(</font>slinha<font color="#808080">,</font>nPosChave<font color="#808080">,</font>nTamChave<font color="#808080">))
    </font><font color="#0000FF">if </font>sCodigo<font color="#808080">==</font>sChave
       btnAcao<font color="#808080">(</font>sreg<font color="#808080">,</font>opConfirmaExclusao<font color="#808080">)
    </font><font color="#0000FF">endif
  enddo
return
</font></font>
</code></pre>
</body>
</html>