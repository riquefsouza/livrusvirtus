<html>
<head>
<title>Livrus Virtus - Console - Ruby</title>
</head>
<!-- Generated by ConTEXT HTML exporter -->
<body text="#000000" bgcolor="#FFFFFF">
<pre>
<code><font  face="Courier New"><font color="#808080">#!/usr/local/bin/ruby
#------------------------------------------------------------------------------
# Sistema integrante do projeto Livrus Virtus.
# Todos os direitos reservados para Henrique F. de Souza.
# Vers&atilde;o programada na linguagem Ruby.
#------------------------------------------------------------------------------
#  programa Livrus

# tipos
</font>regAssunto = <font color="#008080"><b>{ </b></font><font color="#800000">&quot;codigo&quot;</font>=&gt;<font color="#800000">&quot;&quot;</font>, <font color="#800000">&quot;assunto&quot;</font>=&gt;<font color="#800000">&quot;&quot; </font><font color="#008080"><b>}
</b></font>regAutor = <font color="#008080"><b>{ </b></font><font color="#800000">&quot;codigo&quot;</font>=&gt;<font color="#800000">&quot;&quot;</font>, <font color="#800000">&quot;autor&quot;</font>=&gt;<font color="#800000">&quot;&quot; </font><font color="#008080"><b>}
</b></font>regEditora = <font color="#008080"><b>{ </b></font><font color="#800000">&quot;codigo&quot;</font>=&gt;<font color="#800000">&quot;&quot;</font>, <font color="#800000">&quot;editora&quot;</font>=&gt;<font color="#800000">&quot;&quot; </font><font color="#008080"><b>}
</b></font>regIdioma = <font color="#008080"><b>{ </b></font><font color="#800000">&quot;codigo&quot;</font>=&gt;<font color="#800000">&quot;&quot;</font>, <font color="#800000">&quot;idioma&quot;</font>=&gt;<font color="#800000">&quot;&quot; </font><font color="#008080"><b>}
</b></font>regUsuario = <font color="#008080"><b>{ </b></font><font color="#800000">&quot;login&quot;</font>=&gt;<font color="#800000">&quot;&quot;</font>, <font color="#800000">&quot;senha&quot;</font>=&gt;<font color="#800000">&quot;&quot; </font><font color="#008080"><b>}
</b></font>regPais = <font color="#008080"><b>{ </b></font><font color="#800000">&quot;codigo&quot;</font>=&gt;<font color="#800000">&quot;&quot;</font>, <font color="#800000">&quot;pais&quot;</font>=&gt;<font color="#800000">&quot;&quot; </font><font color="#008080"><b>}
</b></font>regProfissao = <font color="#008080"><b>{ </b></font><font color="#800000">&quot;codigo&quot;</font>=&gt;<font color="#800000">&quot;&quot;</font>, <font color="#800000">&quot;profissao&quot;</font>=&gt;<font color="#800000">&quot;&quot; </font><font color="#008080"><b>}
</b></font>regLivro = <font color="#008080"><b>{ </b></font><font color="#800000">&quot;isbn&quot;</font>=&gt;<font color="#800000">&quot;&quot;</font>, <font color="#800000">&quot;titulo&quot;</font>=&gt;<font color="#800000">&quot;&quot;</font>, <font color="#800000">&quot;edicao&quot;</font>=&gt;<font color="#800000">&quot;&quot;</font>, <font color="#800000">&quot;anopubli&quot;</font>=&gt;<font color="#800000">&quot;&quot;</font>, 
             <font color="#800000">&quot;codeditora&quot;</font>=&gt;<font color="#800000">&quot;&quot;</font>, <font color="#800000">&quot;volume&quot;</font>=&gt;<font color="#800000">&quot;&quot;</font>, <font color="#800000">&quot;codidioma&quot;</font>=&gt;<font color="#800000">&quot;&quot;</font>,
             <font color="#800000">&quot;npaginas&quot;</font>=&gt;<font color="#800000">&quot;&quot;</font>, <font color="#800000">&quot;preco&quot;</font>=&gt;<font color="#800000">&quot;&quot;</font>, <font color="#800000">&quot;qtdestoque&quot;</font>=&gt;<font color="#800000">&quot;&quot; </font><font color="#008080"><b>}
</b></font>regLivroAss = <font color="#008080"><b>{ </b></font><font color="#800000">&quot;isbn&quot;</font>=&gt;<font color="#800000">&quot;&quot;</font>, <font color="#800000">&quot;codassunto&quot;</font>=&gt;<font color="#800000">&quot;&quot; </font><font color="#008080"><b>}
</b></font>regLivroAut = <font color="#008080"><b>{ </b></font><font color="#800000">&quot;isbn&quot;</font>=&gt;<font color="#800000">&quot;&quot;</font>, <font color="#800000">&quot;codautor&quot;</font>=&gt;<font color="#800000">&quot;&quot; </font><font color="#008080"><b>}
</b></font>regCliente = <font color="#008080"><b>{ </b></font><font color="#800000">&quot;cpf&quot;</font>=&gt;<font color="#800000">&quot;&quot;</font>, <font color="#800000">&quot;nome&quot;</font>=&gt;<font color="#800000">&quot;&quot;</font>, <font color="#800000">&quot;email&quot;</font>=&gt;<font color="#800000">&quot;&quot;</font>, <font color="#800000">&quot;identidade&quot;</font>=&gt;<font color="#800000">&quot;&quot;</font>,
               <font color="#800000">&quot;sexo&quot;</font>=&gt;<font color="#800000">&quot;&quot;</font>, <font color="#800000">&quot;telefone&quot;</font>=&gt;<font color="#800000">&quot;&quot;</font>, <font color="#800000">&quot;dtnascimento&quot;</font>=&gt;<font color="#800000">&quot;&quot;</font>,
               <font color="#800000">&quot;codendereco&quot;</font>=&gt;<font color="#800000">&quot;&quot;</font>, <font color="#800000">&quot;codpais&quot;</font>=&gt;<font color="#800000">&quot;&quot;</font>, <font color="#800000">&quot;codprofissao&quot;</font>=&gt;<font color="#800000">&quot;&quot; </font><font color="#008080"><b>}
</b></font>regEndereco = <font color="#008080"><b>{ </b></font><font color="#800000">&quot;codigo&quot;</font>=&gt;<font color="#800000">&quot;&quot;</font>, <font color="#800000">&quot;logradouro&quot;</font>=&gt;<font color="#800000">&quot;&quot;</font>, <font color="#800000">&quot;bairro&quot;</font>=&gt;<font color="#800000">&quot;&quot;</font>, <font color="#800000">&quot;cep&quot;</font>=&gt;<font color="#800000">&quot;&quot;</font>,
                <font color="#800000">&quot;cidade&quot;</font>=&gt;<font color="#800000">&quot;&quot;</font>, <font color="#800000">&quot;estado&quot;</font>=&gt;<font color="#800000">&quot;&quot; </font><font color="#008080"><b>}
</b></font>regVenda = <font color="#008080"><b>{ </b></font><font color="#800000">&quot;dthrvenda&quot;</font>=&gt;<font color="#800000">&quot;&quot;</font>, <font color="#808080"># data/hora da venda dd/mm/yyyy hh:mm:ss
             </font><font color="#800000">&quot;cpf&quot;</font>=&gt;<font color="#800000">&quot;&quot;</font>, <font color="#800000">&quot;isbn&quot;</font>=&gt;<font color="#800000">&quot;&quot;</font>, <font color="#800000">&quot;precovenda&quot;</font>=&gt;<font color="#800000">&quot;&quot; </font><font color="#008080"><b>}

</b></font><font color="#808080"># Constantes

# ctTipo 
</font>OPTEXTO, OPNUMERO, OPDATA, OPDATAHORA, OPSENHA = 1, 2, 3, 4, 5

<font color="#808080"># ctArqs
</font>OPASSUNTO, OPAUTOR, OPEDITORA, OPENDERECO, OPIDIOMA, OPPAIS,
OPPROFISSAO, OPCLIENTE, OPLIVRO, OPLIVROASS, OPLIVROAUT,
OPUSUARIO, OPVENDA = 1, 2, 3, 4, 5, 6 , 7, 8, 9, 10, 11, 12, 13

<font color="#808080"># ctAcao
</font>OPNOVO, OPALTERAR, OPPESQUISAR, OPSALVARINCLUSAO, OPSALVARALTERACAO, 
OPEXCLUIR, OPCONFIRMAEXCLUSAO, OPLISTARTODOS = 1, 2, 3, 4, 5, 6 , 7, 8

CRLF = <font color="#800000">&quot;\r\n&quot; </font><font color="#808080"># windows
</font>TAM_CRLF = 2
<font color="#808080"># CRLF = &quot;\n&quot;
# TAM_CRLF = 1 # unix
# CRLF = &quot;\r&quot;
# TAM_CRLF = 1 # macintosh

</font>QTD_MAX_LINHA = 18
TAM_MAX_STR = 255
TAM_MAX_REG = 145

MSG_ARQERRO = <font color="#800000">&quot;Erro: O arquivo n&atilde;o pode ser aberto.\n&quot;
</font>MSG_ERRO = <font color="#800000">&quot;Erro: op&ccedil;&atilde;o inv&aacute;lida digite de novo\n&quot;
</font>MSG_OPCAO = <font color="#800000">&quot;Escolha uma op&ccedil;&atilde;o: &quot;
</font>MSG_PRESS = <font color="#800000">&quot;pressione para continuar...&quot;

</font>MSG_REGINC = <font color="#800000">&quot;registro incluido!\n&quot;
</font>MSG_REGNINC = <font color="#800000">&quot;registro n&atilde;o incluido!\n&quot;
</font>MSG_REGALT = <font color="#800000">&quot;registro alterado!\n&quot;
</font>MSG_REGNALT = <font color="#800000">&quot;registro n&atilde;o alterado!\n&quot;
</font>MSG_REGEXC = <font color="#800000">&quot;registro excluido!\n&quot;
</font>MSG_REGNEXC = <font color="#800000">&quot;registro n&atilde;o excluido!\n&quot;
</font>MSG_REGEXST = <font color="#800000">&quot;registro j&aacute; existe!\n&quot;

</font>MSG_NUMINV = <font color="#800000">&quot;N&uacute;mero inv&aacute;lido ou menor do que 1!\n&quot;
</font>MSG_DATAINV = <font color="#800000">&quot;Data inv&aacute;lida!, formato correto (dd/mm/yyyy)\n&quot;
</font>MSG_DTHRINV = <font color="#800000">&quot;Data/hora inv&aacute;lida!, formato correto (dd/mm/yyyy hh:mm:ss)\n&quot;
</font>MSG_ISBNINV = <font color="#800000">&quot;ISBN inv&aacute;lido!\n&quot;
</font>MSG_CPFINV = <font color="#800000">&quot;CPF inv&aacute;lido!\n&quot;
</font>MSG_SENCONFERE = <font color="#800000">&quot;senha n&atilde;o confere com a senha atual!\n&quot;
</font>MSG_SENCONFIRM = <font color="#800000">&quot;nova senha n&atilde;o confere com a senha confirmada!\n&quot;
</font>MSG_LOGINENCON = <font color="#800000">&quot;login n&atilde;o encontrado!\n&quot;
</font>MSG_SEMESTOQUE = <font color="#800000">&quot;livro n&atilde;o existe no estoque!\n&quot;

</font>ARQ_ASSUNTO = <font color="#800000">&quot;assunto.dat&quot;
</font>ARQ_AUTOR = <font color="#800000">&quot;autor.dat&quot;
</font>ARQ_EDITORA = <font color="#800000">&quot;editora.dat&quot;
</font>ARQ_IDIOMA = <font color="#800000">&quot;idioma.dat&quot;
</font>ARQ_USUARIO = <font color="#800000">&quot;usuario.dat&quot;
</font>ARQ_PAIS = <font color="#800000">&quot;pais.dat&quot;
</font>ARQ_PROFISSAO = <font color="#800000">&quot;profissao.dat&quot;
</font>ARQ_LIVRO = <font color="#800000">&quot;livro.dat&quot;
</font>ARQ_LIVASS = <font color="#800000">&quot;livroass.dat&quot;
</font>ARQ_LIVAUT = <font color="#800000">&quot;livroaut.dat&quot;
</font>ARQ_CLIENTE = <font color="#800000">&quot;cliente.dat&quot;
</font>ARQ_ENDERECO = <font color="#800000">&quot;endereco.dat&quot;
</font>ARQ_VENDA = <font color="#800000">&quot;venda.dat&quot;

</font>TAM_ASSUNTO = 40
TAM_AUTOR = 40
TAM_EDITORA = 60
TAM_IDIOMA = 30
TAM_USUARIO = 20
TAM_PAIS = 53
TAM_PROFISSAO = 60
TAM_LIVRO = 143
TAM_LIVASS = 23
TAM_LIVAUT = 23
TAM_CLIENTE = 135
TAM_ENDERECO = 123
TAM_VENDA = 56

TAssunto = regAssunto
TAutor = regAutor
TEditora = regEditora
TIdioma = regIdioma
TEndereco = regEndereco
TPais = regPais
TProfissao = regProfissao
TLivro = regLivro
TLivroAss = regLivroAss
TLivroAut = regLivroAut
TCliente = regCliente
TUsuario = regUsuario
TVenda = regVenda

<font color="#808080"># variaveis gerais
</font>$bopcao = false
$opmenu = <font color="#800000">&quot;0&quot;
</font>$g_nPosChave, $g_nTamChave = 0, 0
$g_nPreco = 0.0
$g_SalvarInclusao = false

$tfAssunto 
$tfAutor
$tfEditora
$tfIdioma
$tfEndereco
$tfPais
$tfProfissao
$tfLivro
$tfLivroAss
$tfLivroAut
$tfCliente
$tfUsuario
$tfVenda

<font color="#808080">#--- Rotinas b&aacute;sicas ---------------------------------------------------------

#------------------------------------------------------------------------------
# Fun&ccedil;&atilde;o de leitura que retorna a string sem o retorno de carro.
# retorna - a string digitada
# ------------------------------------------------------------------------------
</font><font color="#0000FF"><b>def </b></font>digita<font color="#008080"><b>()
  </b></font>sret = $stdin.<font color="#800000"><b>gets
  </b></font>sret.<font color="#800000"><b>chop</b></font>!
  <font color="#0000FF"><b>return </b></font>sret
<font color="#0000FF"><b>end

</b></font><font color="#808080">#------------------------------------------------------------------------------
# Fun&ccedil;&atilde;o que retorna um peda&ccedil;o de uma string.
# str - indica a string
# ini - indica a posicao inicial do pedaco
# tam - indica o tamanho do pedaco
# retorna - o peda&ccedil;o da string
# ------------------------------------------------------------------------------
</font><font color="#0000FF"><b>def </b></font>copy<font color="#008080"><b>(</b></font>str,nini,ntam<font color="#008080"><b>)
  </b></font><font color="#0000FF"><b>return </b></font>str.<font color="#800000"><b>slice</b></font><font color="#008080"><b>(</b></font>nini-1,ntam<font color="#008080"><b>)
</b></font><font color="#0000FF"><b>end
</b></font><font color="#808080">#------------------------------------------------------------------------------
# Repete um texto um n&uacute;mero determinado de vezes.
# sTexto - o texto a ser repetido
# nQtd - a quantidade de vezes
# retorna - o texto repetido
#------------------------------------------------------------------------------
</font><font color="#0000FF"><b>def </b></font>repete<font color="#008080"><b>(</b></font>sTexto, nQtd<font color="#008080"><b>)
  </b></font><font color="#0000FF"><b>return </b></font>sTexto * nQtd
<font color="#0000FF"><b>end
</b></font><font color="#808080">#------------------------------------------------------------------------------
# Coloca espa&ccedil;os em branco a mais de acordo com o tamanho m&aacute;ximo do texto.
# sTexto - o texto
# nTam - tamanho m&aacute;ximo do texto
# retorna - o texto com espa&ccedil;os em branco a mais
#------------------------------------------------------------------------------
</font><font color="#0000FF"><b>def </b></font>esp<font color="#008080"><b>(</b></font>sTexto, nTam<font color="#008080"><b>)
  </b></font><font color="#0000FF"><b>return </b></font>sTexto.<font color="#800000"><b>ljust</b></font><font color="#008080"><b>(</b></font>nTam<font color="#008080"><b>)
</b></font><font color="#0000FF"><b>end
</b></font><font color="#808080">#------------------------------------------------------------------------------
# Faz uma pesquisa relativa de um texto atrav&eacute;s de um valor chave.
# sTexto - o texto
# sChave - a chave a ser pesquisada
# retorna - se achou ou n&atilde;o a chave dentro do texto
#------------------------------------------------------------------------------
</font><font color="#0000FF"><b>def </b></font>strRelativa<font color="#008080"><b>(</b></font>sTexto, sChave<font color="#008080"><b>)
  </b></font><font color="#0000FF"><b>return </b></font>sTexto.<font color="#800000"><b>include</b></font>?<font color="#008080"><b>(</b></font>sChave<font color="#008080"><b>)
</b></font><font color="#0000FF"><b>end
</b></font><font color="#808080">#------------------------------------------------------------------------------
# Calcula o modulo11 de um valor qualquer.
# svalor - a mstring com o n&uacute;mero a ser calculado
# ndig - d&iacute;gito do valor a ser calculado
# retorna - o d&iacute;gito correto
#------------------------------------------------------------------------------
</font><font color="#0000FF"><b>def </b></font>modulo11<font color="#008080"><b>(</b></font>svalor, ndig<font color="#008080"><b>)
</b></font>ncont, nsoma, npos, nvalor = 0,0,0,0
sres, slocal = <font color="#800000">&quot;&quot;</font>, <font color="#800000">&quot;&quot;

  </font>ncont=1
  <font color="#0000FF"><b>while </b></font>ncont &lt;= 11 do
   slocal=copy<font color="#008080"><b>(</b></font>svalor,ncont,1<font color="#008080"><b>) </b></font>+ slocal
   ncont=ncont+1
  <font color="#0000FF"><b>end
  </b></font>nsoma=0
  <font color="#0000FF"><b>if </b></font>ndig == 1 then
    ncont=3
  <font color="#0000FF"><b>else
    </b></font>ncont=2
  <font color="#0000FF"><b>end
  </b></font>npos=2
  <font color="#0000FF"><b>while </b></font>ncont &lt;= 11 do
    sres=copy<font color="#008080"><b>(</b></font>slocal,ncont,1<font color="#008080"><b>)
    </b></font>nvalor = sres.<font color="#800000"><b>to_i
    </b></font>nsoma=nsoma + <font color="#008080"><b>(</b></font>nvalor * npos<font color="#008080"><b>)
    </b></font>ncont=ncont+1
    npos=npos+1
  <font color="#0000FF"><b>end
  </b></font>nsoma=<font color="#008080"><b>(11 </b></font>- <font color="#008080"><b>(</b></font>nsoma % 11<font color="#008080"><b>))
  
  </b></font><font color="#0000FF"><b>if </b></font>nsoma &gt; 9
    <font color="#0000FF"><b>return </b></font>0
  <font color="#0000FF"><b>else
    return </b></font>nsoma
  <font color="#0000FF"><b>end
end
</b></font><font color="#808080">#------------------------------------------------------------------------------
# Valida&ccedil;&atilde;o de um n&uacute;mero de CPF qualquer.
# cpf - a mstring com o n&uacute;mero do CPF
# retorna - se &eacute; valido ou n&atilde;o
#------------------------------------------------------------------------------
</font><font color="#0000FF"><b>def </b></font>validaCPF<font color="#008080"><b>(</b></font>cpf<font color="#008080"><b>)
</b></font>scpf, sres = <font color="#800000">&quot;&quot;</font>, <font color="#800000">&quot;&quot;
</font>nvalor1, nvalor2 = 0,0
  
  <font color="#0000FF"><b>if </b></font>cpf.<font color="#800000"><b>length</b></font>==14 then
    scpf=copy<font color="#008080"><b>(</b></font>cpf,1,3<font color="#008080"><b>)</b></font>+copy<font color="#008080"><b>(</b></font>cpf,5,3<font color="#008080"><b>)</b></font>+copy<font color="#008080"><b>(</b></font>cpf,9,3<font color="#008080"><b>)</b></font>+copy<font color="#008080"><b>(</b></font>cpf,13,2<font color="#008080"><b>)
    </b></font>sres=copy<font color="#008080"><b>(</b></font>cpf,13,1<font color="#008080"><b>)
    </b></font>nvalor1 = sres.<font color="#800000"><b>to_i
    </b></font>sres=copy<font color="#008080"><b>(</b></font>cpf,14,1<font color="#008080"><b>)
    </b></font>nvalor2 = sres.<font color="#800000"><b>to_i
    </b></font><font color="#0000FF"><b>if </b></font><font color="#008080"><b>(</b></font>modulo11<font color="#008080"><b>(</b></font>scpf,1<font color="#008080"><b>)</b></font>==nvalor1<font color="#008080"><b>) </b></font>and <font color="#008080"><b>(</b></font>modulo11<font color="#008080"><b>(</b></font>scpf,2<font color="#008080"><b>)</b></font>==nvalor2<font color="#008080"><b>)
      </b></font><font color="#0000FF"><b>return </b></font>true
    <font color="#0000FF"><b>else
      return </b></font>false
    <font color="#0000FF"><b>end
  else
    return </b></font>false
  <font color="#0000FF"><b>end
end
</b></font><font color="#808080">#------------------------------------------------------------------------------
# Valida&ccedil;&atilde;o de um n&uacute;mero ISBN qualquer.
# isbn - a mstring com o n&uacute;mero do ISBN
# retorna - se &eacute; valido ou n&atilde;o
#------------------------------------------------------------------------------
</font><font color="#0000FF"><b>def </b></font>validaISBN<font color="#008080"><b>(</b></font>isbn<font color="#008080"><b>)
</b></font>snum, sdigito, sisbn = <font color="#800000">&quot;&quot;</font>, <font color="#800000">&quot;&quot;</font>, <font color="#800000">&quot;&quot;
</font>ncont, nsoma, nvalor = 0,0,0

  <font color="#0000FF"><b>if </b></font>isbn.<font color="#800000"><b>length</b></font>==13 then
    sdigito=copy<font color="#008080"><b>(</b></font>isbn, isbn.<font color="#800000"><b>length</b></font>, 1<font color="#008080"><b>)
    </b></font>sisbn = <font color="#800000">&quot;&quot;
    </font><font color="#0000FF"><b>for </b></font>ncont in <font color="#008080"><b>(1</b></font>..isbn.<font color="#800000"><b>length</b></font>-1<font color="#008080"><b>) </b></font>do
      <font color="#0000FF"><b>if </b></font>copy<font color="#008080"><b>(</b></font>isbn,ncont,1<font color="#008080"><b>)</b></font>!=<font color="#800000">&quot;-&quot; </font>then
        sisbn=sisbn+copy<font color="#008080"><b>(</b></font>isbn,ncont,1<font color="#008080"><b>)
      </b></font><font color="#0000FF"><b>end
    end
    if </b></font>sdigito == <font color="#800000">&quot;X&quot; </font>then
      nsoma = 10
    <font color="#0000FF"><b>else
      </b></font>nvalor = sdigito.<font color="#800000"><b>to_i
      </b></font>nsoma = nvalor
    <font color="#0000FF"><b>end
    for </b></font>ncont in <font color="#008080"><b>(1</b></font>..9<font color="#008080"><b>) </b></font>do
      snum=copy<font color="#008080"><b>(</b></font>sisbn, ncont, 1<font color="#008080"><b>)
      </b></font>nvalor = snum.<font color="#800000"><b>to_i
      </b></font>nsoma=nsoma + <font color="#008080"><b>(</b></font>nvalor * <font color="#008080"><b>(11 </b></font>- ncont<font color="#008080"><b>))
    </b></font><font color="#0000FF"><b>end
    if </b></font><font color="#008080"><b>(</b></font>nsoma % 11<font color="#008080"><b>) </b></font>== 0
      <font color="#0000FF"><b>return </b></font>true
    <font color="#0000FF"><b>else
      return </b></font>false
    <font color="#0000FF"><b>end
  else
    return </b></font>false
  <font color="#0000FF"><b>end
end
</b></font><font color="#808080">#------------------------------------------------------------------------------
# Esconde a digita&ccedil;&atilde;o da senha
# retorna - a senha digitada
#------------------------------------------------------------------------------}
</font><font color="#0000FF"><b>def </b></font>digitaSenha<font color="#008080"><b>(</b></font>sRotulo, nTamSenha<font color="#008080"><b>)
  </b></font><font color="#0000FF"><b>print </b></font>sRotulo
  sSenha = digita<font color="#008080"><b>()
  </b></font><font color="#808080">#  ncont = 0
  #  sSenha=&quot;&quot;
  #  sLetra=&quot;\0&quot;
  #  while (sLetra!=&quot;\r&quot;) and (ncont &lt; nTamSenha) do
  #    sLetra=readkey
  #    sSenha=sSenha+sLetra
  #    ncont++
  #  end
  </font><font color="#0000FF"><b>return </b></font>sSenha
<font color="#0000FF"><b>end
</b></font><font color="#808080">#------------------------------------------------------------------------------
# Valida&ccedil;&atilde;o de um n&uacute;mero qualquer.
# sRotulo - o texto antes de se digitar o n&uacute;mero
# sNumero - a mstring com o valor do n&uacute;mero
# retorna - o sNumero
#------------------------------------------------------------------------------
</font><font color="#0000FF"><b>def </b></font>validaNumero<font color="#008080"><b>(</b></font>sRotulo, sNumero<font color="#008080"><b>)
</b></font>nnum = 0.0
nStatus=-1
<font color="#0000FF"><b>while </b></font><font color="#008080"><b>(</b></font>nStatus!=0<font color="#008080"><b>) </b></font>do
  <font color="#0000FF"><b>print </b></font>sRotulo
  sNumero = digita<font color="#008080"><b>()
  </b></font>nnum = sNumero.<font color="#800000"><b>to_f
  </b></font><font color="#0000FF"><b>if </b></font>nnum &lt; 0.01 then
     <font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font>MSG_NUMINV<font color="#008080"><b>)
  </b></font><font color="#0000FF"><b>else
     </b></font>nStatus=0
  <font color="#0000FF"><b>end
end
return </b></font>sNumero
<font color="#0000FF"><b>end
</b></font><font color="#808080">#------------------------------------------------------------------------------
# Valida&ccedil;&atilde;o de uma data ou data/hora qualquer.
# sRotulo - o texto antes de se digitar a data/hora
# sDataHora - a mstring com o valor da data/hora
# bSoData - indica se vai validar somente uma data sem a hora
# retorna - a sDataHora
#------------------------------------------------------------------------------
</font><font color="#0000FF"><b>def </b></font>validaDataHora<font color="#008080"><b>(</b></font>sRotulo, sDataHora, bSoData<font color="#008080"><b>)
</b></font>sdia, smes, sano, shora, smin, sseg = <font color="#800000">&quot;&quot;</font>,<font color="#800000">&quot;&quot;</font>,<font color="#800000">&quot;&quot;</font>,<font color="#800000">&quot;&quot;</font>,<font color="#800000">&quot;&quot;</font>,<font color="#800000">&quot;&quot;
</font>ndia, nmes, nano, nhora, nmin, nseg, ntam = 0,0,0,0,0,0,0 

bvalida=false
bdatavalida=false
bhoravalida=false
nudiames=0

<font color="#0000FF"><b>if </b></font>bSoData==true then ntam=10
<font color="#0000FF"><b>else </b></font>ntam=19
<font color="#0000FF"><b>end
while </b></font><font color="#008080"><b>(</b></font>bvalida==false<font color="#008080"><b>) </b></font>do
  <font color="#0000FF"><b>print </b></font>sRotulo
  sDataHora = digita<font color="#008080"><b>()
  </b></font><font color="#0000FF"><b>if </b></font>sDataHora.<font color="#800000"><b>length</b></font>==ntam then
    sdia=copy<font color="#008080"><b>(</b></font>sDataHora,1,2<font color="#008080"><b>)
    </b></font>ndia=sdia.<font color="#800000"><b>to_i
    </b></font>smes=copy<font color="#008080"><b>(</b></font>sDataHora,4,2<font color="#008080"><b>)
    </b></font>nmes=smes.<font color="#800000"><b>to_i
    </b></font>sano=copy<font color="#008080"><b>(</b></font>sDataHora,7,4<font color="#008080"><b>)
    </b></font>nano=sano.<font color="#800000"><b>to_i
  
    </b></font><font color="#0000FF"><b>if </b></font><font color="#008080"><b>(</b></font>nano &gt;= 1<font color="#008080"><b>) </b></font>and <font color="#008080"><b>(</b></font>nano &lt;= 9999<font color="#008080"><b>) </b></font>then
      <font color="#0000FF"><b>if </b></font><font color="#008080"><b>(</b></font>nmes &gt;= 1<font color="#008080"><b>) </b></font>and <font color="#008080"><b>(</b></font>nmes &lt;= 31<font color="#008080"><b>) </b></font>then
          <font color="#0000FF"><b>case </b></font>nmes
            when 1, 3, 5, 7, 8, 10, 12
              nudiames=31
            when 2
               <font color="#808080"># ano bissexto
               </font><font color="#0000FF"><b>if </b></font><font color="#008080"><b>(</b></font>nano % 4<font color="#008080"><b>)</b></font>==0 then 
                 nudiames=29
               <font color="#0000FF"><b>else 
                 </b></font>nudiames=28
               <font color="#0000FF"><b>end
             </b></font>when 4, 6, 9, 11
               nudiames=30
          <font color="#0000FF"><b>end
          if </b></font><font color="#008080"><b>(</b></font>ndia &gt;=1<font color="#008080"><b>) </b></font>and <font color="#008080"><b>(</b></font>ndia &lt;=nudiames<font color="#008080"><b>) </b></font>then
             bdatavalida=true
          <font color="#0000FF"><b>end 
      end
    end
  
    if </b></font>bSoData then
       <font color="#0000FF"><b>if </b></font>bdatavalida then 
         bvalida=true
       <font color="#0000FF"><b>else 
         print</b></font><font color="#008080"><b>(</b></font>MSG_DATAINV<font color="#008080"><b>)
       </b></font><font color="#0000FF"><b>end 
    else
      if </b></font>bdatavalida then
          shora=copy<font color="#008080"><b>(</b></font>sDataHora,12,2<font color="#008080"><b>)
          </b></font>nhora = shora.<font color="#800000"><b>to_i
          </b></font>smin=copy<font color="#008080"><b>(</b></font>sDataHora,15,2<font color="#008080"><b>)
          </b></font>nmin = smin.<font color="#800000"><b>to_i
          </b></font>sseg=copy<font color="#008080"><b>(</b></font>sDataHora,18,2<font color="#008080"><b>)
          </b></font>nseg = sseg.<font color="#800000"><b>to_i
  
          </b></font><font color="#0000FF"><b>if </b></font><font color="#008080"><b>(</b></font>nhora &gt;= 0<font color="#008080"><b>) </b></font>and <font color="#008080"><b>(</b></font>nhora &lt;= 23<font color="#008080"><b>) </b></font>then
            <font color="#0000FF"><b>if </b></font><font color="#008080"><b>(</b></font>nmin &gt;= 0<font color="#008080"><b>) </b></font>and <font color="#008080"><b>(</b></font>nmin &lt;= 59<font color="#008080"><b>) </b></font>then
              <font color="#0000FF"><b>if </b></font><font color="#008080"><b>(</b></font>nseg &gt;= 0<font color="#008080"><b>) </b></font>and <font color="#008080"><b>(</b></font>nseg &lt;= 59<font color="#008080"><b>) </b></font>then
                 bhoravalida=true
              <font color="#0000FF"><b>end
            end
          end
  
          if </b></font>bhoravalida then 
             bvalida=true
          <font color="#0000FF"><b>else 
             print</b></font><font color="#008080"><b>(</b></font>MSG_DTHRINV<font color="#008080"><b>)
          </b></font><font color="#0000FF"><b>end
      else
        print</b></font><font color="#008080"><b>(</b></font>MSG_DTHRINV<font color="#008080"><b>)
      </b></font><font color="#0000FF"><b>end
    end
  else
    if </b></font>bSoData==true then 
       <font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font>MSG_DATAINV<font color="#008080"><b>)
    </b></font><font color="#0000FF"><b>else 
       print</b></font><font color="#008080"><b>(</b></font>MSG_DTHRINV<font color="#008080"><b>)
    </b></font><font color="#0000FF"><b>end
  end
end
return </b></font>sDataHora
<font color="#0000FF"><b>end
</b></font><font color="#808080">#------------------------------------------------------------------------------
# Retorna a Data e a hora do sistema.
# retorna - a data e a hora
#------------------------------------------------------------------------------
</font><font color="#0000FF"><b>def </b></font>retDataHora<font color="#008080"><b>()
  </b></font>sTempo = <font color="#800000"><b>Time</b></font>.<font color="#800000"><b>now 
  </b></font><font color="#0000FF"><b>return </b></font>sTempo.<font color="#800000"><b>strftime</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;%d/%m/%Y %H:%M:%S&quot;</font><font color="#008080"><b>)
</b></font><font color="#0000FF"><b>end

</b></font><font color="#808080">#--- Rotinas de manipula&ccedil;&atilde;o de arquivos --------------------------------------

#------------------------------------------------------------------------------
# Calcula o tamanho do arquivo.
# sArq - o arquivo
# retorna - o tamanho do arquivo
#------------------------------------------------------------------------------
</font><font color="#0000FF"><b>def </b></font>tamArq<font color="#008080"><b>(</b></font>sArq<font color="#008080"><b>)
  </b></font><font color="#0000FF"><b>return </b></font><font color="#800000"><b>File</b></font>.<font color="#800000"><b>size</b></font><font color="#008080"><b>(</b></font>sArq.<font color="#800000"><b>path</b></font><font color="#008080"><b>)
</b></font><font color="#0000FF"><b>end
</b></font><font color="#808080">#------------------------------------------------------------------------------
# Abre ou cria os arquivos do sistema.
# bAbre - condi&ccedil;&atilde;o para abrir ou criar os arquivos do sistema
#------------------------------------------------------------------------------
</font><font color="#0000FF"><b>def </b></font>abrecriaArqs<font color="#008080"><b>(</b></font>bAbre<font color="#008080"><b>)
 </b></font><font color="#0000FF"><b>if </b></font>bAbre then
   <font color="#0000FF"><b>begin
     </b></font>$tfAssunto = <font color="#800000"><b>File</b></font>.<font color="#800000"><b>open</b></font><font color="#008080"><b>(</b></font>ARQ_ASSUNTO, <font color="#800000"><b>File</b></font>::RDWR<font color="#008080"><b>)
     </b></font>$tfAutor = <font color="#800000"><b>File</b></font>.<font color="#800000"><b>open</b></font><font color="#008080"><b>(</b></font>ARQ_AUTOR, <font color="#800000"><b>File</b></font>::RDWR<font color="#008080"><b>)
     </b></font>$tfEditora = <font color="#800000"><b>File</b></font>.<font color="#800000"><b>open</b></font><font color="#008080"><b>(</b></font>ARQ_EDITORA, <font color="#800000"><b>File</b></font>::RDWR<font color="#008080"><b>)
     </b></font>$tfIdioma = <font color="#800000"><b>File</b></font>.<font color="#800000"><b>open</b></font><font color="#008080"><b>(</b></font>ARQ_IDIOMA, <font color="#800000"><b>File</b></font>::RDWR<font color="#008080"><b>)
     </b></font>$tfEndereco = <font color="#800000"><b>File</b></font>.<font color="#800000"><b>open</b></font><font color="#008080"><b>(</b></font>ARQ_ENDERECO, <font color="#800000"><b>File</b></font>::RDWR<font color="#008080"><b>)
     </b></font>$tfPais = <font color="#800000"><b>File</b></font>.<font color="#800000"><b>open</b></font><font color="#008080"><b>(</b></font>ARQ_PAIS, <font color="#800000"><b>File</b></font>::RDWR<font color="#008080"><b>)
     </b></font>$tfProfissao = <font color="#800000"><b>File</b></font>.<font color="#800000"><b>open</b></font><font color="#008080"><b>(</b></font>ARQ_PROFISSAO, <font color="#800000"><b>File</b></font>::RDWR<font color="#008080"><b>)
     </b></font>$tfLivro = <font color="#800000"><b>File</b></font>.<font color="#800000"><b>open</b></font><font color="#008080"><b>(</b></font>ARQ_LIVRO, <font color="#800000"><b>File</b></font>::RDWR<font color="#008080"><b>)
     </b></font>$tfLivroAss = <font color="#800000"><b>File</b></font>.<font color="#800000"><b>open</b></font><font color="#008080"><b>(</b></font>ARQ_LIVASS, <font color="#800000"><b>File</b></font>::RDWR<font color="#008080"><b>)
     </b></font>$tfLivroAut = <font color="#800000"><b>File</b></font>.<font color="#800000"><b>open</b></font><font color="#008080"><b>(</b></font>ARQ_LIVAUT, <font color="#800000"><b>File</b></font>::RDWR<font color="#008080"><b>)
     </b></font>$tfCliente = <font color="#800000"><b>File</b></font>.<font color="#800000"><b>open</b></font><font color="#008080"><b>(</b></font>ARQ_CLIENTE, <font color="#800000"><b>File</b></font>::RDWR<font color="#008080"><b>)
     </b></font>$tfUsuario = <font color="#800000"><b>File</b></font>.<font color="#800000"><b>open</b></font><font color="#008080"><b>(</b></font>ARQ_USUARIO, <font color="#800000"><b>File</b></font>::RDWR<font color="#008080"><b>)
     </b></font>$tfVenda = <font color="#800000"><b>File</b></font>.<font color="#800000"><b>open</b></font><font color="#008080"><b>(</b></font>ARQ_VENDA, <font color="#800000"><b>File</b></font>::RDWR<font color="#008080"><b>)
   </b></font>rescue
     <font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font>MSG_ARQERRO<font color="#008080"><b>)
     </b></font><font color="#800000"><b>exit</b></font><font color="#008080"><b>(0)
   </b></font><font color="#0000FF"><b>end
 else
   </b></font>$tfAssunto = <font color="#800000"><b>File</b></font>.<font color="#800000"><b>new</b></font><font color="#008080"><b>(</b></font>ARQ_ASSUNTO, <font color="#800000"><b>File</b></font>::CREAT|<font color="#800000"><b>File</b></font>::TRUNC|<font color="#800000"><b>File</b></font>::RDWR <font color="#008080"><b>)
   </b></font>$tfAutor = <font color="#800000"><b>File</b></font>.<font color="#800000"><b>new</b></font><font color="#008080"><b>(</b></font>ARQ_AUTOR, <font color="#800000"><b>File</b></font>::CREAT|<font color="#800000"><b>File</b></font>::TRUNC|<font color="#800000"><b>File</b></font>::RDWR <font color="#008080"><b>)
   </b></font>$tfEditora = <font color="#800000"><b>File</b></font>.<font color="#800000"><b>new</b></font><font color="#008080"><b>(</b></font>ARQ_EDITORA, <font color="#800000"><b>File</b></font>::CREAT|<font color="#800000"><b>File</b></font>::TRUNC|<font color="#800000"><b>File</b></font>::RDWR <font color="#008080"><b>)
   </b></font>$tfIdioma = <font color="#800000"><b>File</b></font>.<font color="#800000"><b>new</b></font><font color="#008080"><b>(</b></font>ARQ_IDIOMA, <font color="#800000"><b>File</b></font>::CREAT|<font color="#800000"><b>File</b></font>::TRUNC|<font color="#800000"><b>File</b></font>::RDWR <font color="#008080"><b>)
   </b></font>$tfEndereco = <font color="#800000"><b>File</b></font>.<font color="#800000"><b>new</b></font><font color="#008080"><b>(</b></font>ARQ_ENDERECO, <font color="#800000"><b>File</b></font>::CREAT|<font color="#800000"><b>File</b></font>::TRUNC|<font color="#800000"><b>File</b></font>::RDWR <font color="#008080"><b>)
   </b></font>$tfPais = <font color="#800000"><b>File</b></font>.<font color="#800000"><b>new</b></font><font color="#008080"><b>(</b></font>ARQ_PAIS, <font color="#800000"><b>File</b></font>::CREAT|<font color="#800000"><b>File</b></font>::TRUNC|<font color="#800000"><b>File</b></font>::RDWR <font color="#008080"><b>)
   </b></font>$tfProfissao = <font color="#800000"><b>File</b></font>.<font color="#800000"><b>new</b></font><font color="#008080"><b>(</b></font>ARQ_PROFISSAO, <font color="#800000"><b>File</b></font>::CREAT|<font color="#800000"><b>File</b></font>::TRUNC|<font color="#800000"><b>File</b></font>::RDWR <font color="#008080"><b>)
   </b></font>$tfLivro = <font color="#800000"><b>File</b></font>.<font color="#800000"><b>new</b></font><font color="#008080"><b>(</b></font>ARQ_LIVRO, <font color="#800000"><b>File</b></font>::CREAT|<font color="#800000"><b>File</b></font>::TRUNC|<font color="#800000"><b>File</b></font>::RDWR <font color="#008080"><b>)
   </b></font>$tfLivroAss = <font color="#800000"><b>File</b></font>.<font color="#800000"><b>new</b></font><font color="#008080"><b>(</b></font>ARQ_LIVASS, <font color="#800000"><b>File</b></font>::CREAT|<font color="#800000"><b>File</b></font>::TRUNC|<font color="#800000"><b>File</b></font>::RDWR <font color="#008080"><b>)
   </b></font>$tfLivroAut = <font color="#800000"><b>File</b></font>.<font color="#800000"><b>new</b></font><font color="#008080"><b>(</b></font>ARQ_LIVAUT, <font color="#800000"><b>File</b></font>::CREAT|<font color="#800000"><b>File</b></font>::TRUNC|<font color="#800000"><b>File</b></font>::RDWR <font color="#008080"><b>)
   </b></font>$tfCliente = <font color="#800000"><b>File</b></font>.<font color="#800000"><b>new</b></font><font color="#008080"><b>(</b></font>ARQ_CLIENTE, <font color="#800000"><b>File</b></font>::CREAT|<font color="#800000"><b>File</b></font>::TRUNC|<font color="#800000"><b>File</b></font>::RDWR <font color="#008080"><b>)
   </b></font>$tfUsuario = <font color="#800000"><b>File</b></font>.<font color="#800000"><b>new</b></font><font color="#008080"><b>(</b></font>ARQ_USUARIO, <font color="#800000"><b>File</b></font>::CREAT|<font color="#800000"><b>File</b></font>::TRUNC|<font color="#800000"><b>File</b></font>::RDWR <font color="#008080"><b>)
   </b></font>$tfVenda = <font color="#800000"><b>File</b></font>.<font color="#800000"><b>new</b></font><font color="#008080"><b>(</b></font>ARQ_VENDA, <font color="#800000"><b>File</b></font>::CREAT|<font color="#800000"><b>File</b></font>::TRUNC|<font color="#800000"><b>File</b></font>::RDWR <font color="#008080"><b>)
 </b></font><font color="#0000FF"><b>end
end
</b></font><font color="#808080">#------------------------------------------------------------------------------
# Fecha todos os arquivos abertos.
#------------------------------------------------------------------------------
</font><font color="#0000FF"><b>def </b></font>fechaArqs<font color="#008080"><b>()
  </b></font>$tfAssunto.<font color="#800000"><b>close
  </b></font>$tfAutor.<font color="#800000"><b>close
  </b></font>$tfEditora.<font color="#800000"><b>close
  </b></font>$tfIdioma.<font color="#800000"><b>close
  </b></font>$tfEndereco.<font color="#800000"><b>close
  </b></font>$tfPais.<font color="#800000"><b>close
  </b></font>$tfProfissao.<font color="#800000"><b>close
  </b></font>$tfLivro.<font color="#800000"><b>close
  </b></font>$tfLivroAss.<font color="#800000"><b>close
  </b></font>$tfLivroAut.<font color="#800000"><b>close
  </b></font>$tfCliente.<font color="#800000"><b>close
  </b></font>$tfUsuario.<font color="#800000"><b>close
  </b></font>$tfVenda.<font color="#800000"><b>close
</b></font><font color="#0000FF"><b>end
</b></font><font color="#808080">#------------------------------------------------------------------------------
# Pesquisa um registro atrav&eacute;s de um valor chave num arquivo.
# sArq - o arquivo
# sChave - a chave a ser pesquisada
# nPosChave - a posicao inicial da chave dentro do registro
# nTamChave - o tamanho da chave dentro do registro
# nTamLinha - o tamanho do registro
# retorna - o registro pesquisado
#------------------------------------------------------------------------------
</font><font color="#0000FF"><b>def </b></font>pesqArq<font color="#008080"><b>(</b></font>sArq, sChave, nPosChave, nTamChave, nTamLinha<font color="#008080"><b>)
</b></font>slinha, sres = <font color="#800000">&quot;&quot;
</font>nPosicao = 0

  bQuebra=false
  sArq.<font color="#800000"><b>seek</b></font><font color="#008080"><b>(0</b></font>, <font color="#800000"><b>IO</b></font>::SEEK_SET<font color="#008080"><b>)
  </b></font><font color="#0000FF"><b>while </b></font><font color="#008080"><b>(</b></font>not sArq.<font color="#800000"><b>eof</b></font><font color="#008080"><b>) </b></font>and <font color="#008080"><b>(</b></font>bQuebra==false<font color="#008080"><b>) </b></font>do
<font color="#808080">#    slinha = sArq.read(nTamLinha + TAM_CRLF)
    </font>slinha = sArq.<font color="#800000"><b>readline
    </b></font>sres=copy<font color="#008080"><b>(</b></font>slinha,nPosChave,nTamChave<font color="#008080"><b>)</b></font>.<font color="#800000"><b>strip
    </b></font><font color="#0000FF"><b>if </b></font>sres==sChave then
       bQuebra=true
    <font color="#0000FF"><b>end
  end
  </b></font>nPosicao=sArq.<font color="#800000"><b>pos</b></font>-<font color="#008080"><b>(</b></font>nTamLinha + TAM_CRLF<font color="#008080"><b>)
  </b></font><font color="#0000FF"><b>if </b></font>nPosicao &gt; 0 then
     sArq.<font color="#800000"><b>seek</b></font><font color="#008080"><b>(</b></font>nPosicao, <font color="#800000"><b>IO</b></font>::SEEK_SET<font color="#008080"><b>)
  </b></font><font color="#0000FF"><b>else
     </b></font>sArq.<font color="#800000"><b>seek</b></font><font color="#008080"><b>(0</b></font>, <font color="#800000"><b>IO</b></font>::SEEK_SET<font color="#008080"><b>)
  </b></font><font color="#0000FF"><b>end
  if </b></font>sres!=sChave then
     <font color="#0000FF"><b>return </b></font><font color="#800000">&quot;&quot;
  </font><font color="#0000FF"><b>else
     return </b></font>copy<font color="#008080"><b>(</b></font>slinha,1,nTamLinha<font color="#008080"><b>)
  </b></font><font color="#0000FF"><b>end
end
</b></font><font color="#808080">#------------------------------------------------------------------------------
# Pesquisa se tem linha exclu&iacute;da sen&atilde;o vai para a &uacute;ltima linha do arquivo.
# sArq - o arquivo
# nTamLinha - o tamanho do registro
#------------------------------------------------------------------------------
</font><font color="#0000FF"><b>def </b></font>pesqLinhaExcluida<font color="#008080"><b>(</b></font>sArq, nTamLinha<font color="#008080"><b>)
</b></font>sExcluido = <font color="#800000">&quot;&quot;

  </font>sExcluido=pesqArq<font color="#008080"><b>(</b></font>sArq, <font color="#800000">&quot;*&quot;</font>, 1, 1, nTamLinha<font color="#008080"><b>)
  </b></font><font color="#0000FF"><b>if </b></font>sExcluido==<font color="#800000">&quot;&quot; </font>then
     sArq.<font color="#800000"><b>seek</b></font><font color="#008080"><b>(</b></font>tamArq<font color="#008080"><b>(</b></font>sArq<font color="#008080"><b>)</b></font>, <font color="#800000"><b>IO</b></font>::SEEK_SET<font color="#008080"><b>)
  </b></font><font color="#0000FF"><b>end
end
</b></font><font color="#808080">#------------------------------------------------------------------------------
# Pesquisa o maior c&oacute;digo num arquivo.
# sArq - o arquivo
# nPosChave - a posicao inicial da chave dentro do registro
# nTamChave - o tamanho da chave dentro do registro
# nTamLinha - o tamanho do registro
# retorna - o maior c&oacute;digo
#------------------------------------------------------------------------------
</font><font color="#0000FF"><b>def </b></font>pesqMaxCod<font color="#008080"><b>(</b></font>sArq, nPosChave, nTamChave, nTamLinha<font color="#008080"><b>)
</b></font>slinha, sres = <font color="#800000">&quot;&quot;</font>, <font color="#800000">&quot;&quot;
</font>nCod = 0
bQuebra=false
nMaior=0
sArq.<font color="#800000"><b>seek</b></font><font color="#008080"><b>(0</b></font>, <font color="#800000"><b>IO</b></font>::SEEK_SET<font color="#008080"><b>)
</b></font><font color="#0000FF"><b>while </b></font><font color="#008080"><b>(</b></font>not sArq.<font color="#800000"><b>eof</b></font><font color="#008080"><b>) </b></font>and <font color="#008080"><b>(</b></font>bQuebra==false<font color="#008080"><b>) </b></font>do
<font color="#808080">#  slinha = sArq.read(nTamLinha + TAM_CRLF)
  </font>slinha = sArq.<font color="#800000"><b>readline
  </b></font>sres=copy<font color="#008080"><b>(</b></font>slinha,nPosChave,nTamChave<font color="#008080"><b>)</b></font>.<font color="#800000"><b>strip
  </b></font>nCod=sres.<font color="#800000"><b>to_i
  </b></font><font color="#0000FF"><b>if </b></font>nCod &gt; nMaior then
     nMaior=nCod
  <font color="#0000FF"><b>end
end
</b></font>pesqLinhaExcluida<font color="#008080"><b>(</b></font>sArq, nTamLinha<font color="#008080"><b>)
</b></font>sres = <font color="#008080"><b>(</b></font>nMaior+1<font color="#008080"><b>)</b></font>.<font color="#800000"><b>to_s
</b></font><font color="#0000FF"><b>return </b></font>sres
<font color="#0000FF"><b>end
</b></font><font color="#808080">#------------------------------------------------------------------------------
# Grava os registros num determinado arquivo.
# sArq - o arquivo
# sTexto - o registro a ser gravado
# sMsgAcerto - a mensagem caso o registro foi gravado
# sMsgErro - a mensagem caso o registro n&atilde;o foi gravado
#------------------------------------------------------------------------------
</font><font color="#0000FF"><b>def </b></font>escreveArq<font color="#008080"><b>(</b></font>sArq, sTexto, sMsgAcerto, sMsgErro<font color="#008080"><b>)
</b></font>nStatus = 0
  <font color="#0000FF"><b>begin
    </b></font>sTexto=sTexto+CRLF
    nStatus = sArq.<font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font>sTexto<font color="#008080"><b>)
    </b></font><font color="#0000FF"><b>if </b></font>nStatus == sTexto.<font color="#800000"><b>length
      </b></font><font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font>sMsgAcerto,<font color="#800000">&quot;\n&quot;</font><font color="#008080"><b>)
    </b></font><font color="#0000FF"><b>else
      print</b></font><font color="#008080"><b>(</b></font>sMsgErro,<font color="#800000">&quot;\n&quot;</font><font color="#008080"><b>)
    </b></font><font color="#0000FF"><b>end 
  </b></font>rescue
    <font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font>sMsgErro,<font color="#800000">&quot;\n&quot;</font><font color="#008080"><b>)
  </b></font><font color="#0000FF"><b>end
end

</b></font><font color="#808080">#--- Rotinas de implementa&ccedil;&atilde;o do sistema e de interface ----------------------

#------------------------------------------------------------------------------
# Monta o tamanho do registro no arquivo de acordo com o tipo de arquivo.
# sreg - o tipo de arquivo
# retorna - o registro montado
#------------------------------------------------------------------------------
</font><font color="#0000FF"><b>def </b></font>LinhaReg<font color="#008080"><b>(</b></font>sreg<font color="#008080"><b>)
</b></font>slinha=<font color="#800000">&quot;&quot;
</font><font color="#0000FF"><b>if </b></font>sreg==OPASSUNTO then
   slinha=esp<font color="#008080"><b>(</b></font>TAssunto<font color="#008080"><b>[</b></font><font color="#800000">&quot;codigo&quot;</font><font color="#008080"><b>]</b></font>,10<font color="#008080"><b>)</b></font>+esp<font color="#008080"><b>(</b></font>TAssunto<font color="#008080"><b>[</b></font><font color="#800000">&quot;assunto&quot;</font><font color="#008080"><b>]</b></font>,30<font color="#008080"><b>)
</b></font><font color="#0000FF"><b>elsif </b></font>sreg==OPAUTOR then
   slinha=esp<font color="#008080"><b>(</b></font>TAutor<font color="#008080"><b>[</b></font><font color="#800000">&quot;codigo&quot;</font><font color="#008080"><b>]</b></font>,10<font color="#008080"><b>)</b></font>+esp<font color="#008080"><b>(</b></font>TAutor<font color="#008080"><b>[</b></font><font color="#800000">&quot;autor&quot;</font><font color="#008080"><b>]</b></font>,30<font color="#008080"><b>)
</b></font><font color="#0000FF"><b>elsif </b></font>sreg==OPEDITORA then
   slinha=esp<font color="#008080"><b>(</b></font>TEditora<font color="#008080"><b>[</b></font><font color="#800000">&quot;codigo&quot;</font><font color="#008080"><b>]</b></font>,10<font color="#008080"><b>)</b></font>+esp<font color="#008080"><b>(</b></font>TEditora<font color="#008080"><b>[</b></font><font color="#800000">&quot;editora&quot;</font><font color="#008080"><b>]</b></font>,50<font color="#008080"><b>)
</b></font><font color="#0000FF"><b>elsif </b></font>sreg==OPENDERECO then
   slinha=esp<font color="#008080"><b>(</b></font>TEndereco<font color="#008080"><b>[</b></font><font color="#800000">&quot;codigo&quot;</font><font color="#008080"><b>]</b></font>,10<font color="#008080"><b>)</b></font>+esp<font color="#008080"><b>(</b></font>TEndereco<font color="#008080"><b>[</b></font><font color="#800000">&quot;logradouro&quot;</font><font color="#008080"><b>]</b></font>,40<font color="#008080"><b>)</b></font>+
   esp<font color="#008080"><b>(</b></font>TEndereco<font color="#008080"><b>[</b></font><font color="#800000">&quot;bairro&quot;</font><font color="#008080"><b>]</b></font>,15<font color="#008080"><b>)</b></font>+esp<font color="#008080"><b>(</b></font>TEndereco<font color="#008080"><b>[</b></font><font color="#800000">&quot;cep&quot;</font><font color="#008080"><b>]</b></font>,8<font color="#008080"><b>)</b></font>+esp<font color="#008080"><b>(</b></font>TEndereco<font color="#008080"><b>[</b></font><font color="#800000">&quot;cidade&quot;</font><font color="#008080"><b>]</b></font>,30<font color="#008080"><b>)</b></font>+
   esp<font color="#008080"><b>(</b></font>TEndereco<font color="#008080"><b>[</b></font><font color="#800000">&quot;estado&quot;</font><font color="#008080"><b>]</b></font>,20<font color="#008080"><b>)
</b></font><font color="#0000FF"><b>elsif </b></font>sreg==OPIDIOMA then
   slinha=esp<font color="#008080"><b>(</b></font>TIdioma<font color="#008080"><b>[</b></font><font color="#800000">&quot;codigo&quot;</font><font color="#008080"><b>]</b></font>,10<font color="#008080"><b>)</b></font>+esp<font color="#008080"><b>(</b></font>TIdioma<font color="#008080"><b>[</b></font><font color="#800000">&quot;idioma&quot;</font><font color="#008080"><b>]</b></font>,20<font color="#008080"><b>)
</b></font><font color="#0000FF"><b>elsif </b></font>sreg==OPPAIS then
   slinha=esp<font color="#008080"><b>(</b></font>TPais<font color="#008080"><b>[</b></font><font color="#800000">&quot;codigo&quot;</font><font color="#008080"><b>]</b></font>,3<font color="#008080"><b>)</b></font>+esp<font color="#008080"><b>(</b></font>TPais<font color="#008080"><b>[</b></font><font color="#800000">&quot;pais&quot;</font><font color="#008080"><b>]</b></font>,50<font color="#008080"><b>)
</b></font><font color="#0000FF"><b>elsif </b></font>sreg==OPPROFISSAO then
   slinha=esp<font color="#008080"><b>(</b></font>TProfissao<font color="#008080"><b>[</b></font><font color="#800000">&quot;codigo&quot;</font><font color="#008080"><b>]</b></font>,10<font color="#008080"><b>)</b></font>+esp<font color="#008080"><b>(</b></font>TProfissao<font color="#008080"><b>[</b></font><font color="#800000">&quot;profissao&quot;</font><font color="#008080"><b>]</b></font>,50<font color="#008080"><b>)
</b></font><font color="#0000FF"><b>elsif </b></font>sreg==OPUSUARIO then
   slinha=esp<font color="#008080"><b>(</b></font>TUsuario<font color="#008080"><b>[</b></font><font color="#800000">&quot;login&quot;</font><font color="#008080"><b>]</b></font>,10<font color="#008080"><b>)</b></font>+esp<font color="#008080"><b>(</b></font>TUsuario<font color="#008080"><b>[</b></font><font color="#800000">&quot;senha&quot;</font><font color="#008080"><b>]</b></font>,10<font color="#008080"><b>)
</b></font><font color="#0000FF"><b>elsif </b></font>sreg==OPLIVRO then
   slinha=esp<font color="#008080"><b>(</b></font>TLivro<font color="#008080"><b>[</b></font><font color="#800000">&quot;isbn&quot;</font><font color="#008080"><b>]</b></font>,13<font color="#008080"><b>)</b></font>+esp<font color="#008080"><b>(</b></font>TLivro<font color="#008080"><b>[</b></font><font color="#800000">&quot;titulo&quot;</font><font color="#008080"><b>]</b></font>,50<font color="#008080"><b>)</b></font>+esp<font color="#008080"><b>(</b></font>TLivro<font color="#008080"><b>[</b></font><font color="#800000">&quot;edicao&quot;</font><font color="#008080"><b>]</b></font>,10<font color="#008080"><b>)</b></font>+
   esp<font color="#008080"><b>(</b></font>TLivro<font color="#008080"><b>[</b></font><font color="#800000">&quot;anopubli&quot;</font><font color="#008080"><b>]</b></font>,10<font color="#008080"><b>)</b></font>+esp<font color="#008080"><b>(</b></font>TLivro<font color="#008080"><b>[</b></font><font color="#800000">&quot;codeditora&quot;</font><font color="#008080"><b>]</b></font>,10<font color="#008080"><b>)</b></font>+esp<font color="#008080"><b>(</b></font>TLivro<font color="#008080"><b>[</b></font><font color="#800000">&quot;volume&quot;</font><font color="#008080"><b>]</b></font>,10<font color="#008080"><b>)</b></font>+
   esp<font color="#008080"><b>(</b></font>TLivro<font color="#008080"><b>[</b></font><font color="#800000">&quot;codidioma&quot;</font><font color="#008080"><b>]</b></font>,10<font color="#008080"><b>)</b></font>+esp<font color="#008080"><b>(</b></font>TLivro<font color="#008080"><b>[</b></font><font color="#800000">&quot;npaginas&quot;</font><font color="#008080"><b>]</b></font>,10<font color="#008080"><b>)</b></font>+esp<font color="#008080"><b>(</b></font>TLivro<font color="#008080"><b>[</b></font><font color="#800000">&quot;preco&quot;</font><font color="#008080"><b>]</b></font>,10<font color="#008080"><b>)</b></font>+
   esp<font color="#008080"><b>(</b></font>TLivro<font color="#008080"><b>[</b></font><font color="#800000">&quot;qtdestoque&quot;</font><font color="#008080"><b>]</b></font>,10<font color="#008080"><b>)
</b></font><font color="#0000FF"><b>elsif </b></font>sreg==OPLIVROASS then
   slinha=esp<font color="#008080"><b>(</b></font>TLivroAss<font color="#008080"><b>[</b></font><font color="#800000">&quot;isbn&quot;</font><font color="#008080"><b>]</b></font>,13<font color="#008080"><b>)</b></font>+esp<font color="#008080"><b>(</b></font>TLivroAss<font color="#008080"><b>[</b></font><font color="#800000">&quot;codassunto&quot;</font><font color="#008080"><b>]</b></font>,10<font color="#008080"><b>)
</b></font><font color="#0000FF"><b>elsif </b></font>sreg==OPLIVROAUT then
   slinha=esp<font color="#008080"><b>(</b></font>TLivroAut<font color="#008080"><b>[</b></font><font color="#800000">&quot;isbn&quot;</font><font color="#008080"><b>]</b></font>,13<font color="#008080"><b>)</b></font>+esp<font color="#008080"><b>(</b></font>TLivroAut<font color="#008080"><b>[</b></font><font color="#800000">&quot;codautor&quot;</font><font color="#008080"><b>]</b></font>,10<font color="#008080"><b>)
</b></font><font color="#0000FF"><b>elsif </b></font>sreg==OPCLIENTE then
   slinha=esp<font color="#008080"><b>(</b></font>TCliente<font color="#008080"><b>[</b></font><font color="#800000">&quot;cpf&quot;</font><font color="#008080"><b>]</b></font>,14<font color="#008080"><b>)</b></font>+esp<font color="#008080"><b>(</b></font>TCliente<font color="#008080"><b>[</b></font><font color="#800000">&quot;nome&quot;</font><font color="#008080"><b>]</b></font>,30<font color="#008080"><b>)</b></font>+esp<font color="#008080"><b>(</b></font>TCliente<font color="#008080"><b>[</b></font><font color="#800000">&quot;email&quot;</font><font color="#008080"><b>]</b></font>,30<font color="#008080"><b>)</b></font>+
   esp<font color="#008080"><b>(</b></font>TCliente<font color="#008080"><b>[</b></font><font color="#800000">&quot;identidade&quot;</font><font color="#008080"><b>]</b></font>,10<font color="#008080"><b>)</b></font>+esp<font color="#008080"><b>(</b></font>TCliente<font color="#008080"><b>[</b></font><font color="#800000">&quot;sexo&quot;</font><font color="#008080"><b>]</b></font>,1<font color="#008080"><b>)</b></font>+esp<font color="#008080"><b>(</b></font>TCliente<font color="#008080"><b>[</b></font><font color="#800000">&quot;telefone&quot;</font><font color="#008080"><b>]</b></font>,17<font color="#008080"><b>)</b></font>+
   esp<font color="#008080"><b>(</b></font>TCliente<font color="#008080"><b>[</b></font><font color="#800000">&quot;dtnascimento&quot;</font><font color="#008080"><b>]</b></font>,10<font color="#008080"><b>)</b></font>+esp<font color="#008080"><b>(</b></font>TCliente<font color="#008080"><b>[</b></font><font color="#800000">&quot;codendereco&quot;</font><font color="#008080"><b>]</b></font>,10<font color="#008080"><b>)</b></font>+
   esp<font color="#008080"><b>(</b></font>TCliente<font color="#008080"><b>[</b></font><font color="#800000">&quot;codpais&quot;</font><font color="#008080"><b>]</b></font>,3<font color="#008080"><b>)</b></font>+esp<font color="#008080"><b>(</b></font>TCliente<font color="#008080"><b>[</b></font><font color="#800000">&quot;codprofissao&quot;</font><font color="#008080"><b>]</b></font>,10<font color="#008080"><b>)
</b></font><font color="#0000FF"><b>elsif </b></font>sreg==OPVENDA then
   slinha=esp<font color="#008080"><b>(</b></font>TVenda<font color="#008080"><b>[</b></font><font color="#800000">&quot;dthrvenda&quot;</font><font color="#008080"><b>]</b></font>,19<font color="#008080"><b>)</b></font>+esp<font color="#008080"><b>(</b></font>TVenda<font color="#008080"><b>[</b></font><font color="#800000">&quot;cpf&quot;</font><font color="#008080"><b>]</b></font>,14<font color="#008080"><b>)</b></font>+esp<font color="#008080"><b>(</b></font>TVenda<font color="#008080"><b>[</b></font><font color="#800000">&quot;isbn&quot;</font><font color="#008080"><b>]</b></font>,13<font color="#008080"><b>)</b></font>+
   esp<font color="#008080"><b>(</b></font>TVenda<font color="#008080"><b>[</b></font><font color="#800000">&quot;precovenda&quot;</font><font color="#008080"><b>]</b></font>,10<font color="#008080"><b>)
</b></font><font color="#0000FF"><b>end
return </b></font>slinha
<font color="#0000FF"><b>end
</b></font><font color="#808080">#------------------------------------------------------------------------------
# Retorna o tamanho do registro no arquivo de acordo com o tipo de arquivo.
# sreg - o tipo de arquivo
# retorna - o tamanho do registro
#------------------------------------------------------------------------------
</font><font color="#0000FF"><b>def </b></font>tamReg<font color="#008080"><b>(</b></font>sreg<font color="#008080"><b>)
</b></font>nret=0
  <font color="#0000FF"><b>if </b></font>sreg==OPASSUNTO then nret=TAM_ASSUNTO
  <font color="#0000FF"><b>elsif </b></font>sreg==OPAUTOR then nret=TAM_AUTOR
  <font color="#0000FF"><b>elsif </b></font>sreg==OPEDITORA then nret=TAM_EDITORA
  <font color="#0000FF"><b>elsif </b></font>sreg==OPENDERECO then nret=TAM_ENDERECO
  <font color="#0000FF"><b>elsif </b></font>sreg==OPIDIOMA then nret=TAM_IDIOMA
  <font color="#0000FF"><b>elsif </b></font>sreg==OPPAIS then nret=TAM_PAIS
  <font color="#0000FF"><b>elsif </b></font>sreg==OPPROFISSAO then nret=TAM_PROFISSAO
  <font color="#0000FF"><b>elsif </b></font>sreg==OPUSUARIO then nret=TAM_USUARIO
  <font color="#0000FF"><b>elsif </b></font>sreg==OPLIVRO then nret=TAM_LIVRO
  <font color="#0000FF"><b>elsif </b></font>sreg==OPLIVROASS then nret=TAM_LIVASS
  <font color="#0000FF"><b>elsif </b></font>sreg==OPLIVROAUT then nret=TAM_LIVAUT
  <font color="#0000FF"><b>elsif </b></font>sreg==OPCLIENTE then nret=TAM_CLIENTE
  <font color="#0000FF"><b>elsif </b></font>sreg==OPVENDA then nret=TAM_VENDA
  <font color="#0000FF"><b>end
return </b></font>nret
<font color="#0000FF"><b>end
</b></font><font color="#808080">#------------------------------------------------------------------------------
# Seleciona o rotulo de cada campo de acordo com o tipo de arquivo.
# sreg - o tipo de arquivo
# nNum - indica qual rotulo ser&aacute; retornado
# retorna - o rotulo
#------------------------------------------------------------------------------
</font><font color="#0000FF"><b>def </b></font>rotulo<font color="#008080"><b>(</b></font>sreg, nNum<font color="#008080"><b>)
</b></font>sret=<font color="#800000">&quot;&quot;
</font><font color="#0000FF"><b>if </b></font>sreg==OPASSUNTO then
   <font color="#0000FF"><b>case </b></font>nNum
     when 0 
       sret=<font color="#800000">&quot;Assunto(s) n&atilde;o encontrado(s)!&quot;
     </font>when 1
       sret=<font color="#800000">&quot;C&oacute;digo do assunto: &quot;
       </font>$g_nPosChave=1
       $g_nTamChave=10
     when 2
       sret=<font color="#800000">&quot;Assunto: &quot;
       </font>$g_nPosChave=11
       $g_nTamChave=30
   <font color="#0000FF"><b>end
elsif </b></font>sreg==OPAUTOR then
   <font color="#0000FF"><b>case </b></font>nNum
     when 0 
       sret=<font color="#800000">&quot;Autor(es) n&atilde;o encontrado(s)!&quot;
     </font>when 1
       sret=<font color="#800000">&quot;C&oacute;digo do autor: &quot;
       </font>$g_nPosChave=1
       $g_nTamChave=10
     when 2
       sret=<font color="#800000">&quot;Autor: &quot;
       </font>$g_nPosChave=11
       $g_nTamChave=30
   <font color="#0000FF"><b>end
elsif </b></font>sreg==OPEDITORA then
   <font color="#0000FF"><b>case </b></font>nNum
     when 0 
         sret=<font color="#800000">&quot;Editora(s) n&atilde;o encontrada(s)!&quot;
     </font>when 1
         sret=<font color="#800000">&quot;C&oacute;digo da editora: &quot;
         </font>$g_nPosChave=1
         $g_nTamChave=10
     when 2
         sret=<font color="#800000">&quot;Editora: &quot;
         </font>$g_nPosChave=11
         $g_nTamChave=50
   <font color="#0000FF"><b>end
elsif </b></font>sreg==OPENDERECO then
   <font color="#0000FF"><b>case </b></font>nNum
     when 0 
         sret=<font color="#800000">&quot;Endere&ccedil;o(s) n&atilde;o encontrado(s)!&quot;
     </font>when 1
         sret=<font color="#800000">&quot;C&oacute;digo do endere&ccedil;o: &quot;
         </font>$g_nPosChave=1
         $g_nTamChave=10
     when 2
         sret=<font color="#800000">&quot;Logradouro: &quot;
         </font>$g_nPosChave=11
         $g_nTamChave=40
     when 3
         sret=<font color="#800000">&quot;Bairro: &quot;
         </font>$g_nPosChave=51
         $g_nTamChave=15
     when 4
         sret=<font color="#800000">&quot;CEP: &quot;
         </font>$g_nPosChave=66
         $g_nTamChave=8
     when 5
         sret=<font color="#800000">&quot;Cidade: &quot;
         </font>$g_nPosChave=74
         $g_nTamChave=30
     when 6
         sret=<font color="#800000">&quot;Estado: &quot;
         </font>$g_nPosChave=104
         $g_nTamChave=20
   <font color="#0000FF"><b>end
elsif </b></font>sreg==OPIDIOMA then
   <font color="#0000FF"><b>case </b></font>nNum
     when 0 
         sret=<font color="#800000">&quot;Idioma(s) n&atilde;o encontrado(s)!&quot;
     </font>when 1
         sret=<font color="#800000">&quot;C&oacute;digo do idioma: &quot;
         </font>$g_nPosChave=1
         $g_nTamChave=10

     when 2
         sret=<font color="#800000">&quot;Idioma: &quot;
         </font>$g_nPosChave=11
         $g_nTamChave=20
   <font color="#0000FF"><b>end
elsif </b></font>sreg==OPPAIS then
   <font color="#0000FF"><b>case </b></font>nNum
     when 0 
         sret=<font color="#800000">&quot;Pa&iacute;s(es) n&atilde;o encontrado(s)!&quot;
     </font>when 1
         sret=<font color="#800000">&quot;C&oacute;digo do pa&iacute;s: &quot;
         </font>$g_nPosChave=1
         $g_nTamChave=3
     when 2
         sret=<font color="#800000">&quot;Pa&iacute;s: &quot;
         </font>$g_nPosChave=4
         $g_nTamChave=50
   <font color="#0000FF"><b>end
elsif </b></font>sreg==OPPROFISSAO then
   <font color="#0000FF"><b>case </b></font>nNum
     when 0 
         sret=<font color="#800000">&quot;Profiss&atilde;o(es) n&atilde;o encontrada(s)!&quot;
     </font>when 1
         sret=<font color="#800000">&quot;C&oacute;digo da profiss&atilde;o: &quot;
         </font>$g_nPosChave=1
         $g_nTamChave=10
     when 2
         sret=<font color="#800000">&quot;Profiss&atilde;o: &quot;
         </font>$g_nPosChave=11
         $g_nTamChave=50
   <font color="#0000FF"><b>end
elsif </b></font>sreg==OPUSUARIO then
   <font color="#0000FF"><b>case </b></font>nNum
     when 0 
         sret=<font color="#800000">&quot;login ou senha incorreta, tente de novo!&quot;
     </font>when 1
         sret=<font color="#800000">&quot;Login: &quot;
         </font>$g_nPosChave=1
         $g_nTamChave=10
     when 2
         sret=<font color="#800000">&quot;Senha: &quot;
         </font>$g_nPosChave=11
         $g_nTamChave=10
   <font color="#0000FF"><b>end
elsif </b></font>sreg==OPLIVRO then
   <font color="#0000FF"><b>case </b></font>nNum
     when 0 
         sret=<font color="#800000">&quot;Livro(s) n&atilde;o encontrado(s)!&quot;
     </font>when 1
         sret=<font color="#800000">&quot;ISBN: &quot;
         </font>$g_nPosChave=1
         $g_nTamChave=13
     when 2
         sret=<font color="#800000">&quot;T&iacute;tulo: &quot;
         </font>$g_nPosChave=14
         $g_nTamChave=50
     when 3
         sret=<font color="#800000">&quot;Edi&ccedil;&atilde;o: &quot;
         </font>$g_nPosChave=64
         $g_nTamChave=10
     when 4
         sret=<font color="#800000">&quot;Ano de Publica&ccedil;&atilde;o: &quot;
         </font>$g_nPosChave=74
         $g_nTamChave=10
     when 5
         sret=<font color="#800000">&quot;C&oacute;digo da editora: &quot;
         </font>$g_nPosChave=84
         $g_nTamChave=10
     when 6
         sret=<font color="#800000">&quot;Volume: &quot;
         </font>$g_nPosChave=94
         $g_nTamChave=10
     when 7
         sret=<font color="#800000">&quot;C&oacute;digo do idioma: &quot;
         </font>$g_nPosChave=104
         $g_nTamChave=10
     when 8
         sret=<font color="#800000">&quot;N&uacute;mero de p&aacute;ginas: &quot;
         </font>$g_nPosChave=114
         $g_nTamChave=10
     when 9
         sret=<font color="#800000">&quot;Pre&ccedil;o: &quot;
         </font>$g_nPosChave=124
         $g_nTamChave=10
     when 10
          sret=<font color="#800000">&quot;Qtd. Estoque: &quot;
          </font>$g_nPosChave=134
          $g_nTamChave=10
    <font color="#0000FF"><b>end
elsif </b></font>sreg==OPLIVROASS then
   <font color="#0000FF"><b>case </b></font>nNum
     when 0 
         sret=<font color="#800000">&quot;Assunto(s) n&atilde;o encontrado(s)!&quot;
     </font>when 1
         sret=<font color="#800000">&quot;ISBN: &quot;
         </font>$g_nPosChave=1
         $g_nTamChave=13
     when 2
         sret=<font color="#800000">&quot;C&oacute;digo do assunto: &quot;
         </font>$g_nPosChave=14
         $g_nTamChave=10
   <font color="#0000FF"><b>end
elsif </b></font>sreg==OPLIVROAUT then
   <font color="#0000FF"><b>case </b></font>nNum
     when 0 
         sret=<font color="#800000">&quot;Autor(s) n&atilde;o encontrado(s)!&quot;
     </font>when 1
         sret=<font color="#800000">&quot;ISBN: &quot;
         </font>$g_nPosChave=1
         $g_nTamChave=13
     when 2
         sret=<font color="#800000">&quot;C&oacute;digo do autor: &quot;
         </font>$g_nPosChave=14
         $g_nTamChave=10
   <font color="#0000FF"><b>end
elsif </b></font>sreg==OPCLIENTE then
   <font color="#0000FF"><b>case </b></font>nNum
     when 0 
         sret=<font color="#800000">&quot;Cliente(s) n&atilde;o encontrado(s)!&quot;
     </font>when 1
         sret=<font color="#800000">&quot;CPF: &quot;
         </font>$g_nPosChave=1
         $g_nTamChave=14
     when 2
         sret=<font color="#800000">&quot;Nome: &quot;
         </font>$g_nPosChave=15
         $g_nTamChave=30
     when 3
         sret=<font color="#800000">&quot;E-mail: &quot;
         </font>$g_nPosChave=45
         $g_nTamChave=30
     when 4
         sret=<font color="#800000">&quot;Identidade: &quot;
         </font>$g_nPosChave=75
         $g_nTamChave=10
     when 5
         sret=<font color="#800000">&quot;Sexo: &quot;
         </font>$g_nPosChave=85
         $g_nTamChave=1
     when 6
         sret=<font color="#800000">&quot;Telefone: &quot;
         </font>$g_nPosChave=86
         $g_nTamChave=17
     when 7
         sret=<font color="#800000">&quot;Dt. Nascimento: &quot;
         </font>$g_nPosChave=103
         $g_nTamChave=10
     when 8
         sret=<font color="#800000">&quot;C&oacute;digo do endere&ccedil;o: &quot;
         </font>$g_nPosChave=113
         $g_nTamChave=10
     when 9
         sret=<font color="#800000">&quot;C&oacute;digo do pa&iacute;s: &quot;
         </font>$g_nPosChave=123
         $g_nTamChave=3
     when 10
          sret=<font color="#800000">&quot;C&oacute;digo da Profiss&atilde;o: &quot;
          </font>$g_nPosChave=126
          $g_nTamChave=10
   <font color="#0000FF"><b>end
elsif </b></font>sreg==OPVENDA then
   <font color="#0000FF"><b>case </b></font>nNum
     when 0 
         sret=<font color="#800000">&quot;Venda(s) n&atilde;o encontrada(s)!&quot;
     </font>when 1
         sret=<font color="#800000">&quot;Data/Hora venda: &quot;
         </font>$g_nPosChave=1
         $g_nTamChave=19
     when 2
         sret=<font color="#800000">&quot;CPF: &quot;
         </font>$g_nPosChave=20
         $g_nTamChave=14
     when 3
         sret=<font color="#800000">&quot;ISBN: &quot;
         </font>$g_nPosChave=34
         $g_nTamChave=13
     when 4
         sret=<font color="#800000">&quot;Pre+o de venda: &quot;
         </font>$g_nPosChave=47
         $g_nTamChave=10
   <font color="#0000FF"><b>end
end

return </b></font>sret
<font color="#0000FF"><b>end
</b></font><font color="#808080">#------------------------------------------------------------------------------
# Indica se continua ou n&atilde;o mostrando um n&uacute;mero m&aacute;ximo de linhas.
# nlinha - a linha a ser continuada
# nQtdLinha - a quantidade de linhas a serem mostradas
# retorna - se continua ou n&atilde;o
#------------------------------------------------------------------------------
</font><font color="#0000FF"><b>def </b></font>ContinuaSN<font color="#008080"><b>(</b></font>nlinha, nQtdLinha<font color="#008080"><b>)
</b></font>bSOp = false
opCSubMenu = <font color="#800000">&quot;\0&quot;
</font>bret=false
<font color="#0000FF"><b>if </b></font>nlinha &gt; 0 then
  <font color="#0000FF"><b>if </b></font><font color="#008080"><b>(</b></font>nlinha % nQtdLinha<font color="#008080"><b>) </b></font>== 0 then
     bSOp=true
     <font color="#0000FF"><b>while </b></font>bSOp do
       menu<font color="#008080"><b>(13)
       </b></font>opCSubMenu = digita<font color="#008080"><b>()
       </b></font><font color="#0000FF"><b>if </b></font><font color="#008080"><b>(</b></font>opCSubMenu==<font color="#800000">&quot;S&quot;</font><font color="#008080"><b>) </b></font>or <font color="#008080"><b>(</b></font>opCSubMenu==<font color="#800000">&quot;s&quot;</font><font color="#008080"><b>) </b></font>then bSOp=false
       <font color="#0000FF"><b>elsif </b></font><font color="#008080"><b>(</b></font>opCSubMenu==<font color="#800000">&quot;N&quot;</font><font color="#008080"><b>) </b></font>or <font color="#008080"><b>(</b></font>opCSubMenu==<font color="#800000">&quot;n&quot;</font><font color="#008080"><b>) </b></font>then
          bret=true
          bSOp=false
       <font color="#0000FF"><b>else 
         print</b></font><font color="#008080"><b>(</b></font>MSG_ERRO<font color="#008080"><b>)
       </b></font><font color="#0000FF"><b>end
     end
  end
end

return </b></font>bret
<font color="#0000FF"><b>end
</b></font><font color="#808080">#------------------------------------------------------------------------------
# Lista v&aacute;rios registros de acordo com a pesquisa feita.
# sArq - o arquivo
# sreg - o tipo de arquivo
# sChave - a chave a ser pesquisada
# nPosChave - a posicao inicial da chave dentro do registro
# nTamChave - o tamanho da chave dentro do registro
# nTamLinha - o tamanho do registro
# nQtdLinha - a quantidade de linhas a serem mostradas
# retorna - se encontrou algum registro
#------------------------------------------------------------------------------
</font><font color="#0000FF"><b>def </b></font>ListarTodos<font color="#008080"><b>(</b></font>sArq, sreg, sChave, nPosChave, nTamChave, 
                nTamLinha, nQtdLinha, bPesqRelativa<font color="#008080"><b>)
</b></font>slinha, sres = <font color="#800000">&quot;&quot;</font>,<font color="#800000">&quot;&quot;

</font>bRet=false
bQuebra=false
nCont=0
mostrarDados<font color="#008080"><b>(</b></font>sreg, <font color="#800000">&quot;&quot;</font>, 2<font color="#008080"><b>)
</b></font>sArq.<font color="#800000"><b>seek</b></font><font color="#008080"><b>(0</b></font>, <font color="#800000"><b>IO</b></font>::SEEK_SET<font color="#008080"><b>)
</b></font><font color="#0000FF"><b>while </b></font><font color="#008080"><b>(</b></font>not sArq.<font color="#800000"><b>eof</b></font><font color="#008080"><b>) </b></font>and <font color="#008080"><b>(</b></font>bQuebra==false<font color="#008080"><b>) </b></font>do
  slinha = sArq.<font color="#800000"><b>readline
  </b></font><font color="#0000FF"><b>if </b></font>bPesqRelativa then
    sres=copy<font color="#008080"><b>(</b></font>slinha,nPosChave,nTamChave<font color="#008080"><b>)</b></font>.<font color="#800000"><b>strip
    </b></font><font color="#0000FF"><b>if </b></font>strRelativa<font color="#008080"><b>(</b></font>sres,sChave<font color="#008080"><b>) </b></font>then
       bAchou=true
       bRet=true
    <font color="#0000FF"><b>else
       </b></font>bAchou=false
    <font color="#0000FF"><b>end
  else
    </b></font>bAchou=true
    bRet=true
  <font color="#0000FF"><b>end

  if </b></font>bAchou then
    mostrarDados<font color="#008080"><b>(</b></font>sreg, copy<font color="#008080"><b>(</b></font>slinha,1,nTamLinha<font color="#008080"><b>)</b></font>, 3<font color="#008080"><b>)
    </b></font>nCont=nCont+1
  <font color="#0000FF"><b>end

  </b></font>bQuebra=ContinuaSN<font color="#008080"><b>(</b></font>nCont, nQtdLinha<font color="#008080"><b>)
</b></font><font color="#0000FF"><b>end
return </b></font>bRet
<font color="#0000FF"><b>end
</b></font><font color="#808080">#------------------------------------------------------------------------------
# Lista v&aacute;rios registros entre arquivos de acordo com a pesquisa feita.
# sArq1 - o arquivo de liga&ccedil;&atilde;o
# sreg1 - o tipo de arquivo de liga&ccedil;&atilde;o
# nPosChave1 - a posicao inicial da primeira chave no arquivo de liga&ccedil;&atilde;o
# nTamChave1 - o tamanho da primeira chave no arquivo de liga&ccedil;&atilde;o
# nPosChave2 - a posicao inicial da segunda chave do arquivo de liga&ccedil;&atilde;o
# nTamChave2 - o tamanho da segunda chave do arquivo de liga&ccedil;&atilde;o
# sChave - a chave a ser pesquisada no arquivo de liga&ccedil;&atilde;o
# sArq2 - o arquivo a ser pesquisado
# sreg2 - o tipo de arquivo a ser pesquisado
# nPosChave3 - a posicao inicial da chave do arquivo pesquisado
# nQtdLinha - a quantidade de linhas a serem mostradas
#------------------------------------------------------------------------------
</font><font color="#0000FF"><b>def </b></font>ListarRegLigados<font color="#008080"><b>(</b></font>sArq1, sreg1, nPosChave1, nTamChave1, 
nPosChave2, nTamChave2, sChave, sArq2, sreg2, nPosChave3, nQtdLinha<font color="#008080"><b>)
</b></font>slinha1, sCodigo1, sCodigo2, slinha2 = <font color="#800000">&quot;&quot;</font>,<font color="#800000">&quot;&quot;</font>,<font color="#800000">&quot;&quot;</font>,<font color="#800000">&quot;&quot;
</font>bRet=false
nCont=0
bQuebra=false
mostrarDados<font color="#008080"><b>(</b></font>sreg2, <font color="#800000">&quot;&quot;</font>, 2<font color="#008080"><b>)
</b></font>sArq1.<font color="#800000"><b>seek</b></font><font color="#008080"><b>(0</b></font>, <font color="#800000"><b>IO</b></font>::SEEK_SET<font color="#008080"><b>)
</b></font><font color="#0000FF"><b>while </b></font><font color="#008080"><b>(</b></font>not sArq1.<font color="#800000"><b>eof</b></font><font color="#008080"><b>) </b></font>and <font color="#008080"><b>(</b></font>bQuebra==false<font color="#008080"><b>) </b></font>do
  slinha1 = sArq1.<font color="#800000"><b>readline
  </b></font>sCodigo1=copy<font color="#008080"><b>(</b></font>slinha1,nPosChave1,nTamChave1<font color="#008080"><b>)</b></font>.<font color="#800000"><b>strip
  </b></font><font color="#0000FF"><b>if </b></font>sCodigo1==sChave then
    sCodigo2=copy<font color="#008080"><b>(</b></font>slinha1,nPosChave2,nTamChave2<font color="#008080"><b>)</b></font>.<font color="#800000"><b>strip
    </b></font>slinha2=pesqArq<font color="#008080"><b>(</b></font>sArq2, sCodigo2, nPosChave3, nTamChave2, tamReg<font color="#008080"><b>(</b></font>sreg2<font color="#008080"><b>))
    </b></font>mostrarDados<font color="#008080"><b>(</b></font>sreg2, copy<font color="#008080"><b>(</b></font>slinha2, 1, tamReg<font color="#008080"><b>(</b></font>sreg2<font color="#008080"><b>))</b></font>, 3<font color="#008080"><b>)
    </b></font>bRet=true
    nCont=nCont+1
  <font color="#0000FF"><b>end
  </b></font>bQuebra=ContinuaSN<font color="#008080"><b>(</b></font>nCont, nQtdLinha<font color="#008080"><b>)
</b></font><font color="#0000FF"><b>end
if </b></font>bRet==false then
   <font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font>rotulo<font color="#008080"><b>(</b></font>sreg2,0<font color="#008080"><b>)</b></font>,<font color="#800000">&quot;\n&quot;</font><font color="#008080"><b>)
</b></font><font color="#0000FF"><b>end
end
</b></font><font color="#808080">#------------------------------------------------------------------------------
# Valida a entrada de registros de acordo com a pesquisa feita.
# sArq - o arquivo
# sreg - o tipo de arquivo
# nTexto - o numero do r&oacute;tulo da entrada
# sEntrada - a chave a ser pesquisada e validada
# nTentativas - o n&uacute;mero m&aacute;ximo de tentativas
# bPesqRelativa - indica se vai realizar uma pesquisa relativa
# bTipoEntrada - indica o tipo de entrada
# retorna - o registro pesquisado e validado
#------------------------------------------------------------------------------
</font><font color="#0000FF"><b>def </b></font>validaEntrada<font color="#008080"><b>(</b></font>sArq, sreg, nTexto, sEntrada, nTentativas,
        bPesqRelativa, bTipoEntrada<font color="#008080"><b>)
</b></font>sres = <font color="#800000">&quot;&quot;
</font>nTamLinha=tamReg<font color="#008080"><b>(</b></font>sreg<font color="#008080"><b>)
</b></font>sMsgErro=rotulo<font color="#008080"><b>(</b></font>sreg,0<font color="#008080"><b>)
</b></font>sTexto=rotulo<font color="#008080"><b>(</b></font>sreg,nTexto<font color="#008080"><b>)
</b></font>nPosChave=$g_nPosChave
nTamChave=$g_nTamChave

ncont=1
bQuebra=false
  <font color="#0000FF"><b>while </b></font><font color="#008080"><b>(</b></font>bQuebra==false<font color="#008080"><b>) </b></font>and <font color="#008080"><b>(</b></font>ncont &lt;= nTentativas <font color="#008080"><b>) </b></font>do
    <font color="#0000FF"><b>if  </b></font>bTipoEntrada==OPTEXTO then
      <font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font>sTexto<font color="#008080"><b>)
      </b></font>sEntrada = digita<font color="#008080"><b>()
    </b></font><font color="#0000FF"><b>elsif </b></font>bTipoEntrada==OPNUMERO then
       sEntrada=validaNumero<font color="#008080"><b>(</b></font>sTexto,sEntrada<font color="#008080"><b>)
    </b></font><font color="#0000FF"><b>elsif </b></font>bTipoEntrada==OPDATA then
       sEntrada=validaDataHora<font color="#008080"><b>(</b></font>sTexto,sEntrada,true<font color="#008080"><b>)
    </b></font><font color="#0000FF"><b>elsif </b></font>bTipoEntrada==OPDATAHORA then
       sEntrada=validaDataHora<font color="#008080"><b>(</b></font>sTexto,sEntrada,false<font color="#008080"><b>)
    </b></font><font color="#0000FF"><b>elsif </b></font>bTipoEntrada==OPSENHA then
       sEntrada=digitaSenha<font color="#008080"><b>(</b></font>sTexto, 10<font color="#008080"><b>)
    </b></font><font color="#0000FF"><b>end

    if </b></font>bPesqRelativa then
       <font color="#0000FF"><b>if </b></font>ListarTodos<font color="#008080"><b>(</b></font>sArq, sreg, sEntrada, nPosChave, nTamChave, nTamLinha,
                      QTD_MAX_LINHA, true<font color="#008080"><b>) </b></font>then
          sres=<font color="#800000">&quot; &quot;
       </font><font color="#0000FF"><b>end
    else
       </b></font>sres=pesqArq<font color="#008080"><b>(</b></font>sArq, sEntrada, nPosChave, nTamChave, nTamLinha<font color="#008080"><b>)
    </b></font><font color="#0000FF"><b>end
    if </b></font>sres==<font color="#800000">&quot;&quot; </font>then
       <font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font>sMsgErro,<font color="#800000">&quot;\n&quot;</font><font color="#008080"><b>)
    </b></font><font color="#0000FF"><b>else
       </b></font>bQuebra=true
    <font color="#0000FF"><b>end
    </b></font>ncont=ncont+1
  <font color="#0000FF"><b>end
return </b></font>sres
<font color="#0000FF"><b>end
</b></font><font color="#808080">#------------------------------------------------------------------------------
# Mostra a tela de splash do sistema.
#------------------------------------------------------------------------------
</font><font color="#0000FF"><b>def </b></font>frmSplash<font color="#008080"><b>()
 </b></font><font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;*---------------------------------------&quot;</font>+
 <font color="#800000">&quot;-------------------------------------*\n&quot;</font><font color="#008080"><b>)
 </b></font><font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;| LL    II VV   VV RRRRR  UU  UU   SSSS &quot;</font>+
 <font color="#800000">&quot;VV   VV II RRRRR  TTTT UU  UU   SSSS |\n&quot;</font><font color="#008080"><b>)
 </b></font><font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;| LL    II  VV VV  RR   R UU  UU  SS    &quot;</font>+
 <font color="#800000">&quot; VV VV  II RR   R  TT  UU  UU  SS    |\n&quot;</font><font color="#008080"><b>)
 </b></font><font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;| LL    II   VVV   RRRRR  UU  UU    SS  &quot;</font>+
 <font color="#800000">&quot;  VVV   II RRRRR   TT  UU  UU    SS  |\n&quot;</font><font color="#008080"><b>)
 </b></font><font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;| LLLLL II    V    RR   R  UUUU  SSSS   &quot;</font>+
 <font color="#800000">&quot;   V    II RR   R  TT   UUUU  SSSS   |\n&quot;</font><font color="#008080"><b>)
 </b></font><font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;*---------------------------------------&quot;</font>+
 <font color="#800000">&quot;-------------------------------------*\n&quot;</font><font color="#008080"><b>)
 </b></font><font color="#0000FF"><b>for </b></font>cont in <font color="#008080"><b>(1</b></font>..18<font color="#008080"><b>) </b></font>do 
   <font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;\n&quot;</font><font color="#008080"><b>)
 </b></font><font color="#0000FF"><b>end
 print</b></font><font color="#008080"><b>(</b></font>MSG_PRESS<font color="#008080"><b>)
 </b></font>$stdin.<font color="#800000"><b>getc
</b></font><font color="#0000FF"><b>end
</b></font><font color="#808080">#------------------------------------------------------------------------------
# Mostra a tela de sobre do sistema.
#------------------------------------------------------------------------------
</font><font color="#0000FF"><b>def </b></font>frmSobre<font color="#008080"><b>()
 </b></font><font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;*------------------------------------------------------------*\n&quot;</font><font color="#008080"><b>)
 </b></font><font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;|  LL        II  VV       VV  RRRRRRR   UU    UU   SSSSSSS   |\n&quot;</font><font color="#008080"><b>)
 </b></font><font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;|  LL        II   VV     VV   RR     R  UU    UU  SS         |\n&quot;</font><font color="#008080"><b>)
 </b></font><font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;|  LL        II    VV   VV    RR     R  UU    UU   SSSS      |\n&quot;</font><font color="#008080"><b>)
 </b></font><font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;|  LL        II     VV VV     RRRRRRR   UU    UU     SSSS    |\n&quot;</font><font color="#008080"><b>)
 </b></font><font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;|  LLLL      II      VVV      RR RR     UU    UU        SS   |\n&quot;</font><font color="#008080"><b>)
 </b></font><font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;|  LLLLLLLL  II       V       RR   RR    UUUUUU   SSSSSSSS   |\n&quot;</font><font color="#008080"><b>)
 </b></font><font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;|                                                            |\n&quot;</font><font color="#008080"><b>)
 </b></font><font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;|  VV       VV  II  RRRRRRR   TTTTTTTT  UU    UU   SSSSSSS   |\n&quot;</font><font color="#008080"><b>)
 </b></font><font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;|   VV     VV   II  RR     R     TT     UU    UU  SS         |\n&quot;</font><font color="#008080"><b>)
 </b></font><font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;|    VV   VV    II  RR     R     TT     UU    UU   SSSS      |\n&quot;</font><font color="#008080"><b>)
 </b></font><font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;|     VV VV     II  RRRRRRR      TT     UU    UU     SSSS    |\n&quot;</font><font color="#008080"><b>)
 </b></font><font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;|      VVV      II  RR RR        TT     UU    UU        SS   |\n&quot;</font><font color="#008080"><b>)
 </b></font><font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;|       V       II  RR   RR      TT      UUUUUU   SSSSSSSS   |\n&quot;</font><font color="#008080"><b>)
 </b></font><font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;|                                                            |\n&quot;</font><font color="#008080"><b>)
 </b></font><font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;|                                               Versao 1.0.0 |\n&quot;</font><font color="#008080"><b>)
 </b></font><font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;| Sistema integrante do projeto Livrus Virtus.               |\n&quot;</font><font color="#008080"><b>)
 </b></font><font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;| Todos os direitos reservados para Henrique F. de Souza.    |\n&quot;</font><font color="#008080"><b>)
 </b></font><font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;| Versao programada na linguagem ruby.                       |\n&quot;</font><font color="#008080"><b>)
 </b></font><font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;*------------------------------------------------------------*\n&quot;</font><font color="#008080"><b>)
 </b></font><font color="#0000FF"><b>for </b></font>cont in <font color="#008080"><b>(1</b></font>..4<font color="#008080"><b>) </b></font>do 
   <font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;\n&quot;</font><font color="#008080"><b>)
 </b></font><font color="#0000FF"><b>end
 print</b></font><font color="#008080"><b>(</b></font>MSG_PRESS<font color="#008080"><b>)
 </b></font>$stdin.<font color="#800000"><b>getc
</b></font><font color="#0000FF"><b>end
</b></font><font color="#808080">#------------------------------------------------------------------------------
# Mostra a tela de login do sistema.
# retorna - se o login foi validado corretamente
#------------------------------------------------------------------------------
</font><font color="#0000FF"><b>def </b></font>frmLogin<font color="#008080"><b>()
</b></font>slinha = <font color="#800000">&quot;&quot;

  </font>bret=false
  <font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;*--------------------------------------------------------------*\n&quot;</font><font color="#008080"><b>)
  </b></font><font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;| Login do sistema                                             |\n&quot;</font><font color="#008080"><b>)
  </b></font><font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;*--------------------------------------------------------------*\n&quot;</font><font color="#008080"><b>)
  </b></font>slinha=validaEntrada<font color="#008080"><b>($</b></font>tfUsuario, OPUSUARIO, 1, TUsuario<font color="#008080"><b>[</b></font><font color="#800000">&quot;login&quot;</font><font color="#008080"><b>]</b></font>, 3,
        false, OPTEXTO<font color="#008080"><b>)
  </b></font><font color="#0000FF"><b>if </b></font>slinha!=<font color="#800000">&quot;&quot; </font>then
     slinha=validaEntrada<font color="#008080"><b>($</b></font>tfUsuario, OPUSUARIO, 2, TUsuario<font color="#008080"><b>[</b></font><font color="#800000">&quot;senha&quot;</font><font color="#008080"><b>]</b></font>, 3,
        false, OPSENHA<font color="#008080"><b>)
     </b></font><font color="#0000FF"><b>if </b></font>slinha!=<font color="#800000">&quot;&quot; </font>then
        TUsuario<font color="#008080"><b>[</b></font><font color="#800000">&quot;login&quot;</font><font color="#008080"><b>]</b></font>=copy<font color="#008080"><b>(</b></font>slinha, 1, 10<font color="#008080"><b>)</b></font>.<font color="#800000"><b>strip
        </b></font>TUsuario<font color="#008080"><b>[</b></font><font color="#800000">&quot;senha&quot;</font><font color="#008080"><b>]</b></font>=copy<font color="#008080"><b>(</b></font>slinha, 11, 10<font color="#008080"><b>)</b></font>.<font color="#800000"><b>strip
        </b></font>bret=true
     <font color="#0000FF"><b>end
  end
  print</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;\n&quot;</font><font color="#008080"><b>)
  </b></font><font color="#0000FF"><b>return </b></font>bret
<font color="#0000FF"><b>end
</b></font><font color="#808080">#------------------------------------------------------------------------------
# Mostra os menus do sistema.
# num - o n&uacute;mero do menu
#------------------------------------------------------------------------------
</font><font color="#0000FF"><b>def </b></font>menu<font color="#008080"><b>(</b></font>num<font color="#008080"><b>)
 </b></font><font color="#0000FF"><b>if </b></font><font color="#008080"><b>(</b></font>num==1<font color="#008080"><b>) </b></font>then
   <font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;*--------------------------------------------------------------*\n&quot;</font><font color="#008080"><b>)
   </b></font><font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;| (C)adastros        (P)esquisas     (V)endas        (O)p&ccedil;&otilde;es  |\n&quot;</font><font color="#008080"><b>)
   </b></font><font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;*--------------------------------------------------------------*\n&quot;</font><font color="#008080"><b>)
 </b></font><font color="#0000FF"><b>elsif </b></font><font color="#008080"><b>(</b></font>num==2<font color="#008080"><b>) </b></font>then
   <font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;*---------------------------------*\n&quot;</font><font color="#008080"><b>)
   </b></font><font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;| 01. Cadastro de Assuntos        |\n&quot;</font><font color="#008080"><b>)
   </b></font><font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;| 02. Cadastro de Autores         |\n&quot;</font><font color="#008080"><b>)
   </b></font><font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;| 03. Cadastro de Editoras        |\n&quot;</font><font color="#008080"><b>)
   </b></font><font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;| 04. Cadastro de Endere&ccedil;os       |\n&quot;</font><font color="#008080"><b>)
   </b></font><font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;| 05. Cadastro de Idiomas         |\n&quot;</font><font color="#008080"><b>)
   </b></font><font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;| 06. Cadastro de Pa&iacute;ses          |\n&quot;</font><font color="#008080"><b>)
   </b></font><font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;| 07. Cadastro de Profiss&otilde;es      |\n&quot;</font><font color="#008080"><b>)
   </b></font><font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;| 08. Cadastro de Clientes        |\n&quot;</font><font color="#008080"><b>)
   </b></font><font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;| 09. Cadastro de Livros          |\n&quot;</font><font color="#008080"><b>)
   </b></font><font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;| 10. Voltar ao menu              |\n&quot;</font><font color="#008080"><b>)
   </b></font><font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;*---------------------------------*\n&quot;</font><font color="#008080"><b>)
 </b></font><font color="#0000FF"><b>elsif </b></font><font color="#008080"><b>(</b></font>num==3<font color="#008080"><b>) </b></font>then
   <font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;*---------------------------------*\n&quot;</font><font color="#008080"><b>)
   </b></font><font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;| 01. Consulta de Assuntos        |\n&quot;</font><font color="#008080"><b>)
   </b></font><font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;| 02. Consulta de Autores         |\n&quot;</font><font color="#008080"><b>)
   </b></font><font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;| 03. Consulta de Editoras        |\n&quot;</font><font color="#008080"><b>)
   </b></font><font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;| 04. Consulta de Endere&ccedil;os       |\n&quot;</font><font color="#008080"><b>)
   </b></font><font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;| 05. Consulta de Idiomas         |\n&quot;</font><font color="#008080"><b>)
   </b></font><font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;| 06. Consulta de Pa&iacute;ses          |\n&quot;</font><font color="#008080"><b>)
   </b></font><font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;| 07. Consulta de Profiss&otilde;es      |\n&quot;</font><font color="#008080"><b>)
   </b></font><font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;| 08. Consulta de Clientes        |\n&quot;</font><font color="#008080"><b>)
   </b></font><font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;| 09. Consulta de Livros          |\n&quot;</font><font color="#008080"><b>)
   </b></font><font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;| 10. Voltar ao menu              |\n&quot;</font><font color="#008080"><b>)
   </b></font><font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;*---------------------------------*\n&quot;</font><font color="#008080"><b>)
 </b></font><font color="#0000FF"><b>elsif </b></font><font color="#008080"><b>(</b></font>num==4<font color="#008080"><b>) </b></font>then
   <font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;*---------------------------------*\n&quot;</font><font color="#008080"><b>)
   </b></font><font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;| 01. Vender Livros               |\n&quot;</font><font color="#008080"><b>)
   </b></font><font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;| 02. Vendas Realizadas           |\n&quot;</font><font color="#008080"><b>)
   </b></font><font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;| 03. Voltar ao menu              |\n&quot;</font><font color="#008080"><b>)
   </b></font><font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;*---------------------------------*\n&quot;</font><font color="#008080"><b>)
 </b></font><font color="#0000FF"><b>elsif </b></font><font color="#008080"><b>(</b></font>num==5<font color="#008080"><b>) </b></font>then
   <font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;*---------------------------------*\n&quot;</font><font color="#008080"><b>)
   </b></font><font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;| 01. Alterar senha               |\n&quot;</font><font color="#008080"><b>)
   </b></font><font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;| 02. Sobre o sistema             |\n&quot;</font><font color="#008080"><b>)
   </b></font><font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;| 03. Sair do sistema             |\n&quot;</font><font color="#008080"><b>)
   </b></font><font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;| 04. Voltar ao menu              |\n&quot;</font><font color="#008080"><b>)
   </b></font><font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;*---------------------------------*\n&quot;</font><font color="#008080"><b>)
 </b></font><font color="#0000FF"><b>elsif </b></font><font color="#008080"><b>(</b></font>num==6<font color="#008080"><b>) </b></font>then
   <font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;*--------------------------------------------------------------*\n&quot;</font><font color="#008080"><b>)
   </b></font><font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;| (1) Novo  (2) Pesquisar   (3) Voltar ao menu                 |\n&quot;</font><font color="#008080"><b>)
   </b></font><font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;*--------------------------------------------------------------*\n&quot;</font><font color="#008080"><b>)
 </b></font><font color="#0000FF"><b>elsif </b></font><font color="#008080"><b>(</b></font>num==7<font color="#008080"><b>) </b></font>then
   <font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;*--------------------------------------------------------------*\n&quot;</font><font color="#008080"><b>)
   </b></font><font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;| (1) Salvar inclus&atilde;o       (2) Voltar ao menu                 |\n&quot;</font><font color="#008080"><b>)
   </b></font><font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;*--------------------------------------------------------------*\n&quot;</font><font color="#008080"><b>)
 </b></font><font color="#0000FF"><b>elsif </b></font><font color="#008080"><b>(</b></font>num==8<font color="#008080"><b>) </b></font>then
   <font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;*--------------------------------------------------------------*\n&quot;</font><font color="#008080"><b>)
   </b></font><font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;| (1) Alterar       (2) Excluir     (3) Voltar ao menu         |\n&quot;</font><font color="#008080"><b>)
   </b></font><font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;*--------------------------------------------------------------*\n&quot;</font><font color="#008080"><b>)
 </b></font><font color="#0000FF"><b>elsif </b></font><font color="#008080"><b>(</b></font>num==9<font color="#008080"><b>) </b></font>then
   <font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;*--------------------------------------------------------------*\n&quot;</font><font color="#008080"><b>)
   </b></font><font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;| (1) Salvar altera&ccedil;&atilde;o      (2) Voltar ao menu                 |\n&quot;</font><font color="#008080"><b>)
   </b></font><font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;*--------------------------------------------------------------*\n&quot;</font><font color="#008080"><b>)
 </b></font><font color="#0000FF"><b>elsif </b></font><font color="#008080"><b>(</b></font>num==10<font color="#008080"><b>) </b></font>then
   <font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;*--------------------------------------------------------------*\n&quot;</font><font color="#008080"><b>)
   </b></font><font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;| Certeza de excluir? (S/N)                                    |\n&quot;</font><font color="#008080"><b>)
   </b></font><font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;*--------------------------------------------------------------*\n&quot;</font><font color="#008080"><b>)
 </b></font><font color="#0000FF"><b>elsif </b></font><font color="#008080"><b>(</b></font>num==11<font color="#008080"><b>) </b></font>then
   <font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;*--------------------------------------------------------------*\n&quot;</font><font color="#008080"><b>)
   </b></font><font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;| Deseja sair do sistema? (S/N)                                |\n&quot;</font><font color="#008080"><b>)
   </b></font><font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;*--------------------------------------------------------------*\n&quot;</font><font color="#008080"><b>)
 </b></font><font color="#0000FF"><b>elsif </b></font><font color="#008080"><b>(</b></font>num==12<font color="#008080"><b>) </b></font>then
   <font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;*--------------------------------------------------------------*\n&quot;</font><font color="#008080"><b>)
   </b></font><font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;| (1) Pesquisar  (2) Listar todos   (3) Voltar ao menu         |\n&quot;</font><font color="#008080"><b>)
   </b></font><font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;*--------------------------------------------------------------*\n&quot;</font><font color="#008080"><b>)
 </b></font><font color="#0000FF"><b>elsif </b></font><font color="#008080"><b>(</b></font>num==13<font color="#008080"><b>) </b></font>then
   <font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;*--------------------------------------------------------------*\n&quot;</font><font color="#008080"><b>)
   </b></font><font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;| Deseja continuar? (S/N)                                      |\n&quot;</font><font color="#008080"><b>)
   </b></font><font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;*--------------------------------------------------------------*\n&quot;</font><font color="#008080"><b>)
 </b></font><font color="#0000FF"><b>elsif </b></font><font color="#008080"><b>(</b></font>num==14<font color="#008080"><b>) </b></font>then
   <font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;*--------------------------------------------------------------*\n&quot;</font><font color="#008080"><b>)
   </b></font><font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;| Salvar inclus&atilde;o (S/N)                                        |\n&quot;</font><font color="#008080"><b>)
   </b></font><font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;*--------------------------------------------------------------*\n&quot;</font><font color="#008080"><b>)
 </b></font><font color="#0000FF"><b>end
 print</b></font><font color="#008080"><b>(</b></font>MSG_OPCAO<font color="#008080"><b>)
</b></font><font color="#0000FF"><b>end
</b></font><font color="#808080">#------------------------------------------------------------------------------
# Realiza os cadastros de acordo com o tipo de arquivo.
# sreg - o tipo de arquivo
# sacao - a a&ccedil;&atilde;o a ser realizada
#------------------------------------------------------------------------------
</font><font color="#0000FF"><b>def </b></font>frmCadastros<font color="#008080"><b>(</b></font>sreg, sacao<font color="#008080"><b>)
</b></font>slinha = <font color="#800000">&quot;&quot;
</font><font color="#0000FF"><b>if </b></font>sreg==OPASSUNTO then
   <font color="#0000FF"><b>if </b></font>sacao==OPNOVO then
      TAssunto<font color="#008080"><b>[</b></font><font color="#800000">&quot;codigo&quot;</font><font color="#008080"><b>]</b></font>=pesqMaxCod<font color="#008080"><b>($</b></font>tfAssunto, 1, 10, tamReg<font color="#008080"><b>(</b></font>sreg<font color="#008080"><b>))
      </b></font>mostrarDados<font color="#008080"><b>(</b></font>sreg, <font color="#800000">&quot;&quot;</font>, 1<font color="#008080"><b>)
      </b></font>subMenu<font color="#008080"><b>(7</b></font>, sreg<font color="#008080"><b>)
   </b></font><font color="#0000FF"><b>elsif </b></font>sacao==OPPESQUISAR then
     slinha=validaEntrada<font color="#008080"><b>($</b></font>tfAssunto,sreg,1,TAssunto<font color="#008080"><b>[</b></font><font color="#800000">&quot;codigo&quot;</font><font color="#008080"><b>]</b></font>,1,false,OPNUMERO<font color="#008080"><b>)
      </b></font><font color="#0000FF"><b>if </b></font>slinha!=<font color="#800000">&quot;&quot; </font>then
        mostrarDados<font color="#008080"><b>(</b></font>sreg, <font color="#800000">&quot;&quot;</font>, 2<font color="#008080"><b>)
        </b></font>mostrarDados<font color="#008080"><b>(</b></font>sreg, slinha, 3<font color="#008080"><b>)
        </b></font>subMenu<font color="#008080"><b>(8</b></font>, sreg<font color="#008080"><b>)
      </b></font><font color="#0000FF"><b>end
   elsif </b></font>sacao==OPALTERAR then
      mostrarDados<font color="#008080"><b>(</b></font>sreg, <font color="#800000">&quot;&quot;</font>, 1<font color="#008080"><b>)
      </b></font>subMenu<font color="#008080"><b>(9</b></font>, sreg<font color="#008080"><b>)
   </b></font><font color="#0000FF"><b>elsif </b></font>sacao==OPEXCLUIR then
      subMenu<font color="#008080"><b>(10</b></font>, sreg<font color="#008080"><b>)
   </b></font><font color="#0000FF"><b>end
elsif </b></font>sreg==OPAUTOR then
   <font color="#0000FF"><b>if </b></font>sacao==opNovo then
      TAutor<font color="#008080"><b>[</b></font><font color="#800000">&quot;codigo&quot;</font><font color="#008080"><b>]</b></font>=pesqMaxCod<font color="#008080"><b>($</b></font>tfAutor, 1, 10, tamReg<font color="#008080"><b>(</b></font>sreg<font color="#008080"><b>))
      </b></font>mostrarDados<font color="#008080"><b>(</b></font>sreg, <font color="#800000">&quot;&quot;</font>, 1<font color="#008080"><b>)
      </b></font>subMenu<font color="#008080"><b>(7</b></font>, sreg<font color="#008080"><b>)
   </b></font><font color="#0000FF"><b>elsif </b></font>sacao==OPPESQUISAR then
      slinha=validaEntrada<font color="#008080"><b>($</b></font>tfAutor, sreg, 1, TAutor<font color="#008080"><b>[</b></font><font color="#800000">&quot;codigo&quot;</font><font color="#008080"><b>]</b></font>,1,false,OPNUMERO<font color="#008080"><b>)
      </b></font><font color="#0000FF"><b>if </b></font>slinha!=<font color="#800000">&quot;&quot; </font>then
        mostrarDados<font color="#008080"><b>(</b></font>sreg, <font color="#800000">&quot;&quot;</font>, 2<font color="#008080"><b>)
        </b></font>mostrarDados<font color="#008080"><b>(</b></font>sreg, slinha, 3<font color="#008080"><b>)
        </b></font>subMenu<font color="#008080"><b>(8</b></font>, sreg<font color="#008080"><b>)
      </b></font><font color="#0000FF"><b>end
   elsif </b></font>sacao==OPALTERAR then
      mostrarDados<font color="#008080"><b>(</b></font>sreg, <font color="#800000">&quot;&quot;</font>, 1<font color="#008080"><b>)
      </b></font>subMenu<font color="#008080"><b>(9</b></font>, sreg<font color="#008080"><b>)
   </b></font><font color="#0000FF"><b>elsif </b></font>sacao==OPEXCLUIR then
      subMenu<font color="#008080"><b>(10</b></font>, sreg<font color="#008080"><b>)
   </b></font><font color="#0000FF"><b>end
elsif </b></font>sreg==OPEDITORA then
   <font color="#0000FF"><b>if </b></font>sacao==OPNOVO then
      TEditora<font color="#008080"><b>[</b></font><font color="#800000">&quot;codigo&quot;</font><font color="#008080"><b>]</b></font>=pesqMaxCod<font color="#008080"><b>($</b></font>tfEditora, 1, 10, tamReg<font color="#008080"><b>(</b></font>sreg<font color="#008080"><b>))
      </b></font>mostrarDados<font color="#008080"><b>(</b></font>sreg, <font color="#800000">&quot;&quot;</font>, 1<font color="#008080"><b>)
      </b></font>subMenu<font color="#008080"><b>(7</b></font>, sreg<font color="#008080"><b>)
   </b></font><font color="#0000FF"><b>elsif </b></font>sacao==OPPESQUISAR then
     slinha=validaEntrada<font color="#008080"><b>($</b></font>tfEditora,sreg,1,TEditora<font color="#008080"><b>[</b></font><font color="#800000">&quot;codigo&quot;</font><font color="#008080"><b>]</b></font>,1,false,OPNUMERO<font color="#008080"><b>)
      </b></font><font color="#0000FF"><b>if </b></font>slinha!=<font color="#800000">&quot;&quot; </font>then
        mostrarDados<font color="#008080"><b>(</b></font>sreg, <font color="#800000">&quot;&quot;</font>, 2<font color="#008080"><b>)
        </b></font>mostrarDados<font color="#008080"><b>(</b></font>sreg, slinha, 3<font color="#008080"><b>)
        </b></font>subMenu<font color="#008080"><b>(8</b></font>, sreg<font color="#008080"><b>)
      </b></font><font color="#0000FF"><b>end
   elsif </b></font>sacao==OPALTERAR then
      mostrarDados<font color="#008080"><b>(</b></font>sreg, <font color="#800000">&quot;&quot;</font>, 1<font color="#008080"><b>)
      </b></font>subMenu<font color="#008080"><b>(9</b></font>, sreg<font color="#008080"><b>)
   </b></font><font color="#0000FF"><b>elsif </b></font>sacao==OPEXCLUIR then
      subMenu<font color="#008080"><b>(10</b></font>, sreg<font color="#008080"><b>)
   </b></font><font color="#0000FF"><b>end
elsif </b></font>sreg==OPENDERECO then
   <font color="#0000FF"><b>if </b></font>sacao==OPNOVO then
      TEndereco<font color="#008080"><b>[</b></font><font color="#800000">&quot;codigo&quot;</font><font color="#008080"><b>]</b></font>=pesqMaxCod<font color="#008080"><b>($</b></font>tfEndereco, 1, 10, tamReg<font color="#008080"><b>(</b></font>sreg<font color="#008080"><b>))
      </b></font>mostrarDados<font color="#008080"><b>(</b></font>sreg, <font color="#800000">&quot;&quot;</font>, 1<font color="#008080"><b>)
      </b></font>subMenu<font color="#008080"><b>(7</b></font>, sreg<font color="#008080"><b>)
   </b></font><font color="#0000FF"><b>elsif </b></font>sacao==OPPESQUISAR then
      slinha=validaEntrada<font color="#008080"><b>($</b></font>tfEndereco,sreg,1,TEndereco<font color="#008080"><b>[</b></font><font color="#800000">&quot;codigo&quot;</font><font color="#008080"><b>]</b></font>,1,
              false,OPNUMERO<font color="#008080"><b>)
      </b></font><font color="#0000FF"><b>if </b></font>slinha!=<font color="#800000">&quot;&quot; </font>then
        mostrarDados<font color="#008080"><b>(</b></font>sreg, <font color="#800000">&quot;&quot;</font>, 2<font color="#008080"><b>)
        </b></font>mostrarDados<font color="#008080"><b>(</b></font>sreg, slinha, 3<font color="#008080"><b>)
        </b></font>subMenu<font color="#008080"><b>(8</b></font>, sreg<font color="#008080"><b>)
      </b></font><font color="#0000FF"><b>end
   elsif </b></font>sacao==OPALTERAR then
      mostrarDados<font color="#008080"><b>(</b></font>sreg, <font color="#800000">&quot;&quot;</font>, 1<font color="#008080"><b>)
      </b></font>subMenu<font color="#008080"><b>(9</b></font>, sreg<font color="#008080"><b>)
   </b></font><font color="#0000FF"><b>elsif </b></font>sacao==OPEXCLUIR then
      subMenu<font color="#008080"><b>(10</b></font>, sreg<font color="#008080"><b>)
   </b></font><font color="#0000FF"><b>end
elsif </b></font>sreg==OPIDIOMA then
   <font color="#0000FF"><b>if </b></font>sacao==OPNOVO then
      TIdioma<font color="#008080"><b>[</b></font><font color="#800000">&quot;codigo&quot;</font><font color="#008080"><b>]</b></font>=pesqMaxCod<font color="#008080"><b>($</b></font>tfIdioma, 1, 10, tamReg<font color="#008080"><b>(</b></font>sreg<font color="#008080"><b>))
      </b></font>mostrarDados<font color="#008080"><b>(</b></font>sreg, <font color="#800000">&quot;&quot;</font>, 1<font color="#008080"><b>)
      </b></font>subMenu<font color="#008080"><b>(7</b></font>, sreg<font color="#008080"><b>)
   </b></font><font color="#0000FF"><b>elsif </b></font>sacao==OPPESQUISAR then
      slinha=validaEntrada<font color="#008080"><b>($</b></font>tfIdioma,sreg,1,TIdioma<font color="#008080"><b>[</b></font><font color="#800000">&quot;codigo&quot;</font><font color="#008080"><b>]</b></font>,1,false,OPNUMERO<font color="#008080"><b>)
      </b></font><font color="#0000FF"><b>if </b></font>slinha!=<font color="#800000">&quot;&quot; </font>then
        mostrarDados<font color="#008080"><b>(</b></font>sreg, <font color="#800000">&quot;&quot;</font>, 2<font color="#008080"><b>)
        </b></font>mostrarDados<font color="#008080"><b>(</b></font>sreg, slinha, 3<font color="#008080"><b>)
        </b></font>subMenu<font color="#008080"><b>(8</b></font>, sreg<font color="#008080"><b>)
      </b></font><font color="#0000FF"><b>end
   elsif </b></font>sacao==OPALTERAR then
      mostrarDados<font color="#008080"><b>(</b></font>sreg, <font color="#800000">&quot;&quot;</font>, 1<font color="#008080"><b>)
      </b></font>subMenu<font color="#008080"><b>(9</b></font>, sreg<font color="#008080"><b>)
   </b></font><font color="#0000FF"><b>elsif </b></font>sacao==OPEXCLUIR then
      subMenu<font color="#008080"><b>(10</b></font>, sreg<font color="#008080"><b>)
   </b></font><font color="#0000FF"><b>end
elsif </b></font>sreg==OPPAIS then
   <font color="#0000FF"><b>if </b></font>sacao==OPNOVO then
      <font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font>rotulo<font color="#008080"><b>(</b></font>sreg, 1<font color="#008080"><b>))
      </b></font>TPais<font color="#008080"><b>[</b></font><font color="#800000">&quot;codigo&quot;</font><font color="#008080"><b>] </b></font>= digita<font color="#008080"><b>()
      </b></font>slinha=pesqArq<font color="#008080"><b>($</b></font>tfPais, TPais<font color="#008080"><b>[</b></font><font color="#800000">&quot;codigo&quot;</font><font color="#008080"><b>]</b></font>, 1, 3, tamReg<font color="#008080"><b>(</b></font>sreg<font color="#008080"><b>))
      </b></font><font color="#0000FF"><b>if </b></font>slinha==<font color="#800000">&quot;&quot; </font>then
         pesqLinhaExcluida<font color="#008080"><b>($</b></font>tfPais, tamReg<font color="#008080"><b>(</b></font>sreg<font color="#008080"><b>))
         </b></font>mostrarDados<font color="#008080"><b>(</b></font>sreg, <font color="#800000">&quot;&quot;</font>, 1<font color="#008080"><b>)
         </b></font>subMenu<font color="#008080"><b>(7</b></font>, sreg<font color="#008080"><b>)
      </b></font><font color="#0000FF"><b>else 
         print</b></font><font color="#008080"><b>(</b></font>MSG_REGEXST<font color="#008080"><b>)
      </b></font><font color="#0000FF"><b>end
   elsif </b></font>sacao==OPPESQUISAR then
      slinha=validaEntrada<font color="#008080"><b>($</b></font>tfPais, sreg, 1, TPais<font color="#008080"><b>[</b></font><font color="#800000">&quot;codigo&quot;</font><font color="#008080"><b>]</b></font>, 1, false, OPTEXTO<font color="#008080"><b>)
      </b></font><font color="#0000FF"><b>if </b></font>slinha!=<font color="#800000">&quot;&quot; </font>then
        mostrarDados<font color="#008080"><b>(</b></font>sreg, <font color="#800000">&quot;&quot;</font>, 2<font color="#008080"><b>)
        </b></font>mostrarDados<font color="#008080"><b>(</b></font>sreg, slinha, 3<font color="#008080"><b>)
        </b></font>subMenu<font color="#008080"><b>(8</b></font>, sreg<font color="#008080"><b>)
      </b></font><font color="#0000FF"><b>end
   elsif </b></font>sacao==opAlterar then
      <font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font>rotulo<font color="#008080"><b>(</b></font>sreg, 1<font color="#008080"><b>)</b></font>, TPais<font color="#008080"><b>[</b></font><font color="#800000">&quot;codigo&quot;</font><font color="#008080"><b>]</b></font>, <font color="#800000">&quot;\n&quot;</font><font color="#008080"><b>)
      </b></font>mostrarDados<font color="#008080"><b>(</b></font>sreg, <font color="#800000">&quot;&quot;</font>, 1<font color="#008080"><b>)
      </b></font>subMenu<font color="#008080"><b>(9</b></font>, sreg<font color="#008080"><b>)
   </b></font><font color="#0000FF"><b>elsif </b></font>sacao==opExcluir then
      subMenu<font color="#008080"><b>(10</b></font>, sreg<font color="#008080"><b>)
   </b></font><font color="#0000FF"><b>end
elsif </b></font>sreg==OPPROFISSAO then
   <font color="#0000FF"><b>if </b></font>sacao==OPNOVO then
      TProfissao<font color="#008080"><b>[</b></font><font color="#800000">&quot;codigo&quot;</font><font color="#008080"><b>]</b></font>=pesqMaxCod<font color="#008080"><b>($</b></font>tfProfissao, 1, 10, tamReg<font color="#008080"><b>(</b></font>sreg<font color="#008080"><b>))
      </b></font>mostrarDados<font color="#008080"><b>(</b></font>sreg, <font color="#800000">&quot;&quot;</font>, 1<font color="#008080"><b>)
      </b></font>subMenu<font color="#008080"><b>(7</b></font>, sreg<font color="#008080"><b>)
   </b></font><font color="#0000FF"><b>elsif </b></font>sacao==OPPESQUISAR then
      slinha=validaEntrada<font color="#008080"><b>($</b></font>tfProfissao,sreg,1,TProfissao<font color="#008080"><b>[</b></font><font color="#800000">&quot;codigo&quot;</font><font color="#008080"><b>]</b></font>,1,
              false,OPNUMERO<font color="#008080"><b>)
      </b></font><font color="#0000FF"><b>if </b></font>slinha!=<font color="#800000">&quot;&quot; </font>then
        mostrarDados<font color="#008080"><b>(</b></font>sreg, <font color="#800000">&quot;&quot;</font>, 2<font color="#008080"><b>)
        </b></font>mostrarDados<font color="#008080"><b>(</b></font>sreg, slinha, 3<font color="#008080"><b>)
        </b></font>subMenu<font color="#008080"><b>(8</b></font>, sreg<font color="#008080"><b>)
      </b></font><font color="#0000FF"><b>end
   elsif </b></font>sacao==OPALTERAR then
      mostrarDados<font color="#008080"><b>(</b></font>sreg, <font color="#800000">&quot;&quot;</font>, 1<font color="#008080"><b>)
      </b></font>subMenu<font color="#008080"><b>(9</b></font>, sreg<font color="#008080"><b>)
   </b></font><font color="#0000FF"><b>elsif </b></font>sacao==OPEXCLUIR then
      subMenu<font color="#008080"><b>(10</b></font>, sreg<font color="#008080"><b>)
   </b></font><font color="#0000FF"><b>end
elsif </b></font>sreg==OPLIVRO then
   <font color="#0000FF"><b>if </b></font>sacao==OPNOVO then
      <font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font>rotulo<font color="#008080"><b>(</b></font>sreg, 1<font color="#008080"><b>))
      </b></font>TLivro<font color="#008080"><b>[</b></font><font color="#800000">&quot;isbn&quot;</font><font color="#008080"><b>] </b></font>= digita<font color="#008080"><b>()
      </b></font><font color="#0000FF"><b>if </b></font>validaISBN<font color="#008080"><b>(</b></font>TLivro<font color="#008080"><b>[</b></font><font color="#800000">&quot;isbn&quot;</font><font color="#008080"><b>]) </b></font>then
          slinha=pesqArq<font color="#008080"><b>($</b></font>tfLivro, TLivro<font color="#008080"><b>[</b></font><font color="#800000">&quot;isbn&quot;</font><font color="#008080"><b>]</b></font>, 1, 13, tamReg<font color="#008080"><b>(</b></font>sreg<font color="#008080"><b>))
          </b></font><font color="#0000FF"><b>if </b></font>slinha==<font color="#800000">&quot;&quot; </font>then
             pesqLinhaExcluida<font color="#008080"><b>($</b></font>tfLivro, tamReg<font color="#008080"><b>(</b></font>sreg<font color="#008080"><b>))
             </b></font>mostrarDados<font color="#008080"><b>(</b></font>sreg, <font color="#800000">&quot;&quot;</font>, 1<font color="#008080"><b>)
             </b></font>subMenu<font color="#008080"><b>(7</b></font>, sreg<font color="#008080"><b>)
             </b></font>frmCadLigados<font color="#008080"><b>(</b></font>OPLIVROASS, OPNOVO, TLivro<font color="#008080"><b>[</b></font><font color="#800000">&quot;isbn&quot;</font><font color="#008080"><b>])
             </b></font>frmCadLigados<font color="#008080"><b>(</b></font>OPLIVROAUT, OPNOVO, TLivro<font color="#008080"><b>[</b></font><font color="#800000">&quot;isbn&quot;</font><font color="#008080"><b>])
          </b></font><font color="#0000FF"><b>else 
            print</b></font><font color="#008080"><b>(</b></font>MSG_REGEXST<font color="#008080"><b>)
          </b></font><font color="#0000FF"><b>end
      else 
        print</b></font><font color="#008080"><b>(</b></font>MSG_ISBNINV<font color="#008080"><b>)
      </b></font><font color="#0000FF"><b>end
   elsif </b></font>sacao==OPPESQUISAR then
      slinha=validaEntrada<font color="#008080"><b>($</b></font>tfLivro, sreg, 1, TLivro<font color="#008080"><b>[</b></font><font color="#800000">&quot;isbn&quot;</font><font color="#008080"><b>]</b></font>, 1,false,OPTEXTO<font color="#008080"><b>)
      </b></font><font color="#0000FF"><b>if </b></font>slinha!=<font color="#800000">&quot;&quot; </font>then
         mostrarDados<font color="#008080"><b>(</b></font>sreg, <font color="#800000">&quot;&quot;</font>, 2<font color="#008080"><b>)
         </b></font>mostrarDados<font color="#008080"><b>(</b></font>sreg, slinha, 3<font color="#008080"><b>)
         </b></font>subMenu<font color="#008080"><b>(8</b></font>, sreg<font color="#008080"><b>)
      </b></font><font color="#0000FF"><b>end
   elsif </b></font>sacao==OPALTERAR then
      <font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font>rotulo<font color="#008080"><b>(</b></font>sreg, 1<font color="#008080"><b>)</b></font>, TLivro<font color="#008080"><b>[</b></font><font color="#800000">&quot;isbn&quot;</font><font color="#008080"><b>]</b></font>, <font color="#800000">&quot;\n&quot;</font><font color="#008080"><b>)
      </b></font>mostrarDados<font color="#008080"><b>(</b></font>sreg, <font color="#800000">&quot;&quot;</font>, 1<font color="#008080"><b>)
      </b></font>subMenu<font color="#008080"><b>(9</b></font>, sreg<font color="#008080"><b>)
      </b></font>frmCadLigados<font color="#008080"><b>(</b></font>OPLIVROASS, OPEXCLUIR, TLivro<font color="#008080"><b>[</b></font><font color="#800000">&quot;isbn&quot;</font><font color="#008080"><b>])
      </b></font><font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;Assuntos dos livros exclu&iacute;dos, inclua novos!\n&quot;</font><font color="#008080"><b>)
      </b></font>frmCadLigados<font color="#008080"><b>(</b></font>OPLIVROASS, OPNOVO, TLivro<font color="#008080"><b>[</b></font><font color="#800000">&quot;isbn&quot;</font><font color="#008080"><b>])
      </b></font>frmCadLigados<font color="#008080"><b>(</b></font>OPLIVROAUT, OPEXCLUIR, TLivro<font color="#008080"><b>[</b></font><font color="#800000">&quot;isbn&quot;</font><font color="#008080"><b>])
      </b></font><font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;Autores dos livros exclu&iacute;dos, inclua novos!\n&quot;</font><font color="#008080"><b>)
      </b></font>frmCadLigados<font color="#008080"><b>(</b></font>OPLIVROAUT, OPNOVO, TLivro<font color="#008080"><b>[</b></font><font color="#800000">&quot;isbn&quot;</font><font color="#008080"><b>])
   </b></font><font color="#0000FF"><b>elsif </b></font>sacao==OPEXCLUIR then
      subMenu<font color="#008080"><b>(10</b></font>, sreg<font color="#008080"><b>)
      </b></font><font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;Assuntos dos livros sendo exclu&iacute;dos!\n&quot;</font><font color="#008080"><b>)
      </b></font>frmCadLigados<font color="#008080"><b>(</b></font>OPLIVROASS, OPEXCLUIR, TLivro<font color="#008080"><b>[</b></font><font color="#800000">&quot;isbn&quot;</font><font color="#008080"><b>])
      </b></font><font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;Autores dos livros sendo exclu&iacute;dos!\n&quot;</font><font color="#008080"><b>)
      </b></font>frmCadLigados<font color="#008080"><b>(</b></font>OPLIVROAUT, OPEXCLUIR, TLivro<font color="#008080"><b>[</b></font><font color="#800000">&quot;isbn&quot;</font><font color="#008080"><b>])
   </b></font><font color="#0000FF"><b>end
elsif </b></font>sreg==OPCLIENTE then
   <font color="#0000FF"><b>if </b></font>sacao==OPNOVO then
      <font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font>rotulo<font color="#008080"><b>(</b></font>sreg, 1<font color="#008080"><b>))
      </b></font>TCliente<font color="#008080"><b>[</b></font><font color="#800000">&quot;cpf&quot;</font><font color="#008080"><b>] </b></font>= digita<font color="#008080"><b>()
      </b></font><font color="#0000FF"><b>if </b></font>validaCPF<font color="#008080"><b>(</b></font>TCliente<font color="#008080"><b>[</b></font><font color="#800000">&quot;cpf&quot;</font><font color="#008080"><b>]) </b></font>then
          slinha=pesqArq<font color="#008080"><b>($</b></font>tfCliente, TCliente<font color="#008080"><b>[</b></font><font color="#800000">&quot;cpf&quot;</font><font color="#008080"><b>]</b></font>, 1, 14, tamReg<font color="#008080"><b>(</b></font>sreg<font color="#008080"><b>))
          </b></font><font color="#0000FF"><b>if </b></font>slinha==<font color="#800000">&quot;&quot; </font>then
             pesqLinhaExcluida<font color="#008080"><b>($</b></font>tfCliente, tamReg<font color="#008080"><b>(</b></font>sreg<font color="#008080"><b>))
             </b></font>mostrarDados<font color="#008080"><b>(</b></font>sreg, <font color="#800000">&quot;&quot;</font>, 1<font color="#008080"><b>)
             </b></font>subMenu<font color="#008080"><b>(7</b></font>, sreg<font color="#008080"><b>)
          </b></font><font color="#0000FF"><b>else 
            print</b></font><font color="#008080"><b>(</b></font>MSG_REGEXST<font color="#008080"><b>)
          </b></font><font color="#0000FF"><b>end
      else 
        print</b></font><font color="#008080"><b>(</b></font>MSG_CPFINV<font color="#008080"><b>)
      </b></font><font color="#0000FF"><b>end
   elsif </b></font>sacao==OPPESQUISAR then
      slinha=validaEntrada<font color="#008080"><b>($</b></font>tfCliente, sreg, 1, TCliente<font color="#008080"><b>[</b></font><font color="#800000">&quot;cpf&quot;</font><font color="#008080"><b>]</b></font>,1,false,OPTEXTO<font color="#008080"><b>)
      </b></font><font color="#0000FF"><b>if </b></font>slinha!=<font color="#800000">&quot;&quot; </font>then
         mostrarDados<font color="#008080"><b>(</b></font>sreg, <font color="#800000">&quot;&quot;</font>, 2<font color="#008080"><b>)
         </b></font>mostrarDados<font color="#008080"><b>(</b></font>sreg, slinha, 3<font color="#008080"><b>)
         </b></font>subMenu<font color="#008080"><b>(8</b></font>, sreg<font color="#008080"><b>)
      </b></font><font color="#0000FF"><b>end
   elsif </b></font>sacao==OPALTERAR then
      <font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font>rotulo<font color="#008080"><b>(</b></font>sreg, 1<font color="#008080"><b>)</b></font>, TCliente<font color="#008080"><b>[</b></font><font color="#800000">&quot;cpf&quot;</font><font color="#008080"><b>]</b></font>, <font color="#800000">&quot;\n&quot;</font><font color="#008080"><b>)
      </b></font>mostrarDados<font color="#008080"><b>(</b></font>sreg, <font color="#800000">&quot;&quot;</font>, 1<font color="#008080"><b>)
      </b></font>subMenu<font color="#008080"><b>(9</b></font>, sreg<font color="#008080"><b>)
   </b></font><font color="#0000FF"><b>elsif </b></font>sacao==OPEXCLUIR then
      subMenu<font color="#008080"><b>(10</b></font>, sreg<font color="#008080"><b>)
   </b></font><font color="#0000FF"><b>end
elsif </b></font>sreg==OPVENDA then
   <font color="#0000FF"><b>if </b></font>sacao==OPNOVO then
      TVenda<font color="#008080"><b>[</b></font><font color="#800000">&quot;dthrvenda&quot;</font><font color="#008080"><b>] </b></font>= retDataHora<font color="#008080"><b>()
      </b></font><font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font>rotulo<font color="#008080"><b>(</b></font>sreg, 1<font color="#008080"><b>)</b></font>, TVenda<font color="#008080"><b>[</b></font><font color="#800000">&quot;dthrvenda&quot;</font><font color="#008080"><b>]</b></font>, <font color="#800000">&quot;\n&quot;</font><font color="#008080"><b>)
      </b></font>slinha=pesqArq<font color="#008080"><b>($</b></font>tfVenda, TVenda<font color="#008080"><b>[</b></font><font color="#800000">&quot;dthrvenda&quot;</font><font color="#008080"><b>]</b></font>, 1, 19, tamReg<font color="#008080"><b>(</b></font>sreg<font color="#008080"><b>))
      </b></font><font color="#0000FF"><b>if </b></font>slinha==<font color="#800000">&quot;&quot; </font>then
         slinha=validaEntrada<font color="#008080"><b>($</b></font>tfCliente,OPCLIENTE,1,TVenda<font color="#008080"><b>[</b></font><font color="#800000">&quot;cpf&quot;</font><font color="#008080"><b>]</b></font>,3,
                 false,OPTEXTO<font color="#008080"><b>)
         </b></font><font color="#0000FF"><b>if </b></font>slinha!=<font color="#800000">&quot;&quot; </font>then
            TVenda<font color="#008080"><b>[</b></font><font color="#800000">&quot;cpf&quot;</font><font color="#008080"><b>]</b></font>=copy<font color="#008080"><b>(</b></font>slinha,1,14<font color="#008080"><b>)</b></font>.<font color="#800000"><b>strip
            </b></font><font color="#0000FF"><b>if </b></font>validaCPF<font color="#008080"><b>(</b></font>TVenda<font color="#008080"><b>[</b></font><font color="#800000">&quot;cpf&quot;</font><font color="#008080"><b>]) </b></font>then
               <font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot; &quot;</font>,rotulo<font color="#008080"><b>(</b></font>OPCLIENTE, 2<font color="#008080"><b>)) </b></font><font color="#808080"># Nome
               </font><font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font>copy<font color="#008080"><b>(</b></font>slinha, $g_nPosChave, $g_nTamChave<font color="#008080"><b>)</b></font>,<font color="#800000">&quot;\n&quot;</font><font color="#008080"><b>)
               </b></font>frmCadLigados<font color="#008080"><b>(</b></font>OPVENDA, OPNOVO, TVenda<font color="#008080"><b>[</b></font><font color="#800000">&quot;cpf&quot;</font><font color="#008080"><b>])
            </b></font><font color="#0000FF"><b>else 
              print</b></font><font color="#008080"><b>(</b></font>MSG_CPFINV<font color="#008080"><b>)
            </b></font><font color="#0000FF"><b>end
         end
      else 
        print</b></font><font color="#008080"><b>(</b></font>MSG_REGEXST<font color="#008080"><b>)
      </b></font><font color="#0000FF"><b>end
   elsif </b></font>sacao==OPPESQUISAR then
      slinha=validaEntrada<font color="#008080"><b>($</b></font>tfVenda, sreg, 1, TVenda<font color="#008080"><b>[</b></font><font color="#800000">&quot;dthrvenda&quot;</font><font color="#008080"><b>]</b></font>,1,
              false,OPDATAHORA<font color="#008080"><b>)
      </b></font><font color="#0000FF"><b>if </b></font>slinha!=<font color="#800000">&quot;&quot; </font>then
        mostrarDados<font color="#008080"><b>(</b></font>sreg, <font color="#800000">&quot;&quot;</font>, 2<font color="#008080"><b>)
        </b></font>mostrarDados<font color="#008080"><b>(</b></font>sreg, slinha, 3<font color="#008080"><b>)
        </b></font>subMenu<font color="#008080"><b>(8</b></font>, sreg<font color="#008080"><b>)
      </b></font><font color="#0000FF"><b>end
   end
end

end
</b></font><font color="#808080">#------------------------------------------------------------------------------
# Realiza as consultas de acordo com o tipo de arquivo.
# sreg - o tipo de arquivo
# sacao - a a&ccedil;&atilde;o a ser realizada
#------------------------------------------------------------------------------
</font><font color="#0000FF"><b>def </b></font>frmConsultas<font color="#008080"><b>(</b></font>sreg, sacao<font color="#008080"><b>)
</b></font>slinha = <font color="#800000">&quot;&quot;

</font><font color="#0000FF"><b>if </b></font>sreg==OPASSUNTO then
   <font color="#0000FF"><b>if </b></font>sacao==OPPESQUISAR then
      slinha=validaEntrada<font color="#008080"><b>($</b></font>tfAssunto,sreg,2,TAssunto<font color="#008080"><b>[</b></font><font color="#800000">&quot;assunto&quot;</font><font color="#008080"><b>]</b></font>,1,true,OPTEXTO<font color="#008080"><b>)
   </b></font><font color="#0000FF"><b>elsif </b></font>sacao==OPLISTARTODOS then
      <font color="#0000FF"><b>if </b></font>ListarTodos<font color="#008080"><b>($</b></font>tfAssunto, sreg, <font color="#800000">&quot;&quot;</font>, 0, 0, tamReg<font color="#008080"><b>(</b></font>sreg<font color="#008080"><b>)</b></font>,
        QTD_MAX_LINHA, false<font color="#008080"><b>) </b></font>== false then
        <font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font>rotulo<font color="#008080"><b>(</b></font>sreg, 0<font color="#008080"><b>)</b></font>,<font color="#800000">&quot;\n&quot;</font><font color="#008080"><b>)
      </b></font><font color="#0000FF"><b>end
   end
elsif </b></font>sreg==OPAUTOR then
   <font color="#0000FF"><b>if </b></font>sacao==OPPESQUISAR then
      slinha=validaEntrada<font color="#008080"><b>($</b></font>tfAutor,sreg, 2, TAutor<font color="#008080"><b>[</b></font><font color="#800000">&quot;autor&quot;</font><font color="#008080"><b>]</b></font>, 1, true,OPTEXTO<font color="#008080"><b>)
   </b></font><font color="#0000FF"><b>elsif </b></font>sacao==OPLISTARTODOS then
      <font color="#0000FF"><b>if </b></font>ListarTodos<font color="#008080"><b>($</b></font>tfAutor, sreg, <font color="#800000">&quot;&quot;</font>, 0, 0, tamReg<font color="#008080"><b>(</b></font>sreg<font color="#008080"><b>)</b></font>,
        QTD_MAX_LINHA, false<font color="#008080"><b>) </b></font>== false then
        <font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font>rotulo<font color="#008080"><b>(</b></font>sreg, 0<font color="#008080"><b>)</b></font>,<font color="#800000">&quot;\n&quot;</font><font color="#008080"><b>)
      </b></font><font color="#0000FF"><b>end
   end
elsif </b></font>sreg==OPEDITORA then
   <font color="#0000FF"><b>if </b></font>sacao==OPPESQUISAR then
      slinha=validaEntrada<font color="#008080"><b>($</b></font>tfEditora,sreg,2,TEditora<font color="#008080"><b>[</b></font><font color="#800000">&quot;editora&quot;</font><font color="#008080"><b>]</b></font>,1,true,OPTEXTO<font color="#008080"><b>)
   </b></font><font color="#0000FF"><b>elsif </b></font>sacao==OPLISTARTODOS then
      <font color="#0000FF"><b>if </b></font>ListarTodos<font color="#008080"><b>($</b></font>tfEditora, sreg, <font color="#800000">&quot;&quot;</font>, 0, 0, tamReg<font color="#008080"><b>(</b></font>sreg<font color="#008080"><b>)</b></font>,
        QTD_MAX_LINHA, false<font color="#008080"><b>) </b></font>== false then
        <font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font>rotulo<font color="#008080"><b>(</b></font>sreg, 0<font color="#008080"><b>)</b></font>,<font color="#800000">&quot;\n&quot;</font><font color="#008080"><b>)
      </b></font><font color="#0000FF"><b>end
   end
elsif </b></font>sreg==OPENDERECO then
   <font color="#0000FF"><b>if </b></font>sacao==OPPESQUISAR then
      slinha=validaEntrada<font color="#008080"><b>($</b></font>tfEndereco,sreg,2,TEndereco<font color="#008080"><b>[</b></font><font color="#800000">&quot;logradouro&quot;</font><font color="#008080"><b>]</b></font>,1,
              true,OPTEXTO<font color="#008080"><b>)
   </b></font><font color="#0000FF"><b>elsif </b></font>sacao==OPLISTARTODOS then
      <font color="#0000FF"><b>if </b></font>ListarTodos<font color="#008080"><b>($</b></font>tfEndereco, sreg, <font color="#800000">&quot;&quot;</font>, 0, 0, tamReg<font color="#008080"><b>(</b></font>sreg<font color="#008080"><b>)</b></font>,
         3, false<font color="#008080"><b>) </b></font>== false then
        <font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font>rotulo<font color="#008080"><b>(</b></font>sreg, 0<font color="#008080"><b>)</b></font>,<font color="#800000">&quot;\n&quot;</font><font color="#008080"><b>)
      </b></font><font color="#0000FF"><b>end
   end
elsif </b></font>sreg==OPIDIOMA then
   <font color="#0000FF"><b>if </b></font>sacao==OPPESQUISAR then
      slinha=validaEntrada<font color="#008080"><b>($</b></font>tfIdioma, sreg, 2, TIdioma<font color="#008080"><b>[</b></font><font color="#800000">&quot;idioma&quot;</font><font color="#008080"><b>]</b></font>,1,true,OPTEXTO<font color="#008080"><b>)
   </b></font><font color="#0000FF"><b>elsif </b></font>sacao==OPLISTARTODOS then
      <font color="#0000FF"><b>if </b></font>ListarTodos<font color="#008080"><b>($</b></font>tfIdioma, sreg, <font color="#800000">&quot;&quot;</font>, 0, 0, tamReg<font color="#008080"><b>(</b></font>sreg<font color="#008080"><b>)</b></font>,
        QTD_MAX_LINHA, false<font color="#008080"><b>) </b></font>== false then
        <font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font>rotulo<font color="#008080"><b>(</b></font>sreg, 0<font color="#008080"><b>)</b></font>,<font color="#800000">&quot;\n&quot;</font><font color="#008080"><b>)
      </b></font><font color="#0000FF"><b>end
   end
elsif </b></font>sreg==OPPAIS then
   <font color="#0000FF"><b>if </b></font>sacao==OPPESQUISAR then
      slinha=validaEntrada<font color="#008080"><b>($</b></font>tfPais, sreg, 2, TPais<font color="#008080"><b>[</b></font><font color="#800000">&quot;pais&quot;</font><font color="#008080"><b>]</b></font>, 1, true,OPTEXTO<font color="#008080"><b>)
   </b></font><font color="#0000FF"><b>elsif </b></font>sacao==OPLISTARTODOS then
      <font color="#0000FF"><b>if </b></font>ListarTodos<font color="#008080"><b>($</b></font>tfPais, sreg, <font color="#800000">&quot;&quot;</font>, 0, 0, tamReg<font color="#008080"><b>(</b></font>sreg<font color="#008080"><b>)</b></font>,
        QTD_MAX_LINHA, false<font color="#008080"><b>) </b></font>== false then
        <font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font>rotulo<font color="#008080"><b>(</b></font>sreg, 0<font color="#008080"><b>)</b></font>,<font color="#800000">&quot;\n&quot;</font><font color="#008080"><b>)
      </b></font><font color="#0000FF"><b>end
   end
elsif </b></font>sreg==OPPROFISSAO then
   <font color="#0000FF"><b>if </b></font>sacao==OPPESQUISAR then
     slinha=validaEntrada<font color="#008080"><b>($</b></font>tfProfissao,sreg,2,TProfissao<font color="#008080"><b>[</b></font><font color="#800000">&quot;profissao&quot;</font><font color="#008080"><b>]</b></font>,1,
             true,OPTEXTO<font color="#008080"><b>)
   </b></font><font color="#0000FF"><b>elsif </b></font>sacao==OPLISTARTODOS then
      <font color="#0000FF"><b>if </b></font>ListarTodos<font color="#008080"><b>($</b></font>tfProfissao, sreg, <font color="#800000">&quot;&quot;</font>, 0, 0, tamReg<font color="#008080"><b>(</b></font>sreg<font color="#008080"><b>)</b></font>,
        QTD_MAX_LINHA, false<font color="#008080"><b>) </b></font>== false then
        <font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font>rotulo<font color="#008080"><b>(</b></font>sreg, 0<font color="#008080"><b>)</b></font>,<font color="#800000">&quot;\n&quot;</font><font color="#008080"><b>)
      </b></font><font color="#0000FF"><b>end
   end
elsif </b></font>sreg==OPLIVRO then
   <font color="#0000FF"><b>if </b></font>sacao==OPPESQUISAR then
      slinha=validaEntrada<font color="#008080"><b>($</b></font>tfLivro, sreg, 2, TLivro<font color="#008080"><b>[</b></font><font color="#800000">&quot;titulo&quot;</font><font color="#008080"><b>]</b></font>, 1, true,OPTEXTO<font color="#008080"><b>)
   </b></font><font color="#0000FF"><b>elsif </b></font>sacao==OPLISTARTODOS then
      <font color="#0000FF"><b>if </b></font>ListarTodos<font color="#008080"><b>($</b></font>tfLivro, sreg, <font color="#800000">&quot;&quot;</font>, 0, 0, tamReg<font color="#008080"><b>(</b></font>sreg<font color="#008080"><b>)</b></font>,
        1, false<font color="#008080"><b>) </b></font>== false then
        <font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font>rotulo<font color="#008080"><b>(</b></font>sreg, 0<font color="#008080"><b>)</b></font>,<font color="#800000">&quot;\n&quot;</font><font color="#008080"><b>)
      </b></font><font color="#0000FF"><b>end
   end
elsif </b></font>sreg==OPCLIENTE then
   <font color="#0000FF"><b>if </b></font>sacao==OPPESQUISAR then
      slinha=validaEntrada<font color="#008080"><b>($</b></font>tfCliente, sreg, 2, TCliente<font color="#008080"><b>[</b></font><font color="#800000">&quot;nome&quot;</font><font color="#008080"><b>]</b></font>,1,true,OPTEXTO<font color="#008080"><b>)
   </b></font><font color="#0000FF"><b>elsif </b></font>sacao==OPLISTARTODOS then
      <font color="#0000FF"><b>if </b></font>ListarTodos<font color="#008080"><b>($</b></font>tfCliente, sreg, <font color="#800000">&quot;&quot;</font>, 0, 0, tamReg<font color="#008080"><b>(</b></font>sreg<font color="#008080"><b>)</b></font>,
        1, false<font color="#008080"><b>) </b></font>== false then
        <font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font>rotulo<font color="#008080"><b>(</b></font>sreg, 0<font color="#008080"><b>)</b></font>,<font color="#800000">&quot;\n&quot;</font><font color="#008080"><b>)
      </b></font><font color="#0000FF"><b>end
   end
elsif </b></font>sreg==OPVENDA then
   <font color="#0000FF"><b>if </b></font>sacao==OPPESQUISAR then
      slinha=validaEntrada<font color="#008080"><b>($</b></font>tfVenda, sreg, 2, TVenda<font color="#008080"><b>[</b></font><font color="#800000">&quot;cpf&quot;</font><font color="#008080"><b>]</b></font>, 1, true,OPTEXTO<font color="#008080"><b>)
   </b></font><font color="#0000FF"><b>elsif </b></font>sacao==OPLISTARTODOS then
      <font color="#0000FF"><b>if </b></font>ListarTodos<font color="#008080"><b>($</b></font>tfVenda, sreg, <font color="#800000">&quot;&quot;</font>, 0, 0, tamReg<font color="#008080"><b>(</b></font>sreg<font color="#008080"><b>)</b></font>,
        QTD_MAX_LINHA, false<font color="#008080"><b>) </b></font>== false then
        <font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font>rotulo<font color="#008080"><b>(</b></font>sreg, 0<font color="#008080"><b>)</b></font>,<font color="#800000">&quot;\n&quot;</font><font color="#008080"><b>)
      </b></font><font color="#0000FF"><b>end
   end
end
if </b></font>slinha==<font color="#800000">&quot;&quot; </font>then
   <font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;&quot;</font><font color="#008080"><b>)
</b></font><font color="#0000FF"><b>end
end
</b></font><font color="#808080">#------------------------------------------------------------------------------
# Mostra a tela de altera&ccedil;&atilde;o de senha do sistema e realiza a altera&ccedil;&atilde;o.
#------------------------------------------------------------------------------
</font><font color="#0000FF"><b>def </b></font>frmAlterarSenha<font color="#008080"><b>()
</b></font>sres, sSenhaAtual, sNovaSenha, sConfirmaSenha = <font color="#800000">&quot;&quot;</font>,<font color="#800000">&quot;&quot;</font>,<font color="#800000">&quot;&quot;</font>,<font color="#800000">&quot;&quot;

</font><font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font>rotulo<font color="#008080"><b>(</b></font>OPUSUARIO, 1<font color="#008080"><b>)</b></font>, TUsuario<font color="#008080"><b>[</b></font><font color="#800000">&quot;login&quot;</font><font color="#008080"><b>])
</b></font>nopcao=1
bQuebra=false
<font color="#0000FF"><b>while </b></font><font color="#008080"><b>(</b></font>bQuebra==false<font color="#008080"><b>) </b></font>do
  <font color="#0000FF"><b>case </b></font>nopcao
   when 1
       sSenhaAtual=digitaSenha<font color="#008080"><b>(</b></font><font color="#800000">&quot;Senha Atual: &quot;</font>,10<font color="#008080"><b>)
       </b></font><font color="#0000FF"><b>if </b></font>sSenhaAtual!=TUsuario<font color="#008080"><b>[</b></font><font color="#800000">&quot;senha&quot;</font><font color="#008080"><b>] </b></font>then
          <font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font>MSG_SENCONFERE<font color="#008080"><b>)
          </b></font>bQuebra=true
       <font color="#0000FF"><b>else </b></font>nopcao=2
       <font color="#0000FF"><b>end
   </b></font>when 2
       sNovaSenha=digitaSenha<font color="#008080"><b>(</b></font><font color="#800000">&quot;Nova Senha: &quot;</font>,10<font color="#008080"><b>)
       </b></font>sConfirmaSenha=digitaSenha<font color="#008080"><b>(</b></font><font color="#800000">&quot;Confirma Senha: &quot;</font>,10<font color="#008080"><b>)
       </b></font><font color="#0000FF"><b>if </b></font>sNovaSenha!=sConfirmaSenha then
          <font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font>MSG_SENCONFIRM<font color="#008080"><b>)
          </b></font>bQuebra=true
       <font color="#0000FF"><b>else </b></font>nopcao=3
       <font color="#0000FF"><b>end
   </b></font>when 3
       sres=pesqArq<font color="#008080"><b>($</b></font>tfUsuario, TUsuario<font color="#008080"><b>[</b></font><font color="#800000">&quot;login&quot;</font><font color="#008080"><b>]</b></font>, 1, 10, tamReg<font color="#008080"><b>(</b></font>OPUSUARIO<font color="#008080"><b>))
       </b></font><font color="#0000FF"><b>if </b></font>sres==<font color="#800000">&quot;&quot; </font>then
         <font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font>MSG_LOGINENCON<font color="#008080"><b>)
       </b></font><font color="#0000FF"><b>else
         </b></font>TUsuario<font color="#008080"><b>[</b></font><font color="#800000">&quot;senha&quot;</font><font color="#008080"><b>]</b></font>=sConfirmaSenha
         subMenu<font color="#008080"><b>(9</b></font>,OPUSUARIO<font color="#008080"><b>)
         </b></font>bQuebra=true
       <font color="#0000FF"><b>end
  end
end

end
</b></font><font color="#808080">#------------------------------------------------------------------------------
# Executa uma a&ccedil;&atilde;o de grava&ccedil;&atilde;o de acordo com o tipo de arquivo.
# sreg - o tipo de arquivo
# sacao - a a&ccedil;&atilde;o a ser realizada
#------------------------------------------------------------------------------
</font><font color="#0000FF"><b>def </b></font>btnAcao<font color="#008080"><b>(</b></font>sreg, sacao<font color="#008080"><b>)

</b></font><font color="#0000FF"><b>if </b></font>sreg==OPASSUNTO then
   <font color="#0000FF"><b>if </b></font>sacao==OPSALVARINCLUSAO then
      escreveArq<font color="#008080"><b>($</b></font>tfAssunto, LinhaReg<font color="#008080"><b>(</b></font>sreg<font color="#008080"><b>)</b></font>, MSG_REGINC, MSG_REGNINC<font color="#008080"><b>)
   </b></font><font color="#0000FF"><b>elsif </b></font>sacao==OPSALVARALTERACAO then
      escreveArq<font color="#008080"><b>($</b></font>tfAssunto, LinhaReg<font color="#008080"><b>(</b></font>sreg<font color="#008080"><b>)</b></font>, MSG_REGALT, MSG_REGNALT<font color="#008080"><b>)
   </b></font><font color="#0000FF"><b>elsif </b></font>sacao==OPCONFIRMAEXCLUSAO then
      escreveArq<font color="#008080"><b>($</b></font>tfAssunto, repete<font color="#008080"><b>(</b></font><font color="#800000">&quot;*&quot;</font>,tamReg<font color="#008080"><b>(</b></font>sreg<font color="#008080"><b>))</b></font>, MSG_REGEXC, MSG_REGNEXC<font color="#008080"><b>)
   </b></font><font color="#0000FF"><b>end
elsif </b></font>sreg==OPAUTOR then
   <font color="#0000FF"><b>if </b></font>sacao==OPSALVARINCLUSAO then
      escreveArq<font color="#008080"><b>($</b></font>tfAutor, LinhaReg<font color="#008080"><b>(</b></font>sreg<font color="#008080"><b>)</b></font>, MSG_REGINC, MSG_REGNINC<font color="#008080"><b>)
   </b></font><font color="#0000FF"><b>elsif </b></font>sacao==OPSALVARALTERACAO then
      escreveArq<font color="#008080"><b>($</b></font>tfAutor, LinhaReg<font color="#008080"><b>(</b></font>sreg<font color="#008080"><b>)</b></font>, MSG_REGALT, MSG_REGNALT<font color="#008080"><b>)
   </b></font><font color="#0000FF"><b>elsif </b></font>sacao==OPCONFIRMAEXCLUSAO then
      escreveArq<font color="#008080"><b>($</b></font>tfAutor, repete<font color="#008080"><b>(</b></font><font color="#800000">&quot;*&quot;</font>,tamReg<font color="#008080"><b>(</b></font>sreg<font color="#008080"><b>))</b></font>, MSG_REGEXC, MSG_REGNEXC<font color="#008080"><b>)
   </b></font><font color="#0000FF"><b>end
elsif </b></font>sreg==OPEDITORA then
   <font color="#0000FF"><b>if </b></font>sacao==OPSALVARINCLUSAO then
      escreveArq<font color="#008080"><b>($</b></font>tfEditora, LinhaReg<font color="#008080"><b>(</b></font>sreg<font color="#008080"><b>)</b></font>, MSG_REGINC, MSG_REGNINC<font color="#008080"><b>)
   </b></font><font color="#0000FF"><b>elsif </b></font>sacao==OPSALVARALTERACAO then
      escreveArq<font color="#008080"><b>($</b></font>tfEditora, LinhaReg<font color="#008080"><b>(</b></font>sreg<font color="#008080"><b>)</b></font>, MSG_REGALT, MSG_REGNALT<font color="#008080"><b>)
   </b></font><font color="#0000FF"><b>elsif </b></font>sacao==OPCONFIRMAEXCLUSAO then
      escreveArq<font color="#008080"><b>($</b></font>tfEditora, repete<font color="#008080"><b>(</b></font><font color="#800000">&quot;*&quot;</font>,tamReg<font color="#008080"><b>(</b></font>sreg<font color="#008080"><b>))</b></font>, MSG_REGEXC, MSG_REGNEXC<font color="#008080"><b>)
   </b></font><font color="#0000FF"><b>end
elsif </b></font>sreg==OPENDERECO then
   <font color="#0000FF"><b>if </b></font>sacao==OPSALVARINCLUSAO then
      escreveArq<font color="#008080"><b>($</b></font>tfEndereco, LinhaReg<font color="#008080"><b>(</b></font>sreg<font color="#008080"><b>)</b></font>, MSG_REGINC, MSG_REGNINC<font color="#008080"><b>)
   </b></font><font color="#0000FF"><b>elsif </b></font>sacao==OPSALVARALTERACAO then
      escreveArq<font color="#008080"><b>($</b></font>tfEndereco, LinhaReg<font color="#008080"><b>(</b></font>sreg<font color="#008080"><b>)</b></font>, MSG_REGALT, MSG_REGNALT<font color="#008080"><b>)
   </b></font><font color="#0000FF"><b>elsif </b></font>sacao==OPCONFIRMAEXCLUSAO then
      escreveArq<font color="#008080"><b>($</b></font>tfEndereco, repete<font color="#008080"><b>(</b></font><font color="#800000">&quot;*&quot;</font>,tamReg<font color="#008080"><b>(</b></font>sreg<font color="#008080"><b>))</b></font>, MSG_REGEXC, MSG_REGNEXC<font color="#008080"><b>)
   </b></font><font color="#0000FF"><b>end
elsif </b></font>sreg==OPIDIOMA then
   <font color="#0000FF"><b>if </b></font>sacao==OPSALVARINCLUSAO then
      escreveArq<font color="#008080"><b>($</b></font>tfIdioma, LinhaReg<font color="#008080"><b>(</b></font>sreg<font color="#008080"><b>)</b></font>, MSG_REGINC, MSG_REGNINC<font color="#008080"><b>)
   </b></font><font color="#0000FF"><b>elsif </b></font>sacao==OPSALVARALTERACAO then
      escreveArq<font color="#008080"><b>($</b></font>tfIdioma, LinhaReg<font color="#008080"><b>(</b></font>sreg<font color="#008080"><b>)</b></font>, MSG_REGALT, MSG_REGNALT<font color="#008080"><b>)
   </b></font><font color="#0000FF"><b>elsif </b></font>sacao==OPCONFIRMAEXCLUSAO then
      escreveArq<font color="#008080"><b>($</b></font>tfIdioma, repete<font color="#008080"><b>(</b></font><font color="#800000">&quot;*&quot;</font>,tamReg<font color="#008080"><b>(</b></font>sreg<font color="#008080"><b>))</b></font>, MSG_REGEXC, MSG_REGNEXC<font color="#008080"><b>)
   </b></font><font color="#0000FF"><b>end
elsif </b></font>sreg==OPPAIS then
   <font color="#0000FF"><b>if </b></font>sacao==OPSALVARINCLUSAO then
      escreveArq<font color="#008080"><b>($</b></font>tfPais, LinhaReg<font color="#008080"><b>(</b></font>sreg<font color="#008080"><b>)</b></font>, MSG_REGINC, MSG_REGNINC<font color="#008080"><b>)
   </b></font><font color="#0000FF"><b>elsif </b></font>sacao==OPSALVARALTERACAO then
      escreveArq<font color="#008080"><b>($</b></font>tfPais, LinhaReg<font color="#008080"><b>(</b></font>sreg<font color="#008080"><b>)</b></font>, MSG_REGALT, MSG_REGNALT<font color="#008080"><b>)
   </b></font><font color="#0000FF"><b>elsif </b></font>sacao==OPCONFIRMAEXCLUSAO then
      escreveArq<font color="#008080"><b>($</b></font>tfPais, repete<font color="#008080"><b>(</b></font><font color="#800000">&quot;*&quot;</font>,tamReg<font color="#008080"><b>(</b></font>sreg<font color="#008080"><b>))</b></font>, MSG_REGEXC, MSG_REGNEXC<font color="#008080"><b>)
   </b></font><font color="#0000FF"><b>end
elsif </b></font>sreg==OPPROFISSAO then
   <font color="#0000FF"><b>if </b></font>sacao==OPSALVARINCLUSAO then
      escreveArq<font color="#008080"><b>($</b></font>tfProfissao, LinhaReg<font color="#008080"><b>(</b></font>sreg<font color="#008080"><b>)</b></font>, MSG_REGINC, MSG_REGNINC<font color="#008080"><b>)
   </b></font><font color="#0000FF"><b>elsif </b></font>sacao==OPSALVARALTERACAO then
      escreveArq<font color="#008080"><b>($</b></font>tfProfissao, LinhaReg<font color="#008080"><b>(</b></font>sreg<font color="#008080"><b>)</b></font>, MSG_REGALT, MSG_REGNALT<font color="#008080"><b>)
   </b></font><font color="#0000FF"><b>elsif </b></font>sacao==OPCONFIRMAEXCLUSAO then
      escreveArq<font color="#008080"><b>($</b></font>tfProfissao, repete<font color="#008080"><b>(</b></font><font color="#800000">&quot;*&quot;</font>,tamReg<font color="#008080"><b>(</b></font>sreg<font color="#008080"><b>))</b></font>, MSG_REGEXC, MSG_REGNEXC<font color="#008080"><b>)
   </b></font><font color="#0000FF"><b>end
elsif </b></font>sreg==OPLIVRO then
   <font color="#0000FF"><b>if </b></font>sacao==OPSALVARINCLUSAO then
      escreveArq<font color="#008080"><b>($</b></font>tfLivro, LinhaReg<font color="#008080"><b>(</b></font>sreg<font color="#008080"><b>)</b></font>, MSG_REGINC, MSG_REGNINC<font color="#008080"><b>)
   </b></font><font color="#0000FF"><b>elsif </b></font>sacao==OPSALVARALTERACAO then
      escreveArq<font color="#008080"><b>($</b></font>tfLivro, LinhaReg<font color="#008080"><b>(</b></font>sreg<font color="#008080"><b>)</b></font>, MSG_REGALT, MSG_REGNALT<font color="#008080"><b>)
   </b></font><font color="#0000FF"><b>elsif </b></font>sacao==OPCONFIRMAEXCLUSAO then
      escreveArq<font color="#008080"><b>($</b></font>tfLivro, repete<font color="#008080"><b>(</b></font><font color="#800000">&quot;*&quot;</font>,tamReg<font color="#008080"><b>(</b></font>sreg<font color="#008080"><b>))</b></font>, MSG_REGEXC, MSG_REGNEXC<font color="#008080"><b>)
   </b></font><font color="#0000FF"><b>end
elsif </b></font>sreg==OPLIVROASS then
   <font color="#0000FF"><b>if </b></font>sacao==OPSALVARINCLUSAO then
      escreveArq<font color="#008080"><b>($</b></font>tfLivroAss, LinhaReg<font color="#008080"><b>(</b></font>sreg<font color="#008080"><b>)</b></font>, MSG_REGINC, MSG_REGNINC<font color="#008080"><b>)
   </b></font><font color="#0000FF"><b>elsif </b></font>sacao==OPSALVARALTERACAO then
      escreveArq<font color="#008080"><b>($</b></font>tfLivroAss, LinhaReg<font color="#008080"><b>(</b></font>sreg<font color="#008080"><b>)</b></font>, MSG_REGALT, MSG_REGNALT<font color="#008080"><b>)
   </b></font><font color="#0000FF"><b>elsif </b></font>sacao==OPCONFIRMAEXCLUSAO then
      escreveArq<font color="#008080"><b>($</b></font>tfLivroAss, repete<font color="#008080"><b>(</b></font><font color="#800000">&quot;*&quot;</font>,tamReg<font color="#008080"><b>(</b></font>sreg<font color="#008080"><b>))</b></font>, MSG_REGEXC, MSG_REGNEXC<font color="#008080"><b>)
   </b></font><font color="#0000FF"><b>end
elsif </b></font>sreg==OPLIVROAUT then
   <font color="#0000FF"><b>if </b></font>sacao==OPSALVARINCLUSAO then
      escreveArq<font color="#008080"><b>($</b></font>tfLivroAut, LinhaReg<font color="#008080"><b>(</b></font>sreg<font color="#008080"><b>)</b></font>, MSG_REGINC, MSG_REGNINC<font color="#008080"><b>)
   </b></font><font color="#0000FF"><b>elsif </b></font>sacao==OPSALVARALTERACAO then
      escreveArq<font color="#008080"><b>($</b></font>tfLivroAut, LinhaReg<font color="#008080"><b>(</b></font>sreg<font color="#008080"><b>)</b></font>, MSG_REGALT, MSG_REGNALT<font color="#008080"><b>)
   </b></font><font color="#0000FF"><b>elsif </b></font>sacao==OPCONFIRMAEXCLUSAO then
      escreveArq<font color="#008080"><b>($</b></font>tfLivroAut, repete<font color="#008080"><b>(</b></font><font color="#800000">&quot;*&quot;</font>,tamReg<font color="#008080"><b>(</b></font>sreg<font color="#008080"><b>))</b></font>, MSG_REGEXC, MSG_REGNEXC<font color="#008080"><b>)
   </b></font><font color="#0000FF"><b>end
elsif </b></font>sreg==OPCLIENTE then
   <font color="#0000FF"><b>if </b></font>sacao==OPSALVARINCLUSAO then
      escreveArq<font color="#008080"><b>($</b></font>tfCliente, LinhaReg<font color="#008080"><b>(</b></font>sreg<font color="#008080"><b>)</b></font>, MSG_REGINC, MSG_REGNINC<font color="#008080"><b>)
   </b></font><font color="#0000FF"><b>elsif </b></font>sacao==OPSALVARALTERACAO then
      escreveArq<font color="#008080"><b>($</b></font>tfCliente, LinhaReg<font color="#008080"><b>(</b></font>sreg<font color="#008080"><b>)</b></font>, MSG_REGALT, MSG_REGNALT<font color="#008080"><b>)
   </b></font><font color="#0000FF"><b>elsif </b></font>sacao==OPCONFIRMAEXCLUSAO then
      escreveArq<font color="#008080"><b>($</b></font>tfCliente, repete<font color="#008080"><b>(</b></font><font color="#800000">&quot;*&quot;</font>,tamReg<font color="#008080"><b>(</b></font>sreg<font color="#008080"><b>))</b></font>, MSG_REGEXC, MSG_REGNEXC<font color="#008080"><b>)
   </b></font><font color="#0000FF"><b>end
elsif </b></font>sreg==OPVENDA then
   <font color="#0000FF"><b>if </b></font>sacao==OPSALVARINCLUSAO then
      escreveArq<font color="#008080"><b>($</b></font>tfVenda, LinhaReg<font color="#008080"><b>(</b></font>sreg<font color="#008080"><b>)</b></font>, MSG_REGINC, MSG_REGNINC<font color="#008080"><b>)
   </b></font><font color="#0000FF"><b>elsif </b></font>sacao==OPSALVARALTERACAO then
      escreveArq<font color="#008080"><b>($</b></font>tfVenda, LinhaReg<font color="#008080"><b>(</b></font>sreg<font color="#008080"><b>)</b></font>, MSG_REGALT, MSG_REGNALT<font color="#008080"><b>)
   </b></font><font color="#0000FF"><b>elsif </b></font>sacao==OPCONFIRMAEXCLUSAO then
      escreveArq<font color="#008080"><b>($</b></font>tfVenda, repete<font color="#008080"><b>(</b></font><font color="#800000">&quot;*&quot;</font>,tamReg<font color="#008080"><b>(</b></font>sreg<font color="#008080"><b>))</b></font>, MSG_REGEXC, MSG_REGNEXC<font color="#008080"><b>)
   </b></font><font color="#0000FF"><b>end
elsif </b></font>sreg==OPUSUARIO then
   <font color="#0000FF"><b>if </b></font>sacao==OPSALVARALTERACAO then
      escreveArq<font color="#008080"><b>($</b></font>tfUsuario, LinhaReg<font color="#008080"><b>(</b></font>sreg<font color="#008080"><b>)</b></font>, MSG_REGALT, MSG_REGNALT<font color="#008080"><b>)
   </b></font><font color="#0000FF"><b>end
end
end
</b></font><font color="#808080">#------------------------------------------------------------------------------
# Seleciona o menu e/ou a tela certa de acordo com o tipo de arquivo.
# nmenu - o n&uacute;mero do menu
# sreg - o tipo de arquivo
#------------------------------------------------------------------------------
</font><font color="#0000FF"><b>def </b></font>subMenu<font color="#008080"><b>(</b></font>nmenu, sreg<font color="#008080"><b>)
</b></font>opSubMenu = 0
opCSubMenu = <font color="#800000">&quot;&quot;
</font>bSOp=true
<font color="#0000FF"><b>case </b></font>nmenu
 when 6
   <font color="#0000FF"><b>while </b></font>bSOp do
     menu<font color="#008080"><b>(</b></font>nmenu<font color="#008080"><b>)
     </b></font>opSubMenu = digita<font color="#008080"><b>()</b></font>.<font color="#800000"><b>to_i
     </b></font><font color="#0000FF"><b>case </b></font>opSubMenu
       when 1 
         frmCadastros<font color="#008080"><b>(</b></font>sreg, OPNOVO<font color="#008080"><b>)
       </b></font>when 2 
         frmCadastros<font color="#008080"><b>(</b></font>sreg, OPPESQUISAR<font color="#008080"><b>)
       </b></font>when 3 
         bSOp=false
       <font color="#0000FF"><b>else 
         print</b></font><font color="#008080"><b>(</b></font>MSG_ERRO<font color="#008080"><b>)
     </b></font><font color="#0000FF"><b>end
   end
 </b></font>when 7
   <font color="#0000FF"><b>while </b></font>bSOp do
     menu<font color="#008080"><b>(</b></font>nmenu<font color="#008080"><b>)
     </b></font>opSubMenu = digita<font color="#008080"><b>()</b></font>.<font color="#800000"><b>to_i
     </b></font><font color="#0000FF"><b>case </b></font>opSubMenu
       when 1 
         btnAcao<font color="#008080"><b>(</b></font>sreg, OPSALVARINCLUSAO<font color="#008080"><b>) 
         </b></font>bSOp=false
       when 2 
         bSOp=false
       <font color="#0000FF"><b>else 
         print</b></font><font color="#008080"><b>(</b></font>MSG_ERRO<font color="#008080"><b>)
     </b></font><font color="#0000FF"><b>end
   end
 </b></font>when 8
   <font color="#0000FF"><b>while </b></font>bSOp do
     menu<font color="#008080"><b>(</b></font>nmenu<font color="#008080"><b>)
     </b></font>opSubMenu = digita<font color="#008080"><b>()</b></font>.<font color="#800000"><b>to_i
     </b></font><font color="#0000FF"><b>case </b></font>opSubMenu
       when 1 
         frmCadastros<font color="#008080"><b>(</b></font>sreg, OPALTERAR<font color="#008080"><b>) 
         </b></font>bSOp=false
       when 2 
         frmCadastros<font color="#008080"><b>(</b></font>sreg, OPEXCLUIR<font color="#008080"><b>) 
         </b></font>bSOp=false
       when 3 
         bSOp=false
       <font color="#0000FF"><b>else 
         print</b></font><font color="#008080"><b>(</b></font>MSG_ERRO<font color="#008080"><b>)
     </b></font><font color="#0000FF"><b>end
   end
 </b></font>when 9
   <font color="#0000FF"><b>while </b></font>bSOp do
     menu<font color="#008080"><b>(</b></font>nmenu<font color="#008080"><b>)
     </b></font>opSubMenu = digita<font color="#008080"><b>()</b></font>.<font color="#800000"><b>to_i
     </b></font><font color="#0000FF"><b>case </b></font>opSubMenu
       when 1 
         btnAcao<font color="#008080"><b>(</b></font>sreg, OPSALVARALTERACAO<font color="#008080"><b>) 
         </b></font>bSOp=false
       when 2 
         bSOp=false
       <font color="#0000FF"><b>else 
         print</b></font><font color="#008080"><b>(</b></font>MSG_ERRO<font color="#008080"><b>)
     </b></font><font color="#0000FF"><b>end
   end
 </b></font>when 10
   <font color="#0000FF"><b>while </b></font>bSOp do
     menu<font color="#008080"><b>(</b></font>nmenu<font color="#008080"><b>)
     </b></font>opCSubMenu = digita<font color="#008080"><b>()
     </b></font><font color="#0000FF"><b>if </b></font><font color="#008080"><b>(</b></font>opCSubMenu==<font color="#800000">&quot;S&quot;</font><font color="#008080"><b>) </b></font>or <font color="#008080"><b>(</b></font>opCSubMenu==<font color="#800000">&quot;s&quot;</font><font color="#008080"><b>) </b></font>then
        btnAcao<font color="#008080"><b>(</b></font>sreg, OPCONFIRMAEXCLUSAO<font color="#008080"><b>)
        </b></font>bSOp=false
     <font color="#0000FF"><b>elsif </b></font><font color="#008080"><b>(</b></font>opCSubMenu==<font color="#800000">&quot;N&quot;</font><font color="#008080"><b>) </b></font>or <font color="#008080"><b>(</b></font>opCSubMenu==<font color="#800000">&quot;n&quot;</font><font color="#008080"><b>) </b></font>then 
        bSOp=false
     <font color="#0000FF"><b>else print</b></font><font color="#008080"><b>(</b></font>MSG_ERRO<font color="#008080"><b>)
     </b></font><font color="#0000FF"><b>end
   end
 </b></font>when 12
   <font color="#0000FF"><b>while </b></font>bSOp do
     menu<font color="#008080"><b>(</b></font>nmenu<font color="#008080"><b>)
     </b></font>opSubMenu = digita<font color="#008080"><b>()</b></font>.<font color="#800000"><b>to_i
     </b></font><font color="#0000FF"><b>case </b></font>opSubMenu
       when 1 
         frmConsultas<font color="#008080"><b>(</b></font>sreg, OPPESQUISAR<font color="#008080"><b>)
       </b></font>when 2 
         frmConsultas<font color="#008080"><b>(</b></font>sreg, OPLISTARTODOS<font color="#008080"><b>)
       </b></font>when 3 
         bSOp=false
       <font color="#0000FF"><b>else 
         print</b></font><font color="#008080"><b>(</b></font>MSG_ERRO<font color="#008080"><b>)
     </b></font><font color="#0000FF"><b>end
   end
 </b></font>when 14
   <font color="#0000FF"><b>while </b></font>bSOp do
     menu<font color="#008080"><b>(</b></font>nmenu<font color="#008080"><b>)
     </b></font>opCSubMenu = digita<font color="#008080"><b>()
     </b></font><font color="#0000FF"><b>if </b></font><font color="#008080"><b>(</b></font>opCSubMenu==<font color="#800000">&quot;S&quot;</font><font color="#008080"><b>) </b></font>or <font color="#008080"><b>(</b></font>opCSubMenu==<font color="#800000">&quot;s&quot;</font><font color="#008080"><b>) </b></font>then
        btnAcao<font color="#008080"><b>(</b></font>sreg, OPSALVARINCLUSAO<font color="#008080"><b>)
        </b></font>bSOp=false
        $g_SalvarInclusao=true
     <font color="#0000FF"><b>elsif </b></font><font color="#008080"><b>(</b></font>opCSubMenu==<font color="#800000">&quot;N&quot;</font><font color="#008080"><b>) </b></font>or <font color="#008080"><b>(</b></font>opCSubMenu==<font color="#800000">&quot;n&quot;</font><font color="#008080"><b>) </b></font>then 
        bSOp=false
     <font color="#0000FF"><b>else print</b></font><font color="#008080"><b>(</b></font>MSG_ERRO<font color="#008080"><b>)
     </b></font><font color="#0000FF"><b>end
   end
end

end
</b></font><font color="#808080">#------------------------------------------------------------------------------
# Seleciona o submenu e/ou a tela certa de acordo com n&uacute;mero do menu.
# nmenu - o n&uacute;mero do menu
#------------------------------------------------------------------------------
</font><font color="#0000FF"><b>def </b></font>usaMenu<font color="#008080"><b>(</b></font>num<font color="#008080"><b>)
</b></font>opSubMenu = 0
opSair = <font color="#800000">&quot;&quot;

 </font>bSOp=true
 <font color="#0000FF"><b>if </b></font>num == 1 then <font color="#808080"># Cadastros
   </font><font color="#0000FF"><b>while </b></font>bSOp do
     menu<font color="#008080"><b>(2)
     </b></font>opSubMenu = digita<font color="#008080"><b>()</b></font>.<font color="#800000"><b>to_i
     </b></font><font color="#0000FF"><b>case </b></font>opSubMenu
       when 1 
         subMenu<font color="#008080"><b>(6</b></font>, OPASSUNTO<font color="#008080"><b>)
       </b></font>when 2 
         subMenu<font color="#008080"><b>(6</b></font>, OPAUTOR<font color="#008080"><b>)
       </b></font>when 3 
         subMenu<font color="#008080"><b>(6</b></font>, OPEDITORA<font color="#008080"><b>)
       </b></font>when 4 
         subMenu<font color="#008080"><b>(6</b></font>, OPENDERECO<font color="#008080"><b>)
       </b></font>when 5   
         subMenu<font color="#008080"><b>(6</b></font>, OPIDIOMA<font color="#008080"><b>)
       </b></font>when 6 
         subMenu<font color="#008080"><b>(6</b></font>, OPPAIS<font color="#008080"><b>)
       </b></font>when 7 
         subMenu<font color="#008080"><b>(6</b></font>, OPPROFISSAO<font color="#008080"><b>)
       </b></font>when 8 
         subMenu<font color="#008080"><b>(6</b></font>, OPCLIENTE<font color="#008080"><b>)
       </b></font>when 9 
         subMenu<font color="#008080"><b>(6</b></font>, OPLIVRO<font color="#008080"><b>)
       </b></font>when 10 
         bSOp=false
       <font color="#0000FF"><b>else 
         print</b></font><font color="#008080"><b>(</b></font>MSG_ERRO<font color="#008080"><b>)
     </b></font><font color="#0000FF"><b>end
   end
 elsif </b></font>num == 2 then <font color="#808080"># Pesquisas
   </font><font color="#0000FF"><b>while </b></font>bSOp do
     menu<font color="#008080"><b>(3)
     </b></font>opSubMenu = digita<font color="#008080"><b>()</b></font>.<font color="#800000"><b>to_i
     </b></font><font color="#0000FF"><b>case </b></font>opSubMenu
       when 1 
         subMenu<font color="#008080"><b>(12</b></font>, OPASSUNTO<font color="#008080"><b>)
       </b></font>when 2 
         subMenu<font color="#008080"><b>(12</b></font>, OPAUTOR<font color="#008080"><b>)
       </b></font>when 3 
         subMenu<font color="#008080"><b>(12</b></font>, OPEDITORA<font color="#008080"><b>)
       </b></font>when 4 
         subMenu<font color="#008080"><b>(12</b></font>, OPENDERECO<font color="#008080"><b>)
       </b></font>when 5 
         subMenu<font color="#008080"><b>(12</b></font>, OPIDIOMA<font color="#008080"><b>)
       </b></font>when 6 
         subMenu<font color="#008080"><b>(12</b></font>, OPPAIS<font color="#008080"><b>)
       </b></font>when 7 
         subMenu<font color="#008080"><b>(12</b></font>, OPPROFISSAO<font color="#008080"><b>)
       </b></font>when 8 
         subMenu<font color="#008080"><b>(12</b></font>, OPCLIENTE<font color="#008080"><b>)
       </b></font>when 9 
         subMenu<font color="#008080"><b>(12</b></font>, OPLIVRO<font color="#008080"><b>)
       </b></font>when 10 
         bSOp=false
       <font color="#0000FF"><b>else 
         print</b></font><font color="#008080"><b>(</b></font>MSG_ERRO<font color="#008080"><b>)
     </b></font><font color="#0000FF"><b>end
   end
 elsif </b></font>num == 3 then <font color="#808080"># Vendas
   </font><font color="#0000FF"><b>while </b></font>bSOp do
     menu<font color="#008080"><b>(4)
     </b></font>opSubMenu = digita<font color="#008080"><b>()</b></font>.<font color="#800000"><b>to_i
     </b></font><font color="#0000FF"><b>case </b></font>opSubMenu
       when 1 
         subMenu<font color="#008080"><b>(6</b></font>, OPVENDA<font color="#008080"><b>)
       </b></font>when 2 
         subMenu<font color="#008080"><b>(12</b></font>, OPVENDA<font color="#008080"><b>)
       </b></font>when 3 
         bSOp=false
       <font color="#0000FF"><b>else 
         print</b></font><font color="#008080"><b>(</b></font>MSG_ERRO<font color="#008080"><b>)
     </b></font><font color="#0000FF"><b>end
   end
 elsif </b></font>num == 4 then <font color="#808080"># Opcoes
   </font><font color="#0000FF"><b>while </b></font>bSOp do
     menu<font color="#008080"><b>(5)
     </b></font>opSubMenu = digita<font color="#008080"><b>()</b></font>.<font color="#800000"><b>to_i
     </b></font><font color="#0000FF"><b>case </b></font>opSubMenu
       when 1 
         frmAlterarSenha<font color="#008080"><b>()
       </b></font>when 2 
         frmSobre<font color="#008080"><b>()
       </b></font>when 3 
         menu<font color="#008080"><b>(11)
         </b></font>opSair = digita<font color="#008080"><b>()
         </b></font><font color="#0000FF"><b>if </b></font><font color="#008080"><b>(</b></font>opSair==<font color="#800000">&quot;S&quot;</font><font color="#008080"><b>) </b></font>or <font color="#008080"><b>(</b></font>opSair==<font color="#800000">&quot;s&quot;</font><font color="#008080"><b>) </b></font>then
            fechaArqs<font color="#008080"><b>()
            </b></font><font color="#800000"><b>exit</b></font><font color="#008080"><b>(0)
         </b></font><font color="#0000FF"><b>end
       </b></font>when 4 
         bSOp=false
       <font color="#0000FF"><b>else 
         print</b></font><font color="#008080"><b>(</b></font>MSG_ERRO<font color="#008080"><b>)
     </b></font><font color="#0000FF"><b>end
   end
 end
end
</b></font><font color="#808080">#------------------------------------------------------------------------------
# Mostra as entradas e as sa&iacute;das do sistema.
# sreg - o tipo de arquivo
# slinha - o registro com os dados
# nOpcao - indica qual op&ccedil;&atilde;o ser&aacute; mostrada
#------------------------------------------------------------------------------
</font><font color="#0000FF"><b>def </b></font>mostrarDados<font color="#008080"><b>(</b></font>sreg, slinha, nOpcao<font color="#008080"><b>)
</b></font><font color="#0000FF"><b>if </b></font>sreg==OPASSUNTO then
   <font color="#0000FF"><b>case </b></font>nOpcao
     when 1
        <font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font>rotulo<font color="#008080"><b>(</b></font>sreg, 1<font color="#008080"><b>)</b></font>, TAssunto<font color="#008080"><b>[</b></font><font color="#800000">&quot;codigo&quot;</font><font color="#008080"><b>]</b></font>, <font color="#800000">&quot;\n&quot;</font><font color="#008080"><b>)
        </b></font><font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font>rotulo<font color="#008080"><b>(</b></font>sreg, 2<font color="#008080"><b>))
        </b></font>TAssunto<font color="#008080"><b>[</b></font><font color="#800000">&quot;assunto&quot;</font><font color="#008080"><b>] </b></font>= digita<font color="#008080"><b>()
     </b></font>when 2
        <font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;C&oacute;digo     Assunto\n&quot;</font><font color="#008080"><b>)
        </b></font><font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;------     -------\n&quot;</font><font color="#008080"><b>)
     </b></font>when 3
        TAssunto<font color="#008080"><b>[</b></font><font color="#800000">&quot;codigo&quot;</font><font color="#008080"><b>]</b></font>=copy<font color="#008080"><b>(</b></font>slinha, 1, 10<font color="#008080"><b>)
        </b></font>TAssunto<font color="#008080"><b>[</b></font><font color="#800000">&quot;assunto&quot;</font><font color="#008080"><b>]</b></font>=copy<font color="#008080"><b>(</b></font>slinha, 11, 30<font color="#008080"><b>)
        </b></font><font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font>TAssunto<font color="#008080"><b>[</b></font><font color="#800000">&quot;codigo&quot;</font><font color="#008080"><b>]</b></font>,<font color="#800000">&quot; &quot;</font>,TAssunto<font color="#008080"><b>[</b></font><font color="#800000">&quot;assunto&quot;</font><font color="#008080"><b>]</b></font>,<font color="#800000">&quot;\n&quot;</font><font color="#008080"><b>)
   </b></font><font color="#0000FF"><b>end
elsif </b></font>sreg==OPAUTOR then
   <font color="#0000FF"><b>case </b></font>nOpcao
     when 1
        <font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font>rotulo<font color="#008080"><b>(</b></font>sreg, 1<font color="#008080"><b>)</b></font>, TAutor<font color="#008080"><b>[</b></font><font color="#800000">&quot;codigo&quot;</font><font color="#008080"><b>]</b></font>, <font color="#800000">&quot;\n&quot;</font><font color="#008080"><b>)
        </b></font><font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font>rotulo<font color="#008080"><b>(</b></font>sreg, 2<font color="#008080"><b>))
        </b></font>TAutor<font color="#008080"><b>[</b></font><font color="#800000">&quot;autor&quot;</font><font color="#008080"><b>] </b></font>= digita<font color="#008080"><b>()
     </b></font>when 2
        <font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;C&oacute;digo     Autor\n&quot;</font><font color="#008080"><b>)
        </b></font><font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;------     -----\n&quot;</font><font color="#008080"><b>)
     </b></font>when 3
        TAutor<font color="#008080"><b>[</b></font><font color="#800000">&quot;codigo&quot;</font><font color="#008080"><b>]</b></font>=copy<font color="#008080"><b>(</b></font>slinha, 1, 10<font color="#008080"><b>)
        </b></font>TAutor<font color="#008080"><b>[</b></font><font color="#800000">&quot;autor&quot;</font><font color="#008080"><b>]</b></font>=copy<font color="#008080"><b>(</b></font>slinha, 11, 30<font color="#008080"><b>)
        </b></font><font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font>TAutor<font color="#008080"><b>[</b></font><font color="#800000">&quot;codigo&quot;</font><font color="#008080"><b>]</b></font>,<font color="#800000">&quot; &quot;</font>,TAutor<font color="#008080"><b>[</b></font><font color="#800000">&quot;autor&quot;</font><font color="#008080"><b>]</b></font>,<font color="#800000">&quot;\n&quot;</font><font color="#008080"><b>)
   </b></font><font color="#0000FF"><b>end
elsif </b></font>sreg==OPEDITORA then
   <font color="#0000FF"><b>case </b></font>nOpcao
     when 1
        <font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font>rotulo<font color="#008080"><b>(</b></font>sreg, 1<font color="#008080"><b>)</b></font>, TEditora<font color="#008080"><b>[</b></font><font color="#800000">&quot;codigo&quot;</font><font color="#008080"><b>]</b></font>, <font color="#800000">&quot;\n&quot;</font><font color="#008080"><b>)
        </b></font><font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font>rotulo<font color="#008080"><b>(</b></font>sreg, 2<font color="#008080"><b>))
        </b></font>TEditora<font color="#008080"><b>[</b></font><font color="#800000">&quot;editora&quot;</font><font color="#008080"><b>] </b></font>= digita<font color="#008080"><b>()
     </b></font>when 2
        <font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;C&oacute;digo     Editora\n&quot;</font><font color="#008080"><b>)
        </b></font><font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;------     -------\n&quot;</font><font color="#008080"><b>)
     </b></font>when 3
        TEditora<font color="#008080"><b>[</b></font><font color="#800000">&quot;codigo&quot;</font><font color="#008080"><b>]</b></font>=copy<font color="#008080"><b>(</b></font>slinha, 1, 10<font color="#008080"><b>)
        </b></font>TEditora<font color="#008080"><b>[</b></font><font color="#800000">&quot;editora&quot;</font><font color="#008080"><b>]</b></font>=copy<font color="#008080"><b>(</b></font>slinha, 11, 50<font color="#008080"><b>)
        </b></font><font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font>TEditora<font color="#008080"><b>[</b></font><font color="#800000">&quot;codigo&quot;</font><font color="#008080"><b>]</b></font>,<font color="#800000">&quot; &quot;</font>,TEditora<font color="#008080"><b>[</b></font><font color="#800000">&quot;editora&quot;</font><font color="#008080"><b>]</b></font>, <font color="#800000">&quot;\n&quot;</font><font color="#008080"><b>)
   </b></font><font color="#0000FF"><b>end
elsif </b></font>sreg==OPENDERECO then
   <font color="#0000FF"><b>case </b></font>nOpcao
     when 1
        <font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font>rotulo<font color="#008080"><b>(</b></font>sreg, 1<font color="#008080"><b>)</b></font>, TEndereco<font color="#008080"><b>[</b></font><font color="#800000">&quot;codigo&quot;</font><font color="#008080"><b>]</b></font>, <font color="#800000">&quot;\n&quot;</font><font color="#008080"><b>)
        </b></font><font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font>rotulo<font color="#008080"><b>(</b></font>sreg, 2<font color="#008080"><b>))
        </b></font>TEndereco<font color="#008080"><b>[</b></font><font color="#800000">&quot;logradouro&quot;</font><font color="#008080"><b>] </b></font>= digita<font color="#008080"><b>()
        </b></font><font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font>rotulo<font color="#008080"><b>(</b></font>sreg, 3<font color="#008080"><b>))
        </b></font>TEndereco<font color="#008080"><b>[</b></font><font color="#800000">&quot;bairro&quot;</font><font color="#008080"><b>] </b></font>= digita<font color="#008080"><b>()
        </b></font><font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font>rotulo<font color="#008080"><b>(</b></font>sreg, 4<font color="#008080"><b>))
        </b></font>TEndereco<font color="#008080"><b>[</b></font><font color="#800000">&quot;cep&quot;</font><font color="#008080"><b>] </b></font>= digita<font color="#008080"><b>()
        </b></font><font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font>rotulo<font color="#008080"><b>(</b></font>sreg, 5<font color="#008080"><b>))
        </b></font>TEndereco<font color="#008080"><b>[</b></font><font color="#800000">&quot;cidade&quot;</font><font color="#008080"><b>] </b></font>= digita<font color="#008080"><b>()
        </b></font><font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font>rotulo<font color="#008080"><b>(</b></font>sreg, 6<font color="#008080"><b>))
        </b></font>TEndereco<font color="#008080"><b>[</b></font><font color="#800000">&quot;estado&quot;</font><font color="#008080"><b>] </b></font>= digita<font color="#008080"><b>()
     </b></font>when 3
        TEndereco<font color="#008080"><b>[</b></font><font color="#800000">&quot;codigo&quot;</font><font color="#008080"><b>]</b></font>=copy<font color="#008080"><b>(</b></font>slinha, 1, 10<font color="#008080"><b>)</b></font>.<font color="#800000"><b>strip
        </b></font>TEndereco<font color="#008080"><b>[</b></font><font color="#800000">&quot;logradouro&quot;</font><font color="#008080"><b>]</b></font>=copy<font color="#008080"><b>(</b></font>slinha, 11, 40<font color="#008080"><b>)</b></font>.<font color="#800000"><b>strip
        </b></font>TEndereco<font color="#008080"><b>[</b></font><font color="#800000">&quot;bairro&quot;</font><font color="#008080"><b>]</b></font>=copy<font color="#008080"><b>(</b></font>slinha, 51, 15<font color="#008080"><b>)</b></font>.<font color="#800000"><b>strip
        </b></font>TEndereco<font color="#008080"><b>[</b></font><font color="#800000">&quot;cep&quot;</font><font color="#008080"><b>]</b></font>=copy<font color="#008080"><b>(</b></font>slinha, 66, 8<font color="#008080"><b>)</b></font>.<font color="#800000"><b>strip
        </b></font>TEndereco<font color="#008080"><b>[</b></font><font color="#800000">&quot;cidade&quot;</font><font color="#008080"><b>]</b></font>=copy<font color="#008080"><b>(</b></font>slinha, 74, 30<font color="#008080"><b>)</b></font>.<font color="#800000"><b>strip
        </b></font>TEndereco<font color="#008080"><b>[</b></font><font color="#800000">&quot;estado&quot;</font><font color="#008080"><b>]</b></font>=copy<font color="#008080"><b>(</b></font>slinha, 104, 20<font color="#008080"><b>)</b></font>.<font color="#800000"><b>strip
        </b></font><font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;--------------------\n&quot;</font><font color="#008080"><b>)
        </b></font><font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font>rotulo<font color="#008080"><b>(</b></font>sreg, 1<font color="#008080"><b>)</b></font>, TEndereco<font color="#008080"><b>[</b></font><font color="#800000">&quot;codigo&quot;</font><font color="#008080"><b>]</b></font>, <font color="#800000">&quot;\n&quot;</font><font color="#008080"><b>)
        </b></font><font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font>rotulo<font color="#008080"><b>(</b></font>sreg, 2<font color="#008080"><b>)</b></font>, TEndereco<font color="#008080"><b>[</b></font><font color="#800000">&quot;logradouro&quot;</font><font color="#008080"><b>]</b></font>, <font color="#800000">&quot;\n&quot;</font><font color="#008080"><b>)
        </b></font><font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font>rotulo<font color="#008080"><b>(</b></font>sreg, 3<font color="#008080"><b>)</b></font>, TEndereco<font color="#008080"><b>[</b></font><font color="#800000">&quot;bairro&quot;</font><font color="#008080"><b>]</b></font>, <font color="#800000">&quot;\n&quot;</font><font color="#008080"><b>)
        </b></font><font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font>rotulo<font color="#008080"><b>(</b></font>sreg, 4<font color="#008080"><b>)</b></font>, TEndereco<font color="#008080"><b>[</b></font><font color="#800000">&quot;cep&quot;</font><font color="#008080"><b>]</b></font>, <font color="#800000">&quot;\n&quot;</font><font color="#008080"><b>)
        </b></font><font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font>rotulo<font color="#008080"><b>(</b></font>sreg, 5<font color="#008080"><b>)</b></font>, TEndereco<font color="#008080"><b>[</b></font><font color="#800000">&quot;cidade&quot;</font><font color="#008080"><b>]</b></font>, <font color="#800000">&quot;\n&quot;</font><font color="#008080"><b>)
        </b></font><font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font>rotulo<font color="#008080"><b>(</b></font>sreg, 6<font color="#008080"><b>)</b></font>, TEndereco<font color="#008080"><b>[</b></font><font color="#800000">&quot;estado&quot;</font><font color="#008080"><b>]</b></font>, <font color="#800000">&quot;\n&quot;</font><font color="#008080"><b>)
   </b></font><font color="#0000FF"><b>end
elsif </b></font>sreg==OPIDIOMA then
   <font color="#0000FF"><b>case </b></font>nOpcao
     when 1
        <font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font>rotulo<font color="#008080"><b>(</b></font>sreg, 1<font color="#008080"><b>)</b></font>, TIdioma<font color="#008080"><b>[</b></font><font color="#800000">&quot;codigo&quot;</font><font color="#008080"><b>]</b></font>, <font color="#800000">&quot;\n&quot;</font><font color="#008080"><b>)
        </b></font><font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font>rotulo<font color="#008080"><b>(</b></font>sreg, 2<font color="#008080"><b>))
        </b></font>TIdioma<font color="#008080"><b>[</b></font><font color="#800000">&quot;idioma&quot;</font><font color="#008080"><b>] </b></font>= digita<font color="#008080"><b>()
     </b></font>when 2
        <font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;C&oacute;digo     Idioma\n&quot;</font><font color="#008080"><b>)
        </b></font><font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;------     ------\n&quot;</font><font color="#008080"><b>)
     </b></font>when 3
        TIdioma<font color="#008080"><b>[</b></font><font color="#800000">&quot;codigo&quot;</font><font color="#008080"><b>]</b></font>=copy<font color="#008080"><b>(</b></font>slinha, 1, 10<font color="#008080"><b>)
        </b></font>TIdioma<font color="#008080"><b>[</b></font><font color="#800000">&quot;idioma&quot;</font><font color="#008080"><b>]</b></font>=copy<font color="#008080"><b>(</b></font>slinha, 11, 20<font color="#008080"><b>)
        </b></font><font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font>TIdioma<font color="#008080"><b>[</b></font><font color="#800000">&quot;codigo&quot;</font><font color="#008080"><b>]</b></font>,<font color="#800000">&quot; &quot;</font>,TIdioma<font color="#008080"><b>[</b></font><font color="#800000">&quot;idioma&quot;</font><font color="#008080"><b>]</b></font>, <font color="#800000">&quot;\n&quot;</font><font color="#008080"><b>)
   </b></font><font color="#0000FF"><b>end
elsif </b></font>sreg==OPPAIS then
   <font color="#0000FF"><b>case </b></font>nOpcao
     when 1
        <font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font>rotulo<font color="#008080"><b>(</b></font>sreg, 2<font color="#008080"><b>))
        </b></font>TPais<font color="#008080"><b>[</b></font><font color="#800000">&quot;pais&quot;</font><font color="#008080"><b>] </b></font>= digita<font color="#008080"><b>()
     </b></font>when 2
        <font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;C&oacute;digo Pa&iacute;s\n&quot;</font><font color="#008080"><b>)
        </b></font><font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;------ ----\n&quot;</font><font color="#008080"><b>)
     </b></font>when 3
        TPais<font color="#008080"><b>[</b></font><font color="#800000">&quot;codigo&quot;</font><font color="#008080"><b>]</b></font>=copy<font color="#008080"><b>(</b></font>slinha, 1, 3<font color="#008080"><b>)
        </b></font>TPais<font color="#008080"><b>[</b></font><font color="#800000">&quot;pais&quot;</font><font color="#008080"><b>]</b></font>=copy<font color="#008080"><b>(</b></font>slinha, 4, 50<font color="#008080"><b>)
        </b></font><font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font>TPais<font color="#008080"><b>[</b></font><font color="#800000">&quot;codigo&quot;</font><font color="#008080"><b>]</b></font>,<font color="#800000">&quot;    &quot;</font>,TPais<font color="#008080"><b>[</b></font><font color="#800000">&quot;pais&quot;</font><font color="#008080"><b>]</b></font>, <font color="#800000">&quot;\n&quot;</font><font color="#008080"><b>)
   </b></font><font color="#0000FF"><b>end
elsif </b></font>sreg==OPPROFISSAO then
   <font color="#0000FF"><b>case </b></font>nOpcao
     when 1
        <font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font>rotulo<font color="#008080"><b>(</b></font>sreg, 1<font color="#008080"><b>)</b></font>, TProfissao<font color="#008080"><b>[</b></font><font color="#800000">&quot;codigo&quot;</font><font color="#008080"><b>]</b></font>, <font color="#800000">&quot;\n&quot;</font><font color="#008080"><b>)
        </b></font><font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font>rotulo<font color="#008080"><b>(</b></font>sreg, 2<font color="#008080"><b>))
        </b></font>TProfissao<font color="#008080"><b>[</b></font><font color="#800000">&quot;profissao&quot;</font><font color="#008080"><b>] </b></font>= digita<font color="#008080"><b>()
     </b></font>when 2
        <font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;C&oacute;digo     Profiss&atilde;o\n&quot;</font><font color="#008080"><b>)
        </b></font><font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;------     ---------\n&quot;</font><font color="#008080"><b>)
     </b></font>when 3
        TProfissao<font color="#008080"><b>[</b></font><font color="#800000">&quot;codigo&quot;</font><font color="#008080"><b>]</b></font>=copy<font color="#008080"><b>(</b></font>slinha, 1, 10<font color="#008080"><b>)
        </b></font>TProfissao<font color="#008080"><b>[</b></font><font color="#800000">&quot;profissao&quot;</font><font color="#008080"><b>]</b></font>=copy<font color="#008080"><b>(</b></font>slinha, 11, 50<font color="#008080"><b>)
        </b></font><font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font>TProfissao<font color="#008080"><b>[</b></font><font color="#800000">&quot;codigo&quot;</font><font color="#008080"><b>]</b></font>,<font color="#800000">&quot; &quot;</font>,TProfissao<font color="#008080"><b>[</b></font><font color="#800000">&quot;profissao&quot;</font><font color="#008080"><b>]</b></font>, <font color="#800000">&quot;\n&quot;</font><font color="#008080"><b>)
   </b></font><font color="#0000FF"><b>end
elsif </b></font>sreg==OPLIVRO then
   <font color="#0000FF"><b>case </b></font>nOpcao
     when 1
        <font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font>rotulo<font color="#008080"><b>(</b></font>sreg, 2<font color="#008080"><b>))
        </b></font>TLivro<font color="#008080"><b>[</b></font><font color="#800000">&quot;titulo&quot;</font><font color="#008080"><b>] </b></font>= digita<font color="#008080"><b>()
        </b></font>TLivro<font color="#008080"><b>[</b></font><font color="#800000">&quot;edicao&quot;</font><font color="#008080"><b>]</b></font>=validaNumero<font color="#008080"><b>(</b></font>rotulo<font color="#008080"><b>(</b></font>sreg, 3<font color="#008080"><b>)</b></font>, TLivro<font color="#008080"><b>[</b></font><font color="#800000">&quot;edicao&quot;</font><font color="#008080"><b>])
        </b></font>TLivro<font color="#008080"><b>[</b></font><font color="#800000">&quot;anopubli&quot;</font><font color="#008080"><b>]</b></font>=validaNumero<font color="#008080"><b>(</b></font>rotulo<font color="#008080"><b>(</b></font>sreg, 4<font color="#008080"><b>)</b></font>, TLivro<font color="#008080"><b>[</b></font><font color="#800000">&quot;anopubli&quot;</font><font color="#008080"><b>])
        </b></font>mostrarSubDados<font color="#008080"><b>(</b></font>OPLIVRO, OPEDITORA, false<font color="#008080"><b>)
        </b></font>TLivro<font color="#008080"><b>[</b></font><font color="#800000">&quot;volume&quot;</font><font color="#008080"><b>]</b></font>=validaNumero<font color="#008080"><b>(</b></font>rotulo<font color="#008080"><b>(</b></font>sreg, 6<font color="#008080"><b>)</b></font>, TLivro<font color="#008080"><b>[</b></font><font color="#800000">&quot;volume&quot;</font><font color="#008080"><b>])
        </b></font>mostrarSubDados<font color="#008080"><b>(</b></font>OPLIVRO, OPIDIOMA, false<font color="#008080"><b>)
        </b></font>TLivro<font color="#008080"><b>[</b></font><font color="#800000">&quot;npaginas&quot;</font><font color="#008080"><b>]</b></font>=validaNumero<font color="#008080"><b>(</b></font>rotulo<font color="#008080"><b>(</b></font>sreg, 8<font color="#008080"><b>)</b></font>, TLivro<font color="#008080"><b>[</b></font><font color="#800000">&quot;npaginas&quot;</font><font color="#008080"><b>])
        </b></font>TLivro<font color="#008080"><b>[</b></font><font color="#800000">&quot;preco&quot;</font><font color="#008080"><b>]</b></font>=validaNumero<font color="#008080"><b>(</b></font>rotulo<font color="#008080"><b>(</b></font>sreg, 9<font color="#008080"><b>)</b></font>, TLivro<font color="#008080"><b>[</b></font><font color="#800000">&quot;preco&quot;</font><font color="#008080"><b>])
        </b></font>TLivro<font color="#008080"><b>[</b></font><font color="#800000">&quot;qtdestoque&quot;</font><font color="#008080"><b>]</b></font>=validaNumero<font color="#008080"><b>(</b></font>rotulo<font color="#008080"><b>(</b></font>sreg, 10<font color="#008080"><b>)</b></font>, TLivro<font color="#008080"><b>[</b></font><font color="#800000">&quot;qtdestoque&quot;</font><font color="#008080"><b>])
     </b></font>when 3
        TLivro<font color="#008080"><b>[</b></font><font color="#800000">&quot;isbn&quot;</font><font color="#008080"><b>]</b></font>=copy<font color="#008080"><b>(</b></font>slinha, 1, 13<font color="#008080"><b>)</b></font>.<font color="#800000"><b>strip
        </b></font>TLivro<font color="#008080"><b>[</b></font><font color="#800000">&quot;titulo&quot;</font><font color="#008080"><b>]</b></font>=copy<font color="#008080"><b>(</b></font>slinha, 14, 50<font color="#008080"><b>)</b></font>.<font color="#800000"><b>strip
        </b></font>TLivro<font color="#008080"><b>[</b></font><font color="#800000">&quot;edicao&quot;</font><font color="#008080"><b>]</b></font>=copy<font color="#008080"><b>(</b></font>slinha, 64, 10<font color="#008080"><b>)</b></font>.<font color="#800000"><b>strip
        </b></font>TLivro<font color="#008080"><b>[</b></font><font color="#800000">&quot;anopubli&quot;</font><font color="#008080"><b>]</b></font>=copy<font color="#008080"><b>(</b></font>slinha, 74, 10<font color="#008080"><b>)</b></font>.<font color="#800000"><b>strip
        </b></font>TLivro<font color="#008080"><b>[</b></font><font color="#800000">&quot;codeditora&quot;</font><font color="#008080"><b>]</b></font>=copy<font color="#008080"><b>(</b></font>slinha, 84, 10<font color="#008080"><b>)</b></font>.<font color="#800000"><b>strip
        </b></font>TLivro<font color="#008080"><b>[</b></font><font color="#800000">&quot;volume&quot;</font><font color="#008080"><b>]</b></font>=copy<font color="#008080"><b>(</b></font>slinha, 94, 10<font color="#008080"><b>)</b></font>.<font color="#800000"><b>strip
        </b></font>TLivro<font color="#008080"><b>[</b></font><font color="#800000">&quot;codidioma&quot;</font><font color="#008080"><b>]</b></font>=copy<font color="#008080"><b>(</b></font>slinha, 104, 10<font color="#008080"><b>)</b></font>.<font color="#800000"><b>strip
        </b></font>TLivro<font color="#008080"><b>[</b></font><font color="#800000">&quot;npaginas&quot;</font><font color="#008080"><b>]</b></font>=copy<font color="#008080"><b>(</b></font>slinha, 114, 10<font color="#008080"><b>)</b></font>.<font color="#800000"><b>strip
        </b></font>TLivro<font color="#008080"><b>[</b></font><font color="#800000">&quot;preco&quot;</font><font color="#008080"><b>]</b></font>=copy<font color="#008080"><b>(</b></font>slinha, 124, 10<font color="#008080"><b>)</b></font>.<font color="#800000"><b>strip
        </b></font>TLivro<font color="#008080"><b>[</b></font><font color="#800000">&quot;qtdestoque&quot;</font><font color="#008080"><b>]</b></font>=copy<font color="#008080"><b>(</b></font>slinha, 134, 10<font color="#008080"><b>)</b></font>.<font color="#800000"><b>strip
        </b></font><font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;--------------------\n&quot;</font><font color="#008080"><b>)
        </b></font><font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font>rotulo<font color="#008080"><b>(</b></font>sreg, 1<font color="#008080"><b>)</b></font>, TLivro<font color="#008080"><b>[</b></font><font color="#800000">&quot;isbn&quot;</font><font color="#008080"><b>]</b></font>, <font color="#800000">&quot;\n&quot;</font><font color="#008080"><b>)
        </b></font><font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font>rotulo<font color="#008080"><b>(</b></font>sreg, 2<font color="#008080"><b>)</b></font>, TLivro<font color="#008080"><b>[</b></font><font color="#800000">&quot;titulo&quot;</font><font color="#008080"><b>]</b></font>, <font color="#800000">&quot;\n&quot;</font><font color="#008080"><b>)
        </b></font><font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font>rotulo<font color="#008080"><b>(</b></font>sreg, 3<font color="#008080"><b>)</b></font>, TLivro<font color="#008080"><b>[</b></font><font color="#800000">&quot;edicao&quot;</font><font color="#008080"><b>]</b></font>, <font color="#800000">&quot;\n&quot;</font><font color="#008080"><b>)
        </b></font><font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font>rotulo<font color="#008080"><b>(</b></font>sreg, 4<font color="#008080"><b>)</b></font>, TLivro<font color="#008080"><b>[</b></font><font color="#800000">&quot;anopubli&quot;</font><font color="#008080"><b>]</b></font>, <font color="#800000">&quot;\n&quot;</font><font color="#008080"><b>)
        </b></font><font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font>rotulo<font color="#008080"><b>(</b></font>sreg, 5<font color="#008080"><b>)</b></font>, TLivro<font color="#008080"><b>[</b></font><font color="#800000">&quot;codeditora&quot;</font><font color="#008080"><b>]</b></font>, <font color="#800000">&quot;\n&quot;</font><font color="#008080"><b>)
        </b></font>mostrarSubDados<font color="#008080"><b>(</b></font>OPLIVRO, OPEDITORA, true<font color="#008080"><b>)
        </b></font><font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font>rotulo<font color="#008080"><b>(</b></font>sreg, 6<font color="#008080"><b>)</b></font>, TLivro<font color="#008080"><b>[</b></font><font color="#800000">&quot;volume&quot;</font><font color="#008080"><b>]</b></font>, <font color="#800000">&quot;\n&quot;</font><font color="#008080"><b>)
        </b></font><font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font>rotulo<font color="#008080"><b>(</b></font>sreg, 7<font color="#008080"><b>)</b></font>, TLivro<font color="#008080"><b>[</b></font><font color="#800000">&quot;codidioma&quot;</font><font color="#008080"><b>]</b></font>, <font color="#800000">&quot;\n&quot;</font><font color="#008080"><b>)
        </b></font>mostrarSubDados<font color="#008080"><b>(</b></font>OPLIVRO, OPIDIOMA, true<font color="#008080"><b>)
        </b></font><font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font>rotulo<font color="#008080"><b>(</b></font>sreg, 8<font color="#008080"><b>)</b></font>, TLivro<font color="#008080"><b>[</b></font><font color="#800000">&quot;npaginas&quot;</font><font color="#008080"><b>]</b></font>, <font color="#800000">&quot;\n&quot;</font><font color="#008080"><b>)
        </b></font><font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font>rotulo<font color="#008080"><b>(</b></font>sreg, 9<font color="#008080"><b>)</b></font>, TLivro<font color="#008080"><b>[</b></font><font color="#800000">&quot;preco&quot;</font><font color="#008080"><b>]</b></font>, <font color="#800000">&quot;\n&quot;</font><font color="#008080"><b>)
        </b></font><font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font>rotulo<font color="#008080"><b>(</b></font>sreg, 10<font color="#008080"><b>)</b></font>, TLivro<font color="#008080"><b>[</b></font><font color="#800000">&quot;qtdestoque&quot;</font><font color="#008080"><b>]</b></font>, <font color="#800000">&quot;\n&quot;</font><font color="#008080"><b>)
        </b></font>ListarRegLigados<font color="#008080"><b>($</b></font>tfLivroAss, OPLIVROASS, 1, 13, 14, 10, TLivro<font color="#008080"><b>[</b></font><font color="#800000">&quot;isbn&quot;</font><font color="#008080"><b>]</b></font>,
                         $tfAssunto, OPASSUNTO, 1, 4<font color="#008080"><b>)
        </b></font>ListarRegLigados<font color="#008080"><b>($</b></font>tfLivroAut, OPLIVROAUT, 1, 13, 14, 10, TLivro<font color="#008080"><b>[</b></font><font color="#800000">&quot;isbn&quot;</font><font color="#008080"><b>]</b></font>,
                         $tfAutor, OPAUTOR, 1, 4<font color="#008080"><b>)
   </b></font><font color="#0000FF"><b>end
elsif </b></font>sreg==OPCLIENTE then
   <font color="#0000FF"><b>case </b></font>nOpcao
     when 1
        <font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font>rotulo<font color="#008080"><b>(</b></font>sreg, 2<font color="#008080"><b>))
        </b></font>TCliente<font color="#008080"><b>[</b></font><font color="#800000">&quot;nome&quot;</font><font color="#008080"><b>] </b></font>= digita<font color="#008080"><b>()
        </b></font><font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font>rotulo<font color="#008080"><b>(</b></font>sreg, 3<font color="#008080"><b>))
        </b></font>TCliente<font color="#008080"><b>[</b></font><font color="#800000">&quot;email&quot;</font><font color="#008080"><b>] </b></font>= digita<font color="#008080"><b>()
        </b></font><font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font>rotulo<font color="#008080"><b>(</b></font>sreg, 4<font color="#008080"><b>))
        </b></font>TCliente<font color="#008080"><b>[</b></font><font color="#800000">&quot;identidade&quot;</font><font color="#008080"><b>] </b></font>= digita<font color="#008080"><b>()
        </b></font><font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font>rotulo<font color="#008080"><b>(</b></font>sreg, 5<font color="#008080"><b>))
        </b></font>TCliente<font color="#008080"><b>[</b></font><font color="#800000">&quot;sexo&quot;</font><font color="#008080"><b>] </b></font>= digita<font color="#008080"><b>()
        </b></font><font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font>rotulo<font color="#008080"><b>(</b></font>sreg, 6<font color="#008080"><b>))
        </b></font>TCliente<font color="#008080"><b>[</b></font><font color="#800000">&quot;telefone&quot;</font><font color="#008080"><b>] </b></font>= digita<font color="#008080"><b>()
        </b></font>TCliente<font color="#008080"><b>[</b></font><font color="#800000">&quot;dtnascimento&quot;</font><font color="#008080"><b>]</b></font>=
                validaDataHora<font color="#008080"><b>(</b></font>rotulo<font color="#008080"><b>(</b></font>sreg, 7<font color="#008080"><b>)</b></font>, TCliente<font color="#008080"><b>[</b></font><font color="#800000">&quot;dtnascimento&quot;</font><font color="#008080"><b>]</b></font>, true<font color="#008080"><b>)
        </b></font>mostrarSubDados<font color="#008080"><b>(</b></font>OPCLIENTE, OPENDERECO, false<font color="#008080"><b>)
        </b></font>mostrarSubDados<font color="#008080"><b>(</b></font>OPCLIENTE, OPPAIS, false<font color="#008080"><b>)
        </b></font>mostrarSubDados<font color="#008080"><b>(</b></font>OPCLIENTE, OPPROFISSAO, false<font color="#008080"><b>)
     </b></font>when 3
        TCliente<font color="#008080"><b>[</b></font><font color="#800000">&quot;cpf&quot;</font><font color="#008080"><b>]</b></font>=copy<font color="#008080"><b>(</b></font>slinha, 1, 14<font color="#008080"><b>)</b></font>.<font color="#800000"><b>strip
        </b></font>TCliente<font color="#008080"><b>[</b></font><font color="#800000">&quot;nome&quot;</font><font color="#008080"><b>]</b></font>=copy<font color="#008080"><b>(</b></font>slinha, 15, 30<font color="#008080"><b>)</b></font>.<font color="#800000"><b>strip
        </b></font>TCliente<font color="#008080"><b>[</b></font><font color="#800000">&quot;email&quot;</font><font color="#008080"><b>]</b></font>=copy<font color="#008080"><b>(</b></font>slinha, 45, 30<font color="#008080"><b>)</b></font>.<font color="#800000"><b>strip
        </b></font>TCliente<font color="#008080"><b>[</b></font><font color="#800000">&quot;identidade&quot;</font><font color="#008080"><b>]</b></font>=copy<font color="#008080"><b>(</b></font>slinha, 75, 10<font color="#008080"><b>)</b></font>.<font color="#800000"><b>strip
        </b></font>TCliente<font color="#008080"><b>[</b></font><font color="#800000">&quot;sexo&quot;</font><font color="#008080"><b>]</b></font>=copy<font color="#008080"><b>(</b></font>slinha, 85, 1<font color="#008080"><b>)</b></font>.<font color="#800000"><b>strip
        </b></font>TCliente<font color="#008080"><b>[</b></font><font color="#800000">&quot;telefone&quot;</font><font color="#008080"><b>]</b></font>=copy<font color="#008080"><b>(</b></font>slinha, 86, 17<font color="#008080"><b>)</b></font>.<font color="#800000"><b>strip
        </b></font>TCliente<font color="#008080"><b>[</b></font><font color="#800000">&quot;dtnascimento&quot;</font><font color="#008080"><b>]</b></font>=copy<font color="#008080"><b>(</b></font>slinha, 103, 10<font color="#008080"><b>)</b></font>.<font color="#800000"><b>strip
        </b></font>TCliente<font color="#008080"><b>[</b></font><font color="#800000">&quot;codendereco&quot;</font><font color="#008080"><b>]</b></font>=copy<font color="#008080"><b>(</b></font>slinha, 113, 10<font color="#008080"><b>)</b></font>.<font color="#800000"><b>strip
        </b></font>TCliente<font color="#008080"><b>[</b></font><font color="#800000">&quot;codpais&quot;</font><font color="#008080"><b>]</b></font>=copy<font color="#008080"><b>(</b></font>slinha, 123, 3<font color="#008080"><b>)</b></font>.<font color="#800000"><b>strip
        </b></font>TCliente<font color="#008080"><b>[</b></font><font color="#800000">&quot;codprofissao&quot;</font><font color="#008080"><b>]</b></font>=copy<font color="#008080"><b>(</b></font>slinha, 126, 10<font color="#008080"><b>)</b></font>.<font color="#800000"><b>strip
        </b></font><font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;--------------------\n&quot;</font><font color="#008080"><b>)
        </b></font><font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font>rotulo<font color="#008080"><b>(</b></font>sreg, 1<font color="#008080"><b>)</b></font>, TCliente<font color="#008080"><b>[</b></font><font color="#800000">&quot;cpf&quot;</font><font color="#008080"><b>]</b></font>, <font color="#800000">&quot;\n&quot;</font><font color="#008080"><b>)
        </b></font><font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font>rotulo<font color="#008080"><b>(</b></font>sreg, 2<font color="#008080"><b>)</b></font>, TCliente<font color="#008080"><b>[</b></font><font color="#800000">&quot;nome&quot;</font><font color="#008080"><b>]</b></font>, <font color="#800000">&quot;\n&quot;</font><font color="#008080"><b>)
        </b></font><font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font>rotulo<font color="#008080"><b>(</b></font>sreg, 3<font color="#008080"><b>)</b></font>, TCliente<font color="#008080"><b>[</b></font><font color="#800000">&quot;email&quot;</font><font color="#008080"><b>]</b></font>, <font color="#800000">&quot;\n&quot;</font><font color="#008080"><b>)
        </b></font><font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font>rotulo<font color="#008080"><b>(</b></font>sreg, 4<font color="#008080"><b>)</b></font>, TCliente<font color="#008080"><b>[</b></font><font color="#800000">&quot;identidade&quot;</font><font color="#008080"><b>]</b></font>, <font color="#800000">&quot;\n&quot;</font><font color="#008080"><b>)
        </b></font><font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font>rotulo<font color="#008080"><b>(</b></font>sreg, 5<font color="#008080"><b>)</b></font>, TCliente<font color="#008080"><b>[</b></font><font color="#800000">&quot;sexo&quot;</font><font color="#008080"><b>]</b></font>, <font color="#800000">&quot;\n&quot;</font><font color="#008080"><b>)
        </b></font><font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font>rotulo<font color="#008080"><b>(</b></font>sreg, 6<font color="#008080"><b>)</b></font>, TCliente<font color="#008080"><b>[</b></font><font color="#800000">&quot;telefone&quot;</font><font color="#008080"><b>]</b></font>, <font color="#800000">&quot;\n&quot;</font><font color="#008080"><b>)
        </b></font><font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font>rotulo<font color="#008080"><b>(</b></font>sreg, 7<font color="#008080"><b>)</b></font>, TCliente<font color="#008080"><b>[</b></font><font color="#800000">&quot;dtnascimento&quot;</font><font color="#008080"><b>]</b></font>, <font color="#800000">&quot;\n&quot;</font><font color="#008080"><b>)
        </b></font><font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font>rotulo<font color="#008080"><b>(</b></font>sreg, 8<font color="#008080"><b>)</b></font>, TCliente<font color="#008080"><b>[</b></font><font color="#800000">&quot;codendereco&quot;</font><font color="#008080"><b>]</b></font>, <font color="#800000">&quot;\n&quot;</font><font color="#008080"><b>)
        </b></font>mostrarSubDados<font color="#008080"><b>(</b></font>OPCLIENTE, OPENDERECO, true<font color="#008080"><b>)
        </b></font><font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font>rotulo<font color="#008080"><b>(</b></font>sreg, 9<font color="#008080"><b>)</b></font>, TCliente<font color="#008080"><b>[</b></font><font color="#800000">&quot;codpais&quot;</font><font color="#008080"><b>]</b></font>, <font color="#800000">&quot;\n&quot;</font><font color="#008080"><b>)
        </b></font>mostrarSubDados<font color="#008080"><b>(</b></font>OPCLIENTE, OPPAIS, true<font color="#008080"><b>)
        </b></font><font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font>rotulo<font color="#008080"><b>(</b></font>sreg, 10<font color="#008080"><b>)</b></font>, TCliente<font color="#008080"><b>[</b></font><font color="#800000">&quot;codprofissao&quot;</font><font color="#008080"><b>]</b></font>, <font color="#800000">&quot;\n&quot;</font><font color="#008080"><b>)
        </b></font>mostrarSubDados<font color="#008080"><b>(</b></font>OPCLIENTE, OPPROFISSAO, true<font color="#008080"><b>)
   </b></font><font color="#0000FF"><b>end
elsif </b></font>sreg==OPVENDA then
   <font color="#0000FF"><b>case </b></font>nOpcao
     when 1 
        mostrarSubDados<font color="#008080"><b>(</b></font>OPVENDA,OPVENDA, false<font color="#008080"><b>)
     </b></font>when 2
        <font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;DataHoraVenda       CPF            ISBN          &quot;</font>+
        <font color="#800000">&quot;Pre&ccedil;oVenda\n&quot;</font><font color="#008080"><b>)
        </b></font><font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;-------------       ---            ----          &quot;</font>+
        <font color="#800000">&quot;----------\n&quot;</font><font color="#008080"><b>)
     </b></font>when 3
        TVenda<font color="#008080"><b>[</b></font><font color="#800000">&quot;dthrvenda&quot;</font><font color="#008080"><b>]</b></font>=copy<font color="#008080"><b>(</b></font>slinha, 1, 19<font color="#008080"><b>)
        </b></font>TVenda<font color="#008080"><b>[</b></font><font color="#800000">&quot;cpf&quot;</font><font color="#008080"><b>]</b></font>=copy<font color="#008080"><b>(</b></font>slinha, 20, 14<font color="#008080"><b>)
        </b></font>TVenda<font color="#008080"><b>[</b></font><font color="#800000">&quot;isbn&quot;</font><font color="#008080"><b>]</b></font>=copy<font color="#008080"><b>(</b></font>slinha, 34, 13<font color="#008080"><b>)
        </b></font>TVenda<font color="#008080"><b>[</b></font><font color="#800000">&quot;precovenda&quot;</font><font color="#008080"><b>]</b></font>=copy<font color="#008080"><b>(</b></font>slinha, 47, 10<font color="#008080"><b>)
        </b></font><font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font>TVenda<font color="#008080"><b>[</b></font><font color="#800000">&quot;dthrvenda&quot;</font><font color="#008080"><b>]</b></font>,<font color="#800000">&quot; &quot;</font>,TVenda<font color="#008080"><b>[</b></font><font color="#800000">&quot;cpf&quot;</font><font color="#008080"><b>]</b></font>,<font color="#800000">&quot; &quot;</font>,TVenda<font color="#008080"><b>[</b></font><font color="#800000">&quot;isbn&quot;</font><font color="#008080"><b>]</b></font>,<font color="#800000">&quot; &quot;</font>,
        TVenda<font color="#008080"><b>[</b></font><font color="#800000">&quot;precovenda&quot;</font><font color="#008080"><b>]</b></font>, <font color="#800000">&quot;\n&quot;</font><font color="#008080"><b>)
   </b></font><font color="#0000FF"><b>end
end

end
</b></font><font color="#808080">#------------------------------------------------------------------------------
# Mostra as sub inform&ccedil;&otilde;es de entrada e de sa&iacute;da.
# sreg - o tipo de arquivo
# ssubreg - o subtipo de arquivo
# bSoMostrar - se vai s&oacute; mostrar na sa&iacute;da 
#------------------------------------------------------------------------------
</font><font color="#0000FF"><b>def </b></font>mostrarSubDados<font color="#008080"><b>(</b></font>sreg, ssubreg, bSoMostrar<font color="#008080"><b>)
</b></font>sRegistro, sPreco = <font color="#800000">&quot;&quot;</font>, <font color="#800000">&quot;&quot;
</font>nMaxTentativas=3
<font color="#0000FF"><b>if </b></font>sreg==OPLIVRO then
  <font color="#0000FF"><b>if </b></font>ssubreg==OPEDITORA then
    <font color="#0000FF"><b>if </b></font>bSoMostrar then
       sRegistro=pesqArq<font color="#008080"><b>($</b></font>tfEditora,TLivro<font color="#008080"><b>[</b></font><font color="#800000">&quot;codeditora&quot;</font><font color="#008080"><b>]</b></font>,1,10,tamReg<font color="#008080"><b>(</b></font>OPEDITORA<font color="#008080"><b>))
    </b></font><font color="#0000FF"><b>else
       </b></font>sRegistro=validaEntrada<font color="#008080"><b>($</b></font>tfEditora,ssubreg,1,TLivro<font color="#008080"><b>[</b></font><font color="#800000">&quot;codeditora&quot;</font><font color="#008080"><b>]</b></font>,
                  nMaxTentativas,false,OPNUMERO<font color="#008080"><b>)
    </b></font><font color="#0000FF"><b>end
    if </b></font>sRegistro!=<font color="#800000">&quot;&quot; </font>then
      TLivro<font color="#008080"><b>[</b></font><font color="#800000">&quot;codeditora&quot;</font><font color="#008080"><b>]</b></font>=copy<font color="#008080"><b>(</b></font>sRegistro,1,10<font color="#008080"><b>)</b></font>.<font color="#800000"><b>strip
      </b></font><font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot; &quot;</font>,rotulo<font color="#008080"><b>(</b></font>OPEDITORA, 2<font color="#008080"><b>))
      </b></font><font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font>copy<font color="#008080"><b>(</b></font>sRegistro, $g_nPosChave, $g_nTamChave<font color="#008080"><b>)</b></font>, <font color="#800000">&quot;\n&quot;</font><font color="#008080"><b>)
    </b></font><font color="#0000FF"><b>end
  elsif </b></font>ssubreg==OPIDIOMA then
    <font color="#0000FF"><b>if </b></font>bSoMostrar then
       sRegistro=pesqArq<font color="#008080"><b>($</b></font>tfIdioma, TLivro<font color="#008080"><b>[</b></font><font color="#800000">&quot;codidioma&quot;</font><font color="#008080"><b>]</b></font>, 1, 10,tamReg<font color="#008080"><b>(</b></font>OPIDIOMA<font color="#008080"><b>))
    </b></font><font color="#0000FF"><b>else
       </b></font>sRegistro=validaEntrada<font color="#008080"><b>($</b></font>tfIdioma,ssubreg,1,TLivro<font color="#008080"><b>[</b></font><font color="#800000">&quot;codidioma&quot;</font><font color="#008080"><b>]</b></font>,
                  nMaxTentativas,false,OPNUMERO<font color="#008080"><b>)
    </b></font><font color="#0000FF"><b>end
    if </b></font>sRegistro!=<font color="#800000">&quot;&quot; </font>then
      TLivro<font color="#008080"><b>[</b></font><font color="#800000">&quot;codidioma&quot;</font><font color="#008080"><b>]</b></font>=copy<font color="#008080"><b>(</b></font>sRegistro,1,10<font color="#008080"><b>)</b></font>.<font color="#800000"><b>strip
      </b></font><font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot; &quot;</font>,rotulo<font color="#008080"><b>(</b></font>OPIDIOMA, 2<font color="#008080"><b>))
      </b></font><font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font>copy<font color="#008080"><b>(</b></font>sRegistro, $g_nPosChave, $g_nTamChave<font color="#008080"><b>)</b></font>, <font color="#800000">&quot;\n&quot;</font><font color="#008080"><b>)
    </b></font><font color="#0000FF"><b>end
  end
elsif </b></font>sreg==OPCLIENTE then
  <font color="#0000FF"><b>if </b></font>ssubreg==OPENDERECO then
    <font color="#0000FF"><b>if </b></font>bSoMostrar then
       sRegistro=pesqArq<font color="#008080"><b>($</b></font>tfEndereco, TCliente<font color="#008080"><b>[</b></font><font color="#800000">&quot;codendereco&quot;</font><font color="#008080"><b>]</b></font>, 1, 10,
                  tamReg<font color="#008080"><b>(</b></font>OPENDERECO<font color="#008080"><b>))
    </b></font><font color="#0000FF"><b>else
       </b></font>sRegistro=validaEntrada<font color="#008080"><b>($</b></font>tfEndereco,ssubreg,1,TCliente<font color="#008080"><b>[</b></font><font color="#800000">&quot;codendereco&quot;</font><font color="#008080"><b>]</b></font>,
                  nMaxTentativas,false,OPNUMERO<font color="#008080"><b>)
    </b></font><font color="#0000FF"><b>end
    if </b></font>sRegistro!=<font color="#800000">&quot;&quot; </font>then
      TCliente<font color="#008080"><b>[</b></font><font color="#800000">&quot;codendereco&quot;</font><font color="#008080"><b>]</b></font>=copy<font color="#008080"><b>(</b></font>sRegistro,1,10<font color="#008080"><b>)</b></font>.<font color="#800000"><b>strip
      </b></font><font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot; &quot;</font>,rotulo<font color="#008080"><b>(</b></font>OPENDERECO, 2<font color="#008080"><b>))
      </b></font><font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font>copy<font color="#008080"><b>(</b></font>sRegistro, $g_nPosChave, $g_nTamChave<font color="#008080"><b>)</b></font>, <font color="#800000">&quot;\n&quot;</font><font color="#008080"><b>)
      </b></font><font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot; &quot;</font>,rotulo<font color="#008080"><b>(</b></font>OPENDERECO, 3<font color="#008080"><b>))
      </b></font><font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font>copy<font color="#008080"><b>(</b></font>sRegistro, $g_nPosChave, $g_nTamChave<font color="#008080"><b>)</b></font>, <font color="#800000">&quot;\n&quot;</font><font color="#008080"><b>)
      </b></font><font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot; &quot;</font>,rotulo<font color="#008080"><b>(</b></font>OPENDERECO, 4<font color="#008080"><b>))
      </b></font><font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font>copy<font color="#008080"><b>(</b></font>sRegistro, $g_nPosChave, $g_nTamChave<font color="#008080"><b>)</b></font>, <font color="#800000">&quot;\n&quot;</font><font color="#008080"><b>)
      </b></font><font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot; &quot;</font>,rotulo<font color="#008080"><b>(</b></font>OPENDERECO, 5<font color="#008080"><b>))
      </b></font><font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font>copy<font color="#008080"><b>(</b></font>sRegistro, $g_nPosChave, $g_nTamChave<font color="#008080"><b>)</b></font>, <font color="#800000">&quot;\n&quot;</font><font color="#008080"><b>)
      </b></font><font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot; &quot;</font>,rotulo<font color="#008080"><b>(</b></font>OPENDERECO, 6<font color="#008080"><b>))
      </b></font><font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font>copy<font color="#008080"><b>(</b></font>sRegistro, $g_nPosChave, $g_nTamChave<font color="#008080"><b>)</b></font>, <font color="#800000">&quot;\n&quot;</font><font color="#008080"><b>)
    </b></font><font color="#0000FF"><b>end
  elsif </b></font>ssubreg==OPPAIS then
    <font color="#0000FF"><b>if </b></font>bSoMostrar then
       sRegistro=pesqArq<font color="#008080"><b>($</b></font>tfPais, TCliente<font color="#008080"><b>[</b></font><font color="#800000">&quot;codpais&quot;</font><font color="#008080"><b>]</b></font>, 1, 3, tamReg<font color="#008080"><b>(</b></font>OPPAIS<font color="#008080"><b>))
    </b></font><font color="#0000FF"><b>else
       </b></font>sRegistro=validaEntrada<font color="#008080"><b>($</b></font>tfPais,ssubreg,1,TCliente<font color="#008080"><b>[</b></font><font color="#800000">&quot;codpais&quot;</font><font color="#008080"><b>]</b></font>,
                  nMaxTentativas,false,OPTEXTO<font color="#008080"><b>)
    </b></font><font color="#0000FF"><b>end
    if </b></font>sRegistro!=<font color="#800000">&quot;&quot; </font>then
      TCliente<font color="#008080"><b>[</b></font><font color="#800000">&quot;codpais&quot;</font><font color="#008080"><b>]</b></font>=copy<font color="#008080"><b>(</b></font>sRegistro,1,3<font color="#008080"><b>)</b></font>.<font color="#800000"><b>strip
      </b></font><font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot; &quot;</font>,rotulo<font color="#008080"><b>(</b></font>OPPAIS, 2<font color="#008080"><b>))
      </b></font><font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font>copy<font color="#008080"><b>(</b></font>sRegistro, $g_nPosChave, $g_nTamChave<font color="#008080"><b>)</b></font>, <font color="#800000">&quot;\n&quot;</font><font color="#008080"><b>)
    </b></font><font color="#0000FF"><b>end
  elsif </b></font>ssubreg==OPPROFISSAO then
    <font color="#0000FF"><b>if </b></font>bSoMostrar then
       sRegistro=pesqArq<font color="#008080"><b>($</b></font>tfProfissao, TCliente<font color="#008080"><b>[</b></font><font color="#800000">&quot;codprofissao&quot;</font><font color="#008080"><b>]</b></font>, 1, 10,
                  tamReg<font color="#008080"><b>(</b></font>OPPROFISSAO<font color="#008080"><b>))
    </b></font><font color="#0000FF"><b>else
       </b></font>sRegistro=validaEntrada<font color="#008080"><b>($</b></font>tfProfissao,ssubreg,1,TCliente<font color="#008080"><b>[</b></font><font color="#800000">&quot;codprofissao&quot;</font><font color="#008080"><b>]</b></font>,
                  nMaxTentativas,false,OPNUMERO<font color="#008080"><b>)
    </b></font><font color="#0000FF"><b>end
    if </b></font>sRegistro!=<font color="#800000">&quot;&quot; </font>then
      TCliente<font color="#008080"><b>[</b></font><font color="#800000">&quot;codprofissao&quot;</font><font color="#008080"><b>]</b></font>=copy<font color="#008080"><b>(</b></font>sRegistro,1,10<font color="#008080"><b>)</b></font>.<font color="#800000"><b>strip
      </b></font><font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot; &quot;</font>,rotulo<font color="#008080"><b>(</b></font>OPPROFISSAO, 2<font color="#008080"><b>))
      </b></font><font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font>copy<font color="#008080"><b>(</b></font>sRegistro, $g_nPosChave, $g_nTamChave<font color="#008080"><b>)</b></font>, <font color="#800000">&quot;\n&quot;</font><font color="#008080"><b>)
    </b></font><font color="#0000FF"><b>end
  end
elsif </b></font>sreg==OPVENDA then
  sRegistro=pesqArq<font color="#008080"><b>($</b></font>tfLivro, TVenda<font color="#008080"><b>[</b></font><font color="#800000">&quot;isbn&quot;</font><font color="#008080"><b>]</b></font>, 1, 13, tamReg<font color="#008080"><b>(</b></font>OPLIVRO<font color="#008080"><b>))
  </b></font><font color="#0000FF"><b>if </b></font>sRegistro!=<font color="#800000">&quot;&quot; </font>then
    <font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot; &quot;</font>,rotulo<font color="#008080"><b>(</b></font>OPLIVRO, 2<font color="#008080"><b>)) </b></font><font color="#808080"># Titulo 
    </font><font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font>copy<font color="#008080"><b>(</b></font>sRegistro, $g_nPosChave, $g_nTamChave<font color="#008080"><b>)</b></font>, <font color="#800000">&quot;\n&quot;</font><font color="#008080"><b>)
    </b></font><font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot; &quot;</font>,rotulo<font color="#008080"><b>(</b></font>OPLIVRO, 9<font color="#008080"><b>)) </b></font><font color="#808080"># Preco 
    </font>sPreco=copy<font color="#008080"><b>(</b></font>sRegistro, $g_nPosChave, $g_nTamChave<font color="#008080"><b>)
    </b></font>$g_nPreco = sPreco.<font color="#800000"><b>to_f
    </b></font><font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font>sPreco, <font color="#800000">&quot;\n&quot;</font><font color="#008080"><b>)
  </b></font><font color="#0000FF"><b>end
end
end
</b></font><font color="#808080">#------------------------------------------------------------------------------
# Realiza os cadastros dos arquivos que se ligam a outros arquivos.
# sreg - o tipo de arquivo
# sacao - a a&ccedil;&atilde;o a ser realizada
# sCodigo - um das chaves do arquivo de liga&ccedil;&atilde;o
#------------------------------------------------------------------------------
</font><font color="#0000FF"><b>def </b></font>frmCadLigados<font color="#008080"><b>(</b></font>sreg, sacao, sCodigo<font color="#008080"><b>)
</b></font>nQtd, nCont, nQtdEstoque = 0,0,0
nTotalPreco = 0.0
slinha, sTotalPreco, sPreco, sQtd = <font color="#800000">&quot;&quot;</font>,<font color="#800000">&quot;&quot;</font>,<font color="#800000">&quot;&quot;</font>,<font color="#800000">&quot;&quot;

</font><font color="#0000FF"><b>if </b></font>sacao==OPNOVO then
  nCont=1
  <font color="#0000FF"><b>if </b></font>sreg==OPLIVROASS then
    sQtd=validaNumero<font color="#008080"><b>(</b></font><font color="#800000">&quot;Quantos assuntos quer cadastrar?: &quot;</font>, sQtd<font color="#008080"><b>)
    </b></font>nQtd = sQtd.<font color="#800000"><b>to_i
    </b></font>$tfLivroAss.<font color="#800000"><b>seek</b></font><font color="#008080"><b>(0</b></font>, <font color="#800000"><b>IO</b></font>::SEEK_SET<font color="#008080"><b>)
    </b></font><font color="#0000FF"><b>while </b></font>nCont &lt;= nQtd do
      TLivroAss<font color="#008080"><b>[</b></font><font color="#800000">&quot;isbn&quot;</font><font color="#008080"><b>]</b></font>=sCodigo
      <font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font>rotulo<font color="#008080"><b>(</b></font>OPLIVROASS, 2<font color="#008080"><b>))
      </b></font>TLivroAss<font color="#008080"><b>[</b></font><font color="#800000">&quot;codassunto&quot;</font><font color="#008080"><b>] </b></font>= digita<font color="#008080"><b>()
      </b></font>slinha=pesqArq<font color="#008080"><b>($</b></font>tfAssunto, TLivroAss<font color="#008080"><b>[</b></font><font color="#800000">&quot;codassunto&quot;</font><font color="#008080"><b>]</b></font>,1,10,tamReg<font color="#008080"><b>(</b></font>OPASSUNTO<font color="#008080"><b>))
      </b></font><font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot; &quot;</font>,rotulo<font color="#008080"><b>(</b></font>OPASSUNTO, 2<font color="#008080"><b>))
      </b></font><font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font>copy<font color="#008080"><b>(</b></font>slinha, $g_nPosChave, $g_nTamChave<font color="#008080"><b>)</b></font>, <font color="#800000">&quot;\n&quot;</font><font color="#008080"><b>)
      </b></font>pesqLinhaExcluida<font color="#008080"><b>($</b></font>tfLivroAss, tamReg<font color="#008080"><b>(</b></font>sreg<font color="#008080"><b>))
      </b></font>subMenu<font color="#008080"><b>(14</b></font>, sreg<font color="#008080"><b>)
      </b></font>nCont=nCont+1
    <font color="#0000FF"><b>end
  elsif </b></font>sreg==OPLIVROAUT then
    sQtd=validaNumero<font color="#008080"><b>(</b></font><font color="#800000">&quot;Quantos autores quer cadastrar?: &quot;</font>,sQtd<font color="#008080"><b>)
    </b></font>nQtd = sQtd.<font color="#800000"><b>to_i
    </b></font>$tfLivroAut.<font color="#800000"><b>seek</b></font><font color="#008080"><b>(0</b></font>, <font color="#800000"><b>IO</b></font>::SEEK_SET<font color="#008080"><b>)
    </b></font><font color="#0000FF"><b>while </b></font>nCont &lt;= nQtd do
      TLivroAut<font color="#008080"><b>[</b></font><font color="#800000">&quot;isbn&quot;</font><font color="#008080"><b>]</b></font>=sCodigo
      <font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font>rotulo<font color="#008080"><b>(</b></font>OPLIVROAUT, 2<font color="#008080"><b>))
      </b></font>TLivroAut<font color="#008080"><b>[</b></font><font color="#800000">&quot;codautor&quot;</font><font color="#008080"><b>] </b></font>= digita<font color="#008080"><b>()
      </b></font>slinha=pesqArq<font color="#008080"><b>($</b></font>tfAutor, TLivroAut<font color="#008080"><b>[</b></font><font color="#800000">&quot;codautor&quot;</font><font color="#008080"><b>]</b></font>,1,10,tamReg<font color="#008080"><b>(</b></font>OPAUTOR<font color="#008080"><b>))
      </b></font><font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot; &quot;</font>,rotulo<font color="#008080"><b>(</b></font>OPAUTOR, 2<font color="#008080"><b>))
      </b></font><font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font>copy<font color="#008080"><b>(</b></font>slinha, $g_nPosChave, $g_nTamChave<font color="#008080"><b>)</b></font>, <font color="#800000">&quot;\n&quot;</font><font color="#008080"><b>)
      </b></font>pesqLinhaExcluida<font color="#008080"><b>($</b></font>tfLivroAut, tamReg<font color="#008080"><b>(</b></font>sreg<font color="#008080"><b>))
      </b></font>subMenu<font color="#008080"><b>(14</b></font>, sreg<font color="#008080"><b>)
      </b></font>nCont=nCont+1
    <font color="#0000FF"><b>end
  elsif </b></font>sreg==OPVENDA then
    sQtd=validaNumero<font color="#008080"><b>(</b></font><font color="#800000">&quot;Quantos livros quer vender?: &quot;</font>,sQtd<font color="#008080"><b>)
    </b></font>nQtd = sQtd.<font color="#800000"><b>to_i
    </b></font>nTotalPreco=0
    <font color="#0000FF"><b>while </b></font>nCont &lt;= nQtd do
      slinha=validaEntrada<font color="#008080"><b>($</b></font>tfLivro,OPLIVRO,1,TVenda<font color="#008080"><b>[</b></font><font color="#800000">&quot;isbn&quot;</font><font color="#008080"><b>]</b></font>,3,false,OPTEXTO<font color="#008080"><b>)
      </b></font><font color="#0000FF"><b>if </b></font>slinha!=<font color="#800000">&quot;&quot; </font>then
        TVenda<font color="#008080"><b>[</b></font><font color="#800000">&quot;isbn&quot;</font><font color="#008080"><b>]</b></font>=copy<font color="#008080"><b>(</b></font>slinha,1,13<font color="#008080"><b>)</b></font>.<font color="#800000"><b>strip
        </b></font><font color="#0000FF"><b>if </b></font>validaISBN<font color="#008080"><b>(</b></font>TVenda<font color="#008080"><b>[</b></font><font color="#800000">&quot;isbn&quot;</font><font color="#008080"><b>]) </b></font>then
          mostrarDados<font color="#008080"><b>(</b></font>sreg, <font color="#800000">&quot;&quot;</font>, 1<font color="#008080"><b>)
          </b></font>TLivro<font color="#008080"><b>[</b></font><font color="#800000">&quot;qtdestoque&quot;</font><font color="#008080"><b>]</b></font>=copy<font color="#008080"><b>(</b></font>slinha,134,10<font color="#008080"><b>)</b></font>.<font color="#800000"><b>strip
          </b></font>nQtdEstoque = TLivro<font color="#008080"><b>[</b></font><font color="#800000">&quot;qtdestoque&quot;</font><font color="#008080"><b>]</b></font>.<font color="#800000"><b>to_i
          </b></font><font color="#0000FF"><b>if </b></font>nQtdEstoque &gt; 0 then
             nTotalPreco=nTotalPreco + $g_nPreco
             sPreco=$g_nPreco.<font color="#800000"><b>to_s
             </b></font>TVenda<font color="#008080"><b>[</b></font><font color="#800000">&quot;precovenda&quot;</font><font color="#008080"><b>]</b></font>=sPreco
             $g_SalvarInclusao=false
             subMenu<font color="#008080"><b>(14</b></font>, sreg<font color="#008080"><b>)
             </b></font><font color="#0000FF"><b>if </b></font>$g_SalvarInclusao then
                slinha=pesqArq<font color="#008080"><b>($</b></font>tfLivro, TVenda<font color="#008080"><b>[</b></font><font color="#800000">&quot;isbn&quot;</font><font color="#008080"><b>]</b></font>, 1, 13, tamReg<font color="#008080"><b>(</b></font>OPLIVRO<font color="#008080"><b>))
                </b></font><font color="#0000FF"><b>if </b></font>slinha!=<font color="#800000">&quot;&quot; </font>then
                   nQtdEstoque=nQtdEstoque-1
                   TLivro<font color="#008080"><b>[</b></font><font color="#800000">&quot;qtdestoque&quot;</font><font color="#008080"><b>] </b></font>= nQtdEstoque.<font color="#800000"><b>to_s
                   </b></font>slinha=copy<font color="#008080"><b>(</b></font>slinha,1,133<font color="#008080"><b>)</b></font>+esp<font color="#008080"><b>(</b></font>TLivro<font color="#008080"><b>[</b></font><font color="#800000">&quot;qtdestoque&quot;</font><font color="#008080"><b>]</b></font>,10<font color="#008080"><b>)
                   </b></font>escreveArq<font color="#008080"><b>($</b></font>tfLivro, slinha, <font color="#800000">&quot;&quot;</font>, <font color="#800000">&quot;&quot;</font><font color="#008080"><b>)
                </b></font><font color="#0000FF"><b>end
             end
             </b></font>nCont=nCont+1
          <font color="#0000FF"><b>else 
            print</b></font><font color="#008080"><b>(</b></font>MSG_SEMESTOQUE<font color="#008080"><b>)
          </b></font><font color="#0000FF"><b>end 
        else 
          print</b></font><font color="#008080"><b>(</b></font>MSG_ISBNINV<font color="#008080"><b>)
        </b></font><font color="#0000FF"><b>end
      end
    end
    </b></font>sTotalPreco = nTotalPreco.<font color="#800000"><b>to_s
    </b></font><font color="#0000FF"><b>print</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;Total de &quot;</font>,rotulo<font color="#008080"><b>(</b></font>sreg,4<font color="#008080"><b>)</b></font>,sTotalPreco, <font color="#800000">&quot;\n&quot;</font><font color="#008080"><b>)
  </b></font><font color="#0000FF"><b>end
elsif </b></font>sacao==OPEXCLUIR then
  <font color="#0000FF"><b>if </b></font>sreg==OPLIVROASS then
     ExcluirRegLigados<font color="#008080"><b>($</b></font>tfLivroAss, sreg, 1, 13, sCodigo<font color="#008080"><b>)
  </b></font><font color="#0000FF"><b>elsif </b></font>sreg==OPLIVROAUT then
     ExcluirRegLigados<font color="#008080"><b>($</b></font>tfLivroAut, sreg, 1, 13, sCodigo<font color="#008080"><b>)
  </b></font><font color="#0000FF"><b>end
end

end
</b></font><font color="#808080">#------------------------------------------------------------------------------
# Realiza a exclus&atilde;o dos arquivos de liga&ccedil;&atilde;o.
# sArq - o arquivo de liga&ccedil;&atilde;o
# sreg - o tipo de arquivo de liga&ccedil;&atilde;o
# nPosChave - a posicao inicial da chave dentro do registro
# nTamChave - o tamanho da chave dentro do registro
# sChave - a chave a ser excluida
#------------------------------------------------------------------------------
</font><font color="#0000FF"><b>def </b></font>ExcluirRegLigados<font color="#008080"><b>(</b></font>sArq, sreg, nPosChave, nTamChave, sChave<font color="#008080"><b>)
</b></font>slinha, sCodigo = <font color="#800000">&quot;&quot;</font>, <font color="#800000">&quot;&quot;

  </font>sArq.<font color="#800000"><b>seek</b></font><font color="#008080"><b>(0</b></font>, <font color="#800000"><b>IO</b></font>::SEEK_SET<font color="#008080"><b>)
  </b></font><font color="#0000FF"><b>while </b></font><font color="#008080"><b>(</b></font>not sArq.<font color="#800000"><b>eof</b></font><font color="#008080"><b>) </b></font>do
    slinha = sArq.<font color="#800000"><b>readline
    </b></font>sCodigo=copy<font color="#008080"><b>(</b></font>slinha,nPosChave,nTamChave<font color="#008080"><b>)</b></font>.<font color="#800000"><b>strip
    </b></font><font color="#0000FF"><b>if </b></font>sCodigo==sChave then
       btnAcao<font color="#008080"><b>(</b></font>sreg,OPCONFIRMAEXCLUSAO<font color="#008080"><b>)
    </b></font><font color="#0000FF"><b>end
  end
end

</b></font><font color="#808080">#------------------------------------------------------------------------------
# Parte inicial do c&oacute;digo
#------------------------------------------------------------------------------
</font><font color="#0000FF"><b>def </b></font>Main<font color="#008080"><b>()
 </b></font><font color="#0000FF"><b>if </b></font><font color="#008080"><b>(</b></font><font color="#0000FF">ARGV</font>.<font color="#800000"><b>length </b></font>&gt; 0<font color="#008080"><b>) </b></font>and <font color="#008080"><b>(</b></font><font color="#0000FF">ARGV</font><font color="#008080"><b>[0]</b></font>==<font color="#800000">&quot;-cria&quot;</font><font color="#008080"><b>) </b></font>then
   abrecriaArqs<font color="#008080"><b>(</b></font>false<font color="#008080"><b>)
 </b></font><font color="#0000FF"><b>else
   </b></font>frmSplash<font color="#008080"><b>()
   </b></font>abrecriaArqs<font color="#008080"><b>(</b></font>true<font color="#008080"><b>)
   </b></font><font color="#0000FF"><b>if </b></font>frmLogin<font color="#008080"><b>() </b></font>then
     $bopcao=true
     <font color="#0000FF"><b>while </b></font>$bopcao do
       menu<font color="#008080"><b>(1)
       </b></font>$opmenu = digita<font color="#008080"><b>()
       </b></font><font color="#0000FF"><b>if </b></font><font color="#008080"><b>($</b></font>opmenu==<font color="#800000">&quot;C&quot;</font><font color="#008080"><b>) </b></font>or <font color="#008080"><b>($</b></font>opmenu==<font color="#800000">&quot;c&quot;</font><font color="#008080"><b>) </b></font>then usaMenu<font color="#008080"><b>(1)
       </b></font><font color="#0000FF"><b>elsif </b></font><font color="#008080"><b>($</b></font>opmenu==<font color="#800000">&quot;P&quot;</font><font color="#008080"><b>) </b></font>or <font color="#008080"><b>($</b></font>opmenu==<font color="#800000">&quot;p&quot;</font><font color="#008080"><b>) </b></font>then usaMenu<font color="#008080"><b>(2)
       </b></font><font color="#0000FF"><b>elsif </b></font><font color="#008080"><b>($</b></font>opmenu==<font color="#800000">&quot;V&quot;</font><font color="#008080"><b>) </b></font>or <font color="#008080"><b>($</b></font>opmenu==<font color="#800000">&quot;v&quot;</font><font color="#008080"><b>) </b></font>then usaMenu<font color="#008080"><b>(3)
       </b></font><font color="#0000FF"><b>elsif </b></font><font color="#008080"><b>($</b></font>opmenu==<font color="#800000">&quot;O&quot;</font><font color="#008080"><b>) </b></font>or <font color="#008080"><b>($</b></font>opmenu==<font color="#800000">&quot;o&quot;</font><font color="#008080"><b>) </b></font>then usaMenu<font color="#008080"><b>(4)
       </b></font><font color="#0000FF"><b>else 
         print</b></font><font color="#008080"><b>(</b></font>MSG_ERRO<font color="#008080"><b>)
       </b></font><font color="#0000FF"><b>end
     end
   else
     </b></font>fechaArqs<font color="#008080"><b>()
     </b></font><font color="#800000"><b>exit</b></font><font color="#008080"><b>(0)
   </b></font><font color="#0000FF"><b>end
 end
end

</b></font>Main<font color="#008080"><b>()
</b></font></font>
</code></pre>
</body>
</html>