<html>
<head>
<title>Livrus Virtus - Console - Rexx</title>
</head>
<!-- Generated by ConTEXT HTML exporter -->
<body text="#000000" bgcolor="#FFFFFF">
<pre>
<code><font  face="Courier New"><font color="#808080">#!/</font>usr<font color="#808080">/</font>local<font color="#808080">/</font>bin<font color="#808080">/</font>rexx
<font color="#008000"><i>/*------------------------------------------------------------------------------
 Sistema integrante do projeto Livrus Virtus.
 Todos os direitos reservados para Henrique F. de Souza.
 Vers&atilde;o programada na linguagem pascal.
------------------------------------------------------------------------------*/
/* programa Livrus */

  </i></font>tAssunto<font color="#808080">.</font>codigo <font color="#808080">= ''
  </font>tAssunto<font color="#808080">.</font>assunto <font color="#808080">= ''
  
  </font>tAutor<font color="#808080">.</font>codigo <font color="#808080">= ''
  </font>tAutor<font color="#808080">.</font>autor <font color="#808080">= ''
  
  </font>tEditora<font color="#808080">.</font>codigo <font color="#808080">= ''
  </font>tEditora<font color="#808080">.</font>editora <font color="#808080">= ''
  
  </font>tIdioma<font color="#808080">.</font>codigo <font color="#808080">= ''
  </font>tIdioma<font color="#808080">.</font>idioma <font color="#808080">= ''
  
  </font>tUsuario<font color="#808080">.</font>login <font color="#808080">= ''
  </font>tUsuario<font color="#808080">.</font>senha <font color="#808080">= ''
  
  </font>tPais<font color="#808080">.</font>codigo <font color="#808080">= ''
  </font>tPais<font color="#808080">.</font>pais <font color="#808080">= ''
  
  </font>tProfissao<font color="#808080">.</font>codigo <font color="#808080">= ''
  </font>tProfissao<font color="#808080">.</font>profissao <font color="#808080">= ''
  
  </font>tLivro<font color="#808080">.</font>isbn <font color="#808080">= ''
  </font>tLivro<font color="#808080">.</font>titulo <font color="#808080">= ''
  </font>tLivro<font color="#808080">.</font>edicao <font color="#808080">= ''
  </font>tLivro<font color="#808080">.</font>anopubli <font color="#808080">= ''
  </font>tLivro<font color="#808080">.</font>codeditora <font color="#808080">= ''
  </font>tLivro<font color="#808080">.</font>volume <font color="#808080">= ''
  </font>tLivro<font color="#808080">.</font>codidioma <font color="#808080">= ''
  </font>tLivro<font color="#808080">.</font>npaginas <font color="#808080">= ''
  </font>tLivro<font color="#808080">.</font>preco <font color="#808080">= ''
  </font>tLivro<font color="#808080">.</font>qtdestoque <font color="#808080">= ''
  
  </font>tLivroAss<font color="#808080">.</font>isbn <font color="#808080">= ''
  </font>tLivroAss<font color="#808080">.</font>codassunto <font color="#808080">= ''
  
  </font>tLivroAut<font color="#808080">.</font>isbn <font color="#808080">= ''
  </font>tLivroAut<font color="#808080">.</font>codautor <font color="#808080">= ''
  
  </font>tCliente<font color="#808080">.</font>cpf <font color="#808080">= ''
  </font>tCliente<font color="#808080">.</font>nome <font color="#808080">= ''
  </font>tCliente<font color="#808080">.</font>email <font color="#808080">= ''
  </font>tCliente<font color="#808080">.</font>identidade <font color="#808080">= ''
  </font>tCliente<font color="#808080">.</font>sexo <font color="#808080">= ''
  </font>tCliente<font color="#808080">.</font>telefone <font color="#808080">= ''
  </font>tCliente<font color="#808080">.</font>dtnascimento <font color="#808080">= ''
  </font>tCliente<font color="#808080">.</font>codendereco <font color="#808080">= ''
  </font>tCliente<font color="#808080">.</font>codpais <font color="#808080">= ''
  </font>tCliente<font color="#808080">.</font>codprofissao <font color="#808080">= ''
  
  </font>tEndereco<font color="#808080">.</font>codigo <font color="#808080">= ''
  </font>tEndereco<font color="#808080">.</font>logradouro <font color="#808080">= ''
  </font>tEndereco<font color="#808080">.</font>bairro <font color="#808080">= ''
  </font>tEndereco<font color="#808080">.</font>cep <font color="#808080">= ''
  </font>tEndereco<font color="#808080">.</font>cidade <font color="#808080">= ''
  </font>tEndereco<font color="#808080">.</font>estado <font color="#808080">= ''
  
  </font>tVenda<font color="#808080">.</font>dthrvenda <font color="#808080">= ''  </font><font color="#008000"><i>/* data/hora da venda dd/mm/yyyy hh:mm:ss */
  </i></font>tVenda<font color="#808080">.</font>cpf <font color="#808080">= ''
  </font>tVenda<font color="#808080">.</font>isbn <font color="#808080">= ''
  </font>tVenda<font color="#808080">.</font>precovenda <font color="#808080">= ''

  </font>g_nPreco <font color="#808080">= </font><font color="#FF0000">0.0
  </font>g_SalvarInclusao <font color="#808080">= </font>false

<font color="#008000"><i>/*------------------------------------------------------------------------------
Parte inicial do c&oacute;digo
------------------------------------------------------------------------------*/
</i></font><font color="#000080"><b>call </b></font>main

main<font color="#808080">: </font><font color="#000080"><b>procedure

call </b></font>constantes
<font color="#008000"><i>/* if argumentostr(1)='-cria' then
     call abrecriaArqs false
 else do*/
   </i></font><font color="#000080"><b>call </b></font>frmSplash
   <font color="#000080"><b>call </b></font>abrecriaArqs true
   <font color="#000080"><b>if </b></font>frmLogin<font color="#808080">()=</font>true <font color="#000080"><b>then do
     </b></font>bopcao<font color="#808080">=</font>true
     <font color="#000080"><b>do </b></font>while bopcao<font color="#808080">=</font>true
       <font color="#000080"><b>call </b></font>menu<font color="#808080">(</font><font color="#FF0000">1</font><font color="#808080">)
       </font>opmenu <font color="#808080">= </font><font color="#0000FF"><b>linein</b></font><font color="#808080">()
       </font><font color="#000080"><b>if </b></font><font color="#808080">(</font>opmenu<font color="#808080">='</font>C<font color="#808080">') | (</font>opmenu<font color="#808080">='</font>c<font color="#808080">') </font><font color="#000080"><b>then call </b></font>usaMenu <font color="#FF0000">1
       </font><font color="#000080"><b>else if </b></font><font color="#808080">(</font>opmenu<font color="#808080">='</font>P<font color="#808080">') | (</font>opmenu<font color="#808080">='</font>p<font color="#808080">') </font><font color="#000080"><b>then call </b></font>usaMenu <font color="#FF0000">2
       </font><font color="#000080"><b>else if </b></font><font color="#808080">(</font>opmenu<font color="#808080">='</font>V<font color="#808080">') | (</font>opmenu<font color="#808080">='</font>v<font color="#808080">') </font><font color="#000080"><b>then call </b></font>usaMenu <font color="#FF0000">3
       </font><font color="#000080"><b>else if </b></font><font color="#808080">(</font>opmenu<font color="#808080">='</font>O<font color="#808080">') | (</font>opmenu<font color="#808080">='</font>o<font color="#808080">') </font><font color="#000080"><b>then call </b></font>usaMenu <font color="#FF0000">4
       </font><font color="#000080"><b>else say </b></font>MSG_ERRO
     <font color="#000080"><b>end
   end 
   else do
     call </b></font>fechaArqs
     <font color="#000080"><b>exit
   end
</b></font><font color="#008000"><i>/* end */

</i></font><font color="#000080"><b>return

</b></font>constantes<font color="#808080">:
  
  </font><font color="#008000"><i>/* constantes */

  </i></font>true <font color="#808080">= </font><font color="#FF0000">1</font><font color="#808080">; </font>false <font color="#808080">= </font><font color="#FF0000">0
  
  </font><font color="#008000"><i>/* ctTipo */
  </i></font>opTexto <font color="#808080">= </font><font color="#FF0000">1</font><font color="#808080">; </font>opNumero <font color="#808080">= </font><font color="#FF0000">2</font><font color="#808080">; </font>opData <font color="#808080">= </font><font color="#FF0000">3</font><font color="#808080">; </font>opDataHora <font color="#808080">= </font><font color="#FF0000">4</font><font color="#808080">; </font>opSenha <font color="#808080">= </font><font color="#FF0000">5
  </font><font color="#008000"><i>/* ctArqs */ 
  </i></font>opAssunto <font color="#808080">= </font><font color="#FF0000">1</font><font color="#808080">; </font>opAutor <font color="#808080">= </font><font color="#FF0000">2</font><font color="#808080">; </font>opEditora <font color="#808080">= </font><font color="#FF0000">3</font><font color="#808080">; </font>opEndereco <font color="#808080">= </font><font color="#FF0000">4</font><font color="#808080">; </font>opIdioma <font color="#808080">= </font><font color="#FF0000">5 
  </font>opPais <font color="#808080">= </font><font color="#FF0000">6</font><font color="#808080">; </font>opProfissao <font color="#808080">= </font><font color="#FF0000">7</font><font color="#808080">; </font>opCliente <font color="#808080">= </font><font color="#FF0000">8</font><font color="#808080">; </font>opLivro <font color="#808080">= </font><font color="#FF0000">9</font><font color="#808080">; </font>opLivroAss <font color="#808080">= </font><font color="#FF0000">10
  </font>opLivroAut <font color="#808080">= </font><font color="#FF0000">11</font><font color="#808080">; </font>opUsuario <font color="#808080">= </font><font color="#FF0000">12</font><font color="#808080">; </font>opVenda <font color="#808080">= </font><font color="#FF0000">13
  </font><font color="#008000"><i>/* ctAcao */
  </i></font>opNovo <font color="#808080">= </font><font color="#FF0000">1</font><font color="#808080">; </font>opAlterar <font color="#808080">= </font><font color="#FF0000">2</font><font color="#808080">; </font>opPesquisar <font color="#808080">= </font><font color="#FF0000">3</font><font color="#808080">; </font>opSalvarInclusao <font color="#808080">= </font><font color="#FF0000">4</font><font color="#808080">;
  </font>opSalvarAlteracao <font color="#808080">= </font><font color="#FF0000">5</font><font color="#808080">; </font>opExcluir <font color="#808080">= </font><font color="#FF0000">6</font><font color="#808080">; </font>opConfirmaExclusao <font color="#808080">= </font><font color="#FF0000">7</font><font color="#808080">; </font>opListarTodos <font color="#808080">= </font><font color="#FF0000">8
  
  </font>CRLF <font color="#808080">= '\</font>r<font color="#808080">\</font>n<font color="#808080">' </font><font color="#008000"><i>/* windows */
  </i></font>TAM_CRLF <font color="#808080">= </font><font color="#FF0000">2
  </font><font color="#008000"><i>/* CRLF = '\n'
     TAM_CRLF = 1 */ /* unix */
  /* CRLF = '\r'
     TAM_CRLF = 1 */ /* macintosh */
  
  </i></font>QTD_MAX_LINHA <font color="#808080">= </font><font color="#FF0000">18
  
  </font>MSG_ERRO <font color="#808080">= '</font>Erro<font color="#808080">: </font>op<font color="#808080">&ccedil;&atilde;</font>o inv<font color="#808080">&aacute;</font>lida digite de novo<font color="#808080">'
  </font>MSG_OPCAO <font color="#808080">= '</font>Escolha uma op<font color="#808080">&ccedil;&atilde;</font>o<font color="#808080">: '
  </font>MSG_PRESS <font color="#808080">= '</font>pressione para continuar<font color="#808080">...'
  
  </font>MSG_REGINC <font color="#808080">= '</font>registro incluido<font color="#808080">!'
  </font>MSG_REGNINC <font color="#808080">= '</font>registro n<font color="#808080">&atilde;</font>o incluido<font color="#808080">!'
  </font>MSG_REGALT <font color="#808080">= '</font>registro alterado<font color="#808080">!'
  </font>MSG_REGNALT <font color="#808080">= '</font>registro n<font color="#808080">&atilde;</font>o alterado<font color="#808080">!'
  </font>MSG_REGEXC <font color="#808080">= '</font>registro excluido<font color="#808080">!'
  </font>MSG_REGNEXC <font color="#808080">= '</font>registro n<font color="#808080">&atilde;</font>o excluido<font color="#808080">!'
  </font>MSG_REGEXST <font color="#808080">= '</font>registro j<font color="#808080">&aacute; </font>existe<font color="#808080">!'
  
  </font>MSG_NUMINV <font color="#808080">= '</font>N<font color="#808080">&uacute;</font>mero inv<font color="#808080">&aacute;</font>lido ou menor <font color="#000080"><b>do </b></font>que <font color="#FF0000">1</font><font color="#808080">!'
  </font>MSG_DATAINV <font color="#808080">= '</font>Data inv<font color="#808080">&aacute;</font>lida<font color="#808080">!, </font>formato correto <font color="#808080">(</font>dd<font color="#808080">/</font>mm<font color="#808080">/</font>yyyy<font color="#808080">)'
  </font>MSG_DTHRINV <font color="#808080">= '</font>Data<font color="#808080">/</font>hora inv<font color="#808080">&aacute;</font>lida<font color="#808080">!, </font>formato correto <font color="#808080">(</font>dd<font color="#808080">/</font>mm<font color="#808080">/</font>yyyy hh<font color="#808080">:</font>mm<font color="#808080">:</font>ss<font color="#808080">)'
  </font>MSG_ISBNINV <font color="#808080">= '</font>ISBN inv<font color="#808080">&aacute;</font>lido<font color="#808080">!'
  </font>MSG_CPFINV <font color="#808080">= '</font>CPF inv<font color="#808080">&aacute;</font>lido<font color="#808080">!'
  </font>MSG_SENCONFERE <font color="#808080">= '</font>senha n<font color="#808080">&atilde;</font>o confere com a senha atual<font color="#808080">!'
  </font>MSG_SENCONFIRM <font color="#808080">= '</font>nova senha n<font color="#808080">&atilde;</font>o confere com a senha confirmada<font color="#808080">!'
  </font>MSG_LOGINENCON <font color="#808080">= '</font>login n<font color="#808080">&atilde;</font>o encontrado<font color="#808080">!'
  </font>MSG_SEMESTOQUE <font color="#808080">= '</font>livro n<font color="#808080">&atilde;</font>o existe no estoque<font color="#808080">!'
  
  </font>ARQ_ASSUNTO <font color="#808080">= '</font>assunto<font color="#808080">.</font>dat<font color="#808080">'
  </font>ARQ_AUTOR <font color="#808080">= '</font>autor<font color="#808080">.</font>dat<font color="#808080">'
  </font>ARQ_EDITORA <font color="#808080">= '</font>editora<font color="#808080">.</font>dat<font color="#808080">'
  </font>ARQ_IDIOMA <font color="#808080">= '</font>idioma<font color="#808080">.</font>dat<font color="#808080">'
  </font>ARQ_USUARIO <font color="#808080">= '</font>usuario<font color="#808080">.</font>dat<font color="#808080">'
  </font>ARQ_PAIS <font color="#808080">= '</font>pais<font color="#808080">.</font>dat<font color="#808080">'
  </font>ARQ_PROFISSAO <font color="#808080">= '</font>profissao<font color="#808080">.</font>dat<font color="#808080">'
  </font>ARQ_LIVRO <font color="#808080">= '</font>livro<font color="#808080">.</font>dat<font color="#808080">'
  </font>ARQ_LIVASS <font color="#808080">= '</font>livroass<font color="#808080">.</font>dat<font color="#808080">'
  </font>ARQ_LIVAUT <font color="#808080">= '</font>livroaut<font color="#808080">.</font>dat<font color="#808080">'
  </font>ARQ_CLIENTE <font color="#808080">= '</font>cliente<font color="#808080">.</font>dat<font color="#808080">'
  </font>ARQ_ENDERECO <font color="#808080">= '</font>endereco<font color="#808080">.</font>dat<font color="#808080">'
  </font>ARQ_VENDA <font color="#808080">= '</font>venda<font color="#808080">.</font>dat<font color="#808080">'
  
  </font>TAM_ASSUNTO <font color="#808080">= </font><font color="#FF0000">40
  </font>TAM_AUTOR <font color="#808080">= </font><font color="#FF0000">40
  </font>TAM_EDITORA <font color="#808080">= </font><font color="#FF0000">60
  </font>TAM_IDIOMA <font color="#808080">= </font><font color="#FF0000">30
  </font>TAM_USUARIO <font color="#808080">= </font><font color="#FF0000">20
  </font>TAM_PAIS <font color="#808080">= </font><font color="#FF0000">53
  </font>TAM_PROFISSAO <font color="#808080">= </font><font color="#FF0000">60
  </font>TAM_LIVRO <font color="#808080">= </font><font color="#FF0000">143
  </font>TAM_LIVASS <font color="#808080">= </font><font color="#FF0000">23
  </font>TAM_LIVAUT <font color="#808080">= </font><font color="#FF0000">23
  </font>TAM_CLIENTE <font color="#808080">= </font><font color="#FF0000">135
  </font>TAM_ENDERECO <font color="#808080">= </font><font color="#FF0000">123
  </font>TAM_VENDA <font color="#808080">= </font><font color="#FF0000">56
  
  </font>tfAssunto <font color="#808080">= </font>ARQ_ASSUNTO<font color="#808080">; </font>tfAutor <font color="#808080">= </font>ARQ_AUTOR<font color="#808080">; </font>tfEditora <font color="#808080">= </font>ARQ_EDITORA
  tfIdioma <font color="#808080">= </font>ARQ_IDIOMA<font color="#808080">; </font>tfEndereco <font color="#808080">= </font>ARQ_ENDERECO<font color="#808080">; </font>tfPais <font color="#808080">= </font>ARQ_PAIS 
  tfProfissao <font color="#808080">= </font>ARQ_PROFISSAO<font color="#808080">; </font>tfLivro <font color="#808080">= </font>ARQ_LIVRO<font color="#808080">; </font>tfLivroAss <font color="#808080">= </font>ARQ_LIVASS 
  tfLivroAut <font color="#808080">= </font>ARQ_LIVAUT<font color="#808080">; </font>tfCliente <font color="#808080">= </font>ARQ_CLIENTE<font color="#808080">; </font>tfUsuario <font color="#808080">= </font>ARQ_USUARIO 
  tfVenda <font color="#808080">= </font>ARQ_VENDA
  
<font color="#000080"><b>return

</b></font><font color="#008000"><i>/*--- Rotinas b&aacute;sicas ---------------------------------------------------------*/

/*------------------------------------------------------------------------------
Repete um texto um n&uacute;mero determinado de vezes.
sTexto - o texto a ser repetido
nQtd - a quantidade de vezes
retorna - o texto repetido
------------------------------------------------------------------------------*/
</i></font>repete<font color="#808080">: </font><font color="#000080"><b>procedure
  parse arg </b></font>sTexto<font color="#808080">, </font>nQtd
  sret <font color="#808080">= </font><font color="#0000FF"><b>left</b></font><font color="#808080">(</font>sTexto<font color="#808080">,</font>nQtd<font color="#808080">,</font>sTexto<font color="#808080">)
</font><font color="#000080"><b>return </b></font>sret

<font color="#008000"><i>/*------------------------------------------------------------------------------
Coloca espa&ccedil;os em branco a mais de acordo com o tamanho m&aacute;ximo do texto.
sTexto - o texto
nTam - tamanho m&aacute;ximo do texto
retorna - o texto com espa&ccedil;os em branco a mais
------------------------------------------------------------------------------*/
</i></font>esp<font color="#808080">: </font><font color="#000080"><b>procedure
  parse arg </b></font>sTexto<font color="#808080">, </font>nTam
  sret <font color="#808080">= </font><font color="#0000FF"><b>left</b></font><font color="#808080">(</font>sTexto<font color="#808080">,</font>nTam<font color="#808080">)
</font><font color="#000080"><b>return </b></font>sret

<font color="#008000"><i>/*------------------------------------------------------------------------------
Faz uma pesquisa relativa de um texto atrav&eacute;s de um valor chave.
sTexto - o texto
sChave - a chave a ser pesquisada
retorna - se achou ou n&atilde;o a chave dentro do texto
------------------------------------------------------------------------------*/
</i></font>strRelativa<font color="#808080">: </font><font color="#000080"><b>procedure
  parse arg </b></font>sTexto<font color="#808080">, </font>sChave

<font color="#000080"><b>call </b></font>constantes
  <font color="#000080"><b>if </b></font>countstr<font color="#808080">(</font>sChave<font color="#808080">,</font>sTexto<font color="#808080">) &gt; </font><font color="#FF0000">0 </font><font color="#000080"><b>then
     </b></font>bret <font color="#808080">= </font>true
  <font color="#000080"><b>else
     </b></font>bret <font color="#808080">= </font>false
<font color="#000080"><b>return </b></font>bret
<font color="#008000"><i>/*------------------------------------------------------------------------------
Calcula o modulo11 de um valor qualquer.
svalor - a mstring com o n&uacute;mero a ser calculado
ndig - d&iacute;gito do valor a ser calculado
retorna - o d&iacute;gito correto
------------------------------------------------------------------------------*/
</i></font>modulo11<font color="#808080">: </font><font color="#000080"><b>procedure 
  parse arg </b></font>valor<font color="#808080">, </font>dig

<font color="#000080"><b>call </b></font>constantes  
nsoma <font color="#808080">= </font><font color="#FF0000">0</font><font color="#808080">; </font>nvalor <font color="#808080">= </font><font color="#FF0000">0</font><font color="#808080">; </font>npos <font color="#808080">= </font><font color="#FF0000">0</font><font color="#808080">; </font>nmodulo11 <font color="#808080">= </font><font color="#FF0000">0
</font>sres <font color="#808080">= ''; </font>slocal <font color="#808080">= ''
</font>ncont <font color="#808080">= </font><font color="#FF0000">1
</font><font color="#000080"><b>do </b></font>while ncont <font color="#808080">&lt;= </font><font color="#FF0000">11
  </font>slocal <font color="#808080">= </font><font color="#808000"><b>substr</b></font><font color="#808080">(</font>svalor<font color="#808080">,</font>ncont<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">) || </font>slocal
  ncont <font color="#808080">= </font>ncont <font color="#808080">+ </font><font color="#FF0000">1
</font><font color="#000080"><b>end
</b></font>nsoma <font color="#808080">= </font><font color="#FF0000">0
</font><font color="#000080"><b>if </b></font>ndig<font color="#808080">=</font><font color="#FF0000">1 </font><font color="#000080"><b>then
  </b></font>ncont <font color="#808080">= </font><font color="#FF0000">3
</font><font color="#000080"><b>else
  </b></font>ncont <font color="#808080">= </font><font color="#FF0000">2

</font>npos <font color="#808080">= </font><font color="#FF0000">2
</font><font color="#000080"><b>do </b></font>while ncont <font color="#808080">&lt;= </font><font color="#FF0000">11
  </font>sres<font color="#808080">=</font><font color="#808000"><b>substr</b></font><font color="#808080">(</font>slocal<font color="#808080">,</font>ncont<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">)
  </font>nvalor <font color="#808080">= </font>sres
  nsoma<font color="#808080">=</font>nsoma <font color="#808080">+ (</font>nvalor <font color="#808080">* </font>npos<font color="#808080">)
  </font>ncont<font color="#808080">=</font>ncont<font color="#808080">+</font><font color="#FF0000">1
  </font>npos<font color="#808080">=</font>npos<font color="#808080">+</font><font color="#FF0000">1
</font><font color="#000080"><b>end
</b></font>nsoma<font color="#808080">=(</font><font color="#FF0000">11 </font><font color="#808080">- (</font>nsoma <font color="#808080">// </font><font color="#FF0000">11</font><font color="#808080">))

</font><font color="#000080"><b>if </b></font>nsoma <font color="#808080">&gt; </font><font color="#FF0000">9 </font><font color="#000080"><b>then
  </b></font>nmodulo11<font color="#808080">=</font><font color="#FF0000">0
</font><font color="#000080"><b>else
  </b></font>nmodulo11<font color="#808080">=</font>nsoma

<font color="#000080"><b>return </b></font>nmodulo11
<font color="#008000"><i>/*------------------------------------------------------------------------------
Valida&ccedil;&atilde;o de um n&uacute;mero de CPF qualquer.
cpf - a mstring com o n&uacute;mero do CPF
retorna - se &eacute; valido ou n&atilde;o
------------------------------------------------------------------------------*/
</i></font>validaCPF<font color="#808080">: </font><font color="#000080"><b>procedure
  parse arg </b></font>cpf

<font color="#000080"><b>call </b></font>constantes
scpf <font color="#808080">= ''; </font>sres <font color="#808080">= ''
</font>nvalor1 <font color="#808080">= </font><font color="#FF0000">0</font><font color="#808080">; </font>nvalor2 <font color="#808080">= </font><font color="#FF0000">0
</font>bvalidaCPF<font color="#808080">=</font>false

<font color="#000080"><b>if </b></font><font color="#0000FF"><b>length</b></font><font color="#808080">(</font>cpf<font color="#808080">)=</font><font color="#FF0000">14 </font><font color="#000080"><b>then do
  </b></font>scpf<font color="#808080">=</font><font color="#808000"><b>substr</b></font><font color="#808080">(</font>cpf<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#FF0000">3</font><font color="#808080">) || </font><font color="#808000"><b>substr</b></font><font color="#808080">(</font>cpf<font color="#808080">,</font><font color="#FF0000">5</font><font color="#808080">,</font><font color="#FF0000">3</font><font color="#808080">) || </font><font color="#808000"><b>substr</b></font><font color="#808080">(</font>cpf<font color="#808080">,</font><font color="#FF0000">9</font><font color="#808080">,</font><font color="#FF0000">3</font><font color="#808080">) || </font><font color="#808000"><b>substr</b></font><font color="#808080">(</font>cpf<font color="#808080">,</font><font color="#FF0000">13</font><font color="#808080">,</font><font color="#FF0000">2</font><font color="#808080">)
  </font>sres<font color="#808080">=</font><font color="#808000"><b>substr</b></font><font color="#808080">(</font>cpf<font color="#808080">,</font><font color="#FF0000">13</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">)
  </font>nvalor1 <font color="#808080">= </font>sres
  sres<font color="#808080">=</font><font color="#808000"><b>substr</b></font><font color="#808080">(</font>cpf<font color="#808080">,</font><font color="#FF0000">14</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">)
  </font>nvalor2 <font color="#808080">= </font>sres
  <font color="#000080"><b>if </b></font><font color="#808080">((</font>modulo11<font color="#808080">(</font>scpf<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">)=</font>nvalor1<font color="#808080">) &amp; (</font>modulo11<font color="#808080">(</font>scpf<font color="#808080">,</font><font color="#FF0000">2</font><font color="#808080">)=</font>nvalor2<font color="#808080">)) </font><font color="#000080"><b>then
    </b></font>bvalidaCPF<font color="#808080">=</font>true
  <font color="#000080"><b>else
    </b></font>bvalidaCPF<font color="#808080">=</font>false
<font color="#000080"><b>end 
else do
  </b></font>bvalidaCPF<font color="#808080">=</font>false
<font color="#000080"><b>end
return </b></font>bvalidaCPF
<font color="#008000"><i>/*------------------------------------------------------------------------------
Valida&ccedil;&atilde;o de um n&uacute;mero ISBN qualquer.
isbn - a mstring com o n&uacute;mero do ISBN
retorna - se &eacute; valido ou n&atilde;o
------------------------------------------------------------------------------*/
</i></font>validaISBN<font color="#808080">: </font><font color="#000080"><b>procedure
  parse arg </b></font>isbn

<font color="#000080"><b>call </b></font>constantes
sisbn <font color="#808080">= ''; </font>snum <font color="#808080">= ''; </font>sdigito <font color="#808080">= ''; </font>bvalidaISBN <font color="#808080">= </font>false
ncont <font color="#808080">= </font><font color="#FF0000">0</font><font color="#808080">; </font>nsoma <font color="#808080">= </font><font color="#FF0000">0</font><font color="#808080">; </font>nvalor <font color="#808080">= </font><font color="#FF0000">0</font><font color="#808080">;

</font><font color="#000080"><b>if </b></font><font color="#0000FF"><b>length</b></font><font color="#808080">(</font>isbn<font color="#808080">)=</font><font color="#FF0000">13 </font><font color="#000080"><b>then do
  </b></font>sdigito<font color="#808080">=</font><font color="#808000"><b>substr</b></font><font color="#808080">(</font>isbn<font color="#808080">, </font><font color="#0000FF"><b>length</b></font><font color="#808080">(</font>isbn<font color="#808080">), </font><font color="#FF0000">1</font><font color="#808080">)
  </font>sisbn<font color="#808080">=''
  </font><font color="#000080"><b>do </b></font>cont<font color="#808080">=</font><font color="#FF0000">1 </font><font color="#000080"><b>to </b></font><font color="#0000FF"><b>length</b></font><font color="#808080">(</font>isbn<font color="#808080">)-</font><font color="#FF0000">1
    </font><font color="#000080"><b>if </b></font><font color="#808000"><b>substr</b></font><font color="#808080">(</font>isbn<font color="#808080">,</font>cont<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">)&lt;&gt;'-' </font><font color="#000080"><b>then
      </b></font>sisbn <font color="#808080">= </font>sisbn <font color="#808080">|| </font><font color="#808000"><b>substr</b></font><font color="#808080">(</font>isbn<font color="#808080">,</font>cont<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">)
  </font><font color="#000080"><b>end
  if </b></font>sdigito <font color="#808080">= '</font>X<font color="#808080">' </font><font color="#000080"><b>then
    </b></font>nsoma <font color="#808080">= </font><font color="#FF0000">10
  </font><font color="#000080"><b>else do
    </b></font>nvalor <font color="#808080">= </font>sdigito
    nsoma <font color="#808080">= </font>nvalor
  <font color="#000080"><b>end
  do </b></font>ncont<font color="#808080">=</font><font color="#FF0000">1 </font><font color="#000080"><b>to </b></font><font color="#FF0000">9
    </font>snum <font color="#808080">= </font><font color="#808000"><b>substr</b></font><font color="#808080">(</font>sisbn<font color="#808080">, </font>ncont<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">)
    </font>nvalor <font color="#808080">= </font>snum
    nsoma <font color="#808080">= </font>nsoma <font color="#808080">+ (</font>nvalor <font color="#808080">* (</font><font color="#FF0000">11 </font><font color="#808080">- </font>ncont<font color="#808080">))
  </font><font color="#000080"><b>end
  if </b></font><font color="#808080">(</font>nsoma <font color="#808080">// </font><font color="#FF0000">11</font><font color="#808080">) = </font><font color="#FF0000">0 </font><font color="#000080"><b>then
    </b></font>bvalidaISBN<font color="#808080">=</font>true
  <font color="#000080"><b>else
    </b></font>bvalidaISBN<font color="#808080">=</font>false
<font color="#000080"><b>end 
else do
  </b></font>bvalidaISBN<font color="#808080">=</font>false
<font color="#000080"><b>end
return </b></font>bvalidaISBN
<font color="#008000"><i>/*------------------------------------------------------------------------------
Esconde a digita&ccedil;&atilde;o da senha
retorna - a senha digitada
------------------------------------------------------------------------------*/
</i></font>digitaSenha<font color="#808080">: </font><font color="#000080"><b>procedure 
  parse arg </b></font>sRotulo<font color="#808080">, </font>nTamSenha

<font color="#000080"><b>call </b></font><font color="#0000FF"><b>charout </b></font><font color="#808080">,</font>sRotulo
sSenha <font color="#808080">= </font><font color="#0000FF"><b>linein</b></font><font color="#808080">()
</font><font color="#008000"><i>/*  ncont = 0
  sSenha=''
  sLetra='\0'
  do while (sLetra&lt;&gt;'\r') &amp; (ncont &lt; nTamSenha)
    sLetra=readkey
    sSenha=sSenha || sLetra
    ncont=ncont+1
  end */
</i></font><font color="#000080"><b>return </b></font>sSenha

<font color="#008000"><i>/*------------------------------------------------------------------------------
Valida&ccedil;&atilde;o de um n&uacute;mero qualquer.
sRotulo - o texto antes de se digitar o n&uacute;mero
sNumero - a mstring com o valor do n&uacute;mero
retorna - o sNumero
------------------------------------------------------------------------------*/
</i></font>validaNumero<font color="#808080">: </font><font color="#000080"><b>procedure
  parse arg </b></font>sRotulo<font color="#808080">, </font>sNumero

<font color="#000080"><b>call </b></font>constantes
nnum <font color="#808080">= </font><font color="#FF0000">0.0
</font>sNumero <font color="#808080">= ''
</font>nStatus<font color="#808080">=-</font><font color="#FF0000">1
</font><font color="#000080"><b>do </b></font>while nStatus<font color="#808080">&lt;&gt;</font><font color="#FF0000">0
  </font><font color="#000080"><b>call </b></font><font color="#0000FF"><b>charout </b></font><font color="#808080">,</font>sRotulo
  sNumero <font color="#808080">= </font><font color="#0000FF"><b>linein</b></font><font color="#808080">()
  </font><font color="#008000"><i>/* nnum = strtoint(sNumero) */
  </i></font>nnum <font color="#808080">= </font>sNumero
  <font color="#000080"><b>if </b></font><font color="#0000FF"><b>datatype</b></font><font color="#808080">(</font>nnum<font color="#808080">)='</font>NUM<font color="#808080">' </font><font color="#000080"><b>then
    if </b></font>nnum <font color="#808080">&lt; </font><font color="#FF0000">1 </font><font color="#000080"><b>then
      say </b></font>MSG_NUMINV
    <font color="#000080"><b>else
      </b></font>nStatus <font color="#808080">= </font><font color="#FF0000">0
  </font><font color="#000080"><b>else
    say </b></font>MSG_NUMINV
<font color="#000080"><b>end
return </b></font>sNumero
<font color="#008000"><i>/*------------------------------------------------------------------------------
Valida&ccedil;&atilde;o de uma data ou data/hora qualquer.
sRotulo - o texto antes de se digitar a data/hora
sDataHora - a mstring com o valor da data/hora
bSoData - indica se vai validar somente uma data sem a hora
retorna - a sDataHora
------------------------------------------------------------------------------*/
</i></font>validaDataHora<font color="#808080">: </font><font color="#000080"><b>procedure
  parse arg </b></font>sRotulo<font color="#808080">, </font>sDataHora<font color="#808080">, </font>bSoData

<font color="#000080"><b>call </b></font>constantes
sdia <font color="#808080">= ''; </font>smes <font color="#808080">= ''; </font>sano <font color="#808080">= ''; </font>shora <font color="#808080">= ''; </font>smin <font color="#808080">= ''; </font>sseg <font color="#808080">= ''
</font>ndia <font color="#808080">= </font><font color="#FF0000">0</font><font color="#808080">; </font>nmes <font color="#808080">= </font><font color="#FF0000">0</font><font color="#808080">; </font>nano <font color="#808080">= </font><font color="#FF0000">0</font><font color="#808080">; </font>nhora <font color="#808080">= </font><font color="#FF0000">0</font><font color="#808080">; </font>nmin <font color="#808080">= </font><font color="#FF0000">0</font><font color="#808080">; </font>nseg <font color="#808080">= </font><font color="#FF0000">0</font><font color="#808080">; </font>ntam <font color="#808080">= </font><font color="#FF0000">0

</font>bvalida<font color="#808080">=</font>false
bdatavalida<font color="#808080">=</font>false
bhoravalida<font color="#808080">=</font>false
nudiames<font color="#808080">=</font><font color="#FF0000">0

</font><font color="#000080"><b>if </b></font>bSoData<font color="#808080">=</font>true <font color="#000080"><b>then </b></font>ntam<font color="#808080">=</font><font color="#FF0000">10
</font><font color="#000080"><b>else </b></font>ntam<font color="#808080">=</font><font color="#FF0000">19
</font><font color="#000080"><b>do </b></font>while bvalida<font color="#808080">=</font>false
  <font color="#000080"><b>call </b></font><font color="#0000FF"><b>charout </b></font><font color="#808080">,</font>sRotulo
  sDataHora <font color="#808080">= </font><font color="#0000FF"><b>linein</b></font><font color="#808080">()
  </font><font color="#000080"><b>if </b></font><font color="#0000FF"><b>length</b></font><font color="#808080">(</font>sDataHora<font color="#808080">)=</font>ntam <font color="#000080"><b>then do
    </b></font>sdia<font color="#808080">=</font><font color="#808000"><b>substr</b></font><font color="#808080">(</font>sDataHora<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#FF0000">2</font><font color="#808080">)
    </font>ndia<font color="#808080">=</font>sdia
    smes<font color="#808080">=</font><font color="#808000"><b>substr</b></font><font color="#808080">(</font>sDataHora<font color="#808080">,</font><font color="#FF0000">4</font><font color="#808080">,</font><font color="#FF0000">2</font><font color="#808080">)
    </font>nmes<font color="#808080">=</font>smes
    sano<font color="#808080">=</font><font color="#808000"><b>substr</b></font><font color="#808080">(</font>sDataHora<font color="#808080">,</font><font color="#FF0000">7</font><font color="#808080">,</font><font color="#FF0000">4</font><font color="#808080">)
    </font>nano<font color="#808080">=</font>sano
  
    <font color="#000080"><b>if </b></font><font color="#808080">(</font>nano <font color="#808080">&gt;= </font><font color="#FF0000">1</font><font color="#808080">) &amp; (</font>nano <font color="#808080">&lt;= </font><font color="#FF0000">9999</font><font color="#808080">) </font><font color="#000080"><b>then do
      if </b></font><font color="#808080">(</font>nmes <font color="#808080">&gt;= </font><font color="#FF0000">1</font><font color="#808080">) &amp; (</font>nmes <font color="#808080">&lt;= </font><font color="#FF0000">31</font><font color="#808080">) </font><font color="#000080"><b>then do
          select
            when </b></font>nmes<font color="#808080">=</font><font color="#FF0000">1 </font><font color="#808080">| </font>nmes<font color="#808080">=</font><font color="#FF0000">3 </font><font color="#808080">| </font>nmes<font color="#808080">=</font><font color="#FF0000">5 </font><font color="#808080">| </font>nmes<font color="#808080">=</font><font color="#FF0000">7 </font><font color="#808080">| </font>nmes<font color="#808080">=</font><font color="#FF0000">8 </font><font color="#000080"><b>then </b></font>nudiames<font color="#808080">=</font><font color="#FF0000">31
            </font><font color="#000080"><b>when </b></font>nmes<font color="#808080">=</font><font color="#FF0000">10 </font><font color="#808080">| </font>nmes<font color="#808080">=</font><font color="#FF0000">12 </font><font color="#000080"><b>then </b></font>nudiames<font color="#808080">=</font><font color="#FF0000">31
            </font><font color="#000080"><b>when </b></font>nmes<font color="#808080">=</font><font color="#FF0000">2 </font><font color="#000080"><b>then do
                </b></font><font color="#008000"><i>/* ano bissexto */
                </i></font><font color="#000080"><b>if </b></font><font color="#808080">(</font>nano <font color="#808080">// </font><font color="#FF0000">4</font><font color="#808080">)=</font><font color="#FF0000">0 </font><font color="#000080"><b>then </b></font>nudiames<font color="#808080">=</font><font color="#FF0000">29
                </font><font color="#000080"><b>else </b></font>nudiames<font color="#808080">=</font><font color="#FF0000">28
            </font><font color="#000080"><b>end
            when </b></font>nmes<font color="#808080">=</font><font color="#FF0000">4 </font><font color="#808080">| </font>nmes<font color="#808080">=</font><font color="#FF0000">6 </font><font color="#808080">| </font>nmes<font color="#808080">=</font><font color="#FF0000">9 </font><font color="#808080">| </font>nmes<font color="#808080">=</font><font color="#FF0000">11 </font><font color="#000080"><b>then </b></font>nudiames<font color="#808080">=</font><font color="#FF0000">30
          </font><font color="#000080"><b>end
          if </b></font><font color="#808080">(</font>ndia <font color="#808080">&gt;=</font><font color="#FF0000">1</font><font color="#808080">) &amp; (</font>ndia <font color="#808080">&lt;=</font>nudiames<font color="#808080">) </font><font color="#000080"><b>then
             </b></font>bdatavalida<font color="#808080">=</font>true
      <font color="#000080"><b>end
    end
  
    if </b></font>bSoData<font color="#808080">=</font>true <font color="#000080"><b>then do
       if </b></font>bdatavalida<font color="#808080">=</font>true <font color="#000080"><b>then </b></font>bvalida<font color="#808080">=</font>true
       <font color="#000080"><b>else say </b></font>MSG_DATAINV
    <font color="#000080"><b>end 
    else do
      if </b></font>bdatavalida <font color="#000080"><b>then do
          </b></font>shora<font color="#808080">=</font><font color="#808000"><b>substr</b></font><font color="#808080">(</font>sDataHora<font color="#808080">,</font><font color="#FF0000">12</font><font color="#808080">,</font><font color="#FF0000">2</font><font color="#808080">)
          </font>nhora<font color="#808080">=</font>shora
          smin<font color="#808080">=</font><font color="#808000"><b>substr</b></font><font color="#808080">(</font>sDataHora<font color="#808080">,</font><font color="#FF0000">15</font><font color="#808080">,</font><font color="#FF0000">2</font><font color="#808080">)
          </font>nmin<font color="#808080">=</font>smin
          sseg<font color="#808080">=</font><font color="#808000"><b>substr</b></font><font color="#808080">(</font>sDataHora<font color="#808080">,</font><font color="#FF0000">18</font><font color="#808080">,</font><font color="#FF0000">2</font><font color="#808080">)
          </font>nseg<font color="#808080">=</font>sseg
     
          <font color="#000080"><b>if </b></font><font color="#808080">(</font>nhora <font color="#808080">&gt;= </font><font color="#FF0000">0</font><font color="#808080">) &amp; (</font>nhora <font color="#808080">&lt;= </font><font color="#FF0000">23</font><font color="#808080">) </font><font color="#000080"><b>then do
            if </b></font><font color="#808080">(</font>nmin <font color="#808080">&gt;= </font><font color="#FF0000">0</font><font color="#808080">) &amp; (</font>nmin <font color="#808080">&lt;= </font><font color="#FF0000">59</font><font color="#808080">) </font><font color="#000080"><b>then do
              if </b></font><font color="#808080">(</font>nseg <font color="#808080">&gt;= </font><font color="#FF0000">0</font><font color="#808080">) &amp; (</font>nseg <font color="#808080">&lt;= </font><font color="#FF0000">59</font><font color="#808080">) </font><font color="#000080"><b>then
                 </b></font>bhoravalida<font color="#808080">=</font>true
            <font color="#000080"><b>end
          end
  
          if </b></font>bhoravalida<font color="#808080">=</font>true <font color="#000080"><b>then </b></font>bvalida<font color="#808080">=</font>true
          <font color="#000080"><b>else say </b></font>MSG_DTHRINV
      <font color="#000080"><b>end 
      else do
        say </b></font>MSG_DTHRINV
      <font color="#000080"><b>end
    end
  end 
  else do
    if </b></font>bSoData<font color="#808080">=</font>true <font color="#000080"><b>then say </b></font>MSG_DATAINV
    <font color="#000080"><b>else say </b></font>MSG_DTHRINV
  <font color="#000080"><b>end
end
return </b></font>sDataHora
<font color="#008000"><i>/*------------------------------------------------------------------------------
Retorna a Data e a hora do sistema.
retorna - a data e a hora
------------------------------------------------------------------------------*/
</i></font>retDataHora<font color="#808080">: </font><font color="#000080"><b>procedure
  </b></font>sdia <font color="#808080">= </font><font color="#808000"><b>substr</b></font><font color="#808080">(</font><font color="#0000FF"><b>date</b></font><font color="#808080">('</font>S<font color="#808080">'),</font><font color="#FF0000">7</font><font color="#808080">,</font><font color="#FF0000">2</font><font color="#808080">) 
  </font>smes <font color="#808080">= </font><font color="#808000"><b>substr</b></font><font color="#808080">(</font><font color="#0000FF"><b>date</b></font><font color="#808080">('</font>S<font color="#808080">'),</font><font color="#FF0000">5</font><font color="#808080">,</font><font color="#FF0000">2</font><font color="#808080">) 
  </font>sano <font color="#808080">= </font><font color="#808000"><b>substr</b></font><font color="#808080">(</font><font color="#0000FF"><b>date</b></font><font color="#808080">('</font>S<font color="#808080">'),</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#FF0000">4</font><font color="#808080">)
  </font>sdata <font color="#808080">= </font>sdia<font color="#808080">'/'</font>smes<font color="#808080">'/'</font>sano
  stempo <font color="#808080">= </font>sdata <font color="#808000"><b>time</b></font><font color="#808080">('</font>N<font color="#808080">')
</font><font color="#000080"><b>return </b></font>stempo

<font color="#008000"><i>/*--- Rotinas de manipula&ccedil;&atilde;o de arquivos --------------------------------------*/

/*------------------------------------------------------------------------------
Verifica se chegou ao fim do arquivo.
sArq - o arquivo
retorna - se chegou ao fim do arquivo
------------------------------------------------------------------------------*/
</i></font>fimArq<font color="#808080">: </font><font color="#000080"><b>procedure
  parse arg </b></font>sArq

<font color="#000080"><b>call </b></font>constantes
npos <font color="#808080">= </font><font color="#808000"><b>stream</b></font><font color="#808080">(</font>sArq<font color="#808080">,'</font>C<font color="#808080">','</font>QUERY <font color="#808000"><b>SEEK </b></font>READ CHAR<font color="#808080">')
</font>ntam <font color="#808080">= </font><font color="#808000"><b>stream</b></font><font color="#808080">(</font>sArq<font color="#808080">,'</font>C<font color="#808080">','</font>QUERY <font color="#808000"><b>SIZE</b></font><font color="#808080">')
</font><font color="#000080"><b>if </b></font>npos <font color="#808080">= (</font>ntam<font color="#808080">+</font><font color="#FF0000">1</font><font color="#808080">) </font><font color="#000080"><b>then
  </b></font>bret <font color="#808080">= </font>true
<font color="#000080"><b>else
  </b></font>bret <font color="#808080">= </font>false
<font color="#000080"><b>return </b></font>bret
<font color="#008000"><i>/*------------------------------------------------------------------------------
Calcula o tamanho do arquivo.
sArq - o arquivo
retorna - o tamanho do arquivo
------------------------------------------------------------------------------*/
</i></font>tamArq<font color="#808080">: </font><font color="#000080"><b>procedure
  parse arg </b></font>sArq

  nret <font color="#808080">= </font><font color="#808000"><b>stream</b></font><font color="#808080">(</font>sArq<font color="#808080">,'</font>C<font color="#808080">','</font>QUERY <font color="#808000"><b>SIZE</b></font><font color="#808080">')
</font><font color="#000080"><b>return </b></font>nret

<font color="#008000"><i>/*------------------------------------------------------------------------------
Abre ou cria os arquivos do sistema.
bAbre - condi&ccedil;&atilde;o para abrir ou criar os arquivos do sistema
------------------------------------------------------------------------------*/
</i></font>abrecriaArqs<font color="#808080">: </font><font color="#000080"><b>procedure
  parse arg </b></font>bAbre

<font color="#000080"><b>call </b></font>constantes
<font color="#000080"><b>if </b></font>bAbre <font color="#000080"><b>then do
  if </b></font><font color="#808000"><b>stream</b></font><font color="#808080">(</font>ARQ_ASSUNTO<font color="#808080">, '</font>C<font color="#808080">', '</font>QUERY <font color="#808000"><b>EXISTS</b></font><font color="#808080">')&lt;&gt;'' </font><font color="#000080"><b>then
    call </b></font><font color="#808000"><b>stream </b></font>ARQ_ASSUNTO<font color="#808080">,'</font>C<font color="#808080">','</font><font color="#808000"><b>OPEN </b></font>BOTH<font color="#808080">'
  </font><font color="#000080"><b>else
    say </b></font>MSG_ARQERRO<font color="#808080">' --&gt; '</font>ARQ_ASSUNTO
  <font color="#000080"><b>if </b></font><font color="#808000"><b>stream</b></font><font color="#808080">(</font>ARQ_AUTOR<font color="#808080">, '</font>C<font color="#808080">', '</font>QUERY <font color="#808000"><b>EXISTS</b></font><font color="#808080">')&lt;&gt;'' </font><font color="#000080"><b>then
    call </b></font><font color="#808000"><b>stream </b></font>ARQ_AUTOR<font color="#808080">,'</font>C<font color="#808080">','</font><font color="#808000"><b>OPEN </b></font>BOTH<font color="#808080">'
  </font><font color="#000080"><b>else
    say </b></font>MSG_ARQERRO<font color="#808080">' --&gt; '</font>ARQ_AUTOR
  <font color="#000080"><b>if </b></font><font color="#808000"><b>stream</b></font><font color="#808080">(</font>ARQ_EDITORA<font color="#808080">, '</font>C<font color="#808080">', '</font>QUERY <font color="#808000"><b>EXISTS</b></font><font color="#808080">')&lt;&gt;'' </font><font color="#000080"><b>then
    call </b></font><font color="#808000"><b>stream </b></font>ARQ_EDITORA<font color="#808080">,'</font>C<font color="#808080">','</font><font color="#808000"><b>OPEN </b></font>BOTH<font color="#808080">'
  </font><font color="#000080"><b>else
    say </b></font>MSG_ARQERRO<font color="#808080">' --&gt; '</font>ARQ_EDITORA
  <font color="#000080"><b>if </b></font><font color="#808000"><b>stream</b></font><font color="#808080">(</font>ARQ_IDIOMA<font color="#808080">, '</font>C<font color="#808080">', '</font>QUERY <font color="#808000"><b>EXISTS</b></font><font color="#808080">')&lt;&gt;'' </font><font color="#000080"><b>then
    call </b></font><font color="#808000"><b>stream </b></font>ARQ_IDIOMA<font color="#808080">,'</font>C<font color="#808080">','</font><font color="#808000"><b>OPEN </b></font>BOTH<font color="#808080">'
  </font><font color="#000080"><b>else
    say </b></font>MSG_ARQERRO<font color="#808080">' --&gt; '</font>ARQ_IDIOMA
  <font color="#000080"><b>if </b></font><font color="#808000"><b>stream</b></font><font color="#808080">(</font>ARQ_ENDERECO<font color="#808080">, '</font>C<font color="#808080">', '</font>QUERY <font color="#808000"><b>EXISTS</b></font><font color="#808080">')&lt;&gt;'' </font><font color="#000080"><b>then
    call </b></font><font color="#808000"><b>stream </b></font>ARQ_ENDERECO<font color="#808080">,'</font>C<font color="#808080">','</font><font color="#808000"><b>OPEN </b></font>BOTH<font color="#808080">'
  </font><font color="#000080"><b>else
    say </b></font>MSG_ARQERRO<font color="#808080">' --&gt; '</font>ARQ_ENDERECO
  <font color="#000080"><b>if </b></font><font color="#808000"><b>stream</b></font><font color="#808080">(</font>ARQ_PAIS<font color="#808080">, '</font>C<font color="#808080">', '</font>QUERY <font color="#808000"><b>EXISTS</b></font><font color="#808080">')&lt;&gt;'' </font><font color="#000080"><b>then
    call </b></font><font color="#808000"><b>stream </b></font>ARQ_PAIS<font color="#808080">,'</font>C<font color="#808080">','</font><font color="#808000"><b>OPEN </b></font>BOTH<font color="#808080">'
  </font><font color="#000080"><b>else
    say </b></font>MSG_ARQERRO<font color="#808080">' --&gt; '</font>ARQ_PAIS
  <font color="#000080"><b>if </b></font><font color="#808000"><b>stream</b></font><font color="#808080">(</font>ARQ_PROFISSAO<font color="#808080">, '</font>C<font color="#808080">', '</font>QUERY <font color="#808000"><b>EXISTS</b></font><font color="#808080">')&lt;&gt;'' </font><font color="#000080"><b>then
    call </b></font><font color="#808000"><b>stream </b></font>ARQ_PROFISSAO<font color="#808080">,'</font>C<font color="#808080">','</font><font color="#808000"><b>OPEN </b></font>BOTH<font color="#808080">'
  </font><font color="#000080"><b>else
    say </b></font>MSG_ARQERRO<font color="#808080">' --&gt; '</font>ARQ_PROFISSAO
  <font color="#000080"><b>if </b></font><font color="#808000"><b>stream</b></font><font color="#808080">(</font>ARQ_LIVRO<font color="#808080">, '</font>C<font color="#808080">', '</font>QUERY <font color="#808000"><b>EXISTS</b></font><font color="#808080">')&lt;&gt;'' </font><font color="#000080"><b>then
    call </b></font><font color="#808000"><b>stream </b></font>ARQ_LIVRO<font color="#808080">,'</font>C<font color="#808080">','</font><font color="#808000"><b>OPEN </b></font>BOTH<font color="#808080">'
  </font><font color="#000080"><b>else
    say </b></font>MSG_ARQERRO<font color="#808080">' --&gt; '</font>ARQ_LIVRO
  <font color="#000080"><b>if </b></font><font color="#808000"><b>stream</b></font><font color="#808080">(</font>ARQ_LIVASS<font color="#808080">, '</font>C<font color="#808080">', '</font>QUERY <font color="#808000"><b>EXISTS</b></font><font color="#808080">')&lt;&gt;'' </font><font color="#000080"><b>then
    call </b></font><font color="#808000"><b>stream </b></font>ARQ_LIVASS<font color="#808080">,'</font>C<font color="#808080">','</font><font color="#808000"><b>OPEN </b></font>BOTH<font color="#808080">'
  </font><font color="#000080"><b>else
    say </b></font>MSG_ARQERRO<font color="#808080">' --&gt; '</font>ARQ_LIVASS
  <font color="#000080"><b>if </b></font><font color="#808000"><b>stream</b></font><font color="#808080">(</font>ARQ_LIVAUT<font color="#808080">, '</font>C<font color="#808080">', '</font>QUERY <font color="#808000"><b>EXISTS</b></font><font color="#808080">')&lt;&gt;'' </font><font color="#000080"><b>then
    call </b></font><font color="#808000"><b>stream </b></font>ARQ_LIVAUT<font color="#808080">,'</font>C<font color="#808080">','</font><font color="#808000"><b>OPEN </b></font>BOTH<font color="#808080">'
  </font><font color="#000080"><b>else
    say </b></font>MSG_ARQERRO<font color="#808080">' --&gt; '</font>ARQ_LIVAUT
  <font color="#000080"><b>if </b></font><font color="#808000"><b>stream</b></font><font color="#808080">(</font>ARQ_CLIENTE<font color="#808080">, '</font>C<font color="#808080">', '</font>QUERY <font color="#808000"><b>EXISTS</b></font><font color="#808080">')&lt;&gt;'' </font><font color="#000080"><b>then
    call </b></font><font color="#808000"><b>stream </b></font>ARQ_CLIENTE<font color="#808080">,'</font>C<font color="#808080">','</font><font color="#808000"><b>OPEN </b></font>BOTH<font color="#808080">'
  </font><font color="#000080"><b>else
    say </b></font>MSG_ARQERRO<font color="#808080">' --&gt; '</font>ARQ_CLIENTE
  <font color="#000080"><b>if </b></font><font color="#808000"><b>stream</b></font><font color="#808080">(</font>ARQ_USUARIO<font color="#808080">, '</font>C<font color="#808080">', '</font>QUERY <font color="#808000"><b>EXISTS</b></font><font color="#808080">')&lt;&gt;'' </font><font color="#000080"><b>then
    call </b></font><font color="#808000"><b>stream </b></font>ARQ_USUARIO<font color="#808080">,'</font>C<font color="#808080">','</font><font color="#808000"><b>OPEN </b></font>BOTH<font color="#808080">'
  </font><font color="#000080"><b>else
    say </b></font>MSG_ARQERRO<font color="#808080">' --&gt; '</font>ARQ_USUARIO
  <font color="#000080"><b>if </b></font><font color="#808000"><b>stream</b></font><font color="#808080">(</font>ARQ_VENDA<font color="#808080">, '</font>C<font color="#808080">', '</font>QUERY <font color="#808000"><b>EXISTS</b></font><font color="#808080">')&lt;&gt;'' </font><font color="#000080"><b>then
    call </b></font><font color="#808000"><b>stream </b></font>ARQ_VENDA<font color="#808080">,'</font>C<font color="#808080">','</font><font color="#808000"><b>OPEN </b></font>BOTH<font color="#808080">'
  </font><font color="#000080"><b>else
    say </b></font>MSG_ARQERRO<font color="#808080">' --&gt; '</font>ARQ_VENDA
<font color="#000080"><b>end 
else do
  call </b></font><font color="#808000"><b>stream </b></font>ARQ_ASSUNTO<font color="#808080">,'</font>C<font color="#808080">','</font><font color="#808000"><b>OPEN </b></font>WRITE REPLACE<font color="#808080">'
  </font><font color="#000080"><b>call </b></font><font color="#808000"><b>stream </b></font>ARQ_AUTOR<font color="#808080">,'</font>C<font color="#808080">','</font><font color="#808000"><b>OPEN </b></font>WRITE REPLACE<font color="#808080">'
  </font><font color="#000080"><b>call </b></font><font color="#808000"><b>stream </b></font>ARQ_EDITORA<font color="#808080">,'</font>C<font color="#808080">','</font><font color="#808000"><b>OPEN </b></font>WRITE REPLACE<font color="#808080">'
  </font><font color="#000080"><b>call </b></font><font color="#808000"><b>stream </b></font>ARQ_IDIOMA<font color="#808080">,'</font>C<font color="#808080">','</font><font color="#808000"><b>OPEN </b></font>WRITE REPLACE<font color="#808080">'
  </font><font color="#000080"><b>call </b></font><font color="#808000"><b>stream </b></font>ARQ_ENDERECO<font color="#808080">,'</font>C<font color="#808080">','</font><font color="#808000"><b>OPEN </b></font>WRITE REPLACE<font color="#808080">'
  </font><font color="#000080"><b>call </b></font><font color="#808000"><b>stream </b></font>ARQ_PAIS<font color="#808080">,'</font>C<font color="#808080">','</font><font color="#808000"><b>OPEN </b></font>WRITE REPLACE<font color="#808080">'
  </font><font color="#000080"><b>call </b></font><font color="#808000"><b>stream </b></font>ARQ_PROFISSAO<font color="#808080">,'</font>C<font color="#808080">','</font><font color="#808000"><b>OPEN </b></font>WRITE REPLACE<font color="#808080">'
  </font><font color="#000080"><b>call </b></font><font color="#808000"><b>stream </b></font>ARQ_LIVRO<font color="#808080">,'</font>C<font color="#808080">','</font><font color="#808000"><b>OPEN </b></font>WRITE REPLACE<font color="#808080">'
  </font><font color="#000080"><b>call </b></font><font color="#808000"><b>stream </b></font>ARQ_LIVASS<font color="#808080">,'</font>C<font color="#808080">','</font><font color="#808000"><b>OPEN </b></font>WRITE REPLACE<font color="#808080">'
  </font><font color="#000080"><b>call </b></font><font color="#808000"><b>stream </b></font>ARQ_LIVAUT<font color="#808080">,'</font>C<font color="#808080">','</font><font color="#808000"><b>OPEN </b></font>WRITE REPLACE<font color="#808080">'
  </font><font color="#000080"><b>call </b></font><font color="#808000"><b>stream </b></font>ARQ_CLIENTE<font color="#808080">,'</font>C<font color="#808080">','</font><font color="#808000"><b>OPEN </b></font>WRITE REPLACE<font color="#808080">'
  </font><font color="#000080"><b>call </b></font><font color="#808000"><b>stream </b></font>ARQ_USUARIO<font color="#808080">,'</font>C<font color="#808080">','</font><font color="#808000"><b>OPEN </b></font>WRITE REPLACE<font color="#808080">'
  </font><font color="#000080"><b>call </b></font><font color="#808000"><b>stream </b></font>ARQ_VENDA<font color="#808080">,'</font>C<font color="#808080">','</font><font color="#808000"><b>OPEN </b></font>WRITE REPLACE<font color="#808080">'
</font><font color="#000080"><b>end
return
</b></font><font color="#008000"><i>/*------------------------------------------------------------------------------
Fecha todos os arquivos abertos.
------------------------------------------------------------------------------*/
</i></font>fechaArqs <font color="#808080">: </font><font color="#000080"><b>procedure
 call </b></font>constantes
 <font color="#000080"><b>call </b></font><font color="#808000"><b>stream </b></font>ARQ_ASSUNTO<font color="#808080">,'</font>C<font color="#808080">','</font><font color="#808000"><b>CLOSE</b></font><font color="#808080">'
 </font><font color="#000080"><b>call </b></font><font color="#808000"><b>stream </b></font>ARQ_AUTOR<font color="#808080">,'</font>C<font color="#808080">','</font><font color="#808000"><b>CLOSE</b></font><font color="#808080">'
 </font><font color="#000080"><b>call </b></font><font color="#808000"><b>stream </b></font>ARQ_EDITORA<font color="#808080">,'</font>C<font color="#808080">','</font><font color="#808000"><b>CLOSE</b></font><font color="#808080">'
 </font><font color="#000080"><b>call </b></font><font color="#808000"><b>stream </b></font>ARQ_IDIOMA<font color="#808080">,'</font>C<font color="#808080">','</font><font color="#808000"><b>CLOSE</b></font><font color="#808080">'
 </font><font color="#000080"><b>call </b></font><font color="#808000"><b>stream </b></font>ARQ_ENDERECO<font color="#808080">,'</font>C<font color="#808080">','</font><font color="#808000"><b>CLOSE</b></font><font color="#808080">'
 </font><font color="#000080"><b>call </b></font><font color="#808000"><b>stream </b></font>ARQ_PAIS<font color="#808080">,'</font>C<font color="#808080">','</font><font color="#808000"><b>CLOSE</b></font><font color="#808080">'
 </font><font color="#000080"><b>call </b></font><font color="#808000"><b>stream </b></font>ARQ_PROFISSAO<font color="#808080">,'</font>C<font color="#808080">','</font><font color="#808000"><b>CLOSE</b></font><font color="#808080">'
 </font><font color="#000080"><b>call </b></font><font color="#808000"><b>stream </b></font>ARQ_LIVRO<font color="#808080">,'</font>C<font color="#808080">','</font><font color="#808000"><b>CLOSE</b></font><font color="#808080">'
 </font><font color="#000080"><b>call </b></font><font color="#808000"><b>stream </b></font>ARQ_LIVASS<font color="#808080">,'</font>C<font color="#808080">','</font><font color="#808000"><b>CLOSE</b></font><font color="#808080">'
 </font><font color="#000080"><b>call </b></font><font color="#808000"><b>stream </b></font>ARQ_LIVAUT<font color="#808080">,'</font>C<font color="#808080">','</font><font color="#808000"><b>CLOSE</b></font><font color="#808080">'
 </font><font color="#000080"><b>call </b></font><font color="#808000"><b>stream </b></font>ARQ_CLIENTE<font color="#808080">,'</font>C<font color="#808080">','</font><font color="#808000"><b>CLOSE</b></font><font color="#808080">'
 </font><font color="#000080"><b>call </b></font><font color="#808000"><b>stream </b></font>ARQ_USUARIO<font color="#808080">,'</font>C<font color="#808080">','</font><font color="#808000"><b>CLOSE</b></font><font color="#808080">'
 </font><font color="#000080"><b>call </b></font><font color="#808000"><b>stream </b></font>ARQ_VENDA<font color="#808080">,'</font>C<font color="#808080">','</font><font color="#808000"><b>CLOSE</b></font><font color="#808080">'
</font><font color="#000080"><b>return
</b></font><font color="#008000"><i>/*------------------------------------------------------------------------------
Pesquisa um registro atrav&eacute;s de um valor chave num arquivo.
sArq - o arquivo
sChave - a chave a ser pesquisada
nPosChave - a posicao inicial da chave dentro do registro
nTamChave - o tamanho da chave dentro do registro
nTamLinha - o tamanho do registro
retorna - o registro pesquisado
------------------------------------------------------------------------------*/
</i></font>pesqArq<font color="#808080">: </font><font color="#000080"><b>procedure
  parse arg </b></font>sArq<font color="#808080">, </font>sChave<font color="#808080">, </font>nPosChave<font color="#808080">, </font>nTamChave<font color="#808080">, </font>nTamLinha

<font color="#000080"><b>call </b></font>constantes
slinha <font color="#808080">= ''; </font>sres <font color="#808080">= ''; </font>sret <font color="#808080">= ''
</font>nPosicao <font color="#808080">= </font><font color="#FF0000">0
</font>bQuebra<font color="#808080">=</font>false
<font color="#000080"><b>call </b></font><font color="#808000"><b>stream </b></font>sArq<font color="#808080">, '</font>C<font color="#808080">', '</font><font color="#808000"><b>SEEK </b></font><font color="#808080">=</font><font color="#FF0000">0 </font>READ <font color="#0000FF"><b>LINE</b></font><font color="#808080">'
</font><font color="#000080"><b>do </b></font>while <font color="#808080">(</font>fimArq<font color="#808080">(</font>sArq<font color="#808080">)=</font>false<font color="#808080">) &amp; (</font>bQuebra<font color="#808080">=</font>false<font color="#808080">)
  </font>slinha <font color="#808080">= </font><font color="#0000FF"><b>linein</b></font><font color="#808080">(</font>sArq<font color="#808080">)
  </font>sres<font color="#808080">=</font><font color="#808000"><b>strip</b></font><font color="#808080">(</font><font color="#808000"><b>substr</b></font><font color="#808080">(</font>slinha<font color="#808080">,</font>nPosChave<font color="#808080">,</font>nTamChave<font color="#808080">))
  </font><font color="#000080"><b>if </b></font>sres<font color="#808080">=</font>sChave <font color="#000080"><b>then
     </b></font>bQuebra<font color="#808080">=</font>true
<font color="#000080"><b>end
</b></font>nPosicao <font color="#808080">= </font><font color="#808000"><b>stream</b></font><font color="#808080">(</font>sArq<font color="#808080">,'</font>C<font color="#808080">','</font>QUERY <font color="#808000"><b>SEEK </b></font>READ<font color="#808080">')
</font><font color="#000080"><b>if </b></font>nPosicao<font color="#808080">&lt;&gt;'' </font><font color="#000080"><b>then
  </b></font>nPosicao<font color="#808080">=</font>nPosicao<font color="#808080">-(</font>nTamLinha <font color="#808080">+ </font>TAM_CRLF<font color="#808080">)
</font><font color="#000080"><b>else
  </b></font>nPosicao <font color="#808080">= </font><font color="#FF0000">0 
</font><font color="#000080"><b>if </b></font>nPosicao <font color="#808080">&gt; </font><font color="#FF0000">0 </font><font color="#000080"><b>then
  call </b></font><font color="#808000"><b>stream </b></font>sArq<font color="#808080">, '</font>C<font color="#808080">', '</font><font color="#808000"><b>SEEK </b></font><font color="#808080">=' || </font>nPosicao <font color="#808080">|| ' </font>READ <font color="#0000FF"><b>LINE</b></font><font color="#808080">'
</font><font color="#000080"><b>else
  call </b></font><font color="#808000"><b>stream </b></font>sArq<font color="#808080">, '</font>C<font color="#808080">', '</font><font color="#808000"><b>SEEK </b></font><font color="#808080">=</font><font color="#FF0000">0 </font>READ <font color="#0000FF"><b>LINE</b></font><font color="#808080">'
</font><font color="#000080"><b>if </b></font>sres<font color="#808080">&lt;&gt;</font>sChave <font color="#000080"><b>then
   </b></font>sret<font color="#808080">=''
</font><font color="#000080"><b>else
   </b></font>sret<font color="#808080">=</font><font color="#808000"><b>substr</b></font><font color="#808080">(</font>slinha<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font>nTamLinha<font color="#808080">)

</font><font color="#000080"><b>return </b></font>sret
<font color="#008000"><i>/*------------------------------------------------------------------------------
Pesquisa se tem linha exclu&iacute;da sen&atilde;o vai para a &uacute;ltima linha do arquivo.
sArq - o arquivo
nTamLinha - o tamanho do registro
------------------------------------------------------------------------------*/
</i></font>pesqLinhaExcluida<font color="#808080">: </font><font color="#000080"><b>procedure
  parse arg </b></font>sArq<font color="#808080">, </font>nTamLinha

sExcluido<font color="#808080">=</font>pesqArq<font color="#808080">(</font>sArq<font color="#808080">, '*', </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font>nTamLinha<font color="#808080">)
</font><font color="#000080"><b>if </b></font>sExcluido<font color="#808080">='' </font><font color="#000080"><b>then
  call </b></font><font color="#808000"><b>stream </b></font>sArq<font color="#808080">, '</font>C<font color="#808080">', '</font><font color="#808000"><b>SEEK </b></font><font color="#808080">=' || </font>tamArq<font color="#808080">(</font>sArq<font color="#808080">) || ' </font>READ <font color="#0000FF"><b>LINE</b></font><font color="#808080">'
</font><font color="#000080"><b>return
</b></font><font color="#008000"><i>/*------------------------------------------------------------------------------
Pesquisa o maior c&oacute;digo num arquivo.
sArq - o arquivo
nPosChave - a posicao inicial da chave dentro do registro
nTamChave - o tamanho da chave dentro do registro
nTamLinha - o tamanho do registro
retorna - o maior c&oacute;digo
------------------------------------------------------------------------------*/
</i></font>pesqMaxCod<font color="#808080">: </font><font color="#000080"><b>procedure
  parse arg </b></font>sArq<font color="#808080">, </font>nPosChave<font color="#808080">, </font>nTamChave<font color="#808080">, </font>nTamLinha

<font color="#000080"><b>call </b></font>constantes
slinha <font color="#808080">= ''; </font>sres <font color="#808080">= ''
</font>nCod <font color="#808080">= </font><font color="#FF0000">0
</font>bQuebra<font color="#808080">=</font>false
nMaior<font color="#808080">=</font><font color="#FF0000">0
</font><font color="#000080"><b>call </b></font><font color="#808000"><b>stream </b></font>sArq<font color="#808080">, '</font>C<font color="#808080">', '</font><font color="#808000"><b>SEEK </b></font><font color="#808080">=</font><font color="#FF0000">0 </font>READ <font color="#0000FF"><b>LINE</b></font><font color="#808080">'
</font><font color="#000080"><b>do </b></font>while <font color="#808080">(</font>fimArq<font color="#808080">(</font>sArq<font color="#808080">)=</font>false<font color="#808080">) &amp; (</font>bQuebra<font color="#808080">=</font>false<font color="#808080">)
  </font>slinha <font color="#808080">= </font><font color="#0000FF"><b>linein</b></font><font color="#808080">(</font>sArq<font color="#808080">)
  </font>sres<font color="#808080">=</font><font color="#808000"><b>strip</b></font><font color="#808080">(</font><font color="#808000"><b>substr</b></font><font color="#808080">(</font>slinha<font color="#808080">,</font>nPosChave<font color="#808080">,</font>nTamChave<font color="#808080">))
  </font>nCod <font color="#808080">= </font>sres
  <font color="#000080"><b>if </b></font>nCod <font color="#808080">&gt; </font>nMaior <font color="#000080"><b>then
     </b></font>nMaior<font color="#808080">=</font>nCod
<font color="#000080"><b>end
call </b></font>pesqLinhaExcluida sArq<font color="#808080">, </font>nTamLinha
sres <font color="#808080">= (</font>nMaior<font color="#808080">+</font><font color="#FF0000">1</font><font color="#808080">)
</font><font color="#000080"><b>return </b></font>sres
<font color="#008000"><i>/*------------------------------------------------------------------------------
Grava os registros num determinado arquivo.
sArq - o arquivo
sTexto - o registro a ser gravado
sMsgAcerto - a mensagem caso o registro foi gravado
sMsgErro - a mensagem caso o registro n&atilde;o foi gravado
------------------------------------------------------------------------------*/
</i></font>escreveArq<font color="#808080">: </font><font color="#000080"><b>procedure
  parse arg </b></font>sArq<font color="#808080">, </font>sTexto<font color="#808080">, </font>sMsgAcerto<font color="#808080">, </font>sMsgErro

<font color="#008000"><i>/* call constantes
sTexto=sTexto || CRLF */
</i></font><font color="#000080"><b>call </b></font><font color="#0000FF"><b>lineout </b></font>sArq<font color="#808080">, </font>sTexto
<font color="#000080"><b>say </b></font>sMsgAcerto

<font color="#008000"><i>/*say sMsgErro*/
</i></font><font color="#000080"><b>return

</b></font><font color="#008000"><i>/*--- Rotinas de implementa&ccedil;&atilde;o do sistema e de interface ----------------------*/

/*------------------------------------------------------------------------------
Monta o tamanho do registro no arquivo de acordo com o tipo de arquivo.
sreg - o tipo de arquivo
retorna - o registro montado
------------------------------------------------------------------------------*/
</i></font>LinhaReg<font color="#808080">: </font><font color="#000080"><b>procedure expose </b></font>tAssunto<font color="#808080">.</font>codigo tAssunto<font color="#808080">.</font>assunto tAutor<font color="#808080">.</font>codigo<font color="#808080">,
 </font>tAutor<font color="#808080">.</font>autor tEditora<font color="#808080">.</font>codigo tEditora<font color="#808080">.</font>editora tEndereco<font color="#808080">.</font>codigo<font color="#808080">,
 </font>tEndereco<font color="#808080">.</font>logradouro tEndereco<font color="#808080">.</font>bairro tEndereco<font color="#808080">.</font>cep tEndereco<font color="#808080">.</font>cidade<font color="#808080">,
 </font>tEndereco<font color="#808080">.</font>estado tIdioma<font color="#808080">.</font>codigo tIdioma<font color="#808080">.</font>idioma tPais<font color="#808080">.</font>codigo tPais<font color="#808080">.</font>pais<font color="#808080">,
 </font>tProfissao<font color="#808080">.</font>codigo tProfissao<font color="#808080">.</font>profissao tUsuario<font color="#808080">.</font>login tUsuario<font color="#808080">.</font>senha<font color="#808080">,
 </font>tLivro<font color="#808080">.</font>isbn tLivro<font color="#808080">.</font>titulo tLivro<font color="#808080">.</font>edicao tLivro<font color="#808080">.</font>anopubli tLivro<font color="#808080">.</font>codeditora<font color="#808080">,
 </font>tLivro<font color="#808080">.</font>volume tLivro<font color="#808080">.</font>codidioma tLivro<font color="#808080">.</font>npaginas tLivro<font color="#808080">.</font>preco tLivro<font color="#808080">.</font>qtdestoque<font color="#808080">,
 </font>tLivroAss<font color="#808080">.</font>isbn tlivroAss<font color="#808080">.</font>codassunto tLivroAut<font color="#808080">.</font>isbn tlivroAut<font color="#808080">.</font>codautor<font color="#808080">,
 </font>tCliente<font color="#808080">.</font>cpf tCliente<font color="#808080">.</font>nome tCliente<font color="#808080">.</font>email tCliente<font color="#808080">.</font>identidade tCliente<font color="#808080">.</font>sexo<font color="#808080">,
 </font>tCliente<font color="#808080">.</font>telefone tCliente<font color="#808080">.</font>dtnascimento tCliente<font color="#808080">.</font>codendereco tCliente<font color="#808080">.</font>codpais<font color="#808080">,
 </font>tCliente<font color="#808080">.</font>codprofissao tVenda<font color="#808080">.</font>dthrvenda tVenda<font color="#808080">.</font>cpf tVenda<font color="#808080">.</font>isbn tVenda<font color="#808080">.</font>precovenda

  <font color="#000080"><b>parse arg </b></font>sreg

<font color="#000080"><b>call </b></font>constantes
slinha<font color="#808080">=''
</font><font color="#000080"><b>if </b></font>sreg<font color="#808080">=</font>opAssunto <font color="#000080"><b>then
   </b></font>slinha<font color="#808080">=</font>esp<font color="#808080">(</font>tAssunto<font color="#808080">.</font>codigo<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">) || </font>esp<font color="#808080">(</font>tAssunto<font color="#808080">.</font>assunto<font color="#808080">,</font><font color="#FF0000">30</font><font color="#808080">)
</font><font color="#000080"><b>else if </b></font>sreg<font color="#808080">=</font>opAutor <font color="#000080"><b>then
   </b></font>slinha<font color="#808080">=</font>esp<font color="#808080">(</font>tAutor<font color="#808080">.</font>codigo<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">) || </font>esp<font color="#808080">(</font>tAutor<font color="#808080">.</font>autor<font color="#808080">,</font><font color="#FF0000">30</font><font color="#808080">)
</font><font color="#000080"><b>else if </b></font>sreg<font color="#808080">=</font>opEditora <font color="#000080"><b>then
   </b></font>slinha<font color="#808080">=</font>esp<font color="#808080">(</font>tEditora<font color="#808080">.</font>codigo<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">) || </font>esp<font color="#808080">(</font>tEditora<font color="#808080">.</font>editora<font color="#808080">,</font><font color="#FF0000">50</font><font color="#808080">)
</font><font color="#000080"><b>else if </b></font>sreg<font color="#808080">=</font>opEndereco <font color="#000080"><b>then do
   </b></font>slinha<font color="#808080">=</font>esp<font color="#808080">(</font>tEndereco<font color="#808080">.</font>codigo<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">) || </font>esp<font color="#808080">(</font>tEndereco<font color="#808080">.</font>logradouro<font color="#808080">,</font><font color="#FF0000">40</font><font color="#808080">)
   </font>slinha<font color="#808080">=</font>slinha <font color="#808080">|| </font>esp<font color="#808080">(</font>tEndereco<font color="#808080">.</font>bairro<font color="#808080">,</font><font color="#FF0000">15</font><font color="#808080">) || </font>esp<font color="#808080">(</font>tEndereco<font color="#808080">.</font>cep<font color="#808080">,</font><font color="#FF0000">8</font><font color="#808080">) 
   </font>slinha<font color="#808080">=</font>slinha <font color="#808080">|| </font>esp<font color="#808080">(</font>tEndereco<font color="#808080">.</font>cidade<font color="#808080">,</font><font color="#FF0000">30</font><font color="#808080">) || </font>esp<font color="#808080">(</font>tEndereco<font color="#808080">.</font>estado<font color="#808080">,</font><font color="#FF0000">20</font><font color="#808080">)
</font><font color="#000080"><b>end
else if </b></font>sreg<font color="#808080">=</font>opIdioma <font color="#000080"><b>then
   </b></font>slinha<font color="#808080">=</font>esp<font color="#808080">(</font>tIdioma<font color="#808080">.</font>codigo<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">) || </font>esp<font color="#808080">(</font>tIdioma<font color="#808080">.</font>idioma<font color="#808080">,</font><font color="#FF0000">20</font><font color="#808080">)
</font><font color="#000080"><b>else if </b></font>sreg<font color="#808080">=</font>opPais <font color="#000080"><b>then
   </b></font>slinha<font color="#808080">=</font>esp<font color="#808080">(</font>tPais<font color="#808080">.</font>codigo<font color="#808080">,</font><font color="#FF0000">3</font><font color="#808080">) || </font>esp<font color="#808080">(</font>tPais<font color="#808080">.</font>pais<font color="#808080">,</font><font color="#FF0000">50</font><font color="#808080">)
</font><font color="#000080"><b>else if </b></font>sreg<font color="#808080">=</font>opProfissao <font color="#000080"><b>then
   </b></font>slinha<font color="#808080">=</font>esp<font color="#808080">(</font>tProfissao<font color="#808080">.</font>codigo<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">) || </font>esp<font color="#808080">(</font>tProfissao<font color="#808080">.</font>profissao<font color="#808080">,</font><font color="#FF0000">50</font><font color="#808080">)
</font><font color="#000080"><b>else if </b></font>sreg<font color="#808080">=</font>opUsuario <font color="#000080"><b>then
   </b></font>slinha<font color="#808080">=</font>esp<font color="#808080">(</font>tUsuario<font color="#808080">.</font>login<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">) || </font>esp<font color="#808080">(</font>tUsuario<font color="#808080">.</font>senha<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">)
</font><font color="#000080"><b>else if </b></font>sreg<font color="#808080">=</font>opLivro <font color="#000080"><b>then do
   </b></font>slinha<font color="#808080">=</font>esp<font color="#808080">(</font>tLivro<font color="#808080">.</font>isbn<font color="#808080">,</font><font color="#FF0000">13</font><font color="#808080">) || </font>esp<font color="#808080">(</font>tLivro<font color="#808080">.</font>titulo<font color="#808080">,</font><font color="#FF0000">50</font><font color="#808080">)
   </font>slinha<font color="#808080">=</font>slinha <font color="#808080">|| </font>esp<font color="#808080">(</font>tLivro<font color="#808080">.</font>edicao<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">) ||  </font>esp<font color="#808080">(</font>tLivro<font color="#808080">.</font>anopubli<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">) 
   </font>slinha<font color="#808080">=</font>slinha <font color="#808080">|| </font>esp<font color="#808080">(</font>tLivro<font color="#808080">.</font>codeditora<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">) || </font>esp<font color="#808080">(</font>tLivro<font color="#808080">.</font>volume<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">)
   </font>slinha<font color="#808080">=</font>slinha <font color="#808080">|| </font>esp<font color="#808080">(</font>tLivro<font color="#808080">.</font>codidioma<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">) || </font>esp<font color="#808080">(</font>tLivro<font color="#808080">.</font>npaginas<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">)
   </font>slinha<font color="#808080">=</font>slinha <font color="#808080">|| </font>esp<font color="#808080">(</font>tLivro<font color="#808080">.</font>preco<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">) || </font>esp<font color="#808080">(</font>tLivro<font color="#808080">.</font>qtdestoque<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">)
</font><font color="#000080"><b>end
else if </b></font>sreg<font color="#808080">=</font>opLivroAss <font color="#000080"><b>then
   </b></font>slinha<font color="#808080">=</font>esp<font color="#808080">(</font>tLivroAss<font color="#808080">.</font>isbn<font color="#808080">,</font><font color="#FF0000">13</font><font color="#808080">) || </font>esp<font color="#808080">(</font>tlivroAss<font color="#808080">.</font>codassunto<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">)
</font><font color="#000080"><b>else if </b></font>sreg<font color="#808080">=</font>opLivroAut <font color="#000080"><b>then
   </b></font>slinha<font color="#808080">=</font>esp<font color="#808080">(</font>tLivroAut<font color="#808080">.</font>isbn<font color="#808080">,</font><font color="#FF0000">13</font><font color="#808080">) || </font>esp<font color="#808080">(</font>tlivroAut<font color="#808080">.</font>codautor<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">)
</font><font color="#000080"><b>else if </b></font>sreg<font color="#808080">=</font>opCliente <font color="#000080"><b>then do
   </b></font>slinha<font color="#808080">=</font>esp<font color="#808080">(</font>tCliente<font color="#808080">.</font>cpf<font color="#808080">,</font><font color="#FF0000">14</font><font color="#808080">) || </font>esp<font color="#808080">(</font>tCliente<font color="#808080">.</font>nome<font color="#808080">,</font><font color="#FF0000">30</font><font color="#808080">) 
   </font>slinha<font color="#808080">=</font>slinha <font color="#808080">|| </font>esp<font color="#808080">(</font>tCliente<font color="#808080">.</font>email<font color="#808080">,</font><font color="#FF0000">30</font><font color="#808080">) || </font>esp<font color="#808080">(</font>tCliente<font color="#808080">.</font>identidade<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">) 
   </font>slinha<font color="#808080">=</font>slinha <font color="#808080">|| </font>esp<font color="#808080">(</font>tCliente<font color="#808080">.</font>sexo<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">) || </font>esp<font color="#808080">(</font>tCliente<font color="#808080">.</font>telefone<font color="#808080">,</font><font color="#FF0000">17</font><font color="#808080">) 
   </font>slinha<font color="#808080">=</font>slinha <font color="#808080">|| </font>esp<font color="#808080">(</font>tCliente<font color="#808080">.</font>dtnascimento<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">) || </font>esp<font color="#808080">(</font>tCliente<font color="#808080">.</font>codendereco<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">)
   </font>slinha<font color="#808080">=</font>slinha <font color="#808080">|| </font>esp<font color="#808080">(</font>tCliente<font color="#808080">.</font>codpais<font color="#808080">,</font><font color="#FF0000">3</font><font color="#808080">) || </font>esp<font color="#808080">(</font>tCliente<font color="#808080">.</font>codprofissao<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">)
</font><font color="#000080"><b>end
else if </b></font>sreg<font color="#808080">=</font>opVenda <font color="#000080"><b>then do
   </b></font>slinha<font color="#808080">=</font>esp<font color="#808080">(</font>tVenda<font color="#808080">.</font>dthrvenda<font color="#808080">,</font><font color="#FF0000">19</font><font color="#808080">) || </font>esp<font color="#808080">(</font>tVenda<font color="#808080">.</font>cpf<font color="#808080">,</font><font color="#FF0000">14</font><font color="#808080">) 
   </font>slinha<font color="#808080">=</font>slinha <font color="#808080">|| </font>esp<font color="#808080">(</font>tVenda<font color="#808080">.</font>isbn<font color="#808080">,</font><font color="#FF0000">13</font><font color="#808080">) || </font>esp<font color="#808080">(</font>tVenda<font color="#808080">.</font>precovenda<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">)
</font><font color="#000080"><b>end

return </b></font>slinha
<font color="#008000"><i>/*------------------------------------------------------------------------------
Retorna o tamanho do registro no arquivo de acordo com o tipo de arquivo.
sreg - o tipo de arquivo
retorna - o tamanho do registro
------------------------------------------------------------------------------*/
</i></font>tamReg<font color="#808080">: </font><font color="#000080"><b>procedure
  parse arg </b></font>sreg

<font color="#000080"><b>call </b></font>constantes
<font color="#000080"><b>if </b></font>sreg<font color="#808080">=</font>opAssunto <font color="#000080"><b>then </b></font>nret<font color="#808080">=</font>TAM_ASSUNTO
<font color="#000080"><b>else if </b></font>sreg<font color="#808080">=</font>opAutor <font color="#000080"><b>then </b></font>nret<font color="#808080">=</font>TAM_AUTOR
<font color="#000080"><b>else if </b></font>sreg<font color="#808080">=</font>opEditora <font color="#000080"><b>then </b></font>nret<font color="#808080">=</font>TAM_EDITORA
<font color="#000080"><b>else if </b></font>sreg<font color="#808080">=</font>opEndereco <font color="#000080"><b>then </b></font>nret<font color="#808080">=</font>TAM_ENDERECO
<font color="#000080"><b>else if </b></font>sreg<font color="#808080">=</font>opIdioma <font color="#000080"><b>then </b></font>nret<font color="#808080">=</font>TAM_IDIOMA
<font color="#000080"><b>else if </b></font>sreg<font color="#808080">=</font>opPais <font color="#000080"><b>then </b></font>nret<font color="#808080">=</font>TAM_PAIS
<font color="#000080"><b>else if </b></font>sreg<font color="#808080">=</font>opProfissao <font color="#000080"><b>then </b></font>nret<font color="#808080">=</font>TAM_PROFISSAO
<font color="#000080"><b>else if </b></font>sreg<font color="#808080">=</font>opUsuario <font color="#000080"><b>then </b></font>nret<font color="#808080">=</font>TAM_USUARIO
<font color="#000080"><b>else if </b></font>sreg<font color="#808080">=</font>opLivro <font color="#000080"><b>then </b></font>nret<font color="#808080">=</font>TAM_LIVRO
<font color="#000080"><b>else if </b></font>sreg<font color="#808080">=</font>opLivroAss <font color="#000080"><b>then </b></font>nret<font color="#808080">=</font>TAM_LIVASS
<font color="#000080"><b>else if </b></font>sreg<font color="#808080">=</font>opLivroAut <font color="#000080"><b>then </b></font>nret<font color="#808080">=</font>TAM_LIVAUT
<font color="#000080"><b>else if </b></font>sreg<font color="#808080">=</font>opCliente <font color="#000080"><b>then </b></font>nret<font color="#808080">=</font>TAM_CLIENTE
<font color="#000080"><b>else if </b></font>sreg<font color="#808080">=</font>opVenda <font color="#000080"><b>then </b></font>nret<font color="#808080">=</font>TAM_VENDA

<font color="#000080"><b>return </b></font>nret
<font color="#008000"><i>/*------------------------------------------------------------------------------
Seleciona o rotulo de cada campo de acordo com o tipo de arquivo.
sreg - o tipo de arquivo
nNum - indica qual rotulo ser&aacute; retornado
retorna - o rotulo
------------------------------------------------------------------------------*/
</i></font>rotulo<font color="#808080">: </font><font color="#000080"><b>procedure
  parse arg </b></font>sreg<font color="#808080">, </font>nNum

<font color="#000080"><b>call </b></font>constantes
sret<font color="#808080">=''
</font><font color="#000080"><b>if </b></font>sreg<font color="#808080">=</font>opAssunto <font color="#000080"><b>then do
   select
     when </b></font>nNum <font color="#808080">= </font><font color="#FF0000">0 </font><font color="#000080"><b>then </b></font>sret<font color="#808080">='</font>Assunto<font color="#808080">(</font>s<font color="#808080">) </font>n<font color="#808080">&atilde;</font>o encontrado<font color="#808080">(</font>s<font color="#808080">)!'
     </font><font color="#000080"><b>when </b></font>nNum <font color="#808080">= </font><font color="#FF0000">1 </font><font color="#000080"><b>then </b></font>sret<font color="#808080">='</font>C<font color="#808080">&oacute;</font>digo <font color="#000080"><b>do </b></font>assunto<font color="#808080">: '
     </font><font color="#000080"><b>when </b></font>nNum <font color="#808080">= </font><font color="#FF0000">2 </font><font color="#000080"><b>then </b></font>sret<font color="#808080">='</font>Assunto<font color="#808080">: '
   </font><font color="#000080"><b>end
end 
else if </b></font>sreg<font color="#808080">=</font>opAutor <font color="#000080"><b>then do
   select
     when </b></font>nNum <font color="#808080">= </font><font color="#FF0000">0 </font><font color="#000080"><b>then </b></font>sret<font color="#808080">='</font>Autor<font color="#808080">(</font>es<font color="#808080">) </font>n<font color="#808080">&atilde;</font>o encontrado<font color="#808080">(</font>s<font color="#808080">)!'
     </font><font color="#000080"><b>when </b></font>nNum <font color="#808080">= </font><font color="#FF0000">1 </font><font color="#000080"><b>then </b></font>sret<font color="#808080">='</font>C<font color="#808080">&oacute;</font>digo <font color="#000080"><b>do </b></font>autor<font color="#808080">: '
     </font><font color="#000080"><b>when </b></font>nNum <font color="#808080">= </font><font color="#FF0000">2 </font><font color="#000080"><b>then </b></font>sret<font color="#808080">='</font>Autor<font color="#808080">: '
   </font><font color="#000080"><b>end
end 
else if </b></font>sreg<font color="#808080">=</font>opEditora <font color="#000080"><b>then do
   select
     when </b></font>nNum <font color="#808080">= </font><font color="#FF0000">0 </font><font color="#000080"><b>then </b></font>sret<font color="#808080">='</font>Editora<font color="#808080">(</font>s<font color="#808080">) </font>n<font color="#808080">&atilde;</font>o encontrada<font color="#808080">(</font>s<font color="#808080">)!'
     </font><font color="#000080"><b>when </b></font>nNum <font color="#808080">= </font><font color="#FF0000">1 </font><font color="#000080"><b>then </b></font>sret<font color="#808080">='</font>C<font color="#808080">&oacute;</font>digo da editora<font color="#808080">: '
     </font><font color="#000080"><b>when </b></font>nNum <font color="#808080">= </font><font color="#FF0000">2 </font><font color="#000080"><b>then </b></font>sret<font color="#808080">='</font>Editora<font color="#808080">: '
   </font><font color="#000080"><b>end
end 
else if </b></font>sreg<font color="#808080">=</font>opEndereco <font color="#000080"><b>then do
   select
     when </b></font>nNum <font color="#808080">= </font><font color="#FF0000">0 </font><font color="#000080"><b>then </b></font>sret<font color="#808080">='</font>Endere<font color="#808080">&ccedil;</font>o<font color="#808080">(</font>s<font color="#808080">) </font>n<font color="#808080">&atilde;</font>o encontrado<font color="#808080">(</font>s<font color="#808080">)!'
     </font><font color="#000080"><b>when </b></font>nNum <font color="#808080">= </font><font color="#FF0000">1 </font><font color="#000080"><b>then </b></font>sret<font color="#808080">='</font>C<font color="#808080">&oacute;</font>digo <font color="#000080"><b>do </b></font>endere<font color="#808080">&ccedil;</font>o<font color="#808080">: '
     </font><font color="#000080"><b>when </b></font>nNum <font color="#808080">= </font><font color="#FF0000">2 </font><font color="#000080"><b>then </b></font>sret<font color="#808080">='</font>Logradouro<font color="#808080">: '
     </font><font color="#000080"><b>when </b></font>nNum <font color="#808080">= </font><font color="#FF0000">3 </font><font color="#000080"><b>then </b></font>sret<font color="#808080">='</font>Bairro<font color="#808080">: '
     </font><font color="#000080"><b>when </b></font>nNum <font color="#808080">= </font><font color="#FF0000">4 </font><font color="#000080"><b>then </b></font>sret<font color="#808080">='</font>CEP<font color="#808080">: '
     </font><font color="#000080"><b>when </b></font>nNum <font color="#808080">= </font><font color="#FF0000">5 </font><font color="#000080"><b>then </b></font>sret<font color="#808080">='</font>Cidade<font color="#808080">: '
     </font><font color="#000080"><b>when </b></font>nNum <font color="#808080">= </font><font color="#FF0000">6 </font><font color="#000080"><b>then </b></font>sret<font color="#808080">='</font>Estado<font color="#808080">: '
   </font><font color="#000080"><b>end
end 
else if </b></font>sreg<font color="#808080">=</font>opIdioma <font color="#000080"><b>then do
   select
     when </b></font>nNum <font color="#808080">= </font><font color="#FF0000">0 </font><font color="#000080"><b>then </b></font>sret<font color="#808080">='</font>Idioma<font color="#808080">(</font>s<font color="#808080">) </font>n<font color="#808080">&atilde;</font>o encontrado<font color="#808080">(</font>s<font color="#808080">)!'
     </font><font color="#000080"><b>when </b></font>nNum <font color="#808080">= </font><font color="#FF0000">1 </font><font color="#000080"><b>then </b></font>sret<font color="#808080">='</font>C<font color="#808080">&oacute;</font>digo <font color="#000080"><b>do </b></font>idioma<font color="#808080">: '
     </font><font color="#000080"><b>when </b></font>nNum <font color="#808080">= </font><font color="#FF0000">2 </font><font color="#000080"><b>then </b></font>sret<font color="#808080">='</font>Idioma<font color="#808080">: '
   </font><font color="#000080"><b>end
end 
else if </b></font>sreg<font color="#808080">=</font>opPais <font color="#000080"><b>then do
   select
     when </b></font>nNum <font color="#808080">= </font><font color="#FF0000">0 </font><font color="#000080"><b>then </b></font>sret<font color="#808080">='</font>Pa<font color="#808080">&iacute;</font>s<font color="#808080">(</font>es<font color="#808080">) </font>n<font color="#808080">&atilde;</font>o encontrado<font color="#808080">(</font>s<font color="#808080">)!'
     </font><font color="#000080"><b>when </b></font>nNum <font color="#808080">= </font><font color="#FF0000">1 </font><font color="#000080"><b>then </b></font>sret<font color="#808080">='</font>C<font color="#808080">&oacute;</font>digo <font color="#000080"><b>do </b></font>pa<font color="#808080">&iacute;</font>s<font color="#808080">: '
     </font><font color="#000080"><b>when </b></font>nNum <font color="#808080">= </font><font color="#FF0000">2 </font><font color="#000080"><b>then </b></font>sret<font color="#808080">='</font>Pa<font color="#808080">&iacute;</font>s<font color="#808080">: '
   </font><font color="#000080"><b>end
end 
else if </b></font>sreg<font color="#808080">=</font>opProfissao <font color="#000080"><b>then do
   select
     when </b></font>nNum <font color="#808080">= </font><font color="#FF0000">0 </font><font color="#000080"><b>then </b></font>sret<font color="#808080">='</font>Profiss<font color="#808080">&atilde;</font>o<font color="#808080">(</font>es<font color="#808080">) </font>n<font color="#808080">&atilde;</font>o encontrada<font color="#808080">(</font>s<font color="#808080">)!'
     </font><font color="#000080"><b>when </b></font>nNum <font color="#808080">= </font><font color="#FF0000">1 </font><font color="#000080"><b>then </b></font>sret<font color="#808080">='</font>C<font color="#808080">&oacute;</font>digo da profiss<font color="#808080">&atilde;</font>o<font color="#808080">: '
     </font><font color="#000080"><b>when </b></font>nNum <font color="#808080">= </font><font color="#FF0000">2 </font><font color="#000080"><b>then </b></font>sret<font color="#808080">='</font>Profiss<font color="#808080">&atilde;</font>o<font color="#808080">: '
   </font><font color="#000080"><b>end
end 
else if </b></font>sreg<font color="#808080">=</font>opUsuario <font color="#000080"><b>then do
   select
     when </b></font>nNum <font color="#808080">= </font><font color="#FF0000">0 </font><font color="#000080"><b>then </b></font>sret<font color="#808080">='</font>login ou senha incorreta<font color="#808080">, </font>tente de novo<font color="#808080">!'
     </font><font color="#000080"><b>when </b></font>nNum <font color="#808080">= </font><font color="#FF0000">1 </font><font color="#000080"><b>then </b></font>sret<font color="#808080">='</font>Login<font color="#808080">: '
     </font><font color="#000080"><b>when </b></font>nNum <font color="#808080">= </font><font color="#FF0000">2 </font><font color="#000080"><b>then </b></font>sret<font color="#808080">='</font>Senha<font color="#808080">: '
   </font><font color="#000080"><b>end
end 
else if </b></font>sreg<font color="#808080">=</font>opLivro <font color="#000080"><b>then do
   select
     when </b></font>nNum <font color="#808080">= </font><font color="#FF0000">0 </font><font color="#000080"><b>then </b></font>sret<font color="#808080">='</font>Livro<font color="#808080">(</font>s<font color="#808080">) </font>n<font color="#808080">&atilde;</font>o encontrado<font color="#808080">(</font>s<font color="#808080">)!'
     </font><font color="#000080"><b>when </b></font>nNum <font color="#808080">= </font><font color="#FF0000">1 </font><font color="#000080"><b>then </b></font>sret<font color="#808080">='</font>ISBN<font color="#808080">: '
     </font><font color="#000080"><b>when </b></font>nNum <font color="#808080">= </font><font color="#FF0000">2 </font><font color="#000080"><b>then </b></font>sret<font color="#808080">='</font>T<font color="#808080">&iacute;</font>tulo<font color="#808080">: '
     </font><font color="#000080"><b>when </b></font>nNum <font color="#808080">= </font><font color="#FF0000">3 </font><font color="#000080"><b>then </b></font>sret<font color="#808080">='</font>Edi<font color="#808080">&ccedil;&atilde;</font>o<font color="#808080">: '
     </font><font color="#000080"><b>when </b></font>nNum <font color="#808080">= </font><font color="#FF0000">4 </font><font color="#000080"><b>then </b></font>sret<font color="#808080">='</font>Ano de Publica<font color="#808080">&ccedil;&atilde;</font>o<font color="#808080">: '
     </font><font color="#000080"><b>when </b></font>nNum <font color="#808080">= </font><font color="#FF0000">5 </font><font color="#000080"><b>then </b></font>sret<font color="#808080">='</font>C<font color="#808080">&oacute;</font>digo da editora<font color="#808080">: '
     </font><font color="#000080"><b>when </b></font>nNum <font color="#808080">= </font><font color="#FF0000">6 </font><font color="#000080"><b>then </b></font>sret<font color="#808080">='</font>Volume<font color="#808080">: '
     </font><font color="#000080"><b>when </b></font>nNum <font color="#808080">= </font><font color="#FF0000">7 </font><font color="#000080"><b>then </b></font>sret<font color="#808080">='</font>C<font color="#808080">&oacute;</font>digo <font color="#000080"><b>do </b></font>idioma<font color="#808080">: '
     </font><font color="#000080"><b>when </b></font>nNum <font color="#808080">= </font><font color="#FF0000">8 </font><font color="#000080"><b>then </b></font>sret<font color="#808080">='</font>N<font color="#808080">&uacute;</font>mero de p<font color="#808080">&aacute;</font>ginas<font color="#808080">: '
     </font><font color="#000080"><b>when </b></font>nNum <font color="#808080">= </font><font color="#FF0000">9 </font><font color="#000080"><b>then </b></font>sret<font color="#808080">='</font>Pre<font color="#808080">&ccedil;</font>o<font color="#808080">: '
     </font><font color="#000080"><b>when </b></font>nNum <font color="#808080">= </font><font color="#FF0000">10 </font><font color="#000080"><b>then </b></font>sret<font color="#808080">='</font>Qtd<font color="#808080">. </font>Estoque<font color="#808080">: '
   </font><font color="#000080"><b>end
end 
else if </b></font>sreg<font color="#808080">=</font>opLivroAss <font color="#000080"><b>then do
   select
     when </b></font>nNum <font color="#808080">= </font><font color="#FF0000">0 </font><font color="#000080"><b>then </b></font>sret<font color="#808080">='</font>Assunto<font color="#808080">(</font>s<font color="#808080">) </font>n<font color="#808080">&atilde;</font>o encontrado<font color="#808080">(</font>s<font color="#808080">)!'
     </font><font color="#000080"><b>when </b></font>nNum <font color="#808080">= </font><font color="#FF0000">1 </font><font color="#000080"><b>then </b></font>sret<font color="#808080">='</font>ISBN<font color="#808080">: '
     </font><font color="#000080"><b>when </b></font>nNum <font color="#808080">= </font><font color="#FF0000">2 </font><font color="#000080"><b>then </b></font>sret<font color="#808080">='</font>C<font color="#808080">&oacute;</font>digo <font color="#000080"><b>do </b></font>assunto<font color="#808080">: '
   </font><font color="#000080"><b>end
end 
else if </b></font>sreg<font color="#808080">=</font>opLivroAut <font color="#000080"><b>then do
   select
     when </b></font>nNum <font color="#808080">= </font><font color="#FF0000">0 </font><font color="#000080"><b>then </b></font>sret<font color="#808080">='</font>Autor<font color="#808080">(</font>s<font color="#808080">) </font>n<font color="#808080">&atilde;</font>o encontrado<font color="#808080">(</font>s<font color="#808080">)!'
     </font><font color="#000080"><b>when </b></font>nNum <font color="#808080">= </font><font color="#FF0000">1 </font><font color="#000080"><b>then </b></font>sret<font color="#808080">='</font>ISBN<font color="#808080">: '
     </font><font color="#000080"><b>when </b></font>nNum <font color="#808080">= </font><font color="#FF0000">2 </font><font color="#000080"><b>then </b></font>sret<font color="#808080">='</font>C<font color="#808080">&oacute;</font>digo <font color="#000080"><b>do </b></font>autor<font color="#808080">: '
   </font><font color="#000080"><b>end
end 
else if </b></font>sreg<font color="#808080">=</font>opCliente <font color="#000080"><b>then do
   select
     when </b></font>nNum <font color="#808080">= </font><font color="#FF0000">0 </font><font color="#000080"><b>then </b></font>sret<font color="#808080">='</font>Cliente<font color="#808080">(</font>s<font color="#808080">) </font>n<font color="#808080">&atilde;</font>o encontrado<font color="#808080">(</font>s<font color="#808080">)!'
     </font><font color="#000080"><b>when </b></font>nNum <font color="#808080">= </font><font color="#FF0000">1 </font><font color="#000080"><b>then </b></font>sret<font color="#808080">='</font>CPF<font color="#808080">: '
     </font><font color="#000080"><b>when </b></font>nNum <font color="#808080">= </font><font color="#FF0000">2 </font><font color="#000080"><b>then </b></font>sret<font color="#808080">='</font>Nome<font color="#808080">: '
     </font><font color="#000080"><b>when </b></font>nNum <font color="#808080">= </font><font color="#FF0000">3 </font><font color="#000080"><b>then </b></font>sret<font color="#808080">='</font>E<font color="#808080">-</font>mail<font color="#808080">: '
     </font><font color="#000080"><b>when </b></font>nNum <font color="#808080">= </font><font color="#FF0000">4 </font><font color="#000080"><b>then </b></font>sret<font color="#808080">='</font>Identidade<font color="#808080">: '
     </font><font color="#000080"><b>when </b></font>nNum <font color="#808080">= </font><font color="#FF0000">5 </font><font color="#000080"><b>then </b></font>sret<font color="#808080">='</font>Sexo<font color="#808080">: '
     </font><font color="#000080"><b>when </b></font>nNum <font color="#808080">= </font><font color="#FF0000">6 </font><font color="#000080"><b>then </b></font>sret<font color="#808080">='</font>Telefone<font color="#808080">: '
     </font><font color="#000080"><b>when </b></font>nNum <font color="#808080">= </font><font color="#FF0000">7 </font><font color="#000080"><b>then </b></font>sret<font color="#808080">='</font>Dt<font color="#808080">. </font>Nascimento<font color="#808080">: '
     </font><font color="#000080"><b>when </b></font>nNum <font color="#808080">= </font><font color="#FF0000">8 </font><font color="#000080"><b>then </b></font>sret<font color="#808080">='</font>C<font color="#808080">&oacute;</font>digo <font color="#000080"><b>do </b></font>endere<font color="#808080">&ccedil;</font>o<font color="#808080">: '
     </font><font color="#000080"><b>when </b></font>nNum <font color="#808080">= </font><font color="#FF0000">9 </font><font color="#000080"><b>then </b></font>sret<font color="#808080">='</font>C<font color="#808080">&oacute;</font>digo <font color="#000080"><b>do </b></font>pa<font color="#808080">&iacute;</font>s<font color="#808080">: '
     </font><font color="#000080"><b>when </b></font>nNum <font color="#808080">= </font><font color="#FF0000">10 </font><font color="#000080"><b>then </b></font>sret<font color="#808080">='</font>C<font color="#808080">&oacute;</font>digo da Profiss<font color="#808080">&atilde;</font>o<font color="#808080">: '
   </font><font color="#000080"><b>end
end 
else if </b></font>sreg<font color="#808080">=</font>opVenda <font color="#000080"><b>then do
   select
     when </b></font>nNum <font color="#808080">= </font><font color="#FF0000">0 </font><font color="#000080"><b>then </b></font>sret<font color="#808080">='</font>Venda<font color="#808080">(</font>s<font color="#808080">) </font>n<font color="#808080">&atilde;</font>o encontrada<font color="#808080">(</font>s<font color="#808080">)!'
     </font><font color="#000080"><b>when </b></font>nNum <font color="#808080">= </font><font color="#FF0000">1 </font><font color="#000080"><b>then </b></font>sret<font color="#808080">='</font>Data<font color="#808080">/</font>Hora venda<font color="#808080">: '
     </font><font color="#000080"><b>when </b></font>nNum <font color="#808080">= </font><font color="#FF0000">2 </font><font color="#000080"><b>then </b></font>sret<font color="#808080">='</font>CPF<font color="#808080">: '
     </font><font color="#000080"><b>when </b></font>nNum <font color="#808080">= </font><font color="#FF0000">3 </font><font color="#000080"><b>then </b></font>sret<font color="#808080">='</font>ISBN<font color="#808080">: '
     </font><font color="#000080"><b>when </b></font>nNum <font color="#808080">= </font><font color="#FF0000">4 </font><font color="#000080"><b>then </b></font>sret<font color="#808080">='</font>Pre<font color="#808080">&ccedil;</font>o de venda<font color="#808080">: '
   </font><font color="#000080"><b>end
end

return </b></font>sret
<font color="#008000"><i>/*------------------------------------------------------------------------------
Seleciona a posicao da chave de cada campo de acordo com o tipo de arquivo.
sreg - o tipo de arquivo
retorna - a posicao da chave 
------------------------------------------------------------------------------*/
</i></font>gnPosChave<font color="#808080">: </font><font color="#000080"><b>procedure
  parse arg </b></font>sreg<font color="#808080">, </font>nNum

<font color="#000080"><b>call </b></font>constantes
sret<font color="#808080">=''
</font><font color="#000080"><b>if </b></font>sreg<font color="#808080">=</font>opAssunto <font color="#000080"><b>then do
   if </b></font>nNum <font color="#808080">= </font><font color="#FF0000">1 </font><font color="#000080"><b>then </b></font>g_nPosChave<font color="#808080">=</font><font color="#FF0000">1
   </font><font color="#000080"><b>else if </b></font>nNum <font color="#808080">= </font><font color="#FF0000">2 </font><font color="#000080"><b>then </b></font>g_nPosChave<font color="#808080">=</font><font color="#FF0000">11
</font><font color="#000080"><b>end
else if </b></font>sreg<font color="#808080">=</font>opAutor <font color="#000080"><b>then do
   if </b></font>nNum <font color="#808080">= </font><font color="#FF0000">1 </font><font color="#000080"><b>then </b></font>g_nPosChave<font color="#808080">=</font><font color="#FF0000">1
   </font><font color="#000080"><b>else if </b></font>nNum <font color="#808080">= </font><font color="#FF0000">2 </font><font color="#000080"><b>then </b></font>g_nPosChave<font color="#808080">=</font><font color="#FF0000">11
</font><font color="#000080"><b>end 
else if </b></font>sreg<font color="#808080">=</font>opEditora <font color="#000080"><b>then do
   if </b></font>nNum <font color="#808080">= </font><font color="#FF0000">1 </font><font color="#000080"><b>then </b></font>g_nPosChave<font color="#808080">=</font><font color="#FF0000">1
   </font><font color="#000080"><b>else if </b></font>nNum <font color="#808080">= </font><font color="#FF0000">2 </font><font color="#000080"><b>then </b></font>g_nPosChave<font color="#808080">=</font><font color="#FF0000">11
</font><font color="#000080"><b>end 
else if </b></font>sreg<font color="#808080">=</font>opEndereco <font color="#000080"><b>then do
   if </b></font>nNum <font color="#808080">= </font><font color="#FF0000">1 </font><font color="#000080"><b>then </b></font>g_nPosChave<font color="#808080">=</font><font color="#FF0000">1
   </font><font color="#000080"><b>else if </b></font>nNum <font color="#808080">= </font><font color="#FF0000">2 </font><font color="#000080"><b>then </b></font>g_nPosChave<font color="#808080">=</font><font color="#FF0000">11
   </font><font color="#000080"><b>else if </b></font>nNum <font color="#808080">= </font><font color="#FF0000">3 </font><font color="#000080"><b>then </b></font>g_nPosChave<font color="#808080">=</font><font color="#FF0000">51
   </font><font color="#000080"><b>else if </b></font>nNum <font color="#808080">= </font><font color="#FF0000">4 </font><font color="#000080"><b>then </b></font>g_nPosChave<font color="#808080">=</font><font color="#FF0000">66
   </font><font color="#000080"><b>else if </b></font>nNum <font color="#808080">= </font><font color="#FF0000">5 </font><font color="#000080"><b>then </b></font>g_nPosChave<font color="#808080">=</font><font color="#FF0000">74
   </font><font color="#000080"><b>else if </b></font>nNum <font color="#808080">= </font><font color="#FF0000">6 </font><font color="#000080"><b>then </b></font>g_nPosChave<font color="#808080">=</font><font color="#FF0000">104
</font><font color="#000080"><b>end 
else if </b></font>sreg<font color="#808080">=</font>opIdioma <font color="#000080"><b>then do
   if </b></font>nNum <font color="#808080">= </font><font color="#FF0000">1 </font><font color="#000080"><b>then </b></font>g_nPosChave<font color="#808080">=</font><font color="#FF0000">1
   </font><font color="#000080"><b>else if </b></font>nNum <font color="#808080">= </font><font color="#FF0000">2 </font><font color="#000080"><b>then </b></font>g_nPosChave<font color="#808080">=</font><font color="#FF0000">11
</font><font color="#000080"><b>end 
else if </b></font>sreg<font color="#808080">=</font>opPais <font color="#000080"><b>then do
   if </b></font>nNum <font color="#808080">= </font><font color="#FF0000">1 </font><font color="#000080"><b>then </b></font>g_nPosChave<font color="#808080">=</font><font color="#FF0000">1
   </font><font color="#000080"><b>else if </b></font>nNum <font color="#808080">= </font><font color="#FF0000">2 </font><font color="#000080"><b>then </b></font>g_nPosChave<font color="#808080">=</font><font color="#FF0000">4
</font><font color="#000080"><b>end 
else if </b></font>sreg<font color="#808080">=</font>opProfissao <font color="#000080"><b>then do
   if </b></font>nNum <font color="#808080">= </font><font color="#FF0000">1 </font><font color="#000080"><b>then </b></font>g_nPosChave<font color="#808080">=</font><font color="#FF0000">1
   </font><font color="#000080"><b>else if </b></font>nNum <font color="#808080">= </font><font color="#FF0000">2 </font><font color="#000080"><b>then </b></font>g_nPosChave<font color="#808080">=</font><font color="#FF0000">11
</font><font color="#000080"><b>end 
else if </b></font>sreg<font color="#808080">=</font>opUsuario <font color="#000080"><b>then do
   if </b></font>nNum <font color="#808080">= </font><font color="#FF0000">1 </font><font color="#000080"><b>then </b></font>g_nPosChave<font color="#808080">=</font><font color="#FF0000">1
   </font><font color="#000080"><b>else if </b></font>nNum <font color="#808080">= </font><font color="#FF0000">2 </font><font color="#000080"><b>then </b></font>g_nPosChave<font color="#808080">=</font><font color="#FF0000">11
</font><font color="#000080"><b>end 
else if </b></font>sreg<font color="#808080">=</font>opLivro <font color="#000080"><b>then do
   if </b></font>nNum <font color="#808080">= </font><font color="#FF0000">1 </font><font color="#000080"><b>then </b></font>g_nPosChave<font color="#808080">=</font><font color="#FF0000">1
   </font><font color="#000080"><b>else if </b></font>nNum <font color="#808080">= </font><font color="#FF0000">2 </font><font color="#000080"><b>then </b></font>g_nPosChave<font color="#808080">=</font><font color="#FF0000">14
   </font><font color="#000080"><b>else if </b></font>nNum <font color="#808080">= </font><font color="#FF0000">3 </font><font color="#000080"><b>then </b></font>g_nPosChave<font color="#808080">=</font><font color="#FF0000">64
   </font><font color="#000080"><b>else if </b></font>nNum <font color="#808080">= </font><font color="#FF0000">4 </font><font color="#000080"><b>then </b></font>g_nPosChave<font color="#808080">=</font><font color="#FF0000">74
   </font><font color="#000080"><b>else if </b></font>nNum <font color="#808080">= </font><font color="#FF0000">5 </font><font color="#000080"><b>then </b></font>g_nPosChave<font color="#808080">=</font><font color="#FF0000">84
   </font><font color="#000080"><b>else if </b></font>nNum <font color="#808080">= </font><font color="#FF0000">6 </font><font color="#000080"><b>then </b></font>g_nPosChave<font color="#808080">=</font><font color="#FF0000">94
   </font><font color="#000080"><b>else if </b></font>nNum <font color="#808080">= </font><font color="#FF0000">7 </font><font color="#000080"><b>then </b></font>g_nPosChave<font color="#808080">=</font><font color="#FF0000">104
   </font><font color="#000080"><b>else if </b></font>nNum <font color="#808080">= </font><font color="#FF0000">8 </font><font color="#000080"><b>then </b></font>g_nPosChave<font color="#808080">=</font><font color="#FF0000">114
   </font><font color="#000080"><b>else if </b></font>nNum <font color="#808080">= </font><font color="#FF0000">9 </font><font color="#000080"><b>then </b></font>g_nPosChave<font color="#808080">=</font><font color="#FF0000">124
   </font><font color="#000080"><b>else if </b></font>nNum <font color="#808080">= </font><font color="#FF0000">10 </font><font color="#000080"><b>then </b></font>g_nPosChave<font color="#808080">=</font><font color="#FF0000">134
</font><font color="#000080"><b>end 
else if </b></font>sreg<font color="#808080">=</font>opLivroAss <font color="#000080"><b>then do
   if </b></font>nNum <font color="#808080">= </font><font color="#FF0000">1 </font><font color="#000080"><b>then </b></font>g_nPosChave<font color="#808080">=</font><font color="#FF0000">1
   </font><font color="#000080"><b>else if </b></font>nNum <font color="#808080">= </font><font color="#FF0000">2 </font><font color="#000080"><b>then </b></font>g_nPosChave<font color="#808080">=</font><font color="#FF0000">14
</font><font color="#000080"><b>end 
else if </b></font>sreg<font color="#808080">=</font>opLivroAut <font color="#000080"><b>then do
   if </b></font>nNum <font color="#808080">= </font><font color="#FF0000">1 </font><font color="#000080"><b>then </b></font>g_nPosChave<font color="#808080">=</font><font color="#FF0000">1
   </font><font color="#000080"><b>else if </b></font>nNum <font color="#808080">= </font><font color="#FF0000">2 </font><font color="#000080"><b>then </b></font>g_nPosChave<font color="#808080">=</font><font color="#FF0000">14
</font><font color="#000080"><b>end 
else if </b></font>sreg<font color="#808080">=</font>opCliente <font color="#000080"><b>then do
   if </b></font>nNum <font color="#808080">= </font><font color="#FF0000">1 </font><font color="#000080"><b>then </b></font>g_nPosChave<font color="#808080">=</font><font color="#FF0000">1
   </font><font color="#000080"><b>else if </b></font>nNum <font color="#808080">= </font><font color="#FF0000">2 </font><font color="#000080"><b>then </b></font>g_nPosChave<font color="#808080">=</font><font color="#FF0000">15
   </font><font color="#000080"><b>else if </b></font>nNum <font color="#808080">= </font><font color="#FF0000">3 </font><font color="#000080"><b>then </b></font>g_nPosChave<font color="#808080">=</font><font color="#FF0000">45
   </font><font color="#000080"><b>else if </b></font>nNum <font color="#808080">= </font><font color="#FF0000">4 </font><font color="#000080"><b>then </b></font>g_nPosChave<font color="#808080">=</font><font color="#FF0000">75
   </font><font color="#000080"><b>else if </b></font>nNum <font color="#808080">= </font><font color="#FF0000">5 </font><font color="#000080"><b>then </b></font>g_nPosChave<font color="#808080">=</font><font color="#FF0000">85
   </font><font color="#000080"><b>else if </b></font>nNum <font color="#808080">= </font><font color="#FF0000">6 </font><font color="#000080"><b>then </b></font>g_nPosChave<font color="#808080">=</font><font color="#FF0000">86
   </font><font color="#000080"><b>else if </b></font>nNum <font color="#808080">= </font><font color="#FF0000">7 </font><font color="#000080"><b>then </b></font>g_nPosChave<font color="#808080">=</font><font color="#FF0000">103
   </font><font color="#000080"><b>else if </b></font>nNum <font color="#808080">= </font><font color="#FF0000">8 </font><font color="#000080"><b>then </b></font>g_nPosChave<font color="#808080">=</font><font color="#FF0000">113
   </font><font color="#000080"><b>else if </b></font>nNum <font color="#808080">= </font><font color="#FF0000">9 </font><font color="#000080"><b>then </b></font>g_nPosChave<font color="#808080">=</font><font color="#FF0000">123
   </font><font color="#000080"><b>else if </b></font>nNum <font color="#808080">= </font><font color="#FF0000">10 </font><font color="#000080"><b>then </b></font>g_nPosChave<font color="#808080">=</font><font color="#FF0000">126
</font><font color="#000080"><b>end 
else if </b></font>sreg<font color="#808080">=</font>opVenda <font color="#000080"><b>then do
   if </b></font>nNum <font color="#808080">= </font><font color="#FF0000">1 </font><font color="#000080"><b>then </b></font>g_nPosChave<font color="#808080">=</font><font color="#FF0000">1
   </font><font color="#000080"><b>else if </b></font>nNum <font color="#808080">= </font><font color="#FF0000">2 </font><font color="#000080"><b>then </b></font>g_nPosChave<font color="#808080">=</font><font color="#FF0000">20
   </font><font color="#000080"><b>else if </b></font>nNum <font color="#808080">= </font><font color="#FF0000">3 </font><font color="#000080"><b>then </b></font>g_nPosChave<font color="#808080">=</font><font color="#FF0000">34
   </font><font color="#000080"><b>else if </b></font>nNum <font color="#808080">= </font><font color="#FF0000">4 </font><font color="#000080"><b>then </b></font>g_nPosChave<font color="#808080">=</font><font color="#FF0000">47
</font><font color="#000080"><b>end

return </b></font>g_nPosChave
<font color="#008000"><i>/*------------------------------------------------------------------------------
Seleciona o tamanho da chave de cada campo de acordo com o tipo de arquivo.
sreg - o tipo de arquivo
retorna - o tamanho da chave 
------------------------------------------------------------------------------*/
</i></font>gnTamChave<font color="#808080">: </font><font color="#000080"><b>procedure
  parse arg </b></font>sreg<font color="#808080">, </font>nNum

<font color="#000080"><b>call </b></font>constantes
sret<font color="#808080">=''
</font><font color="#000080"><b>if </b></font>sreg<font color="#808080">=</font>opAssunto <font color="#000080"><b>then do
   if </b></font>nNum <font color="#808080">= </font><font color="#FF0000">1 </font><font color="#000080"><b>then </b></font>g_nTamChave<font color="#808080">=</font><font color="#FF0000">10
   </font><font color="#000080"><b>else if </b></font>nNum <font color="#808080">= </font><font color="#FF0000">2 </font><font color="#000080"><b>then </b></font>g_nTamChave<font color="#808080">=</font><font color="#FF0000">30
</font><font color="#000080"><b>end
else if </b></font>sreg<font color="#808080">=</font>opAutor <font color="#000080"><b>then do
   if </b></font>nNum <font color="#808080">= </font><font color="#FF0000">1 </font><font color="#000080"><b>then </b></font>g_nTamChave<font color="#808080">=</font><font color="#FF0000">10
   </font><font color="#000080"><b>else if </b></font>nNum <font color="#808080">= </font><font color="#FF0000">2 </font><font color="#000080"><b>then </b></font>g_nTamChave<font color="#808080">=</font><font color="#FF0000">30
</font><font color="#000080"><b>end 
else if </b></font>sreg<font color="#808080">=</font>opEditora <font color="#000080"><b>then do
   if </b></font>nNum <font color="#808080">= </font><font color="#FF0000">1 </font><font color="#000080"><b>then </b></font>g_nTamChave<font color="#808080">=</font><font color="#FF0000">10
   </font><font color="#000080"><b>else if </b></font>nNum <font color="#808080">= </font><font color="#FF0000">2 </font><font color="#000080"><b>then </b></font>g_nTamChave<font color="#808080">=</font><font color="#FF0000">50
</font><font color="#000080"><b>end 
else if </b></font>sreg<font color="#808080">=</font>opEndereco <font color="#000080"><b>then do
   if </b></font>nNum <font color="#808080">= </font><font color="#FF0000">1 </font><font color="#000080"><b>then </b></font>g_nTamChave<font color="#808080">=</font><font color="#FF0000">10
   </font><font color="#000080"><b>else if </b></font>nNum <font color="#808080">= </font><font color="#FF0000">2 </font><font color="#000080"><b>then </b></font>g_nTamChave<font color="#808080">=</font><font color="#FF0000">40
   </font><font color="#000080"><b>else if </b></font>nNum <font color="#808080">= </font><font color="#FF0000">3 </font><font color="#000080"><b>then </b></font>g_nTamChave<font color="#808080">=</font><font color="#FF0000">15
   </font><font color="#000080"><b>else if </b></font>nNum <font color="#808080">= </font><font color="#FF0000">4 </font><font color="#000080"><b>then </b></font>g_nTamChave<font color="#808080">=</font><font color="#FF0000">8
   </font><font color="#000080"><b>else if </b></font>nNum <font color="#808080">= </font><font color="#FF0000">5 </font><font color="#000080"><b>then </b></font>g_nTamChave<font color="#808080">=</font><font color="#FF0000">30
   </font><font color="#000080"><b>else if </b></font>nNum <font color="#808080">= </font><font color="#FF0000">6 </font><font color="#000080"><b>then </b></font>g_nTamChave<font color="#808080">=</font><font color="#FF0000">20
</font><font color="#000080"><b>end 
else if </b></font>sreg<font color="#808080">=</font>opIdioma <font color="#000080"><b>then do
   if </b></font>nNum <font color="#808080">= </font><font color="#FF0000">1 </font><font color="#000080"><b>then </b></font>g_nTamChave<font color="#808080">=</font><font color="#FF0000">10
   </font><font color="#000080"><b>else if </b></font>nNum <font color="#808080">= </font><font color="#FF0000">2 </font><font color="#000080"><b>then </b></font>g_nTamChave<font color="#808080">=</font><font color="#FF0000">20
</font><font color="#000080"><b>end 
else if </b></font>sreg<font color="#808080">=</font>opPais <font color="#000080"><b>then do
   if </b></font>nNum <font color="#808080">= </font><font color="#FF0000">1 </font><font color="#000080"><b>then </b></font>g_nTamChave<font color="#808080">=</font><font color="#FF0000">3
   </font><font color="#000080"><b>else if </b></font>nNum <font color="#808080">= </font><font color="#FF0000">2 </font><font color="#000080"><b>then </b></font>g_nTamChave<font color="#808080">=</font><font color="#FF0000">50
</font><font color="#000080"><b>end 
else if </b></font>sreg<font color="#808080">=</font>opProfissao <font color="#000080"><b>then do
   if </b></font>nNum <font color="#808080">= </font><font color="#FF0000">1 </font><font color="#000080"><b>then </b></font>g_nTamChave<font color="#808080">=</font><font color="#FF0000">10
   </font><font color="#000080"><b>else if </b></font>nNum <font color="#808080">= </font><font color="#FF0000">2 </font><font color="#000080"><b>then </b></font>g_nTamChave<font color="#808080">=</font><font color="#FF0000">50
</font><font color="#000080"><b>end 
else if </b></font>sreg<font color="#808080">=</font>opUsuario <font color="#000080"><b>then do
   if </b></font>nNum <font color="#808080">= </font><font color="#FF0000">1 </font><font color="#000080"><b>then </b></font>g_nTamChave<font color="#808080">=</font><font color="#FF0000">10
   </font><font color="#000080"><b>else if </b></font>nNum <font color="#808080">= </font><font color="#FF0000">2 </font><font color="#000080"><b>then </b></font>g_nTamChave<font color="#808080">=</font><font color="#FF0000">10
</font><font color="#000080"><b>end 
else if </b></font>sreg<font color="#808080">=</font>opLivro <font color="#000080"><b>then do
   if </b></font>nNum <font color="#808080">= </font><font color="#FF0000">1 </font><font color="#000080"><b>then </b></font>g_nTamChave<font color="#808080">=</font><font color="#FF0000">13
   </font><font color="#000080"><b>else if </b></font>nNum <font color="#808080">= </font><font color="#FF0000">2 </font><font color="#000080"><b>then </b></font>g_nTamChave<font color="#808080">=</font><font color="#FF0000">50
   </font><font color="#000080"><b>else if </b></font>nNum <font color="#808080">= </font><font color="#FF0000">3 </font><font color="#000080"><b>then </b></font>g_nTamChave<font color="#808080">=</font><font color="#FF0000">10
   </font><font color="#000080"><b>else if </b></font>nNum <font color="#808080">= </font><font color="#FF0000">4 </font><font color="#000080"><b>then </b></font>g_nTamChave<font color="#808080">=</font><font color="#FF0000">10
   </font><font color="#000080"><b>else if </b></font>nNum <font color="#808080">= </font><font color="#FF0000">5 </font><font color="#000080"><b>then </b></font>g_nTamChave<font color="#808080">=</font><font color="#FF0000">10
   </font><font color="#000080"><b>else if </b></font>nNum <font color="#808080">= </font><font color="#FF0000">6 </font><font color="#000080"><b>then </b></font>g_nTamChave<font color="#808080">=</font><font color="#FF0000">10
   </font><font color="#000080"><b>else if </b></font>nNum <font color="#808080">= </font><font color="#FF0000">7 </font><font color="#000080"><b>then </b></font>g_nTamChave<font color="#808080">=</font><font color="#FF0000">10
   </font><font color="#000080"><b>else if </b></font>nNum <font color="#808080">= </font><font color="#FF0000">8 </font><font color="#000080"><b>then </b></font>g_nTamChave<font color="#808080">=</font><font color="#FF0000">10
   </font><font color="#000080"><b>else if </b></font>nNum <font color="#808080">= </font><font color="#FF0000">9 </font><font color="#000080"><b>then </b></font>g_nTamChave<font color="#808080">=</font><font color="#FF0000">10
   </font><font color="#000080"><b>else if </b></font>nNum <font color="#808080">= </font><font color="#FF0000">10 </font><font color="#000080"><b>then </b></font>g_nTamChave<font color="#808080">=</font><font color="#FF0000">10
</font><font color="#000080"><b>end 
else if </b></font>sreg<font color="#808080">=</font>opLivroAss <font color="#000080"><b>then do
   if </b></font>nNum <font color="#808080">= </font><font color="#FF0000">1 </font><font color="#000080"><b>then </b></font>g_nTamChave<font color="#808080">=</font><font color="#FF0000">13
   </font><font color="#000080"><b>else if </b></font>nNum <font color="#808080">= </font><font color="#FF0000">2 </font><font color="#000080"><b>then </b></font>g_nTamChave<font color="#808080">=</font><font color="#FF0000">10
</font><font color="#000080"><b>end 
else if </b></font>sreg<font color="#808080">=</font>opLivroAut <font color="#000080"><b>then do
   if </b></font>nNum <font color="#808080">= </font><font color="#FF0000">1 </font><font color="#000080"><b>then </b></font>g_nTamChave<font color="#808080">=</font><font color="#FF0000">13
   </font><font color="#000080"><b>else if </b></font>nNum <font color="#808080">= </font><font color="#FF0000">2 </font><font color="#000080"><b>then </b></font>g_nTamChave<font color="#808080">=</font><font color="#FF0000">10
</font><font color="#000080"><b>end 
else if </b></font>sreg<font color="#808080">=</font>opCliente <font color="#000080"><b>then do
   if </b></font>nNum <font color="#808080">= </font><font color="#FF0000">1 </font><font color="#000080"><b>then </b></font>g_nTamChave<font color="#808080">=</font><font color="#FF0000">14
   </font><font color="#000080"><b>else if </b></font>nNum <font color="#808080">= </font><font color="#FF0000">2 </font><font color="#000080"><b>then </b></font>g_nTamChave<font color="#808080">=</font><font color="#FF0000">30
   </font><font color="#000080"><b>else if </b></font>nNum <font color="#808080">= </font><font color="#FF0000">3 </font><font color="#000080"><b>then </b></font>g_nTamChave<font color="#808080">=</font><font color="#FF0000">30
   </font><font color="#000080"><b>else if </b></font>nNum <font color="#808080">= </font><font color="#FF0000">4 </font><font color="#000080"><b>then </b></font>g_nTamChave<font color="#808080">=</font><font color="#FF0000">10
   </font><font color="#000080"><b>else if </b></font>nNum <font color="#808080">= </font><font color="#FF0000">5 </font><font color="#000080"><b>then </b></font>g_nTamChave<font color="#808080">=</font><font color="#FF0000">1
   </font><font color="#000080"><b>else if </b></font>nNum <font color="#808080">= </font><font color="#FF0000">6 </font><font color="#000080"><b>then </b></font>g_nTamChave<font color="#808080">=</font><font color="#FF0000">17
   </font><font color="#000080"><b>else if </b></font>nNum <font color="#808080">= </font><font color="#FF0000">7 </font><font color="#000080"><b>then </b></font>g_nTamChave<font color="#808080">=</font><font color="#FF0000">10
   </font><font color="#000080"><b>else if </b></font>nNum <font color="#808080">= </font><font color="#FF0000">8 </font><font color="#000080"><b>then </b></font>g_nTamChave<font color="#808080">=</font><font color="#FF0000">10
   </font><font color="#000080"><b>else if </b></font>nNum <font color="#808080">= </font><font color="#FF0000">9 </font><font color="#000080"><b>then </b></font>g_nTamChave<font color="#808080">=</font><font color="#FF0000">3
   </font><font color="#000080"><b>else if </b></font>nNum <font color="#808080">= </font><font color="#FF0000">10 </font><font color="#000080"><b>then </b></font>g_nTamChave<font color="#808080">=</font><font color="#FF0000">10
</font><font color="#000080"><b>end 
else if </b></font>sreg<font color="#808080">=</font>opVenda <font color="#000080"><b>then do
   if </b></font>nNum <font color="#808080">= </font><font color="#FF0000">1 </font><font color="#000080"><b>then </b></font>g_nTamChave<font color="#808080">=</font><font color="#FF0000">19
   </font><font color="#000080"><b>else if </b></font>nNum <font color="#808080">= </font><font color="#FF0000">2 </font><font color="#000080"><b>then </b></font>g_nTamChave<font color="#808080">=</font><font color="#FF0000">14
   </font><font color="#000080"><b>else if </b></font>nNum <font color="#808080">= </font><font color="#FF0000">3 </font><font color="#000080"><b>then </b></font>g_nTamChave<font color="#808080">=</font><font color="#FF0000">13
   </font><font color="#000080"><b>else if </b></font>nNum <font color="#808080">= </font><font color="#FF0000">4 </font><font color="#000080"><b>then </b></font>g_nTamChave<font color="#808080">=</font><font color="#FF0000">10
</font><font color="#000080"><b>end

return </b></font>g_nTamChave
<font color="#008000"><i>/*------------------------------------------------------------------------------
Indica se continua ou n&atilde;o mostrando um n&uacute;mero m&aacute;ximo de linhas.
nlinha - a linha a ser continuada
nQtdLinha - a quantidade de linhas a serem mostradas
retorna - se continua ou n&atilde;o
------------------------------------------------------------------------------*/
</i></font>ContinuaSN<font color="#808080">: </font><font color="#000080"><b>procedure
  parse arg </b></font>nlinha<font color="#808080">, </font>nQtdLinha

<font color="#000080"><b>call </b></font>constantes
bSOp<font color="#808080">=</font>false
opCSubMenu <font color="#808080">= ''
</font>bret<font color="#808080">=</font>false
<font color="#000080"><b>if </b></font>nlinha <font color="#808080">&gt; </font><font color="#FF0000">0 </font><font color="#000080"><b>then do
  if </b></font><font color="#808080">(</font>nlinha <font color="#808080">// </font>nQtdLinha<font color="#808080">) = </font><font color="#FF0000">0 </font><font color="#000080"><b>then do
    </b></font>bSOp<font color="#808080">=</font>true
    <font color="#000080"><b>do </b></font>while bSOp
      menu<font color="#808080">(</font><font color="#FF0000">13</font><font color="#808080">)
      </font>opCSubMenu <font color="#808080">= </font><font color="#0000FF"><b>linein</b></font><font color="#808080">()
      </font><font color="#000080"><b>if </b></font><font color="#808080">(</font>opCSubMenu<font color="#808080">='</font>S<font color="#808080">') | (</font>opCSubMenu<font color="#808080">='</font>s<font color="#808080">') </font><font color="#000080"><b>then </b></font>bSOp<font color="#808080">=</font>false
      <font color="#000080"><b>else if </b></font><font color="#808080">(</font>opCSubMenu<font color="#808080">='</font>N<font color="#808080">') | (</font>opCSubMenu<font color="#808080">='</font>n<font color="#808080">') </font><font color="#000080"><b>then do
        </b></font>bret<font color="#808080">=</font>true
        bSOp<font color="#808080">=</font>false
      <font color="#000080"><b>end 
      else say </b></font>MSG_ERRO
    <font color="#000080"><b>end 
  end
end

return </b></font>bret
<font color="#008000"><i>/*------------------------------------------------------------------------------
Lista v&aacute;rios registros de acordo com a pesquisa feita.
sArq - o arquivo
sreg - o tipo de arquivo
sChave - a chave a ser pesquisada
nPosChave - a posicao inicial da chave dentro do registro
nTamChave - o tamanho da chave dentro do registro
nTamLinha - o tamanho do registro
nQtdLinha - a quantidade de linhas a serem mostradas
retorna - se encontrou algum registro
------------------------------------------------------------------------------*/
</i></font>ListarTodos<font color="#808080">: </font><font color="#000080"><b>procedure
  parse arg </b></font>sArq<font color="#808080">, </font>sreg<font color="#808080">, </font>sChave<font color="#808080">, </font>nPosChave<font color="#808080">, </font>nTamChave<font color="#808080">, </font>nTamLinha<font color="#808080">, 
            </font>nQtdLinha<font color="#808080">, </font>bPesqRelativa

<font color="#000080"><b>call </b></font>constantes
slinha <font color="#808080">= ''; </font>sres <font color="#808080">= ''
</font>bAchou <font color="#808080">= </font>false
bRet<font color="#808080">=</font>false
bQuebra<font color="#808080">=</font>false
nCont<font color="#808080">=</font><font color="#FF0000">0
</font><font color="#000080"><b>call </b></font>mostrarDados sreg<font color="#808080">, '', </font><font color="#FF0000">2
</font><font color="#000080"><b>call </b></font><font color="#808000"><b>stream </b></font>sArq<font color="#808080">, '</font>C<font color="#808080">', '</font><font color="#808000"><b>SEEK </b></font><font color="#808080">=</font><font color="#FF0000">0 </font>READ <font color="#0000FF"><b>LINE</b></font><font color="#808080">'
</font><font color="#000080"><b>do </b></font>while <font color="#808080">(</font>fimArq<font color="#808080">(</font>sArq<font color="#808080">)=</font>false<font color="#808080">) &amp; (</font>bQuebra<font color="#808080">=</font>false<font color="#808080">)
  </font>slinha <font color="#808080">= </font><font color="#0000FF"><b>linein</b></font><font color="#808080">(</font>sArq<font color="#808080">)
  </font><font color="#000080"><b>if </b></font>bPesqRelativa<font color="#808080">=</font>true <font color="#000080"><b>then do
    </b></font>sres<font color="#808080">=</font><font color="#808000"><b>strip</b></font><font color="#808080">(</font><font color="#808000"><b>substr</b></font><font color="#808080">(</font>slinha<font color="#808080">,</font>nPosChave<font color="#808080">,</font>nTamChave<font color="#808080">))
    </font><font color="#000080"><b>if </b></font>strRelativa<font color="#808080">(</font>sres<font color="#808080">,</font>sChave<font color="#808080">) </font><font color="#000080"><b>then do
       </b></font>bAchou<font color="#808080">=</font>true
       bRet<font color="#808080">=</font>true
    <font color="#000080"><b>end 
    else
       </b></font>bAchou<font color="#808080">=</font>false
  <font color="#000080"><b>end 
  else do
    </b></font>bAchou<font color="#808080">=</font>true
    bRet<font color="#808080">=</font>true
  <font color="#000080"><b>end

  if </b></font>bAchou <font color="#000080"><b>then do
    call </b></font>mostrarDados sreg<font color="#808080">, </font><font color="#808000"><b>substr</b></font><font color="#808080">(</font>slinha<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font>nTamLinha<font color="#808080">), </font><font color="#FF0000">3
    </font>nCont<font color="#808080">=</font>nCont<font color="#808080">+</font><font color="#FF0000">1
  </font><font color="#000080"><b>end

  </b></font>bQuebra<font color="#808080">=</font>ContinuaSN<font color="#808080">(</font>nCont<font color="#808080">, </font>nQtdLinha<font color="#808080">)
</font><font color="#000080"><b>end
return </b></font>bRet
<font color="#008000"><i>/*------------------------------------------------------------------------------
Lista v&aacute;rios registros entre arquivos de acordo com a pesquisa feita.
sArq1 - o arquivo de liga&ccedil;&atilde;o
sreg1 - o tipo de arquivo de liga&ccedil;&atilde;o
nPosChave1 - a posicao inicial da primeira chave no arquivo de liga&ccedil;&atilde;o
nTamChave1 - o tamanho da primeira chave no arquivo de liga&ccedil;&atilde;o
nPosChave2 - a posicao inicial da segunda chave do arquivo de liga&ccedil;&atilde;o
nTamChave2 - o tamanho da segunda chave do arquivo de liga&ccedil;&atilde;o
sChave - a chave a ser pesquisada no arquivo de liga&ccedil;&atilde;o
sArq2 - o arquivo a ser pesquisado
sreg2 - o tipo de arquivo a ser pesquisado
nPosChave3 - a posicao inicial da chave do arquivo pesquisado
nQtdLinha - a quantidade de linhas a serem mostradas
------------------------------------------------------------------------------*/
</i></font>ListarRegLigados<font color="#808080">: </font><font color="#000080"><b>procedure
 parse arg </b></font>sArq1<font color="#808080">, </font>sreg1<font color="#808080">, </font>nPosChave1<font color="#808080">, </font>nTamChave1<font color="#808080">, </font>nPosChave2<font color="#808080">, </font>nTamChave2<font color="#808080">, </font>sChave<font color="#808080">,
 </font>sArq2<font color="#808080">, </font>sreg2<font color="#808080">, </font>nPosChave3<font color="#808080">, </font>nQtdLinha

<font color="#000080"><b>call </b></font>constantes
slinha1 <font color="#808080">= ''; </font>sCodigo1 <font color="#808080">= ''; </font>sCodigo2 <font color="#808080">= ''; </font>slinha2 <font color="#808080">= ''
</font>bRet<font color="#808080">=</font>false
nCont<font color="#808080">=</font><font color="#FF0000">0
</font>bQuebra<font color="#808080">=</font>false
mostrarDados<font color="#808080">(</font>sreg2<font color="#808080">, '', </font><font color="#FF0000">2</font><font color="#808080">)
</font><font color="#000080"><b>call </b></font><font color="#808000"><b>stream </b></font>sArq1<font color="#808080">, '</font>C<font color="#808080">', '</font><font color="#808000"><b>SEEK </b></font><font color="#808080">=</font><font color="#FF0000">0 </font>READ <font color="#0000FF"><b>LINE</b></font><font color="#808080">'
</font><font color="#000080"><b>do </b></font>while <font color="#808080">(</font>fimArq<font color="#808080">(</font>sArq1<font color="#808080">)=</font>false<font color="#808080">) &amp; (</font>bQuebra<font color="#808080">=</font>false<font color="#808080">)
  </font>slinha1 <font color="#808080">= </font><font color="#0000FF"><b>linein</b></font><font color="#808080">(</font>sArq1<font color="#808080">)
  </font>sCodigo1<font color="#808080">=</font><font color="#808000"><b>strip</b></font><font color="#808080">(</font><font color="#808000"><b>substr</b></font><font color="#808080">(</font>slinha1<font color="#808080">,</font>nPosChave1<font color="#808080">,</font>nTamChave1<font color="#808080">))
  </font><font color="#000080"><b>if </b></font>sCodigo1<font color="#808080">=</font>sChave <font color="#000080"><b>then do
    </b></font>sCodigo2<font color="#808080">=</font><font color="#808000"><b>strip</b></font><font color="#808080">(</font><font color="#808000"><b>substr</b></font><font color="#808080">(</font>slinha1<font color="#808080">,</font>nPosChave2<font color="#808080">,</font>nTamChave2<font color="#808080">))
    </font>slinha2<font color="#808080">=</font>pesqArq<font color="#808080">(</font>sArq2<font color="#808080">, </font>sCodigo2<font color="#808080">, </font>nPosChave3<font color="#808080">, </font>nTamChave2<font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg2<font color="#808080">))
    </font>mostrarDados<font color="#808080">(</font>sreg2<font color="#808080">, </font><font color="#808000"><b>substr</b></font><font color="#808080">(</font>slinha2<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg2<font color="#808080">)), </font><font color="#FF0000">3</font><font color="#808080">)
    </font>bRet<font color="#808080">=</font>true
    nCont<font color="#808080">=</font>nCont<font color="#808080">+</font><font color="#FF0000">1
  </font><font color="#000080"><b>end
  </b></font>bQuebra<font color="#808080">=</font>ContinuaSN<font color="#808080">(</font>nCont<font color="#808080">, </font>nQtdLinha<font color="#808080">)
</font><font color="#000080"><b>end
if </b></font>bRet<font color="#808080">=</font>false <font color="#000080"><b>then
   say </b></font>rotulo<font color="#808080">(</font>sreg2<font color="#808080">,</font><font color="#FF0000">0</font><font color="#808080">)
</font><font color="#000080"><b>return
</b></font><font color="#008000"><i>/*------------------------------------------------------------------------------
Valida a entrada de registros de acordo com a pesquisa feita.
sArq - o arquivo
sreg - o tipo de arquivo
nTexto - o numero do r&oacute;tulo da entrada
sEntrada - a chave a ser pesquisada e validada
nTentativas - o n&uacute;mero m&aacute;ximo de tentativas
bPesqRelativa - indica se vai realizar uma pesquisa relativa
bTipoEntrada - indica o tipo de entrada
retorna - o registro pesquisado e validado
------------------------------------------------------------------------------*/
</i></font>validaEntrada<font color="#808080">: </font><font color="#000080"><b>procedure
  parse arg </b></font>sArq<font color="#808080">,</font>sreg<font color="#808080">,</font>nTexto<font color="#808080">,</font>sEntrada<font color="#808080">,</font>nTentativas<font color="#808080">,</font>bPesqRelativa<font color="#808080">,</font>bTipoEntrada

<font color="#000080"><b>call </b></font>constantes
sres <font color="#808080">= '' 
</font>nTamLinha<font color="#808080">=</font>tamReg<font color="#808080">(</font>sreg<font color="#808080">)
</font>sMsgErro<font color="#808080">=</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">,</font><font color="#FF0000">0</font><font color="#808080">)
</font>sTexto<font color="#808080">=</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">,</font>nTexto<font color="#808080">)
</font>nPosChave<font color="#808080">=</font>gnPosChave<font color="#808080">(</font>sreg<font color="#808080">,</font>nTexto<font color="#808080">)
</font>nTamChave<font color="#808080">=</font>gnTamChave<font color="#808080">(</font>sreg<font color="#808080">,</font>nTexto<font color="#808080">)

</font>ncont<font color="#808080">=</font><font color="#FF0000">1
</font>bQuebra<font color="#808080">=</font>false
  <font color="#000080"><b>do </b></font>while <font color="#808080">(</font>bQuebra<font color="#808080">=</font>false<font color="#808080">) &amp; (</font>ncont <font color="#808080">&lt;= </font>nTentativas <font color="#808080">)
    </font><font color="#000080"><b>if </b></font>bTipoEntrada<font color="#808080">=</font>opTexto <font color="#000080"><b>then do
      call </b></font><font color="#0000FF"><b>charout </b></font><font color="#808080">,</font>sTexto
      sEntrada <font color="#808080">= </font><font color="#0000FF"><b>linein</b></font><font color="#808080">()
    </font><font color="#000080"><b>end 
    else if </b></font>bTipoEntrada<font color="#808080">=</font>opNumero <font color="#000080"><b>then
       </b></font>sEntrada<font color="#808080">=</font>validaNumero<font color="#808080">(</font>sTexto<font color="#808080">,</font>sEntrada<font color="#808080">)
    </font><font color="#000080"><b>else if </b></font>bTipoEntrada<font color="#808080">=</font>opData <font color="#000080"><b>then
       </b></font>sEntrada<font color="#808080">=</font>validaDataHora<font color="#808080">(</font>sTexto<font color="#808080">,</font>sEntrada<font color="#808080">,</font>true<font color="#808080">)
    </font><font color="#000080"><b>else if </b></font>bTipoEntrada<font color="#808080">=</font>opDataHora <font color="#000080"><b>then
       </b></font>sEntrada<font color="#808080">=</font>validaDataHora<font color="#808080">(</font>sTexto<font color="#808080">,</font>sEntrada<font color="#808080">,</font>false<font color="#808080">)
    </font><font color="#000080"><b>else if </b></font>bTipoEntrada<font color="#808080">=</font>opSenha <font color="#000080"><b>then 
       </b></font>sEntrada<font color="#808080">=</font>digitaSenha<font color="#808080">(</font>sTexto<font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">)

    </font><font color="#000080"><b>if </b></font>bPesqRelativa<font color="#808080">=</font>true <font color="#000080"><b>then do
       if </b></font>ListarTodos<font color="#808080">(</font>sArq<font color="#808080">,</font>sreg<font color="#808080">,</font>sEntrada<font color="#808080">,</font>nPosChave<font color="#808080">,</font>nTamChave<font color="#808080">,</font>nTamLinha<font color="#808080">,
          </font>QTD_MAX_LINHA<font color="#808080">,</font>true<font color="#808080">)=</font>true <font color="#000080"><b>then
          </b></font>sres<font color="#808080">=' '
    </font><font color="#000080"><b>end 
    else
      </b></font>sres<font color="#808080">=</font>pesqArq<font color="#808080">(</font>sArq<font color="#808080">, </font>sEntrada<font color="#808080">, </font>nPosChave<font color="#808080">, </font>nTamChave<font color="#808080">, </font>nTamLinha<font color="#808080">)   

    </font><font color="#000080"><b>if </b></font>sres<font color="#808080">='' </font><font color="#000080"><b>then
       say </b></font>sMsgErro
    <font color="#000080"><b>else
       </b></font>bQuebra<font color="#808080">=</font>true

    ncont<font color="#808080">=</font>ncont<font color="#808080">+</font><font color="#FF0000">1
  </font><font color="#000080"><b>end
return </b></font>sres
<font color="#008000"><i>/*------------------------------------------------------------------------------
Mostra a tela de splash do sistema.
------------------------------------------------------------------------------*/
</i></font>frmSplash<font color="#808080">: </font><font color="#000080"><b>procedure

call </b></font>constantes
cont <font color="#808080">= </font><font color="#FF0000">0
 </font><font color="#000080"><b>say </b></font><font color="#808080">'*---------------------------------------',
 '-------------------------------------*'
 </font><font color="#000080"><b>say </b></font><font color="#808080">'| </font>LL    II VV   VV RRRRR  UU  UU   SSSS <font color="#808080">',
 '</font>VV   VV II RRRRR  TTTT UU  UU   SSSS <font color="#808080">|'
 </font><font color="#000080"><b>say </b></font><font color="#808080">'| </font>LL    II  VV VV  RR   R UU  UU  SS    <font color="#808080">',
 ' </font>VV VV  II RR   R  TT  UU  UU  SS    <font color="#808080">|'
 </font><font color="#000080"><b>say </b></font><font color="#808080">'| </font>LL    II   VVV   RRRRR  UU  UU    SS  <font color="#808080">',
 '  </font>VVV   II RRRRR   TT  UU  UU    SS  <font color="#808080">|'
 </font><font color="#000080"><b>say </b></font><font color="#808080">'| </font>LLLLL II    V    RR   R  UUUU  SSSS   <font color="#808080">',
 '   </font>V    II RR   R  TT   UUUU  SSSS   <font color="#808080">|'
 </font><font color="#000080"><b>say </b></font><font color="#808080">'*---------------------------------------',
 '-------------------------------------*'
 </font><font color="#000080"><b>do </b></font>cont<font color="#808080">=</font><font color="#FF0000">1 </font><font color="#000080"><b>to </b></font><font color="#FF0000">18 
   </font><font color="#000080"><b>say </b></font><font color="#808080">''
 </font><font color="#000080"><b>end
 call </b></font><font color="#0000FF"><b>charout </b></font><font color="#808080">,</font>MSG_PRESS
 cont <font color="#808080">= </font><font color="#0000FF"><b>linein</b></font><font color="#808080">()
</font><font color="#000080"><b>return
</b></font><font color="#008000"><i>/*------------------------------------------------------------------------------
Mostra a tela de sobre do sistema.
------------------------------------------------------------------------------*/
</i></font>frmSobre<font color="#808080">: </font><font color="#000080"><b>procedure

call </b></font>constantes
cont <font color="#808080">= </font><font color="#FF0000">0
 </font><font color="#000080"><b>say </b></font><font color="#808080">'*------------------------------------------------------------*'
 </font><font color="#000080"><b>say </b></font><font color="#808080">'|  </font>LL        II  VV       VV  RRRRRRR   UU    UU   SSSSSSS   <font color="#808080">|'
 </font><font color="#000080"><b>say </b></font><font color="#808080">'|  </font>LL        II   VV     VV   RR     R  UU    UU  SS         <font color="#808080">|'
 </font><font color="#000080"><b>say </b></font><font color="#808080">'|  </font>LL        II    VV   VV    RR     R  UU    UU   SSSS      <font color="#808080">|'
 </font><font color="#000080"><b>say </b></font><font color="#808080">'|  </font>LL        II     VV VV     RRRRRRR   UU    UU     SSSS    <font color="#808080">|'
 </font><font color="#000080"><b>say </b></font><font color="#808080">'|  </font>LLLL      II      VVV      RR RR     UU    UU        SS   <font color="#808080">|'
 </font><font color="#000080"><b>say </b></font><font color="#808080">'|  </font>LLLLLLLL  II       V       RR   RR    UUUUUU   SSSSSSSS   <font color="#808080">|'
 </font><font color="#000080"><b>say </b></font><font color="#808080">'|                                                            |'
 </font><font color="#000080"><b>say </b></font><font color="#808080">'|  </font>VV       VV  II  RRRRRRR   TTTTTTTT  UU    UU   SSSSSSS   <font color="#808080">|'
 </font><font color="#000080"><b>say </b></font><font color="#808080">'|   </font>VV     VV   II  RR     R     TT     UU    UU  SS         <font color="#808080">|'
 </font><font color="#000080"><b>say </b></font><font color="#808080">'|    </font>VV   VV    II  RR     R     TT     UU    UU   SSSS      <font color="#808080">|'
 </font><font color="#000080"><b>say </b></font><font color="#808080">'|     </font>VV VV     II  RRRRRRR      TT     UU    UU     SSSS    <font color="#808080">|'
 </font><font color="#000080"><b>say </b></font><font color="#808080">'|      </font>VVV      II  RR RR        TT     UU    UU        SS   <font color="#808080">|'
 </font><font color="#000080"><b>say </b></font><font color="#808080">'|       </font>V       II  RR   RR      TT      UUUUUU   SSSSSSSS   <font color="#808080">|'
 </font><font color="#000080"><b>say </b></font><font color="#808080">'|                                                            |'
 </font><font color="#000080"><b>say </b></font><font color="#808080">'|                                               </font>Versao <font color="#FF0000">1.0.0 </font><font color="#808080">|'
 </font><font color="#000080"><b>say </b></font><font color="#808080">'| </font>Sistema integrante <font color="#000080"><b>do </b></font>projeto Livrus Virtus<font color="#808080">.               |'
 </font><font color="#000080"><b>say </b></font><font color="#808080">'| </font>Todos os direitos reservados para Henrique F<font color="#808080">. </font>de Souza<font color="#808080">.    |'
 </font><font color="#000080"><b>say </b></font><font color="#808080">'| </font>Versao programada na linguagem rexx<font color="#808080">.                       |'
 </font><font color="#000080"><b>say </b></font><font color="#808080">'*------------------------------------------------------------*'
 </font><font color="#000080"><b>do </b></font>cont<font color="#808080">=</font><font color="#FF0000">1 </font><font color="#000080"><b>to </b></font><font color="#FF0000">4
   </font><font color="#000080"><b>say </b></font><font color="#808080">''
 </font><font color="#000080"><b>end
 call </b></font><font color="#0000FF"><b>charout </b></font><font color="#808080">,</font>MSG_PRESS
 cont <font color="#808080">= </font><font color="#0000FF"><b>linein</b></font><font color="#808080">()
</font><font color="#000080"><b>return
</b></font><font color="#008000"><i>/*------------------------------------------------------------------------------
Mostra a tela de login do sistema.
retorna - se o login foi validado corretamente
------------------------------------------------------------------------------*/
</i></font>frmLogin<font color="#808080">: </font><font color="#000080"><b>procedure

call </b></font>constantes
slinha <font color="#808080">= ''
</font>bret<font color="#808080">=</font>false
<font color="#000080"><b>say </b></font><font color="#808080">'*--------------------------------------------------------------*'
</font><font color="#000080"><b>say </b></font><font color="#808080">'| </font>Login <font color="#000080"><b>do </b></font>sistema                                             <font color="#808080">|'
</font><font color="#000080"><b>say </b></font><font color="#808080">'*--------------------------------------------------------------*'
</font>slinha<font color="#808080">=</font>validaEntrada<font color="#808080">(</font>tfUsuario<font color="#808080">, </font>opUsuario<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font>tUsuario<font color="#808080">.</font>login<font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">, </font>false<font color="#808080">, </font>opTexto<font color="#808080">)
</font><font color="#000080"><b>if </b></font>slinha<font color="#808080">&lt;&gt;'' </font><font color="#000080"><b>then do
   </b></font>slinha<font color="#808080">=</font>validaEntrada<font color="#808080">(</font>tfUsuario<font color="#808080">, </font>opUsuario<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">, </font>tUsuario<font color="#808080">.</font>senha<font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">, </font>false<font color="#808080">, </font>opSenha<font color="#808080">)
   </font><font color="#000080"><b>if </b></font>slinha<font color="#808080">&lt;&gt;'' </font><font color="#000080"><b>then do
      </b></font>tUsuario<font color="#808080">.</font>login<font color="#808080">=</font><font color="#808000"><b>strip</b></font><font color="#808080">(</font><font color="#808000"><b>substr</b></font><font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">))
      </font>tUsuario<font color="#808080">.</font>senha<font color="#808080">=</font><font color="#808000"><b>strip</b></font><font color="#808080">(</font><font color="#808000"><b>substr</b></font><font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">11</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">))
      </font>bret<font color="#808080">=</font>true
   <font color="#000080"><b>end
end
say </b></font><font color="#808080">''
</font><font color="#000080"><b>return </b></font>bret
<font color="#008000"><i>/*------------------------------------------------------------------------------
Mostra os menus do sistema.
num - o n&uacute;mero do menu
------------------------------------------------------------------------------*/
</i></font>menu<font color="#808080">: </font><font color="#000080"><b>procedure
  parse arg </b></font>num

<font color="#000080"><b>call </b></font>constantes
 <font color="#000080"><b>if </b></font><font color="#808080">(</font>num<font color="#808080">=</font><font color="#FF0000">1</font><font color="#808080">) </font><font color="#000080"><b>then do
  say </b></font><font color="#808080">'*--------------------------------------------------------------*'
  </font><font color="#000080"><b>say </b></font><font color="#808080">'| (</font>C<font color="#808080">)</font>adastros        <font color="#808080">(</font>P<font color="#808080">)</font>esquisas     <font color="#808080">(</font>V<font color="#808080">)</font>endas        <font color="#808080">(</font>O<font color="#808080">)</font>p<font color="#808080">&ccedil;&otilde;</font>es  <font color="#808080">|'
  </font><font color="#000080"><b>say </b></font><font color="#808080">'*--------------------------------------------------------------*'
 </font><font color="#000080"><b>end 
 else if </b></font><font color="#808080">(</font>num<font color="#808080">=</font><font color="#FF0000">2</font><font color="#808080">) </font><font color="#000080"><b>then do
   say </b></font><font color="#808080">'*---------------------------------*'
   </font><font color="#000080"><b>say </b></font><font color="#808080">'| </font><font color="#FF0000">01. </font>Cadastro de Assuntos        <font color="#808080">|'
   </font><font color="#000080"><b>say </b></font><font color="#808080">'| </font><font color="#FF0000">02. </font>Cadastro de Autores         <font color="#808080">|'
   </font><font color="#000080"><b>say </b></font><font color="#808080">'| </font><font color="#FF0000">03. </font>Cadastro de Editoras        <font color="#808080">|'
   </font><font color="#000080"><b>say </b></font><font color="#808080">'| </font><font color="#FF0000">04. </font>Cadastro de Endere<font color="#808080">&ccedil;</font>os       <font color="#808080">|'
   </font><font color="#000080"><b>say </b></font><font color="#808080">'| </font><font color="#FF0000">05. </font>Cadastro de Idiomas         <font color="#808080">|'
   </font><font color="#000080"><b>say </b></font><font color="#808080">'| </font><font color="#FF0000">06. </font>Cadastro de Pa<font color="#808080">&iacute;</font>ses          <font color="#808080">|'
   </font><font color="#000080"><b>say </b></font><font color="#808080">'| </font><font color="#FF0000">07. </font>Cadastro de Profiss<font color="#808080">&otilde;</font>es      <font color="#808080">|'
   </font><font color="#000080"><b>say </b></font><font color="#808080">'| </font><font color="#FF0000">08. </font>Cadastro de Clientes        <font color="#808080">|'
   </font><font color="#000080"><b>say </b></font><font color="#808080">'| </font><font color="#FF0000">09. </font>Cadastro de Livros          <font color="#808080">|'
   </font><font color="#000080"><b>say </b></font><font color="#808080">'| </font><font color="#FF0000">10. </font>Voltar ao menu              <font color="#808080">|'
   </font><font color="#000080"><b>say </b></font><font color="#808080">'*---------------------------------*'
 </font><font color="#000080"><b>end 
 else if </b></font><font color="#808080">(</font>num<font color="#808080">=</font><font color="#FF0000">3</font><font color="#808080">) </font><font color="#000080"><b>then do
   say </b></font><font color="#808080">'*---------------------------------*'
   </font><font color="#000080"><b>say </b></font><font color="#808080">'| </font><font color="#FF0000">01. </font>Consulta de Assuntos        <font color="#808080">|'
   </font><font color="#000080"><b>say </b></font><font color="#808080">'| </font><font color="#FF0000">02. </font>Consulta de Autores         <font color="#808080">|'
   </font><font color="#000080"><b>say </b></font><font color="#808080">'| </font><font color="#FF0000">03. </font>Consulta de Editoras        <font color="#808080">|'
   </font><font color="#000080"><b>say </b></font><font color="#808080">'| </font><font color="#FF0000">04. </font>Consulta de Endere<font color="#808080">&ccedil;</font>os       <font color="#808080">|'
   </font><font color="#000080"><b>say </b></font><font color="#808080">'| </font><font color="#FF0000">05. </font>Consulta de Idiomas         <font color="#808080">|'
   </font><font color="#000080"><b>say </b></font><font color="#808080">'| </font><font color="#FF0000">06. </font>Consulta de Pa<font color="#808080">&iacute;</font>ses          <font color="#808080">|'
   </font><font color="#000080"><b>say </b></font><font color="#808080">'| </font><font color="#FF0000">07. </font>Consulta de Profiss<font color="#808080">&otilde;</font>es      <font color="#808080">|'
   </font><font color="#000080"><b>say </b></font><font color="#808080">'| </font><font color="#FF0000">08. </font>Consulta de Clientes        <font color="#808080">|'
   </font><font color="#000080"><b>say </b></font><font color="#808080">'| </font><font color="#FF0000">09. </font>Consulta de Livros          <font color="#808080">|'
   </font><font color="#000080"><b>say </b></font><font color="#808080">'| </font><font color="#FF0000">10. </font>Voltar ao menu              <font color="#808080">|'
   </font><font color="#000080"><b>say </b></font><font color="#808080">'*---------------------------------*'
 </font><font color="#000080"><b>end 
 else if </b></font><font color="#808080">(</font>num<font color="#808080">=</font><font color="#FF0000">4</font><font color="#808080">) </font><font color="#000080"><b>then do
   say </b></font><font color="#808080">'*---------------------------------*'
   </font><font color="#000080"><b>say </b></font><font color="#808080">'| </font><font color="#FF0000">01. </font>Vender Livros               <font color="#808080">|'
   </font><font color="#000080"><b>say </b></font><font color="#808080">'| </font><font color="#FF0000">02. </font>Vendas Realizadas           <font color="#808080">|'
   </font><font color="#000080"><b>say </b></font><font color="#808080">'| </font><font color="#FF0000">03. </font>Voltar ao menu              <font color="#808080">|'
   </font><font color="#000080"><b>say </b></font><font color="#808080">'*---------------------------------*'
 </font><font color="#000080"><b>end 
 else if </b></font><font color="#808080">(</font>num<font color="#808080">=</font><font color="#FF0000">5</font><font color="#808080">) </font><font color="#000080"><b>then do
   say </b></font><font color="#808080">'*---------------------------------*'
   </font><font color="#000080"><b>say </b></font><font color="#808080">'| </font><font color="#FF0000">01. </font>Alterar senha               <font color="#808080">|'
   </font><font color="#000080"><b>say </b></font><font color="#808080">'| </font><font color="#FF0000">02. </font>Sobre o sistema             <font color="#808080">|'
   </font><font color="#000080"><b>say </b></font><font color="#808080">'| </font><font color="#FF0000">03. </font>Sair <font color="#000080"><b>do </b></font>sistema             <font color="#808080">|'
   </font><font color="#000080"><b>say </b></font><font color="#808080">'| </font><font color="#FF0000">04. </font>Voltar ao menu              <font color="#808080">|'
   </font><font color="#000080"><b>say </b></font><font color="#808080">'*---------------------------------*'
 </font><font color="#000080"><b>end 
 else if </b></font><font color="#808080">(</font>num<font color="#808080">=</font><font color="#FF0000">6</font><font color="#808080">) </font><font color="#000080"><b>then do
   say </b></font><font color="#808080">'*--------------------------------------------------------------*'
   </font><font color="#000080"><b>say </b></font><font color="#808080">'| (</font><font color="#FF0000">1</font><font color="#808080">) </font>Novo  <font color="#808080">(</font><font color="#FF0000">2</font><font color="#808080">) </font>Pesquisar   <font color="#808080">(</font><font color="#FF0000">3</font><font color="#808080">) </font>Voltar ao menu                 <font color="#808080">|'
   </font><font color="#000080"><b>say </b></font><font color="#808080">'*--------------------------------------------------------------*'
 </font><font color="#000080"><b>end 
 else if </b></font><font color="#808080">(</font>num<font color="#808080">=</font><font color="#FF0000">7</font><font color="#808080">) </font><font color="#000080"><b>then do
   say </b></font><font color="#808080">'*--------------------------------------------------------------*'
   </font><font color="#000080"><b>say </b></font><font color="#808080">'| (</font><font color="#FF0000">1</font><font color="#808080">) </font>Salvar inclus<font color="#808080">&atilde;</font>o       <font color="#808080">(</font><font color="#FF0000">2</font><font color="#808080">) </font>Voltar ao menu                 <font color="#808080">|'
   </font><font color="#000080"><b>say </b></font><font color="#808080">'*--------------------------------------------------------------*'
 </font><font color="#000080"><b>end 
 else if </b></font><font color="#808080">(</font>num<font color="#808080">=</font><font color="#FF0000">8</font><font color="#808080">) </font><font color="#000080"><b>then do
   say </b></font><font color="#808080">'*--------------------------------------------------------------*'
   </font><font color="#000080"><b>say </b></font><font color="#808080">'| (</font><font color="#FF0000">1</font><font color="#808080">) </font>Alterar       <font color="#808080">(</font><font color="#FF0000">2</font><font color="#808080">) </font>Excluir     <font color="#808080">(</font><font color="#FF0000">3</font><font color="#808080">) </font>Voltar ao menu         <font color="#808080">|'
   </font><font color="#000080"><b>say </b></font><font color="#808080">'*--------------------------------------------------------------*'
 </font><font color="#000080"><b>end 
 else if </b></font><font color="#808080">(</font>num<font color="#808080">=</font><font color="#FF0000">9</font><font color="#808080">) </font><font color="#000080"><b>then do
   say </b></font><font color="#808080">'*--------------------------------------------------------------*'
   </font><font color="#000080"><b>say </b></font><font color="#808080">'| (</font><font color="#FF0000">1</font><font color="#808080">) </font>Salvar altera<font color="#808080">&ccedil;&atilde;</font>o      <font color="#808080">(</font><font color="#FF0000">2</font><font color="#808080">) </font>Voltar ao menu                 <font color="#808080">|'
   </font><font color="#000080"><b>say </b></font><font color="#808080">'*--------------------------------------------------------------*'
 </font><font color="#000080"><b>end 
 else if </b></font><font color="#808080">(</font>num<font color="#808080">=</font><font color="#FF0000">10</font><font color="#808080">) </font><font color="#000080"><b>then do
   say </b></font><font color="#808080">'*--------------------------------------------------------------*'
   </font><font color="#000080"><b>say </b></font><font color="#808080">'| </font>Certeza de excluir<font color="#808080">? (</font>S<font color="#808080">/</font>N<font color="#808080">)                                    |'
   </font><font color="#000080"><b>say </b></font><font color="#808080">'*--------------------------------------------------------------*'
 </font><font color="#000080"><b>end 
 else if </b></font><font color="#808080">(</font>num<font color="#808080">=</font><font color="#FF0000">11</font><font color="#808080">) </font><font color="#000080"><b>then do
   say </b></font><font color="#808080">'*--------------------------------------------------------------*'
   </font><font color="#000080"><b>say </b></font><font color="#808080">'| </font>Deseja sair <font color="#000080"><b>do </b></font>sistema<font color="#808080">? (</font>S<font color="#808080">/</font>N<font color="#808080">)                                |'
   </font><font color="#000080"><b>say </b></font><font color="#808080">'*--------------------------------------------------------------*'
 </font><font color="#000080"><b>end 
 else if </b></font><font color="#808080">(</font>num<font color="#808080">=</font><font color="#FF0000">12</font><font color="#808080">) </font><font color="#000080"><b>then do
   say </b></font><font color="#808080">'*--------------------------------------------------------------*'
   </font><font color="#000080"><b>say </b></font><font color="#808080">'| (</font><font color="#FF0000">1</font><font color="#808080">) </font>Pesquisar  <font color="#808080">(</font><font color="#FF0000">2</font><font color="#808080">) </font>Listar todos   <font color="#808080">(</font><font color="#FF0000">3</font><font color="#808080">) </font>Voltar ao menu         <font color="#808080">|'
   </font><font color="#000080"><b>say </b></font><font color="#808080">'*--------------------------------------------------------------*'
 </font><font color="#000080"><b>end 
 else if </b></font><font color="#808080">(</font>num<font color="#808080">=</font><font color="#FF0000">13</font><font color="#808080">) </font><font color="#000080"><b>then do
   say </b></font><font color="#808080">'*--------------------------------------------------------------*'
   </font><font color="#000080"><b>say </b></font><font color="#808080">'| </font>Deseja continuar<font color="#808080">? (</font>S<font color="#808080">/</font>N<font color="#808080">)                                      |'
   </font><font color="#000080"><b>say </b></font><font color="#808080">'*--------------------------------------------------------------*'
 </font><font color="#000080"><b>end 
 else if </b></font><font color="#808080">(</font>num<font color="#808080">=</font><font color="#FF0000">14</font><font color="#808080">) </font><font color="#000080"><b>then do
   say </b></font><font color="#808080">'*--------------------------------------------------------------*'
   </font><font color="#000080"><b>say </b></font><font color="#808080">'| </font>Salvar inclus<font color="#808080">&atilde;</font>o <font color="#808080">(</font>S<font color="#808080">/</font>N<font color="#808080">)                                        |'
   </font><font color="#000080"><b>say </b></font><font color="#808080">'*--------------------------------------------------------------*'
 </font><font color="#000080"><b>end
 call </b></font><font color="#0000FF"><b>charout </b></font><font color="#808080">,</font>MSG_OPCAO
<font color="#000080"><b>return
</b></font><font color="#008000"><i>/*------------------------------------------------------------------------------
Realiza os cadastros de acordo com o tipo de arquivo.
sreg - o tipo de arquivo
sacao - a a&ccedil;&atilde;o a ser realizada
------------------------------------------------------------------------------*/
</i></font>frmCadastros<font color="#808080">: </font><font color="#000080"><b>procedure expose </b></font>g_SalvarInclusao g_nPreco<font color="#808080">, 
 </font>tAssunto<font color="#808080">.</font>codigo tAssunto<font color="#808080">.</font>assunto tAutor<font color="#808080">.</font>codigo<font color="#808080">,
 </font>tAutor<font color="#808080">.</font>autor tEditora<font color="#808080">.</font>codigo tEditora<font color="#808080">.</font>editora tEndereco<font color="#808080">.</font>codigo<font color="#808080">,
 </font>tEndereco<font color="#808080">.</font>logradouro tEndereco<font color="#808080">.</font>bairro tEndereco<font color="#808080">.</font>cep tEndereco<font color="#808080">.</font>cidade<font color="#808080">,
 </font>tEndereco<font color="#808080">.</font>estado tIdioma<font color="#808080">.</font>codigo tIdioma<font color="#808080">.</font>idioma tPais<font color="#808080">.</font>codigo tPais<font color="#808080">.</font>pais<font color="#808080">,
 </font>tProfissao<font color="#808080">.</font>codigo tProfissao<font color="#808080">.</font>profissao tUsuario<font color="#808080">.</font>login tUsuario<font color="#808080">.</font>senha<font color="#808080">,
 </font>tLivro<font color="#808080">.</font>isbn tLivro<font color="#808080">.</font>titulo tLivro<font color="#808080">.</font>edicao tLivro<font color="#808080">.</font>anopubli tLivro<font color="#808080">.</font>codeditora<font color="#808080">,
 </font>tLivro<font color="#808080">.</font>volume tLivro<font color="#808080">.</font>codidioma tLivro<font color="#808080">.</font>npaginas tLivro<font color="#808080">.</font>preco tLivro<font color="#808080">.</font>qtdestoque<font color="#808080">,
 </font>tLivroAss<font color="#808080">.</font>isbn tlivroAss<font color="#808080">.</font>codassunto tLivroAut<font color="#808080">.</font>isbn tlivroAut<font color="#808080">.</font>codautor<font color="#808080">,
 </font>tCliente<font color="#808080">.</font>cpf tCliente<font color="#808080">.</font>nome tCliente<font color="#808080">.</font>email tCliente<font color="#808080">.</font>identidade tCliente<font color="#808080">.</font>sexo<font color="#808080">,
 </font>tCliente<font color="#808080">.</font>telefone tCliente<font color="#808080">.</font>dtnascimento tCliente<font color="#808080">.</font>codendereco tCliente<font color="#808080">.</font>codpais<font color="#808080">,
 </font>tCliente<font color="#808080">.</font>codprofissao tVenda<font color="#808080">.</font>dthrvenda tVenda<font color="#808080">.</font>cpf tVenda<font color="#808080">.</font>isbn tVenda<font color="#808080">.</font>precovenda

  <font color="#000080"><b>parse arg </b></font>sreg<font color="#808080">, </font>sacao

<font color="#000080"><b>call </b></font>constantes
slinha <font color="#808080">= ''
</font><font color="#000080"><b>if </b></font>sreg<font color="#808080">=</font>opAssunto <font color="#000080"><b>then do
   if </b></font>sacao<font color="#808080">=</font>opNovo <font color="#000080"><b>then do
      </b></font>tAssunto<font color="#808080">.</font>codigo<font color="#808080">=</font>pesqMaxCod<font color="#808080">(</font>tfAssunto<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">))
      </font><font color="#000080"><b>call </b></font>mostrarDados sreg<font color="#808080">, '', </font><font color="#FF0000">1
      </font><font color="#000080"><b>call </b></font>submenu <font color="#FF0000">7</font><font color="#808080">, </font>sreg
   <font color="#000080"><b>end 
   else if </b></font>sacao<font color="#808080">=</font>opPesquisar <font color="#000080"><b>then do
     </b></font>slinha<font color="#808080">=</font>validaEntrada<font color="#808080">(</font>tfAssunto<font color="#808080">,</font>sreg<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font>tAssunto<font color="#808080">.</font>codigo<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font>false<font color="#808080">,</font>opNumero<font color="#808080">)
      </font><font color="#000080"><b>if </b></font>slinha<font color="#808080">&lt;&gt;'' </font><font color="#000080"><b>then do
        call </b></font>mostrarDados sreg<font color="#808080">, '', </font><font color="#FF0000">2
        </font><font color="#000080"><b>call </b></font>mostrarDados sreg<font color="#808080">, </font>slinha<font color="#808080">, </font><font color="#FF0000">3
        </font><font color="#000080"><b>call </b></font>submenu <font color="#FF0000">8</font><font color="#808080">, </font>sreg
      <font color="#000080"><b>end
   end 
   else if </b></font>sacao<font color="#808080">=</font>opAlterar <font color="#000080"><b>then do
      call </b></font>mostrarDados sreg<font color="#808080">, '', </font><font color="#FF0000">1
      </font><font color="#000080"><b>call </b></font>submenu <font color="#FF0000">9</font><font color="#808080">, </font>sreg
   <font color="#000080"><b>end 
   else if </b></font>sacao<font color="#808080">=</font>opExcluir <font color="#000080"><b>then do
      call </b></font>submenu <font color="#FF0000">10</font><font color="#808080">, </font>sreg
   <font color="#000080"><b>end
end 
else if </b></font>sreg<font color="#808080">=</font>opAutor <font color="#000080"><b>then do
   if </b></font>sacao<font color="#808080">=</font>opNovo <font color="#000080"><b>then do
      </b></font>tAutor<font color="#808080">.</font>codigo<font color="#808080">=</font>pesqMaxCod<font color="#808080">(</font>tfAutor<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">))
      </font><font color="#000080"><b>call </b></font>mostrarDados sreg<font color="#808080">, '', </font><font color="#FF0000">1
      </font><font color="#000080"><b>call </b></font>submenu <font color="#FF0000">7</font><font color="#808080">, </font>sreg
   <font color="#000080"><b>end 
   else if </b></font>sacao<font color="#808080">=</font>opPesquisar <font color="#000080"><b>then do
      </b></font>slinha<font color="#808080">=</font>validaEntrada<font color="#808080">(</font>tfAutor<font color="#808080">, </font>sreg<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font>tAutor<font color="#808080">.</font>codigo<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font>false<font color="#808080">,</font>opNumero<font color="#808080">)
      </font><font color="#000080"><b>if </b></font>slinha<font color="#808080">&lt;&gt;'' </font><font color="#000080"><b>then do
        call </b></font>mostrarDados sreg<font color="#808080">, '', </font><font color="#FF0000">2
        </font><font color="#000080"><b>call </b></font>mostrarDados sreg<font color="#808080">, </font>slinha<font color="#808080">, </font><font color="#FF0000">3
        </font><font color="#000080"><b>call </b></font>submenu <font color="#FF0000">8</font><font color="#808080">, </font>sreg
      <font color="#000080"><b>end
   end 
   else if </b></font>sacao<font color="#808080">=</font>opAlterar <font color="#000080"><b>then do
      call </b></font>mostrarDados sreg<font color="#808080">, '', </font><font color="#FF0000">1
      </font><font color="#000080"><b>call </b></font>submenu <font color="#FF0000">9</font><font color="#808080">, </font>sreg
   <font color="#000080"><b>end 
   else if </b></font>sacao<font color="#808080">=</font>opExcluir <font color="#000080"><b>then do
      call </b></font>submenu <font color="#FF0000">10</font><font color="#808080">, </font>sreg
   <font color="#000080"><b>end
end 
else if </b></font>sreg<font color="#808080">=</font>opEditora <font color="#000080"><b>then do
   if </b></font>sacao<font color="#808080">=</font>opNovo <font color="#000080"><b>then do
      </b></font>tEditora<font color="#808080">.</font>codigo<font color="#808080">=</font>pesqMaxCod<font color="#808080">(</font>tfEditora<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">))
      </font><font color="#000080"><b>call </b></font>mostrarDados sreg<font color="#808080">, '', </font><font color="#FF0000">1
      </font><font color="#000080"><b>call </b></font>submenu <font color="#FF0000">7</font><font color="#808080">, </font>sreg
   <font color="#000080"><b>end 
   else if </b></font>sacao<font color="#808080">=</font>opPesquisar <font color="#000080"><b>then do
     </b></font>slinha<font color="#808080">=</font>validaEntrada<font color="#808080">(</font>tfEditora<font color="#808080">,</font>sreg<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font>tEditora<font color="#808080">.</font>codigo<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font>false<font color="#808080">,</font>opNumero<font color="#808080">)
      </font><font color="#000080"><b>if </b></font>slinha<font color="#808080">&lt;&gt;'' </font><font color="#000080"><b>then do
        call </b></font>mostrarDados sreg<font color="#808080">, '', </font><font color="#FF0000">2
        </font><font color="#000080"><b>call </b></font>mostrarDados sreg<font color="#808080">, </font>slinha<font color="#808080">, </font><font color="#FF0000">3
        </font><font color="#000080"><b>call </b></font>submenu <font color="#FF0000">8</font><font color="#808080">, </font>sreg
      <font color="#000080"><b>end
   end 
   else if </b></font>sacao<font color="#808080">=</font>opAlterar <font color="#000080"><b>then do
      call </b></font>mostrarDados sreg<font color="#808080">, '', </font><font color="#FF0000">1
      </font><font color="#000080"><b>call </b></font>submenu <font color="#FF0000">9</font><font color="#808080">, </font>sreg
   <font color="#000080"><b>end 
   else if </b></font>sacao<font color="#808080">=</font>opExcluir <font color="#000080"><b>then do
      call </b></font>submenu <font color="#FF0000">10</font><font color="#808080">, </font>sreg
   <font color="#000080"><b>end
end 
else if </b></font>sreg<font color="#808080">=</font>opEndereco <font color="#000080"><b>then do
   if </b></font>sacao<font color="#808080">=</font>opNovo <font color="#000080"><b>then do
      </b></font>tEndereco<font color="#808080">.</font>codigo<font color="#808080">=</font>pesqMaxCod<font color="#808080">(</font>tfEndereco<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">))
      </font><font color="#000080"><b>call </b></font>mostrarDados sreg<font color="#808080">, '', </font><font color="#FF0000">1
      </font><font color="#000080"><b>call </b></font>submenu <font color="#FF0000">7</font><font color="#808080">, </font>sreg
   <font color="#000080"><b>end 
   else if </b></font>sacao<font color="#808080">=</font>opPesquisar <font color="#000080"><b>then do
      </b></font>slinha<font color="#808080">=</font>validaEntrada<font color="#808080">(</font>tfEndereco<font color="#808080">,</font>sreg<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font>tEndereco<font color="#808080">.</font>codigo<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,
              </font>false<font color="#808080">,</font>opNumero<font color="#808080">)
      </font><font color="#000080"><b>if </b></font>slinha<font color="#808080">&lt;&gt;'' </font><font color="#000080"><b>then do
        call </b></font>mostrarDados sreg<font color="#808080">, '', </font><font color="#FF0000">2
        </font><font color="#000080"><b>call </b></font>mostrarDados sreg<font color="#808080">, </font>slinha<font color="#808080">, </font><font color="#FF0000">3
        </font><font color="#000080"><b>call </b></font>submenu <font color="#FF0000">8</font><font color="#808080">, </font>sreg
      <font color="#000080"><b>end
   end 
   else if </b></font>sacao<font color="#808080">=</font>opAlterar <font color="#000080"><b>then do
      call </b></font>mostrarDados sreg<font color="#808080">, '', </font><font color="#FF0000">1
      </font><font color="#000080"><b>call </b></font>submenu <font color="#FF0000">9</font><font color="#808080">, </font>sreg
   <font color="#000080"><b>end 
   else if </b></font>sacao<font color="#808080">=</font>opExcluir <font color="#000080"><b>then do
      call </b></font>submenu <font color="#FF0000">10</font><font color="#808080">, </font>sreg
   <font color="#000080"><b>end
end 
else if </b></font>sreg<font color="#808080">=</font>opIdioma <font color="#000080"><b>then do
   if </b></font>sacao<font color="#808080">=</font>opNovo <font color="#000080"><b>then do
      </b></font>tIdioma<font color="#808080">.</font>codigo<font color="#808080">=</font>pesqMaxCod<font color="#808080">(</font>tfIdioma<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">))
      </font><font color="#000080"><b>call </b></font>mostrarDados sreg<font color="#808080">, '', </font><font color="#FF0000">1
      </font><font color="#000080"><b>call </b></font>submenu <font color="#FF0000">7</font><font color="#808080">, </font>sreg
   <font color="#000080"><b>end 
   else if </b></font>sacao<font color="#808080">=</font>opPesquisar <font color="#000080"><b>then do
      </b></font>slinha<font color="#808080">=</font>validaEntrada<font color="#808080">(</font>tfIdioma<font color="#808080">,</font>sreg<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font>tIdioma<font color="#808080">.</font>codigo<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font>false<font color="#808080">,</font>opNumero<font color="#808080">)
      </font><font color="#000080"><b>if </b></font>slinha<font color="#808080">&lt;&gt;'' </font><font color="#000080"><b>then do
        call </b></font>mostrarDados sreg<font color="#808080">, '', </font><font color="#FF0000">2
        </font><font color="#000080"><b>call </b></font>mostrarDados sreg<font color="#808080">, </font>slinha<font color="#808080">, </font><font color="#FF0000">3
        </font><font color="#000080"><b>call </b></font>submenu <font color="#FF0000">8</font><font color="#808080">, </font>sreg
      <font color="#000080"><b>end
   end 
   else if </b></font>sacao<font color="#808080">=</font>opAlterar <font color="#000080"><b>then do
      call </b></font>mostrarDados sreg<font color="#808080">, '', </font><font color="#FF0000">1
      </font><font color="#000080"><b>call </b></font>submenu <font color="#FF0000">9</font><font color="#808080">, </font>sreg
   <font color="#000080"><b>end 
   else if </b></font>sacao<font color="#808080">=</font>opExcluir <font color="#000080"><b>then do
      call </b></font>submenu <font color="#FF0000">10</font><font color="#808080">, </font>sreg
   <font color="#000080"><b>end
end 
else if </b></font>sreg<font color="#808080">=</font>opPais <font color="#000080"><b>then do
   if </b></font>sacao<font color="#808080">=</font>opNovo <font color="#000080"><b>then do
      call </b></font><font color="#0000FF"><b>charout </b></font><font color="#808080">,</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">)
      </font>tPais<font color="#808080">.</font>codigo <font color="#808080">= </font><font color="#0000FF"><b>linein</b></font><font color="#808080">()
      </font>slinha<font color="#808080">=</font>pesqArq<font color="#808080">(</font>tfPais<font color="#808080">, </font>tPais<font color="#808080">.</font>codigo<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">))
      </font><font color="#000080"><b>if </b></font>slinha<font color="#808080">='' </font><font color="#000080"><b>then do
         call </b></font>pesqLinhaExcluida tfPais<font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">)
         </font><font color="#000080"><b>call </b></font>mostrarDados sreg<font color="#808080">, '', </font><font color="#FF0000">1
         </font><font color="#000080"><b>call </b></font>submenu <font color="#FF0000">7</font><font color="#808080">, </font>sreg
      <font color="#000080"><b>end  
      else say </b></font>MSG_REGEXST
   <font color="#000080"><b>end 
   else if </b></font>sacao<font color="#808080">=</font>opPesquisar <font color="#000080"><b>then do
      </b></font>slinha<font color="#808080">=</font>validaEntrada<font color="#808080">(</font>tfPais<font color="#808080">, </font>sreg<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font>tPais<font color="#808080">.</font>codigo<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font>false<font color="#808080">, </font>opTexto<font color="#808080">)
      </font><font color="#000080"><b>if </b></font>slinha<font color="#808080">&lt;&gt;'' </font><font color="#000080"><b>then do
        call </b></font>mostrarDados sreg<font color="#808080">, '', </font><font color="#FF0000">2
        </font><font color="#000080"><b>call </b></font>mostrarDados sreg<font color="#808080">, </font>slinha<font color="#808080">, </font><font color="#FF0000">3
        </font><font color="#000080"><b>call </b></font>submenu <font color="#FF0000">8</font><font color="#808080">, </font>sreg
      <font color="#000080"><b>end
   end 
   else if </b></font>sacao<font color="#808080">=</font>opAlterar <font color="#000080"><b>then do
      say </b></font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">) || </font>tPais<font color="#808080">.</font>codigo
      <font color="#000080"><b>call </b></font>mostrarDados sreg<font color="#808080">, '', </font><font color="#FF0000">1
      </font><font color="#000080"><b>call </b></font>submenu <font color="#FF0000">9</font><font color="#808080">, </font>sreg
   <font color="#000080"><b>end 
   else if </b></font>sacao<font color="#808080">=</font>opExcluir <font color="#000080"><b>then do
      call </b></font>submenu <font color="#FF0000">10</font><font color="#808080">, </font>sreg
   <font color="#000080"><b>end
end 
else if </b></font>sreg<font color="#808080">=</font>opProfissao <font color="#000080"><b>then do
   if </b></font>sacao<font color="#808080">=</font>opNovo <font color="#000080"><b>then do
      </b></font>tProfissao<font color="#808080">.</font>codigo<font color="#808080">=</font>pesqMaxCod<font color="#808080">(</font>tfProfissao<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">))
      </font><font color="#000080"><b>call </b></font>mostrarDados sreg<font color="#808080">, '', </font><font color="#FF0000">1
      </font><font color="#000080"><b>call </b></font>submenu <font color="#FF0000">7</font><font color="#808080">, </font>sreg
   <font color="#000080"><b>end 
   else if </b></font>sacao<font color="#808080">=</font>opPesquisar <font color="#000080"><b>then do
      </b></font>slinha<font color="#808080">=</font>validaEntrada<font color="#808080">(</font>tfProfissao<font color="#808080">,</font>sreg<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font>tProfissao<font color="#808080">.</font>codigo<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,
              </font>false<font color="#808080">,</font>opNumero<font color="#808080">)
      </font><font color="#000080"><b>if </b></font>slinha<font color="#808080">&lt;&gt;'' </font><font color="#000080"><b>then do
        call </b></font>mostrarDados sreg<font color="#808080">, '', </font><font color="#FF0000">2
        </font><font color="#000080"><b>call </b></font>mostrarDados sreg<font color="#808080">, </font>slinha<font color="#808080">, </font><font color="#FF0000">3
        </font><font color="#000080"><b>call </b></font>submenu <font color="#FF0000">8</font><font color="#808080">, </font>sreg
      <font color="#000080"><b>end
   end 
   else if </b></font>sacao<font color="#808080">=</font>opAlterar <font color="#000080"><b>then do
      call </b></font>mostrarDados sreg<font color="#808080">, '', </font><font color="#FF0000">1
      </font><font color="#000080"><b>call </b></font>submenu <font color="#FF0000">9</font><font color="#808080">, </font>sreg
   <font color="#000080"><b>end 
   else if </b></font>sacao<font color="#808080">=</font>opExcluir <font color="#000080"><b>then do
      call </b></font>submenu <font color="#FF0000">10</font><font color="#808080">, </font>sreg
   <font color="#000080"><b>end
end 
else if </b></font>sreg<font color="#808080">=</font>opLivro <font color="#000080"><b>then do
   if </b></font>sacao<font color="#808080">=</font>opNovo <font color="#000080"><b>then do
      call </b></font><font color="#0000FF"><b>charout </b></font><font color="#808080">,</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">)
      </font>tLivro<font color="#808080">.</font>isbn <font color="#808080">= </font><font color="#0000FF"><b>linein</b></font><font color="#808080">()
      </font><font color="#000080"><b>if </b></font>validaISBN<font color="#808080">(</font>tLivro<font color="#808080">.</font>isbn<font color="#808080">) </font><font color="#000080"><b>then do
          </b></font>slinha<font color="#808080">=</font>pesqArq<font color="#808080">(</font>tfLivro<font color="#808080">, </font>tLivro<font color="#808080">.</font>isbn<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">13</font><font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">))
          </font><font color="#000080"><b>if </b></font>slinha<font color="#808080">='' </font><font color="#000080"><b>then do
             call </b></font>pesqLinhaExcluida tfLivro<font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">)
             </font><font color="#000080"><b>call </b></font>mostrarDados sreg<font color="#808080">, '', </font><font color="#FF0000">1
             </font><font color="#000080"><b>call </b></font>submenu <font color="#FF0000">7</font><font color="#808080">, </font>sreg
             <font color="#000080"><b>call </b></font>frmCadLigados opLivroAss<font color="#808080">, </font>opNovo<font color="#808080">, </font>tLivro<font color="#808080">.</font>isbn
             <font color="#000080"><b>call </b></font>frmCadLigados opLivroAut<font color="#808080">, </font>opNovo<font color="#808080">, </font>tLivro<font color="#808080">.</font>isbn
          <font color="#000080"><b>end 
          else say </b></font>MSG_REGEXST
      <font color="#000080"><b>end 
      else say </b></font>MSG_ISBNINV
   <font color="#000080"><b>end 
   else if </b></font>sacao<font color="#808080">=</font>opPesquisar <font color="#000080"><b>then do
      </b></font>slinha<font color="#808080">=</font>validaEntrada<font color="#808080">(</font>tfLivro<font color="#808080">, </font>sreg<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font>tLivro<font color="#808080">.</font>isbn<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">,</font>false<font color="#808080">,</font>opTexto<font color="#808080">)
      </font><font color="#000080"><b>if </b></font>slinha<font color="#808080">&lt;&gt;'' </font><font color="#000080"><b>then do
         call </b></font>mostrarDados sreg<font color="#808080">, '', </font><font color="#FF0000">2
         </font><font color="#000080"><b>call </b></font>mostrarDados sreg<font color="#808080">, </font>slinha<font color="#808080">, </font><font color="#FF0000">3
         </font><font color="#000080"><b>call </b></font>submenu <font color="#FF0000">8</font><font color="#808080">, </font>sreg
      <font color="#000080"><b>end
   end 
   else if </b></font>sacao<font color="#808080">=</font>opAlterar <font color="#000080"><b>then do
      say </b></font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">) || </font>tLivro<font color="#808080">.</font>isbn
      <font color="#000080"><b>call </b></font>mostrarDados sreg<font color="#808080">, '', </font><font color="#FF0000">1
      </font><font color="#000080"><b>call </b></font>submenu <font color="#FF0000">9</font><font color="#808080">, </font>sreg
      frmCadLigados<font color="#808080">(</font>opLivroAss<font color="#808080">, </font>opExcluir<font color="#808080">, </font>tLivro<font color="#808080">.</font>isbn<font color="#808080">)
      </font><font color="#000080"><b>say </b></font><font color="#808080">'</font>Assuntos dos livros exclu<font color="#808080">&iacute;</font>dos<font color="#808080">, </font>inclua novos<font color="#808080">!'
      </font>frmCadLigados<font color="#808080">(</font>opLivroAss<font color="#808080">, </font>opNovo<font color="#808080">, </font>tLivro<font color="#808080">.</font>isbn<font color="#808080">)
      </font>frmCadLigados<font color="#808080">(</font>opLivroAut<font color="#808080">, </font>opExcluir<font color="#808080">, </font>tLivro<font color="#808080">.</font>isbn<font color="#808080">)
      </font><font color="#000080"><b>say </b></font><font color="#808080">'</font>Autores dos livros exclu<font color="#808080">&iacute;</font>dos<font color="#808080">, </font>inclua novos<font color="#808080">!'
      </font>frmCadLigados<font color="#808080">(</font>opLivroAut<font color="#808080">, </font>opNovo<font color="#808080">, </font>tLivro<font color="#808080">.</font>isbn<font color="#808080">)
   </font><font color="#000080"><b>end 
   else if </b></font>sacao<font color="#808080">=</font>opExcluir <font color="#000080"><b>then do
      call </b></font>submenu <font color="#FF0000">10</font><font color="#808080">, </font>sreg
      <font color="#000080"><b>say </b></font><font color="#808080">'</font>Assuntos dos livros sendo exclu<font color="#808080">&iacute;</font>dos<font color="#808080">!'
      </font>frmCadLigados<font color="#808080">(</font>opLivroAss<font color="#808080">, </font>opExcluir<font color="#808080">, </font>tLivro<font color="#808080">.</font>isbn<font color="#808080">)
      </font><font color="#000080"><b>say </b></font><font color="#808080">'</font>Autores dos livros sendo exclu<font color="#808080">&iacute;</font>dos<font color="#808080">!'
      </font>frmCadLigados<font color="#808080">(</font>opLivroAut<font color="#808080">, </font>opExcluir<font color="#808080">, </font>tLivro<font color="#808080">.</font>isbn<font color="#808080">)
   </font><font color="#000080"><b>end
end 
else if </b></font>sreg<font color="#808080">=</font>opCliente <font color="#000080"><b>then do
   if </b></font>sacao<font color="#808080">=</font>opNovo <font color="#000080"><b>then do
      call </b></font><font color="#0000FF"><b>charout </b></font><font color="#808080">,</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">)
      </font>tCliente<font color="#808080">.</font>cpf <font color="#808080">= </font><font color="#0000FF"><b>linein</b></font><font color="#808080">()
      </font><font color="#000080"><b>if </b></font>validaCPF<font color="#808080">(</font>tCliente<font color="#808080">.</font>cpf<font color="#808080">) </font><font color="#000080"><b>then do
          </b></font>slinha<font color="#808080">=</font>pesqArq<font color="#808080">(</font>tfCliente<font color="#808080">, </font>tCliente<font color="#808080">.</font>cpf<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">14</font><font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">))
          </font><font color="#000080"><b>if </b></font>slinha<font color="#808080">='' </font><font color="#000080"><b>then do
             call </b></font>pesqLinhaExcluida tfCliente<font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">)
             </font><font color="#000080"><b>call </b></font>mostrarDados sreg<font color="#808080">, '', </font><font color="#FF0000">1
             </font><font color="#000080"><b>call </b></font>submenu <font color="#FF0000">7</font><font color="#808080">, </font>sreg
          <font color="#000080"><b>end 
          else say </b></font>MSG_REGEXST
      <font color="#000080"><b>end 
      else say </b></font>MSG_CPFINV
   <font color="#000080"><b>end 
   else if </b></font>sacao<font color="#808080">=</font>opPesquisar <font color="#000080"><b>then do
      </b></font>slinha<font color="#808080">=</font>validaEntrada<font color="#808080">(</font>tfCliente<font color="#808080">, </font>sreg<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font>tCliente<font color="#808080">.</font>cpf<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font>false<font color="#808080">,</font>opTexto<font color="#808080">)
      </font><font color="#000080"><b>if </b></font>slinha<font color="#808080">&lt;&gt;'' </font><font color="#000080"><b>then do
         call </b></font>mostrarDados sreg<font color="#808080">, '', </font><font color="#FF0000">2
         </font><font color="#000080"><b>call </b></font>mostrarDados sreg<font color="#808080">, </font>slinha<font color="#808080">, </font><font color="#FF0000">3
         </font><font color="#000080"><b>call </b></font>submenu <font color="#FF0000">8</font><font color="#808080">, </font>sreg
      <font color="#000080"><b>end
   end 
   else if </b></font>sacao<font color="#808080">=</font>opAlterar <font color="#000080"><b>then do
      say </b></font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">) || </font>tCliente<font color="#808080">.</font>cpf
      <font color="#000080"><b>call </b></font>mostrarDados sreg<font color="#808080">, '', </font><font color="#FF0000">1
      </font><font color="#000080"><b>call </b></font>submenu <font color="#FF0000">9</font><font color="#808080">, </font>sreg
   <font color="#000080"><b>end 
   else if </b></font>sacao<font color="#808080">=</font>opExcluir <font color="#000080"><b>then do
      call </b></font>submenu <font color="#FF0000">10</font><font color="#808080">, </font>sreg
   <font color="#000080"><b>end
end 
else if </b></font>sreg<font color="#808080">=</font>opVenda <font color="#000080"><b>then do
   if </b></font>sacao<font color="#808080">=</font>opNovo <font color="#000080"><b>then do
      </b></font>tVenda<font color="#808080">.</font>dthrvenda<font color="#808080">=</font>retDataHora<font color="#808080">()
      </font><font color="#000080"><b>say </b></font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">) || </font>tVenda<font color="#808080">.</font>dthrvenda
      slinha<font color="#808080">=</font>pesqArq<font color="#808080">(</font>tfVenda<font color="#808080">, </font>tVenda<font color="#808080">.</font>dthrvenda<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">19</font><font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">))
      </font><font color="#000080"><b>if </b></font>slinha<font color="#808080">='' </font><font color="#000080"><b>then do
         </b></font>slinha<font color="#808080">=</font>validaEntrada<font color="#808080">(</font>tfCliente<font color="#808080">,</font>opCliente<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font>tVenda<font color="#808080">.</font>cpf<font color="#808080">,</font><font color="#FF0000">3</font><font color="#808080">,</font>false<font color="#808080">,</font>opTexto<font color="#808080">)
         </font><font color="#000080"><b>if </b></font>slinha<font color="#808080">&lt;&gt;'' </font><font color="#000080"><b>then do
            </b></font>tVenda<font color="#808080">.</font>cpf<font color="#808080">=</font><font color="#808000"><b>strip</b></font><font color="#808080">(</font><font color="#808000"><b>substr</b></font><font color="#808080">(</font>slinha<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#FF0000">14</font><font color="#808080">))
            </font><font color="#000080"><b>if </b></font>validaCPF<font color="#808080">(</font>tVenda<font color="#808080">.</font>cpf<font color="#808080">) </font><font color="#000080"><b>then do
               call </b></font><font color="#0000FF"><b>charout </b></font><font color="#808080">,' '</font>rotulo<font color="#808080">(</font>opCliente<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">) </font><font color="#008000"><i>/* Nome */
               </i></font><font color="#000080"><b>say </b></font><font color="#808000"><b>substr</b></font><font color="#808080">(</font>slinha<font color="#808080">, </font>gnPosChave<font color="#808080">(</font>opCliente<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">), </font>gnTamChave<font color="#808080">(</font>opCliente<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">))
               </font>frmCadLigados<font color="#808080">(</font>opVenda<font color="#808080">, </font>opNovo<font color="#808080">, </font>tVenda<font color="#808080">.</font>cpf<font color="#808080">)
            </font><font color="#000080"><b>end 
            else say </b></font>MSG_CPFINV
         <font color="#000080"><b>end
      end 
      else say </b></font>MSG_REGEXST
   <font color="#000080"><b>end 
   else if </b></font>sacao<font color="#808080">=</font>opPesquisar <font color="#000080"><b>then do
      </b></font>slinha<font color="#808080">=</font>validaEntrada<font color="#808080">(</font>tfVenda<font color="#808080">, </font>sreg<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font>tVenda<font color="#808080">.</font>dthrvenda<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,
              </font>false<font color="#808080">,</font>opDataHora<font color="#808080">)
      </font><font color="#000080"><b>if </b></font>slinha<font color="#808080">&lt;&gt;'' </font><font color="#000080"><b>then do
        call </b></font>mostrarDados sreg<font color="#808080">, '', </font><font color="#FF0000">2
        </font><font color="#000080"><b>call </b></font>mostrarDados sreg<font color="#808080">, </font>slinha<font color="#808080">, </font><font color="#FF0000">3
        </font><font color="#000080"><b>call </b></font>submenu <font color="#FF0000">8</font><font color="#808080">, </font>sreg
      <font color="#000080"><b>end
   end
end
return
</b></font><font color="#008000"><i>/*------------------------------------------------------------------------------
Realiza as consultas de acordo com o tipo de arquivo.
sreg - o tipo de arquivo
sacao - a a&ccedil;&atilde;o a ser realizada
------------------------------------------------------------------------------*/
</i></font>frmConsultas<font color="#808080">: </font><font color="#000080"><b>procedure
  parse arg </b></font>sreg<font color="#808080">, </font>sacao

<font color="#000080"><b>call </b></font>constantes
slinha <font color="#808080">= ''
</font><font color="#000080"><b>if </b></font>sreg<font color="#808080">=</font>opAssunto <font color="#000080"><b>then do
   if </b></font>sacao<font color="#808080">=</font>opPesquisar <font color="#000080"><b>then
      </b></font>slinha<font color="#808080">=</font>validaEntrada<font color="#808080">(</font>tfAssunto<font color="#808080">,</font>sreg<font color="#808080">,</font><font color="#FF0000">2</font><font color="#808080">,</font>tAssunto<font color="#808080">.</font>assunto<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font>true<font color="#808080">,</font>opTexto<font color="#808080">)
   </font><font color="#000080"><b>else if </b></font>sacao<font color="#808080">=</font>opListarTodos <font color="#000080"><b>then do
      if </b></font>ListarTodos<font color="#808080">(</font>tfAssunto<font color="#808080">, </font>sreg<font color="#808080">, '', </font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">),
        </font>QTD_MAX_LINHA<font color="#808080">, </font>false<font color="#808080">) = </font>false <font color="#000080"><b>then
        say </b></font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">)
   </font><font color="#000080"><b>end
end 
else if </b></font>sreg<font color="#808080">=</font>opAutor <font color="#000080"><b>then do
   if </b></font>sacao<font color="#808080">=</font>opPesquisar <font color="#000080"><b>then
      </b></font>slinha<font color="#808080">=</font>validaEntrada<font color="#808080">(</font>tfAutor<font color="#808080">,</font>sreg<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">, </font>tAutor<font color="#808080">.</font>autor<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font>true<font color="#808080">,</font>opTexto<font color="#808080">)
   </font><font color="#000080"><b>else if </b></font>sacao<font color="#808080">=</font>opListarTodos <font color="#000080"><b>then do
      if </b></font>ListarTodos<font color="#808080">(</font>tfAutor<font color="#808080">, </font>sreg<font color="#808080">, '', </font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">),
        </font>QTD_MAX_LINHA<font color="#808080">, </font>false<font color="#808080">) = </font>false <font color="#000080"><b>then
        say </b></font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">)
   </font><font color="#000080"><b>end
end 
else if </b></font>sreg<font color="#808080">=</font>opEditora <font color="#000080"><b>then do
   if </b></font>sacao<font color="#808080">=</font>opPesquisar <font color="#000080"><b>then
      </b></font>slinha<font color="#808080">=</font>validaEntrada<font color="#808080">(</font>tfEditora<font color="#808080">,</font>sreg<font color="#808080">,</font><font color="#FF0000">2</font><font color="#808080">,</font>tEditora<font color="#808080">.</font>editora<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font>true<font color="#808080">,</font>opTexto<font color="#808080">)
   </font><font color="#000080"><b>else if </b></font>sacao<font color="#808080">=</font>opListarTodos <font color="#000080"><b>then do
      if </b></font>ListarTodos<font color="#808080">(</font>tfEditora<font color="#808080">, </font>sreg<font color="#808080">, '', </font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">),
        </font>QTD_MAX_LINHA<font color="#808080">, </font>false<font color="#808080">) = </font>false <font color="#000080"><b>then
        say </b></font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">)
   </font><font color="#000080"><b>end
end 
else if </b></font>sreg<font color="#808080">=</font>opEndereco <font color="#000080"><b>then do
   if </b></font>sacao<font color="#808080">=</font>opPesquisar <font color="#000080"><b>then
      </b></font>slinha<font color="#808080">=</font>validaEntrada<font color="#808080">(</font>tfEndereco<font color="#808080">,</font>sreg<font color="#808080">,</font><font color="#FF0000">2</font><font color="#808080">,</font>tEndereco<font color="#808080">.</font>Logradouro<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,
              </font>true<font color="#808080">,</font>opTexto<font color="#808080">)
   </font><font color="#000080"><b>else if </b></font>sacao<font color="#808080">=</font>opListarTodos <font color="#000080"><b>then do
      if </b></font>ListarTodos<font color="#808080">(</font>tfEndereco<font color="#808080">, </font>sreg<font color="#808080">, '', </font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">),
         </font><font color="#FF0000">3</font><font color="#808080">, </font>false<font color="#808080">) = </font>false <font color="#000080"><b>then
        say </b></font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">)
   </font><font color="#000080"><b>end
end 
else if </b></font>sreg<font color="#808080">=</font>opIdioma <font color="#000080"><b>then do
   if </b></font>sacao<font color="#808080">=</font>opPesquisar <font color="#000080"><b>then
      </b></font>slinha<font color="#808080">=</font>validaEntrada<font color="#808080">(</font>tfIdioma<font color="#808080">, </font>sreg<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">, </font>tIdioma<font color="#808080">.</font>idioma<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font>true<font color="#808080">,</font>opTexto<font color="#808080">)
   </font><font color="#000080"><b>else if </b></font>sacao<font color="#808080">=</font>opListarTodos <font color="#000080"><b>then do
      if </b></font>ListarTodos<font color="#808080">(</font>tfIdioma<font color="#808080">, </font>sreg<font color="#808080">, '', </font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">),
        </font>QTD_MAX_LINHA<font color="#808080">, </font>false<font color="#808080">) = </font>false <font color="#000080"><b>then
        say </b></font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">)
   </font><font color="#000080"><b>end
end 
else if </b></font>sreg<font color="#808080">=</font>opPais <font color="#000080"><b>then do
   if </b></font>sacao<font color="#808080">=</font>opPesquisar <font color="#000080"><b>then
      </b></font>slinha<font color="#808080">=</font>validaEntrada<font color="#808080">(</font>tfPais<font color="#808080">, </font>sreg<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">, </font>tPais<font color="#808080">.</font>pais<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font>true<font color="#808080">,</font>opTexto<font color="#808080">)
   </font><font color="#000080"><b>else if </b></font>sacao<font color="#808080">=</font>opListarTodos <font color="#000080"><b>then do
      if </b></font>ListarTodos<font color="#808080">(</font>tfPais<font color="#808080">, </font>sreg<font color="#808080">, '', </font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">),
        </font>QTD_MAX_LINHA<font color="#808080">, </font>false<font color="#808080">) = </font>false <font color="#000080"><b>then
        say </b></font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">)
   </font><font color="#000080"><b>end
end 
else if </b></font>sreg<font color="#808080">=</font>opProfissao <font color="#000080"><b>then do
   if </b></font>sacao<font color="#808080">=</font>opPesquisar <font color="#000080"><b>then
     </b></font>slinha<font color="#808080">=</font>validaEntrada<font color="#808080">(</font>tfProfissao<font color="#808080">,</font>sreg<font color="#808080">,</font><font color="#FF0000">2</font><font color="#808080">,</font>tProfissao<font color="#808080">.</font>profissao<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,
             </font>true<font color="#808080">,</font>opTexto<font color="#808080">)
   </font><font color="#000080"><b>else if </b></font>sacao<font color="#808080">=</font>opListarTodos <font color="#000080"><b>then do
      if </b></font>ListarTodos<font color="#808080">(</font>tfProfissao<font color="#808080">, </font>sreg<font color="#808080">, '', </font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">),
        </font>QTD_MAX_LINHA<font color="#808080">, </font>false<font color="#808080">) = </font>false <font color="#000080"><b>then
        say </b></font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">)
   </font><font color="#000080"><b>end
end 
else if </b></font>sreg<font color="#808080">=</font>opLivro <font color="#000080"><b>then do
   if </b></font>sacao<font color="#808080">=</font>opPesquisar <font color="#000080"><b>then
      </b></font>slinha<font color="#808080">=</font>validaEntrada<font color="#808080">(</font>tfLivro<font color="#808080">, </font>sreg<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">, </font>tLivro<font color="#808080">.</font>titulo<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font>true<font color="#808080">,</font>opTexto<font color="#808080">)
   </font><font color="#000080"><b>else if </b></font>sacao<font color="#808080">=</font>opListarTodos <font color="#000080"><b>then do
      if </b></font>ListarTodos<font color="#808080">(</font>tfLivro<font color="#808080">, </font>sreg<font color="#808080">, '', </font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">),
        </font><font color="#FF0000">1</font><font color="#808080">, </font>false<font color="#808080">) = </font>false <font color="#000080"><b>then
        say </b></font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">)
   </font><font color="#000080"><b>end
end 
else if </b></font>sreg<font color="#808080">=</font>opCliente <font color="#000080"><b>then do
   if </b></font>sacao<font color="#808080">=</font>opPesquisar <font color="#000080"><b>then
      </b></font>slinha<font color="#808080">=</font>validaEntrada<font color="#808080">(</font>tfCliente<font color="#808080">, </font>sreg<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">, </font>tCliente<font color="#808080">.</font>nome<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font>true<font color="#808080">,</font>opTexto<font color="#808080">)
   </font><font color="#000080"><b>else if </b></font>sacao<font color="#808080">=</font>opListarTodos <font color="#000080"><b>then do
      if </b></font>ListarTodos<font color="#808080">(</font>tfCliente<font color="#808080">, </font>sreg<font color="#808080">, '', </font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">),
        </font><font color="#FF0000">1</font><font color="#808080">, </font>false<font color="#808080">) = </font>false <font color="#000080"><b>then
        say </b></font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">)
   </font><font color="#000080"><b>end
end 
else if </b></font>sreg<font color="#808080">=</font>opVenda <font color="#000080"><b>then do
   if </b></font>sacao<font color="#808080">=</font>opPesquisar <font color="#000080"><b>then
      </b></font>slinha<font color="#808080">=</font>validaEntrada<font color="#808080">(</font>tfVenda<font color="#808080">, </font>sreg<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">, </font>tVenda<font color="#808080">.</font>cpf<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font>true<font color="#808080">,</font>opTexto<font color="#808080">)
   </font><font color="#000080"><b>else if </b></font>sacao<font color="#808080">=</font>opListarTodos <font color="#000080"><b>then do
      if </b></font>ListarTodos<font color="#808080">(</font>tfVenda<font color="#808080">, </font>sreg<font color="#808080">, '', </font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">),
        </font>QTD_MAX_LINHA<font color="#808080">, </font>false<font color="#808080">) = </font>false <font color="#000080"><b>then
        say </b></font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">)
   </font><font color="#000080"><b>end
end
if </b></font>slinha<font color="#808080">='' </font><font color="#000080"><b>then
   call </b></font><font color="#0000FF"><b>charout </b></font><font color="#808080">,''
</font><font color="#000080"><b>return
</b></font><font color="#008000"><i>/*------------------------------------------------------------------------------
Mostra a tela de altera&ccedil;&atilde;o de senha do sistema e realiza a altera&ccedil;&atilde;o.
------------------------------------------------------------------------------*/
</i></font>frmAlterarSenha<font color="#808080">: </font><font color="#000080"><b>procedure

call </b></font>constantes
sres <font color="#808080">= ''; </font>sSenhaAtual <font color="#808080">= ''; </font>sNovaSenha <font color="#808080">= ''; </font>sConfirmaSenha <font color="#808080">= ''

</font><font color="#000080"><b>say </b></font>rotulo<font color="#808080">(</font>opUsuario<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">) || </font>tUsuario<font color="#808080">.</font>login
nopcao<font color="#808080">=</font><font color="#FF0000">1
</font>bQuebra<font color="#808080">=</font>false
<font color="#000080"><b>do </b></font>while bQuebra<font color="#808080">=</font>false
  <font color="#000080"><b>select
    when </b></font>nopcao<font color="#808080">=</font><font color="#FF0000">1 </font><font color="#000080"><b>then do
       </b></font>sSenhaAtual<font color="#808080">=</font>digitaSenha<font color="#808080">('</font>Senha Atual<font color="#808080">: ',</font><font color="#FF0000">10</font><font color="#808080">)
       </font><font color="#000080"><b>if </b></font>sSenhaAtual<font color="#808080">&lt;&gt;</font>tUsuario<font color="#808080">.</font>senha <font color="#000080"><b>then do
          say </b></font>MSG_SENCONFERE
          bQuebra<font color="#808080">=</font>true
       <font color="#000080"><b>end 
       else </b></font>nopcao<font color="#808080">=</font><font color="#FF0000">2
     </font><font color="#000080"><b>end
    when </b></font>nopcao<font color="#808080">=</font><font color="#FF0000">2 </font><font color="#000080"><b>then do
       </b></font>sNovaSenha<font color="#808080">=</font>digitaSenha<font color="#808080">('</font>Nova Senha<font color="#808080">: ',</font><font color="#FF0000">10</font><font color="#808080">)
       </font>sConfirmaSenha<font color="#808080">=</font>digitaSenha<font color="#808080">('</font>Confirma Senha<font color="#808080">: ',</font><font color="#FF0000">10</font><font color="#808080">)
       </font><font color="#000080"><b>if </b></font>sNovaSenha<font color="#808080">&lt;&gt;</font>sConfirmaSenha <font color="#000080"><b>then do
          say </b></font>MSG_SENCONFIRM
          bQuebra<font color="#808080">=</font>true
       <font color="#000080"><b>end 
       else </b></font>nopcao<font color="#808080">=</font><font color="#FF0000">3
     </font><font color="#000080"><b>end
    when </b></font>nopcao<font color="#808080">=</font><font color="#FF0000">3 </font><font color="#000080"><b>then do
       </b></font>sres<font color="#808080">=</font>pesqArq<font color="#808080">(</font>tfUsuario<font color="#808080">, </font>tUsuario<font color="#808080">.</font>login<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">, </font>tamReg<font color="#808080">(</font>opUsuario<font color="#808080">))
       </font><font color="#000080"><b>if </b></font>sres<font color="#808080">='' </font><font color="#000080"><b>then
         say </b></font>MSG_LOGINENCON
       <font color="#000080"><b>else do
         </b></font>tUsuario<font color="#808080">.</font>senha<font color="#808080">=</font>sConfirmaSenha
         <font color="#000080"><b>call </b></font>submenu <font color="#FF0000">9</font><font color="#808080">,</font>opUsuario
         bQuebra<font color="#808080">=</font>true
       <font color="#000080"><b>end
     end
  end
end
return
</b></font><font color="#008000"><i>/*------------------------------------------------------------------------------
Executa uma a&ccedil;&atilde;o de grava&ccedil;&atilde;o de acordo com o tipo de arquivo.
sreg - o tipo de arquivo
sacao - a a&ccedil;&atilde;o a ser realizada
------------------------------------------------------------------------------*/
</i></font>btnAcao<font color="#808080">: </font><font color="#000080"><b>procedure expose </b></font>tAssunto<font color="#808080">.</font>codigo tAssunto<font color="#808080">.</font>assunto tAutor<font color="#808080">.</font>codigo<font color="#808080">,
 </font>tAutor<font color="#808080">.</font>autor tEditora<font color="#808080">.</font>codigo tEditora<font color="#808080">.</font>editora tEndereco<font color="#808080">.</font>codigo<font color="#808080">,
 </font>tEndereco<font color="#808080">.</font>logradouro tEndereco<font color="#808080">.</font>bairro tEndereco<font color="#808080">.</font>cep tEndereco<font color="#808080">.</font>cidade<font color="#808080">,
 </font>tEndereco<font color="#808080">.</font>estado tIdioma<font color="#808080">.</font>codigo tIdioma<font color="#808080">.</font>idioma tPais<font color="#808080">.</font>codigo tPais<font color="#808080">.</font>pais<font color="#808080">,
 </font>tProfissao<font color="#808080">.</font>codigo tProfissao<font color="#808080">.</font>profissao tUsuario<font color="#808080">.</font>login tUsuario<font color="#808080">.</font>senha<font color="#808080">,
 </font>tLivro<font color="#808080">.</font>isbn tLivro<font color="#808080">.</font>titulo tLivro<font color="#808080">.</font>edicao tLivro<font color="#808080">.</font>anopubli tLivro<font color="#808080">.</font>codeditora<font color="#808080">,
 </font>tLivro<font color="#808080">.</font>volume tLivro<font color="#808080">.</font>codidioma tLivro<font color="#808080">.</font>npaginas tLivro<font color="#808080">.</font>preco tLivro<font color="#808080">.</font>qtdestoque<font color="#808080">,
 </font>tLivroAss<font color="#808080">.</font>isbn tlivroAss<font color="#808080">.</font>codassunto tLivroAut<font color="#808080">.</font>isbn tlivroAut<font color="#808080">.</font>codautor<font color="#808080">,
 </font>tCliente<font color="#808080">.</font>cpf tCliente<font color="#808080">.</font>nome tCliente<font color="#808080">.</font>email tCliente<font color="#808080">.</font>identidade tCliente<font color="#808080">.</font>sexo<font color="#808080">,
 </font>tCliente<font color="#808080">.</font>telefone tCliente<font color="#808080">.</font>dtnascimento tCliente<font color="#808080">.</font>codendereco tCliente<font color="#808080">.</font>codpais<font color="#808080">,
 </font>tCliente<font color="#808080">.</font>codprofissao tVenda<font color="#808080">.</font>dthrvenda tVenda<font color="#808080">.</font>cpf tVenda<font color="#808080">.</font>isbn tVenda<font color="#808080">.</font>precovenda

  <font color="#000080"><b>parse arg </b></font>sreg<font color="#808080">, </font>sacao

<font color="#000080"><b>call </b></font>constantes
<font color="#000080"><b>if </b></font>sreg<font color="#808080">=</font>opAssunto <font color="#000080"><b>then do
   if </b></font>sacao<font color="#808080">=</font>opSalvarInclusao <font color="#000080"><b>then
      call </b></font>escreveArq tfAssunto<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGINC<font color="#808080">, </font>MSG_REGNINC
   <font color="#000080"><b>else if </b></font>sacao<font color="#808080">=</font>opSalvarAlteracao <font color="#000080"><b>then
      call </b></font>escreveArq tfAssunto<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGALT<font color="#808080">, </font>MSG_REGNALT
   <font color="#000080"><b>else if </b></font>sacao<font color="#808080">=</font>opConfirmaExclusao <font color="#000080"><b>then
      call </b></font>escreveArq tfAssunto<font color="#808080">, </font>repete<font color="#808080">('*',</font>tamReg<font color="#808080">(</font>sreg<font color="#808080">)), </font>MSG_REGEXC<font color="#808080">, </font>MSG_REGNEXC
<font color="#000080"><b>end 
else if </b></font>sreg<font color="#808080">=</font>opAutor <font color="#000080"><b>then do
   if </b></font>sacao<font color="#808080">=</font>opSalvarInclusao <font color="#000080"><b>then
      call </b></font>escreveArq tfAutor<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGINC<font color="#808080">, </font>MSG_REGNINC
   <font color="#000080"><b>else if </b></font>sacao<font color="#808080">=</font>opSalvarAlteracao <font color="#000080"><b>then
      call </b></font>escreveArq tfAutor<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGALT<font color="#808080">, </font>MSG_REGNALT
   <font color="#000080"><b>else if </b></font>sacao<font color="#808080">=</font>opConfirmaExclusao <font color="#000080"><b>then
      call </b></font>escreveArq tfAutor<font color="#808080">, </font>repete<font color="#808080">('*',</font>tamReg<font color="#808080">(</font>sreg<font color="#808080">)), </font>MSG_REGEXC<font color="#808080">, </font>MSG_REGNEXC
<font color="#000080"><b>end 
else if </b></font>sreg<font color="#808080">=</font>opEditora <font color="#000080"><b>then do
   if </b></font>sacao<font color="#808080">=</font>opSalvarInclusao <font color="#000080"><b>then
      call </b></font>escreveArq tfEditora<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGINC<font color="#808080">, </font>MSG_REGNINC
   <font color="#000080"><b>else if </b></font>sacao<font color="#808080">=</font>opSalvarAlteracao <font color="#000080"><b>then
      call </b></font>escreveArq tfEditora<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGALT<font color="#808080">, </font>MSG_REGNALT
   <font color="#000080"><b>else if </b></font>sacao<font color="#808080">=</font>opConfirmaExclusao <font color="#000080"><b>then
      call </b></font>escreveArq tfEditora<font color="#808080">, </font>repete<font color="#808080">('*',</font>tamReg<font color="#808080">(</font>sreg<font color="#808080">)), </font>MSG_REGEXC<font color="#808080">, </font>MSG_REGNEXC
<font color="#000080"><b>end 
else if </b></font>sreg<font color="#808080">=</font>opEndereco <font color="#000080"><b>then do
   if </b></font>sacao<font color="#808080">=</font>opSalvarInclusao <font color="#000080"><b>then
      call </b></font>escreveArq tfEndereco<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGINC<font color="#808080">, </font>MSG_REGNINC
   <font color="#000080"><b>else if </b></font>sacao<font color="#808080">=</font>opSalvarAlteracao <font color="#000080"><b>then
      call </b></font>escreveArq tfEndereco<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGALT<font color="#808080">, </font>MSG_REGNALT
   <font color="#000080"><b>else if </b></font>sacao<font color="#808080">=</font>opConfirmaExclusao <font color="#000080"><b>then
      call </b></font>escreveArq tfEndereco<font color="#808080">, </font>repete<font color="#808080">('*',</font>tamReg<font color="#808080">(</font>sreg<font color="#808080">)), </font>MSG_REGEXC<font color="#808080">, </font>MSG_REGNEXC
<font color="#000080"><b>end 
else if </b></font>sreg<font color="#808080">=</font>opIdioma <font color="#000080"><b>then do
   if </b></font>sacao<font color="#808080">=</font>opSalvarInclusao <font color="#000080"><b>then
      call </b></font>escreveArq tfIdioma<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGINC<font color="#808080">, </font>MSG_REGNINC
   <font color="#000080"><b>else if </b></font>sacao<font color="#808080">=</font>opSalvarAlteracao <font color="#000080"><b>then
      call </b></font>escreveArq tfIdioma<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGALT<font color="#808080">, </font>MSG_REGNALT
   <font color="#000080"><b>else if </b></font>sacao<font color="#808080">=</font>opConfirmaExclusao <font color="#000080"><b>then
      call </b></font>escreveArq tfIdioma<font color="#808080">, </font>repete<font color="#808080">('*',</font>tamReg<font color="#808080">(</font>sreg<font color="#808080">)), </font>MSG_REGEXC<font color="#808080">, </font>MSG_REGNEXC
<font color="#000080"><b>end 
else if </b></font>sreg<font color="#808080">=</font>opPais <font color="#000080"><b>then do
   if </b></font>sacao<font color="#808080">=</font>opSalvarInclusao <font color="#000080"><b>then
      call </b></font>escreveArq tfPais<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGINC<font color="#808080">, </font>MSG_REGNINC
   <font color="#000080"><b>else if </b></font>sacao<font color="#808080">=</font>opSalvarAlteracao <font color="#000080"><b>then
      call </b></font>escreveArq tfPais<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGALT<font color="#808080">, </font>MSG_REGNALT
   <font color="#000080"><b>else if </b></font>sacao<font color="#808080">=</font>opConfirmaExclusao <font color="#000080"><b>then
      call </b></font>escreveArq tfPais<font color="#808080">, </font>repete<font color="#808080">('*',</font>tamReg<font color="#808080">(</font>sreg<font color="#808080">)), </font>MSG_REGEXC<font color="#808080">, </font>MSG_REGNEXC
<font color="#000080"><b>end 
else if </b></font>sreg<font color="#808080">=</font>opProfissao <font color="#000080"><b>then do
   if </b></font>sacao<font color="#808080">=</font>opSalvarInclusao <font color="#000080"><b>then
      call </b></font>escreveArq tfProfissao<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGINC<font color="#808080">, </font>MSG_REGNINC
   <font color="#000080"><b>else if </b></font>sacao<font color="#808080">=</font>opSalvarAlteracao <font color="#000080"><b>then
      call </b></font>escreveArq tfProfissao<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGALT<font color="#808080">, </font>MSG_REGNALT
   <font color="#000080"><b>else if </b></font>sacao<font color="#808080">=</font>opConfirmaExclusao <font color="#000080"><b>then
      call </b></font>escreveArq tfProfissao<font color="#808080">, </font>repete<font color="#808080">('*',</font>tamReg<font color="#808080">(</font>sreg<font color="#808080">)), </font>MSG_REGEXC<font color="#808080">, </font>MSG_REGNEXC
<font color="#000080"><b>end 
else if </b></font>sreg<font color="#808080">=</font>opLivro <font color="#000080"><b>then do
   if </b></font>sacao<font color="#808080">=</font>opSalvarInclusao <font color="#000080"><b>then
      call </b></font>escreveArq tfLivro<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGINC<font color="#808080">, </font>MSG_REGNINC
   <font color="#000080"><b>else if </b></font>sacao<font color="#808080">=</font>opSalvarAlteracao <font color="#000080"><b>then
      call </b></font>escreveArq tfLivro<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGALT<font color="#808080">, </font>MSG_REGNALT
   <font color="#000080"><b>else if </b></font>sacao<font color="#808080">=</font>opConfirmaExclusao <font color="#000080"><b>then
      call </b></font>escreveArq tfLivro<font color="#808080">, </font>repete<font color="#808080">('*',</font>tamReg<font color="#808080">(</font>sreg<font color="#808080">)), </font>MSG_REGEXC<font color="#808080">, </font>MSG_REGNEXC
<font color="#000080"><b>end 
else if </b></font>sreg<font color="#808080">=</font>opLivroAss <font color="#000080"><b>then do
   if </b></font>sacao<font color="#808080">=</font>opSalvarInclusao <font color="#000080"><b>then
      call </b></font>escreveArq tfLivroAss<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGINC<font color="#808080">, </font>MSG_REGNINC
   <font color="#000080"><b>else if </b></font>sacao<font color="#808080">=</font>opSalvarAlteracao <font color="#000080"><b>then
      call </b></font>escreveArq tfLivroAss<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGALT<font color="#808080">, </font>MSG_REGNALT
   <font color="#000080"><b>else if </b></font>sacao<font color="#808080">=</font>opConfirmaExclusao <font color="#000080"><b>then
      call </b></font>escreveArq tfLivroAss<font color="#808080">, </font>repete<font color="#808080">('*',</font>tamReg<font color="#808080">(</font>sreg<font color="#808080">)), </font>MSG_REGEXC<font color="#808080">, </font>MSG_REGNEXC
<font color="#000080"><b>end 
else if </b></font>sreg<font color="#808080">=</font>opLivroAut <font color="#000080"><b>then do
   if </b></font>sacao<font color="#808080">=</font>opSalvarInclusao <font color="#000080"><b>then
      call </b></font>escreveArq tfLivroAut<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGINC<font color="#808080">, </font>MSG_REGNINC
   <font color="#000080"><b>else if </b></font>sacao<font color="#808080">=</font>opSalvarAlteracao <font color="#000080"><b>then
      call </b></font>escreveArq tfLivroAut<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGALT<font color="#808080">, </font>MSG_REGNALT
   <font color="#000080"><b>else if </b></font>sacao<font color="#808080">=</font>opConfirmaExclusao <font color="#000080"><b>then
      call </b></font>escreveArq tfLivroAut<font color="#808080">, </font>repete<font color="#808080">('*',</font>tamReg<font color="#808080">(</font>sreg<font color="#808080">)), </font>MSG_REGEXC<font color="#808080">, </font>MSG_REGNEXC
<font color="#000080"><b>end 
else if </b></font>sreg<font color="#808080">=</font>opCliente <font color="#000080"><b>then do
   if </b></font>sacao<font color="#808080">=</font>opSalvarInclusao <font color="#000080"><b>then
      call </b></font>escreveArq tfCliente<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGINC<font color="#808080">, </font>MSG_REGNINC
   <font color="#000080"><b>else if </b></font>sacao<font color="#808080">=</font>opSalvarAlteracao <font color="#000080"><b>then
      call </b></font>escreveArq tfCliente<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGALT<font color="#808080">, </font>MSG_REGNALT
   <font color="#000080"><b>else if </b></font>sacao<font color="#808080">=</font>opConfirmaExclusao <font color="#000080"><b>then
      call </b></font>escreveArq tfCliente<font color="#808080">, </font>repete<font color="#808080">('*',</font>tamReg<font color="#808080">(</font>sreg<font color="#808080">)), </font>MSG_REGEXC<font color="#808080">, </font>MSG_REGNEXC
<font color="#000080"><b>end 
else if </b></font>sreg<font color="#808080">=</font>opVenda <font color="#000080"><b>then do
   if </b></font>sacao<font color="#808080">=</font>opSalvarInclusao <font color="#000080"><b>then
      call </b></font>escreveArq tfVenda<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGINC<font color="#808080">, </font>MSG_REGNINC
   <font color="#000080"><b>else if </b></font>sacao<font color="#808080">=</font>opSalvarAlteracao <font color="#000080"><b>then
      call </b></font>escreveArq tfVenda<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGALT<font color="#808080">, </font>MSG_REGNALT
   <font color="#000080"><b>else if </b></font>sacao<font color="#808080">=</font>opConfirmaExclusao <font color="#000080"><b>then
      call </b></font>escreveArq tfVenda<font color="#808080">, </font>repete<font color="#808080">('*',</font>tamReg<font color="#808080">(</font>sreg<font color="#808080">)), </font>MSG_REGEXC<font color="#808080">, </font>MSG_REGNEXC
<font color="#000080"><b>end 
else if </b></font>sreg<font color="#808080">=</font>opUsuario <font color="#000080"><b>then do
   if </b></font>sacao<font color="#808080">=</font>opSalvarAlteracao <font color="#000080"><b>then
      call </b></font>escreveArq tfUsuario<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGALT<font color="#808080">, </font>MSG_REGNALT
<font color="#000080"><b>end
return
</b></font><font color="#008000"><i>/*------------------------------------------------------------------------------
Seleciona o menu e/ou a tela certa de acordo com o tipo de arquivo.
nmenu - o n&uacute;mero do menu
sreg - o tipo de arquivo
------------------------------------------------------------------------------*/
</i></font>submenu<font color="#808080">: </font><font color="#000080"><b>procedure expose </b></font>g_SalvarInclusao tAssunto<font color="#808080">.</font>codigo tAssunto<font color="#808080">.</font>assunto<font color="#808080">, 
 </font>tAutor<font color="#808080">.</font>codigo tAutor<font color="#808080">.</font>autor tEditora<font color="#808080">.</font>codigo tEditora<font color="#808080">.</font>editora tEndereco<font color="#808080">.</font>codigo<font color="#808080">,
 </font>tEndereco<font color="#808080">.</font>logradouro tEndereco<font color="#808080">.</font>bairro tEndereco<font color="#808080">.</font>cep tEndereco<font color="#808080">.</font>cidade<font color="#808080">,
 </font>tEndereco<font color="#808080">.</font>estado tIdioma<font color="#808080">.</font>codigo tIdioma<font color="#808080">.</font>idioma tPais<font color="#808080">.</font>codigo tPais<font color="#808080">.</font>pais<font color="#808080">,
 </font>tProfissao<font color="#808080">.</font>codigo tProfissao<font color="#808080">.</font>profissao tUsuario<font color="#808080">.</font>login tUsuario<font color="#808080">.</font>senha<font color="#808080">,
 </font>tLivro<font color="#808080">.</font>isbn tLivro<font color="#808080">.</font>titulo tLivro<font color="#808080">.</font>edicao tLivro<font color="#808080">.</font>anopubli tLivro<font color="#808080">.</font>codeditora<font color="#808080">,
 </font>tLivro<font color="#808080">.</font>volume tLivro<font color="#808080">.</font>codidioma tLivro<font color="#808080">.</font>npaginas tLivro<font color="#808080">.</font>preco tLivro<font color="#808080">.</font>qtdestoque<font color="#808080">,
 </font>tLivroAss<font color="#808080">.</font>isbn tlivroAss<font color="#808080">.</font>codassunto tLivroAut<font color="#808080">.</font>isbn tlivroAut<font color="#808080">.</font>codautor<font color="#808080">,
 </font>tCliente<font color="#808080">.</font>cpf tCliente<font color="#808080">.</font>nome tCliente<font color="#808080">.</font>email tCliente<font color="#808080">.</font>identidade tCliente<font color="#808080">.</font>sexo<font color="#808080">,
 </font>tCliente<font color="#808080">.</font>telefone tCliente<font color="#808080">.</font>dtnascimento tCliente<font color="#808080">.</font>codendereco tCliente<font color="#808080">.</font>codpais<font color="#808080">,
 </font>tCliente<font color="#808080">.</font>codprofissao tVenda<font color="#808080">.</font>dthrvenda tVenda<font color="#808080">.</font>cpf tVenda<font color="#808080">.</font>isbn tVenda<font color="#808080">.</font>precovenda

  <font color="#000080"><b>parse arg </b></font>nmenu<font color="#808080">, </font>sreg

<font color="#000080"><b>call </b></font>constantes
opSubMenu <font color="#808080">= </font><font color="#FF0000">0</font><font color="#808080">; 
</font>opCSubMenu <font color="#808080">= ''
</font>bSOp<font color="#808080">=</font>true
<font color="#000080"><b>select
  when </b></font>nmenu <font color="#808080">= </font><font color="#FF0000">6 </font><font color="#000080"><b>then do
    do </b></font>while bSOp<font color="#808080">=</font>true
      <font color="#000080"><b>call </b></font>menu nmenu
      opSubMenu <font color="#808080">= </font><font color="#0000FF"><b>linein</b></font><font color="#808080">()
      </font><font color="#000080"><b>select 
        when </b></font>opSubMenu<font color="#808080">=</font><font color="#FF0000">1 </font><font color="#000080"><b>then call </b></font>frmCadastros sreg<font color="#808080">, </font>opNovo
        <font color="#000080"><b>when </b></font>opSubMenu<font color="#808080">=</font><font color="#FF0000">2 </font><font color="#000080"><b>then call </b></font>frmCadastros sreg<font color="#808080">, </font>opPesquisar
        <font color="#000080"><b>when </b></font>opSubMenu<font color="#808080">=</font><font color="#FF0000">3 </font><font color="#000080"><b>then </b></font>bSOp<font color="#808080">=</font>false
        otherwise <font color="#000080"><b>say </b></font>MSG_ERRO
      <font color="#000080"><b>end
    end
  end
  when </b></font>nmenu <font color="#808080">= </font><font color="#FF0000">7 </font><font color="#000080"><b>then do
    do </b></font>while bSOp<font color="#808080">=</font>true
      <font color="#000080"><b>call </b></font>menu nmenu
      opSubMenu <font color="#808080">= </font><font color="#0000FF"><b>linein</b></font><font color="#808080">()
      </font><font color="#000080"><b>select 
        when </b></font>opSubMenu<font color="#808080">=</font><font color="#FF0000">1 </font><font color="#000080"><b>then do 
          call </b></font>btnAcao sreg<font color="#808080">, </font>opSalvarInclusao
          bSOp<font color="#808080">=</font>false 
        <font color="#000080"><b>end
        when </b></font>opSubMenu<font color="#808080">=</font><font color="#FF0000">2 </font><font color="#000080"><b>then </b></font>bSOp<font color="#808080">=</font>false
        otherwise <font color="#000080"><b>say </b></font>MSG_ERRO
      <font color="#000080"><b>end
    end
  end
  when </b></font>nmenu <font color="#808080">= </font><font color="#FF0000">8 </font><font color="#000080"><b>then do
    do </b></font>while bSOp<font color="#808080">=</font>true
      <font color="#000080"><b>call </b></font>menu nmenu
      opSubMenu <font color="#808080">= </font><font color="#0000FF"><b>linein</b></font><font color="#808080">()
      </font><font color="#000080"><b>select 
        when </b></font>opSubMenu<font color="#808080">=</font><font color="#FF0000">1 </font><font color="#000080"><b>then do 
          call </b></font>frmCadastros sreg<font color="#808080">, </font>opAlterar
          bSOp<font color="#808080">=</font>false 
        <font color="#000080"><b>end
        when </b></font>opSubMenu<font color="#808080">=</font><font color="#FF0000">2 </font><font color="#000080"><b>then do 
          call </b></font>frmCadastros sreg<font color="#808080">, </font>opExcluir
          bSOp<font color="#808080">=</font>false 
        <font color="#000080"><b>end
        when </b></font>opSubMenu<font color="#808080">=</font><font color="#FF0000">3 </font><font color="#000080"><b>then </b></font>bSOp<font color="#808080">=</font>false
        otherwise <font color="#000080"><b>say </b></font>MSG_ERRO
      <font color="#000080"><b>end
    end
  end
  when </b></font>nmenu <font color="#808080">= </font><font color="#FF0000">9 </font><font color="#000080"><b>then do
    do </b></font>while bSOp<font color="#808080">=</font>true
      <font color="#000080"><b>call </b></font>menu nmenu
      opSubMenu <font color="#808080">= </font><font color="#0000FF"><b>linein</b></font><font color="#808080">()
      </font><font color="#000080"><b>select 
        when </b></font>opSubMenu<font color="#808080">=</font><font color="#FF0000">1 </font><font color="#000080"><b>then do 
          call </b></font>btnAcao sreg<font color="#808080">, </font>opSalvarAlteracao
          bSOp<font color="#808080">=</font>false 
        <font color="#000080"><b>end
        when </b></font>opSubMenu<font color="#808080">=</font><font color="#FF0000">2 </font><font color="#000080"><b>then </b></font>bSOp<font color="#808080">=</font>false
        otherwise <font color="#000080"><b>say </b></font>MSG_ERRO
      <font color="#000080"><b>end
    end
  end
  when </b></font>nmenu <font color="#808080">= </font><font color="#FF0000">10 </font><font color="#000080"><b>then do
    do </b></font>while bSOp <font color="#808080">= </font>true
      <font color="#000080"><b>call </b></font>menu nmenu
      opCSubMenu <font color="#808080">= </font><font color="#0000FF"><b>linein</b></font><font color="#808080">()
      </font><font color="#000080"><b>if </b></font><font color="#808080">(</font>opCSubMenu<font color="#808080">='</font>S<font color="#808080">') | (</font>opCSubMenu<font color="#808080">='</font>s<font color="#808080">') </font><font color="#000080"><b>then do
         call </b></font>btnAcao sreg<font color="#808080">, </font>opConfirmaExclusao
         bSOp<font color="#808080">=</font>false
      <font color="#000080"><b>end 
      else if </b></font><font color="#808080">(</font>opCSubMenu<font color="#808080">='</font>N<font color="#808080">') | (</font>opCSubMenu<font color="#808080">='</font>n<font color="#808080">') </font><font color="#000080"><b>then </b></font>bSOp<font color="#808080">=</font>false
      <font color="#000080"><b>else say </b></font>MSG_ERRO
    <font color="#000080"><b>end
   end
  when </b></font>nmenu <font color="#808080">= </font><font color="#FF0000">12 </font><font color="#000080"><b>then do
    do </b></font>while bSOp<font color="#808080">=</font>true
      <font color="#000080"><b>call </b></font>menu nmenu
      opSubMenu <font color="#808080">= </font><font color="#0000FF"><b>linein</b></font><font color="#808080">()
      </font><font color="#000080"><b>select 
        when </b></font>opSubMenu<font color="#808080">=</font><font color="#FF0000">1 </font><font color="#000080"><b>then call </b></font>frmConsultas sreg<font color="#808080">, </font>opPesquisar
        <font color="#000080"><b>when </b></font>opSubMenu<font color="#808080">=</font><font color="#FF0000">2 </font><font color="#000080"><b>then call </b></font>frmConsultas sreg<font color="#808080">, </font>opListarTodos
        <font color="#000080"><b>when </b></font>opSubMenu<font color="#808080">=</font><font color="#FF0000">3 </font><font color="#000080"><b>then </b></font>bSOp<font color="#808080">=</font>false
        otherwise <font color="#000080"><b>say </b></font>MSG_ERRO
      <font color="#000080"><b>end
    end
  end
  when </b></font>nmenu <font color="#808080">= </font><font color="#FF0000">14 </font><font color="#000080"><b>then do
    do </b></font>while bSOp<font color="#808080">=</font>true
      <font color="#000080"><b>call </b></font>menu nmenu
      opCSubMenu <font color="#808080">= </font><font color="#0000FF"><b>linein</b></font><font color="#808080">()
      </font><font color="#000080"><b>if </b></font><font color="#808080">(</font>opCSubMenu<font color="#808080">='</font>S<font color="#808080">') | (</font>opCSubMenu<font color="#808080">='</font>s<font color="#808080">') </font><font color="#000080"><b>then do
        call </b></font>btnAcao sreg<font color="#808080">, </font>opSalvarInclusao
        bSOp<font color="#808080">=</font>false
        g_SalvarInclusao<font color="#808080">=</font>true
      <font color="#000080"><b>end 
      else if </b></font><font color="#808080">(</font>opCSubMenu<font color="#808080">='</font>N<font color="#808080">') | (</font>opCSubMenu<font color="#808080">='</font>n<font color="#808080">') </font><font color="#000080"><b>then </b></font>bSOp<font color="#808080">=</font>false
      <font color="#000080"><b>else say </b></font>MSG_ERRO
    <font color="#000080"><b>end
   end
end
return
</b></font><font color="#008000"><i>/*------------------------------------------------------------------------------
Seleciona o submenu e/ou a tela certa de acordo com n&uacute;mero do menu.
nmenu - o n&uacute;mero do menu
------------------------------------------------------------------------------*/
</i></font>usaMenu<font color="#808080">: </font><font color="#000080"><b>procedure
  parse arg </b></font>num

<font color="#000080"><b>call </b></font>constantes
opSubMenu <font color="#808080">= </font><font color="#FF0000">0
</font>opSair <font color="#808080">= ''
</font>bSOp<font color="#808080">=</font>true
 <font color="#000080"><b>if </b></font>num <font color="#808080">= </font><font color="#FF0000">1 </font><font color="#000080"><b>then do </b></font><font color="#008000"><i>/* Cadastros */
   </i></font><font color="#000080"><b>do </b></font>while bSOp<font color="#808080">=</font>true
     <font color="#000080"><b>call </b></font>menu <font color="#FF0000">2
     </font>opSubMenu <font color="#808080">= </font><font color="#0000FF"><b>linein</b></font><font color="#808080">()
     </font><font color="#000080"><b>select
       when </b></font>opSubMenu <font color="#808080">= </font><font color="#FF0000">1 </font><font color="#000080"><b>then call </b></font>submenu <font color="#FF0000">6</font><font color="#808080">, </font>opAssunto
       <font color="#000080"><b>when </b></font>opSubMenu <font color="#808080">= </font><font color="#FF0000">2 </font><font color="#000080"><b>then call </b></font>submenu <font color="#FF0000">6</font><font color="#808080">, </font>opAutor
       <font color="#000080"><b>when </b></font>opSubMenu <font color="#808080">= </font><font color="#FF0000">3 </font><font color="#000080"><b>then call </b></font>submenu <font color="#FF0000">6</font><font color="#808080">, </font>opEditora
       <font color="#000080"><b>when </b></font>opSubMenu <font color="#808080">= </font><font color="#FF0000">4 </font><font color="#000080"><b>then call </b></font>submenu <font color="#FF0000">6</font><font color="#808080">, </font>opEndereco
       <font color="#000080"><b>when </b></font>opSubMenu <font color="#808080">= </font><font color="#FF0000">5 </font><font color="#000080"><b>then call </b></font>submenu <font color="#FF0000">6</font><font color="#808080">, </font>opIdioma
       <font color="#000080"><b>when </b></font>opSubMenu <font color="#808080">= </font><font color="#FF0000">6 </font><font color="#000080"><b>then call </b></font>submenu <font color="#FF0000">6</font><font color="#808080">, </font>opPais
       <font color="#000080"><b>when </b></font>opSubMenu <font color="#808080">= </font><font color="#FF0000">7 </font><font color="#000080"><b>then call </b></font>submenu <font color="#FF0000">6</font><font color="#808080">, </font>opProfissao
       <font color="#000080"><b>when </b></font>opSubMenu <font color="#808080">= </font><font color="#FF0000">8 </font><font color="#000080"><b>then call </b></font>submenu <font color="#FF0000">6</font><font color="#808080">, </font>opCliente
       <font color="#000080"><b>when </b></font>opSubMenu <font color="#808080">= </font><font color="#FF0000">9 </font><font color="#000080"><b>then call </b></font>submenu <font color="#FF0000">6</font><font color="#808080">, </font>opLivro
       <font color="#000080"><b>when </b></font>opSubMenu <font color="#808080">= </font><font color="#FF0000">10 </font><font color="#000080"><b>then </b></font>bSOp<font color="#808080">=</font>false
       otherwise <font color="#000080"><b>say </b></font>MSG_ERRO
     <font color="#000080"><b>end
   end
 end 
 else if </b></font>num <font color="#808080">= </font><font color="#FF0000">2 </font><font color="#000080"><b>then do </b></font><font color="#008000"><i>/* Pesquisas */
   </i></font><font color="#000080"><b>do </b></font>while bSOp<font color="#808080">=</font>true
     <font color="#000080"><b>call </b></font>menu <font color="#FF0000">3
     </font>opSubMenu <font color="#808080">= </font><font color="#0000FF"><b>linein</b></font><font color="#808080">()
     </font><font color="#000080"><b>select
       when </b></font>opSubMenu <font color="#808080">= </font><font color="#FF0000">1 </font><font color="#000080"><b>then call </b></font>submenu <font color="#FF0000">12</font><font color="#808080">, </font>opAssunto
       <font color="#000080"><b>when </b></font>opSubMenu <font color="#808080">= </font><font color="#FF0000">2 </font><font color="#000080"><b>then call </b></font>submenu <font color="#FF0000">12</font><font color="#808080">, </font>opAutor
       <font color="#000080"><b>when </b></font>opSubMenu <font color="#808080">= </font><font color="#FF0000">3 </font><font color="#000080"><b>then call </b></font>submenu <font color="#FF0000">12</font><font color="#808080">, </font>opEditora
       <font color="#000080"><b>when </b></font>opSubMenu <font color="#808080">= </font><font color="#FF0000">4 </font><font color="#000080"><b>then call </b></font>submenu <font color="#FF0000">12</font><font color="#808080">, </font>opEndereco
       <font color="#000080"><b>when </b></font>opSubMenu <font color="#808080">= </font><font color="#FF0000">5 </font><font color="#000080"><b>then call </b></font>submenu <font color="#FF0000">12</font><font color="#808080">, </font>opIdioma
       <font color="#000080"><b>when </b></font>opSubMenu <font color="#808080">= </font><font color="#FF0000">6 </font><font color="#000080"><b>then call </b></font>submenu <font color="#FF0000">12</font><font color="#808080">, </font>opPais
       <font color="#000080"><b>when </b></font>opSubMenu <font color="#808080">= </font><font color="#FF0000">7 </font><font color="#000080"><b>then call </b></font>submenu <font color="#FF0000">12</font><font color="#808080">, </font>opProfissao
       <font color="#000080"><b>when </b></font>opSubMenu <font color="#808080">= </font><font color="#FF0000">8 </font><font color="#000080"><b>then call </b></font>submenu <font color="#FF0000">12</font><font color="#808080">, </font>opCliente
       <font color="#000080"><b>when </b></font>opSubMenu <font color="#808080">= </font><font color="#FF0000">9 </font><font color="#000080"><b>then call </b></font>submenu <font color="#FF0000">12</font><font color="#808080">, </font>opLivro
       <font color="#000080"><b>when </b></font>opSubMenu <font color="#808080">= </font><font color="#FF0000">10 </font><font color="#000080"><b>then </b></font>bSOp<font color="#808080">=</font>false
       otherwise <font color="#000080"><b>say </b></font>MSG_ERRO
     <font color="#000080"><b>end
   end
 end 
 else if </b></font>num <font color="#808080">= </font><font color="#FF0000">3 </font><font color="#000080"><b>then do </b></font><font color="#008000"><i>/* Vendas */
   </i></font><font color="#000080"><b>do </b></font>while bSOp<font color="#808080">=</font>true
     <font color="#000080"><b>call </b></font>menu <font color="#FF0000">4
     </font>opSubMenu <font color="#808080">= </font><font color="#0000FF"><b>linein</b></font><font color="#808080">()
     </font><font color="#000080"><b>select
       when </b></font>opSubMenu <font color="#808080">= </font><font color="#FF0000">1 </font><font color="#000080"><b>then call </b></font>submenu <font color="#FF0000">6</font><font color="#808080">, </font>opVenda
       <font color="#000080"><b>when </b></font>opSubMenu <font color="#808080">= </font><font color="#FF0000">2 </font><font color="#000080"><b>then call </b></font>submenu <font color="#FF0000">12</font><font color="#808080">, </font>opVenda
       <font color="#000080"><b>when </b></font>opSubMenu <font color="#808080">= </font><font color="#FF0000">3 </font><font color="#000080"><b>then </b></font>bSOp<font color="#808080">=</font>false
       otherwise <font color="#000080"><b>say </b></font>MSG_ERRO
     <font color="#000080"><b>end
   end
 end 
 else if </b></font>num <font color="#808080">= </font><font color="#FF0000">4 </font><font color="#000080"><b>then do </b></font><font color="#008000"><i>/* Opcoes */
   </i></font><font color="#000080"><b>do </b></font>while bSOp<font color="#808080">=</font>true
     <font color="#000080"><b>call </b></font>menu <font color="#FF0000">5
     </font>opSubMenu <font color="#808080">= </font><font color="#0000FF"><b>linein</b></font><font color="#808080">()
     </font><font color="#000080"><b>select
       when </b></font>opSubMenu <font color="#808080">= </font><font color="#FF0000">1 </font><font color="#000080"><b>then call </b></font>frmAlterarSenha
       <font color="#000080"><b>when </b></font>opSubMenu <font color="#808080">= </font><font color="#FF0000">2 </font><font color="#000080"><b>then call </b></font>frmSobre
       <font color="#000080"><b>when </b></font>opSubMenu <font color="#808080">= </font><font color="#FF0000">3 </font><font color="#000080"><b>then do
           call </b></font>menu <font color="#FF0000">11
           </font>opSair <font color="#808080">= </font><font color="#0000FF"><b>linein</b></font><font color="#808080">()
           </font><font color="#000080"><b>if </b></font><font color="#808080">(</font>opSair<font color="#808080">='</font>S<font color="#808080">') | (</font>opSair<font color="#808080">='</font>s<font color="#808080">') </font><font color="#000080"><b>then do
              call </b></font>fechaArqs
              <font color="#000080"><b>exit
           end
        end
       when </b></font>opSubMenu <font color="#808080">= </font><font color="#FF0000">4 </font><font color="#000080"><b>then </b></font>bSOp<font color="#808080">=</font>false
       otherwise <font color="#000080"><b>say </b></font>MSG_ERRO
     <font color="#000080"><b>end
   end
 end
return
</b></font><font color="#008000"><i>/*------------------------------------------------------------------------------
Mostra as entradas e as sa&iacute;das do sistema.
sreg - o tipo de arquivo
slinha - o registro com os dados
nOpcao - indica qual op&ccedil;&atilde;o ser&aacute; mostrada
------------------------------------------------------------------------------*/
</i></font>mostrarDados<font color="#808080">: </font><font color="#000080"><b>procedure expose </b></font>g_nPreco tAssunto<font color="#808080">.</font>codigo tAssunto<font color="#808080">.</font>assunto<font color="#808080">, 
 </font>tAutor<font color="#808080">.</font>codigo tAutor<font color="#808080">.</font>autor tEditora<font color="#808080">.</font>codigo tEditora<font color="#808080">.</font>editora tEndereco<font color="#808080">.</font>codigo<font color="#808080">,
 </font>tEndereco<font color="#808080">.</font>logradouro tEndereco<font color="#808080">.</font>bairro tEndereco<font color="#808080">.</font>cep tEndereco<font color="#808080">.</font>cidade<font color="#808080">,
 </font>tEndereco<font color="#808080">.</font>estado tIdioma<font color="#808080">.</font>codigo tIdioma<font color="#808080">.</font>idioma tPais<font color="#808080">.</font>codigo tPais<font color="#808080">.</font>pais<font color="#808080">,
 </font>tProfissao<font color="#808080">.</font>codigo tProfissao<font color="#808080">.</font>profissao tUsuario<font color="#808080">.</font>login tUsuario<font color="#808080">.</font>senha<font color="#808080">,
 </font>tLivro<font color="#808080">.</font>isbn tLivro<font color="#808080">.</font>titulo tLivro<font color="#808080">.</font>edicao tLivro<font color="#808080">.</font>anopubli tLivro<font color="#808080">.</font>codeditora<font color="#808080">,
 </font>tLivro<font color="#808080">.</font>volume tLivro<font color="#808080">.</font>codidioma tLivro<font color="#808080">.</font>npaginas tLivro<font color="#808080">.</font>preco tLivro<font color="#808080">.</font>qtdestoque<font color="#808080">,
 </font>tLivroAss<font color="#808080">.</font>isbn tlivroAss<font color="#808080">.</font>codassunto tLivroAut<font color="#808080">.</font>isbn tlivroAut<font color="#808080">.</font>codautor<font color="#808080">,
 </font>tCliente<font color="#808080">.</font>cpf tCliente<font color="#808080">.</font>nome tCliente<font color="#808080">.</font>email tCliente<font color="#808080">.</font>identidade tCliente<font color="#808080">.</font>sexo<font color="#808080">,
 </font>tCliente<font color="#808080">.</font>telefone tCliente<font color="#808080">.</font>dtnascimento tCliente<font color="#808080">.</font>codendereco tCliente<font color="#808080">.</font>codpais<font color="#808080">,
 </font>tCliente<font color="#808080">.</font>codprofissao tVenda<font color="#808080">.</font>dthrvenda tVenda<font color="#808080">.</font>cpf tVenda<font color="#808080">.</font>isbn tVenda<font color="#808080">.</font>precovenda

  <font color="#000080"><b>parse arg </b></font>sreg<font color="#808080">, </font>slinha<font color="#808080">, </font>nOpcao

<font color="#000080"><b>call </b></font>constantes
<font color="#000080"><b>if </b></font>sreg<font color="#808080">=</font>opAssunto <font color="#000080"><b>then do
   select
     when </b></font>nOpcao <font color="#808080">= </font><font color="#FF0000">1 </font><font color="#000080"><b>then do
        say </b></font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">) || </font>tAssunto<font color="#808080">.</font>codigo
        <font color="#000080"><b>call </b></font><font color="#0000FF"><b>charout </b></font><font color="#808080">,</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">)
        </font>tAssunto<font color="#808080">.</font>assunto <font color="#808080">= </font><font color="#0000FF"><b>linein</b></font><font color="#808080">()
       </font><font color="#000080"><b>end
    when </b></font>nOpcao <font color="#808080">= </font><font color="#FF0000">2 </font><font color="#000080"><b>then do
        say </b></font><font color="#808080">'</font>C<font color="#808080">&oacute;</font>digo     Assunto<font color="#808080">'
        </font><font color="#000080"><b>say </b></font><font color="#808080">'------     -------'
       </font><font color="#000080"><b>end
    when </b></font>nOpcao <font color="#808080">= </font><font color="#FF0000">3 </font><font color="#000080"><b>then do
        </b></font>tAssunto<font color="#808080">.</font>codigo<font color="#808080">=</font><font color="#808000"><b>substr</b></font><font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">)
        </font>tAssunto<font color="#808080">.</font>assunto<font color="#808080">=</font><font color="#808000"><b>substr</b></font><font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">11</font><font color="#808080">, </font><font color="#FF0000">30</font><font color="#808080">)
        </font><font color="#000080"><b>say </b></font>tAssunto<font color="#808080">.</font>codigo<font color="#808080">' '</font>tAssunto<font color="#808080">.</font>assunto
       <font color="#000080"><b>end
   end
end 
else if </b></font>sreg<font color="#808080">=</font>opAutor <font color="#000080"><b>then do
   select
    when </b></font>nOpcao <font color="#808080">= </font><font color="#FF0000">1 </font><font color="#000080"><b>then do
        say </b></font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">) || </font>tAutor<font color="#808080">.</font>codigo
        <font color="#000080"><b>call </b></font><font color="#0000FF"><b>charout </b></font><font color="#808080">,</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">)
        </font>tAutor<font color="#808080">.</font>autor <font color="#808080">= </font><font color="#0000FF"><b>linein</b></font><font color="#808080">()
       </font><font color="#000080"><b>end
    when </b></font>nOpcao <font color="#808080">= </font><font color="#FF0000">2 </font><font color="#000080"><b>then do
        say </b></font><font color="#808080">'</font>C<font color="#808080">&oacute;</font>digo     Autor<font color="#808080">'
        </font><font color="#000080"><b>say </b></font><font color="#808080">'------     -----'
       </font><font color="#000080"><b>end
    when </b></font>nOpcao <font color="#808080">= </font><font color="#FF0000">3 </font><font color="#000080"><b>then do
        </b></font>tAutor<font color="#808080">.</font>codigo<font color="#808080">=</font><font color="#808000"><b>substr</b></font><font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">)
        </font>tAutor<font color="#808080">.</font>autor<font color="#808080">=</font><font color="#808000"><b>substr</b></font><font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">11</font><font color="#808080">, </font><font color="#FF0000">30</font><font color="#808080">)
        </font><font color="#000080"><b>say </b></font>tAutor<font color="#808080">.</font>codigo<font color="#808080">' '</font>tAutor<font color="#808080">.</font>autor
       <font color="#000080"><b>end
   end
end 
else if </b></font>sreg<font color="#808080">=</font>opEditora <font color="#000080"><b>then do
   select
    when </b></font>nOpcao <font color="#808080">= </font><font color="#FF0000">1 </font><font color="#000080"><b>then do
        say </b></font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">) || </font>tEditora<font color="#808080">.</font>codigo
        <font color="#000080"><b>call </b></font><font color="#0000FF"><b>charout </b></font><font color="#808080">,</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">)
        </font>tEditora<font color="#808080">.</font>editora <font color="#808080">= </font><font color="#0000FF"><b>linein</b></font><font color="#808080">()
       </font><font color="#000080"><b>end
    when </b></font>nOpcao <font color="#808080">= </font><font color="#FF0000">2 </font><font color="#000080"><b>then do
        say </b></font><font color="#808080">'</font>C<font color="#808080">&oacute;</font>digo     Editora<font color="#808080">'
        </font><font color="#000080"><b>say </b></font><font color="#808080">'------     -------'
       </font><font color="#000080"><b>end
    when </b></font>nOpcao <font color="#808080">= </font><font color="#FF0000">3 </font><font color="#000080"><b>then do
        </b></font>tEditora<font color="#808080">.</font>codigo<font color="#808080">=</font><font color="#808000"><b>substr</b></font><font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">)
        </font>tEditora<font color="#808080">.</font>editora<font color="#808080">=</font><font color="#808000"><b>substr</b></font><font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">11</font><font color="#808080">, </font><font color="#FF0000">50</font><font color="#808080">)
        </font><font color="#000080"><b>say </b></font>tEditora<font color="#808080">.</font>codigo<font color="#808080">' '</font>tEditora<font color="#808080">.</font>editora
       <font color="#000080"><b>end
   end
end 
else if </b></font>sreg<font color="#808080">=</font>opEndereco <font color="#000080"><b>then do
   select
    when </b></font>nOpcao <font color="#808080">= </font><font color="#FF0000">1 </font><font color="#000080"><b>then do
        say </b></font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">) || </font>tEndereco<font color="#808080">.</font>codigo
        <font color="#000080"><b>call </b></font><font color="#0000FF"><b>charout </b></font><font color="#808080">,</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">)
        </font>tEndereco<font color="#808080">.</font>Logradouro <font color="#808080">= </font><font color="#0000FF"><b>linein</b></font><font color="#808080">()
        </font><font color="#000080"><b>call </b></font><font color="#0000FF"><b>charout </b></font><font color="#808080">,</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">)
        </font>tEndereco<font color="#808080">.</font>bairro <font color="#808080">= </font><font color="#0000FF"><b>linein</b></font><font color="#808080">()
        </font><font color="#000080"><b>call </b></font><font color="#0000FF"><b>charout </b></font><font color="#808080">,</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">4</font><font color="#808080">)
        </font>tEndereco<font color="#808080">.</font>cep <font color="#808080">= </font><font color="#0000FF"><b>linein</b></font><font color="#808080">()
        </font><font color="#000080"><b>call </b></font><font color="#0000FF"><b>charout </b></font><font color="#808080">,</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">5</font><font color="#808080">)
        </font>tEndereco<font color="#808080">.</font>cidade <font color="#808080">= </font><font color="#0000FF"><b>linein</b></font><font color="#808080">()
        </font><font color="#000080"><b>call </b></font><font color="#0000FF"><b>charout </b></font><font color="#808080">,</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">6</font><font color="#808080">)
        </font>tEndereco<font color="#808080">.</font>estado <font color="#808080">= </font><font color="#0000FF"><b>linein</b></font><font color="#808080">()
       </font><font color="#000080"><b>end
    when </b></font>nOpcao <font color="#808080">= </font><font color="#FF0000">3 </font><font color="#000080"><b>then do
        </b></font>tEndereco<font color="#808080">.</font>codigo<font color="#808080">=</font><font color="#808000"><b>strip</b></font><font color="#808080">(</font><font color="#808000"><b>substr</b></font><font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">))
        </font>tEndereco<font color="#808080">.</font>logradouro<font color="#808080">=</font><font color="#808000"><b>strip</b></font><font color="#808080">(</font><font color="#808000"><b>substr</b></font><font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">11</font><font color="#808080">, </font><font color="#FF0000">40</font><font color="#808080">))
        </font>tEndereco<font color="#808080">.</font>bairro<font color="#808080">=</font><font color="#808000"><b>strip</b></font><font color="#808080">(</font><font color="#808000"><b>substr</b></font><font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">51</font><font color="#808080">, </font><font color="#FF0000">15</font><font color="#808080">))
        </font>tEndereco<font color="#808080">.</font>cep<font color="#808080">=</font><font color="#808000"><b>strip</b></font><font color="#808080">(</font><font color="#808000"><b>substr</b></font><font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">66</font><font color="#808080">, </font><font color="#FF0000">8</font><font color="#808080">))
        </font>tEndereco<font color="#808080">.</font>cidade<font color="#808080">=</font><font color="#808000"><b>strip</b></font><font color="#808080">(</font><font color="#808000"><b>substr</b></font><font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">74</font><font color="#808080">, </font><font color="#FF0000">30</font><font color="#808080">))
        </font>tEndereco<font color="#808080">.</font>estado<font color="#808080">=</font><font color="#808000"><b>strip</b></font><font color="#808080">(</font><font color="#808000"><b>substr</b></font><font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">104</font><font color="#808080">, </font><font color="#FF0000">20</font><font color="#808080">))
        </font><font color="#000080"><b>say </b></font><font color="#808080">'--------------------'
        </font><font color="#000080"><b>say </b></font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">) || </font>tEndereco<font color="#808080">.</font>codigo
        <font color="#000080"><b>say </b></font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">) || </font>tEndereco<font color="#808080">.</font>Logradouro
        <font color="#000080"><b>say </b></font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">) || </font>tEndereco<font color="#808080">.</font>bairro
        <font color="#000080"><b>say </b></font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">4</font><font color="#808080">) || </font>tEndereco<font color="#808080">.</font>cep
        <font color="#000080"><b>say </b></font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">5</font><font color="#808080">) || </font>tEndereco<font color="#808080">.</font>cidade
        <font color="#000080"><b>say </b></font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">6</font><font color="#808080">) || </font>tEndereco<font color="#808080">.</font>estado
       <font color="#000080"><b>end
   end
end 
else if </b></font>sreg<font color="#808080">=</font>opIdioma <font color="#000080"><b>then do
   select
    when </b></font>nOpcao <font color="#808080">= </font><font color="#FF0000">1 </font><font color="#000080"><b>then do
        say </b></font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">) || </font>tIdioma<font color="#808080">.</font>codigo
        <font color="#000080"><b>call </b></font><font color="#0000FF"><b>charout </b></font><font color="#808080">,</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">)
        </font>tIdioma<font color="#808080">.</font>idioma <font color="#808080">= </font><font color="#0000FF"><b>linein</b></font><font color="#808080">()
       </font><font color="#000080"><b>end
    when </b></font>nOpcao <font color="#808080">= </font><font color="#FF0000">2 </font><font color="#000080"><b>then do
        say </b></font><font color="#808080">'</font>C<font color="#808080">&oacute;</font>digo     Idioma<font color="#808080">'
        </font><font color="#000080"><b>say </b></font><font color="#808080">'------     ------'
       </font><font color="#000080"><b>end
    when </b></font>nOpcao <font color="#808080">= </font><font color="#FF0000">3 </font><font color="#000080"><b>then do
        </b></font>tIdioma<font color="#808080">.</font>codigo<font color="#808080">=</font><font color="#808000"><b>substr</b></font><font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">)
        </font>tIdioma<font color="#808080">.</font>idioma<font color="#808080">=</font><font color="#808000"><b>substr</b></font><font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">11</font><font color="#808080">, </font><font color="#FF0000">20</font><font color="#808080">)
        </font><font color="#000080"><b>say </b></font>tIdioma<font color="#808080">.</font>codigo<font color="#808080">' '</font>tIdioma<font color="#808080">.</font>idioma
       <font color="#000080"><b>end
   end
end 
else if </b></font>sreg<font color="#808080">=</font>opPais <font color="#000080"><b>then do
   select
    when </b></font>nOpcao <font color="#808080">= </font><font color="#FF0000">1 </font><font color="#000080"><b>then do
        call </b></font><font color="#0000FF"><b>charout </b></font><font color="#808080">,</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">)
        </font>tPais<font color="#808080">.</font>pais <font color="#808080">= </font><font color="#0000FF"><b>linein</b></font><font color="#808080">()
       </font><font color="#000080"><b>end
    when </b></font>nOpcao <font color="#808080">= </font><font color="#FF0000">2 </font><font color="#000080"><b>then do
        say </b></font><font color="#808080">'</font>C<font color="#808080">&oacute;</font>digo Pa<font color="#808080">&iacute;</font>s<font color="#808080">'
        </font><font color="#000080"><b>say </b></font><font color="#808080">'------ ----'
       </font><font color="#000080"><b>end
    when </b></font>nOpcao <font color="#808080">= </font><font color="#FF0000">3 </font><font color="#000080"><b>then do
        </b></font>tPais<font color="#808080">.</font>codigo<font color="#808080">=</font><font color="#808000"><b>substr</b></font><font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">)
        </font>tPais<font color="#808080">.</font>pais<font color="#808080">=</font><font color="#808000"><b>substr</b></font><font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">4</font><font color="#808080">, </font><font color="#FF0000">50</font><font color="#808080">)
        </font><font color="#000080"><b>say </b></font>tPais<font color="#808080">.</font>codigo<font color="#808080">'    '</font>tPais<font color="#808080">.</font>pais
       <font color="#000080"><b>end
   end
end 
else if </b></font>sreg<font color="#808080">=</font>opProfissao <font color="#000080"><b>then do
   select
    when </b></font>nOpcao <font color="#808080">= </font><font color="#FF0000">1 </font><font color="#000080"><b>then do
        say </b></font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">) || </font>tProfissao<font color="#808080">.</font>codigo
        <font color="#000080"><b>call </b></font><font color="#0000FF"><b>charout </b></font><font color="#808080">,</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">)
        </font>tProfissao<font color="#808080">.</font>profissao <font color="#808080">= </font><font color="#0000FF"><b>linein</b></font><font color="#808080">()
       </font><font color="#000080"><b>end
    when </b></font>nOpcao <font color="#808080">= </font><font color="#FF0000">2 </font><font color="#000080"><b>then do
        say </b></font><font color="#808080">'</font>C<font color="#808080">&oacute;</font>digo     Profiss<font color="#808080">&atilde;</font>o<font color="#808080">'
        </font><font color="#000080"><b>say </b></font><font color="#808080">'------     ---------'
       </font><font color="#000080"><b>end
    when </b></font>nOpcao <font color="#808080">= </font><font color="#FF0000">3 </font><font color="#000080"><b>then do
        </b></font>tProfissao<font color="#808080">.</font>codigo<font color="#808080">=</font><font color="#808000"><b>substr</b></font><font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">)
        </font>tProfissao<font color="#808080">.</font>profissao<font color="#808080">=</font><font color="#808000"><b>substr</b></font><font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">11</font><font color="#808080">, </font><font color="#FF0000">50</font><font color="#808080">)
        </font><font color="#000080"><b>say </b></font>tProfissao<font color="#808080">.</font>codigo<font color="#808080">' '</font>tProfissao<font color="#808080">.</font>profissao
       <font color="#000080"><b>end
   end
end 
else if </b></font>sreg<font color="#808080">=</font>opLivro <font color="#000080"><b>then do
   select
    when </b></font>nOpcao <font color="#808080">= </font><font color="#FF0000">1 </font><font color="#000080"><b>then do
        call </b></font><font color="#0000FF"><b>charout </b></font><font color="#808080">,</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">)
        </font>tLivro<font color="#808080">.</font>titulo <font color="#808080">= </font><font color="#0000FF"><b>linein</b></font><font color="#808080">()
        </font>tLivro<font color="#808080">.</font>edicao<font color="#808080">=</font>validaNumero<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">), </font>tLivro<font color="#808080">.</font>edicao<font color="#808080">)
        </font>tLivro<font color="#808080">.</font>anopubli<font color="#808080">=</font>validaNumero<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">4</font><font color="#808080">), </font>tLivro<font color="#808080">.</font>anopubli<font color="#808080">)
        </font><font color="#000080"><b>call </b></font>mostrarSubDados opLivro<font color="#808080">, </font>opEditora<font color="#808080">, </font>false
        tLivro<font color="#808080">.</font>volume<font color="#808080">=</font>validaNumero<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">6</font><font color="#808080">), </font>tLivro<font color="#808080">.</font>volume<font color="#808080">)
        </font><font color="#000080"><b>call </b></font>mostrarSubDados opLivro<font color="#808080">, </font>opIdioma<font color="#808080">, </font>false
        tLivro<font color="#808080">.</font>npaginas<font color="#808080">=</font>validaNumero<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">8</font><font color="#808080">), </font>tLivro<font color="#808080">.</font>npaginas<font color="#808080">)
        </font>tLivro<font color="#808080">.</font>preco<font color="#808080">=</font>validaNumero<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">9</font><font color="#808080">), </font>tLivro<font color="#808080">.</font>preco<font color="#808080">)
        </font>tLivro<font color="#808080">.</font>qtdestoque<font color="#808080">=</font>validaNumero<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">), </font>tLivro<font color="#808080">.</font>qtdestoque<font color="#808080">)
       </font><font color="#000080"><b>end
    when </b></font>nOpcao <font color="#808080">= </font><font color="#FF0000">3 </font><font color="#000080"><b>then do
        </b></font>tLivro<font color="#808080">.</font>isbn<font color="#808080">=</font><font color="#808000"><b>strip</b></font><font color="#808080">(</font><font color="#808000"><b>substr</b></font><font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">13</font><font color="#808080">))
        </font>tLivro<font color="#808080">.</font>titulo<font color="#808080">=</font><font color="#808000"><b>strip</b></font><font color="#808080">(</font><font color="#808000"><b>substr</b></font><font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">14</font><font color="#808080">, </font><font color="#FF0000">50</font><font color="#808080">))
        </font>tLivro<font color="#808080">.</font>edicao<font color="#808080">=</font><font color="#808000"><b>strip</b></font><font color="#808080">(</font><font color="#808000"><b>substr</b></font><font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">64</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">))
        </font>tLivro<font color="#808080">.</font>anopubli<font color="#808080">=</font><font color="#808000"><b>strip</b></font><font color="#808080">(</font><font color="#808000"><b>substr</b></font><font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">74</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">))
        </font>tLivro<font color="#808080">.</font>codeditora<font color="#808080">=</font><font color="#808000"><b>strip</b></font><font color="#808080">(</font><font color="#808000"><b>substr</b></font><font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">84</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">))
        </font>tLivro<font color="#808080">.</font>volume<font color="#808080">=</font><font color="#808000"><b>strip</b></font><font color="#808080">(</font><font color="#808000"><b>substr</b></font><font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">94</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">))
        </font>tLivro<font color="#808080">.</font>codidioma<font color="#808080">=</font><font color="#808000"><b>strip</b></font><font color="#808080">(</font><font color="#808000"><b>substr</b></font><font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">104</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">))
        </font>tLivro<font color="#808080">.</font>npaginas<font color="#808080">=</font><font color="#808000"><b>strip</b></font><font color="#808080">(</font><font color="#808000"><b>substr</b></font><font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">114</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">))
        </font>tLivro<font color="#808080">.</font>preco<font color="#808080">=</font><font color="#808000"><b>strip</b></font><font color="#808080">(</font><font color="#808000"><b>substr</b></font><font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">124</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">))
        </font>tLivro<font color="#808080">.</font>qtdestoque<font color="#808080">=</font><font color="#808000"><b>strip</b></font><font color="#808080">(</font><font color="#808000"><b>substr</b></font><font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">134</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">))
        </font><font color="#000080"><b>say </b></font><font color="#808080">'--------------------'
        </font><font color="#000080"><b>say </b></font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">) || </font>tLivro<font color="#808080">.</font>isbn
        <font color="#000080"><b>say </b></font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">) || </font>tLivro<font color="#808080">.</font>titulo
        <font color="#000080"><b>say </b></font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">) || </font>tLivro<font color="#808080">.</font>edicao
        <font color="#000080"><b>say </b></font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">4</font><font color="#808080">) || </font>tLivro<font color="#808080">.</font>anopubli
        <font color="#000080"><b>say </b></font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">5</font><font color="#808080">) || </font>tLivro<font color="#808080">.</font>codeditora
        <font color="#000080"><b>call </b></font>mostrarSubDados opLivro<font color="#808080">, </font>opEditora<font color="#808080">, </font>true
        <font color="#000080"><b>say </b></font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">6</font><font color="#808080">) || </font>tLivro<font color="#808080">.</font>volume
        <font color="#000080"><b>say </b></font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">7</font><font color="#808080">) || </font>tLivro<font color="#808080">.</font>codidioma
        <font color="#000080"><b>call </b></font>mostrarSubDados opLivro<font color="#808080">, </font>opIdioma<font color="#808080">, </font>true
        <font color="#000080"><b>say </b></font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">8</font><font color="#808080">) || </font>tLivro<font color="#808080">.</font>npaginas
        <font color="#000080"><b>say </b></font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">9</font><font color="#808080">) || </font>tLivro<font color="#808080">.</font>preco
        <font color="#000080"><b>say </b></font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">) || </font>tLivro<font color="#808080">.</font>qtdestoque
        <font color="#000080"><b>call </b></font>ListarRegLigados tfLivroAss<font color="#808080">, </font>opLivroAss<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">13</font><font color="#808080">, </font><font color="#FF0000">14</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">, </font>tLivro<font color="#808080">.</font>isbn<font color="#808080">,
                         </font>tfAssunto<font color="#808080">, </font>opAssunto<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">4
        </font><font color="#000080"><b>call </b></font>ListarRegLigados tfLivroAut<font color="#808080">, </font>opLivroAut<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">13</font><font color="#808080">, </font><font color="#FF0000">14</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">, </font>tLivro<font color="#808080">.</font>isbn<font color="#808080">,
                         </font>tfAutor<font color="#808080">, </font>opAutor<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">4
       </font><font color="#000080"><b>end
   end
end 
else if </b></font>sreg<font color="#808080">=</font>opCliente <font color="#000080"><b>then do
   select
    when </b></font>nOpcao <font color="#808080">= </font><font color="#FF0000">1 </font><font color="#000080"><b>then do
        call </b></font><font color="#0000FF"><b>charout </b></font><font color="#808080">,</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">)
        </font>tCliente<font color="#808080">.</font>nome <font color="#808080">= </font><font color="#0000FF"><b>linein</b></font><font color="#808080">()
        </font><font color="#000080"><b>call </b></font><font color="#0000FF"><b>charout </b></font><font color="#808080">,</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">)
        </font>tCliente<font color="#808080">.</font>email <font color="#808080">= </font><font color="#0000FF"><b>linein</b></font><font color="#808080">()
        </font><font color="#000080"><b>call </b></font><font color="#0000FF"><b>charout </b></font><font color="#808080">,</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">4</font><font color="#808080">)
        </font>tCliente<font color="#808080">.</font>identidade <font color="#808080">= </font><font color="#0000FF"><b>linein</b></font><font color="#808080">()
        </font><font color="#000080"><b>call </b></font><font color="#0000FF"><b>charout </b></font><font color="#808080">,</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">5</font><font color="#808080">)
        </font>tCliente<font color="#808080">.</font>sexo <font color="#808080">= </font><font color="#0000FF"><b>linein</b></font><font color="#808080">()
        </font><font color="#000080"><b>call </b></font><font color="#0000FF"><b>charout </b></font><font color="#808080">,</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">6</font><font color="#808080">)
        </font>tCliente<font color="#808080">.</font>telefone <font color="#808080">= </font><font color="#0000FF"><b>linein</b></font><font color="#808080">()
        </font>tCliente<font color="#808080">.</font>dtnascimento<font color="#808080">=
                </font>validaDataHora<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">7</font><font color="#808080">), </font>tCliente<font color="#808080">.</font>dtnascimento<font color="#808080">, </font>true<font color="#808080">)
        </font><font color="#000080"><b>call </b></font>mostrarSubDados opCliente<font color="#808080">, </font>opEndereco<font color="#808080">, </font>false
        <font color="#000080"><b>call </b></font>mostrarSubDados opCliente<font color="#808080">, </font>opPais<font color="#808080">, </font>false
        <font color="#000080"><b>call </b></font>mostrarSubDados opCliente<font color="#808080">, </font>opProfissao<font color="#808080">, </font>false
       <font color="#000080"><b>end
    when </b></font>nOpcao <font color="#808080">= </font><font color="#FF0000">3 </font><font color="#000080"><b>then do
        </b></font>tCliente<font color="#808080">.</font>cpf<font color="#808080">=</font><font color="#808000"><b>strip</b></font><font color="#808080">(</font><font color="#808000"><b>substr</b></font><font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">14</font><font color="#808080">))
        </font>tCliente<font color="#808080">.</font>nome<font color="#808080">=</font><font color="#808000"><b>strip</b></font><font color="#808080">(</font><font color="#808000"><b>substr</b></font><font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">15</font><font color="#808080">, </font><font color="#FF0000">30</font><font color="#808080">))
        </font>tCliente<font color="#808080">.</font>email<font color="#808080">=</font><font color="#808000"><b>strip</b></font><font color="#808080">(</font><font color="#808000"><b>substr</b></font><font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">45</font><font color="#808080">, </font><font color="#FF0000">30</font><font color="#808080">))
        </font>tCliente<font color="#808080">.</font>identidade<font color="#808080">=</font><font color="#808000"><b>strip</b></font><font color="#808080">(</font><font color="#808000"><b>substr</b></font><font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">75</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">))
        </font>tCliente<font color="#808080">.</font>sexo<font color="#808080">=</font><font color="#808000"><b>strip</b></font><font color="#808080">(</font><font color="#808000"><b>substr</b></font><font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">85</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">))
        </font>tCliente<font color="#808080">.</font>telefone<font color="#808080">=</font><font color="#808000"><b>strip</b></font><font color="#808080">(</font><font color="#808000"><b>substr</b></font><font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">86</font><font color="#808080">, </font><font color="#FF0000">17</font><font color="#808080">))
        </font>tCliente<font color="#808080">.</font>dtnascimento<font color="#808080">=</font><font color="#808000"><b>strip</b></font><font color="#808080">(</font><font color="#808000"><b>substr</b></font><font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">103</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">))
        </font>tCliente<font color="#808080">.</font>codendereco<font color="#808080">=</font><font color="#808000"><b>strip</b></font><font color="#808080">(</font><font color="#808000"><b>substr</b></font><font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">113</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">))
        </font>tCliente<font color="#808080">.</font>codpais<font color="#808080">=</font><font color="#808000"><b>strip</b></font><font color="#808080">(</font><font color="#808000"><b>substr</b></font><font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">123</font><font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">))
        </font>tCliente<font color="#808080">.</font>codprofissao<font color="#808080">=</font><font color="#808000"><b>strip</b></font><font color="#808080">(</font><font color="#808000"><b>substr</b></font><font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">126</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">))
        </font><font color="#000080"><b>say </b></font><font color="#808080">'--------------------'
        </font><font color="#000080"><b>say </b></font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">) || </font>tCliente<font color="#808080">.</font>cpf
        <font color="#000080"><b>say </b></font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">) || </font>tCliente<font color="#808080">.</font>nome
        <font color="#000080"><b>say </b></font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">) || </font>tCliente<font color="#808080">.</font>email
        <font color="#000080"><b>say </b></font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">4</font><font color="#808080">) || </font>tCliente<font color="#808080">.</font>identidade
        <font color="#000080"><b>say </b></font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">5</font><font color="#808080">) || </font>tCliente<font color="#808080">.</font>sexo
        <font color="#000080"><b>say </b></font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">6</font><font color="#808080">) || </font>tCliente<font color="#808080">.</font>telefone
        <font color="#000080"><b>say </b></font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">7</font><font color="#808080">) || </font>tCliente<font color="#808080">.</font>dtnascimento
        <font color="#000080"><b>say </b></font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">8</font><font color="#808080">) || </font>tCliente<font color="#808080">.</font>codendereco
        <font color="#000080"><b>call </b></font>mostrarSubDados opCliente<font color="#808080">, </font>opEndereco<font color="#808080">, </font>true
        <font color="#000080"><b>say </b></font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">9</font><font color="#808080">) || </font>tCliente<font color="#808080">.</font>codpais
        <font color="#000080"><b>call </b></font>mostrarSubDados opCliente<font color="#808080">, </font>opPais<font color="#808080">, </font>true
        <font color="#000080"><b>say </b></font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">) || </font>tCliente<font color="#808080">.</font>codprofissao
        <font color="#000080"><b>call </b></font>mostrarSubDados opCliente<font color="#808080">, </font>opProfissao<font color="#808080">, </font>true
       <font color="#000080"><b>end
   end
end 
else if </b></font>sreg<font color="#808080">=</font>opVenda <font color="#000080"><b>then do
   select
    when </b></font>nOpcao <font color="#808080">= </font><font color="#FF0000">1 </font><font color="#000080"><b>then call </b></font>mostrarSubDados opVenda<font color="#808080">,</font>opVenda<font color="#808080">, </font>false
    <font color="#000080"><b>when </b></font>nOpcao <font color="#808080">= </font><font color="#FF0000">2 </font><font color="#000080"><b>then do
        say </b></font><font color="#808080">'</font>DataHoraVenda       CPF            ISBN          Pre<font color="#808080">&ccedil;</font>oVenda<font color="#808080">'
        </font><font color="#000080"><b>say </b></font><font color="#808080">'-------------       ---            ----          ----------'
       </font><font color="#000080"><b>end
    when </b></font>nOpcao <font color="#808080">= </font><font color="#FF0000">3 </font><font color="#000080"><b>then do
        </b></font>tVenda<font color="#808080">.</font>dthrvenda<font color="#808080">=</font><font color="#808000"><b>substr</b></font><font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">19</font><font color="#808080">)
        </font>tVenda<font color="#808080">.</font>cpf<font color="#808080">=</font><font color="#808000"><b>substr</b></font><font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">20</font><font color="#808080">, </font><font color="#FF0000">14</font><font color="#808080">)
        </font>tVenda<font color="#808080">.</font>isbn<font color="#808080">=</font><font color="#808000"><b>substr</b></font><font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">34</font><font color="#808080">, </font><font color="#FF0000">13</font><font color="#808080">)
        </font>tVenda<font color="#808080">.</font>precovenda<font color="#808080">=</font><font color="#808000"><b>substr</b></font><font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">47</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">)
        </font><font color="#000080"><b>say </b></font>tVenda<font color="#808080">.</font>dthrvenda<font color="#808080">' '</font>tVenda<font color="#808080">.</font>cpf<font color="#808080">' '</font>tVenda<font color="#808080">.</font>isbn<font color="#808080">' '</font>tVenda<font color="#808080">.</font>precovenda
       <font color="#000080"><b>end
   end
end
return
</b></font><font color="#008000"><i>/*------------------------------------------------------------------------------
Mostra as sub inform&ccedil;&otilde;es de entrada e de sa&iacute;da.
sreg - o tipo de arquivo
ssubreg - o subtipo de arquivo
bSoMostrar - se vai s&oacute; mostrar na sa&iacute;da 
------------------------------------------------------------------------------*/
</i></font>mostrarSubDados<font color="#808080">: </font><font color="#000080"><b>procedure expose </b></font>g_nPreco
 tEditora<font color="#808080">.</font>codigo tEditora<font color="#808080">.</font>editora tEndereco<font color="#808080">.</font>codigo<font color="#808080">,
 </font>tEndereco<font color="#808080">.</font>logradouro tEndereco<font color="#808080">.</font>bairro tEndereco<font color="#808080">.</font>cep tEndereco<font color="#808080">.</font>cidade<font color="#808080">,
 </font>tEndereco<font color="#808080">.</font>estado tIdioma<font color="#808080">.</font>codigo tIdioma<font color="#808080">.</font>idioma tPais<font color="#808080">.</font>codigo tPais<font color="#808080">.</font>pais<font color="#808080">,
 </font>tProfissao<font color="#808080">.</font>codigo tProfissao<font color="#808080">.</font>profissao tUsuario<font color="#808080">.</font>login tUsuario<font color="#808080">.</font>senha<font color="#808080">,
 </font>tLivro<font color="#808080">.</font>isbn tLivro<font color="#808080">.</font>titulo tLivro<font color="#808080">.</font>edicao tLivro<font color="#808080">.</font>anopubli tLivro<font color="#808080">.</font>codeditora<font color="#808080">,
 </font>tLivro<font color="#808080">.</font>volume tLivro<font color="#808080">.</font>codidioma tLivro<font color="#808080">.</font>npaginas tLivro<font color="#808080">.</font>preco tLivro<font color="#808080">.</font>qtdestoque<font color="#808080">,
 </font>tCliente<font color="#808080">.</font>cpf tCliente<font color="#808080">.</font>nome tCliente<font color="#808080">.</font>email tCliente<font color="#808080">.</font>identidade tCliente<font color="#808080">.</font>sexo<font color="#808080">,
 </font>tCliente<font color="#808080">.</font>telefone tCliente<font color="#808080">.</font>dtnascimento tCliente<font color="#808080">.</font>codendereco tCliente<font color="#808080">.</font>codpais<font color="#808080">,
 </font>tCliente<font color="#808080">.</font>codprofissao tVenda<font color="#808080">.</font>dthrvenda tVenda<font color="#808080">.</font>cpf tVenda<font color="#808080">.</font>isbn tVenda<font color="#808080">.</font>precovenda

  <font color="#000080"><b>parse arg </b></font>sreg<font color="#808080">, </font>ssubreg<font color="#808080">, </font>bSoMostrar

<font color="#000080"><b>call </b></font>constantes
sRegistro <font color="#808080">= ''; </font>sPreco <font color="#808080">= ''
</font>nMaxTentativas<font color="#808080">=</font><font color="#FF0000">3
</font><font color="#000080"><b>if </b></font>sreg<font color="#808080">=</font>opLivro <font color="#000080"><b>then do
  if </b></font>ssubreg<font color="#808080">=</font>opEditora <font color="#000080"><b>then do
    if </b></font>bSoMostrar <font color="#000080"><b>then
       </b></font>sRegistro<font color="#808080">=</font>pesqArq<font color="#808080">(</font>tfEditora<font color="#808080">,</font>tLivro<font color="#808080">.</font>codeditora<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">,</font>tamReg<font color="#808080">(</font>opEditora<font color="#808080">))
    </font><font color="#000080"><b>else
       </b></font>sRegistro<font color="#808080">=</font>validaEntrada<font color="#808080">(</font>tfEditora<font color="#808080">,</font>ssubreg<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font>tLivro<font color="#808080">.</font>codeditora<font color="#808080">,
                  </font>nMaxTentativas<font color="#808080">,</font>false<font color="#808080">,</font>opNumero<font color="#808080">)
    </font><font color="#000080"><b>if </b></font>sRegistro<font color="#808080">&lt;&gt;'' </font><font color="#000080"><b>then do
      </b></font>tLivro<font color="#808080">.</font>codeditora<font color="#808080">=</font><font color="#808000"><b>strip</b></font><font color="#808080">(</font><font color="#808000"><b>substr</b></font><font color="#808080">(</font>sRegistro<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">))
      </font><font color="#000080"><b>call </b></font><font color="#0000FF"><b>charout </b></font><font color="#808080">,' '</font>rotulo<font color="#808080">(</font>opEditora<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">)
      </font><font color="#000080"><b>say </b></font><font color="#808000"><b>substr</b></font><font color="#808080">(</font>sRegistro<font color="#808080">, </font>gnPosChave<font color="#808080">(</font>opEditora<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">), </font>gnTamChave<font color="#808080">(</font>opEditora<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">))
    </font><font color="#000080"><b>end
  end 
  else if </b></font>ssubreg<font color="#808080">=</font>opIdioma <font color="#000080"><b>then do
    if </b></font>bSoMostrar <font color="#000080"><b>then
       </b></font>sRegistro<font color="#808080">=</font>pesqArq<font color="#808080">(</font>tfIdioma<font color="#808080">, </font>tLivro<font color="#808080">.</font>codidioma<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">,</font>tamReg<font color="#808080">(</font>opIdioma<font color="#808080">))
    </font><font color="#000080"><b>else
       </b></font>sRegistro<font color="#808080">=</font>validaEntrada<font color="#808080">(</font>tfIdioma<font color="#808080">,</font>ssubreg<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font>tLivro<font color="#808080">.</font>codidioma<font color="#808080">,
                  </font>nMaxTentativas<font color="#808080">,</font>false<font color="#808080">,</font>opNumero<font color="#808080">)
    </font><font color="#000080"><b>if </b></font>sRegistro<font color="#808080">&lt;&gt;'' </font><font color="#000080"><b>then do
      </b></font>tLivro<font color="#808080">.</font>codidioma<font color="#808080">=</font><font color="#808000"><b>strip</b></font><font color="#808080">(</font><font color="#808000"><b>substr</b></font><font color="#808080">(</font>sRegistro<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">))
      </font><font color="#000080"><b>call </b></font><font color="#0000FF"><b>charout </b></font><font color="#808080">,' '</font>rotulo<font color="#808080">(</font>opIdioma<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">)
      </font><font color="#000080"><b>say </b></font><font color="#808000"><b>substr</b></font><font color="#808080">(</font>sRegistro<font color="#808080">, </font>gnPosChave<font color="#808080">(</font>opIdioma<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">), </font>gnTamChave<font color="#808080">(</font>opIdioma<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">))
    </font><font color="#000080"><b>end
  end
end 
else if </b></font>sreg<font color="#808080">=</font>opCliente <font color="#000080"><b>then do
  if </b></font>ssubreg<font color="#808080">=</font>opEndereco <font color="#000080"><b>then do
    if </b></font>bSoMostrar <font color="#000080"><b>then
       </b></font>sRegistro<font color="#808080">=</font>pesqArq<font color="#808080">(</font>tfEndereco<font color="#808080">, </font>tCliente<font color="#808080">.</font>codendereco<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">,
                  </font>tamReg<font color="#808080">(</font>opEndereco<font color="#808080">))
    </font><font color="#000080"><b>else
       </b></font>sRegistro<font color="#808080">=</font>validaEntrada<font color="#808080">(</font>tfEndereco<font color="#808080">,</font>ssubreg<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font>tCliente<font color="#808080">.</font>codendereco<font color="#808080">,
                  </font>nMaxTentativas<font color="#808080">,</font>false<font color="#808080">,</font>opNumero<font color="#808080">)
    </font><font color="#000080"><b>if </b></font>sRegistro<font color="#808080">&lt;&gt;'' </font><font color="#000080"><b>then do
      </b></font>tCliente<font color="#808080">.</font>codendereco<font color="#808080">=</font><font color="#808000"><b>strip</b></font><font color="#808080">(</font><font color="#808000"><b>substr</b></font><font color="#808080">(</font>sRegistro<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">))
      </font><font color="#000080"><b>call </b></font><font color="#0000FF"><b>charout </b></font><font color="#808080">,' '</font>rotulo<font color="#808080">(</font>opEndereco<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">)
      </font><font color="#000080"><b>say </b></font><font color="#808000"><b>substr</b></font><font color="#808080">(</font>sRegistro<font color="#808080">, </font>gnPosChave<font color="#808080">(</font>opEndereco<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">), </font>gnTamChave<font color="#808080">(</font>opEndereco<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">))
      </font><font color="#000080"><b>call </b></font><font color="#0000FF"><b>charout </b></font><font color="#808080">,' '</font>rotulo<font color="#808080">(</font>opEndereco<font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">)
      </font><font color="#000080"><b>say </b></font><font color="#808000"><b>substr</b></font><font color="#808080">(</font>sRegistro<font color="#808080">, </font>gnPosChave<font color="#808080">(</font>opEndereco<font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">), </font>gnTamChave<font color="#808080">(</font>opEndereco<font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">))
      </font><font color="#000080"><b>call </b></font><font color="#0000FF"><b>charout </b></font><font color="#808080">,' '</font>rotulo<font color="#808080">(</font>opEndereco<font color="#808080">, </font><font color="#FF0000">4</font><font color="#808080">)
      </font><font color="#000080"><b>say </b></font><font color="#808000"><b>substr</b></font><font color="#808080">(</font>sRegistro<font color="#808080">, </font>gnPosChave<font color="#808080">(</font>opEndereco<font color="#808080">, </font><font color="#FF0000">4</font><font color="#808080">), </font>gnTamChave<font color="#808080">(</font>opEndereco<font color="#808080">, </font><font color="#FF0000">4</font><font color="#808080">))
      </font><font color="#000080"><b>call </b></font><font color="#0000FF"><b>charout </b></font><font color="#808080">,' '</font>rotulo<font color="#808080">(</font>opEndereco<font color="#808080">, </font><font color="#FF0000">5</font><font color="#808080">)
      </font><font color="#000080"><b>say </b></font><font color="#808000"><b>substr</b></font><font color="#808080">(</font>sRegistro<font color="#808080">, </font>gnPosChave<font color="#808080">(</font>opEndereco<font color="#808080">, </font><font color="#FF0000">5</font><font color="#808080">), </font>gnTamChave<font color="#808080">(</font>opEndereco<font color="#808080">, </font><font color="#FF0000">5</font><font color="#808080">))
      </font><font color="#000080"><b>call </b></font><font color="#0000FF"><b>charout </b></font><font color="#808080">,' '</font>rotulo<font color="#808080">(</font>opEndereco<font color="#808080">, </font><font color="#FF0000">6</font><font color="#808080">)
      </font><font color="#000080"><b>say </b></font><font color="#808000"><b>substr</b></font><font color="#808080">(</font>sRegistro<font color="#808080">, </font>gnPosChave<font color="#808080">(</font>opEndereco<font color="#808080">, </font><font color="#FF0000">6</font><font color="#808080">), </font>gnTamChave<font color="#808080">(</font>opEndereco<font color="#808080">, </font><font color="#FF0000">6</font><font color="#808080">))
    </font><font color="#000080"><b>end
  end 
  else if </b></font>ssubreg<font color="#808080">=</font>opPais <font color="#000080"><b>then do
    if </b></font>bSoMostrar <font color="#000080"><b>then
       </b></font>sRegistro<font color="#808080">=</font>pesqArq<font color="#808080">(</font>tfPais<font color="#808080">, </font>tCliente<font color="#808080">.</font>codpais<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">, </font>tamReg<font color="#808080">(</font>opPais<font color="#808080">))
    </font><font color="#000080"><b>else
       </b></font>sRegistro<font color="#808080">=</font>validaEntrada<font color="#808080">(</font>tfPais<font color="#808080">,</font>ssubreg<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font>tCliente<font color="#808080">.</font>codpais<font color="#808080">,
                  </font>nMaxTentativas<font color="#808080">,</font>false<font color="#808080">,</font>opTexto<font color="#808080">)
    </font><font color="#000080"><b>if </b></font>sRegistro<font color="#808080">&lt;&gt;'' </font><font color="#000080"><b>then do
      </b></font>tCliente<font color="#808080">.</font>codpais<font color="#808080">=</font><font color="#808000"><b>strip</b></font><font color="#808080">(</font><font color="#808000"><b>substr</b></font><font color="#808080">(</font>sRegistro<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#FF0000">3</font><font color="#808080">))
      </font><font color="#000080"><b>call </b></font><font color="#0000FF"><b>charout </b></font><font color="#808080">,' '</font>rotulo<font color="#808080">(</font>opPais<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">)
      </font><font color="#000080"><b>say </b></font><font color="#808000"><b>substr</b></font><font color="#808080">(</font>sRegistro<font color="#808080">, </font>gnPosChave<font color="#808080">(</font>opPais<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">), </font>gnTamChave<font color="#808080">(</font>opPais<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">))
    </font><font color="#000080"><b>end
  end 
  else if </b></font>ssubreg<font color="#808080">=</font>opProfissao <font color="#000080"><b>then do
    if </b></font>bSoMostrar <font color="#000080"><b>then
       </b></font>sRegistro<font color="#808080">=</font>pesqArq<font color="#808080">(</font>tfProfissao<font color="#808080">, </font>tCliente<font color="#808080">.</font>codprofissao<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">,
                  </font>tamReg<font color="#808080">(</font>opProfissao<font color="#808080">))
    </font><font color="#000080"><b>else
       </b></font>sRegistro<font color="#808080">=</font>validaEntrada<font color="#808080">(</font>tfProfissao<font color="#808080">,</font>ssubreg<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font>tCliente<font color="#808080">.</font>codprofissao<font color="#808080">,
                  </font>nMaxTentativas<font color="#808080">,</font>false<font color="#808080">,</font>opNumero<font color="#808080">)
    </font><font color="#000080"><b>if </b></font>sRegistro<font color="#808080">&lt;&gt;'' </font><font color="#000080"><b>then do
      </b></font>tCliente<font color="#808080">.</font>codprofissao<font color="#808080">=</font><font color="#808000"><b>strip</b></font><font color="#808080">(</font><font color="#808000"><b>substr</b></font><font color="#808080">(</font>sRegistro<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">))
      </font><font color="#000080"><b>call </b></font><font color="#0000FF"><b>charout </b></font><font color="#808080">,' '</font>rotulo<font color="#808080">(</font>opProfissao<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">)
      </font><font color="#000080"><b>say </b></font><font color="#808000"><b>substr</b></font><font color="#808080">(</font>sRegistro<font color="#808080">, </font>gnPosChave<font color="#808080">(</font>opProfissao<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">), </font>gnTamChave<font color="#808080">(</font>opProfissao<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">))
    </font><font color="#000080"><b>end
  end
end 
else if </b></font>sreg<font color="#808080">=</font>opVenda <font color="#000080"><b>then do
  </b></font>sRegistro<font color="#808080">=</font>pesqArq<font color="#808080">(</font>tfLivro<font color="#808080">, </font>tVenda<font color="#808080">.</font>isbn<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">13</font><font color="#808080">, </font>tamReg<font color="#808080">(</font>opLivro<font color="#808080">))
  </font><font color="#000080"><b>if </b></font>sRegistro<font color="#808080">&lt;&gt;'' </font><font color="#000080"><b>then do
    call </b></font><font color="#0000FF"><b>charout </b></font><font color="#808080">,' '</font>rotulo<font color="#808080">(</font>opLivro<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">) </font><font color="#008000"><i>/* Titulo */
    </i></font><font color="#000080"><b>say </b></font><font color="#808000"><b>substr</b></font><font color="#808080">(</font>sRegistro<font color="#808080">, </font>gnPosChave<font color="#808080">(</font>opLivro<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">), </font>gnTamChave<font color="#808080">(</font>opLivro<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">))
    </font><font color="#000080"><b>call </b></font><font color="#0000FF"><b>charout </b></font><font color="#808080">,' '</font>rotulo<font color="#808080">(</font>opLivro<font color="#808080">, </font><font color="#FF0000">9</font><font color="#808080">) </font><font color="#008000"><i>/* Preco */
    </i></font>sPreco<font color="#808080">=</font><font color="#808000"><b>substr</b></font><font color="#808080">(</font>sRegistro<font color="#808080">, </font>gnPosChave<font color="#808080">(</font>opLivro<font color="#808080">, </font><font color="#FF0000">9</font><font color="#808080">), </font>gnTamChave<font color="#808080">(</font>opLivro<font color="#808080">, </font><font color="#FF0000">9</font><font color="#808080">))
    </font>g_nPreco <font color="#808080">= </font>sPreco
    <font color="#000080"><b>say </b></font>sPreco
  <font color="#000080"><b>end
end
return
</b></font><font color="#008000"><i>/*------------------------------------------------------------------------------
Realiza os cadastros dos arquivos que se ligam a outros arquivos.
sreg - o tipo de arquivo
sacao - a a&ccedil;&atilde;o a ser realizada
sCodigo - um das chaves do arquivo de liga&ccedil;&atilde;o
------------------------------------------------------------------------------*/
</i></font>frmCadLigados<font color="#808080">: </font><font color="#000080"><b>procedure expose </b></font>g_SalvarInclusao g_nPreco
 tAssunto<font color="#808080">.</font>codigo tAssunto<font color="#808080">.</font>assunto tAutor<font color="#808080">.</font>codigo tAutor<font color="#808080">.</font>autor<font color="#808080">,
 </font>tLivro<font color="#808080">.</font>isbn tLivro<font color="#808080">.</font>titulo tLivro<font color="#808080">.</font>edicao tLivro<font color="#808080">.</font>anopubli tLivro<font color="#808080">.</font>codeditora<font color="#808080">,
 </font>tLivro<font color="#808080">.</font>volume tLivro<font color="#808080">.</font>codidioma tLivro<font color="#808080">.</font>npaginas tLivro<font color="#808080">.</font>preco tLivro<font color="#808080">.</font>qtdestoque<font color="#808080">,
 </font>tLivroAss<font color="#808080">.</font>isbn tlivroAss<font color="#808080">.</font>codassunto tLivroAut<font color="#808080">.</font>isbn tlivroAut<font color="#808080">.</font>codautor<font color="#808080">,
 </font>tVenda<font color="#808080">.</font>dthrvenda tVenda<font color="#808080">.</font>cpf tVenda<font color="#808080">.</font>isbn tVenda<font color="#808080">.</font>precovenda

  <font color="#000080"><b>parse arg </b></font>sreg<font color="#808080">, </font>sacao<font color="#808080">, </font>sCodigo

<font color="#000080"><b>call </b></font>constantes
nQtd <font color="#808080">= </font><font color="#FF0000">0</font><font color="#808080">; </font>nCont <font color="#808080">= </font><font color="#FF0000">0</font><font color="#808080">; </font>nQtdEstoque <font color="#808080">= </font><font color="#FF0000">0
</font>nTotalPreco <font color="#808080">= </font><font color="#FF0000">0.0
</font>slinha <font color="#808080">= ''; </font>sTotalPreco <font color="#808080">= ''; </font>sPreco <font color="#808080">= ''; </font>sQtd <font color="#808080">= ''

</font><font color="#000080"><b>if </b></font>sacao<font color="#808080">=</font>opNovo <font color="#000080"><b>then do
  </b></font>nCont<font color="#808080">=</font><font color="#FF0000">1
  </font><font color="#000080"><b>if </b></font>sreg<font color="#808080">=</font>opLivroAss <font color="#000080"><b>then do
    </b></font>sQtd<font color="#808080">=</font>validaNumero<font color="#808080">('</font>Quantos assuntos quer cadastrar<font color="#808080">?: ', </font>sQtd<font color="#808080">)
    </font>nQtd <font color="#808080">= </font>sQtd
    <font color="#000080"><b>call </b></font><font color="#808000"><b>stream </b></font>tfLivroAss<font color="#808080">, '</font>C<font color="#808080">', '</font><font color="#808000"><b>SEEK </b></font><font color="#808080">=</font><font color="#FF0000">0 </font>READ <font color="#0000FF"><b>LINE</b></font><font color="#808080">'
    </font><font color="#000080"><b>do </b></font>while nCont <font color="#808080">&lt;= </font>nQtd
      tLivroAss<font color="#808080">.</font>isbn<font color="#808080">=</font>sCodigo
      <font color="#000080"><b>call </b></font><font color="#0000FF"><b>charout </b></font><font color="#808080">,</font>rotulo<font color="#808080">(</font>opLivroAss<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">)
      </font>tLivroAss<font color="#808080">.</font>codassunto <font color="#808080">= </font><font color="#0000FF"><b>linein</b></font><font color="#808080">()
      </font>slinha<font color="#808080">=</font>pesqArq<font color="#808080">(</font>tfAssunto<font color="#808080">, </font>tLivroAss<font color="#808080">.</font>codassunto<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">,</font>tamReg<font color="#808080">(</font>opAssunto<font color="#808080">))
      </font><font color="#000080"><b>call </b></font><font color="#0000FF"><b>charout </b></font><font color="#808080">,' '</font>rotulo<font color="#808080">(</font>opAssunto<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">)
      </font><font color="#000080"><b>say </b></font><font color="#808000"><b>substr</b></font><font color="#808080">(</font>slinha<font color="#808080">, </font>gnPosChave<font color="#808080">(</font>opAssunto<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">), </font>gnTamChave<font color="#808080">(</font>opAssunto<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">))
      </font><font color="#000080"><b>call </b></font>pesqLinhaExcluida tfLivroAss<font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">)
      </font><font color="#000080"><b>call </b></font>submenu <font color="#FF0000">14</font><font color="#808080">, </font>sreg
      nCont<font color="#808080">=</font>nCont<font color="#808080">+</font><font color="#FF0000">1
    </font><font color="#000080"><b>end
  end 
  else if </b></font>sreg<font color="#808080">=</font>opLivroAut <font color="#000080"><b>then do
    </b></font>sQtd<font color="#808080">=</font>validaNumero<font color="#808080">('</font>Quantos autores quer cadastrar<font color="#808080">?: ',</font>sQtd<font color="#808080">)
    </font>nQtd <font color="#808080">= </font>sQtd
    <font color="#000080"><b>call </b></font><font color="#808000"><b>stream </b></font>tfLivroAut<font color="#808080">, '</font>C<font color="#808080">', '</font><font color="#808000"><b>SEEK </b></font><font color="#808080">=</font><font color="#FF0000">0 </font>READ <font color="#0000FF"><b>LINE</b></font><font color="#808080">'
    </font><font color="#000080"><b>do </b></font>while nCont <font color="#808080">&lt;= </font>nQtd
      tLivroAut<font color="#808080">.</font>isbn<font color="#808080">=</font>sCodigo
      <font color="#000080"><b>call </b></font><font color="#0000FF"><b>charout </b></font><font color="#808080">,</font>rotulo<font color="#808080">(</font>opLivroAut<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">)
      </font>tLivroAut<font color="#808080">.</font>codautor <font color="#808080">= </font><font color="#0000FF"><b>linein</b></font><font color="#808080">()
      </font>slinha<font color="#808080">=</font>pesqArq<font color="#808080">(</font>tfAutor<font color="#808080">, </font>tLivroAut<font color="#808080">.</font>codautor<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">,</font>tamReg<font color="#808080">(</font>opAutor<font color="#808080">))
      </font><font color="#000080"><b>call </b></font><font color="#0000FF"><b>charout </b></font><font color="#808080">,' '</font>rotulo<font color="#808080">(</font>opAutor<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">)
      </font><font color="#000080"><b>say </b></font><font color="#808000"><b>substr</b></font><font color="#808080">(</font>slinha<font color="#808080">, </font>gnPosChave<font color="#808080">(</font>opAutor<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">), </font>gnTamChave<font color="#808080">(</font>opAutor<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">))
      </font><font color="#000080"><b>call </b></font>pesqLinhaExcluida tfLivroAut<font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">)
      </font><font color="#000080"><b>call </b></font>submenu <font color="#FF0000">14</font><font color="#808080">, </font>sreg
      nCont<font color="#808080">=</font>nCont<font color="#808080">+</font><font color="#FF0000">1
    </font><font color="#000080"><b>end
  end 
  else if </b></font>sreg<font color="#808080">=</font>opVenda <font color="#000080"><b>then do
    </b></font>sQtd<font color="#808080">=</font>validaNumero<font color="#808080">('</font>Quantos livros quer vender<font color="#808080">?: ',</font>sQtd<font color="#808080">)
    </font>nQtd <font color="#808080">= </font>sQtd
    nTotalPreco<font color="#808080">=</font><font color="#FF0000">0
    </font><font color="#000080"><b>do </b></font>while nCont <font color="#808080">&lt;= </font>nQtd
      slinha<font color="#808080">=</font>validaEntrada<font color="#808080">(</font>tfLivro<font color="#808080">,</font>opLivro<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font>tVenda<font color="#808080">.</font>isbn<font color="#808080">,</font><font color="#FF0000">3</font><font color="#808080">,</font>false<font color="#808080">,</font>opTexto<font color="#808080">)
      </font><font color="#000080"><b>if </b></font>slinha<font color="#808080">&lt;&gt;'' </font><font color="#000080"><b>then do
        </b></font>tVenda<font color="#808080">.</font>isbn<font color="#808080">=</font><font color="#808000"><b>strip</b></font><font color="#808080">(</font><font color="#808000"><b>substr</b></font><font color="#808080">(</font>slinha<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#FF0000">13</font><font color="#808080">))
        </font><font color="#000080"><b>if </b></font>validaISBN<font color="#808080">(</font>tVenda<font color="#808080">.</font>isbn<font color="#808080">) </font><font color="#000080"><b>then do
          call </b></font>mostrarDados sreg<font color="#808080">, '', </font><font color="#FF0000">1
          </font>tLivro<font color="#808080">.</font>qtdestoque<font color="#808080">=</font><font color="#808000"><b>strip</b></font><font color="#808080">(</font><font color="#808000"><b>substr</b></font><font color="#808080">(</font>slinha<font color="#808080">,</font><font color="#FF0000">134</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">))
          </font>nQtdEstoque <font color="#808080">= </font>tLivro<font color="#808080">.</font>qtdestoque
          <font color="#000080"><b>if </b></font>nQtdEstoque <font color="#808080">&gt; </font><font color="#FF0000">0 </font><font color="#000080"><b>then do
             </b></font>nTotalPreco<font color="#808080">=</font>nTotalPreco <font color="#808080">+ </font>g_nPreco
             sPreco <font color="#808080">= </font>g_nPreco
             tVenda<font color="#808080">.</font>precovenda<font color="#808080">=</font>sPreco
             g_SalvarInclusao<font color="#808080">=</font>false
             <font color="#000080"><b>call </b></font>submenu <font color="#FF0000">14</font><font color="#808080">, </font>sreg
             <font color="#000080"><b>if </b></font>g_SalvarInclusao <font color="#000080"><b>then do
                </b></font>slinha<font color="#808080">=</font>pesqArq<font color="#808080">(</font>tfLivro<font color="#808080">, </font>tVenda<font color="#808080">.</font>isbn<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">13</font><font color="#808080">, </font>tamReg<font color="#808080">(</font>opLivro<font color="#808080">))
                </font><font color="#000080"><b>if </b></font>slinha<font color="#808080">&lt;&gt;'' </font><font color="#000080"><b>then do
                   </b></font>nQtdEstoque<font color="#808080">=</font>nQtdEstoque<font color="#808080">-</font><font color="#FF0000">1
                   </font>tLivro<font color="#808080">.</font>qtdestoque <font color="#808080">= </font>nQtdEstoque
                   slinha<font color="#808080">=</font><font color="#808000"><b>substr</b></font><font color="#808080">(</font>slinha<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#FF0000">133</font><font color="#808080">)+</font>esp<font color="#808080">(</font>tLivro<font color="#808080">.</font>qtdestoque<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">)
                   </font><font color="#000080"><b>call </b></font>escreveArq tfLivro<font color="#808080">, </font>slinha<font color="#808080">, '', ''
                </font><font color="#000080"><b>end
             end
             </b></font>nCont<font color="#808080">=</font>nCont<font color="#808080">+</font><font color="#FF0000">1
          </font><font color="#000080"><b>end 
          else say </b></font>MSG_SEMESTOQUE
        <font color="#000080"><b>end 
        else say </b></font>MSG_ISBNINV
      <font color="#000080"><b>end
    end
    </b></font>sTotalPreco <font color="#808080">= </font>nTotalPreco
    <font color="#000080"><b>say </b></font><font color="#808080">'</font>Total de <font color="#808080">' || </font>rotulo<font color="#808080">(</font>sreg<font color="#808080">,</font><font color="#FF0000">4</font><font color="#808080">) || </font>sTotalPreco
  <font color="#000080"><b>end
end 
else if </b></font>sacao<font color="#808080">=</font>opExcluir <font color="#000080"><b>then do
  if </b></font>sreg<font color="#808080">=</font>opLivroAss <font color="#000080"><b>then
     call </b></font>ExcluirRegLigados tfLivroAss<font color="#808080">, </font>sreg<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">13</font><font color="#808080">, </font>sCodigo
  <font color="#000080"><b>else if </b></font>sreg<font color="#808080">=</font>opLivroAut <font color="#000080"><b>then
     call </b></font>ExcluirRegLigados tfLivroAut<font color="#808080">, </font>sreg<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">13</font><font color="#808080">, </font>sCodigo
<font color="#000080"><b>end

return
</b></font><font color="#008000"><i>/*------------------------------------------------------------------------------
Realiza a exclus&atilde;o dos arquivos de liga&ccedil;&atilde;o.
sArq - o arquivo de liga&ccedil;&atilde;o
sreg - o tipo de arquivo de liga&ccedil;&atilde;o
nPosChave - a posicao inicial da chave dentro do registro
nTamChave - o tamanho da chave dentro do registro
sChave - a chave a ser excluida
------------------------------------------------------------------------------*/
</i></font>ExcluirRegLigados<font color="#808080">: </font><font color="#000080"><b>procedure
  parse arg </b></font>sArq<font color="#808080">, </font>sreg<font color="#808080">, </font>nPosChave<font color="#808080">, </font>nTamChave<font color="#808080">, </font>sChave

<font color="#000080"><b>call </b></font>constantes
slinha <font color="#808080">= ''; </font>sCodigo <font color="#808080">= ''

  </font><font color="#000080"><b>call </b></font><font color="#808000"><b>stream </b></font>sArq<font color="#808080">, '</font>C<font color="#808080">', '</font><font color="#808000"><b>SEEK </b></font><font color="#808080">=</font><font color="#FF0000">0 </font>READ <font color="#0000FF"><b>LINE</b></font><font color="#808080">'
  </font><font color="#000080"><b>do </b></font>while <font color="#808080">(</font>fimArq<font color="#808080">(</font>sArq<font color="#808080">)=</font>false<font color="#808080">)
    </font>slinha <font color="#808080">= </font><font color="#0000FF"><b>linein</b></font><font color="#808080">(</font>sArq<font color="#808080">)
    </font>sCodigo<font color="#808080">=</font><font color="#808000"><b>strip</b></font><font color="#808080">(</font><font color="#808000"><b>substr</b></font><font color="#808080">(</font>slinha<font color="#808080">,</font>nPosChave<font color="#808080">,</font>nTamChave<font color="#808080">))
    </font><font color="#000080"><b>if </b></font>sCodigo<font color="#808080">=</font>sChave <font color="#000080"><b>then
       call </b></font>btnAcao sreg<font color="#808080">,</font>opConfirmaExclusao
  <font color="#000080"><b>end
return
</b></font></font>
</code></pre>
</body>
</html>