<html>
<head>
<title>Livrus Virtus - Console - Eiffel</title>
</head>
<!-- Generated by ConTEXT HTML exporter -->
<body text="#000000" bgcolor="#FFFFFF">
<pre>
<code><font  face="Courier New"><font color="#808080">-- ----------------------------------------------------------------------------
-- Sistema integrante do projeto Livrus Virtus.
-- Todos os direitos reservados para Henrique F. de Souza.
-- Vers&atilde;o programada na linguagem Eiffel.
-- ----------------------------------------------------------------------------
</font><font color="#000080"><b>indexing
   </b></font>title<font color="#808080">: </font><font color="#800000">&quot;Programa Livrus&quot;</font><font color="#808080">;
   </font>author<font color="#808080">: </font><font color="#800000">&quot;Henrique F. de Souza&quot;</font><font color="#808080">;

</font><font color="#000080"><b>class </b></font>LIVRUS

<font color="#000080"><b>creation
  </b></font>make

<font color="#000080"><b>feature
  </b></font>optexto<font color="#808080">: </font><font color="#0000FF">INTEGER </font><font color="#000080"><b>is </b></font><font color="#FF0000">1</font><font color="#808080">; </font>opnumero<font color="#808080">: </font><font color="#0000FF">INTEGER </font><font color="#000080"><b>is </b></font><font color="#FF0000">2</font><font color="#808080">; </font>opdata<font color="#808080">: </font><font color="#0000FF">INTEGER </font><font color="#000080"><b>is </b></font><font color="#FF0000">3</font><font color="#808080">; 
  </font>opdatahora<font color="#808080">: </font><font color="#0000FF">INTEGER </font><font color="#000080"><b>is </b></font><font color="#FF0000">4</font><font color="#808080">; </font>opsenha<font color="#808080">: </font><font color="#0000FF">INTEGER </font><font color="#000080"><b>is </b></font><font color="#FF0000">5</font><font color="#808080">;
  </font>cttipo<font color="#808080">: </font><font color="#0000FF">SET</font><font color="#808080">[</font><font color="#0000FF">INTEGER</font><font color="#808080">];
 
  </font>opassunto<font color="#808080">: </font><font color="#0000FF">INTEGER </font><font color="#000080"><b>is </b></font><font color="#FF0000">1</font><font color="#808080">; </font>opautor<font color="#808080">: </font><font color="#0000FF">INTEGER </font><font color="#000080"><b>is </b></font><font color="#FF0000">2</font><font color="#808080">; </font>opeditora<font color="#808080">: </font><font color="#0000FF">INTEGER </font><font color="#000080"><b>is </b></font><font color="#FF0000">3</font><font color="#808080">;
  </font>opendereco<font color="#808080">: </font><font color="#0000FF">INTEGER </font><font color="#000080"><b>is </b></font><font color="#FF0000">4</font><font color="#808080">; </font>opidioma<font color="#808080">: </font><font color="#0000FF">INTEGER </font><font color="#000080"><b>is </b></font><font color="#FF0000">5</font><font color="#808080">; </font>oppais<font color="#808080">: </font><font color="#0000FF">INTEGER </font><font color="#000080"><b>is </b></font><font color="#FF0000">6</font><font color="#808080">; 
  </font>opprofissao<font color="#808080">: </font><font color="#0000FF">INTEGER </font><font color="#000080"><b>is </b></font><font color="#FF0000">7</font><font color="#808080">; </font>opcliente<font color="#808080">: </font><font color="#0000FF">INTEGER </font><font color="#000080"><b>is </b></font><font color="#FF0000">8</font><font color="#808080">; </font>oplivro<font color="#808080">: </font><font color="#0000FF">INTEGER </font><font color="#000080"><b>is </b></font><font color="#FF0000">9</font><font color="#808080">; 
  </font>oplivroass<font color="#808080">: </font><font color="#0000FF">INTEGER </font><font color="#000080"><b>is </b></font><font color="#FF0000">10</font><font color="#808080">; </font>oplivroaut<font color="#808080">: </font><font color="#0000FF">INTEGER </font><font color="#000080"><b>is </b></font><font color="#FF0000">11</font><font color="#808080">; 
  </font>opusuario<font color="#808080">: </font><font color="#0000FF">INTEGER </font><font color="#000080"><b>is </b></font><font color="#FF0000">12</font><font color="#808080">; </font>opvenda<font color="#808080">: </font><font color="#0000FF">INTEGER </font><font color="#000080"><b>is </b></font><font color="#FF0000">13</font><font color="#808080">;
  </font>ctarqs<font color="#808080">: </font><font color="#0000FF">SET</font><font color="#808080">[</font><font color="#0000FF">INTEGER</font><font color="#808080">];

  </font>opnovo<font color="#808080">: </font><font color="#0000FF">INTEGER </font><font color="#000080"><b>is </b></font><font color="#FF0000">1</font><font color="#808080">; </font>opalterar<font color="#808080">: </font><font color="#0000FF">INTEGER </font><font color="#000080"><b>is </b></font><font color="#FF0000">2</font><font color="#808080">; </font>oppesquisar<font color="#808080">: </font><font color="#0000FF">INTEGER </font><font color="#000080"><b>is </b></font><font color="#FF0000">3</font><font color="#808080">; 
  </font>opsalvarinclusao<font color="#808080">: </font><font color="#0000FF">INTEGER </font><font color="#000080"><b>is </b></font><font color="#FF0000">4</font><font color="#808080">; </font>opsalvaralteracao<font color="#808080">: </font><font color="#0000FF">INTEGER </font><font color="#000080"><b>is </b></font><font color="#FF0000">5</font><font color="#808080">; 
  </font>opexcluir<font color="#808080">: </font><font color="#0000FF">INTEGER </font><font color="#000080"><b>is </b></font><font color="#FF0000">6</font><font color="#808080">; </font>opconfirmaexclusao<font color="#808080">: </font><font color="#0000FF">INTEGER </font><font color="#000080"><b>is </b></font><font color="#FF0000">7</font><font color="#808080">; 
  </font>oplistartodos<font color="#808080">: </font><font color="#0000FF">INTEGER </font><font color="#000080"><b>is </b></font><font color="#FF0000">8</font><font color="#808080">;
  </font>ctacao<font color="#808080">: </font><font color="#0000FF">SET</font><font color="#808080">[</font><font color="#0000FF">INTEGER</font><font color="#808080">];

-- constantes
  </font>crlf<font color="#808080">: </font><font color="#0000FF">STRING </font><font color="#000080"><b>is </b></font><font color="#800000">&quot;%N&quot;</font><font color="#808080">; -- windows
  </font>tam_crlf<font color="#808080">: </font><font color="#0000FF">INTEGER </font><font color="#000080"><b>is </b></font><font color="#FF0000">2</font><font color="#808080">;
-- crlf = &quot;%N&quot;;
-- tam_crlf = 1; -- unix 
-- crlf = &quot;%R&quot;;
-- tam_crlf = 1; -- macintosh 

  </font>qtd_max_linha<font color="#808080">: </font><font color="#0000FF">INTEGER </font><font color="#000080"><b>is </b></font><font color="#FF0000">18</font><font color="#808080">;

  </font>msg_arqerro<font color="#808080">: </font><font color="#0000FF">STRING </font><font color="#000080"><b>is </b></font><font color="#800000">&quot;Erro: O arquivo n&atilde;o pode ser aberto.%N&quot;</font><font color="#808080">;
  </font>msg_arqcerro<font color="#808080">: </font><font color="#0000FF">STRING </font><font color="#000080"><b>is </b></font><font color="#800000">&quot;Erro: O arquivo n&atilde;o pode ser criado.%N&quot;</font><font color="#808080">;
  </font>msg_erro<font color="#808080">: </font><font color="#0000FF">STRING </font><font color="#000080"><b>is </b></font><font color="#800000">&quot;Erro: op&ccedil;&atilde;o inv&aacute;lida digite de novo.%N&quot;</font><font color="#808080">;
  </font>msg_opcao<font color="#808080">: </font><font color="#0000FF">STRING </font><font color="#000080"><b>is </b></font><font color="#800000">&quot;Escolha uma op&ccedil;&atilde;o: &quot;</font><font color="#808080">;
  </font>msg_press<font color="#808080">: </font><font color="#0000FF">STRING </font><font color="#000080"><b>is </b></font><font color="#800000">&quot;pressione para continuar...&quot;</font><font color="#808080">;

  </font>msg_reginc<font color="#808080">: </font><font color="#0000FF">STRING </font><font color="#000080"><b>is </b></font><font color="#800000">&quot;registro incluido!%N&quot;</font><font color="#808080">;
  </font>msg_regninc<font color="#808080">: </font><font color="#0000FF">STRING </font><font color="#000080"><b>is </b></font><font color="#800000">&quot;registro n&atilde;o incluido!%N&quot;</font><font color="#808080">;
  </font>msg_regalt<font color="#808080">: </font><font color="#0000FF">STRING </font><font color="#000080"><b>is </b></font><font color="#800000">&quot;registro alterado!%N&quot;</font><font color="#808080">;
  </font>msg_regnalt<font color="#808080">: </font><font color="#0000FF">STRING </font><font color="#000080"><b>is </b></font><font color="#800000">&quot;registro n&atilde;o alterado!%N&quot;</font><font color="#808080">;
  </font>msg_regexc<font color="#808080">: </font><font color="#0000FF">STRING </font><font color="#000080"><b>is </b></font><font color="#800000">&quot;registro excluido!%N&quot;</font><font color="#808080">;
  </font>msg_regnexc<font color="#808080">: </font><font color="#0000FF">STRING </font><font color="#000080"><b>is </b></font><font color="#800000">&quot;registro n&atilde;o excluido!%N&quot;</font><font color="#808080">;
  </font>msg_regexst<font color="#808080">: </font><font color="#0000FF">STRING </font><font color="#000080"><b>is </b></font><font color="#800000">&quot;registro j&aacute; existe!%N&quot;</font><font color="#808080">;

  </font>msg_numinv<font color="#808080">: </font><font color="#0000FF">STRING </font><font color="#000080"><b>is </b></font><font color="#800000">&quot;N&uacute;mero inv&aacute;lido ou menor do que 1!%N&quot;</font><font color="#808080">;
  </font>msg_datainv<font color="#808080">: </font><font color="#0000FF">STRING </font><font color="#000080"><b>is </b></font><font color="#800000">&quot;Data inv&aacute;lida!, formato correto (dd/mm/yyyy)%N&quot;</font><font color="#808080">;
  </font>msg_dthrinv<font color="#808080">: </font><font color="#0000FF">STRING </font><font color="#000080"><b>is </b></font><font color="#800000">&quot;Data/hora inv&aacute;lida!, formato correto (dd/mm/yyyy hh:mm:ss)%N&quot;</font><font color="#808080">;
  </font>msg_isbninv<font color="#808080">: </font><font color="#0000FF">STRING </font><font color="#000080"><b>is </b></font><font color="#800000">&quot;ISBN inv&aacute;lido!%N&quot;</font><font color="#808080">;
  </font>msg_cpfinv<font color="#808080">: </font><font color="#0000FF">STRING </font><font color="#000080"><b>is </b></font><font color="#800000">&quot;CPF inv&aacute;lido!%N&quot;</font><font color="#808080">;
  </font>msg_senconfere<font color="#808080">: </font><font color="#0000FF">STRING </font><font color="#000080"><b>is </b></font><font color="#800000">&quot;senha n&atilde;o confere com a senha atual!%N&quot;</font><font color="#808080">;
  </font>msg_senconfirm<font color="#808080">: </font><font color="#0000FF">STRING </font><font color="#000080"><b>is </b></font><font color="#800000">&quot;nova senha n&atilde;o confere com a senha confirmada!%N&quot;</font><font color="#808080">;
  </font>msg_loginencon<font color="#808080">: </font><font color="#0000FF">STRING </font><font color="#000080"><b>is </b></font><font color="#800000">&quot;login n&atilde;o encontrado!%N&quot;</font><font color="#808080">;
  </font>msg_semestoque<font color="#808080">: </font><font color="#0000FF">STRING </font><font color="#000080"><b>is </b></font><font color="#800000">&quot;livro n&atilde;o existe no estoque!%N&quot;</font><font color="#808080">;

  </font>arq_assunto<font color="#808080">: </font><font color="#0000FF">STRING </font><font color="#000080"><b>is </b></font><font color="#800000">&quot;c:\temp\assunto.dat&quot;</font><font color="#808080">;
  </font>arq_autor<font color="#808080">: </font><font color="#0000FF">STRING </font><font color="#000080"><b>is </b></font><font color="#800000">&quot;c:\temp\autor.dat&quot;</font><font color="#808080">;
  </font>arq_editora<font color="#808080">: </font><font color="#0000FF">STRING </font><font color="#000080"><b>is </b></font><font color="#800000">&quot;c:\temp\editora.dat&quot;</font><font color="#808080">;
  </font>arq_idioma<font color="#808080">: </font><font color="#0000FF">STRING </font><font color="#000080"><b>is </b></font><font color="#800000">&quot;c:\temp\idioma.dat&quot;</font><font color="#808080">;
  </font>arq_usuario<font color="#808080">: </font><font color="#0000FF">STRING </font><font color="#000080"><b>is </b></font><font color="#800000">&quot;c:\temp\usuario.dat&quot;</font><font color="#808080">;
  </font>arq_pais<font color="#808080">: </font><font color="#0000FF">STRING </font><font color="#000080"><b>is </b></font><font color="#800000">&quot;c:\temp\pais.dat&quot;</font><font color="#808080">;
  </font>arq_profissao<font color="#808080">: </font><font color="#0000FF">STRING </font><font color="#000080"><b>is </b></font><font color="#800000">&quot;c:\temp\profissao.dat&quot;</font><font color="#808080">;
  </font>arq_livro<font color="#808080">: </font><font color="#0000FF">STRING </font><font color="#000080"><b>is </b></font><font color="#800000">&quot;c:\temp\livro.dat&quot;</font><font color="#808080">;
  </font>arq_livass<font color="#808080">: </font><font color="#0000FF">STRING </font><font color="#000080"><b>is </b></font><font color="#800000">&quot;c:\temp\livroass.dat&quot;</font><font color="#808080">;
  </font>arq_livaut<font color="#808080">: </font><font color="#0000FF">STRING </font><font color="#000080"><b>is </b></font><font color="#800000">&quot;c:\temp\livroaut.dat&quot;</font><font color="#808080">;
  </font>arq_cliente<font color="#808080">: </font><font color="#0000FF">STRING </font><font color="#000080"><b>is </b></font><font color="#800000">&quot;c:\temp\cliente.dat&quot;</font><font color="#808080">;
  </font>arq_endereco<font color="#808080">: </font><font color="#0000FF">STRING </font><font color="#000080"><b>is </b></font><font color="#800000">&quot;c:\temp\endereco.dat&quot;</font><font color="#808080">;
  </font>arq_venda<font color="#808080">: </font><font color="#0000FF">STRING </font><font color="#000080"><b>is </b></font><font color="#800000">&quot;c:\temp\venda.dat&quot;</font><font color="#808080">;

  </font>tam_assunto<font color="#808080">: </font><font color="#0000FF">INTEGER </font><font color="#000080"><b>is </b></font><font color="#FF0000">40</font><font color="#808080">;
  </font>tam_autor<font color="#808080">: </font><font color="#0000FF">INTEGER </font><font color="#000080"><b>is </b></font><font color="#FF0000">40</font><font color="#808080">;
  </font>tam_editora<font color="#808080">: </font><font color="#0000FF">INTEGER </font><font color="#000080"><b>is </b></font><font color="#FF0000">60</font><font color="#808080">;
  </font>tam_idioma<font color="#808080">: </font><font color="#0000FF">INTEGER </font><font color="#000080"><b>is </b></font><font color="#FF0000">30</font><font color="#808080">;
  </font>tam_usuario<font color="#808080">: </font><font color="#0000FF">INTEGER </font><font color="#000080"><b>is </b></font><font color="#FF0000">20</font><font color="#808080">;
  </font>tam_pais<font color="#808080">: </font><font color="#0000FF">INTEGER </font><font color="#000080"><b>is </b></font><font color="#FF0000">53</font><font color="#808080">;
  </font>tam_profissao<font color="#808080">: </font><font color="#0000FF">INTEGER </font><font color="#000080"><b>is </b></font><font color="#FF0000">60</font><font color="#808080">;
  </font>tam_livro<font color="#808080">: </font><font color="#0000FF">INTEGER </font><font color="#000080"><b>is </b></font><font color="#FF0000">143</font><font color="#808080">;
  </font>tam_livass<font color="#808080">: </font><font color="#0000FF">INTEGER </font><font color="#000080"><b>is </b></font><font color="#FF0000">23</font><font color="#808080">;
  </font>tam_livaut<font color="#808080">: </font><font color="#0000FF">INTEGER </font><font color="#000080"><b>is </b></font><font color="#FF0000">23</font><font color="#808080">;
  </font>tam_cliente<font color="#808080">: </font><font color="#0000FF">INTEGER </font><font color="#000080"><b>is </b></font><font color="#FF0000">135</font><font color="#808080">;
  </font>tam_endereco<font color="#808080">: </font><font color="#0000FF">INTEGER </font><font color="#000080"><b>is </b></font><font color="#FF0000">123</font><font color="#808080">;
  </font>tam_venda<font color="#808080">: </font><font color="#0000FF">INTEGER </font><font color="#000080"><b>is </b></font><font color="#FF0000">56</font><font color="#808080">;

-- variaveis gerais

  </font>bopcao<font color="#808080">: </font><font color="#0000FF">BOOLEAN</font><font color="#808080">;
  </font>opmenu<font color="#808080">: </font><font color="#0000FF">STRING</font><font color="#808080">;
  </font>g_nposchave<font color="#808080">, </font>g_ntamchave<font color="#808080">, </font>g_nposreg<font color="#808080">: </font><font color="#0000FF">INTEGER</font><font color="#808080">;  
  </font>g_npreco<font color="#808080">: </font><font color="#0000FF">DOUBLE</font><font color="#808080">;
  </font>g_salvarinclusao<font color="#808080">, </font>g_regexcluido<font color="#808080">: </font><font color="#0000FF">BOOLEAN</font><font color="#808080">;
  
  </font>tassunto<font color="#808080">: </font>REGASSUNTO<font color="#808080">;
  </font>tautor<font color="#808080">: </font>REGAUTOR<font color="#808080">;
  </font>teditora<font color="#808080">: </font>REGEDITORA<font color="#808080">;
  </font>tidioma<font color="#808080">: </font>REGIDIOMA<font color="#808080">;
  </font>tendereco<font color="#808080">: </font>REGENDERECO<font color="#808080">;
  </font>tpais<font color="#808080">: </font>REGPAIS<font color="#808080">;
  </font>tprofissao<font color="#808080">: </font>REGPROFISSAO<font color="#808080">;
  </font>tlivro<font color="#808080">: </font>REGLIVRO<font color="#808080">;
  </font>tlivroass<font color="#808080">: </font>REGLIVROASS<font color="#808080">;
  </font>tlivroaut<font color="#808080">: </font>REGLIVROAUT<font color="#808080">;
  </font>tcliente<font color="#808080">: </font>REGCLIENTE<font color="#808080">;
  </font>tusuario<font color="#808080">: </font>REGUSUARIO<font color="#808080">;
  </font>tvenda<font color="#808080">: </font>REGVENDA<font color="#808080">;
  
  </font>tfassunto<font color="#808080">, </font>tfautor<font color="#808080">, </font>tfeditora<font color="#808080">, </font>tfidioma<font color="#808080">, </font>tfendereco<font color="#808080">, 
  </font>tfpais<font color="#808080">, </font>tfprofissao<font color="#808080">, </font>tflivro<font color="#808080">, </font>tflivroass<font color="#808080">, </font>tflivroaut<font color="#808080">, 
  </font>tfcliente<font color="#808080">, </font>tfusuario<font color="#808080">, </font>tfvenda<font color="#808080">: </font><font color="#0000FF">TEXT_FILE_READ_WRITE</font><font color="#808080">;

</font><font color="#000080"><b>feature 

</b></font><font color="#808080">-- ----------------------------------------------------------------------------
-- Parte inicial do c&oacute;digo
-- ----------------------------------------------------------------------------
</font>make <font color="#000080"><b>is
local
do       
  </b></font>inicializa<font color="#808080">;
  </font><font color="#000080"><b>if </b></font>argument_count <font color="#808080">&gt; </font><font color="#FF0000">1 </font><font color="#000080"><b>then
    if </b></font>argument<font color="#808080">(</font><font color="#FF0000">1</font><font color="#808080">)</font>.is_equal<font color="#808080">(</font><font color="#800000">&quot;-cria&quot;</font><font color="#808080">) </font><font color="#000080"><b>then
      </b></font>abrecriaarqs<font color="#808080">(</font><font color="#008080">false</font><font color="#808080">);
    </font><font color="#000080"><b>end</b></font><font color="#808080">;
  </font><font color="#000080"><b>else
    </b></font>frmsplash<font color="#808080">;
    </font>abrecriaarqs<font color="#808080">(</font><font color="#008080">true</font><font color="#808080">);
    </font><font color="#000080"><b>if </b></font>frmlogin <font color="#000080"><b>then
      from
        </b></font>bopcao<font color="#808080">:=</font><font color="#008080">true</font><font color="#808080">;
      </font><font color="#000080"><b>until 
        </b></font>bopcao<font color="#808080">=</font><font color="#008080">false
      </font><font color="#000080"><b>loop
        </b></font>menu<font color="#808080">(</font><font color="#FF0000">1</font><font color="#808080">);
        </font>opmenu<font color="#808080">:=</font>digita<font color="#808080">;
        </font><font color="#000080"><b>if </b></font><font color="#808080">(</font>opmenu.item<font color="#808080">(</font><font color="#FF0000">1</font><font color="#808080">)='</font>C<font color="#808080">') </font><font color="#000080"><b>or </b></font><font color="#808080">(</font>opmenu.item<font color="#808080">(</font><font color="#FF0000">1</font><font color="#808080">)='</font>c<font color="#808080">') </font><font color="#000080"><b>then </b></font>usamenu<font color="#808080">(</font><font color="#FF0000">1</font><font color="#808080">)
        </font><font color="#000080"><b>elseif </b></font><font color="#808080">(</font>opmenu.item<font color="#808080">(</font><font color="#FF0000">1</font><font color="#808080">)='</font>P<font color="#808080">') </font><font color="#000080"><b>or </b></font><font color="#808080">(</font>opmenu.item<font color="#808080">(</font><font color="#FF0000">1</font><font color="#808080">)='</font>p<font color="#808080">') </font><font color="#000080"><b>then </b></font>usamenu<font color="#808080">(</font><font color="#FF0000">2</font><font color="#808080">)
        </font><font color="#000080"><b>elseif </b></font><font color="#808080">(</font>opmenu.item<font color="#808080">(</font><font color="#FF0000">1</font><font color="#808080">)='</font>V<font color="#808080">') </font><font color="#000080"><b>or </b></font><font color="#808080">(</font>opmenu.item<font color="#808080">(</font><font color="#FF0000">1</font><font color="#808080">)='</font>v<font color="#808080">') </font><font color="#000080"><b>then </b></font>usamenu<font color="#808080">(</font><font color="#FF0000">3</font><font color="#808080">)
        </font><font color="#000080"><b>elseif </b></font><font color="#808080">(</font>opmenu.item<font color="#808080">(</font><font color="#FF0000">1</font><font color="#808080">)='</font>O<font color="#808080">') </font><font color="#000080"><b>or </b></font><font color="#808080">(</font>opmenu.item<font color="#808080">(</font><font color="#FF0000">1</font><font color="#808080">)='</font>o<font color="#808080">') </font><font color="#000080"><b>then </b></font>usamenu<font color="#808080">(</font><font color="#FF0000">4</font><font color="#808080">)
        </font><font color="#000080"><b>else </b></font>io.put_string<font color="#808080">(</font>msg_erro<font color="#808080">);
        </font><font color="#000080"><b>end</b></font><font color="#808080">;
      </font><font color="#000080"><b>end</b></font><font color="#808080">;
    </font><font color="#000080"><b>else
      </b></font>fechaarqs<font color="#808080">;
      </font>die_with_code<font color="#808080">(</font>exit_success_code<font color="#808080">);      
    </font><font color="#000080"><b>end</b></font><font color="#808080">;
  </font><font color="#000080"><b>end</b></font><font color="#808080">;
</font><font color="#000080"><b>end</b></font><font color="#808080">;

</font><font color="#000080"><b>feature </b></font><font color="#808080">-- Rotinas b&aacute;sicas

-- ----------------------------------------------------------------------------
-- cria todos os objetos
-- ----------------------------------------------------------------------------
</font>inicializa <font color="#000080"><b>is
do
  </b></font>create tassunto.make<font color="#808080">;
  </font>create tautor.make<font color="#808080">;
  </font>create teditora.make<font color="#808080">; 
  </font>create tidioma.make<font color="#808080">;
  </font>create tendereco.make<font color="#808080">; 
  </font>create tpais.make<font color="#808080">; 
  </font>create tprofissao.make<font color="#808080">;
  </font>create tlivro.make<font color="#808080">;
  </font>create tlivroass.make<font color="#808080">; 
  </font>create tlivroaut.make<font color="#808080">; 
  </font>create tcliente.make<font color="#808080">; 
  </font>create tusuario.make<font color="#808080">; 
  </font>create tvenda.make<font color="#808080">;

  </font>create tfassunto.make<font color="#808080">;
  </font>create tfautor.make<font color="#808080">;
  </font>create tfeditora.make<font color="#808080">; 
  </font>create tfidioma.make<font color="#808080">;
  </font>create tfendereco.make<font color="#808080">; 
  </font>create tfpais.make<font color="#808080">; 
  </font>create tfprofissao.make<font color="#808080">;
  </font>create tflivro.make<font color="#808080">;
  </font>create tflivroass.make<font color="#808080">; 
  </font>create tflivroaut.make<font color="#808080">; 
  </font>create tfcliente.make<font color="#808080">; 
  </font>create tfusuario.make<font color="#808080">; 
  </font>create tfvenda.make<font color="#808080">;

  </font>create <font color="#808080">{</font>HASHED_SET<font color="#808080">[</font><font color="#0000FF">INTEGER</font><font color="#808080">]} </font>cttipo.make<font color="#808080">;
  </font>cttipo.add<font color="#808080">(</font>optexto<font color="#808080">);
  </font>cttipo.add<font color="#808080">(</font>opnumero<font color="#808080">);
  </font>cttipo.add<font color="#808080">(</font>opdata<font color="#808080">);
  </font>cttipo.add<font color="#808080">(</font>opdatahora<font color="#808080">);
  </font>cttipo.add<font color="#808080">(</font>opsenha<font color="#808080">);

  </font>create <font color="#808080">{</font>HASHED_SET<font color="#808080">[</font><font color="#0000FF">INTEGER</font><font color="#808080">]} </font>ctarqs.make<font color="#808080">;
  </font>ctarqs.add<font color="#808080">(</font>opassunto<font color="#808080">);
  </font>ctarqs.add<font color="#808080">(</font>opautor<font color="#808080">);
  </font>ctarqs.add<font color="#808080">(</font>opeditora<font color="#808080">);
  </font>ctarqs.add<font color="#808080">(</font>opendereco<font color="#808080">);
  </font>ctarqs.add<font color="#808080">(</font>opidioma<font color="#808080">);
  </font>ctarqs.add<font color="#808080">(</font>oppais<font color="#808080">);
  </font>ctarqs.add<font color="#808080">(</font>opprofissao<font color="#808080">);
  </font>ctarqs.add<font color="#808080">(</font>opcliente<font color="#808080">);
  </font>ctarqs.add<font color="#808080">(</font>oplivro<font color="#808080">);
  </font>ctarqs.add<font color="#808080">(</font>oplivroass<font color="#808080">);
  </font>ctarqs.add<font color="#808080">(</font>oplivroaut<font color="#808080">);
  </font>ctarqs.add<font color="#808080">(</font>opusuario<font color="#808080">);
  </font>ctarqs.add<font color="#808080">(</font>opvenda<font color="#808080">);

  </font>create <font color="#808080">{</font>HASHED_SET<font color="#808080">[</font><font color="#0000FF">INTEGER</font><font color="#808080">]} </font>ctacao.make<font color="#808080">;
  </font>ctacao.add<font color="#808080">(</font>opnovo<font color="#808080">);
  </font>ctacao.add<font color="#808080">(</font>opalterar<font color="#808080">);
  </font>ctacao.add<font color="#808080">(</font>oppesquisar<font color="#808080">);
  </font>ctacao.add<font color="#808080">(</font>opsalvarinclusao<font color="#808080">);
  </font>ctacao.add<font color="#808080">(</font>opsalvaralteracao<font color="#808080">);
  </font>ctacao.add<font color="#808080">(</font>opexcluir<font color="#808080">);
  </font>ctacao.add<font color="#808080">(</font>opconfirmaexclusao<font color="#808080">);
  </font>ctacao.add<font color="#808080">(</font>oplistartodos<font color="#808080">);

</font><font color="#000080"><b>end</b></font><font color="#808080">;
-- ----------------------------------------------------------------------------
-- Fun&ccedil;&atilde;o que retorna um peda&ccedil;o de uma string.
-- sstr - indica a string
-- nini - indica a posicao inicial do pedaco
-- ntam - indica o tamanho do pedaco
-- retorna - o peda&ccedil;o da string
--- ---------------------------------------------------------------------------
</font>substr<font color="#808080">(</font>sstr<font color="#808080">: </font><font color="#0000FF">STRING</font><font color="#808080">; </font>nini<font color="#808080">, </font>ntam<font color="#808080">: </font><font color="#0000FF">INTEGER</font><font color="#808080">): </font><font color="#0000FF">STRING </font><font color="#000080"><b>is
do
 </b></font><font color="#800080">result</font><font color="#808080">:=</font>sstr.substring<font color="#808080">(</font>nini<font color="#808080">,</font>nini<font color="#808080">+</font>ntam<font color="#808080">-</font><font color="#FF0000">1</font><font color="#808080">);
</font><font color="#000080"><b>end</b></font><font color="#808080">;
-- ----------------------------------------------------------------------------
-- Retira os espa&ccedil;os em branco antes ou depois do texto.
-- sTexto - o texto a ser retirado os espa&ccedil;os em branco
-- retorna - o texto sem os espa&ccedil;os em branco
-- ----------------------------------------------------------------------------
</font>trim<font color="#808080">(</font>stexto<font color="#808080">: </font><font color="#0000FF">STRING</font><font color="#808080">): </font><font color="#0000FF">STRING </font><font color="#000080"><b>is
do
  </b></font>stexto.left_adjust<font color="#808080">;
  </font>stexto.right_adjust<font color="#808080">;
  </font><font color="#800080">result</font><font color="#808080">:=</font>stexto<font color="#808080">;
</font><font color="#000080"><b>end</b></font><font color="#808080">;
-- ----------------------------------------------------------------------------
-- Repete um texto um n&uacute;mero determinado de vezes.
-- sTexto - o texto a ser repetido
-- nQtd - a quantidade de vezes
-- retorna - o texto repetido
-- ----------------------------------------------------------------------------
</font>repete<font color="#808080">(</font>stexto<font color="#808080">: </font><font color="#0000FF">CHARACTER</font><font color="#808080">; </font>nqtd<font color="#808080">: </font><font color="#0000FF">INTEGER</font><font color="#808080">): </font><font color="#0000FF">STRING </font><font color="#000080"><b>is
local
 </b></font>stemp<font color="#808080">: </font><font color="#0000FF">STRING</font><font color="#808080">;
</font><font color="#000080"><b>do
  </b></font>stemp<font color="#808080">:=</font><font color="#800000">&quot;&quot;</font><font color="#808080">;
  </font>stemp.extend_multiple<font color="#808080">(</font>stexto<font color="#808080">,</font>nqtd<font color="#808080">);
  </font><font color="#800080">result</font><font color="#808080">:=</font>stemp<font color="#808080">;
</font><font color="#000080"><b>end</b></font><font color="#808080">;
-- ----------------------------------------------------------------------------
-- Coloca espa&ccedil;os em branco a mais de acordo com o tamanho m&aacute;ximo do texto.
-- sTexto - o texto
-- nTam - tamanho m&aacute;ximo do texto
-- retorna - o texto com espa&ccedil;os em branco a mais
------------------------------------------------------------------------------
</font>esp<font color="#808080">(</font>stexto<font color="#808080">: </font><font color="#0000FF">STRING</font><font color="#808080">; </font>ntam<font color="#808080">: </font><font color="#0000FF">INTEGER</font><font color="#808080">): </font><font color="#0000FF">STRING </font><font color="#000080"><b>is
do
  </b></font><font color="#800080">result</font><font color="#808080">:=</font>stexto<font color="#808080">+</font>repete<font color="#808080">(' ',</font>ntam<font color="#808080">-</font>stexto.count<font color="#808080">);
</font><font color="#000080"><b>end</b></font><font color="#808080">;
-- ----------------------------------------------------------------------------
-- Escreve zeros na frente de um texto.
-- stexto - o texto para receber zeros a frente
-- ntam - o tamanho da string
-- retorna - o texto com o zeros antes
-- ----------------------------------------------------------------------------
</font>zeros<font color="#808080">(</font>stexto<font color="#808080">:</font><font color="#0000FF">STRING</font><font color="#808080">; </font>ntam<font color="#808080">:</font><font color="#0000FF">INTEGER</font><font color="#808080">): </font><font color="#0000FF">STRING </font><font color="#000080"><b>is
local 
  </b></font>ncont<font color="#808080">: </font><font color="#0000FF">INTEGER</font><font color="#808080">;
  </font>saux<font color="#808080">: </font><font color="#0000FF">STRING</font><font color="#808080">;
</font><font color="#000080"><b>do
  </b></font>saux<font color="#808080">:=</font><font color="#800000">&quot;&quot;</font><font color="#808080">;
  </font><font color="#000080"><b>if </b></font>ntam<font color="#808080">/=</font>stexto.count <font color="#000080"><b>then
    from
      </b></font>ncont<font color="#808080">:=</font><font color="#FF0000">1 
    </font><font color="#000080"><b>until
      </b></font>ncont <font color="#808080">&gt; </font>ntam<font color="#808080">-</font>stexto.count
    <font color="#000080"><b>loop
      </b></font>saux<font color="#808080">:=</font>saux <font color="#808080">+ </font><font color="#800000">&quot;0&quot;</font><font color="#808080">;
      </font>ncont<font color="#808080">:=</font>ncont <font color="#808080">+ </font><font color="#FF0000">1</font><font color="#808080">;
    </font><font color="#000080"><b>end</b></font><font color="#808080">;
  </font><font color="#000080"><b>end</b></font><font color="#808080">;
  </font><font color="#800080">result</font><font color="#808080">:=</font>saux<font color="#808080">+</font>stexto<font color="#808080">;
</font><font color="#000080"><b>end</b></font><font color="#808080">;
-- ----------------------------------------------------------------------------
-- Faz uma pesquisa relativa de um texto atrav&eacute;s de um valor chave.
-- sTexto - o texto
-- sChave - a chave a ser pesquisada
-- retorna - se achou ou n&atilde;o a chave dentro do texto
-- ----------------------------------------------------------------------------
</font>strrelativa<font color="#808080">(</font>stexto<font color="#808080">, </font>schave<font color="#808080">: </font><font color="#0000FF">STRING</font><font color="#808080">): </font><font color="#0000FF">BOOLEAN </font><font color="#000080"><b>is
do
 </b></font><font color="#800080">result</font><font color="#808080">:=</font>stexto.has_substring<font color="#808080">(</font>schave<font color="#808080">);
</font><font color="#000080"><b>end</b></font><font color="#808080">;
-- ----------------------------------------------------------------------------
-- Calcula o modulo11 de um valor qualquer.
-- svalor - a mstring com o n&uacute;mero a ser calculado
-- ndig - d&iacute;gito do valor a ser calculado
-- retorna - o d&iacute;gito correto
-- ----------------------------------------------------------------------------}
</font>modulo11<font color="#808080">(</font>svalor<font color="#808080">: </font><font color="#0000FF">STRING</font><font color="#808080">; </font>ndig<font color="#808080">: </font><font color="#0000FF">INTEGER</font><font color="#808080">): </font><font color="#0000FF">INTEGER </font><font color="#000080"><b>is
local 
  </b></font>ncont<font color="#808080">, </font>nsoma<font color="#808080">, </font>nvalor<font color="#808080">, </font>npos<font color="#808080">: </font><font color="#0000FF">INTEGER</font><font color="#808080">;
  </font>sres<font color="#808080">, </font>slocal<font color="#808080">: </font><font color="#0000FF">STRING</font><font color="#808080">;
</font><font color="#000080"><b>do
  </b></font>ncont<font color="#808080">:=</font><font color="#FF0000">1</font><font color="#808080">;
  </font>slocal<font color="#808080">:=</font><font color="#800000">&quot;&quot;</font><font color="#808080">;
  </font><font color="#000080"><b>from 
    </b></font>ncont <font color="#808080">:= </font><font color="#FF0000">1</font><font color="#808080">;
  </font><font color="#000080"><b>until
    </b></font>ncont <font color="#808080">&gt; </font><font color="#FF0000">11
  </font><font color="#000080"><b>loop
    </b></font>slocal<font color="#808080">:=</font>substr<font color="#808080">(</font>svalor<font color="#808080">,</font>ncont<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">) + </font>slocal<font color="#808080">;
    </font>ncont<font color="#808080">:=</font>ncont<font color="#808080">+</font><font color="#FF0000">1</font><font color="#808080">;
  </font><font color="#000080"><b>end</b></font><font color="#808080">;
  </font>nsoma<font color="#808080">:=</font><font color="#FF0000">0</font><font color="#808080">;
  </font>npos<font color="#808080">:=</font><font color="#FF0000">2</font><font color="#808080">;
  </font><font color="#000080"><b>from 
    if </b></font>ndig<font color="#808080">=</font><font color="#FF0000">1 </font><font color="#000080"><b>then
      </b></font>ncont<font color="#808080">:=</font><font color="#FF0000">3</font><font color="#808080">;
    </font><font color="#000080"><b>else
      </b></font>ncont<font color="#808080">:=</font><font color="#FF0000">2</font><font color="#808080">;
    </font><font color="#000080"><b>end</b></font><font color="#808080">; 
  </font><font color="#000080"><b>until
    </b></font>ncont <font color="#808080">&gt; </font><font color="#FF0000">11
  </font><font color="#000080"><b>loop
    </b></font>sres<font color="#808080">:=</font>substr<font color="#808080">(</font>slocal<font color="#808080">,</font>ncont<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">);
    </font>nvalor<font color="#808080">:=</font>sres.to_integer<font color="#808080">;
    </font>nsoma<font color="#808080">:=</font>nsoma <font color="#808080">+ (</font>nvalor <font color="#808080">* </font>npos<font color="#808080">);
    </font>ncont<font color="#808080">:=</font>ncont<font color="#808080">+</font><font color="#FF0000">1</font><font color="#808080">;
    </font>npos<font color="#808080">:=</font>npos<font color="#808080">+</font><font color="#FF0000">1</font><font color="#808080">;
  </font><font color="#000080"><b>end</b></font><font color="#808080">;
  </font>nsoma<font color="#808080">:=(</font><font color="#FF0000">11 </font><font color="#808080">- (</font>nsoma <font color="#808080">\\ </font><font color="#FF0000">11</font><font color="#808080">));

  </font><font color="#000080"><b>if </b></font>nsoma <font color="#808080">&gt; </font><font color="#FF0000">9 </font><font color="#000080"><b>then
    </b></font><font color="#800080">result</font><font color="#808080">:=</font><font color="#FF0000">0</font><font color="#808080">;
  </font><font color="#000080"><b>else
    </b></font><font color="#800080">result</font><font color="#808080">:=</font>nsoma<font color="#808080">;
  </font><font color="#000080"><b>end</b></font><font color="#808080">;
</font><font color="#000080"><b>end</b></font><font color="#808080">;
-- ----------------------------------------------------------------------------
-- Valida&ccedil;&atilde;o de um n&uacute;mero de CPF qualquer.
-- cpf - a mstring com o n&uacute;mero do CPF
-- retorna - se &eacute; valido ou n&atilde;o
-- ----------------------------------------------------------------------------
</font>validacpf<font color="#808080">(</font>cpf<font color="#808080">: </font><font color="#0000FF">STRING</font><font color="#808080">): </font><font color="#0000FF">BOOLEAN </font><font color="#000080"><b>is
local 
  </b></font>scpf<font color="#808080">, </font>sres<font color="#808080">: </font><font color="#0000FF">STRING</font><font color="#808080">;
  </font>nvalor1<font color="#808080">, </font>nvalor2<font color="#808080">: </font><font color="#0000FF">INTEGER</font><font color="#808080">;
</font><font color="#000080"><b>do
if </b></font><font color="#808080">(</font>cpf.count<font color="#808080">=</font><font color="#FF0000">14</font><font color="#808080">) </font><font color="#000080"><b>then 
  </b></font>scpf<font color="#808080">:=</font>substr<font color="#808080">(</font>cpf<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#FF0000">3</font><font color="#808080">)+</font>substr<font color="#808080">(</font>cpf<font color="#808080">,</font><font color="#FF0000">5</font><font color="#808080">,</font><font color="#FF0000">3</font><font color="#808080">)+</font>substr<font color="#808080">(</font>cpf<font color="#808080">,</font><font color="#FF0000">9</font><font color="#808080">,</font><font color="#FF0000">3</font><font color="#808080">)+</font>substr<font color="#808080">(</font>cpf<font color="#808080">,</font><font color="#FF0000">13</font><font color="#808080">,</font><font color="#FF0000">2</font><font color="#808080">);
  </font>sres<font color="#808080">:=</font>substr<font color="#808080">(</font>cpf<font color="#808080">,</font><font color="#FF0000">13</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">);
  </font>nvalor1<font color="#808080">:=</font>sres.to_integer<font color="#808080">;
  </font>sres<font color="#808080">:=</font>substr<font color="#808080">(</font>cpf<font color="#808080">,</font><font color="#FF0000">14</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">);
  </font>nvalor2<font color="#808080">:=</font>sres.to_integer<font color="#808080">;
  </font><font color="#000080"><b>if </b></font><font color="#808080">((</font>modulo11<font color="#808080">(</font>scpf<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">)=</font>nvalor1<font color="#808080">) </font><font color="#000080"><b>and </b></font><font color="#808080">(</font>modulo11<font color="#808080">(</font>scpf<font color="#808080">,</font><font color="#FF0000">2</font><font color="#808080">)=</font>nvalor2<font color="#808080">)) </font><font color="#000080"><b>then
    </b></font><font color="#800080">result</font><font color="#808080">:=</font><font color="#008080">true</font><font color="#808080">;
  </font><font color="#000080"><b>else
    </b></font><font color="#800080">result</font><font color="#808080">:=</font><font color="#008080">false</font><font color="#808080">;
  </font><font color="#000080"><b>end</b></font><font color="#808080">;
</font><font color="#000080"><b>else
  </b></font><font color="#800080">result</font><font color="#808080">:=</font><font color="#008080">false</font><font color="#808080">;
</font><font color="#000080"><b>end</b></font><font color="#808080">;
</font><font color="#000080"><b>end</b></font><font color="#808080">;
-- ----------------------------------------------------------------------------
-- Valida&ccedil;&atilde;o de um n&uacute;mero ISBN qualquer.
-- isbn - a mstring com o n&uacute;mero do ISBN
-- retorna - se &eacute; valido ou n&atilde;o
-- ----------------------------------------------------------------------------
</font>validaisbn<font color="#808080">(</font>isbn<font color="#808080">: </font><font color="#0000FF">STRING</font><font color="#808080">): </font><font color="#0000FF">BOOLEAN </font><font color="#000080"><b>is
local 
  </b></font>snum<font color="#808080">, </font>sdigito<font color="#808080">, </font>sisbn<font color="#808080">: </font><font color="#0000FF">STRING</font><font color="#808080">;
  </font>nvalor<font color="#808080">, </font>nsoma<font color="#808080">, </font>ncont<font color="#808080">: </font><font color="#0000FF">INTEGER</font><font color="#808080">;
</font><font color="#000080"><b>do
if </b></font><font color="#808080">(</font>isbn.count<font color="#808080">=</font><font color="#FF0000">13</font><font color="#808080">) </font><font color="#000080"><b>then
  </b></font>sdigito <font color="#808080">:= </font>substr<font color="#808080">(</font>isbn<font color="#808080">, </font>isbn.count<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">);
  </font>sisbn<font color="#808080">:=</font><font color="#800000">&quot;&quot;</font><font color="#808080">;
  </font><font color="#000080"><b>from 
    </b></font>ncont <font color="#808080">:= </font><font color="#FF0000">1</font><font color="#808080">;
  </font><font color="#000080"><b>until
    </b></font>ncont <font color="#808080">&gt; </font>isbn.count<font color="#808080">-</font><font color="#FF0000">1
  </font><font color="#000080"><b>loop
    if </b></font>substr<font color="#808080">(</font>isbn<font color="#808080">,</font>ncont<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">) /= </font><font color="#800000">&quot;-&quot; </font><font color="#000080"><b>then
      </b></font>sisbn<font color="#808080">:=</font>sisbn<font color="#808080">+</font>substr<font color="#808080">(</font>isbn<font color="#808080">,</font>ncont<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">);
    </font><font color="#000080"><b>end</b></font><font color="#808080">;
    </font>ncont<font color="#808080">:=</font>ncont <font color="#808080">+ </font><font color="#FF0000">1</font><font color="#808080">;
  </font><font color="#000080"><b>end</b></font><font color="#808080">;
  </font><font color="#000080"><b>if </b></font>sdigito <font color="#808080">= </font><font color="#800000">&quot;X&quot; </font><font color="#000080"><b>then
    </b></font>nsoma <font color="#808080">:= </font><font color="#FF0000">10
  </font><font color="#000080"><b>else
    </b></font>nvalor<font color="#808080">:=</font>sdigito.to_integer<font color="#808080">;
    </font>nsoma <font color="#808080">:= </font>nvalor<font color="#808080">;
  </font><font color="#000080"><b>end</b></font><font color="#808080">;
  </font><font color="#000080"><b>from 
    </b></font>ncont <font color="#808080">:= </font><font color="#FF0000">1</font><font color="#808080">;
  </font><font color="#000080"><b>until
    </b></font>ncont <font color="#808080">&gt; </font><font color="#FF0000">9
  </font><font color="#000080"><b>loop
    </b></font>snum<font color="#808080">:=</font>substr<font color="#808080">(</font>sisbn<font color="#808080">, </font>ncont<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">);
    </font>nvalor<font color="#808080">:=</font>snum.to_integer<font color="#808080">;
    </font>nsoma<font color="#808080">:=</font>nsoma <font color="#808080">+ (</font>nvalor <font color="#808080">* (</font><font color="#FF0000">11 </font><font color="#808080">- </font>ncont<font color="#808080">));
    </font>ncont<font color="#808080">:=</font>ncont <font color="#808080">+ </font><font color="#FF0000">1</font><font color="#808080">;
  </font><font color="#000080"><b>end</b></font><font color="#808080">;
  </font><font color="#000080"><b>if </b></font><font color="#808080">(</font>nsoma <font color="#808080">\\ </font><font color="#FF0000">11</font><font color="#808080">) = </font><font color="#FF0000">0 </font><font color="#000080"><b>then
    </b></font><font color="#800080">result</font><font color="#808080">:=</font><font color="#008080">true</font><font color="#808080">;
  </font><font color="#000080"><b>else
    </b></font><font color="#800080">result</font><font color="#808080">:=</font><font color="#008080">false</font><font color="#808080">;
  </font><font color="#000080"><b>end</b></font><font color="#808080">;
</font><font color="#000080"><b>else
  </b></font><font color="#800080">result</font><font color="#808080">:=</font><font color="#008080">false</font><font color="#808080">;
</font><font color="#000080"><b>end</b></font><font color="#808080">;
</font><font color="#000080"><b>end</b></font><font color="#808080">;
-- ----------------------------------------------------------------------------
-- realiza a digita&ccedil;&atilde;o de algum texto
-- retorna - o texto digitado
-- ----------------------------------------------------------------------------
</font>digita<font color="#808080">: </font><font color="#0000FF">STRING </font><font color="#000080"><b>is
do
  </b></font>io.read_line<font color="#808080">;
  </font><font color="#000080"><b>if </b></font>io.last_string.is_empty <font color="#000080"><b>then
    </b></font>io.flush<font color="#808080">;
    </font>io.read_line<font color="#808080">;
  </font><font color="#000080"><b>end
  </b></font><font color="#800080">result</font><font color="#808080">:=</font>io.last_string<font color="#808080">;
</font><font color="#000080"><b>end</b></font><font color="#808080">;
-- ----------------------------------------------------------------------------
-- Esconde a digita&ccedil;&atilde;o da senha
-- retorna - a senha digitada
-- ----------------------------------------------------------------------------
</font>digitasenha<font color="#808080">(</font>srotulo<font color="#808080">: </font><font color="#0000FF">STRING</font><font color="#808080">; </font>ntamsenha<font color="#808080">: </font><font color="#0000FF">INTEGER</font><font color="#808080">): </font><font color="#0000FF">STRING </font><font color="#000080"><b>is
local
  </b></font>ssenha<font color="#808080">: </font><font color="#0000FF">STRING</font><font color="#808080">;
--  sletra: CHARACTER;
--  ncont: INTEGER;
</font><font color="#000080"><b>do
  </b></font>io.put_string<font color="#808080">(</font>srotulo<font color="#808080">);
  </font>ssenha<font color="#808080">:=</font>digita
<font color="#808080">--  ssenha:=&quot;&quot;;
--  sletra:='%U';
--  from 
--    ncont := 1;
--  until
--    (ncont &gt; ntamsenha) and (sletra = '%R')
--  loop
--    io.read_character;
--    sletra:=io.last_character;
--    ssenha.insert_character(sletra,ncont);
--    ncont:=ncont+1;
--  end;
  </font><font color="#800080">result</font><font color="#808080">:=</font>ssenha<font color="#808080">;
</font><font color="#000080"><b>end</b></font><font color="#808080">;
-- ----------------------------------------------------------------------------
-- Valida&ccedil;&atilde;o de um n&uacute;mero qualquer.
-- sRotulo - o texto antes de se digitar o n&uacute;mero
-- sNumero - a mstring com o valor do n&uacute;mero
-- retorna - o sNumero
-- ----------------------------------------------------------------------------
</font>validanumero<font color="#808080">(</font>srotulo<font color="#808080">, </font>snumero<font color="#808080">: </font><font color="#0000FF">STRING</font><font color="#808080">): </font><font color="#0000FF">STRING </font><font color="#000080"><b>is
local
  </b></font>nnum<font color="#808080">: </font><font color="#0000FF">DOUBLE</font><font color="#808080">;
  </font>nstatus<font color="#808080">: </font><font color="#0000FF">INTEGER</font><font color="#808080">;
  </font>slocal<font color="#808080">: </font><font color="#0000FF">STRING</font><font color="#808080">;
</font><font color="#000080"><b>do
</b></font>slocal<font color="#808080">:=</font>snumero<font color="#808080">;
</font><font color="#000080"><b>from
  </b></font>nstatus<font color="#808080">:=-</font><font color="#FF0000">1</font><font color="#808080">;
</font><font color="#000080"><b>until
  </b></font>nstatus <font color="#808080">= </font><font color="#FF0000">0
</font><font color="#000080"><b>loop
  </b></font>io.put_string<font color="#808080">(</font>srotulo<font color="#808080">);
  </font>slocal<font color="#808080">:=</font>digita<font color="#808080">;
  </font><font color="#000080"><b>if </b></font>slocal.is_double <font color="#000080"><b>then
    </b></font>nnum<font color="#808080">:=</font>slocal.to_double<font color="#808080">;
    </font><font color="#000080"><b>if </b></font>nnum <font color="#808080">&lt; </font><font color="#FF0000">0</font>.01 <font color="#000080"><b>then
      </b></font>io.put_string<font color="#808080">(</font>msg_numinv<font color="#808080">);
    </font><font color="#000080"><b>else
      </b></font>nstatus<font color="#808080">:=</font><font color="#FF0000">0</font><font color="#808080">;
    </font><font color="#000080"><b>end</b></font><font color="#808080">;
  </font><font color="#000080"><b>else
    </b></font>io.put_string<font color="#808080">(</font>msg_numinv<font color="#808080">);
  </font><font color="#000080"><b>end</b></font><font color="#808080">;
</font><font color="#000080"><b>end</b></font><font color="#808080">;
</font><font color="#800080">result</font><font color="#808080">:=</font>slocal<font color="#808080">;
</font><font color="#000080"><b>end</b></font><font color="#808080">;
-- ----------------------------------------------------------------------------
-- Valida&ccedil;&atilde;o de uma data ou data/hora qualquer.
-- sRotulo - o texto antes de se digitar a data/hora
-- sDataHora - a mstring com o valor da data/hora
-- bSoData - indica se vai validar somente uma data sem a hora
-- retorna - a sDataHora
-- ----------------------------------------------------------------------------
</font>validadatahora<font color="#808080">(</font>srotulo<font color="#808080">, </font>sdatahora<font color="#808080">: </font><font color="#0000FF">STRING</font><font color="#808080">; </font>bsodata<font color="#808080">: </font><font color="#0000FF">BOOLEAN</font><font color="#808080">): </font><font color="#0000FF">STRING </font><font color="#000080"><b>is
local
  </b></font>bvalida<font color="#808080">, </font>bdatavalida<font color="#808080">, </font>bhoravalida<font color="#808080">: </font><font color="#0000FF">BOOLEAN</font><font color="#808080">;
  </font>sdia<font color="#808080">, </font>smes<font color="#808080">, </font>sano<font color="#808080">, </font>shora<font color="#808080">, </font>smin<font color="#808080">, </font>sseg<font color="#808080">, </font>slocal<font color="#808080">: </font><font color="#0000FF">STRING</font><font color="#808080">;
  </font>ndia<font color="#808080">, </font>nmes<font color="#808080">, </font>nano<font color="#808080">, </font>nhora<font color="#808080">, </font>nmin<font color="#808080">, </font>nseg<font color="#808080">, </font>nudiames<font color="#808080">, </font>ntam<font color="#808080">: </font><font color="#0000FF">INTEGER</font><font color="#808080">;
</font><font color="#000080"><b>do
from
  </b></font>slocal<font color="#808080">:=</font>sdatahora<font color="#808080">;
  </font>bvalida<font color="#808080">:=</font><font color="#008080">false</font><font color="#808080">;
  </font>bdatavalida<font color="#808080">:=</font><font color="#008080">false</font><font color="#808080">;
  </font>bhoravalida<font color="#808080">:=</font><font color="#008080">false</font><font color="#808080">;
  </font>nudiames<font color="#808080">:=</font><font color="#FF0000">0</font><font color="#808080">;
  
  </font><font color="#000080"><b>if </b></font>bsodata<font color="#808080">=</font><font color="#008080">true </font><font color="#000080"><b>then
    </b></font>ntam<font color="#808080">:=</font><font color="#FF0000">10</font><font color="#808080">;
  </font><font color="#000080"><b>else 
    </b></font>ntam<font color="#808080">:=</font><font color="#FF0000">19</font><font color="#808080">;
  </font><font color="#000080"><b>end</b></font><font color="#808080">;
</font><font color="#000080"><b>until
  </b></font>bvalida<font color="#808080">=</font><font color="#008080">true
</font><font color="#000080"><b>loop
  </b></font>io.put_string<font color="#808080">(</font>srotulo<font color="#808080">);
  </font>slocal<font color="#808080">:=</font>digita<font color="#808080">;
  </font><font color="#000080"><b>if </b></font>slocal.count<font color="#808080">=</font>ntam <font color="#000080"><b>then 
    </b></font>sdia<font color="#808080">:=</font>substr<font color="#808080">(</font>slocal<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#FF0000">2</font><font color="#808080">);
    </font>ndia<font color="#808080">:=</font>sdia.to_integer<font color="#808080">;
    </font>smes<font color="#808080">:=</font>substr<font color="#808080">(</font>slocal<font color="#808080">,</font><font color="#FF0000">4</font><font color="#808080">,</font><font color="#FF0000">2</font><font color="#808080">);
    </font>nmes<font color="#808080">:=</font>smes.to_integer<font color="#808080">;
    </font>sano<font color="#808080">:=</font>substr<font color="#808080">(</font>slocal<font color="#808080">,</font><font color="#FF0000">7</font><font color="#808080">,</font><font color="#FF0000">4</font><font color="#808080">);
    </font>nano<font color="#808080">:=</font>sano.to_integer<font color="#808080">;
  
    </font><font color="#000080"><b>if </b></font><font color="#808080">(</font>nano <font color="#808080">&gt;= </font><font color="#FF0000">1</font><font color="#808080">) </font><font color="#000080"><b>and </b></font><font color="#808080">(</font>nano <font color="#808080">&lt;= </font><font color="#FF0000">9999</font><font color="#808080">) </font><font color="#000080"><b>then
      if </b></font><font color="#808080">(</font>nmes <font color="#808080">&gt;= </font><font color="#FF0000">1</font><font color="#808080">) </font><font color="#000080"><b>and </b></font><font color="#808080">(</font>nmes <font color="#808080">&lt;= </font><font color="#FF0000">31</font><font color="#808080">) </font><font color="#000080"><b>then
         inspect </b></font>nmes
           <font color="#000080"><b>when </b></font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">, </font><font color="#FF0000">5</font><font color="#808080">, </font><font color="#FF0000">7</font><font color="#808080">, </font><font color="#FF0000">8</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">, </font><font color="#FF0000">12 </font><font color="#000080"><b>then </b></font>nudiames<font color="#808080">:=</font><font color="#FF0000">31</font><font color="#808080">;
           </font><font color="#000080"><b>when </b></font><font color="#FF0000">2 </font><font color="#000080"><b>then
               </b></font><font color="#808080">-- ano bissexto
               </font><font color="#000080"><b>if </b></font><font color="#808080">(</font>nano <font color="#808080">\\ </font><font color="#FF0000">4</font><font color="#808080">)=</font><font color="#FF0000">0 </font><font color="#000080"><b>then </b></font>nudiames<font color="#808080">:=</font><font color="#FF0000">29
               </font><font color="#000080"><b>else </b></font>nudiames<font color="#808080">:=</font><font color="#FF0000">28</font><font color="#808080">; 
               </font><font color="#000080"><b>end</b></font><font color="#808080">;
           </font><font color="#000080"><b>when </b></font><font color="#FF0000">4</font><font color="#808080">, </font><font color="#FF0000">6</font><font color="#808080">, </font><font color="#FF0000">9</font><font color="#808080">, </font><font color="#FF0000">11 </font><font color="#000080"><b>then </b></font>nudiames<font color="#808080">:=</font><font color="#FF0000">30</font><font color="#808080">;
         </font><font color="#000080"><b>end</b></font><font color="#808080">;
         </font><font color="#000080"><b>if </b></font><font color="#808080">(</font>ndia <font color="#808080">&gt;=</font><font color="#FF0000">1</font><font color="#808080">) </font><font color="#000080"><b>and </b></font><font color="#808080">(</font>ndia <font color="#808080">&lt;=</font>nudiames<font color="#808080">) </font><font color="#000080"><b>then
            </b></font>bdatavalida<font color="#808080">:=</font><font color="#008080">true</font><font color="#808080">;
         </font><font color="#000080"><b>end</b></font><font color="#808080">;
      </font><font color="#000080"><b>end</b></font><font color="#808080">;
    </font><font color="#000080"><b>end</b></font><font color="#808080">;
  
    </font><font color="#000080"><b>if </b></font>bsodata <font color="#000080"><b>then
       if </b></font>bdatavalida <font color="#000080"><b>then </b></font>bvalida<font color="#808080">:=</font><font color="#008080">true
       </font><font color="#000080"><b>else 
         </b></font>io.put_string<font color="#808080">(</font>msg_datainv<font color="#808080">);
         </font>io.put_new_line<font color="#808080">;   
       </font><font color="#000080"><b>end</b></font><font color="#808080">;
    </font><font color="#000080"><b>else
      if </b></font>bdatavalida <font color="#000080"><b>then
          </b></font>shora<font color="#808080">:=</font>substr<font color="#808080">(</font>slocal<font color="#808080">,</font><font color="#FF0000">12</font><font color="#808080">,</font><font color="#FF0000">2</font><font color="#808080">);
          </font>nhora<font color="#808080">:=</font>shora.to_integer<font color="#808080">;
          </font>smin<font color="#808080">:=</font>substr<font color="#808080">(</font>slocal<font color="#808080">,</font><font color="#FF0000">15</font><font color="#808080">,</font><font color="#FF0000">2</font><font color="#808080">);
          </font>nmin<font color="#808080">:=</font>smin.to_integer<font color="#808080">;
          </font>sseg<font color="#808080">:=</font>substr<font color="#808080">(</font>slocal<font color="#808080">,</font><font color="#FF0000">18</font><font color="#808080">,</font><font color="#FF0000">2</font><font color="#808080">);
          </font>nseg<font color="#808080">:=</font>sseg.to_integer<font color="#808080">;
  
          </font><font color="#000080"><b>if </b></font><font color="#808080">(</font>nhora <font color="#808080">&gt;= </font><font color="#FF0000">0</font><font color="#808080">) </font><font color="#000080"><b>and </b></font><font color="#808080">(</font>nhora <font color="#808080">&lt;= </font><font color="#FF0000">23</font><font color="#808080">) </font><font color="#000080"><b>then
            if </b></font><font color="#808080">(</font>nmin <font color="#808080">&gt;= </font><font color="#FF0000">0</font><font color="#808080">) </font><font color="#000080"><b>and </b></font><font color="#808080">(</font>nmin <font color="#808080">&lt;= </font><font color="#FF0000">59</font><font color="#808080">) </font><font color="#000080"><b>then
              if </b></font><font color="#808080">(</font>nseg <font color="#808080">&gt;= </font><font color="#FF0000">0</font><font color="#808080">) </font><font color="#000080"><b>and </b></font><font color="#808080">(</font>nseg <font color="#808080">&lt;= </font><font color="#FF0000">59</font><font color="#808080">) </font><font color="#000080"><b>then
                 </b></font>bhoravalida<font color="#808080">:=</font><font color="#008080">true</font><font color="#808080">;
              </font><font color="#000080"><b>end</b></font><font color="#808080">;
            </font><font color="#000080"><b>end</b></font><font color="#808080">;
          </font><font color="#000080"><b>end</b></font><font color="#808080">;
  
          </font><font color="#000080"><b>if </b></font>bhoravalida <font color="#000080"><b>then </b></font>bvalida<font color="#808080">:=</font><font color="#008080">true
          </font><font color="#000080"><b>else </b></font>io.put_string<font color="#808080">(</font>msg_dthrinv<font color="#808080">);
          </font><font color="#000080"><b>end</b></font><font color="#808080">; 
      </font><font color="#000080"><b>else
        </b></font>io.put_string<font color="#808080">(</font>msg_dthrinv<font color="#808080">);
      </font><font color="#000080"><b>end</b></font><font color="#808080">;
    </font><font color="#000080"><b>end</b></font><font color="#808080">;
  </font><font color="#000080"><b>else
    if </b></font>bsodata<font color="#808080">=</font><font color="#008080">true </font><font color="#000080"><b>then </b></font>io.put_string<font color="#808080">(</font>msg_datainv<font color="#808080">)
    </font><font color="#000080"><b>else </b></font>io.put_string<font color="#808080">(</font>msg_dthrinv<font color="#808080">);
    </font><font color="#000080"><b>end</b></font><font color="#808080">;
  </font><font color="#000080"><b>end</b></font><font color="#808080">;
</font><font color="#000080"><b>end</b></font><font color="#808080">;
</font><font color="#800080">result</font><font color="#808080">:=</font>slocal<font color="#808080">;
</font><font color="#000080"><b>end</b></font><font color="#808080">;
-- ----------------------------------------------------------------------------
-- Retorna a Data e a hora do sistema.
-- retorna - a data e a hora
-- ----------------------------------------------------------------------------
</font>retdatahora<font color="#808080">: </font><font color="#0000FF">STRING </font><font color="#000080"><b>is
local 
  </b></font>tempo<font color="#808080">: </font>TIME<font color="#808080">;
  </font>sdia<font color="#808080">,</font>smes<font color="#808080">,</font>sano<font color="#808080">,</font>shora<font color="#808080">,</font>smin<font color="#808080">,</font>sseg<font color="#808080">: </font><font color="#0000FF">STRING</font><font color="#808080">;
</font><font color="#000080"><b>do
  </b></font>tempo.update<font color="#808080">;
  </font>sdia<font color="#808080">:=</font>tempo.day.to_string<font color="#808080">;
  </font>smes<font color="#808080">:=</font>tempo.month.to_string<font color="#808080">;
  </font>sano<font color="#808080">:=</font>tempo.year.to_string<font color="#808080">;
  </font>shora<font color="#808080">:=</font>tempo.hour.to_string<font color="#808080">;
  </font>smin<font color="#808080">:=</font>tempo.minute.to_string<font color="#808080">;
  </font>sseg<font color="#808080">:=</font>tempo.second.to_string<font color="#808080">;
  </font><font color="#800080">result</font><font color="#808080">:=</font>zeros<font color="#808080">(</font>sdia<font color="#808080">,</font><font color="#FF0000">2</font><font color="#808080">)+</font><font color="#800000">&quot;/&quot;</font><font color="#808080">+</font>zeros<font color="#808080">(</font>smes<font color="#808080">,</font><font color="#FF0000">2</font><font color="#808080">)+</font><font color="#800000">&quot;/&quot;</font><font color="#808080">+</font>sano<font color="#808080">+</font><font color="#800000">&quot; &quot;</font><font color="#808080">+
  </font>zeros<font color="#808080">(</font>shora<font color="#808080">,</font><font color="#FF0000">2</font><font color="#808080">)+</font><font color="#800000">&quot;:&quot;</font><font color="#808080">+</font>zeros<font color="#808080">(</font>smin<font color="#808080">,</font><font color="#FF0000">2</font><font color="#808080">)+</font><font color="#800000">&quot;:&quot;</font><font color="#808080">+</font>zeros<font color="#808080">(</font>sseg<font color="#808080">,</font><font color="#FF0000">2</font><font color="#808080">);
</font><font color="#000080"><b>end</b></font><font color="#808080">;
-- ----------------------------------------------------------------------------
-- Calcula o tamanho do arquivo.
-- sArq - o arquivo
-- retorna - o tamanho do arquivo
-- ----------------------------------------------------------------------------
</font>tamarq<font color="#808080">(</font>sarq<font color="#808080">: </font><font color="#0000FF">STRING</font><font color="#808080">): </font><font color="#0000FF">INTEGER </font><font color="#000080"><b>is
do
  </b></font><font color="#800080">result</font><font color="#808080">:=</font><font color="#0000FF">file_tools</font>.size_of<font color="#808080">(</font>sarq<font color="#808080">);
</font><font color="#000080"><b>end</b></font><font color="#808080">;
-- ----------------------------------------------------------------------------
-- Abre ou cria os arquivos do sistema.
-- bAbre - condi&ccedil;&atilde;o para abrir ou criar os arquivos do sistema
-- ----------------------------------------------------------------------------
</font>abrecriaarqs<font color="#808080">(</font>babre<font color="#808080">: </font><font color="#0000FF">BOOLEAN</font><font color="#808080">) </font><font color="#000080"><b>is
do
  if </b></font>babre<font color="#808080">=</font><font color="#008080">true </font><font color="#000080"><b>then 
    </b></font>tfassunto.connect_to<font color="#808080">(</font>arq_assunto<font color="#808080">);
    </font><font color="#000080"><b>if </b></font>tfassunto.is_connected<font color="#808080">=</font><font color="#008080">false </font><font color="#000080"><b>then
      </b></font>io.put_string<font color="#808080">(</font>msg_arqerro<font color="#808080">+</font><font color="#800000">&quot; --&gt; &quot;</font><font color="#808080">+</font>arq_assunto<font color="#808080">);
      </font>io.put_new_line<font color="#808080">;
      </font>die_with_code<font color="#808080">(</font>exit_failure_code<font color="#808080">);
    </font><font color="#000080"><b>end</b></font><font color="#808080">;
    </font>tfautor.connect_to<font color="#808080">(</font>arq_autor<font color="#808080">);
    </font><font color="#000080"><b>if </b></font>tfautor.is_connected<font color="#808080">=</font><font color="#008080">false </font><font color="#000080"><b>then
      </b></font>io.put_string<font color="#808080">(</font>msg_arqerro<font color="#808080">+</font><font color="#800000">&quot; --&gt; &quot;</font><font color="#808080">+</font>arq_autor<font color="#808080">);
      </font>io.put_new_line<font color="#808080">;
      </font>die_with_code<font color="#808080">(</font>exit_failure_code<font color="#808080">);
    </font><font color="#000080"><b>end</b></font><font color="#808080">;
    </font>tfeditora.connect_to<font color="#808080">(</font>arq_editora<font color="#808080">);
    </font><font color="#000080"><b>if </b></font>tfeditora.is_connected<font color="#808080">=</font><font color="#008080">false </font><font color="#000080"><b>then
      </b></font>io.put_string<font color="#808080">(</font>msg_arqerro<font color="#808080">+</font><font color="#800000">&quot; --&gt; &quot;</font><font color="#808080">+</font>arq_editora<font color="#808080">);
      </font>io.put_new_line<font color="#808080">;
      </font>die_with_code<font color="#808080">(</font>exit_failure_code<font color="#808080">);
    </font><font color="#000080"><b>end</b></font><font color="#808080">;
    </font>tfidioma.connect_to<font color="#808080">(</font>arq_idioma<font color="#808080">);
    </font><font color="#000080"><b>if </b></font>tfidioma.is_connected<font color="#808080">=</font><font color="#008080">false </font><font color="#000080"><b>then
      </b></font>io.put_string<font color="#808080">(</font>msg_arqerro<font color="#808080">+</font><font color="#800000">&quot; --&gt; &quot;</font><font color="#808080">+</font>arq_idioma<font color="#808080">);
      </font>io.put_new_line<font color="#808080">;
      </font>die_with_code<font color="#808080">(</font>exit_failure_code<font color="#808080">);
    </font><font color="#000080"><b>end</b></font><font color="#808080">;
    </font>tfendereco.connect_to<font color="#808080">(</font>arq_endereco<font color="#808080">);
    </font><font color="#000080"><b>if </b></font>tfendereco.is_connected<font color="#808080">=</font><font color="#008080">false </font><font color="#000080"><b>then
      </b></font>io.put_string<font color="#808080">(</font>msg_arqerro<font color="#808080">+</font><font color="#800000">&quot; --&gt; &quot;</font><font color="#808080">+</font>arq_endereco<font color="#808080">);
      </font>io.put_new_line<font color="#808080">;
      </font>die_with_code<font color="#808080">(</font>exit_failure_code<font color="#808080">);
    </font><font color="#000080"><b>end</b></font><font color="#808080">;
    </font>tfpais.connect_to<font color="#808080">(</font>arq_pais<font color="#808080">);
    </font><font color="#000080"><b>if </b></font>tfpais.is_connected<font color="#808080">=</font><font color="#008080">false </font><font color="#000080"><b>then
      </b></font>io.put_string<font color="#808080">(</font>msg_arqerro<font color="#808080">+</font><font color="#800000">&quot; --&gt; &quot;</font><font color="#808080">+</font>arq_pais<font color="#808080">);
      </font>io.put_new_line<font color="#808080">;
      </font>die_with_code<font color="#808080">(</font>exit_failure_code<font color="#808080">);
    </font><font color="#000080"><b>end</b></font><font color="#808080">;
    </font>tfprofissao.connect_to<font color="#808080">(</font>arq_profissao<font color="#808080">);
    </font><font color="#000080"><b>if </b></font>tfprofissao.is_connected<font color="#808080">=</font><font color="#008080">false </font><font color="#000080"><b>then
      </b></font>io.put_string<font color="#808080">(</font>msg_arqerro<font color="#808080">+</font><font color="#800000">&quot; --&gt; &quot;</font><font color="#808080">+</font>arq_profissao<font color="#808080">);
      </font>io.put_new_line<font color="#808080">;
      </font>die_with_code<font color="#808080">(</font>exit_failure_code<font color="#808080">);
    </font><font color="#000080"><b>end</b></font><font color="#808080">;
    </font>tflivro.connect_to<font color="#808080">(</font>arq_livro<font color="#808080">);
    </font><font color="#000080"><b>if </b></font>tflivro.is_connected<font color="#808080">=</font><font color="#008080">false </font><font color="#000080"><b>then
      </b></font>io.put_string<font color="#808080">(</font>msg_arqerro<font color="#808080">+</font><font color="#800000">&quot; --&gt; &quot;</font><font color="#808080">+</font>arq_livro<font color="#808080">);
      </font>io.put_new_line<font color="#808080">;
      </font>die_with_code<font color="#808080">(</font>exit_failure_code<font color="#808080">);
    </font><font color="#000080"><b>end</b></font><font color="#808080">;
    </font>tflivroass.connect_to<font color="#808080">(</font>arq_livass<font color="#808080">);
    </font><font color="#000080"><b>if </b></font>tflivroass.is_connected<font color="#808080">=</font><font color="#008080">false </font><font color="#000080"><b>then
      </b></font>io.put_string<font color="#808080">(</font>msg_arqerro<font color="#808080">+</font><font color="#800000">&quot; --&gt; &quot;</font><font color="#808080">+</font>arq_livass<font color="#808080">);
      </font>io.put_new_line<font color="#808080">;
      </font>die_with_code<font color="#808080">(</font>exit_failure_code<font color="#808080">);
    </font><font color="#000080"><b>end</b></font><font color="#808080">;
    </font>tflivroaut.connect_to<font color="#808080">(</font>arq_livaut<font color="#808080">);
    </font><font color="#000080"><b>if </b></font>tflivroaut.is_connected<font color="#808080">=</font><font color="#008080">false </font><font color="#000080"><b>then
      </b></font>io.put_string<font color="#808080">(</font>msg_arqerro<font color="#808080">+</font><font color="#800000">&quot; --&gt; &quot;</font><font color="#808080">+</font>arq_livaut<font color="#808080">);
      </font>io.put_new_line<font color="#808080">;
      </font>die_with_code<font color="#808080">(</font>exit_failure_code<font color="#808080">);
    </font><font color="#000080"><b>end</b></font><font color="#808080">;
    </font>tfcliente.connect_to<font color="#808080">(</font>arq_cliente<font color="#808080">);
    </font><font color="#000080"><b>if </b></font>tfcliente.is_connected<font color="#808080">=</font><font color="#008080">false </font><font color="#000080"><b>then
      </b></font>io.put_string<font color="#808080">(</font>msg_arqerro<font color="#808080">+</font><font color="#800000">&quot; --&gt; &quot;</font><font color="#808080">+</font>arq_cliente<font color="#808080">);
      </font>io.put_new_line<font color="#808080">;
      </font>die_with_code<font color="#808080">(</font>exit_failure_code<font color="#808080">);
    </font><font color="#000080"><b>end</b></font><font color="#808080">;
    </font>tfusuario.connect_to<font color="#808080">(</font>arq_usuario<font color="#808080">);
    </font><font color="#000080"><b>if </b></font>tfusuario.is_connected<font color="#808080">=</font><font color="#008080">false </font><font color="#000080"><b>then
      </b></font>io.put_string<font color="#808080">(</font>msg_arqerro<font color="#808080">+</font><font color="#800000">&quot; --&gt; &quot;</font><font color="#808080">+</font>arq_usuario<font color="#808080">);
      </font>io.put_new_line<font color="#808080">;
      </font>die_with_code<font color="#808080">(</font>exit_failure_code<font color="#808080">);
    </font><font color="#000080"><b>end</b></font><font color="#808080">;
    </font>tfvenda.connect_to<font color="#808080">(</font>arq_venda<font color="#808080">);
    </font><font color="#000080"><b>if </b></font>tfvenda.is_connected<font color="#808080">=</font><font color="#008080">false </font><font color="#000080"><b>then
      </b></font>io.put_string<font color="#808080">(</font>msg_arqerro<font color="#808080">+</font><font color="#800000">&quot; --&gt; &quot;</font><font color="#808080">+</font>arq_venda<font color="#808080">);
      </font>io.put_new_line<font color="#808080">;
      </font>die_with_code<font color="#808080">(</font>exit_failure_code<font color="#808080">);
    </font><font color="#000080"><b>end</b></font><font color="#808080">;
  </font><font color="#000080"><b>else  
    </b></font>tfassunto.connect_for_appending_to<font color="#808080">(</font>arq_assunto<font color="#808080">);
    </font><font color="#000080"><b>if </b></font>tfassunto.is_connected<font color="#808080">=</font><font color="#008080">false </font><font color="#000080"><b>then
      </b></font>io.put_string<font color="#808080">(</font>msg_arqcerro<font color="#808080">+</font><font color="#800000">&quot; --&gt; &quot;</font><font color="#808080">+</font>arq_assunto<font color="#808080">);
      </font>io.put_new_line<font color="#808080">;
      </font>die_with_code<font color="#808080">(</font>exit_failure_code<font color="#808080">);
    </font><font color="#000080"><b>end</b></font><font color="#808080">;
    </font>tfautor.connect_for_appending_to<font color="#808080">(</font>arq_autor<font color="#808080">);
    </font><font color="#000080"><b>if </b></font>tfautor.is_connected<font color="#808080">=</font><font color="#008080">false </font><font color="#000080"><b>then
      </b></font>io.put_string<font color="#808080">(</font>msg_arqcerro<font color="#808080">+</font><font color="#800000">&quot; --&gt; &quot;</font><font color="#808080">+</font>arq_autor<font color="#808080">);
      </font>io.put_new_line<font color="#808080">;
      </font>die_with_code<font color="#808080">(</font>exit_failure_code<font color="#808080">);
    </font><font color="#000080"><b>end</b></font><font color="#808080">;
    </font>tfeditora.connect_for_appending_to<font color="#808080">(</font>arq_editora<font color="#808080">);
    </font><font color="#000080"><b>if </b></font>tfeditora.is_connected<font color="#808080">=</font><font color="#008080">false </font><font color="#000080"><b>then
      </b></font>io.put_string<font color="#808080">(</font>msg_arqcerro<font color="#808080">+</font><font color="#800000">&quot; --&gt; &quot;</font><font color="#808080">+</font>arq_editora<font color="#808080">);
      </font>io.put_new_line<font color="#808080">;
      </font>die_with_code<font color="#808080">(</font>exit_failure_code<font color="#808080">);
    </font><font color="#000080"><b>end</b></font><font color="#808080">;
    </font>tfidioma.connect_for_appending_to<font color="#808080">(</font>arq_idioma<font color="#808080">);
    </font><font color="#000080"><b>if </b></font>tfidioma.is_connected<font color="#808080">=</font><font color="#008080">false </font><font color="#000080"><b>then
      </b></font>io.put_string<font color="#808080">(</font>msg_arqcerro<font color="#808080">+</font><font color="#800000">&quot; --&gt; &quot;</font><font color="#808080">+</font>arq_idioma<font color="#808080">);
      </font>io.put_new_line<font color="#808080">;
      </font>die_with_code<font color="#808080">(</font>exit_failure_code<font color="#808080">);
    </font><font color="#000080"><b>end</b></font><font color="#808080">;
    </font>tfendereco.connect_for_appending_to<font color="#808080">(</font>arq_endereco<font color="#808080">);
    </font><font color="#000080"><b>if </b></font>tfendereco.is_connected<font color="#808080">=</font><font color="#008080">false </font><font color="#000080"><b>then
      </b></font>io.put_string<font color="#808080">(</font>msg_arqcerro<font color="#808080">+</font><font color="#800000">&quot; --&gt; &quot;</font><font color="#808080">+</font>arq_endereco<font color="#808080">);
      </font>io.put_new_line<font color="#808080">;
      </font>die_with_code<font color="#808080">(</font>exit_failure_code<font color="#808080">);
    </font><font color="#000080"><b>end</b></font><font color="#808080">;
    </font>tfpais.connect_for_appending_to<font color="#808080">(</font>arq_pais<font color="#808080">);
    </font><font color="#000080"><b>if </b></font>tfpais.is_connected<font color="#808080">=</font><font color="#008080">false </font><font color="#000080"><b>then
      </b></font>io.put_string<font color="#808080">(</font>msg_arqcerro<font color="#808080">+</font><font color="#800000">&quot; --&gt; &quot;</font><font color="#808080">+</font>arq_pais<font color="#808080">);
      </font>io.put_new_line<font color="#808080">;
      </font>die_with_code<font color="#808080">(</font>exit_failure_code<font color="#808080">);
    </font><font color="#000080"><b>end</b></font><font color="#808080">;
    </font>tfprofissao.connect_for_appending_to<font color="#808080">(</font>arq_profissao<font color="#808080">);
    </font><font color="#000080"><b>if </b></font>tfprofissao.is_connected<font color="#808080">=</font><font color="#008080">false </font><font color="#000080"><b>then
      </b></font>io.put_string<font color="#808080">(</font>msg_arqcerro<font color="#808080">+</font><font color="#800000">&quot; --&gt; &quot;</font><font color="#808080">+</font>arq_profissao<font color="#808080">);
      </font>io.put_new_line<font color="#808080">;
      </font>die_with_code<font color="#808080">(</font>exit_failure_code<font color="#808080">);
    </font><font color="#000080"><b>end</b></font><font color="#808080">;
    </font>tflivro.connect_for_appending_to<font color="#808080">(</font>arq_livro<font color="#808080">);
    </font><font color="#000080"><b>if </b></font>tflivro.is_connected<font color="#808080">=</font><font color="#008080">false </font><font color="#000080"><b>then
      </b></font>io.put_string<font color="#808080">(</font>msg_arqcerro<font color="#808080">+</font><font color="#800000">&quot; --&gt; &quot;</font><font color="#808080">+</font>arq_livro<font color="#808080">);
      </font>io.put_new_line<font color="#808080">;
      </font>die_with_code<font color="#808080">(</font>exit_failure_code<font color="#808080">);
    </font><font color="#000080"><b>end</b></font><font color="#808080">;
    </font>tflivroass.connect_for_appending_to<font color="#808080">(</font>arq_livass<font color="#808080">);
    </font><font color="#000080"><b>if </b></font>tflivroass.is_connected<font color="#808080">=</font><font color="#008080">false </font><font color="#000080"><b>then
      </b></font>io.put_string<font color="#808080">(</font>msg_arqcerro<font color="#808080">+</font><font color="#800000">&quot; --&gt; &quot;</font><font color="#808080">+</font>arq_livass<font color="#808080">);
      </font>io.put_new_line<font color="#808080">;
      </font>die_with_code<font color="#808080">(</font>exit_failure_code<font color="#808080">);
    </font><font color="#000080"><b>end</b></font><font color="#808080">;
    </font>tflivroaut.connect_for_appending_to<font color="#808080">(</font>arq_livaut<font color="#808080">);
    </font><font color="#000080"><b>if </b></font>tflivroaut.is_connected<font color="#808080">=</font><font color="#008080">false </font><font color="#000080"><b>then
      </b></font>io.put_string<font color="#808080">(</font>msg_arqcerro<font color="#808080">+</font><font color="#800000">&quot; --&gt; &quot;</font><font color="#808080">+</font>arq_livaut<font color="#808080">);
      </font>io.put_new_line<font color="#808080">;
      </font>die_with_code<font color="#808080">(</font>exit_failure_code<font color="#808080">);
    </font><font color="#000080"><b>end</b></font><font color="#808080">;
    </font>tfcliente.connect_for_appending_to<font color="#808080">(</font>arq_cliente<font color="#808080">);
    </font><font color="#000080"><b>if </b></font>tfcliente.is_connected<font color="#808080">=</font><font color="#008080">false </font><font color="#000080"><b>then
      </b></font>io.put_string<font color="#808080">(</font>msg_arqcerro<font color="#808080">+</font><font color="#800000">&quot; --&gt; &quot;</font><font color="#808080">+</font>arq_cliente<font color="#808080">);
      </font>io.put_new_line<font color="#808080">;
      </font>die_with_code<font color="#808080">(</font>exit_failure_code<font color="#808080">);
    </font><font color="#000080"><b>end</b></font><font color="#808080">;
    </font>tfusuario.connect_for_appending_to<font color="#808080">(</font>arq_usuario<font color="#808080">);
    </font><font color="#000080"><b>if </b></font>tfusuario.is_connected<font color="#808080">=</font><font color="#008080">false </font><font color="#000080"><b>then
      </b></font>io.put_string<font color="#808080">(</font>msg_arqcerro<font color="#808080">+</font><font color="#800000">&quot; --&gt; &quot;</font><font color="#808080">+</font>arq_usuario<font color="#808080">);
      </font>io.put_new_line<font color="#808080">;
      </font>die_with_code<font color="#808080">(</font>exit_failure_code<font color="#808080">);
    </font><font color="#000080"><b>end</b></font><font color="#808080">;
    </font>tfvenda.connect_for_appending_to<font color="#808080">(</font>arq_venda<font color="#808080">);
    </font><font color="#000080"><b>if </b></font>tfvenda.is_connected<font color="#808080">=</font><font color="#008080">false </font><font color="#000080"><b>then
      </b></font>io.put_string<font color="#808080">(</font>msg_arqcerro<font color="#808080">+</font><font color="#800000">&quot; --&gt; &quot;</font><font color="#808080">+</font>arq_venda<font color="#808080">);
      </font>io.put_new_line<font color="#808080">;
      </font>die_with_code<font color="#808080">(</font>exit_failure_code<font color="#808080">);
    </font><font color="#000080"><b>end</b></font><font color="#808080">;
  </font><font color="#000080"><b>end</b></font><font color="#808080">;
</font><font color="#000080"><b>end</b></font><font color="#808080">;
-- ----------------------------------------------------------------------------
-- Fecha todos os arquivos abertos.
-- ----------------------------------------------------------------------------
</font>fechaarqs <font color="#000080"><b>is
do
  </b></font>tfassunto.disconnect<font color="#808080">;
  </font>tfautor.disconnect<font color="#808080">;
  </font>tfeditora.disconnect<font color="#808080">;
  </font>tfidioma.disconnect<font color="#808080">;
  </font>tfendereco.disconnect<font color="#808080">;
  </font>tfpais.disconnect<font color="#808080">;
  </font>tfprofissao.disconnect<font color="#808080">;
  </font>tflivro.disconnect<font color="#808080">;
  </font>tflivroass.disconnect<font color="#808080">;
  </font>tflivroaut.disconnect<font color="#808080">;
  </font>tfcliente.disconnect<font color="#808080">;
  </font>tfusuario.disconnect<font color="#808080">;
  </font>tfvenda.disconnect<font color="#808080">;
</font><font color="#000080"><b>end</b></font><font color="#808080">;
-- ----------------------------------------------------------------------------
-- Reconecta o arquivo
-- sArq - o arquivo
-- ----------------------------------------------------------------------------
</font>reconecta<font color="#808080">(</font>sarq<font color="#808080">: </font><font color="#0000FF">TEXT_FILE_READ_WRITE</font><font color="#808080">) </font><font color="#000080"><b>is
local
  </b></font>snomearq<font color="#808080">: </font><font color="#0000FF">STRING</font><font color="#808080">;
</font><font color="#000080"><b>do
  </b></font>snomearq<font color="#808080">:=</font>sarq.path<font color="#808080">;
  </font>sarq.disconnect<font color="#808080">;
  </font>sarq.connect_to<font color="#808080">(</font>snomearq<font color="#808080">);
</font><font color="#000080"><b>end</b></font><font color="#808080">;
-- ----------------------------------------------------------------------------
-- Pesquisa um registro atrav&eacute;s de um valor chave num arquivo.
-- sArq - o arquivo
-- sChave - a chave a ser pesquisada
-- nPosChave - a posicao inicial da chave dentro do registro
-- nTamChave - o tamanho da chave dentro do registro
-- nTamLinha - o tamanho do registro
-- retorna - o registro pesquisado
-- ----------------------------------------------------------------------------
</font>pesqarq<font color="#808080">(</font>sarq<font color="#808080">: </font><font color="#0000FF">TEXT_FILE_READ_WRITE</font><font color="#808080">; </font>schave<font color="#808080">: </font><font color="#0000FF">STRING</font><font color="#808080">; </font>nposchave<font color="#808080">,
        </font>ntamchave<font color="#808080">, </font>ntamlinha<font color="#808080">: </font><font color="#0000FF">INTEGER</font><font color="#808080">): </font><font color="#0000FF">STRING </font><font color="#000080"><b>is
local
  </b></font>slinha<font color="#808080">, </font>sres<font color="#808080">: </font><font color="#0000FF">STRING</font><font color="#808080">;
  </font>bquebra<font color="#808080">: </font><font color="#0000FF">BOOLEAN</font><font color="#808080">;
  </font>nposicao<font color="#808080">: </font><font color="#0000FF">INTEGER</font><font color="#808080">;
</font><font color="#000080"><b>do
  </b></font>reconecta<font color="#808080">(</font>sarq<font color="#808080">);
  </font><font color="#000080"><b>from
    </b></font>sres<font color="#808080">:=</font><font color="#800000">&quot;&quot;</font><font color="#808080">;
    </font>slinha<font color="#808080">:=</font><font color="#800000">&quot;&quot;</font><font color="#808080">;
    </font>bquebra<font color="#808080">:=</font><font color="#008080">false</font><font color="#808080">;
    </font>nposicao<font color="#808080">:=</font><font color="#FF0000">0</font><font color="#808080">;
  </font><font color="#000080"><b>until
    </b></font>sarq.end_of_input <font color="#000080"><b>or </b></font>bquebra<font color="#808080">=</font><font color="#008080">true
  </font><font color="#000080"><b>loop
    </b></font>slinha.clear_count<font color="#808080">;
    </font>sarq.read_line_in<font color="#808080">(</font>slinha<font color="#808080">);
    </font><font color="#000080"><b>if </b></font>slinha.is_empty<font color="#808080">=</font><font color="#008080">false </font><font color="#000080"><b>then
      </b></font>sres<font color="#808080">:=</font>trim<font color="#808080">(</font>substr<font color="#808080">(</font>slinha<font color="#808080">,</font>nposchave<font color="#808080">,</font>ntamchave<font color="#808080">));
      </font><font color="#000080"><b>if </b></font>sres.is_equal<font color="#808080">(</font>schave<font color="#808080">) </font><font color="#000080"><b>then
        </b></font>bquebra<font color="#808080">:=</font><font color="#008080">true</font><font color="#808080">;  
      </font><font color="#000080"><b>end</b></font><font color="#808080">;
      </font>nposicao<font color="#808080">:=</font>nposicao<font color="#808080">+</font><font color="#FF0000">1</font><font color="#808080">;
    </font><font color="#000080"><b>end</b></font><font color="#808080">;
  </font><font color="#000080"><b>end</b></font><font color="#808080">;
  </font>g_nposreg<font color="#808080">:=</font>nposicao<font color="#808080">;
  </font><font color="#000080"><b>if </b></font>sres.is_equal<font color="#808080">(</font>schave<font color="#808080">)=</font><font color="#008080">false </font><font color="#000080"><b>then
    </b></font><font color="#800080">result</font><font color="#808080">:=</font><font color="#800000">&quot;&quot;
  </font><font color="#000080"><b>else
    </b></font><font color="#800080">result</font><font color="#808080">:=</font>substr<font color="#808080">(</font>slinha<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font>ntamlinha<font color="#808080">);
  </font><font color="#000080"><b>end</b></font><font color="#808080">;
</font><font color="#000080"><b>end</b></font><font color="#808080">;
-- ----------------------------------------------------------------------------
-- Pesquisa se tem linha exclu&iacute;da sen&atilde;o vai para a &uacute;ltima linha do arquivo.
-- sArq - o arquivo
-- nTamLinha - o tamanho do registro
-- ----------------------------------------------------------------------------
</font>pesqlinhaexcluida<font color="#808080">(</font>sarq<font color="#808080">: </font><font color="#0000FF">TEXT_FILE_READ_WRITE</font><font color="#808080">; </font>ntamlinha<font color="#808080">: </font><font color="#0000FF">INTEGER</font><font color="#808080">) </font><font color="#000080"><b>is
local 
  </b></font>sexcluido<font color="#808080">: </font><font color="#0000FF">STRING</font><font color="#808080">;
</font><font color="#000080"><b>do
  </b></font>sexcluido<font color="#808080">:=</font>pesqarq<font color="#808080">(</font>sarq<font color="#808080">, </font><font color="#800000">&quot;*&quot;</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font>ntamlinha<font color="#808080">);
  </font><font color="#000080"><b>if </b></font>sexcluido.is_empty <font color="#000080"><b>then
     </b></font><font color="#808080">-- g_nposreg:=tamarq(sarq.path);
    </font>g_regexcluido<font color="#808080">:=</font><font color="#008080">false</font><font color="#808080">;
  </font><font color="#000080"><b>else
    </b></font>g_regexcluido<font color="#808080">:=</font><font color="#008080">true</font><font color="#808080">;
  </font><font color="#000080"><b>end</b></font><font color="#808080">;
</font><font color="#000080"><b>end</b></font><font color="#808080">;
-- ----------------------------------------------------------------------------
-- Pesquisa o maior c&oacute;digo num arquivo.
-- sArq - o arquivo
-- nPosChave - a posicao inicial da chave dentro do registro
-- nTamChave - o tamanho da chave dentro do registro
-- nTamLinha - o tamanho do registro
-- retorna - o maior c&oacute;digo
-- ----------------------------------------------------------------------------
</font>pesqmaxcod<font color="#808080">(</font>sarq<font color="#808080">: </font><font color="#0000FF">TEXT_FILE_READ_WRITE</font><font color="#808080">; </font>nposchave<font color="#808080">,
           </font>ntamchave<font color="#808080">, </font>ntamlinha<font color="#808080">: </font><font color="#0000FF">INTEGER</font><font color="#808080">): </font><font color="#0000FF">STRING </font><font color="#000080"><b>is
local
  </b></font>slinha<font color="#808080">, </font>sres<font color="#808080">: </font><font color="#0000FF">STRING</font><font color="#808080">;
  </font>nmaior<font color="#808080">, </font>ncod<font color="#808080">, </font>nposicao<font color="#808080">: </font><font color="#0000FF">INTEGER</font><font color="#808080">;
</font><font color="#000080"><b>do
  </b></font>reconecta<font color="#808080">(</font>sarq<font color="#808080">);
  </font><font color="#000080"><b>from
    </b></font>slinha<font color="#808080">:=</font><font color="#800000">&quot;&quot;</font><font color="#808080">;
    </font>nmaior<font color="#808080">:=</font><font color="#FF0000">0</font><font color="#808080">;
    </font>nposicao<font color="#808080">:=</font><font color="#FF0000">0</font><font color="#808080">;
  </font><font color="#000080"><b>until
    </b></font>sarq.end_of_input
  <font color="#000080"><b>loop
    </b></font>slinha.clear_count<font color="#808080">;
    </font>sarq.read_line_in<font color="#808080">(</font>slinha<font color="#808080">);
    </font><font color="#000080"><b>if </b></font>slinha.is_empty<font color="#808080">=</font><font color="#008080">false </font><font color="#000080"><b>then
      </b></font>sres<font color="#808080">:=</font>trim<font color="#808080">(</font>substr<font color="#808080">(</font>slinha<font color="#808080">,</font>nposchave<font color="#808080">,</font>ntamchave<font color="#808080">));
      </font>ncod<font color="#808080">:=</font>sres.to_integer<font color="#808080">;
      </font><font color="#000080"><b>if </b></font>ncod <font color="#808080">&gt; </font>nmaior <font color="#000080"><b>then
        </b></font>nmaior<font color="#808080">:=</font>ncod<font color="#808080">;
      </font><font color="#000080"><b>end</b></font><font color="#808080">;  
      </font>nposicao<font color="#808080">:=</font>nposicao<font color="#808080">+</font><font color="#FF0000">1</font><font color="#808080">;
    </font><font color="#000080"><b>end</b></font><font color="#808080">;
  </font><font color="#000080"><b>end</b></font><font color="#808080">;  
  </font>pesqlinhaexcluida<font color="#808080">(</font>sarq<font color="#808080">, </font>ntamlinha<font color="#808080">);
  </font><font color="#000080"><b>if </b></font>g_regexcluido<font color="#808080">=</font><font color="#008080">false </font><font color="#000080"><b>then
    </b></font>g_nposreg<font color="#808080">:=</font>nposicao<font color="#808080">+</font><font color="#FF0000">1</font><font color="#808080">;
  </font><font color="#000080"><b>end 
  </b></font>sres<font color="#808080">:=(</font>nmaior<font color="#808080">+</font><font color="#FF0000">1</font><font color="#808080">)</font>.to_string<font color="#808080">;
  </font><font color="#800080">result</font><font color="#808080">:=</font>sres<font color="#808080">;
</font><font color="#000080"><b>end</b></font><font color="#808080">;
-- ----------------------------------------------------------------------------
-- Grava os registros num determinado arquivo.
-- sArq - o arquivo
-- sTexto - o registro a ser gravado
-- sMsgAcerto - a mensagem caso o registro foi gravado
-- sMsgErro - a mensagem caso o registro n&atilde;o foi gravado
-- ----------------------------------------------------------------------------
</font>escrevearq<font color="#808080">(</font>sarq<font color="#808080">: </font><font color="#0000FF">TEXT_FILE_READ_WRITE</font><font color="#808080">; </font>stexto<font color="#808080">, </font>smsgacerto<font color="#808080">, 
           </font>smsgerro<font color="#808080">: </font><font color="#0000FF">STRING</font><font color="#808080">) </font><font color="#000080"><b>is
local
  </b></font>sarqgrava<font color="#808080">: </font><font color="#0000FF">TEXT_FILE_WRITE</font><font color="#808080">;
  </font>slinha<font color="#808080">, </font>snomearq<font color="#808080">, </font>stemparq<font color="#808080">: </font><font color="#0000FF">STRING</font><font color="#808080">;
  </font>nposicao<font color="#808080">: </font><font color="#0000FF">INTEGER</font><font color="#808080">;
</font><font color="#000080"><b>do
  </b></font>reconecta<font color="#808080">(</font>sarq<font color="#808080">);
  </font>stemparq<font color="#808080">:=</font><font color="#800000">&quot;temp.dat&quot;</font><font color="#808080">;
  </font>create sarqgrava.make<font color="#808080">;
  </font>sarqgrava.connect_to<font color="#808080">(</font>stemparq<font color="#808080">);
  </font><font color="#000080"><b>if </b></font>sarqgrava.is_connected <font color="#000080"><b>then
    from
      </b></font>slinha<font color="#808080">:=</font><font color="#800000">&quot;&quot;</font><font color="#808080">;
      </font>nposicao<font color="#808080">:=</font><font color="#FF0000">1</font><font color="#808080">;
    </font><font color="#000080"><b>until
      </b></font>sarq.end_of_input
    <font color="#000080"><b>loop
      if </b></font>g_nposreg<font color="#808080">=</font>nposicao <font color="#000080"><b>then        
        </b></font>sarqgrava.put_string<font color="#808080">(</font>stexto <font color="#808080">+ </font>crlf<font color="#808080">);
        </font>sarq.read_line<font color="#808080">;
      </font><font color="#000080"><b>else      
        </b></font>sarq.read_line<font color="#808080">;
        </font>slinha<font color="#808080">:=</font>sarq.last_string<font color="#808080">;
        </font><font color="#000080"><b>if </b></font>slinha.is_empty<font color="#808080">=</font><font color="#008080">false </font><font color="#000080"><b>then
          </b></font>sarqgrava.put_string<font color="#808080">(</font>slinha <font color="#808080">+ </font>crlf<font color="#808080">);
        </font><font color="#000080"><b>end</b></font><font color="#808080">;
      </font><font color="#000080"><b>end</b></font><font color="#808080">;
      </font>nposicao<font color="#808080">:=</font>nposicao<font color="#808080">+</font><font color="#FF0000">1</font><font color="#808080">;
    </font><font color="#000080"><b>end</b></font><font color="#808080">;
    </font><font color="#000080"><b>if </b></font>g_nposreg<font color="#808080">=</font>nposicao <font color="#000080"><b>then
      </b></font>sarqgrava.put_string<font color="#808080">(</font>stexto <font color="#808080">+ </font>crlf<font color="#808080">);
    </font><font color="#000080"><b>end</b></font><font color="#808080">;
    </font>sarqgrava.disconnect

    snomearq <font color="#808080">:= </font>sarq.path<font color="#808080">;
    </font>sarq.disconnect<font color="#808080">;
    </font><font color="#0000FF">file_tools</font>.delete<font color="#808080">(</font>snomearq<font color="#808080">);
    </font><font color="#0000FF">file_tools</font>.rename_to<font color="#808080">(</font>stemparq<font color="#808080">, </font>snomearq<font color="#808080">);
    </font>sarq.connect_to<font color="#808080">(</font>snomearq<font color="#808080">);

    </font>io.put_string<font color="#808080">(</font>smsgacerto<font color="#808080">);
  </font><font color="#000080"><b>else
    </b></font>io.put_string<font color="#808080">(</font>smsgerro<font color="#808080">);
  </font><font color="#000080"><b>end 
end</b></font><font color="#808080">;
-- ----------------------------------------------------------------------------
-- Monta o tamanho do registro no arquivo de acordo com o tipo de arquivo.
-- sreg - o tipo de arquivo
-- retorna - o registro montado
-- ----------------------------------------------------------------------------
</font>linhareg<font color="#808080">(</font>sreg<font color="#808080">: </font><font color="#0000FF">INTEGER</font><font color="#808080">): </font><font color="#0000FF">STRING </font><font color="#000080"><b>is
local 
  </b></font>slinha<font color="#808080">: </font><font color="#0000FF">STRING</font><font color="#808080">;
</font><font color="#000080"><b>do
</b></font>slinha<font color="#808080">:=</font><font color="#800000">&quot;&quot;</font><font color="#808080">;
</font><font color="#000080"><b>if </b></font>ctarqs.item<font color="#808080">(</font>opassunto<font color="#808080">)=</font>sreg <font color="#000080"><b>then
 </b></font>slinha<font color="#808080">:=</font>esp<font color="#808080">(</font>tassunto.codigo<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">)+</font>esp<font color="#808080">(</font>tassunto.assunto<font color="#808080">,</font><font color="#FF0000">30</font><font color="#808080">)
</font><font color="#000080"><b>elseif </b></font>ctarqs.item<font color="#808080">(</font>opautor<font color="#808080">)=</font>sreg <font color="#000080"><b>then
 </b></font>slinha<font color="#808080">:=</font>esp<font color="#808080">(</font>tautor.codigo<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">)+</font>esp<font color="#808080">(</font>tautor.autor<font color="#808080">,</font><font color="#FF0000">30</font><font color="#808080">)
</font><font color="#000080"><b>elseif </b></font>ctarqs.item<font color="#808080">(</font>opeditora<font color="#808080">)=</font>sreg <font color="#000080"><b>then
 </b></font>slinha<font color="#808080">:=</font>esp<font color="#808080">(</font>teditora.codigo<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">)+</font>esp<font color="#808080">(</font>teditora.editora<font color="#808080">,</font><font color="#FF0000">50</font><font color="#808080">)
</font><font color="#000080"><b>elseif </b></font>ctarqs.item<font color="#808080">(</font>opendereco<font color="#808080">)=</font>sreg <font color="#000080"><b>then
 </b></font>slinha<font color="#808080">:=</font>esp<font color="#808080">(</font>tendereco.codigo<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">)+</font>esp<font color="#808080">(</font>tendereco.logradouro<font color="#808080">,</font><font color="#FF0000">40</font><font color="#808080">)+
 </font>esp<font color="#808080">(</font>tendereco.bairro<font color="#808080">,</font><font color="#FF0000">15</font><font color="#808080">)+</font>esp<font color="#808080">(</font>tendereco.cep<font color="#808080">,</font><font color="#FF0000">8</font><font color="#808080">)+
 </font>esp<font color="#808080">(</font>tendereco.cidade<font color="#808080">,</font><font color="#FF0000">30</font><font color="#808080">)+</font>esp<font color="#808080">(</font>tendereco.estado<font color="#808080">,</font><font color="#FF0000">20</font><font color="#808080">)
</font><font color="#000080"><b>elseif </b></font>ctarqs.item<font color="#808080">(</font>opidioma<font color="#808080">)=</font>sreg <font color="#000080"><b>then
 </b></font>slinha<font color="#808080">:=</font>esp<font color="#808080">(</font>tidioma.codigo<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">)+</font>esp<font color="#808080">(</font>tidioma.idioma<font color="#808080">,</font><font color="#FF0000">20</font><font color="#808080">)
</font><font color="#000080"><b>elseif </b></font>ctarqs.item<font color="#808080">(</font>oppais<font color="#808080">)=</font>sreg <font color="#000080"><b>then
 </b></font>slinha<font color="#808080">:=</font>esp<font color="#808080">(</font>tpais.codigo<font color="#808080">,</font><font color="#FF0000">3</font><font color="#808080">)+</font>esp<font color="#808080">(</font>tpais.pais<font color="#808080">,</font><font color="#FF0000">50</font><font color="#808080">)
</font><font color="#000080"><b>elseif </b></font>ctarqs.item<font color="#808080">(</font>opprofissao<font color="#808080">)=</font>sreg <font color="#000080"><b>then
 </b></font>slinha<font color="#808080">:=</font>esp<font color="#808080">(</font>tprofissao.codigo<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">)+</font>esp<font color="#808080">(</font>tprofissao.profissao<font color="#808080">,</font><font color="#FF0000">50</font><font color="#808080">)
</font><font color="#000080"><b>elseif </b></font>ctarqs.item<font color="#808080">(</font>opusuario<font color="#808080">)=</font>sreg <font color="#000080"><b>then
 </b></font>slinha<font color="#808080">:=</font>esp<font color="#808080">(</font>tusuario.login<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">)+</font>esp<font color="#808080">(</font>tusuario.senha<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">)
</font><font color="#000080"><b>elseif </b></font>ctarqs.item<font color="#808080">(</font>oplivro<font color="#808080">)=</font>sreg <font color="#000080"><b>then
 </b></font>slinha<font color="#808080">:=</font>esp<font color="#808080">(</font>tlivro.isbn<font color="#808080">,</font><font color="#FF0000">13</font><font color="#808080">)+</font>esp<font color="#808080">(</font>tlivro.titulo<font color="#808080">,</font><font color="#FF0000">50</font><font color="#808080">)+
 </font>esp<font color="#808080">(</font>tlivro.edicao<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">)+</font>esp<font color="#808080">(</font>tlivro.anopubli<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">)+
 </font>esp<font color="#808080">(</font>tlivro.codeditora<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">)+</font>esp<font color="#808080">(</font>tlivro.volume<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">)+
 </font>esp<font color="#808080">(</font>tlivro.codidioma<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">)+</font>esp<font color="#808080">(</font>tlivro.npaginas<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">)+
 </font>esp<font color="#808080">(</font>tlivro.preco<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">)+</font>esp<font color="#808080">(</font>tlivro.qtdestoque<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">)
</font><font color="#000080"><b>elseif </b></font>ctarqs.item<font color="#808080">(</font>oplivroass<font color="#808080">)=</font>sreg <font color="#000080"><b>then
 </b></font>slinha<font color="#808080">:=</font>esp<font color="#808080">(</font>tlivroass.isbn<font color="#808080">,</font><font color="#FF0000">13</font><font color="#808080">)+</font>esp<font color="#808080">(</font>tlivroass.codassunto<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">)
</font><font color="#000080"><b>elseif </b></font>ctarqs.item<font color="#808080">(</font>oplivroaut<font color="#808080">)=</font>sreg <font color="#000080"><b>then
 </b></font>slinha<font color="#808080">:=</font>esp<font color="#808080">(</font>tlivroaut.isbn<font color="#808080">,</font><font color="#FF0000">13</font><font color="#808080">)+</font>esp<font color="#808080">(</font>tlivroaut.codautor<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">)
</font><font color="#000080"><b>elseif </b></font>ctarqs.item<font color="#808080">(</font>opcliente<font color="#808080">)=</font>sreg <font color="#000080"><b>then
 </b></font>slinha<font color="#808080">:=</font>esp<font color="#808080">(</font>tcliente.cpf<font color="#808080">,</font><font color="#FF0000">14</font><font color="#808080">)+</font>esp<font color="#808080">(</font>tcliente.nome<font color="#808080">,</font><font color="#FF0000">30</font><font color="#808080">)+
 </font>esp<font color="#808080">(</font>tcliente.email<font color="#808080">,</font><font color="#FF0000">30</font><font color="#808080">)+</font>esp<font color="#808080">(</font>tcliente.identidade<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">)+
 </font>esp<font color="#808080">(</font>tcliente.sexo<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">)+</font>esp<font color="#808080">(</font>tcliente.telefone<font color="#808080">,</font><font color="#FF0000">17</font><font color="#808080">)+
 </font>esp<font color="#808080">(</font>tcliente.dtnascimento<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">)+</font>esp<font color="#808080">(</font>tcliente.codendereco<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">)+
 </font>esp<font color="#808080">(</font>tcliente.codpais<font color="#808080">,</font><font color="#FF0000">3</font><font color="#808080">)+</font>esp<font color="#808080">(</font>tcliente.codprofissao<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">)
</font><font color="#000080"><b>elseif </b></font>ctarqs.item<font color="#808080">(</font>opvenda<font color="#808080">)=</font>sreg <font color="#000080"><b>then
 </b></font>slinha<font color="#808080">:=</font>esp<font color="#808080">(</font>tvenda.dthrvenda<font color="#808080">,</font><font color="#FF0000">19</font><font color="#808080">)+</font>esp<font color="#808080">(</font>tvenda.cpf<font color="#808080">,</font><font color="#FF0000">14</font><font color="#808080">)+
 </font>esp<font color="#808080">(</font>tvenda.isbn<font color="#808080">,</font><font color="#FF0000">13</font><font color="#808080">)+</font>esp<font color="#808080">(</font>tvenda.precovenda<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">);
</font><font color="#000080"><b>end</b></font><font color="#808080">;
</font><font color="#800080">result</font><font color="#808080">:=</font>slinha<font color="#808080">;
</font><font color="#000080"><b>end</b></font><font color="#808080">;
-- ----------------------------------------------------------------------------
-- retorna o tamanho do registro no arquivo de acordo com o tipo de arquivo.
-- sreg - o tipo de arquivo
-- retorna - o tamanho do registro
-- ----------------------------------------------------------------------------
</font>tamreg<font color="#808080">(</font>sreg<font color="#808080">: </font><font color="#0000FF">INTEGER</font><font color="#808080">): </font><font color="#0000FF">INTEGER </font><font color="#000080"><b>is
local
  </b></font>nret<font color="#808080">: </font><font color="#0000FF">INTEGER</font><font color="#808080">;
</font><font color="#000080"><b>do
  </b></font>nret<font color="#808080">:=</font><font color="#FF0000">0</font><font color="#808080">;
  </font><font color="#000080"><b>if </b></font>ctarqs.item<font color="#808080">(</font>opassunto<font color="#808080">)=</font>sreg <font color="#000080"><b>then </b></font>nret<font color="#808080">:=</font>tam_assunto
  <font color="#000080"><b>elseif </b></font>ctarqs.item<font color="#808080">(</font>opautor<font color="#808080">)=</font>sreg <font color="#000080"><b>then </b></font>nret<font color="#808080">:=</font>tam_autor
  <font color="#000080"><b>elseif </b></font>ctarqs.item<font color="#808080">(</font>opeditora<font color="#808080">)=</font>sreg <font color="#000080"><b>then </b></font>nret<font color="#808080">:=</font>tam_editora
  <font color="#000080"><b>elseif </b></font>ctarqs.item<font color="#808080">(</font>opendereco<font color="#808080">)=</font>sreg <font color="#000080"><b>then </b></font>nret<font color="#808080">:=</font>tam_endereco
  <font color="#000080"><b>elseif </b></font>ctarqs.item<font color="#808080">(</font>opidioma<font color="#808080">)=</font>sreg <font color="#000080"><b>then </b></font>nret<font color="#808080">:=</font>tam_idioma
  <font color="#000080"><b>elseif </b></font>ctarqs.item<font color="#808080">(</font>oppais<font color="#808080">)=</font>sreg <font color="#000080"><b>then </b></font>nret<font color="#808080">:=</font>tam_pais
  <font color="#000080"><b>elseif </b></font>ctarqs.item<font color="#808080">(</font>opprofissao<font color="#808080">)=</font>sreg <font color="#000080"><b>then </b></font>nret<font color="#808080">:=</font>tam_profissao
  <font color="#000080"><b>elseif </b></font>ctarqs.item<font color="#808080">(</font>opusuario<font color="#808080">)=</font>sreg <font color="#000080"><b>then </b></font>nret<font color="#808080">:=</font>tam_usuario
  <font color="#000080"><b>elseif </b></font>ctarqs.item<font color="#808080">(</font>oplivro<font color="#808080">)=</font>sreg <font color="#000080"><b>then </b></font>nret<font color="#808080">:=</font>tam_livro
  <font color="#000080"><b>elseif </b></font>ctarqs.item<font color="#808080">(</font>oplivroass<font color="#808080">)=</font>sreg <font color="#000080"><b>then </b></font>nret<font color="#808080">:=</font>tam_livass
  <font color="#000080"><b>elseif </b></font>ctarqs.item<font color="#808080">(</font>oplivroaut<font color="#808080">)=</font>sreg <font color="#000080"><b>then </b></font>nret<font color="#808080">:=</font>tam_livaut
  <font color="#000080"><b>elseif </b></font>ctarqs.item<font color="#808080">(</font>opcliente<font color="#808080">)=</font>sreg <font color="#000080"><b>then </b></font>nret<font color="#808080">:=</font>tam_cliente
  <font color="#000080"><b>elseif </b></font>ctarqs.item<font color="#808080">(</font>opvenda<font color="#808080">)=</font>sreg <font color="#000080"><b>then </b></font>nret<font color="#808080">:=</font>tam_venda<font color="#808080">;
  </font><font color="#000080"><b>end</b></font><font color="#808080">;
  </font><font color="#800080">result</font><font color="#808080">:=</font>nret<font color="#808080">;
</font><font color="#000080"><b>end</b></font><font color="#808080">;
-- ----------------------------------------------------------------------------
-- seleciona o rotulo de cada campo de acordo com o tipo de arquivo.
-- sreg - o tipo de arquivo
-- nnum - indica qual rotulo ser&aacute; retornado
-- retorna - o rotulo
-- ----------------------------------------------------------------------------
</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">: </font><font color="#0000FF">INTEGER</font><font color="#808080">; </font>nnum<font color="#808080">: </font><font color="#0000FF">INTEGER</font><font color="#808080">): </font><font color="#0000FF">STRING </font><font color="#000080"><b>is
local
  </b></font>sret<font color="#808080">: </font><font color="#0000FF">STRING</font><font color="#808080">;
</font><font color="#000080"><b>do
</b></font>sret<font color="#808080">:=</font><font color="#800000">&quot;&quot;</font><font color="#808080">;
</font><font color="#000080"><b>if </b></font>ctarqs.item<font color="#808080">(</font>opassunto<font color="#808080">)=</font>sreg <font color="#000080"><b>then 
   inspect </b></font>nnum
     <font color="#000080"><b>when </b></font><font color="#FF0000">0 </font><font color="#000080"><b>then </b></font>sret<font color="#808080">:=</font><font color="#800000">&quot;Assunto(s) n&atilde;o encontrado(s)!%N&quot;</font><font color="#808080">;
     </font><font color="#000080"><b>when </b></font><font color="#FF0000">1 </font><font color="#000080"><b>then
         </b></font>sret<font color="#808080">:=</font><font color="#800000">&quot;C&oacute;digo do assunto: &quot;</font><font color="#808080">;
         </font>g_nposchave<font color="#808080">:=</font><font color="#FF0000">1</font><font color="#808080">;
         </font>g_ntamchave<font color="#808080">:=</font><font color="#FF0000">10</font><font color="#808080">;
     </font><font color="#000080"><b>when </b></font><font color="#FF0000">2 </font><font color="#000080"><b>then
         </b></font>sret<font color="#808080">:=</font><font color="#800000">&quot;Assunto: &quot;</font><font color="#808080">;
         </font>g_nposchave<font color="#808080">:=</font><font color="#FF0000">11</font><font color="#808080">;
         </font>g_ntamchave<font color="#808080">:=</font><font color="#FF0000">30</font><font color="#808080">;
   </font><font color="#000080"><b>end</b></font><font color="#808080">;
</font><font color="#000080"><b>elseif </b></font>ctarqs.item<font color="#808080">(</font>opautor<font color="#808080">)=</font>sreg <font color="#000080"><b>then
   inspect </b></font>nnum
     <font color="#000080"><b>when </b></font><font color="#FF0000">0 </font><font color="#000080"><b>then </b></font>sret<font color="#808080">:=</font><font color="#800000">&quot;Autor(es) n&atilde;o encontrado(s)!%N&quot;</font><font color="#808080">;
     </font><font color="#000080"><b>when </b></font><font color="#FF0000">1 </font><font color="#000080"><b>then
         </b></font>sret<font color="#808080">:=</font><font color="#800000">&quot;C&oacute;digo do autor: &quot;</font><font color="#808080">;
         </font>g_nposchave<font color="#808080">:=</font><font color="#FF0000">1</font><font color="#808080">;
         </font>g_ntamchave<font color="#808080">:=</font><font color="#FF0000">10</font><font color="#808080">;

     </font><font color="#000080"><b>when </b></font><font color="#FF0000">2 </font><font color="#000080"><b>then
         </b></font>sret<font color="#808080">:=</font><font color="#800000">&quot;Autor: &quot;</font><font color="#808080">;
         </font>g_nposchave<font color="#808080">:=</font><font color="#FF0000">11</font><font color="#808080">;
         </font>g_ntamchave<font color="#808080">:=</font><font color="#FF0000">30</font><font color="#808080">;
   </font><font color="#000080"><b>end</b></font><font color="#808080">;
</font><font color="#000080"><b>elseif </b></font>ctarqs.item<font color="#808080">(</font>opeditora<font color="#808080">)=</font>sreg <font color="#000080"><b>then
   inspect </b></font>nnum
     <font color="#000080"><b>when </b></font><font color="#FF0000">0 </font><font color="#000080"><b>then </b></font>sret<font color="#808080">:=</font><font color="#800000">&quot;Editora(s) n&atilde;o encontrada(s)!%N&quot;</font><font color="#808080">;
     </font><font color="#000080"><b>when </b></font><font color="#FF0000">1 </font><font color="#000080"><b>then
         </b></font>sret<font color="#808080">:=</font><font color="#800000">&quot;C&oacute;digo da editora: &quot;</font><font color="#808080">;
         </font>g_nposchave<font color="#808080">:=</font><font color="#FF0000">1</font><font color="#808080">;
         </font>g_ntamchave<font color="#808080">:=</font><font color="#FF0000">10</font><font color="#808080">;
     </font><font color="#000080"><b>when </b></font><font color="#FF0000">2 </font><font color="#000080"><b>then
         </b></font>sret<font color="#808080">:=</font><font color="#800000">&quot;Editora: &quot;</font><font color="#808080">;
         </font>g_nposchave<font color="#808080">:=</font><font color="#FF0000">11</font><font color="#808080">;
         </font>g_ntamchave<font color="#808080">:=</font><font color="#FF0000">50</font><font color="#808080">;
   </font><font color="#000080"><b>end</b></font><font color="#808080">;
</font><font color="#000080"><b>elseif </b></font>ctarqs.item<font color="#808080">(</font>opendereco<font color="#808080">)=</font>sreg <font color="#000080"><b>then
   inspect </b></font>nnum
     <font color="#000080"><b>when </b></font><font color="#FF0000">0 </font><font color="#000080"><b>then </b></font>sret<font color="#808080">:=</font><font color="#800000">&quot;Endere&ccedil;o(s) n&atilde;o encontrado(s)!%N&quot;</font><font color="#808080">;
     </font><font color="#000080"><b>when </b></font><font color="#FF0000">1 </font><font color="#000080"><b>then
         </b></font>sret<font color="#808080">:=</font><font color="#800000">&quot;C&oacute;digo do endere&ccedil;o: &quot;</font><font color="#808080">;
         </font>g_nposchave<font color="#808080">:=</font><font color="#FF0000">1</font><font color="#808080">;
         </font>g_ntamchave<font color="#808080">:=</font><font color="#FF0000">10</font><font color="#808080">;
     </font><font color="#000080"><b>when </b></font><font color="#FF0000">2 </font><font color="#000080"><b>then
         </b></font>sret<font color="#808080">:=</font><font color="#800000">&quot;Logradouro: &quot;</font><font color="#808080">;
         </font>g_nposchave<font color="#808080">:=</font><font color="#FF0000">11</font><font color="#808080">;
         </font>g_ntamchave<font color="#808080">:=</font><font color="#FF0000">40</font><font color="#808080">;
     </font><font color="#000080"><b>when </b></font><font color="#FF0000">3 </font><font color="#000080"><b>then
         </b></font>sret<font color="#808080">:=</font><font color="#800000">&quot;Bairro: &quot;</font><font color="#808080">;
         </font>g_nposchave<font color="#808080">:=</font><font color="#FF0000">51</font><font color="#808080">;
         </font>g_ntamchave<font color="#808080">:=</font><font color="#FF0000">15</font><font color="#808080">;
     </font><font color="#000080"><b>when </b></font><font color="#FF0000">4 </font><font color="#000080"><b>then
         </b></font>sret<font color="#808080">:=</font><font color="#800000">&quot;CEP: &quot;</font><font color="#808080">;
         </font>g_nposchave<font color="#808080">:=</font><font color="#FF0000">66</font><font color="#808080">;
         </font>g_ntamchave<font color="#808080">:=</font><font color="#FF0000">8</font><font color="#808080">;
     </font><font color="#000080"><b>when </b></font><font color="#FF0000">5 </font><font color="#000080"><b>then
         </b></font>sret<font color="#808080">:=</font><font color="#800000">&quot;Cidade: &quot;</font><font color="#808080">;
         </font>g_nposchave<font color="#808080">:=</font><font color="#FF0000">74</font><font color="#808080">;
         </font>g_ntamchave<font color="#808080">:=</font><font color="#FF0000">30</font><font color="#808080">;
     </font><font color="#000080"><b>when </b></font><font color="#FF0000">6 </font><font color="#000080"><b>then
         </b></font>sret<font color="#808080">:=</font><font color="#800000">&quot;Estado: &quot;</font><font color="#808080">;
         </font>g_nposchave<font color="#808080">:=</font><font color="#FF0000">104</font><font color="#808080">;
         </font>g_ntamchave<font color="#808080">:=</font><font color="#FF0000">20</font><font color="#808080">;
   </font><font color="#000080"><b>end</b></font><font color="#808080">;
</font><font color="#000080"><b>elseif </b></font>ctarqs.item<font color="#808080">(</font>opidioma<font color="#808080">)=</font>sreg <font color="#000080"><b>then
   inspect </b></font>nnum
     <font color="#000080"><b>when </b></font><font color="#FF0000">0 </font><font color="#000080"><b>then </b></font>sret<font color="#808080">:=</font><font color="#800000">&quot;Idioma(s) n&atilde;o encontrado(s)!%N&quot;</font><font color="#808080">;
     </font><font color="#000080"><b>when </b></font><font color="#FF0000">1 </font><font color="#000080"><b>then
         </b></font>sret<font color="#808080">:=</font><font color="#800000">&quot;C&oacute;digo do idioma: &quot;</font><font color="#808080">;
         </font>g_nposchave<font color="#808080">:=</font><font color="#FF0000">1</font><font color="#808080">;
         </font>g_ntamchave<font color="#808080">:=</font><font color="#FF0000">10</font><font color="#808080">;
     </font><font color="#000080"><b>when </b></font><font color="#FF0000">2 </font><font color="#000080"><b>then
         </b></font>sret<font color="#808080">:=</font><font color="#800000">&quot;Idioma: &quot;</font><font color="#808080">;
         </font>g_nposchave<font color="#808080">:=</font><font color="#FF0000">11</font><font color="#808080">;
         </font>g_ntamchave<font color="#808080">:=</font><font color="#FF0000">20</font><font color="#808080">;
   </font><font color="#000080"><b>end</b></font><font color="#808080">;
</font><font color="#000080"><b>elseif </b></font>ctarqs.item<font color="#808080">(</font>oppais<font color="#808080">)=</font>sreg <font color="#000080"><b>then
   inspect </b></font>nnum
     <font color="#000080"><b>when </b></font><font color="#FF0000">0 </font><font color="#000080"><b>then </b></font>sret<font color="#808080">:=</font><font color="#800000">&quot;Pa&iacute;s(es) n&atilde;o encontrado(s)!%N&quot;</font><font color="#808080">;
     </font><font color="#000080"><b>when </b></font><font color="#FF0000">1 </font><font color="#000080"><b>then
         </b></font>sret<font color="#808080">:=</font><font color="#800000">&quot;C&oacute;digo do pa&iacute;s: &quot;</font><font color="#808080">;
         </font>g_nposchave<font color="#808080">:=</font><font color="#FF0000">1</font><font color="#808080">;
         </font>g_ntamchave<font color="#808080">:=</font><font color="#FF0000">3</font><font color="#808080">;
     </font><font color="#000080"><b>when </b></font><font color="#FF0000">2 </font><font color="#000080"><b>then
         </b></font>sret<font color="#808080">:=</font><font color="#800000">&quot;Pa&iacute;s: &quot;</font><font color="#808080">;
         </font>g_nposchave<font color="#808080">:=</font><font color="#FF0000">4</font><font color="#808080">;
         </font>g_ntamchave<font color="#808080">:=</font><font color="#FF0000">50</font><font color="#808080">;
   </font><font color="#000080"><b>end</b></font><font color="#808080">;
</font><font color="#000080"><b>elseif </b></font>ctarqs.item<font color="#808080">(</font>opprofissao<font color="#808080">)=</font>sreg <font color="#000080"><b>then
   inspect </b></font>nnum
     <font color="#000080"><b>when </b></font><font color="#FF0000">0 </font><font color="#000080"><b>then </b></font>sret<font color="#808080">:=</font><font color="#800000">&quot;Profiss&atilde;o(es) n&atilde;o encontrada(s)!%N&quot;</font><font color="#808080">;
     </font><font color="#000080"><b>when </b></font><font color="#FF0000">1 </font><font color="#000080"><b>then
         </b></font>sret<font color="#808080">:=</font><font color="#800000">&quot;C&oacute;digo da profiss&atilde;o: &quot;</font><font color="#808080">;
         </font>g_nposchave<font color="#808080">:=</font><font color="#FF0000">1</font><font color="#808080">;
         </font>g_ntamchave<font color="#808080">:=</font><font color="#FF0000">10</font><font color="#808080">;
     </font><font color="#000080"><b>when </b></font><font color="#FF0000">2 </font><font color="#000080"><b>then
         </b></font>sret<font color="#808080">:=</font><font color="#800000">&quot;Profiss&atilde;o: &quot;</font><font color="#808080">;
         </font>g_nposchave<font color="#808080">:=</font><font color="#FF0000">11</font><font color="#808080">;
         </font>g_ntamchave<font color="#808080">:=</font><font color="#FF0000">50</font><font color="#808080">;
   </font><font color="#000080"><b>end</b></font><font color="#808080">;
</font><font color="#000080"><b>elseif </b></font>ctarqs.item<font color="#808080">(</font>opusuario<font color="#808080">)=</font>sreg <font color="#000080"><b>then
   inspect </b></font>nnum
     <font color="#000080"><b>when </b></font><font color="#FF0000">0 </font><font color="#000080"><b>then </b></font>sret<font color="#808080">:=</font><font color="#800000">&quot;login ou senha incorreta, tente de novo!%N&quot;</font><font color="#808080">;
     </font><font color="#000080"><b>when </b></font><font color="#FF0000">1 </font><font color="#000080"><b>then
         </b></font>sret<font color="#808080">:=</font><font color="#800000">&quot;Login: &quot;</font><font color="#808080">;
         </font>g_nposchave<font color="#808080">:=</font><font color="#FF0000">1</font><font color="#808080">;
         </font>g_ntamchave<font color="#808080">:=</font><font color="#FF0000">10</font><font color="#808080">;
     </font><font color="#000080"><b>when </b></font><font color="#FF0000">2 </font><font color="#000080"><b>then
         </b></font>sret<font color="#808080">:=</font><font color="#800000">&quot;Senha: &quot;</font><font color="#808080">;
         </font>g_nposchave<font color="#808080">:=</font><font color="#FF0000">11</font><font color="#808080">;
         </font>g_ntamchave<font color="#808080">:=</font><font color="#FF0000">10</font><font color="#808080">;
   </font><font color="#000080"><b>end</b></font><font color="#808080">;
</font><font color="#000080"><b>elseif </b></font>ctarqs.item<font color="#808080">(</font>oplivro<font color="#808080">)=</font>sreg <font color="#000080"><b>then
   inspect </b></font>nnum
     <font color="#000080"><b>when </b></font><font color="#FF0000">0 </font><font color="#000080"><b>then </b></font>sret<font color="#808080">:=</font><font color="#800000">&quot;Livro(s) n&atilde;o encontrado(s)!%N&quot;</font><font color="#808080">;
     </font><font color="#000080"><b>when </b></font><font color="#FF0000">1 </font><font color="#000080"><b>then
         </b></font>sret<font color="#808080">:=</font><font color="#800000">&quot;ISBN: &quot;</font><font color="#808080">;
         </font>g_nposchave<font color="#808080">:=</font><font color="#FF0000">1</font><font color="#808080">;
         </font>g_ntamchave<font color="#808080">:=</font><font color="#FF0000">13</font><font color="#808080">;
     </font><font color="#000080"><b>when </b></font><font color="#FF0000">2 </font><font color="#000080"><b>then
         </b></font>sret<font color="#808080">:=</font><font color="#800000">&quot;T&iacute;tulo: &quot;</font><font color="#808080">;
         </font>g_nposchave<font color="#808080">:=</font><font color="#FF0000">14</font><font color="#808080">;
         </font>g_ntamchave<font color="#808080">:=</font><font color="#FF0000">50</font><font color="#808080">;
     </font><font color="#000080"><b>when </b></font><font color="#FF0000">3 </font><font color="#000080"><b>then
         </b></font>sret<font color="#808080">:=</font><font color="#800000">&quot;Edi&ccedil;&atilde;o: &quot;</font><font color="#808080">;
         </font>g_nposchave<font color="#808080">:=</font><font color="#FF0000">64</font><font color="#808080">;
         </font>g_ntamchave<font color="#808080">:=</font><font color="#FF0000">10</font><font color="#808080">;
     </font><font color="#000080"><b>when </b></font><font color="#FF0000">4 </font><font color="#000080"><b>then
         </b></font>sret<font color="#808080">:=</font><font color="#800000">&quot;Ano de Publica&ccedil;&atilde;o: &quot;</font><font color="#808080">;
         </font>g_nposchave<font color="#808080">:=</font><font color="#FF0000">74</font><font color="#808080">;
         </font>g_ntamchave<font color="#808080">:=</font><font color="#FF0000">10</font><font color="#808080">;
     </font><font color="#000080"><b>when </b></font><font color="#FF0000">5 </font><font color="#000080"><b>then
         </b></font>sret<font color="#808080">:=</font><font color="#800000">&quot;C&oacute;digo da editora: &quot;</font><font color="#808080">;
         </font>g_nposchave<font color="#808080">:=</font><font color="#FF0000">84</font><font color="#808080">;
         </font>g_ntamchave<font color="#808080">:=</font><font color="#FF0000">10</font><font color="#808080">;
     </font><font color="#000080"><b>when </b></font><font color="#FF0000">6 </font><font color="#000080"><b>then
         </b></font>sret<font color="#808080">:=</font><font color="#800000">&quot;Volume: &quot;</font><font color="#808080">;
         </font>g_nposchave<font color="#808080">:=</font><font color="#FF0000">94</font><font color="#808080">;
         </font>g_ntamchave<font color="#808080">:=</font><font color="#FF0000">10</font><font color="#808080">;
     </font><font color="#000080"><b>when </b></font><font color="#FF0000">7 </font><font color="#000080"><b>then
         </b></font>sret<font color="#808080">:=</font><font color="#800000">&quot;C&oacute;digo do idioma: &quot;</font><font color="#808080">;
         </font>g_nposchave<font color="#808080">:=</font><font color="#FF0000">104</font><font color="#808080">;
         </font>g_ntamchave<font color="#808080">:=</font><font color="#FF0000">10</font><font color="#808080">;
     </font><font color="#000080"><b>when </b></font><font color="#FF0000">8 </font><font color="#000080"><b>then
         </b></font>sret<font color="#808080">:=</font><font color="#800000">&quot;N&uacute;mero de p&aacute;ginas: &quot;</font><font color="#808080">;
         </font>g_nposchave<font color="#808080">:=</font><font color="#FF0000">114</font><font color="#808080">;
         </font>g_ntamchave<font color="#808080">:=</font><font color="#FF0000">10</font><font color="#808080">;
     </font><font color="#000080"><b>when </b></font><font color="#FF0000">9 </font><font color="#000080"><b>then
         </b></font>sret<font color="#808080">:=</font><font color="#800000">&quot;Pre&ccedil;o: &quot;</font><font color="#808080">;
         </font>g_nposchave<font color="#808080">:=</font><font color="#FF0000">124</font><font color="#808080">;
         </font>g_ntamchave<font color="#808080">:=</font><font color="#FF0000">10</font><font color="#808080">;
     </font><font color="#000080"><b>when </b></font><font color="#FF0000">10 </font><font color="#000080"><b>then
          </b></font>sret<font color="#808080">:=</font><font color="#800000">&quot;Qtd. Estoque: &quot;</font><font color="#808080">;
          </font>g_nposchave<font color="#808080">:=</font><font color="#FF0000">134</font><font color="#808080">;
          </font>g_ntamchave<font color="#808080">:=</font><font color="#FF0000">10</font><font color="#808080">;
   </font><font color="#000080"><b>end</b></font><font color="#808080">;
</font><font color="#000080"><b>elseif </b></font>ctarqs.item<font color="#808080">(</font>oplivroass<font color="#808080">)=</font>sreg <font color="#000080"><b>then
   inspect </b></font>nnum
     <font color="#000080"><b>when </b></font><font color="#FF0000">0 </font><font color="#000080"><b>then </b></font>sret<font color="#808080">:=</font><font color="#800000">&quot;Assunto(s) n&atilde;o encontrado(s)!%N&quot;</font><font color="#808080">;
     </font><font color="#000080"><b>when </b></font><font color="#FF0000">1 </font><font color="#000080"><b>then
         </b></font>sret<font color="#808080">:=</font><font color="#800000">&quot;ISBN: &quot;</font><font color="#808080">;
         </font>g_nposchave<font color="#808080">:=</font><font color="#FF0000">1</font><font color="#808080">;
         </font>g_ntamchave<font color="#808080">:=</font><font color="#FF0000">13</font><font color="#808080">;
     </font><font color="#000080"><b>when </b></font><font color="#FF0000">2 </font><font color="#000080"><b>then
         </b></font>sret<font color="#808080">:=</font><font color="#800000">&quot;C&oacute;digo do assunto: &quot;</font><font color="#808080">;
         </font>g_nposchave<font color="#808080">:=</font><font color="#FF0000">14</font><font color="#808080">;
         </font>g_ntamchave<font color="#808080">:=</font><font color="#FF0000">10</font><font color="#808080">;
   </font><font color="#000080"><b>end</b></font><font color="#808080">;
</font><font color="#000080"><b>elseif </b></font>ctarqs.item<font color="#808080">(</font>oplivroaut<font color="#808080">)=</font>sreg <font color="#000080"><b>then
   inspect </b></font>nnum
     <font color="#000080"><b>when </b></font><font color="#FF0000">0 </font><font color="#000080"><b>then </b></font>sret<font color="#808080">:=</font><font color="#800000">&quot;Autor(s) n&atilde;o encontrado(s)!%N&quot;</font><font color="#808080">;
     </font><font color="#000080"><b>when </b></font><font color="#FF0000">1 </font><font color="#000080"><b>then
         </b></font>sret<font color="#808080">:=</font><font color="#800000">&quot;ISBN: &quot;</font><font color="#808080">;
         </font>g_nposchave<font color="#808080">:=</font><font color="#FF0000">1</font><font color="#808080">;
         </font>g_ntamchave<font color="#808080">:=</font><font color="#FF0000">13</font><font color="#808080">;
     </font><font color="#000080"><b>when </b></font><font color="#FF0000">2 </font><font color="#000080"><b>then
         </b></font>sret<font color="#808080">:=</font><font color="#800000">&quot;C&oacute;digo do autor: &quot;</font><font color="#808080">;
         </font>g_nposchave<font color="#808080">:=</font><font color="#FF0000">14</font><font color="#808080">;
         </font>g_ntamchave<font color="#808080">:=</font><font color="#FF0000">10</font><font color="#808080">;
   </font><font color="#000080"><b>end</b></font><font color="#808080">;
</font><font color="#000080"><b>elseif </b></font>ctarqs.item<font color="#808080">(</font>opcliente<font color="#808080">)=</font>sreg <font color="#000080"><b>then
   inspect </b></font>nnum
     <font color="#000080"><b>when </b></font><font color="#FF0000">0 </font><font color="#000080"><b>then </b></font>sret<font color="#808080">:=</font><font color="#800000">&quot;Cliente(s) n&atilde;o encontrado(s)!%N&quot;</font><font color="#808080">;
     </font><font color="#000080"><b>when </b></font><font color="#FF0000">1 </font><font color="#000080"><b>then
         </b></font>sret<font color="#808080">:=</font><font color="#800000">&quot;CPF: &quot;</font><font color="#808080">;
         </font>g_nposchave<font color="#808080">:=</font><font color="#FF0000">1</font><font color="#808080">;
         </font>g_ntamchave<font color="#808080">:=</font><font color="#FF0000">14</font><font color="#808080">;
     </font><font color="#000080"><b>when </b></font><font color="#FF0000">2 </font><font color="#000080"><b>then
         </b></font>sret<font color="#808080">:=</font><font color="#800000">&quot;Nome: &quot;</font><font color="#808080">;
         </font>g_nposchave<font color="#808080">:=</font><font color="#FF0000">15</font><font color="#808080">;
         </font>g_ntamchave<font color="#808080">:=</font><font color="#FF0000">30</font><font color="#808080">;
     </font><font color="#000080"><b>when </b></font><font color="#FF0000">3 </font><font color="#000080"><b>then
         </b></font>sret<font color="#808080">:=</font><font color="#800000">&quot;E-mail: &quot;</font><font color="#808080">;
         </font>g_nposchave<font color="#808080">:=</font><font color="#FF0000">45</font><font color="#808080">;
         </font>g_ntamchave<font color="#808080">:=</font><font color="#FF0000">30</font><font color="#808080">;
     </font><font color="#000080"><b>when </b></font><font color="#FF0000">4 </font><font color="#000080"><b>then
         </b></font>sret<font color="#808080">:=</font><font color="#800000">&quot;Identidade: &quot;</font><font color="#808080">;
         </font>g_nposchave<font color="#808080">:=</font><font color="#FF0000">75</font><font color="#808080">;
         </font>g_ntamchave<font color="#808080">:=</font><font color="#FF0000">10</font><font color="#808080">;
     </font><font color="#000080"><b>when </b></font><font color="#FF0000">5 </font><font color="#000080"><b>then
         </b></font>sret<font color="#808080">:=</font><font color="#800000">&quot;Sexo: &quot;</font><font color="#808080">;
         </font>g_nposchave<font color="#808080">:=</font><font color="#FF0000">85</font><font color="#808080">;
         </font>g_ntamchave<font color="#808080">:=</font><font color="#FF0000">1</font><font color="#808080">;
     </font><font color="#000080"><b>when </b></font><font color="#FF0000">6 </font><font color="#000080"><b>then
         </b></font>sret<font color="#808080">:=</font><font color="#800000">&quot;Telefone: &quot;</font><font color="#808080">;
         </font>g_nposchave<font color="#808080">:=</font><font color="#FF0000">86</font><font color="#808080">;
         </font>g_ntamchave<font color="#808080">:=</font><font color="#FF0000">17</font><font color="#808080">;
     </font><font color="#000080"><b>when </b></font><font color="#FF0000">7 </font><font color="#000080"><b>then
         </b></font>sret<font color="#808080">:=</font><font color="#800000">&quot;Dt. Nascimento: &quot;</font><font color="#808080">;
         </font>g_nposchave<font color="#808080">:=</font><font color="#FF0000">103</font><font color="#808080">;
         </font>g_ntamchave<font color="#808080">:=</font><font color="#FF0000">10</font><font color="#808080">;
     </font><font color="#000080"><b>when </b></font><font color="#FF0000">8 </font><font color="#000080"><b>then
         </b></font>sret<font color="#808080">:=</font><font color="#800000">&quot;C&oacute;digo do endere&ccedil;o: &quot;</font><font color="#808080">;
         </font>g_nposchave<font color="#808080">:=</font><font color="#FF0000">113</font><font color="#808080">;
         </font>g_ntamchave<font color="#808080">:=</font><font color="#FF0000">10</font><font color="#808080">;
     </font><font color="#000080"><b>when </b></font><font color="#FF0000">9 </font><font color="#000080"><b>then
         </b></font>sret<font color="#808080">:=</font><font color="#800000">&quot;C&oacute;digo do pa&iacute;s: &quot;</font><font color="#808080">;
         </font>g_nposchave<font color="#808080">:=</font><font color="#FF0000">123</font><font color="#808080">;
         </font>g_ntamchave<font color="#808080">:=</font><font color="#FF0000">3</font><font color="#808080">;
     </font><font color="#000080"><b>when </b></font><font color="#FF0000">10 </font><font color="#000080"><b>then
          </b></font>sret<font color="#808080">:=</font><font color="#800000">&quot;C&oacute;digo da Profiss&atilde;o: &quot;</font><font color="#808080">;
          </font>g_nposchave<font color="#808080">:=</font><font color="#FF0000">126</font><font color="#808080">;
          </font>g_ntamchave<font color="#808080">:=</font><font color="#FF0000">10</font><font color="#808080">;
   </font><font color="#000080"><b>end</b></font><font color="#808080">;
</font><font color="#000080"><b>elseif </b></font>ctarqs.item<font color="#808080">(</font>opvenda<font color="#808080">)=</font>sreg <font color="#000080"><b>then
   inspect </b></font>nnum
     <font color="#000080"><b>when </b></font><font color="#FF0000">0 </font><font color="#000080"><b>then </b></font>sret<font color="#808080">:=</font><font color="#800000">&quot;Venda(s) n&atilde;o encontrada(s)!%N&quot;</font><font color="#808080">;
     </font><font color="#000080"><b>when </b></font><font color="#FF0000">1 </font><font color="#000080"><b>then
         </b></font>sret<font color="#808080">:=</font><font color="#800000">&quot;Data/Hora venda: &quot;</font><font color="#808080">;
         </font>g_nposchave<font color="#808080">:=</font><font color="#FF0000">1</font><font color="#808080">;
         </font>g_ntamchave<font color="#808080">:=</font><font color="#FF0000">19</font><font color="#808080">;
     </font><font color="#000080"><b>when </b></font><font color="#FF0000">2 </font><font color="#000080"><b>then
         </b></font>sret<font color="#808080">:=</font><font color="#800000">&quot;CPF: &quot;</font><font color="#808080">;
         </font>g_nposchave<font color="#808080">:=</font><font color="#FF0000">20</font><font color="#808080">;
         </font>g_ntamchave<font color="#808080">:=</font><font color="#FF0000">14</font><font color="#808080">;
     </font><font color="#000080"><b>when </b></font><font color="#FF0000">3 </font><font color="#000080"><b>then
         </b></font>sret<font color="#808080">:=</font><font color="#800000">&quot;ISBN: &quot;</font><font color="#808080">;
         </font>g_nposchave<font color="#808080">:=</font><font color="#FF0000">34</font><font color="#808080">;
         </font>g_ntamchave<font color="#808080">:=</font><font color="#FF0000">13</font><font color="#808080">;
     </font><font color="#000080"><b>when </b></font><font color="#FF0000">4 </font><font color="#000080"><b>then
         </b></font>sret<font color="#808080">:=</font><font color="#800000">&quot;Pre&ccedil;o de venda: &quot;</font><font color="#808080">;
         </font>g_nposchave<font color="#808080">:=</font><font color="#FF0000">47</font><font color="#808080">;
         </font>g_ntamchave<font color="#808080">:=</font><font color="#FF0000">10</font><font color="#808080">;
   </font><font color="#000080"><b>end</b></font><font color="#808080">;
</font><font color="#000080"><b>end</b></font><font color="#808080">;

</font><font color="#800080">result</font><font color="#808080">:=</font>sret<font color="#808080">;
</font><font color="#000080"><b>end</b></font><font color="#808080">;
-- ----------------------------------------------------------------------------
-- Indica se continua ou n&atilde;o mostrando um n&uacute;mero m&aacute;ximo de linhas.
-- nlinha - a linha a ser continuada
-- nQtdLinha - a quantidade de linhas a serem mostradas
-- retorna - se continua ou n&atilde;o
-- ----------------------------------------------------------------------------
</font>continuasn<font color="#808080">(</font>nlinha<font color="#808080">, </font>nqtdlinha<font color="#808080">: </font><font color="#0000FF">INTEGER</font><font color="#808080">): </font><font color="#0000FF">BOOLEAN </font><font color="#000080"><b>is
local
  </b></font>bsop<font color="#808080">, </font>bret<font color="#808080">: </font><font color="#0000FF">BOOLEAN</font><font color="#808080">;
  </font>opcsubmenu<font color="#808080">: </font><font color="#0000FF">STRING</font><font color="#808080">;
</font><font color="#000080"><b>do
</b></font>bret<font color="#808080">:=</font><font color="#008080">false</font><font color="#808080">;
</font><font color="#000080"><b>if </b></font>nlinha <font color="#808080">&gt; </font><font color="#FF0000">0 </font><font color="#000080"><b>then
  if </b></font><font color="#808080">(</font>nlinha <font color="#808080">\\ </font>nqtdlinha<font color="#808080">) = </font><font color="#FF0000">0 </font><font color="#000080"><b>then
     from      
       </b></font>bsop<font color="#808080">:=</font><font color="#008080">true</font><font color="#808080">;
     </font><font color="#000080"><b>until 
       </b></font>bsop<font color="#808080">=</font><font color="#008080">false
     </font><font color="#000080"><b>loop
       </b></font>menu<font color="#808080">(</font><font color="#FF0000">13</font><font color="#808080">);
       </font>opcsubmenu<font color="#808080">:=</font>digita<font color="#808080">;
       </font><font color="#000080"><b>if </b></font><font color="#808080">(</font>opcsubmenu.item<font color="#808080">(</font><font color="#FF0000">1</font><font color="#808080">)='</font>s<font color="#808080">') </font><font color="#000080"><b>or </b></font><font color="#808080">(</font>opcsubmenu.item<font color="#808080">(</font><font color="#FF0000">1</font><font color="#808080">)='</font>s<font color="#808080">') </font><font color="#000080"><b>then 
         </b></font>bsop<font color="#808080">:=</font><font color="#008080">false
       </font><font color="#000080"><b>elseif </b></font><font color="#808080">(</font>opcsubmenu.item<font color="#808080">(</font><font color="#FF0000">1</font><font color="#808080">)='</font>n<font color="#808080">') </font><font color="#000080"><b>or </b></font><font color="#808080">(</font>opcsubmenu.item<font color="#808080">(</font><font color="#FF0000">1</font><font color="#808080">)='</font>n<font color="#808080">') </font><font color="#000080"><b>then
         </b></font>bret<font color="#808080">:=</font><font color="#008080">true</font><font color="#808080">;
         </font>bsop<font color="#808080">:=</font><font color="#008080">false</font><font color="#808080">;
       </font><font color="#000080"><b>else 
         </b></font>io.put_string<font color="#808080">(</font>msg_erro<font color="#808080">);
       </font><font color="#000080"><b>end</b></font><font color="#808080">;
     </font><font color="#000080"><b>end</b></font><font color="#808080">;
  </font><font color="#000080"><b>end</b></font><font color="#808080">;
</font><font color="#000080"><b>end</b></font><font color="#808080">;
</font><font color="#800080">result</font><font color="#808080">:=</font>bret<font color="#808080">;
</font><font color="#000080"><b>end</b></font><font color="#808080">;
-- ----------------------------------------------------------------------------
-- Lista v&aacute;rios registros de acordo com a pesquisa feita.
-- sArq - o arquivo
-- sreg - o tipo de arquivo
-- sChave - a chave a ser pesquisada
-- nPosChave - a posicao inicial da chave dentro do registro
-- nTamChave - o tamanho da chave dentro do registro
-- nTamLinha - o tamanho do registro
-- nQtdLinha - a quantidade de linhas a serem mostradas
-- retorna - se encontrou algum registro
-- ----------------------------------------------------------------------------
</font>listartodos<font color="#808080">(</font>sarq<font color="#808080">: </font><font color="#0000FF">TEXT_FILE_READ_WRITE</font><font color="#808080">; </font>sreg<font color="#808080">: </font><font color="#0000FF">INTEGER</font><font color="#808080">; </font>schave<font color="#808080">: </font><font color="#0000FF">STRING</font><font color="#808080">;
   </font>nposchave<font color="#808080">, </font>ntamchave<font color="#808080">, </font>ntamlinha<font color="#808080">, </font>nqtdlinha<font color="#808080">: </font><font color="#0000FF">INTEGER</font><font color="#808080">;
   </font>bpesqrelativa<font color="#808080">: </font><font color="#0000FF">BOOLEAN</font><font color="#808080">): </font><font color="#0000FF">BOOLEAN </font><font color="#000080"><b>is
local 
  </b></font>slinha<font color="#808080">, </font>sres<font color="#808080">: </font><font color="#0000FF">STRING</font><font color="#808080">;
  </font>bquebra<font color="#808080">, </font>bachou<font color="#808080">, </font>bret<font color="#808080">: </font><font color="#0000FF">BOOLEAN</font><font color="#808080">;
  </font>ncont<font color="#808080">: </font><font color="#0000FF">INTEGER</font><font color="#808080">;
</font><font color="#000080"><b>do
  </b></font>reconecta<font color="#808080">(</font>sarq<font color="#808080">);
  </font>bret<font color="#808080">:=</font><font color="#008080">false</font><font color="#808080">;
  </font>mostrardados<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">);
  </font><font color="#000080"><b>from
    </b></font>sres<font color="#808080">:=</font><font color="#800000">&quot;&quot;</font><font color="#808080">;
    </font>slinha<font color="#808080">:=</font><font color="#800000">&quot;&quot;</font><font color="#808080">;
    </font>bquebra<font color="#808080">:=</font><font color="#008080">false</font><font color="#808080">;
    </font>ncont<font color="#808080">:=</font><font color="#FF0000">0</font><font color="#808080">;
  </font><font color="#000080"><b>until
    </b></font>sarq.end_of_input <font color="#000080"><b>or </b></font>bquebra<font color="#808080">=</font><font color="#008080">true
  </font><font color="#000080"><b>loop
    </b></font>slinha.clear_count<font color="#808080">;
    </font>sarq.read_line_in<font color="#808080">(</font>slinha<font color="#808080">);
    </font><font color="#000080"><b>if </b></font>slinha.is_empty<font color="#808080">=</font><font color="#008080">false </font><font color="#000080"><b>then
      if </b></font>bpesqrelativa<font color="#808080">=</font><font color="#008080">true </font><font color="#000080"><b>then
        </b></font>sres<font color="#808080">:=</font>trim<font color="#808080">(</font>substr<font color="#808080">(</font>slinha<font color="#808080">,</font>nposchave<font color="#808080">,</font>ntamchave<font color="#808080">));

        </font><font color="#000080"><b>if </b></font>strrelativa<font color="#808080">(</font>sres<font color="#808080">,</font>schave<font color="#808080">) </font><font color="#000080"><b>then
          </b></font>bachou<font color="#808080">:=</font><font color="#008080">true</font><font color="#808080">;
          </font>bret<font color="#808080">:=</font><font color="#008080">true</font><font color="#808080">;
        </font><font color="#000080"><b>else
          </b></font>bachou<font color="#808080">:=</font><font color="#008080">false</font><font color="#808080">;
        </font><font color="#000080"><b>end</b></font><font color="#808080">;
      </font><font color="#000080"><b>else
        </b></font>bachou<font color="#808080">:=</font><font color="#008080">true</font><font color="#808080">;
        </font>bret<font color="#808080">:=</font><font color="#008080">true</font><font color="#808080">;
      </font><font color="#000080"><b>end</b></font><font color="#808080">;
    
      </font><font color="#000080"><b>if </b></font>bachou <font color="#000080"><b>then
        </b></font>mostrardados<font color="#808080">(</font>sreg<font color="#808080">, </font>substr<font color="#808080">(</font>slinha<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font>ntamlinha<font color="#808080">), </font><font color="#FF0000">3</font><font color="#808080">);
        </font>ncont<font color="#808080">:=</font>ncont<font color="#808080">+</font><font color="#FF0000">1</font><font color="#808080">;
      </font><font color="#000080"><b>end</b></font><font color="#808080">;
    
      </font>bquebra<font color="#808080">:=</font>continuasn<font color="#808080">(</font>ncont<font color="#808080">, </font>nqtdlinha<font color="#808080">);
    </font><font color="#000080"><b>end</b></font><font color="#808080">;
  </font><font color="#000080"><b>end</b></font><font color="#808080">;
</font><font color="#800080">result</font><font color="#808080">:=</font>bret<font color="#808080">;
</font><font color="#000080"><b>end</b></font><font color="#808080">;
-- ----------------------------------------------------------------------------
-- Lista v&aacute;rios registros entre arquivos de acordo com a pesquisa feita.
-- sArq1 - o arquivo de liga&ccedil;&atilde;o
-- sreg1 - o tipo de arquivo de liga&ccedil;&atilde;o
-- nPosChave1 - a posicao inicial da primeira chave no arquivo de liga&ccedil;&atilde;o
-- nTamChave1 - o tamanho da primeira chave no arquivo de liga&ccedil;&atilde;o
-- nPosChave2 - a posicao inicial da segunda chave do arquivo de liga&ccedil;&atilde;o
-- nTamChave2 - o tamanho da segunda chave do arquivo de liga&ccedil;&atilde;o
-- sChave - a chave a ser pesquisada no arquivo de liga&ccedil;&atilde;o
-- sArq2 - o arquivo a ser pesquisado
-- sreg2 - o tipo de arquivo a ser pesquisado
-- nPosChave3 - a posicao inicial da chave do arquivo pesquisado
-- nQtdLinha - a quantidade de linhas a serem mostradas
-- ----------------------------------------------------------------------------
</font>listarregligados<font color="#808080">(</font>sarq1<font color="#808080">: </font><font color="#0000FF">TEXT_FILE_READ_WRITE</font><font color="#808080">; </font>sreg1<font color="#808080">, </font>nposchave1<font color="#808080">,
  </font>ntamchave1<font color="#808080">, </font>nposchave2<font color="#808080">, </font>ntamchave2<font color="#808080">: </font><font color="#0000FF">INTEGER</font><font color="#808080">; </font>schave<font color="#808080">: </font><font color="#0000FF">STRING</font><font color="#808080">;
  </font>sarq2<font color="#808080">: </font><font color="#0000FF">TEXT_FILE_READ_WRITE</font><font color="#808080">; </font>sreg2<font color="#808080">, </font>nposchave3<font color="#808080">, </font>nqtdlinha<font color="#808080">: </font><font color="#0000FF">INTEGER</font><font color="#808080">) </font><font color="#000080"><b>is
local
  </b></font>bquebra<font color="#808080">, </font>bret<font color="#808080">: </font><font color="#0000FF">BOOLEAN</font><font color="#808080">;
  </font>ncont<font color="#808080">: </font><font color="#0000FF">INTEGER</font><font color="#808080">;
  </font>slinha1<font color="#808080">, </font>scodigo1<font color="#808080">, </font>scodigo2<font color="#808080">, </font>slinha2<font color="#808080">: </font><font color="#0000FF">STRING</font><font color="#808080">;
</font><font color="#000080"><b>do
  </b></font>reconecta<font color="#808080">(</font>sarq1<font color="#808080">);
  </font>bret<font color="#808080">:=</font><font color="#008080">false</font><font color="#808080">;
  </font>mostrardados<font color="#808080">(</font>sreg2<font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">);
  </font><font color="#000080"><b>from
    </b></font>slinha1<font color="#808080">:=</font><font color="#800000">&quot;&quot;</font><font color="#808080">;
    </font>bquebra<font color="#808080">:=</font><font color="#008080">false</font><font color="#808080">;
    </font>ncont<font color="#808080">:=</font><font color="#FF0000">0</font><font color="#808080">;
  </font><font color="#000080"><b>until
    </b></font>sarq1.end_of_input <font color="#000080"><b>or </b></font>bquebra<font color="#808080">=</font><font color="#008080">true
  </font><font color="#000080"><b>loop
    </b></font>slinha1.clear_count<font color="#808080">;
    </font>sarq1.read_line_in<font color="#808080">(</font>slinha1<font color="#808080">);
    </font><font color="#000080"><b>if </b></font>slinha1.is_empty<font color="#808080">=</font><font color="#008080">false </font><font color="#000080"><b>then
      </b></font>scodigo1<font color="#808080">:=</font>trim<font color="#808080">(</font>substr<font color="#808080">(</font>slinha1<font color="#808080">,</font>nposchave1<font color="#808080">,</font>ntamchave1<font color="#808080">));
      </font><font color="#000080"><b>if </b></font>scodigo1.is_equal<font color="#808080">(</font>schave<font color="#808080">) </font><font color="#000080"><b>then
        </b></font>scodigo2<font color="#808080">:=</font>trim<font color="#808080">(</font>substr<font color="#808080">(</font>slinha1<font color="#808080">,</font>nposchave2<font color="#808080">,</font>ntamchave2<font color="#808080">));
        </font>slinha2<font color="#808080">:=</font>pesqarq<font color="#808080">(</font>sarq2<font color="#808080">,</font>scodigo2<font color="#808080">,</font>nposchave3<font color="#808080">,</font>ntamchave2<font color="#808080">,</font>tamreg<font color="#808080">(</font>sreg2<font color="#808080">));
        </font>mostrardados<font color="#808080">(</font>sreg2<font color="#808080">, </font>substr<font color="#808080">(</font>slinha2<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font>tamreg<font color="#808080">(</font>sreg2<font color="#808080">)), </font><font color="#FF0000">3</font><font color="#808080">);
        </font>bret<font color="#808080">:=</font><font color="#008080">true</font><font color="#808080">;
        </font>ncont<font color="#808080">:=</font>ncont<font color="#808080">+</font><font color="#FF0000">1</font><font color="#808080">;
      </font><font color="#000080"><b>end</b></font><font color="#808080">;
      </font>bquebra<font color="#808080">:=</font>continuasn<font color="#808080">(</font>ncont<font color="#808080">, </font>nqtdlinha<font color="#808080">);
    </font><font color="#000080"><b>end</b></font><font color="#808080">;
  </font><font color="#000080"><b>end</b></font><font color="#808080">;
  </font><font color="#000080"><b>if </b></font>bret<font color="#808080">=</font><font color="#008080">false </font><font color="#000080"><b>then
     </b></font>io.put_string<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg2<font color="#808080">,</font><font color="#FF0000">0</font><font color="#808080">));
  </font><font color="#000080"><b>end</b></font><font color="#808080">;
</font><font color="#000080"><b>end</b></font><font color="#808080">;
-- ----------------------------------------------------------------------------
-- Valida a entrada de registros de acordo com a pesquisa feita.
-- sArq - o arquivo
-- sreg - o tipo de arquivo
-- nTexto - o numero do r&oacute;tulo da entrada
-- sEntrada - a chave a ser pesquisada e validada
-- nTentativas - o n&uacute;mero m&aacute;ximo de tentativas
-- bPesqRelativa - indica se vai realizar uma pesquisa relativa
-- bTipoEntrada - indica o tipo de entrada
-- retorna - o registro pesquisado e validado
-- ----------------------------------------------------------------------------
</font>validaentrada<font color="#808080">(</font>sarq<font color="#808080">: </font><font color="#0000FF">TEXT_FILE_READ_WRITE</font><font color="#808080">; </font>sreg<font color="#808080">, </font>ntexto<font color="#808080">: </font><font color="#0000FF">INTEGER</font><font color="#808080">;
        </font>sentrada<font color="#808080">: </font><font color="#0000FF">STRING</font><font color="#808080">; </font>ntentativas<font color="#808080">: </font><font color="#0000FF">INTEGER</font><font color="#808080">;
        </font>bpesqrelativa<font color="#808080">: </font><font color="#0000FF">BOOLEAN</font><font color="#808080">; </font>btipoentrada<font color="#808080">: </font><font color="#0000FF">INTEGER</font><font color="#808080">): </font><font color="#0000FF">STRING </font><font color="#000080"><b>is
local
  </b></font>bquebra<font color="#808080">: </font><font color="#0000FF">BOOLEAN</font><font color="#808080">;
  </font>slocal<font color="#808080">, </font>sres<font color="#808080">, </font>stexto<font color="#808080">, </font>smsgerro<font color="#808080">: </font><font color="#0000FF">STRING</font><font color="#808080">;
  </font>ncont<font color="#808080">, </font>nposchave<font color="#808080">, </font>ntamchave<font color="#808080">, </font>ntamlinha<font color="#808080">: </font><font color="#0000FF">INTEGER</font><font color="#808080">;
</font><font color="#000080"><b>do
  </b></font>ntamlinha<font color="#808080">:=</font>tamreg<font color="#808080">(</font>sreg<font color="#808080">);
  </font>smsgerro<font color="#808080">:=</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">,</font><font color="#FF0000">0</font><font color="#808080">);
  </font>stexto<font color="#808080">:=</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">,</font>ntexto<font color="#808080">);
  </font>nposchave<font color="#808080">:=</font>g_nposchave<font color="#808080">;
  </font>ntamchave<font color="#808080">:=</font>g_ntamchave<font color="#808080">;
  </font>slocal<font color="#808080">:=</font>sentrada<font color="#808080">;
  </font>sres<font color="#808080">:=</font><font color="#800000">&quot;&quot;</font><font color="#808080">;
  </font><font color="#000080"><b>from
    </b></font>ncont<font color="#808080">:=</font><font color="#FF0000">1</font><font color="#808080">;
    </font>bquebra<font color="#808080">:=</font><font color="#008080">false</font><font color="#808080">;
  </font><font color="#000080"><b>until
    </b></font>bquebra<font color="#808080">=</font><font color="#008080">true </font><font color="#000080"><b>or </b></font>ncont <font color="#808080">&gt; </font>ntentativas
  <font color="#000080"><b>loop
    if </b></font>cttipo.item<font color="#808080">(</font>optexto<font color="#808080">) = </font>btipoentrada <font color="#000080"><b>then
      </b></font>io.put_string<font color="#808080">(</font>stexto<font color="#808080">);
      </font>slocal<font color="#808080">:=</font>digita<font color="#808080">;
    </font><font color="#000080"><b>elseif </b></font>cttipo.item<font color="#808080">(</font>opnumero<font color="#808080">) = </font>btipoentrada <font color="#000080"><b>then
       </b></font>slocal<font color="#808080">:=</font>validanumero<font color="#808080">(</font>stexto<font color="#808080">,</font>sentrada<font color="#808080">)
    </font><font color="#000080"><b>elseif </b></font>cttipo.item<font color="#808080">(</font>opdata<font color="#808080">) = </font>btipoentrada <font color="#000080"><b>then
       </b></font>slocal<font color="#808080">:=</font>validadatahora<font color="#808080">(</font>stexto<font color="#808080">,</font>sentrada<font color="#808080">,</font><font color="#008080">true</font><font color="#808080">)
    </font><font color="#000080"><b>elseif </b></font>cttipo.item<font color="#808080">(</font>opdatahora<font color="#808080">) = </font>btipoentrada <font color="#000080"><b>then
       </b></font>slocal<font color="#808080">:=</font>validadatahora<font color="#808080">(</font>stexto<font color="#808080">,</font>sentrada<font color="#808080">,</font><font color="#008080">false</font><font color="#808080">)
    </font><font color="#000080"><b>elseif </b></font>cttipo.item<font color="#808080">(</font>opsenha<font color="#808080">) = </font>btipoentrada <font color="#000080"><b>then
       </b></font>slocal<font color="#808080">:=</font>digitasenha<font color="#808080">(</font>stexto<font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">);
    </font><font color="#000080"><b>end</b></font><font color="#808080">;
 
    </font><font color="#000080"><b>if </b></font>bpesqrelativa <font color="#000080"><b>then
      if </b></font>listartodos<font color="#808080">(</font>sarq<font color="#808080">, </font>sreg<font color="#808080">, </font>slocal<font color="#808080">, </font>nposchave<font color="#808080">, </font>ntamchave<font color="#808080">, </font>ntamlinha<font color="#808080">,
                    </font>qtd_max_linha<font color="#808080">, </font><font color="#008080">true</font><font color="#808080">) </font><font color="#000080"><b>then
        </b></font>sres<font color="#808080">:=</font><font color="#800000">&quot; &quot;</font><font color="#808080">;
      </font><font color="#000080"><b>end</b></font><font color="#808080">;
    </font><font color="#000080"><b>else
      </b></font>sres<font color="#808080">:=</font>pesqarq<font color="#808080">(</font>sarq<font color="#808080">, </font>slocal<font color="#808080">, </font>nposchave<font color="#808080">, </font>ntamchave<font color="#808080">, </font>ntamlinha<font color="#808080">);
    </font><font color="#000080"><b>end</b></font><font color="#808080">;
    </font><font color="#000080"><b>if </b></font>sres.is_empty <font color="#000080"><b>then
       </b></font>io.put_string<font color="#808080">(</font>smsgerro<font color="#808080">);
    </font><font color="#000080"><b>else
       </b></font>bquebra<font color="#808080">:=</font><font color="#008080">true</font><font color="#808080">;
    </font><font color="#000080"><b>end</b></font><font color="#808080">;
    </font>ncont<font color="#808080">:=</font>ncont<font color="#808080">+</font><font color="#FF0000">1</font><font color="#808080">;
  </font><font color="#000080"><b>end</b></font><font color="#808080">;
</font><font color="#800080">result</font><font color="#808080">:=</font>sres<font color="#808080">;
</font><font color="#000080"><b>end</b></font><font color="#808080">;
-- ----------------------------------------------------------------------------
-- Mostra a tela de splash do sistema.
-- ----------------------------------------------------------------------------
</font>frmsplash <font color="#000080"><b>is
local
  </b></font>ncont<font color="#808080">: </font><font color="#0000FF">INTEGER</font><font color="#808080">;
</font><font color="#000080"><b>do
 </b></font>io.put_string<font color="#808080">(</font><font color="#800000">&quot;*---------------------------------------&quot;</font><font color="#808080">+
 </font><font color="#800000">&quot;-------------------------------------*%N&quot;</font><font color="#808080">);
 </font>io.put_string<font color="#808080">(</font><font color="#800000">&quot;| LL    II VV   VV RRRRR  UU  UU   SSSS &quot;</font><font color="#808080">+
 </font><font color="#800000">&quot;VV   VV II RRRRR  TTTT UU  UU   SSSS |%N&quot;</font><font color="#808080">);
 </font>io.put_string<font color="#808080">(</font><font color="#800000">&quot;| LL    II  VV VV  RR   R UU  UU  SS    &quot;</font><font color="#808080">+
 </font><font color="#800000">&quot; VV VV  II RR   R  TT  UU  UU  SS    |%N&quot;</font><font color="#808080">);
 </font>io.put_string<font color="#808080">(</font><font color="#800000">&quot;| LL    II   VVV   RRRRR  UU  UU    SS  &quot;</font><font color="#808080">+
 </font><font color="#800000">&quot;  VVV   II RRRRR   TT  UU  UU    SS  |%N&quot;</font><font color="#808080">);
 </font>io.put_string<font color="#808080">(</font><font color="#800000">&quot;| LLLLL II    V    RR   R  UUUU  SSSS   &quot;</font><font color="#808080">+
 </font><font color="#800000">&quot;   V    II RR   R  TT   UUUU  SSSS   |%N&quot;</font><font color="#808080">);
 </font>io.put_string<font color="#808080">(</font><font color="#800000">&quot;*---------------------------------------&quot;</font><font color="#808080">+
 </font><font color="#800000">&quot;-------------------------------------*%N&quot;</font><font color="#808080">);
 </font><font color="#000080"><b>from
   </b></font>ncont<font color="#808080">:=</font><font color="#FF0000">1 
 </font><font color="#000080"><b>until
   </b></font>ncont <font color="#808080">&gt; </font><font color="#FF0000">18 
 </font><font color="#000080"><b>loop
   </b></font>io.put_new_line<font color="#808080">;
   </font>ncont<font color="#808080">:=</font>ncont <font color="#808080">+ </font><font color="#FF0000">1</font><font color="#808080">;
 </font><font color="#000080"><b>end 
 </b></font>io.put_string<font color="#808080">(</font>msg_press<font color="#808080">);
 </font>io.read_character<font color="#808080">;
 </font>io.put_new_line<font color="#808080">;
</font><font color="#000080"><b>end</b></font><font color="#808080">;
-- ----------------------------------------------------------------------------
-- Mostra a tela de sobre do sistema.
-- ----------------------------------------------------------------------------
</font>frmsobre <font color="#000080"><b>is
local
  </b></font>ncont<font color="#808080">: </font><font color="#0000FF">INTEGER</font><font color="#808080">;
  </font>stemp<font color="#808080">: </font><font color="#0000FF">STRING</font><font color="#808080">;
</font><font color="#000080"><b>do
 </b></font>io.put_string<font color="#808080">(</font><font color="#800000">&quot;*------------------------------------------------------------*%N&quot;</font><font color="#808080">);
 </font>io.put_string<font color="#808080">(</font><font color="#800000">&quot;|  LL        II  VV       VV  RRRRRRR   UU    UU   SSSSSSS   |%N&quot;</font><font color="#808080">);
 </font>io.put_string<font color="#808080">(</font><font color="#800000">&quot;|  LL        II   VV     VV   RR     R  UU    UU  SS         |%N&quot;</font><font color="#808080">);
 </font>io.put_string<font color="#808080">(</font><font color="#800000">&quot;|  LL        II    VV   VV    RR     R  UU    UU   SSSS      |%N&quot;</font><font color="#808080">);
 </font>io.put_string<font color="#808080">(</font><font color="#800000">&quot;|  LL        II     VV VV     RRRRRRR   UU    UU     SSSS    |%N&quot;</font><font color="#808080">);
 </font>io.put_string<font color="#808080">(</font><font color="#800000">&quot;|  LLLL      II      VVV      RR RR     UU    UU        SS   |%N&quot;</font><font color="#808080">);
 </font>io.put_string<font color="#808080">(</font><font color="#800000">&quot;|  LLLLLLLL  II       V       RR   RR    UUUUUU   SSSSSSSS   |%N&quot;</font><font color="#808080">);
 </font>io.put_string<font color="#808080">(</font><font color="#800000">&quot;|                                                            |%N&quot;</font><font color="#808080">);
 </font>io.put_string<font color="#808080">(</font><font color="#800000">&quot;|  VV       VV  II  RRRRRRR   TTTTTTTT  UU    UU   SSSSSSS   |%N&quot;</font><font color="#808080">);
 </font>io.put_string<font color="#808080">(</font><font color="#800000">&quot;|   VV     VV   II  RR     R     TT     UU    UU  SS         |%N&quot;</font><font color="#808080">);
 </font>io.put_string<font color="#808080">(</font><font color="#800000">&quot;|    VV   VV    II  RR     R     TT     UU    UU   SSSS      |%N&quot;</font><font color="#808080">);
 </font>io.put_string<font color="#808080">(</font><font color="#800000">&quot;|     VV VV     II  RRRRRRR      TT     UU    UU     SSSS    |%N&quot;</font><font color="#808080">);
 </font>io.put_string<font color="#808080">(</font><font color="#800000">&quot;|      VVV      II  RR RR        TT     UU    UU        SS   |%N&quot;</font><font color="#808080">);
 </font>io.put_string<font color="#808080">(</font><font color="#800000">&quot;|       V       II  RR   RR      TT      UUUUUU   SSSSSSSS   |%N&quot;</font><font color="#808080">);
 </font>io.put_string<font color="#808080">(</font><font color="#800000">&quot;|                                                            |%N&quot;</font><font color="#808080">);
 </font>io.put_string<font color="#808080">(</font><font color="#800000">&quot;|                                               Versao 1.0.0 |%N&quot;</font><font color="#808080">);
 </font>io.put_string<font color="#808080">(</font><font color="#800000">&quot;| Sistema integrante do projeto Livrus Virtus.               |%N&quot;</font><font color="#808080">);
 </font>io.put_string<font color="#808080">(</font><font color="#800000">&quot;| Todos os direitos reservados para Henrique F. de Souza.    |%N&quot;</font><font color="#808080">);
 </font>io.put_string<font color="#808080">(</font><font color="#800000">&quot;| Versao programada na linguagem Eiffel.                     |%N&quot;</font><font color="#808080">);
 </font>io.put_string<font color="#808080">(</font><font color="#800000">&quot;*------------------------------------------------------------*%N&quot;</font><font color="#808080">);
 </font><font color="#000080"><b>from
   </b></font>ncont<font color="#808080">:=</font><font color="#FF0000">1 
 </font><font color="#000080"><b>until
   </b></font>ncont <font color="#808080">&gt; </font><font color="#FF0000">4 
 </font><font color="#000080"><b>loop
   </b></font>io.put_new_line<font color="#808080">;
   </font>ncont<font color="#808080">:=</font>ncont <font color="#808080">+ </font><font color="#FF0000">1</font><font color="#808080">;
 </font><font color="#000080"><b>end 
 </b></font>io.put_string<font color="#808080">(</font>msg_press<font color="#808080">);
 </font>stemp<font color="#808080">:=</font>digita<font color="#808080">;
 </font>io.put_new_line<font color="#808080">;
</font><font color="#000080"><b>end</b></font><font color="#808080">;
-- ----------------------------------------------------------------------------
-- Mostra a tela de login do sistema.
-- retorna - se o login foi validado corretamente
-- ----------------------------------------------------------------------------
</font>frmlogin<font color="#808080">: </font><font color="#0000FF">BOOLEAN </font><font color="#000080"><b>is
local
  </b></font>bret<font color="#808080">: </font><font color="#0000FF">BOOLEAN</font><font color="#808080">;
  </font>slinha<font color="#808080">: </font><font color="#0000FF">STRING</font><font color="#808080">;
</font><font color="#000080"><b>do
  </b></font>bret<font color="#808080">:=</font><font color="#008080">false</font><font color="#808080">;
  </font>io.put_string<font color="#808080">(</font><font color="#800000">&quot;*----------------------------------------------------&quot;</font><font color="#808080">+
  </font><font color="#800000">&quot;----------*%N&quot;</font><font color="#808080">);
  </font>io.put_string<font color="#808080">(</font><font color="#800000">&quot;| Login do sistema                                   &quot;</font><font color="#808080">+
  </font><font color="#800000">&quot;          |%N&quot;</font><font color="#808080">);
  </font>io.put_string<font color="#808080">(</font><font color="#800000">&quot;*----------------------------------------------------&quot;</font><font color="#808080">+
  </font><font color="#800000">&quot;----------*%N&quot;</font><font color="#808080">);
  </font>slinha<font color="#808080">:=</font>validaentrada<font color="#808080">(</font>tfusuario<font color="#808080">, </font>opusuario<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font>tusuario.login<font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">,
        </font><font color="#008080">false</font><font color="#808080">, </font>optexto<font color="#808080">);
  </font><font color="#000080"><b>if </b></font>slinha.is_empty<font color="#808080">=</font><font color="#008080">false </font><font color="#000080"><b>then
     </b></font>slinha<font color="#808080">:=</font>validaentrada<font color="#808080">(</font>tfusuario<font color="#808080">, </font>opusuario<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">, </font>tusuario.senha<font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">,
        </font><font color="#008080">false</font><font color="#808080">, </font>opsenha<font color="#808080">);
     </font><font color="#000080"><b>if </b></font>slinha.is_empty<font color="#808080">=</font><font color="#008080">false </font><font color="#000080"><b>then
        </b></font>tusuario.set_login<font color="#808080">(</font>trim<font color="#808080">(</font>substr<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">)));
        </font>tusuario.set_senha<font color="#808080">(</font>trim<font color="#808080">(</font>substr<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">11</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">)));
        </font>bret<font color="#808080">:=</font><font color="#008080">true</font><font color="#808080">;
     </font><font color="#000080"><b>end</b></font><font color="#808080">;
  </font><font color="#000080"><b>end</b></font><font color="#808080">;
  </font>io.put_new_line<font color="#808080">;
  </font><font color="#800080">result</font><font color="#808080">:=</font>bret<font color="#808080">;
</font><font color="#000080"><b>end</b></font><font color="#808080">;
-- ----------------------------------------------------------------------------
-- Mostra os menus do sistema.
-- num - o n&uacute;mero do menu
-- ----------------------------------------------------------------------------
</font>menu<font color="#808080">(</font>num<font color="#808080">: </font><font color="#0000FF">INTEGER</font><font color="#808080">) </font><font color="#000080"><b>is
do
 if </b></font><font color="#808080">(</font>num<font color="#808080">=</font><font color="#FF0000">1</font><font color="#808080">) </font><font color="#000080"><b>then
   </b></font>io.put_string<font color="#808080">(</font><font color="#800000">&quot;*--------------------------------------------------------------*%N&quot;</font><font color="#808080">);
   </font>io.put_string<font color="#808080">(</font><font color="#800000">&quot;| (C)adastros        (P)esquisas     (V)endas        (O)p&ccedil;&otilde;es  |%N&quot;</font><font color="#808080">);
   </font>io.put_string<font color="#808080">(</font><font color="#800000">&quot;*--------------------------------------------------------------*%N&quot;</font><font color="#808080">);
 </font><font color="#000080"><b>elseif </b></font><font color="#808080">(</font>num<font color="#808080">=</font><font color="#FF0000">2</font><font color="#808080">) </font><font color="#000080"><b>then
   </b></font>io.put_string<font color="#808080">(</font><font color="#800000">&quot;*---------------------------------*%N&quot;</font><font color="#808080">);
   </font>io.put_string<font color="#808080">(</font><font color="#800000">&quot;| 01. Cadastro de Assuntos        |%N&quot;</font><font color="#808080">);
   </font>io.put_string<font color="#808080">(</font><font color="#800000">&quot;| 02. Cadastro de Autores         |%N&quot;</font><font color="#808080">);
   </font>io.put_string<font color="#808080">(</font><font color="#800000">&quot;| 03. Cadastro de Editoras        |%N&quot;</font><font color="#808080">);
   </font>io.put_string<font color="#808080">(</font><font color="#800000">&quot;| 04. Cadastro de Endere&ccedil;os       |%N&quot;</font><font color="#808080">);
   </font>io.put_string<font color="#808080">(</font><font color="#800000">&quot;| 05. Cadastro de Idiomas         |%N&quot;</font><font color="#808080">);
   </font>io.put_string<font color="#808080">(</font><font color="#800000">&quot;| 06. Cadastro de Pa&iacute;ses          |%N&quot;</font><font color="#808080">);
   </font>io.put_string<font color="#808080">(</font><font color="#800000">&quot;| 07. Cadastro de Profiss&otilde;es      |%N&quot;</font><font color="#808080">);
   </font>io.put_string<font color="#808080">(</font><font color="#800000">&quot;| 08. Cadastro de Clientes        |%N&quot;</font><font color="#808080">);
   </font>io.put_string<font color="#808080">(</font><font color="#800000">&quot;| 09. Cadastro de Livros          |%N&quot;</font><font color="#808080">);
   </font>io.put_string<font color="#808080">(</font><font color="#800000">&quot;| 10. Voltar ao menu              |%N&quot;</font><font color="#808080">);
   </font>io.put_string<font color="#808080">(</font><font color="#800000">&quot;*---------------------------------*%N&quot;</font><font color="#808080">);
 </font><font color="#000080"><b>elseif </b></font><font color="#808080">(</font>num<font color="#808080">=</font><font color="#FF0000">3</font><font color="#808080">) </font><font color="#000080"><b>then
   </b></font>io.put_string<font color="#808080">(</font><font color="#800000">&quot;*---------------------------------*%N&quot;</font><font color="#808080">);
   </font>io.put_string<font color="#808080">(</font><font color="#800000">&quot;| 01. Consulta de Assuntos        |%N&quot;</font><font color="#808080">);
   </font>io.put_string<font color="#808080">(</font><font color="#800000">&quot;| 02. Consulta de Autores         |%N&quot;</font><font color="#808080">);
   </font>io.put_string<font color="#808080">(</font><font color="#800000">&quot;| 03. Consulta de Editoras        |%N&quot;</font><font color="#808080">);
   </font>io.put_string<font color="#808080">(</font><font color="#800000">&quot;| 04. Consulta de Endere&ccedil;os       |%N&quot;</font><font color="#808080">);
   </font>io.put_string<font color="#808080">(</font><font color="#800000">&quot;| 05. Consulta de Idiomas         |%N&quot;</font><font color="#808080">);
   </font>io.put_string<font color="#808080">(</font><font color="#800000">&quot;| 06. Consulta de Pa&iacute;ses          |%N&quot;</font><font color="#808080">);
   </font>io.put_string<font color="#808080">(</font><font color="#800000">&quot;| 07. Consulta de Profiss&otilde;es      |%N&quot;</font><font color="#808080">);
   </font>io.put_string<font color="#808080">(</font><font color="#800000">&quot;| 08. Consulta de Clientes        |%N&quot;</font><font color="#808080">);
   </font>io.put_string<font color="#808080">(</font><font color="#800000">&quot;| 09. Consulta de Livros          |%N&quot;</font><font color="#808080">);
   </font>io.put_string<font color="#808080">(</font><font color="#800000">&quot;| 10. Voltar ao menu              |%N&quot;</font><font color="#808080">);
   </font>io.put_string<font color="#808080">(</font><font color="#800000">&quot;*---------------------------------*%N&quot;</font><font color="#808080">);
 </font><font color="#000080"><b>elseif </b></font><font color="#808080">(</font>num<font color="#808080">=</font><font color="#FF0000">4</font><font color="#808080">) </font><font color="#000080"><b>then
   </b></font>io.put_string<font color="#808080">(</font><font color="#800000">&quot;*---------------------------------*%N&quot;</font><font color="#808080">);
   </font>io.put_string<font color="#808080">(</font><font color="#800000">&quot;| 01. Vender Livros               |%N&quot;</font><font color="#808080">);
   </font>io.put_string<font color="#808080">(</font><font color="#800000">&quot;| 02. Vendas Realizadas           |%N&quot;</font><font color="#808080">);
   </font>io.put_string<font color="#808080">(</font><font color="#800000">&quot;| 03. Voltar ao menu              |%N&quot;</font><font color="#808080">);
   </font>io.put_string<font color="#808080">(</font><font color="#800000">&quot;*---------------------------------*%N&quot;</font><font color="#808080">);
 </font><font color="#000080"><b>elseif </b></font><font color="#808080">(</font>num<font color="#808080">=</font><font color="#FF0000">5</font><font color="#808080">) </font><font color="#000080"><b>then
   </b></font>io.put_string<font color="#808080">(</font><font color="#800000">&quot;*---------------------------------*%N&quot;</font><font color="#808080">);
   </font>io.put_string<font color="#808080">(</font><font color="#800000">&quot;| 01. Alterar senha               |%N&quot;</font><font color="#808080">);
   </font>io.put_string<font color="#808080">(</font><font color="#800000">&quot;| 02. Sobre o sistema             |%N&quot;</font><font color="#808080">);
   </font>io.put_string<font color="#808080">(</font><font color="#800000">&quot;| 03. Sair do sistema             |%N&quot;</font><font color="#808080">);
   </font>io.put_string<font color="#808080">(</font><font color="#800000">&quot;| 04. Voltar ao menu              |%N&quot;</font><font color="#808080">);
   </font>io.put_string<font color="#808080">(</font><font color="#800000">&quot;*---------------------------------*%N&quot;</font><font color="#808080">);
 </font><font color="#000080"><b>elseif </b></font><font color="#808080">(</font>num<font color="#808080">=</font><font color="#FF0000">6</font><font color="#808080">) </font><font color="#000080"><b>then
   </b></font>io.put_string<font color="#808080">(</font><font color="#800000">&quot;*--------------------------------------------------------------*%N&quot;</font><font color="#808080">);
   </font>io.put_string<font color="#808080">(</font><font color="#800000">&quot;| (1) Novo  (2) Pesquisar   (3) Voltar ao menu                 |%N&quot;</font><font color="#808080">);
   </font>io.put_string<font color="#808080">(</font><font color="#800000">&quot;*--------------------------------------------------------------*%N&quot;</font><font color="#808080">);
 </font><font color="#000080"><b>elseif </b></font><font color="#808080">(</font>num<font color="#808080">=</font><font color="#FF0000">7</font><font color="#808080">) </font><font color="#000080"><b>then
   </b></font>io.put_string<font color="#808080">(</font><font color="#800000">&quot;*--------------------------------------------------------------*%N&quot;</font><font color="#808080">);
   </font>io.put_string<font color="#808080">(</font><font color="#800000">&quot;| (1) Salvar inclus&atilde;o       (2) Voltar ao menu                 |%N&quot;</font><font color="#808080">);
   </font>io.put_string<font color="#808080">(</font><font color="#800000">&quot;*--------------------------------------------------------------*%N&quot;</font><font color="#808080">);
 </font><font color="#000080"><b>elseif </b></font><font color="#808080">(</font>num<font color="#808080">=</font><font color="#FF0000">8</font><font color="#808080">) </font><font color="#000080"><b>then
   </b></font>io.put_string<font color="#808080">(</font><font color="#800000">&quot;*--------------------------------------------------------------*%N&quot;</font><font color="#808080">);
   </font>io.put_string<font color="#808080">(</font><font color="#800000">&quot;| (1) Alterar       (2) Excluir     (3) Voltar ao menu         |%N&quot;</font><font color="#808080">);
   </font>io.put_string<font color="#808080">(</font><font color="#800000">&quot;*--------------------------------------------------------------*%N&quot;</font><font color="#808080">);
 </font><font color="#000080"><b>elseif </b></font><font color="#808080">(</font>num<font color="#808080">=</font><font color="#FF0000">9</font><font color="#808080">) </font><font color="#000080"><b>then
   </b></font>io.put_string<font color="#808080">(</font><font color="#800000">&quot;*--------------------------------------------------------------*%N&quot;</font><font color="#808080">);
   </font>io.put_string<font color="#808080">(</font><font color="#800000">&quot;| (1) Salvar altera&ccedil;&atilde;o      (2) Voltar ao menu                 |%N&quot;</font><font color="#808080">);
   </font>io.put_string<font color="#808080">(</font><font color="#800000">&quot;*--------------------------------------------------------------*%N&quot;</font><font color="#808080">);
 </font><font color="#000080"><b>elseif </b></font><font color="#808080">(</font>num<font color="#808080">=</font><font color="#FF0000">10</font><font color="#808080">) </font><font color="#000080"><b>then
   </b></font>io.put_string<font color="#808080">(</font><font color="#800000">&quot;*--------------------------------------------------------------*%N&quot;</font><font color="#808080">);
   </font>io.put_string<font color="#808080">(</font><font color="#800000">&quot;| Certeza de excluir? (S/N)                                    |%N&quot;</font><font color="#808080">);
   </font>io.put_string<font color="#808080">(</font><font color="#800000">&quot;*--------------------------------------------------------------*%N&quot;</font><font color="#808080">);
 </font><font color="#000080"><b>elseif </b></font><font color="#808080">(</font>num<font color="#808080">=</font><font color="#FF0000">11</font><font color="#808080">) </font><font color="#000080"><b>then
   </b></font>io.put_string<font color="#808080">(</font><font color="#800000">&quot;*--------------------------------------------------------------*%N&quot;</font><font color="#808080">);
   </font>io.put_string<font color="#808080">(</font><font color="#800000">&quot;| Deseja sair do sistema? (S/N)                                |%N&quot;</font><font color="#808080">);
   </font>io.put_string<font color="#808080">(</font><font color="#800000">&quot;*--------------------------------------------------------------*%N&quot;</font><font color="#808080">);
 </font><font color="#000080"><b>elseif </b></font><font color="#808080">(</font>num<font color="#808080">=</font><font color="#FF0000">12</font><font color="#808080">) </font><font color="#000080"><b>then
   </b></font>io.put_string<font color="#808080">(</font><font color="#800000">&quot;*--------------------------------------------------------------*%N&quot;</font><font color="#808080">);
   </font>io.put_string<font color="#808080">(</font><font color="#800000">&quot;| (1) Pesquisar  (2) Listar todos   (3) Voltar ao menu         |%N&quot;</font><font color="#808080">);
   </font>io.put_string<font color="#808080">(</font><font color="#800000">&quot;*--------------------------------------------------------------*%N&quot;</font><font color="#808080">);
 </font><font color="#000080"><b>elseif </b></font><font color="#808080">(</font>num<font color="#808080">=</font><font color="#FF0000">13</font><font color="#808080">) </font><font color="#000080"><b>then
   </b></font>io.put_string<font color="#808080">(</font><font color="#800000">&quot;*--------------------------------------------------------------*%N&quot;</font><font color="#808080">);
   </font>io.put_string<font color="#808080">(</font><font color="#800000">&quot;| Deseja continuar? (S/N)                                      |%N&quot;</font><font color="#808080">);
   </font>io.put_string<font color="#808080">(</font><font color="#800000">&quot;*--------------------------------------------------------------*%N&quot;</font><font color="#808080">);
 </font><font color="#000080"><b>elseif </b></font><font color="#808080">(</font>num<font color="#808080">=</font><font color="#FF0000">14</font><font color="#808080">) </font><font color="#000080"><b>then
   </b></font>io.put_string<font color="#808080">(</font><font color="#800000">&quot;*--------------------------------------------------------------*%N&quot;</font><font color="#808080">);
   </font>io.put_string<font color="#808080">(</font><font color="#800000">&quot;| Salvar inclus&atilde;o (S/N)                                        |%N&quot;</font><font color="#808080">);
   </font>io.put_string<font color="#808080">(</font><font color="#800000">&quot;*--------------------------------------------------------------*%N&quot;</font><font color="#808080">);
 </font><font color="#000080"><b>end</b></font><font color="#808080">;
 </font>io.put_string<font color="#808080">(</font>msg_opcao<font color="#808080">);
</font><font color="#000080"><b>end</b></font><font color="#808080">;
-- ----------------------------------------------------------------------------
-- Realiza os cadastros de acordo com o tipo de arquivo.
-- sreg - o tipo de arquivo
-- sacao - a a&ccedil;&atilde;o a ser realizada
-- ----------------------------------------------------------------------------
</font>frmcadastros<font color="#808080">(</font>sreg<font color="#808080">, </font>sacao<font color="#808080">: </font><font color="#0000FF">INTEGER</font><font color="#808080">) </font><font color="#000080"><b>is
local
  </b></font>slinha<font color="#808080">: </font><font color="#0000FF">STRING</font><font color="#808080">;
</font><font color="#000080"><b>do
if </b></font>ctarqs.item<font color="#808080">(</font>opassunto<font color="#808080">)=</font>sreg <font color="#000080"><b>then
   if </b></font>ctacao.item<font color="#808080">(</font>opnovo<font color="#808080">) = </font>sacao <font color="#000080"><b>then
      </b></font>tassunto.set_codigo<font color="#808080">(</font>pesqmaxcod<font color="#808080">(</font>tfassunto<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">, </font>tamreg<font color="#808080">(</font>sreg<font color="#808080">)));
      </font>mostrardados<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">);
      </font>submenu<font color="#808080">(</font><font color="#FF0000">7</font><font color="#808080">, </font>sreg<font color="#808080">);
   </font><font color="#000080"><b>elseif </b></font>ctacao.item<font color="#808080">(</font>oppesquisar<font color="#808080">) = </font>sacao <font color="#000080"><b>then
     </b></font>slinha<font color="#808080">:=</font>validaentrada<font color="#808080">(</font>tfassunto<font color="#808080">,</font>sreg<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font>tassunto.codigo<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#008080">false</font><font color="#808080">,</font>opnumero<font color="#808080">);
      </font><font color="#000080"><b>if </b></font>slinha.is_empty<font color="#808080">=</font><font color="#008080">false </font><font color="#000080"><b>then
        </b></font>mostrardados<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">);
        </font>mostrardados<font color="#808080">(</font>sreg<font color="#808080">, </font>slinha<font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">);
        </font>submenu<font color="#808080">(</font><font color="#FF0000">8</font><font color="#808080">, </font>sreg<font color="#808080">);
      </font><font color="#000080"><b>end</b></font><font color="#808080">;
   </font><font color="#000080"><b>elseif </b></font>ctacao.item<font color="#808080">(</font>opalterar<font color="#808080">) = </font>sacao <font color="#000080"><b>then
      </b></font>mostrardados<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">);
      </font>submenu<font color="#808080">(</font><font color="#FF0000">9</font><font color="#808080">, </font>sreg<font color="#808080">);
   </font><font color="#000080"><b>elseif </b></font>ctacao.item<font color="#808080">(</font>opexcluir<font color="#808080">) = </font>sacao <font color="#000080"><b>then
      </b></font>submenu<font color="#808080">(</font><font color="#FF0000">10</font><font color="#808080">, </font>sreg<font color="#808080">);
   </font><font color="#000080"><b>end</b></font><font color="#808080">;
</font><font color="#000080"><b>elseif </b></font>ctarqs.item<font color="#808080">(</font>opautor<font color="#808080">) = </font>sreg <font color="#000080"><b>then
   if </b></font>ctacao.item<font color="#808080">(</font>opnovo<font color="#808080">) = </font>sacao <font color="#000080"><b>then
      </b></font>tautor.set_codigo<font color="#808080">(</font>pesqmaxcod<font color="#808080">(</font>tfautor<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">, </font>tamreg<font color="#808080">(</font>sreg<font color="#808080">)));
      </font>mostrardados<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">);
      </font>submenu<font color="#808080">(</font><font color="#FF0000">7</font><font color="#808080">, </font>sreg<font color="#808080">);
   </font><font color="#000080"><b>elseif </b></font>ctacao.item<font color="#808080">(</font>oppesquisar<font color="#808080">) = </font>sacao <font color="#000080"><b>then
      </b></font>slinha<font color="#808080">:=</font>validaentrada<font color="#808080">(</font>tfautor<font color="#808080">, </font>sreg<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font>tautor.codigo<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#008080">false</font><font color="#808080">,</font>opnumero<font color="#808080">);
      </font><font color="#000080"><b>if </b></font>slinha.is_empty<font color="#808080">=</font><font color="#008080">false </font><font color="#000080"><b>then
        </b></font>mostrardados<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">);
        </font>mostrardados<font color="#808080">(</font>sreg<font color="#808080">, </font>slinha<font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">);
        </font>submenu<font color="#808080">(</font><font color="#FF0000">8</font><font color="#808080">, </font>sreg<font color="#808080">);
      </font><font color="#000080"><b>end</b></font><font color="#808080">;
   </font><font color="#000080"><b>elseif </b></font>ctacao.item<font color="#808080">(</font>opalterar<font color="#808080">) = </font>sacao <font color="#000080"><b>then
      </b></font>mostrardados<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">);
      </font>submenu<font color="#808080">(</font><font color="#FF0000">9</font><font color="#808080">, </font>sreg<font color="#808080">);
   </font><font color="#000080"><b>elseif </b></font>ctacao.item<font color="#808080">(</font>opexcluir<font color="#808080">) = </font>sacao <font color="#000080"><b>then
      </b></font>submenu<font color="#808080">(</font><font color="#FF0000">10</font><font color="#808080">, </font>sreg<font color="#808080">);
   </font><font color="#000080"><b>end</b></font><font color="#808080">;
</font><font color="#000080"><b>elseif </b></font>ctarqs.item<font color="#808080">(</font>opeditora<font color="#808080">) = </font>sreg <font color="#000080"><b>then
   if </b></font>ctacao.item<font color="#808080">(</font>opnovo<font color="#808080">) = </font>sacao <font color="#000080"><b>then
      </b></font>teditora.set_codigo<font color="#808080">(</font>pesqmaxcod<font color="#808080">(</font>tfeditora<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">, </font>tamreg<font color="#808080">(</font>sreg<font color="#808080">)));
      </font>mostrardados<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">);
      </font>submenu<font color="#808080">(</font><font color="#FF0000">7</font><font color="#808080">, </font>sreg<font color="#808080">);
   </font><font color="#000080"><b>elseif </b></font>ctacao.item<font color="#808080">(</font>oppesquisar<font color="#808080">) = </font>sacao <font color="#000080"><b>then
     </b></font>slinha<font color="#808080">:=</font>validaentrada<font color="#808080">(</font>tfeditora<font color="#808080">,</font>sreg<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font>teditora.codigo<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#008080">false</font><font color="#808080">,</font>opnumero<font color="#808080">);
      </font><font color="#000080"><b>if </b></font>slinha.is_empty<font color="#808080">=</font><font color="#008080">false </font><font color="#000080"><b>then
        </b></font>mostrardados<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">);
        </font>mostrardados<font color="#808080">(</font>sreg<font color="#808080">, </font>slinha<font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">);
        </font>submenu<font color="#808080">(</font><font color="#FF0000">8</font><font color="#808080">, </font>sreg<font color="#808080">);
      </font><font color="#000080"><b>end</b></font><font color="#808080">;
   </font><font color="#000080"><b>elseif </b></font>ctacao.item<font color="#808080">(</font>opalterar<font color="#808080">) = </font>sacao <font color="#000080"><b>then
      </b></font>mostrardados<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">);
      </font>submenu<font color="#808080">(</font><font color="#FF0000">9</font><font color="#808080">, </font>sreg<font color="#808080">);
   </font><font color="#000080"><b>elseif </b></font>ctacao.item<font color="#808080">(</font>opexcluir<font color="#808080">) = </font>sacao <font color="#000080"><b>then
      </b></font>submenu<font color="#808080">(</font><font color="#FF0000">10</font><font color="#808080">, </font>sreg<font color="#808080">);
   </font><font color="#000080"><b>end</b></font><font color="#808080">;
</font><font color="#000080"><b>elseif </b></font>ctarqs.item<font color="#808080">(</font>opendereco<font color="#808080">) = </font>sreg <font color="#000080"><b>then
   if </b></font>ctacao.item<font color="#808080">(</font>opnovo<font color="#808080">) = </font>sacao <font color="#000080"><b>then
      </b></font>tendereco.set_codigo<font color="#808080">(</font>pesqmaxcod<font color="#808080">(</font>tfendereco<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">, </font>tamreg<font color="#808080">(</font>sreg<font color="#808080">)));
      </font>mostrardados<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">);
      </font>submenu<font color="#808080">(</font><font color="#FF0000">7</font><font color="#808080">, </font>sreg<font color="#808080">);
   </font><font color="#000080"><b>elseif </b></font>ctacao.item<font color="#808080">(</font>oppesquisar<font color="#808080">) = </font>sacao <font color="#000080"><b>then
      </b></font>slinha<font color="#808080">:=</font>validaentrada<font color="#808080">(</font>tfendereco<font color="#808080">,</font>sreg<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font>tendereco.codigo<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,
              </font><font color="#008080">false</font><font color="#808080">,</font>opnumero<font color="#808080">);
      </font><font color="#000080"><b>if </b></font>slinha.is_empty<font color="#808080">=</font><font color="#008080">false </font><font color="#000080"><b>then
        </b></font>mostrardados<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">);
        </font>mostrardados<font color="#808080">(</font>sreg<font color="#808080">, </font>slinha<font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">);
        </font>submenu<font color="#808080">(</font><font color="#FF0000">8</font><font color="#808080">, </font>sreg<font color="#808080">);
      </font><font color="#000080"><b>end</b></font><font color="#808080">;
   </font><font color="#000080"><b>elseif </b></font>ctacao.item<font color="#808080">(</font>opalterar<font color="#808080">) = </font>sacao <font color="#000080"><b>then
      </b></font>mostrardados<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">);
      </font>submenu<font color="#808080">(</font><font color="#FF0000">9</font><font color="#808080">, </font>sreg<font color="#808080">);
   </font><font color="#000080"><b>elseif </b></font>ctacao.item<font color="#808080">(</font>opexcluir<font color="#808080">) = </font>sacao <font color="#000080"><b>then
      </b></font>submenu<font color="#808080">(</font><font color="#FF0000">10</font><font color="#808080">, </font>sreg<font color="#808080">);
   </font><font color="#000080"><b>end</b></font><font color="#808080">;
</font><font color="#000080"><b>elseif </b></font>ctarqs.item<font color="#808080">(</font>opidioma<font color="#808080">) = </font>sreg <font color="#000080"><b>then
   if </b></font>ctacao.item<font color="#808080">(</font>opnovo<font color="#808080">) = </font>sacao <font color="#000080"><b>then
      </b></font>tidioma.set_codigo<font color="#808080">(</font>pesqmaxcod<font color="#808080">(</font>tfidioma<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">, </font>tamreg<font color="#808080">(</font>sreg<font color="#808080">)));
      </font>mostrardados<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">);
      </font>submenu<font color="#808080">(</font><font color="#FF0000">7</font><font color="#808080">, </font>sreg<font color="#808080">);
   </font><font color="#000080"><b>elseif </b></font>ctacao.item<font color="#808080">(</font>oppesquisar<font color="#808080">) = </font>sacao <font color="#000080"><b>then
      </b></font>slinha<font color="#808080">:=</font>validaentrada<font color="#808080">(</font>tfidioma<font color="#808080">,</font>sreg<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font>tidioma.codigo<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#008080">false</font><font color="#808080">,</font>opnumero<font color="#808080">);
      </font><font color="#000080"><b>if </b></font>slinha.is_empty<font color="#808080">=</font><font color="#008080">false </font><font color="#000080"><b>then
        </b></font>mostrardados<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">);
        </font>mostrardados<font color="#808080">(</font>sreg<font color="#808080">, </font>slinha<font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">);
        </font>submenu<font color="#808080">(</font><font color="#FF0000">8</font><font color="#808080">, </font>sreg<font color="#808080">);
      </font><font color="#000080"><b>end</b></font><font color="#808080">;
   </font><font color="#000080"><b>elseif </b></font>ctacao.item<font color="#808080">(</font>opalterar<font color="#808080">) = </font>sacao <font color="#000080"><b>then
      </b></font>mostrardados<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">);
      </font>submenu<font color="#808080">(</font><font color="#FF0000">9</font><font color="#808080">, </font>sreg<font color="#808080">);
   </font><font color="#000080"><b>elseif </b></font>ctacao.item<font color="#808080">(</font>opexcluir<font color="#808080">) = </font>sacao <font color="#000080"><b>then
      </b></font>submenu<font color="#808080">(</font><font color="#FF0000">10</font><font color="#808080">, </font>sreg<font color="#808080">);
   </font><font color="#000080"><b>end</b></font><font color="#808080">;
</font><font color="#000080"><b>elseif </b></font>ctarqs.item<font color="#808080">(</font>oppais<font color="#808080">) = </font>sreg <font color="#000080"><b>then
   if </b></font>ctacao.item<font color="#808080">(</font>opnovo<font color="#808080">) = </font>sacao <font color="#000080"><b>then
      </b></font>io.put_string<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">));
      </font>tpais.set_codigo<font color="#808080">(</font>digita<font color="#808080">);
      </font>slinha<font color="#808080">:=</font>pesqarq<font color="#808080">(</font>tfpais<font color="#808080">, </font>tpais.codigo<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">, </font>tamreg<font color="#808080">(</font>sreg<font color="#808080">));
      </font><font color="#000080"><b>if </b></font>slinha.is_empty <font color="#000080"><b>then
         </b></font>pesqlinhaexcluida<font color="#808080">(</font>tfpais<font color="#808080">, </font>tamreg<font color="#808080">(</font>sreg<font color="#808080">));
         </font>mostrardados<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">);
         </font>submenu<font color="#808080">(</font><font color="#FF0000">7</font><font color="#808080">, </font>sreg<font color="#808080">);
      </font><font color="#000080"><b>else 
        </b></font>io.put_string<font color="#808080">(</font>msg_regexst<font color="#808080">);
      </font><font color="#000080"><b>end</b></font><font color="#808080">;
   </font><font color="#000080"><b>elseif </b></font>ctacao.item<font color="#808080">(</font>oppesquisar<font color="#808080">) = </font>sacao <font color="#000080"><b>then
      </b></font>slinha<font color="#808080">:=</font>validaentrada<font color="#808080">(</font>tfpais<font color="#808080">, </font>sreg<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font>tpais.codigo<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#008080">false</font><font color="#808080">, </font>optexto<font color="#808080">);
      </font><font color="#000080"><b>if </b></font>slinha.is_empty<font color="#808080">=</font><font color="#008080">false </font><font color="#000080"><b>then
        </b></font>mostrardados<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">);
        </font>mostrardados<font color="#808080">(</font>sreg<font color="#808080">, </font>slinha<font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">);
        </font>submenu<font color="#808080">(</font><font color="#FF0000">8</font><font color="#808080">, </font>sreg<font color="#808080">);
      </font><font color="#000080"><b>end</b></font><font color="#808080">;
   </font><font color="#000080"><b>elseif </b></font>ctacao.item<font color="#808080">(</font>opalterar<font color="#808080">) = </font>sacao <font color="#000080"><b>then
      </b></font>io.put_string<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">) + </font>tpais.codigo <font color="#808080">+ </font>crlf<font color="#808080">);
      </font>mostrardados<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">);
      </font>submenu<font color="#808080">(</font><font color="#FF0000">9</font><font color="#808080">, </font>sreg<font color="#808080">);
   </font><font color="#000080"><b>elseif </b></font>ctacao.item<font color="#808080">(</font>opexcluir<font color="#808080">) = </font>sacao <font color="#000080"><b>then
      </b></font>submenu<font color="#808080">(</font><font color="#FF0000">10</font><font color="#808080">, </font>sreg<font color="#808080">);
   </font><font color="#000080"><b>end</b></font><font color="#808080">;
</font><font color="#000080"><b>elseif </b></font>ctarqs.item<font color="#808080">(</font>opprofissao<font color="#808080">) = </font>sreg <font color="#000080"><b>then
   if </b></font>ctacao.item<font color="#808080">(</font>opnovo<font color="#808080">) = </font>sacao <font color="#000080"><b>then
      </b></font>tprofissao.set_codigo<font color="#808080">(</font>pesqmaxcod<font color="#808080">(</font>tfprofissao<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">, </font>tamreg<font color="#808080">(</font>sreg<font color="#808080">)));
      </font>mostrardados<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">);
      </font>submenu<font color="#808080">(</font><font color="#FF0000">7</font><font color="#808080">, </font>sreg<font color="#808080">);
   </font><font color="#000080"><b>elseif </b></font>ctacao.item<font color="#808080">(</font>oppesquisar<font color="#808080">) = </font>sacao <font color="#000080"><b>then
      </b></font>slinha<font color="#808080">:=</font>validaentrada<font color="#808080">(</font>tfprofissao<font color="#808080">,</font>sreg<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font>tprofissao.codigo<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,
              </font><font color="#008080">false</font><font color="#808080">,</font>opnumero<font color="#808080">);
      </font><font color="#000080"><b>if </b></font>slinha.is_empty<font color="#808080">=</font><font color="#008080">false </font><font color="#000080"><b>then
        </b></font>mostrardados<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">);
        </font>mostrardados<font color="#808080">(</font>sreg<font color="#808080">, </font>slinha<font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">);
        </font>submenu<font color="#808080">(</font><font color="#FF0000">8</font><font color="#808080">, </font>sreg<font color="#808080">);
      </font><font color="#000080"><b>end</b></font><font color="#808080">;
   </font><font color="#000080"><b>elseif </b></font>ctacao.item<font color="#808080">(</font>opalterar<font color="#808080">) = </font>sacao <font color="#000080"><b>then
      </b></font>mostrardados<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">);
      </font>submenu<font color="#808080">(</font><font color="#FF0000">9</font><font color="#808080">, </font>sreg<font color="#808080">);
   </font><font color="#000080"><b>elseif </b></font>ctacao.item<font color="#808080">(</font>opexcluir<font color="#808080">) = </font>sacao <font color="#000080"><b>then
      </b></font>submenu<font color="#808080">(</font><font color="#FF0000">10</font><font color="#808080">, </font>sreg<font color="#808080">);
   </font><font color="#000080"><b>end</b></font><font color="#808080">;
</font><font color="#000080"><b>elseif </b></font>ctarqs.item<font color="#808080">(</font>oplivro<font color="#808080">) = </font>sreg <font color="#000080"><b>then
   if </b></font>ctacao.item<font color="#808080">(</font>opnovo<font color="#808080">) = </font>sacao <font color="#000080"><b>then
      </b></font>io.put_string<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">));
      </font>tlivro.set_isbn<font color="#808080">(</font>digita<font color="#808080">);
      </font><font color="#000080"><b>if </b></font>validaisbn<font color="#808080">(</font>tlivro.isbn<font color="#808080">) </font><font color="#000080"><b>then
          </b></font>slinha<font color="#808080">:=</font>pesqarq<font color="#808080">(</font>tflivro<font color="#808080">, </font>tlivro.isbn<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">13</font><font color="#808080">, </font>tamreg<font color="#808080">(</font>sreg<font color="#808080">));
          </font><font color="#000080"><b>if </b></font>slinha.is_empty <font color="#000080"><b>then
             </b></font>pesqlinhaexcluida<font color="#808080">(</font>tflivro<font color="#808080">, </font>tamreg<font color="#808080">(</font>sreg<font color="#808080">));
             </font>mostrardados<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">);
             </font>submenu<font color="#808080">(</font><font color="#FF0000">7</font><font color="#808080">, </font>sreg<font color="#808080">);
             </font>frmcadligados<font color="#808080">(</font>oplivroass<font color="#808080">, </font>opnovo<font color="#808080">, </font>tlivro.isbn<font color="#808080">);
             </font>frmcadligados<font color="#808080">(</font>oplivroaut<font color="#808080">, </font>opnovo<font color="#808080">, </font>tlivro.isbn<font color="#808080">);
          </font><font color="#000080"><b>else 
             </b></font>io.put_string<font color="#808080">(</font>msg_regexst<font color="#808080">);
          </font><font color="#000080"><b>end</b></font><font color="#808080">;
      </font><font color="#000080"><b>else 
        </b></font>io.put_string<font color="#808080">(</font>msg_isbninv<font color="#808080">);
      </font><font color="#000080"><b>end</b></font><font color="#808080">; 
   </font><font color="#000080"><b>elseif </b></font>ctacao.item<font color="#808080">(</font>oppesquisar<font color="#808080">) = </font>sacao <font color="#000080"><b>then
      </b></font>slinha<font color="#808080">:=</font>validaentrada<font color="#808080">(</font>tflivro<font color="#808080">, </font>sreg<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font>tlivro.isbn<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#008080">false</font><font color="#808080">,</font>optexto<font color="#808080">);
      </font><font color="#000080"><b>if </b></font>slinha.is_empty<font color="#808080">=</font><font color="#008080">false </font><font color="#000080"><b>then
         </b></font>mostrardados<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">);
         </font>mostrardados<font color="#808080">(</font>sreg<font color="#808080">, </font>slinha<font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">);
         </font>submenu<font color="#808080">(</font><font color="#FF0000">8</font><font color="#808080">, </font>sreg<font color="#808080">);
      </font><font color="#000080"><b>end</b></font><font color="#808080">;
   </font><font color="#000080"><b>elseif </b></font>ctacao.item<font color="#808080">(</font>opalterar<font color="#808080">) = </font>sacao <font color="#000080"><b>then
      </b></font>io.put_string<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">) + </font>tlivro.isbn <font color="#808080">+ </font>crlf<font color="#808080">);
      </font>mostrardados<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">);
      </font>submenu<font color="#808080">(</font><font color="#FF0000">9</font><font color="#808080">, </font>sreg<font color="#808080">);
      </font>frmcadligados<font color="#808080">(</font>oplivroass<font color="#808080">, </font>opexcluir<font color="#808080">, </font>tlivro.isbn<font color="#808080">);
      </font>io.put_string<font color="#808080">(</font><font color="#800000">&quot;assuntos dos livros exclu&iacute;dos, inclua novos!%N&quot;</font><font color="#808080">);
      </font>frmcadligados<font color="#808080">(</font>oplivroass<font color="#808080">, </font>opnovo<font color="#808080">, </font>tlivro.isbn<font color="#808080">);
      </font>frmcadligados<font color="#808080">(</font>oplivroaut<font color="#808080">, </font>opexcluir<font color="#808080">, </font>tlivro.isbn<font color="#808080">);
      </font>io.put_string<font color="#808080">(</font><font color="#800000">&quot;autores dos livros exclu&iacute;dos, inclua novos!%N&quot;</font><font color="#808080">);
      </font>frmcadligados<font color="#808080">(</font>oplivroaut<font color="#808080">, </font>opnovo<font color="#808080">, </font>tlivro.isbn<font color="#808080">);
   </font><font color="#000080"><b>elseif </b></font>ctacao.item<font color="#808080">(</font>opexcluir<font color="#808080">) = </font>sacao <font color="#000080"><b>then
      </b></font>submenu<font color="#808080">(</font><font color="#FF0000">10</font><font color="#808080">, </font>sreg<font color="#808080">);
      </font>io.put_string<font color="#808080">(</font><font color="#800000">&quot;assuntos dos livros sendo exclu&iacute;dos!%N&quot;</font><font color="#808080">);
      </font>frmcadligados<font color="#808080">(</font>oplivroass<font color="#808080">, </font>opexcluir<font color="#808080">, </font>tlivro.isbn<font color="#808080">);
      </font>io.put_string<font color="#808080">(</font><font color="#800000">&quot;autores dos livros sendo exclu&iacute;dos!%N&quot;</font><font color="#808080">);
      </font>frmcadligados<font color="#808080">(</font>oplivroaut<font color="#808080">, </font>opexcluir<font color="#808080">, </font>tlivro.isbn<font color="#808080">);
   </font><font color="#000080"><b>end</b></font><font color="#808080">;
</font><font color="#000080"><b>elseif </b></font>ctarqs.item<font color="#808080">(</font>opcliente<font color="#808080">) = </font>sreg <font color="#000080"><b>then
   if </b></font>ctacao.item<font color="#808080">(</font>opnovo<font color="#808080">) = </font>sacao <font color="#000080"><b>then
      </b></font>io.put_string<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">));
      </font>tcliente.set_cpf<font color="#808080">(</font>digita<font color="#808080">);
      </font><font color="#000080"><b>if </b></font>validacpf<font color="#808080">(</font>tcliente.cpf<font color="#808080">) </font><font color="#000080"><b>then
          </b></font>slinha<font color="#808080">:=</font>pesqarq<font color="#808080">(</font>tfcliente<font color="#808080">, </font>tcliente.cpf<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">14</font><font color="#808080">, </font>tamreg<font color="#808080">(</font>sreg<font color="#808080">));
          </font><font color="#000080"><b>if </b></font>slinha.is_empty <font color="#000080"><b>then
             </b></font>pesqlinhaexcluida<font color="#808080">(</font>tfcliente<font color="#808080">, </font>tamreg<font color="#808080">(</font>sreg<font color="#808080">));
             </font>mostrardados<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">);
             </font>submenu<font color="#808080">(</font><font color="#FF0000">7</font><font color="#808080">, </font>sreg<font color="#808080">);
          </font><font color="#000080"><b>else 
            </b></font>io.put_string<font color="#808080">(</font>msg_regexst<font color="#808080">);
          </font><font color="#000080"><b>end</b></font><font color="#808080">;
      </font><font color="#000080"><b>else 
        </b></font>io.put_string<font color="#808080">(</font>msg_cpfinv<font color="#808080">);
      </font><font color="#000080"><b>end</b></font><font color="#808080">;
   </font><font color="#000080"><b>elseif </b></font>ctacao.item<font color="#808080">(</font>oppesquisar<font color="#808080">) = </font>sacao <font color="#000080"><b>then
      </b></font>slinha<font color="#808080">:=</font>validaentrada<font color="#808080">(</font>tfcliente<font color="#808080">, </font>sreg<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font>tcliente.cpf<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#008080">false</font><font color="#808080">,</font>optexto<font color="#808080">);
      </font><font color="#000080"><b>if </b></font>slinha.is_empty<font color="#808080">=</font><font color="#008080">false </font><font color="#000080"><b>then
         </b></font>mostrardados<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">);
         </font>mostrardados<font color="#808080">(</font>sreg<font color="#808080">, </font>slinha<font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">);
         </font>submenu<font color="#808080">(</font><font color="#FF0000">8</font><font color="#808080">, </font>sreg<font color="#808080">);
      </font><font color="#000080"><b>end</b></font><font color="#808080">;
   </font><font color="#000080"><b>elseif </b></font>ctacao.item<font color="#808080">(</font>opalterar<font color="#808080">) = </font>sacao <font color="#000080"><b>then
      </b></font>io.put_string<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">) + </font>tcliente.cpf <font color="#808080">+ </font>crlf<font color="#808080">);
      </font>mostrardados<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">);
      </font>submenu<font color="#808080">(</font><font color="#FF0000">9</font><font color="#808080">, </font>sreg<font color="#808080">);
   </font><font color="#000080"><b>elseif </b></font>ctacao.item<font color="#808080">(</font>opexcluir<font color="#808080">) = </font>sacao <font color="#000080"><b>then
      </b></font>submenu<font color="#808080">(</font><font color="#FF0000">10</font><font color="#808080">, </font>sreg<font color="#808080">);
   </font><font color="#000080"><b>end</b></font><font color="#808080">;
</font><font color="#000080"><b>elseif </b></font>ctarqs.item<font color="#808080">(</font>opvenda<font color="#808080">) = </font>sreg <font color="#000080"><b>then
   if </b></font>ctacao.item<font color="#808080">(</font>opnovo<font color="#808080">) = </font>sacao <font color="#000080"><b>then
      </b></font>tvenda.set_dthrvenda<font color="#808080">(</font>retdatahora<font color="#808080">);
      </font>io.put_string<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">) + </font>tvenda.dthrvenda <font color="#808080">+ </font>crlf<font color="#808080">);
      </font>slinha<font color="#808080">:=</font>pesqarq<font color="#808080">(</font>tfvenda<font color="#808080">, </font>tvenda.dthrvenda<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">19</font><font color="#808080">, </font>tamreg<font color="#808080">(</font>sreg<font color="#808080">));
      </font><font color="#000080"><b>if </b></font>slinha.is_empty <font color="#000080"><b>then
         </b></font>slinha<font color="#808080">:=</font>validaentrada<font color="#808080">(</font>tfcliente<font color="#808080">,</font>opcliente<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font>tvenda.cpf<font color="#808080">,</font><font color="#FF0000">3</font><font color="#808080">,
                 </font><font color="#008080">false</font><font color="#808080">,</font>optexto<font color="#808080">);
         </font><font color="#000080"><b>if </b></font>slinha.is_empty<font color="#808080">=</font><font color="#008080">false </font><font color="#000080"><b>then
            </b></font>tvenda.set_cpf<font color="#808080">(</font>trim<font color="#808080">(</font>substr<font color="#808080">(</font>slinha<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#FF0000">14</font><font color="#808080">)));
            </font><font color="#000080"><b>if </b></font>validacpf<font color="#808080">(</font>tvenda.cpf<font color="#808080">) </font><font color="#000080"><b>then
               </b></font>io.put_string<font color="#808080">(</font><font color="#800000">&quot; &quot; </font><font color="#808080">+ </font>rotulo<font color="#808080">(</font>opcliente<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">)); -- nome
               </font>io.put_string<font color="#808080">(</font>substr<font color="#808080">(</font>slinha<font color="#808080">, </font>g_nposchave<font color="#808080">, </font>g_ntamchave<font color="#808080">) + </font>crlf<font color="#808080">);
               </font>frmcadligados<font color="#808080">(</font>opvenda<font color="#808080">, </font>opnovo<font color="#808080">, </font>tvenda.cpf<font color="#808080">);
            </font><font color="#000080"><b>else 
               </b></font>io.put_string<font color="#808080">(</font>msg_cpfinv<font color="#808080">);
            </font><font color="#000080"><b>end</b></font><font color="#808080">;
         </font><font color="#000080"><b>end</b></font><font color="#808080">;
      </font><font color="#000080"><b>else 
        </b></font>io.put_string<font color="#808080">(</font>msg_regexst<font color="#808080">);
      </font><font color="#000080"><b>end</b></font><font color="#808080">;
   </font><font color="#000080"><b>elseif </b></font>ctacao.item<font color="#808080">(</font>oppesquisar<font color="#808080">) = </font>sacao <font color="#000080"><b>then
      </b></font>slinha<font color="#808080">:=</font>validaentrada<font color="#808080">(</font>tfvenda<font color="#808080">, </font>sreg<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font>tvenda.dthrvenda<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,
              </font><font color="#008080">false</font><font color="#808080">,</font>opdatahora<font color="#808080">);
      </font><font color="#000080"><b>if </b></font>slinha.is_empty<font color="#808080">=</font><font color="#008080">false </font><font color="#000080"><b>then
        </b></font>mostrardados<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">);
        </font>mostrardados<font color="#808080">(</font>sreg<font color="#808080">, </font>slinha<font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">);
        </font>submenu<font color="#808080">(</font><font color="#FF0000">8</font><font color="#808080">, </font>sreg<font color="#808080">);
      </font><font color="#000080"><b>end</b></font><font color="#808080">;
   </font><font color="#000080"><b>end</b></font><font color="#808080">;
</font><font color="#000080"><b>end</b></font><font color="#808080">;

</font><font color="#000080"><b>end</b></font><font color="#808080">;
-- ----------------------------------------------------------------------------
-- realiza as consultas de acordo com o tipo de arquivo.
-- sreg - o tipo de arquivo
-- sacao - a a&ccedil;&atilde;o a ser realizada
-- ----------------------------------------------------------------------------
</font>frmconsultas<font color="#808080">(</font>sreg<font color="#808080">, </font>sacao<font color="#808080">: </font><font color="#0000FF">INTEGER</font><font color="#808080">) </font><font color="#000080"><b>is
local
  </b></font>slinha<font color="#808080">: </font><font color="#0000FF">STRING</font><font color="#808080">;
</font><font color="#000080"><b>do
</b></font>slinha<font color="#808080">:=</font><font color="#800000">&quot;&quot;</font><font color="#808080">;
</font><font color="#000080"><b>if </b></font>ctarqs.item<font color="#808080">(</font>opassunto<font color="#808080">) = </font>sreg <font color="#000080"><b>then
   if </b></font>ctacao.item<font color="#808080">(</font>oppesquisar<font color="#808080">) = </font>sacao <font color="#000080"><b>then
      </b></font>slinha<font color="#808080">:=</font>validaentrada<font color="#808080">(</font>tfassunto<font color="#808080">,</font>sreg<font color="#808080">,</font><font color="#FF0000">2</font><font color="#808080">,</font>tassunto.assunto<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#008080">true</font><font color="#808080">,</font>optexto<font color="#808080">)
   </font><font color="#000080"><b>elseif </b></font>ctacao.item<font color="#808080">(</font>oplistartodos<font color="#808080">) = </font>sacao <font color="#000080"><b>then
      if </b></font>listartodos<font color="#808080">(</font>tfassunto<font color="#808080">, </font>sreg<font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font>tamreg<font color="#808080">(</font>sreg<font color="#808080">),
        </font>qtd_max_linha<font color="#808080">, </font><font color="#008080">false</font><font color="#808080">) = </font><font color="#008080">false </font><font color="#000080"><b>then
        </b></font>io.put_string<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">));
      </font><font color="#000080"><b>end</b></font><font color="#808080">;
   </font><font color="#000080"><b>end</b></font><font color="#808080">;
</font><font color="#000080"><b>elseif </b></font>ctarqs.item<font color="#808080">(</font>opautor<font color="#808080">) = </font>sreg <font color="#000080"><b>then
   if </b></font>ctacao.item<font color="#808080">(</font>oppesquisar<font color="#808080">) = </font>sacao <font color="#000080"><b>then
      </b></font>slinha<font color="#808080">:=</font>validaentrada<font color="#808080">(</font>tfautor<font color="#808080">,</font>sreg<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">, </font>tautor.autor<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#008080">true</font><font color="#808080">,</font>optexto<font color="#808080">)
   </font><font color="#000080"><b>elseif </b></font>ctacao.item<font color="#808080">(</font>oplistartodos<font color="#808080">) = </font>sacao <font color="#000080"><b>then
      if </b></font>listartodos<font color="#808080">(</font>tfautor<font color="#808080">, </font>sreg<font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font>tamreg<font color="#808080">(</font>sreg<font color="#808080">),
        </font>qtd_max_linha<font color="#808080">, </font><font color="#008080">false</font><font color="#808080">) = </font><font color="#008080">false </font><font color="#000080"><b>then
        </b></font>io.put_string<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">));
      </font><font color="#000080"><b>end</b></font><font color="#808080">;
   </font><font color="#000080"><b>end</b></font><font color="#808080">;
</font><font color="#000080"><b>elseif </b></font>ctarqs.item<font color="#808080">(</font>opeditora<font color="#808080">) = </font>sreg <font color="#000080"><b>then
   if </b></font>ctacao.item<font color="#808080">(</font>oppesquisar<font color="#808080">) = </font>sacao <font color="#000080"><b>then
      </b></font>slinha<font color="#808080">:=</font>validaentrada<font color="#808080">(</font>tfeditora<font color="#808080">,</font>sreg<font color="#808080">,</font><font color="#FF0000">2</font><font color="#808080">,</font>teditora.editora<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#008080">true</font><font color="#808080">,</font>optexto<font color="#808080">)
   </font><font color="#000080"><b>elseif </b></font>ctacao.item<font color="#808080">(</font>oplistartodos<font color="#808080">) = </font>sacao <font color="#000080"><b>then
      if </b></font>listartodos<font color="#808080">(</font>tfeditora<font color="#808080">, </font>sreg<font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font>tamreg<font color="#808080">(</font>sreg<font color="#808080">),
        </font>qtd_max_linha<font color="#808080">, </font><font color="#008080">false</font><font color="#808080">) = </font><font color="#008080">false </font><font color="#000080"><b>then
        </b></font>io.put_string<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">));
      </font><font color="#000080"><b>end</b></font><font color="#808080">;
   </font><font color="#000080"><b>end</b></font><font color="#808080">;
</font><font color="#000080"><b>elseif </b></font>ctarqs.item<font color="#808080">(</font>opendereco<font color="#808080">) = </font>sreg <font color="#000080"><b>then
   if </b></font>ctacao.item<font color="#808080">(</font>oppesquisar<font color="#808080">) = </font>sacao <font color="#000080"><b>then
      </b></font>slinha<font color="#808080">:=</font>validaentrada<font color="#808080">(</font>tfendereco<font color="#808080">,</font>sreg<font color="#808080">,</font><font color="#FF0000">2</font><font color="#808080">,</font>tendereco.logradouro<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,
              </font><font color="#008080">true</font><font color="#808080">,</font>optexto<font color="#808080">)
   </font><font color="#000080"><b>elseif </b></font>ctacao.item<font color="#808080">(</font>oplistartodos<font color="#808080">) = </font>sacao <font color="#000080"><b>then
      if </b></font>listartodos<font color="#808080">(</font>tfendereco<font color="#808080">, </font>sreg<font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font>tamreg<font color="#808080">(</font>sreg<font color="#808080">),
         </font><font color="#FF0000">3</font><font color="#808080">, </font><font color="#008080">false</font><font color="#808080">) = </font><font color="#008080">false </font><font color="#000080"><b>then
        </b></font>io.put_string<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">));
      </font><font color="#000080"><b>end</b></font><font color="#808080">;
   </font><font color="#000080"><b>end</b></font><font color="#808080">;
</font><font color="#000080"><b>elseif </b></font>ctarqs.item<font color="#808080">(</font>opidioma<font color="#808080">) = </font>sreg <font color="#000080"><b>then
   if </b></font>ctacao.item<font color="#808080">(</font>oppesquisar<font color="#808080">) = </font>sacao <font color="#000080"><b>then
      </b></font>slinha<font color="#808080">:=</font>validaentrada<font color="#808080">(</font>tfidioma<font color="#808080">, </font>sreg<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">, </font>tidioma.idioma<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#008080">true</font><font color="#808080">,</font>optexto<font color="#808080">)
   </font><font color="#000080"><b>elseif </b></font>ctacao.item<font color="#808080">(</font>oplistartodos<font color="#808080">) = </font>sacao <font color="#000080"><b>then
      if </b></font>listartodos<font color="#808080">(</font>tfidioma<font color="#808080">, </font>sreg<font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font>tamreg<font color="#808080">(</font>sreg<font color="#808080">),
        </font>qtd_max_linha<font color="#808080">, </font><font color="#008080">false</font><font color="#808080">) = </font><font color="#008080">false </font><font color="#000080"><b>then
        </b></font>io.put_string<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">));
      </font><font color="#000080"><b>end</b></font><font color="#808080">;
   </font><font color="#000080"><b>end</b></font><font color="#808080">;
</font><font color="#000080"><b>elseif </b></font>ctarqs.item<font color="#808080">(</font>oppais<font color="#808080">) = </font>sreg <font color="#000080"><b>then
   if </b></font>ctacao.item<font color="#808080">(</font>oppesquisar<font color="#808080">) = </font>sacao <font color="#000080"><b>then
      </b></font>slinha<font color="#808080">:=</font>validaentrada<font color="#808080">(</font>tfpais<font color="#808080">, </font>sreg<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">, </font>tpais.pais<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#008080">true</font><font color="#808080">,</font>optexto<font color="#808080">)
   </font><font color="#000080"><b>elseif </b></font>ctacao.item<font color="#808080">(</font>oplistartodos<font color="#808080">) = </font>sacao <font color="#000080"><b>then
      if </b></font>listartodos<font color="#808080">(</font>tfpais<font color="#808080">, </font>sreg<font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font>tamreg<font color="#808080">(</font>sreg<font color="#808080">),
        </font>qtd_max_linha<font color="#808080">, </font><font color="#008080">false</font><font color="#808080">) = </font><font color="#008080">false </font><font color="#000080"><b>then
        </b></font>io.put_string<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">));
      </font><font color="#000080"><b>end</b></font><font color="#808080">;
   </font><font color="#000080"><b>end</b></font><font color="#808080">;
</font><font color="#000080"><b>elseif </b></font>ctarqs.item<font color="#808080">(</font>opprofissao<font color="#808080">) = </font>sreg <font color="#000080"><b>then
   if </b></font>ctacao.item<font color="#808080">(</font>oppesquisar<font color="#808080">) = </font>sacao <font color="#000080"><b>then
     </b></font>slinha<font color="#808080">:=</font>validaentrada<font color="#808080">(</font>tfprofissao<font color="#808080">,</font>sreg<font color="#808080">,</font><font color="#FF0000">2</font><font color="#808080">,</font>tprofissao.profissao<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,
             </font><font color="#008080">true</font><font color="#808080">,</font>optexto<font color="#808080">)
   </font><font color="#000080"><b>elseif </b></font>ctacao.item<font color="#808080">(</font>oplistartodos<font color="#808080">) = </font>sacao <font color="#000080"><b>then
      if </b></font>listartodos<font color="#808080">(</font>tfprofissao<font color="#808080">, </font>sreg<font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font>tamreg<font color="#808080">(</font>sreg<font color="#808080">),
        </font>qtd_max_linha<font color="#808080">, </font><font color="#008080">false</font><font color="#808080">) = </font><font color="#008080">false </font><font color="#000080"><b>then
        </b></font>io.put_string<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">));
      </font><font color="#000080"><b>end</b></font><font color="#808080">;
   </font><font color="#000080"><b>end</b></font><font color="#808080">;
</font><font color="#000080"><b>elseif </b></font>ctarqs.item<font color="#808080">(</font>oplivro<font color="#808080">) = </font>sreg <font color="#000080"><b>then
   if </b></font>ctacao.item<font color="#808080">(</font>oppesquisar<font color="#808080">) = </font>sacao <font color="#000080"><b>then
      </b></font>slinha<font color="#808080">:=</font>validaentrada<font color="#808080">(</font>tflivro<font color="#808080">, </font>sreg<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">, </font>tlivro.titulo<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#008080">true</font><font color="#808080">,</font>optexto<font color="#808080">)
   </font><font color="#000080"><b>elseif </b></font>ctacao.item<font color="#808080">(</font>oplistartodos<font color="#808080">) = </font>sacao <font color="#000080"><b>then
      if </b></font>listartodos<font color="#808080">(</font>tflivro<font color="#808080">, </font>sreg<font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font>tamreg<font color="#808080">(</font>sreg<font color="#808080">),
        </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#008080">false</font><font color="#808080">) = </font><font color="#008080">false </font><font color="#000080"><b>then
        </b></font>io.put_string<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">));
      </font><font color="#000080"><b>end</b></font><font color="#808080">;
   </font><font color="#000080"><b>end</b></font><font color="#808080">;
</font><font color="#000080"><b>elseif </b></font>ctarqs.item<font color="#808080">(</font>opcliente<font color="#808080">) = </font>sreg <font color="#000080"><b>then
   if </b></font>ctacao.item<font color="#808080">(</font>oppesquisar<font color="#808080">) = </font>sacao <font color="#000080"><b>then
      </b></font>slinha<font color="#808080">:=</font>validaentrada<font color="#808080">(</font>tfcliente<font color="#808080">, </font>sreg<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">, </font>tcliente.nome<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#008080">true</font><font color="#808080">,</font>optexto<font color="#808080">)
   </font><font color="#000080"><b>elseif </b></font>ctacao.item<font color="#808080">(</font>oplistartodos<font color="#808080">) = </font>sacao <font color="#000080"><b>then
      if </b></font>listartodos<font color="#808080">(</font>tfcliente<font color="#808080">, </font>sreg<font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font>tamreg<font color="#808080">(</font>sreg<font color="#808080">),
        </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#008080">false</font><font color="#808080">) = </font><font color="#008080">false </font><font color="#000080"><b>then
        </b></font>io.put_string<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">));
      </font><font color="#000080"><b>end</b></font><font color="#808080">;
   </font><font color="#000080"><b>end</b></font><font color="#808080">;
</font><font color="#000080"><b>elseif </b></font>ctarqs.item<font color="#808080">(</font>opvenda<font color="#808080">) = </font>sreg <font color="#000080"><b>then
   if </b></font>ctacao.item<font color="#808080">(</font>oppesquisar<font color="#808080">) = </font>sacao <font color="#000080"><b>then
      </b></font>slinha<font color="#808080">:=</font>validaentrada<font color="#808080">(</font>tfvenda<font color="#808080">, </font>sreg<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">, </font>tvenda.cpf<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#008080">true</font><font color="#808080">,</font>optexto<font color="#808080">)
   </font><font color="#000080"><b>elseif </b></font>ctacao.item<font color="#808080">(</font>oplistartodos<font color="#808080">) = </font>sacao <font color="#000080"><b>then
      if </b></font>listartodos<font color="#808080">(</font>tfvenda<font color="#808080">, </font>sreg<font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font>tamreg<font color="#808080">(</font>sreg<font color="#808080">),
        </font>qtd_max_linha<font color="#808080">, </font><font color="#008080">false</font><font color="#808080">) = </font><font color="#008080">false </font><font color="#000080"><b>then
        </b></font>io.put_string<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">));
      </font><font color="#000080"><b>end</b></font><font color="#808080">;
   </font><font color="#000080"><b>end</b></font><font color="#808080">;
</font><font color="#000080"><b>end</b></font><font color="#808080">;
</font><font color="#000080"><b>if </b></font>slinha.is_empty <font color="#000080"><b>then
   </b></font>io.put_string<font color="#808080">(</font><font color="#800000">&quot;&quot;</font><font color="#808080">);
</font><font color="#000080"><b>end</b></font><font color="#808080">;
</font><font color="#000080"><b>end</b></font><font color="#808080">;
-- ----------------------------------------------------------------------------
-- mostra a tela de altera&ccedil;&atilde;o de senha do sistema e realiza a altera&ccedil;&atilde;o.
-- ----------------------------------------------------------------------------
</font>frmalterarsenha <font color="#000080"><b>is
local
  </b></font>bquebra<font color="#808080">: </font><font color="#0000FF">BOOLEAN</font><font color="#808080">;
  </font>sres<font color="#808080">, </font>ssenhaatual<font color="#808080">, </font>snovasenha<font color="#808080">, </font>sconfirmasenha<font color="#808080">: </font><font color="#0000FF">STRING</font><font color="#808080">;
  </font>nopcao<font color="#808080">: </font><font color="#0000FF">INTEGER</font><font color="#808080">;
</font><font color="#000080"><b>do
</b></font>io.put_string<font color="#808080">(</font>rotulo<font color="#808080">(</font>opusuario<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">) + </font>tusuario.login <font color="#808080">+ </font>crlf<font color="#808080">);
</font><font color="#000080"><b>from
  </b></font>nopcao<font color="#808080">:=</font><font color="#FF0000">1</font><font color="#808080">;
  </font>bquebra<font color="#808080">:=</font><font color="#008080">false</font><font color="#808080">;
</font><font color="#000080"><b>until
  </b></font>bquebra<font color="#808080">=</font><font color="#008080">true
</font><font color="#000080"><b>loop
  inspect </b></font>nopcao
    <font color="#000080"><b>when </b></font><font color="#FF0000">1 </font><font color="#000080"><b>then
       </b></font>ssenhaatual<font color="#808080">:=</font>digitasenha<font color="#808080">(</font><font color="#800000">&quot;Senha Atual: &quot;</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">);
       </font><font color="#000080"><b>if </b></font>ssenhaatual.is_equal<font color="#808080">(</font>tusuario.senha<font color="#808080">)=</font><font color="#008080">false </font><font color="#000080"><b>then
          </b></font>io.put_string<font color="#808080">(</font>msg_senconfere<font color="#808080">);
          </font>bquebra<font color="#808080">:=</font><font color="#008080">true</font><font color="#808080">;
       </font><font color="#000080"><b>else 
          </b></font>nopcao<font color="#808080">:=</font><font color="#FF0000">2</font><font color="#808080">;
       </font><font color="#000080"><b>end</b></font><font color="#808080">;
    </font><font color="#000080"><b>when </b></font><font color="#FF0000">2 </font><font color="#000080"><b>then
       </b></font>snovasenha<font color="#808080">:=</font>digitasenha<font color="#808080">(</font><font color="#800000">&quot;Nova Senha: &quot;</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">);
       </font>sconfirmasenha<font color="#808080">:=</font>digitasenha<font color="#808080">(</font><font color="#800000">&quot;Confirma Senha: &quot;</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">);
       </font><font color="#000080"><b>if </b></font>snovasenha.is_equal<font color="#808080">(</font>sconfirmasenha<font color="#808080">)=</font><font color="#008080">false </font><font color="#000080"><b>then
          </b></font>io.put_string<font color="#808080">(</font>msg_senconfirm<font color="#808080">);
          </font>bquebra<font color="#808080">:=</font><font color="#008080">true</font><font color="#808080">;
       </font><font color="#000080"><b>else 
          </b></font>nopcao<font color="#808080">:=</font><font color="#FF0000">3</font><font color="#808080">;
       </font><font color="#000080"><b>end</b></font><font color="#808080">;
    </font><font color="#000080"><b>when </b></font><font color="#FF0000">3 </font><font color="#000080"><b>then
       </b></font>sres<font color="#808080">:=</font>pesqarq<font color="#808080">(</font>tfusuario<font color="#808080">, </font>tusuario.login<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">, </font>tamreg<font color="#808080">(</font>opusuario<font color="#808080">));
       </font><font color="#000080"><b>if </b></font>sres.is_empty <font color="#000080"><b>then
         </b></font>io.put_string<font color="#808080">(</font>msg_loginencon<font color="#808080">)
       </font><font color="#000080"><b>else
         </b></font>tusuario.set_senha<font color="#808080">(</font>sconfirmasenha<font color="#808080">);
         </font>submenu<font color="#808080">(</font><font color="#FF0000">9</font><font color="#808080">,</font>opusuario<font color="#808080">);
         </font>bquebra<font color="#808080">:=</font><font color="#008080">true</font><font color="#808080">;
       </font><font color="#000080"><b>end</b></font><font color="#808080">;
  </font><font color="#000080"><b>end</b></font><font color="#808080">;
</font><font color="#000080"><b>end</b></font><font color="#808080">;

</font><font color="#000080"><b>end</b></font><font color="#808080">;
-- ----------------------------------------------------------------------------
-- Executa uma a&ccedil;&atilde;o de grava&ccedil;&atilde;o de acordo com o tipo de arquivo.
-- sreg - o tipo de arquivo
-- sacao - a a&ccedil;&atilde;o a ser realizada
-- ----------------------------------------------------------------------------
</font>btnacao<font color="#808080">(</font>sreg<font color="#808080">, </font>sacao<font color="#808080">: </font><font color="#0000FF">INTEGER</font><font color="#808080">) </font><font color="#000080"><b>is
do
if </b></font>ctarqs.item<font color="#808080">(</font>opassunto<font color="#808080">) = </font>sreg <font color="#000080"><b>then
  if </b></font>ctacao.item<font color="#808080">(</font>opsalvarinclusao<font color="#808080">) = </font>sacao <font color="#000080"><b>then
    </b></font>escrevearq<font color="#808080">(</font>tfassunto<font color="#808080">, </font>linhareg<font color="#808080">(</font>sreg<font color="#808080">), </font>msg_reginc<font color="#808080">, </font>msg_regninc<font color="#808080">)
  </font><font color="#000080"><b>elseif </b></font>ctacao.item<font color="#808080">(</font>opsalvaralteracao<font color="#808080">) = </font>sacao <font color="#000080"><b>then
    </b></font>escrevearq<font color="#808080">(</font>tfassunto<font color="#808080">, </font>linhareg<font color="#808080">(</font>sreg<font color="#808080">), </font>msg_regalt<font color="#808080">, </font>msg_regnalt<font color="#808080">)
  </font><font color="#000080"><b>elseif </b></font>ctacao.item<font color="#808080">(</font>opconfirmaexclusao<font color="#808080">) = </font>sacao <font color="#000080"><b>then
    </b></font>escrevearq<font color="#808080">(</font>tfassunto<font color="#808080">, </font>repete<font color="#808080">('*',</font>tamreg<font color="#808080">(</font>sreg<font color="#808080">)), </font>msg_regexc<font color="#808080">, </font>msg_regnexc<font color="#808080">);
  </font><font color="#000080"><b>end</b></font><font color="#808080">;
</font><font color="#000080"><b>elseif </b></font>ctarqs.item<font color="#808080">(</font>opautor<font color="#808080">) = </font>sreg <font color="#000080"><b>then
  if </b></font>ctacao.item<font color="#808080">(</font>opsalvarinclusao<font color="#808080">) = </font>sacao <font color="#000080"><b>then
    </b></font>escrevearq<font color="#808080">(</font>tfautor<font color="#808080">, </font>linhareg<font color="#808080">(</font>sreg<font color="#808080">), </font>msg_reginc<font color="#808080">, </font>msg_regninc<font color="#808080">)
  </font><font color="#000080"><b>elseif </b></font>ctacao.item<font color="#808080">(</font>opsalvaralteracao<font color="#808080">) = </font>sacao <font color="#000080"><b>then
    </b></font>escrevearq<font color="#808080">(</font>tfautor<font color="#808080">, </font>linhareg<font color="#808080">(</font>sreg<font color="#808080">), </font>msg_regalt<font color="#808080">, </font>msg_regnalt<font color="#808080">)
  </font><font color="#000080"><b>elseif </b></font>ctacao.item<font color="#808080">(</font>opconfirmaexclusao<font color="#808080">) = </font>sacao <font color="#000080"><b>then
    </b></font>escrevearq<font color="#808080">(</font>tfautor<font color="#808080">, </font>repete<font color="#808080">('*',</font>tamreg<font color="#808080">(</font>sreg<font color="#808080">)), </font>msg_regexc<font color="#808080">, </font>msg_regnexc<font color="#808080">);
  </font><font color="#000080"><b>end</b></font><font color="#808080">;
</font><font color="#000080"><b>elseif </b></font>ctarqs.item<font color="#808080">(</font>opeditora<font color="#808080">) = </font>sreg <font color="#000080"><b>then
  if </b></font>ctacao.item<font color="#808080">(</font>opsalvarinclusao<font color="#808080">) = </font>sacao <font color="#000080"><b>then
    </b></font>escrevearq<font color="#808080">(</font>tfeditora<font color="#808080">, </font>linhareg<font color="#808080">(</font>sreg<font color="#808080">), </font>msg_reginc<font color="#808080">, </font>msg_regninc<font color="#808080">)
  </font><font color="#000080"><b>elseif </b></font>ctacao.item<font color="#808080">(</font>opsalvaralteracao<font color="#808080">) = </font>sacao <font color="#000080"><b>then
    </b></font>escrevearq<font color="#808080">(</font>tfeditora<font color="#808080">, </font>linhareg<font color="#808080">(</font>sreg<font color="#808080">), </font>msg_regalt<font color="#808080">, </font>msg_regnalt<font color="#808080">)
  </font><font color="#000080"><b>elseif </b></font>ctacao.item<font color="#808080">(</font>opconfirmaexclusao<font color="#808080">) = </font>sacao <font color="#000080"><b>then
    </b></font>escrevearq<font color="#808080">(</font>tfeditora<font color="#808080">, </font>repete<font color="#808080">('*',</font>tamreg<font color="#808080">(</font>sreg<font color="#808080">)), </font>msg_regexc<font color="#808080">, </font>msg_regnexc<font color="#808080">);
  </font><font color="#000080"><b>end</b></font><font color="#808080">;
</font><font color="#000080"><b>elseif </b></font>ctarqs.item<font color="#808080">(</font>opendereco<font color="#808080">) = </font>sreg <font color="#000080"><b>then
  if </b></font>ctacao.item<font color="#808080">(</font>opsalvarinclusao<font color="#808080">) = </font>sacao <font color="#000080"><b>then
    </b></font>escrevearq<font color="#808080">(</font>tfendereco<font color="#808080">, </font>linhareg<font color="#808080">(</font>sreg<font color="#808080">), </font>msg_reginc<font color="#808080">, </font>msg_regninc<font color="#808080">)
  </font><font color="#000080"><b>elseif </b></font>ctacao.item<font color="#808080">(</font>opsalvaralteracao<font color="#808080">) = </font>sacao <font color="#000080"><b>then
    </b></font>escrevearq<font color="#808080">(</font>tfendereco<font color="#808080">, </font>linhareg<font color="#808080">(</font>sreg<font color="#808080">), </font>msg_regalt<font color="#808080">, </font>msg_regnalt<font color="#808080">)
  </font><font color="#000080"><b>elseif </b></font>ctacao.item<font color="#808080">(</font>opconfirmaexclusao<font color="#808080">) = </font>sacao <font color="#000080"><b>then
    </b></font>escrevearq<font color="#808080">(</font>tfendereco<font color="#808080">, </font>repete<font color="#808080">('*',</font>tamreg<font color="#808080">(</font>sreg<font color="#808080">)), </font>msg_regexc<font color="#808080">, </font>msg_regnexc<font color="#808080">);
  </font><font color="#000080"><b>end</b></font><font color="#808080">;
</font><font color="#000080"><b>elseif </b></font>ctarqs.item<font color="#808080">(</font>opidioma<font color="#808080">) = </font>sreg <font color="#000080"><b>then
  if </b></font>ctacao.item<font color="#808080">(</font>opsalvarinclusao<font color="#808080">) = </font>sacao <font color="#000080"><b>then
    </b></font>escrevearq<font color="#808080">(</font>tfidioma<font color="#808080">, </font>linhareg<font color="#808080">(</font>sreg<font color="#808080">), </font>msg_reginc<font color="#808080">, </font>msg_regninc<font color="#808080">)
  </font><font color="#000080"><b>elseif </b></font>ctacao.item<font color="#808080">(</font>opsalvaralteracao<font color="#808080">) = </font>sacao <font color="#000080"><b>then
    </b></font>escrevearq<font color="#808080">(</font>tfidioma<font color="#808080">, </font>linhareg<font color="#808080">(</font>sreg<font color="#808080">), </font>msg_regalt<font color="#808080">, </font>msg_regnalt<font color="#808080">)
  </font><font color="#000080"><b>elseif </b></font>ctacao.item<font color="#808080">(</font>opconfirmaexclusao<font color="#808080">) = </font>sacao <font color="#000080"><b>then
    </b></font>escrevearq<font color="#808080">(</font>tfidioma<font color="#808080">, </font>repete<font color="#808080">('*',</font>tamreg<font color="#808080">(</font>sreg<font color="#808080">)), </font>msg_regexc<font color="#808080">, </font>msg_regnexc<font color="#808080">);
  </font><font color="#000080"><b>end</b></font><font color="#808080">;
</font><font color="#000080"><b>elseif </b></font>ctarqs.item<font color="#808080">(</font>oppais<font color="#808080">) = </font>sreg <font color="#000080"><b>then
  if </b></font>ctacao.item<font color="#808080">(</font>opsalvarinclusao<font color="#808080">) = </font>sacao <font color="#000080"><b>then
    </b></font>escrevearq<font color="#808080">(</font>tfpais<font color="#808080">, </font>linhareg<font color="#808080">(</font>sreg<font color="#808080">), </font>msg_reginc<font color="#808080">, </font>msg_regninc<font color="#808080">)
  </font><font color="#000080"><b>elseif </b></font>ctacao.item<font color="#808080">(</font>opsalvaralteracao<font color="#808080">) = </font>sacao <font color="#000080"><b>then
    </b></font>escrevearq<font color="#808080">(</font>tfpais<font color="#808080">, </font>linhareg<font color="#808080">(</font>sreg<font color="#808080">), </font>msg_regalt<font color="#808080">, </font>msg_regnalt<font color="#808080">)
  </font><font color="#000080"><b>elseif </b></font>ctacao.item<font color="#808080">(</font>opconfirmaexclusao<font color="#808080">) = </font>sacao <font color="#000080"><b>then
    </b></font>escrevearq<font color="#808080">(</font>tfpais<font color="#808080">, </font>repete<font color="#808080">('*',</font>tamreg<font color="#808080">(</font>sreg<font color="#808080">)), </font>msg_regexc<font color="#808080">, </font>msg_regnexc<font color="#808080">);
  </font><font color="#000080"><b>end</b></font><font color="#808080">;
</font><font color="#000080"><b>elseif </b></font>ctarqs.item<font color="#808080">(</font>opprofissao<font color="#808080">) = </font>sreg <font color="#000080"><b>then
  if </b></font>ctacao.item<font color="#808080">(</font>opsalvarinclusao<font color="#808080">) = </font>sacao <font color="#000080"><b>then
    </b></font>escrevearq<font color="#808080">(</font>tfprofissao<font color="#808080">, </font>linhareg<font color="#808080">(</font>sreg<font color="#808080">), </font>msg_reginc<font color="#808080">, </font>msg_regninc<font color="#808080">)
  </font><font color="#000080"><b>elseif </b></font>ctacao.item<font color="#808080">(</font>opsalvaralteracao<font color="#808080">) = </font>sacao <font color="#000080"><b>then
    </b></font>escrevearq<font color="#808080">(</font>tfprofissao<font color="#808080">, </font>linhareg<font color="#808080">(</font>sreg<font color="#808080">), </font>msg_regalt<font color="#808080">, </font>msg_regnalt<font color="#808080">)
  </font><font color="#000080"><b>elseif </b></font>ctacao.item<font color="#808080">(</font>opconfirmaexclusao<font color="#808080">) = </font>sacao <font color="#000080"><b>then
    </b></font>escrevearq<font color="#808080">(</font>tfprofissao<font color="#808080">, </font>repete<font color="#808080">('*',</font>tamreg<font color="#808080">(</font>sreg<font color="#808080">)), </font>msg_regexc<font color="#808080">, </font>msg_regnexc<font color="#808080">);
  </font><font color="#000080"><b>end</b></font><font color="#808080">;
</font><font color="#000080"><b>elseif </b></font>ctarqs.item<font color="#808080">(</font>oplivro<font color="#808080">) = </font>sreg <font color="#000080"><b>then
  if </b></font>ctacao.item<font color="#808080">(</font>opsalvarinclusao<font color="#808080">) = </font>sacao <font color="#000080"><b>then
    </b></font>escrevearq<font color="#808080">(</font>tflivro<font color="#808080">, </font>linhareg<font color="#808080">(</font>sreg<font color="#808080">), </font>msg_reginc<font color="#808080">, </font>msg_regninc<font color="#808080">)
  </font><font color="#000080"><b>elseif </b></font>ctacao.item<font color="#808080">(</font>opsalvaralteracao<font color="#808080">) = </font>sacao <font color="#000080"><b>then
    </b></font>escrevearq<font color="#808080">(</font>tflivro<font color="#808080">, </font>linhareg<font color="#808080">(</font>sreg<font color="#808080">), </font>msg_regalt<font color="#808080">, </font>msg_regnalt<font color="#808080">)
  </font><font color="#000080"><b>elseif </b></font>ctacao.item<font color="#808080">(</font>opconfirmaexclusao<font color="#808080">) = </font>sacao <font color="#000080"><b>then
    </b></font>escrevearq<font color="#808080">(</font>tflivro<font color="#808080">, </font>repete<font color="#808080">('*',</font>tamreg<font color="#808080">(</font>sreg<font color="#808080">)), </font>msg_regexc<font color="#808080">, </font>msg_regnexc<font color="#808080">);
  </font><font color="#000080"><b>end</b></font><font color="#808080">;
</font><font color="#000080"><b>elseif </b></font>ctarqs.item<font color="#808080">(</font>oplivroass<font color="#808080">) = </font>sreg <font color="#000080"><b>then
  if </b></font>ctacao.item<font color="#808080">(</font>opsalvarinclusao<font color="#808080">) = </font>sacao <font color="#000080"><b>then
    </b></font>escrevearq<font color="#808080">(</font>tflivroass<font color="#808080">, </font>linhareg<font color="#808080">(</font>sreg<font color="#808080">), </font>msg_reginc<font color="#808080">, </font>msg_regninc<font color="#808080">)
  </font><font color="#000080"><b>elseif </b></font>ctacao.item<font color="#808080">(</font>opsalvaralteracao<font color="#808080">) = </font>sacao <font color="#000080"><b>then
    </b></font>escrevearq<font color="#808080">(</font>tflivroass<font color="#808080">, </font>linhareg<font color="#808080">(</font>sreg<font color="#808080">), </font>msg_regalt<font color="#808080">, </font>msg_regnalt<font color="#808080">)
  </font><font color="#000080"><b>elseif </b></font>ctacao.item<font color="#808080">(</font>opconfirmaexclusao<font color="#808080">) = </font>sacao <font color="#000080"><b>then
    </b></font>escrevearq<font color="#808080">(</font>tflivroass<font color="#808080">, </font>repete<font color="#808080">('*',</font>tamreg<font color="#808080">(</font>sreg<font color="#808080">)), </font>msg_regexc<font color="#808080">, </font>msg_regnexc<font color="#808080">);
  </font><font color="#000080"><b>end</b></font><font color="#808080">;
</font><font color="#000080"><b>elseif </b></font>ctarqs.item<font color="#808080">(</font>oplivroaut<font color="#808080">) = </font>sreg <font color="#000080"><b>then
  if </b></font>ctacao.item<font color="#808080">(</font>opsalvarinclusao<font color="#808080">) = </font>sacao <font color="#000080"><b>then
    </b></font>escrevearq<font color="#808080">(</font>tflivroaut<font color="#808080">, </font>linhareg<font color="#808080">(</font>sreg<font color="#808080">), </font>msg_reginc<font color="#808080">, </font>msg_regninc<font color="#808080">)
  </font><font color="#000080"><b>elseif </b></font>ctacao.item<font color="#808080">(</font>opsalvaralteracao<font color="#808080">) = </font>sacao <font color="#000080"><b>then
    </b></font>escrevearq<font color="#808080">(</font>tflivroaut<font color="#808080">, </font>linhareg<font color="#808080">(</font>sreg<font color="#808080">), </font>msg_regalt<font color="#808080">, </font>msg_regnalt<font color="#808080">)
  </font><font color="#000080"><b>elseif </b></font>ctacao.item<font color="#808080">(</font>opconfirmaexclusao<font color="#808080">) = </font>sacao <font color="#000080"><b>then
    </b></font>escrevearq<font color="#808080">(</font>tflivroaut<font color="#808080">, </font>repete<font color="#808080">('*',</font>tamreg<font color="#808080">(</font>sreg<font color="#808080">)), </font>msg_regexc<font color="#808080">, </font>msg_regnexc<font color="#808080">);
  </font><font color="#000080"><b>end</b></font><font color="#808080">;
</font><font color="#000080"><b>elseif </b></font>ctarqs.item<font color="#808080">(</font>opcliente<font color="#808080">) = </font>sreg <font color="#000080"><b>then
  if </b></font>ctacao.item<font color="#808080">(</font>opsalvarinclusao<font color="#808080">) = </font>sacao <font color="#000080"><b>then
    </b></font>escrevearq<font color="#808080">(</font>tfcliente<font color="#808080">, </font>linhareg<font color="#808080">(</font>sreg<font color="#808080">), </font>msg_reginc<font color="#808080">, </font>msg_regninc<font color="#808080">)
  </font><font color="#000080"><b>elseif </b></font>ctacao.item<font color="#808080">(</font>opsalvaralteracao<font color="#808080">) = </font>sacao <font color="#000080"><b>then
    </b></font>escrevearq<font color="#808080">(</font>tfcliente<font color="#808080">, </font>linhareg<font color="#808080">(</font>sreg<font color="#808080">), </font>msg_regalt<font color="#808080">, </font>msg_regnalt<font color="#808080">)
  </font><font color="#000080"><b>elseif </b></font>ctacao.item<font color="#808080">(</font>opconfirmaexclusao<font color="#808080">) = </font>sacao <font color="#000080"><b>then
    </b></font>escrevearq<font color="#808080">(</font>tfcliente<font color="#808080">, </font>repete<font color="#808080">('*',</font>tamreg<font color="#808080">(</font>sreg<font color="#808080">)), </font>msg_regexc<font color="#808080">, </font>msg_regnexc<font color="#808080">);
  </font><font color="#000080"><b>end</b></font><font color="#808080">;
</font><font color="#000080"><b>elseif </b></font>ctarqs.item<font color="#808080">(</font>opvenda<font color="#808080">) = </font>sreg <font color="#000080"><b>then
  if </b></font>ctacao.item<font color="#808080">(</font>opsalvarinclusao<font color="#808080">) = </font>sacao <font color="#000080"><b>then
    </b></font>escrevearq<font color="#808080">(</font>tfvenda<font color="#808080">, </font>linhareg<font color="#808080">(</font>sreg<font color="#808080">), </font>msg_reginc<font color="#808080">, </font>msg_regninc<font color="#808080">)
  </font><font color="#000080"><b>elseif </b></font>ctacao.item<font color="#808080">(</font>opsalvaralteracao<font color="#808080">) = </font>sacao <font color="#000080"><b>then
    </b></font>escrevearq<font color="#808080">(</font>tfvenda<font color="#808080">, </font>linhareg<font color="#808080">(</font>sreg<font color="#808080">), </font>msg_regalt<font color="#808080">, </font>msg_regnalt<font color="#808080">)
  </font><font color="#000080"><b>elseif </b></font>ctacao.item<font color="#808080">(</font>opconfirmaexclusao<font color="#808080">) = </font>sacao <font color="#000080"><b>then
    </b></font>escrevearq<font color="#808080">(</font>tfvenda<font color="#808080">, </font>repete<font color="#808080">('*',</font>tamreg<font color="#808080">(</font>sreg<font color="#808080">)), </font>msg_regexc<font color="#808080">, </font>msg_regnexc<font color="#808080">);
  </font><font color="#000080"><b>end</b></font><font color="#808080">;
</font><font color="#000080"><b>elseif </b></font>ctarqs.item<font color="#808080">(</font>opusuario<font color="#808080">) = </font>sreg <font color="#000080"><b>then
  if </b></font>ctacao.item<font color="#808080">(</font>opsalvaralteracao<font color="#808080">) = </font>sacao <font color="#000080"><b>then
    </b></font>escrevearq<font color="#808080">(</font>tfusuario<font color="#808080">, </font>linhareg<font color="#808080">(</font>sreg<font color="#808080">), </font>msg_regalt<font color="#808080">, </font>msg_regnalt<font color="#808080">);
  </font><font color="#000080"><b>end</b></font><font color="#808080">;
</font><font color="#000080"><b>end</b></font><font color="#808080">;
</font><font color="#000080"><b>end</b></font><font color="#808080">;
-- ----------------------------------------------------------------------------
-- Seleciona o menu e/ou a tela certa de acordo com o tipo de arquivo.
-- nmenu - o n&uacute;mero do menu
-- sreg - o tipo de arquivo
-- ----------------------------------------------------------------------------
</font>submenu<font color="#808080">(</font>nmenu<font color="#808080">, </font>sreg<font color="#808080">: </font><font color="#0000FF">INTEGER</font><font color="#808080">) </font><font color="#000080"><b>is
local
  </b></font>opsubmenu<font color="#808080">: </font><font color="#0000FF">INTEGER</font><font color="#808080">;
  </font>opcsubmenu<font color="#808080">: </font><font color="#0000FF">STRING</font><font color="#808080">;
  </font>bsop<font color="#808080">: </font><font color="#0000FF">BOOLEAN</font><font color="#808080">;
</font><font color="#000080"><b>do
inspect </b></font>nmenu
  <font color="#000080"><b>when </b></font><font color="#FF0000">6 </font><font color="#000080"><b>then
    from </b></font>bsop<font color="#808080">:=</font><font color="#008080">true</font><font color="#808080">; 
    </font><font color="#000080"><b>until </b></font>bsop<font color="#808080">=</font><font color="#008080">false 
    </font><font color="#000080"><b>loop
      </b></font>menu<font color="#808080">(</font>nmenu<font color="#808080">);
      </font>io.read_integer
      opsubmenu<font color="#808080">:=</font>io.last_integer<font color="#808080">;
      </font><font color="#000080"><b>inspect </b></font>opsubmenu
        <font color="#000080"><b>when </b></font><font color="#FF0000">1 </font><font color="#000080"><b>then </b></font>frmcadastros<font color="#808080">(</font>sreg<font color="#808080">, </font>opnovo<font color="#808080">);
        </font><font color="#000080"><b>when </b></font><font color="#FF0000">2 </font><font color="#000080"><b>then </b></font>frmcadastros<font color="#808080">(</font>sreg<font color="#808080">, </font>oppesquisar<font color="#808080">);
        </font><font color="#000080"><b>when </b></font><font color="#FF0000">3 </font><font color="#000080"><b>then </b></font>bsop<font color="#808080">:=</font><font color="#008080">false</font><font color="#808080">;
        </font><font color="#000080"><b>else </b></font>io.put_string<font color="#808080">(</font>msg_erro<font color="#808080">);
      </font><font color="#000080"><b>end</b></font><font color="#808080">;
    </font><font color="#000080"><b>end</b></font><font color="#808080">;
  </font><font color="#000080"><b>when </b></font><font color="#FF0000">7 </font><font color="#000080"><b>then
    from </b></font>bsop<font color="#808080">:=</font><font color="#008080">true</font><font color="#808080">; 
    </font><font color="#000080"><b>until </b></font>bsop<font color="#808080">=</font><font color="#008080">false 
    </font><font color="#000080"><b>loop
      </b></font>menu<font color="#808080">(</font>nmenu<font color="#808080">);
      </font>io.read_integer
      opsubmenu<font color="#808080">:=</font>io.last_integer<font color="#808080">;
      </font><font color="#000080"><b>inspect </b></font>opsubmenu
        <font color="#000080"><b>when </b></font><font color="#FF0000">1 </font><font color="#000080"><b>then 
          </b></font>btnacao<font color="#808080">(</font>sreg<font color="#808080">, </font>opsalvarinclusao<font color="#808080">); 
          </font>bsop<font color="#808080">:=</font><font color="#008080">false</font><font color="#808080">;
        </font><font color="#000080"><b>when </b></font><font color="#FF0000">2 </font><font color="#000080"><b>then </b></font>bsop<font color="#808080">:=</font><font color="#008080">false</font><font color="#808080">;
        </font><font color="#000080"><b>else </b></font>io.put_string<font color="#808080">(</font>msg_erro<font color="#808080">);
      </font><font color="#000080"><b>end</b></font><font color="#808080">;
    </font><font color="#000080"><b>end</b></font><font color="#808080">;
  </font><font color="#000080"><b>when </b></font><font color="#FF0000">8 </font><font color="#000080"><b>then
    from </b></font>bsop<font color="#808080">:=</font><font color="#008080">true</font><font color="#808080">; 
    </font><font color="#000080"><b>until </b></font>bsop<font color="#808080">=</font><font color="#008080">false 
    </font><font color="#000080"><b>loop
      </b></font>menu<font color="#808080">(</font>nmenu<font color="#808080">);
      </font>io.read_integer
      opsubmenu<font color="#808080">:=</font>io.last_integer<font color="#808080">;
      </font><font color="#000080"><b>inspect </b></font>opsubmenu
        <font color="#000080"><b>when </b></font><font color="#FF0000">1 </font><font color="#000080"><b>then 
          </b></font>frmcadastros<font color="#808080">(</font>sreg<font color="#808080">, </font>opalterar<font color="#808080">); 
          </font>bsop<font color="#808080">:=</font><font color="#008080">false</font><font color="#808080">;
        </font><font color="#000080"><b>when </b></font><font color="#FF0000">2 </font><font color="#000080"><b>then 
          </b></font>frmcadastros<font color="#808080">(</font>sreg<font color="#808080">, </font>opexcluir<font color="#808080">); 
          </font>bsop<font color="#808080">:=</font><font color="#008080">false</font><font color="#808080">;
        </font><font color="#000080"><b>when </b></font><font color="#FF0000">3 </font><font color="#000080"><b>then </b></font>bsop<font color="#808080">:=</font><font color="#008080">false</font><font color="#808080">;
        </font><font color="#000080"><b>else </b></font>io.put_string<font color="#808080">(</font>msg_erro<font color="#808080">);
      </font><font color="#000080"><b>end</b></font><font color="#808080">;
    </font><font color="#000080"><b>end</b></font><font color="#808080">;
  </font><font color="#000080"><b>when </b></font><font color="#FF0000">9 </font><font color="#000080"><b>then
    from </b></font>bsop<font color="#808080">:=</font><font color="#008080">true</font><font color="#808080">; 
    </font><font color="#000080"><b>until </b></font>bsop<font color="#808080">=</font><font color="#008080">false 
    </font><font color="#000080"><b>loop
      </b></font>menu<font color="#808080">(</font>nmenu<font color="#808080">);
      </font>io.read_integer
      opsubmenu<font color="#808080">:=</font>io.last_integer<font color="#808080">;
      </font><font color="#000080"><b>inspect </b></font>opsubmenu
        <font color="#000080"><b>when </b></font><font color="#FF0000">1 </font><font color="#000080"><b>then 
          </b></font>btnacao<font color="#808080">(</font>sreg<font color="#808080">, </font>opsalvaralteracao<font color="#808080">); 
          </font>bsop<font color="#808080">:=</font><font color="#008080">false</font><font color="#808080">;
        </font><font color="#000080"><b>when </b></font><font color="#FF0000">2 </font><font color="#000080"><b>then </b></font>bsop<font color="#808080">:=</font><font color="#008080">false</font><font color="#808080">;
        </font><font color="#000080"><b>else </b></font>io.put_string<font color="#808080">(</font>msg_erro<font color="#808080">);
      </font><font color="#000080"><b>end</b></font><font color="#808080">;
    </font><font color="#000080"><b>end</b></font><font color="#808080">;
  </font><font color="#000080"><b>when </b></font><font color="#FF0000">10 </font><font color="#000080"><b>then
    from </b></font>bsop<font color="#808080">:=</font><font color="#008080">true</font><font color="#808080">; 
    </font><font color="#000080"><b>until </b></font>bsop<font color="#808080">=</font><font color="#008080">false 
    </font><font color="#000080"><b>loop
      </b></font>menu<font color="#808080">(</font>nmenu<font color="#808080">);
      </font>opcsubmenu<font color="#808080">:=</font>digita<font color="#808080">;
      </font><font color="#000080"><b>if </b></font><font color="#808080">(</font>opcsubmenu.item<font color="#808080">(</font><font color="#FF0000">1</font><font color="#808080">)='</font>s<font color="#808080">') </font><font color="#000080"><b>or </b></font><font color="#808080">(</font>opcsubmenu.item<font color="#808080">(</font><font color="#FF0000">1</font><font color="#808080">)='</font>s<font color="#808080">') </font><font color="#000080"><b>then
        </b></font>btnacao<font color="#808080">(</font>sreg<font color="#808080">, </font>opconfirmaexclusao<font color="#808080">);
        </font>bsop<font color="#808080">:=</font><font color="#008080">false</font><font color="#808080">;
      </font><font color="#000080"><b>elseif </b></font><font color="#808080">(</font>opcsubmenu.item<font color="#808080">(</font><font color="#FF0000">1</font><font color="#808080">)='</font>n<font color="#808080">') </font><font color="#000080"><b>or </b></font><font color="#808080">(</font>opcsubmenu.item<font color="#808080">(</font><font color="#FF0000">1</font><font color="#808080">)='</font>n<font color="#808080">') </font><font color="#000080"><b>then 
        </b></font>bsop<font color="#808080">:=</font><font color="#008080">false
      </font><font color="#000080"><b>else </b></font>io.put_string<font color="#808080">(</font>msg_erro<font color="#808080">);
      </font><font color="#000080"><b>end</b></font><font color="#808080">;
    </font><font color="#000080"><b>end</b></font><font color="#808080">;
  </font><font color="#000080"><b>when </b></font><font color="#FF0000">12 </font><font color="#000080"><b>then
    from </b></font>bsop<font color="#808080">:=</font><font color="#008080">true</font><font color="#808080">; 
    </font><font color="#000080"><b>until </b></font>bsop<font color="#808080">=</font><font color="#008080">false 
    </font><font color="#000080"><b>loop
      </b></font>menu<font color="#808080">(</font>nmenu<font color="#808080">);
      </font>io.read_integer
      opsubmenu<font color="#808080">:=</font>io.last_integer<font color="#808080">;
      </font><font color="#000080"><b>inspect </b></font>opsubmenu
        <font color="#000080"><b>when </b></font><font color="#FF0000">1 </font><font color="#000080"><b>then </b></font>frmconsultas<font color="#808080">(</font>sreg<font color="#808080">, </font>oppesquisar<font color="#808080">);
        </font><font color="#000080"><b>when </b></font><font color="#FF0000">2 </font><font color="#000080"><b>then </b></font>frmconsultas<font color="#808080">(</font>sreg<font color="#808080">, </font>oplistartodos<font color="#808080">);
        </font><font color="#000080"><b>when </b></font><font color="#FF0000">3 </font><font color="#000080"><b>then </b></font>bsop<font color="#808080">:=</font><font color="#008080">false</font><font color="#808080">;
        </font><font color="#000080"><b>else </b></font>io.put_string<font color="#808080">(</font>msg_erro<font color="#808080">);
      </font><font color="#000080"><b>end</b></font><font color="#808080">;
    </font><font color="#000080"><b>end</b></font><font color="#808080">;
  </font><font color="#000080"><b>when </b></font><font color="#FF0000">14 </font><font color="#000080"><b>then
    from </b></font>bsop<font color="#808080">:=</font><font color="#008080">true</font><font color="#808080">; 
    </font><font color="#000080"><b>until </b></font>bsop<font color="#808080">=</font><font color="#008080">false 
    </font><font color="#000080"><b>loop
      </b></font>menu<font color="#808080">(</font>nmenu<font color="#808080">);
      </font>opcsubmenu<font color="#808080">:=</font>digita<font color="#808080">;
      </font><font color="#000080"><b>if </b></font><font color="#808080">(</font>opcsubmenu.item<font color="#808080">(</font><font color="#FF0000">1</font><font color="#808080">)='</font>s<font color="#808080">') </font><font color="#000080"><b>or </b></font><font color="#808080">(</font>opcsubmenu.item<font color="#808080">(</font><font color="#FF0000">1</font><font color="#808080">)='</font>s<font color="#808080">') </font><font color="#000080"><b>then
        </b></font>btnacao<font color="#808080">(</font>sreg<font color="#808080">, </font>opsalvarinclusao<font color="#808080">);
        </font>bsop<font color="#808080">:=</font><font color="#008080">false</font><font color="#808080">;
        </font>g_salvarinclusao<font color="#808080">:=</font><font color="#008080">true</font><font color="#808080">;
      </font><font color="#000080"><b>elseif </b></font><font color="#808080">(</font>opcsubmenu.item<font color="#808080">(</font><font color="#FF0000">1</font><font color="#808080">)='</font>n<font color="#808080">') </font><font color="#000080"><b>or </b></font><font color="#808080">(</font>opcsubmenu.item<font color="#808080">(</font><font color="#FF0000">1</font><font color="#808080">)='</font>n<font color="#808080">') </font><font color="#000080"><b>then 
        </b></font>bsop<font color="#808080">:=</font><font color="#008080">false
      </font><font color="#000080"><b>else </b></font>io.put_string<font color="#808080">(</font>msg_erro<font color="#808080">);
      </font><font color="#000080"><b>end</b></font><font color="#808080">;
    </font><font color="#000080"><b>end</b></font><font color="#808080">;
</font><font color="#000080"><b>end</b></font><font color="#808080">;

</font><font color="#000080"><b>end</b></font><font color="#808080">;
-- ----------------------------------------------------------------------------
-- Seleciona o submenu e/ou a tela certa de acordo com n&uacute;mero do menu.
-- nmenu - o n&uacute;mero do menu
-- ----------------------------------------------------------------------------
</font>usamenu<font color="#808080">(</font>num<font color="#808080">: </font><font color="#0000FF">INTEGER</font><font color="#808080">) </font><font color="#000080"><b>is
local
  </b></font>opsubmenu<font color="#808080">: </font><font color="#0000FF">INTEGER</font><font color="#808080">;
  </font>bsop<font color="#808080">: </font><font color="#0000FF">BOOLEAN</font><font color="#808080">;
  </font>opsair<font color="#808080">: </font><font color="#0000FF">STRING</font><font color="#808080">;
</font><font color="#000080"><b>do
 if </b></font>num <font color="#808080">= </font><font color="#FF0000">1 </font><font color="#000080"><b>then </b></font><font color="#808080">-- cadastros
   </font><font color="#000080"><b>from </b></font>bsop<font color="#808080">:=</font><font color="#008080">true</font><font color="#808080">; 
   </font><font color="#000080"><b>until </b></font>bsop<font color="#808080">=</font><font color="#008080">false 
   </font><font color="#000080"><b>loop
     </b></font>menu<font color="#808080">(</font><font color="#FF0000">2</font><font color="#808080">);
     </font>io.read_integer
     opsubmenu<font color="#808080">:=</font>io.last_integer<font color="#808080">;
     </font><font color="#000080"><b>inspect </b></font>opsubmenu
       <font color="#000080"><b>when </b></font><font color="#FF0000">1 </font><font color="#000080"><b>then </b></font>submenu<font color="#808080">(</font><font color="#FF0000">6</font><font color="#808080">, </font>opassunto<font color="#808080">);
       </font><font color="#000080"><b>when </b></font><font color="#FF0000">2 </font><font color="#000080"><b>then </b></font>submenu<font color="#808080">(</font><font color="#FF0000">6</font><font color="#808080">, </font>opautor<font color="#808080">);
       </font><font color="#000080"><b>when </b></font><font color="#FF0000">3 </font><font color="#000080"><b>then </b></font>submenu<font color="#808080">(</font><font color="#FF0000">6</font><font color="#808080">, </font>opeditora<font color="#808080">);
       </font><font color="#000080"><b>when </b></font><font color="#FF0000">4 </font><font color="#000080"><b>then </b></font>submenu<font color="#808080">(</font><font color="#FF0000">6</font><font color="#808080">, </font>opendereco<font color="#808080">);
       </font><font color="#000080"><b>when </b></font><font color="#FF0000">5 </font><font color="#000080"><b>then </b></font>submenu<font color="#808080">(</font><font color="#FF0000">6</font><font color="#808080">, </font>opidioma<font color="#808080">);
       </font><font color="#000080"><b>when </b></font><font color="#FF0000">6 </font><font color="#000080"><b>then </b></font>submenu<font color="#808080">(</font><font color="#FF0000">6</font><font color="#808080">, </font>oppais<font color="#808080">);
       </font><font color="#000080"><b>when </b></font><font color="#FF0000">7 </font><font color="#000080"><b>then </b></font>submenu<font color="#808080">(</font><font color="#FF0000">6</font><font color="#808080">, </font>opprofissao<font color="#808080">);
       </font><font color="#000080"><b>when </b></font><font color="#FF0000">8 </font><font color="#000080"><b>then </b></font>submenu<font color="#808080">(</font><font color="#FF0000">6</font><font color="#808080">, </font>opcliente<font color="#808080">);
       </font><font color="#000080"><b>when </b></font><font color="#FF0000">9 </font><font color="#000080"><b>then </b></font>submenu<font color="#808080">(</font><font color="#FF0000">6</font><font color="#808080">, </font>oplivro<font color="#808080">);
       </font><font color="#000080"><b>when </b></font><font color="#FF0000">10 </font><font color="#000080"><b>then </b></font>bsop<font color="#808080">:=</font><font color="#008080">false</font><font color="#808080">;
       </font><font color="#000080"><b>else </b></font>io.put_string<font color="#808080">(</font>msg_erro<font color="#808080">);
     </font><font color="#000080"><b>end</b></font><font color="#808080">;
   </font><font color="#000080"><b>end</b></font><font color="#808080">;
 </font><font color="#000080"><b>elseif </b></font>num <font color="#808080">= </font><font color="#FF0000">2 </font><font color="#000080"><b>then </b></font><font color="#808080">-- pesquisas
   </font><font color="#000080"><b>from </b></font>bsop<font color="#808080">:=</font><font color="#008080">true</font><font color="#808080">; 
   </font><font color="#000080"><b>until </b></font>bsop<font color="#808080">=</font><font color="#008080">false 
   </font><font color="#000080"><b>loop
     </b></font>menu<font color="#808080">(</font><font color="#FF0000">3</font><font color="#808080">);
     </font>io.read_integer
     opsubmenu<font color="#808080">:=</font>io.last_integer<font color="#808080">;
     </font><font color="#000080"><b>inspect </b></font>opsubmenu
       <font color="#000080"><b>when </b></font><font color="#FF0000">1 </font><font color="#000080"><b>then </b></font>submenu<font color="#808080">(</font><font color="#FF0000">12</font><font color="#808080">, </font>opassunto<font color="#808080">);
       </font><font color="#000080"><b>when </b></font><font color="#FF0000">2 </font><font color="#000080"><b>then </b></font>submenu<font color="#808080">(</font><font color="#FF0000">12</font><font color="#808080">, </font>opautor<font color="#808080">);
       </font><font color="#000080"><b>when </b></font><font color="#FF0000">3 </font><font color="#000080"><b>then </b></font>submenu<font color="#808080">(</font><font color="#FF0000">12</font><font color="#808080">, </font>opeditora<font color="#808080">);
       </font><font color="#000080"><b>when </b></font><font color="#FF0000">4 </font><font color="#000080"><b>then </b></font>submenu<font color="#808080">(</font><font color="#FF0000">12</font><font color="#808080">, </font>opendereco<font color="#808080">);
       </font><font color="#000080"><b>when </b></font><font color="#FF0000">5 </font><font color="#000080"><b>then </b></font>submenu<font color="#808080">(</font><font color="#FF0000">12</font><font color="#808080">, </font>opidioma<font color="#808080">);
       </font><font color="#000080"><b>when </b></font><font color="#FF0000">6 </font><font color="#000080"><b>then </b></font>submenu<font color="#808080">(</font><font color="#FF0000">12</font><font color="#808080">, </font>oppais<font color="#808080">);
       </font><font color="#000080"><b>when </b></font><font color="#FF0000">7 </font><font color="#000080"><b>then </b></font>submenu<font color="#808080">(</font><font color="#FF0000">12</font><font color="#808080">, </font>opprofissao<font color="#808080">);
       </font><font color="#000080"><b>when </b></font><font color="#FF0000">8 </font><font color="#000080"><b>then </b></font>submenu<font color="#808080">(</font><font color="#FF0000">12</font><font color="#808080">, </font>opcliente<font color="#808080">);
       </font><font color="#000080"><b>when </b></font><font color="#FF0000">9 </font><font color="#000080"><b>then </b></font>submenu<font color="#808080">(</font><font color="#FF0000">12</font><font color="#808080">, </font>oplivro<font color="#808080">);
       </font><font color="#000080"><b>when </b></font><font color="#FF0000">10 </font><font color="#000080"><b>then </b></font>bsop<font color="#808080">:=</font><font color="#008080">false</font><font color="#808080">;
       </font><font color="#000080"><b>else </b></font>io.put_string<font color="#808080">(</font>msg_erro<font color="#808080">);
     </font><font color="#000080"><b>end</b></font><font color="#808080">;
   </font><font color="#000080"><b>end</b></font><font color="#808080">;
 </font><font color="#000080"><b>elseif </b></font>num <font color="#808080">= </font><font color="#FF0000">3 </font><font color="#000080"><b>then </b></font><font color="#808080">-- vendas
   </font><font color="#000080"><b>from </b></font>bsop<font color="#808080">:=</font><font color="#008080">true</font><font color="#808080">; 
   </font><font color="#000080"><b>until </b></font>bsop<font color="#808080">=</font><font color="#008080">false 
   </font><font color="#000080"><b>loop
     </b></font>menu<font color="#808080">(</font><font color="#FF0000">4</font><font color="#808080">);
     </font>io.read_integer
     opsubmenu<font color="#808080">:=</font>io.last_integer<font color="#808080">;
     </font><font color="#000080"><b>inspect </b></font>opsubmenu
       <font color="#000080"><b>when </b></font><font color="#FF0000">1 </font><font color="#000080"><b>then </b></font>submenu<font color="#808080">(</font><font color="#FF0000">6</font><font color="#808080">, </font>opvenda<font color="#808080">);
       </font><font color="#000080"><b>when </b></font><font color="#FF0000">2 </font><font color="#000080"><b>then </b></font>submenu<font color="#808080">(</font><font color="#FF0000">12</font><font color="#808080">, </font>opvenda<font color="#808080">);
       </font><font color="#000080"><b>when </b></font><font color="#FF0000">3 </font><font color="#000080"><b>then </b></font>bsop<font color="#808080">:=</font><font color="#008080">false</font><font color="#808080">;
       </font><font color="#000080"><b>else </b></font>io.put_string<font color="#808080">(</font>msg_erro<font color="#808080">);
     </font><font color="#000080"><b>end</b></font><font color="#808080">;
   </font><font color="#000080"><b>end</b></font><font color="#808080">;
 </font><font color="#000080"><b>elseif </b></font>num <font color="#808080">= </font><font color="#FF0000">4 </font><font color="#000080"><b>then </b></font><font color="#808080">-- opcoes
   </font><font color="#000080"><b>from </b></font>bsop<font color="#808080">:=</font><font color="#008080">true</font><font color="#808080">; 
   </font><font color="#000080"><b>until </b></font>bsop<font color="#808080">=</font><font color="#008080">false 
   </font><font color="#000080"><b>loop
     </b></font>menu<font color="#808080">(</font><font color="#FF0000">5</font><font color="#808080">);
     </font>io.read_integer
     opsubmenu<font color="#808080">:=</font>io.last_integer<font color="#808080">;
     </font><font color="#000080"><b>inspect </b></font>opsubmenu
       <font color="#000080"><b>when </b></font><font color="#FF0000">1 </font><font color="#000080"><b>then </b></font>frmalterarsenha<font color="#808080">;
       </font><font color="#000080"><b>when </b></font><font color="#FF0000">2 </font><font color="#000080"><b>then </b></font>frmsobre<font color="#808080">;
       </font><font color="#000080"><b>when </b></font><font color="#FF0000">3 </font><font color="#000080"><b>then
         </b></font>menu<font color="#808080">(</font><font color="#FF0000">11</font><font color="#808080">);
         </font>opsair<font color="#808080">:=</font>digita<font color="#808080">;
         </font><font color="#000080"><b>if </b></font><font color="#808080">(</font>opsair.item<font color="#808080">(</font><font color="#FF0000">1</font><font color="#808080">)='</font>s<font color="#808080">') </font><font color="#000080"><b>or </b></font><font color="#808080">(</font>opsair.item<font color="#808080">(</font><font color="#FF0000">1</font><font color="#808080">)='</font>s<font color="#808080">') </font><font color="#000080"><b>then
            </b></font>fechaarqs<font color="#808080">;
            </font>die_with_code<font color="#808080">(</font>exit_success_code<font color="#808080">);
         </font><font color="#000080"><b>end</b></font><font color="#808080">;
       </font><font color="#000080"><b>when </b></font><font color="#FF0000">4 </font><font color="#000080"><b>then </b></font>bsop<font color="#808080">:=</font><font color="#008080">false</font><font color="#808080">;
       </font><font color="#000080"><b>else </b></font>io.put_string<font color="#808080">(</font>msg_erro<font color="#808080">);
     </font><font color="#000080"><b>end</b></font><font color="#808080">;
   </font><font color="#000080"><b>end</b></font><font color="#808080">;
 </font><font color="#000080"><b>end</b></font><font color="#808080">;
</font><font color="#000080"><b>end</b></font><font color="#808080">;
-- ----------------------------------------------------------------------------
-- Mostra as entradas e as sa&iacute;das do sistema.
-- sreg - o tipo de arquivo
-- slinha - o registro com os dados
-- nOpcao - indica qual op&ccedil;&atilde;o ser&aacute; mostrada
-- ----------------------------------------------------------------------------
</font>mostrardados<font color="#808080">(</font>sreg<font color="#808080">: </font><font color="#0000FF">INTEGER</font><font color="#808080">; </font>slinha<font color="#808080">: </font><font color="#0000FF">STRING</font><font color="#808080">; </font>nopcao<font color="#808080">: </font><font color="#0000FF">INTEGER</font><font color="#808080">) </font><font color="#000080"><b>is
do
if </b></font>ctarqs.item<font color="#808080">(</font>opassunto<font color="#808080">) = </font>sreg <font color="#000080"><b>then
  inspect </b></font>nopcao
    <font color="#000080"><b>when </b></font><font color="#FF0000">1 </font><font color="#000080"><b>then
      </b></font>io.put_string<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">) + </font>tassunto.codigo <font color="#808080">+ </font>crlf<font color="#808080">);
      </font>io.put_string<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">));
      </font>tassunto.set_assunto<font color="#808080">(</font>digita<font color="#808080">);
    </font><font color="#000080"><b>when </b></font><font color="#FF0000">2 </font><font color="#000080"><b>then
      </b></font>io.put_string<font color="#808080">(</font><font color="#800000">&quot;C&oacute;digo     Assunto%N&quot;</font><font color="#808080">);
      </font>io.put_string<font color="#808080">(</font><font color="#800000">&quot;------     -------%N&quot;</font><font color="#808080">);
    </font><font color="#000080"><b>when </b></font><font color="#FF0000">3 </font><font color="#000080"><b>then
      </b></font>tassunto.set_codigo<font color="#808080">(</font>substr<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">));
      </font>tassunto.set_assunto<font color="#808080">(</font>substr<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">11</font><font color="#808080">, </font><font color="#FF0000">30</font><font color="#808080">));
      </font>io.put_string<font color="#808080">(</font>tassunto.codigo<font color="#808080">+</font><font color="#800000">&quot; &quot;</font><font color="#808080">+</font>tassunto.assunto<font color="#808080">+</font>crlf<font color="#808080">);
  </font><font color="#000080"><b>end</b></font><font color="#808080">;
</font><font color="#000080"><b>elseif </b></font>ctarqs.item<font color="#808080">(</font>opautor<font color="#808080">) = </font>sreg <font color="#000080"><b>then
  inspect </b></font>nopcao
    <font color="#000080"><b>when </b></font><font color="#FF0000">1 </font><font color="#000080"><b>then
      </b></font>io.put_string<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">) + </font>tautor.codigo <font color="#808080">+ </font>crlf<font color="#808080">);
      </font>io.put_string<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">));
      </font>tautor.set_autor<font color="#808080">(</font>digita<font color="#808080">);
    </font><font color="#000080"><b>when </b></font><font color="#FF0000">2 </font><font color="#000080"><b>then
      </b></font>io.put_string<font color="#808080">(</font><font color="#800000">&quot;C&oacute;digo     Autor%N&quot;</font><font color="#808080">);
      </font>io.put_string<font color="#808080">(</font><font color="#800000">&quot;------     -----%N&quot;</font><font color="#808080">);
    </font><font color="#000080"><b>when </b></font><font color="#FF0000">3 </font><font color="#000080"><b>then
      </b></font>tautor.set_codigo<font color="#808080">(</font>substr<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">));
      </font>tautor.set_autor<font color="#808080">(</font>substr<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">11</font><font color="#808080">, </font><font color="#FF0000">30</font><font color="#808080">));
      </font>io.put_string<font color="#808080">(</font>tautor.codigo<font color="#808080">+</font><font color="#800000">&quot; &quot;</font><font color="#808080">+</font>tautor.autor<font color="#808080">+</font>crlf<font color="#808080">);
  </font><font color="#000080"><b>end</b></font><font color="#808080">;
</font><font color="#000080"><b>elseif </b></font>ctarqs.item<font color="#808080">(</font>opeditora<font color="#808080">) = </font>sreg <font color="#000080"><b>then
  inspect </b></font>nopcao
    <font color="#000080"><b>when </b></font><font color="#FF0000">1 </font><font color="#000080"><b>then
      </b></font>io.put_string<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">) + </font>teditora.codigo <font color="#808080">+ </font>crlf<font color="#808080">);
      </font>io.put_string<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">));
      </font>teditora.set_editora<font color="#808080">(</font>digita<font color="#808080">);
    </font><font color="#000080"><b>when </b></font><font color="#FF0000">2 </font><font color="#000080"><b>then
      </b></font>io.put_string<font color="#808080">(</font><font color="#800000">&quot;C&oacute;digo     Editora%N&quot;</font><font color="#808080">);
      </font>io.put_string<font color="#808080">(</font><font color="#800000">&quot;------     -------%N&quot;</font><font color="#808080">);
    </font><font color="#000080"><b>when </b></font><font color="#FF0000">3 </font><font color="#000080"><b>then
      </b></font>teditora.set_codigo<font color="#808080">(</font>substr<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">));
      </font>teditora.set_editora<font color="#808080">(</font>substr<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">11</font><font color="#808080">, </font><font color="#FF0000">50</font><font color="#808080">));
      </font>io.put_string<font color="#808080">(</font>teditora.codigo <font color="#808080">+ </font><font color="#800000">&quot; &quot; </font><font color="#808080">+ </font>teditora.editora <font color="#808080">+ </font>crlf<font color="#808080">);
  </font><font color="#000080"><b>end</b></font><font color="#808080">;
</font><font color="#000080"><b>elseif </b></font>ctarqs.item<font color="#808080">(</font>opendereco<font color="#808080">) = </font>sreg <font color="#000080"><b>then
  inspect </b></font>nopcao
    <font color="#000080"><b>when </b></font><font color="#FF0000">1 </font><font color="#000080"><b>then
      </b></font>io.put_string<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">) + </font>tendereco.codigo <font color="#808080">+ </font>crlf<font color="#808080">);
      </font>io.put_string<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">));
      </font>tendereco.set_logradouro<font color="#808080">(</font>digita<font color="#808080">);
      </font>io.put_string<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">));
      </font>tendereco.set_bairro<font color="#808080">(</font>digita<font color="#808080">);
      </font>io.put_string<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">4</font><font color="#808080">));
      </font>tendereco.set_cep<font color="#808080">(</font>digita<font color="#808080">);
      </font>io.put_string<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">5</font><font color="#808080">));
      </font>tendereco.set_cidade<font color="#808080">(</font>digita<font color="#808080">);
      </font>io.put_string<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">6</font><font color="#808080">));
      </font>tendereco.set_estado<font color="#808080">(</font>digita<font color="#808080">);
    </font><font color="#000080"><b>when </b></font><font color="#FF0000">2 </font><font color="#000080"><b>then 
      </b></font>io.put_string<font color="#808080">(</font><font color="#800000">&quot;&quot;</font><font color="#808080">);
    </font><font color="#000080"><b>when </b></font><font color="#FF0000">3 </font><font color="#000080"><b>then
      </b></font>tendereco.set_codigo<font color="#808080">(</font>trim<font color="#808080">(</font>substr<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">)));
      </font>tendereco.set_logradouro<font color="#808080">(</font>trim<font color="#808080">(</font>substr<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">11</font><font color="#808080">, </font><font color="#FF0000">40</font><font color="#808080">)));
      </font>tendereco.set_bairro<font color="#808080">(</font>trim<font color="#808080">(</font>substr<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">51</font><font color="#808080">, </font><font color="#FF0000">15</font><font color="#808080">)));
      </font>tendereco.set_cep<font color="#808080">(</font>trim<font color="#808080">(</font>substr<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">66</font><font color="#808080">, </font><font color="#FF0000">8</font><font color="#808080">)));
      </font>tendereco.set_cidade<font color="#808080">(</font>trim<font color="#808080">(</font>substr<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">74</font><font color="#808080">, </font><font color="#FF0000">30</font><font color="#808080">)));
      </font>tendereco.set_estado<font color="#808080">(</font>trim<font color="#808080">(</font>substr<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">104</font><font color="#808080">, </font><font color="#FF0000">20</font><font color="#808080">)));
      </font>io.put_string<font color="#808080">(</font><font color="#800000">&quot;--------------------%N&quot;</font><font color="#808080">);
      </font>io.put_string<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">) + </font>tendereco.codigo <font color="#808080">+ </font>crlf<font color="#808080">);
      </font>io.put_string<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">) + </font>tendereco.logradouro <font color="#808080">+ </font>crlf<font color="#808080">);
      </font>io.put_string<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">) + </font>tendereco.bairro <font color="#808080">+ </font>crlf<font color="#808080">);
      </font>io.put_string<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">4</font><font color="#808080">) + </font>tendereco.cep <font color="#808080">+ </font>crlf<font color="#808080">);
      </font>io.put_string<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">5</font><font color="#808080">) + </font>tendereco.cidade <font color="#808080">+ </font>crlf<font color="#808080">);
      </font>io.put_string<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">6</font><font color="#808080">) + </font>tendereco.estado <font color="#808080">+ </font>crlf<font color="#808080">);
  </font><font color="#000080"><b>end</b></font><font color="#808080">;
</font><font color="#000080"><b>elseif </b></font>ctarqs.item<font color="#808080">(</font>opidioma<font color="#808080">) = </font>sreg <font color="#000080"><b>then
  inspect </b></font>nopcao
    <font color="#000080"><b>when </b></font><font color="#FF0000">1 </font><font color="#000080"><b>then
      </b></font>io.put_string<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">) + </font>tidioma.codigo <font color="#808080">+ </font>crlf<font color="#808080">);
      </font>io.put_string<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">));
      </font>tidioma.set_idioma<font color="#808080">(</font>digita<font color="#808080">);
    </font><font color="#000080"><b>when </b></font><font color="#FF0000">2 </font><font color="#000080"><b>then
      </b></font>io.put_string<font color="#808080">(</font><font color="#800000">&quot;C&oacute;digo     Idioma%N&quot;</font><font color="#808080">);
      </font>io.put_string<font color="#808080">(</font><font color="#800000">&quot;------     ------%N&quot;</font><font color="#808080">);
    </font><font color="#000080"><b>when </b></font><font color="#FF0000">3 </font><font color="#000080"><b>then
      </b></font>tidioma.set_codigo<font color="#808080">(</font>substr<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">));
      </font>tidioma.set_idioma<font color="#808080">(</font>substr<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">11</font><font color="#808080">, </font><font color="#FF0000">20</font><font color="#808080">));
      </font>io.put_string<font color="#808080">(</font>tidioma.codigo<font color="#808080">+</font><font color="#800000">&quot; &quot;</font><font color="#808080">+</font>tidioma.idioma<font color="#808080">+</font>crlf<font color="#808080">);
  </font><font color="#000080"><b>end</b></font><font color="#808080">;
</font><font color="#000080"><b>elseif </b></font>ctarqs.item<font color="#808080">(</font>oppais<font color="#808080">) = </font>sreg <font color="#000080"><b>then
  inspect </b></font>nopcao
    <font color="#000080"><b>when </b></font><font color="#FF0000">1 </font><font color="#000080"><b>then
      </b></font>io.put_string<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">));
      </font>tpais.set_pais<font color="#808080">(</font>digita<font color="#808080">);
    </font><font color="#000080"><b>when </b></font><font color="#FF0000">2 </font><font color="#000080"><b>then
      </b></font>io.put_string<font color="#808080">(</font><font color="#800000">&quot;C&oacute;digo Pa&iacute;s%N&quot;</font><font color="#808080">);
      </font>io.put_string<font color="#808080">(</font><font color="#800000">&quot;------ ----%N&quot;</font><font color="#808080">);
    </font><font color="#000080"><b>when </b></font><font color="#FF0000">3 </font><font color="#000080"><b>then
      </b></font>tpais.set_codigo<font color="#808080">(</font>substr<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">));
      </font>tpais.set_pais<font color="#808080">(</font>substr<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">4</font><font color="#808080">, </font><font color="#FF0000">50</font><font color="#808080">));
      </font>io.put_string<font color="#808080">(</font>tpais.codigo<font color="#808080">+</font><font color="#800000">&quot;    &quot;</font><font color="#808080">+</font>tpais.pais<font color="#808080">+</font>crlf<font color="#808080">);
  </font><font color="#000080"><b>end</b></font><font color="#808080">;
</font><font color="#000080"><b>elseif </b></font>ctarqs.item<font color="#808080">(</font>opprofissao<font color="#808080">) = </font>sreg <font color="#000080"><b>then
  inspect </b></font>nopcao
    <font color="#000080"><b>when </b></font><font color="#FF0000">1 </font><font color="#000080"><b>then
      </b></font>io.put_string<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">) + </font>tprofissao.codigo<font color="#808080">+</font>crlf<font color="#808080">);
      </font>io.put_string<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">));
      </font>tprofissao.set_profissao<font color="#808080">(</font>digita<font color="#808080">);
    </font><font color="#000080"><b>when </b></font><font color="#FF0000">2 </font><font color="#000080"><b>then
      </b></font>io.put_string<font color="#808080">(</font><font color="#800000">&quot;C&oacute;digo     Profiss&atilde;o%N&quot;</font><font color="#808080">);
      </font>io.put_string<font color="#808080">(</font><font color="#800000">&quot;------     ---------%N&quot;</font><font color="#808080">);
    </font><font color="#000080"><b>when </b></font><font color="#FF0000">3 </font><font color="#000080"><b>then
      </b></font>tprofissao.set_codigo<font color="#808080">(</font>substr<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">));
      </font>tprofissao.set_profissao<font color="#808080">(</font>substr<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">11</font><font color="#808080">, </font><font color="#FF0000">50</font><font color="#808080">));
      </font>io.put_string<font color="#808080">(</font>tprofissao.codigo<font color="#808080">+</font><font color="#800000">&quot; &quot;</font><font color="#808080">+</font>tprofissao.profissao<font color="#808080">+</font>crlf<font color="#808080">);
  </font><font color="#000080"><b>end</b></font><font color="#808080">;
</font><font color="#000080"><b>elseif </b></font>ctarqs.item<font color="#808080">(</font>oplivro<font color="#808080">) = </font>sreg <font color="#000080"><b>then
  inspect </b></font>nopcao
    <font color="#000080"><b>when </b></font><font color="#FF0000">1 </font><font color="#000080"><b>then
      </b></font>io.put_string<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">));
      </font>tlivro.set_titulo<font color="#808080">(</font>digita<font color="#808080">);
      </font>tlivro.set_edicao<font color="#808080">(</font>validanumero<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">), </font>tlivro.edicao<font color="#808080">));
      </font>tlivro.set_anopubli<font color="#808080">(</font>validanumero<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">4</font><font color="#808080">), </font>tlivro.anopubli<font color="#808080">));
      </font>mostrarsubdados<font color="#808080">(</font>oplivro<font color="#808080">, </font>opeditora<font color="#808080">, </font><font color="#008080">false</font><font color="#808080">);
      </font>tlivro.set_volume<font color="#808080">(</font>validanumero<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">6</font><font color="#808080">), </font>tlivro.volume<font color="#808080">));
      </font>mostrarsubdados<font color="#808080">(</font>oplivro<font color="#808080">, </font>opidioma<font color="#808080">, </font><font color="#008080">false</font><font color="#808080">);
      </font>tlivro.set_npaginas<font color="#808080">(</font>validanumero<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">8</font><font color="#808080">), </font>tlivro.npaginas<font color="#808080">));
      </font>tlivro.set_preco<font color="#808080">(</font>validanumero<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">9</font><font color="#808080">), </font>tlivro.preco<font color="#808080">));
      </font>tlivro.set_qtdestoque<font color="#808080">(</font>validanumero<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">), </font>tlivro.qtdestoque<font color="#808080">));
    </font><font color="#000080"><b>when </b></font><font color="#FF0000">2 </font><font color="#000080"><b>then 
      </b></font>io.put_string<font color="#808080">(</font><font color="#800000">&quot;&quot;</font><font color="#808080">);
    </font><font color="#000080"><b>when </b></font><font color="#FF0000">3 </font><font color="#000080"><b>then
      </b></font>tlivro.set_isbn<font color="#808080">(</font>trim<font color="#808080">(</font>substr<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">13</font><font color="#808080">)));
      </font>tlivro.set_titulo<font color="#808080">(</font>trim<font color="#808080">(</font>substr<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">14</font><font color="#808080">, </font><font color="#FF0000">50</font><font color="#808080">)));
      </font>tlivro.set_edicao<font color="#808080">(</font>trim<font color="#808080">(</font>substr<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">64</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">)));
      </font>tlivro.set_anopubli<font color="#808080">(</font>trim<font color="#808080">(</font>substr<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">74</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">)));
      </font>tlivro.set_codeditora<font color="#808080">(</font>trim<font color="#808080">(</font>substr<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">84</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">)));
      </font>tlivro.set_volume<font color="#808080">(</font>trim<font color="#808080">(</font>substr<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">94</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">)));
      </font>tlivro.set_codidioma<font color="#808080">(</font>trim<font color="#808080">(</font>substr<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">104</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">)));
      </font>tlivro.set_npaginas<font color="#808080">(</font>trim<font color="#808080">(</font>substr<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">114</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">)));
      </font>tlivro.set_preco<font color="#808080">(</font>trim<font color="#808080">(</font>substr<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">124</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">)));
      </font>tlivro.set_qtdestoque<font color="#808080">(</font>trim<font color="#808080">(</font>substr<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">134</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">)));
      </font>io.put_string<font color="#808080">(</font><font color="#800000">&quot;--------------------%N&quot;</font><font color="#808080">);
      </font>io.put_string<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">) + </font>tlivro.isbn <font color="#808080">+ </font>crlf<font color="#808080">);
      </font>io.put_string<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">) + </font>tlivro.titulo <font color="#808080">+ </font>crlf<font color="#808080">);
      </font>io.put_string<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">) + </font>tlivro.edicao <font color="#808080">+ </font>crlf<font color="#808080">);
      </font>io.put_string<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">4</font><font color="#808080">) + </font>tlivro.anopubli <font color="#808080">+ </font>crlf<font color="#808080">);
      </font>io.put_string<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">5</font><font color="#808080">) + </font>tlivro.codeditora <font color="#808080">+ </font>crlf<font color="#808080">);
      </font>mostrarsubdados<font color="#808080">(</font>oplivro<font color="#808080">, </font>opeditora<font color="#808080">, </font><font color="#008080">true</font><font color="#808080">);
      </font>io.put_string<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">6</font><font color="#808080">) + </font>tlivro.volume <font color="#808080">+ </font>crlf<font color="#808080">);
      </font>io.put_string<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">7</font><font color="#808080">) + </font>tlivro.codidioma <font color="#808080">+ </font>crlf<font color="#808080">);
      </font>mostrarsubdados<font color="#808080">(</font>oplivro<font color="#808080">, </font>opidioma<font color="#808080">, </font><font color="#008080">true</font><font color="#808080">);
      </font>io.put_string<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">8</font><font color="#808080">) + </font>tlivro.npaginas <font color="#808080">+ </font>crlf<font color="#808080">);
      </font>io.put_string<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">9</font><font color="#808080">) + </font>tlivro.preco <font color="#808080">+ </font>crlf<font color="#808080">);
      </font>io.put_string<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">) + </font>tlivro.qtdestoque <font color="#808080">+ </font>crlf<font color="#808080">);
      </font>listarregligados<font color="#808080">(</font>tflivroass<font color="#808080">, </font>oplivroass<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">13</font><font color="#808080">, </font><font color="#FF0000">14</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">, </font>tlivro.isbn<font color="#808080">,
                       </font>tfassunto<font color="#808080">, </font>opassunto<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">4</font><font color="#808080">);
      </font>listarregligados<font color="#808080">(</font>tflivroaut<font color="#808080">, </font>oplivroaut<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">13</font><font color="#808080">, </font><font color="#FF0000">14</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">, </font>tlivro.isbn<font color="#808080">,
                       </font>tfautor<font color="#808080">, </font>opautor<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">4</font><font color="#808080">);
   </font><font color="#000080"><b>end</b></font><font color="#808080">;
</font><font color="#000080"><b>elseif </b></font>ctarqs.item<font color="#808080">(</font>opcliente<font color="#808080">) = </font>sreg <font color="#000080"><b>then
  inspect </b></font>nopcao
    <font color="#000080"><b>when </b></font><font color="#FF0000">1 </font><font color="#000080"><b>then
      </b></font>io.put_string<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">));
      </font>tcliente.set_nome<font color="#808080">(</font>digita<font color="#808080">);
      </font>io.put_string<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">));
      </font>tcliente.set_email<font color="#808080">(</font>digita<font color="#808080">);
      </font>io.put_string<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">4</font><font color="#808080">));
      </font>tcliente.set_identidade<font color="#808080">(</font>digita<font color="#808080">);
      </font>io.put_string<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">5</font><font color="#808080">));
      </font>tcliente.set_sexo<font color="#808080">(</font>digita<font color="#808080">);
      </font>io.put_string<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">6</font><font color="#808080">));
      </font>tcliente.set_telefone<font color="#808080">(</font>digita<font color="#808080">);
      </font>tcliente.set_dtnascimento<font color="#808080">(
              </font>validadatahora<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">7</font><font color="#808080">), </font>tcliente.dtnascimento<font color="#808080">, </font><font color="#008080">true</font><font color="#808080">));
      </font>mostrarsubdados<font color="#808080">(</font>opcliente<font color="#808080">, </font>opendereco<font color="#808080">, </font><font color="#008080">false</font><font color="#808080">);
      </font>mostrarsubdados<font color="#808080">(</font>opcliente<font color="#808080">, </font>oppais<font color="#808080">, </font><font color="#008080">false</font><font color="#808080">);
      </font>mostrarsubdados<font color="#808080">(</font>opcliente<font color="#808080">, </font>opprofissao<font color="#808080">, </font><font color="#008080">false</font><font color="#808080">);
    </font><font color="#000080"><b>when </b></font><font color="#FF0000">2 </font><font color="#000080"><b>then 
      </b></font>io.put_string<font color="#808080">(</font><font color="#800000">&quot;&quot;</font><font color="#808080">);
    </font><font color="#000080"><b>when </b></font><font color="#FF0000">3 </font><font color="#000080"><b>then
      </b></font>tcliente.set_cpf<font color="#808080">(</font>trim<font color="#808080">(</font>substr<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">14</font><font color="#808080">)));
      </font>tcliente.set_nome<font color="#808080">(</font>trim<font color="#808080">(</font>substr<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">15</font><font color="#808080">, </font><font color="#FF0000">30</font><font color="#808080">)));
      </font>tcliente.set_email<font color="#808080">(</font>trim<font color="#808080">(</font>substr<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">45</font><font color="#808080">, </font><font color="#FF0000">30</font><font color="#808080">)));
      </font>tcliente.set_identidade<font color="#808080">(</font>trim<font color="#808080">(</font>substr<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">75</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">)));
      </font>tcliente.set_sexo<font color="#808080">(</font>trim<font color="#808080">(</font>substr<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">85</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">)));
      </font>tcliente.set_telefone<font color="#808080">(</font>trim<font color="#808080">(</font>substr<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">86</font><font color="#808080">, </font><font color="#FF0000">17</font><font color="#808080">)));
      </font>tcliente.set_dtnascimento<font color="#808080">(</font>trim<font color="#808080">(</font>substr<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">103</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">)));
      </font>tcliente.set_codendereco<font color="#808080">(</font>trim<font color="#808080">(</font>substr<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">113</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">)));
      </font>tcliente.set_codpais<font color="#808080">(</font>trim<font color="#808080">(</font>substr<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">123</font><font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">)));
      </font>tcliente.set_codprofissao<font color="#808080">(</font>trim<font color="#808080">(</font>substr<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">126</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">)));
      </font>io.put_string<font color="#808080">(</font><font color="#800000">&quot;--------------------%N&quot;</font><font color="#808080">);
      </font>io.put_string<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">) + </font>tcliente.cpf <font color="#808080">+ </font>crlf<font color="#808080">);
      </font>io.put_string<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">) + </font>tcliente.nome <font color="#808080">+ </font>crlf<font color="#808080">);
      </font>io.put_string<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">) + </font>tcliente.email <font color="#808080">+ </font>crlf<font color="#808080">);
      </font>io.put_string<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">4</font><font color="#808080">) + </font>tcliente.identidade <font color="#808080">+ </font>crlf<font color="#808080">);
      </font>io.put_string<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">5</font><font color="#808080">) + </font>tcliente.sexo <font color="#808080">+ </font>crlf<font color="#808080">);
      </font>io.put_string<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">6</font><font color="#808080">) + </font>tcliente.telefone <font color="#808080">+ </font>crlf<font color="#808080">);
      </font>io.put_string<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">7</font><font color="#808080">) + </font>tcliente.dtnascimento <font color="#808080">+ </font>crlf<font color="#808080">);
      </font>io.put_string<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">8</font><font color="#808080">) + </font>tcliente.codendereco <font color="#808080">+ </font>crlf<font color="#808080">);
      </font>mostrarsubdados<font color="#808080">(</font>opcliente<font color="#808080">, </font>opendereco<font color="#808080">, </font><font color="#008080">true</font><font color="#808080">);
      </font>io.put_string<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">9</font><font color="#808080">) + </font>tcliente.codpais <font color="#808080">+ </font>crlf<font color="#808080">);
      </font>mostrarsubdados<font color="#808080">(</font>opcliente<font color="#808080">, </font>oppais<font color="#808080">, </font><font color="#008080">true</font><font color="#808080">);
      </font>io.put_string<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">) + </font>tcliente.codprofissao <font color="#808080">+ </font>crlf<font color="#808080">);
      </font>mostrarsubdados<font color="#808080">(</font>opcliente<font color="#808080">, </font>opprofissao<font color="#808080">, </font><font color="#008080">true</font><font color="#808080">);
   </font><font color="#000080"><b>end</b></font><font color="#808080">;
</font><font color="#000080"><b>elseif </b></font>ctarqs.item<font color="#808080">(</font>opvenda<font color="#808080">) = </font>sreg <font color="#000080"><b>then
  inspect </b></font>nopcao
    <font color="#000080"><b>when </b></font><font color="#FF0000">1 </font><font color="#000080"><b>then 
      </b></font>mostrarsubdados<font color="#808080">(</font>opvenda<font color="#808080">,</font>opvenda<font color="#808080">, </font><font color="#008080">false</font><font color="#808080">);
    </font><font color="#000080"><b>when </b></font><font color="#FF0000">2 </font><font color="#000080"><b>then
      </b></font>io.put_string<font color="#808080">(</font><font color="#800000">&quot;DataHoraVenda       CPF            ISBN          &quot;</font><font color="#808080">+
      </font><font color="#800000">&quot;Pre&ccedil;oVenda%N&quot;</font><font color="#808080">);
      </font>io.put_string<font color="#808080">(</font><font color="#800000">&quot;-------------       ---            ----          &quot;</font><font color="#808080">+
      </font><font color="#800000">&quot;----------%N&quot;</font><font color="#808080">);
    </font><font color="#000080"><b>when </b></font><font color="#FF0000">3 </font><font color="#000080"><b>then
      </b></font>tvenda.set_dthrvenda<font color="#808080">(</font>substr<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">19</font><font color="#808080">));
      </font>tvenda.set_cpf<font color="#808080">(</font>substr<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">20</font><font color="#808080">, </font><font color="#FF0000">14</font><font color="#808080">));
      </font>tvenda.set_isbn<font color="#808080">(</font>substr<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">34</font><font color="#808080">, </font><font color="#FF0000">13</font><font color="#808080">));
      </font>tvenda.set_precovenda<font color="#808080">(</font>substr<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">47</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">));
      </font>io.put_string<font color="#808080">(</font>tvenda.dthrvenda<font color="#808080">+</font><font color="#800000">&quot; &quot;</font><font color="#808080">+</font>tvenda.cpf<font color="#808080">+</font><font color="#800000">&quot; &quot;</font><font color="#808080">+</font>tvenda.isbn<font color="#808080">+</font><font color="#800000">&quot; &quot;</font><font color="#808080">+
      </font>tvenda.precovenda <font color="#808080">+ </font>crlf<font color="#808080">);
  </font><font color="#000080"><b>end</b></font><font color="#808080">;
</font><font color="#000080"><b>end</b></font><font color="#808080">;

</font><font color="#000080"><b>end</b></font><font color="#808080">;
-- ----------------------------------------------------------------------------
-- Mostra as sub inform&ccedil;&otilde;es de entrada e de sa&iacute;da.
-- sreg - o tipo de arquivo
-- ssubreg - o subtipo de arquivo
-- bSoMostrar - se vai s&oacute; mostrar na sa&iacute;da 
-- ----------------------------------------------------------------------------
</font>mostrarsubdados<font color="#808080">(</font>sreg<font color="#808080">, </font>ssubreg<font color="#808080">: </font><font color="#0000FF">INTEGER</font><font color="#808080">; </font>bsomostrar<font color="#808080">: </font><font color="#0000FF">BOOLEAN</font><font color="#808080">) </font><font color="#000080"><b>is
local 
  </b></font>sregistro<font color="#808080">, </font>spreco<font color="#808080">: </font><font color="#0000FF">STRING</font><font color="#808080">;
  </font>nmaxtentativas<font color="#808080">: </font><font color="#0000FF">INTEGER</font><font color="#808080">;
</font><font color="#000080"><b>do
</b></font>nmaxtentativas<font color="#808080">:=</font><font color="#FF0000">3</font><font color="#808080">;
</font><font color="#000080"><b>if </b></font>ctarqs.item<font color="#808080">(</font>oplivro<font color="#808080">) = </font>sreg <font color="#000080"><b>then
  if </b></font>ctarqs.item<font color="#808080">(</font>opeditora<font color="#808080">) = </font>ssubreg <font color="#000080"><b>then
    if </b></font>bsomostrar <font color="#000080"><b>then
       </b></font>sregistro<font color="#808080">:=</font>pesqarq<font color="#808080">(</font>tfeditora<font color="#808080">,</font>tlivro.codeditora<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">,</font>tamreg<font color="#808080">(</font>opeditora<font color="#808080">))
    </font><font color="#000080"><b>else
       </b></font>sregistro<font color="#808080">:=</font>validaentrada<font color="#808080">(</font>tfeditora<font color="#808080">,</font>ssubreg<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font>tlivro.codeditora<font color="#808080">,
                  </font>nmaxtentativas<font color="#808080">,</font><font color="#008080">false</font><font color="#808080">,</font>opnumero<font color="#808080">);
    </font><font color="#000080"><b>end</b></font><font color="#808080">;
    </font><font color="#000080"><b>if </b></font>sregistro.is_empty<font color="#808080">=</font><font color="#008080">false </font><font color="#000080"><b>then
      </b></font>tlivro.set_codeditora<font color="#808080">(</font>trim<font color="#808080">(</font>substr<font color="#808080">(</font>sregistro<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">)));
      </font>io.put_string<font color="#808080">(</font><font color="#800000">&quot; &quot; </font><font color="#808080">+ </font>rotulo<font color="#808080">(</font>opeditora<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">));
      </font>io.put_string<font color="#808080">(</font>substr<font color="#808080">(</font>sregistro<font color="#808080">, </font>g_nposchave<font color="#808080">, </font>g_ntamchave<font color="#808080">)+</font>crlf<font color="#808080">);
    </font><font color="#000080"><b>end</b></font><font color="#808080">;
  </font><font color="#000080"><b>elseif </b></font>ctarqs.item<font color="#808080">(</font>opidioma<font color="#808080">) = </font>ssubreg <font color="#000080"><b>then
    if </b></font>bsomostrar <font color="#000080"><b>then
       </b></font>sregistro<font color="#808080">:=</font>pesqarq<font color="#808080">(</font>tfidioma<font color="#808080">, </font>tlivro.codidioma<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">,</font>tamreg<font color="#808080">(</font>opidioma<font color="#808080">))
    </font><font color="#000080"><b>else
       </b></font>sregistro<font color="#808080">:=</font>validaentrada<font color="#808080">(</font>tfidioma<font color="#808080">,</font>ssubreg<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font>tlivro.codidioma<font color="#808080">,
                  </font>nmaxtentativas<font color="#808080">,</font><font color="#008080">false</font><font color="#808080">,</font>opnumero<font color="#808080">);
    </font><font color="#000080"><b>end</b></font><font color="#808080">;
    </font><font color="#000080"><b>if </b></font>sregistro.is_empty<font color="#808080">=</font><font color="#008080">false </font><font color="#000080"><b>then
      </b></font>tlivro.set_codidioma<font color="#808080">(</font>trim<font color="#808080">(</font>substr<font color="#808080">(</font>sregistro<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">)));
      </font>io.put_string<font color="#808080">(</font><font color="#800000">&quot; &quot; </font><font color="#808080">+ </font>rotulo<font color="#808080">(</font>opidioma<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">));
      </font>io.put_string<font color="#808080">(</font>substr<font color="#808080">(</font>sregistro<font color="#808080">, </font>g_nposchave<font color="#808080">, </font>g_ntamchave<font color="#808080">)+</font>crlf<font color="#808080">);
    </font><font color="#000080"><b>end</b></font><font color="#808080">;
  </font><font color="#000080"><b>end</b></font><font color="#808080">;
</font><font color="#000080"><b>elseif </b></font>ctarqs.item<font color="#808080">(</font>opcliente<font color="#808080">) = </font>sreg <font color="#000080"><b>then
  if </b></font>ctarqs.item<font color="#808080">(</font>opendereco<font color="#808080">) = </font>ssubreg <font color="#000080"><b>then
    if </b></font>bsomostrar <font color="#000080"><b>then
       </b></font>sregistro<font color="#808080">:=</font>pesqarq<font color="#808080">(</font>tfendereco<font color="#808080">, </font>tcliente.codendereco<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">,
                  </font>tamreg<font color="#808080">(</font>opendereco<font color="#808080">))
    </font><font color="#000080"><b>else
       </b></font>sregistro<font color="#808080">:=</font>validaentrada<font color="#808080">(</font>tfendereco<font color="#808080">,</font>ssubreg<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font>tcliente.codendereco<font color="#808080">,
                  </font>nmaxtentativas<font color="#808080">,</font><font color="#008080">false</font><font color="#808080">,</font>opnumero<font color="#808080">);
    </font><font color="#000080"><b>end</b></font><font color="#808080">;
    </font><font color="#000080"><b>if </b></font>sregistro.is_empty<font color="#808080">=</font><font color="#008080">false </font><font color="#000080"><b>then
      </b></font>tcliente.set_codendereco<font color="#808080">(</font>trim<font color="#808080">(</font>substr<font color="#808080">(</font>sregistro<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">)));
      </font>io.put_string<font color="#808080">(</font><font color="#800000">&quot; &quot; </font><font color="#808080">+ </font>rotulo<font color="#808080">(</font>opendereco<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">));
      </font>io.put_string<font color="#808080">(</font>substr<font color="#808080">(</font>sregistro<font color="#808080">, </font>g_nposchave<font color="#808080">, </font>g_ntamchave<font color="#808080">)+</font>crlf<font color="#808080">);
      </font>io.put_string<font color="#808080">(</font><font color="#800000">&quot; &quot; </font><font color="#808080">+ </font>rotulo<font color="#808080">(</font>opendereco<font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">));
      </font>io.put_string<font color="#808080">(</font>substr<font color="#808080">(</font>sregistro<font color="#808080">, </font>g_nposchave<font color="#808080">, </font>g_ntamchave<font color="#808080">)+</font>crlf<font color="#808080">);
      </font>io.put_string<font color="#808080">(</font><font color="#800000">&quot; &quot; </font><font color="#808080">+ </font>rotulo<font color="#808080">(</font>opendereco<font color="#808080">, </font><font color="#FF0000">4</font><font color="#808080">));
      </font>io.put_string<font color="#808080">(</font>substr<font color="#808080">(</font>sregistro<font color="#808080">, </font>g_nposchave<font color="#808080">, </font>g_ntamchave<font color="#808080">)+</font>crlf<font color="#808080">);
      </font>io.put_string<font color="#808080">(</font><font color="#800000">&quot; &quot; </font><font color="#808080">+ </font>rotulo<font color="#808080">(</font>opendereco<font color="#808080">, </font><font color="#FF0000">5</font><font color="#808080">));
      </font>io.put_string<font color="#808080">(</font>substr<font color="#808080">(</font>sregistro<font color="#808080">, </font>g_nposchave<font color="#808080">, </font>g_ntamchave<font color="#808080">)+</font>crlf<font color="#808080">);
      </font>io.put_string<font color="#808080">(</font><font color="#800000">&quot; &quot; </font><font color="#808080">+ </font>rotulo<font color="#808080">(</font>opendereco<font color="#808080">, </font><font color="#FF0000">6</font><font color="#808080">));
      </font>io.put_string<font color="#808080">(</font>substr<font color="#808080">(</font>sregistro<font color="#808080">, </font>g_nposchave<font color="#808080">, </font>g_ntamchave<font color="#808080">)+</font>crlf<font color="#808080">);
    </font><font color="#000080"><b>end</b></font><font color="#808080">;
  </font><font color="#000080"><b>elseif </b></font>ctarqs.item<font color="#808080">(</font>oppais<font color="#808080">) = </font>ssubreg <font color="#000080"><b>then
    if </b></font>bsomostrar <font color="#000080"><b>then
       </b></font>sregistro<font color="#808080">:=</font>pesqarq<font color="#808080">(</font>tfpais<font color="#808080">, </font>tcliente.codpais<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">, </font>tamreg<font color="#808080">(</font>oppais<font color="#808080">))
    </font><font color="#000080"><b>else
       </b></font>sregistro<font color="#808080">:=</font>validaentrada<font color="#808080">(</font>tfpais<font color="#808080">,</font>ssubreg<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font>tcliente.codpais<font color="#808080">,
                  </font>nmaxtentativas<font color="#808080">,</font><font color="#008080">false</font><font color="#808080">,</font>optexto<font color="#808080">);
    </font><font color="#000080"><b>end</b></font><font color="#808080">;
    </font><font color="#000080"><b>if </b></font>sregistro.is_empty<font color="#808080">=</font><font color="#008080">false </font><font color="#000080"><b>then
      </b></font>tcliente.set_codpais<font color="#808080">(</font>trim<font color="#808080">(</font>substr<font color="#808080">(</font>sregistro<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#FF0000">3</font><font color="#808080">)));
      </font>io.put_string<font color="#808080">(</font><font color="#800000">&quot; &quot; </font><font color="#808080">+ </font>rotulo<font color="#808080">(</font>oppais<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">));
      </font>io.put_string<font color="#808080">(</font>substr<font color="#808080">(</font>sregistro<font color="#808080">, </font>g_nposchave<font color="#808080">, </font>g_ntamchave<font color="#808080">)+</font>crlf<font color="#808080">);
    </font><font color="#000080"><b>end</b></font><font color="#808080">;
  </font><font color="#000080"><b>elseif </b></font>ctarqs.item<font color="#808080">(</font>opprofissao<font color="#808080">) = </font>ssubreg <font color="#000080"><b>then
    if </b></font>bsomostrar <font color="#000080"><b>then
       </b></font>sregistro<font color="#808080">:=</font>pesqarq<font color="#808080">(</font>tfprofissao<font color="#808080">, </font>tcliente.codprofissao<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">,
                  </font>tamreg<font color="#808080">(</font>opprofissao<font color="#808080">))
    </font><font color="#000080"><b>else
       </b></font>sregistro<font color="#808080">:=</font>validaentrada<font color="#808080">(</font>tfprofissao<font color="#808080">,</font>ssubreg<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font>tcliente.codprofissao<font color="#808080">,
                  </font>nmaxtentativas<font color="#808080">,</font><font color="#008080">false</font><font color="#808080">,</font>opnumero<font color="#808080">);
    </font><font color="#000080"><b>end</b></font><font color="#808080">;
    </font><font color="#000080"><b>if </b></font>sregistro.is_empty<font color="#808080">=</font><font color="#008080">false </font><font color="#000080"><b>then
      </b></font>tcliente.set_codprofissao<font color="#808080">(</font>trim<font color="#808080">(</font>substr<font color="#808080">(</font>sregistro<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">)));
      </font>io.put_string<font color="#808080">(</font><font color="#800000">&quot; &quot; </font><font color="#808080">+ </font>rotulo<font color="#808080">(</font>opprofissao<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">));
      </font>io.put_string<font color="#808080">(</font>substr<font color="#808080">(</font>sregistro<font color="#808080">, </font>g_nposchave<font color="#808080">, </font>g_ntamchave<font color="#808080">)+</font>crlf<font color="#808080">);
    </font><font color="#000080"><b>end</b></font><font color="#808080">;
  </font><font color="#000080"><b>end</b></font><font color="#808080">;
</font><font color="#000080"><b>elseif </b></font>ctarqs.item<font color="#808080">(</font>opvenda<font color="#808080">) = </font>sreg <font color="#000080"><b>then
  </b></font>sregistro<font color="#808080">:=</font>pesqarq<font color="#808080">(</font>tflivro<font color="#808080">, </font>tvenda.isbn<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">13</font><font color="#808080">, </font>tamreg<font color="#808080">(</font>oplivro<font color="#808080">));
  </font><font color="#000080"><b>if </b></font>sregistro.is_empty<font color="#808080">=</font><font color="#008080">false </font><font color="#000080"><b>then
    </b></font>io.put_string<font color="#808080">(</font><font color="#800000">&quot; &quot; </font><font color="#808080">+ </font>rotulo<font color="#808080">(</font>oplivro<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">)); -- titulo
    </font>io.put_string<font color="#808080">(</font>substr<font color="#808080">(</font>sregistro<font color="#808080">, </font>g_nposchave<font color="#808080">, </font>g_ntamchave<font color="#808080">)+</font>crlf<font color="#808080">);
    </font>io.put_string<font color="#808080">(</font><font color="#800000">&quot; &quot; </font><font color="#808080">+ </font>rotulo<font color="#808080">(</font>oplivro<font color="#808080">, </font><font color="#FF0000">9</font><font color="#808080">)); -- preco 
    </font>spreco<font color="#808080">:=</font>substr<font color="#808080">(</font>sregistro<font color="#808080">, </font>g_nposchave<font color="#808080">, </font>g_ntamchave<font color="#808080">);
    </font>g_npreco<font color="#808080">:=</font>spreco.to_double<font color="#808080">;
    </font>io.put_string<font color="#808080">(</font>spreco <font color="#808080">+ </font>crlf<font color="#808080">);
  </font><font color="#000080"><b>end</b></font><font color="#808080">;
</font><font color="#000080"><b>end</b></font><font color="#808080">;
</font><font color="#000080"><b>end</b></font><font color="#808080">;
-- ----------------------------------------------------------------------------
-- realiza os cadastros dos arquivos que se ligam a outros arquivos.
-- sreg - o tipo de arquivo
-- sacao - a a&ccedil;&atilde;o a ser realizada
-- scodigo - um das chaves do arquivo de liga&ccedil;&atilde;o
-- ----------------------------------------------------------------------------
</font>frmcadligados<font color="#808080">(</font>sreg<font color="#808080">, </font>sacao<font color="#808080">: </font><font color="#0000FF">INTEGER</font><font color="#808080">; </font>scodigo<font color="#808080">: </font><font color="#0000FF">STRING</font><font color="#808080">) </font><font color="#000080"><b>is
local
  </b></font>nqtd<font color="#808080">, </font>ncont<font color="#808080">, </font>nqtdestoque<font color="#808080">: </font><font color="#0000FF">INTEGER</font><font color="#808080">;
  </font>ntotalpreco<font color="#808080">: </font><font color="#0000FF">DOUBLE</font><font color="#808080">;
  </font>slinha<font color="#808080">, </font>stotalpreco<font color="#808080">, </font>spreco<font color="#808080">, </font>sqtd<font color="#808080">: </font><font color="#0000FF">STRING</font><font color="#808080">;
</font><font color="#000080"><b>do
if </b></font>ctacao.item<font color="#808080">(</font>opnovo<font color="#808080">) = </font>sacao <font color="#000080"><b>then
  if </b></font>ctarqs.item<font color="#808080">(</font>oplivroass<font color="#808080">) = </font>sreg <font color="#000080"><b>then
    </b></font>sqtd<font color="#808080">:=</font>validanumero<font color="#808080">(</font><font color="#800000">&quot;Quantos assuntos quer cadastrar?: &quot;</font><font color="#808080">, </font>sqtd<font color="#808080">);
    </font>nqtd<font color="#808080">:=</font>sqtd.to_integer<font color="#808080">;
    </font><font color="#000080"><b>from  </b></font>ncont<font color="#808080">:=</font><font color="#FF0000">1</font><font color="#808080">; 
    </font><font color="#000080"><b>until </b></font>ncont <font color="#808080">&gt; </font>nqtd
    <font color="#000080"><b>loop
      </b></font>tlivroass.set_isbn<font color="#808080">(</font>scodigo<font color="#808080">);
      </font>io.put_string<font color="#808080">(</font>rotulo<font color="#808080">(</font>oplivroass<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">));
      </font>tlivroass.set_codassunto<font color="#808080">(</font>digita<font color="#808080">);
      </font>slinha<font color="#808080">:=</font>pesqarq<font color="#808080">(</font>tfassunto<font color="#808080">, </font>tlivroass.codassunto<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">,</font>tamreg<font color="#808080">(</font>opassunto<font color="#808080">));
      </font>io.put_string<font color="#808080">(</font><font color="#800000">&quot; &quot; </font><font color="#808080">+ </font>rotulo<font color="#808080">(</font>opassunto<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">));
      </font>io.put_string<font color="#808080">(</font>substr<font color="#808080">(</font>slinha<font color="#808080">, </font>g_nposchave<font color="#808080">, </font>g_ntamchave<font color="#808080">)+</font>crlf<font color="#808080">);
      </font>pesqlinhaexcluida<font color="#808080">(</font>tflivroass<font color="#808080">, </font>tamreg<font color="#808080">(</font>sreg<font color="#808080">));
      </font>submenu<font color="#808080">(</font><font color="#FF0000">14</font><font color="#808080">, </font>sreg<font color="#808080">);
      </font>ncont<font color="#808080">:=</font>ncont<font color="#808080">+</font><font color="#FF0000">1</font><font color="#808080">;
    </font><font color="#000080"><b>end</b></font><font color="#808080">;
  </font><font color="#000080"><b>elseif </b></font>ctarqs.item<font color="#808080">(</font>oplivroaut<font color="#808080">) = </font>sreg <font color="#000080"><b>then
    </b></font>sqtd<font color="#808080">:=</font>validanumero<font color="#808080">(</font><font color="#800000">&quot;Quantos autores quer cadastrar?: &quot;</font><font color="#808080">,</font>sqtd<font color="#808080">);
    </font>nqtd<font color="#808080">:=</font>sqtd.to_integer<font color="#808080">;
    </font><font color="#000080"><b>from  </b></font>ncont<font color="#808080">:=</font><font color="#FF0000">1</font><font color="#808080">; 
    </font><font color="#000080"><b>until </b></font>ncont <font color="#808080">&gt; </font>nqtd
    <font color="#000080"><b>loop
      </b></font>tlivroaut.set_isbn<font color="#808080">(</font>scodigo<font color="#808080">);
      </font>io.put_string<font color="#808080">(</font>rotulo<font color="#808080">(</font>oplivroaut<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">));
      </font>tlivroaut.set_codautor<font color="#808080">(</font>digita<font color="#808080">);
      </font>slinha<font color="#808080">:=</font>pesqarq<font color="#808080">(</font>tfautor<font color="#808080">, </font>tlivroaut.codautor<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">,</font>tamreg<font color="#808080">(</font>opautor<font color="#808080">));
      </font>io.put_string<font color="#808080">(</font><font color="#800000">&quot; &quot; </font><font color="#808080">+ </font>rotulo<font color="#808080">(</font>opautor<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">));
      </font>io.put_string<font color="#808080">(</font>substr<font color="#808080">(</font>slinha<font color="#808080">, </font>g_nposchave<font color="#808080">, </font>g_ntamchave<font color="#808080">)+</font>crlf<font color="#808080">);
      </font>pesqlinhaexcluida<font color="#808080">(</font>tflivroaut<font color="#808080">, </font>tamreg<font color="#808080">(</font>sreg<font color="#808080">));
      </font>submenu<font color="#808080">(</font><font color="#FF0000">14</font><font color="#808080">, </font>sreg<font color="#808080">);
      </font>ncont<font color="#808080">:=</font>ncont<font color="#808080">+</font><font color="#FF0000">1</font><font color="#808080">;
    </font><font color="#000080"><b>end</b></font><font color="#808080">;
  </font><font color="#000080"><b>elseif </b></font>ctarqs.item<font color="#808080">(</font>opvenda<font color="#808080">) = </font>sreg <font color="#000080"><b>then
    </b></font>sqtd<font color="#808080">:=</font>validanumero<font color="#808080">(</font><font color="#800000">&quot;Quantos livros quer vender?: &quot;</font><font color="#808080">,</font>sqtd<font color="#808080">);
    </font>nqtd<font color="#808080">:=</font>sqtd.to_integer<font color="#808080">;
    </font>ntotalpreco<font color="#808080">:=</font><font color="#FF0000">0</font><font color="#808080">;
    </font><font color="#000080"><b>from  </b></font>ncont<font color="#808080">:=</font><font color="#FF0000">1</font><font color="#808080">; 
    </font><font color="#000080"><b>until </b></font>ncont <font color="#808080">&gt; </font>nqtd
    <font color="#000080"><b>loop
      </b></font>slinha<font color="#808080">:=</font>validaentrada<font color="#808080">(</font>tflivro<font color="#808080">,</font>oplivro<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font>tvenda.isbn<font color="#808080">,</font><font color="#FF0000">3</font><font color="#808080">,</font><font color="#008080">false</font><font color="#808080">,</font>optexto<font color="#808080">);
      </font><font color="#000080"><b>if </b></font>slinha.is_empty<font color="#808080">=</font><font color="#008080">false </font><font color="#000080"><b>then
        </b></font>tvenda.set_isbn<font color="#808080">(</font>trim<font color="#808080">(</font>substr<font color="#808080">(</font>slinha<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#FF0000">13</font><font color="#808080">)));
        </font><font color="#000080"><b>if </b></font>validaisbn<font color="#808080">(</font>tvenda.isbn<font color="#808080">) </font><font color="#000080"><b>then
          </b></font>mostrardados<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">);
          </font>tlivro.set_qtdestoque<font color="#808080">(</font>trim<font color="#808080">(</font>substr<font color="#808080">(</font>slinha<font color="#808080">,</font><font color="#FF0000">134</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">)));
          </font>nqtdestoque<font color="#808080">:=</font>tlivro.qtdestoque.to_integer
          <font color="#000080"><b>if </b></font>nqtdestoque <font color="#808080">&gt; </font><font color="#FF0000">0 </font><font color="#000080"><b>then
             </b></font>ntotalpreco<font color="#808080">:=</font>ntotalpreco <font color="#808080">+ </font>g_npreco<font color="#808080">;
             </font>spreco<font color="#808080">:=</font>g_npreco.to_string
             tvenda.set_precovenda<font color="#808080">(</font>spreco<font color="#808080">);
             </font>g_salvarinclusao<font color="#808080">:=</font><font color="#008080">false</font><font color="#808080">;
             </font>submenu<font color="#808080">(</font><font color="#FF0000">14</font><font color="#808080">, </font>sreg<font color="#808080">);
             </font><font color="#000080"><b>if </b></font>g_salvarinclusao <font color="#000080"><b>then
                </b></font>slinha<font color="#808080">:=</font>pesqarq<font color="#808080">(</font>tflivro<font color="#808080">, </font>tvenda.isbn<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">13</font><font color="#808080">, </font>tamreg<font color="#808080">(</font>oplivro<font color="#808080">));
                </font><font color="#000080"><b>if </b></font>slinha.is_empty<font color="#808080">=</font><font color="#008080">false </font><font color="#000080"><b>then
                   </b></font>nqtdestoque<font color="#808080">:=</font>nqtdestoque<font color="#808080">-</font><font color="#FF0000">1</font><font color="#808080">;
                   </font>tlivro.set_qtdestoque<font color="#808080">(</font>nqtdestoque.to_string<font color="#808080">)
                   </font>slinha<font color="#808080">:=</font>substr<font color="#808080">(</font>slinha<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#FF0000">133</font><font color="#808080">)+</font>esp<font color="#808080">(</font>tlivro.qtdestoque<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">);
                   </font>escrevearq<font color="#808080">(</font>tflivro<font color="#808080">, </font>slinha<font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">);
                </font><font color="#000080"><b>end</b></font><font color="#808080">;
             </font><font color="#000080"><b>end</b></font><font color="#808080">;
             </font>ncont<font color="#808080">:=</font>ncont<font color="#808080">+</font><font color="#FF0000">1</font><font color="#808080">;
          </font><font color="#000080"><b>else 
            </b></font>io.put_string<font color="#808080">(</font>msg_semestoque<font color="#808080">);
          </font><font color="#000080"><b>end</b></font><font color="#808080">;
        </font><font color="#000080"><b>else 
          </b></font>io.put_string<font color="#808080">(</font>msg_isbninv<font color="#808080">);
        </font><font color="#000080"><b>end</b></font><font color="#808080">;
      </font><font color="#000080"><b>end</b></font><font color="#808080">;
    </font><font color="#000080"><b>end</b></font><font color="#808080">;
    </font>stotalpreco<font color="#808080">:=</font>ntotalpreco.to_string
    io.put_string<font color="#808080">(</font><font color="#800000">&quot;Total de &quot; </font><font color="#808080">+ </font>rotulo<font color="#808080">(</font>sreg<font color="#808080">,</font><font color="#FF0000">4</font><font color="#808080">) + </font>stotalpreco <font color="#808080">+ </font>crlf<font color="#808080">);
  </font><font color="#000080"><b>end</b></font><font color="#808080">;
</font><font color="#000080"><b>elseif </b></font>ctacao.item<font color="#808080">(</font>opexcluir<font color="#808080">) = </font>sacao <font color="#000080"><b>then
  if </b></font>ctarqs.item<font color="#808080">(</font>oplivroass<font color="#808080">) = </font>sreg <font color="#000080"><b>then
     </b></font>excluirregligados<font color="#808080">(</font>tflivroass<font color="#808080">, </font>sreg<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">13</font><font color="#808080">, </font>scodigo<font color="#808080">);
  </font><font color="#000080"><b>elseif </b></font>ctarqs.item<font color="#808080">(</font>oplivroaut<font color="#808080">) = </font>sreg <font color="#000080"><b>then
     </b></font>excluirregligados<font color="#808080">(</font>tflivroaut<font color="#808080">, </font>sreg<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">13</font><font color="#808080">, </font>scodigo<font color="#808080">);
  </font><font color="#000080"><b>end</b></font><font color="#808080">;
</font><font color="#000080"><b>end</b></font><font color="#808080">;

</font><font color="#000080"><b>end</b></font><font color="#808080">;
-- ----------------------------------------------------------------------------
-- Realiza a exclus&atilde;o dos arquivos de liga&ccedil;&atilde;o.
-- sArq - o arquivo de liga&ccedil;&atilde;o
-- sreg - o tipo de arquivo de liga&ccedil;&atilde;o
-- nPosChave - a posicao inicial da chave dentro do registro
-- nTamChave - o tamanho da chave dentro do registro
-- sChave - a chave a ser excluida
-- ----------------------------------------------------------------------------
</font>excluirregligados<font color="#808080">(</font>sarq<font color="#808080">: </font><font color="#0000FF">TEXT_FILE_READ_WRITE</font><font color="#808080">; </font>sreg<font color="#808080">, </font>nposchave<font color="#808080">,
                  </font>ntamchave<font color="#808080">: </font><font color="#0000FF">INTEGER</font><font color="#808080">; </font>schave<font color="#808080">: </font><font color="#0000FF">STRING</font><font color="#808080">) </font><font color="#000080"><b>is
local
  </b></font>slinha<font color="#808080">, </font>scodigo<font color="#808080">: </font><font color="#0000FF">STRING</font><font color="#808080">;
</font><font color="#000080"><b>do
  </b></font>reconecta<font color="#808080">(</font>sarq<font color="#808080">);
  </font><font color="#000080"><b>from
    </b></font>slinha<font color="#808080">:=</font><font color="#800000">&quot;&quot;</font><font color="#808080">;
  </font><font color="#000080"><b>until
    </b></font>sarq.end_of_input
  <font color="#000080"><b>loop
    </b></font>slinha.clear_count<font color="#808080">;
    </font>sarq.read_line_in<font color="#808080">(</font>slinha<font color="#808080">);
    </font><font color="#000080"><b>if </b></font>slinha.is_empty<font color="#808080">=</font><font color="#008080">false </font><font color="#000080"><b>then
      </b></font>scodigo<font color="#808080">:=</font>trim<font color="#808080">(</font>substr<font color="#808080">(</font>slinha<font color="#808080">,</font>nposchave<font color="#808080">,</font>ntamchave<font color="#808080">));
      </font><font color="#000080"><b>if </b></font>scodigo.is_equal<font color="#808080">(</font>schave<font color="#808080">) </font><font color="#000080"><b>then
         </b></font>btnacao<font color="#808080">(</font>sreg<font color="#808080">,</font>opconfirmaexclusao<font color="#808080">);
      </font><font color="#000080"><b>end</b></font><font color="#808080">;
    </font><font color="#000080"><b>end</b></font><font color="#808080">;
  </font><font color="#000080"><b>end</b></font><font color="#808080">;
</font><font color="#000080"><b>end</b></font><font color="#808080">;

</font><font color="#000080"><b>end
</b></font></font>
</code></pre>
</body>
</html>