<html>
<head>
<title>Livrus Virtus - Console - Perl</title>
</head>
<!-- Generated by ConTEXT HTML exporter -->
<body text="#000000" bgcolor="#FFFFFF">
<pre>
<code><font  face="Courier New"><font color="#808080"><i>#!/usr/bin/perl
#------------------------------------------------------------------------------
# Sistema integrante do projeto Livrus Virtus.
# Todos os direitos reservados para Henrique F. de Souza.
# Vers&atilde;o programada na linguagem Perl.
#------------------------------------------------------------------------------
# programa Livrus

#use strict;
</i></font><font color="#0000FF">use </font><font color="#800080">warnings;

our </font><font color="#008080">%tAssunto </font><font color="#800080">= ( codigo =&gt; </font><font color="#800000">&quot;&quot;</font><font color="#800080">, assunto =&gt; </font><font color="#800000">&quot;&quot; </font><font color="#800080">);
our </font><font color="#008080">%tAutor </font><font color="#800080">= ( codigo =&gt; </font><font color="#800000">&quot;&quot;</font><font color="#800080">, autor =&gt; </font><font color="#800000">&quot;&quot; </font><font color="#800080">);
our </font><font color="#008080">%tEditora </font><font color="#800080">= ( codigo =&gt; </font><font color="#800000">&quot;&quot;</font><font color="#800080">, editora =&gt; </font><font color="#800000">&quot;&quot; </font><font color="#800080">);
our </font><font color="#008080">%tIdioma </font><font color="#800080">= ( codigo =&gt; </font><font color="#800000">&quot;&quot;</font><font color="#800080">, idioma =&gt; </font><font color="#800000">&quot;&quot; </font><font color="#800080">);
our </font><font color="#008080">%tUsuario </font><font color="#800080">= ( login =&gt; </font><font color="#800000">&quot;&quot;</font><font color="#800080">, senha =&gt; </font><font color="#800000">&quot;&quot; </font><font color="#800080">);
our </font><font color="#008080">%tPais </font><font color="#800080">= ( codigo =&gt; </font><font color="#800000">&quot;&quot;</font><font color="#800080">, pais =&gt; </font><font color="#800000">&quot;&quot; </font><font color="#800080">);
our </font><font color="#008080">%tProfissao </font><font color="#800080">= ( codigo =&gt; </font><font color="#800000">&quot;&quot;</font><font color="#800080">, profissao =&gt; </font><font color="#800000">&quot;&quot; </font><font color="#800080">);
our </font><font color="#008080">%tLivro </font><font color="#800080">= ( isbn =&gt; </font><font color="#800000">&quot;&quot;</font><font color="#800080">, titulo =&gt; </font><font color="#800000">&quot;&quot;</font><font color="#800080">, edicao =&gt; </font><font color="#800000">&quot;&quot;</font><font color="#800080">, anopubli =&gt; </font><font color="#800000">&quot;&quot;</font><font color="#800080">,
   codeditora =&gt; </font><font color="#800000">&quot;&quot;</font><font color="#800080">, volume =&gt; </font><font color="#800000">&quot;&quot;</font><font color="#800080">, codidioma =&gt; </font><font color="#800000">&quot;&quot;</font><font color="#800080">, npaginas =&gt; </font><font color="#800000">&quot;&quot;</font><font color="#800080">, 
   preco =&gt; </font><font color="#800000">&quot;&quot;</font><font color="#800080">, qtdestoque =&gt; </font><font color="#800000">&quot;&quot; </font><font color="#800080">);
our </font><font color="#008080">%tLivroAss </font><font color="#800080">= ( isbn =&gt; </font><font color="#800000">&quot;&quot;</font><font color="#800080">, codassunto =&gt; </font><font color="#800000">&quot;&quot; </font><font color="#800080">);
our </font><font color="#008080">%tLivroAut </font><font color="#800080">= ( isbn =&gt; </font><font color="#800000">&quot;&quot;</font><font color="#800080">, codautor =&gt; </font><font color="#800000">&quot;&quot; </font><font color="#800080">);
our </font><font color="#008080">%tCliente </font><font color="#800080">= ( cpf =&gt; </font><font color="#800000">&quot;&quot;</font><font color="#800080">, nome =&gt; </font><font color="#800000">&quot;&quot;</font><font color="#800080">, email =&gt; </font><font color="#800000">&quot;&quot;</font><font color="#800080">, identidade =&gt; </font><font color="#800000">&quot;&quot;</font><font color="#800080">,
   sexo =&gt; </font><font color="#800000">&quot;&quot;</font><font color="#800080">, telefone =&gt; </font><font color="#800000">&quot;&quot;</font><font color="#800080">, dtnascimento =&gt; </font><font color="#800000">&quot;&quot;</font><font color="#800080">, codendereco =&gt; </font><font color="#800000">&quot;&quot;</font><font color="#800080">,
   codpais =&gt; </font><font color="#800000">&quot;&quot;</font><font color="#800080">, codprofissao =&gt; </font><font color="#800000">&quot;&quot; </font><font color="#800080">);
our </font><font color="#008080">%tEndereco </font><font color="#800080">= ( codigo =&gt; </font><font color="#800000">&quot;&quot;</font><font color="#800080">, logradouro =&gt; </font><font color="#800000">&quot;&quot;</font><font color="#800080">, bairro =&gt; </font><font color="#800000">&quot;&quot;</font><font color="#800080">, cep =&gt; </font><font color="#800000">&quot;&quot;</font><font color="#800080">, 
   cidade =&gt; </font><font color="#800000">&quot;&quot;</font><font color="#800080">, estado =&gt; </font><font color="#800000">&quot;&quot; </font><font color="#800080">);
our </font><font color="#008080">%tVenda </font><font color="#800080">= ( dthrvenda =&gt; </font><font color="#800000">&quot;&quot;</font><font color="#800080">, cpf =&gt; </font><font color="#800000">&quot;&quot;</font><font color="#800080">, isbn =&gt; </font><font color="#800000">&quot;&quot;</font><font color="#800080">, precovenda =&gt; </font><font color="#800000">&quot;&quot; </font><font color="#800080">);

</font><font color="#808080"><i># ctTipo 
</i></font><font color="#800080">our </font><font color="#008080">$opTexto </font><font color="#800080">= </font><font color="#FF0000">1</font><font color="#800080">; our </font><font color="#008080">$opNumero </font><font color="#800080">= </font><font color="#FF0000">2</font><font color="#800080">; our </font><font color="#008080">$opData </font><font color="#800080">= </font><font color="#FF0000">3</font><font color="#800080">; our </font><font color="#008080">$opDataHora </font><font color="#800080">= </font><font color="#FF0000">4</font><font color="#800080">; 
our </font><font color="#008080">$opSenha </font><font color="#800080">= </font><font color="#FF0000">5</font><font color="#800080">;
</font><font color="#808080"><i># ctArqs 
</i></font><font color="#800080">our </font><font color="#008080">$opAssunto </font><font color="#800080">= </font><font color="#FF0000">1</font><font color="#800080">; our </font><font color="#008080">$opAutor </font><font color="#800080">= </font><font color="#FF0000">2</font><font color="#800080">; our </font><font color="#008080">$opEditora </font><font color="#800080">= </font><font color="#FF0000">3</font><font color="#800080">; our </font><font color="#008080">$opEndereco </font><font color="#800080">= </font><font color="#FF0000">4</font><font color="#800080">; 
our </font><font color="#008080">$opIdioma </font><font color="#800080">= </font><font color="#FF0000">5</font><font color="#800080">; our </font><font color="#008080">$opPais </font><font color="#800080">= </font><font color="#FF0000">6</font><font color="#800080">; our </font><font color="#008080">$opProfissao </font><font color="#800080">= </font><font color="#FF0000">7</font><font color="#800080">; our </font><font color="#008080">$opCliente </font><font color="#800080">= </font><font color="#FF0000">8</font><font color="#800080">; 
our </font><font color="#008080">$opLivro </font><font color="#800080">= </font><font color="#FF0000">9</font><font color="#800080">; our </font><font color="#008080">$opLivroAss </font><font color="#800080">= </font><font color="#FF0000">10</font><font color="#800080">; our </font><font color="#008080">$opLivroAut </font><font color="#800080">= </font><font color="#FF0000">11</font><font color="#800080">;
our </font><font color="#008080">$opUsuario </font><font color="#800080">= </font><font color="#FF0000">12</font><font color="#800080">; our </font><font color="#008080">$opVenda </font><font color="#800080">= </font><font color="#FF0000">13</font><font color="#800080">;
</font><font color="#808080"><i># ctAcao 
</i></font><font color="#800080">our </font><font color="#008080">$opNovo </font><font color="#800080">= </font><font color="#FF0000">1</font><font color="#800080">; our </font><font color="#008080">$opAlterar </font><font color="#800080">= </font><font color="#FF0000">2</font><font color="#800080">; our </font><font color="#008080">$opPesquisar </font><font color="#800080">= </font><font color="#FF0000">3</font><font color="#800080">; 
our </font><font color="#008080">$opSalvarInclusao </font><font color="#800080">= </font><font color="#FF0000">4</font><font color="#800080">; our </font><font color="#008080">$opSalvarAlteracao </font><font color="#800080">= </font><font color="#FF0000">4</font><font color="#800080">; our </font><font color="#008080">$opExcluir </font><font color="#800080">= </font><font color="#FF0000">5</font><font color="#800080">; 
our </font><font color="#008080">$opConfirmaExclusao </font><font color="#800080">= </font><font color="#FF0000">6</font><font color="#800080">; our </font><font color="#008080">$opListarTodos </font><font color="#800080">= </font><font color="#FF0000">7</font><font color="#800080">;

</font><font color="#808080"><i># constantes
</i></font><font color="#800080">our </font><font color="#008080">$false </font><font color="#800080">= </font><font color="#FF0000">0</font><font color="#800080">;
our </font><font color="#008080">$true </font><font color="#800080">= </font><font color="#FF0000">1</font><font color="#800080">;

our </font><font color="#008080">$CRLF </font><font color="#800080">= </font><font color="#800000">&quot;\n&quot;</font><font color="#800080">; </font><font color="#808080"><i># windows 
</i></font><font color="#800080">our </font><font color="#008080">$TAM_CRLF </font><font color="#800080">= </font><font color="#FF0000">2</font><font color="#800080">;
</font><font color="#808080"><i># our $CRLF = &quot;\n&quot;;
# our $TAM_CRLF = 1; # unix
# our $CRLF = &quot;\r&quot;;
# our $TAM_CRLF = 1; # macintosh 

</i></font><font color="#800080">our </font><font color="#008080">$SEEK_SET </font><font color="#800080">= </font><font color="#FF0000">0</font><font color="#800080">;
</font><font color="#808080"><i># our $SEEK_CUR = 1;
</i></font><font color="#800080">our </font><font color="#008080">$SEEK_END </font><font color="#800080">= </font><font color="#FF0000">2</font><font color="#800080">;

our </font><font color="#008080">$ARQ_ABRE </font><font color="#800080">= </font><font color="#800000">&quot;+&lt;&quot;</font><font color="#800080">;
our </font><font color="#008080">$ARQ_CRIA </font><font color="#800080">= </font><font color="#800000">&quot;+&gt;&quot;</font><font color="#800080">;

our </font><font color="#008080">$QTD_MAX_LINHA </font><font color="#800080">= </font><font color="#FF0000">18</font><font color="#800080">;
our </font><font color="#008080">$TAM_MAX_STR </font><font color="#800080">= </font><font color="#FF0000">255</font><font color="#800080">;

our </font><font color="#008080">$MSG_ARQERRO </font><font color="#800080">= </font><font color="#800000">&quot;Erro: O arquivo n&atilde;o pode ser aberto.&quot;</font><font color="#800080">;
our </font><font color="#008080">$MSG_ERRO </font><font color="#800080">= </font><font color="#800000">&quot;Erro: op&ccedil;&atilde;o inv&aacute;lida digite de novo.\n&quot;</font><font color="#800080">;
our </font><font color="#008080">$MSG_OPCAO </font><font color="#800080">= </font><font color="#800000">&quot;Escolha uma op&ccedil;&atilde;o: &quot;</font><font color="#800080">;
our </font><font color="#008080">$MSG_PRESS </font><font color="#800080">= </font><font color="#800000">&quot;pressione para continuar...&quot;</font><font color="#800080">;

our </font><font color="#008080">$MSG_REGINC </font><font color="#800080">= </font><font color="#800000">&quot;registro incluido!\n&quot;</font><font color="#800080">;
our </font><font color="#008080">$MSG_REGNINC </font><font color="#800080">= </font><font color="#800000">&quot;registro n&atilde;o incluido!\n&quot;</font><font color="#800080">;
our </font><font color="#008080">$MSG_REGALT </font><font color="#800080">= </font><font color="#800000">&quot;registro alterado!\n&quot;</font><font color="#800080">;
our </font><font color="#008080">$MSG_REGNALT </font><font color="#800080">= </font><font color="#800000">&quot;registro n&atilde;o alterado!\n&quot;</font><font color="#800080">;
our </font><font color="#008080">$MSG_REGEXC </font><font color="#800080">= </font><font color="#800000">&quot;registro excluido!\n&quot;</font><font color="#800080">;
our </font><font color="#008080">$MSG_REGNEXC </font><font color="#800080">= </font><font color="#800000">&quot;registro n&atilde;o excluido!\n&quot;</font><font color="#800080">;
our </font><font color="#008080">$MSG_REGEXST </font><font color="#800080">= </font><font color="#800000">&quot;registro j&aacute; existe!\n&quot;</font><font color="#800080">;

our </font><font color="#008080">$MSG_NUMINV </font><font color="#800080">= </font><font color="#800000">&quot;N&uacute;mero inv&aacute;lido ou menor do que 1!\n&quot;</font><font color="#800080">;
our </font><font color="#008080">$MSG_DATAINV </font><font color="#800080">= </font><font color="#800000">&quot;Data inv&aacute;lida!, formato correto (dd/mm/yyyy)\n&quot;</font><font color="#800080">;
our </font><font color="#008080">$MSG_DTHRINV </font><font color="#800080">= </font><font color="#800000">&quot;Data/hora inv&aacute;lida!, formato correto (dd/mm/yyyy hh:mm:ss)\n&quot;</font><font color="#800080">;
our </font><font color="#008080">$MSG_ISBNINV </font><font color="#800080">= </font><font color="#800000">&quot;ISBN inv&aacute;lido!\n&quot;</font><font color="#800080">;
our </font><font color="#008080">$MSG_CPFINV </font><font color="#800080">= </font><font color="#800000">&quot;CPF inv&aacute;lido!\n&quot;</font><font color="#800080">;
our </font><font color="#008080">$MSG_SENCONFERE </font><font color="#800080">= </font><font color="#800000">&quot;senha n&atilde;o confere com a senha atual!\n&quot;</font><font color="#800080">;
our </font><font color="#008080">$MSG_SENCONFIRM </font><font color="#800080">= </font><font color="#800000">&quot;nova senha n&atilde;o confere com a senha confirmada!\n&quot;</font><font color="#800080">;
our </font><font color="#008080">$MSG_LOGINENCON </font><font color="#800080">= </font><font color="#800000">&quot;login n&atilde;o encontrado!\n&quot;</font><font color="#800080">;
our </font><font color="#008080">$MSG_SEMESTOQUE </font><font color="#800080">= </font><font color="#800000">&quot;livro n&atilde;o existe no estoque!\n&quot;</font><font color="#800080">;

our </font><font color="#008080">$ARQ_ASSUNTO </font><font color="#800080">= </font><font color="#800000">&quot;assunto.dat&quot;</font><font color="#800080">;
our </font><font color="#008080">$ARQ_AUTOR </font><font color="#800080">= </font><font color="#800000">&quot;autor.dat&quot;</font><font color="#800080">;
our </font><font color="#008080">$ARQ_EDITORA </font><font color="#800080">= </font><font color="#800000">&quot;editora.dat&quot;</font><font color="#800080">;
our </font><font color="#008080">$ARQ_IDIOMA </font><font color="#800080">= </font><font color="#800000">&quot;idioma.dat&quot;</font><font color="#800080">;
our </font><font color="#008080">$ARQ_USUARIO </font><font color="#800080">= </font><font color="#800000">&quot;usuario.dat&quot;</font><font color="#800080">;
our </font><font color="#008080">$ARQ_PAIS </font><font color="#800080">= </font><font color="#800000">&quot;pais.dat&quot;</font><font color="#800080">;
our </font><font color="#008080">$ARQ_PROFISSAO </font><font color="#800080">= </font><font color="#800000">&quot;profissao.dat&quot;</font><font color="#800080">;
our </font><font color="#008080">$ARQ_LIVRO </font><font color="#800080">= </font><font color="#800000">&quot;livro.dat&quot;</font><font color="#800080">;
our </font><font color="#008080">$ARQ_LIVASS </font><font color="#800080">= </font><font color="#800000">&quot;livroass.dat&quot;</font><font color="#800080">;
our </font><font color="#008080">$ARQ_LIVAUT </font><font color="#800080">= </font><font color="#800000">&quot;livroaut.dat&quot;</font><font color="#800080">;
our </font><font color="#008080">$ARQ_CLIENTE </font><font color="#800080">= </font><font color="#800000">&quot;cliente.dat&quot;</font><font color="#800080">;
our </font><font color="#008080">$ARQ_ENDERECO </font><font color="#800080">= </font><font color="#800000">&quot;endereco.dat&quot;</font><font color="#800080">;
our </font><font color="#008080">$ARQ_VENDA </font><font color="#800080">= </font><font color="#800000">&quot;venda.dat&quot;</font><font color="#800080">;

our </font><font color="#008080">$TAM_ASSUNTO </font><font color="#800080">= </font><font color="#FF0000">40</font><font color="#800080">;
our </font><font color="#008080">$TAM_AUTOR </font><font color="#800080">= </font><font color="#FF0000">40</font><font color="#800080">;
our </font><font color="#008080">$TAM_EDITORA </font><font color="#800080">= </font><font color="#FF0000">60</font><font color="#800080">;
our </font><font color="#008080">$TAM_IDIOMA </font><font color="#800080">= </font><font color="#FF0000">30</font><font color="#800080">;
our </font><font color="#008080">$TAM_USUARIO </font><font color="#800080">= </font><font color="#FF0000">20</font><font color="#800080">;
our </font><font color="#008080">$TAM_PAIS </font><font color="#800080">= </font><font color="#FF0000">53</font><font color="#800080">;
our </font><font color="#008080">$TAM_PROFISSAO </font><font color="#800080">= </font><font color="#FF0000">60</font><font color="#800080">;
our </font><font color="#008080">$TAM_LIVRO </font><font color="#800080">= </font><font color="#FF0000">143</font><font color="#800080">;
our </font><font color="#008080">$TAM_LIVASS </font><font color="#800080">= </font><font color="#FF0000">23</font><font color="#800080">;
our </font><font color="#008080">$TAM_LIVAUT </font><font color="#800080">= </font><font color="#FF0000">23</font><font color="#800080">;
our </font><font color="#008080">$TAM_CLIENTE </font><font color="#800080">= </font><font color="#FF0000">135</font><font color="#800080">;
our </font><font color="#008080">$TAM_ENDERECO </font><font color="#800080">= </font><font color="#FF0000">123</font><font color="#800080">;
our </font><font color="#008080">$TAM_VENDA </font><font color="#800080">= </font><font color="#FF0000">56</font><font color="#800080">;

</font><font color="#808080"><i># variaveis gerais

</i></font><font color="#800080">our </font><font color="#008080">$bopcao </font><font color="#800080">= </font><font color="#008080">$false</font><font color="#800080">;
our </font><font color="#008080">$opmenu </font><font color="#800080">= </font><font color="#800000">&quot;&quot;</font><font color="#800080">;
our </font><font color="#008080">$g_nPosChave </font><font color="#800080">= </font><font color="#FF0000">0</font><font color="#800080">;
our </font><font color="#008080">$g_nTamChave </font><font color="#800080">= </font><font color="#FF0000">0</font><font color="#800080">;
our </font><font color="#008080">$g_nPreco </font><font color="#800080">= </font><font color="#FF0000">0.0</font><font color="#800080">;
our </font><font color="#008080">$g_SalvarInclusao </font><font color="#800080">= </font><font color="#008080">$false</font><font color="#800080">;

</font><font color="#808080"><i># our $tfAssunto = 1; our $tfAutor = 2; our $tfEditora = 3; our $tfIdioma = 4; 
# our $tfEndereco = 5; our $tfPais = 6; our $tfProfissao = 7; our $tfLivro = 8; 
# our $tfLivroAss = 9; our $tfLivroAut = 10; our $tfCliente = 11; 
# our $tfUsuario = 12; our $tfVenda = 13;


#--- Rotinas b&aacute;sicas --------------------------------------------------------

#------------------------------------------------------------------------------
# Faz uma compara&ccedil;&atilde;o exata de duas strings.
# sTexto1 - a primeira string
# sTexto2 - a segunda string
# retorna - se uma string &eacute; igual ou n&atilde;o a outra.
#------------------------------------------------------------------------------
</i></font><font color="#0000FF">sub </font><font color="#800080">strcmp {
  </font><font color="#0000FF">my </font><font color="#008080">$sTexto1 </font><font color="#800080">= </font><font color="#FF00FF">$_</font><font color="#800080">[</font><font color="#FF0000">0</font><font color="#800080">];
  </font><font color="#0000FF">my </font><font color="#008080">$sTexto2 </font><font color="#800080">= </font><font color="#FF00FF">$_</font><font color="#800080">[</font><font color="#FF0000">1</font><font color="#800080">];

   </font><font color="#0000FF">if </font><font color="#800080">((</font><font color="#000080">index</font><font color="#800080">(</font><font color="#008080">$sTexto1</font><font color="#800080">, </font><font color="#008080">$sTexto2</font><font color="#800080">) == </font><font color="#FF0000">0</font><font color="#800080">) &amp;&amp; 
       (</font><font color="#000080">length</font><font color="#800080">(</font><font color="#008080">$sTexto1</font><font color="#800080">) == </font><font color="#000080">length</font><font color="#800080">(</font><font color="#008080">$sTexto2</font><font color="#800080">))) {
      </font><font color="#0000FF">return </font><font color="#008080">$true</font><font color="#800080">;
   } </font><font color="#0000FF">else </font><font color="#800080">{
      </font><font color="#0000FF">return </font><font color="#008080">$false</font><font color="#800080">;
   }
}  
</font><font color="#808080"><i>#------------------------------------------------------------------------------
# Fun&ccedil;&atilde;o que retorna uma string digitada do teclado
# retorna - a string digitada
#------------------------------------------------------------------------------
</i></font><font color="#0000FF">sub </font><font color="#800080">digita {
  </font><font color="#0000FF">my </font><font color="#008080">$sret</font><font color="#800080">;
  </font><font color="#000080">chomp</font><font color="#800080">( </font><font color="#008080">$sret </font><font color="#800080">= &lt;</font><font color="#FF00FF">STDIN</font><font color="#800080">&gt; );
  </font><font color="#0000FF">return </font><font color="#008080">$sret</font><font color="#800080">;
}
</font><font color="#808080"><i>#------------------------------------------------------------------------------
# Fun&ccedil;&atilde;o que retorna um peda&ccedil;o de uma string.
# str - indica a string
# ini - indica a posicao inicial do pedaco
# tam - indica o tamanho do pedaco
# retorna - o peda&ccedil;o da string
#------------------------------------------------------------------------------
</i></font><font color="#0000FF">sub </font><font color="#800080">copy {
</font><font color="#0000FF">my </font><font color="#008080">$str </font><font color="#800080">= </font><font color="#FF00FF">$_</font><font color="#800080">[</font><font color="#FF0000">0</font><font color="#800080">];
</font><font color="#0000FF">my </font><font color="#008080">$ini </font><font color="#800080">= </font><font color="#FF00FF">$_</font><font color="#800080">[</font><font color="#FF0000">1</font><font color="#800080">];
</font><font color="#0000FF">my </font><font color="#008080">$tam </font><font color="#800080">= </font><font color="#FF00FF">$_</font><font color="#800080">[</font><font color="#FF0000">2</font><font color="#800080">];
  </font><font color="#0000FF">return </font><font color="#000080">substr</font><font color="#800080">(</font><font color="#008080">$str</font><font color="#800080">,</font><font color="#008080">$ini</font><font color="#800080">-</font><font color="#FF0000">1</font><font color="#800080">,</font><font color="#008080">$tam</font><font color="#800080">);
}
</font><font color="#808080"><i>#------------------------------------------------------------------------------
# Retira os espa&ccedil;os em branco antes ou depois do texto.
# sTexto - o texto a ser retirado os espa&ccedil;os em branco
# retorna - o texto sem os espa&ccedil;os em branco
#------------------------------------------------------------------------------
</i></font><font color="#0000FF">sub </font><font color="#800080">trim {
</font><font color="#0000FF">my </font><font color="#008080">$sTexto </font><font color="#800080">= </font><font color="#000080">shift</font><font color="#800080">();  
  </font><font color="#008080">$sTexto </font><font color="#800080">=~ s/</font><font color="#008000">\s+</font><font color="#800080">//;
  </font><font color="#008080">$sTexto </font><font color="#800080">=~ s/</font><font color="#008000">\s+</font><font color="#800080">//;
  </font><font color="#0000FF">return </font><font color="#008080">$sTexto</font><font color="#800080">;
}
</font><font color="#808080"><i>#------------------------------------------------------------------------------
# Repete um texto um n&uacute;mero determinado de vezes.
# sTexto - o texto a ser repetido
# nQtd - a quantidade de vezes
# retorna - o texto repetido
#------------------------------------------------------------------------------
</i></font><font color="#0000FF">sub </font><font color="#800080">repete {
</font><font color="#0000FF">my </font><font color="#008080">$sTexto </font><font color="#800080">= </font><font color="#FF00FF">$_</font><font color="#800080">[</font><font color="#FF0000">0</font><font color="#800080">];
</font><font color="#0000FF">my </font><font color="#008080">$nQtd </font><font color="#800080">= </font><font color="#FF00FF">$_</font><font color="#800080">[</font><font color="#FF0000">1</font><font color="#800080">];

  </font><font color="#0000FF">my </font><font color="#008080">$sret</font><font color="#800080">;
  </font><font color="#0000FF">my </font><font color="#008080">$ncont</font><font color="#800080">;
  </font><font color="#0000FF">for</font><font color="#800080">(</font><font color="#008080">$ncont </font><font color="#800080">= </font><font color="#FF0000">1</font><font color="#800080">; </font><font color="#008080">$ncont </font><font color="#800080">&lt;= </font><font color="#008080">$nQtd</font><font color="#800080">; </font><font color="#008080">$ncont</font><font color="#800080">++) {
    </font><font color="#008080">$sret </font><font color="#800080">= </font><font color="#008080">$sret </font><font color="#800080">. </font><font color="#008080">$sTexto</font><font color="#800080">;
  }
  </font><font color="#0000FF">return </font><font color="#008080">$sret</font><font color="#800080">;
}
</font><font color="#808080"><i>#------------------------------------------------------------------------------
# Coloca espa&ccedil;os em branco a mais de acordo com o tamanho m&aacute;ximo do texto.
# sTexto - o texto
# nTam - tamanho m&aacute;ximo do texto
# retorna - o texto com espa&ccedil;os em branco a mais
#------------------------------------------------------------------------------
</i></font><font color="#0000FF">sub </font><font color="#800080">esp {
</font><font color="#0000FF">my </font><font color="#008080">$sTexto </font><font color="#800080">= </font><font color="#FF00FF">$_</font><font color="#800080">[</font><font color="#FF0000">0</font><font color="#800080">];
</font><font color="#0000FF">my </font><font color="#008080">$nTam </font><font color="#800080">= </font><font color="#FF00FF">$_</font><font color="#800080">[</font><font color="#FF0000">1</font><font color="#800080">]; 

</font><font color="#0000FF">return </font><font color="#008080">$sTexto</font><font color="#800080">.repete(</font><font color="#800000">&quot; &quot;</font><font color="#800080">,</font><font color="#008080">$nTam</font><font color="#800080">-</font><font color="#000080">length</font><font color="#800080">(</font><font color="#008080">$sTexto</font><font color="#800080">));
}
</font><font color="#808080"><i>#------------------------------------------------------------------------------
# Faz uma pesquisa relativa de um texto atrav&eacute;s de um valor chave.
# sTexto - o texto
# sChave - a chave a ser pesquisada
# retorna - se achou ou n&atilde;o a chave dentro do texto
#------------------------------------------------------------------------------
</i></font><font color="#0000FF">sub </font><font color="#800080">strRelativa {
  </font><font color="#0000FF">my </font><font color="#008080">$sTexto </font><font color="#800080">= </font><font color="#FF00FF">$_</font><font color="#800080">[</font><font color="#FF0000">0</font><font color="#800080">];
  </font><font color="#0000FF">my </font><font color="#008080">$sChave </font><font color="#800080">= </font><font color="#FF00FF">$_</font><font color="#800080">[</font><font color="#FF0000">1</font><font color="#800080">];

   </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#000080">index</font><font color="#800080">(</font><font color="#008080">$sTexto</font><font color="#800080">, </font><font color="#008080">$sChave</font><font color="#800080">) &gt;= </font><font color="#FF0000">0</font><font color="#800080">) {
      </font><font color="#0000FF">return </font><font color="#008080">$true</font><font color="#800080">;
   } </font><font color="#0000FF">else </font><font color="#800080">{
      </font><font color="#0000FF">return </font><font color="#008080">$false</font><font color="#800080">;
   }
}  
</font><font color="#808080"><i>#------------------------------------------------------------------------------
# Calcula o modulo11 de um valor qualquer.
# svalor - a mstring com o n&uacute;mero a ser calculado
# ndig - d&iacute;gito do valor a ser calculado
# retorna - o d&iacute;gito correto
#------------------------------------------------------------------------------
</i></font><font color="#0000FF">sub </font><font color="#800080">modulo11 {
 </font><font color="#0000FF">my </font><font color="#008080">$svalor </font><font color="#800080">= </font><font color="#FF00FF">$_</font><font color="#800080">[</font><font color="#FF0000">0</font><font color="#800080">];
 </font><font color="#0000FF">my </font><font color="#008080">$ndig </font><font color="#800080">= </font><font color="#FF00FF">$_</font><font color="#800080">[</font><font color="#FF0000">1</font><font color="#800080">];

</font><font color="#0000FF">my </font><font color="#008080">$ncont</font><font color="#800080">; </font><font color="#0000FF">my </font><font color="#008080">$nsoma</font><font color="#800080">; </font><font color="#0000FF">my </font><font color="#008080">$nvalor</font><font color="#800080">; </font><font color="#0000FF">my </font><font color="#008080">$npos</font><font color="#800080">;
</font><font color="#0000FF">my </font><font color="#008080">$sres</font><font color="#800080">; </font><font color="#0000FF">my </font><font color="#008080">$slocal</font><font color="#800080">;

 </font><font color="#008080">$ncont</font><font color="#800080">=</font><font color="#FF0000">1</font><font color="#800080">;
 </font><font color="#008080">$slocal</font><font color="#800080">=</font><font color="#800000">&quot;&quot;</font><font color="#800080">;
 </font><font color="#0000FF">while </font><font color="#800080">(</font><font color="#008080">$ncont </font><font color="#800080">&lt;= </font><font color="#FF0000">11</font><font color="#800080">) {
   </font><font color="#008080">$slocal</font><font color="#800080">=copy(</font><font color="#008080">$svalor</font><font color="#800080">,</font><font color="#008080">$ncont</font><font color="#800080">,</font><font color="#FF0000">1</font><font color="#800080">).</font><font color="#008080">$slocal</font><font color="#800080">;
   </font><font color="#008080">$ncont</font><font color="#800080">++;
 }
 </font><font color="#008080">$nsoma</font><font color="#800080">=</font><font color="#FF0000">0</font><font color="#800080">;
 </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$ndig </font><font color="#800080">== </font><font color="#FF0000">1</font><font color="#800080">) {
   </font><font color="#008080">$ncont</font><font color="#800080">=</font><font color="#FF0000">3</font><font color="#800080">;
 } </font><font color="#0000FF">else </font><font color="#800080">{
   </font><font color="#008080">$ncont</font><font color="#800080">=</font><font color="#FF0000">2</font><font color="#800080">;
 }
 </font><font color="#008080">$npos</font><font color="#800080">=</font><font color="#FF0000">2</font><font color="#800080">;
 </font><font color="#0000FF">while </font><font color="#800080">(</font><font color="#008080">$ncont </font><font color="#800080">&lt;= </font><font color="#FF0000">11</font><font color="#800080">) {
   </font><font color="#008080">$sres </font><font color="#800080">= copy(</font><font color="#008080">$slocal</font><font color="#800080">,</font><font color="#008080">$ncont</font><font color="#800080">,</font><font color="#FF0000">1</font><font color="#800080">);
   </font><font color="#008080">$nvalor </font><font color="#800080">= </font><font color="#008080">$sres</font><font color="#800080">;
   </font><font color="#008080">$nsoma</font><font color="#800080">=</font><font color="#008080">$nsoma </font><font color="#800080">+ (</font><font color="#008080">$nvalor </font><font color="#800080">* </font><font color="#008080">$npos</font><font color="#800080">);
   </font><font color="#008080">$ncont</font><font color="#800080">++;
   </font><font color="#008080">$npos</font><font color="#800080">++;
 }
 </font><font color="#008080">$nsoma</font><font color="#800080">=(</font><font color="#FF0000">11 </font><font color="#800080">- (</font><font color="#008080">$nsoma </font><font color="#800080">% </font><font color="#FF0000">11</font><font color="#800080">));

 </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$nsoma </font><font color="#800080">&gt; </font><font color="#FF0000">9</font><font color="#800080">) {
   </font><font color="#0000FF">return </font><font color="#FF0000">0</font><font color="#800080">;
 } </font><font color="#0000FF">else </font><font color="#800080">{
   </font><font color="#0000FF">return </font><font color="#008080">$nsoma</font><font color="#800080">;
 }
}
</font><font color="#808080"><i>#------------------------------------------------------------------------------
# Valida&ccedil;&atilde;o de um n&uacute;mero de CPF qualquer.
# cpf - a mstring com o n&uacute;mero do CPF
# retorna - se &eacute; valido ou n&atilde;o
#------------------------------------------------------------------------------
</i></font><font color="#0000FF">sub </font><font color="#800080">validaCPF {
</font><font color="#0000FF">my </font><font color="#008080">$cpf </font><font color="#800080">= </font><font color="#000080">shift</font><font color="#800080">();

</font><font color="#0000FF">my </font><font color="#008080">$scpf</font><font color="#800080">; </font><font color="#0000FF">my </font><font color="#008080">$sres</font><font color="#800080">;
</font><font color="#0000FF">my </font><font color="#008080">$nvalor1</font><font color="#800080">; </font><font color="#0000FF">my </font><font color="#008080">$nvalor2</font><font color="#800080">;

</font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#000080">length</font><font color="#800080">(</font><font color="#008080">$cpf</font><font color="#800080">)==</font><font color="#FF0000">14</font><font color="#800080">) {
  </font><font color="#008080">$scpf </font><font color="#800080">= copy(</font><font color="#008080">$cpf</font><font color="#800080">,</font><font color="#FF0000">1</font><font color="#800080">,</font><font color="#FF0000">3</font><font color="#800080">).copy(</font><font color="#008080">$cpf</font><font color="#800080">,</font><font color="#FF0000">5</font><font color="#800080">,</font><font color="#FF0000">3</font><font color="#800080">).copy(</font><font color="#008080">$cpf</font><font color="#800080">,</font><font color="#FF0000">9</font><font color="#800080">,</font><font color="#FF0000">3</font><font color="#800080">).copy(</font><font color="#008080">$cpf</font><font color="#800080">,</font><font color="#FF0000">13</font><font color="#800080">,</font><font color="#FF0000">2</font><font color="#800080">);
  </font><font color="#008080">$sres </font><font color="#800080">= copy(</font><font color="#008080">$cpf</font><font color="#800080">,</font><font color="#FF0000">13</font><font color="#800080">,</font><font color="#FF0000">1</font><font color="#800080">);
  </font><font color="#008080">$nvalor1 </font><font color="#800080">= </font><font color="#008080">$sres</font><font color="#800080">;
  </font><font color="#008080">$sres </font><font color="#800080">= copy(</font><font color="#008080">$cpf</font><font color="#800080">,</font><font color="#FF0000">14</font><font color="#800080">,</font><font color="#FF0000">1</font><font color="#800080">);
  </font><font color="#008080">$nvalor2 </font><font color="#800080">= </font><font color="#008080">$sres</font><font color="#800080">;
  </font><font color="#0000FF">if </font><font color="#800080">((modulo11(</font><font color="#008080">$scpf</font><font color="#800080">,</font><font color="#FF0000">1</font><font color="#800080">)==</font><font color="#008080">$nvalor1</font><font color="#800080">) &amp;&amp; 
      (modulo11(</font><font color="#008080">$scpf</font><font color="#800080">,</font><font color="#FF0000">2</font><font color="#800080">)==</font><font color="#008080">$nvalor2</font><font color="#800080">)) {
    </font><font color="#0000FF">return </font><font color="#008080">$true</font><font color="#800080">;
  } </font><font color="#0000FF">else </font><font color="#800080">{
    </font><font color="#0000FF">return </font><font color="#008080">$false</font><font color="#800080">;
  }
} </font><font color="#0000FF">else </font><font color="#800080">{
    </font><font color="#0000FF">return </font><font color="#008080">$false</font><font color="#800080">;
  }
}
</font><font color="#808080"><i>#------------------------------------------------------------------------------
# Valida&ccedil;&atilde;o de um n&uacute;mero ISBN qualquer.
# isbn - a mstring com o n&uacute;mero do ISBN
# retorna - se &eacute; valido ou n&atilde;o
#------------------------------------------------------------------------------
</i></font><font color="#0000FF">sub </font><font color="#800080">validaISBN {
</font><font color="#0000FF">my </font><font color="#008080">$isbn </font><font color="#800080">= </font><font color="#000080">shift</font><font color="#800080">();

</font><font color="#0000FF">my </font><font color="#008080">$sisbn</font><font color="#800080">; </font><font color="#0000FF">my </font><font color="#008080">$sdigito</font><font color="#800080">; </font><font color="#0000FF">my </font><font color="#008080">$snum</font><font color="#800080">;
</font><font color="#0000FF">my </font><font color="#008080">$nvalor</font><font color="#800080">; </font><font color="#0000FF">my </font><font color="#008080">$nsoma</font><font color="#800080">; </font><font color="#0000FF">my </font><font color="#008080">$ncont</font><font color="#800080">;

</font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#000080">length</font><font color="#800080">(</font><font color="#008080">$isbn</font><font color="#800080">)==</font><font color="#FF0000">13</font><font color="#800080">) {
  </font><font color="#008080">$sdigito </font><font color="#800080">= copy(</font><font color="#008080">$isbn</font><font color="#800080">, </font><font color="#000080">length</font><font color="#800080">(</font><font color="#008080">$isbn</font><font color="#800080">), </font><font color="#FF0000">1</font><font color="#800080">);
  </font><font color="#008080">$sisbn</font><font color="#800080">=</font><font color="#800000">&quot;&quot;</font><font color="#800080">;
  </font><font color="#0000FF">for</font><font color="#800080">(</font><font color="#008080">$ncont </font><font color="#800080">= </font><font color="#FF0000">1</font><font color="#800080">; </font><font color="#008080">$ncont </font><font color="#800080">&lt;= </font><font color="#000080">length</font><font color="#800080">(</font><font color="#008080">$isbn</font><font color="#800080">)-</font><font color="#FF0000">1</font><font color="#800080">; </font><font color="#008080">$ncont</font><font color="#800080">++)  {
    </font><font color="#0000FF">if </font><font color="#800080">(strcmp(copy(</font><font color="#008080">$isbn</font><font color="#800080">,</font><font color="#008080">$ncont</font><font color="#800080">,</font><font color="#FF0000">1</font><font color="#800080">),</font><font color="#800000">&quot;-&quot;</font><font color="#800080">)==</font><font color="#008080">$false</font><font color="#800080">) {
      </font><font color="#008080">$sisbn </font><font color="#800080">= </font><font color="#008080">$sisbn </font><font color="#800080">. copy(</font><font color="#008080">$isbn</font><font color="#800080">,</font><font color="#008080">$ncont</font><font color="#800080">,</font><font color="#FF0000">1</font><font color="#800080">);
    }
  }
  </font><font color="#0000FF">if </font><font color="#800080">(strcmp(</font><font color="#008080">$sdigito</font><font color="#800080">, </font><font color="#800000">&quot;X&quot;</font><font color="#800080">)==</font><font color="#008080">$true</font><font color="#800080">) {
    </font><font color="#008080">$nsoma </font><font color="#800080">= </font><font color="#FF0000">10</font><font color="#800080">;
  } </font><font color="#0000FF">else </font><font color="#800080">{
    </font><font color="#008080">$nvalor </font><font color="#800080">= </font><font color="#008080">$sdigito</font><font color="#800080">;
    </font><font color="#008080">$nsoma </font><font color="#800080">= </font><font color="#008080">$nvalor</font><font color="#800080">;
  }
  </font><font color="#0000FF">for</font><font color="#800080">(</font><font color="#008080">$ncont </font><font color="#800080">= </font><font color="#FF0000">1</font><font color="#800080">; </font><font color="#008080">$ncont </font><font color="#800080">&lt;= </font><font color="#FF0000">9</font><font color="#800080">; </font><font color="#008080">$ncont</font><font color="#800080">++)  {
    </font><font color="#008080">$snum </font><font color="#800080">= copy(</font><font color="#008080">$sisbn</font><font color="#800080">, </font><font color="#008080">$ncont</font><font color="#800080">, </font><font color="#FF0000">1</font><font color="#800080">);
    </font><font color="#008080">$nvalor </font><font color="#800080">= </font><font color="#008080">$snum</font><font color="#800080">;
    </font><font color="#008080">$nsoma </font><font color="#800080">= </font><font color="#008080">$nsoma </font><font color="#800080">+ (</font><font color="#008080">$nvalor </font><font color="#800080">* (</font><font color="#FF0000">11 </font><font color="#800080">- </font><font color="#008080">$ncont</font><font color="#800080">));
  }
  </font><font color="#0000FF">if </font><font color="#800080">((</font><font color="#008080">$nsoma </font><font color="#800080">% </font><font color="#FF0000">11</font><font color="#800080">) == </font><font color="#FF0000">0</font><font color="#800080">) {
    </font><font color="#0000FF">return </font><font color="#008080">$true</font><font color="#800080">;
  } </font><font color="#0000FF">else </font><font color="#800080">{
    </font><font color="#0000FF">return </font><font color="#008080">$false</font><font color="#800080">;
  }
} </font><font color="#0000FF">else </font><font color="#800080">{
  </font><font color="#0000FF">return </font><font color="#008080">$false</font><font color="#800080">;
 }
}
</font><font color="#808080"><i>#------------------------------------------------------------------------------
# Esconde a digita&ccedil;&atilde;o da senha
# retorna - a senha digitada
#------------------------------------------------------------------------------
</i></font><font color="#0000FF">sub </font><font color="#800080">digitaSenha {
</font><font color="#0000FF">my </font><font color="#008080">$sRotulo </font><font color="#800080">= </font><font color="#FF00FF">$_</font><font color="#800080">[</font><font color="#FF0000">0</font><font color="#800080">];
</font><font color="#0000FF">my </font><font color="#008080">$nTamSenha </font><font color="#800080">= </font><font color="#FF00FF">$_</font><font color="#800080">[</font><font color="#FF0000">1</font><font color="#800080">];

</font><font color="#0000FF">my </font><font color="#008080">$sSenha</font><font color="#800080">; </font><font color="#0000FF">my </font><font color="#008080">$sLetra</font><font color="#800080">; </font><font color="#0000FF">my </font><font color="#008080">$ncont</font><font color="#800080">;
 
</font><font color="#000080">print</font><font color="#800080">(</font><font color="#008080">$sRotulo</font><font color="#800080">);
</font><font color="#008080">$sSenha </font><font color="#800080">= digita();
  
</font><font color="#808080"><i># $ncont  = 0;
# $sLetra = '\0';
# while(($sLetra!~'\r') &amp;&amp; ($ncont &lt; $nTamSenha)) {
#   $sLetra = getch();
#   if ($sLetra!~'\r') {
#      $sSenha = $sSenha . $sLetra;
#   }
#   $ncont++;
# }
# print(&quot;\n&quot;);

</i></font><font color="#0000FF">return </font><font color="#008080">$sSenha</font><font color="#800080">;
}
</font><font color="#808080"><i>#------------------------------------------------------------------------------
# Valida&ccedil;&atilde;o de um n&uacute;mero qualquer.
# sRotulo - o texto antes de se digitar o n&uacute;mero
# sNumero - a mstring com o valor do n&uacute;mero
# retorna - o sNumero
#------------------------------------------------------------------------------
</i></font><font color="#0000FF">sub </font><font color="#800080">validaNumero {
</font><font color="#0000FF">my </font><font color="#008080">$sRotulo </font><font color="#800080">= </font><font color="#FF00FF">$_</font><font color="#800080">[</font><font color="#FF0000">0</font><font color="#800080">];
</font><font color="#0000FF">my </font><font color="#008080">$sNumero </font><font color="#800080">= </font><font color="#FF00FF">$_</font><font color="#800080">[</font><font color="#FF0000">1</font><font color="#800080">];

</font><font color="#0000FF">my </font><font color="#008080">$nnum</font><font color="#800080">; </font><font color="#0000FF">my </font><font color="#008080">$nStatus</font><font color="#800080">;

</font><font color="#008080">$nStatus </font><font color="#800080">= -</font><font color="#FF0000">1</font><font color="#800080">;
 </font><font color="#0000FF">while </font><font color="#800080">(</font><font color="#008080">$nStatus</font><font color="#800080">!=</font><font color="#FF0000">0</font><font color="#800080">) {
  </font><font color="#000080">print</font><font color="#800080">(</font><font color="#008080">$sRotulo</font><font color="#800080">);
  </font><font color="#008080">$sNumero </font><font color="#800080">= digita();
  </font><font color="#008080">$nnum </font><font color="#800080">= </font><font color="#008080">$sNumero</font><font color="#800080">;
  </font><font color="#0000FF">if </font><font color="#800080">( </font><font color="#008080">$nnum </font><font color="#800080">=~ /</font><font color="#008000">[0-9]</font><font color="#800080">/ ) {
    </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$nnum </font><font color="#800080">&lt; </font><font color="#FF0000">1</font><font color="#800080">) {
       </font><font color="#000080">print</font><font color="#800080">(</font><font color="#008080">$MSG_NUMINV</font><font color="#800080">);
    } </font><font color="#0000FF">else </font><font color="#800080">{
      </font><font color="#008080">$nStatus</font><font color="#800080">=</font><font color="#FF0000">0</font><font color="#800080">;
    }
  } </font><font color="#0000FF">else </font><font color="#800080">{
    </font><font color="#000080">print</font><font color="#800080">(</font><font color="#008080">$MSG_NUMINV</font><font color="#800080">);
  }
}
</font><font color="#0000FF">return </font><font color="#008080">$sNumero</font><font color="#800080">;
}
</font><font color="#808080"><i>#------------------------------------------------------------------------------
# Valida&ccedil;&atilde;o de uma data ou data/hora qualquer.
# sRotulo - o texto antes de se digitar a data/hora
# sDataHora - a mstring com o valor da data/hora
# bSoData - indica se vai validar somente uma data sem a hora
# retorna - a sDataHora
#------------------------------------------------------------------------------
</i></font><font color="#0000FF">sub </font><font color="#800080">validaDataHora {
</font><font color="#0000FF">my </font><font color="#008080">$sRotulo </font><font color="#800080">= </font><font color="#FF00FF">$_</font><font color="#800080">[</font><font color="#FF0000">0</font><font color="#800080">];
</font><font color="#0000FF">my </font><font color="#008080">$sDataHora </font><font color="#800080">= </font><font color="#FF00FF">$_</font><font color="#800080">[</font><font color="#FF0000">1</font><font color="#800080">];
</font><font color="#0000FF">my </font><font color="#008080">$bSoData </font><font color="#800080">= </font><font color="#FF00FF">$_</font><font color="#800080">[</font><font color="#FF0000">2</font><font color="#800080">];

</font><font color="#0000FF">my </font><font color="#008080">$sdia</font><font color="#800080">; </font><font color="#0000FF">my </font><font color="#008080">$smes</font><font color="#800080">; </font><font color="#0000FF">my </font><font color="#008080">$sano</font><font color="#800080">; </font><font color="#0000FF">my </font><font color="#008080">$shora</font><font color="#800080">; </font><font color="#0000FF">my </font><font color="#008080">$smin</font><font color="#800080">; </font><font color="#0000FF">my </font><font color="#008080">$sseg</font><font color="#800080">;
</font><font color="#0000FF">my </font><font color="#008080">$ndia</font><font color="#800080">; </font><font color="#0000FF">my </font><font color="#008080">$nmes</font><font color="#800080">; </font><font color="#0000FF">my </font><font color="#008080">$nano</font><font color="#800080">; </font><font color="#0000FF">my </font><font color="#008080">$nhora</font><font color="#800080">; </font><font color="#0000FF">my </font><font color="#008080">$nmin</font><font color="#800080">; </font><font color="#0000FF">my </font><font color="#008080">$nseg</font><font color="#800080">;
</font><font color="#0000FF">my </font><font color="#008080">$ntam</font><font color="#800080">;

</font><font color="#0000FF">my </font><font color="#008080">$bvalida </font><font color="#800080">= </font><font color="#008080">$false</font><font color="#800080">;
</font><font color="#0000FF">my </font><font color="#008080">$bdatavalida </font><font color="#800080">= </font><font color="#008080">$false</font><font color="#800080">;
</font><font color="#0000FF">my </font><font color="#008080">$bhoravalida </font><font color="#800080">= </font><font color="#008080">$false</font><font color="#800080">;
</font><font color="#0000FF">my </font><font color="#008080">$nudiames </font><font color="#800080">= </font><font color="#FF0000">0</font><font color="#800080">;
</font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$bSoData</font><font color="#800080">==</font><font color="#008080">$true</font><font color="#800080">) { 
  </font><font color="#008080">$ntam</font><font color="#800080">=</font><font color="#FF0000">10</font><font color="#800080">; 
} </font><font color="#0000FF">else </font><font color="#800080">{ 
  </font><font color="#008080">$ntam</font><font color="#800080">=</font><font color="#FF0000">19</font><font color="#800080">;
}
</font><font color="#0000FF">while </font><font color="#800080">(</font><font color="#008080">$bvalida</font><font color="#800080">==</font><font color="#008080">$false</font><font color="#800080">) {
  </font><font color="#000080">print</font><font color="#800080">(</font><font color="#008080">$sRotulo</font><font color="#800080">);
  </font><font color="#008080">$sDataHora </font><font color="#800080">= digita();
  </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#000080">length</font><font color="#800080">(</font><font color="#008080">$sDataHora</font><font color="#800080">)==</font><font color="#008080">$ntam</font><font color="#800080">) {
    </font><font color="#008080">$sdia </font><font color="#800080">= copy(</font><font color="#008080">$sDataHora</font><font color="#800080">,</font><font color="#FF0000">1</font><font color="#800080">,</font><font color="#FF0000">2</font><font color="#800080">);
    </font><font color="#008080">$ndia </font><font color="#800080">= </font><font color="#008080">$sdia</font><font color="#800080">;
    </font><font color="#008080">$smes </font><font color="#800080">= copy(</font><font color="#008080">$sDataHora</font><font color="#800080">,</font><font color="#FF0000">4</font><font color="#800080">,</font><font color="#FF0000">2</font><font color="#800080">);
    </font><font color="#008080">$nmes </font><font color="#800080">= </font><font color="#008080">$smes</font><font color="#800080">;
    </font><font color="#008080">$sano </font><font color="#800080">= copy(</font><font color="#008080">$sDataHora</font><font color="#800080">,</font><font color="#FF0000">7</font><font color="#800080">,</font><font color="#FF0000">4</font><font color="#800080">);
    </font><font color="#008080">$nano </font><font color="#800080">= </font><font color="#008080">$sano</font><font color="#800080">;
  
    </font><font color="#0000FF">if </font><font color="#800080">((</font><font color="#008080">$nano </font><font color="#800080">&gt;= </font><font color="#FF0000">1</font><font color="#800080">) &amp;&amp; (</font><font color="#008080">$nano </font><font color="#800080">&lt;= </font><font color="#FF0000">9999</font><font color="#800080">)) {
      </font><font color="#0000FF">if </font><font color="#800080">((</font><font color="#008080">$nmes </font><font color="#800080">&gt;= </font><font color="#FF0000">1</font><font color="#800080">) &amp;&amp; (</font><font color="#008080">$nmes </font><font color="#800080">&lt;= </font><font color="#FF0000">31</font><font color="#800080">)) {
          SWITCH: {
</font><font color="#FFFFFF">          	</font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$nmes</font><font color="#800080">==</font><font color="#FF0000">1 </font><font color="#800080">|| </font><font color="#008080">$nmes</font><font color="#800080">==</font><font color="#FF0000">3 </font><font color="#800080">|| </font><font color="#008080">$nmes</font><font color="#800080">==</font><font color="#FF0000">5 </font><font color="#800080">|| </font><font color="#008080">$nmes</font><font color="#800080">==</font><font color="#FF0000">7 </font><font color="#800080">|| 
                </font><font color="#008080">$nmes</font><font color="#800080">==</font><font color="#FF0000">8 </font><font color="#800080">|| </font><font color="#008080">$nmes</font><font color="#800080">==</font><font color="#FF0000">10 </font><font color="#800080">|| </font><font color="#008080">$nmes</font><font color="#800080">==</font><font color="#FF0000">12</font><font color="#800080">) { 
              </font><font color="#008080">$nudiames </font><font color="#800080">= </font><font color="#FF0000">31</font><font color="#800080">;
              </font><font color="#0000FF">last </font><font color="#800080">SWITCH;
            }
</font><font color="#FFFFFF">          	</font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$nmes</font><font color="#800080">==</font><font color="#FF0000">2</font><font color="#800080">) { 
               </font><font color="#808080"><i># ano bissexto 
               </i></font><font color="#0000FF">if </font><font color="#800080">((</font><font color="#008080">$nano </font><font color="#800080">% </font><font color="#FF0000">4</font><font color="#800080">)==</font><font color="#FF0000">0</font><font color="#800080">) { 
                 </font><font color="#008080">$nudiames </font><font color="#800080">= </font><font color="#FF0000">29</font><font color="#800080">;
               } </font><font color="#0000FF">else </font><font color="#800080">{
                 </font><font color="#008080">$nudiames </font><font color="#800080">= </font><font color="#FF0000">28</font><font color="#800080">;
               }
              </font><font color="#0000FF">last </font><font color="#800080">SWITCH;
            }
</font><font color="#FFFFFF">          	</font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$nmes</font><font color="#800080">==</font><font color="#FF0000">4 </font><font color="#800080">|| </font><font color="#008080">$nmes</font><font color="#800080">==</font><font color="#FF0000">6 </font><font color="#800080">|| </font><font color="#008080">$nmes</font><font color="#800080">==</font><font color="#FF0000">9 </font><font color="#800080">|| </font><font color="#008080">$nmes</font><font color="#800080">==</font><font color="#FF0000">11</font><font color="#800080">) { 
              </font><font color="#008080">$nudiames </font><font color="#800080">= </font><font color="#FF0000">30</font><font color="#800080">;
              </font><font color="#0000FF">last </font><font color="#800080">SWITCH;
            }
          }
          </font><font color="#0000FF">if </font><font color="#800080">((</font><font color="#008080">$ndia </font><font color="#800080">&gt;=</font><font color="#FF0000">1</font><font color="#800080">) &amp;&amp; (</font><font color="#008080">$ndia </font><font color="#800080">&lt;= </font><font color="#008080">$nudiames</font><font color="#800080">)) {
             </font><font color="#008080">$bdatavalida </font><font color="#800080">= </font><font color="#008080">$true</font><font color="#800080">;
          }
      }
    }
  
    </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$bSoData</font><font color="#800080">==</font><font color="#008080">$true</font><font color="#800080">) {
       </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$bdatavalida</font><font color="#800080">==</font><font color="#008080">$true</font><font color="#800080">) {
           </font><font color="#008080">$bvalida </font><font color="#800080">= </font><font color="#008080">$true</font><font color="#800080">;
       } </font><font color="#0000FF">else </font><font color="#800080">{
</font><font color="#FFFFFF">  		   </font><font color="#000080">print</font><font color="#800080">(</font><font color="#008080">$MSG_DATAINV</font><font color="#800080">);
       }
    } </font><font color="#0000FF">else </font><font color="#800080">{
      </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$bdatavalida</font><font color="#800080">==</font><font color="#008080">$true</font><font color="#800080">) {
          </font><font color="#008080">$shora </font><font color="#800080">= copy(</font><font color="#008080">$sDataHora</font><font color="#800080">,</font><font color="#FF0000">12</font><font color="#800080">,</font><font color="#FF0000">2</font><font color="#800080">);
          </font><font color="#008080">$nhora </font><font color="#800080">= </font><font color="#008080">$shora</font><font color="#800080">;
          </font><font color="#008080">$smin </font><font color="#800080">= copy(</font><font color="#008080">$sDataHora</font><font color="#800080">,</font><font color="#FF0000">15</font><font color="#800080">,</font><font color="#FF0000">2</font><font color="#800080">);
          </font><font color="#008080">$nmin </font><font color="#800080">= </font><font color="#008080">$smin</font><font color="#800080">;
          </font><font color="#008080">$sseg </font><font color="#800080">= copy(</font><font color="#008080">$sDataHora</font><font color="#800080">,</font><font color="#FF0000">18</font><font color="#800080">,</font><font color="#FF0000">2</font><font color="#800080">);
          </font><font color="#008080">$nseg </font><font color="#800080">= </font><font color="#008080">$sseg</font><font color="#800080">;
  
          </font><font color="#0000FF">if </font><font color="#800080">((</font><font color="#008080">$nhora </font><font color="#800080">&gt;= </font><font color="#FF0000">0</font><font color="#800080">) &amp;&amp; (</font><font color="#008080">$nhora </font><font color="#800080">&lt;= </font><font color="#FF0000">23</font><font color="#800080">)) {
            </font><font color="#0000FF">if </font><font color="#800080">((</font><font color="#008080">$nmin </font><font color="#800080">&gt;= </font><font color="#FF0000">0</font><font color="#800080">) &amp;&amp; (</font><font color="#008080">$nmin </font><font color="#800080">&lt;= </font><font color="#FF0000">59</font><font color="#800080">)) {
              </font><font color="#0000FF">if </font><font color="#800080">((</font><font color="#008080">$nseg </font><font color="#800080">&gt;= </font><font color="#FF0000">0</font><font color="#800080">) &amp;&amp; (</font><font color="#008080">$nseg </font><font color="#800080">&lt;= </font><font color="#FF0000">59</font><font color="#800080">)) {
                 </font><font color="#008080">$bhoravalida </font><font color="#800080">= </font><font color="#008080">$true</font><font color="#800080">;
              } 
            }
          }
  
          </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$bhoravalida</font><font color="#800080">==</font><font color="#008080">$true</font><font color="#800080">) {
</font><font color="#FFFFFF">  		      </font><font color="#008080">$bvalida </font><font color="#800080">= </font><font color="#008080">$true</font><font color="#800080">;
          } </font><font color="#0000FF">else </font><font color="#800080">{
</font><font color="#FFFFFF">  		      </font><font color="#000080">print</font><font color="#800080">(</font><font color="#008080">$MSG_DTHRINV</font><font color="#800080">);
          }
      } </font><font color="#0000FF">else </font><font color="#800080">{
        </font><font color="#000080">print</font><font color="#800080">(</font><font color="#008080">$MSG_DTHRINV</font><font color="#800080">);
      }
    }
  } </font><font color="#0000FF">else </font><font color="#800080">{
    </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$bSoData</font><font color="#800080">==</font><font color="#008080">$true</font><font color="#800080">) { 
      </font><font color="#000080">print</font><font color="#800080">(</font><font color="#008080">$MSG_DATAINV</font><font color="#800080">);
    } </font><font color="#0000FF">else </font><font color="#800080">{
      </font><font color="#000080">print</font><font color="#800080">(</font><font color="#008080">$MSG_DTHRINV</font><font color="#800080">);
    } 
  }
}
</font><font color="#0000FF">return </font><font color="#008080">$sDataHora</font><font color="#800080">;
}
</font><font color="#808080"><i>#------------------------------------------------------------------------------
# Retorna a Data e a hora do sistema.
# retorna - a data e a hora
#------------------------------------------------------------------------------
</i></font><font color="#0000FF">sub </font><font color="#800080">retDataHora {
</font><font color="#0000FF">my </font><font color="#008080">$sdatahora</font><font color="#800080">;

</font><font color="#0000FF">my </font><font color="#008080">@stempo</font><font color="#800080">=</font><font color="#000080">localtime</font><font color="#800080">(</font><font color="#000080">time</font><font color="#800080">);
</font><font color="#0000FF">my </font><font color="#008080">$seg </font><font color="#800080">= </font><font color="#008080">$stempo</font><font color="#800080">[</font><font color="#FF0000">0</font><font color="#800080">];
</font><font color="#0000FF">my </font><font color="#008080">$min </font><font color="#800080">= </font><font color="#008080">$stempo</font><font color="#800080">[</font><font color="#FF0000">1</font><font color="#800080">];
</font><font color="#0000FF">my </font><font color="#008080">$hora </font><font color="#800080">= </font><font color="#008080">$stempo</font><font color="#800080">[</font><font color="#FF0000">2</font><font color="#800080">];
</font><font color="#0000FF">my </font><font color="#008080">$dia </font><font color="#800080">= </font><font color="#008080">$stempo</font><font color="#800080">[</font><font color="#FF0000">3</font><font color="#800080">];
</font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$dia </font><font color="#800080">&lt; </font><font color="#FF0000">10</font><font color="#800080">) { </font><font color="#008080">$dia </font><font color="#800080">= </font><font color="#800000">'0'</font><font color="#800080">.</font><font color="#008080">$dia</font><font color="#800080">; }
</font><font color="#0000FF">my </font><font color="#008080">$mes </font><font color="#800080">= </font><font color="#008080">$stempo</font><font color="#800080">[</font><font color="#FF0000">4</font><font color="#800080">];
</font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$mes </font><font color="#800080">&lt; </font><font color="#FF0000">10</font><font color="#800080">) { </font><font color="#008080">$mes </font><font color="#800080">= </font><font color="#800000">'0'</font><font color="#800080">.</font><font color="#008080">$mes</font><font color="#800080">; }
</font><font color="#0000FF">my </font><font color="#008080">$ano </font><font color="#800080">= </font><font color="#008080">$stempo</font><font color="#800080">[</font><font color="#FF0000">5</font><font color="#800080">];
</font><font color="#008080">$ano </font><font color="#800080">+= </font><font color="#FF0000">1900</font><font color="#800080">; 
</font><font color="#008080">$sdatahora </font><font color="#800080">= </font><font color="#008080">$dia</font><font color="#800080">.</font><font color="#800000">&quot;/&quot;</font><font color="#800080">.</font><font color="#008080">$mes</font><font color="#800080">.</font><font color="#800000">&quot;/&quot;</font><font color="#800080">.</font><font color="#008080">$ano</font><font color="#800080">.</font><font color="#800000">&quot; &quot;</font><font color="#800080">.</font><font color="#008080">$hora</font><font color="#800080">.</font><font color="#800000">&quot;:&quot;</font><font color="#800080">.</font><font color="#008080">$min</font><font color="#800080">.</font><font color="#800000">&quot;:&quot;</font><font color="#800080">.</font><font color="#008080">$seg</font><font color="#800080">;
</font><font color="#0000FF">return </font><font color="#008080">$sdatahora</font><font color="#800080">;
}
</font><font color="#808080"><i>#--- Rotinas de manipula&ccedil;&atilde;o de arquivos -------------------------------------

#------------------------------------------------------------------------------
# Calcula o tamanho do arquivo.
# sArq - o arquivo
# retorna - o tamanho do arquivo
#------------------------------------------------------------------------------
</i></font><font color="#0000FF">sub </font><font color="#800080">tamArq {
</font><font color="#0000FF">my </font><font color="#008080">$sArq </font><font color="#800080">= </font><font color="#000080">shift</font><font color="#800080">();
</font><font color="#0000FF">my </font><font color="#008080">$ntam</font><font color="#800080">;

</font><font color="#000080">seek</font><font color="#800080">(</font><font color="#008080">$sArq</font><font color="#800080">, </font><font color="#FF0000">0</font><font color="#800080">, </font><font color="#008080">$SEEK_END</font><font color="#800080">);
</font><font color="#008080">$ntam </font><font color="#800080">= </font><font color="#000080">tell</font><font color="#800080">(</font><font color="#008080">$sArq</font><font color="#800080">);
</font><font color="#000080">seek</font><font color="#800080">(</font><font color="#008080">$sArq</font><font color="#800080">, </font><font color="#FF0000">0</font><font color="#800080">, </font><font color="#008080">$SEEK_SET</font><font color="#800080">);
</font><font color="#0000FF">return </font><font color="#008080">$ntam</font><font color="#800080">;
}
</font><font color="#808080"><i>#------------------------------------------------------------------------------
# Abre ou cria os arquivos do sistema.
# bAbre - condi&ccedil;&atilde;o para abrir ou criar os arquivos do sistema
#------------------------------------------------------------------------------
</i></font><font color="#0000FF">sub </font><font color="#800080">abrecriaArqs {
</font><font color="#0000FF">my </font><font color="#008080">$bAbre </font><font color="#800080">= </font><font color="#000080">shift</font><font color="#800080">();

</font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$bAbre</font><font color="#800080">) {
  </font><font color="#000080">open </font><font color="#800080">tfAssunto, </font><font color="#008080">$ARQ_ABRE</font><font color="#800080">, </font><font color="#008080">$ARQ_ASSUNTO
    </font><font color="#800080">or </font><font color="#0000FF">die </font><font color="#008080">$MSG_ARQERRO</font><font color="#800080">.</font><font color="#800000">&quot; --&gt; &quot;</font><font color="#800080">.</font><font color="#008080">$ARQ_ASSUNTO</font><font color="#800080">.</font><font color="#800000">&quot;\n&quot;</font><font color="#800080">;
  </font><font color="#000080">open </font><font color="#800080">tfAutor, </font><font color="#008080">$ARQ_ABRE</font><font color="#800080">, </font><font color="#008080">$ARQ_AUTOR
    </font><font color="#800080">or </font><font color="#0000FF">die </font><font color="#008080">$MSG_ARQERRO</font><font color="#800080">.</font><font color="#800000">&quot; --&gt; &quot;</font><font color="#800080">.</font><font color="#008080">$ARQ_AUTOR</font><font color="#800080">.</font><font color="#800000">&quot;\n&quot;</font><font color="#800080">;
  </font><font color="#000080">open </font><font color="#800080">tfEditora, </font><font color="#008080">$ARQ_ABRE</font><font color="#800080">, </font><font color="#008080">$ARQ_EDITORA
    </font><font color="#800080">or </font><font color="#0000FF">die </font><font color="#008080">$MSG_ARQERRO</font><font color="#800080">.</font><font color="#800000">&quot; --&gt; &quot;</font><font color="#800080">.</font><font color="#008080">$ARQ_EDITORA</font><font color="#800080">.</font><font color="#800000">&quot;\n&quot;</font><font color="#800080">;
  </font><font color="#000080">open </font><font color="#800080">tfIdioma, </font><font color="#008080">$ARQ_ABRE</font><font color="#800080">, </font><font color="#008080">$ARQ_IDIOMA
    </font><font color="#800080">or </font><font color="#0000FF">die </font><font color="#008080">$MSG_ARQERRO</font><font color="#800080">.</font><font color="#800000">&quot; --&gt; &quot;</font><font color="#800080">.</font><font color="#008080">$ARQ_IDIOMA</font><font color="#800080">.</font><font color="#800000">&quot;\n&quot;</font><font color="#800080">;
  </font><font color="#000080">open </font><font color="#800080">tfEndereco, </font><font color="#008080">$ARQ_ABRE</font><font color="#800080">, </font><font color="#008080">$ARQ_ENDERECO
    </font><font color="#800080">or </font><font color="#0000FF">die </font><font color="#008080">$MSG_ARQERRO</font><font color="#800080">.</font><font color="#800000">&quot; --&gt; &quot;</font><font color="#800080">.</font><font color="#008080">$ARQ_ENDERECO</font><font color="#800080">.</font><font color="#800000">&quot;\n&quot;</font><font color="#800080">;
  </font><font color="#000080">open </font><font color="#800080">tfPais, </font><font color="#008080">$ARQ_ABRE</font><font color="#800080">, </font><font color="#008080">$ARQ_PAIS
    </font><font color="#800080">or </font><font color="#0000FF">die </font><font color="#008080">$MSG_ARQERRO</font><font color="#800080">.</font><font color="#800000">&quot; --&gt; &quot;</font><font color="#800080">.</font><font color="#008080">$ARQ_PAIS</font><font color="#800080">.</font><font color="#800000">&quot;\n&quot;</font><font color="#800080">;
  </font><font color="#000080">open </font><font color="#800080">tfProfissao, </font><font color="#008080">$ARQ_ABRE</font><font color="#800080">, </font><font color="#008080">$ARQ_PROFISSAO
    </font><font color="#800080">or </font><font color="#0000FF">die </font><font color="#008080">$MSG_ARQERRO</font><font color="#800080">.</font><font color="#800000">&quot; --&gt; &quot;</font><font color="#800080">.</font><font color="#008080">$ARQ_PROFISSAO</font><font color="#800080">.</font><font color="#800000">&quot;\n&quot;</font><font color="#800080">;
  </font><font color="#000080">open </font><font color="#800080">tfLivro, </font><font color="#008080">$ARQ_ABRE</font><font color="#800080">, </font><font color="#008080">$ARQ_LIVRO
    </font><font color="#800080">or </font><font color="#0000FF">die </font><font color="#008080">$MSG_ARQERRO</font><font color="#800080">.</font><font color="#800000">&quot; --&gt; &quot;</font><font color="#800080">.</font><font color="#008080">$ARQ_LIVRO</font><font color="#800080">.</font><font color="#800000">&quot;\n&quot;</font><font color="#800080">;
  </font><font color="#000080">open </font><font color="#800080">tfLivroAss, </font><font color="#008080">$ARQ_ABRE</font><font color="#800080">, </font><font color="#008080">$ARQ_LIVASS
    </font><font color="#800080">or </font><font color="#0000FF">die </font><font color="#008080">$MSG_ARQERRO</font><font color="#800080">.</font><font color="#800000">&quot; --&gt; &quot;</font><font color="#800080">.</font><font color="#008080">$ARQ_LIVASS</font><font color="#800080">.</font><font color="#800000">&quot;\n&quot;</font><font color="#800080">;
  </font><font color="#000080">open </font><font color="#800080">tfLivroAut, </font><font color="#008080">$ARQ_ABRE</font><font color="#800080">, </font><font color="#008080">$ARQ_LIVAUT
    </font><font color="#800080">or </font><font color="#0000FF">die </font><font color="#008080">$MSG_ARQERRO</font><font color="#800080">.</font><font color="#800000">&quot; --&gt; &quot;</font><font color="#800080">.</font><font color="#008080">$ARQ_LIVAUT</font><font color="#800080">.</font><font color="#800000">&quot;\n&quot;</font><font color="#800080">;
  </font><font color="#000080">open </font><font color="#800080">tfCliente, </font><font color="#008080">$ARQ_ABRE</font><font color="#800080">, </font><font color="#008080">$ARQ_CLIENTE
    </font><font color="#800080">or </font><font color="#0000FF">die </font><font color="#008080">$MSG_ARQERRO</font><font color="#800080">.</font><font color="#800000">&quot; --&gt; &quot;</font><font color="#800080">.</font><font color="#008080">$ARQ_CLIENTE</font><font color="#800080">.</font><font color="#800000">&quot;\n&quot;</font><font color="#800080">;
  </font><font color="#000080">open </font><font color="#800080">tfUsuario, </font><font color="#008080">$ARQ_ABRE</font><font color="#800080">, </font><font color="#008080">$ARQ_USUARIO
    </font><font color="#800080">or </font><font color="#0000FF">die </font><font color="#008080">$MSG_ARQERRO</font><font color="#800080">.</font><font color="#800000">&quot; --&gt; &quot;</font><font color="#800080">.</font><font color="#008080">$ARQ_USUARIO</font><font color="#800080">.</font><font color="#800000">&quot;\n&quot;</font><font color="#800080">;
  </font><font color="#000080">open </font><font color="#800080">tfVenda, </font><font color="#008080">$ARQ_ABRE</font><font color="#800080">, </font><font color="#008080">$ARQ_VENDA
    </font><font color="#800080">or </font><font color="#0000FF">die </font><font color="#008080">$MSG_ARQERRO</font><font color="#800080">.</font><font color="#800000">&quot; --&gt; &quot;</font><font color="#800080">.</font><font color="#008080">$ARQ_VENDA</font><font color="#800080">.</font><font color="#800000">&quot;\n&quot;</font><font color="#800080">;
} </font><font color="#0000FF">else </font><font color="#800080">{
  </font><font color="#000080">open </font><font color="#800080">tfAssunto, </font><font color="#008080">$ARQ_CRIA</font><font color="#800080">, </font><font color="#008080">$ARQ_ASSUNTO</font><font color="#800080">;
  </font><font color="#000080">open </font><font color="#800080">tfAutor, </font><font color="#008080">$ARQ_CRIA</font><font color="#800080">, </font><font color="#008080">$ARQ_AUTOR</font><font color="#800080">;
  </font><font color="#000080">open </font><font color="#800080">tfEditora, </font><font color="#008080">$ARQ_CRIA</font><font color="#800080">, </font><font color="#008080">$ARQ_EDITORA</font><font color="#800080">;
  </font><font color="#000080">open </font><font color="#800080">tfIdioma, </font><font color="#008080">$ARQ_CRIA</font><font color="#800080">, </font><font color="#008080">$ARQ_IDIOMA</font><font color="#800080">;
  </font><font color="#000080">open </font><font color="#800080">tfEndereco, </font><font color="#008080">$ARQ_CRIA</font><font color="#800080">, </font><font color="#008080">$ARQ_ENDERECO</font><font color="#800080">;
  </font><font color="#000080">open </font><font color="#800080">tfPais, </font><font color="#008080">$ARQ_CRIA</font><font color="#800080">, </font><font color="#008080">$ARQ_PAIS</font><font color="#800080">;
  </font><font color="#000080">open </font><font color="#800080">tfProfissao, </font><font color="#008080">$ARQ_CRIA</font><font color="#800080">, </font><font color="#008080">$ARQ_PROFISSAO</font><font color="#800080">;
  </font><font color="#000080">open </font><font color="#800080">tfLivro, </font><font color="#008080">$ARQ_CRIA</font><font color="#800080">, </font><font color="#008080">$ARQ_LIVRO</font><font color="#800080">;
  </font><font color="#000080">open </font><font color="#800080">tfLivroAss, </font><font color="#008080">$ARQ_CRIA</font><font color="#800080">, </font><font color="#008080">$ARQ_LIVASS</font><font color="#800080">;
  </font><font color="#000080">open </font><font color="#800080">tfLivroAut, </font><font color="#008080">$ARQ_CRIA</font><font color="#800080">, </font><font color="#008080">$ARQ_LIVAUT</font><font color="#800080">;
  </font><font color="#000080">open </font><font color="#800080">tfCliente, </font><font color="#008080">$ARQ_CRIA</font><font color="#800080">, </font><font color="#008080">$ARQ_CLIENTE</font><font color="#800080">;
  </font><font color="#000080">open </font><font color="#800080">tfUsuario, </font><font color="#008080">$ARQ_CRIA</font><font color="#800080">, </font><font color="#008080">$ARQ_USUARIO</font><font color="#800080">;
  </font><font color="#000080">open </font><font color="#800080">tfVenda, </font><font color="#008080">$ARQ_CRIA</font><font color="#800080">, </font><font color="#008080">$ARQ_VENDA</font><font color="#800080">;
}
}
</font><font color="#808080"><i>#------------------------------------------------------------------------------
# Fecha todos os arquivos abertos.
#------------------------------------------------------------------------------
</i></font><font color="#0000FF">sub </font><font color="#800080">fechaArqs {
 </font><font color="#000080">close </font><font color="#800080">tfAssunto;
 </font><font color="#000080">close </font><font color="#800080">tfAutor;
 </font><font color="#000080">close </font><font color="#800080">tfEditora;
 </font><font color="#000080">close </font><font color="#800080">tfIdioma;
 </font><font color="#000080">close </font><font color="#800080">tfEndereco;
 </font><font color="#000080">close </font><font color="#800080">tfPais;
 </font><font color="#000080">close </font><font color="#800080">tfProfissao;
 </font><font color="#000080">close </font><font color="#800080">tfLivro;
 </font><font color="#000080">close </font><font color="#800080">tfLivroAss;
 </font><font color="#000080">close </font><font color="#800080">tfLivroAut;
 </font><font color="#000080">close </font><font color="#800080">tfCliente;
 </font><font color="#000080">close </font><font color="#800080">tfUsuario;
 </font><font color="#000080">close </font><font color="#800080">tfVenda;
}
</font><font color="#808080"><i>#------------------------------------------------------------------------------
# Pesquisa um registro atrav&eacute;s de um valor chave num arquivo.
# sArq - o arquivo
# sChave - a chave a ser pesquisada
# nPosChave - a posicao inicial da chave dentro do registro
# nTamChave - o tamanho da chave dentro do registro
# nTamLinha - o tamanho do registro
# retorna - o registro pesquisado
#------------------------------------------------------------------------------
</i></font><font color="#0000FF">sub </font><font color="#800080">pesqArq {
</font><font color="#0000FF">my </font><font color="#008080">$sArq </font><font color="#800080">= </font><font color="#FF00FF">$_</font><font color="#800080">[</font><font color="#FF0000">0</font><font color="#800080">];
</font><font color="#0000FF">my </font><font color="#008080">$sChave </font><font color="#800080">= </font><font color="#FF00FF">$_</font><font color="#800080">[</font><font color="#FF0000">1</font><font color="#800080">];
</font><font color="#0000FF">my </font><font color="#008080">$nPosChave </font><font color="#800080">= </font><font color="#FF00FF">$_</font><font color="#800080">[</font><font color="#FF0000">2</font><font color="#800080">];
</font><font color="#0000FF">my </font><font color="#008080">$nTamChave </font><font color="#800080">= </font><font color="#FF00FF">$_</font><font color="#800080">[</font><font color="#FF0000">3</font><font color="#800080">];
</font><font color="#0000FF">my </font><font color="#008080">$nTamLinha </font><font color="#800080">= </font><font color="#FF00FF">$_</font><font color="#800080">[</font><font color="#FF0000">4</font><font color="#800080">];

</font><font color="#0000FF">my </font><font color="#008080">$slinha</font><font color="#800080">; </font><font color="#0000FF">my </font><font color="#008080">$sres</font><font color="#800080">; </font><font color="#0000FF">my </font><font color="#008080">$nPosicao</font><font color="#800080">;
</font><font color="#0000FF">my </font><font color="#008080">$bQuebra </font><font color="#800080">= </font><font color="#008080">$false</font><font color="#800080">;
</font><font color="#000080">seek</font><font color="#800080">(</font><font color="#008080">$sArq</font><font color="#800080">, </font><font color="#FF0000">0</font><font color="#800080">, </font><font color="#008080">$SEEK_SET</font><font color="#800080">);
</font><font color="#0000FF">while </font><font color="#800080">((!</font><font color="#000080">eof</font><font color="#800080">(</font><font color="#008080">$sArq</font><font color="#800080">)) &amp;&amp; (</font><font color="#008080">$bQuebra</font><font color="#800080">==</font><font color="#008080">$false</font><font color="#800080">)) {
  </font><font color="#008080">$slinha </font><font color="#800080">= &lt;</font><font color="#008080">$sArq</font><font color="#800080">&gt;;
  </font><font color="#008080">$sres </font><font color="#800080">= trim(copy(</font><font color="#008080">$slinha</font><font color="#800080">, </font><font color="#008080">$nPosChave</font><font color="#800080">, </font><font color="#008080">$nTamChave</font><font color="#800080">));
  </font><font color="#0000FF">if </font><font color="#800080">(strcmp(</font><font color="#008080">$sres</font><font color="#800080">,</font><font color="#008080">$sChave</font><font color="#800080">)==</font><font color="#008080">$true</font><font color="#800080">) {
     </font><font color="#008080">$bQuebra </font><font color="#800080">= </font><font color="#008080">$true</font><font color="#800080">;
  }
}
</font><font color="#008080">$nPosicao </font><font color="#800080">= </font><font color="#000080">tell</font><font color="#800080">(</font><font color="#008080">$sArq</font><font color="#800080">)-(</font><font color="#008080">$nTamLinha </font><font color="#800080">+ </font><font color="#008080">$TAM_CRLF</font><font color="#800080">);
</font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$nPosicao </font><font color="#800080">&gt; </font><font color="#FF0000">0</font><font color="#800080">) {
   </font><font color="#000080">seek</font><font color="#800080">(</font><font color="#008080">$sArq</font><font color="#800080">, </font><font color="#008080">$nPosicao</font><font color="#800080">, </font><font color="#008080">$SEEK_SET</font><font color="#800080">);
} </font><font color="#0000FF">else </font><font color="#800080">{
   </font><font color="#000080">seek</font><font color="#800080">(</font><font color="#008080">$sArq</font><font color="#800080">, </font><font color="#FF0000">0</font><font color="#800080">, </font><font color="#008080">$SEEK_SET</font><font color="#800080">);
}
</font><font color="#0000FF">if </font><font color="#800080">(strcmp(</font><font color="#008080">$sres</font><font color="#800080">,</font><font color="#008080">$sChave</font><font color="#800080">)==</font><font color="#008080">$false</font><font color="#800080">) {
   </font><font color="#0000FF">return </font><font color="#800000">&quot;&quot;</font><font color="#800080">;  
} </font><font color="#0000FF">else </font><font color="#800080">{
   </font><font color="#0000FF">return </font><font color="#800080">copy(</font><font color="#008080">$slinha</font><font color="#800080">,</font><font color="#FF0000">1</font><font color="#800080">,</font><font color="#008080">$nTamLinha</font><font color="#800080">);
} 
}
</font><font color="#808080"><i>#------------------------------------------------------------------------------
# Pesquisa se tem linha exclu&iacute;da sen&atilde;o vai para a &uacute;ltima linha do arquivo.
# sArq - o arquivo
# nTamLinha - o tamanho do registro
#------------------------------------------------------------------------------
</i></font><font color="#0000FF">sub </font><font color="#800080">pesqLinhaExcluida {
</font><font color="#0000FF">my </font><font color="#008080">$sArq </font><font color="#800080">= </font><font color="#FF00FF">$_</font><font color="#800080">[</font><font color="#FF0000">0</font><font color="#800080">];
</font><font color="#0000FF">my </font><font color="#008080">$nTamLinha </font><font color="#800080">= </font><font color="#FF00FF">$_</font><font color="#800080">[</font><font color="#FF0000">1</font><font color="#800080">];

</font><font color="#0000FF">my </font><font color="#008080">$sExcluido </font><font color="#800080">= pesqArq(</font><font color="#008080">$sArq</font><font color="#800080">, </font><font color="#800000">&quot;*&quot;</font><font color="#800080">, </font><font color="#FF0000">1</font><font color="#800080">, </font><font color="#FF0000">1</font><font color="#800080">, </font><font color="#008080">$nTamLinha</font><font color="#800080">);
</font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#000080">length</font><font color="#800080">(</font><font color="#008080">$sExcluido</font><font color="#800080">)==</font><font color="#FF0000">0</font><font color="#800080">) {
   </font><font color="#000080">seek</font><font color="#800080">(</font><font color="#008080">$sArq</font><font color="#800080">, tamArq(</font><font color="#008080">$sArq</font><font color="#800080">), </font><font color="#008080">$SEEK_SET</font><font color="#800080">);
}
}
</font><font color="#808080"><i>#------------------------------------------------------------------------------
# Pesquisa o maior c&oacute;digo num arquivo.
# sArq - o arquivo
# nPosChave - a posicao inicial da chave dentro do registro
# nTamChave - o tamanho da chave dentro do registro
# nTamLinha - o tamanho do registro
# retorna - o maior c&oacute;digo
#------------------------------------------------------------------------------
</i></font><font color="#0000FF">sub </font><font color="#800080">pesqMaxCod {
</font><font color="#0000FF">my </font><font color="#008080">$sArq </font><font color="#800080">= </font><font color="#FF00FF">$_</font><font color="#800080">[</font><font color="#FF0000">0</font><font color="#800080">];
</font><font color="#0000FF">my </font><font color="#008080">$nPosChave </font><font color="#800080">= </font><font color="#FF00FF">$_</font><font color="#800080">[</font><font color="#FF0000">1</font><font color="#800080">];
</font><font color="#0000FF">my </font><font color="#008080">$nTamChave </font><font color="#800080">= </font><font color="#FF00FF">$_</font><font color="#800080">[</font><font color="#FF0000">2</font><font color="#800080">];
</font><font color="#0000FF">my </font><font color="#008080">$nTamLinha </font><font color="#800080">= </font><font color="#FF00FF">$_</font><font color="#800080">[</font><font color="#FF0000">3</font><font color="#800080">];

</font><font color="#0000FF">my </font><font color="#008080">$slinha</font><font color="#800080">; </font><font color="#0000FF">my </font><font color="#008080">$sres</font><font color="#800080">; </font><font color="#0000FF">my </font><font color="#008080">$nCod</font><font color="#800080">;
</font><font color="#0000FF">my </font><font color="#008080">$bQuebra </font><font color="#800080">= </font><font color="#008080">$false</font><font color="#800080">;
</font><font color="#0000FF">my </font><font color="#008080">$nMaior </font><font color="#800080">= </font><font color="#FF0000">0</font><font color="#800080">;
</font><font color="#000080">seek</font><font color="#800080">(</font><font color="#008080">$sArq</font><font color="#800080">, </font><font color="#FF0000">0</font><font color="#800080">, </font><font color="#008080">$SEEK_SET</font><font color="#800080">);
</font><font color="#0000FF">while </font><font color="#800080">((!</font><font color="#000080">eof</font><font color="#800080">(</font><font color="#008080">$sArq</font><font color="#800080">)) &amp;&amp; (</font><font color="#008080">$bQuebra</font><font color="#800080">==</font><font color="#008080">$false</font><font color="#800080">)) {
  </font><font color="#008080">$slinha </font><font color="#800080">= &lt;</font><font color="#008080">$sArq</font><font color="#800080">&gt;;
  </font><font color="#008080">$sres </font><font color="#800080">= trim(copy(</font><font color="#008080">$slinha</font><font color="#800080">,</font><font color="#008080">$nPosChave</font><font color="#800080">,</font><font color="#008080">$nTamChave</font><font color="#800080">));
  </font><font color="#008080">$nCod </font><font color="#800080">= </font><font color="#008080">$sres</font><font color="#800080">;
  </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$nCod </font><font color="#800080">&gt; </font><font color="#008080">$nMaior</font><font color="#800080">) {
     </font><font color="#008080">$nMaior </font><font color="#800080">= </font><font color="#008080">$nCod</font><font color="#800080">;
  }
}
pesqLinhaExcluida(</font><font color="#008080">$sArq</font><font color="#800080">, </font><font color="#008080">$nTamLinha</font><font color="#800080">);
</font><font color="#008080">$sres </font><font color="#800080">= </font><font color="#008080">$nMaior</font><font color="#800080">+</font><font color="#FF0000">1</font><font color="#800080">;
</font><font color="#0000FF">return </font><font color="#008080">$sres</font><font color="#800080">;
}
</font><font color="#808080"><i>#------------------------------------------------------------------------------
# Grava os registros num determinado arquivo.
# sArq - o arquivo
# sTexto - o registro a ser gravado
# sMsgAcerto - a mensagem caso o registro foi gravado
# sMsgErro - a mensagem caso o registro n&atilde;o foi gravado
#------------------------------------------------------------------------------
</i></font><font color="#0000FF">sub </font><font color="#800080">escreveArq {
</font><font color="#0000FF">my </font><font color="#008080">$sArq </font><font color="#800080">= </font><font color="#FF00FF">$_</font><font color="#800080">[</font><font color="#FF0000">0</font><font color="#800080">];
</font><font color="#0000FF">my </font><font color="#008080">$sTexto </font><font color="#800080">= </font><font color="#FF00FF">$_</font><font color="#800080">[</font><font color="#FF0000">1</font><font color="#800080">];
</font><font color="#0000FF">my </font><font color="#008080">$sMsgAcerto </font><font color="#800080">= </font><font color="#FF00FF">$_</font><font color="#800080">[</font><font color="#FF0000">2</font><font color="#800080">];
</font><font color="#0000FF">my </font><font color="#008080">$sMsgErro </font><font color="#800080">= </font><font color="#FF00FF">$_</font><font color="#800080">[</font><font color="#FF0000">3</font><font color="#800080">];

</font><font color="#008080">$sTexto </font><font color="#800080">= </font><font color="#008080">$sTexto </font><font color="#800080">. </font><font color="#008080">$CRLF</font><font color="#800080">;
</font><font color="#000080">print </font><font color="#008080">$sArq $sTexto</font><font color="#800080">;
</font><font color="#000080">print</font><font color="#800080">(</font><font color="#008080">$sMsgAcerto</font><font color="#800080">.</font><font color="#800000">&quot;\n&quot;</font><font color="#800080">);
</font><font color="#808080"><i>#else 
#   print($sMsgErro.&quot;\n&quot;);
</i></font><font color="#800080">}

</font><font color="#808080"><i>#--- Rotinas de implementa&ccedil;&atilde;o do sistema e de interface ---------------------

#------------------------------------------------------------------------------
# Monta o tamanho do registro no arquivo de acordo com o tipo de arquivo.
# sreg - o tipo de arquivo
# retorna - o registro montado
#------------------------------------------------------------------------------
</i></font><font color="#0000FF">sub </font><font color="#800080">LinhaReg {
</font><font color="#0000FF">my </font><font color="#008080">$sreg </font><font color="#800080">= </font><font color="#000080">shift</font><font color="#800080">();
</font><font color="#0000FF">my </font><font color="#008080">$slinha</font><font color="#800080">;

</font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$sreg</font><font color="#800080">==</font><font color="#008080">$opAssunto</font><font color="#800080">) {
   </font><font color="#008080">$slinha</font><font color="#800080">=esp(</font><font color="#008080">$tAssunto</font><font color="#800080">{</font><font color="#800000">&quot;codigo&quot;</font><font color="#800080">},</font><font color="#FF0000">10</font><font color="#800080">).esp(</font><font color="#008080">$tAssunto</font><font color="#800080">{</font><font color="#800000">&quot;assunto&quot;</font><font color="#800080">},</font><font color="#FF0000">30</font><font color="#800080">);
} </font><font color="#0000FF">elsif </font><font color="#800080">(</font><font color="#008080">$sreg</font><font color="#800080">==</font><font color="#008080">$opAutor</font><font color="#800080">) {
   </font><font color="#008080">$slinha</font><font color="#800080">=esp(</font><font color="#008080">$tAutor</font><font color="#800080">{</font><font color="#800000">&quot;codigo&quot;</font><font color="#800080">},</font><font color="#FF0000">10</font><font color="#800080">).esp(</font><font color="#008080">$tAutor</font><font color="#800080">{</font><font color="#800000">&quot;autor&quot;</font><font color="#800080">},</font><font color="#FF0000">30</font><font color="#800080">);
} </font><font color="#0000FF">elsif </font><font color="#800080">(</font><font color="#008080">$sreg</font><font color="#800080">==</font><font color="#008080">$opEditora</font><font color="#800080">) {
   </font><font color="#008080">$slinha</font><font color="#800080">=esp(</font><font color="#008080">$tEditora</font><font color="#800080">{</font><font color="#800000">&quot;codigo&quot;</font><font color="#800080">},</font><font color="#FF0000">10</font><font color="#800080">).esp(</font><font color="#008080">$tEditora</font><font color="#800080">{</font><font color="#800000">&quot;editora&quot;</font><font color="#800080">},</font><font color="#FF0000">50</font><font color="#800080">);
} </font><font color="#0000FF">elsif </font><font color="#800080">(</font><font color="#008080">$sreg</font><font color="#800080">==</font><font color="#008080">$opEndereco</font><font color="#800080">) {
   </font><font color="#008080">$slinha</font><font color="#800080">=esp(</font><font color="#008080">$tEndereco</font><font color="#800080">{</font><font color="#800000">&quot;codigo&quot;</font><font color="#800080">},</font><font color="#FF0000">10</font><font color="#800080">).esp(</font><font color="#008080">$tEndereco</font><font color="#800080">{</font><font color="#800000">&quot;logradouro&quot;</font><font color="#800080">},</font><font color="#FF0000">40</font><font color="#800080">).
   esp(</font><font color="#008080">$tEndereco</font><font color="#800080">{</font><font color="#800000">&quot;bairro&quot;</font><font color="#800080">},</font><font color="#FF0000">15</font><font color="#800080">).esp(</font><font color="#008080">$tEndereco</font><font color="#800080">{</font><font color="#800000">&quot;cep&quot;</font><font color="#800080">},</font><font color="#FF0000">8</font><font color="#800080">).esp(</font><font color="#008080">$tEndereco</font><font color="#800080">{</font><font color="#800000">&quot;cidade&quot;</font><font color="#800080">},</font><font color="#FF0000">30</font><font color="#800080">).
   esp(</font><font color="#008080">$tEndereco</font><font color="#800080">{</font><font color="#800000">&quot;estado&quot;</font><font color="#800080">},</font><font color="#FF0000">20</font><font color="#800080">);
} </font><font color="#0000FF">elsif </font><font color="#800080">(</font><font color="#008080">$sreg</font><font color="#800080">==</font><font color="#008080">$opIdioma</font><font color="#800080">) {
   </font><font color="#008080">$slinha</font><font color="#800080">=esp(</font><font color="#008080">$tIdioma</font><font color="#800080">{</font><font color="#800000">&quot;codigo&quot;</font><font color="#800080">},</font><font color="#FF0000">10</font><font color="#800080">).esp(</font><font color="#008080">$tIdioma</font><font color="#800080">{</font><font color="#800000">&quot;idioma&quot;</font><font color="#800080">},</font><font color="#FF0000">20</font><font color="#800080">);
} </font><font color="#0000FF">elsif </font><font color="#800080">(</font><font color="#008080">$sreg</font><font color="#800080">==</font><font color="#008080">$opPais</font><font color="#800080">) {
   </font><font color="#008080">$slinha</font><font color="#800080">=esp(</font><font color="#008080">$tPais</font><font color="#800080">{</font><font color="#800000">&quot;codigo&quot;</font><font color="#800080">},</font><font color="#FF0000">3</font><font color="#800080">).esp(</font><font color="#008080">$tPais</font><font color="#800080">{</font><font color="#800000">&quot;pais&quot;</font><font color="#800080">},</font><font color="#FF0000">50</font><font color="#800080">);
} </font><font color="#0000FF">elsif </font><font color="#800080">(</font><font color="#008080">$sreg</font><font color="#800080">==</font><font color="#008080">$opProfissao</font><font color="#800080">) {
   </font><font color="#008080">$slinha</font><font color="#800080">=esp(</font><font color="#008080">$tProfissao</font><font color="#800080">{</font><font color="#800000">&quot;codigo&quot;</font><font color="#800080">},</font><font color="#FF0000">10</font><font color="#800080">).esp(</font><font color="#008080">$tProfissao</font><font color="#800080">{</font><font color="#800000">&quot;profissao&quot;</font><font color="#800080">},</font><font color="#FF0000">50</font><font color="#800080">);
} </font><font color="#0000FF">elsif </font><font color="#800080">(</font><font color="#008080">$sreg</font><font color="#800080">==</font><font color="#008080">$opUsuario</font><font color="#800080">) {
   </font><font color="#008080">$slinha</font><font color="#800080">=esp(</font><font color="#008080">$tUsuario</font><font color="#800080">{</font><font color="#800000">&quot;login&quot;</font><font color="#800080">},</font><font color="#FF0000">10</font><font color="#800080">).esp(</font><font color="#008080">$tUsuario</font><font color="#800080">{</font><font color="#800000">&quot;senha&quot;</font><font color="#800080">},</font><font color="#FF0000">10</font><font color="#800080">);
} </font><font color="#0000FF">elsif </font><font color="#800080">(</font><font color="#008080">$sreg</font><font color="#800080">==</font><font color="#008080">$opLivro</font><font color="#800080">) {
   </font><font color="#008080">$slinha</font><font color="#800080">=esp(</font><font color="#008080">$tLivro</font><font color="#800080">{</font><font color="#800000">&quot;isbn&quot;</font><font color="#800080">},</font><font color="#FF0000">13</font><font color="#800080">).esp(</font><font color="#008080">$tLivro</font><font color="#800080">{</font><font color="#800000">&quot;titulo&quot;</font><font color="#800080">},</font><font color="#FF0000">50</font><font color="#800080">).
   esp(</font><font color="#008080">$tLivro</font><font color="#800080">{</font><font color="#800000">&quot;edicao&quot;</font><font color="#800080">},</font><font color="#FF0000">10</font><font color="#800080">).esp(</font><font color="#008080">$tLivro</font><font color="#800080">{</font><font color="#800000">&quot;anopubli&quot;</font><font color="#800080">},</font><font color="#FF0000">10</font><font color="#800080">).esp(</font><font color="#008080">$tLivro</font><font color="#800080">{</font><font color="#800000">&quot;codeditora&quot;</font><font color="#800080">},</font><font color="#FF0000">10</font><font color="#800080">).
   esp(</font><font color="#008080">$tLivro</font><font color="#800080">{</font><font color="#800000">&quot;volume&quot;</font><font color="#800080">},</font><font color="#FF0000">10</font><font color="#800080">).esp(</font><font color="#008080">$tLivro</font><font color="#800080">{</font><font color="#800000">&quot;codidioma&quot;</font><font color="#800080">},</font><font color="#FF0000">10</font><font color="#800080">).esp(</font><font color="#008080">$tLivro</font><font color="#800080">{</font><font color="#800000">&quot;npaginas&quot;</font><font color="#800080">},</font><font color="#FF0000">10</font><font color="#800080">).
   esp(</font><font color="#008080">$tLivro</font><font color="#800080">{</font><font color="#800000">&quot;preco&quot;</font><font color="#800080">},</font><font color="#FF0000">10</font><font color="#800080">).esp(</font><font color="#008080">$tLivro</font><font color="#800080">{</font><font color="#800000">&quot;qtdestoque&quot;</font><font color="#800080">},</font><font color="#FF0000">10</font><font color="#800080">);
} </font><font color="#0000FF">elsif </font><font color="#800080">(</font><font color="#008080">$sreg</font><font color="#800080">==</font><font color="#008080">$opLivroAss</font><font color="#800080">) {
   </font><font color="#008080">$slinha</font><font color="#800080">=esp(</font><font color="#008080">$tLivroAss</font><font color="#800080">{</font><font color="#800000">&quot;isbn&quot;</font><font color="#800080">},</font><font color="#FF0000">13</font><font color="#800080">).esp(</font><font color="#008080">$tLivroAss</font><font color="#800080">{</font><font color="#800000">&quot;codassunto&quot;</font><font color="#800080">},</font><font color="#FF0000">10</font><font color="#800080">);
} </font><font color="#0000FF">elsif </font><font color="#800080">(</font><font color="#008080">$sreg</font><font color="#800080">==</font><font color="#008080">$opLivroAut</font><font color="#800080">) {
   </font><font color="#008080">$slinha </font><font color="#800080">=esp(</font><font color="#008080">$tLivroAut</font><font color="#800080">{</font><font color="#800000">&quot;isbn&quot;</font><font color="#800080">},</font><font color="#FF0000">13</font><font color="#800080">).esp(</font><font color="#008080">$tLivroAut</font><font color="#800080">{</font><font color="#800000">&quot;codautor&quot;</font><font color="#800080">},</font><font color="#FF0000">10</font><font color="#800080">);
} </font><font color="#0000FF">elsif </font><font color="#800080">(</font><font color="#008080">$sreg</font><font color="#800080">==</font><font color="#008080">$opCliente</font><font color="#800080">) {
   </font><font color="#008080">$slinha</font><font color="#800080">=esp(</font><font color="#008080">$tCliente</font><font color="#800080">{</font><font color="#800000">&quot;cpf&quot;</font><font color="#800080">},</font><font color="#FF0000">14</font><font color="#800080">).esp(</font><font color="#008080">$tCliente</font><font color="#800080">{</font><font color="#800000">&quot;nome&quot;</font><font color="#800080">},</font><font color="#FF0000">30</font><font color="#800080">).
   esp(</font><font color="#008080">$tCliente</font><font color="#800080">{</font><font color="#800000">&quot;email&quot;</font><font color="#800080">},</font><font color="#FF0000">30</font><font color="#800080">).esp(</font><font color="#008080">$tCliente</font><font color="#800080">{</font><font color="#800000">&quot;identidade&quot;</font><font color="#800080">},</font><font color="#FF0000">10</font><font color="#800080">).esp(</font><font color="#008080">$tCliente</font><font color="#800080">{</font><font color="#800000">&quot;sexo&quot;</font><font color="#800080">},</font><font color="#FF0000">1</font><font color="#800080">).
   esp(</font><font color="#008080">$tCliente</font><font color="#800080">{</font><font color="#800000">&quot;telefone&quot;</font><font color="#800080">},</font><font color="#FF0000">17</font><font color="#800080">).esp(</font><font color="#008080">$tCliente</font><font color="#800080">{</font><font color="#800000">&quot;dtnascimento&quot;</font><font color="#800080">},</font><font color="#FF0000">10</font><font color="#800080">).
   esp(</font><font color="#008080">$tCliente</font><font color="#800080">{</font><font color="#800000">&quot;codendereco&quot;</font><font color="#800080">},</font><font color="#FF0000">10</font><font color="#800080">).esp(</font><font color="#008080">$tCliente</font><font color="#800080">{</font><font color="#800000">&quot;codpais&quot;</font><font color="#800080">},</font><font color="#FF0000">3</font><font color="#800080">).
   esp(</font><font color="#008080">$tCliente</font><font color="#800080">{</font><font color="#800000">&quot;codprofissao&quot;</font><font color="#800080">},</font><font color="#FF0000">10</font><font color="#800080">);
} </font><font color="#0000FF">elsif </font><font color="#800080">(</font><font color="#008080">$sreg</font><font color="#800080">==</font><font color="#008080">$opVenda</font><font color="#800080">) {
   </font><font color="#008080">$slinha</font><font color="#800080">=esp(</font><font color="#008080">$tVenda</font><font color="#800080">{</font><font color="#800000">&quot;dthrvenda&quot;</font><font color="#800080">},</font><font color="#FF0000">19</font><font color="#800080">).esp(</font><font color="#008080">$tVenda</font><font color="#800080">{</font><font color="#800000">&quot;cpf&quot;</font><font color="#800080">},</font><font color="#FF0000">14</font><font color="#800080">).
   esp(</font><font color="#008080">$tVenda</font><font color="#800080">{</font><font color="#800000">&quot;isbn&quot;</font><font color="#800080">},</font><font color="#FF0000">13</font><font color="#800080">).esp(</font><font color="#008080">$tVenda</font><font color="#800080">{</font><font color="#800000">&quot;precovenda&quot;</font><font color="#800080">},</font><font color="#FF0000">10</font><font color="#800080">);
}
</font><font color="#0000FF">return </font><font color="#008080">$slinha</font><font color="#800080">;
}
</font><font color="#808080"><i>#------------------------------------------------------------------------------
# Retorna o tamanho do registro no arquivo de acordo com o tipo de arquivo.
# sreg - o tipo de arquivo
# retorna - o tamanho do registro
#------------------------------------------------------------------------------
</i></font><font color="#0000FF">sub </font><font color="#800080">tamReg {
</font><font color="#0000FF">my </font><font color="#008080">$sreg </font><font color="#800080">= </font><font color="#000080">shift</font><font color="#800080">();
</font><font color="#0000FF">my </font><font color="#008080">$nret </font><font color="#800080">= </font><font color="#FF0000">0</font><font color="#800080">;

</font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$sreg</font><font color="#800080">==</font><font color="#008080">$opAssunto</font><font color="#800080">) { </font><font color="#008080">$nret </font><font color="#800080">= </font><font color="#008080">$TAM_ASSUNTO</font><font color="#800080">;
} </font><font color="#0000FF">elsif </font><font color="#800080">(</font><font color="#008080">$sreg</font><font color="#800080">==</font><font color="#008080">$opAutor</font><font color="#800080">) { </font><font color="#008080">$nret </font><font color="#800080">= </font><font color="#008080">$TAM_AUTOR</font><font color="#800080">;
} </font><font color="#0000FF">elsif </font><font color="#800080">(</font><font color="#008080">$sreg</font><font color="#800080">==</font><font color="#008080">$opEditora</font><font color="#800080">) { </font><font color="#008080">$nret </font><font color="#800080">= </font><font color="#008080">$TAM_EDITORA</font><font color="#800080">;
} </font><font color="#0000FF">elsif </font><font color="#800080">(</font><font color="#008080">$sreg</font><font color="#800080">==</font><font color="#008080">$opEndereco</font><font color="#800080">) { </font><font color="#008080">$nret </font><font color="#800080">= </font><font color="#008080">$TAM_ENDERECO</font><font color="#800080">;
} </font><font color="#0000FF">elsif </font><font color="#800080">(</font><font color="#008080">$sreg</font><font color="#800080">==</font><font color="#008080">$opIdioma</font><font color="#800080">) { </font><font color="#008080">$nret </font><font color="#800080">= </font><font color="#008080">$TAM_IDIOMA</font><font color="#800080">;
} </font><font color="#0000FF">elsif </font><font color="#800080">(</font><font color="#008080">$sreg</font><font color="#800080">==</font><font color="#008080">$opPais</font><font color="#800080">) { </font><font color="#008080">$nret </font><font color="#800080">= </font><font color="#008080">$TAM_PAIS</font><font color="#800080">;
} </font><font color="#0000FF">elsif </font><font color="#800080">(</font><font color="#008080">$sreg</font><font color="#800080">==</font><font color="#008080">$opProfissao</font><font color="#800080">) { </font><font color="#008080">$nret </font><font color="#800080">= </font><font color="#008080">$TAM_PROFISSAO</font><font color="#800080">;
} </font><font color="#0000FF">elsif </font><font color="#800080">(</font><font color="#008080">$sreg</font><font color="#800080">==</font><font color="#008080">$opUsuario</font><font color="#800080">) { </font><font color="#008080">$nret </font><font color="#800080">= </font><font color="#008080">$TAM_USUARIO</font><font color="#800080">;
} </font><font color="#0000FF">elsif </font><font color="#800080">(</font><font color="#008080">$sreg</font><font color="#800080">==</font><font color="#008080">$opLivro</font><font color="#800080">) { </font><font color="#008080">$nret </font><font color="#800080">= </font><font color="#008080">$TAM_LIVRO</font><font color="#800080">;
} </font><font color="#0000FF">elsif </font><font color="#800080">(</font><font color="#008080">$sreg</font><font color="#800080">==</font><font color="#008080">$opLivroAss</font><font color="#800080">) { </font><font color="#008080">$nret </font><font color="#800080">= </font><font color="#008080">$TAM_LIVASS</font><font color="#800080">;
} </font><font color="#0000FF">elsif </font><font color="#800080">(</font><font color="#008080">$sreg</font><font color="#800080">==</font><font color="#008080">$opLivroAut</font><font color="#800080">) { </font><font color="#008080">$nret </font><font color="#800080">= </font><font color="#008080">$TAM_LIVAUT</font><font color="#800080">;
} </font><font color="#0000FF">elsif </font><font color="#800080">(</font><font color="#008080">$sreg</font><font color="#800080">==</font><font color="#008080">$opCliente</font><font color="#800080">) { </font><font color="#008080">$nret </font><font color="#800080">= </font><font color="#008080">$TAM_CLIENTE</font><font color="#800080">;
} </font><font color="#0000FF">elsif </font><font color="#800080">(</font><font color="#008080">$sreg</font><font color="#800080">==</font><font color="#008080">$opVenda</font><font color="#800080">) { </font><font color="#008080">$nret </font><font color="#800080">= </font><font color="#008080">$TAM_VENDA</font><font color="#800080">;
}
</font><font color="#0000FF">return </font><font color="#008080">$nret</font><font color="#800080">;
}
</font><font color="#808080"><i>#------------------------------------------------------------------------------
# Seleciona o rotulo de cada campo de acordo com o tipo de arquivo.
# sreg - o tipo de arquivo
# nNum - indica qual rotulo ser&aacute; retornado
# retorna - o rotulo
#------------------------------------------------------------------------------
</i></font><font color="#0000FF">sub </font><font color="#800080">rotulo {
</font><font color="#0000FF">my </font><font color="#008080">$sreg </font><font color="#800080">= </font><font color="#FF00FF">$_</font><font color="#800080">[</font><font color="#FF0000">0</font><font color="#800080">];
</font><font color="#0000FF">my </font><font color="#008080">$nNum </font><font color="#800080">= </font><font color="#FF00FF">$_</font><font color="#800080">[</font><font color="#FF0000">1</font><font color="#800080">];
</font><font color="#0000FF">my </font><font color="#008080">$sret</font><font color="#800080">;
</font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$sreg</font><font color="#800080">==</font><font color="#008080">$opAssunto</font><font color="#800080">) {
   SWITCH: {
     </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$nNum </font><font color="#800080">== </font><font color="#FF0000">0</font><font color="#800080">) { 
       </font><font color="#008080">$sret</font><font color="#800080">=</font><font color="#800000">&quot;Assunto(s) n&atilde;o encontrado(s)!&quot;</font><font color="#800080">;
       </font><font color="#0000FF">last </font><font color="#800080">SWITCH;
     }
     </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$nNum </font><font color="#800080">== </font><font color="#FF0000">1</font><font color="#800080">) {
         </font><font color="#008080">$sret</font><font color="#800080">=</font><font color="#800000">&quot;C&oacute;digo do assunto: &quot;</font><font color="#800080">;
         </font><font color="#008080">$g_nPosChave </font><font color="#800080">= </font><font color="#FF0000">1</font><font color="#800080">;
         </font><font color="#008080">$g_nTamChave </font><font color="#800080">= </font><font color="#FF0000">10</font><font color="#800080">;
         </font><font color="#0000FF">last </font><font color="#800080">SWITCH;
     }
     </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$nNum </font><font color="#800080">== </font><font color="#FF0000">2</font><font color="#800080">) {
         </font><font color="#008080">$sret</font><font color="#800080">=</font><font color="#800000">&quot;Assunto: &quot;</font><font color="#800080">;
         </font><font color="#008080">$g_nPosChave </font><font color="#800080">= </font><font color="#FF0000">11</font><font color="#800080">;
         </font><font color="#008080">$g_nTamChave </font><font color="#800080">= </font><font color="#FF0000">30</font><font color="#800080">;
         </font><font color="#0000FF">last </font><font color="#800080">SWITCH;
     }
   }
} </font><font color="#0000FF">elsif </font><font color="#800080">(</font><font color="#008080">$sreg</font><font color="#800080">==</font><font color="#008080">$opAutor</font><font color="#800080">) {
   SWITCH: {
     </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$nNum </font><font color="#800080">== </font><font color="#FF0000">0</font><font color="#800080">) { </font><font color="#008080">$sret</font><font color="#800080">=</font><font color="#800000">&quot;Autor(es) n&atilde;o encontrado(s)!&quot;</font><font color="#800080">; }
     </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$nNum </font><font color="#800080">== </font><font color="#FF0000">1</font><font color="#800080">) {
         </font><font color="#008080">$sret</font><font color="#800080">=</font><font color="#800000">&quot;C&oacute;digo do autor: &quot;</font><font color="#800080">;
         </font><font color="#008080">$g_nPosChave </font><font color="#800080">= </font><font color="#FF0000">1</font><font color="#800080">;
         </font><font color="#008080">$g_nTamChave </font><font color="#800080">= </font><font color="#FF0000">10</font><font color="#800080">;
         </font><font color="#0000FF">last </font><font color="#800080">SWITCH;
     }
     </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$nNum </font><font color="#800080">== </font><font color="#FF0000">2</font><font color="#800080">) {
         </font><font color="#008080">$sret</font><font color="#800080">=</font><font color="#800000">&quot;Autor: &quot;</font><font color="#800080">;
         </font><font color="#008080">$g_nPosChave </font><font color="#800080">= </font><font color="#FF0000">11</font><font color="#800080">;
         </font><font color="#008080">$g_nTamChave </font><font color="#800080">= </font><font color="#FF0000">30</font><font color="#800080">;
         </font><font color="#0000FF">last </font><font color="#800080">SWITCH;
     }
   }
} </font><font color="#0000FF">elsif </font><font color="#800080">(</font><font color="#008080">$sreg</font><font color="#800080">==</font><font color="#008080">$opEditora</font><font color="#800080">) {
   SWITCH: {
     </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$nNum </font><font color="#800080">== </font><font color="#FF0000">0</font><font color="#800080">) { </font><font color="#008080">$sret</font><font color="#800080">=</font><font color="#800000">&quot;Editora(s) n&atilde;o encontrada(s)!&quot;</font><font color="#800080">; }
     </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$nNum </font><font color="#800080">== </font><font color="#FF0000">1</font><font color="#800080">) {
         </font><font color="#008080">$sret</font><font color="#800080">=</font><font color="#800000">&quot;C&oacute;digo da editora: &quot;</font><font color="#800080">;
         </font><font color="#008080">$g_nPosChave </font><font color="#800080">= </font><font color="#FF0000">1</font><font color="#800080">;
         </font><font color="#008080">$g_nTamChave </font><font color="#800080">= </font><font color="#FF0000">10</font><font color="#800080">;
         </font><font color="#0000FF">last </font><font color="#800080">SWITCH;
     }
     </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$nNum </font><font color="#800080">== </font><font color="#FF0000">2</font><font color="#800080">) {
         </font><font color="#008080">$sret</font><font color="#800080">=</font><font color="#800000">&quot;Editora: &quot;</font><font color="#800080">;
         </font><font color="#008080">$g_nPosChave </font><font color="#800080">= </font><font color="#FF0000">11</font><font color="#800080">;
         </font><font color="#008080">$g_nTamChave </font><font color="#800080">= </font><font color="#FF0000">50</font><font color="#800080">;
         </font><font color="#0000FF">last </font><font color="#800080">SWITCH;
     }
   }
} </font><font color="#0000FF">elsif </font><font color="#800080">(</font><font color="#008080">$sreg</font><font color="#800080">==</font><font color="#008080">$opEndereco</font><font color="#800080">) {
   SWITCH: {
     </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$nNum </font><font color="#800080">== </font><font color="#FF0000">0</font><font color="#800080">) { </font><font color="#008080">$sret</font><font color="#800080">=</font><font color="#800000">&quot;Endere&ccedil;o(s) n&atilde;o encontrado(s)!&quot;</font><font color="#800080">; }
     </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$nNum </font><font color="#800080">== </font><font color="#FF0000">1</font><font color="#800080">) {
         </font><font color="#008080">$sret</font><font color="#800080">=</font><font color="#800000">&quot;C&oacute;digo do endere&ccedil;o: &quot;</font><font color="#800080">;
         </font><font color="#008080">$g_nPosChave </font><font color="#800080">= </font><font color="#FF0000">1</font><font color="#800080">;
         </font><font color="#008080">$g_nTamChave </font><font color="#800080">= </font><font color="#FF0000">10</font><font color="#800080">;
         </font><font color="#0000FF">last </font><font color="#800080">SWITCH;
     }
     </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$nNum </font><font color="#800080">== </font><font color="#FF0000">2</font><font color="#800080">) {
         </font><font color="#008080">$sret</font><font color="#800080">=</font><font color="#800000">&quot;Logradouro: &quot;</font><font color="#800080">;
         </font><font color="#008080">$g_nPosChave </font><font color="#800080">= </font><font color="#FF0000">11</font><font color="#800080">;
         </font><font color="#008080">$g_nTamChave </font><font color="#800080">= </font><font color="#FF0000">40</font><font color="#800080">;
         </font><font color="#0000FF">last </font><font color="#800080">SWITCH;
     }
     </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$nNum </font><font color="#800080">== </font><font color="#FF0000">3</font><font color="#800080">) {
         </font><font color="#008080">$sret</font><font color="#800080">=</font><font color="#800000">&quot;Bairro: &quot;</font><font color="#800080">;
         </font><font color="#008080">$g_nPosChave </font><font color="#800080">= </font><font color="#FF0000">51</font><font color="#800080">;
         </font><font color="#008080">$g_nTamChave </font><font color="#800080">= </font><font color="#FF0000">15</font><font color="#800080">;
         </font><font color="#0000FF">last </font><font color="#800080">SWITCH;
     }
     </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$nNum </font><font color="#800080">== </font><font color="#FF0000">4</font><font color="#800080">) {
         </font><font color="#008080">$sret</font><font color="#800080">=</font><font color="#800000">&quot;CEP: &quot;</font><font color="#800080">;
         </font><font color="#008080">$g_nPosChave </font><font color="#800080">= </font><font color="#FF0000">66</font><font color="#800080">;
         </font><font color="#008080">$g_nTamChave </font><font color="#800080">= </font><font color="#FF0000">8</font><font color="#800080">;
         </font><font color="#0000FF">last </font><font color="#800080">SWITCH;
     }
     </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$nNum </font><font color="#800080">== </font><font color="#FF0000">5</font><font color="#800080">) {
         </font><font color="#008080">$sret</font><font color="#800080">=</font><font color="#800000">&quot;Cidade: &quot;</font><font color="#800080">;
         </font><font color="#008080">$g_nPosChave </font><font color="#800080">= </font><font color="#FF0000">74</font><font color="#800080">;
         </font><font color="#008080">$g_nTamChave </font><font color="#800080">= </font><font color="#FF0000">30</font><font color="#800080">;
         </font><font color="#0000FF">last </font><font color="#800080">SWITCH;
     }
     </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$nNum </font><font color="#800080">== </font><font color="#FF0000">6</font><font color="#800080">) {
         </font><font color="#008080">$sret</font><font color="#800080">=</font><font color="#800000">&quot;Estado: &quot;</font><font color="#800080">;
         </font><font color="#008080">$g_nPosChave </font><font color="#800080">= </font><font color="#FF0000">104</font><font color="#800080">;
         </font><font color="#008080">$g_nTamChave </font><font color="#800080">= </font><font color="#FF0000">20</font><font color="#800080">;
         </font><font color="#0000FF">last </font><font color="#800080">SWITCH;
     }
   }
} </font><font color="#0000FF">elsif </font><font color="#800080">(</font><font color="#008080">$sreg</font><font color="#800080">==</font><font color="#008080">$opIdioma</font><font color="#800080">) {
   SWITCH: {
     </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$nNum </font><font color="#800080">== </font><font color="#FF0000">0</font><font color="#800080">) { </font><font color="#008080">$sret</font><font color="#800080">=</font><font color="#800000">&quot;Idioma(s) n&atilde;o encontrado(s)!&quot;</font><font color="#800080">; }
     </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$nNum </font><font color="#800080">== </font><font color="#FF0000">1</font><font color="#800080">) {
         </font><font color="#008080">$sret</font><font color="#800080">=</font><font color="#800000">&quot;C&oacute;digo do idioma: &quot;</font><font color="#800080">;
         </font><font color="#008080">$g_nPosChave </font><font color="#800080">= </font><font color="#FF0000">1</font><font color="#800080">;
         </font><font color="#008080">$g_nTamChave </font><font color="#800080">= </font><font color="#FF0000">10</font><font color="#800080">;
         </font><font color="#0000FF">last </font><font color="#800080">SWITCH;
     }
     </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$nNum </font><font color="#800080">== </font><font color="#FF0000">2</font><font color="#800080">) {
         </font><font color="#008080">$sret</font><font color="#800080">=</font><font color="#800000">&quot;Idioma: &quot;</font><font color="#800080">;
         </font><font color="#008080">$g_nPosChave </font><font color="#800080">= </font><font color="#FF0000">11</font><font color="#800080">;
         </font><font color="#008080">$g_nTamChave </font><font color="#800080">= </font><font color="#FF0000">20</font><font color="#800080">;
         </font><font color="#0000FF">last </font><font color="#800080">SWITCH;
     }
   }
} </font><font color="#0000FF">elsif </font><font color="#800080">(</font><font color="#008080">$sreg</font><font color="#800080">==</font><font color="#008080">$opPais</font><font color="#800080">) {
   SWITCH: {
     </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$nNum </font><font color="#800080">== </font><font color="#FF0000">0</font><font color="#800080">) { </font><font color="#008080">$sret</font><font color="#800080">=</font><font color="#800000">&quot;Pa&iacute;s(es) n&atilde;o encontrado(s)!&quot;</font><font color="#800080">; }
     </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$nNum </font><font color="#800080">== </font><font color="#FF0000">1</font><font color="#800080">) {
         </font><font color="#008080">$sret</font><font color="#800080">=</font><font color="#800000">&quot;C&oacute;digo do pa&iacute;s: &quot;</font><font color="#800080">;
         </font><font color="#008080">$g_nPosChave </font><font color="#800080">= </font><font color="#FF0000">1</font><font color="#800080">;
         </font><font color="#008080">$g_nTamChave </font><font color="#800080">= </font><font color="#FF0000">3</font><font color="#800080">;
         </font><font color="#0000FF">last </font><font color="#800080">SWITCH;
     }
     </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$nNum </font><font color="#800080">== </font><font color="#FF0000">2</font><font color="#800080">) {
         </font><font color="#008080">$sret</font><font color="#800080">=</font><font color="#800000">&quot;Pa&iacute;s: &quot;</font><font color="#800080">;
         </font><font color="#008080">$g_nPosChave </font><font color="#800080">= </font><font color="#FF0000">4</font><font color="#800080">;
         </font><font color="#008080">$g_nTamChave </font><font color="#800080">= </font><font color="#FF0000">50</font><font color="#800080">;
         </font><font color="#0000FF">last </font><font color="#800080">SWITCH;
     }
   }
} </font><font color="#0000FF">elsif </font><font color="#800080">(</font><font color="#008080">$sreg</font><font color="#800080">==</font><font color="#008080">$opProfissao</font><font color="#800080">) {
   SWITCH: {
     </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$nNum </font><font color="#800080">== </font><font color="#FF0000">0</font><font color="#800080">) { </font><font color="#008080">$sret</font><font color="#800080">=</font><font color="#800000">&quot;Profiss&atilde;o(es) n&atilde;o encontrada(s)!&quot;</font><font color="#800080">; }
     </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$nNum </font><font color="#800080">== </font><font color="#FF0000">1</font><font color="#800080">) {
         </font><font color="#008080">$sret</font><font color="#800080">=</font><font color="#800000">&quot;C&oacute;digo da profiss&atilde;o: &quot;</font><font color="#800080">;
         </font><font color="#008080">$g_nPosChave </font><font color="#800080">= </font><font color="#FF0000">1</font><font color="#800080">;
         </font><font color="#008080">$g_nTamChave </font><font color="#800080">= </font><font color="#FF0000">10</font><font color="#800080">;
         </font><font color="#0000FF">last </font><font color="#800080">SWITCH;
     }
     </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$nNum </font><font color="#800080">== </font><font color="#FF0000">2</font><font color="#800080">) {
         </font><font color="#008080">$sret</font><font color="#800080">=</font><font color="#800000">&quot;Profiss&atilde;o: &quot;</font><font color="#800080">;
         </font><font color="#008080">$g_nPosChave </font><font color="#800080">= </font><font color="#FF0000">11</font><font color="#800080">;
         </font><font color="#008080">$g_nTamChave </font><font color="#800080">= </font><font color="#FF0000">50</font><font color="#800080">;
         </font><font color="#0000FF">last </font><font color="#800080">SWITCH;
     }
   }
} </font><font color="#0000FF">elsif </font><font color="#800080">(</font><font color="#008080">$sreg</font><font color="#800080">==</font><font color="#008080">$opUsuario</font><font color="#800080">) {
   SWITCH: {
     </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$nNum </font><font color="#800080">== </font><font color="#FF0000">0</font><font color="#800080">) { </font><font color="#008080">$sret</font><font color="#800080">=</font><font color="#800000">&quot;login ou senha incorreta, tente de novo!&quot;</font><font color="#800080">; }
     </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$nNum </font><font color="#800080">== </font><font color="#FF0000">1</font><font color="#800080">) {
         </font><font color="#008080">$sret</font><font color="#800080">=</font><font color="#800000">&quot;Login: &quot;</font><font color="#800080">;
         </font><font color="#008080">$g_nPosChave </font><font color="#800080">= </font><font color="#FF0000">1</font><font color="#800080">;
         </font><font color="#008080">$g_nTamChave </font><font color="#800080">= </font><font color="#FF0000">10</font><font color="#800080">;
         </font><font color="#0000FF">last </font><font color="#800080">SWITCH;
     }
     </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$nNum </font><font color="#800080">== </font><font color="#FF0000">2</font><font color="#800080">) {
         </font><font color="#008080">$sret</font><font color="#800080">=</font><font color="#800000">&quot;Senha: &quot;</font><font color="#800080">;
         </font><font color="#008080">$g_nPosChave </font><font color="#800080">= </font><font color="#FF0000">11</font><font color="#800080">;
         </font><font color="#008080">$g_nTamChave </font><font color="#800080">= </font><font color="#FF0000">10</font><font color="#800080">;
         </font><font color="#0000FF">last </font><font color="#800080">SWITCH;
     }
   }
} </font><font color="#0000FF">elsif </font><font color="#800080">(</font><font color="#008080">$sreg</font><font color="#800080">==</font><font color="#008080">$opLivro</font><font color="#800080">) {
   SWITCH: {
     </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$nNum </font><font color="#800080">== </font><font color="#FF0000">0</font><font color="#800080">) { </font><font color="#008080">$sret</font><font color="#800080">=</font><font color="#800000">&quot;Livro(s) n&atilde;o encontrado(s)!&quot;</font><font color="#800080">; }
     </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$nNum </font><font color="#800080">== </font><font color="#FF0000">1</font><font color="#800080">) {
         </font><font color="#008080">$sret</font><font color="#800080">=</font><font color="#800000">&quot;ISBN: &quot;</font><font color="#800080">;
         </font><font color="#008080">$g_nPosChave </font><font color="#800080">= </font><font color="#FF0000">1</font><font color="#800080">;
         </font><font color="#008080">$g_nTamChave </font><font color="#800080">= </font><font color="#FF0000">13</font><font color="#800080">;
         </font><font color="#0000FF">last </font><font color="#800080">SWITCH;
     }
     </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$nNum </font><font color="#800080">== </font><font color="#FF0000">2</font><font color="#800080">) {
         </font><font color="#008080">$sret</font><font color="#800080">=</font><font color="#800000">&quot;T&iacute;tulo: &quot;</font><font color="#800080">;
         </font><font color="#008080">$g_nPosChave </font><font color="#800080">= </font><font color="#FF0000">14</font><font color="#800080">;
         </font><font color="#008080">$g_nTamChave </font><font color="#800080">= </font><font color="#FF0000">50</font><font color="#800080">;
         </font><font color="#0000FF">last </font><font color="#800080">SWITCH;
     }
     </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$nNum </font><font color="#800080">== </font><font color="#FF0000">3</font><font color="#800080">) {
         </font><font color="#008080">$sret</font><font color="#800080">=</font><font color="#800000">&quot;Edi&ccedil;&atilde;o: &quot;</font><font color="#800080">;
         </font><font color="#008080">$g_nPosChave </font><font color="#800080">= </font><font color="#FF0000">64</font><font color="#800080">;
         </font><font color="#008080">$g_nTamChave </font><font color="#800080">= </font><font color="#FF0000">10</font><font color="#800080">;
         </font><font color="#0000FF">last </font><font color="#800080">SWITCH;
     }
     </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$nNum </font><font color="#800080">== </font><font color="#FF0000">4</font><font color="#800080">) {
         </font><font color="#008080">$sret</font><font color="#800080">=</font><font color="#800000">&quot;Ano de Publica&ccedil;&atilde;o: &quot;</font><font color="#800080">;
         </font><font color="#008080">$g_nPosChave </font><font color="#800080">= </font><font color="#FF0000">74</font><font color="#800080">;
         </font><font color="#008080">$g_nTamChave </font><font color="#800080">= </font><font color="#FF0000">10</font><font color="#800080">;
         </font><font color="#0000FF">last </font><font color="#800080">SWITCH;
     }
     </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$nNum </font><font color="#800080">== </font><font color="#FF0000">5</font><font color="#800080">) {
         </font><font color="#008080">$sret</font><font color="#800080">=</font><font color="#800000">&quot;C&oacute;digo da editora: &quot;</font><font color="#800080">;
         </font><font color="#008080">$g_nPosChave </font><font color="#800080">= </font><font color="#FF0000">84</font><font color="#800080">;
         </font><font color="#008080">$g_nTamChave </font><font color="#800080">= </font><font color="#FF0000">10</font><font color="#800080">;
         </font><font color="#0000FF">last </font><font color="#800080">SWITCH;
     }
     </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$nNum </font><font color="#800080">== </font><font color="#FF0000">6</font><font color="#800080">) {
         </font><font color="#008080">$sret</font><font color="#800080">=</font><font color="#800000">&quot;Volume: &quot;</font><font color="#800080">;
         </font><font color="#008080">$g_nPosChave </font><font color="#800080">= </font><font color="#FF0000">94</font><font color="#800080">;
         </font><font color="#008080">$g_nTamChave </font><font color="#800080">= </font><font color="#FF0000">10</font><font color="#800080">;
         </font><font color="#0000FF">last </font><font color="#800080">SWITCH;
     }
     </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$nNum </font><font color="#800080">== </font><font color="#FF0000">7</font><font color="#800080">) {
         </font><font color="#008080">$sret</font><font color="#800080">=</font><font color="#800000">&quot;C&oacute;digo do idioma: &quot;</font><font color="#800080">;
         </font><font color="#008080">$g_nPosChave </font><font color="#800080">= </font><font color="#FF0000">104</font><font color="#800080">;
         </font><font color="#008080">$g_nTamChave </font><font color="#800080">= </font><font color="#FF0000">10</font><font color="#800080">;
         </font><font color="#0000FF">last </font><font color="#800080">SWITCH;
     }
     </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$nNum </font><font color="#800080">== </font><font color="#FF0000">8</font><font color="#800080">) {
         </font><font color="#008080">$sret</font><font color="#800080">=</font><font color="#800000">&quot;N&uacute;mero de p&aacute;ginas: &quot;</font><font color="#800080">;
         </font><font color="#008080">$g_nPosChave </font><font color="#800080">= </font><font color="#FF0000">114</font><font color="#800080">;
         </font><font color="#008080">$g_nTamChave </font><font color="#800080">= </font><font color="#FF0000">10</font><font color="#800080">;
         </font><font color="#0000FF">last </font><font color="#800080">SWITCH;
     }
     </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$nNum </font><font color="#800080">== </font><font color="#FF0000">9</font><font color="#800080">) {
         </font><font color="#008080">$sret</font><font color="#800080">=</font><font color="#800000">&quot;Pre&ccedil;o: &quot;</font><font color="#800080">;
         </font><font color="#008080">$g_nPosChave </font><font color="#800080">= </font><font color="#FF0000">124</font><font color="#800080">;
         </font><font color="#008080">$g_nTamChave </font><font color="#800080">= </font><font color="#FF0000">10</font><font color="#800080">;
         </font><font color="#0000FF">last </font><font color="#800080">SWITCH;
     }
     </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$nNum </font><font color="#800080">== </font><font color="#FF0000">10</font><font color="#800080">) {
          </font><font color="#008080">$sret</font><font color="#800080">=</font><font color="#800000">&quot;Qtd. Estoque: &quot;</font><font color="#800080">;
          </font><font color="#008080">$g_nPosChave </font><font color="#800080">= </font><font color="#FF0000">134</font><font color="#800080">;
          </font><font color="#008080">$g_nTamChave </font><font color="#800080">= </font><font color="#FF0000">10</font><font color="#800080">;
          </font><font color="#0000FF">last </font><font color="#800080">SWITCH;
     }
   }
} </font><font color="#0000FF">elsif </font><font color="#800080">(</font><font color="#008080">$sreg</font><font color="#800080">==</font><font color="#008080">$opLivroAss</font><font color="#800080">) {
   SWITCH: {
     </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$nNum </font><font color="#800080">== </font><font color="#FF0000">0</font><font color="#800080">) { </font><font color="#008080">$sret</font><font color="#800080">=</font><font color="#800000">&quot;Assunto(s) n&atilde;o encontrado(s)!&quot;</font><font color="#800080">; }
     </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$nNum </font><font color="#800080">== </font><font color="#FF0000">1</font><font color="#800080">) {
         </font><font color="#008080">$sret</font><font color="#800080">=</font><font color="#800000">&quot;ISBN: &quot;</font><font color="#800080">;
         </font><font color="#008080">$g_nPosChave </font><font color="#800080">= </font><font color="#FF0000">1</font><font color="#800080">;
         </font><font color="#008080">$g_nTamChave </font><font color="#800080">= </font><font color="#FF0000">13</font><font color="#800080">;
         </font><font color="#0000FF">last </font><font color="#800080">SWITCH;
     }
     </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$nNum </font><font color="#800080">== </font><font color="#FF0000">2</font><font color="#800080">) {
         </font><font color="#008080">$sret</font><font color="#800080">=</font><font color="#800000">&quot;C&oacute;digo do assunto: &quot;</font><font color="#800080">;
         </font><font color="#008080">$g_nPosChave </font><font color="#800080">= </font><font color="#FF0000">14</font><font color="#800080">;
         </font><font color="#008080">$g_nTamChave </font><font color="#800080">= </font><font color="#FF0000">10</font><font color="#800080">;
         </font><font color="#0000FF">last </font><font color="#800080">SWITCH;
     }
   }
} </font><font color="#0000FF">elsif </font><font color="#800080">(</font><font color="#008080">$sreg</font><font color="#800080">==</font><font color="#008080">$opLivroAut</font><font color="#800080">) {
   SWITCH: {
     </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$nNum </font><font color="#800080">== </font><font color="#FF0000">0</font><font color="#800080">) { </font><font color="#008080">$sret</font><font color="#800080">=</font><font color="#800000">&quot;Autor(s) n&atilde;o encontrado(s)!&quot;</font><font color="#800080">; }
     </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$nNum </font><font color="#800080">== </font><font color="#FF0000">1</font><font color="#800080">) {
         </font><font color="#008080">$sret</font><font color="#800080">=</font><font color="#800000">&quot;ISBN: &quot;</font><font color="#800080">;
         </font><font color="#008080">$g_nPosChave </font><font color="#800080">= </font><font color="#FF0000">1</font><font color="#800080">;
         </font><font color="#008080">$g_nTamChave </font><font color="#800080">= </font><font color="#FF0000">13</font><font color="#800080">;
         </font><font color="#0000FF">last </font><font color="#800080">SWITCH;
     }
     </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$nNum </font><font color="#800080">== </font><font color="#FF0000">2</font><font color="#800080">) {
         </font><font color="#008080">$sret</font><font color="#800080">=</font><font color="#800000">&quot;C&oacute;digo do autor: &quot;</font><font color="#800080">;
         </font><font color="#008080">$g_nPosChave </font><font color="#800080">= </font><font color="#FF0000">14</font><font color="#800080">;
         </font><font color="#008080">$g_nTamChave </font><font color="#800080">= </font><font color="#FF0000">10</font><font color="#800080">;
          </font><font color="#0000FF">last </font><font color="#800080">SWITCH;
}
   }
} </font><font color="#0000FF">elsif </font><font color="#800080">(</font><font color="#008080">$sreg</font><font color="#800080">==</font><font color="#008080">$opCliente</font><font color="#800080">) {
   SWITCH: {
     </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$nNum </font><font color="#800080">== </font><font color="#FF0000">0</font><font color="#800080">) { </font><font color="#008080">$sret</font><font color="#800080">=</font><font color="#800000">&quot;Cliente(s) n&atilde;o encontrado(s)!&quot;</font><font color="#800080">; }
     </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$nNum </font><font color="#800080">== </font><font color="#FF0000">1</font><font color="#800080">) {
         </font><font color="#008080">$sret</font><font color="#800080">=</font><font color="#800000">&quot;CPF: &quot;</font><font color="#800080">;
         </font><font color="#008080">$g_nPosChave </font><font color="#800080">= </font><font color="#FF0000">1</font><font color="#800080">;
         </font><font color="#008080">$g_nTamChave </font><font color="#800080">= </font><font color="#FF0000">14</font><font color="#800080">;
         </font><font color="#0000FF">last </font><font color="#800080">SWITCH;
     }
     </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$nNum </font><font color="#800080">== </font><font color="#FF0000">2</font><font color="#800080">) {
         </font><font color="#008080">$sret</font><font color="#800080">=</font><font color="#800000">&quot;Nome: &quot;</font><font color="#800080">;
         </font><font color="#008080">$g_nPosChave </font><font color="#800080">= </font><font color="#FF0000">15</font><font color="#800080">;
         </font><font color="#008080">$g_nTamChave </font><font color="#800080">= </font><font color="#FF0000">30</font><font color="#800080">;
         </font><font color="#0000FF">last </font><font color="#800080">SWITCH;
     }
     </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$nNum </font><font color="#800080">== </font><font color="#FF0000">3</font><font color="#800080">) {
         </font><font color="#008080">$sret</font><font color="#800080">=</font><font color="#800000">&quot;E-mail: &quot;</font><font color="#800080">;
         </font><font color="#008080">$g_nPosChave </font><font color="#800080">= </font><font color="#FF0000">45</font><font color="#800080">;
         </font><font color="#008080">$g_nTamChave </font><font color="#800080">= </font><font color="#FF0000">30</font><font color="#800080">;
         </font><font color="#0000FF">last </font><font color="#800080">SWITCH;
     }
     </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$nNum </font><font color="#800080">== </font><font color="#FF0000">4</font><font color="#800080">) {
         </font><font color="#008080">$sret</font><font color="#800080">=</font><font color="#800000">&quot;Identidade: &quot;</font><font color="#800080">;
         </font><font color="#008080">$g_nPosChave </font><font color="#800080">= </font><font color="#FF0000">75</font><font color="#800080">;
         </font><font color="#008080">$g_nTamChave </font><font color="#800080">= </font><font color="#FF0000">10</font><font color="#800080">;
         </font><font color="#0000FF">last </font><font color="#800080">SWITCH;
     }
     </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$nNum </font><font color="#800080">== </font><font color="#FF0000">5</font><font color="#800080">) {
         </font><font color="#008080">$sret</font><font color="#800080">=</font><font color="#800000">&quot;Sexo: &quot;</font><font color="#800080">;
         </font><font color="#008080">$g_nPosChave </font><font color="#800080">= </font><font color="#FF0000">85</font><font color="#800080">;
         </font><font color="#008080">$g_nTamChave </font><font color="#800080">= </font><font color="#FF0000">1</font><font color="#800080">;
         </font><font color="#0000FF">last </font><font color="#800080">SWITCH;
     }
     </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$nNum </font><font color="#800080">== </font><font color="#FF0000">6</font><font color="#800080">) {
         </font><font color="#008080">$sret</font><font color="#800080">=</font><font color="#800000">&quot;Telefone: &quot;</font><font color="#800080">;
         </font><font color="#008080">$g_nPosChave </font><font color="#800080">= </font><font color="#FF0000">86</font><font color="#800080">;
         </font><font color="#008080">$g_nTamChave </font><font color="#800080">= </font><font color="#FF0000">17</font><font color="#800080">;
         </font><font color="#0000FF">last </font><font color="#800080">SWITCH;
     }
     </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$nNum </font><font color="#800080">== </font><font color="#FF0000">7</font><font color="#800080">) {
         </font><font color="#008080">$sret</font><font color="#800080">=</font><font color="#800000">&quot;Dt. Nascimento: &quot;</font><font color="#800080">;
         </font><font color="#008080">$g_nPosChave </font><font color="#800080">= </font><font color="#FF0000">103</font><font color="#800080">;
         </font><font color="#008080">$g_nTamChave </font><font color="#800080">= </font><font color="#FF0000">10</font><font color="#800080">;
         </font><font color="#0000FF">last </font><font color="#800080">SWITCH;
     }
     </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$nNum </font><font color="#800080">== </font><font color="#FF0000">8</font><font color="#800080">) {
         </font><font color="#008080">$sret</font><font color="#800080">=</font><font color="#800000">&quot;C&oacute;digo do endere&ccedil;o: &quot;</font><font color="#800080">;
         </font><font color="#008080">$g_nPosChave </font><font color="#800080">= </font><font color="#FF0000">113</font><font color="#800080">;
         </font><font color="#008080">$g_nTamChave </font><font color="#800080">= </font><font color="#FF0000">10</font><font color="#800080">;
         </font><font color="#0000FF">last </font><font color="#800080">SWITCH;
     }
     </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$nNum </font><font color="#800080">== </font><font color="#FF0000">9</font><font color="#800080">) {
         </font><font color="#008080">$sret</font><font color="#800080">=</font><font color="#800000">&quot;C&oacute;digo do pa&iacute;s: &quot;</font><font color="#800080">;
         </font><font color="#008080">$g_nPosChave </font><font color="#800080">= </font><font color="#FF0000">123</font><font color="#800080">;
         </font><font color="#008080">$g_nTamChave </font><font color="#800080">= </font><font color="#FF0000">3</font><font color="#800080">;
         </font><font color="#0000FF">last </font><font color="#800080">SWITCH;
     }
     </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$nNum </font><font color="#800080">== </font><font color="#FF0000">10</font><font color="#800080">) {
          </font><font color="#008080">$sret</font><font color="#800080">=</font><font color="#800000">&quot;C&oacute;digo da Profiss&atilde;o: &quot;</font><font color="#800080">;
          </font><font color="#008080">$g_nPosChave </font><font color="#800080">= </font><font color="#FF0000">126</font><font color="#800080">;
          </font><font color="#008080">$g_nTamChave </font><font color="#800080">= </font><font color="#FF0000">10</font><font color="#800080">;
         </font><font color="#0000FF">last </font><font color="#800080">SWITCH;
     }
   }
} </font><font color="#0000FF">elsif </font><font color="#800080">(</font><font color="#008080">$sreg</font><font color="#800080">==</font><font color="#008080">$opVenda</font><font color="#800080">) {
   SWITCH: {
     </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$nNum </font><font color="#800080">== </font><font color="#FF0000">0</font><font color="#800080">) { </font><font color="#008080">$sret</font><font color="#800080">=</font><font color="#800000">&quot;Venda(s) n&atilde;o encontrada(s)!&quot;</font><font color="#800080">; }
     </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$nNum </font><font color="#800080">== </font><font color="#FF0000">1</font><font color="#800080">) {
         </font><font color="#008080">$sret</font><font color="#800080">=</font><font color="#800000">&quot;Data/Hora venda: &quot;</font><font color="#800080">;
         </font><font color="#008080">$g_nPosChave </font><font color="#800080">= </font><font color="#FF0000">1</font><font color="#800080">;
         </font><font color="#008080">$g_nTamChave </font><font color="#800080">= </font><font color="#FF0000">19</font><font color="#800080">;
         </font><font color="#0000FF">last </font><font color="#800080">SWITCH;
     }
     </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$nNum </font><font color="#800080">== </font><font color="#FF0000">2</font><font color="#800080">) {
         </font><font color="#008080">$sret</font><font color="#800080">=</font><font color="#800000">&quot;CPF: &quot;</font><font color="#800080">;
         </font><font color="#008080">$g_nPosChave </font><font color="#800080">= </font><font color="#FF0000">20</font><font color="#800080">;
         </font><font color="#008080">$g_nTamChave </font><font color="#800080">= </font><font color="#FF0000">14</font><font color="#800080">;
         </font><font color="#0000FF">last </font><font color="#800080">SWITCH;
     }
     </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$nNum </font><font color="#800080">== </font><font color="#FF0000">3</font><font color="#800080">) {
         </font><font color="#008080">$sret</font><font color="#800080">=</font><font color="#800000">&quot;ISBN: &quot;</font><font color="#800080">;
         </font><font color="#008080">$g_nPosChave </font><font color="#800080">= </font><font color="#FF0000">34</font><font color="#800080">;
         </font><font color="#008080">$g_nTamChave </font><font color="#800080">= </font><font color="#FF0000">13</font><font color="#800080">;
         </font><font color="#0000FF">last </font><font color="#800080">SWITCH;
     }
     </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$nNum </font><font color="#800080">== </font><font color="#FF0000">4</font><font color="#800080">) {
         </font><font color="#008080">$sret</font><font color="#800080">=</font><font color="#800000">&quot;Pre&ccedil;o de venda: &quot;</font><font color="#800080">;
         </font><font color="#008080">$g_nPosChave </font><font color="#800080">= </font><font color="#FF0000">47</font><font color="#800080">;
         </font><font color="#008080">$g_nTamChave </font><font color="#800080">= </font><font color="#FF0000">10</font><font color="#800080">;
         </font><font color="#0000FF">last </font><font color="#800080">SWITCH;
     }
   }
}

</font><font color="#0000FF">return </font><font color="#008080">$sret</font><font color="#800080">;
}
</font><font color="#808080"><i>#------------------------------------------------------------------------------
# Indica se continua ou n&atilde;o mostrando um n&uacute;mero m&aacute;ximo de linhas.
# nlinha - a linha a ser continuada
# nQtdLinha - a quantidade de linhas a serem mostradas
# retorna - se continua ou n&atilde;o
#------------------------------------------------------------------------------
</i></font><font color="#0000FF">sub </font><font color="#800080">ContinuaSN {
</font><font color="#0000FF">my </font><font color="#008080">$nlinha </font><font color="#800080">= </font><font color="#FF00FF">$_</font><font color="#800080">[</font><font color="#FF0000">0</font><font color="#800080">];
</font><font color="#0000FF">my </font><font color="#008080">$nQtdLinha </font><font color="#800080">= </font><font color="#FF00FF">$_</font><font color="#800080">[</font><font color="#FF0000">1</font><font color="#800080">];

</font><font color="#0000FF">my </font><font color="#008080">$bSOp</font><font color="#800080">; </font><font color="#0000FF">my </font><font color="#008080">$opCSubMenu</font><font color="#800080">;
</font><font color="#0000FF">my </font><font color="#008080">$bret </font><font color="#800080">= </font><font color="#008080">$false</font><font color="#800080">;
</font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$nlinha </font><font color="#800080">&gt; </font><font color="#FF0000">0</font><font color="#800080">) {
  </font><font color="#0000FF">if </font><font color="#800080">((</font><font color="#008080">$nlinha </font><font color="#800080">% </font><font color="#008080">$nQtdLinha</font><font color="#800080">) == </font><font color="#FF0000">0</font><font color="#800080">) {
      </font><font color="#008080">$bSOp </font><font color="#800080">= </font><font color="#008080">$true</font><font color="#800080">;
      </font><font color="#0000FF">while</font><font color="#800080">(</font><font color="#008080">$bSOp</font><font color="#800080">==</font><font color="#008080">$true</font><font color="#800080">) {
       menu(</font><font color="#FF0000">13</font><font color="#800080">);
       </font><font color="#008080">$opCSubMenu </font><font color="#800080">= digita();
       </font><font color="#0000FF">if </font><font color="#800080">((</font><font color="#008080">$opCSubMenu</font><font color="#800080">=~</font><font color="#800000">'S'</font><font color="#800080">) || (</font><font color="#008080">$opCSubMenu</font><font color="#800080">=~</font><font color="#800000">'s'</font><font color="#800080">)) { </font><font color="#008080">$bSOp </font><font color="#800080">= </font><font color="#008080">$false</font><font color="#800080">; }
       </font><font color="#0000FF">elsif </font><font color="#800080">((</font><font color="#008080">$opCSubMenu</font><font color="#800080">=~</font><font color="#800000">'N'</font><font color="#800080">) || (</font><font color="#008080">$opCSubMenu</font><font color="#800080">=~</font><font color="#800000">'n'</font><font color="#800080">)) {
          </font><font color="#008080">$bret </font><font color="#800080">= </font><font color="#008080">$true</font><font color="#800080">;
          </font><font color="#008080">$bSOp </font><font color="#800080">= </font><font color="#008080">$false</font><font color="#800080">;
       } </font><font color="#0000FF">else </font><font color="#800080">{ </font><font color="#000080">print</font><font color="#800080">(MSG_ERRO); }
      }
  }
}

</font><font color="#0000FF">return </font><font color="#008080">$bret</font><font color="#800080">;
}
</font><font color="#808080"><i>#------------------------------------------------------------------------------
# Lista v&aacute;rios registros de acordo com a pesquisa feita.
# sArq - o arquivo
# sreg - o tipo de arquivo
# sChave - a chave a ser pesquisada
# nPosChave - a posicao inicial da chave dentro do registro
# nTamChave - o tamanho da chave dentro do registro
# nTamLinha - o tamanho do registro
# nQtdLinha - a quantidade de linhas a serem mostradas
# retorna - se encontrou algum registro
#------------------------------------------------------------------------------
</i></font><font color="#0000FF">sub </font><font color="#800080">ListarTodos { 
</font><font color="#0000FF">my </font><font color="#008080">$sArq </font><font color="#800080">= </font><font color="#FF00FF">$_</font><font color="#800080">[</font><font color="#FF0000">0</font><font color="#800080">]; </font><font color="#0000FF">my </font><font color="#008080">$sreg </font><font color="#800080">= </font><font color="#FF00FF">$_</font><font color="#800080">[</font><font color="#FF0000">1</font><font color="#800080">]; </font><font color="#0000FF">my </font><font color="#008080">$sChave </font><font color="#800080">= </font><font color="#FF00FF">$_</font><font color="#800080">[</font><font color="#FF0000">2</font><font color="#800080">]; </font><font color="#0000FF">my </font><font color="#008080">$nPosChave </font><font color="#800080">= </font><font color="#FF00FF">$_</font><font color="#800080">[</font><font color="#FF0000">3</font><font color="#800080">];
</font><font color="#0000FF">my </font><font color="#008080">$nTamChave </font><font color="#800080">= </font><font color="#FF00FF">$_</font><font color="#800080">[</font><font color="#FF0000">4</font><font color="#800080">]; </font><font color="#0000FF">my </font><font color="#008080">$nTamLinha </font><font color="#800080">= </font><font color="#FF00FF">$_</font><font color="#800080">[</font><font color="#FF0000">5</font><font color="#800080">]; </font><font color="#0000FF">my </font><font color="#008080">$nQtdLinha </font><font color="#800080">= </font><font color="#FF00FF">$_</font><font color="#800080">[</font><font color="#FF0000">6</font><font color="#800080">];
</font><font color="#0000FF">my </font><font color="#008080">$bPesqRelativa </font><font color="#800080">= </font><font color="#FF00FF">$_</font><font color="#800080">[</font><font color="#FF0000">7</font><font color="#800080">];

</font><font color="#0000FF">my </font><font color="#008080">$slinha</font><font color="#800080">; </font><font color="#0000FF">my </font><font color="#008080">$bAchou</font><font color="#800080">; </font><font color="#0000FF">my </font><font color="#008080">$sres</font><font color="#800080">;

</font><font color="#0000FF">my </font><font color="#008080">$bRet </font><font color="#800080">= </font><font color="#008080">$false</font><font color="#800080">;
</font><font color="#0000FF">my </font><font color="#008080">$bQuebra </font><font color="#800080">= </font><font color="#008080">$false</font><font color="#800080">;
</font><font color="#0000FF">my </font><font color="#008080">$nCont </font><font color="#800080">= </font><font color="#FF0000">0</font><font color="#800080">;
mostrarDados(</font><font color="#008080">$sreg</font><font color="#800080">, </font><font color="#800000">&quot;&quot;</font><font color="#800080">, </font><font color="#FF0000">2</font><font color="#800080">);
</font><font color="#000080">seek</font><font color="#800080">(</font><font color="#008080">$sArq</font><font color="#800080">, </font><font color="#FF0000">0</font><font color="#800080">, </font><font color="#008080">$SEEK_SET</font><font color="#800080">);
</font><font color="#0000FF">while </font><font color="#800080">((!</font><font color="#000080">eof</font><font color="#800080">(</font><font color="#008080">$sArq</font><font color="#800080">)) &amp;&amp; (</font><font color="#008080">$bQuebra</font><font color="#800080">==</font><font color="#008080">$false</font><font color="#800080">)) {
  </font><font color="#008080">$slinha </font><font color="#800080">= &lt;</font><font color="#008080">$sArq</font><font color="#800080">&gt;;

  </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$bPesqRelativa</font><font color="#800080">==</font><font color="#008080">$true</font><font color="#800080">) {
    </font><font color="#008080">$sres </font><font color="#800080">= trim(copy(</font><font color="#008080">$slinha</font><font color="#800080">,</font><font color="#008080">$nPosChave</font><font color="#800080">,</font><font color="#008080">$nTamChave</font><font color="#800080">));
    </font><font color="#0000FF">if </font><font color="#800080">(strRelativa(</font><font color="#008080">$sres</font><font color="#800080">,</font><font color="#008080">$sChave</font><font color="#800080">)==</font><font color="#008080">$true</font><font color="#800080">) {
       </font><font color="#008080">$bAchou </font><font color="#800080">= </font><font color="#008080">$true</font><font color="#800080">;
       </font><font color="#008080">$bRet </font><font color="#800080">= </font><font color="#008080">$true</font><font color="#800080">;
    } </font><font color="#0000FF">else </font><font color="#800080">{
       </font><font color="#008080">$bAchou </font><font color="#800080">= </font><font color="#008080">$false</font><font color="#800080">;
    }   
  } </font><font color="#0000FF">else </font><font color="#800080">{
    </font><font color="#008080">$bAchou </font><font color="#800080">= </font><font color="#008080">$true</font><font color="#800080">;
    </font><font color="#008080">$bRet </font><font color="#800080">= </font><font color="#008080">$true</font><font color="#800080">;
  }

  </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$bAchou</font><font color="#800080">==</font><font color="#008080">$true</font><font color="#800080">) {
    mostrarDados(</font><font color="#008080">$sreg</font><font color="#800080">, copy(</font><font color="#008080">$slinha</font><font color="#800080">,</font><font color="#FF0000">1</font><font color="#800080">,</font><font color="#008080">$nTamLinha</font><font color="#800080">), </font><font color="#FF0000">3</font><font color="#800080">);
    </font><font color="#008080">$nCont</font><font color="#800080">++;
  }

  </font><font color="#008080">$bQuebra </font><font color="#800080">= ContinuaSN(</font><font color="#008080">$nCont</font><font color="#800080">, </font><font color="#008080">$nQtdLinha</font><font color="#800080">);
}
</font><font color="#0000FF">return </font><font color="#008080">$bRet</font><font color="#800080">;
}
</font><font color="#808080"><i>#------------------------------------------------------------------------------
# Lista v&aacute;rios registros entre arquivos de acordo com a pesquisa feita.
# sArq1 - o arquivo de liga&ccedil;&atilde;o
# sreg1 - o tipo de arquivo de liga&ccedil;&atilde;o
# nPosChave1 - a posicao inicial da primeira chave no arquivo de liga&ccedil;&atilde;o
# nTamChave1 - o tamanho da primeira chave no arquivo de liga&ccedil;&atilde;o
# nPosChave2 - a posicao inicial da segunda chave do arquivo de liga&ccedil;&atilde;o
# nTamChave2 - o tamanho da segunda chave do arquivo de liga&ccedil;&atilde;o
# sChave - a chave a ser pesquisada no arquivo de liga&ccedil;&atilde;o
# sArq2 - o arquivo a ser pesquisado
# sreg2 - o tipo de arquivo a ser pesquisado
# nPosChave3 - a posicao inicial da chave do arquivo pesquisado
# nQtdLinha - a quantidade de linhas a serem mostradas
#------------------------------------------------------------------------------
</i></font><font color="#0000FF">sub </font><font color="#800080">ListarRegLigados {
</font><font color="#0000FF">my </font><font color="#008080">$sArq1 </font><font color="#800080">= </font><font color="#FF00FF">$_</font><font color="#800080">[</font><font color="#FF0000">0</font><font color="#800080">]; </font><font color="#0000FF">my </font><font color="#008080">$sreg1 </font><font color="#800080">= </font><font color="#FF00FF">$_</font><font color="#800080">[</font><font color="#FF0000">1</font><font color="#800080">]; </font><font color="#0000FF">my </font><font color="#008080">$nPosChave1 </font><font color="#800080">= </font><font color="#FF00FF">$_</font><font color="#800080">[</font><font color="#FF0000">2</font><font color="#800080">]; 
</font><font color="#0000FF">my </font><font color="#008080">$nTamChave1 </font><font color="#800080">= </font><font color="#FF00FF">$_</font><font color="#800080">[</font><font color="#FF0000">3</font><font color="#800080">]; </font><font color="#0000FF">my </font><font color="#008080">$nPosChave2 </font><font color="#800080">= </font><font color="#FF00FF">$_</font><font color="#800080">[</font><font color="#FF0000">4</font><font color="#800080">]; </font><font color="#0000FF">my </font><font color="#008080">$nTamChave2 </font><font color="#800080">= </font><font color="#FF00FF">$_</font><font color="#800080">[</font><font color="#FF0000">5</font><font color="#800080">]; 
</font><font color="#0000FF">my </font><font color="#008080">$sChave </font><font color="#800080">= </font><font color="#FF00FF">$_</font><font color="#800080">[</font><font color="#FF0000">6</font><font color="#800080">]; </font><font color="#0000FF">my </font><font color="#008080">$sArq2 </font><font color="#800080">= </font><font color="#FF00FF">$_</font><font color="#800080">[</font><font color="#FF0000">7</font><font color="#800080">]; </font><font color="#0000FF">my </font><font color="#008080">$sreg2 </font><font color="#800080">= </font><font color="#FF00FF">$_</font><font color="#800080">[</font><font color="#FF0000">8</font><font color="#800080">]; 
</font><font color="#0000FF">my </font><font color="#008080">$nPosChave3 </font><font color="#800080">= </font><font color="#FF00FF">$_</font><font color="#800080">[</font><font color="#FF0000">9</font><font color="#800080">]; </font><font color="#0000FF">my </font><font color="#008080">$nQtdLinha </font><font color="#800080">= </font><font color="#FF00FF">$_</font><font color="#800080">[</font><font color="#FF0000">10</font><font color="#800080">];

</font><font color="#0000FF">my </font><font color="#008080">$slinha1</font><font color="#800080">; </font><font color="#0000FF">my </font><font color="#008080">$sCodigo1</font><font color="#800080">; </font><font color="#0000FF">my </font><font color="#008080">$sCodigo2</font><font color="#800080">; </font><font color="#0000FF">my </font><font color="#008080">$slinha2</font><font color="#800080">;
</font><font color="#0000FF">my </font><font color="#008080">$bRet </font><font color="#800080">= </font><font color="#008080">$false</font><font color="#800080">;
</font><font color="#0000FF">my </font><font color="#008080">$nCont </font><font color="#800080">= </font><font color="#FF0000">0</font><font color="#800080">;
</font><font color="#0000FF">my </font><font color="#008080">$bQuebra </font><font color="#800080">= </font><font color="#008080">$false</font><font color="#800080">;
mostrarDados(</font><font color="#008080">$sreg2</font><font color="#800080">, </font><font color="#800000">&quot;&quot;</font><font color="#800080">, </font><font color="#FF0000">2</font><font color="#800080">);
</font><font color="#000080">seek</font><font color="#800080">(</font><font color="#008080">$sArq1</font><font color="#800080">, </font><font color="#FF0000">0</font><font color="#800080">, </font><font color="#008080">$SEEK_SET</font><font color="#800080">);
</font><font color="#0000FF">while </font><font color="#800080">((!</font><font color="#000080">eof</font><font color="#800080">(</font><font color="#008080">$sArq1</font><font color="#800080">)) &amp;&amp; (</font><font color="#008080">$bQuebra</font><font color="#800080">==</font><font color="#008080">$false</font><font color="#800080">)) {
  </font><font color="#008080">$slinha1 </font><font color="#800080">= &lt;</font><font color="#008080">$sArq1</font><font color="#800080">&gt;;
  </font><font color="#008080">$sCodigo1 </font><font color="#800080">= trim(copy(</font><font color="#008080">$slinha1</font><font color="#800080">,</font><font color="#008080">$nPosChave1</font><font color="#800080">,</font><font color="#008080">$nTamChave1</font><font color="#800080">));
  </font><font color="#0000FF">if </font><font color="#800080">(strcmp(</font><font color="#008080">$sCodigo1</font><font color="#800080">, </font><font color="#008080">$sChave</font><font color="#800080">)==</font><font color="#008080">$true</font><font color="#800080">) {
    </font><font color="#008080">$sCodigo2 </font><font color="#800080">= trim(copy(</font><font color="#008080">$slinha1</font><font color="#800080">,</font><font color="#008080">$nPosChave2</font><font color="#800080">,</font><font color="#008080">$nTamChave2</font><font color="#800080">));
    </font><font color="#008080">$slinha2 </font><font color="#800080">= pesqArq(</font><font color="#008080">$sArq2</font><font color="#800080">, </font><font color="#008080">$sCodigo2</font><font color="#800080">, </font><font color="#008080">$nPosChave3</font><font color="#800080">, 
               </font><font color="#008080">$nTamChave2</font><font color="#800080">, tamReg(</font><font color="#008080">$sreg2</font><font color="#800080">));
    mostrarDados(</font><font color="#008080">$sreg2</font><font color="#800080">, copy(</font><font color="#008080">$slinha2</font><font color="#800080">, </font><font color="#FF0000">1</font><font color="#800080">, tamReg(</font><font color="#008080">$sreg2</font><font color="#800080">)), </font><font color="#FF0000">3</font><font color="#800080">);
    </font><font color="#008080">$bRet </font><font color="#800080">= </font><font color="#008080">$true</font><font color="#800080">;
    </font><font color="#008080">$nCont</font><font color="#800080">++;
  }
  </font><font color="#008080">$bQuebra </font><font color="#800080">= ContinuaSN(</font><font color="#008080">$nCont</font><font color="#800080">, </font><font color="#008080">$nQtdLinha</font><font color="#800080">);
}
</font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$bRet</font><font color="#800080">==</font><font color="#008080">$false</font><font color="#800080">) {
   </font><font color="#000080">print</font><font color="#800080">(rotulo(</font><font color="#008080">$sreg2</font><font color="#800080">,</font><font color="#FF0000">0</font><font color="#800080">).</font><font color="#800000">&quot;\n&quot;</font><font color="#800080">);
}
}
</font><font color="#808080"><i>#------------------------------------------------------------------------------
# Valida a entrada de registros de acordo com a pesquisa feita.
# sArq - o arquivo
# sreg - o tipo de arquivo
# nTexto - o numero do r&oacute;tulo da entrada
# sEntrada - a chave a ser pesquisada e validada
# nTentativas - o n&uacute;mero m&aacute;ximo de tentativas
# bPesqRelativa - indica se vai realizar uma pesquisa relativa
# bTipoEntrada - indica o tipo de entrada
# retorna - o registro pesquisado e validado
#------------------------------------------------------------------------------
</i></font><font color="#0000FF">sub </font><font color="#800080">validaEntrada {
</font><font color="#0000FF">my </font><font color="#008080">$sArq </font><font color="#800080">= </font><font color="#FF00FF">$_</font><font color="#800080">[</font><font color="#FF0000">0</font><font color="#800080">]; </font><font color="#0000FF">my </font><font color="#008080">$sreg </font><font color="#800080">= </font><font color="#FF00FF">$_</font><font color="#800080">[</font><font color="#FF0000">1</font><font color="#800080">]; </font><font color="#0000FF">my </font><font color="#008080">$nTexto </font><font color="#800080">= </font><font color="#FF00FF">$_</font><font color="#800080">[</font><font color="#FF0000">2</font><font color="#800080">]; </font><font color="#0000FF">my </font><font color="#008080">$sEntrada </font><font color="#800080">= </font><font color="#FF00FF">$_</font><font color="#800080">[</font><font color="#FF0000">3</font><font color="#800080">]; 
</font><font color="#0000FF">my </font><font color="#008080">$nTentativas </font><font color="#800080">= </font><font color="#FF00FF">$_</font><font color="#800080">[</font><font color="#FF0000">4</font><font color="#800080">]; </font><font color="#0000FF">my </font><font color="#008080">$bPesqRelativa </font><font color="#800080">= </font><font color="#FF00FF">$_</font><font color="#800080">[</font><font color="#FF0000">5</font><font color="#800080">]; </font><font color="#0000FF">my </font><font color="#008080">$bTipoEntrada </font><font color="#800080">= </font><font color="#FF00FF">$_</font><font color="#800080">[</font><font color="#FF0000">6</font><font color="#800080">];

</font><font color="#0000FF">my </font><font color="#008080">$sres</font><font color="#800080">;
</font><font color="#0000FF">my </font><font color="#008080">$nTamLinha </font><font color="#800080">= tamReg(</font><font color="#008080">$sreg</font><font color="#800080">);
</font><font color="#0000FF">my </font><font color="#008080">$sMsgErro </font><font color="#800080">= rotulo(</font><font color="#008080">$sreg</font><font color="#800080">,</font><font color="#FF0000">0</font><font color="#800080">);
</font><font color="#0000FF">my </font><font color="#008080">$sTexto </font><font color="#800080">= rotulo(</font><font color="#008080">$sreg</font><font color="#800080">,</font><font color="#008080">$nTexto</font><font color="#800080">);
</font><font color="#0000FF">my </font><font color="#008080">$nPosChave </font><font color="#800080">= </font><font color="#008080">$g_nPosChave</font><font color="#800080">;
</font><font color="#0000FF">my </font><font color="#008080">$nTamChave </font><font color="#800080">= </font><font color="#008080">$g_nTamChave</font><font color="#800080">;

</font><font color="#0000FF">my </font><font color="#008080">$ncont </font><font color="#800080">= </font><font color="#FF0000">1</font><font color="#800080">;
</font><font color="#0000FF">my </font><font color="#008080">$bQuebra </font><font color="#800080">= </font><font color="#008080">$false</font><font color="#800080">;
  </font><font color="#0000FF">while </font><font color="#800080">((</font><font color="#008080">$bQuebra</font><font color="#800080">==</font><font color="#008080">$false</font><font color="#800080">) &amp;&amp; (</font><font color="#008080">$ncont </font><font color="#800080">&lt;= </font><font color="#008080">$nTentativas </font><font color="#800080">)) {
    </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$bTipoEntrada</font><font color="#800080">==</font><font color="#008080">$opTexto</font><font color="#800080">) {
      </font><font color="#000080">print</font><font color="#800080">(</font><font color="#008080">$sTexto</font><font color="#800080">);
      </font><font color="#008080">$sEntrada </font><font color="#800080">= digita();
    } </font><font color="#0000FF">elsif </font><font color="#800080">(</font><font color="#008080">$bTipoEntrada</font><font color="#800080">==</font><font color="#008080">$opNumero</font><font color="#800080">) {
       </font><font color="#008080">$sEntrada </font><font color="#800080">= validaNumero(</font><font color="#008080">$sTexto</font><font color="#800080">,</font><font color="#008080">$sEntrada</font><font color="#800080">);
    } </font><font color="#0000FF">elsif </font><font color="#800080">(</font><font color="#008080">$bTipoEntrada</font><font color="#800080">==</font><font color="#008080">$opData</font><font color="#800080">) {
       </font><font color="#008080">$sEntrada </font><font color="#800080">= validaDataHora(</font><font color="#008080">$sTexto</font><font color="#800080">,</font><font color="#008080">$sEntrada</font><font color="#800080">,</font><font color="#008080">$true</font><font color="#800080">);
    } </font><font color="#0000FF">elsif </font><font color="#800080">(</font><font color="#008080">$bTipoEntrada</font><font color="#800080">==</font><font color="#008080">$opDataHora</font><font color="#800080">) {
       </font><font color="#008080">$sEntrada </font><font color="#800080">= validaDataHora(</font><font color="#008080">$sTexto</font><font color="#800080">,</font><font color="#008080">$sEntrada</font><font color="#800080">,</font><font color="#008080">$false</font><font color="#800080">);
    } </font><font color="#0000FF">elsif </font><font color="#800080">(</font><font color="#008080">$bTipoEntrada</font><font color="#800080">==</font><font color="#008080">$opSenha</font><font color="#800080">) {
       </font><font color="#008080">$sEntrada </font><font color="#800080">= digitaSenha(</font><font color="#008080">$sTexto</font><font color="#800080">, </font><font color="#FF0000">10</font><font color="#800080">);
    }

    </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$bPesqRelativa</font><font color="#800080">==</font><font color="#008080">$true</font><font color="#800080">) {
       </font><font color="#0000FF">if </font><font color="#800080">(ListarTodos(</font><font color="#008080">$sArq</font><font color="#800080">, </font><font color="#008080">$sreg</font><font color="#800080">, </font><font color="#008080">$sEntrada</font><font color="#800080">, </font><font color="#008080">$nPosChave</font><font color="#800080">, </font><font color="#008080">$nTamChave</font><font color="#800080">, </font><font color="#008080">$nTamLinha</font><font color="#800080">,
           </font><font color="#008080">$QTD_MAX_LINHA</font><font color="#800080">, </font><font color="#008080">$true</font><font color="#800080">)) {
         </font><font color="#008080">$sres </font><font color="#800080">= </font><font color="#800000">&quot; &quot;</font><font color="#800080">;
       }  
    } </font><font color="#0000FF">else </font><font color="#800080">{
       </font><font color="#008080">$sres </font><font color="#800080">= pesqArq(</font><font color="#008080">$sArq</font><font color="#800080">, </font><font color="#008080">$sEntrada</font><font color="#800080">, </font><font color="#008080">$nPosChave</font><font color="#800080">, </font><font color="#008080">$nTamChave</font><font color="#800080">, </font><font color="#008080">$nTamLinha</font><font color="#800080">);
    }
    </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#000080">length</font><font color="#800080">(</font><font color="#008080">$sres</font><font color="#800080">) == </font><font color="#FF0000">0</font><font color="#800080">) {
       </font><font color="#000080">print</font><font color="#800080">(</font><font color="#008080">$sMsgErro</font><font color="#800080">.</font><font color="#800000">&quot;\n&quot;</font><font color="#800080">);
    } </font><font color="#0000FF">else </font><font color="#800080">{
       </font><font color="#008080">$bQuebra </font><font color="#800080">= </font><font color="#008080">$true</font><font color="#800080">;
    }
    </font><font color="#008080">$ncont</font><font color="#800080">++;
  }
</font><font color="#0000FF">return </font><font color="#008080">$sres</font><font color="#800080">;
}
</font><font color="#808080"><i>#------------------------------------------------------------------------------
# Mostra a tela de splash do sistema.
#------------------------------------------------------------------------------
</i></font><font color="#0000FF">sub </font><font color="#800080">frmSplash {
</font><font color="#0000FF">my </font><font color="#008080">$cont</font><font color="#800080">;

 </font><font color="#000080">print</font><font color="#800080">(</font><font color="#800000">&quot;*---------------------------------------&quot;</font><font color="#800080">.
 </font><font color="#800000">&quot;-------------------------------------*\n&quot;</font><font color="#800080">);
 </font><font color="#000080">print</font><font color="#800080">(</font><font color="#800000">&quot;| LL    II VV   VV RRRRR  UU  UU   SSSS &quot;</font><font color="#800080">.
 </font><font color="#800000">&quot;VV   VV II RRRRR  TTTT UU  UU   SSSS |\n&quot;</font><font color="#800080">);
 </font><font color="#000080">print</font><font color="#800080">(</font><font color="#800000">&quot;| LL    II  VV VV  RR   R UU  UU  SS    &quot;</font><font color="#800080">.
 </font><font color="#800000">&quot; VV VV  II RR   R  TT  UU  UU  SS    |\n&quot;</font><font color="#800080">);
 </font><font color="#000080">print</font><font color="#800080">(</font><font color="#800000">&quot;| LL    II   VVV   RRRRR  UU  UU    SS  &quot;</font><font color="#800080">.
 </font><font color="#800000">&quot;  VVV   II RRRRR   TT  UU  UU    SS  |\n&quot;</font><font color="#800080">);
 </font><font color="#000080">print</font><font color="#800080">(</font><font color="#800000">&quot;| LLLLL II    V    RR   R  UUUU  SSSS   &quot;</font><font color="#800080">.
 </font><font color="#800000">&quot;   V    II RR   R  TT   UUUU  SSSS   |\n&quot;</font><font color="#800080">);
 </font><font color="#000080">print</font><font color="#800080">(</font><font color="#800000">&quot;*---------------------------------------&quot;</font><font color="#800080">.
 </font><font color="#800000">&quot;-------------------------------------*\n&quot;</font><font color="#800080">);
 </font><font color="#0000FF">for</font><font color="#800080">(</font><font color="#008080">$cont </font><font color="#800080">= </font><font color="#FF0000">1</font><font color="#800080">; </font><font color="#008080">$cont </font><font color="#800080">&lt;= </font><font color="#FF0000">18</font><font color="#800080">; </font><font color="#008080">$cont</font><font color="#800080">++) { </font><font color="#000080">print</font><font color="#800080">(</font><font color="#800000">&quot;\n&quot;</font><font color="#800080">); }
 </font><font color="#000080">print</font><font color="#800080">(</font><font color="#008080">$MSG_PRESS</font><font color="#800080">);
 </font><font color="#008080">$cont </font><font color="#800080">= digita();
}
</font><font color="#808080"><i>#------------------------------------------------------------------------------
# Mostra a tela de sobre do sistema.
#------------------------------------------------------------------------------
</i></font><font color="#0000FF">sub </font><font color="#800080">frmSobre {
</font><font color="#0000FF">my </font><font color="#008080">$cont</font><font color="#800080">;

</font><font color="#0000FF">my </font><font color="#008080">$tela </font><font color="#800080">= </font><font color="#800000">&lt;&lt;'FRMSOBRE'</font><font color="#800080">;
</font><font color="#800000">*------------------------------------------------------------*
|  LL        II  VV       VV  RRRRRRR   UU    UU   SSSSSSS   |
|  LL        II   VV     VV   RR     R  UU    UU  SS         |
|  LL        II    VV   VV    RR     R  UU    UU   SSSS      |
|  LL        II     VV VV     RRRRRRR   UU    UU     SSSS    |
|  LLLL      II      VVV      RR RR     UU    UU        SS   |
|  LLLLLLLL  II       V       RR   RR    UUUUUU   SSSSSSSS   |
|                                                            |
|  VV       VV  II  RRRRRRR   TTTTTTTT  UU    UU   SSSSSSS   |
|   VV     VV   II  RR     R     TT     UU    UU  SS         |
|    VV   VV    II  RR     R     TT     UU    UU   SSSS      |
|     VV VV     II  RRRRRRR      TT     UU    UU     SSSS    |
|      VVV      II  RR RR        TT     UU    UU        SS   |
|       V       II  RR   RR      TT      UUUUUU   SSSSSSSS   |
|                                                            |
|                                               Versao 1.0.0 |
| Sistema integrante do projeto Livrus Virtus.               |
| Todos os direitos reservados para Henrique F. de Souza.    |
| Versao programada na linguagem Perl.                       |
*------------------------------------------------------------*
FRMSOBRE
 </font><font color="#000080">print </font><font color="#008080">$tela</font><font color="#800080">;
 </font><font color="#0000FF">for</font><font color="#800080">(</font><font color="#008080">$cont </font><font color="#800080">= </font><font color="#FF0000">1</font><font color="#800080">; </font><font color="#008080">$cont </font><font color="#800080">&lt;= </font><font color="#FF0000">4</font><font color="#800080">; </font><font color="#008080">$cont</font><font color="#800080">++) { </font><font color="#000080">print</font><font color="#800080">(</font><font color="#800000">&quot;\n&quot;</font><font color="#800080">); }
 </font><font color="#000080">print</font><font color="#800080">(</font><font color="#008080">$MSG_PRESS</font><font color="#800080">);
 </font><font color="#008080">$cont </font><font color="#800080">= digita();
}
</font><font color="#808080"><i>#-----------------------------------------------------------------------------
# Mostra a tela de login do sistema.
# retorna - se o login foi validado corretamente
#------------------------------------------------------------------------------
</i></font><font color="#0000FF">sub </font><font color="#800080">frmLogin {
</font><font color="#0000FF">my </font><font color="#008080">$bret</font><font color="#800080">;
</font><font color="#0000FF">my </font><font color="#008080">$slinha</font><font color="#800080">;

  </font><font color="#008080">$bret </font><font color="#800080">= </font><font color="#008080">$false</font><font color="#800080">;
  </font><font color="#000080">print</font><font color="#800080">(</font><font color="#800000">&quot;*--------------------------------------------------------------*\n&quot;</font><font color="#800080">);
  </font><font color="#000080">print</font><font color="#800080">(</font><font color="#800000">&quot;| Login do sistema                                             |\n&quot;</font><font color="#800080">);
  </font><font color="#000080">print</font><font color="#800080">(</font><font color="#800000">&quot;*--------------------------------------------------------------*\n&quot;</font><font color="#800080">);
  </font><font color="#008080">$slinha </font><font color="#800080">= validaEntrada(tfUsuario, </font><font color="#008080">$opUsuario</font><font color="#800080">, </font><font color="#FF0000">1</font><font color="#800080">, </font><font color="#008080">$tUsuario</font><font color="#800080">{</font><font color="#800000">&quot;login&quot;</font><font color="#800080">}, </font><font color="#FF0000">3</font><font color="#800080">,
        </font><font color="#008080">$false</font><font color="#800080">, </font><font color="#008080">$opTexto</font><font color="#800080">);
  </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#000080">length</font><font color="#800080">(</font><font color="#008080">$slinha</font><font color="#800080">) &gt; </font><font color="#FF0000">0</font><font color="#800080">) {
     </font><font color="#008080">$slinha </font><font color="#800080">= validaEntrada(tfUsuario, </font><font color="#008080">$opUsuario</font><font color="#800080">, </font><font color="#FF0000">2</font><font color="#800080">, </font><font color="#008080">$tUsuario</font><font color="#800080">{</font><font color="#800000">&quot;senha&quot;</font><font color="#800080">}, </font><font color="#FF0000">3</font><font color="#800080">,
        </font><font color="#008080">$false</font><font color="#800080">, </font><font color="#008080">$opSenha</font><font color="#800080">);
     </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#000080">length</font><font color="#800080">(</font><font color="#008080">$slinha</font><font color="#800080">) &gt; </font><font color="#FF0000">0</font><font color="#800080">) {
        </font><font color="#008080">$tUsuario</font><font color="#800080">{</font><font color="#800000">&quot;login&quot;</font><font color="#800080">} = trim(copy(</font><font color="#008080">$slinha</font><font color="#800080">, </font><font color="#FF0000">1</font><font color="#800080">, </font><font color="#FF0000">10</font><font color="#800080">));
        </font><font color="#008080">$tUsuario</font><font color="#800080">{</font><font color="#800000">&quot;senha&quot;</font><font color="#800080">} = trim(copy(</font><font color="#008080">$slinha</font><font color="#800080">, </font><font color="#FF0000">11</font><font color="#800080">, </font><font color="#FF0000">10</font><font color="#800080">));
        </font><font color="#008080">$bret </font><font color="#800080">= </font><font color="#008080">$true</font><font color="#800080">;
     }
  }
  </font><font color="#000080">print</font><font color="#800080">(</font><font color="#800000">&quot;\n&quot;</font><font color="#800080">);
  </font><font color="#0000FF">return </font><font color="#008080">$bret</font><font color="#800080">;
}
</font><font color="#808080"><i>#------------------------------------------------------------------------------
# Mostra os menus do sistema.
# num - o n&uacute;mero do menu
#------------------------------------------------------------------------------
</i></font><font color="#0000FF">sub </font><font color="#800080">menu {
</font><font color="#0000FF">my </font><font color="#008080">$num </font><font color="#800080">= </font><font color="#000080">shift</font><font color="#800080">();
</font><font color="#0000FF">my </font><font color="#008080">$tela</font><font color="#800080">;

 </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$num</font><font color="#800080">==</font><font color="#FF0000">1</font><font color="#800080">) {
   </font><font color="#000080">print</font><font color="#800080">(</font><font color="#800000">&quot;*--------------------------------------------------------------*\n&quot;</font><font color="#800080">);
   </font><font color="#000080">print</font><font color="#800080">(</font><font color="#800000">&quot;| (C)adastros        (P)esquisas     (V)endas        (O)p&ccedil;&otilde;es  |\n&quot;</font><font color="#800080">);
   </font><font color="#000080">print</font><font color="#800080">(</font><font color="#800000">&quot;*--------------------------------------------------------------*\n&quot;</font><font color="#800080">);
 } </font><font color="#0000FF">elsif </font><font color="#800080">(</font><font color="#008080">$num</font><font color="#800080">==</font><font color="#FF0000">2</font><font color="#800080">) {
   </font><font color="#000080">print</font><font color="#800080">(</font><font color="#800000">&quot;*---------------------------------*\n&quot;</font><font color="#800080">);
   </font><font color="#000080">print</font><font color="#800080">(</font><font color="#800000">&quot;| 01. Cadastro de Assuntos        |\n&quot;</font><font color="#800080">);
   </font><font color="#000080">print</font><font color="#800080">(</font><font color="#800000">&quot;| 02. Cadastro de Autores         |\n&quot;</font><font color="#800080">);
   </font><font color="#000080">print</font><font color="#800080">(</font><font color="#800000">&quot;| 03. Cadastro de Editoras        |\n&quot;</font><font color="#800080">);
   </font><font color="#000080">print</font><font color="#800080">(</font><font color="#800000">&quot;| 04. Cadastro de Endere&ccedil;os       |\n&quot;</font><font color="#800080">);
   </font><font color="#000080">print</font><font color="#800080">(</font><font color="#800000">&quot;| 05. Cadastro de Idiomas         |\n&quot;</font><font color="#800080">);
   </font><font color="#000080">print</font><font color="#800080">(</font><font color="#800000">&quot;| 06. Cadastro de Pa&iacute;ses          |\n&quot;</font><font color="#800080">);
   </font><font color="#000080">print</font><font color="#800080">(</font><font color="#800000">&quot;| 07. Cadastro de Profiss&otilde;es      |\n&quot;</font><font color="#800080">);
   </font><font color="#000080">print</font><font color="#800080">(</font><font color="#800000">&quot;| 08. Cadastro de Clientes        |\n&quot;</font><font color="#800080">);
   </font><font color="#000080">print</font><font color="#800080">(</font><font color="#800000">&quot;| 09. Cadastro de Livros          |\n&quot;</font><font color="#800080">);
   </font><font color="#000080">print</font><font color="#800080">(</font><font color="#800000">&quot;| 10. Voltar ao menu              |\n&quot;</font><font color="#800080">);
   </font><font color="#000080">print</font><font color="#800080">(</font><font color="#800000">&quot;*---------------------------------*\n&quot;</font><font color="#800080">);
 } </font><font color="#0000FF">elsif </font><font color="#800080">(</font><font color="#008080">$num</font><font color="#800080">==</font><font color="#FF0000">3</font><font color="#800080">) {
   </font><font color="#000080">print</font><font color="#800080">(</font><font color="#800000">&quot;*---------------------------------*\n&quot;</font><font color="#800080">);
   </font><font color="#000080">print</font><font color="#800080">(</font><font color="#800000">&quot;| 01. Consulta de Assuntos        |\n&quot;</font><font color="#800080">);
   </font><font color="#000080">print</font><font color="#800080">(</font><font color="#800000">&quot;| 02. Consulta de Autores         |\n&quot;</font><font color="#800080">);
   </font><font color="#000080">print</font><font color="#800080">(</font><font color="#800000">&quot;| 03. Consulta de Editoras        |\n&quot;</font><font color="#800080">);
   </font><font color="#000080">print</font><font color="#800080">(</font><font color="#800000">&quot;| 04. Consulta de Endere&ccedil;os       |\n&quot;</font><font color="#800080">);
   </font><font color="#000080">print</font><font color="#800080">(</font><font color="#800000">&quot;| 05. Consulta de Idiomas         |\n&quot;</font><font color="#800080">);
   </font><font color="#000080">print</font><font color="#800080">(</font><font color="#800000">&quot;| 06. Consulta de Pa&iacute;ses          |\n&quot;</font><font color="#800080">);
   </font><font color="#000080">print</font><font color="#800080">(</font><font color="#800000">&quot;| 07. Consulta de Profiss&otilde;es      |\n&quot;</font><font color="#800080">);
   </font><font color="#000080">print</font><font color="#800080">(</font><font color="#800000">&quot;| 08. Consulta de Clientes        |\n&quot;</font><font color="#800080">);
   </font><font color="#000080">print</font><font color="#800080">(</font><font color="#800000">&quot;| 09. Consulta de Livros          |\n&quot;</font><font color="#800080">);
   </font><font color="#000080">print</font><font color="#800080">(</font><font color="#800000">&quot;| 10. Voltar ao menu              |\n&quot;</font><font color="#800080">);
   </font><font color="#000080">print</font><font color="#800080">(</font><font color="#800000">&quot;*---------------------------------*\n&quot;</font><font color="#800080">);
 } </font><font color="#0000FF">elsif </font><font color="#800080">(</font><font color="#008080">$num</font><font color="#800080">==</font><font color="#FF0000">4</font><font color="#800080">) {
   </font><font color="#000080">print</font><font color="#800080">(</font><font color="#800000">&quot;*---------------------------------*\n&quot;</font><font color="#800080">);
   </font><font color="#000080">print</font><font color="#800080">(</font><font color="#800000">&quot;| 01. Vender Livros               |\n&quot;</font><font color="#800080">);
   </font><font color="#000080">print</font><font color="#800080">(</font><font color="#800000">&quot;| 02. Vendas Realizadas           |\n&quot;</font><font color="#800080">);
   </font><font color="#000080">print</font><font color="#800080">(</font><font color="#800000">&quot;| 03. Voltar ao menu              |\n&quot;</font><font color="#800080">);
   </font><font color="#000080">print</font><font color="#800080">(</font><font color="#800000">&quot;*---------------------------------*\n&quot;</font><font color="#800080">);
 } </font><font color="#0000FF">elsif </font><font color="#800080">(</font><font color="#008080">$num</font><font color="#800080">==</font><font color="#FF0000">5</font><font color="#800080">) {
   </font><font color="#000080">print</font><font color="#800080">(</font><font color="#800000">&quot;*---------------------------------*\n&quot;</font><font color="#800080">);
   </font><font color="#000080">print</font><font color="#800080">(</font><font color="#800000">&quot;| 01. Alterar senha               |\n&quot;</font><font color="#800080">);
   </font><font color="#000080">print</font><font color="#800080">(</font><font color="#800000">&quot;| 02. Sobre o sistema             |\n&quot;</font><font color="#800080">);
   </font><font color="#000080">print</font><font color="#800080">(</font><font color="#800000">&quot;| 03. Sair do sistema             |\n&quot;</font><font color="#800080">);
   </font><font color="#000080">print</font><font color="#800080">(</font><font color="#800000">&quot;| 04. Voltar ao menu              |\n&quot;</font><font color="#800080">);
   </font><font color="#000080">print</font><font color="#800080">(</font><font color="#800000">&quot;*---------------------------------*\n&quot;</font><font color="#800080">);
 } </font><font color="#0000FF">elsif </font><font color="#800080">(</font><font color="#008080">$num</font><font color="#800080">==</font><font color="#FF0000">6</font><font color="#800080">) {
   </font><font color="#000080">print</font><font color="#800080">(</font><font color="#800000">&quot;*--------------------------------------------------------------*\n&quot;</font><font color="#800080">);
   </font><font color="#000080">print</font><font color="#800080">(</font><font color="#800000">&quot;| (1) Novo  (2) Pesquisar   (3) Voltar ao menu                 |\n&quot;</font><font color="#800080">);
   </font><font color="#000080">print</font><font color="#800080">(</font><font color="#800000">&quot;*--------------------------------------------------------------*\n&quot;</font><font color="#800080">);
 } </font><font color="#0000FF">elsif </font><font color="#800080">(</font><font color="#008080">$num</font><font color="#800080">==</font><font color="#FF0000">7</font><font color="#800080">) {
   </font><font color="#000080">print</font><font color="#800080">(</font><font color="#800000">&quot;*--------------------------------------------------------------*\n&quot;</font><font color="#800080">);
   </font><font color="#000080">print</font><font color="#800080">(</font><font color="#800000">&quot;| (1) Salvar inclus&atilde;o       (2) Voltar ao menu                 |\n&quot;</font><font color="#800080">);
   </font><font color="#000080">print</font><font color="#800080">(</font><font color="#800000">&quot;*--------------------------------------------------------------*\n&quot;</font><font color="#800080">);
 } </font><font color="#0000FF">elsif </font><font color="#800080">(</font><font color="#008080">$num</font><font color="#800080">==</font><font color="#FF0000">8</font><font color="#800080">) {
   </font><font color="#000080">print</font><font color="#800080">(</font><font color="#800000">&quot;*--------------------------------------------------------------*\n&quot;</font><font color="#800080">);
   </font><font color="#000080">print</font><font color="#800080">(</font><font color="#800000">&quot;| (1) Alterar       (2) Excluir     (3) Voltar ao menu         |\n&quot;</font><font color="#800080">);
   </font><font color="#000080">print</font><font color="#800080">(</font><font color="#800000">&quot;*--------------------------------------------------------------*\n&quot;</font><font color="#800080">);
 } </font><font color="#0000FF">elsif </font><font color="#800080">(</font><font color="#008080">$num</font><font color="#800080">==</font><font color="#FF0000">9</font><font color="#800080">) {
   </font><font color="#000080">print</font><font color="#800080">(</font><font color="#800000">&quot;*--------------------------------------------------------------*\n&quot;</font><font color="#800080">);
   </font><font color="#000080">print</font><font color="#800080">(</font><font color="#800000">&quot;| (1) Salvar altera&ccedil;&atilde;o      (2) Voltar ao menu                 |\n&quot;</font><font color="#800080">);
   </font><font color="#000080">print</font><font color="#800080">(</font><font color="#800000">&quot;*--------------------------------------------------------------*\n&quot;</font><font color="#800080">);
 } </font><font color="#0000FF">elsif </font><font color="#800080">(</font><font color="#008080">$num</font><font color="#800080">==</font><font color="#FF0000">10</font><font color="#800080">) {
   </font><font color="#000080">print</font><font color="#800080">(</font><font color="#800000">&quot;*--------------------------------------------------------------*\n&quot;</font><font color="#800080">);
   </font><font color="#000080">print</font><font color="#800080">(</font><font color="#800000">&quot;| Certeza de excluir? (S/N)                                    |\n&quot;</font><font color="#800080">);
   </font><font color="#000080">print</font><font color="#800080">(</font><font color="#800000">&quot;*--------------------------------------------------------------*\n&quot;</font><font color="#800080">);
 } </font><font color="#0000FF">elsif </font><font color="#800080">(</font><font color="#008080">$num</font><font color="#800080">==</font><font color="#FF0000">11</font><font color="#800080">) {
   </font><font color="#000080">print</font><font color="#800080">(</font><font color="#800000">&quot;*--------------------------------------------------------------*\n&quot;</font><font color="#800080">);
   </font><font color="#000080">print</font><font color="#800080">(</font><font color="#800000">&quot;| Deseja sair do sistema? (S/N)                                |\n&quot;</font><font color="#800080">);
   </font><font color="#000080">print</font><font color="#800080">(</font><font color="#800000">&quot;*--------------------------------------------------------------*\n&quot;</font><font color="#800080">);
 } </font><font color="#0000FF">elsif </font><font color="#800080">(</font><font color="#008080">$num</font><font color="#800080">==</font><font color="#FF0000">12</font><font color="#800080">) {
   </font><font color="#000080">print</font><font color="#800080">(</font><font color="#800000">&quot;*--------------------------------------------------------------*\n&quot;</font><font color="#800080">);
   </font><font color="#000080">print</font><font color="#800080">(</font><font color="#800000">&quot;| (1) Pesquisar  (2) Listar todos   (3) Voltar ao menu         |\n&quot;</font><font color="#800080">);
   </font><font color="#000080">print</font><font color="#800080">(</font><font color="#800000">&quot;*--------------------------------------------------------------*\n&quot;</font><font color="#800080">);
 } </font><font color="#0000FF">elsif </font><font color="#800080">(</font><font color="#008080">$num</font><font color="#800080">==</font><font color="#FF0000">13</font><font color="#800080">) {
   </font><font color="#000080">print</font><font color="#800080">(</font><font color="#800000">&quot;*--------------------------------------------------------------*\n&quot;</font><font color="#800080">);
   </font><font color="#000080">print</font><font color="#800080">(</font><font color="#800000">&quot;| Deseja continuar? (S/N)                                      |\n&quot;</font><font color="#800080">);
   </font><font color="#000080">print</font><font color="#800080">(</font><font color="#800000">&quot;*--------------------------------------------------------------*\n&quot;</font><font color="#800080">);
 } </font><font color="#0000FF">elsif </font><font color="#800080">(</font><font color="#008080">$num</font><font color="#800080">==</font><font color="#FF0000">14</font><font color="#800080">) {
   </font><font color="#000080">print</font><font color="#800080">(</font><font color="#800000">&quot;*--------------------------------------------------------------*\n&quot;</font><font color="#800080">);
   </font><font color="#000080">print</font><font color="#800080">(</font><font color="#800000">&quot;| Salvar inclus&atilde;o (S/N)                                        |\n&quot;</font><font color="#800080">);
   </font><font color="#000080">print</font><font color="#800080">(</font><font color="#800000">&quot;*--------------------------------------------------------------*\n&quot;</font><font color="#800080">);
 }
 </font><font color="#000080">print</font><font color="#800080">(</font><font color="#008080">$MSG_OPCAO</font><font color="#800080">);
}
</font><font color="#808080"><i>#------------------------------------------------------------------------------
# Realiza os cadastros de acordo com o tipo de arquivo.
# sreg - o tipo de arquivo
# sacao - a a&ccedil;&atilde;o a ser realizada
#------------------------------------------------------------------------------
</i></font><font color="#0000FF">sub </font><font color="#800080">frmCadastros { 
</font><font color="#0000FF">my </font><font color="#008080">$sreg </font><font color="#800080">= </font><font color="#FF00FF">$_</font><font color="#800080">[</font><font color="#FF0000">0</font><font color="#800080">];
</font><font color="#0000FF">my </font><font color="#008080">$sacao </font><font color="#800080">= </font><font color="#FF00FF">$_</font><font color="#800080">[</font><font color="#FF0000">1</font><font color="#800080">];
</font><font color="#0000FF">my </font><font color="#008080">$slinha</font><font color="#800080">;

</font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$sreg</font><font color="#800080">==</font><font color="#008080">$opAssunto</font><font color="#800080">) {
   </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$sacao</font><font color="#800080">==</font><font color="#008080">$opNovo</font><font color="#800080">) {
      </font><font color="#008080">$tAssunto</font><font color="#800080">{</font><font color="#800000">&quot;codigo&quot;</font><font color="#800080">} = pesqMaxCod(tfAssunto, </font><font color="#FF0000">1</font><font color="#800080">, </font><font color="#FF0000">10</font><font color="#800080">, tamReg(</font><font color="#008080">$sreg</font><font color="#800080">));
      mostrarDados(</font><font color="#008080">$sreg</font><font color="#800080">, </font><font color="#800000">&quot;&quot;</font><font color="#800080">, </font><font color="#FF0000">1</font><font color="#800080">);
      subMenu(</font><font color="#FF0000">7</font><font color="#800080">, </font><font color="#008080">$sreg</font><font color="#800080">);
   } </font><font color="#0000FF">elsif </font><font color="#800080">(</font><font color="#008080">$sacao</font><font color="#800080">==</font><font color="#008080">$opPesquisar</font><font color="#800080">) {
     </font><font color="#008080">$slinha </font><font color="#800080">= validaEntrada(tfAssunto,</font><font color="#008080">$sreg</font><font color="#800080">,</font><font color="#FF0000">1</font><font color="#800080">,</font><font color="#008080">$tAssunto</font><font color="#800080">{</font><font color="#800000">&quot;codigo&quot;</font><font color="#800080">},</font><font color="#FF0000">1</font><font color="#800080">,</font><font color="#008080">$false</font><font color="#800080">,</font><font color="#008080">$opNumero</font><font color="#800080">);
      </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#000080">length</font><font color="#800080">(</font><font color="#008080">$slinha</font><font color="#800080">) &gt; </font><font color="#FF0000">0</font><font color="#800080">) {
        mostrarDados(</font><font color="#008080">$sreg</font><font color="#800080">, </font><font color="#800000">&quot;&quot;</font><font color="#800080">, </font><font color="#FF0000">2</font><font color="#800080">);
        mostrarDados(</font><font color="#008080">$sreg</font><font color="#800080">, </font><font color="#008080">$slinha</font><font color="#800080">, </font><font color="#FF0000">3</font><font color="#800080">);
        subMenu(</font><font color="#FF0000">8</font><font color="#800080">, </font><font color="#008080">$sreg</font><font color="#800080">);
      }
   } </font><font color="#0000FF">elsif </font><font color="#800080">(</font><font color="#008080">$sacao</font><font color="#800080">==</font><font color="#008080">$opAlterar</font><font color="#800080">) {
      mostrarDados(</font><font color="#008080">$sreg</font><font color="#800080">, </font><font color="#800000">&quot;&quot;</font><font color="#800080">, </font><font color="#FF0000">1</font><font color="#800080">);
      subMenu(</font><font color="#FF0000">9</font><font color="#800080">, </font><font color="#008080">$sreg</font><font color="#800080">);
   } </font><font color="#0000FF">elsif </font><font color="#800080">(</font><font color="#008080">$sacao</font><font color="#800080">==</font><font color="#008080">$opExcluir</font><font color="#800080">) {
      subMenu(</font><font color="#FF0000">10</font><font color="#800080">, </font><font color="#008080">$sreg</font><font color="#800080">);
   }
} </font><font color="#0000FF">elsif </font><font color="#800080">(</font><font color="#008080">$sreg</font><font color="#800080">==</font><font color="#008080">$opAutor</font><font color="#800080">) {
   </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$sacao</font><font color="#800080">==</font><font color="#008080">$opNovo</font><font color="#800080">) {
      </font><font color="#008080">$tAutor</font><font color="#800080">{</font><font color="#800000">&quot;codigo&quot;</font><font color="#800080">} = pesqMaxCod(tfAutor, </font><font color="#FF0000">1</font><font color="#800080">, </font><font color="#FF0000">10</font><font color="#800080">, tamReg(</font><font color="#008080">$sreg</font><font color="#800080">));
      mostrarDados(</font><font color="#008080">$sreg</font><font color="#800080">, </font><font color="#800000">&quot;&quot;</font><font color="#800080">, </font><font color="#FF0000">1</font><font color="#800080">);
      subMenu(</font><font color="#FF0000">7</font><font color="#800080">, </font><font color="#008080">$sreg</font><font color="#800080">);
   } </font><font color="#0000FF">elsif </font><font color="#800080">(</font><font color="#008080">$sacao</font><font color="#800080">==</font><font color="#008080">$opPesquisar</font><font color="#800080">) {
      </font><font color="#008080">$slinha </font><font color="#800080">= validaEntrada(tfAutor, </font><font color="#008080">$sreg</font><font color="#800080">, </font><font color="#FF0000">1</font><font color="#800080">, </font><font color="#008080">$tAutor</font><font color="#800080">{</font><font color="#800000">&quot;codigo&quot;</font><font color="#800080">},</font><font color="#FF0000">1</font><font color="#800080">,</font><font color="#008080">$false</font><font color="#800080">,</font><font color="#008080">$opNumero</font><font color="#800080">);
      </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#000080">length</font><font color="#800080">(</font><font color="#008080">$slinha</font><font color="#800080">) &gt; </font><font color="#FF0000">0</font><font color="#800080">) {
        mostrarDados(</font><font color="#008080">$sreg</font><font color="#800080">, </font><font color="#800000">&quot;&quot;</font><font color="#800080">, </font><font color="#FF0000">2</font><font color="#800080">);
        mostrarDados(</font><font color="#008080">$sreg</font><font color="#800080">, </font><font color="#008080">$slinha</font><font color="#800080">, </font><font color="#FF0000">3</font><font color="#800080">);
        subMenu(</font><font color="#FF0000">8</font><font color="#800080">, </font><font color="#008080">$sreg</font><font color="#800080">);
      }
   } </font><font color="#0000FF">elsif </font><font color="#800080">(</font><font color="#008080">$sacao</font><font color="#800080">==</font><font color="#008080">$opAlterar</font><font color="#800080">) {
      mostrarDados(</font><font color="#008080">$sreg</font><font color="#800080">, </font><font color="#800000">&quot;&quot;</font><font color="#800080">, </font><font color="#FF0000">1</font><font color="#800080">);
      subMenu(</font><font color="#FF0000">9</font><font color="#800080">, </font><font color="#008080">$sreg</font><font color="#800080">);
   } </font><font color="#0000FF">elsif </font><font color="#800080">(</font><font color="#008080">$sacao</font><font color="#800080">==</font><font color="#008080">$opExcluir</font><font color="#800080">) {
      subMenu(</font><font color="#FF0000">10</font><font color="#800080">, </font><font color="#008080">$sreg</font><font color="#800080">);
   }
} </font><font color="#0000FF">elsif </font><font color="#800080">(</font><font color="#008080">$sreg</font><font color="#800080">==</font><font color="#008080">$opEditora</font><font color="#800080">) {
   </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$sacao</font><font color="#800080">==</font><font color="#008080">$opNovo</font><font color="#800080">) {
      </font><font color="#008080">$tEditora</font><font color="#800080">{</font><font color="#800000">&quot;codigo&quot;</font><font color="#800080">} = pesqMaxCod(tfEditora, </font><font color="#FF0000">1</font><font color="#800080">, </font><font color="#FF0000">10</font><font color="#800080">, tamReg(</font><font color="#008080">$sreg</font><font color="#800080">));
      mostrarDados(</font><font color="#008080">$sreg</font><font color="#800080">, </font><font color="#800000">&quot;&quot;</font><font color="#800080">, </font><font color="#FF0000">1</font><font color="#800080">);
      subMenu(</font><font color="#FF0000">7</font><font color="#800080">, </font><font color="#008080">$sreg</font><font color="#800080">);
   } </font><font color="#0000FF">elsif </font><font color="#800080">(</font><font color="#008080">$sacao</font><font color="#800080">==</font><font color="#008080">$opPesquisar</font><font color="#800080">) {
      </font><font color="#008080">$slinha </font><font color="#800080">= validaEntrada(tfEditora,</font><font color="#008080">$sreg</font><font color="#800080">,</font><font color="#FF0000">1</font><font color="#800080">,</font><font color="#008080">$tEditora</font><font color="#800080">{</font><font color="#800000">&quot;codigo&quot;</font><font color="#800080">},</font><font color="#FF0000">1</font><font color="#800080">,</font><font color="#008080">$false</font><font color="#800080">,</font><font color="#008080">$opNumero</font><font color="#800080">);
      </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#000080">length</font><font color="#800080">(</font><font color="#008080">$slinha</font><font color="#800080">) &gt; </font><font color="#FF0000">0</font><font color="#800080">) {
        mostrarDados(</font><font color="#008080">$sreg</font><font color="#800080">, </font><font color="#800000">&quot;&quot;</font><font color="#800080">, </font><font color="#FF0000">2</font><font color="#800080">);
        mostrarDados(</font><font color="#008080">$sreg</font><font color="#800080">, </font><font color="#008080">$slinha</font><font color="#800080">, </font><font color="#FF0000">3</font><font color="#800080">);
        subMenu(</font><font color="#FF0000">8</font><font color="#800080">, </font><font color="#008080">$sreg</font><font color="#800080">);
      }
   } </font><font color="#0000FF">elsif </font><font color="#800080">(</font><font color="#008080">$sacao</font><font color="#800080">==</font><font color="#008080">$opAlterar</font><font color="#800080">) {
      mostrarDados(</font><font color="#008080">$sreg</font><font color="#800080">, </font><font color="#800000">&quot;&quot;</font><font color="#800080">, </font><font color="#FF0000">1</font><font color="#800080">);
      subMenu(</font><font color="#FF0000">9</font><font color="#800080">, </font><font color="#008080">$sreg</font><font color="#800080">);
   } </font><font color="#0000FF">elsif </font><font color="#800080">(</font><font color="#008080">$sacao</font><font color="#800080">==</font><font color="#008080">$opExcluir</font><font color="#800080">) {
      subMenu(</font><font color="#FF0000">10</font><font color="#800080">, </font><font color="#008080">$sreg</font><font color="#800080">);
   }
} </font><font color="#0000FF">elsif </font><font color="#800080">(</font><font color="#008080">$sreg</font><font color="#800080">==</font><font color="#008080">$opEndereco</font><font color="#800080">) {
   </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$sacao</font><font color="#800080">==</font><font color="#008080">$opNovo</font><font color="#800080">) {
      </font><font color="#008080">$tEndereco</font><font color="#800080">{</font><font color="#800000">&quot;codigo&quot;</font><font color="#800080">} = pesqMaxCod(tfEndereco, </font><font color="#FF0000">1</font><font color="#800080">, </font><font color="#FF0000">10</font><font color="#800080">, tamReg(</font><font color="#008080">$sreg</font><font color="#800080">));
      mostrarDados(</font><font color="#008080">$sreg</font><font color="#800080">, </font><font color="#800000">&quot;&quot;</font><font color="#800080">, </font><font color="#FF0000">1</font><font color="#800080">);
      subMenu(</font><font color="#FF0000">7</font><font color="#800080">, </font><font color="#008080">$sreg</font><font color="#800080">);
   } </font><font color="#0000FF">elsif </font><font color="#800080">(</font><font color="#008080">$sacao</font><font color="#800080">==</font><font color="#008080">$opPesquisar</font><font color="#800080">) {
      </font><font color="#008080">$slinha </font><font color="#800080">= validaEntrada(tfEndereco,</font><font color="#008080">$sreg</font><font color="#800080">,</font><font color="#FF0000">1</font><font color="#800080">,</font><font color="#008080">$tEndereco</font><font color="#800080">{</font><font color="#800000">&quot;codigo&quot;</font><font color="#800080">},</font><font color="#FF0000">1</font><font color="#800080">,
              </font><font color="#008080">$false</font><font color="#800080">,</font><font color="#008080">$opNumero</font><font color="#800080">);
      </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#000080">length</font><font color="#800080">(</font><font color="#008080">$slinha</font><font color="#800080">) &gt; </font><font color="#FF0000">0</font><font color="#800080">) {
        mostrarDados(</font><font color="#008080">$sreg</font><font color="#800080">, </font><font color="#800000">&quot;&quot;</font><font color="#800080">, </font><font color="#FF0000">2</font><font color="#800080">);
        mostrarDados(</font><font color="#008080">$sreg</font><font color="#800080">, </font><font color="#008080">$slinha</font><font color="#800080">, </font><font color="#FF0000">3</font><font color="#800080">);
        subMenu(</font><font color="#FF0000">8</font><font color="#800080">, </font><font color="#008080">$sreg</font><font color="#800080">);
      }
   } </font><font color="#0000FF">elsif </font><font color="#800080">(</font><font color="#008080">$sacao</font><font color="#800080">==</font><font color="#008080">$opAlterar</font><font color="#800080">) {
      mostrarDados(</font><font color="#008080">$sreg</font><font color="#800080">, </font><font color="#800000">&quot;&quot;</font><font color="#800080">, </font><font color="#FF0000">1</font><font color="#800080">);
      subMenu(</font><font color="#FF0000">9</font><font color="#800080">, </font><font color="#008080">$sreg</font><font color="#800080">);
   } </font><font color="#0000FF">elsif </font><font color="#800080">(</font><font color="#008080">$sacao</font><font color="#800080">==</font><font color="#008080">$opExcluir</font><font color="#800080">) {
      subMenu(</font><font color="#FF0000">10</font><font color="#800080">, </font><font color="#008080">$sreg</font><font color="#800080">);
   }
} </font><font color="#0000FF">elsif </font><font color="#800080">(</font><font color="#008080">$sreg</font><font color="#800080">==</font><font color="#008080">$opIdioma</font><font color="#800080">) {
   </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$sacao</font><font color="#800080">==</font><font color="#008080">$opNovo</font><font color="#800080">) {
      </font><font color="#008080">$tIdioma</font><font color="#800080">{</font><font color="#800000">&quot;codigo&quot;</font><font color="#800080">} = pesqMaxCod(tfIdioma, </font><font color="#FF0000">1</font><font color="#800080">, </font><font color="#FF0000">10</font><font color="#800080">, tamReg(</font><font color="#008080">$sreg</font><font color="#800080">));
      mostrarDados(</font><font color="#008080">$sreg</font><font color="#800080">, </font><font color="#800000">&quot;&quot;</font><font color="#800080">, </font><font color="#FF0000">1</font><font color="#800080">);
      subMenu(</font><font color="#FF0000">7</font><font color="#800080">, </font><font color="#008080">$sreg</font><font color="#800080">);
   } </font><font color="#0000FF">elsif </font><font color="#800080">(</font><font color="#008080">$sacao</font><font color="#800080">==</font><font color="#008080">$opPesquisar</font><font color="#800080">) {
      </font><font color="#008080">$slinha </font><font color="#800080">= validaEntrada(tfIdioma,</font><font color="#008080">$sreg</font><font color="#800080">,</font><font color="#FF0000">1</font><font color="#800080">,</font><font color="#008080">$tIdioma</font><font color="#800080">{</font><font color="#800000">&quot;codigo&quot;</font><font color="#800080">},</font><font color="#FF0000">1</font><font color="#800080">,</font><font color="#008080">$false</font><font color="#800080">,</font><font color="#008080">$opNumero</font><font color="#800080">);
      </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#000080">length</font><font color="#800080">(</font><font color="#008080">$slinha</font><font color="#800080">) &gt; </font><font color="#FF0000">0</font><font color="#800080">) {
        mostrarDados(</font><font color="#008080">$sreg</font><font color="#800080">, </font><font color="#800000">&quot;&quot;</font><font color="#800080">, </font><font color="#FF0000">2</font><font color="#800080">);
        mostrarDados(</font><font color="#008080">$sreg</font><font color="#800080">, </font><font color="#008080">$slinha</font><font color="#800080">, </font><font color="#FF0000">3</font><font color="#800080">);
        subMenu(</font><font color="#FF0000">8</font><font color="#800080">, </font><font color="#008080">$sreg</font><font color="#800080">);
      }
   } </font><font color="#0000FF">elsif </font><font color="#800080">(</font><font color="#008080">$sacao</font><font color="#800080">==</font><font color="#008080">$opAlterar</font><font color="#800080">) {
      mostrarDados(</font><font color="#008080">$sreg</font><font color="#800080">, </font><font color="#800000">&quot;&quot;</font><font color="#800080">, </font><font color="#FF0000">1</font><font color="#800080">);
      subMenu(</font><font color="#FF0000">9</font><font color="#800080">, </font><font color="#008080">$sreg</font><font color="#800080">);
   } </font><font color="#0000FF">elsif </font><font color="#800080">(</font><font color="#008080">$sacao</font><font color="#800080">==</font><font color="#008080">$opExcluir</font><font color="#800080">) {
      subMenu(</font><font color="#FF0000">10</font><font color="#800080">, </font><font color="#008080">$sreg</font><font color="#800080">);
   }
} </font><font color="#0000FF">elsif </font><font color="#800080">(</font><font color="#008080">$sreg</font><font color="#800080">==</font><font color="#008080">$opPais</font><font color="#800080">) {
   </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$sacao</font><font color="#800080">==</font><font color="#008080">$opNovo</font><font color="#800080">) {
      </font><font color="#000080">print</font><font color="#800080">(rotulo(</font><font color="#008080">$sreg</font><font color="#800080">, </font><font color="#FF0000">1</font><font color="#800080">));
      </font><font color="#008080">$tPais</font><font color="#800080">{</font><font color="#800000">&quot;codigo&quot;</font><font color="#800080">} = digita();
      </font><font color="#008080">$slinha </font><font color="#800080">= pesqArq(tfPais, </font><font color="#008080">$tPais</font><font color="#800080">{</font><font color="#800000">&quot;codigo&quot;</font><font color="#800080">}, </font><font color="#FF0000">1</font><font color="#800080">, </font><font color="#FF0000">3</font><font color="#800080">, tamReg(</font><font color="#008080">$sreg</font><font color="#800080">));
      </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#000080">length</font><font color="#800080">(</font><font color="#008080">$slinha</font><font color="#800080">)==</font><font color="#FF0000">0</font><font color="#800080">) {
         pesqLinhaExcluida(tfPais, tamReg(</font><font color="#008080">$sreg</font><font color="#800080">));
         mostrarDados(</font><font color="#008080">$sreg</font><font color="#800080">, </font><font color="#800000">&quot;&quot;</font><font color="#800080">, </font><font color="#FF0000">1</font><font color="#800080">);
         subMenu(</font><font color="#FF0000">7</font><font color="#800080">, </font><font color="#008080">$sreg</font><font color="#800080">);
      } </font><font color="#0000FF">else </font><font color="#800080">{ </font><font color="#000080">print</font><font color="#800080">(MSG_REGEXST); }
   } </font><font color="#0000FF">elsif </font><font color="#800080">(</font><font color="#008080">$sacao</font><font color="#800080">==</font><font color="#008080">$opPesquisar</font><font color="#800080">) {
      </font><font color="#008080">$slinha </font><font color="#800080">= validaEntrada(tfPais, </font><font color="#008080">$sreg</font><font color="#800080">, </font><font color="#FF0000">1</font><font color="#800080">, </font><font color="#008080">$tPais</font><font color="#800080">{</font><font color="#800000">&quot;codigo&quot;</font><font color="#800080">}, </font><font color="#FF0000">1</font><font color="#800080">, </font><font color="#008080">$false</font><font color="#800080">, </font><font color="#008080">$opTexto</font><font color="#800080">);
      </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#000080">length</font><font color="#800080">(</font><font color="#008080">$slinha</font><font color="#800080">) &gt; </font><font color="#FF0000">0</font><font color="#800080">) {
        mostrarDados(</font><font color="#008080">$sreg</font><font color="#800080">, </font><font color="#800000">&quot;&quot;</font><font color="#800080">, </font><font color="#FF0000">2</font><font color="#800080">);
        mostrarDados(</font><font color="#008080">$sreg</font><font color="#800080">, </font><font color="#008080">$slinha</font><font color="#800080">, </font><font color="#FF0000">3</font><font color="#800080">);
        subMenu(</font><font color="#FF0000">8</font><font color="#800080">, </font><font color="#008080">$sreg</font><font color="#800080">);
      }
   } </font><font color="#0000FF">elsif </font><font color="#800080">(</font><font color="#008080">$sacao</font><font color="#800080">==</font><font color="#008080">$opAlterar</font><font color="#800080">) {
      </font><font color="#000080">print</font><font color="#800080">(rotulo(</font><font color="#008080">$sreg</font><font color="#800080">, </font><font color="#FF0000">1</font><font color="#800080">).</font><font color="#008080">$tPais</font><font color="#800080">{</font><font color="#800000">&quot;codigo&quot;</font><font color="#800080">}.</font><font color="#800000">&quot;\n&quot;</font><font color="#800080">);
      mostrarDados(</font><font color="#008080">$sreg</font><font color="#800080">, </font><font color="#800000">&quot;&quot;</font><font color="#800080">, </font><font color="#FF0000">1</font><font color="#800080">);
      subMenu(</font><font color="#FF0000">9</font><font color="#800080">, </font><font color="#008080">$sreg</font><font color="#800080">);
   } </font><font color="#0000FF">elsif </font><font color="#800080">(</font><font color="#008080">$sacao</font><font color="#800080">==</font><font color="#008080">$opExcluir</font><font color="#800080">) {
      subMenu(</font><font color="#FF0000">10</font><font color="#800080">, </font><font color="#008080">$sreg</font><font color="#800080">);
   }
} </font><font color="#0000FF">elsif </font><font color="#800080">(</font><font color="#008080">$sreg</font><font color="#800080">==</font><font color="#008080">$opProfissao</font><font color="#800080">) {
   </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$sacao</font><font color="#800080">==</font><font color="#008080">$opNovo</font><font color="#800080">) {
      </font><font color="#008080">$tProfissao</font><font color="#800080">{</font><font color="#800000">&quot;codigo&quot;</font><font color="#800080">} = pesqMaxCod(tfProfissao, </font><font color="#FF0000">1</font><font color="#800080">, </font><font color="#FF0000">10</font><font color="#800080">, tamReg(</font><font color="#008080">$sreg</font><font color="#800080">));
      mostrarDados(</font><font color="#008080">$sreg</font><font color="#800080">, </font><font color="#800000">&quot;&quot;</font><font color="#800080">, </font><font color="#FF0000">1</font><font color="#800080">);
      subMenu(</font><font color="#FF0000">7</font><font color="#800080">, </font><font color="#008080">$sreg</font><font color="#800080">);
   } </font><font color="#0000FF">elsif </font><font color="#800080">(</font><font color="#008080">$sacao</font><font color="#800080">==</font><font color="#008080">$opPesquisar</font><font color="#800080">) {
      </font><font color="#008080">$slinha </font><font color="#800080">= validaEntrada(tfProfissao,</font><font color="#008080">$sreg</font><font color="#800080">,</font><font color="#FF0000">1</font><font color="#800080">,</font><font color="#008080">$tProfissao</font><font color="#800080">{</font><font color="#800000">&quot;codigo&quot;</font><font color="#800080">},</font><font color="#FF0000">1</font><font color="#800080">,
              </font><font color="#008080">$false</font><font color="#800080">,</font><font color="#008080">$opNumero</font><font color="#800080">);
      </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#000080">length</font><font color="#800080">(</font><font color="#008080">$slinha</font><font color="#800080">) &gt; </font><font color="#FF0000">0</font><font color="#800080">) {
        mostrarDados(</font><font color="#008080">$sreg</font><font color="#800080">, </font><font color="#800000">&quot;&quot;</font><font color="#800080">, </font><font color="#FF0000">2</font><font color="#800080">);
        mostrarDados(</font><font color="#008080">$sreg</font><font color="#800080">, </font><font color="#008080">$slinha</font><font color="#800080">, </font><font color="#FF0000">3</font><font color="#800080">);
        subMenu(</font><font color="#FF0000">8</font><font color="#800080">, </font><font color="#008080">$sreg</font><font color="#800080">);
      }
   } </font><font color="#0000FF">elsif </font><font color="#800080">(</font><font color="#008080">$sacao</font><font color="#800080">==</font><font color="#008080">$opAlterar</font><font color="#800080">) {
      mostrarDados(</font><font color="#008080">$sreg</font><font color="#800080">, </font><font color="#800000">&quot;&quot;</font><font color="#800080">, </font><font color="#FF0000">1</font><font color="#800080">);
      subMenu(</font><font color="#FF0000">9</font><font color="#800080">, </font><font color="#008080">$sreg</font><font color="#800080">);
   } </font><font color="#0000FF">elsif </font><font color="#800080">(</font><font color="#008080">$sacao</font><font color="#800080">==</font><font color="#008080">$opExcluir</font><font color="#800080">) {
      subMenu(</font><font color="#FF0000">10</font><font color="#800080">, </font><font color="#008080">$sreg</font><font color="#800080">);
   }
} </font><font color="#0000FF">elsif </font><font color="#800080">(</font><font color="#008080">$sreg</font><font color="#800080">==</font><font color="#008080">$opLivro</font><font color="#800080">) {
   </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$sacao</font><font color="#800080">==</font><font color="#008080">$opNovo</font><font color="#800080">) {
      </font><font color="#000080">print</font><font color="#800080">(rotulo(</font><font color="#008080">$sreg</font><font color="#800080">, </font><font color="#FF0000">1</font><font color="#800080">));
      </font><font color="#008080">$tLivro</font><font color="#800080">{</font><font color="#800000">&quot;isbn&quot;</font><font color="#800080">} = digita();
      </font><font color="#0000FF">if </font><font color="#800080">(validaISBN(</font><font color="#008080">$tLivro</font><font color="#800080">{</font><font color="#800000">&quot;isbn&quot;</font><font color="#800080">})) {
          </font><font color="#008080">$slinha </font><font color="#800080">= pesqArq(tfLivro, </font><font color="#008080">$tLivro</font><font color="#800080">{</font><font color="#800000">&quot;isbn&quot;</font><font color="#800080">}, </font><font color="#FF0000">1</font><font color="#800080">, </font><font color="#FF0000">13</font><font color="#800080">, tamReg(</font><font color="#008080">$sreg</font><font color="#800080">));
          </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#000080">length</font><font color="#800080">(</font><font color="#008080">$slinha</font><font color="#800080">)==</font><font color="#FF0000">0</font><font color="#800080">) {
             pesqLinhaExcluida(tfLivro, tamReg(</font><font color="#008080">$sreg</font><font color="#800080">));
             mostrarDados(</font><font color="#008080">$sreg</font><font color="#800080">, </font><font color="#800000">&quot;&quot;</font><font color="#800080">, </font><font color="#FF0000">1</font><font color="#800080">);
             subMenu(</font><font color="#FF0000">7</font><font color="#800080">, </font><font color="#008080">$sreg</font><font color="#800080">);
             frmCadLigados(</font><font color="#008080">$opLivroAss</font><font color="#800080">, </font><font color="#008080">$opNovo</font><font color="#800080">, </font><font color="#008080">$tLivro</font><font color="#800080">{</font><font color="#800000">&quot;isbn&quot;</font><font color="#800080">});
             frmCadLigados(</font><font color="#008080">$opLivroAut</font><font color="#800080">, </font><font color="#008080">$opNovo</font><font color="#800080">, </font><font color="#008080">$tLivro</font><font color="#800080">{</font><font color="#800000">&quot;isbn&quot;</font><font color="#800080">});
          } </font><font color="#0000FF">else </font><font color="#800080">{ </font><font color="#000080">print</font><font color="#800080">(MSG_REGEXST); }
      } </font><font color="#0000FF">else </font><font color="#800080">{ </font><font color="#000080">print</font><font color="#800080">(MSG_ISBNINV); }
   } </font><font color="#0000FF">elsif </font><font color="#800080">(</font><font color="#008080">$sacao</font><font color="#800080">==</font><font color="#008080">$opPesquisar</font><font color="#800080">) {
      </font><font color="#008080">$slinha </font><font color="#800080">= validaEntrada(tfLivro, </font><font color="#008080">$sreg</font><font color="#800080">, </font><font color="#FF0000">1</font><font color="#800080">, </font><font color="#008080">$tLivro</font><font color="#800080">{</font><font color="#800000">&quot;isbn&quot;</font><font color="#800080">}, </font><font color="#FF0000">1</font><font color="#800080">,</font><font color="#008080">$false</font><font color="#800080">,</font><font color="#008080">$opTexto</font><font color="#800080">);
      </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#000080">length</font><font color="#800080">(</font><font color="#008080">$slinha</font><font color="#800080">) &gt; </font><font color="#FF0000">0</font><font color="#800080">) {
         mostrarDados(</font><font color="#008080">$sreg</font><font color="#800080">, </font><font color="#800000">&quot;&quot;</font><font color="#800080">, </font><font color="#FF0000">2</font><font color="#800080">);
         mostrarDados(</font><font color="#008080">$sreg</font><font color="#800080">, </font><font color="#008080">$slinha</font><font color="#800080">, </font><font color="#FF0000">3</font><font color="#800080">);
         subMenu(</font><font color="#FF0000">8</font><font color="#800080">, </font><font color="#008080">$sreg</font><font color="#800080">);
      }
   } </font><font color="#0000FF">elsif </font><font color="#800080">(</font><font color="#008080">$sacao</font><font color="#800080">==</font><font color="#008080">$opAlterar</font><font color="#800080">) {
      </font><font color="#000080">print</font><font color="#800080">(rotulo(</font><font color="#008080">$sreg</font><font color="#800080">, </font><font color="#FF0000">1</font><font color="#800080">).</font><font color="#008080">$tLivro</font><font color="#800080">{</font><font color="#800000">&quot;isbn&quot;</font><font color="#800080">}.</font><font color="#800000">&quot;\n&quot;</font><font color="#800080">);
      mostrarDados(</font><font color="#008080">$sreg</font><font color="#800080">, </font><font color="#800000">&quot;&quot;</font><font color="#800080">, </font><font color="#FF0000">1</font><font color="#800080">);
      subMenu(</font><font color="#FF0000">9</font><font color="#800080">, </font><font color="#008080">$sreg</font><font color="#800080">);
      frmCadLigados(</font><font color="#008080">$opLivroAss</font><font color="#800080">, </font><font color="#008080">$opExcluir</font><font color="#800080">, </font><font color="#008080">$tLivro</font><font color="#800080">{</font><font color="#800000">&quot;isbn&quot;</font><font color="#800080">});
      </font><font color="#000080">print</font><font color="#800080">(</font><font color="#800000">&quot;Assuntos dos livros exclu&iacute;dos, inclua novos!\n&quot;</font><font color="#800080">);
      frmCadLigados(</font><font color="#008080">$opLivroAss</font><font color="#800080">, </font><font color="#008080">$opNovo</font><font color="#800080">, </font><font color="#008080">$tLivro</font><font color="#800080">{</font><font color="#800000">&quot;isbn&quot;</font><font color="#800080">});
      frmCadLigados(</font><font color="#008080">$opLivroAut</font><font color="#800080">, </font><font color="#008080">$opExcluir</font><font color="#800080">, </font><font color="#008080">$tLivro</font><font color="#800080">{</font><font color="#800000">&quot;isbn&quot;</font><font color="#800080">});
      </font><font color="#000080">print</font><font color="#800080">(</font><font color="#800000">&quot;Autores dos livros exclu&iacute;dos, inclua novos!\n&quot;</font><font color="#800080">);
      frmCadLigados(</font><font color="#008080">$opLivroAut</font><font color="#800080">, </font><font color="#008080">$opNovo</font><font color="#800080">, </font><font color="#008080">$tLivro</font><font color="#800080">{</font><font color="#800000">&quot;isbn&quot;</font><font color="#800080">});
   } </font><font color="#0000FF">elsif </font><font color="#800080">(</font><font color="#008080">$sacao</font><font color="#800080">==</font><font color="#008080">$opExcluir</font><font color="#800080">) {
      subMenu(</font><font color="#FF0000">10</font><font color="#800080">, </font><font color="#008080">$sreg</font><font color="#800080">);
      </font><font color="#000080">print</font><font color="#800080">(</font><font color="#800000">&quot;Assuntos dos livros sendo exclu&iacute;dos!\n&quot;</font><font color="#800080">);
      frmCadLigados(</font><font color="#008080">$opLivroAss</font><font color="#800080">, </font><font color="#008080">$opExcluir</font><font color="#800080">, </font><font color="#008080">$tLivro</font><font color="#800080">{</font><font color="#800000">&quot;isbn&quot;</font><font color="#800080">});
      </font><font color="#000080">print</font><font color="#800080">(</font><font color="#800000">&quot;Autores dos livros sendo exclu&iacute;dos!\n&quot;</font><font color="#800080">);
      frmCadLigados(</font><font color="#008080">$opLivroAut</font><font color="#800080">, </font><font color="#008080">$opExcluir</font><font color="#800080">, </font><font color="#008080">$tLivro</font><font color="#800080">{</font><font color="#800000">&quot;isbn&quot;</font><font color="#800080">});
   }
} </font><font color="#0000FF">elsif </font><font color="#800080">(</font><font color="#008080">$sreg</font><font color="#800080">==</font><font color="#008080">$opCliente</font><font color="#800080">) {
   </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$sacao</font><font color="#800080">==</font><font color="#008080">$opNovo</font><font color="#800080">) {
      </font><font color="#000080">print</font><font color="#800080">(rotulo(</font><font color="#008080">$sreg</font><font color="#800080">, </font><font color="#FF0000">1</font><font color="#800080">));
      </font><font color="#008080">$tCliente</font><font color="#800080">{</font><font color="#800000">&quot;cpf&quot;</font><font color="#800080">} = digita();
      </font><font color="#0000FF">if </font><font color="#800080">(validaCPF(</font><font color="#008080">$tCliente</font><font color="#800080">{</font><font color="#800000">&quot;cpf&quot;</font><font color="#800080">})) {
          </font><font color="#008080">$slinha </font><font color="#800080">= pesqArq(tfCliente, </font><font color="#008080">$tCliente</font><font color="#800080">{</font><font color="#800000">&quot;cpf&quot;</font><font color="#800080">}, </font><font color="#FF0000">1</font><font color="#800080">, </font><font color="#FF0000">14</font><font color="#800080">, tamReg(</font><font color="#008080">$sreg</font><font color="#800080">));
          </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#000080">length</font><font color="#800080">(</font><font color="#008080">$slinha</font><font color="#800080">)==</font><font color="#FF0000">0</font><font color="#800080">) {
             pesqLinhaExcluida(tfCliente, tamReg(</font><font color="#008080">$sreg</font><font color="#800080">));
             mostrarDados(</font><font color="#008080">$sreg</font><font color="#800080">, </font><font color="#800000">&quot;&quot;</font><font color="#800080">, </font><font color="#FF0000">1</font><font color="#800080">);
             subMenu(</font><font color="#FF0000">7</font><font color="#800080">, </font><font color="#008080">$sreg</font><font color="#800080">);
          } </font><font color="#0000FF">else </font><font color="#800080">{ </font><font color="#000080">print</font><font color="#800080">(MSG_REGEXST); }
      } </font><font color="#0000FF">else </font><font color="#800080">{ </font><font color="#000080">print</font><font color="#800080">(MSG_CPFINV); }
   } </font><font color="#0000FF">elsif </font><font color="#800080">(</font><font color="#008080">$sacao</font><font color="#800080">==</font><font color="#008080">$opPesquisar</font><font color="#800080">) {
      </font><font color="#008080">$slinha </font><font color="#800080">= validaEntrada(tfCliente, </font><font color="#008080">$sreg</font><font color="#800080">, </font><font color="#FF0000">1</font><font color="#800080">, </font><font color="#008080">$tCliente</font><font color="#800080">{</font><font color="#800000">&quot;cpf&quot;</font><font color="#800080">},</font><font color="#FF0000">1</font><font color="#800080">,</font><font color="#008080">$false</font><font color="#800080">,</font><font color="#008080">$opTexto</font><font color="#800080">);
      </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#000080">length</font><font color="#800080">(</font><font color="#008080">$slinha</font><font color="#800080">) &gt; </font><font color="#FF0000">0</font><font color="#800080">) {
         mostrarDados(</font><font color="#008080">$sreg</font><font color="#800080">, </font><font color="#800000">&quot;&quot;</font><font color="#800080">, </font><font color="#FF0000">2</font><font color="#800080">);
         mostrarDados(</font><font color="#008080">$sreg</font><font color="#800080">, </font><font color="#008080">$slinha</font><font color="#800080">, </font><font color="#FF0000">3</font><font color="#800080">);
         subMenu(</font><font color="#FF0000">8</font><font color="#800080">, </font><font color="#008080">$sreg</font><font color="#800080">);
      }
   } </font><font color="#0000FF">elsif </font><font color="#800080">(</font><font color="#008080">$sacao</font><font color="#800080">==</font><font color="#008080">$opAlterar</font><font color="#800080">) {
      </font><font color="#000080">print</font><font color="#800080">(rotulo(</font><font color="#008080">$sreg</font><font color="#800080">, </font><font color="#FF0000">1</font><font color="#800080">).</font><font color="#008080">$tCliente</font><font color="#800080">{</font><font color="#800000">&quot;cpf&quot;</font><font color="#800080">}.</font><font color="#800000">&quot;\n&quot;</font><font color="#800080">);
      mostrarDados(</font><font color="#008080">$sreg</font><font color="#800080">, </font><font color="#800000">&quot;&quot;</font><font color="#800080">, </font><font color="#FF0000">1</font><font color="#800080">);
      subMenu(</font><font color="#FF0000">9</font><font color="#800080">, </font><font color="#008080">$sreg</font><font color="#800080">);
   } </font><font color="#0000FF">elsif </font><font color="#800080">(</font><font color="#008080">$sacao</font><font color="#800080">==</font><font color="#008080">$opExcluir</font><font color="#800080">) {
      subMenu(</font><font color="#FF0000">10</font><font color="#800080">, </font><font color="#008080">$sreg</font><font color="#800080">);
   }
} </font><font color="#0000FF">elsif </font><font color="#800080">(</font><font color="#008080">$sreg</font><font color="#800080">==</font><font color="#008080">$opVenda</font><font color="#800080">) {
   </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$sacao</font><font color="#800080">==</font><font color="#008080">$opNovo</font><font color="#800080">) {
      </font><font color="#008080">$tVenda</font><font color="#800080">{</font><font color="#800000">&quot;dthrvenda&quot;</font><font color="#800080">} = retDataHora();
      </font><font color="#000080">print</font><font color="#800080">(rotulo(</font><font color="#008080">$sreg</font><font color="#800080">, </font><font color="#FF0000">1</font><font color="#800080">).</font><font color="#008080">$tVenda</font><font color="#800080">{</font><font color="#800000">&quot;dthrvenda&quot;</font><font color="#800080">}.</font><font color="#800000">&quot;\n&quot;</font><font color="#800080">);
      </font><font color="#008080">$slinha </font><font color="#800080">= pesqArq(tfVenda, </font><font color="#008080">$tVenda</font><font color="#800080">{</font><font color="#800000">&quot;dthrvenda&quot;</font><font color="#800080">}, </font><font color="#FF0000">1</font><font color="#800080">, </font><font color="#FF0000">19</font><font color="#800080">, tamReg(</font><font color="#008080">$sreg</font><font color="#800080">));
      </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#000080">length</font><font color="#800080">(</font><font color="#008080">$slinha</font><font color="#800080">)==</font><font color="#FF0000">0</font><font color="#800080">) {
         </font><font color="#008080">$slinha </font><font color="#800080">= validaEntrada(tfCliente,</font><font color="#008080">$opCliente</font><font color="#800080">,</font><font color="#FF0000">1</font><font color="#800080">,</font><font color="#008080">$tVenda</font><font color="#800080">{</font><font color="#800000">&quot;cpf&quot;</font><font color="#800080">},</font><font color="#FF0000">3</font><font color="#800080">,
                 </font><font color="#008080">$false</font><font color="#800080">,</font><font color="#008080">$opTexto</font><font color="#800080">);
         </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#000080">length</font><font color="#800080">(</font><font color="#008080">$slinha</font><font color="#800080">) &gt; </font><font color="#FF0000">0</font><font color="#800080">) {
            </font><font color="#008080">$tVenda</font><font color="#800080">{</font><font color="#800000">&quot;cpf&quot;</font><font color="#800080">} = trim(copy(</font><font color="#008080">$slinha</font><font color="#800080">,</font><font color="#FF0000">1</font><font color="#800080">,</font><font color="#FF0000">14</font><font color="#800080">));
            </font><font color="#0000FF">if </font><font color="#800080">(validaCPF(</font><font color="#008080">$tVenda</font><font color="#800080">{</font><font color="#800000">&quot;cpf&quot;</font><font color="#800080">})) {
               </font><font color="#000080">print</font><font color="#800080">(</font><font color="#800000">&quot; &quot;</font><font color="#800080">.rotulo(</font><font color="#008080">$opCliente</font><font color="#800080">, </font><font color="#FF0000">2</font><font color="#800080">)); </font><font color="#808080"><i># Nome 
               </i></font><font color="#000080">print</font><font color="#800080">(copy(</font><font color="#008080">$slinha</font><font color="#800080">, </font><font color="#008080">$g_nPosChave</font><font color="#800080">, </font><font color="#008080">$g_nTamChave</font><font color="#800080">).</font><font color="#800000">&quot;\n&quot;</font><font color="#800080">);
               frmCadLigados(</font><font color="#008080">$opVenda</font><font color="#800080">, </font><font color="#008080">$opNovo</font><font color="#800080">, </font><font color="#008080">$tVenda</font><font color="#800080">{</font><font color="#800000">&quot;cpf&quot;</font><font color="#800080">});
            } </font><font color="#0000FF">else </font><font color="#800080">{ </font><font color="#000080">print</font><font color="#800080">(MSG_CPFINV); }
         }
      } </font><font color="#0000FF">else </font><font color="#800080">{ </font><font color="#000080">print</font><font color="#800080">(MSG_REGEXST); }
   } </font><font color="#0000FF">elsif </font><font color="#800080">(</font><font color="#008080">$sacao</font><font color="#800080">==</font><font color="#008080">$opPesquisar</font><font color="#800080">) {
      </font><font color="#008080">$slinha </font><font color="#800080">= validaEntrada(tfVenda, </font><font color="#008080">$sreg</font><font color="#800080">, </font><font color="#FF0000">1</font><font color="#800080">, </font><font color="#008080">$tVenda</font><font color="#800080">{</font><font color="#800000">&quot;dthrvenda&quot;</font><font color="#800080">},</font><font color="#FF0000">1</font><font color="#800080">,
              </font><font color="#008080">$false</font><font color="#800080">,</font><font color="#008080">$opDataHora</font><font color="#800080">);
      </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#000080">length</font><font color="#800080">(</font><font color="#008080">$slinha</font><font color="#800080">) &gt; </font><font color="#FF0000">0</font><font color="#800080">) {
        mostrarDados(</font><font color="#008080">$sreg</font><font color="#800080">, </font><font color="#800000">&quot;&quot;</font><font color="#800080">, </font><font color="#FF0000">2</font><font color="#800080">);
        mostrarDados(</font><font color="#008080">$sreg</font><font color="#800080">, </font><font color="#008080">$slinha</font><font color="#800080">, </font><font color="#FF0000">3</font><font color="#800080">);
        subMenu(</font><font color="#FF0000">8</font><font color="#800080">, </font><font color="#008080">$sreg</font><font color="#800080">);
      }
   }
}

}
</font><font color="#808080"><i>#------------------------------------------------------------------------------
# Realiza as consultas de acordo com o tipo de arquivo.
# sreg - o tipo de arquivo
# sacao - a a&ccedil;&atilde;o a ser realizada
#------------------------------------------------------------------------------
</i></font><font color="#0000FF">sub </font><font color="#800080">frmConsultas {
</font><font color="#0000FF">my </font><font color="#008080">$sreg </font><font color="#800080">= </font><font color="#FF00FF">$_</font><font color="#800080">[</font><font color="#FF0000">0</font><font color="#800080">]; 
</font><font color="#0000FF">my </font><font color="#008080">$sacao </font><font color="#800080">= </font><font color="#FF00FF">$_</font><font color="#800080">[</font><font color="#FF0000">1</font><font color="#800080">];
</font><font color="#0000FF">my </font><font color="#008080">$slinha </font><font color="#800080">= </font><font color="#800000">&quot;&quot;</font><font color="#800080">;

</font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$sreg</font><font color="#800080">==</font><font color="#008080">$opAssunto</font><font color="#800080">) {
   </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$sacao</font><font color="#800080">==</font><font color="#008080">$opPesquisar</font><font color="#800080">) {
      </font><font color="#008080">$slinha </font><font color="#800080">= validaEntrada(tfAssunto,</font><font color="#008080">$sreg</font><font color="#800080">,</font><font color="#FF0000">2</font><font color="#800080">,</font><font color="#008080">$tAssunto</font><font color="#800080">{</font><font color="#800000">&quot;assunto&quot;</font><font color="#800080">},</font><font color="#FF0000">1</font><font color="#800080">,</font><font color="#008080">$true</font><font color="#800080">,</font><font color="#008080">$opTexto</font><font color="#800080">);
   } </font><font color="#0000FF">elsif </font><font color="#800080">(</font><font color="#008080">$sacao</font><font color="#800080">==</font><font color="#008080">$opListarTodos</font><font color="#800080">) {
      </font><font color="#0000FF">if </font><font color="#800080">(ListarTodos(tfAssunto, </font><font color="#008080">$sreg</font><font color="#800080">, </font><font color="#800000">&quot;&quot;</font><font color="#800080">, </font><font color="#FF0000">0</font><font color="#800080">, </font><font color="#FF0000">0</font><font color="#800080">, tamReg(</font><font color="#008080">$sreg</font><font color="#800080">),
        </font><font color="#008080">$QTD_MAX_LINHA</font><font color="#800080">, </font><font color="#008080">$false</font><font color="#800080">) == </font><font color="#008080">$false</font><font color="#800080">) {
          </font><font color="#000080">print</font><font color="#800080">(rotulo(</font><font color="#008080">$sreg</font><font color="#800080">, </font><font color="#FF0000">0</font><font color="#800080">).</font><font color="#800000">&quot;\n&quot;</font><font color="#800080">);
      }
   }
} </font><font color="#0000FF">elsif </font><font color="#800080">(</font><font color="#008080">$sreg</font><font color="#800080">==</font><font color="#008080">$opAutor</font><font color="#800080">) {
   </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$sacao</font><font color="#800080">==</font><font color="#008080">$opPesquisar</font><font color="#800080">) {
      </font><font color="#008080">$slinha </font><font color="#800080">= validaEntrada(tfAutor,</font><font color="#008080">$sreg</font><font color="#800080">, </font><font color="#FF0000">2</font><font color="#800080">, </font><font color="#008080">$tAutor</font><font color="#800080">{</font><font color="#800000">&quot;autor&quot;</font><font color="#800080">}, </font><font color="#FF0000">1</font><font color="#800080">, </font><font color="#008080">$true</font><font color="#800080">,</font><font color="#008080">$opTexto</font><font color="#800080">);
   } </font><font color="#0000FF">elsif </font><font color="#800080">(</font><font color="#008080">$sacao</font><font color="#800080">==</font><font color="#008080">$opListarTodos</font><font color="#800080">) {
      </font><font color="#0000FF">if </font><font color="#800080">(ListarTodos(tfAutor, </font><font color="#008080">$sreg</font><font color="#800080">, </font><font color="#800000">&quot;&quot;</font><font color="#800080">, </font><font color="#FF0000">0</font><font color="#800080">, </font><font color="#FF0000">0</font><font color="#800080">, tamReg(</font><font color="#008080">$sreg</font><font color="#800080">),
        </font><font color="#008080">$QTD_MAX_LINHA</font><font color="#800080">, </font><font color="#008080">$false</font><font color="#800080">) == </font><font color="#008080">$false</font><font color="#800080">) {
        </font><font color="#000080">print</font><font color="#800080">(rotulo(</font><font color="#008080">$sreg</font><font color="#800080">, </font><font color="#FF0000">0</font><font color="#800080">).</font><font color="#800000">&quot;\n&quot;</font><font color="#800080">);
      }
   }
} </font><font color="#0000FF">elsif </font><font color="#800080">(</font><font color="#008080">$sreg</font><font color="#800080">==</font><font color="#008080">$opEditora</font><font color="#800080">) {
   </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$sacao</font><font color="#800080">==</font><font color="#008080">$opPesquisar</font><font color="#800080">) {
      </font><font color="#008080">$slinha </font><font color="#800080">= validaEntrada(tfEditora,</font><font color="#008080">$sreg</font><font color="#800080">,</font><font color="#FF0000">2</font><font color="#800080">,</font><font color="#008080">$tEditora</font><font color="#800080">{</font><font color="#800000">&quot;editora&quot;</font><font color="#800080">},</font><font color="#FF0000">1</font><font color="#800080">,</font><font color="#008080">$true</font><font color="#800080">,</font><font color="#008080">$opTexto</font><font color="#800080">);
   } </font><font color="#0000FF">elsif </font><font color="#800080">(</font><font color="#008080">$sacao</font><font color="#800080">==</font><font color="#008080">$opListarTodos</font><font color="#800080">) {
      </font><font color="#0000FF">if </font><font color="#800080">(ListarTodos(tfEditora, </font><font color="#008080">$sreg</font><font color="#800080">, </font><font color="#800000">&quot;&quot;</font><font color="#800080">, </font><font color="#FF0000">0</font><font color="#800080">, </font><font color="#FF0000">0</font><font color="#800080">, tamReg(</font><font color="#008080">$sreg</font><font color="#800080">),
        </font><font color="#008080">$QTD_MAX_LINHA</font><font color="#800080">, </font><font color="#008080">$false</font><font color="#800080">) == </font><font color="#008080">$false</font><font color="#800080">) {
        </font><font color="#000080">print</font><font color="#800080">(rotulo(</font><font color="#008080">$sreg</font><font color="#800080">, </font><font color="#FF0000">0</font><font color="#800080">).</font><font color="#800000">&quot;\n&quot;</font><font color="#800080">);
      }
   }
} </font><font color="#0000FF">elsif </font><font color="#800080">(</font><font color="#008080">$sreg</font><font color="#800080">==</font><font color="#008080">$opEndereco</font><font color="#800080">) {
   </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$sacao</font><font color="#800080">==</font><font color="#008080">$opPesquisar</font><font color="#800080">) {
      </font><font color="#008080">$slinha </font><font color="#800080">= validaEntrada(tfEndereco,</font><font color="#008080">$sreg</font><font color="#800080">,</font><font color="#FF0000">2</font><font color="#800080">,</font><font color="#008080">$tEndereco</font><font color="#800080">{</font><font color="#800000">&quot;logradouro&quot;</font><font color="#800080">},</font><font color="#FF0000">1</font><font color="#800080">,
              </font><font color="#008080">$true</font><font color="#800080">,</font><font color="#008080">$opTexto</font><font color="#800080">);
   } </font><font color="#0000FF">elsif </font><font color="#800080">(</font><font color="#008080">$sacao</font><font color="#800080">==</font><font color="#008080">$opListarTodos</font><font color="#800080">) {
      </font><font color="#0000FF">if </font><font color="#800080">(ListarTodos(tfEndereco, </font><font color="#008080">$sreg</font><font color="#800080">, </font><font color="#800000">&quot;&quot;</font><font color="#800080">, </font><font color="#FF0000">0</font><font color="#800080">, </font><font color="#FF0000">0</font><font color="#800080">, tamReg(</font><font color="#008080">$sreg</font><font color="#800080">),
         </font><font color="#FF0000">3</font><font color="#800080">, </font><font color="#008080">$false</font><font color="#800080">) == </font><font color="#008080">$false</font><font color="#800080">) {
        </font><font color="#000080">print</font><font color="#800080">(rotulo(</font><font color="#008080">$sreg</font><font color="#800080">, </font><font color="#FF0000">0</font><font color="#800080">).</font><font color="#800000">&quot;\n&quot;</font><font color="#800080">);
      }
   }
} </font><font color="#0000FF">elsif </font><font color="#800080">(</font><font color="#008080">$sreg</font><font color="#800080">==</font><font color="#008080">$opIdioma</font><font color="#800080">) {
   </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$sacao</font><font color="#800080">==</font><font color="#008080">$opPesquisar</font><font color="#800080">) {
      </font><font color="#008080">$slinha </font><font color="#800080">= validaEntrada(tfIdioma, </font><font color="#008080">$sreg</font><font color="#800080">, </font><font color="#FF0000">2</font><font color="#800080">, </font><font color="#008080">$tIdioma</font><font color="#800080">{</font><font color="#800000">&quot;idioma&quot;</font><font color="#800080">},</font><font color="#FF0000">1</font><font color="#800080">,</font><font color="#008080">$true</font><font color="#800080">,</font><font color="#008080">$opTexto</font><font color="#800080">);
   } </font><font color="#0000FF">elsif </font><font color="#800080">(</font><font color="#008080">$sacao</font><font color="#800080">==</font><font color="#008080">$opListarTodos</font><font color="#800080">) {
      </font><font color="#0000FF">if </font><font color="#800080">(ListarTodos(tfIdioma, </font><font color="#008080">$sreg</font><font color="#800080">, </font><font color="#800000">&quot;&quot;</font><font color="#800080">, </font><font color="#FF0000">0</font><font color="#800080">, </font><font color="#FF0000">0</font><font color="#800080">, tamReg(</font><font color="#008080">$sreg</font><font color="#800080">),
        </font><font color="#008080">$QTD_MAX_LINHA</font><font color="#800080">, </font><font color="#008080">$false</font><font color="#800080">) == </font><font color="#008080">$false</font><font color="#800080">) {
        </font><font color="#000080">print</font><font color="#800080">(rotulo(</font><font color="#008080">$sreg</font><font color="#800080">, </font><font color="#FF0000">0</font><font color="#800080">).</font><font color="#800000">&quot;\n&quot;</font><font color="#800080">);
      } 
   }
} </font><font color="#0000FF">elsif </font><font color="#800080">(</font><font color="#008080">$sreg</font><font color="#800080">==</font><font color="#008080">$opPais</font><font color="#800080">) {
   </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$sacao</font><font color="#800080">==</font><font color="#008080">$opPesquisar</font><font color="#800080">) {
      </font><font color="#008080">$slinha </font><font color="#800080">= validaEntrada(tfPais, </font><font color="#008080">$sreg</font><font color="#800080">, </font><font color="#FF0000">2</font><font color="#800080">, </font><font color="#008080">$tPais</font><font color="#800080">{</font><font color="#800000">&quot;pais&quot;</font><font color="#800080">}, </font><font color="#FF0000">1</font><font color="#800080">, </font><font color="#008080">$true</font><font color="#800080">,</font><font color="#008080">$opTexto</font><font color="#800080">);
   } </font><font color="#0000FF">elsif </font><font color="#800080">(</font><font color="#008080">$sacao</font><font color="#800080">==</font><font color="#008080">$opListarTodos</font><font color="#800080">) {
      </font><font color="#0000FF">if </font><font color="#800080">(ListarTodos(tfPais, </font><font color="#008080">$sreg</font><font color="#800080">, </font><font color="#800000">&quot;&quot;</font><font color="#800080">, </font><font color="#FF0000">0</font><font color="#800080">, </font><font color="#FF0000">0</font><font color="#800080">, tamReg(</font><font color="#008080">$sreg</font><font color="#800080">),
        </font><font color="#008080">$QTD_MAX_LINHA</font><font color="#800080">, </font><font color="#008080">$false</font><font color="#800080">) == </font><font color="#008080">$false</font><font color="#800080">) {
        </font><font color="#000080">print</font><font color="#800080">(rotulo(</font><font color="#008080">$sreg</font><font color="#800080">, </font><font color="#FF0000">0</font><font color="#800080">).</font><font color="#800000">&quot;\n&quot;</font><font color="#800080">);
      }
   }
} </font><font color="#0000FF">elsif </font><font color="#800080">(</font><font color="#008080">$sreg</font><font color="#800080">==</font><font color="#008080">$opProfissao</font><font color="#800080">) {
   </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$sacao</font><font color="#800080">==</font><font color="#008080">$opPesquisar</font><font color="#800080">) {
     </font><font color="#008080">$slinha </font><font color="#800080">= validaEntrada(tfProfissao,</font><font color="#008080">$sreg</font><font color="#800080">,</font><font color="#FF0000">2</font><font color="#800080">,</font><font color="#008080">$tProfissao</font><font color="#800080">{</font><font color="#800000">&quot;profissao&quot;</font><font color="#800080">},</font><font color="#FF0000">1</font><font color="#800080">,
             </font><font color="#008080">$true</font><font color="#800080">,</font><font color="#008080">$opTexto</font><font color="#800080">);
   } </font><font color="#0000FF">elsif </font><font color="#800080">(</font><font color="#008080">$sacao</font><font color="#800080">==</font><font color="#008080">$opListarTodos</font><font color="#800080">) {
      </font><font color="#0000FF">if </font><font color="#800080">(ListarTodos(tfProfissao, </font><font color="#008080">$sreg</font><font color="#800080">, </font><font color="#800000">&quot;&quot;</font><font color="#800080">, </font><font color="#FF0000">0</font><font color="#800080">, </font><font color="#FF0000">0</font><font color="#800080">, tamReg(</font><font color="#008080">$sreg</font><font color="#800080">),
        </font><font color="#008080">$QTD_MAX_LINHA</font><font color="#800080">, </font><font color="#008080">$false</font><font color="#800080">) == </font><font color="#008080">$false</font><font color="#800080">) {
        </font><font color="#000080">print</font><font color="#800080">(rotulo(</font><font color="#008080">$sreg</font><font color="#800080">, </font><font color="#FF0000">0</font><font color="#800080">).</font><font color="#800000">&quot;\n&quot;</font><font color="#800080">);
      }
   }
} </font><font color="#0000FF">elsif </font><font color="#800080">(</font><font color="#008080">$sreg</font><font color="#800080">==</font><font color="#008080">$opLivro</font><font color="#800080">) {
   </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$sacao</font><font color="#800080">==</font><font color="#008080">$opPesquisar</font><font color="#800080">) {
      </font><font color="#008080">$slinha </font><font color="#800080">= validaEntrada(tfLivro, </font><font color="#008080">$sreg</font><font color="#800080">, </font><font color="#FF0000">2</font><font color="#800080">, </font><font color="#008080">$tLivro</font><font color="#800080">{</font><font color="#800000">&quot;titulo&quot;</font><font color="#800080">}, </font><font color="#FF0000">1</font><font color="#800080">, </font><font color="#008080">$true</font><font color="#800080">,</font><font color="#008080">$opTexto</font><font color="#800080">);
   } </font><font color="#0000FF">elsif </font><font color="#800080">(</font><font color="#008080">$sacao</font><font color="#800080">==</font><font color="#008080">$opListarTodos</font><font color="#800080">) {
      </font><font color="#0000FF">if </font><font color="#800080">(ListarTodos(tfLivro, </font><font color="#008080">$sreg</font><font color="#800080">, </font><font color="#800000">&quot;&quot;</font><font color="#800080">, </font><font color="#FF0000">0</font><font color="#800080">, </font><font color="#FF0000">0</font><font color="#800080">, tamReg(</font><font color="#008080">$sreg</font><font color="#800080">),
        </font><font color="#FF0000">1</font><font color="#800080">, </font><font color="#008080">$false</font><font color="#800080">) == </font><font color="#008080">$false</font><font color="#800080">) {
        </font><font color="#000080">print</font><font color="#800080">(rotulo(</font><font color="#008080">$sreg</font><font color="#800080">, </font><font color="#FF0000">0</font><font color="#800080">).</font><font color="#800000">&quot;\n&quot;</font><font color="#800080">);
      }
   }
} </font><font color="#0000FF">elsif </font><font color="#800080">(</font><font color="#008080">$sreg</font><font color="#800080">==</font><font color="#008080">$opCliente</font><font color="#800080">) {
   </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$sacao</font><font color="#800080">==</font><font color="#008080">$opPesquisar</font><font color="#800080">) {
      </font><font color="#008080">$slinha </font><font color="#800080">= validaEntrada(tfCliente, </font><font color="#008080">$sreg</font><font color="#800080">, </font><font color="#FF0000">2</font><font color="#800080">, </font><font color="#008080">$tCliente</font><font color="#800080">{</font><font color="#800000">&quot;nome&quot;</font><font color="#800080">},</font><font color="#FF0000">1</font><font color="#800080">,</font><font color="#008080">$true</font><font color="#800080">,</font><font color="#008080">$opTexto</font><font color="#800080">);
   } </font><font color="#0000FF">elsif </font><font color="#800080">(</font><font color="#008080">$sacao</font><font color="#800080">==</font><font color="#008080">$opListarTodos</font><font color="#800080">) {
      </font><font color="#0000FF">if </font><font color="#800080">(ListarTodos(tfCliente, </font><font color="#008080">$sreg</font><font color="#800080">, </font><font color="#800000">&quot;&quot;</font><font color="#800080">, </font><font color="#FF0000">0</font><font color="#800080">, </font><font color="#FF0000">0</font><font color="#800080">, tamReg(</font><font color="#008080">$sreg</font><font color="#800080">),
        </font><font color="#FF0000">1</font><font color="#800080">, </font><font color="#008080">$false</font><font color="#800080">) == </font><font color="#008080">$false</font><font color="#800080">) {
        </font><font color="#000080">print</font><font color="#800080">(rotulo(</font><font color="#008080">$sreg</font><font color="#800080">, </font><font color="#FF0000">0</font><font color="#800080">).</font><font color="#800000">&quot;\n&quot;</font><font color="#800080">);
      }
   }
} </font><font color="#0000FF">elsif </font><font color="#800080">(</font><font color="#008080">$sreg</font><font color="#800080">==</font><font color="#008080">$opVenda</font><font color="#800080">) {
   </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$sacao</font><font color="#800080">==</font><font color="#008080">$opPesquisar</font><font color="#800080">) {
      </font><font color="#008080">$slinha </font><font color="#800080">= validaEntrada(tfVenda, </font><font color="#008080">$sreg</font><font color="#800080">, </font><font color="#FF0000">2</font><font color="#800080">, </font><font color="#008080">$tVenda</font><font color="#800080">{</font><font color="#800000">&quot;cpf&quot;</font><font color="#800080">}, </font><font color="#FF0000">1</font><font color="#800080">, </font><font color="#008080">$true</font><font color="#800080">,</font><font color="#008080">$opTexto</font><font color="#800080">);
   } </font><font color="#0000FF">elsif </font><font color="#800080">(</font><font color="#008080">$sacao</font><font color="#800080">==</font><font color="#008080">$opListarTodos</font><font color="#800080">) {
      </font><font color="#0000FF">if </font><font color="#800080">(ListarTodos(tfVenda, </font><font color="#008080">$sreg</font><font color="#800080">, </font><font color="#800000">&quot;&quot;</font><font color="#800080">, </font><font color="#FF0000">0</font><font color="#800080">, </font><font color="#FF0000">0</font><font color="#800080">, tamReg(</font><font color="#008080">$sreg</font><font color="#800080">),
        </font><font color="#008080">$QTD_MAX_LINHA</font><font color="#800080">, </font><font color="#008080">$false</font><font color="#800080">) == </font><font color="#008080">$false</font><font color="#800080">) {
        </font><font color="#000080">print</font><font color="#800080">(rotulo(</font><font color="#008080">$sreg</font><font color="#800080">, </font><font color="#FF0000">0</font><font color="#800080">).</font><font color="#800000">&quot;\n&quot;</font><font color="#800080">);
      }
   }
}
</font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#000080">length</font><font color="#800080">(</font><font color="#008080">$slinha</font><font color="#800080">)==</font><font color="#FF0000">0</font><font color="#800080">) {
   </font><font color="#000080">print</font><font color="#800080">(</font><font color="#800000">&quot;&quot;</font><font color="#800080">);
}
}
</font><font color="#808080"><i>#------------------------------------------------------------------------------
# Mostra a tela de altera&ccedil;&atilde;o de senha do sistema e realiza a altera&ccedil;&atilde;o.
#------------------------------------------------------------------------------
</i></font><font color="#0000FF">sub </font><font color="#800080">frmAlterarSenha {
</font><font color="#0000FF">my </font><font color="#008080">$sres</font><font color="#800080">; </font><font color="#0000FF">my </font><font color="#008080">$sSenhaAtual</font><font color="#800080">; </font><font color="#0000FF">my </font><font color="#008080">$sNovaSenha</font><font color="#800080">; </font><font color="#0000FF">my </font><font color="#008080">$sConfirmaSenha</font><font color="#800080">;

</font><font color="#000080">print</font><font color="#800080">(rotulo(</font><font color="#008080">$opUsuario</font><font color="#800080">, </font><font color="#FF0000">1</font><font color="#800080">).</font><font color="#008080">$tUsuario</font><font color="#800080">{</font><font color="#800000">&quot;login&quot;</font><font color="#800080">}.</font><font color="#800000">&quot;\n&quot;</font><font color="#800080">);
</font><font color="#0000FF">my </font><font color="#008080">$nopcao </font><font color="#800080">= </font><font color="#FF0000">1</font><font color="#800080">;
</font><font color="#0000FF">my </font><font color="#008080">$bQuebra </font><font color="#800080">= </font><font color="#008080">$false</font><font color="#800080">;
</font><font color="#0000FF">while </font><font color="#800080">(</font><font color="#008080">$bQuebra</font><font color="#800080">==</font><font color="#008080">$false</font><font color="#800080">) {
  SWITCH: {
    </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$nopcao</font><font color="#800080">==</font><font color="#FF0000">1</font><font color="#800080">) {
       </font><font color="#008080">$sSenhaAtual </font><font color="#800080">= digitaSenha(</font><font color="#800000">&quot;Senha Atual: &quot;</font><font color="#800080">, </font><font color="#FF0000">10</font><font color="#800080">);
       </font><font color="#0000FF">if </font><font color="#800080">(strcmp(</font><font color="#008080">$sSenhaAtual</font><font color="#800080">,</font><font color="#008080">$tUsuario</font><font color="#800080">{</font><font color="#800000">&quot;senha&quot;</font><font color="#800080">})==</font><font color="#008080">$false</font><font color="#800080">) {
          </font><font color="#000080">print</font><font color="#800080">(</font><font color="#008080">$MSG_SENCONFERE</font><font color="#800080">);
          </font><font color="#008080">$bQuebra </font><font color="#800080">= </font><font color="#008080">$true</font><font color="#800080">;
       } </font><font color="#0000FF">else </font><font color="#800080">{ </font><font color="#008080">$nopcao </font><font color="#800080">= </font><font color="#FF0000">2</font><font color="#800080">; }
       </font><font color="#0000FF">last </font><font color="#800080">SWITCH;
    }
    </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$nopcao</font><font color="#800080">==</font><font color="#FF0000">2</font><font color="#800080">) {
       </font><font color="#008080">$sNovaSenha </font><font color="#800080">= digitaSenha(</font><font color="#800000">&quot;Nova Senha: &quot;</font><font color="#800080">, </font><font color="#FF0000">10</font><font color="#800080">);
       </font><font color="#008080">$sConfirmaSenha </font><font color="#800080">= digitaSenha(</font><font color="#800000">&quot;Confirma Senha: &quot;</font><font color="#800080">, </font><font color="#FF0000">10</font><font color="#800080">);
       </font><font color="#0000FF">if </font><font color="#800080">(strcmp(</font><font color="#008080">$sNovaSenha</font><font color="#800080">,</font><font color="#008080">$sConfirmaSenha</font><font color="#800080">)==</font><font color="#008080">$false</font><font color="#800080">) {
          </font><font color="#000080">print</font><font color="#800080">(</font><font color="#008080">$MSG_SENCONFIRM</font><font color="#800080">);
          </font><font color="#008080">$bQuebra </font><font color="#800080">= </font><font color="#008080">$true</font><font color="#800080">;
       } </font><font color="#0000FF">else </font><font color="#800080">{ </font><font color="#008080">$nopcao </font><font color="#800080">= </font><font color="#FF0000">3</font><font color="#800080">; }
       </font><font color="#0000FF">last </font><font color="#800080">SWITCH;
    }
    </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$nopcao</font><font color="#800080">==</font><font color="#FF0000">3</font><font color="#800080">) {
       </font><font color="#008080">$sres </font><font color="#800080">= pesqArq(tfUsuario, </font><font color="#008080">$tUsuario</font><font color="#800080">{</font><font color="#800000">&quot;login&quot;</font><font color="#800080">}, </font><font color="#FF0000">1</font><font color="#800080">, </font><font color="#FF0000">10</font><font color="#800080">, tamReg(</font><font color="#008080">$opUsuario</font><font color="#800080">));
       </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#000080">length</font><font color="#800080">(</font><font color="#008080">$sres</font><font color="#800080">)==</font><font color="#FF0000">0</font><font color="#800080">) {
         </font><font color="#000080">print</font><font color="#800080">(</font><font color="#008080">$MSG_LOGINENCON</font><font color="#800080">);
       } </font><font color="#0000FF">else </font><font color="#800080">{
         </font><font color="#008080">$tUsuario</font><font color="#800080">{</font><font color="#800000">&quot;senha&quot;</font><font color="#800080">} = </font><font color="#008080">$sConfirmaSenha</font><font color="#800080">;
         subMenu(</font><font color="#FF0000">9</font><font color="#800080">,</font><font color="#008080">$opUsuario</font><font color="#800080">);
         </font><font color="#008080">$bQuebra </font><font color="#800080">= </font><font color="#008080">$true</font><font color="#800080">;
       }
       </font><font color="#0000FF">last </font><font color="#800080">SWITCH;
    }
  }
}
}
</font><font color="#808080"><i>#------------------------------------------------------------------------------
# Executa uma a&ccedil;&atilde;o de grava&ccedil;&atilde;o de acordo com o tipo de arquivo.
# sreg - o tipo de arquivo
# sacao - a a&ccedil;&atilde;o a ser realizada
#------------------------------------------------------------------------------
</i></font><font color="#0000FF">sub </font><font color="#800080">btnAcao {
</font><font color="#0000FF">my </font><font color="#008080">$sreg </font><font color="#800080">= </font><font color="#FF00FF">$_</font><font color="#800080">[</font><font color="#FF0000">0</font><font color="#800080">];
</font><font color="#0000FF">my </font><font color="#008080">$sacao </font><font color="#800080">= </font><font color="#FF00FF">$_</font><font color="#800080">[</font><font color="#FF0000">1</font><font color="#800080">];

</font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$sreg</font><font color="#800080">==</font><font color="#008080">$opAssunto</font><font color="#800080">) {
   </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$sacao</font><font color="#800080">==</font><font color="#008080">$opSalvarInclusao</font><font color="#800080">) {
      escreveArq(tfAssunto, LinhaReg(</font><font color="#008080">$sreg</font><font color="#800080">), </font><font color="#008080">$MSG_REGINC</font><font color="#800080">, </font><font color="#008080">$MSG_REGNINC</font><font color="#800080">);
   } </font><font color="#0000FF">elsif </font><font color="#800080">(</font><font color="#008080">$sacao</font><font color="#800080">==</font><font color="#008080">$opSalvarAlteracao</font><font color="#800080">) {
      escreveArq(tfAssunto, LinhaReg(</font><font color="#008080">$sreg</font><font color="#800080">), </font><font color="#008080">$MSG_REGALT</font><font color="#800080">, </font><font color="#008080">$MSG_REGNALT</font><font color="#800080">);
   } </font><font color="#0000FF">elsif </font><font color="#800080">(</font><font color="#008080">$sacao</font><font color="#800080">==</font><font color="#008080">$opConfirmaExclusao</font><font color="#800080">) {
      escreveArq(tfAssunto, repete(</font><font color="#800000">&quot;*&quot;</font><font color="#800080">,tamReg(</font><font color="#008080">$sreg</font><font color="#800080">)), </font><font color="#008080">$MSG_REGEXC</font><font color="#800080">, </font><font color="#008080">$MSG_REGNEXC</font><font color="#800080">);
   }
} </font><font color="#0000FF">elsif </font><font color="#800080">(</font><font color="#008080">$sreg</font><font color="#800080">==</font><font color="#008080">$opAutor</font><font color="#800080">) {
   </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$sacao</font><font color="#800080">==</font><font color="#008080">$opSalvarInclusao</font><font color="#800080">) {
      escreveArq(tfAutor, LinhaReg(</font><font color="#008080">$sreg</font><font color="#800080">), </font><font color="#008080">$MSG_REGINC</font><font color="#800080">, </font><font color="#008080">$MSG_REGNINC</font><font color="#800080">);
   } </font><font color="#0000FF">elsif </font><font color="#800080">(</font><font color="#008080">$sacao</font><font color="#800080">==</font><font color="#008080">$opSalvarAlteracao</font><font color="#800080">) {
      escreveArq(tfAutor, LinhaReg(</font><font color="#008080">$sreg</font><font color="#800080">), </font><font color="#008080">$MSG_REGALT</font><font color="#800080">, </font><font color="#008080">$MSG_REGNALT</font><font color="#800080">);
   } </font><font color="#0000FF">elsif </font><font color="#800080">(</font><font color="#008080">$sacao</font><font color="#800080">==</font><font color="#008080">$opConfirmaExclusao</font><font color="#800080">) {
      escreveArq(tfAutor, repete(</font><font color="#800000">&quot;*&quot;</font><font color="#800080">,tamReg(</font><font color="#008080">$sreg</font><font color="#800080">)), </font><font color="#008080">$MSG_REGEXC</font><font color="#800080">, </font><font color="#008080">$MSG_REGNEXC</font><font color="#800080">);
   }
} </font><font color="#0000FF">elsif </font><font color="#800080">(</font><font color="#008080">$sreg</font><font color="#800080">==</font><font color="#008080">$opEditora</font><font color="#800080">) {
   </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$sacao</font><font color="#800080">==</font><font color="#008080">$opSalvarInclusao</font><font color="#800080">) {
      escreveArq(tfEditora, LinhaReg(</font><font color="#008080">$sreg</font><font color="#800080">), </font><font color="#008080">$MSG_REGINC</font><font color="#800080">, </font><font color="#008080">$MSG_REGNINC</font><font color="#800080">);
   } </font><font color="#0000FF">elsif </font><font color="#800080">(</font><font color="#008080">$sacao</font><font color="#800080">==</font><font color="#008080">$opSalvarAlteracao</font><font color="#800080">) {
      escreveArq(tfEditora, LinhaReg(</font><font color="#008080">$sreg</font><font color="#800080">), </font><font color="#008080">$MSG_REGALT</font><font color="#800080">, </font><font color="#008080">$MSG_REGNALT</font><font color="#800080">);
   } </font><font color="#0000FF">elsif </font><font color="#800080">(</font><font color="#008080">$sacao</font><font color="#800080">==</font><font color="#008080">$opConfirmaExclusao</font><font color="#800080">) {
      escreveArq(tfEditora, repete(</font><font color="#800000">&quot;*&quot;</font><font color="#800080">,tamReg(</font><font color="#008080">$sreg</font><font color="#800080">)), </font><font color="#008080">$MSG_REGEXC</font><font color="#800080">, </font><font color="#008080">$MSG_REGNEXC</font><font color="#800080">);
   }
} </font><font color="#0000FF">elsif </font><font color="#800080">(</font><font color="#008080">$sreg</font><font color="#800080">==</font><font color="#008080">$opEndereco</font><font color="#800080">) {
   </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$sacao</font><font color="#800080">==</font><font color="#008080">$opSalvarInclusao</font><font color="#800080">) {
      escreveArq(tfEndereco, LinhaReg(</font><font color="#008080">$sreg</font><font color="#800080">), </font><font color="#008080">$MSG_REGINC</font><font color="#800080">, </font><font color="#008080">$MSG_REGNINC</font><font color="#800080">);
   } </font><font color="#0000FF">elsif </font><font color="#800080">(</font><font color="#008080">$sacao</font><font color="#800080">==</font><font color="#008080">$opSalvarAlteracao</font><font color="#800080">) {
      escreveArq(tfEndereco, LinhaReg(</font><font color="#008080">$sreg</font><font color="#800080">), </font><font color="#008080">$MSG_REGALT</font><font color="#800080">, </font><font color="#008080">$MSG_REGNALT</font><font color="#800080">);
   } </font><font color="#0000FF">elsif </font><font color="#800080">(</font><font color="#008080">$sacao</font><font color="#800080">==</font><font color="#008080">$opConfirmaExclusao</font><font color="#800080">) {
      escreveArq(tfEndereco, repete(</font><font color="#800000">&quot;*&quot;</font><font color="#800080">,tamReg(</font><font color="#008080">$sreg</font><font color="#800080">)), </font><font color="#008080">$MSG_REGEXC</font><font color="#800080">, </font><font color="#008080">$MSG_REGNEXC</font><font color="#800080">);
   }
} </font><font color="#0000FF">elsif </font><font color="#800080">(</font><font color="#008080">$sreg</font><font color="#800080">==</font><font color="#008080">$opIdioma</font><font color="#800080">) {
   </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$sacao</font><font color="#800080">==</font><font color="#008080">$opSalvarInclusao</font><font color="#800080">) {
      escreveArq(tfIdioma, LinhaReg(</font><font color="#008080">$sreg</font><font color="#800080">), </font><font color="#008080">$MSG_REGINC</font><font color="#800080">, </font><font color="#008080">$MSG_REGNINC</font><font color="#800080">);
   } </font><font color="#0000FF">elsif </font><font color="#800080">(</font><font color="#008080">$sacao</font><font color="#800080">==</font><font color="#008080">$opSalvarAlteracao</font><font color="#800080">) {
      escreveArq(tfIdioma, LinhaReg(</font><font color="#008080">$sreg</font><font color="#800080">), </font><font color="#008080">$MSG_REGALT</font><font color="#800080">, </font><font color="#008080">$MSG_REGNALT</font><font color="#800080">);
   } </font><font color="#0000FF">elsif </font><font color="#800080">(</font><font color="#008080">$sacao</font><font color="#800080">==</font><font color="#008080">$opConfirmaExclusao</font><font color="#800080">) {
      escreveArq(tfIdioma, repete(</font><font color="#800000">&quot;*&quot;</font><font color="#800080">,tamReg(</font><font color="#008080">$sreg</font><font color="#800080">)), </font><font color="#008080">$MSG_REGEXC</font><font color="#800080">, </font><font color="#008080">$MSG_REGNEXC</font><font color="#800080">);
   }
} </font><font color="#0000FF">elsif </font><font color="#800080">(</font><font color="#008080">$sreg</font><font color="#800080">==</font><font color="#008080">$opPais</font><font color="#800080">) {
   </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$sacao</font><font color="#800080">==</font><font color="#008080">$opSalvarInclusao</font><font color="#800080">) {
      escreveArq(tfPais, LinhaReg(</font><font color="#008080">$sreg</font><font color="#800080">), </font><font color="#008080">$MSG_REGINC</font><font color="#800080">, </font><font color="#008080">$MSG_REGNINC</font><font color="#800080">);
   } </font><font color="#0000FF">elsif </font><font color="#800080">(</font><font color="#008080">$sacao</font><font color="#800080">==</font><font color="#008080">$opSalvarAlteracao</font><font color="#800080">) {
      escreveArq(tfPais, LinhaReg(</font><font color="#008080">$sreg</font><font color="#800080">), </font><font color="#008080">$MSG_REGALT</font><font color="#800080">, </font><font color="#008080">$MSG_REGNALT</font><font color="#800080">);
   } </font><font color="#0000FF">elsif </font><font color="#800080">(</font><font color="#008080">$sacao</font><font color="#800080">==</font><font color="#008080">$opConfirmaExclusao</font><font color="#800080">) {
      escreveArq(tfPais, repete(</font><font color="#800000">&quot;*&quot;</font><font color="#800080">,tamReg(</font><font color="#008080">$sreg</font><font color="#800080">)), </font><font color="#008080">$MSG_REGEXC</font><font color="#800080">, </font><font color="#008080">$MSG_REGNEXC</font><font color="#800080">);
   }
} </font><font color="#0000FF">elsif </font><font color="#800080">(</font><font color="#008080">$sreg</font><font color="#800080">==</font><font color="#008080">$opProfissao</font><font color="#800080">) {
   </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$sacao</font><font color="#800080">==</font><font color="#008080">$opSalvarInclusao</font><font color="#800080">) {
      escreveArq(tfProfissao, LinhaReg(</font><font color="#008080">$sreg</font><font color="#800080">), </font><font color="#008080">$MSG_REGINC</font><font color="#800080">, </font><font color="#008080">$MSG_REGNINC</font><font color="#800080">);
   } </font><font color="#0000FF">elsif </font><font color="#800080">(</font><font color="#008080">$sacao</font><font color="#800080">==</font><font color="#008080">$opSalvarAlteracao</font><font color="#800080">) {
      escreveArq(tfProfissao, LinhaReg(</font><font color="#008080">$sreg</font><font color="#800080">), </font><font color="#008080">$MSG_REGALT</font><font color="#800080">, </font><font color="#008080">$MSG_REGNALT</font><font color="#800080">);
   } </font><font color="#0000FF">elsif </font><font color="#800080">(</font><font color="#008080">$sacao</font><font color="#800080">==</font><font color="#008080">$opConfirmaExclusao</font><font color="#800080">) {
     escreveArq(tfProfissao, repete(</font><font color="#800000">&quot;*&quot;</font><font color="#800080">,tamReg(</font><font color="#008080">$sreg</font><font color="#800080">)), </font><font color="#008080">$MSG_REGEXC</font><font color="#800080">, </font><font color="#008080">$MSG_REGNEXC</font><font color="#800080">);
   }
} </font><font color="#0000FF">elsif </font><font color="#800080">(</font><font color="#008080">$sreg</font><font color="#800080">==</font><font color="#008080">$opLivro</font><font color="#800080">) {
   </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$sacao</font><font color="#800080">==</font><font color="#008080">$opSalvarInclusao</font><font color="#800080">) {
      escreveArq(tfLivro, LinhaReg(</font><font color="#008080">$sreg</font><font color="#800080">), </font><font color="#008080">$MSG_REGINC</font><font color="#800080">, </font><font color="#008080">$MSG_REGNINC</font><font color="#800080">);
   } </font><font color="#0000FF">elsif </font><font color="#800080">(</font><font color="#008080">$sacao</font><font color="#800080">==</font><font color="#008080">$opSalvarAlteracao</font><font color="#800080">) {
      escreveArq(tfLivro, LinhaReg(</font><font color="#008080">$sreg</font><font color="#800080">), </font><font color="#008080">$MSG_REGALT</font><font color="#800080">, </font><font color="#008080">$MSG_REGNALT</font><font color="#800080">);
   } </font><font color="#0000FF">elsif </font><font color="#800080">(</font><font color="#008080">$sacao</font><font color="#800080">==</font><font color="#008080">$opConfirmaExclusao</font><font color="#800080">) {
      escreveArq(tfLivro, repete(</font><font color="#800000">&quot;*&quot;</font><font color="#800080">,tamReg(</font><font color="#008080">$sreg</font><font color="#800080">)), </font><font color="#008080">$MSG_REGEXC</font><font color="#800080">, </font><font color="#008080">$MSG_REGNEXC</font><font color="#800080">);
   }
} </font><font color="#0000FF">elsif </font><font color="#800080">(</font><font color="#008080">$sreg</font><font color="#800080">==</font><font color="#008080">$opLivroAss</font><font color="#800080">) {
   </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$sacao</font><font color="#800080">==</font><font color="#008080">$opSalvarInclusao</font><font color="#800080">) {
      escreveArq(tfLivroAss, LinhaReg(</font><font color="#008080">$sreg</font><font color="#800080">), </font><font color="#008080">$MSG_REGINC</font><font color="#800080">, </font><font color="#008080">$MSG_REGNINC</font><font color="#800080">);
   } </font><font color="#0000FF">elsif </font><font color="#800080">(</font><font color="#008080">$sacao</font><font color="#800080">==</font><font color="#008080">$opSalvarAlteracao</font><font color="#800080">) {
      escreveArq(tfLivroAss, LinhaReg(</font><font color="#008080">$sreg</font><font color="#800080">), </font><font color="#008080">$MSG_REGALT</font><font color="#800080">, </font><font color="#008080">$MSG_REGNALT</font><font color="#800080">);
   } </font><font color="#0000FF">elsif </font><font color="#800080">(</font><font color="#008080">$sacao</font><font color="#800080">==</font><font color="#008080">$opConfirmaExclusao</font><font color="#800080">) {
      escreveArq(tfLivroAss, repete(</font><font color="#800000">&quot;*&quot;</font><font color="#800080">,tamReg(</font><font color="#008080">$sreg</font><font color="#800080">)), </font><font color="#008080">$MSG_REGEXC</font><font color="#800080">, </font><font color="#008080">$MSG_REGNEXC</font><font color="#800080">);
   }
} </font><font color="#0000FF">elsif </font><font color="#800080">(</font><font color="#008080">$sreg</font><font color="#800080">==</font><font color="#008080">$opLivroAut</font><font color="#800080">) {
   </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$sacao</font><font color="#800080">==</font><font color="#008080">$opSalvarInclusao</font><font color="#800080">) {
      escreveArq(tfLivroAut, LinhaReg(</font><font color="#008080">$sreg</font><font color="#800080">), </font><font color="#008080">$MSG_REGINC</font><font color="#800080">, </font><font color="#008080">$MSG_REGNINC</font><font color="#800080">);
   } </font><font color="#0000FF">elsif </font><font color="#800080">(</font><font color="#008080">$sacao</font><font color="#800080">==</font><font color="#008080">$opSalvarAlteracao</font><font color="#800080">) {
      escreveArq(tfLivroAut, LinhaReg(</font><font color="#008080">$sreg</font><font color="#800080">), </font><font color="#008080">$MSG_REGALT</font><font color="#800080">, </font><font color="#008080">$MSG_REGNALT</font><font color="#800080">);
   } </font><font color="#0000FF">elsif </font><font color="#800080">(</font><font color="#008080">$sacao</font><font color="#800080">==</font><font color="#008080">$opConfirmaExclusao</font><font color="#800080">) {
      escreveArq(tfLivroAut, repete(</font><font color="#800000">&quot;*&quot;</font><font color="#800080">,tamReg(</font><font color="#008080">$sreg</font><font color="#800080">)), </font><font color="#008080">$MSG_REGEXC</font><font color="#800080">, </font><font color="#008080">$MSG_REGNEXC</font><font color="#800080">);
   }
} </font><font color="#0000FF">elsif </font><font color="#800080">(</font><font color="#008080">$sreg</font><font color="#800080">==</font><font color="#008080">$opCliente</font><font color="#800080">) {
   </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$sacao</font><font color="#800080">==</font><font color="#008080">$opSalvarInclusao</font><font color="#800080">) {
      escreveArq(tfCliente, LinhaReg(</font><font color="#008080">$sreg</font><font color="#800080">), </font><font color="#008080">$MSG_REGINC</font><font color="#800080">, </font><font color="#008080">$MSG_REGNINC</font><font color="#800080">);
   } </font><font color="#0000FF">elsif </font><font color="#800080">(</font><font color="#008080">$sacao</font><font color="#800080">==</font><font color="#008080">$opSalvarAlteracao</font><font color="#800080">) {
      escreveArq(tfCliente, LinhaReg(</font><font color="#008080">$sreg</font><font color="#800080">), </font><font color="#008080">$MSG_REGALT</font><font color="#800080">, </font><font color="#008080">$MSG_REGNALT</font><font color="#800080">);
   } </font><font color="#0000FF">elsif </font><font color="#800080">(</font><font color="#008080">$sacao</font><font color="#800080">==</font><font color="#008080">$opConfirmaExclusao</font><font color="#800080">) {
      escreveArq(tfCliente, repete(</font><font color="#800000">&quot;*&quot;</font><font color="#800080">,tamReg(</font><font color="#008080">$sreg</font><font color="#800080">)), </font><font color="#008080">$MSG_REGEXC</font><font color="#800080">, </font><font color="#008080">$MSG_REGNEXC</font><font color="#800080">);
   }
} </font><font color="#0000FF">elsif </font><font color="#800080">(</font><font color="#008080">$sreg</font><font color="#800080">==</font><font color="#008080">$opVenda</font><font color="#800080">) {
   </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$sacao</font><font color="#800080">==</font><font color="#008080">$opSalvarInclusao</font><font color="#800080">) {
      escreveArq(tfVenda, LinhaReg(</font><font color="#008080">$sreg</font><font color="#800080">), </font><font color="#008080">$MSG_REGINC</font><font color="#800080">, </font><font color="#008080">$MSG_REGNINC</font><font color="#800080">);
   } </font><font color="#0000FF">elsif </font><font color="#800080">(</font><font color="#008080">$sacao</font><font color="#800080">==</font><font color="#008080">$opSalvarAlteracao</font><font color="#800080">) {
      escreveArq(tfVenda, LinhaReg(</font><font color="#008080">$sreg</font><font color="#800080">), </font><font color="#008080">$MSG_REGALT</font><font color="#800080">, </font><font color="#008080">$MSG_REGNALT</font><font color="#800080">);
   } </font><font color="#0000FF">elsif </font><font color="#800080">(</font><font color="#008080">$sacao</font><font color="#800080">==</font><font color="#008080">$opConfirmaExclusao</font><font color="#800080">) {
      escreveArq(tfVenda, repete(</font><font color="#800000">&quot;*&quot;</font><font color="#800080">,tamReg(</font><font color="#008080">$sreg</font><font color="#800080">)), </font><font color="#008080">$MSG_REGEXC</font><font color="#800080">, </font><font color="#008080">$MSG_REGNEXC</font><font color="#800080">);
   }
} </font><font color="#0000FF">elsif </font><font color="#800080">(</font><font color="#008080">$sreg</font><font color="#800080">==</font><font color="#008080">$opUsuario</font><font color="#800080">) {
   </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$sacao</font><font color="#800080">==</font><font color="#008080">$opSalvarAlteracao</font><font color="#800080">) {
      escreveArq(tfUsuario, LinhaReg(</font><font color="#008080">$sreg</font><font color="#800080">), </font><font color="#008080">$MSG_REGALT</font><font color="#800080">, </font><font color="#008080">$MSG_REGNALT</font><font color="#800080">);
   }
}
}
</font><font color="#808080"><i>#------------------------------------------------------------------------------
# Seleciona o menu e/ou a tela certa de acordo com o tipo de arquivo.
# nmenu - o n&uacute;mero do menu
# sreg - o tipo de arquivo
#------------------------------------------------------------------------------
</i></font><font color="#0000FF">sub </font><font color="#800080">subMenu {
</font><font color="#0000FF">my </font><font color="#008080">$nmenu </font><font color="#800080">= </font><font color="#FF00FF">$_</font><font color="#800080">[</font><font color="#FF0000">0</font><font color="#800080">];
</font><font color="#0000FF">my </font><font color="#008080">$sreg </font><font color="#800080">= </font><font color="#FF00FF">$_</font><font color="#800080">[</font><font color="#FF0000">1</font><font color="#800080">];

</font><font color="#0000FF">my </font><font color="#008080">$opSubMenu</font><font color="#800080">;
</font><font color="#0000FF">my </font><font color="#008080">$opCSubMenu</font><font color="#800080">;
</font><font color="#0000FF">my </font><font color="#008080">$bSOp </font><font color="#800080">= </font><font color="#008080">$true</font><font color="#800080">;
SWITCH: {
  </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$nmenu </font><font color="#800080">== </font><font color="#FF0000">6</font><font color="#800080">) {
    </font><font color="#0000FF">while </font><font color="#800080">(</font><font color="#008080">$bSOp </font><font color="#800080">== </font><font color="#008080">$true</font><font color="#800080">) {
      menu(</font><font color="#008080">$nmenu</font><font color="#800080">);
      </font><font color="#008080">$opSubMenu </font><font color="#800080">= digita();
      SWITCH : {
        </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$opSubMenu </font><font color="#800080">== </font><font color="#FF0000">1</font><font color="#800080">) { frmCadastros(</font><font color="#008080">$sreg</font><font color="#800080">, </font><font color="#008080">$opNovo</font><font color="#800080">); </font><font color="#0000FF">last </font><font color="#800080">SWITCH; }
        </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$opSubMenu </font><font color="#800080">== </font><font color="#FF0000">2</font><font color="#800080">) { frmCadastros(</font><font color="#008080">$sreg</font><font color="#800080">, </font><font color="#008080">$opPesquisar</font><font color="#800080">); </font><font color="#0000FF">last </font><font color="#800080">SWITCH; }
        </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$opSubMenu </font><font color="#800080">== </font><font color="#FF0000">3</font><font color="#800080">) { </font><font color="#008080">$bSOp </font><font color="#800080">= </font><font color="#008080">$false</font><font color="#800080">; </font><font color="#0000FF">last </font><font color="#800080">SWITCH; }
</font><font color="#FFFFFF">	      </font><font color="#000080">print</font><font color="#800080">(</font><font color="#008080">$MSG_ERRO</font><font color="#800080">);
      }
    }
    </font><font color="#0000FF">last </font><font color="#800080">SWITCH;
  }
  </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$nmenu </font><font color="#800080">== </font><font color="#FF0000">7</font><font color="#800080">) {
    </font><font color="#0000FF">while </font><font color="#800080">(</font><font color="#008080">$bSOp </font><font color="#800080">== </font><font color="#008080">$true</font><font color="#800080">) {
      menu(</font><font color="#008080">$nmenu</font><font color="#800080">);
      </font><font color="#008080">$opSubMenu </font><font color="#800080">= digita();
      SWITCH : {
        </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$opSubMenu </font><font color="#800080">== </font><font color="#FF0000">1</font><font color="#800080">) { 
          btnAcao(</font><font color="#008080">$sreg</font><font color="#800080">, </font><font color="#008080">$opSalvarInclusao</font><font color="#800080">); </font><font color="#008080">$bSOp </font><font color="#800080">= </font><font color="#008080">$false</font><font color="#800080">; </font><font color="#0000FF">last </font><font color="#800080">SWITCH; }
        </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$opSubMenu </font><font color="#800080">== </font><font color="#FF0000">2</font><font color="#800080">) { </font><font color="#008080">$bSOp </font><font color="#800080">= </font><font color="#008080">$false</font><font color="#800080">; </font><font color="#0000FF">last </font><font color="#800080">SWITCH; }
        </font><font color="#000080">print</font><font color="#800080">(</font><font color="#008080">$MSG_ERRO</font><font color="#800080">);
      }
    }
    </font><font color="#0000FF">last </font><font color="#800080">SWITCH;
  }
  </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$nmenu </font><font color="#800080">== </font><font color="#FF0000">8</font><font color="#800080">) {
    </font><font color="#0000FF">while </font><font color="#800080">(</font><font color="#008080">$bSOp </font><font color="#800080">== </font><font color="#008080">$true</font><font color="#800080">) {
      menu(</font><font color="#008080">$nmenu</font><font color="#800080">);
      </font><font color="#008080">$opSubMenu </font><font color="#800080">= digita();
      SWITCH : {
        </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$opSubMenu </font><font color="#800080">== </font><font color="#FF0000">1</font><font color="#800080">) { 
          frmCadastros(</font><font color="#008080">$sreg</font><font color="#800080">, </font><font color="#008080">$opAlterar</font><font color="#800080">); </font><font color="#008080">$bSOp </font><font color="#800080">= </font><font color="#008080">$false</font><font color="#800080">; </font><font color="#0000FF">last </font><font color="#800080">SWITCH; }
        </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$opSubMenu </font><font color="#800080">== </font><font color="#FF0000">2</font><font color="#800080">) { 
          frmCadastros(</font><font color="#008080">$sreg</font><font color="#800080">, </font><font color="#008080">$opExcluir</font><font color="#800080">); </font><font color="#008080">$bSOp </font><font color="#800080">= </font><font color="#008080">$false</font><font color="#800080">; </font><font color="#0000FF">last </font><font color="#800080">SWITCH; }
        </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$opSubMenu </font><font color="#800080">== </font><font color="#FF0000">3</font><font color="#800080">) { </font><font color="#008080">$bSOp </font><font color="#800080">= </font><font color="#008080">$false</font><font color="#800080">; </font><font color="#0000FF">last </font><font color="#800080">SWITCH; }
        </font><font color="#000080">print</font><font color="#800080">(</font><font color="#008080">$MSG_ERRO</font><font color="#800080">);
      }
    }
    </font><font color="#0000FF">last </font><font color="#800080">SWITCH;
  }
  </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$nmenu </font><font color="#800080">== </font><font color="#FF0000">9</font><font color="#800080">) {
    </font><font color="#0000FF">while </font><font color="#800080">(</font><font color="#008080">$bSOp </font><font color="#800080">== </font><font color="#008080">$true</font><font color="#800080">) {
      menu(</font><font color="#008080">$nmenu</font><font color="#800080">);
      </font><font color="#008080">$opSubMenu </font><font color="#800080">= digita();
      SWITCH : {
        </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$opSubMenu </font><font color="#800080">== </font><font color="#FF0000">1</font><font color="#800080">) { 
          btnAcao(</font><font color="#008080">$sreg</font><font color="#800080">, </font><font color="#008080">$opSalvarAlteracao</font><font color="#800080">); </font><font color="#008080">$bSOp </font><font color="#800080">= </font><font color="#008080">$false</font><font color="#800080">; </font><font color="#0000FF">last </font><font color="#800080">SWITCH; }
        </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$opSubMenu </font><font color="#800080">== </font><font color="#FF0000">2</font><font color="#800080">) { </font><font color="#008080">$bSOp </font><font color="#800080">= </font><font color="#008080">$false</font><font color="#800080">; </font><font color="#0000FF">last </font><font color="#800080">SWITCH; }
        </font><font color="#000080">print</font><font color="#800080">(</font><font color="#008080">$MSG_ERRO</font><font color="#800080">);
      }
    }
    </font><font color="#0000FF">last </font><font color="#800080">SWITCH;
  }
  </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$nmenu </font><font color="#800080">== </font><font color="#FF0000">10</font><font color="#800080">) {
    </font><font color="#0000FF">while </font><font color="#800080">(</font><font color="#008080">$bSOp </font><font color="#800080">== </font><font color="#008080">$true</font><font color="#800080">) {
      menu(</font><font color="#008080">$nmenu</font><font color="#800080">);
      </font><font color="#008080">$opCSubMenu </font><font color="#800080">= digita();
      </font><font color="#0000FF">if </font><font color="#800080">((</font><font color="#008080">$opCSubMenu</font><font color="#800080">=~</font><font color="#800000">'S'</font><font color="#800080">) || (</font><font color="#008080">$opCSubMenu</font><font color="#800080">=~</font><font color="#800000">'s'</font><font color="#800080">)) {
        btnAcao(</font><font color="#008080">$sreg</font><font color="#800080">, </font><font color="#008080">$opConfirmaExclusao</font><font color="#800080">);
        </font><font color="#008080">$bSOp </font><font color="#800080">= </font><font color="#008080">$false</font><font color="#800080">;
      } </font><font color="#0000FF">elsif </font><font color="#800080">((</font><font color="#008080">$opCSubMenu</font><font color="#800080">=~</font><font color="#800000">'N'</font><font color="#800080">) || (</font><font color="#008080">$opCSubMenu</font><font color="#800080">=~</font><font color="#800000">'n'</font><font color="#800080">)) { 
        </font><font color="#008080">$bSOp </font><font color="#800080">= </font><font color="#008080">$false</font><font color="#800080">;
      } </font><font color="#0000FF">else </font><font color="#800080">{ 
        </font><font color="#000080">print</font><font color="#800080">(</font><font color="#008080">$MSG_ERRO</font><font color="#800080">); 
      }
    }
    </font><font color="#0000FF">last </font><font color="#800080">SWITCH;
  }
  </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$nmenu </font><font color="#800080">== </font><font color="#FF0000">12</font><font color="#800080">) {
    </font><font color="#0000FF">while </font><font color="#800080">(</font><font color="#008080">$bSOp </font><font color="#800080">== </font><font color="#008080">$true</font><font color="#800080">) {
      menu(</font><font color="#008080">$nmenu</font><font color="#800080">);
      </font><font color="#008080">$opSubMenu </font><font color="#800080">= digita();
      SWITCH : {
        </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$opSubMenu </font><font color="#800080">== </font><font color="#FF0000">1</font><font color="#800080">) { frmConsultas(</font><font color="#008080">$sreg</font><font color="#800080">, </font><font color="#008080">$opPesquisar</font><font color="#800080">); </font><font color="#0000FF">last </font><font color="#800080">SWITCH; }
        </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$opSubMenu </font><font color="#800080">== </font><font color="#FF0000">2</font><font color="#800080">) { frmConsultas(</font><font color="#008080">$sreg</font><font color="#800080">, </font><font color="#008080">$opListarTodos</font><font color="#800080">); </font><font color="#0000FF">last </font><font color="#800080">SWITCH; }
        </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$opSubMenu </font><font color="#800080">== </font><font color="#FF0000">3</font><font color="#800080">) { </font><font color="#008080">$bSOp </font><font color="#800080">= </font><font color="#008080">$false</font><font color="#800080">; </font><font color="#0000FF">last </font><font color="#800080">SWITCH; }
        </font><font color="#000080">print</font><font color="#800080">(</font><font color="#008080">$MSG_ERRO</font><font color="#800080">);
      }
    }
    </font><font color="#0000FF">last </font><font color="#800080">SWITCH;
  }
  </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$nmenu </font><font color="#800080">== </font><font color="#FF0000">14</font><font color="#800080">) {
    </font><font color="#0000FF">while </font><font color="#800080">(</font><font color="#008080">$bSOp </font><font color="#800080">== </font><font color="#008080">$true</font><font color="#800080">) {
      menu(</font><font color="#008080">$nmenu</font><font color="#800080">);
      </font><font color="#008080">$opCSubMenu </font><font color="#800080">= digita();
      </font><font color="#0000FF">if </font><font color="#800080">((</font><font color="#008080">$opCSubMenu</font><font color="#800080">=~</font><font color="#800000">'S'</font><font color="#800080">) || (</font><font color="#008080">$opCSubMenu</font><font color="#800080">=~</font><font color="#800000">'s'</font><font color="#800080">)) {
        btnAcao(</font><font color="#008080">$sreg</font><font color="#800080">, </font><font color="#008080">$opSalvarInclusao</font><font color="#800080">);
        </font><font color="#008080">$bSOp </font><font color="#800080">= </font><font color="#008080">$false</font><font color="#800080">;
        </font><font color="#008080">$g_SalvarInclusao </font><font color="#800080">= </font><font color="#008080">$true</font><font color="#800080">;
      } </font><font color="#0000FF">elsif </font><font color="#800080">((</font><font color="#008080">$opCSubMenu</font><font color="#800080">=~</font><font color="#800000">'N'</font><font color="#800080">) || (</font><font color="#008080">$opCSubMenu</font><font color="#800080">=~</font><font color="#800000">'n'</font><font color="#800080">)) { 
        </font><font color="#008080">$bSOp </font><font color="#800080">= </font><font color="#008080">$false</font><font color="#800080">;
      } </font><font color="#0000FF">else </font><font color="#800080">{
        </font><font color="#000080">print</font><font color="#800080">(</font><font color="#008080">$MSG_ERRO</font><font color="#800080">);
      } 
    }
    </font><font color="#0000FF">last </font><font color="#800080">SWITCH;
  }
}

}
</font><font color="#808080"><i>#------------------------------------------------------------------------------
# Seleciona o submenu e/ou a tela certa de acordo com n&uacute;mero do menu.
# nmenu - o n&uacute;mero do menu
#------------------------------------------------------------------------------
</i></font><font color="#0000FF">sub </font><font color="#800080">usaMenu { 
</font><font color="#0000FF">my </font><font color="#008080">$num </font><font color="#800080">= </font><font color="#000080">shift</font><font color="#800080">();

</font><font color="#0000FF">my </font><font color="#008080">$opSubMenu</font><font color="#800080">;
</font><font color="#0000FF">my </font><font color="#008080">$opSair</font><font color="#800080">;
</font><font color="#0000FF">my </font><font color="#008080">$bSOp </font><font color="#800080">= </font><font color="#008080">$true</font><font color="#800080">;
 </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$num </font><font color="#800080">== </font><font color="#FF0000">1</font><font color="#800080">) { </font><font color="#808080"><i># Cadastros
   </i></font><font color="#0000FF">while </font><font color="#800080">(</font><font color="#008080">$bSOp </font><font color="#800080">== </font><font color="#008080">$true</font><font color="#800080">) {
     menu(</font><font color="#FF0000">2</font><font color="#800080">);
     </font><font color="#008080">$opSubMenu </font><font color="#800080">= digita();
     SWITCH: {
       </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$opSubMenu</font><font color="#800080">==</font><font color="#FF0000">1</font><font color="#800080">) { subMenu(</font><font color="#FF0000">6</font><font color="#800080">, </font><font color="#008080">$opAssunto</font><font color="#800080">); </font><font color="#0000FF">last </font><font color="#800080">SWITCH; }
       </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$opSubMenu</font><font color="#800080">==</font><font color="#FF0000">2</font><font color="#800080">) { subMenu(</font><font color="#FF0000">6</font><font color="#800080">, </font><font color="#008080">$opAutor</font><font color="#800080">); </font><font color="#0000FF">last </font><font color="#800080">SWITCH; }
       </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$opSubMenu</font><font color="#800080">==</font><font color="#FF0000">3</font><font color="#800080">) { subMenu(</font><font color="#FF0000">6</font><font color="#800080">, </font><font color="#008080">$opEditora</font><font color="#800080">); </font><font color="#0000FF">last </font><font color="#800080">SWITCH; }
       </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$opSubMenu</font><font color="#800080">==</font><font color="#FF0000">4</font><font color="#800080">) { subMenu(</font><font color="#FF0000">6</font><font color="#800080">, </font><font color="#008080">$opEndereco</font><font color="#800080">); </font><font color="#0000FF">last </font><font color="#800080">SWITCH; }
       </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$opSubMenu</font><font color="#800080">==</font><font color="#FF0000">5</font><font color="#800080">) { subMenu(</font><font color="#FF0000">6</font><font color="#800080">, </font><font color="#008080">$opIdioma</font><font color="#800080">); </font><font color="#0000FF">last </font><font color="#800080">SWITCH; }
       </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$opSubMenu</font><font color="#800080">==</font><font color="#FF0000">6</font><font color="#800080">) { subMenu(</font><font color="#FF0000">6</font><font color="#800080">, </font><font color="#008080">$opPais</font><font color="#800080">); </font><font color="#0000FF">last </font><font color="#800080">SWITCH; }
       </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$opSubMenu</font><font color="#800080">==</font><font color="#FF0000">7</font><font color="#800080">) { subMenu(</font><font color="#FF0000">6</font><font color="#800080">, </font><font color="#008080">$opProfissao</font><font color="#800080">); </font><font color="#0000FF">last </font><font color="#800080">SWITCH; }
       </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$opSubMenu</font><font color="#800080">==</font><font color="#FF0000">8</font><font color="#800080">) { subMenu(</font><font color="#FF0000">6</font><font color="#800080">, </font><font color="#008080">$opCliente</font><font color="#800080">); </font><font color="#0000FF">last </font><font color="#800080">SWITCH; }
       </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$opSubMenu</font><font color="#800080">==</font><font color="#FF0000">9</font><font color="#800080">) { subMenu(</font><font color="#FF0000">6</font><font color="#800080">, </font><font color="#008080">$opLivro</font><font color="#800080">); </font><font color="#0000FF">last </font><font color="#800080">SWITCH; }
       </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$opSubMenu</font><font color="#800080">==</font><font color="#FF0000">10</font><font color="#800080">) { </font><font color="#008080">$bSOp </font><font color="#800080">= </font><font color="#008080">$false</font><font color="#800080">; </font><font color="#0000FF">last </font><font color="#800080">SWITCH; }
       </font><font color="#000080">print</font><font color="#800080">(</font><font color="#008080">$MSG_ERRO</font><font color="#800080">);
     }
   }
 } </font><font color="#0000FF">elsif </font><font color="#800080">(</font><font color="#008080">$num </font><font color="#800080">== </font><font color="#FF0000">2</font><font color="#800080">) { </font><font color="#808080"><i># Pesquisas
   </i></font><font color="#0000FF">while </font><font color="#800080">(</font><font color="#008080">$bSOp </font><font color="#800080">== </font><font color="#008080">$true</font><font color="#800080">) {
     menu(</font><font color="#FF0000">3</font><font color="#800080">);
     </font><font color="#008080">$opSubMenu </font><font color="#800080">= digita();
     SWITCH: {
       </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$opSubMenu</font><font color="#800080">==</font><font color="#FF0000">1</font><font color="#800080">) { subMenu(</font><font color="#FF0000">12</font><font color="#800080">, </font><font color="#008080">$opAssunto</font><font color="#800080">); </font><font color="#0000FF">last </font><font color="#800080">SWITCH; }
       </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$opSubMenu</font><font color="#800080">==</font><font color="#FF0000">2</font><font color="#800080">) { subMenu(</font><font color="#FF0000">12</font><font color="#800080">, </font><font color="#008080">$opAutor</font><font color="#800080">); </font><font color="#0000FF">last </font><font color="#800080">SWITCH; }
       </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$opSubMenu</font><font color="#800080">==</font><font color="#FF0000">3</font><font color="#800080">) { subMenu(</font><font color="#FF0000">12</font><font color="#800080">, </font><font color="#008080">$opEditora</font><font color="#800080">); </font><font color="#0000FF">last </font><font color="#800080">SWITCH; }
       </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$opSubMenu</font><font color="#800080">==</font><font color="#FF0000">4</font><font color="#800080">) { subMenu(</font><font color="#FF0000">12</font><font color="#800080">, </font><font color="#008080">$opEndereco</font><font color="#800080">); </font><font color="#0000FF">last </font><font color="#800080">SWITCH; }
       </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$opSubMenu</font><font color="#800080">==</font><font color="#FF0000">5</font><font color="#800080">) { subMenu(</font><font color="#FF0000">12</font><font color="#800080">, </font><font color="#008080">$opIdioma</font><font color="#800080">); </font><font color="#0000FF">last </font><font color="#800080">SWITCH; }
       </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$opSubMenu</font><font color="#800080">==</font><font color="#FF0000">6</font><font color="#800080">) { subMenu(</font><font color="#FF0000">12</font><font color="#800080">, </font><font color="#008080">$opPais</font><font color="#800080">); </font><font color="#0000FF">last </font><font color="#800080">SWITCH; }
       </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$opSubMenu</font><font color="#800080">==</font><font color="#FF0000">7</font><font color="#800080">) { subMenu(</font><font color="#FF0000">12</font><font color="#800080">, </font><font color="#008080">$opProfissao</font><font color="#800080">); </font><font color="#0000FF">last </font><font color="#800080">SWITCH; }
       </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$opSubMenu</font><font color="#800080">==</font><font color="#FF0000">8</font><font color="#800080">) { subMenu(</font><font color="#FF0000">12</font><font color="#800080">, </font><font color="#008080">$opCliente</font><font color="#800080">); </font><font color="#0000FF">last </font><font color="#800080">SWITCH; }
       </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$opSubMenu</font><font color="#800080">==</font><font color="#FF0000">9</font><font color="#800080">) { subMenu(</font><font color="#FF0000">12</font><font color="#800080">, </font><font color="#008080">$opLivro</font><font color="#800080">); </font><font color="#0000FF">last </font><font color="#800080">SWITCH; }
       </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$opSubMenu</font><font color="#800080">==</font><font color="#FF0000">10</font><font color="#800080">) { </font><font color="#008080">$bSOp </font><font color="#800080">= </font><font color="#008080">$false</font><font color="#800080">; </font><font color="#0000FF">last </font><font color="#800080">SWITCH; }
       </font><font color="#000080">print</font><font color="#800080">(</font><font color="#008080">$MSG_ERRO</font><font color="#800080">);
     }
   }
 } </font><font color="#0000FF">elsif </font><font color="#800080">(</font><font color="#008080">$num </font><font color="#800080">== </font><font color="#FF0000">3</font><font color="#800080">) { </font><font color="#808080"><i># Vendas
   </i></font><font color="#0000FF">while </font><font color="#800080">(</font><font color="#008080">$bSOp </font><font color="#800080">== </font><font color="#008080">$true</font><font color="#800080">) {
     menu(</font><font color="#FF0000">4</font><font color="#800080">);
     </font><font color="#008080">$opSubMenu </font><font color="#800080">= digita();
     SWITCH: {
       </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$opSubMenu</font><font color="#800080">==</font><font color="#FF0000">1</font><font color="#800080">) { subMenu(</font><font color="#FF0000">6</font><font color="#800080">, </font><font color="#008080">$opVenda</font><font color="#800080">); </font><font color="#0000FF">last </font><font color="#800080">SWITCH; }
       </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$opSubMenu</font><font color="#800080">==</font><font color="#FF0000">2</font><font color="#800080">) { subMenu(</font><font color="#FF0000">12</font><font color="#800080">, </font><font color="#008080">$opVenda</font><font color="#800080">); </font><font color="#0000FF">last </font><font color="#800080">SWITCH; }
       </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$opSubMenu</font><font color="#800080">==</font><font color="#FF0000">3</font><font color="#800080">) { </font><font color="#008080">$bSOp </font><font color="#800080">= </font><font color="#008080">$false</font><font color="#800080">; </font><font color="#0000FF">last </font><font color="#800080">SWITCH; }
       </font><font color="#000080">print</font><font color="#800080">(</font><font color="#008080">$MSG_ERRO</font><font color="#800080">);
     }
   }
 } </font><font color="#0000FF">elsif </font><font color="#800080">(</font><font color="#008080">$num </font><font color="#800080">== </font><font color="#FF0000">4</font><font color="#800080">) { </font><font color="#808080"><i># Opcoes
   </i></font><font color="#0000FF">while </font><font color="#800080">(</font><font color="#008080">$bSOp </font><font color="#800080">== </font><font color="#008080">$true</font><font color="#800080">) {
     menu(</font><font color="#FF0000">5</font><font color="#800080">);
     </font><font color="#008080">$opSubMenu </font><font color="#800080">= digita();
     SWITCH: {
       </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$opSubMenu</font><font color="#800080">==</font><font color="#FF0000">1</font><font color="#800080">) { frmAlterarSenha(); </font><font color="#0000FF">last </font><font color="#800080">SWITCH; }
       </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$opSubMenu</font><font color="#800080">==</font><font color="#FF0000">2</font><font color="#800080">) { frmSobre(); </font><font color="#0000FF">last </font><font color="#800080">SWITCH; }
       </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$opSubMenu</font><font color="#800080">==</font><font color="#FF0000">3</font><font color="#800080">) { 
         menu(</font><font color="#FF0000">11</font><font color="#800080">);
         </font><font color="#008080">$opSair </font><font color="#800080">= digita();
         </font><font color="#0000FF">if </font><font color="#800080">((</font><font color="#008080">$opSair</font><font color="#800080">=~</font><font color="#800000">'S'</font><font color="#800080">) || (</font><font color="#008080">$opSair</font><font color="#800080">=~</font><font color="#800000">'s'</font><font color="#800080">)) {
            fechaArqs();
            </font><font color="#0000FF">exit</font><font color="#800080">(</font><font color="#FF0000">0</font><font color="#800080">);
         }
         </font><font color="#0000FF">last </font><font color="#800080">SWITCH;
       }
       </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$opSubMenu</font><font color="#800080">==</font><font color="#FF0000">4</font><font color="#800080">) { </font><font color="#008080">$bSOp </font><font color="#800080">= </font><font color="#008080">$false</font><font color="#800080">; </font><font color="#0000FF">last </font><font color="#800080">SWITCH; }
       </font><font color="#000080">print</font><font color="#800080">(</font><font color="#008080">$MSG_ERRO</font><font color="#800080">);
     }
   }
 }
}
</font><font color="#808080"><i>#------------------------------------------------------------------------------
# Mostra as entradas e as sa&iacute;das do sistema.
# sreg - o tipo de arquivo
# slinha - o registro com os dados
# nOpcao - indica qual op&ccedil;&atilde;o ser&aacute; mostrada
#------------------------------------------------------------------------------
</i></font><font color="#0000FF">sub </font><font color="#800080">mostrarDados {
</font><font color="#0000FF">my </font><font color="#008080">$sreg </font><font color="#800080">= </font><font color="#FF00FF">$_</font><font color="#800080">[</font><font color="#FF0000">0</font><font color="#800080">];
</font><font color="#0000FF">my </font><font color="#008080">$slinha </font><font color="#800080">= </font><font color="#FF00FF">$_</font><font color="#800080">[</font><font color="#FF0000">1</font><font color="#800080">];
</font><font color="#0000FF">my </font><font color="#008080">$nOpcao </font><font color="#800080">= </font><font color="#FF00FF">$_</font><font color="#800080">[</font><font color="#FF0000">2</font><font color="#800080">];
 
</font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$sreg</font><font color="#800080">==</font><font color="#008080">$opAssunto</font><font color="#800080">) {
  SWITCH: {
    </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$nOpcao</font><font color="#800080">==</font><font color="#FF0000">1</font><font color="#800080">) {
        </font><font color="#000080">print</font><font color="#800080">(rotulo(</font><font color="#008080">$sreg</font><font color="#800080">, </font><font color="#FF0000">1</font><font color="#800080">).</font><font color="#008080">$tAssunto</font><font color="#800080">{</font><font color="#800000">&quot;codigo&quot;</font><font color="#800080">}.</font><font color="#800000">&quot;\n&quot;</font><font color="#800080">);
        </font><font color="#000080">print</font><font color="#800080">(rotulo(</font><font color="#008080">$sreg</font><font color="#800080">, </font><font color="#FF0000">2</font><font color="#800080">));
        </font><font color="#008080">$tAssunto</font><font color="#800080">{</font><font color="#800000">&quot;assunto&quot;</font><font color="#800080">} = digita();
        </font><font color="#0000FF">last </font><font color="#800080">SWITCH; 
    }
    </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$nOpcao</font><font color="#800080">==</font><font color="#FF0000">2</font><font color="#800080">) {
        </font><font color="#000080">print</font><font color="#800080">(</font><font color="#800000">&quot;C&oacute;digo     Assunto\n&quot;</font><font color="#800080">);
        </font><font color="#000080">print</font><font color="#800080">(</font><font color="#800000">&quot;------     -------\n&quot;</font><font color="#800080">);
        </font><font color="#0000FF">last </font><font color="#800080">SWITCH; 
    }
    </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$nOpcao</font><font color="#800080">==</font><font color="#FF0000">3</font><font color="#800080">) {
        </font><font color="#008080">$tAssunto</font><font color="#800080">{</font><font color="#800000">&quot;codigo&quot;</font><font color="#800080">} = trim(copy(</font><font color="#008080">$slinha</font><font color="#800080">, </font><font color="#FF0000">1</font><font color="#800080">, </font><font color="#FF0000">10</font><font color="#800080">));
        </font><font color="#008080">$tAssunto</font><font color="#800080">{</font><font color="#800000">&quot;assunto&quot;</font><font color="#800080">} = trim(copy(</font><font color="#008080">$slinha</font><font color="#800080">, </font><font color="#FF0000">11</font><font color="#800080">, </font><font color="#FF0000">30</font><font color="#800080">));
        </font><font color="#000080">print</font><font color="#800080">(esp(</font><font color="#008080">$tAssunto</font><font color="#800080">{</font><font color="#800000">&quot;codigo&quot;</font><font color="#800080">},</font><font color="#FF0000">10</font><font color="#800080">).</font><font color="#800000">&quot; &quot;</font><font color="#800080">.esp(</font><font color="#008080">$tAssunto</font><font color="#800080">{</font><font color="#800000">&quot;assunto&quot;</font><font color="#800080">},</font><font color="#FF0000">30</font><font color="#800080">).</font><font color="#800000">&quot;\n&quot;</font><font color="#800080">);
        </font><font color="#0000FF">last </font><font color="#800080">SWITCH; 
    }
  }
} </font><font color="#0000FF">elsif </font><font color="#800080">(</font><font color="#008080">$sreg</font><font color="#800080">==</font><font color="#008080">$opAutor</font><font color="#800080">) {
  SWITCH: {
    </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$nOpcao</font><font color="#800080">==</font><font color="#FF0000">1</font><font color="#800080">) {
        </font><font color="#000080">print</font><font color="#800080">(rotulo(</font><font color="#008080">$sreg</font><font color="#800080">, </font><font color="#FF0000">1</font><font color="#800080">).</font><font color="#008080">$tAutor</font><font color="#800080">{</font><font color="#800000">&quot;codigo&quot;</font><font color="#800080">}.</font><font color="#800000">&quot;\n&quot;</font><font color="#800080">);
        </font><font color="#000080">print</font><font color="#800080">(rotulo(</font><font color="#008080">$sreg</font><font color="#800080">, </font><font color="#FF0000">2</font><font color="#800080">));
        </font><font color="#008080">$tAutor</font><font color="#800080">{</font><font color="#800000">&quot;autor&quot;</font><font color="#800080">} = digita();
        </font><font color="#0000FF">last </font><font color="#800080">SWITCH; 
    }
    </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$nOpcao</font><font color="#800080">==</font><font color="#FF0000">2</font><font color="#800080">) {
        </font><font color="#000080">print</font><font color="#800080">(</font><font color="#800000">&quot;C&oacute;digo     Autor\n&quot;</font><font color="#800080">);
        </font><font color="#000080">print</font><font color="#800080">(</font><font color="#800000">&quot;------     -----\n&quot;</font><font color="#800080">);
        </font><font color="#0000FF">last </font><font color="#800080">SWITCH; 
    }
    </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$nOpcao</font><font color="#800080">==</font><font color="#FF0000">3</font><font color="#800080">) {
        </font><font color="#008080">$tAutor</font><font color="#800080">{</font><font color="#800000">&quot;codigo&quot;</font><font color="#800080">} = trim(copy(</font><font color="#008080">$slinha</font><font color="#800080">, </font><font color="#FF0000">1</font><font color="#800080">, </font><font color="#FF0000">10</font><font color="#800080">));
        </font><font color="#008080">$tAutor</font><font color="#800080">{</font><font color="#800000">&quot;autor&quot;</font><font color="#800080">} = trim(copy(</font><font color="#008080">$slinha</font><font color="#800080">, </font><font color="#FF0000">11</font><font color="#800080">, </font><font color="#FF0000">30</font><font color="#800080">));
        </font><font color="#000080">print</font><font color="#800080">(esp(</font><font color="#008080">$tAutor</font><font color="#800080">{</font><font color="#800000">&quot;codigo&quot;</font><font color="#800080">},</font><font color="#FF0000">10</font><font color="#800080">).</font><font color="#800000">&quot; &quot;</font><font color="#800080">.esp(</font><font color="#008080">$tAutor</font><font color="#800080">{</font><font color="#800000">&quot;autor&quot;</font><font color="#800080">},</font><font color="#FF0000">30</font><font color="#800080">).</font><font color="#800000">&quot;\n&quot;</font><font color="#800080">);
        </font><font color="#0000FF">last </font><font color="#800080">SWITCH; 
    }
  }
} </font><font color="#0000FF">elsif </font><font color="#800080">(</font><font color="#008080">$sreg</font><font color="#800080">==</font><font color="#008080">$opEditora</font><font color="#800080">) {
  SWITCH: {
    </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$nOpcao</font><font color="#800080">==</font><font color="#FF0000">1</font><font color="#800080">) {
        </font><font color="#000080">print</font><font color="#800080">(rotulo(</font><font color="#008080">$sreg</font><font color="#800080">, </font><font color="#FF0000">1</font><font color="#800080">).</font><font color="#008080">$tEditora</font><font color="#800080">{</font><font color="#800000">&quot;codigo&quot;</font><font color="#800080">}.</font><font color="#800000">&quot;\n&quot;</font><font color="#800080">);
        </font><font color="#000080">print</font><font color="#800080">(rotulo(</font><font color="#008080">$sreg</font><font color="#800080">, </font><font color="#FF0000">2</font><font color="#800080">));
        </font><font color="#008080">$tEditora</font><font color="#800080">{</font><font color="#800000">&quot;editora&quot;</font><font color="#800080">} = digita();
        </font><font color="#0000FF">last </font><font color="#800080">SWITCH; 
    }
    </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$nOpcao</font><font color="#800080">==</font><font color="#FF0000">2</font><font color="#800080">) {
        </font><font color="#000080">print</font><font color="#800080">(</font><font color="#800000">&quot;C&oacute;digo     Editora\n&quot;</font><font color="#800080">);
        </font><font color="#000080">print</font><font color="#800080">(</font><font color="#800000">&quot;------     -------\n&quot;</font><font color="#800080">);
        </font><font color="#0000FF">last </font><font color="#800080">SWITCH; 
    }
    </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$nOpcao</font><font color="#800080">==</font><font color="#FF0000">3</font><font color="#800080">) {
        </font><font color="#008080">$tEditora</font><font color="#800080">{</font><font color="#800000">&quot;codigo&quot;</font><font color="#800080">} = trim(copy(</font><font color="#008080">$slinha</font><font color="#800080">, </font><font color="#FF0000">1</font><font color="#800080">, </font><font color="#FF0000">10</font><font color="#800080">));
        </font><font color="#008080">$tEditora</font><font color="#800080">{</font><font color="#800000">&quot;editora&quot;</font><font color="#800080">} = trim(copy(</font><font color="#008080">$slinha</font><font color="#800080">, </font><font color="#FF0000">11</font><font color="#800080">, </font><font color="#FF0000">50</font><font color="#800080">));
        </font><font color="#000080">print</font><font color="#800080">(esp(</font><font color="#008080">$tEditora</font><font color="#800080">{</font><font color="#800000">&quot;codigo&quot;</font><font color="#800080">},</font><font color="#FF0000">10</font><font color="#800080">).</font><font color="#800000">&quot; &quot;</font><font color="#800080">.esp(</font><font color="#008080">$tEditora</font><font color="#800080">{</font><font color="#800000">&quot;editora&quot;</font><font color="#800080">},</font><font color="#FF0000">50</font><font color="#800080">).</font><font color="#800000">&quot;\n&quot;</font><font color="#800080">);
        </font><font color="#0000FF">last </font><font color="#800080">SWITCH;  
    }
  }
} </font><font color="#0000FF">elsif </font><font color="#800080">(</font><font color="#008080">$sreg</font><font color="#800080">==</font><font color="#008080">$opEndereco</font><font color="#800080">) {
  SWITCH: {
    </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$nOpcao</font><font color="#800080">==</font><font color="#FF0000">1</font><font color="#800080">) {
        </font><font color="#000080">print</font><font color="#800080">(rotulo(</font><font color="#008080">$sreg</font><font color="#800080">, </font><font color="#FF0000">1</font><font color="#800080">).</font><font color="#008080">$tEndereco</font><font color="#800080">{</font><font color="#800000">&quot;codigo&quot;</font><font color="#800080">}.</font><font color="#800000">&quot;\n&quot;</font><font color="#800080">);
        </font><font color="#000080">print</font><font color="#800080">(rotulo(</font><font color="#008080">$sreg</font><font color="#800080">, </font><font color="#FF0000">2</font><font color="#800080">));
        </font><font color="#008080">$tEndereco</font><font color="#800080">{</font><font color="#800000">&quot;logradouro&quot;</font><font color="#800080">} = digita();
        </font><font color="#000080">print</font><font color="#800080">(rotulo(</font><font color="#008080">$sreg</font><font color="#800080">, </font><font color="#FF0000">3</font><font color="#800080">));
        </font><font color="#008080">$tEndereco</font><font color="#800080">{</font><font color="#800000">&quot;bairro&quot;</font><font color="#800080">} = digita();
        </font><font color="#000080">print</font><font color="#800080">(rotulo(</font><font color="#008080">$sreg</font><font color="#800080">, </font><font color="#FF0000">4</font><font color="#800080">));
        </font><font color="#008080">$tEndereco</font><font color="#800080">{</font><font color="#800000">&quot;cep&quot;</font><font color="#800080">} = digita();
        </font><font color="#000080">print</font><font color="#800080">(rotulo(</font><font color="#008080">$sreg</font><font color="#800080">, </font><font color="#FF0000">5</font><font color="#800080">));
        </font><font color="#008080">$tEndereco</font><font color="#800080">{</font><font color="#800000">&quot;cidade&quot;</font><font color="#800080">} = digita();
        </font><font color="#000080">print</font><font color="#800080">(rotulo(</font><font color="#008080">$sreg</font><font color="#800080">, </font><font color="#FF0000">6</font><font color="#800080">));
        </font><font color="#008080">$tEndereco</font><font color="#800080">{</font><font color="#800000">&quot;estado&quot;</font><font color="#800080">} = digita();
        </font><font color="#0000FF">last </font><font color="#800080">SWITCH; 
    }
    </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$nOpcao</font><font color="#800080">==</font><font color="#FF0000">3</font><font color="#800080">) {
        </font><font color="#008080">$tEndereco</font><font color="#800080">{</font><font color="#800000">&quot;codigo&quot;</font><font color="#800080">} = trim(copy(</font><font color="#008080">$slinha</font><font color="#800080">, </font><font color="#FF0000">1</font><font color="#800080">, </font><font color="#FF0000">10</font><font color="#800080">));
        </font><font color="#008080">$tEndereco</font><font color="#800080">{</font><font color="#800000">&quot;logradouro&quot;</font><font color="#800080">} = trim(copy(</font><font color="#008080">$slinha</font><font color="#800080">, </font><font color="#FF0000">11</font><font color="#800080">, </font><font color="#FF0000">40</font><font color="#800080">));
        </font><font color="#008080">$tEndereco</font><font color="#800080">{</font><font color="#800000">&quot;bairro&quot;</font><font color="#800080">} = trim(copy(</font><font color="#008080">$slinha</font><font color="#800080">, </font><font color="#FF0000">51</font><font color="#800080">, </font><font color="#FF0000">15</font><font color="#800080">));
        </font><font color="#008080">$tEndereco</font><font color="#800080">{</font><font color="#800000">&quot;cep&quot;</font><font color="#800080">} = trim(copy(</font><font color="#008080">$slinha</font><font color="#800080">, </font><font color="#FF0000">66</font><font color="#800080">, </font><font color="#FF0000">8</font><font color="#800080">));
        </font><font color="#008080">$tEndereco</font><font color="#800080">{</font><font color="#800000">&quot;cidade&quot;</font><font color="#800080">} = trim(copy(</font><font color="#008080">$slinha</font><font color="#800080">, </font><font color="#FF0000">74</font><font color="#800080">, </font><font color="#FF0000">30</font><font color="#800080">));
        </font><font color="#008080">$tEndereco</font><font color="#800080">{</font><font color="#800000">&quot;estado&quot;</font><font color="#800080">} = trim(copy(</font><font color="#008080">$slinha</font><font color="#800080">, </font><font color="#FF0000">104</font><font color="#800080">, </font><font color="#FF0000">20</font><font color="#800080">));
        </font><font color="#000080">print</font><font color="#800080">(</font><font color="#800000">&quot;--------------------\n&quot;</font><font color="#800080">);
        </font><font color="#000080">print</font><font color="#800080">(rotulo(</font><font color="#008080">$sreg</font><font color="#800080">, </font><font color="#FF0000">1</font><font color="#800080">).</font><font color="#008080">$tEndereco</font><font color="#800080">{</font><font color="#800000">&quot;codigo&quot;</font><font color="#800080">}.</font><font color="#800000">&quot;\n&quot;</font><font color="#800080">);
        </font><font color="#000080">print</font><font color="#800080">(rotulo(</font><font color="#008080">$sreg</font><font color="#800080">, </font><font color="#FF0000">2</font><font color="#800080">).</font><font color="#008080">$tEndereco</font><font color="#800080">{</font><font color="#800000">&quot;logradouro&quot;</font><font color="#800080">}.</font><font color="#800000">&quot;\n&quot;</font><font color="#800080">);
        </font><font color="#000080">print</font><font color="#800080">(rotulo(</font><font color="#008080">$sreg</font><font color="#800080">, </font><font color="#FF0000">3</font><font color="#800080">).</font><font color="#008080">$tEndereco</font><font color="#800080">{</font><font color="#800000">&quot;bairro&quot;</font><font color="#800080">}.</font><font color="#800000">&quot;\n&quot;</font><font color="#800080">);
        </font><font color="#000080">print</font><font color="#800080">(rotulo(</font><font color="#008080">$sreg</font><font color="#800080">, </font><font color="#FF0000">4</font><font color="#800080">).</font><font color="#008080">$tEndereco</font><font color="#800080">{</font><font color="#800000">&quot;cep&quot;</font><font color="#800080">}.</font><font color="#800000">&quot;\n&quot;</font><font color="#800080">);
        </font><font color="#000080">print</font><font color="#800080">(rotulo(</font><font color="#008080">$sreg</font><font color="#800080">, </font><font color="#FF0000">5</font><font color="#800080">).</font><font color="#008080">$tEndereco</font><font color="#800080">{</font><font color="#800000">&quot;cidade&quot;</font><font color="#800080">}.</font><font color="#800000">&quot;\n&quot;</font><font color="#800080">);
        </font><font color="#000080">print</font><font color="#800080">(rotulo(</font><font color="#008080">$sreg</font><font color="#800080">, </font><font color="#FF0000">6</font><font color="#800080">).</font><font color="#008080">$tEndereco</font><font color="#800080">{</font><font color="#800000">&quot;estado&quot;</font><font color="#800080">}.</font><font color="#800000">&quot;\n&quot;</font><font color="#800080">);
        </font><font color="#0000FF">last </font><font color="#800080">SWITCH; 
    }
  }
} </font><font color="#0000FF">elsif </font><font color="#800080">(</font><font color="#008080">$sreg</font><font color="#800080">==</font><font color="#008080">$opIdioma</font><font color="#800080">) {
  SWITCH: {
    </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$nOpcao</font><font color="#800080">==</font><font color="#FF0000">1</font><font color="#800080">) {
        </font><font color="#000080">print</font><font color="#800080">(rotulo(</font><font color="#008080">$sreg</font><font color="#800080">, </font><font color="#FF0000">1</font><font color="#800080">).</font><font color="#008080">$tIdioma</font><font color="#800080">{</font><font color="#800000">&quot;codigo&quot;</font><font color="#800080">}.</font><font color="#800000">&quot;\n&quot;</font><font color="#800080">);
        </font><font color="#000080">print</font><font color="#800080">(rotulo(</font><font color="#008080">$sreg</font><font color="#800080">, </font><font color="#FF0000">2</font><font color="#800080">));
        </font><font color="#008080">$tIdioma</font><font color="#800080">{</font><font color="#800000">&quot;idioma&quot;</font><font color="#800080">} = digita();
        </font><font color="#0000FF">last </font><font color="#800080">SWITCH; 
    }
    </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$nOpcao</font><font color="#800080">==</font><font color="#FF0000">2</font><font color="#800080">) {
        </font><font color="#000080">print</font><font color="#800080">(</font><font color="#800000">&quot;C&oacute;digo     Idioma\n&quot;</font><font color="#800080">);
        </font><font color="#000080">print</font><font color="#800080">(</font><font color="#800000">&quot;------     ------\n&quot;</font><font color="#800080">);
        </font><font color="#0000FF">last </font><font color="#800080">SWITCH; 
    }
    </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$nOpcao</font><font color="#800080">==</font><font color="#FF0000">3</font><font color="#800080">) {
        </font><font color="#008080">$tIdioma</font><font color="#800080">{</font><font color="#800000">&quot;codigo&quot;</font><font color="#800080">} = trim(copy(</font><font color="#008080">$slinha</font><font color="#800080">, </font><font color="#FF0000">1</font><font color="#800080">, </font><font color="#FF0000">10</font><font color="#800080">));
        </font><font color="#008080">$tIdioma</font><font color="#800080">{</font><font color="#800000">&quot;idioma&quot;</font><font color="#800080">} = trim(copy(</font><font color="#008080">$slinha</font><font color="#800080">, </font><font color="#FF0000">11</font><font color="#800080">, </font><font color="#FF0000">20</font><font color="#800080">));
        </font><font color="#000080">print</font><font color="#800080">(esp(</font><font color="#008080">$tIdioma</font><font color="#800080">{</font><font color="#800000">&quot;codigo&quot;</font><font color="#800080">},</font><font color="#FF0000">10</font><font color="#800080">).</font><font color="#800000">&quot; &quot;</font><font color="#800080">.esp(</font><font color="#008080">$tIdioma</font><font color="#800080">{</font><font color="#800000">&quot;idioma&quot;</font><font color="#800080">},</font><font color="#FF0000">20</font><font color="#800080">).</font><font color="#800000">&quot;\n&quot;</font><font color="#800080">);
        </font><font color="#0000FF">last </font><font color="#800080">SWITCH; 
    }
  }
} </font><font color="#0000FF">elsif </font><font color="#800080">(</font><font color="#008080">$sreg</font><font color="#800080">==</font><font color="#008080">$opPais</font><font color="#800080">) {
  SWITCH: {
    </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$nOpcao</font><font color="#800080">==</font><font color="#FF0000">1</font><font color="#800080">) {
        </font><font color="#000080">print</font><font color="#800080">(rotulo(</font><font color="#008080">$sreg</font><font color="#800080">, </font><font color="#FF0000">2</font><font color="#800080">));
        </font><font color="#008080">$tPais</font><font color="#800080">{</font><font color="#800000">&quot;pais&quot;</font><font color="#800080">} = digita();
        </font><font color="#0000FF">last </font><font color="#800080">SWITCH; 
    }
    </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$nOpcao</font><font color="#800080">==</font><font color="#FF0000">2</font><font color="#800080">) {
        </font><font color="#000080">print</font><font color="#800080">(</font><font color="#800000">&quot;C&oacute;digo Pa&iacute;s\n&quot;</font><font color="#800080">);
        </font><font color="#000080">print</font><font color="#800080">(</font><font color="#800000">&quot;------ ----\n&quot;</font><font color="#800080">);
        </font><font color="#0000FF">last </font><font color="#800080">SWITCH; 
    }
    </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$nOpcao</font><font color="#800080">==</font><font color="#FF0000">3</font><font color="#800080">) {
        </font><font color="#008080">$tPais</font><font color="#800080">{</font><font color="#800000">&quot;codigo&quot;</font><font color="#800080">} = trim(copy(</font><font color="#008080">$slinha</font><font color="#800080">, </font><font color="#FF0000">1</font><font color="#800080">, </font><font color="#FF0000">3</font><font color="#800080">));
        </font><font color="#008080">$tPais</font><font color="#800080">{</font><font color="#800000">&quot;pais&quot;</font><font color="#800080">} = trim(copy(</font><font color="#008080">$slinha</font><font color="#800080">, </font><font color="#FF0000">4</font><font color="#800080">, </font><font color="#FF0000">50</font><font color="#800080">));
        </font><font color="#000080">print</font><font color="#800080">(esp(</font><font color="#008080">$tPais</font><font color="#800080">{</font><font color="#800000">&quot;codigo&quot;</font><font color="#800080">},</font><font color="#FF0000">3</font><font color="#800080">).</font><font color="#800000">&quot;    &quot;</font><font color="#800080">.esp(</font><font color="#008080">$tPais</font><font color="#800080">{</font><font color="#800000">&quot;pais&quot;</font><font color="#800080">},</font><font color="#FF0000">50</font><font color="#800080">).</font><font color="#800000">&quot;\n&quot;</font><font color="#800080">);
        </font><font color="#0000FF">last </font><font color="#800080">SWITCH; 
    }
  }
} </font><font color="#0000FF">elsif </font><font color="#800080">(</font><font color="#008080">$sreg</font><font color="#800080">==</font><font color="#008080">$opProfissao</font><font color="#800080">) {
  SWITCH: {
    </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$nOpcao</font><font color="#800080">==</font><font color="#FF0000">1</font><font color="#800080">) {
        </font><font color="#000080">print</font><font color="#800080">(rotulo(</font><font color="#008080">$sreg</font><font color="#800080">, </font><font color="#FF0000">1</font><font color="#800080">).</font><font color="#008080">$tProfissao</font><font color="#800080">{</font><font color="#800000">&quot;codigo&quot;</font><font color="#800080">}.</font><font color="#800000">&quot;\n&quot;</font><font color="#800080">);
        </font><font color="#000080">print</font><font color="#800080">(rotulo(</font><font color="#008080">$sreg</font><font color="#800080">, </font><font color="#FF0000">2</font><font color="#800080">));
        </font><font color="#008080">$tProfissao</font><font color="#800080">{</font><font color="#800000">&quot;profissao&quot;</font><font color="#800080">} = digita();
        </font><font color="#0000FF">last </font><font color="#800080">SWITCH; 
    }
    </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$nOpcao</font><font color="#800080">==</font><font color="#FF0000">2</font><font color="#800080">) {
        </font><font color="#000080">print</font><font color="#800080">(</font><font color="#800000">&quot;C&oacute;digo     Profiss&atilde;o\n&quot;</font><font color="#800080">);
        </font><font color="#000080">print</font><font color="#800080">(</font><font color="#800000">&quot;------     ---------\n&quot;</font><font color="#800080">);
        </font><font color="#0000FF">last </font><font color="#800080">SWITCH; 
    }
    </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$nOpcao</font><font color="#800080">==</font><font color="#FF0000">3</font><font color="#800080">) {
        </font><font color="#008080">$tProfissao</font><font color="#800080">{</font><font color="#800000">&quot;codigo&quot;</font><font color="#800080">} = trim(copy(</font><font color="#008080">$slinha</font><font color="#800080">, </font><font color="#FF0000">1</font><font color="#800080">, </font><font color="#FF0000">10</font><font color="#800080">));
        </font><font color="#008080">$tProfissao</font><font color="#800080">{</font><font color="#800000">&quot;profissao&quot;</font><font color="#800080">} = trim(copy(</font><font color="#008080">$slinha</font><font color="#800080">, </font><font color="#FF0000">11</font><font color="#800080">, </font><font color="#FF0000">50</font><font color="#800080">));
        </font><font color="#000080">print</font><font color="#800080">(esp(</font><font color="#008080">$tProfissao</font><font color="#800080">{</font><font color="#800000">&quot;codigo&quot;</font><font color="#800080">},</font><font color="#FF0000">10</font><font color="#800080">).</font><font color="#800000">&quot; &quot;</font><font color="#800080">.
                esp(</font><font color="#008080">$tProfissao</font><font color="#800080">{</font><font color="#800000">&quot;profissao&quot;</font><font color="#800080">},</font><font color="#FF0000">50</font><font color="#800080">).</font><font color="#800000">&quot;\n&quot;</font><font color="#800080">);
        </font><font color="#0000FF">last </font><font color="#800080">SWITCH; 
    }
  }
} </font><font color="#0000FF">elsif </font><font color="#800080">(</font><font color="#008080">$sreg</font><font color="#800080">==</font><font color="#008080">$opLivro</font><font color="#800080">) {
  SWITCH: {
    </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$nOpcao</font><font color="#800080">==</font><font color="#FF0000">1</font><font color="#800080">) {
        </font><font color="#000080">print</font><font color="#800080">(rotulo(</font><font color="#008080">$sreg</font><font color="#800080">, </font><font color="#FF0000">2</font><font color="#800080">));
        </font><font color="#008080">$tLivro</font><font color="#800080">{</font><font color="#800000">&quot;titulo&quot;</font><font color="#800080">} = digita();
        </font><font color="#008080">$tLivro</font><font color="#800080">{</font><font color="#800000">&quot;edicao&quot;</font><font color="#800080">} = validaNumero(rotulo(</font><font color="#008080">$sreg</font><font color="#800080">, </font><font color="#FF0000">3</font><font color="#800080">), </font><font color="#008080">$tLivro</font><font color="#800080">{</font><font color="#800000">&quot;edicao&quot;</font><font color="#800080">});
        </font><font color="#008080">$tLivro</font><font color="#800080">{</font><font color="#800000">&quot;anopubli&quot;</font><font color="#800080">} = validaNumero(rotulo(</font><font color="#008080">$sreg</font><font color="#800080">, </font><font color="#FF0000">4</font><font color="#800080">), </font><font color="#008080">$tLivro</font><font color="#800080">{</font><font color="#800000">&quot;anopubli&quot;</font><font color="#800080">});
        mostrarSubDados(</font><font color="#008080">$opLivro</font><font color="#800080">, </font><font color="#008080">$opEditora</font><font color="#800080">, </font><font color="#008080">$false</font><font color="#800080">);
        </font><font color="#008080">$tLivro</font><font color="#800080">{</font><font color="#800000">&quot;volume&quot;</font><font color="#800080">} = validaNumero(rotulo(</font><font color="#008080">$sreg</font><font color="#800080">, </font><font color="#FF0000">6</font><font color="#800080">), </font><font color="#008080">$tLivro</font><font color="#800080">{</font><font color="#800000">&quot;volume&quot;</font><font color="#800080">});
        mostrarSubDados(</font><font color="#008080">$opLivro</font><font color="#800080">, </font><font color="#008080">$opIdioma</font><font color="#800080">, </font><font color="#008080">$false</font><font color="#800080">);
        </font><font color="#008080">$tLivro</font><font color="#800080">{</font><font color="#800000">&quot;npaginas&quot;</font><font color="#800080">} = validaNumero(rotulo(</font><font color="#008080">$sreg</font><font color="#800080">, </font><font color="#FF0000">8</font><font color="#800080">), </font><font color="#008080">$tLivro</font><font color="#800080">{</font><font color="#800000">&quot;npaginas&quot;</font><font color="#800080">});
        </font><font color="#008080">$tLivro</font><font color="#800080">{</font><font color="#800000">&quot;preco&quot;</font><font color="#800080">} = validaNumero(rotulo(</font><font color="#008080">$sreg</font><font color="#800080">, </font><font color="#FF0000">9</font><font color="#800080">), </font><font color="#008080">$tLivro</font><font color="#800080">{</font><font color="#800000">&quot;preco&quot;</font><font color="#800080">});
        </font><font color="#008080">$tLivro</font><font color="#800080">{</font><font color="#800000">&quot;qtdestoque&quot;</font><font color="#800080">} = validaNumero(rotulo(</font><font color="#008080">$sreg</font><font color="#800080">, </font><font color="#FF0000">10</font><font color="#800080">), 
            </font><font color="#008080">$tLivro</font><font color="#800080">{</font><font color="#800000">&quot;qtdestoque&quot;</font><font color="#800080">});
        </font><font color="#0000FF">last </font><font color="#800080">SWITCH; 
    }
    </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$nOpcao</font><font color="#800080">==</font><font color="#FF0000">3</font><font color="#800080">) {
        </font><font color="#008080">$tLivro</font><font color="#800080">{</font><font color="#800000">&quot;isbn&quot;</font><font color="#800080">} = trim(copy(</font><font color="#008080">$slinha</font><font color="#800080">, </font><font color="#FF0000">1</font><font color="#800080">, </font><font color="#FF0000">13</font><font color="#800080">));
        </font><font color="#008080">$tLivro</font><font color="#800080">{</font><font color="#800000">&quot;titulo&quot;</font><font color="#800080">} = trim(copy(</font><font color="#008080">$slinha</font><font color="#800080">, </font><font color="#FF0000">14</font><font color="#800080">, </font><font color="#FF0000">50</font><font color="#800080">));
        </font><font color="#008080">$tLivro</font><font color="#800080">{</font><font color="#800000">&quot;edicao&quot;</font><font color="#800080">} = trim(copy(</font><font color="#008080">$slinha</font><font color="#800080">, </font><font color="#FF0000">64</font><font color="#800080">, </font><font color="#FF0000">10</font><font color="#800080">));
        </font><font color="#008080">$tLivro</font><font color="#800080">{</font><font color="#800000">&quot;anopubli&quot;</font><font color="#800080">} = trim(copy(</font><font color="#008080">$slinha</font><font color="#800080">, </font><font color="#FF0000">74</font><font color="#800080">, </font><font color="#FF0000">10</font><font color="#800080">));
        </font><font color="#008080">$tLivro</font><font color="#800080">{</font><font color="#800000">&quot;codeditora&quot;</font><font color="#800080">} = trim(copy(</font><font color="#008080">$slinha</font><font color="#800080">, </font><font color="#FF0000">84</font><font color="#800080">, </font><font color="#FF0000">10</font><font color="#800080">));
        </font><font color="#008080">$tLivro</font><font color="#800080">{</font><font color="#800000">&quot;volume&quot;</font><font color="#800080">} = trim(copy(</font><font color="#008080">$slinha</font><font color="#800080">, </font><font color="#FF0000">94</font><font color="#800080">, </font><font color="#FF0000">10</font><font color="#800080">));
        </font><font color="#008080">$tLivro</font><font color="#800080">{</font><font color="#800000">&quot;codidioma&quot;</font><font color="#800080">} = trim(copy(</font><font color="#008080">$slinha</font><font color="#800080">, </font><font color="#FF0000">104</font><font color="#800080">, </font><font color="#FF0000">10</font><font color="#800080">));
        </font><font color="#008080">$tLivro</font><font color="#800080">{</font><font color="#800000">&quot;npaginas&quot;</font><font color="#800080">} = trim(copy(</font><font color="#008080">$slinha</font><font color="#800080">, </font><font color="#FF0000">114</font><font color="#800080">, </font><font color="#FF0000">10</font><font color="#800080">));
        </font><font color="#008080">$tLivro</font><font color="#800080">{</font><font color="#800000">&quot;preco&quot;</font><font color="#800080">} = trim(copy(</font><font color="#008080">$slinha</font><font color="#800080">, </font><font color="#FF0000">124</font><font color="#800080">, </font><font color="#FF0000">10</font><font color="#800080">));
        </font><font color="#008080">$tLivro</font><font color="#800080">{</font><font color="#800000">&quot;qtdestoque&quot;</font><font color="#800080">} = trim(copy(</font><font color="#008080">$slinha</font><font color="#800080">, </font><font color="#FF0000">134</font><font color="#800080">, </font><font color="#FF0000">10</font><font color="#800080">));
        </font><font color="#000080">print</font><font color="#800080">(</font><font color="#800000">&quot;--------------------\n&quot;</font><font color="#800080">);
        </font><font color="#000080">print</font><font color="#800080">(rotulo(</font><font color="#008080">$sreg</font><font color="#800080">, </font><font color="#FF0000">1</font><font color="#800080">).</font><font color="#008080">$tLivro</font><font color="#800080">{</font><font color="#800000">&quot;isbn&quot;</font><font color="#800080">}.</font><font color="#800000">&quot;\n&quot;</font><font color="#800080">);
        </font><font color="#000080">print</font><font color="#800080">(rotulo(</font><font color="#008080">$sreg</font><font color="#800080">, </font><font color="#FF0000">2</font><font color="#800080">).</font><font color="#008080">$tLivro</font><font color="#800080">{</font><font color="#800000">&quot;titulo&quot;</font><font color="#800080">}.</font><font color="#800000">&quot;\n&quot;</font><font color="#800080">);
        </font><font color="#000080">print</font><font color="#800080">(rotulo(</font><font color="#008080">$sreg</font><font color="#800080">, </font><font color="#FF0000">3</font><font color="#800080">).</font><font color="#008080">$tLivro</font><font color="#800080">{</font><font color="#800000">&quot;edicao&quot;</font><font color="#800080">}.</font><font color="#800000">&quot;\n&quot;</font><font color="#800080">);
        </font><font color="#000080">print</font><font color="#800080">(rotulo(</font><font color="#008080">$sreg</font><font color="#800080">, </font><font color="#FF0000">4</font><font color="#800080">).</font><font color="#008080">$tLivro</font><font color="#800080">{</font><font color="#800000">&quot;anopubli&quot;</font><font color="#800080">}.</font><font color="#800000">&quot;\n&quot;</font><font color="#800080">);
        </font><font color="#000080">print</font><font color="#800080">(rotulo(</font><font color="#008080">$sreg</font><font color="#800080">, </font><font color="#FF0000">5</font><font color="#800080">).</font><font color="#008080">$tLivro</font><font color="#800080">{</font><font color="#800000">&quot;codeditora&quot;</font><font color="#800080">}.</font><font color="#800000">&quot;\n&quot;</font><font color="#800080">);
        mostrarSubDados(</font><font color="#008080">$opLivro</font><font color="#800080">, </font><font color="#008080">$opEditora</font><font color="#800080">, </font><font color="#008080">$true</font><font color="#800080">);
        </font><font color="#000080">print</font><font color="#800080">(rotulo(</font><font color="#008080">$sreg</font><font color="#800080">, </font><font color="#FF0000">6</font><font color="#800080">).</font><font color="#008080">$tLivro</font><font color="#800080">{</font><font color="#800000">&quot;volume&quot;</font><font color="#800080">}.</font><font color="#800000">&quot;\n&quot;</font><font color="#800080">);
        </font><font color="#000080">print</font><font color="#800080">(rotulo(</font><font color="#008080">$sreg</font><font color="#800080">, </font><font color="#FF0000">7</font><font color="#800080">).</font><font color="#008080">$tLivro</font><font color="#800080">{</font><font color="#800000">&quot;codidioma&quot;</font><font color="#800080">}.</font><font color="#800000">&quot;\n&quot;</font><font color="#800080">);
        mostrarSubDados(</font><font color="#008080">$opLivro</font><font color="#800080">, </font><font color="#008080">$opIdioma</font><font color="#800080">, </font><font color="#008080">$true</font><font color="#800080">);
        </font><font color="#000080">print</font><font color="#800080">(rotulo(</font><font color="#008080">$sreg</font><font color="#800080">, </font><font color="#FF0000">8</font><font color="#800080">).</font><font color="#008080">$tLivro</font><font color="#800080">{</font><font color="#800000">&quot;npaginas&quot;</font><font color="#800080">}.</font><font color="#800000">&quot;\n&quot;</font><font color="#800080">);
        </font><font color="#000080">print</font><font color="#800080">(rotulo(</font><font color="#008080">$sreg</font><font color="#800080">, </font><font color="#FF0000">9</font><font color="#800080">).</font><font color="#008080">$tLivro</font><font color="#800080">{</font><font color="#800000">&quot;preco&quot;</font><font color="#800080">}.</font><font color="#800000">&quot;\n&quot;</font><font color="#800080">);
        </font><font color="#000080">print</font><font color="#800080">(rotulo(</font><font color="#008080">$sreg</font><font color="#800080">, </font><font color="#FF0000">10</font><font color="#800080">).</font><font color="#008080">$tLivro</font><font color="#800080">{</font><font color="#800000">&quot;qtdestoque&quot;</font><font color="#800080">}.</font><font color="#800000">&quot;\n&quot;</font><font color="#800080">);
        ListarRegLigados(tfLivroAss, </font><font color="#008080">$opLivroAss</font><font color="#800080">, </font><font color="#FF0000">1</font><font color="#800080">, </font><font color="#FF0000">13</font><font color="#800080">, </font><font color="#FF0000">14</font><font color="#800080">, </font><font color="#FF0000">10</font><font color="#800080">, </font><font color="#008080">$tLivro</font><font color="#800080">{</font><font color="#800000">&quot;isbn&quot;</font><font color="#800080">},
                         tfAssunto, </font><font color="#008080">$opAssunto</font><font color="#800080">, </font><font color="#FF0000">1</font><font color="#800080">, </font><font color="#FF0000">4</font><font color="#800080">);
        ListarRegLigados(tfLivroAut, </font><font color="#008080">$opLivroAut</font><font color="#800080">, </font><font color="#FF0000">1</font><font color="#800080">, </font><font color="#FF0000">13</font><font color="#800080">, </font><font color="#FF0000">14</font><font color="#800080">, </font><font color="#FF0000">10</font><font color="#800080">, </font><font color="#008080">$tLivro</font><font color="#800080">{</font><font color="#800000">&quot;isbn&quot;</font><font color="#800080">},
                         tfAutor, </font><font color="#008080">$opAutor</font><font color="#800080">, </font><font color="#FF0000">1</font><font color="#800080">, </font><font color="#FF0000">4</font><font color="#800080">);
        </font><font color="#0000FF">last </font><font color="#800080">SWITCH; 
    }
  }
} </font><font color="#0000FF">elsif </font><font color="#800080">(</font><font color="#008080">$sreg</font><font color="#800080">==</font><font color="#008080">$opCliente</font><font color="#800080">) {
  SWITCH: {
    </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$nOpcao</font><font color="#800080">==</font><font color="#FF0000">1</font><font color="#800080">) {
        </font><font color="#000080">print</font><font color="#800080">(rotulo(</font><font color="#008080">$sreg</font><font color="#800080">, </font><font color="#FF0000">2</font><font color="#800080">));
        </font><font color="#008080">$tCliente</font><font color="#800080">{</font><font color="#800000">&quot;nome&quot;</font><font color="#800080">} = digita();
        </font><font color="#000080">print</font><font color="#800080">(rotulo(</font><font color="#008080">$sreg</font><font color="#800080">, </font><font color="#FF0000">3</font><font color="#800080">));
        </font><font color="#008080">$tCliente</font><font color="#800080">{</font><font color="#800000">&quot;email&quot;</font><font color="#800080">} = digita();
        </font><font color="#000080">print</font><font color="#800080">(rotulo(</font><font color="#008080">$sreg</font><font color="#800080">, </font><font color="#FF0000">4</font><font color="#800080">));
        </font><font color="#008080">$tCliente</font><font color="#800080">{</font><font color="#800000">&quot;identidade&quot;</font><font color="#800080">} = digita();
        </font><font color="#000080">print</font><font color="#800080">(rotulo(</font><font color="#008080">$sreg</font><font color="#800080">, </font><font color="#FF0000">5</font><font color="#800080">));
        </font><font color="#008080">$tCliente</font><font color="#800080">{</font><font color="#800000">&quot;sexo&quot;</font><font color="#800080">} = digita();
        </font><font color="#000080">print</font><font color="#800080">(rotulo(</font><font color="#008080">$sreg</font><font color="#800080">, </font><font color="#FF0000">6</font><font color="#800080">));
        </font><font color="#008080">$tCliente</font><font color="#800080">{</font><font color="#800000">&quot;telefone&quot;</font><font color="#800080">} = digita();
        </font><font color="#008080">$tCliente</font><font color="#800080">{</font><font color="#800000">&quot;dtnascimento&quot;</font><font color="#800080">} = 
            validaDataHora(rotulo(</font><font color="#008080">$sreg</font><font color="#800080">, </font><font color="#FF0000">7</font><font color="#800080">), </font><font color="#008080">$tCliente</font><font color="#800080">{</font><font color="#800000">&quot;dtnascimento&quot;</font><font color="#800080">}, </font><font color="#008080">$true</font><font color="#800080">);
        mostrarSubDados(</font><font color="#008080">$opCliente</font><font color="#800080">, </font><font color="#008080">$opEndereco</font><font color="#800080">, </font><font color="#008080">$false</font><font color="#800080">);
        mostrarSubDados(</font><font color="#008080">$opCliente</font><font color="#800080">, </font><font color="#008080">$opPais</font><font color="#800080">, </font><font color="#008080">$false</font><font color="#800080">);
        mostrarSubDados(</font><font color="#008080">$opCliente</font><font color="#800080">, </font><font color="#008080">$opProfissao</font><font color="#800080">, </font><font color="#008080">$false</font><font color="#800080">);
        </font><font color="#0000FF">last </font><font color="#800080">SWITCH; 
    }
    </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$nOpcao</font><font color="#800080">==</font><font color="#FF0000">3</font><font color="#800080">) {
        </font><font color="#008080">$tCliente</font><font color="#800080">{</font><font color="#800000">&quot;cpf&quot;</font><font color="#800080">} = trim(copy(</font><font color="#008080">$slinha</font><font color="#800080">, </font><font color="#FF0000">1</font><font color="#800080">, </font><font color="#FF0000">14</font><font color="#800080">));
        </font><font color="#008080">$tCliente</font><font color="#800080">{</font><font color="#800000">&quot;nome&quot;</font><font color="#800080">} = trim(copy(</font><font color="#008080">$slinha</font><font color="#800080">, </font><font color="#FF0000">15</font><font color="#800080">, </font><font color="#FF0000">30</font><font color="#800080">));
        </font><font color="#008080">$tCliente</font><font color="#800080">{</font><font color="#800000">&quot;email&quot;</font><font color="#800080">} = trim(copy(</font><font color="#008080">$slinha</font><font color="#800080">, </font><font color="#FF0000">45</font><font color="#800080">, </font><font color="#FF0000">30</font><font color="#800080">));
        </font><font color="#008080">$tCliente</font><font color="#800080">{</font><font color="#800000">&quot;identidade&quot;</font><font color="#800080">} = trim(copy(</font><font color="#008080">$slinha</font><font color="#800080">, </font><font color="#FF0000">75</font><font color="#800080">, </font><font color="#FF0000">10</font><font color="#800080">));
        </font><font color="#008080">$tCliente</font><font color="#800080">{</font><font color="#800000">&quot;sexo&quot;</font><font color="#800080">} = trim(copy(</font><font color="#008080">$slinha</font><font color="#800080">, </font><font color="#FF0000">85</font><font color="#800080">, </font><font color="#FF0000">1</font><font color="#800080">));
        </font><font color="#008080">$tCliente</font><font color="#800080">{</font><font color="#800000">&quot;telefone&quot;</font><font color="#800080">} = trim(copy(</font><font color="#008080">$slinha</font><font color="#800080">, </font><font color="#FF0000">86</font><font color="#800080">, </font><font color="#FF0000">17</font><font color="#800080">));
        </font><font color="#008080">$tCliente</font><font color="#800080">{</font><font color="#800000">&quot;dtnascimento&quot;</font><font color="#800080">} = trim(copy(</font><font color="#008080">$slinha</font><font color="#800080">, </font><font color="#FF0000">103</font><font color="#800080">, </font><font color="#FF0000">10</font><font color="#800080">));
        </font><font color="#008080">$tCliente</font><font color="#800080">{</font><font color="#800000">&quot;codendereco&quot;</font><font color="#800080">} = trim(copy(</font><font color="#008080">$slinha</font><font color="#800080">, </font><font color="#FF0000">113</font><font color="#800080">, </font><font color="#FF0000">10</font><font color="#800080">));
        </font><font color="#008080">$tCliente</font><font color="#800080">{</font><font color="#800000">&quot;codpais&quot;</font><font color="#800080">} = trim(copy(</font><font color="#008080">$slinha</font><font color="#800080">, </font><font color="#FF0000">123</font><font color="#800080">, </font><font color="#FF0000">3</font><font color="#800080">));
        </font><font color="#008080">$tCliente</font><font color="#800080">{</font><font color="#800000">&quot;codprofissao&quot;</font><font color="#800080">} = trim(copy(</font><font color="#008080">$slinha</font><font color="#800080">, </font><font color="#FF0000">126</font><font color="#800080">, </font><font color="#FF0000">10</font><font color="#800080">));
        </font><font color="#000080">print</font><font color="#800080">(</font><font color="#800000">&quot;--------------------\n&quot;</font><font color="#800080">);
        </font><font color="#000080">print</font><font color="#800080">(rotulo(</font><font color="#008080">$sreg</font><font color="#800080">, </font><font color="#FF0000">1</font><font color="#800080">).</font><font color="#008080">$tCliente</font><font color="#800080">{</font><font color="#800000">&quot;cpf&quot;</font><font color="#800080">}.</font><font color="#800000">&quot;\n&quot;</font><font color="#800080">);
        </font><font color="#000080">print</font><font color="#800080">(rotulo(</font><font color="#008080">$sreg</font><font color="#800080">, </font><font color="#FF0000">2</font><font color="#800080">).</font><font color="#008080">$tCliente</font><font color="#800080">{</font><font color="#800000">&quot;nome&quot;</font><font color="#800080">}.</font><font color="#800000">&quot;\n&quot;</font><font color="#800080">);
        </font><font color="#000080">print</font><font color="#800080">(rotulo(</font><font color="#008080">$sreg</font><font color="#800080">, </font><font color="#FF0000">3</font><font color="#800080">).</font><font color="#008080">$tCliente</font><font color="#800080">{</font><font color="#800000">&quot;email&quot;</font><font color="#800080">}.</font><font color="#800000">&quot;\n&quot;</font><font color="#800080">);
        </font><font color="#000080">print</font><font color="#800080">(rotulo(</font><font color="#008080">$sreg</font><font color="#800080">, </font><font color="#FF0000">4</font><font color="#800080">).</font><font color="#008080">$tCliente</font><font color="#800080">{</font><font color="#800000">&quot;identidade&quot;</font><font color="#800080">}.</font><font color="#800000">&quot;\n&quot;</font><font color="#800080">);
        </font><font color="#000080">print</font><font color="#800080">(rotulo(</font><font color="#008080">$sreg</font><font color="#800080">, </font><font color="#FF0000">5</font><font color="#800080">).</font><font color="#008080">$tCliente</font><font color="#800080">{</font><font color="#800000">&quot;sexo&quot;</font><font color="#800080">}.</font><font color="#800000">&quot;\n&quot;</font><font color="#800080">);
        </font><font color="#000080">print</font><font color="#800080">(rotulo(</font><font color="#008080">$sreg</font><font color="#800080">, </font><font color="#FF0000">6</font><font color="#800080">).</font><font color="#008080">$tCliente</font><font color="#800080">{</font><font color="#800000">&quot;telefone&quot;</font><font color="#800080">}.</font><font color="#800000">&quot;\n&quot;</font><font color="#800080">);
        </font><font color="#000080">print</font><font color="#800080">(rotulo(</font><font color="#008080">$sreg</font><font color="#800080">, </font><font color="#FF0000">7</font><font color="#800080">).</font><font color="#008080">$tCliente</font><font color="#800080">{</font><font color="#800000">&quot;dtnascimento&quot;</font><font color="#800080">}.</font><font color="#800000">&quot;\n&quot;</font><font color="#800080">);
        </font><font color="#000080">print</font><font color="#800080">(rotulo(</font><font color="#008080">$sreg</font><font color="#800080">, </font><font color="#FF0000">8</font><font color="#800080">).</font><font color="#008080">$tCliente</font><font color="#800080">{</font><font color="#800000">&quot;codendereco&quot;</font><font color="#800080">}.</font><font color="#800000">&quot;\n&quot;</font><font color="#800080">);
        mostrarSubDados(</font><font color="#008080">$opCliente</font><font color="#800080">, </font><font color="#008080">$opEndereco</font><font color="#800080">, </font><font color="#008080">$true</font><font color="#800080">);
        </font><font color="#000080">print</font><font color="#800080">(rotulo(</font><font color="#008080">$sreg</font><font color="#800080">, </font><font color="#FF0000">9</font><font color="#800080">).</font><font color="#008080">$tCliente</font><font color="#800080">{</font><font color="#800000">&quot;codpais&quot;</font><font color="#800080">}.</font><font color="#800000">&quot;\n&quot;</font><font color="#800080">);
        mostrarSubDados(</font><font color="#008080">$opCliente</font><font color="#800080">, </font><font color="#008080">$opPais</font><font color="#800080">, </font><font color="#008080">$true</font><font color="#800080">);
        </font><font color="#000080">print</font><font color="#800080">(rotulo(</font><font color="#008080">$sreg</font><font color="#800080">, </font><font color="#FF0000">10</font><font color="#800080">).</font><font color="#008080">$tCliente</font><font color="#800080">{</font><font color="#800000">&quot;codprofissao&quot;</font><font color="#800080">}.</font><font color="#800000">&quot;\n&quot;</font><font color="#800080">);
        mostrarSubDados(</font><font color="#008080">$opCliente</font><font color="#800080">, </font><font color="#008080">$opProfissao</font><font color="#800080">, </font><font color="#008080">$true</font><font color="#800080">);
        </font><font color="#0000FF">last </font><font color="#800080">SWITCH; 
    }
   }
} </font><font color="#0000FF">elsif </font><font color="#800080">(</font><font color="#008080">$sreg</font><font color="#800080">==</font><font color="#008080">$opVenda</font><font color="#800080">) {
  SWITCH: {
    </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$nOpcao</font><font color="#800080">==</font><font color="#FF0000">1</font><font color="#800080">) {
      mostrarSubDados(</font><font color="#008080">$opVenda</font><font color="#800080">,</font><font color="#008080">$opVenda</font><font color="#800080">, </font><font color="#008080">$false</font><font color="#800080">);
      </font><font color="#0000FF">last </font><font color="#800080">SWITCH; 
    }
    </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$nOpcao</font><font color="#800080">==</font><font color="#FF0000">2</font><font color="#800080">) {
        </font><font color="#000080">print</font><font color="#800080">(</font><font color="#800000">&quot;DataHoraVenda       CPF            ISBN          &quot;</font><font color="#800080">.
        </font><font color="#800000">&quot;Pre&ccedil;oVenda\n&quot;</font><font color="#800080">);
        </font><font color="#000080">print</font><font color="#800080">(</font><font color="#800000">&quot;-------------       ---            ----          &quot;</font><font color="#800080">.
        </font><font color="#800000">&quot;----------\n&quot;</font><font color="#800080">);
        </font><font color="#0000FF">last </font><font color="#800080">SWITCH; 
    }
    </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$nOpcao</font><font color="#800080">==</font><font color="#FF0000">3</font><font color="#800080">) {
        </font><font color="#008080">$tVenda</font><font color="#800080">{</font><font color="#800000">&quot;dthrvenda&quot;</font><font color="#800080">} = trim(copy(</font><font color="#008080">$slinha</font><font color="#800080">, </font><font color="#FF0000">1</font><font color="#800080">, </font><font color="#FF0000">19</font><font color="#800080">));
        </font><font color="#008080">$tVenda</font><font color="#800080">{</font><font color="#800000">&quot;cpf&quot;</font><font color="#800080">} = trim(copy(</font><font color="#008080">$slinha</font><font color="#800080">, </font><font color="#FF0000">20</font><font color="#800080">, </font><font color="#FF0000">14</font><font color="#800080">));
        </font><font color="#008080">$tVenda</font><font color="#800080">{</font><font color="#800000">&quot;isbn&quot;</font><font color="#800080">} = trim(copy(</font><font color="#008080">$slinha</font><font color="#800080">, </font><font color="#FF0000">34</font><font color="#800080">, </font><font color="#FF0000">13</font><font color="#800080">));
        </font><font color="#008080">$tVenda</font><font color="#800080">{</font><font color="#800000">&quot;precovenda&quot;</font><font color="#800080">} = trim(copy(</font><font color="#008080">$slinha</font><font color="#800080">, </font><font color="#FF0000">47</font><font color="#800080">, </font><font color="#FF0000">10</font><font color="#800080">));
        </font><font color="#000080">print</font><font color="#800080">(esp(</font><font color="#008080">$tVenda</font><font color="#800080">{</font><font color="#800000">&quot;dthrvenda&quot;</font><font color="#800080">},</font><font color="#FF0000">19</font><font color="#800080">).</font><font color="#800000">&quot; &quot;</font><font color="#800080">.esp(</font><font color="#008080">$tVenda</font><font color="#800080">{</font><font color="#800000">&quot;cpf&quot;</font><font color="#800080">},</font><font color="#FF0000">14</font><font color="#800080">).</font><font color="#800000">&quot; &quot;</font><font color="#800080">.
        esp(</font><font color="#008080">$tVenda</font><font color="#800080">{</font><font color="#800000">&quot;isbn&quot;</font><font color="#800080">},</font><font color="#FF0000">13</font><font color="#800080">).</font><font color="#800000">&quot; &quot;</font><font color="#800080">.esp(</font><font color="#008080">$tVenda</font><font color="#800080">{</font><font color="#800000">&quot;precovenda&quot;</font><font color="#800080">},</font><font color="#FF0000">10</font><font color="#800080">).</font><font color="#800000">&quot;\n&quot;</font><font color="#800080">);
        </font><font color="#0000FF">last </font><font color="#800080">SWITCH; 
    }
  }
}

}
</font><font color="#808080"><i>#------------------------------------------------------------------------------
# Mostra as sub inform&ccedil;&otilde;es de entrada e de sa&iacute;da.
# sreg - o tipo de arquivo
# ssubreg - o subtipo de arquivo
# bSoMostrar - se vai s&oacute; mostrar na sa&iacute;da
#------------------------------------------------------------------------------
</i></font><font color="#0000FF">sub </font><font color="#800080">mostrarSubDados { 
</font><font color="#0000FF">my </font><font color="#008080">$sreg </font><font color="#800080">= </font><font color="#FF00FF">$_</font><font color="#800080">[</font><font color="#FF0000">0</font><font color="#800080">];
</font><font color="#0000FF">my </font><font color="#008080">$ssubreg </font><font color="#800080">= </font><font color="#FF00FF">$_</font><font color="#800080">[</font><font color="#FF0000">1</font><font color="#800080">];
</font><font color="#0000FF">my </font><font color="#008080">$bSoMostrar </font><font color="#800080">= </font><font color="#FF00FF">$_</font><font color="#800080">[</font><font color="#FF0000">2</font><font color="#800080">];

</font><font color="#0000FF">my </font><font color="#008080">$sRegistro</font><font color="#800080">; </font><font color="#0000FF">my </font><font color="#008080">$sPreco</font><font color="#800080">;
</font><font color="#0000FF">my </font><font color="#008080">$nMaxTentativas </font><font color="#800080">= </font><font color="#FF0000">3</font><font color="#800080">;
</font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$sreg</font><font color="#800080">==</font><font color="#008080">$opLivro</font><font color="#800080">) {
  </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$ssubreg</font><font color="#800080">==</font><font color="#008080">$opEditora</font><font color="#800080">) {
    </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$bSoMostrar</font><font color="#800080">==</font><font color="#008080">$true</font><font color="#800080">) {
       </font><font color="#008080">$sRegistro </font><font color="#800080">= pesqArq(tfEditora,</font><font color="#008080">$tLivro</font><font color="#800080">{</font><font color="#800000">&quot;codeditora&quot;</font><font color="#800080">},</font><font color="#FF0000">1</font><font color="#800080">,</font><font color="#FF0000">10</font><font color="#800080">,tamReg(</font><font color="#008080">$opEditora</font><font color="#800080">));
    } </font><font color="#0000FF">else </font><font color="#800080">{
       </font><font color="#008080">$sRegistro </font><font color="#800080">= validaEntrada(tfEditora,</font><font color="#008080">$ssubreg</font><font color="#800080">,</font><font color="#FF0000">1</font><font color="#800080">,</font><font color="#008080">$tLivro</font><font color="#800080">{</font><font color="#800000">&quot;codeditora&quot;</font><font color="#800080">},
                  </font><font color="#008080">$nMaxTentativas</font><font color="#800080">,</font><font color="#008080">$false</font><font color="#800080">,</font><font color="#008080">$opNumero</font><font color="#800080">);
    }
    </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#000080">length</font><font color="#800080">(</font><font color="#008080">$sRegistro</font><font color="#800080">) &gt; </font><font color="#FF0000">0</font><font color="#800080">) {
      </font><font color="#008080">$tLivro</font><font color="#800080">{</font><font color="#800000">&quot;codeditora&quot;</font><font color="#800080">} = trim(copy(</font><font color="#008080">$sRegistro</font><font color="#800080">,</font><font color="#FF0000">1</font><font color="#800080">,</font><font color="#FF0000">10</font><font color="#800080">));
      </font><font color="#000080">print</font><font color="#800080">(</font><font color="#800000">&quot; &quot;</font><font color="#800080">.rotulo(</font><font color="#008080">$opEditora</font><font color="#800080">, </font><font color="#FF0000">2</font><font color="#800080">));
      </font><font color="#000080">print</font><font color="#800080">(copy(</font><font color="#008080">$sRegistro</font><font color="#800080">, </font><font color="#008080">$g_nPosChave</font><font color="#800080">, </font><font color="#008080">$g_nTamChave</font><font color="#800080">).</font><font color="#800000">&quot;\n&quot;</font><font color="#800080">);
    }
  } </font><font color="#0000FF">elsif </font><font color="#800080">(</font><font color="#008080">$ssubreg</font><font color="#800080">==</font><font color="#008080">$opIdioma</font><font color="#800080">) {
    </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$bSoMostrar</font><font color="#800080">==</font><font color="#008080">$true</font><font color="#800080">) {
       </font><font color="#008080">$sRegistro </font><font color="#800080">= pesqArq(tfIdioma, </font><font color="#008080">$tLivro</font><font color="#800080">{</font><font color="#800000">&quot;codidioma&quot;</font><font color="#800080">}, </font><font color="#FF0000">1</font><font color="#800080">, </font><font color="#FF0000">10</font><font color="#800080">,tamReg(</font><font color="#008080">$opIdioma</font><font color="#800080">));
    } </font><font color="#0000FF">else </font><font color="#800080">{
       </font><font color="#008080">$sRegistro </font><font color="#800080">= validaEntrada(tfIdioma,</font><font color="#008080">$ssubreg</font><font color="#800080">,</font><font color="#FF0000">1</font><font color="#800080">,</font><font color="#008080">$tLivro</font><font color="#800080">{</font><font color="#800000">&quot;codidioma&quot;</font><font color="#800080">},
                  </font><font color="#008080">$nMaxTentativas</font><font color="#800080">,</font><font color="#008080">$false</font><font color="#800080">,</font><font color="#008080">$opNumero</font><font color="#800080">);
    }
    </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#000080">length</font><font color="#800080">(</font><font color="#008080">$sRegistro</font><font color="#800080">) &gt; </font><font color="#FF0000">0</font><font color="#800080">) {
      </font><font color="#008080">$tLivro</font><font color="#800080">{</font><font color="#800000">&quot;codidioma&quot;</font><font color="#800080">} = trim(copy(</font><font color="#008080">$sRegistro</font><font color="#800080">,</font><font color="#FF0000">1</font><font color="#800080">,</font><font color="#FF0000">10</font><font color="#800080">));
      </font><font color="#000080">print</font><font color="#800080">(</font><font color="#800000">&quot; &quot;</font><font color="#800080">.rotulo(</font><font color="#008080">$opIdioma</font><font color="#800080">, </font><font color="#FF0000">2</font><font color="#800080">));
      </font><font color="#000080">print</font><font color="#800080">(copy(</font><font color="#008080">$sRegistro</font><font color="#800080">, </font><font color="#008080">$g_nPosChave</font><font color="#800080">, </font><font color="#008080">$g_nTamChave</font><font color="#800080">).</font><font color="#800000">&quot;\n&quot;</font><font color="#800080">);
    }
  }
} </font><font color="#0000FF">elsif </font><font color="#800080">(</font><font color="#008080">$sreg</font><font color="#800080">==</font><font color="#008080">$opCliente</font><font color="#800080">) {
  </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$ssubreg</font><font color="#800080">==</font><font color="#008080">$opEndereco</font><font color="#800080">) {
    </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$bSoMostrar</font><font color="#800080">==</font><font color="#008080">$true</font><font color="#800080">) {
       </font><font color="#008080">$sRegistro </font><font color="#800080">= pesqArq(tfEndereco, </font><font color="#008080">$tCliente</font><font color="#800080">{</font><font color="#800000">&quot;codendereco&quot;</font><font color="#800080">}, </font><font color="#FF0000">1</font><font color="#800080">, </font><font color="#FF0000">10</font><font color="#800080">,
                  tamReg(</font><font color="#008080">$opEndereco</font><font color="#800080">));
    } </font><font color="#0000FF">else </font><font color="#800080">{
       </font><font color="#008080">$sRegistro </font><font color="#800080">= validaEntrada(tfEndereco,</font><font color="#008080">$ssubreg</font><font color="#800080">,</font><font color="#FF0000">1</font><font color="#800080">,</font><font color="#008080">$tCliente</font><font color="#800080">{</font><font color="#800000">&quot;codendereco&quot;</font><font color="#800080">},
                  </font><font color="#008080">$nMaxTentativas</font><font color="#800080">,</font><font color="#008080">$false</font><font color="#800080">,</font><font color="#008080">$opNumero</font><font color="#800080">);
    }
    </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#000080">length</font><font color="#800080">(</font><font color="#008080">$sRegistro</font><font color="#800080">) &gt; </font><font color="#FF0000">0</font><font color="#800080">) {
      </font><font color="#008080">$tCliente</font><font color="#800080">{</font><font color="#800000">&quot;codendereco&quot;</font><font color="#800080">} = trim(copy(</font><font color="#008080">$sRegistro</font><font color="#800080">,</font><font color="#FF0000">1</font><font color="#800080">,</font><font color="#FF0000">10</font><font color="#800080">));
      </font><font color="#000080">print</font><font color="#800080">(</font><font color="#800000">&quot; &quot;</font><font color="#800080">.rotulo(</font><font color="#008080">$opEndereco</font><font color="#800080">, </font><font color="#FF0000">2</font><font color="#800080">));
      </font><font color="#000080">print</font><font color="#800080">(copy(</font><font color="#008080">$sRegistro</font><font color="#800080">, </font><font color="#008080">$g_nPosChave</font><font color="#800080">, </font><font color="#008080">$g_nTamChave</font><font color="#800080">).</font><font color="#800000">&quot;\n&quot;</font><font color="#800080">);
      </font><font color="#000080">print</font><font color="#800080">(</font><font color="#800000">&quot; &quot;</font><font color="#800080">.rotulo(</font><font color="#008080">$opEndereco</font><font color="#800080">, </font><font color="#FF0000">3</font><font color="#800080">));
      </font><font color="#000080">print</font><font color="#800080">(copy(</font><font color="#008080">$sRegistro</font><font color="#800080">, </font><font color="#008080">$g_nPosChave</font><font color="#800080">, </font><font color="#008080">$g_nTamChave</font><font color="#800080">).</font><font color="#800000">&quot;\n&quot;</font><font color="#800080">);
      </font><font color="#000080">print</font><font color="#800080">(</font><font color="#800000">&quot; &quot;</font><font color="#800080">.rotulo(</font><font color="#008080">$opEndereco</font><font color="#800080">, </font><font color="#FF0000">4</font><font color="#800080">));
      </font><font color="#000080">print</font><font color="#800080">(copy(</font><font color="#008080">$sRegistro</font><font color="#800080">, </font><font color="#008080">$g_nPosChave</font><font color="#800080">, </font><font color="#008080">$g_nTamChave</font><font color="#800080">).</font><font color="#800000">&quot;\n&quot;</font><font color="#800080">);
      </font><font color="#000080">print</font><font color="#800080">(</font><font color="#800000">&quot; &quot;</font><font color="#800080">.rotulo(</font><font color="#008080">$opEndereco</font><font color="#800080">, </font><font color="#FF0000">5</font><font color="#800080">));
      </font><font color="#000080">print</font><font color="#800080">(copy(</font><font color="#008080">$sRegistro</font><font color="#800080">, </font><font color="#008080">$g_nPosChave</font><font color="#800080">, </font><font color="#008080">$g_nTamChave</font><font color="#800080">).</font><font color="#800000">&quot;\n&quot;</font><font color="#800080">);
      </font><font color="#000080">print</font><font color="#800080">(</font><font color="#800000">&quot; &quot;</font><font color="#800080">.rotulo(</font><font color="#008080">$opEndereco</font><font color="#800080">, </font><font color="#FF0000">6</font><font color="#800080">));
      </font><font color="#000080">print</font><font color="#800080">(copy(</font><font color="#008080">$sRegistro</font><font color="#800080">, </font><font color="#008080">$g_nPosChave</font><font color="#800080">, </font><font color="#008080">$g_nTamChave</font><font color="#800080">).</font><font color="#800000">&quot;\n&quot;</font><font color="#800080">);
    }
  } </font><font color="#0000FF">elsif </font><font color="#800080">(</font><font color="#008080">$ssubreg</font><font color="#800080">==</font><font color="#008080">$opPais</font><font color="#800080">) {
    </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$bSoMostrar</font><font color="#800080">==</font><font color="#008080">$true</font><font color="#800080">) {
       </font><font color="#008080">$sRegistro </font><font color="#800080">= pesqArq(tfPais, </font><font color="#008080">$tCliente</font><font color="#800080">{</font><font color="#800000">&quot;codpais&quot;</font><font color="#800080">}, </font><font color="#FF0000">1</font><font color="#800080">, </font><font color="#FF0000">3</font><font color="#800080">, tamReg(</font><font color="#008080">$opPais</font><font color="#800080">));
    } </font><font color="#0000FF">else </font><font color="#800080">{
       </font><font color="#008080">$sRegistro </font><font color="#800080">= validaEntrada(tfPais,</font><font color="#008080">$ssubreg</font><font color="#800080">,</font><font color="#FF0000">1</font><font color="#800080">,</font><font color="#008080">$tCliente</font><font color="#800080">{</font><font color="#800000">&quot;codpais&quot;</font><font color="#800080">},
                  </font><font color="#008080">$nMaxTentativas</font><font color="#800080">,</font><font color="#008080">$false</font><font color="#800080">,</font><font color="#008080">$opTexto</font><font color="#800080">);
    }
    </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#000080">length</font><font color="#800080">(</font><font color="#008080">$sRegistro</font><font color="#800080">) &gt; </font><font color="#FF0000">0</font><font color="#800080">) {
      </font><font color="#008080">$tCliente</font><font color="#800080">{</font><font color="#800000">&quot;codpais&quot;</font><font color="#800080">} = trim(copy(</font><font color="#008080">$sRegistro</font><font color="#800080">,</font><font color="#FF0000">1</font><font color="#800080">,</font><font color="#FF0000">3</font><font color="#800080">));
      </font><font color="#000080">print</font><font color="#800080">(</font><font color="#800000">&quot; &quot;</font><font color="#800080">.rotulo(</font><font color="#008080">$opPais</font><font color="#800080">, </font><font color="#FF0000">2</font><font color="#800080">));
      </font><font color="#000080">print</font><font color="#800080">(copy(</font><font color="#008080">$sRegistro</font><font color="#800080">, </font><font color="#008080">$g_nPosChave</font><font color="#800080">, </font><font color="#008080">$g_nTamChave</font><font color="#800080">).</font><font color="#800000">&quot;\n&quot;</font><font color="#800080">);
    }
  } </font><font color="#0000FF">elsif </font><font color="#800080">(</font><font color="#008080">$ssubreg</font><font color="#800080">==</font><font color="#008080">$opProfissao</font><font color="#800080">) {
    </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$bSoMostrar</font><font color="#800080">==</font><font color="#008080">$true</font><font color="#800080">) {
       </font><font color="#008080">$sRegistro </font><font color="#800080">= pesqArq(tfProfissao, </font><font color="#008080">$tCliente</font><font color="#800080">{</font><font color="#800000">&quot;codprofissao&quot;</font><font color="#800080">}, </font><font color="#FF0000">1</font><font color="#800080">, </font><font color="#FF0000">10</font><font color="#800080">,
                  tamReg(</font><font color="#008080">$opProfissao</font><font color="#800080">));
    } </font><font color="#0000FF">else </font><font color="#800080">{
       </font><font color="#008080">$sRegistro </font><font color="#800080">= validaEntrada(tfProfissao,</font><font color="#008080">$ssubreg</font><font color="#800080">,</font><font color="#FF0000">1</font><font color="#800080">,</font><font color="#008080">$tCliente</font><font color="#800080">{</font><font color="#800000">&quot;codprofissao&quot;</font><font color="#800080">},
                  </font><font color="#008080">$nMaxTentativas</font><font color="#800080">,</font><font color="#008080">$false</font><font color="#800080">,</font><font color="#008080">$opNumero</font><font color="#800080">);
    }
    </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#000080">length</font><font color="#800080">(</font><font color="#008080">$sRegistro</font><font color="#800080">) &gt; </font><font color="#FF0000">0</font><font color="#800080">) {
      </font><font color="#008080">$tCliente</font><font color="#800080">{</font><font color="#800000">&quot;codprofissao&quot;</font><font color="#800080">} = trim(copy(</font><font color="#008080">$sRegistro</font><font color="#800080">,</font><font color="#FF0000">1</font><font color="#800080">,</font><font color="#FF0000">10</font><font color="#800080">));
      </font><font color="#000080">print</font><font color="#800080">(</font><font color="#800000">&quot; &quot;</font><font color="#800080">.rotulo(</font><font color="#008080">$opProfissao</font><font color="#800080">, </font><font color="#FF0000">2</font><font color="#800080">));
      </font><font color="#000080">print</font><font color="#800080">(copy(</font><font color="#008080">$sRegistro</font><font color="#800080">, </font><font color="#008080">$g_nPosChave</font><font color="#800080">, </font><font color="#008080">$g_nTamChave</font><font color="#800080">).</font><font color="#800000">&quot;\n&quot;</font><font color="#800080">);
    }
  }
} </font><font color="#0000FF">elsif </font><font color="#800080">(</font><font color="#008080">$sreg</font><font color="#800080">==</font><font color="#008080">$opVenda</font><font color="#800080">) {
  </font><font color="#008080">$sRegistro </font><font color="#800080">= pesqArq(tfLivro, </font><font color="#008080">$tVenda</font><font color="#800080">{</font><font color="#800000">&quot;isbn&quot;</font><font color="#800080">}, </font><font color="#FF0000">1</font><font color="#800080">, </font><font color="#FF0000">13</font><font color="#800080">, tamReg(</font><font color="#008080">$opLivro</font><font color="#800080">));
  </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#000080">length</font><font color="#800080">(</font><font color="#008080">$sRegistro</font><font color="#800080">) &gt; </font><font color="#FF0000">0</font><font color="#800080">) {
    </font><font color="#000080">print</font><font color="#800080">(</font><font color="#800000">&quot; &quot;</font><font color="#800080">.rotulo(</font><font color="#008080">$opLivro</font><font color="#800080">, </font><font color="#FF0000">2</font><font color="#800080">)); </font><font color="#808080"><i># Titulo
    </i></font><font color="#000080">print</font><font color="#800080">(copy(</font><font color="#008080">$sRegistro</font><font color="#800080">, </font><font color="#008080">$g_nPosChave</font><font color="#800080">, </font><font color="#008080">$g_nTamChave</font><font color="#800080">).</font><font color="#800000">&quot;\n&quot;</font><font color="#800080">);
    </font><font color="#000080">print</font><font color="#800080">(</font><font color="#800000">&quot; &quot;</font><font color="#800080">.rotulo(</font><font color="#008080">$opLivro</font><font color="#800080">, </font><font color="#FF0000">9</font><font color="#800080">)); </font><font color="#808080"><i># Preco
    </i></font><font color="#008080">$sPreco </font><font color="#800080">= copy(</font><font color="#008080">$sRegistro</font><font color="#800080">, </font><font color="#008080">$g_nPosChave</font><font color="#800080">, </font><font color="#008080">$g_nTamChave</font><font color="#800080">);
    </font><font color="#008080">$g_nPreco </font><font color="#800080">= </font><font color="#008080">$sPreco</font><font color="#800080">;
    </font><font color="#000080">print</font><font color="#800080">(</font><font color="#008080">$sPreco</font><font color="#800080">.</font><font color="#800000">&quot;\n&quot;</font><font color="#800080">);
  }
}
}
</font><font color="#808080"><i>#------------------------------------------------------------------------------
# Realiza os cadastros dos arquivos que se ligam a outros arquivos.
# sreg - o tipo de arquivo
# sacao - a a&ccedil;&atilde;o a ser realizada
# sCodigo - um das chaves do arquivo de liga&ccedil;&atilde;o
#------------------------------------------------------------------------------
</i></font><font color="#0000FF">sub </font><font color="#800080">frmCadLigados { 
</font><font color="#0000FF">my </font><font color="#008080">$sreg </font><font color="#800080">= </font><font color="#FF00FF">$_</font><font color="#800080">[</font><font color="#FF0000">0</font><font color="#800080">]; 
</font><font color="#0000FF">my </font><font color="#008080">$sacao </font><font color="#800080">= </font><font color="#FF00FF">$_</font><font color="#800080">[</font><font color="#FF0000">1</font><font color="#800080">]; 
</font><font color="#0000FF">my </font><font color="#008080">$sCodigo </font><font color="#800080">= </font><font color="#FF00FF">$_</font><font color="#800080">[</font><font color="#FF0000">2</font><font color="#800080">];

</font><font color="#0000FF">my </font><font color="#008080">$nQtd</font><font color="#800080">; </font><font color="#0000FF">my </font><font color="#008080">$nCont</font><font color="#800080">; </font><font color="#0000FF">my </font><font color="#008080">$nQtdEstoque</font><font color="#800080">;
</font><font color="#0000FF">my </font><font color="#008080">$nTotalPreco</font><font color="#800080">;
</font><font color="#0000FF">my </font><font color="#008080">$slinha</font><font color="#800080">; </font><font color="#0000FF">my </font><font color="#008080">$sTotalPreco</font><font color="#800080">; </font><font color="#0000FF">my </font><font color="#008080">$sPreco</font><font color="#800080">;
</font><font color="#0000FF">my </font><font color="#008080">$sQtd</font><font color="#800080">;

</font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$sacao</font><font color="#800080">==</font><font color="#008080">$opNovo</font><font color="#800080">) {
  </font><font color="#008080">$nCont </font><font color="#800080">= </font><font color="#FF0000">1</font><font color="#800080">;
  </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$sreg</font><font color="#800080">==</font><font color="#008080">$opLivroAss</font><font color="#800080">) {
    </font><font color="#008080">$sQtd </font><font color="#800080">= validaNumero(</font><font color="#800000">&quot;Quantos assuntos quer cadastrar?: &quot;</font><font color="#800080">,</font><font color="#008080">$sQtd</font><font color="#800080">);
    </font><font color="#008080">$nQtd </font><font color="#800080">= </font><font color="#008080">$sQtd</font><font color="#800080">;
    </font><font color="#000080">seek</font><font color="#800080">(tfLivroAss, </font><font color="#FF0000">0</font><font color="#800080">, </font><font color="#008080">$SEEK_SET</font><font color="#800080">);
    </font><font color="#0000FF">while </font><font color="#800080">(</font><font color="#008080">$nCont </font><font color="#800080">&lt;= </font><font color="#008080">$nQtd</font><font color="#800080">) {
      </font><font color="#008080">$tLivroAss</font><font color="#800080">{</font><font color="#800000">&quot;isbn&quot;</font><font color="#800080">} = </font><font color="#008080">$sCodigo</font><font color="#800080">;
      </font><font color="#000080">print</font><font color="#800080">(rotulo(</font><font color="#008080">$opLivroAss</font><font color="#800080">, </font><font color="#FF0000">2</font><font color="#800080">));
      </font><font color="#008080">$tLivroAss</font><font color="#800080">{</font><font color="#800000">&quot;codassunto&quot;</font><font color="#800080">} = digita();
      </font><font color="#008080">$slinha </font><font color="#800080">= pesqArq(tfAssunto, </font><font color="#008080">$tLivroAss</font><font color="#800080">{</font><font color="#800000">&quot;codassunto&quot;</font><font color="#800080">},</font><font color="#FF0000">1</font><font color="#800080">,</font><font color="#FF0000">10</font><font color="#800080">,tamReg(</font><font color="#008080">$opAssunto</font><font color="#800080">));
      </font><font color="#000080">print</font><font color="#800080">(</font><font color="#800000">&quot; &quot;</font><font color="#800080">.rotulo(</font><font color="#008080">$opAssunto</font><font color="#800080">, </font><font color="#FF0000">2</font><font color="#800080">));
      </font><font color="#000080">print</font><font color="#800080">(copy(</font><font color="#008080">$slinha</font><font color="#800080">, </font><font color="#008080">$g_nPosChave</font><font color="#800080">, </font><font color="#008080">$g_nTamChave</font><font color="#800080">).</font><font color="#800000">&quot;\n&quot;</font><font color="#800080">);
      pesqLinhaExcluida(tfLivroAss, tamReg(</font><font color="#008080">$sreg</font><font color="#800080">));
      subMenu(</font><font color="#FF0000">14</font><font color="#800080">, </font><font color="#008080">$sreg</font><font color="#800080">);
      </font><font color="#008080">$nCont</font><font color="#800080">++;
    }
  } </font><font color="#0000FF">elsif </font><font color="#800080">(</font><font color="#008080">$sreg</font><font color="#800080">==</font><font color="#008080">$opLivroAut</font><font color="#800080">) {
    </font><font color="#008080">$sQtd </font><font color="#800080">= validaNumero(</font><font color="#800000">&quot;Quantos autores quer cadastrar?: &quot;</font><font color="#800080">,</font><font color="#008080">$sQtd</font><font color="#800080">);
    </font><font color="#008080">$nQtd </font><font color="#800080">= </font><font color="#008080">$sQtd</font><font color="#800080">;
    </font><font color="#000080">seek</font><font color="#800080">(tfLivroAut, </font><font color="#FF0000">0</font><font color="#800080">, </font><font color="#008080">$SEEK_SET</font><font color="#800080">);
    </font><font color="#0000FF">while </font><font color="#800080">(</font><font color="#008080">$nCont </font><font color="#800080">&lt;= </font><font color="#008080">$nQtd</font><font color="#800080">) {
      </font><font color="#008080">$tLivroAut</font><font color="#800080">{</font><font color="#800000">&quot;isbn&quot;</font><font color="#800080">} = </font><font color="#008080">$sCodigo</font><font color="#800080">;
      </font><font color="#000080">print</font><font color="#800080">(rotulo(</font><font color="#008080">$opLivroAut</font><font color="#800080">, </font><font color="#FF0000">2</font><font color="#800080">));
      </font><font color="#008080">$tLivroAut</font><font color="#800080">{</font><font color="#800000">&quot;codautor&quot;</font><font color="#800080">} = digita();
      </font><font color="#008080">$slinha </font><font color="#800080">= pesqArq(tfAutor, </font><font color="#008080">$tLivroAut</font><font color="#800080">{</font><font color="#800000">&quot;codautor&quot;</font><font color="#800080">},</font><font color="#FF0000">1</font><font color="#800080">,</font><font color="#FF0000">10</font><font color="#800080">,tamReg(</font><font color="#008080">$opAutor</font><font color="#800080">));
      </font><font color="#000080">print</font><font color="#800080">(</font><font color="#800000">&quot; &quot;</font><font color="#800080">.rotulo(</font><font color="#008080">$opAutor</font><font color="#800080">, </font><font color="#FF0000">2</font><font color="#800080">));
      </font><font color="#000080">print</font><font color="#800080">(copy(</font><font color="#008080">$slinha</font><font color="#800080">, </font><font color="#008080">$g_nPosChave</font><font color="#800080">, </font><font color="#008080">$g_nTamChave</font><font color="#800080">).</font><font color="#800000">&quot;\n&quot;</font><font color="#800080">);
      pesqLinhaExcluida(tfLivroAut, tamReg(</font><font color="#008080">$sreg</font><font color="#800080">));
      subMenu(</font><font color="#FF0000">14</font><font color="#800080">, </font><font color="#008080">$sreg</font><font color="#800080">);
      </font><font color="#008080">$nCont</font><font color="#800080">++;
    }
  } </font><font color="#0000FF">elsif </font><font color="#800080">(</font><font color="#008080">$sreg</font><font color="#800080">==</font><font color="#008080">$opVenda</font><font color="#800080">) {
    </font><font color="#008080">$sPreco </font><font color="#800080">= </font><font color="#800000">&quot;&quot;</font><font color="#800080">;
    </font><font color="#008080">$sTotalPreco </font><font color="#800080">= </font><font color="#800000">&quot;&quot;</font><font color="#800080">;
    </font><font color="#008080">$sQtd </font><font color="#800080">= validaNumero(</font><font color="#800000">&quot;Quantos livros quer vender?: &quot;</font><font color="#800080">,</font><font color="#008080">$sQtd</font><font color="#800080">);
    </font><font color="#008080">$nQtd </font><font color="#800080">= </font><font color="#008080">$sQtd</font><font color="#800080">;
    </font><font color="#008080">$nTotalPreco </font><font color="#800080">= </font><font color="#FF0000">0</font><font color="#800080">;
    </font><font color="#0000FF">while </font><font color="#800080">(</font><font color="#008080">$nCont </font><font color="#800080">&lt;= </font><font color="#008080">$nQtd</font><font color="#800080">) {
      </font><font color="#008080">$slinha </font><font color="#800080">= validaEntrada(tfLivro,</font><font color="#008080">$opLivro</font><font color="#800080">,</font><font color="#FF0000">1</font><font color="#800080">,</font><font color="#008080">$tVenda</font><font color="#800080">{</font><font color="#800000">&quot;isbn&quot;</font><font color="#800080">},</font><font color="#FF0000">3</font><font color="#800080">,</font><font color="#008080">$false</font><font color="#800080">,</font><font color="#008080">$opTexto</font><font color="#800080">);
      </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#000080">length</font><font color="#800080">(</font><font color="#008080">$slinha</font><font color="#800080">) &gt; </font><font color="#FF0000">0</font><font color="#800080">) {
        </font><font color="#008080">$tVenda</font><font color="#800080">{</font><font color="#800000">&quot;isbn&quot;</font><font color="#800080">} = trim(copy(</font><font color="#008080">$slinha</font><font color="#800080">,</font><font color="#FF0000">1</font><font color="#800080">,</font><font color="#FF0000">13</font><font color="#800080">));
        </font><font color="#0000FF">if </font><font color="#800080">(validaISBN(</font><font color="#008080">$tVenda</font><font color="#800080">{</font><font color="#800000">&quot;isbn&quot;</font><font color="#800080">})) {
          mostrarDados(</font><font color="#008080">$sreg</font><font color="#800080">, </font><font color="#800000">&quot;&quot;</font><font color="#800080">, </font><font color="#FF0000">1</font><font color="#800080">);
          </font><font color="#008080">$tLivro</font><font color="#800080">{</font><font color="#800000">&quot;qtdestoque&quot;</font><font color="#800080">} = trim(copy(</font><font color="#008080">$slinha</font><font color="#800080">,</font><font color="#FF0000">134</font><font color="#800080">,</font><font color="#FF0000">10</font><font color="#800080">));
          </font><font color="#008080">$nQtdEstoque </font><font color="#800080">= </font><font color="#008080">$tLivro</font><font color="#800080">{</font><font color="#800000">&quot;qtdestoque&quot;</font><font color="#800080">};
          </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$nQtdEstoque </font><font color="#800080">&gt; </font><font color="#FF0000">0</font><font color="#800080">) {
             </font><font color="#008080">$nTotalPreco </font><font color="#800080">= </font><font color="#008080">$nTotalPreco </font><font color="#800080">+ </font><font color="#008080">$g_nPreco</font><font color="#800080">;
             </font><font color="#008080">$sPreco </font><font color="#800080">= </font><font color="#008080">$g_nPreco</font><font color="#800080">;
             </font><font color="#008080">$tVenda</font><font color="#800080">{</font><font color="#800000">&quot;precovenda&quot;</font><font color="#800080">} = </font><font color="#008080">$sPreco</font><font color="#800080">;
             </font><font color="#008080">$g_SalvarInclusao </font><font color="#800080">= </font><font color="#008080">$false</font><font color="#800080">;
             subMenu(</font><font color="#FF0000">14</font><font color="#800080">, </font><font color="#008080">$sreg</font><font color="#800080">);
             </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$g_SalvarInclusao</font><font color="#800080">==</font><font color="#008080">$true</font><font color="#800080">) {
                </font><font color="#008080">$slinha </font><font color="#800080">= pesqArq(tfLivro, </font><font color="#008080">$tVenda</font><font color="#800080">{</font><font color="#800000">&quot;isbn&quot;</font><font color="#800080">}, </font><font color="#FF0000">1</font><font color="#800080">, </font><font color="#FF0000">13</font><font color="#800080">, tamReg(</font><font color="#008080">$opLivro</font><font color="#800080">));
                </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#000080">length</font><font color="#800080">(</font><font color="#008080">$slinha</font><font color="#800080">) &gt; </font><font color="#FF0000">0</font><font color="#800080">) {
                   </font><font color="#008080">$nQtdEstoque </font><font color="#800080">= </font><font color="#008080">$nQtdEstoque</font><font color="#800080">-</font><font color="#FF0000">1</font><font color="#800080">;
                   </font><font color="#008080">$tLivro</font><font color="#800080">{</font><font color="#800000">&quot;qtdestoque&quot;</font><font color="#800080">} = </font><font color="#008080">$nQtdEstoque</font><font color="#800080">;
                   </font><font color="#008080">$slinha</font><font color="#800080">=copy(</font><font color="#008080">$slinha</font><font color="#800080">,</font><font color="#FF0000">1</font><font color="#800080">,</font><font color="#FF0000">133</font><font color="#800080">).esp(</font><font color="#008080">$tLivro</font><font color="#800080">{</font><font color="#800000">&quot;qtdestoque&quot;</font><font color="#800080">},</font><font color="#FF0000">10</font><font color="#800080">);
                   escreveArq(tfLivro, </font><font color="#008080">$slinha</font><font color="#800080">, </font><font color="#800000">&quot;&quot;</font><font color="#800080">, </font><font color="#800000">&quot;&quot;</font><font color="#800080">);
                }
             }
             </font><font color="#008080">$nCont</font><font color="#800080">++;
          } </font><font color="#0000FF">else </font><font color="#800080">{ </font><font color="#000080">print</font><font color="#800080">(MSG_SEMESTOQUE); }
        } </font><font color="#0000FF">else </font><font color="#800080">{ </font><font color="#000080">print</font><font color="#800080">(MSG_ISBNINV); }
      }
    }
    </font><font color="#008080">$nTotalPreco </font><font color="#800080">= </font><font color="#008080">$sTotalPreco</font><font color="#800080">;
    </font><font color="#000080">print</font><font color="#800080">(</font><font color="#800000">&quot;Total de &quot;</font><font color="#800080">.rotulo(</font><font color="#008080">$sreg</font><font color="#800080">,</font><font color="#FF0000">4</font><font color="#800080">).</font><font color="#008080">$nTotalPreco</font><font color="#800080">.</font><font color="#800000">&quot;\n&quot;</font><font color="#800080">);
  }
} </font><font color="#0000FF">elsif </font><font color="#800080">(</font><font color="#008080">$sacao</font><font color="#800080">==</font><font color="#008080">$opExcluir</font><font color="#800080">) {
  </font><font color="#0000FF">if </font><font color="#800080">(</font><font color="#008080">$sreg</font><font color="#800080">==</font><font color="#008080">$opLivroAss</font><font color="#800080">) {
     ExcluirRegLigados(tfLivroAss, </font><font color="#008080">$sreg</font><font color="#800080">, </font><font color="#FF0000">1</font><font color="#800080">, </font><font color="#FF0000">13</font><font color="#800080">, </font><font color="#008080">$sCodigo</font><font color="#800080">);
  } </font><font color="#0000FF">elsif </font><font color="#800080">(</font><font color="#008080">$sreg</font><font color="#800080">==</font><font color="#008080">$opLivroAut</font><font color="#800080">) {
     ExcluirRegLigados(tfLivroAut, </font><font color="#008080">$sreg</font><font color="#800080">, </font><font color="#FF0000">1</font><font color="#800080">, </font><font color="#FF0000">13</font><font color="#800080">, </font><font color="#008080">$sCodigo</font><font color="#800080">);
  }
}

}
</font><font color="#808080"><i>#------------------------------------------------------------------------------
# Realiza a exclus&atilde;o dos arquivos de liga&ccedil;&atilde;o.
# sArq - o arquivo de liga&ccedil;&atilde;o
# sreg - o tipo de arquivo de liga&ccedil;&atilde;o
# nPosChave - a posicao inicial da chave dentro do registro
# nTamChave - o tamanho da chave dentro do registro
# sChave - a chave a ser excluida
#------------------------------------------------------------------------------
</i></font><font color="#0000FF">sub </font><font color="#800080">ExcluirRegLigados {
</font><font color="#0000FF">my </font><font color="#008080">$sArq </font><font color="#800080">= </font><font color="#FF00FF">$_</font><font color="#800080">[</font><font color="#FF0000">0</font><font color="#800080">];
</font><font color="#0000FF">my </font><font color="#008080">$sreg </font><font color="#800080">= </font><font color="#FF00FF">$_</font><font color="#800080">[</font><font color="#FF0000">1</font><font color="#800080">];
</font><font color="#0000FF">my </font><font color="#008080">$nPosChave </font><font color="#800080">= </font><font color="#FF00FF">$_</font><font color="#800080">[</font><font color="#FF0000">2</font><font color="#800080">];
</font><font color="#0000FF">my </font><font color="#008080">$nTamChave </font><font color="#800080">= </font><font color="#FF00FF">$_</font><font color="#800080">[</font><font color="#FF0000">3</font><font color="#800080">];
</font><font color="#0000FF">my </font><font color="#008080">$sChave </font><font color="#800080">= </font><font color="#FF00FF">$_</font><font color="#800080">[</font><font color="#FF0000">4</font><font color="#800080">];

</font><font color="#0000FF">my </font><font color="#008080">$slinha</font><font color="#800080">; </font><font color="#0000FF">my </font><font color="#008080">$sCodigo</font><font color="#800080">;

  </font><font color="#000080">seek</font><font color="#800080">(</font><font color="#008080">$sArq</font><font color="#800080">, </font><font color="#FF0000">0</font><font color="#800080">, </font><font color="#008080">$SEEK_SET</font><font color="#800080">);
  </font><font color="#0000FF">while </font><font color="#800080">(!</font><font color="#000080">eof</font><font color="#800080">(</font><font color="#008080">$sArq</font><font color="#800080">)) {
    </font><font color="#008080">$slinha </font><font color="#800080">= &lt;</font><font color="#008080">$sArq</font><font color="#800080">&gt;;
    </font><font color="#008080">$sCodigo </font><font color="#800080">= trim(copy(</font><font color="#008080">$slinha</font><font color="#800080">,</font><font color="#008080">$nPosChave</font><font color="#800080">,</font><font color="#008080">$nTamChave</font><font color="#800080">));
    </font><font color="#0000FF">if </font><font color="#800080">(strcmp(</font><font color="#008080">$sCodigo</font><font color="#800080">,</font><font color="#008080">$sChave</font><font color="#800080">)==</font><font color="#008080">$true</font><font color="#800080">) {
       btnAcao(</font><font color="#008080">$sreg</font><font color="#800080">,</font><font color="#008080">$opConfirmaExclusao</font><font color="#800080">);
    } 
  }
}
</font><font color="#808080"><i>#------------------------------------------------------------------------------
# Parte inicial do c&oacute;digo
#------------------------------------------------------------------------------
</i></font><font color="#0000FF">sub </font><font color="#800080">main {
 </font><font color="#0000FF">if </font><font color="#800080">((</font><font color="#FF00FF">$#ARGV </font><font color="#800080">== </font><font color="#FF0000">0</font><font color="#800080">) &amp;&amp; (strcmp(</font><font color="#FF00FF">$ARGV</font><font color="#800080">[</font><font color="#FF0000">0</font><font color="#800080">],</font><font color="#800000">&quot;-cria&quot;</font><font color="#800080">)==</font><font color="#008080">$true</font><font color="#800080">)) {
   abrecriaArqs(</font><font color="#008080">$false</font><font color="#800080">);
 } </font><font color="#0000FF">else </font><font color="#800080">{
   frmSplash();
   abrecriaArqs(</font><font color="#008080">$true</font><font color="#800080">);
   </font><font color="#0000FF">if </font><font color="#800080">(frmLogin()==</font><font color="#008080">$true</font><font color="#800080">) {
     </font><font color="#008080">$bopcao </font><font color="#800080">= </font><font color="#008080">$true</font><font color="#800080">;
     </font><font color="#0000FF">while </font><font color="#800080">(</font><font color="#008080">$bopcao</font><font color="#800080">==</font><font color="#008080">$true</font><font color="#800080">) {
       menu(</font><font color="#FF0000">1</font><font color="#800080">);
       </font><font color="#008080">$opmenu </font><font color="#800080">= digita();
       </font><font color="#0000FF">if </font><font color="#800080">((</font><font color="#008080">$opmenu</font><font color="#800080">=~</font><font color="#800000">'C'</font><font color="#800080">) || (</font><font color="#008080">$opmenu</font><font color="#800080">=~</font><font color="#800000">'c'</font><font color="#800080">)) { usaMenu(</font><font color="#FF0000">1</font><font color="#800080">); }
       </font><font color="#0000FF">elsif </font><font color="#800080">((</font><font color="#008080">$opmenu</font><font color="#800080">=~</font><font color="#800000">'P'</font><font color="#800080">) || (</font><font color="#008080">$opmenu</font><font color="#800080">=~</font><font color="#800000">'p'</font><font color="#800080">)) { usaMenu(</font><font color="#FF0000">2</font><font color="#800080">); }
       </font><font color="#0000FF">elsif </font><font color="#800080">((</font><font color="#008080">$opmenu</font><font color="#800080">=~</font><font color="#800000">'V'</font><font color="#800080">) || (</font><font color="#008080">$opmenu</font><font color="#800080">=~</font><font color="#800000">'v'</font><font color="#800080">)) { usaMenu(</font><font color="#FF0000">3</font><font color="#800080">); }
       </font><font color="#0000FF">elsif </font><font color="#800080">((</font><font color="#008080">$opmenu</font><font color="#800080">=~</font><font color="#800000">'O'</font><font color="#800080">) || (</font><font color="#008080">$opmenu</font><font color="#800080">=~</font><font color="#800000">'o'</font><font color="#800080">)) { usaMenu(</font><font color="#FF0000">4</font><font color="#800080">); }
       </font><font color="#0000FF">else </font><font color="#800080">{ </font><font color="#000080">print</font><font color="#800080">(</font><font color="#008080">$MSG_ERRO</font><font color="#800080">); }
     }
   } </font><font color="#0000FF">else </font><font color="#800080">{
     fechaArqs();
     </font><font color="#0000FF">exit</font><font color="#800080">(</font><font color="#FF0000">0</font><font color="#800080">);
   }
 }
 </font><font color="#0000FF">exit</font><font color="#800080">(</font><font color="#FF0000">0</font><font color="#800080">);
}

main();
</font></font>
</code></pre>
</body>
</html>