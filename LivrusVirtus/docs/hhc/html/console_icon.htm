<html>
<head>
<title>Livrus Virtus - Console - Icon</title>
</head>
<!-- Generated by ConTEXT HTML exporter -->
<body text="#000000" bgcolor="#FFFFFF">
<pre>
<code><font  face="Courier New"><font color="#808080">#------------------------------------------------------------------------------
# Sistema integrante do projeto Livrus Virtus.
# Todos os direitos reservados para Henrique F. de Souza.
# Vers&atilde;o programada na linguagem Icon.
#------------------------------------------------------------------------------
# programa Livrus

</font>record regAssunto<font color="#008080"><b>(</b></font>codigo, assunto<font color="#008080"><b>)
</b></font>record regAutor<font color="#008080"><b>(</b></font>codigo, autor<font color="#008080"><b>)
</b></font>record regEditora<font color="#008080"><b>(</b></font>codigo, editora<font color="#008080"><b>)
</b></font>record regIdioma<font color="#008080"><b>(</b></font>codigo, idioma<font color="#008080"><b>)
</b></font>record regUsuario<font color="#008080"><b>(</b></font>login, senha<font color="#008080"><b>)
</b></font>record regPais<font color="#008080"><b>(</b></font>codigo, pais<font color="#008080"><b>)
</b></font>record regProfissao<font color="#008080"><b>(</b></font>codigo, profissao<font color="#008080"><b>)
</b></font>record regLivro<font color="#008080"><b>(</b></font>isbn, titulo, edicao, anopubli, codeditora, volume,
                codidioma, npaginas, preco, qtdestoque<font color="#008080"><b>)
</b></font>record regLivroAss<font color="#008080"><b>(</b></font>isbn, codassunto<font color="#008080"><b>)
</b></font>record regLivroAut<font color="#008080"><b>(</b></font>isbn, codautor<font color="#008080"><b>)
</b></font>record regCliente<font color="#008080"><b>(</b></font>cpf, nome, email, identidade, sexo, telefone, dtnascimento,
                  codendereco, codpais, codprofissao<font color="#008080"><b>)
</b></font>record regEndereco<font color="#008080"><b>(</b></font>codigo, logradouro, bairro, cep, cidade, estado<font color="#008080"><b>)
</b></font>record regVenda<font color="#008080"><b>(</b></font>dthrvenda, <font color="#808080"># data/hora da venda dd/mm/yyyy hh:mm:ss
                </font>cpf, isbn, precovenda<font color="#008080"><b>)

</b></font>global true, false

global ctTipo, opTexto, opNumero, opData, opDataHora, opSenha
global ctArqs, opAssunto, opAutor, opEditora, opEndereco, opIdioma, opPais, 
   opProfissao, opCliente, opLivro, opLivroAss, opLivroAut, opUsuario, opVenda
global ctAcao, opNovo, opAlterar, opPesquisar, opSalvarInclusao,
       opSalvarAlteracao, opExcluir, opConfirmaExclusao, opListarTodos

global CRLF, TAM_CRLF, QTD_MAX_LINHA, ARQ_ABRE, ARQ_CRIA, 
       MSG_ARQERRO, MSG_ARQCERRO

global MSG_ERRO, MSG_OPCAO, MSG_PRESS, MSG_REGINC, MSG_REGNINC, MSG_REGALT,
       MSG_REGNALT, MSG_REGEXC, MSG_REGNEXC, MSG_REGEXST
global MSG_NUMINV, MSG_DATAINV, MSG_DTHRINV, MSG_ISBNINV, MSG_CPFINV, 
       MSG_SENCONFERE, MSG_SENCONFIRM, MSG_LOGINENCON, MSG_SEMESTOQUE

global ARQ_ASSUNTO, ARQ_AUTOR, ARQ_EDITORA, ARQ_IDIOMA,  ARQ_USUARIO, ARQ_PAIS,
       ARQ_PROFISSAO, ARQ_LIVRO, ARQ_LIVASS, ARQ_LIVAUT, ARQ_CLIENTE, 
       ARQ_ENDERECO, ARQ_VENDA
global TAM_ASSUNTO, TAM_AUTOR, TAM_EDITORA, TAM_IDIOMA, TAM_USUARIO, TAM_PAIS, 
       TAM_PROFISSAO, TAM_LIVRO, TAM_LIVASS, TAM_LIVAUT, TAM_CLIENTE, 
       TAM_ENDERECO, TAM_VENDA

global bopcao, opmenu, g_nPosChave, g_nTamChave, g_nPreco, g_SalvarInclusao

global tAssunto, tAutor, tEditora, tIdioma, tEndereco, tPais, tProfissao, 
       tLivro, tLivroAss, tLivroAut, tCliente, tUsuario, tVenda
global tfAssunto, tfAutor, tfEditora, tfIdioma, tfEndereco, tfPais, tfProfissao,
       tfLivro, tfLivroAss, tfLivroAut, tfCliente, tfUsuario, tfVenda

<font color="#808080"># constantes
</font>procedure constantes<font color="#008080"><b>()
</b></font>true := 1 
false := 0

ctTipo := set<font color="#008080"><b>([</b></font>opTexto:=1, opNumero:=2, opData:=3, opDataHora:=4, opSenha:=5<font color="#008080"><b>])
</b></font>ctArqs := set<font color="#008080"><b>([</b></font>opAssunto:=1, opAutor:=2, opEditora:=3, opEndereco:=4, 
          opIdioma:=5, opPais:=6, opProfissao:=7, opCliente:=8, opLivro:=9, 
          opLivroAss:=10, opLivroAut:=11, opUsuario:=12, opVenda:=13<font color="#008080"><b>])
</b></font>ctAcao := set<font color="#008080"><b>([</b></font>opNovo:=1, opAlterar:=2, opPesquisar:=3, opSalvarInclusao:=4,
              opSalvarAlteracao:=5, opExcluir:=6, opConfirmaExclusao:=7, 
              opListarTodos:=8<font color="#008080"><b>])

</b></font>CRLF := <font color="#800000">&quot;\r\n&quot; </font><font color="#808080"># windows 
</font>TAM_CRLF := 2
<font color="#808080"># CRLF := &quot;\n&quot;
# TAM_CRLF := 1 # unix 
# CRLF := &quot;\r&quot;
# TAM_CRLF := 1 # macintosh 

</font>QTD_MAX_LINHA := 18

ARQ_ABRE := <font color="#800000">&quot;bt&quot;
</font>ARQ_CRIA := <font color="#800000">&quot;ct&quot;

</font>MSG_ARQERRO := <font color="#800000">&quot;Erro: o arquivo n&atilde;o pode ser aberto.&quot;
</font>MSG_ARQCERRO := <font color="#800000">&quot;Erro: o arquivo n&atilde;o pode ser criado.&quot;
</font>MSG_ERRO := <font color="#800000">&quot;Erro: op&ccedil;&atilde;o inv&aacute;lida digite de novo&quot;
</font>MSG_OPCAO := <font color="#800000">&quot;Escolha uma op&ccedil;&atilde;o: &quot;
</font>MSG_PRESS := <font color="#800000">&quot;pressione para continuar...&quot;

</font>MSG_REGINC := <font color="#800000">&quot;registro incluido!&quot;
</font>MSG_REGNINC := <font color="#800000">&quot;registro n&atilde;o incluido!&quot;
</font>MSG_REGALT := <font color="#800000">&quot;registro alterado!&quot;
</font>MSG_REGNALT := <font color="#800000">&quot;registro n&atilde;o alterado!&quot;
</font>MSG_REGEXC := <font color="#800000">&quot;registro excluido!&quot;
</font>MSG_REGNEXC := <font color="#800000">&quot;registro n&atilde;o excluido!&quot;
</font>MSG_REGEXST := <font color="#800000">&quot;registro j&aacute; existe!&quot;

</font>MSG_NUMINV := <font color="#800000">&quot;N&uacute;mero inv&aacute;lido ou menor do que 1!&quot;
</font>MSG_DATAINV := <font color="#800000">&quot;Data inv&aacute;lida!, formato correto (dd/mm/yyyy)&quot;
</font>MSG_DTHRINV := <font color="#800000">&quot;Data/hora inv&aacute;lida!, formato correto (dd/mm/yyyy hh:mm:ss)&quot;
</font>MSG_ISBNINV := <font color="#800000">&quot;ISBN inv&aacute;lido!&quot;
</font>MSG_CPFINV := <font color="#800000">&quot;CPF inv&aacute;lido!&quot;
</font>MSG_SENCONFERE := <font color="#800000">&quot;senha n&atilde;o confere com a senha atual!&quot;
</font>MSG_SENCONFIRM := <font color="#800000">&quot;nova senha n&atilde;o confere com a senha confirmada!&quot;
</font>MSG_LOGINENCON := <font color="#800000">&quot;login n&atilde;o encontrado!&quot;
</font>MSG_SEMESTOQUE := <font color="#800000">&quot;livro n&atilde;o existe no estoque!&quot;

</font>ARQ_ASSUNTO := <font color="#800000">&quot;assunto.dat&quot;
</font>ARQ_AUTOR := <font color="#800000">&quot;autor.dat&quot;
</font>ARQ_EDITORA := <font color="#800000">&quot;editora.dat&quot;
</font>ARQ_IDIOMA := <font color="#800000">&quot;idioma.dat&quot;
</font>ARQ_USUARIO := <font color="#800000">&quot;usuario.dat&quot;
</font>ARQ_PAIS := <font color="#800000">&quot;pais.dat&quot;
</font>ARQ_PROFISSAO := <font color="#800000">&quot;profissao.dat&quot;
</font>ARQ_LIVRO := <font color="#800000">&quot;livro.dat&quot;
</font>ARQ_LIVASS := <font color="#800000">&quot;livroass.dat&quot;
</font>ARQ_LIVAUT := <font color="#800000">&quot;livroaut.dat&quot;
</font>ARQ_CLIENTE := <font color="#800000">&quot;cliente.dat&quot;
</font>ARQ_ENDERECO := <font color="#800000">&quot;endereco.dat&quot;
</font>ARQ_VENDA := <font color="#800000">&quot;venda.dat&quot;

</font>TAM_ASSUNTO := 40
TAM_AUTOR := 40
TAM_EDITORA := 60
TAM_IDIOMA := 30
TAM_USUARIO := 20
TAM_PAIS := 53
TAM_PROFISSAO := 60
TAM_LIVRO := 143
TAM_LIVASS := 23
TAM_LIVAUT := 23
TAM_CLIENTE := 135
TAM_ENDERECO := 123
TAM_VENDA := 56

<font color="#808080"># variaveis globais
</font>bopcao := false
opmenu := <font color="#800000">&quot;&quot;
</font>g_nPosChave := 0
g_nTamChave := 0
g_nPreco := 0.0
g_SalvarInclusao := false

tAssunto := regAssunto<font color="#008080"><b>(</b></font><font color="#800000">&quot;&quot;</font>,<font color="#800000">&quot;&quot;</font><font color="#008080"><b>)
</b></font>tAutor := regAutor<font color="#008080"><b>(</b></font><font color="#800000">&quot;&quot;</font>,<font color="#800000">&quot;&quot;</font><font color="#008080"><b>)
</b></font>tEditora := regEditora<font color="#008080"><b>(</b></font><font color="#800000">&quot;&quot;</font>,<font color="#800000">&quot;&quot;</font><font color="#008080"><b>)
</b></font>tIdioma := regIdioma<font color="#008080"><b>(</b></font><font color="#800000">&quot;&quot;</font>,<font color="#800000">&quot;&quot;</font><font color="#008080"><b>)
</b></font>tEndereco := regEndereco<font color="#008080"><b>(</b></font><font color="#800000">&quot;&quot;</font>,<font color="#800000">&quot;&quot;</font>,<font color="#800000">&quot;&quot;</font>,<font color="#800000">&quot;&quot;</font>,<font color="#800000">&quot;&quot;</font>,<font color="#800000">&quot;&quot;</font><font color="#008080"><b>)
</b></font>tPais := regPais<font color="#008080"><b>(</b></font><font color="#800000">&quot;&quot;</font>,<font color="#800000">&quot;&quot;</font><font color="#008080"><b>)
</b></font>tProfissao := regProfissao<font color="#008080"><b>(</b></font><font color="#800000">&quot;&quot;</font>,<font color="#800000">&quot;&quot;</font><font color="#008080"><b>)
</b></font>tLivro := regLivro<font color="#008080"><b>(</b></font><font color="#800000">&quot;&quot;</font>,<font color="#800000">&quot;&quot;</font>,<font color="#800000">&quot;&quot;</font>,<font color="#800000">&quot;&quot;</font>,<font color="#800000">&quot;&quot;</font>,<font color="#800000">&quot;&quot;</font>,<font color="#800000">&quot;&quot;</font>,<font color="#800000">&quot;&quot;</font>,<font color="#800000">&quot;&quot;</font>,<font color="#800000">&quot;&quot;</font><font color="#008080"><b>)
</b></font>tLivroAss := regLivroAss<font color="#008080"><b>(</b></font><font color="#800000">&quot;&quot;</font>,<font color="#800000">&quot;&quot;</font><font color="#008080"><b>)
</b></font>tLivroAut := regLivroAut<font color="#008080"><b>(</b></font><font color="#800000">&quot;&quot;</font>,<font color="#800000">&quot;&quot;</font><font color="#008080"><b>)
</b></font>tCliente := regCliente<font color="#008080"><b>(</b></font><font color="#800000">&quot;&quot;</font>,<font color="#800000">&quot;&quot;</font>,<font color="#800000">&quot;&quot;</font>,<font color="#800000">&quot;&quot;</font>,<font color="#800000">&quot;&quot;</font>,<font color="#800000">&quot;&quot;</font>,<font color="#800000">&quot;&quot;</font>,<font color="#800000">&quot;&quot;</font>,<font color="#800000">&quot;&quot;</font>,<font color="#800000">&quot;&quot;</font><font color="#008080"><b>)
</b></font>tUsuario := regUsuario<font color="#008080"><b>(</b></font><font color="#800000">&quot;&quot;</font>,<font color="#800000">&quot;&quot;</font><font color="#008080"><b>)
</b></font>tVenda := regVenda<font color="#008080"><b>(</b></font><font color="#800000">&quot;&quot;</font>,<font color="#800000">&quot;&quot;</font>,<font color="#800000">&quot;&quot;</font>,<font color="#800000">&quot;&quot;</font><font color="#008080"><b>)
</b></font><font color="#0000FF"><b>end

</b></font><font color="#808080">#------------------------------------------------------------------------------
# Fun&ccedil;&atilde;o que retorna o tamanho de uma string.
# stexto - indica a string
# retorna - o tamanho da string
#------------------------------------------------------------------------------
</font>procedure <font color="#800000"><b>length</b></font><font color="#008080"><b>(</b></font>stexto<font color="#008080"><b>)
</b></font><font color="#800000"><b>local </b></font>ntam

  ntam := 0
  <font color="#0000FF"><b>while </b></font>stexto &gt;&gt; <font color="#800000">&quot;&quot; </font>do <font color="#008080"><b>{
      </b></font>ntam+:=1
      stexto:=stexto<font color="#008080"><b>[2</b></font>:0<font color="#008080"><b>]      
  }
  </b></font><font color="#0000FF"><b>return </b></font>ntam
<font color="#0000FF"><b>end

</b></font><font color="#808080">#------------------------------------------------------------------------------
# Fun&ccedil;&atilde;o que retorna um peda&ccedil;o de uma string.
# stexto - indica a string
# nini - indica a posicao inicial do pedaco
# ntam - indica o tamanho do pedaco
# retorna - o peda&ccedil;o da string
#------------------------------------------------------------------------------
</font>procedure substr<font color="#008080"><b>(</b></font>stexto,nini,ntam<font color="#008080"><b>)
  </b></font><font color="#0000FF"><b>return </b></font>stexto<font color="#008080"><b>[</b></font>nini:nini+ntam<font color="#008080"><b>]
</b></font><font color="#0000FF"><b>end

</b></font><font color="#808080">#------------------------------------------------------------------------------
# Faz uma pesquisa relativa de um texto atrav&eacute;s de um valor chave.
# sTexto - o texto
# sChave - a chave a ser pesquisada
# retorna - se achou ou n&atilde;o a chave dentro do texto
#------------------------------------------------------------------------------
</font>procedure strRelativa<font color="#008080"><b>(</b></font>sTexto, sChave<font color="#008080"><b>)
  </b></font><font color="#0000FF"><b>if </b></font><font color="#800000"><b>find</b></font><font color="#008080"><b>(</b></font>sChave,sTexto<font color="#008080"><b>) </b></font>&gt; 0 then 
    <font color="#0000FF"><b>return </b></font>true 
  <font color="#0000FF"><b>else 
    return </b></font>false
<font color="#0000FF"><b>end

</b></font><font color="#808080">#------------------------------------------------------------------------------
# Calcula o modulo11 de um valor qualquer.
# svalor - a mstring com o n&uacute;mero a ser calculado
# ndig - d&iacute;gito do valor a ser calculado
# retorna - o d&iacute;gito correto
#------------------------------------------------------------------------------
</font>procedure modulo11<font color="#008080"><b>(</b></font>svalor, ndig<font color="#008080"><b>)
</b></font><font color="#800000"><b>local </b></font>ncont, nsoma, nvalor, npos
<font color="#800000"><b>local </b></font>sres, slocal

 ncont:=1
 slocal:=<font color="#800000">&quot;&quot;
 </font><font color="#0000FF"><b>while </b></font>ncont &lt;= 11 do <font color="#008080"><b>{
   </b></font>slocal:=substr<font color="#008080"><b>(</b></font>svalor,ncont,1<font color="#008080"><b>) </b></font>|| slocal
   ncont+:=1
 <font color="#008080"><b>}
 </b></font>nsoma:=0
 <font color="#0000FF"><b>if </b></font>ndig=1 then
   ncont:=3
 <font color="#0000FF"><b>else
   </b></font>ncont:=2
 npos:=2
 <font color="#0000FF"><b>while </b></font>ncont &lt;= 11 do <font color="#008080"><b>{
   </b></font>sres:=substr<font color="#008080"><b>(</b></font>slocal,ncont,1<font color="#008080"><b>)
   </b></font>nvalor:=integer<font color="#008080"><b>(</b></font>sres<font color="#008080"><b>)
   </b></font>nsoma:=nsoma + <font color="#008080"><b>(</b></font>nvalor * npos<font color="#008080"><b>)
   </b></font>ncont+:=1
   npos+:=1
 <font color="#008080"><b>}
 </b></font>nsoma:=<font color="#008080"><b>(11 </b></font>- <font color="#008080"><b>(</b></font>nsoma % 11<font color="#008080"><b>))

</b></font><font color="#0000FF"><b>if </b></font>nsoma &gt; 9 then
  <font color="#0000FF"><b>return </b></font>0
<font color="#0000FF"><b>else
  return </b></font>nsoma
<font color="#0000FF"><b>end
</b></font><font color="#808080">#------------------------------------------------------------------------------
# Valida&ccedil;&atilde;o de um n&uacute;mero de CPF qualquer.
# cpf - a mstring com o n&uacute;mero do CPF
# retorna - se &eacute; valido ou n&atilde;o
#------------------------------------------------------------------------------
</font>procedure validaCPF<font color="#008080"><b>(</b></font>cpf<font color="#008080"><b>)
</b></font><font color="#800000"><b>local </b></font>scpf, sres
<font color="#800000"><b>local </b></font>nvalor1, nvalor2

<font color="#0000FF"><b>if </b></font><font color="#008080"><b>(</b></font><font color="#800000"><b>length</b></font><font color="#008080"><b>(</b></font>cpf<font color="#008080"><b>)</b></font>=14<font color="#008080"><b>) </b></font>then <font color="#008080"><b>{
  </b></font>scpf:=substr<font color="#008080"><b>(</b></font>cpf,1,3<font color="#008080"><b>) </b></font>|| substr<font color="#008080"><b>(</b></font>cpf,5,3<font color="#008080"><b>) </b></font>|| substr<font color="#008080"><b>(</b></font>cpf,9,3<font color="#008080"><b>) </b></font>|| substr<font color="#008080"><b>(</b></font>cpf,13,2<font color="#008080"><b>)
  </b></font>sres:=substr<font color="#008080"><b>(</b></font>cpf,13,1<font color="#008080"><b>)
  </b></font>nvalor1:=integer<font color="#008080"><b>(</b></font>sres<font color="#008080"><b>)
  </b></font>sres:=substr<font color="#008080"><b>(</b></font>cpf,14,1<font color="#008080"><b>)
  </b></font>nvalor2:=integer<font color="#008080"><b>(</b></font>sres<font color="#008080"><b>)
  </b></font><font color="#0000FF"><b>if </b></font><font color="#008080"><b>((</b></font>modulo11<font color="#008080"><b>(</b></font>scpf,1<font color="#008080"><b>)</b></font>=nvalor1<font color="#008080"><b>) </b></font>&amp; <font color="#008080"><b>(</b></font>modulo11<font color="#008080"><b>(</b></font>scpf,2<font color="#008080"><b>)</b></font>=nvalor2<font color="#008080"><b>)) </b></font>then
    <font color="#0000FF"><b>return </b></font>true
  <font color="#0000FF"><b>else
    return </b></font>false
<font color="#008080"><b>} </b></font><font color="#0000FF"><b>else
  return </b></font>false
<font color="#0000FF"><b>end
</b></font><font color="#808080">#------------------------------------------------------------------------------
# Valida&ccedil;&atilde;o de um n&uacute;mero ISBN qualquer.
# isbn - a mstring com o n&uacute;mero do ISBN
# retorna - se &eacute; valido ou n&atilde;o
#------------------------------------------------------------------------------
</font>procedure validaISBN<font color="#008080"><b>(</b></font>isbn<font color="#008080"><b>)
</b></font><font color="#800000"><b>local </b></font>snum, sdigito, sisbn
<font color="#800000"><b>local </b></font>nvalor, nsoma, nstatus, ncont

<font color="#0000FF"><b>if </b></font><font color="#008080"><b>(</b></font><font color="#800000"><b>length</b></font><font color="#008080"><b>(</b></font>isbn<font color="#008080"><b>)</b></font>=13<font color="#008080"><b>) </b></font>then <font color="#008080"><b>{
  </b></font>sdigito := substr<font color="#008080"><b>(</b></font>isbn, <font color="#800000"><b>length</b></font><font color="#008080"><b>(</b></font>isbn<font color="#008080"><b>)</b></font>, 1<font color="#008080"><b>)
  </b></font>sisbn:=<font color="#800000">&quot;&quot;
  </font>every ncont:=1 to <font color="#800000"><b>length</b></font><font color="#008080"><b>(</b></font>isbn<font color="#008080"><b>)</b></font>-1 do <font color="#008080"><b>{
    </b></font><font color="#0000FF"><b>if </b></font><font color="#008080"><b>(</b></font>substr<font color="#008080"><b>(</b></font>isbn,ncont,1<font color="#008080"><b>)</b></font>~==<font color="#800000">&quot;-&quot;</font><font color="#008080"><b>) </b></font>then
      sisbn:=sisbn || substr<font color="#008080"><b>(</b></font>isbn,ncont,1<font color="#008080"><b>)
  }
  </b></font><font color="#0000FF"><b>if </b></font>sdigito == <font color="#800000">&quot;X&quot; </font>then
    nsoma := 10
  <font color="#0000FF"><b>else </b></font><font color="#008080"><b>{
    </b></font>nvalor:=integer<font color="#008080"><b>(</b></font>sdigito<font color="#008080"><b>)
    </b></font>nsoma := nvalor
  <font color="#008080"><b>}
  </b></font>every ncont:=1 to 9 do <font color="#008080"><b>{
    </b></font>snum:=substr<font color="#008080"><b>(</b></font>sisbn, ncont, 1<font color="#008080"><b>)
    </b></font>nvalor:=integer<font color="#008080"><b>(</b></font>snum<font color="#008080"><b>)
    </b></font>nsoma:=nsoma + <font color="#008080"><b>(</b></font>nvalor * <font color="#008080"><b>(11 </b></font>- ncont<font color="#008080"><b>))
  }
  </b></font><font color="#0000FF"><b>if </b></font><font color="#008080"><b>(</b></font>nsoma % 11<font color="#008080"><b>) </b></font>= 0 then
    <font color="#0000FF"><b>return </b></font>true
  <font color="#0000FF"><b>else
    return </b></font>false
<font color="#008080"><b>} </b></font><font color="#0000FF"><b>else
  return </b></font>false
<font color="#0000FF"><b>end
</b></font><font color="#808080">#------------------------------------------------------------------------------
# Esconde a digita&ccedil;&atilde;o da senha
# retorna - a senha digitada
#------------------------------------------------------------------------------
</font>procedure digitaSenha<font color="#008080"><b>(</b></font>sRotulo, nTamSenha<font color="#008080"><b>)
</b></font><font color="#800000"><b>local </b></font>sSenha, sLetra
<font color="#800000"><b>local </b></font>ncont

writes<font color="#008080"><b>(</b></font>sRotulo<font color="#008080"><b>)
</b></font>sSenha:=<font color="#800000"><b>read</b></font><font color="#008080"><b>()
</b></font><font color="#808080">#  ncont := 0
#  sSenha:=&quot;&quot;
#  sLetra:=&quot;\0&quot;
#  while((sLetra~==&quot;\r&quot;) &amp; (ncont &lt; nTamSenha)) do {
#    sLetra:=getch()
#    sSenha:=sSenha || sLetra
#    ncont+:=1
#  }
</font><font color="#0000FF"><b>return </b></font>sSenha
<font color="#0000FF"><b>end
</b></font><font color="#808080">#------------------------------------------------------------------------------
# Valida&ccedil;&atilde;o de um n&uacute;mero qualquer.
# sRotulo - o texto antes de se digitar o n&uacute;mero
# sNumero - a mstring com o valor do n&uacute;mero
# retorna - o sNumero
#------------------------------------------------------------------------------
</font>procedure validaNumero<font color="#008080"><b>(</b></font>sRotulo, sNumero<font color="#008080"><b>)
</b></font><font color="#800000"><b>local </b></font>nnum
<font color="#800000"><b>local </b></font>nStatus

nStatus:=-1
<font color="#0000FF"><b>while </b></font><font color="#008080"><b>(</b></font>nStatus~=0<font color="#008080"><b>) </b></font>do <font color="#008080"><b>{
  </b></font>writes<font color="#008080"><b>(</b></font>sRotulo<font color="#008080"><b>)
  </b></font>sNumero:=<font color="#800000"><b>read</b></font><font color="#008080"><b>()
  </b></font>nnum:=real<font color="#008080"><b>(</b></font>sNumero<font color="#008080"><b>)
  </b></font><font color="#0000FF"><b>if </b></font><font color="#800000"><b>type</b></font><font color="#008080"><b>(</b></font>nnum<font color="#008080"><b>)</b></font>==<font color="#800000">&quot;real&quot; </font>then <font color="#008080"><b>{
    </b></font><font color="#0000FF"><b>if </b></font><font color="#008080"><b>(</b></font>nnum &lt; 0.01<font color="#008080"><b>) </b></font>then
       <font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font>MSG_NUMINV<font color="#008080"><b>)
    </b></font><font color="#0000FF"><b>else
      </b></font>nStatus := 0
  <font color="#008080"><b>} </b></font><font color="#0000FF"><b>else
      </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font>MSG_NUMINV<font color="#008080"><b>)
}
</b></font><font color="#0000FF"><b>return </b></font>sNumero
<font color="#0000FF"><b>end
</b></font><font color="#808080">#------------------------------------------------------------------------------
# Valida&ccedil;&atilde;o de uma data ou data/hora qualquer.
# sRotulo - o texto antes de se digitar a data/hora
# sDataHora - a mstring com o valor da data/hora
# bSoData - indica se vai validar somente uma data sem a hora
# retorna - a sDataHora
#------------------------------------------------------------------------------
</font>procedure validaDataHora<font color="#008080"><b>(</b></font>sRotulo, sDataHora, bSoData<font color="#008080"><b>)
</b></font><font color="#800000"><b>local </b></font>bvalida, bdatavalida, bhoravalida
<font color="#800000"><b>local </b></font>sdia, smes, sano, shora, smin, sseg
<font color="#800000"><b>local </b></font>ndia, nmes, nano, nhora, nmin, nseg, nudiames, ntam

bvalida:=false
bdatavalida:=false
bhoravalida:=false
nudiames:=0

<font color="#0000FF"><b>if </b></font>bSoData=true then ntam:=10
<font color="#0000FF"><b>else </b></font>ntam:=19
<font color="#0000FF"><b>while </b></font><font color="#008080"><b>(</b></font>bvalida=false<font color="#008080"><b>) </b></font>do <font color="#008080"><b>{
  </b></font>writes<font color="#008080"><b>(</b></font>sRotulo<font color="#008080"><b>)
  </b></font>sDataHora := <font color="#800000"><b>read</b></font><font color="#008080"><b>()
  </b></font><font color="#0000FF"><b>if </b></font><font color="#800000"><b>length</b></font><font color="#008080"><b>(</b></font>sDataHora<font color="#008080"><b>)</b></font>=ntam then <font color="#008080"><b>{
    </b></font>sdia:=substr<font color="#008080"><b>(</b></font>sDataHora,1,2<font color="#008080"><b>)
    </b></font>ndia:=integer<font color="#008080"><b>(</b></font>sdia<font color="#008080"><b>)
    </b></font>smes:=substr<font color="#008080"><b>(</b></font>sDataHora,4,2<font color="#008080"><b>)
    </b></font>nmes:=integer<font color="#008080"><b>(</b></font>smes<font color="#008080"><b>)
    </b></font>sano:=substr<font color="#008080"><b>(</b></font>sDataHora,7,4<font color="#008080"><b>)
    </b></font>nano:=integer<font color="#008080"><b>(</b></font>sano<font color="#008080"><b>)
  
    </b></font><font color="#0000FF"><b>if </b></font><font color="#008080"><b>(</b></font>nano &gt;= 1<font color="#008080"><b>) </b></font>&amp; <font color="#008080"><b>(</b></font>nano &lt;= 9999<font color="#008080"><b>) </b></font>then <font color="#008080"><b>{
      </b></font><font color="#0000FF"><b>if </b></font><font color="#008080"><b>(</b></font>nmes &gt;= 1<font color="#008080"><b>) </b></font>&amp; <font color="#008080"><b>(</b></font>nmes &lt;= 31<font color="#008080"><b>) </b></font>then <font color="#008080"><b>{
         </b></font><font color="#0000FF"><b>case </b></font>nmes of <font color="#008080"><b>{
           </b></font>1 | 3 | 5 | 7 | 8 | 10 | 12: nudiames:=31
           2: <font color="#008080"><b>{
               </b></font><font color="#808080"># ano bissexto 
               </font><font color="#0000FF"><b>if </b></font><font color="#008080"><b>(</b></font>nano % 4<font color="#008080"><b>)</b></font>=0 then nudiames:=29
               <font color="#0000FF"><b>else </b></font>nudiames:=28
           <font color="#008080"><b>}
           </b></font>4 | 6 | 9 | 11: nudiames:=30
         <font color="#008080"><b>}
         </b></font><font color="#0000FF"><b>if </b></font><font color="#008080"><b>(</b></font>ndia &gt;=1<font color="#008080"><b>) </b></font>&amp; <font color="#008080"><b>(</b></font>ndia &lt;=nudiames<font color="#008080"><b>) </b></font>then
            bdatavalida:=true
      <font color="#008080"><b>}
    }
  
    </b></font><font color="#0000FF"><b>if </b></font>bSoData=true then <font color="#008080"><b>{
       </b></font><font color="#0000FF"><b>if </b></font>bdatavalida=true then bvalida:=true
       <font color="#0000FF"><b>else </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font>MSG_DATAINV<font color="#008080"><b>)
    } </b></font><font color="#0000FF"><b>else </b></font><font color="#008080"><b>{
      </b></font><font color="#0000FF"><b>if </b></font>bdatavalida=true then <font color="#008080"><b>{
          </b></font>shora:=substr<font color="#008080"><b>(</b></font>sDataHora,12,2<font color="#008080"><b>)
          </b></font>nhora:=integer<font color="#008080"><b>(</b></font>shora<font color="#008080"><b>)
          </b></font>smin:=substr<font color="#008080"><b>(</b></font>sDataHora,15,2<font color="#008080"><b>)
          </b></font>nmin:=integer<font color="#008080"><b>(</b></font>smin<font color="#008080"><b>)
          </b></font>sseg:=substr<font color="#008080"><b>(</b></font>sDataHora,18,2<font color="#008080"><b>)
          </b></font>nseg:=integer<font color="#008080"><b>(</b></font>sseg<font color="#008080"><b>)
  
          </b></font><font color="#0000FF"><b>if </b></font><font color="#008080"><b>(</b></font>nhora &gt;= 0<font color="#008080"><b>) </b></font>&amp; <font color="#008080"><b>(</b></font>nhora &lt;= 23<font color="#008080"><b>) </b></font>then <font color="#008080"><b>{
            </b></font><font color="#0000FF"><b>if </b></font><font color="#008080"><b>(</b></font>nmin &gt;= 0<font color="#008080"><b>) </b></font>&amp; <font color="#008080"><b>(</b></font>nmin &lt;= 59<font color="#008080"><b>) </b></font>then <font color="#008080"><b>{
              </b></font><font color="#0000FF"><b>if </b></font><font color="#008080"><b>(</b></font>nseg &gt;= 0<font color="#008080"><b>) </b></font>&amp; <font color="#008080"><b>(</b></font>nseg &lt;= 59<font color="#008080"><b>) </b></font>then
                 bhoravalida:=true
            <font color="#008080"><b>}
          }
  
          </b></font><font color="#0000FF"><b>if </b></font>bhoravalida=true then 
            bvalida:=true
          <font color="#0000FF"><b>else 
            </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font>MSG_DTHRINV<font color="#008080"><b>)
      } </b></font><font color="#0000FF"><b>else
        </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font>MSG_DTHRINV<font color="#008080"><b>)
    }
  } </b></font><font color="#0000FF"><b>else </b></font><font color="#008080"><b>{
    </b></font><font color="#0000FF"><b>if </b></font>bSoData=true then <font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font>MSG_DATAINV<font color="#008080"><b>)
    </b></font><font color="#0000FF"><b>else </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font>MSG_DTHRINV<font color="#008080"><b>)
  }
}
</b></font><font color="#0000FF"><b>return </b></font>sDataHora
<font color="#0000FF"><b>end
</b></font><font color="#808080">#------------------------------------------------------------------------------
# Retorna a Data e a hora do sistema.
# retorna - a data e a hora
#------------------------------------------------------------------------------
</font>procedure retDataHora<font color="#008080"><b>()
</b></font><font color="#800000"><b>local </b></font>sdia,smes,sano,sdatahora

sano:=substr<font color="#008080"><b>(</b></font>&amp;date,1,4<font color="#008080"><b>)
</b></font>smes:=substr<font color="#008080"><b>(</b></font>&amp;date,5,4<font color="#008080"><b>)
</b></font>sdia:=substr<font color="#008080"><b>(</b></font>&amp;date,9,2<font color="#008080"><b>)
</b></font>sdatahora:= sdia || smes || sano || <font color="#800000">&quot; &quot; </font>|| &amp;clock

<font color="#0000FF"><b>return </b></font>sdatahora
<font color="#0000FF"><b>end
</b></font><font color="#808080">#------------------------------------------------------------------------------
# Calcula o tamanho do arquivo.
# sArq - o arquivo
# retorna - o tamanho do arquivo
#------------------------------------------------------------------------------
</font>procedure tamArq<font color="#008080"><b>(</b></font>sArq<font color="#008080"><b>)
</b></font><font color="#800000"><b>local </b></font>ntam, npos

npos:=where<font color="#008080"><b>(</b></font>sArq<font color="#008080"><b>)
</b></font><font color="#800000"><b>seek</b></font><font color="#008080"><b>(</b></font>sArq,0<font color="#008080"><b>)
</b></font>ntam:=where<font color="#008080"><b>(</b></font>sArq<font color="#008080"><b>)
</b></font><font color="#800000"><b>seek</b></font><font color="#008080"><b>(</b></font>sArq,npos<font color="#008080"><b>)

</b></font><font color="#0000FF"><b>return </b></font>ntam 
<font color="#0000FF"><b>end
</b></font><font color="#808080">#------------------------------------------------------------------------------
# Abre ou cria os arquivos do sistema.
# bAbre - condi&ccedil;&atilde;o para abrir ou criar os arquivos do sistema
#------------------------------------------------------------------------------
</font>procedure abrecriaArqs<font color="#008080"><b>(</b></font>bAbre<font color="#008080"><b>)

</b></font><font color="#0000FF"><b>if </b></font>bAbre=true then <font color="#008080"><b>{
  </b></font><font color="#0000FF"><b>if </b></font>not<font color="#008080"><b>(</b></font>tfAssunto := <font color="#800000"><b>open</b></font><font color="#008080"><b>(</b></font>ARQ_ASSUNTO, ARQ_ABRE<font color="#008080"><b>)) </b></font>then <font color="#008080"><b>{
    </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font>MSG_ARQERRO || <font color="#800000">&quot; --&gt; &quot; </font>|| ARQ_ASSUNTO<font color="#008080"><b>)
    </b></font><font color="#800000"><b>exit</b></font><font color="#008080"><b>(0)
  }
  </b></font><font color="#0000FF"><b>if </b></font>not<font color="#008080"><b>(</b></font>tfAutor := <font color="#800000"><b>open</b></font><font color="#008080"><b>(</b></font>ARQ_AUTOR, ARQ_ABRE<font color="#008080"><b>)) </b></font>then <font color="#008080"><b>{
    </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font>MSG_ARQERRO || <font color="#800000">&quot; --&gt; &quot; </font>|| ARQ_AUTOR<font color="#008080"><b>)
    </b></font><font color="#800000"><b>exit</b></font><font color="#008080"><b>(0)
  }
  </b></font><font color="#0000FF"><b>if </b></font>not<font color="#008080"><b>(</b></font>tfEditora := <font color="#800000"><b>open</b></font><font color="#008080"><b>(</b></font>ARQ_EDITORA, ARQ_ABRE<font color="#008080"><b>)) </b></font>then <font color="#008080"><b>{
    </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font>MSG_ARQERRO || <font color="#800000">&quot; --&gt; &quot; </font>|| ARQ_EDITORA<font color="#008080"><b>)
    </b></font><font color="#800000"><b>exit</b></font><font color="#008080"><b>(0)
  }
  </b></font><font color="#0000FF"><b>if </b></font>not<font color="#008080"><b>(</b></font>tfIdioma := <font color="#800000"><b>open</b></font><font color="#008080"><b>(</b></font>ARQ_IDIOMA, ARQ_ABRE<font color="#008080"><b>)) </b></font>then <font color="#008080"><b>{
    </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font>MSG_ARQERRO || <font color="#800000">&quot; --&gt; &quot; </font>|| ARQ_IDIOMA<font color="#008080"><b>)
    </b></font><font color="#800000"><b>exit</b></font><font color="#008080"><b>(0)
  }
  </b></font><font color="#0000FF"><b>if </b></font>not<font color="#008080"><b>(</b></font>tfEndereco := <font color="#800000"><b>open</b></font><font color="#008080"><b>(</b></font>ARQ_ENDERECO, ARQ_ABRE<font color="#008080"><b>)) </b></font>then <font color="#008080"><b>{
    </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font>MSG_ARQERRO || <font color="#800000">&quot; --&gt; &quot; </font>|| ARQ_ENDERECO<font color="#008080"><b>)
    </b></font><font color="#800000"><b>exit</b></font><font color="#008080"><b>(0)
  }
  </b></font><font color="#0000FF"><b>if </b></font>not<font color="#008080"><b>(</b></font>tfPais := <font color="#800000"><b>open</b></font><font color="#008080"><b>(</b></font>ARQ_PAIS, ARQ_ABRE<font color="#008080"><b>)) </b></font>then <font color="#008080"><b>{
    </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font>MSG_ARQERRO || <font color="#800000">&quot; --&gt; &quot; </font>|| ARQ_PAIS<font color="#008080"><b>)
    </b></font><font color="#800000"><b>exit</b></font><font color="#008080"><b>(0)
  }
  </b></font><font color="#0000FF"><b>if </b></font>not<font color="#008080"><b>(</b></font>tfProfissao := <font color="#800000"><b>open</b></font><font color="#008080"><b>(</b></font>ARQ_PROFISSAO, ARQ_ABRE<font color="#008080"><b>)) </b></font>then <font color="#008080"><b>{
    </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font>MSG_ARQERRO || <font color="#800000">&quot; --&gt; &quot; </font>|| ARQ_PROFISSAO<font color="#008080"><b>)
    </b></font><font color="#800000"><b>exit</b></font><font color="#008080"><b>(0)
  }
  </b></font><font color="#0000FF"><b>if </b></font>not<font color="#008080"><b>(</b></font>tfLivro := <font color="#800000"><b>open</b></font><font color="#008080"><b>(</b></font>ARQ_LIVRO, ARQ_ABRE<font color="#008080"><b>)) </b></font>then <font color="#008080"><b>{
    </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font>MSG_ARQERRO || <font color="#800000">&quot; --&gt; &quot; </font>|| ARQ_LIVRO<font color="#008080"><b>)
    </b></font><font color="#800000"><b>exit</b></font><font color="#008080"><b>(0)
  }
  </b></font><font color="#0000FF"><b>if </b></font>not<font color="#008080"><b>(</b></font>tfLivroAss := <font color="#800000"><b>open</b></font><font color="#008080"><b>(</b></font>ARQ_LIVASS, ARQ_ABRE<font color="#008080"><b>)) </b></font>then <font color="#008080"><b>{
    </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font>MSG_ARQERRO || <font color="#800000">&quot; --&gt; &quot; </font>|| ARQ_LIVASS<font color="#008080"><b>)
    </b></font><font color="#800000"><b>exit</b></font><font color="#008080"><b>(0)
  }
  </b></font><font color="#0000FF"><b>if </b></font>not<font color="#008080"><b>(</b></font>tfLivroAut := <font color="#800000"><b>open</b></font><font color="#008080"><b>(</b></font>ARQ_LIVAUT, ARQ_ABRE<font color="#008080"><b>)) </b></font>then <font color="#008080"><b>{
    </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font>MSG_ARQERRO || <font color="#800000">&quot; --&gt; &quot; </font>|| ARQ_LIVAUT<font color="#008080"><b>)
    </b></font><font color="#800000"><b>exit</b></font><font color="#008080"><b>(0)
  }
  </b></font><font color="#0000FF"><b>if </b></font>not<font color="#008080"><b>(</b></font>tfCliente := <font color="#800000"><b>open</b></font><font color="#008080"><b>(</b></font>ARQ_CLIENTE, ARQ_ABRE<font color="#008080"><b>)) </b></font>then <font color="#008080"><b>{
    </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font>MSG_ARQERRO || <font color="#800000">&quot; --&gt; &quot; </font>|| ARQ_CLIENTE<font color="#008080"><b>)
    </b></font><font color="#800000"><b>exit</b></font><font color="#008080"><b>(0)
  }
  </b></font><font color="#0000FF"><b>if </b></font>not<font color="#008080"><b>(</b></font>tfUsuario := <font color="#800000"><b>open</b></font><font color="#008080"><b>(</b></font>ARQ_USUARIO, ARQ_ABRE<font color="#008080"><b>)) </b></font>then <font color="#008080"><b>{
    </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font>MSG_ARQERRO || <font color="#800000">&quot; --&gt; &quot; </font>|| ARQ_USUARIO<font color="#008080"><b>)
    </b></font><font color="#800000"><b>exit</b></font><font color="#008080"><b>(0)
  }
  </b></font><font color="#0000FF"><b>if </b></font>not<font color="#008080"><b>(</b></font>tfVenda := <font color="#800000"><b>open</b></font><font color="#008080"><b>(</b></font>ARQ_VENDA, ARQ_ABRE<font color="#008080"><b>)) </b></font>then <font color="#008080"><b>{
    </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font>MSG_ARQERRO || <font color="#800000">&quot; --&gt; &quot; </font>|| ARQ_VENDA<font color="#008080"><b>)
    </b></font><font color="#800000"><b>exit</b></font><font color="#008080"><b>(0)
  }
} </b></font><font color="#0000FF"><b>else </b></font><font color="#008080"><b>{
  </b></font><font color="#0000FF"><b>if </b></font>not<font color="#008080"><b>(</b></font>tfAssunto := <font color="#800000"><b>open</b></font><font color="#008080"><b>(</b></font>ARQ_ASSUNTO, ARQ_CRIA<font color="#008080"><b>)) </b></font>then
    <font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font>MSG_ARQCERRO || <font color="#800000">&quot; --&gt; &quot; </font>|| ARQ_ASSUNTO<font color="#008080"><b>)
  </b></font><font color="#0000FF"><b>if </b></font>not<font color="#008080"><b>(</b></font>tfAutor := <font color="#800000"><b>open</b></font><font color="#008080"><b>(</b></font>ARQ_AUTOR, ARQ_CRIA<font color="#008080"><b>)) </b></font>then
    <font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font>MSG_ARQCERRO || <font color="#800000">&quot; --&gt; &quot; </font>|| ARQ_AUTOR<font color="#008080"><b>)
  </b></font><font color="#0000FF"><b>if </b></font>not<font color="#008080"><b>(</b></font>tfEditora := <font color="#800000"><b>open</b></font><font color="#008080"><b>(</b></font>ARQ_EDITORA, ARQ_CRIA<font color="#008080"><b>)) </b></font>then
    <font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font>MSG_ARQCERRO || <font color="#800000">&quot; --&gt; &quot; </font>|| ARQ_EDITORA<font color="#008080"><b>)
  </b></font><font color="#0000FF"><b>if </b></font>not<font color="#008080"><b>(</b></font>tfIdioma := <font color="#800000"><b>open</b></font><font color="#008080"><b>(</b></font>ARQ_IDIOMA, ARQ_CRIA<font color="#008080"><b>)) </b></font>then
    <font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font>MSG_ARQCERRO || <font color="#800000">&quot; --&gt; &quot; </font>|| ARQ_IDIOMA<font color="#008080"><b>)
  </b></font><font color="#0000FF"><b>if </b></font>not<font color="#008080"><b>(</b></font>tfEndereco := <font color="#800000"><b>open</b></font><font color="#008080"><b>(</b></font>ARQ_ENDERECO, ARQ_CRIA<font color="#008080"><b>)) </b></font>then
    <font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font>MSG_ARQCERRO || <font color="#800000">&quot; --&gt; &quot; </font>|| ARQ_ENDERECO<font color="#008080"><b>)
  </b></font><font color="#0000FF"><b>if </b></font>not<font color="#008080"><b>(</b></font>tfPais := <font color="#800000"><b>open</b></font><font color="#008080"><b>(</b></font>ARQ_PAIS, ARQ_CRIA<font color="#008080"><b>)) </b></font>then
    <font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font>MSG_ARQCERRO || <font color="#800000">&quot; --&gt; &quot; </font>|| ARQ_PAIS<font color="#008080"><b>)
  </b></font><font color="#0000FF"><b>if </b></font>not<font color="#008080"><b>(</b></font>tfProfissao := <font color="#800000"><b>open</b></font><font color="#008080"><b>(</b></font>ARQ_PROFISSAO, ARQ_CRIA<font color="#008080"><b>)) </b></font>then
    <font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font>MSG_ARQCERRO || <font color="#800000">&quot; --&gt; &quot; </font>|| ARQ_PROFISSAO<font color="#008080"><b>)
  </b></font><font color="#0000FF"><b>if </b></font>not<font color="#008080"><b>(</b></font>tfLivro := <font color="#800000"><b>open</b></font><font color="#008080"><b>(</b></font>ARQ_LIVRO, ARQ_CRIA<font color="#008080"><b>)) </b></font>then
    <font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font>MSG_ARQCERRO || <font color="#800000">&quot; --&gt; &quot; </font>|| ARQ_LIVRO<font color="#008080"><b>)
  </b></font><font color="#0000FF"><b>if </b></font>not<font color="#008080"><b>(</b></font>tfLivroAss := <font color="#800000"><b>open</b></font><font color="#008080"><b>(</b></font>ARQ_LIVASS, ARQ_CRIA<font color="#008080"><b>)) </b></font>then
    <font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font>MSG_ARQCERRO || <font color="#800000">&quot; --&gt; &quot; </font>|| ARQ_LIVASS<font color="#008080"><b>)
  </b></font><font color="#0000FF"><b>if </b></font>not<font color="#008080"><b>(</b></font>tfLivroAut := <font color="#800000"><b>open</b></font><font color="#008080"><b>(</b></font>ARQ_LIVAUT, ARQ_CRIA<font color="#008080"><b>)) </b></font>then
    <font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font>MSG_ARQCERRO || <font color="#800000">&quot; --&gt; &quot; </font>|| ARQ_LIVAUT<font color="#008080"><b>)
  </b></font><font color="#0000FF"><b>if </b></font>not<font color="#008080"><b>(</b></font>tfCliente := <font color="#800000"><b>open</b></font><font color="#008080"><b>(</b></font>ARQ_CLIENTE, ARQ_CRIA<font color="#008080"><b>)) </b></font>then
    <font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font>MSG_ARQCERRO || <font color="#800000">&quot; --&gt; &quot; </font>|| ARQ_CLIENTE<font color="#008080"><b>)
  </b></font><font color="#0000FF"><b>if </b></font>not<font color="#008080"><b>(</b></font>tfUsuario := <font color="#800000"><b>open</b></font><font color="#008080"><b>(</b></font>ARQ_USUARIO, ARQ_CRIA<font color="#008080"><b>)) </b></font>then
    <font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font>MSG_ARQCERRO || <font color="#800000">&quot; --&gt; &quot; </font>|| ARQ_USUARIO<font color="#008080"><b>)
  </b></font><font color="#0000FF"><b>if </b></font>not<font color="#008080"><b>(</b></font>tfVenda := <font color="#800000"><b>open</b></font><font color="#008080"><b>(</b></font>ARQ_VENDA, ARQ_CRIA<font color="#008080"><b>)) </b></font>then
    <font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font>MSG_ARQCERRO || <font color="#800000">&quot; --&gt; &quot; </font>|| ARQ_VENDA<font color="#008080"><b>)
}
</b></font><font color="#0000FF"><b>end
</b></font><font color="#808080">#------------------------------------------------------------------------------
# Fecha todos os arquivos abertos.
#------------------------------------------------------------------------------
</font>procedure fechaArqs<font color="#008080"><b>()
 </b></font><font color="#800000"><b>close</b></font><font color="#008080"><b>(</b></font>tfAssunto<font color="#008080"><b>)
 </b></font><font color="#800000"><b>close</b></font><font color="#008080"><b>(</b></font>tfAutor<font color="#008080"><b>)
 </b></font><font color="#800000"><b>close</b></font><font color="#008080"><b>(</b></font>tfEditora<font color="#008080"><b>)
 </b></font><font color="#800000"><b>close</b></font><font color="#008080"><b>(</b></font>tfIdioma<font color="#008080"><b>)
 </b></font><font color="#800000"><b>close</b></font><font color="#008080"><b>(</b></font>tfEndereco<font color="#008080"><b>)
 </b></font><font color="#800000"><b>close</b></font><font color="#008080"><b>(</b></font>tfPais<font color="#008080"><b>)
 </b></font><font color="#800000"><b>close</b></font><font color="#008080"><b>(</b></font>tfProfissao<font color="#008080"><b>)
 </b></font><font color="#800000"><b>close</b></font><font color="#008080"><b>(</b></font>tfLivro<font color="#008080"><b>)
 </b></font><font color="#800000"><b>close</b></font><font color="#008080"><b>(</b></font>tfLivroAss<font color="#008080"><b>)
 </b></font><font color="#800000"><b>close</b></font><font color="#008080"><b>(</b></font>tfLivroAut<font color="#008080"><b>)
 </b></font><font color="#800000"><b>close</b></font><font color="#008080"><b>(</b></font>tfCliente<font color="#008080"><b>)
 </b></font><font color="#800000"><b>close</b></font><font color="#008080"><b>(</b></font>tfUsuario<font color="#008080"><b>)
 </b></font><font color="#800000"><b>close</b></font><font color="#008080"><b>(</b></font>tfVenda<font color="#008080"><b>)
</b></font><font color="#0000FF"><b>end
</b></font><font color="#808080">#------------------------------------------------------------------------------
# Pesquisa um registro atrav&eacute;s de um valor chave num arquivo.
# sArq - o arquivo
# sChave - a chave a ser pesquisada
# nPosChave - a posicao inicial da chave dentro do registro
# nTamChave - o tamanho da chave dentro do registro
# nTamLinha - o tamanho do registro
# retorna - o registro pesquisado
#------------------------------------------------------------------------------
</font>procedure pesqArq<font color="#008080"><b>(</b></font>sArq, sChave, nPosChave, nTamChave, nTamLinha<font color="#008080"><b>)
</b></font><font color="#800000"><b>local </b></font>slinha, sres, bQuebra, nPosicao, stemp

bQuebra:=false
<font color="#800000"><b>seek</b></font><font color="#008080"><b>(</b></font>sArq, 1<font color="#008080"><b>)
</b></font><font color="#0000FF"><b>while </b></font><font color="#008080"><b>(</b></font>slinha := <font color="#800000"><b>read</b></font><font color="#008080"><b>(</b></font>sArq<font color="#008080"><b>)) </b></font>&amp; <font color="#008080"><b>(</b></font>bQuebra=false<font color="#008080"><b>) </b></font>do <font color="#008080"><b>{
  </b></font>sres:=trim<font color="#008080"><b>(</b></font>substr<font color="#008080"><b>(</b></font>slinha,nPosChave,nTamChave<font color="#008080"><b>))
  </b></font><font color="#0000FF"><b>if </b></font><font color="#008080"><b>(</b></font>\sres<font color="#008080"><b>) </b></font>&amp; <font color="#008080"><b>(</b></font>sres == sChave<font color="#008080"><b>) </b></font>then <font color="#008080"><b>{
     </b></font>stemp:=slinha
     bQuebra:=true
  <font color="#008080"><b>}
}
</b></font>nPosicao:=where<font color="#008080"><b>(</b></font>sArq<font color="#008080"><b>)</b></font>-<font color="#008080"><b>((</b></font>nTamLinha + TAM_CRLF<font color="#008080"><b>) </b></font>* 2<font color="#008080"><b>)
</b></font><font color="#0000FF"><b>if </b></font>nPosicao &gt; 1 then
   <font color="#800000"><b>seek</b></font><font color="#008080"><b>(</b></font>sArq, nPosicao<font color="#008080"><b>)
</b></font><font color="#0000FF"><b>else
   </b></font><font color="#800000"><b>seek</b></font><font color="#008080"><b>(</b></font>sArq, 1<font color="#008080"><b>)
</b></font><font color="#0000FF"><b>if </b></font><font color="#008080"><b>(</b></font>\sres<font color="#008080"><b>) </b></font>then <font color="#008080"><b>{
  </b></font><font color="#0000FF"><b>if </b></font><font color="#008080"><b>(</b></font>sres~==sChave<font color="#008080"><b>) </b></font>then
     <font color="#0000FF"><b>return </b></font><font color="#800000">&quot;&quot;
  </font><font color="#0000FF"><b>else
     return </b></font>substr<font color="#008080"><b>(</b></font>stemp,1,nTamLinha<font color="#008080"><b>)
} </b></font><font color="#0000FF"><b>else
  return </b></font><font color="#800000">&quot;&quot;
</font><font color="#0000FF"><b>end
</b></font><font color="#808080">#------------------------------------------------------------------------------
# Pesquisa se tem linha exclu&iacute;da sen&atilde;o vai para a &uacute;ltima linha do arquivo.
# sArq - o arquivo
# nTamLinha - o tamanho do registro
#------------------------------------------------------------------------------
</font>procedure pesqLinhaExcluida<font color="#008080"><b>(</b></font>sArq, nTamLinha<font color="#008080"><b>)
</b></font><font color="#800000"><b>local </b></font>sExcluido

sExcluido:=pesqArq<font color="#008080"><b>(</b></font>sArq, <font color="#800000">&quot;*&quot;</font>, 1, 1, nTamLinha<font color="#008080"><b>)
</b></font><font color="#0000FF"><b>if </b></font>sExcluido==<font color="#800000">&quot;&quot; </font>then
   <font color="#800000"><b>seek</b></font><font color="#008080"><b>(</b></font>sArq, tamArq<font color="#008080"><b>(</b></font>sArq<font color="#008080"><b>))
</b></font><font color="#0000FF"><b>end
</b></font><font color="#808080">#------------------------------------------------------------------------------
# Pesquisa o maior c&oacute;digo num arquivo.
# sArq - o arquivo
# nPosChave - a posicao inicial da chave dentro do registro
# nTamChave - o tamanho da chave dentro do registro
# nTamLinha - o tamanho do registro
# retorna - o maior c&oacute;digo
#------------------------------------------------------------------------------
</font>procedure pesqMaxCod<font color="#008080"><b>(</b></font>sArq, nPosChave, nTamChave, nTamLinha<font color="#008080"><b>)
</b></font><font color="#800000"><b>local </b></font>slinha, sres, bQuebra, nMaior, nCod

bQuebra:=false
nMaior:=0
<font color="#800000"><b>seek</b></font><font color="#008080"><b>(</b></font>sArq, 1<font color="#008080"><b>)
</b></font><font color="#0000FF"><b>while </b></font><font color="#008080"><b>(</b></font>slinha := <font color="#800000"><b>read</b></font><font color="#008080"><b>(</b></font>sArq<font color="#008080"><b>)) </b></font>&amp; <font color="#008080"><b>(</b></font>bQuebra=false<font color="#008080"><b>) </b></font>do <font color="#008080"><b>{
  </b></font>sres:=trim<font color="#008080"><b>(</b></font>substr<font color="#008080"><b>(</b></font>slinha,nPosChave,nTamChave<font color="#008080"><b>))
  </b></font><font color="#0000FF"><b>if </b></font>\sres then <font color="#008080"><b>{
    </b></font>nCod:=integer<font color="#008080"><b>(</b></font>sres<font color="#008080"><b>)
    </b></font><font color="#0000FF"><b>if </b></font>nCod &gt; nMaior then
       nMaior:=nCod
  <font color="#008080"><b>}
}
</b></font>pesqLinhaExcluida<font color="#008080"><b>(</b></font>sArq, nTamLinha<font color="#008080"><b>)
</b></font>sres:=<font color="#800000"><b>string</b></font><font color="#008080"><b>(</b></font>nMaior+1<font color="#008080"><b>)
</b></font><font color="#0000FF"><b>return </b></font>sres
<font color="#0000FF"><b>end
</b></font><font color="#808080">#------------------------------------------------------------------------------
# Grava os registros num determinado arquivo.
# sArq - o arquivo
# sTexto - o registro a ser gravado
# sMsgAcerto - a mensagem caso o registro foi gravado
# sMsgErro - a mensagem caso o registro n&atilde;o foi gravado
#------------------------------------------------------------------------------
</font>procedure escreveArq<font color="#008080"><b>(</b></font>sArq, sTexto, sMsgAcerto, sMsgErro<font color="#008080"><b>)
</b></font><font color="#808080">#sTexto:=sTexto || CRLF
</font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font>sArq, sTexto<font color="#008080"><b>)
</b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font>sMsgAcerto<font color="#008080"><b>)
</b></font><font color="#808080"># write(sMsgErro)
</font><font color="#0000FF"><b>end
</b></font><font color="#808080">#------------------------------------------------------------------------------
# Monta o tamanho do registro no arquivo de acordo com o tipo de arquivo.
# sreg - o tipo de arquivo
# retorna - o registro montado
#------------------------------------------------------------------------------
</font>procedure LinhaReg<font color="#008080"><b>(</b></font>sreg<font color="#008080"><b>)
</b></font><font color="#800000"><b>local </b></font>slinha

slinha:=<font color="#800000">&quot;&quot;
</font><font color="#0000FF"><b>if </b></font>member<font color="#008080"><b>(</b></font>ctArqs, sreg<font color="#008080"><b>) </b></font>= opAssunto then
  slinha:=left<font color="#008080"><b>(</b></font>tAssunto.codigo,10<font color="#008080"><b>) </b></font>|| left<font color="#008080"><b>(</b></font>tAssunto.assunto,30<font color="#008080"><b>)
</b></font><font color="#0000FF"><b>else if </b></font>member<font color="#008080"><b>(</b></font>ctArqs, sreg<font color="#008080"><b>) </b></font>= opAutor then
  slinha:=left<font color="#008080"><b>(</b></font>tAutor.codigo,10<font color="#008080"><b>) </b></font>|| left<font color="#008080"><b>(</b></font>tAutor.autor,30<font color="#008080"><b>)
</b></font><font color="#0000FF"><b>else if </b></font>member<font color="#008080"><b>(</b></font>ctArqs, sreg<font color="#008080"><b>) </b></font>= opEditora then
  slinha:=left<font color="#008080"><b>(</b></font>tEditora.codigo,10<font color="#008080"><b>) </b></font>|| left<font color="#008080"><b>(</b></font>tEditora.editora,50<font color="#008080"><b>)
</b></font><font color="#0000FF"><b>else if </b></font>member<font color="#008080"><b>(</b></font>ctArqs, sreg<font color="#008080"><b>) </b></font>= opEndereco then
  slinha:=left<font color="#008080"><b>(</b></font>tEndereco.codigo,10<font color="#008080"><b>) </b></font>|| left<font color="#008080"><b>(</b></font>tEndereco.logradouro,40<font color="#008080"><b>) </b></font>||
  left<font color="#008080"><b>(</b></font>tEndereco.bairro,15<font color="#008080"><b>) </b></font>|| left<font color="#008080"><b>(</b></font>tEndereco.cep,8<font color="#008080"><b>) </b></font>|| 
  left<font color="#008080"><b>(</b></font>tEndereco.cidade,30<font color="#008080"><b>) </b></font>|| left<font color="#008080"><b>(</b></font>tEndereco.estado,20<font color="#008080"><b>)
</b></font><font color="#0000FF"><b>else if </b></font>member<font color="#008080"><b>(</b></font>ctArqs, sreg<font color="#008080"><b>) </b></font>= opIdioma then
  slinha:=left<font color="#008080"><b>(</b></font>tIdioma.codigo,10<font color="#008080"><b>) </b></font>|| left<font color="#008080"><b>(</b></font>tIdioma.idioma,20<font color="#008080"><b>)
</b></font><font color="#0000FF"><b>else if </b></font>member<font color="#008080"><b>(</b></font>ctArqs, sreg<font color="#008080"><b>) </b></font>= opPais then
  slinha:=left<font color="#008080"><b>(</b></font>tPais.codigo,3<font color="#008080"><b>) </b></font>|| left<font color="#008080"><b>(</b></font>tPais.pais,50<font color="#008080"><b>)
</b></font><font color="#0000FF"><b>else if </b></font>member<font color="#008080"><b>(</b></font>ctArqs, sreg<font color="#008080"><b>) </b></font>= opProfissao then
  slinha:=left<font color="#008080"><b>(</b></font>tProfissao.codigo,10<font color="#008080"><b>) </b></font>|| left<font color="#008080"><b>(</b></font>tProfissao.profissao,50<font color="#008080"><b>)
</b></font><font color="#0000FF"><b>else if </b></font>member<font color="#008080"><b>(</b></font>ctArqs, sreg<font color="#008080"><b>) </b></font>= opUsuario then
  slinha:=left<font color="#008080"><b>(</b></font>tUsuario.login,10<font color="#008080"><b>) </b></font>|| left<font color="#008080"><b>(</b></font>tUsuario.senha,10<font color="#008080"><b>)
</b></font><font color="#0000FF"><b>else if </b></font>member<font color="#008080"><b>(</b></font>ctArqs, sreg<font color="#008080"><b>) </b></font>= opLivro then
  slinha:=left<font color="#008080"><b>(</b></font>tLivro.isbn,13<font color="#008080"><b>) </b></font>|| left<font color="#008080"><b>(</b></font>tLivro.titulo,50<font color="#008080"><b>) </b></font>|| 
  left<font color="#008080"><b>(</b></font>tLivro.edicao,10<font color="#008080"><b>) </b></font>|| left<font color="#008080"><b>(</b></font>tLivro.anopubli,10<font color="#008080"><b>) </b></font>|| 
  left<font color="#008080"><b>(</b></font>tLivro.codeditora,10<font color="#008080"><b>) </b></font>|| left<font color="#008080"><b>(</b></font>tLivro.volume,10<font color="#008080"><b>) </b></font>||
  left<font color="#008080"><b>(</b></font>tLivro.codidioma,10<font color="#008080"><b>) </b></font>|| left<font color="#008080"><b>(</b></font>tLivro.npaginas,10<font color="#008080"><b>) </b></font>|| 
  left<font color="#008080"><b>(</b></font>tLivro.preco,10<font color="#008080"><b>) </b></font>|| left<font color="#008080"><b>(</b></font>tLivro.qtdestoque,10<font color="#008080"><b>)
</b></font><font color="#0000FF"><b>else if </b></font>member<font color="#008080"><b>(</b></font>ctArqs, sreg<font color="#008080"><b>) </b></font>= opLivroAss then
  slinha:=left<font color="#008080"><b>(</b></font>tLivroAss.isbn,13<font color="#008080"><b>) </b></font>|| left<font color="#008080"><b>(</b></font>tlivroAss.codassunto,10<font color="#008080"><b>)
</b></font><font color="#0000FF"><b>else if </b></font>member<font color="#008080"><b>(</b></font>ctArqs, sreg<font color="#008080"><b>) </b></font>= opLivroAut then
  slinha:=left<font color="#008080"><b>(</b></font>tLivroAut.isbn,13<font color="#008080"><b>) </b></font>|| left<font color="#008080"><b>(</b></font>tlivroAut.codautor,10<font color="#008080"><b>)
</b></font><font color="#0000FF"><b>else if </b></font>member<font color="#008080"><b>(</b></font>ctArqs, sreg<font color="#008080"><b>) </b></font>= opCliente then
  slinha:=left<font color="#008080"><b>(</b></font>tCliente.cpf,14<font color="#008080"><b>) </b></font>|| left<font color="#008080"><b>(</b></font>tCliente.nome,30<font color="#008080"><b>) </b></font>|| 
  left<font color="#008080"><b>(</b></font>tCliente.email,30<font color="#008080"><b>) </b></font>|| left<font color="#008080"><b>(</b></font>tCliente.identidade,10<font color="#008080"><b>) </b></font>|| 
  left<font color="#008080"><b>(</b></font>tCliente.sexo,1<font color="#008080"><b>) </b></font>|| left<font color="#008080"><b>(</b></font>tCliente.telefone,17<font color="#008080"><b>) </b></font>||
  left<font color="#008080"><b>(</b></font>tCliente.dtnascimento,10<font color="#008080"><b>) </b></font>|| left<font color="#008080"><b>(</b></font>tCliente.codendereco,10<font color="#008080"><b>) </b></font>||
  left<font color="#008080"><b>(</b></font>tCliente.codpais,3<font color="#008080"><b>) </b></font>|| left<font color="#008080"><b>(</b></font>tCliente.codprofissao,10<font color="#008080"><b>)
</b></font><font color="#0000FF"><b>else if </b></font>member<font color="#008080"><b>(</b></font>ctArqs, sreg<font color="#008080"><b>) </b></font>= opVenda then
  slinha:=left<font color="#008080"><b>(</b></font>tVenda.dthrvenda,19<font color="#008080"><b>) </b></font>|| left<font color="#008080"><b>(</b></font>tVenda.cpf,14<font color="#008080"><b>) </b></font>|| 
  left<font color="#008080"><b>(</b></font>tVenda.isbn,13<font color="#008080"><b>) </b></font>|| left<font color="#008080"><b>(</b></font>tVenda.precovenda,10<font color="#008080"><b>)

</b></font><font color="#0000FF"><b>return </b></font>slinha
<font color="#0000FF"><b>end
</b></font><font color="#808080">#------------------------------------------------------------------------------
# Retorna o tamanho do registro no arquivo de acordo com o tipo de arquivo.
# sreg - o tipo de arquivo
# retorna - o tamanho do registro
#------------------------------------------------------------------------------
</font>procedure tamReg<font color="#008080"><b>(</b></font>sreg<font color="#008080"><b>)
</b></font><font color="#800000"><b>local </b></font>nret

nret:=0
<font color="#0000FF"><b>if </b></font>member<font color="#008080"><b>(</b></font>ctArqs, sreg<font color="#008080"><b>) </b></font>= opAssunto then nret:=TAM_ASSUNTO
<font color="#0000FF"><b>else if </b></font>member<font color="#008080"><b>(</b></font>ctArqs, sreg<font color="#008080"><b>) </b></font>= opAutor then nret:=TAM_AUTOR
<font color="#0000FF"><b>else if </b></font>member<font color="#008080"><b>(</b></font>ctArqs, sreg<font color="#008080"><b>) </b></font>= opEditora then nret:=TAM_EDITORA
<font color="#0000FF"><b>else if </b></font>member<font color="#008080"><b>(</b></font>ctArqs, sreg<font color="#008080"><b>) </b></font>= opEndereco then nret:=TAM_ENDERECO
<font color="#0000FF"><b>else if </b></font>member<font color="#008080"><b>(</b></font>ctArqs, sreg<font color="#008080"><b>) </b></font>= opIdioma then nret:=TAM_IDIOMA
<font color="#0000FF"><b>else if </b></font>member<font color="#008080"><b>(</b></font>ctArqs, sreg<font color="#008080"><b>) </b></font>= opPais then nret:=TAM_PAIS
<font color="#0000FF"><b>else if </b></font>member<font color="#008080"><b>(</b></font>ctArqs, sreg<font color="#008080"><b>) </b></font>= opProfissao then nret:=TAM_PROFISSAO
<font color="#0000FF"><b>else if </b></font>member<font color="#008080"><b>(</b></font>ctArqs, sreg<font color="#008080"><b>) </b></font>= opUsuario then nret:=TAM_USUARIO
<font color="#0000FF"><b>else if </b></font>member<font color="#008080"><b>(</b></font>ctArqs, sreg<font color="#008080"><b>) </b></font>= opLivro then nret:=TAM_LIVRO
<font color="#0000FF"><b>else if </b></font>member<font color="#008080"><b>(</b></font>ctArqs, sreg<font color="#008080"><b>) </b></font>= opLivroAss then nret:=TAM_LIVASS
<font color="#0000FF"><b>else if </b></font>member<font color="#008080"><b>(</b></font>ctArqs, sreg<font color="#008080"><b>) </b></font>= opLivroAut then nret:=TAM_LIVAUT
<font color="#0000FF"><b>else if </b></font>member<font color="#008080"><b>(</b></font>ctArqs, sreg<font color="#008080"><b>) </b></font>= opCliente then nret:=TAM_CLIENTE
<font color="#0000FF"><b>else if </b></font>member<font color="#008080"><b>(</b></font>ctArqs, sreg<font color="#008080"><b>) </b></font>= opVenda then nret:=TAM_VENDA

<font color="#0000FF"><b>return </b></font>nret
<font color="#0000FF"><b>end
</b></font><font color="#808080">#------------------------------------------------------------------------------
# Seleciona o rotulo de cada campo de acordo com o tipo de arquivo.
# sreg - o tipo de arquivo
# nNum - indica qual rotulo ser&aacute; retornado
# retorna - o rotulo
#------------------------------------------------------------------------------
</font>procedure rotulo<font color="#008080"><b>(</b></font>sreg, nNum<font color="#008080"><b>)
</b></font><font color="#800000"><b>local </b></font>sret

sret:=<font color="#800000">&quot;&quot;
</font><font color="#0000FF"><b>if </b></font>member<font color="#008080"><b>(</b></font>ctArqs, sreg<font color="#008080"><b>) </b></font>= opAssunto then <font color="#008080"><b>{
   </b></font><font color="#0000FF"><b>case </b></font>nNum of <font color="#008080"><b>{
     </b></font>0: sret:=<font color="#800000">&quot;Assunto(s) n&atilde;o encontrado(s)!&quot;
     </font>1: <font color="#008080"><b>{
         </b></font>sret:=<font color="#800000">&quot;C&oacute;digo do assunto: &quot;
         </font>g_nPosChave:=1
         g_nTamChave:=10
        <font color="#008080"><b>}
     </b></font>2: <font color="#008080"><b>{
         </b></font>sret:=<font color="#800000">&quot;Assunto: &quot;
         </font>g_nPosChave:=11
         g_nTamChave:=30
        <font color="#008080"><b>}
   }
} </b></font><font color="#0000FF"><b>else if </b></font>member<font color="#008080"><b>(</b></font>ctArqs, sreg<font color="#008080"><b>) </b></font>= opAutor then <font color="#008080"><b>{
   </b></font><font color="#0000FF"><b>case </b></font>nNum of <font color="#008080"><b>{
     </b></font>0: sret:=<font color="#800000">&quot;Autor(es) n&atilde;o encontrado(s)!&quot;
     </font>1: <font color="#008080"><b>{
         </b></font>sret:=<font color="#800000">&quot;C&oacute;digo do autor: &quot;
         </font>g_nPosChave:=1
         g_nTamChave:=10
        <font color="#008080"><b>}
     </b></font>2: <font color="#008080"><b>{
         </b></font>sret:=<font color="#800000">&quot;Autor: &quot;
         </font>g_nPosChave:=11
         g_nTamChave:=30
        <font color="#008080"><b>}
   }
} </b></font><font color="#0000FF"><b>else if </b></font>member<font color="#008080"><b>(</b></font>ctArqs, sreg<font color="#008080"><b>) </b></font>= opEditora then <font color="#008080"><b>{
   </b></font><font color="#0000FF"><b>case </b></font>nNum of <font color="#008080"><b>{
     </b></font>0: sret:=<font color="#800000">&quot;Editora(s) n&atilde;o encontrada(s)!&quot;
     </font>1: <font color="#008080"><b>{
         </b></font>sret:=<font color="#800000">&quot;C&oacute;digo da editora: &quot;
         </font>g_nPosChave:=1
         g_nTamChave:=10
        <font color="#008080"><b>}
     </b></font>2: <font color="#008080"><b>{
         </b></font>sret:=<font color="#800000">&quot;Editora: &quot;
         </font>g_nPosChave:=11
         g_nTamChave:=50
        <font color="#008080"><b>}
   }
} </b></font><font color="#0000FF"><b>else if </b></font>member<font color="#008080"><b>(</b></font>ctArqs, sreg<font color="#008080"><b>) </b></font>= opEndereco then <font color="#008080"><b>{
   </b></font><font color="#0000FF"><b>case </b></font>nNum of <font color="#008080"><b>{
     </b></font>0: sret:=<font color="#800000">&quot;Endere&ccedil;o(s) n&atilde;o encontrado(s)!&quot;
     </font>1: <font color="#008080"><b>{
         </b></font>sret:=<font color="#800000">&quot;C&oacute;digo do endere&ccedil;o: &quot;
         </font>g_nPosChave:=1
         g_nTamChave:=10
        <font color="#008080"><b>}
     </b></font>2: <font color="#008080"><b>{
         </b></font>sret:=<font color="#800000">&quot;Logradouro: &quot;
         </font>g_nPosChave:=11
         g_nTamChave:=40
        <font color="#008080"><b>}
     </b></font>3: <font color="#008080"><b>{
         </b></font>sret:=<font color="#800000">&quot;Bairro: &quot;
         </font>g_nPosChave:=51
         g_nTamChave:=15
        <font color="#008080"><b>}
     </b></font>4: <font color="#008080"><b>{
         </b></font>sret:=<font color="#800000">&quot;CEP: &quot;
         </font>g_nPosChave:=66
         g_nTamChave:=8
        <font color="#008080"><b>}
     </b></font>5: <font color="#008080"><b>{
         </b></font>sret:=<font color="#800000">&quot;Cidade: &quot;
         </font>g_nPosChave:=74
         g_nTamChave:=30
        <font color="#008080"><b>}
     </b></font>6: <font color="#008080"><b>{
         </b></font>sret:=<font color="#800000">&quot;Estado: &quot;
         </font>g_nPosChave:=104
         g_nTamChave:=20
        <font color="#008080"><b>}
   }
} </b></font><font color="#0000FF"><b>else if </b></font>member<font color="#008080"><b>(</b></font>ctArqs, sreg<font color="#008080"><b>) </b></font>= opIdioma then <font color="#008080"><b>{
   </b></font><font color="#0000FF"><b>case </b></font>nNum of <font color="#008080"><b>{
     </b></font>0: sret:=<font color="#800000">&quot;Idioma(s) n&atilde;o encontrado(s)!&quot;
     </font>1: <font color="#008080"><b>{
         </b></font>sret:=<font color="#800000">&quot;C&oacute;digo do idioma: &quot;
         </font>g_nPosChave:=1
         g_nTamChave:=10
        <font color="#008080"><b>}
     </b></font>2: <font color="#008080"><b>{
         </b></font>sret:=<font color="#800000">&quot;Idioma: &quot;
         </font>g_nPosChave:=11
         g_nTamChave:=20
        <font color="#008080"><b>}
   }
} </b></font><font color="#0000FF"><b>else if </b></font>member<font color="#008080"><b>(</b></font>ctArqs, sreg<font color="#008080"><b>) </b></font>= opPais then <font color="#008080"><b>{
   </b></font><font color="#0000FF"><b>case </b></font>nNum of <font color="#008080"><b>{
     </b></font>0: sret:=<font color="#800000">&quot;Pa&iacute;s(es) n&atilde;o encontrado(s)!&quot;
     </font>1: <font color="#008080"><b>{
         </b></font>sret:=<font color="#800000">&quot;C&oacute;digo do pa&iacute;s: &quot;
         </font>g_nPosChave:=1
         g_nTamChave:=3
        <font color="#008080"><b>}
     </b></font>2: <font color="#008080"><b>{
         </b></font>sret:=<font color="#800000">&quot;Pa&iacute;s: &quot;
         </font>g_nPosChave:=4
         g_nTamChave:=50
        <font color="#008080"><b>}
   }
} </b></font><font color="#0000FF"><b>else if </b></font>member<font color="#008080"><b>(</b></font>ctArqs, sreg<font color="#008080"><b>) </b></font>= opProfissao then <font color="#008080"><b>{
   </b></font><font color="#0000FF"><b>case </b></font>nNum of <font color="#008080"><b>{
     </b></font>0: sret:=<font color="#800000">&quot;Profiss&atilde;o(es) n&atilde;o encontrada(s)!&quot;
     </font>1: <font color="#008080"><b>{
         </b></font>sret:=<font color="#800000">&quot;C&oacute;digo da profiss&atilde;o: &quot;
         </font>g_nPosChave:=1
         g_nTamChave:=10
        <font color="#008080"><b>}
     </b></font>2: <font color="#008080"><b>{
         </b></font>sret:=<font color="#800000">&quot;Profiss&atilde;o: &quot;
         </font>g_nPosChave:=11
         g_nTamChave:=50
        <font color="#008080"><b>}
   }
} </b></font><font color="#0000FF"><b>else if </b></font>member<font color="#008080"><b>(</b></font>ctArqs, sreg<font color="#008080"><b>) </b></font>= opUsuario then <font color="#008080"><b>{
   </b></font><font color="#0000FF"><b>case </b></font>nNum of <font color="#008080"><b>{
     </b></font>0: sret:=<font color="#800000">&quot;login ou senha incorreta, tente de novo!&quot;
     </font>1: <font color="#008080"><b>{
         </b></font>sret:=<font color="#800000">&quot;Login: &quot;
         </font>g_nPosChave:=1
         g_nTamChave:=10
        <font color="#008080"><b>}
     </b></font>2: <font color="#008080"><b>{
         </b></font>sret:=<font color="#800000">&quot;Senha: &quot;
         </font>g_nPosChave:=11
         g_nTamChave:=10
        <font color="#008080"><b>}
   }
} </b></font><font color="#0000FF"><b>else if </b></font>member<font color="#008080"><b>(</b></font>ctArqs, sreg<font color="#008080"><b>) </b></font>= opLivro then <font color="#008080"><b>{
   </b></font><font color="#0000FF"><b>case </b></font>nNum of <font color="#008080"><b>{
     </b></font>0: sret:=<font color="#800000">&quot;Livro(s) n&atilde;o encontrado(s)!&quot;
     </font>1: <font color="#008080"><b>{
         </b></font>sret:=<font color="#800000">&quot;ISBN: &quot;
         </font>g_nPosChave:=1
         g_nTamChave:=13
        <font color="#008080"><b>}
     </b></font>2: <font color="#008080"><b>{
         </b></font>sret:=<font color="#800000">&quot;T&iacute;tulo: &quot;
         </font>g_nPosChave:=14
         g_nTamChave:=50
        <font color="#008080"><b>}
     </b></font>3: <font color="#008080"><b>{
         </b></font>sret:=<font color="#800000">&quot;Edi&ccedil;&atilde;o: &quot;
         </font>g_nPosChave:=64
         g_nTamChave:=10
        <font color="#008080"><b>}
     </b></font>4: <font color="#008080"><b>{
         </b></font>sret:=<font color="#800000">&quot;Ano de Publica&ccedil;&atilde;o: &quot;
         </font>g_nPosChave:=74
         g_nTamChave:=10
        <font color="#008080"><b>}
     </b></font>5: <font color="#008080"><b>{
         </b></font>sret:=<font color="#800000">&quot;C&oacute;digo da editora: &quot;
         </font>g_nPosChave:=84
         g_nTamChave:=10
        <font color="#008080"><b>}
     </b></font>6: <font color="#008080"><b>{
         </b></font>sret:=<font color="#800000">&quot;Volume: &quot;
         </font>g_nPosChave:=94
         g_nTamChave:=10
        <font color="#008080"><b>}
     </b></font>7: <font color="#008080"><b>{
         </b></font>sret:=<font color="#800000">&quot;C&oacute;digo do idioma: &quot;
         </font>g_nPosChave:=104
         g_nTamChave:=10
        <font color="#008080"><b>}
     </b></font>8: <font color="#008080"><b>{
         </b></font>sret:=<font color="#800000">&quot;N&uacute;mero de p&aacute;ginas: &quot;
         </font>g_nPosChave:=114
         g_nTamChave:=10
        <font color="#008080"><b>}
     </b></font>9: <font color="#008080"><b>{
         </b></font>sret:=<font color="#800000">&quot;Pre&ccedil;o: &quot;
         </font>g_nPosChave:=124
         g_nTamChave:=10
        <font color="#008080"><b>}
     </b></font>10: <font color="#008080"><b>{
          </b></font>sret:=<font color="#800000">&quot;Qtd. Estoque: &quot;
          </font>g_nPosChave:=134
          g_nTamChave:=10
         <font color="#008080"><b>}
   }
} </b></font><font color="#0000FF"><b>else if </b></font>member<font color="#008080"><b>(</b></font>ctArqs, sreg<font color="#008080"><b>) </b></font>= opLivroAss then <font color="#008080"><b>{
   </b></font><font color="#0000FF"><b>case </b></font>nNum of <font color="#008080"><b>{
     </b></font>0: sret:=<font color="#800000">&quot;Assunto(s) n&atilde;o encontrado(s)!&quot;
     </font>1: <font color="#008080"><b>{
         </b></font>sret:=<font color="#800000">&quot;ISBN: &quot;
         </font>g_nPosChave:=1
         g_nTamChave:=13
        <font color="#008080"><b>}
     </b></font>2: <font color="#008080"><b>{
         </b></font>sret:=<font color="#800000">&quot;C&oacute;digo do assunto: &quot;
         </font>g_nPosChave:=14
         g_nTamChave:=10
        <font color="#008080"><b>}
   }
} </b></font><font color="#0000FF"><b>else if </b></font>member<font color="#008080"><b>(</b></font>ctArqs, sreg<font color="#008080"><b>) </b></font>= opLivroAut then <font color="#008080"><b>{
   </b></font><font color="#0000FF"><b>case </b></font>nNum of <font color="#008080"><b>{
     </b></font>0: sret:=<font color="#800000">&quot;Autor(s) n&atilde;o encontrado(s)!&quot;
     </font>1: <font color="#008080"><b>{
         </b></font>sret:=<font color="#800000">&quot;ISBN: &quot;
         </font>g_nPosChave:=1
         g_nTamChave:=13
        <font color="#008080"><b>}
     </b></font>2: <font color="#008080"><b>{
         </b></font>sret:=<font color="#800000">&quot;C&oacute;digo do autor: &quot;
         </font>g_nPosChave:=14
         g_nTamChave:=10
        <font color="#008080"><b>}
   }
} </b></font><font color="#0000FF"><b>else if </b></font>member<font color="#008080"><b>(</b></font>ctArqs, sreg<font color="#008080"><b>) </b></font>= opCliente then <font color="#008080"><b>{
   </b></font><font color="#0000FF"><b>case </b></font>nNum of <font color="#008080"><b>{
     </b></font>0: sret:=<font color="#800000">&quot;Cliente(s) n&atilde;o encontrado(s)!&quot;
     </font>1: <font color="#008080"><b>{
         </b></font>sret:=<font color="#800000">&quot;CPF: &quot;
         </font>g_nPosChave:=1
         g_nTamChave:=14
        <font color="#008080"><b>}
     </b></font>2: <font color="#008080"><b>{
         </b></font>sret:=<font color="#800000">&quot;Nome: &quot;
         </font>g_nPosChave:=15
         g_nTamChave:=30
        <font color="#008080"><b>}
     </b></font>3: <font color="#008080"><b>{
         </b></font>sret:=<font color="#800000">&quot;E-mail: &quot;
         </font>g_nPosChave:=45
         g_nTamChave:=30
        <font color="#008080"><b>}
     </b></font>4: <font color="#008080"><b>{
         </b></font>sret:=<font color="#800000">&quot;Identidade: &quot;
         </font>g_nPosChave:=75
         g_nTamChave:=10
        <font color="#008080"><b>}
     </b></font>5: <font color="#008080"><b>{
         </b></font>sret:=<font color="#800000">&quot;Sexo: &quot;
         </font>g_nPosChave:=85
         g_nTamChave:=1
        <font color="#008080"><b>}
     </b></font>6: <font color="#008080"><b>{
         </b></font>sret:=<font color="#800000">&quot;Telefone: &quot;
         </font>g_nPosChave:=86
         g_nTamChave:=17
        <font color="#008080"><b>}
     </b></font>7: <font color="#008080"><b>{
         </b></font>sret:=<font color="#800000">&quot;Dt. Nascimento: &quot;
         </font>g_nPosChave:=103
         g_nTamChave:=10
        <font color="#008080"><b>}
     </b></font>8: <font color="#008080"><b>{
         </b></font>sret:=<font color="#800000">&quot;C&oacute;digo do endere&ccedil;o: &quot;
         </font>g_nPosChave:=113
         g_nTamChave:=10
        <font color="#008080"><b>}
     </b></font>9: <font color="#008080"><b>{
         </b></font>sret:=<font color="#800000">&quot;C&oacute;digo do pa&iacute;s: &quot;
         </font>g_nPosChave:=123
         g_nTamChave:=3
        <font color="#008080"><b>}
     </b></font>10: <font color="#008080"><b>{
          </b></font>sret:=<font color="#800000">&quot;C&oacute;digo da Profiss&atilde;o: &quot;
          </font>g_nPosChave:=126
          g_nTamChave:=10
        <font color="#008080"><b>}
   }
} </b></font><font color="#0000FF"><b>else if </b></font>member<font color="#008080"><b>(</b></font>ctArqs, sreg<font color="#008080"><b>) </b></font>= opVenda then <font color="#008080"><b>{
   </b></font><font color="#0000FF"><b>case </b></font>nNum of <font color="#008080"><b>{
     </b></font>0: sret:=<font color="#800000">&quot;Venda(s) n&atilde;o encontrada(s)!&quot;
     </font>1: <font color="#008080"><b>{
         </b></font>sret:=<font color="#800000">&quot;Data/Hora venda: &quot;
         </font>g_nPosChave:=1
         g_nTamChave:=19
        <font color="#008080"><b>}
     </b></font>2: <font color="#008080"><b>{
         </b></font>sret:=<font color="#800000">&quot;CPF: &quot;
         </font>g_nPosChave:=20
         g_nTamChave:=14
        <font color="#008080"><b>}
     </b></font>3: <font color="#008080"><b>{
         </b></font>sret:=<font color="#800000">&quot;ISBN: &quot;
         </font>g_nPosChave:=34
         g_nTamChave:=13
        <font color="#008080"><b>}
     </b></font>4: <font color="#008080"><b>{
         </b></font>sret:=<font color="#800000">&quot;Pre&ccedil;o de venda: &quot;
         </font>g_nPosChave:=47
         g_nTamChave:=10
        <font color="#008080"><b>}
   }
}

</b></font><font color="#0000FF"><b>return </b></font>sret
<font color="#0000FF"><b>end
</b></font><font color="#808080">#------------------------------------------------------------------------------
# Indica se continua ou n&atilde;o mostrando um n&uacute;mero m&aacute;ximo de linhas.
# nlinha - a linha a ser continuada
# nQtdLinha - a quantidade de linhas a serem mostradas
# retorna - se continua ou n&atilde;o
#------------------------------------------------------------------------------
</font>procedure ContinuaSN<font color="#008080"><b>(</b></font>nlinha, nQtdLinha<font color="#008080"><b>)
</b></font><font color="#800000"><b>local </b></font>bSOp, bret, opCSubMenu

bret:=false
<font color="#0000FF"><b>if </b></font>nlinha &gt; 0 then <font color="#008080"><b>{
  </b></font><font color="#0000FF"><b>if </b></font><font color="#008080"><b>(</b></font>nlinha % nQtdLinha<font color="#008080"><b>) </b></font>= 0 then <font color="#008080"><b>{
     </b></font>bSOp:=true
     <font color="#0000FF"><b>while </b></font><font color="#008080"><b>(</b></font>bSOp=true<font color="#008080"><b>) </b></font>do <font color="#008080"><b>{
       </b></font>menu<font color="#008080"><b>(13)
       </b></font>opCSubMenu := <font color="#800000"><b>read</b></font><font color="#008080"><b>()
       </b></font><font color="#0000FF"><b>if </b></font><font color="#008080"><b>(</b></font>opCSubMenu==<font color="#800000">&quot;S&quot;</font><font color="#008080"><b>) </b></font>| <font color="#008080"><b>(</b></font>opCSubMenu==<font color="#800000">&quot;s&quot;</font><font color="#008080"><b>) </b></font>then bSOp:=false
       <font color="#0000FF"><b>else if </b></font><font color="#008080"><b>(</b></font>opCSubMenu==<font color="#800000">&quot;N&quot;</font><font color="#008080"><b>) </b></font>| <font color="#008080"><b>(</b></font>opCSubMenu==<font color="#800000">&quot;n&quot;</font><font color="#008080"><b>) </b></font>then <font color="#008080"><b>{
          </b></font>bret:=true
          bSOp:=false
       <font color="#008080"><b>} </b></font><font color="#0000FF"><b>else </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font>MSG_ERRO<font color="#008080"><b>)
     }
  }
}
</b></font><font color="#0000FF"><b>return </b></font>bret
<font color="#0000FF"><b>end
</b></font><font color="#808080">#------------------------------------------------------------------------------
# Lista v&aacute;rios registros de acordo com a pesquisa feita.
# sArq - o arquivo
# sreg - o tipo de arquivo
# sChave - a chave a ser pesquisada
# nPosChave - a posicao inicial da chave dentro do registro
# nTamChave - o tamanho da chave dentro do registro
# nTamLinha - o tamanho do registro
# nQtdLinha - a quantidade de linhas a serem mostradas
# retorna - se encontrou algum registro
#------------------------------------------------------------------------------
</font>procedure ListarTodos<font color="#008080"><b>(</b></font>sArq, sreg, sChave, nPosChave, nTamChave, nTamLinha, 
  nQtdLinha, bPesqRelativa<font color="#008080"><b>)
</b></font><font color="#800000"><b>local </b></font>slinha, bQuebra, bAchou, bRet, nCont, sres

bRet:=false
bQuebra:=false
nCont:=0
mostrarDados<font color="#008080"><b>(</b></font>sreg, <font color="#800000">&quot;&quot;</font>, 2<font color="#008080"><b>)
</b></font><font color="#800000"><b>seek</b></font><font color="#008080"><b>(</b></font>sArq, 1<font color="#008080"><b>)
</b></font><font color="#0000FF"><b>while </b></font><font color="#008080"><b>(</b></font>slinha := <font color="#800000"><b>read</b></font><font color="#008080"><b>(</b></font>sArq<font color="#008080"><b>)) </b></font>&amp; <font color="#008080"><b>(</b></font>bQuebra=false<font color="#008080"><b>) </b></font>do <font color="#008080"><b>{
  </b></font><font color="#0000FF"><b>if </b></font>bPesqRelativa=true then <font color="#008080"><b>{
    </b></font>sres:=trim<font color="#008080"><b>(</b></font>substr<font color="#008080"><b>(</b></font>slinha,nPosChave,nTamChave<font color="#008080"><b>))
    </b></font><font color="#0000FF"><b>if </b></font><font color="#008080"><b>(</b></font>\sres<font color="#008080"><b>) </b></font>&amp; <font color="#008080"><b>(</b></font>strRelativa<font color="#008080"><b>(</b></font>sres,sChave<font color="#008080"><b>)</b></font>=true<font color="#008080"><b>) </b></font>then <font color="#008080"><b>{
       </b></font>bAchou:=true
       bRet:=true
    <font color="#008080"><b>} </b></font><font color="#0000FF"><b>else
       </b></font>bAchou:=false
  <font color="#008080"><b>} </b></font><font color="#0000FF"><b>else </b></font><font color="#008080"><b>{
    </b></font>bAchou:=true
    bRet:=true
  <font color="#008080"><b>}

  </b></font><font color="#0000FF"><b>if </b></font>bAchou=true then <font color="#008080"><b>{
    </b></font>mostrarDados<font color="#008080"><b>(</b></font>sreg, substr<font color="#008080"><b>(</b></font>slinha,1,nTamLinha<font color="#008080"><b>)</b></font>, 3<font color="#008080"><b>)
    </b></font>nCont+:=1
  <font color="#008080"><b>}

  </b></font>bQuebra:=ContinuaSN<font color="#008080"><b>(</b></font>nCont, nQtdLinha<font color="#008080"><b>)
}
</b></font><font color="#0000FF"><b>return </b></font>bRet
<font color="#0000FF"><b>end
</b></font><font color="#808080">#------------------------------------------------------------------------------
# Lista v&aacute;rios registros entre arquivos de acordo com a pesquisa feita.
# sArq1 - o arquivo de liga&ccedil;&atilde;o
# sreg1 - o tipo de arquivo de liga&ccedil;&atilde;o
# nPosChave1 - a posicao inicial da primeira chave no arquivo de liga&ccedil;&atilde;o
# nTamChave1 - o tamanho da primeira chave no arquivo de liga&ccedil;&atilde;o
# nPosChave2 - a posicao inicial da segunda chave do arquivo de liga&ccedil;&atilde;o
# nTamChave2 - o tamanho da segunda chave do arquivo de liga&ccedil;&atilde;o
# sChave - a chave a ser pesquisada no arquivo de liga&ccedil;&atilde;o
# sArq2 - o arquivo a ser pesquisado
# sreg2 - o tipo de arquivo a ser pesquisado
# nPosChave3 - a posicao inicial da chave do arquivo pesquisado
# nQtdLinha - a quantidade de linhas a serem mostradas
#------------------------------------------------------------------------------
</font>procedure ListarRegLigados<font color="#008080"><b>(</b></font>sArq1, sreg1, nPosChave1, nTamChave1, 
          nPosChave2, nTamChave2, sChave, sArq2, sreg2, nPosChave3, nQtdLinha<font color="#008080"><b>)
</b></font><font color="#800000"><b>local </b></font>slinha1, bQuebra, bRet, nCont, sCodigo1, sCodigo2, slinha2

bRet:=false
nCont:=0
bQuebra:=false
mostrarDados<font color="#008080"><b>(</b></font>sreg2, <font color="#800000">&quot;&quot;</font>, 2<font color="#008080"><b>)
</b></font><font color="#800000"><b>seek</b></font><font color="#008080"><b>(</b></font>sArq1, 1<font color="#008080"><b>)
</b></font><font color="#0000FF"><b>while </b></font><font color="#008080"><b>(</b></font>slinha1 := <font color="#800000"><b>read</b></font><font color="#008080"><b>(</b></font>sArq1<font color="#008080"><b>)) </b></font>&amp; <font color="#008080"><b>(</b></font>bQuebra=false<font color="#008080"><b>) </b></font>do <font color="#008080"><b>{
  </b></font>sCodigo1:=trim<font color="#008080"><b>(</b></font>substr<font color="#008080"><b>(</b></font>slinha1,nPosChave1,nTamChave1<font color="#008080"><b>))
  </b></font><font color="#0000FF"><b>if </b></font><font color="#008080"><b>(</b></font>\sCodigo1<font color="#008080"><b>) </b></font>&amp; <font color="#008080"><b>(</b></font>sCodigo1==sChave<font color="#008080"><b>) </b></font>then <font color="#008080"><b>{
    </b></font>sCodigo2:=trim<font color="#008080"><b>(</b></font>substr<font color="#008080"><b>(</b></font>slinha1,nPosChave2,nTamChave2<font color="#008080"><b>))
    </b></font>slinha2:=pesqArq<font color="#008080"><b>(</b></font>sArq2, sCodigo2, nPosChave3, nTamChave2, tamReg<font color="#008080"><b>(</b></font>sreg2<font color="#008080"><b>))
    </b></font>mostrarDados<font color="#008080"><b>(</b></font>sreg2, substr<font color="#008080"><b>(</b></font>slinha2, 1, tamReg<font color="#008080"><b>(</b></font>sreg2<font color="#008080"><b>))</b></font>, 3<font color="#008080"><b>)
    </b></font>bRet:=true
    nCont+:=1
  <font color="#008080"><b>}
  </b></font>bQuebra:=ContinuaSN<font color="#008080"><b>(</b></font>nCont, nQtdLinha<font color="#008080"><b>)
}
</b></font><font color="#0000FF"><b>if </b></font>bRet=false then
   <font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font>rotulo<font color="#008080"><b>(</b></font>sreg2,0<font color="#008080"><b>))
</b></font><font color="#0000FF"><b>end
</b></font><font color="#808080">#------------------------------------------------------------------------------
# Valida a entrada de registros de acordo com a pesquisa feita.
# sArq - o arquivo
# sreg - o tipo de arquivo
# nTexto - o numero do r&oacute;tulo da entrada
# sEntrada - a chave a ser pesquisada e validada
# nTentativas - o n&uacute;mero m&aacute;ximo de tentativas
# bPesqRelativa - indica se vai realizar uma pesquisa relativa
# bTipoEntrada - indica o tipo de entrada
# retorna - o registro pesquisado e validado
#------------------------------------------------------------------------------
</font>procedure validaEntrada<font color="#008080"><b>(</b></font>sArq, sreg, nTexto, sEntrada, nTentativas,
          bPesqRelativa, bTipoEntrada<font color="#008080"><b>)
</b></font><font color="#800000"><b>local </b></font>bQuebra, sres, sTexto, sMsgErro, ncont, nPosChave, nTamChave, nTamLinha

nTamLinha:=tamReg<font color="#008080"><b>(</b></font>sreg<font color="#008080"><b>)
</b></font>sMsgErro:=rotulo<font color="#008080"><b>(</b></font>sreg,0<font color="#008080"><b>)
</b></font>sTexto:=rotulo<font color="#008080"><b>(</b></font>sreg,nTexto<font color="#008080"><b>)
</b></font>nPosChave:=g_nPosChave
nTamChave:=g_nTamChave

ncont:=1
bQuebra:=false
  <font color="#0000FF"><b>while </b></font><font color="#008080"><b>(</b></font>bQuebra=false<font color="#008080"><b>) </b></font>&amp; <font color="#008080"><b>(</b></font>ncont &lt;= nTentativas <font color="#008080"><b>) </b></font>do <font color="#008080"><b>{

    </b></font><font color="#0000FF"><b>if </b></font>member<font color="#008080"><b>(</b></font>ctTipo, bTipoEntrada<font color="#008080"><b>) </b></font>= opTexto then <font color="#008080"><b>{
      </b></font>writes<font color="#008080"><b>(</b></font>sTexto<font color="#008080"><b>)
      </b></font>sEntrada:=<font color="#800000"><b>read</b></font><font color="#008080"><b>()
    } </b></font><font color="#0000FF"><b>else if </b></font>member<font color="#008080"><b>(</b></font>ctTipo, bTipoEntrada<font color="#008080"><b>) </b></font>= opNumero then
       sEntrada:=validaNumero<font color="#008080"><b>(</b></font>sTexto,sEntrada<font color="#008080"><b>)
    </b></font><font color="#0000FF"><b>else if </b></font>member<font color="#008080"><b>(</b></font>ctTipo, bTipoEntrada<font color="#008080"><b>) </b></font>= opData then
      sEntrada:=validaDataHora<font color="#008080"><b>(</b></font>sTexto,sEntrada,true<font color="#008080"><b>)
    </b></font><font color="#0000FF"><b>else if </b></font>member<font color="#008080"><b>(</b></font>ctTipo, bTipoEntrada<font color="#008080"><b>) </b></font>= opDataHora then
      sEntrada:=validaDataHora<font color="#008080"><b>(</b></font>sTexto,sEntrada,false<font color="#008080"><b>)
    </b></font><font color="#0000FF"><b>else if </b></font>member<font color="#008080"><b>(</b></font>ctTipo, bTipoEntrada<font color="#008080"><b>) </b></font>= opSenha then
      sEntrada:=digitaSenha<font color="#008080"><b>(</b></font>sTexto, 10<font color="#008080"><b>) 

    </b></font><font color="#0000FF"><b>if </b></font>bPesqRelativa=true then <font color="#008080"><b>{
       </b></font><font color="#0000FF"><b>if </b></font>ListarTodos<font color="#008080"><b>(</b></font>sArq, sreg, sEntrada, nPosChave, nTamChave, nTamLinha,
                      QTD_MAX_LINHA, true<font color="#008080"><b>)</b></font>=true then
          sres:=<font color="#800000">&quot; &quot;     
    </font><font color="#008080"><b>} </b></font><font color="#0000FF"><b>else
       </b></font>sres:=pesqArq<font color="#008080"><b>(</b></font>sArq, sEntrada, nPosChave, nTamChave, nTamLinha<font color="#008080"><b>)

    </b></font><font color="#0000FF"><b>if </b></font>sres==<font color="#800000">&quot;&quot; </font>then
       <font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font>sMsgErro<font color="#008080"><b>)
    </b></font><font color="#0000FF"><b>else
       </b></font>bQuebra:=true

    ncont+:=1
  <font color="#008080"><b>}
</b></font><font color="#0000FF"><b>return </b></font>sres
<font color="#0000FF"><b>end
</b></font><font color="#808080">#------------------------------------------------------------------------------
# Mostra a tela de splash do sistema.
#------------------------------------------------------------------------------
</font>procedure frmSplash<font color="#008080"><b>()
</b></font><font color="#800000"><b>local </b></font>cont

 <font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;*---------------------------------------&quot; </font>||
 <font color="#800000">&quot;-------------------------------------*&quot;</font><font color="#008080"><b>)
 </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;| LL    II VV   VV RRRRR  UU  UU   SSSS &quot; </font>||
 <font color="#800000">&quot;VV   VV II RRRRR  TTTT UU  UU   SSSS |&quot;</font><font color="#008080"><b>)
 </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;| LL    II  VV VV  RR   R UU  UU  SS    &quot; </font>||
 <font color="#800000">&quot; VV VV  II RR   R  TT  UU  UU  SS    |&quot;</font><font color="#008080"><b>)
 </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;| LL    II   VVV   RRRRR  UU  UU    SS  &quot; </font>||
 <font color="#800000">&quot;  VVV   II RRRRR   TT  UU  UU    SS  |&quot;</font><font color="#008080"><b>)
 </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;| LLLLL II    V    RR   R  UUUU  SSSS   &quot; </font>||
 <font color="#800000">&quot;   V    II RR   R  TT   UUUU  SSSS   |&quot;</font><font color="#008080"><b>)
 </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;*---------------------------------------&quot; </font>||
 <font color="#800000">&quot;-------------------------------------*&quot;</font><font color="#008080"><b>)
 </b></font>every cont:=1 to 18 do <font color="#800000"><b>write</b></font><font color="#008080"><b>()
 </b></font>writes<font color="#008080"><b>(</b></font>MSG_PRESS<font color="#008080"><b>)
 </b></font><font color="#800000"><b>read</b></font><font color="#008080"><b>()
</b></font><font color="#0000FF"><b>end
</b></font><font color="#808080">#------------------------------------------------------------------------------
# Mostra a tela de sobre do sistema.
#------------------------------------------------------------------------------
</font>procedure frmSobre<font color="#008080"><b>()
</b></font><font color="#800000"><b>local </b></font>cont

 <font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;*------------------------------------------------------------*&quot;</font><font color="#008080"><b>)
 </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;|  LL        II  VV       VV  RRRRRRR   UU    UU   SSSSSSS   |&quot;</font><font color="#008080"><b>)
 </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;|  LL        II   VV     VV   RR     R  UU    UU  SS         |&quot;</font><font color="#008080"><b>)
 </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;|  LL        II    VV   VV    RR     R  UU    UU   SSSS      |&quot;</font><font color="#008080"><b>)
 </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;|  LL        II     VV VV     RRRRRRR   UU    UU     SSSS    |&quot;</font><font color="#008080"><b>)
 </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;|  LLLL      II      VVV      RR RR     UU    UU        SS   |&quot;</font><font color="#008080"><b>)
 </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;|  LLLLLLLL  II       V       RR   RR    UUUUUU   SSSSSSSS   |&quot;</font><font color="#008080"><b>)
 </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;|                                                            |&quot;</font><font color="#008080"><b>)
 </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;|  VV       VV  II  RRRRRRR   TTTTTTTT  UU    UU   SSSSSSS   |&quot;</font><font color="#008080"><b>)
 </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;|   VV     VV   II  RR     R     TT     UU    UU  SS         |&quot;</font><font color="#008080"><b>)
 </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;|    VV   VV    II  RR     R     TT     UU    UU   SSSS      |&quot;</font><font color="#008080"><b>)
 </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;|     VV VV     II  RRRRRRR      TT     UU    UU     SSSS    |&quot;</font><font color="#008080"><b>)
 </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;|      VVV      II  RR RR        TT     UU    UU        SS   |&quot;</font><font color="#008080"><b>)
 </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;|       V       II  RR   RR      TT      UUUUUU   SSSSSSSS   |&quot;</font><font color="#008080"><b>)
 </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;|                                                            |&quot;</font><font color="#008080"><b>)
 </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;|                                               Versao 1.0.0 |&quot;</font><font color="#008080"><b>)
 </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;| Sistema integrante do projeto Livrus Virtus.               |&quot;</font><font color="#008080"><b>)
 </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;| Todos os direitos reservados para Henrique F. de Souza.    |&quot;</font><font color="#008080"><b>)
 </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;| Versao programada na linguagem Icon.                       |&quot;</font><font color="#008080"><b>)
 </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;*------------------------------------------------------------*&quot;</font><font color="#008080"><b>)
 </b></font>every cont:=1 to 4 do <font color="#800000"><b>write</b></font><font color="#008080"><b>()
 </b></font>writes<font color="#008080"><b>(</b></font>MSG_PRESS<font color="#008080"><b>)
 </b></font><font color="#800000"><b>read</b></font><font color="#008080"><b>()
</b></font><font color="#0000FF"><b>end
</b></font><font color="#808080">#------------------------------------------------------------------------------
# Mostra a tela de login do sistema.
# retorna - se o login foi validado corretamente
#------------------------------------------------------------------------------
</font>procedure frmLogin<font color="#008080"><b>()
</b></font><font color="#800000"><b>local </b></font>bret, slinha

  bret:=false
  <font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;*--------------------------------------------------------------*&quot;</font><font color="#008080"><b>)
  </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;| Login do sistema                                             |&quot;</font><font color="#008080"><b>)
  </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;*--------------------------------------------------------------*&quot;</font><font color="#008080"><b>)
  </b></font>slinha:=validaEntrada<font color="#008080"><b>(</b></font>tfUsuario, opUsuario, 1, tUsuario.login, 3,
        false, opTexto<font color="#008080"><b>)
  </b></font><font color="#0000FF"><b>if </b></font>slinha~==<font color="#800000">&quot;&quot; </font>then <font color="#008080"><b>{
     </b></font>slinha:=validaEntrada<font color="#008080"><b>(</b></font>tfUsuario, opUsuario, 2, tUsuario.senha, 3,
        false, opSenha<font color="#008080"><b>)
     </b></font><font color="#0000FF"><b>if </b></font>slinha~==<font color="#800000">&quot;&quot; </font>then <font color="#008080"><b>{
        </b></font>tUsuario.login:=trim<font color="#008080"><b>(</b></font>substr<font color="#008080"><b>(</b></font>slinha, 1, 10<font color="#008080"><b>))
        </b></font>tUsuario.senha:=trim<font color="#008080"><b>(</b></font>substr<font color="#008080"><b>(</b></font>slinha, 11, 10<font color="#008080"><b>))
        </b></font>bret:=true
     <font color="#008080"><b>}
  }
  </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>()
  </b></font><font color="#0000FF"><b>return </b></font>bret
<font color="#0000FF"><b>end
</b></font><font color="#808080">#------------------------------------------------------------------------------
# Mostra os menus do sistema.
# num - o n&uacute;mero do menu
#------------------------------------------------------------------------------}
</font>procedure menu<font color="#008080"><b>(</b></font>num<font color="#008080"><b>)

 </b></font><font color="#0000FF"><b>if </b></font><font color="#008080"><b>(</b></font>num=1<font color="#008080"><b>) </b></font>then <font color="#008080"><b>{
  </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;*--------------------------------------------------------------*&quot;</font><font color="#008080"><b>)
  </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;| (C)adastros        (P)esquisas     (V)endas        (O)p&ccedil;&otilde;es  |&quot;</font><font color="#008080"><b>)
  </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;*--------------------------------------------------------------*&quot;</font><font color="#008080"><b>)
 } </b></font><font color="#0000FF"><b>else if </b></font><font color="#008080"><b>(</b></font>num=2<font color="#008080"><b>) </b></font>then <font color="#008080"><b>{
   </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;*---------------------------------*&quot;</font><font color="#008080"><b>)
   </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;| 01. Cadastro de Assuntos        |&quot;</font><font color="#008080"><b>)
   </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;| 02. Cadastro de Autores         |&quot;</font><font color="#008080"><b>)
   </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;| 03. Cadastro de Editoras        |&quot;</font><font color="#008080"><b>)
   </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;| 04. Cadastro de Endere&ccedil;os       |&quot;</font><font color="#008080"><b>)
   </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;| 05. Cadastro de Idiomas         |&quot;</font><font color="#008080"><b>)
   </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;| 06. Cadastro de Pa&iacute;ses          |&quot;</font><font color="#008080"><b>)
   </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;| 07. Cadastro de Profiss&otilde;es      |&quot;</font><font color="#008080"><b>)
   </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;| 08. Cadastro de Clientes        |&quot;</font><font color="#008080"><b>)
   </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;| 09. Cadastro de Livros          |&quot;</font><font color="#008080"><b>)
   </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;| 10. Voltar ao menu              |&quot;</font><font color="#008080"><b>)
   </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;*---------------------------------*&quot;</font><font color="#008080"><b>)
 } </b></font><font color="#0000FF"><b>else if </b></font><font color="#008080"><b>(</b></font>num=3<font color="#008080"><b>) </b></font>then <font color="#008080"><b>{
   </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;*---------------------------------*&quot;</font><font color="#008080"><b>)
   </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;| 01. Consulta de Assuntos        |&quot;</font><font color="#008080"><b>)
   </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;| 02. Consulta de Autores         |&quot;</font><font color="#008080"><b>)
   </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;| 03. Consulta de Editoras        |&quot;</font><font color="#008080"><b>)
   </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;| 04. Consulta de Endere&ccedil;os       |&quot;</font><font color="#008080"><b>)
   </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;| 05. Consulta de Idiomas         |&quot;</font><font color="#008080"><b>)
   </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;| 06. Consulta de Pa&iacute;ses          |&quot;</font><font color="#008080"><b>)
   </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;| 07. Consulta de Profiss&otilde;es      |&quot;</font><font color="#008080"><b>)
   </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;| 08. Consulta de Clientes        |&quot;</font><font color="#008080"><b>)
   </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;| 09. Consulta de Livros          |&quot;</font><font color="#008080"><b>)
   </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;| 10. Voltar ao menu              |&quot;</font><font color="#008080"><b>)
   </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;*---------------------------------*&quot;</font><font color="#008080"><b>)
 } </b></font><font color="#0000FF"><b>else if </b></font><font color="#008080"><b>(</b></font>num=4<font color="#008080"><b>) </b></font>then <font color="#008080"><b>{
   </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;*---------------------------------*&quot;</font><font color="#008080"><b>)
   </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;| 01. Vender Livros               |&quot;</font><font color="#008080"><b>)
   </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;| 02. Vendas Realizadas           |&quot;</font><font color="#008080"><b>)
   </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;| 03. Voltar ao menu              |&quot;</font><font color="#008080"><b>)
   </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;*---------------------------------*&quot;</font><font color="#008080"><b>)
 } </b></font><font color="#0000FF"><b>else if </b></font><font color="#008080"><b>(</b></font>num=5<font color="#008080"><b>) </b></font>then <font color="#008080"><b>{
   </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;*---------------------------------*&quot;</font><font color="#008080"><b>)
   </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;| 01. Alterar senha               |&quot;</font><font color="#008080"><b>)
   </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;| 02. Sobre o sistema             |&quot;</font><font color="#008080"><b>)
   </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;| 03. Sair do sistema             |&quot;</font><font color="#008080"><b>)
   </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;| 04. Voltar ao menu              |&quot;</font><font color="#008080"><b>)
   </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;*---------------------------------*&quot;</font><font color="#008080"><b>)
 } </b></font><font color="#0000FF"><b>else if </b></font><font color="#008080"><b>(</b></font>num=6<font color="#008080"><b>) </b></font>then <font color="#008080"><b>{
   </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;*--------------------------------------------------------------*&quot;</font><font color="#008080"><b>)
   </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;| (1) Novo  (2) Pesquisar   (3) Voltar ao menu                 |&quot;</font><font color="#008080"><b>)
   </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;*--------------------------------------------------------------*&quot;</font><font color="#008080"><b>)
 } </b></font><font color="#0000FF"><b>else if </b></font><font color="#008080"><b>(</b></font>num=7<font color="#008080"><b>) </b></font>then <font color="#008080"><b>{
   </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;*--------------------------------------------------------------*&quot;</font><font color="#008080"><b>)
   </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;| (1) Salvar inclus&atilde;o       (2) Voltar ao menu                 |&quot;</font><font color="#008080"><b>)
   </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;*--------------------------------------------------------------*&quot;</font><font color="#008080"><b>)
 } </b></font><font color="#0000FF"><b>else if </b></font><font color="#008080"><b>(</b></font>num=8<font color="#008080"><b>) </b></font>then <font color="#008080"><b>{
   </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;*--------------------------------------------------------------*&quot;</font><font color="#008080"><b>)
   </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;| (1) Alterar       (2) Excluir     (3) Voltar ao menu         |&quot;</font><font color="#008080"><b>)
   </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;*--------------------------------------------------------------*&quot;</font><font color="#008080"><b>)
 } </b></font><font color="#0000FF"><b>else if </b></font><font color="#008080"><b>(</b></font>num=9<font color="#008080"><b>) </b></font>then <font color="#008080"><b>{
   </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;*--------------------------------------------------------------*&quot;</font><font color="#008080"><b>)
   </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;| (1) Salvar altera&ccedil;&atilde;o      (2) Voltar ao menu                 |&quot;</font><font color="#008080"><b>)
   </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;*--------------------------------------------------------------*&quot;</font><font color="#008080"><b>)
 } </b></font><font color="#0000FF"><b>else if </b></font><font color="#008080"><b>(</b></font>num=10<font color="#008080"><b>) </b></font>then <font color="#008080"><b>{
   </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;*--------------------------------------------------------------*&quot;</font><font color="#008080"><b>)
   </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;| Certeza de excluir? (S/N)                                    |&quot;</font><font color="#008080"><b>)
   </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;*--------------------------------------------------------------*&quot;</font><font color="#008080"><b>)
 } </b></font><font color="#0000FF"><b>else if </b></font><font color="#008080"><b>(</b></font>num=11<font color="#008080"><b>) </b></font>then <font color="#008080"><b>{
   </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;*--------------------------------------------------------------*&quot;</font><font color="#008080"><b>)
   </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;| Deseja sair do sistema? (S/N)                                |&quot;</font><font color="#008080"><b>)
   </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;*--------------------------------------------------------------*&quot;</font><font color="#008080"><b>)
 } </b></font><font color="#0000FF"><b>else if </b></font><font color="#008080"><b>(</b></font>num=12<font color="#008080"><b>) </b></font>then <font color="#008080"><b>{
   </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;*--------------------------------------------------------------*&quot;</font><font color="#008080"><b>)
   </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;| (1) Pesquisar  (2) Listar todos   (3) Voltar ao menu         |&quot;</font><font color="#008080"><b>)
   </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;*--------------------------------------------------------------*&quot;</font><font color="#008080"><b>)
 } </b></font><font color="#0000FF"><b>else if </b></font><font color="#008080"><b>(</b></font>num=13<font color="#008080"><b>) </b></font>then <font color="#008080"><b>{
   </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;*--------------------------------------------------------------*&quot;</font><font color="#008080"><b>)
   </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;| Deseja continuar? (S/N)                                      |&quot;</font><font color="#008080"><b>)
   </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;*--------------------------------------------------------------*&quot;</font><font color="#008080"><b>)
 } </b></font><font color="#0000FF"><b>else if </b></font><font color="#008080"><b>(</b></font>num=14<font color="#008080"><b>) </b></font>then <font color="#008080"><b>{
   </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;*--------------------------------------------------------------*&quot;</font><font color="#008080"><b>)
   </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;| Salvar inclus&atilde;o (S/N)                                        |&quot;</font><font color="#008080"><b>)
   </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;*--------------------------------------------------------------*&quot;</font><font color="#008080"><b>)
 }
 </b></font>writes<font color="#008080"><b>(</b></font>MSG_OPCAO<font color="#008080"><b>)
</b></font><font color="#0000FF"><b>end
</b></font><font color="#808080">#------------------------------------------------------------------------------
# Realiza os cadastros de acordo com o tipo de arquivo.
# sreg - o tipo de arquivo
# sacao - a a&ccedil;&atilde;o a ser realizada
#------------------------------------------------------------------------------
</font>procedure frmCadastros<font color="#008080"><b>(</b></font>sreg, sacao<font color="#008080"><b>)
</b></font><font color="#800000"><b>local </b></font>slinha

<font color="#0000FF"><b>if </b></font>member<font color="#008080"><b>(</b></font>ctArqs, sreg<font color="#008080"><b>) </b></font>= opAssunto then <font color="#008080"><b>{
   </b></font><font color="#0000FF"><b>if </b></font>member<font color="#008080"><b>(</b></font>ctAcao, sacao<font color="#008080"><b>) </b></font>= opNovo then <font color="#008080"><b>{
      </b></font>tAssunto.codigo:=pesqMaxCod<font color="#008080"><b>(</b></font>tfAssunto, 1, 10, tamReg<font color="#008080"><b>(</b></font>sreg<font color="#008080"><b>))
      </b></font>mostrarDados<font color="#008080"><b>(</b></font>sreg, <font color="#800000">&quot;&quot;</font>, 1<font color="#008080"><b>)
      </b></font>subMenu<font color="#008080"><b>(7</b></font>, sreg<font color="#008080"><b>)
   } </b></font><font color="#0000FF"><b>else if </b></font>member<font color="#008080"><b>(</b></font>ctAcao, sacao<font color="#008080"><b>) </b></font>= opPesquisar then <font color="#008080"><b>{
     </b></font>slinha:=validaEntrada<font color="#008080"><b>(</b></font>tfAssunto,sreg,1,tAssunto.codigo,1,false,opNumero<font color="#008080"><b>)
      </b></font><font color="#0000FF"><b>if </b></font>slinha~==<font color="#800000">&quot;&quot; </font>then <font color="#008080"><b>{
        </b></font>mostrarDados<font color="#008080"><b>(</b></font>sreg, <font color="#800000">&quot;&quot;</font>, 2<font color="#008080"><b>)
        </b></font>mostrarDados<font color="#008080"><b>(</b></font>sreg, slinha, 3<font color="#008080"><b>)
        </b></font>subMenu<font color="#008080"><b>(8</b></font>, sreg<font color="#008080"><b>)
      }
   } </b></font><font color="#0000FF"><b>else if </b></font>member<font color="#008080"><b>(</b></font>ctAcao, sacao<font color="#008080"><b>) </b></font>= opAlterar then <font color="#008080"><b>{
      </b></font>mostrarDados<font color="#008080"><b>(</b></font>sreg, <font color="#800000">&quot;&quot;</font>, 1<font color="#008080"><b>)
      </b></font>subMenu<font color="#008080"><b>(9</b></font>, sreg<font color="#008080"><b>)
   } </b></font><font color="#0000FF"><b>else if </b></font>member<font color="#008080"><b>(</b></font>ctAcao, sacao<font color="#008080"><b>) </b></font>= opExcluir then <font color="#008080"><b>{
      </b></font>subMenu<font color="#008080"><b>(10</b></font>, sreg<font color="#008080"><b>)
   }
} </b></font><font color="#0000FF"><b>else if </b></font>member<font color="#008080"><b>(</b></font>ctArqs, sreg<font color="#008080"><b>) </b></font>= opAutor then <font color="#008080"><b>{
   </b></font><font color="#0000FF"><b>if </b></font>member<font color="#008080"><b>(</b></font>ctAcao, sacao<font color="#008080"><b>) </b></font>= opNovo then <font color="#008080"><b>{
      </b></font>tAutor.codigo:=pesqMaxCod<font color="#008080"><b>(</b></font>tfAutor, 1, 10, tamReg<font color="#008080"><b>(</b></font>sreg<font color="#008080"><b>))
      </b></font>mostrarDados<font color="#008080"><b>(</b></font>sreg, <font color="#800000">&quot;&quot;</font>, 1<font color="#008080"><b>)
      </b></font>subMenu<font color="#008080"><b>(7</b></font>, sreg<font color="#008080"><b>)
   } </b></font><font color="#0000FF"><b>else if </b></font>member<font color="#008080"><b>(</b></font>ctAcao, sacao<font color="#008080"><b>) </b></font>= opPesquisar then <font color="#008080"><b>{
      </b></font>slinha:=validaEntrada<font color="#008080"><b>(</b></font>tfAutor, sreg, 1, tAutor.codigo,1,false,opNumero<font color="#008080"><b>)
      </b></font><font color="#0000FF"><b>if </b></font>slinha~==<font color="#800000">&quot;&quot; </font>then <font color="#008080"><b>{
        </b></font>mostrarDados<font color="#008080"><b>(</b></font>sreg, <font color="#800000">&quot;&quot;</font>, 2<font color="#008080"><b>)
        </b></font>mostrarDados<font color="#008080"><b>(</b></font>sreg, slinha, 3<font color="#008080"><b>)
        </b></font>subMenu<font color="#008080"><b>(8</b></font>, sreg<font color="#008080"><b>)
      }
   } </b></font><font color="#0000FF"><b>else if </b></font>member<font color="#008080"><b>(</b></font>ctAcao, sacao<font color="#008080"><b>) </b></font>= opAlterar then <font color="#008080"><b>{
      </b></font>mostrarDados<font color="#008080"><b>(</b></font>sreg, <font color="#800000">&quot;&quot;</font>, 1<font color="#008080"><b>)
      </b></font>subMenu<font color="#008080"><b>(9</b></font>, sreg<font color="#008080"><b>)
   } </b></font><font color="#0000FF"><b>else if </b></font>member<font color="#008080"><b>(</b></font>ctAcao, sacao<font color="#008080"><b>) </b></font>= opExcluir then <font color="#008080"><b>{
      </b></font>subMenu<font color="#008080"><b>(10</b></font>, sreg<font color="#008080"><b>)
   }
} </b></font><font color="#0000FF"><b>else if </b></font>member<font color="#008080"><b>(</b></font>ctArqs, sreg<font color="#008080"><b>) </b></font>= opEditora then <font color="#008080"><b>{
   </b></font><font color="#0000FF"><b>if </b></font>member<font color="#008080"><b>(</b></font>ctAcao, sacao<font color="#008080"><b>) </b></font>= opNovo then <font color="#008080"><b>{
      </b></font>tEditora.codigo:=pesqMaxCod<font color="#008080"><b>(</b></font>tfEditora, 1, 10, tamReg<font color="#008080"><b>(</b></font>sreg<font color="#008080"><b>))
      </b></font>mostrarDados<font color="#008080"><b>(</b></font>sreg, <font color="#800000">&quot;&quot;</font>, 1<font color="#008080"><b>)
      </b></font>subMenu<font color="#008080"><b>(7</b></font>, sreg<font color="#008080"><b>)
   } </b></font><font color="#0000FF"><b>else if </b></font>member<font color="#008080"><b>(</b></font>ctAcao, sacao<font color="#008080"><b>) </b></font>= opPesquisar then <font color="#008080"><b>{
     </b></font>slinha:=validaEntrada<font color="#008080"><b>(</b></font>tfEditora,sreg,1,tEditora.codigo,1,false,opNumero<font color="#008080"><b>)
      </b></font><font color="#0000FF"><b>if </b></font>slinha~==<font color="#800000">&quot;&quot; </font>then <font color="#008080"><b>{
        </b></font>mostrarDados<font color="#008080"><b>(</b></font>sreg, <font color="#800000">&quot;&quot;</font>, 2<font color="#008080"><b>)
        </b></font>mostrarDados<font color="#008080"><b>(</b></font>sreg, slinha, 3<font color="#008080"><b>)
        </b></font>subMenu<font color="#008080"><b>(8</b></font>, sreg<font color="#008080"><b>)
      }
   } </b></font><font color="#0000FF"><b>else if </b></font>member<font color="#008080"><b>(</b></font>ctAcao, sacao<font color="#008080"><b>) </b></font>= opAlterar then <font color="#008080"><b>{
      </b></font>mostrarDados<font color="#008080"><b>(</b></font>sreg, <font color="#800000">&quot;&quot;</font>, 1<font color="#008080"><b>)
      </b></font>subMenu<font color="#008080"><b>(9</b></font>, sreg<font color="#008080"><b>)
   } </b></font><font color="#0000FF"><b>else if </b></font>member<font color="#008080"><b>(</b></font>ctAcao, sacao<font color="#008080"><b>) </b></font>= opExcluir then <font color="#008080"><b>{
      </b></font>subMenu<font color="#008080"><b>(10</b></font>, sreg<font color="#008080"><b>)
   }
} </b></font><font color="#0000FF"><b>else if </b></font>member<font color="#008080"><b>(</b></font>ctArqs, sreg<font color="#008080"><b>) </b></font>= opEndereco then <font color="#008080"><b>{
   </b></font><font color="#0000FF"><b>if </b></font>member<font color="#008080"><b>(</b></font>ctAcao, sacao<font color="#008080"><b>) </b></font>= opNovo then <font color="#008080"><b>{
      </b></font>tEndereco.codigo:=pesqMaxCod<font color="#008080"><b>(</b></font>tfEndereco, 1, 10, tamReg<font color="#008080"><b>(</b></font>sreg<font color="#008080"><b>))
      </b></font>mostrarDados<font color="#008080"><b>(</b></font>sreg, <font color="#800000">&quot;&quot;</font>, 1<font color="#008080"><b>)
      </b></font>subMenu<font color="#008080"><b>(7</b></font>, sreg<font color="#008080"><b>)
   } </b></font><font color="#0000FF"><b>else if </b></font>member<font color="#008080"><b>(</b></font>ctAcao, sacao<font color="#008080"><b>) </b></font>= opPesquisar then <font color="#008080"><b>{
      </b></font>slinha:=validaEntrada<font color="#008080"><b>(</b></font>tfEndereco,sreg,1,tEndereco.codigo,1,
              false,opNumero<font color="#008080"><b>)
      </b></font><font color="#0000FF"><b>if </b></font>slinha~==<font color="#800000">&quot;&quot; </font>then <font color="#008080"><b>{
        </b></font>mostrarDados<font color="#008080"><b>(</b></font>sreg, <font color="#800000">&quot;&quot;</font>, 2<font color="#008080"><b>)
        </b></font>mostrarDados<font color="#008080"><b>(</b></font>sreg, slinha, 3<font color="#008080"><b>)
        </b></font>subMenu<font color="#008080"><b>(8</b></font>, sreg<font color="#008080"><b>)
      }
   } </b></font><font color="#0000FF"><b>else if </b></font>member<font color="#008080"><b>(</b></font>ctAcao, sacao<font color="#008080"><b>) </b></font>= opAlterar then <font color="#008080"><b>{
      </b></font>mostrarDados<font color="#008080"><b>(</b></font>sreg, <font color="#800000">&quot;&quot;</font>, 1<font color="#008080"><b>)
      </b></font>subMenu<font color="#008080"><b>(9</b></font>, sreg<font color="#008080"><b>)
   } </b></font><font color="#0000FF"><b>else if </b></font>member<font color="#008080"><b>(</b></font>ctAcao, sacao<font color="#008080"><b>) </b></font>= opExcluir then <font color="#008080"><b>{
      </b></font>subMenu<font color="#008080"><b>(10</b></font>, sreg<font color="#008080"><b>)
   }
} </b></font><font color="#0000FF"><b>else if </b></font>member<font color="#008080"><b>(</b></font>ctArqs, sreg<font color="#008080"><b>) </b></font>= opIdioma then <font color="#008080"><b>{
   </b></font><font color="#0000FF"><b>if </b></font>member<font color="#008080"><b>(</b></font>ctAcao, sacao<font color="#008080"><b>) </b></font>= opNovo then <font color="#008080"><b>{
      </b></font>tIdioma.codigo:=pesqMaxCod<font color="#008080"><b>(</b></font>tfIdioma, 1, 10, tamReg<font color="#008080"><b>(</b></font>sreg<font color="#008080"><b>))
      </b></font>mostrarDados<font color="#008080"><b>(</b></font>sreg, <font color="#800000">&quot;&quot;</font>, 1<font color="#008080"><b>)
      </b></font>subMenu<font color="#008080"><b>(7</b></font>, sreg<font color="#008080"><b>)
   } </b></font><font color="#0000FF"><b>else if </b></font>member<font color="#008080"><b>(</b></font>ctAcao, sacao<font color="#008080"><b>) </b></font>= opPesquisar then <font color="#008080"><b>{
      </b></font>slinha:=validaEntrada<font color="#008080"><b>(</b></font>tfIdioma,sreg,1,tIdioma.codigo,1,false,opNumero<font color="#008080"><b>)
      </b></font><font color="#0000FF"><b>if </b></font>slinha~==<font color="#800000">&quot;&quot; </font>then <font color="#008080"><b>{
        </b></font>mostrarDados<font color="#008080"><b>(</b></font>sreg, <font color="#800000">&quot;&quot;</font>, 2<font color="#008080"><b>)
        </b></font>mostrarDados<font color="#008080"><b>(</b></font>sreg, slinha, 3<font color="#008080"><b>)
        </b></font>subMenu<font color="#008080"><b>(8</b></font>, sreg<font color="#008080"><b>)
      }
   } </b></font><font color="#0000FF"><b>else if </b></font>member<font color="#008080"><b>(</b></font>ctAcao, sacao<font color="#008080"><b>) </b></font>= opAlterar then <font color="#008080"><b>{
      </b></font>mostrarDados<font color="#008080"><b>(</b></font>sreg, <font color="#800000">&quot;&quot;</font>, 1<font color="#008080"><b>)
      </b></font>subMenu<font color="#008080"><b>(9</b></font>, sreg<font color="#008080"><b>)
   } </b></font><font color="#0000FF"><b>else if </b></font>member<font color="#008080"><b>(</b></font>ctAcao, sacao<font color="#008080"><b>) </b></font>= opExcluir then <font color="#008080"><b>{
      </b></font>subMenu<font color="#008080"><b>(10</b></font>, sreg<font color="#008080"><b>)
   }
} </b></font><font color="#0000FF"><b>else if </b></font>member<font color="#008080"><b>(</b></font>ctArqs, sreg<font color="#008080"><b>) </b></font>= opPais then <font color="#008080"><b>{
   </b></font><font color="#0000FF"><b>if </b></font>member<font color="#008080"><b>(</b></font>ctAcao, sacao<font color="#008080"><b>) </b></font>= opNovo then <font color="#008080"><b>{
      </b></font>writes<font color="#008080"><b>(</b></font>rotulo<font color="#008080"><b>(</b></font>sreg, 1<font color="#008080"><b>))
      </b></font>tPais.codigo:=<font color="#800000"><b>read</b></font><font color="#008080"><b>()
      </b></font>slinha:=pesqArq<font color="#008080"><b>(</b></font>tfPais, tPais.codigo, 1, 3, tamReg<font color="#008080"><b>(</b></font>sreg<font color="#008080"><b>))
      </b></font><font color="#0000FF"><b>if </b></font>slinha=<font color="#800000">&quot;&quot; </font>then <font color="#008080"><b>{
         </b></font>pesqLinhaExcluida<font color="#008080"><b>(</b></font>tfPais, tamReg<font color="#008080"><b>(</b></font>sreg<font color="#008080"><b>))
         </b></font>mostrarDados<font color="#008080"><b>(</b></font>sreg, <font color="#800000">&quot;&quot;</font>, 1<font color="#008080"><b>)
         </b></font>subMenu<font color="#008080"><b>(7</b></font>, sreg<font color="#008080"><b>)
      } </b></font><font color="#0000FF"><b>else </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font>MSG_REGEXST<font color="#008080"><b>)
   } </b></font><font color="#0000FF"><b>else if </b></font>member<font color="#008080"><b>(</b></font>ctAcao, sacao<font color="#008080"><b>) </b></font>= opPesquisar then <font color="#008080"><b>{
      </b></font>slinha:=validaEntrada<font color="#008080"><b>(</b></font>tfPais, sreg, 1, tPais.codigo, 1, false, opTexto<font color="#008080"><b>)
      </b></font><font color="#0000FF"><b>if </b></font>slinha~==<font color="#800000">&quot;&quot; </font>then <font color="#008080"><b>{
        </b></font>mostrarDados<font color="#008080"><b>(</b></font>sreg, <font color="#800000">&quot;&quot;</font>, 2<font color="#008080"><b>)
        </b></font>mostrarDados<font color="#008080"><b>(</b></font>sreg, slinha, 3<font color="#008080"><b>)
        </b></font>subMenu<font color="#008080"><b>(8</b></font>, sreg<font color="#008080"><b>)
      }
   } </b></font><font color="#0000FF"><b>else if </b></font>member<font color="#008080"><b>(</b></font>ctAcao, sacao<font color="#008080"><b>) </b></font>= opAlterar then <font color="#008080"><b>{
      </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font>rotulo<font color="#008080"><b>(</b></font>sreg, 1<font color="#008080"><b>) </b></font>|| tPais.codigo<font color="#008080"><b>)
      </b></font>mostrarDados<font color="#008080"><b>(</b></font>sreg, <font color="#800000">&quot;&quot;</font>, 1<font color="#008080"><b>)
      </b></font>subMenu<font color="#008080"><b>(9</b></font>, sreg<font color="#008080"><b>)
   } </b></font><font color="#0000FF"><b>else if </b></font>member<font color="#008080"><b>(</b></font>ctAcao, sacao<font color="#008080"><b>) </b></font>= opExcluir then <font color="#008080"><b>{
      </b></font>subMenu<font color="#008080"><b>(10</b></font>, sreg<font color="#008080"><b>)
   }
} </b></font><font color="#0000FF"><b>else if </b></font>member<font color="#008080"><b>(</b></font>ctArqs, sreg<font color="#008080"><b>) </b></font>= opProfissao then <font color="#008080"><b>{
   </b></font><font color="#0000FF"><b>if </b></font>member<font color="#008080"><b>(</b></font>ctAcao, sacao<font color="#008080"><b>) </b></font>= opNovo then <font color="#008080"><b>{
      </b></font>tProfissao.codigo:=pesqMaxCod<font color="#008080"><b>(</b></font>tfProfissao, 1, 10, tamReg<font color="#008080"><b>(</b></font>sreg<font color="#008080"><b>))
      </b></font>mostrarDados<font color="#008080"><b>(</b></font>sreg, <font color="#800000">&quot;&quot;</font>, 1<font color="#008080"><b>)
      </b></font>subMenu<font color="#008080"><b>(7</b></font>, sreg<font color="#008080"><b>)
   } </b></font><font color="#0000FF"><b>else if </b></font>member<font color="#008080"><b>(</b></font>ctAcao, sacao<font color="#008080"><b>) </b></font>= opPesquisar then <font color="#008080"><b>{
      </b></font>slinha:=validaEntrada<font color="#008080"><b>(</b></font>tfProfissao,sreg,1,tProfissao.codigo,1,
              false,opNumero<font color="#008080"><b>)
      </b></font><font color="#0000FF"><b>if </b></font>slinha~==<font color="#800000">&quot;&quot; </font>then <font color="#008080"><b>{
        </b></font>mostrarDados<font color="#008080"><b>(</b></font>sreg, <font color="#800000">&quot;&quot;</font>, 2<font color="#008080"><b>)
        </b></font>mostrarDados<font color="#008080"><b>(</b></font>sreg, slinha, 3<font color="#008080"><b>)
        </b></font>subMenu<font color="#008080"><b>(8</b></font>, sreg<font color="#008080"><b>)
      }
   } </b></font><font color="#0000FF"><b>else if </b></font>member<font color="#008080"><b>(</b></font>ctAcao, sacao<font color="#008080"><b>) </b></font>= opAlterar then <font color="#008080"><b>{
      </b></font>mostrarDados<font color="#008080"><b>(</b></font>sreg, <font color="#800000">&quot;&quot;</font>, 1<font color="#008080"><b>)
      </b></font>subMenu<font color="#008080"><b>(9</b></font>, sreg<font color="#008080"><b>)
   } </b></font><font color="#0000FF"><b>else if </b></font>member<font color="#008080"><b>(</b></font>ctAcao, sacao<font color="#008080"><b>) </b></font>= opExcluir then <font color="#008080"><b>{
      </b></font>subMenu<font color="#008080"><b>(10</b></font>, sreg<font color="#008080"><b>)
   }
} </b></font><font color="#0000FF"><b>else if </b></font>member<font color="#008080"><b>(</b></font>ctArqs, sreg<font color="#008080"><b>) </b></font>= opLivro then <font color="#008080"><b>{
   </b></font><font color="#0000FF"><b>if </b></font>member<font color="#008080"><b>(</b></font>ctAcao, sacao<font color="#008080"><b>) </b></font>= opNovo then <font color="#008080"><b>{
      </b></font>writes<font color="#008080"><b>(</b></font>rotulo<font color="#008080"><b>(</b></font>sreg, 1<font color="#008080"><b>))
      </b></font>tLivro.isbn:=<font color="#800000"><b>read</b></font><font color="#008080"><b>()
      </b></font><font color="#0000FF"><b>if </b></font>validaISBN<font color="#008080"><b>(</b></font>tLivro.isbn<font color="#008080"><b>)</b></font>=true then <font color="#008080"><b>{
          </b></font>slinha:=pesqArq<font color="#008080"><b>(</b></font>tfLivro, tLivro.isbn, 1, 13, tamReg<font color="#008080"><b>(</b></font>sreg<font color="#008080"><b>))
          </b></font><font color="#0000FF"><b>if </b></font>slinha=<font color="#800000">&quot;&quot; </font>then <font color="#008080"><b>{
             </b></font>pesqLinhaExcluida<font color="#008080"><b>(</b></font>tfLivro, tamReg<font color="#008080"><b>(</b></font>sreg<font color="#008080"><b>))
             </b></font>mostrarDados<font color="#008080"><b>(</b></font>sreg, <font color="#800000">&quot;&quot;</font>, 1<font color="#008080"><b>)
             </b></font>subMenu<font color="#008080"><b>(7</b></font>, sreg<font color="#008080"><b>)
             </b></font>frmCadLigados<font color="#008080"><b>(</b></font>opLivroAss, opNovo, tLivro.isbn<font color="#008080"><b>)
             </b></font>frmCadLigados<font color="#008080"><b>(</b></font>opLivroAut, opNovo, tLivro.isbn<font color="#008080"><b>)
          } </b></font><font color="#0000FF"><b>else </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font>MSG_REGEXST<font color="#008080"><b>)
      } </b></font><font color="#0000FF"><b>else </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font>MSG_ISBNINV<font color="#008080"><b>)
   } </b></font><font color="#0000FF"><b>else if </b></font>member<font color="#008080"><b>(</b></font>ctAcao, sacao<font color="#008080"><b>) </b></font>= opPesquisar then <font color="#008080"><b>{
      </b></font>slinha:=validaEntrada<font color="#008080"><b>(</b></font>tfLivro, sreg, 1, tLivro.isbn, 1,false,opTexto<font color="#008080"><b>)
      </b></font><font color="#0000FF"><b>if </b></font>slinha~==<font color="#800000">&quot;&quot; </font>then <font color="#008080"><b>{
         </b></font>mostrarDados<font color="#008080"><b>(</b></font>sreg, <font color="#800000">&quot;&quot;</font>, 2<font color="#008080"><b>)
         </b></font>mostrarDados<font color="#008080"><b>(</b></font>sreg, slinha, 3<font color="#008080"><b>)
         </b></font>subMenu<font color="#008080"><b>(8</b></font>, sreg<font color="#008080"><b>)
      }
   } </b></font><font color="#0000FF"><b>else if </b></font>member<font color="#008080"><b>(</b></font>ctAcao, sacao<font color="#008080"><b>) </b></font>= opAlterar then <font color="#008080"><b>{
      </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font>rotulo<font color="#008080"><b>(</b></font>sreg, 1<font color="#008080"><b>)</b></font>, tLivro.isbn<font color="#008080"><b>)
      </b></font>mostrarDados<font color="#008080"><b>(</b></font>sreg, <font color="#800000">&quot;&quot;</font>, 1<font color="#008080"><b>)
      </b></font>subMenu<font color="#008080"><b>(9</b></font>, sreg<font color="#008080"><b>)
      </b></font>frmCadLigados<font color="#008080"><b>(</b></font>opLivroAss, opExcluir, tLivro.isbn<font color="#008080"><b>)
      </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;Assuntos dos livros exclu&iacute;dos, inclua novos!&quot;</font><font color="#008080"><b>)
      </b></font>frmCadLigados<font color="#008080"><b>(</b></font>opLivroAss, opNovo, tLivro.isbn<font color="#008080"><b>)
      </b></font>frmCadLigados<font color="#008080"><b>(</b></font>opLivroAut, opExcluir, tLivro.isbn<font color="#008080"><b>)
      </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;Autores dos livros exclu&iacute;dos, inclua novos!&quot;</font><font color="#008080"><b>)
      </b></font>frmCadLigados<font color="#008080"><b>(</b></font>opLivroAut, opNovo, tLivro.isbn<font color="#008080"><b>)
   } </b></font><font color="#0000FF"><b>else if </b></font>member<font color="#008080"><b>(</b></font>ctAcao, sacao<font color="#008080"><b>) </b></font>= opExcluir then <font color="#008080"><b>{
      </b></font>subMenu<font color="#008080"><b>(10</b></font>, sreg<font color="#008080"><b>)
      </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;Assuntos dos livros sendo exclu&iacute;dos!&quot;</font><font color="#008080"><b>)
      </b></font>frmCadLigados<font color="#008080"><b>(</b></font>opLivroAss, opExcluir, tLivro.isbn<font color="#008080"><b>)
      </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;Autores dos livros sendo exclu&iacute;dos!&quot;</font><font color="#008080"><b>)
      </b></font>frmCadLigados<font color="#008080"><b>(</b></font>opLivroAut, opExcluir, tLivro.isbn<font color="#008080"><b>)
   }
} </b></font><font color="#0000FF"><b>else if </b></font>member<font color="#008080"><b>(</b></font>ctArqs, sreg<font color="#008080"><b>) </b></font>= opCliente then <font color="#008080"><b>{
   </b></font><font color="#0000FF"><b>if </b></font>member<font color="#008080"><b>(</b></font>ctAcao, sacao<font color="#008080"><b>) </b></font>= opNovo then <font color="#008080"><b>{
      </b></font>writes<font color="#008080"><b>(</b></font>rotulo<font color="#008080"><b>(</b></font>sreg, 1<font color="#008080"><b>))
      </b></font>tCliente.cpf:=<font color="#800000"><b>read</b></font><font color="#008080"><b>()
      </b></font><font color="#0000FF"><b>if </b></font>validaCPF<font color="#008080"><b>(</b></font>tCliente.cpf<font color="#008080"><b>) </b></font>then <font color="#008080"><b>{
          </b></font>slinha:=pesqArq<font color="#008080"><b>(</b></font>tfCliente, tCliente.cpf, 1, 14, tamReg<font color="#008080"><b>(</b></font>sreg<font color="#008080"><b>))
          </b></font><font color="#0000FF"><b>if </b></font>slinha=<font color="#800000">&quot;&quot; </font>then <font color="#008080"><b>{
             </b></font>pesqLinhaExcluida<font color="#008080"><b>(</b></font>tfCliente, tamReg<font color="#008080"><b>(</b></font>sreg<font color="#008080"><b>))
             </b></font>mostrarDados<font color="#008080"><b>(</b></font>sreg, <font color="#800000">&quot;&quot;</font>, 1<font color="#008080"><b>)
             </b></font>subMenu<font color="#008080"><b>(7</b></font>, sreg<font color="#008080"><b>)
          } </b></font><font color="#0000FF"><b>else </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font>MSG_REGEXST<font color="#008080"><b>)
      } </b></font><font color="#0000FF"><b>else </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font>MSG_CPFINV<font color="#008080"><b>)
   } </b></font><font color="#0000FF"><b>else if </b></font>member<font color="#008080"><b>(</b></font>ctAcao, sacao<font color="#008080"><b>) </b></font>= opPesquisar then <font color="#008080"><b>{
      </b></font>slinha:=validaEntrada<font color="#008080"><b>(</b></font>tfCliente, sreg, 1, tCliente.cpf,1,false,opTexto<font color="#008080"><b>)
      </b></font><font color="#0000FF"><b>if </b></font>slinha~==<font color="#800000">&quot;&quot; </font>then <font color="#008080"><b>{
         </b></font>mostrarDados<font color="#008080"><b>(</b></font>sreg, <font color="#800000">&quot;&quot;</font>, 2<font color="#008080"><b>)
         </b></font>mostrarDados<font color="#008080"><b>(</b></font>sreg, slinha, 3<font color="#008080"><b>)
         </b></font>subMenu<font color="#008080"><b>(8</b></font>, sreg<font color="#008080"><b>)
      }
   } </b></font><font color="#0000FF"><b>else if </b></font>member<font color="#008080"><b>(</b></font>ctAcao, sacao<font color="#008080"><b>) </b></font>= opAlterar then <font color="#008080"><b>{
      </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font>rotulo<font color="#008080"><b>(</b></font>sreg, 1<font color="#008080"><b>) </b></font>|| tCliente.cpf<font color="#008080"><b>)
      </b></font>mostrarDados<font color="#008080"><b>(</b></font>sreg, <font color="#800000">&quot;&quot;</font>, 1<font color="#008080"><b>)
      </b></font>subMenu<font color="#008080"><b>(9</b></font>, sreg<font color="#008080"><b>)
   } </b></font><font color="#0000FF"><b>else if </b></font>member<font color="#008080"><b>(</b></font>ctAcao, sacao<font color="#008080"><b>) </b></font>= opExcluir then <font color="#008080"><b>{
      </b></font>subMenu<font color="#008080"><b>(10</b></font>, sreg<font color="#008080"><b>)
   }
} </b></font><font color="#0000FF"><b>else if </b></font>member<font color="#008080"><b>(</b></font>ctArqs, sreg<font color="#008080"><b>) </b></font>= opVenda then <font color="#008080"><b>{
   </b></font><font color="#0000FF"><b>if </b></font>member<font color="#008080"><b>(</b></font>ctAcao, sacao<font color="#008080"><b>) </b></font>= opNovo then <font color="#008080"><b>{
      </b></font>tVenda.dthrvenda:=retDataHora<font color="#008080"><b>()
      </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font>rotulo<font color="#008080"><b>(</b></font>sreg, 1<font color="#008080"><b>) </b></font>|| tVenda.dthrvenda<font color="#008080"><b>)
      </b></font>slinha:=pesqArq<font color="#008080"><b>(</b></font>tfVenda, tVenda.dthrvenda, 1, 19, tamReg<font color="#008080"><b>(</b></font>sreg<font color="#008080"><b>))
      </b></font><font color="#0000FF"><b>if </b></font>slinha==<font color="#800000">&quot;&quot; </font>then <font color="#008080"><b>{
         </b></font>slinha:=validaEntrada<font color="#008080"><b>(</b></font>tfCliente,opCliente,1,tVenda.cpf,3,
                 false,opTexto<font color="#008080"><b>)
         </b></font><font color="#0000FF"><b>if </b></font>slinha~==<font color="#800000">&quot;&quot; </font>then <font color="#008080"><b>{
            </b></font>tVenda.cpf:=trim<font color="#008080"><b>(</b></font>substr<font color="#008080"><b>(</b></font>slinha,1,14<font color="#008080"><b>))
            </b></font><font color="#0000FF"><b>if </b></font>validaCPF<font color="#008080"><b>(</b></font>tVenda.cpf<font color="#008080"><b>)</b></font>=true then <font color="#008080"><b>{
               </b></font>writes<font color="#008080"><b>(</b></font><font color="#800000">&quot; &quot; </font>|| rotulo<font color="#008080"><b>(</b></font>opCliente, 2<font color="#008080"><b>)) </b></font><font color="#808080"># Nome 
               </font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font>substr<font color="#008080"><b>(</b></font>slinha, g_nPosChave, g_nTamChave<font color="#008080"><b>))
               </b></font>frmCadLigados<font color="#008080"><b>(</b></font>opVenda, opNovo, tVenda.cpf<font color="#008080"><b>)
            } </b></font><font color="#0000FF"><b>else </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font>MSG_CPFINV<font color="#008080"><b>)
         }
      } </b></font><font color="#0000FF"><b>else </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font>MSG_REGEXST<font color="#008080"><b>)
   } </b></font><font color="#0000FF"><b>else if </b></font>member<font color="#008080"><b>(</b></font>ctAcao, sacao<font color="#008080"><b>) </b></font>= opPesquisar then <font color="#008080"><b>{
      </b></font>slinha:=validaEntrada<font color="#008080"><b>(</b></font>tfVenda, sreg, 1, tVenda.dthrvenda,1,
              false,opDataHora<font color="#008080"><b>)
      </b></font><font color="#0000FF"><b>if </b></font>slinha~==<font color="#800000">&quot;&quot; </font>then <font color="#008080"><b>{
        </b></font>mostrarDados<font color="#008080"><b>(</b></font>sreg, <font color="#800000">&quot;&quot;</font>, 2<font color="#008080"><b>)
        </b></font>mostrarDados<font color="#008080"><b>(</b></font>sreg, slinha, 3<font color="#008080"><b>)
        </b></font>subMenu<font color="#008080"><b>(8</b></font>, sreg<font color="#008080"><b>)
      }
   }
}
</b></font><font color="#0000FF"><b>end
</b></font><font color="#808080">#------------------------------------------------------------------------------
# Realiza as consultas de acordo com o tipo de arquivo.
# sreg - o tipo de arquivo
# sacao - a a&ccedil;&atilde;o a ser realizada
#------------------------------------------------------------------------------
</font>procedure frmConsultas<font color="#008080"><b>(</b></font>sreg, sacao<font color="#008080"><b>)
</b></font><font color="#800000"><b>local </b></font>slinha

slinha:=<font color="#800000">&quot;&quot;
</font><font color="#0000FF"><b>if </b></font>member<font color="#008080"><b>(</b></font>ctArqs, sreg<font color="#008080"><b>) </b></font>= opAssunto then <font color="#008080"><b>{
   </b></font><font color="#0000FF"><b>if </b></font>member<font color="#008080"><b>(</b></font>ctAcao, sacao<font color="#008080"><b>) </b></font>= opPesquisar then
      slinha:=validaEntrada<font color="#008080"><b>(</b></font>tfAssunto,sreg,2,tAssunto.assunto,1,true,opTexto<font color="#008080"><b>)
   </b></font><font color="#0000FF"><b>else if </b></font>member<font color="#008080"><b>(</b></font>ctAcao, sacao<font color="#008080"><b>) </b></font>= opListarTodos then <font color="#008080"><b>{
      </b></font><font color="#0000FF"><b>if </b></font>ListarTodos<font color="#008080"><b>(</b></font>tfAssunto, sreg, <font color="#800000">&quot;&quot;</font>, 0, 0, tamReg<font color="#008080"><b>(</b></font>sreg<font color="#008080"><b>)</b></font>,
        QTD_MAX_LINHA, false<font color="#008080"><b>) </b></font>= false then
        <font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font>rotulo<font color="#008080"><b>(</b></font>sreg, 0<font color="#008080"><b>))
   }
} </b></font><font color="#0000FF"><b>else if </b></font>member<font color="#008080"><b>(</b></font>ctArqs, sreg<font color="#008080"><b>) </b></font>= opAutor then <font color="#008080"><b>{
   </b></font><font color="#0000FF"><b>if </b></font>member<font color="#008080"><b>(</b></font>ctAcao, sacao<font color="#008080"><b>) </b></font>= opPesquisar then
      slinha:=validaEntrada<font color="#008080"><b>(</b></font>tfAutor,sreg, 2, tAutor.autor, 1, true,opTexto<font color="#008080"><b>)
   </b></font><font color="#0000FF"><b>else if </b></font>member<font color="#008080"><b>(</b></font>ctAcao, sacao<font color="#008080"><b>) </b></font>= opListarTodos then <font color="#008080"><b>{
      </b></font><font color="#0000FF"><b>if </b></font>ListarTodos<font color="#008080"><b>(</b></font>tfAutor, sreg, <font color="#800000">&quot;&quot;</font>, 0, 0, tamReg<font color="#008080"><b>(</b></font>sreg<font color="#008080"><b>)</b></font>,
        QTD_MAX_LINHA, false<font color="#008080"><b>) </b></font>= false then
        <font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font>rotulo<font color="#008080"><b>(</b></font>sreg, 0<font color="#008080"><b>))
   }
} </b></font><font color="#0000FF"><b>else if </b></font>member<font color="#008080"><b>(</b></font>ctArqs, sreg<font color="#008080"><b>) </b></font>= opEditora then <font color="#008080"><b>{
   </b></font><font color="#0000FF"><b>if </b></font>member<font color="#008080"><b>(</b></font>ctAcao, sacao<font color="#008080"><b>) </b></font>= opPesquisar then
      slinha:=validaEntrada<font color="#008080"><b>(</b></font>tfEditora,sreg,2,tEditora.editora,1,true,opTexto<font color="#008080"><b>)
   </b></font><font color="#0000FF"><b>else if </b></font>member<font color="#008080"><b>(</b></font>ctAcao, sacao<font color="#008080"><b>) </b></font>= opListarTodos then <font color="#008080"><b>{
      </b></font><font color="#0000FF"><b>if </b></font>ListarTodos<font color="#008080"><b>(</b></font>tfEditora, sreg, <font color="#800000">&quot;&quot;</font>, 0, 0, tamReg<font color="#008080"><b>(</b></font>sreg<font color="#008080"><b>)</b></font>,
        QTD_MAX_LINHA, false<font color="#008080"><b>) </b></font>= false then
        <font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font>rotulo<font color="#008080"><b>(</b></font>sreg, 0<font color="#008080"><b>))
   }
} </b></font><font color="#0000FF"><b>else if </b></font>member<font color="#008080"><b>(</b></font>ctArqs, sreg<font color="#008080"><b>) </b></font>= opEndereco then <font color="#008080"><b>{
   </b></font><font color="#0000FF"><b>if </b></font>member<font color="#008080"><b>(</b></font>ctAcao, sacao<font color="#008080"><b>) </b></font>= opPesquisar then
      slinha:=validaEntrada<font color="#008080"><b>(</b></font>tfEndereco,sreg,2,tEndereco.Logradouro,1,
              true,opTexto<font color="#008080"><b>)
   </b></font><font color="#0000FF"><b>else if </b></font>member<font color="#008080"><b>(</b></font>ctAcao, sacao<font color="#008080"><b>) </b></font>= opListarTodos then <font color="#008080"><b>{
      </b></font><font color="#0000FF"><b>if </b></font>ListarTodos<font color="#008080"><b>(</b></font>tfEndereco, sreg, <font color="#800000">&quot;&quot;</font>, 0, 0, tamReg<font color="#008080"><b>(</b></font>sreg<font color="#008080"><b>)</b></font>,
         3, false<font color="#008080"><b>) </b></font>= false then
        <font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font>rotulo<font color="#008080"><b>(</b></font>sreg, 0<font color="#008080"><b>))
   }
} </b></font><font color="#0000FF"><b>else if </b></font>member<font color="#008080"><b>(</b></font>ctArqs, sreg<font color="#008080"><b>) </b></font>= opIdioma then <font color="#008080"><b>{
   </b></font><font color="#0000FF"><b>if </b></font>member<font color="#008080"><b>(</b></font>ctAcao, sacao<font color="#008080"><b>) </b></font>= opPesquisar then
      slinha:=validaEntrada<font color="#008080"><b>(</b></font>tfIdioma, sreg, 2, tIdioma.idioma,1,true,opTexto<font color="#008080"><b>)
   </b></font><font color="#0000FF"><b>else if </b></font>member<font color="#008080"><b>(</b></font>ctAcao, sacao<font color="#008080"><b>) </b></font>= opListarTodos then <font color="#008080"><b>{
      </b></font><font color="#0000FF"><b>if </b></font>ListarTodos<font color="#008080"><b>(</b></font>tfIdioma, sreg, <font color="#800000">&quot;&quot;</font>, 0, 0, tamReg<font color="#008080"><b>(</b></font>sreg<font color="#008080"><b>)</b></font>,
        QTD_MAX_LINHA, false<font color="#008080"><b>) </b></font>= false then
        <font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font>rotulo<font color="#008080"><b>(</b></font>sreg, 0<font color="#008080"><b>))
   }
} </b></font><font color="#0000FF"><b>else if </b></font>member<font color="#008080"><b>(</b></font>ctArqs, sreg<font color="#008080"><b>) </b></font>= opPais then <font color="#008080"><b>{
   </b></font><font color="#0000FF"><b>if </b></font>member<font color="#008080"><b>(</b></font>ctAcao, sacao<font color="#008080"><b>) </b></font>= opPesquisar then
      slinha:=validaEntrada<font color="#008080"><b>(</b></font>tfPais, sreg, 2, tPais.pais, 1, true,opTexto<font color="#008080"><b>)
   </b></font><font color="#0000FF"><b>else if </b></font>member<font color="#008080"><b>(</b></font>ctAcao, sacao<font color="#008080"><b>) </b></font>= opListarTodos then <font color="#008080"><b>{
      </b></font><font color="#0000FF"><b>if </b></font>ListarTodos<font color="#008080"><b>(</b></font>tfPais, sreg, <font color="#800000">&quot;&quot;</font>, 0, 0, tamReg<font color="#008080"><b>(</b></font>sreg<font color="#008080"><b>)</b></font>,
        QTD_MAX_LINHA, false<font color="#008080"><b>) </b></font>= false then
        <font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font>rotulo<font color="#008080"><b>(</b></font>sreg, 0<font color="#008080"><b>))
   }
} </b></font><font color="#0000FF"><b>else if </b></font>member<font color="#008080"><b>(</b></font>ctArqs, sreg<font color="#008080"><b>) </b></font>= opProfissao then <font color="#008080"><b>{
   </b></font><font color="#0000FF"><b>if </b></font>member<font color="#008080"><b>(</b></font>ctAcao, sacao<font color="#008080"><b>) </b></font>= opPesquisar then
     slinha:=validaEntrada<font color="#008080"><b>(</b></font>tfProfissao,sreg,2,tProfissao.profissao,1,
             true,opTexto<font color="#008080"><b>)
   </b></font><font color="#0000FF"><b>else if </b></font>member<font color="#008080"><b>(</b></font>ctAcao, sacao<font color="#008080"><b>) </b></font>= opListarTodos then <font color="#008080"><b>{
      </b></font><font color="#0000FF"><b>if </b></font>ListarTodos<font color="#008080"><b>(</b></font>tfProfissao, sreg, <font color="#800000">&quot;&quot;</font>, 0, 0, tamReg<font color="#008080"><b>(</b></font>sreg<font color="#008080"><b>)</b></font>,
        QTD_MAX_LINHA, false<font color="#008080"><b>) </b></font>= false then
        <font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font>rotulo<font color="#008080"><b>(</b></font>sreg, 0<font color="#008080"><b>))
   }
} </b></font><font color="#0000FF"><b>else if </b></font>member<font color="#008080"><b>(</b></font>ctArqs, sreg<font color="#008080"><b>) </b></font>= opLivro then <font color="#008080"><b>{
   </b></font><font color="#0000FF"><b>if </b></font>member<font color="#008080"><b>(</b></font>ctAcao, sacao<font color="#008080"><b>) </b></font>= opPesquisar then
      slinha:=validaEntrada<font color="#008080"><b>(</b></font>tfLivro, sreg, 2, tLivro.titulo, 1, true,opTexto<font color="#008080"><b>)
   </b></font><font color="#0000FF"><b>else if </b></font>member<font color="#008080"><b>(</b></font>ctAcao, sacao<font color="#008080"><b>) </b></font>= opListarTodos then <font color="#008080"><b>{
      </b></font><font color="#0000FF"><b>if </b></font>ListarTodos<font color="#008080"><b>(</b></font>tfLivro, sreg, <font color="#800000">&quot;&quot;</font>, 0, 0, tamReg<font color="#008080"><b>(</b></font>sreg<font color="#008080"><b>)</b></font>,
        1, false<font color="#008080"><b>) </b></font>= false then
        <font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font>rotulo<font color="#008080"><b>(</b></font>sreg, 0<font color="#008080"><b>))
   }
} </b></font><font color="#0000FF"><b>else if </b></font>member<font color="#008080"><b>(</b></font>ctArqs, sreg<font color="#008080"><b>) </b></font>= opCliente then <font color="#008080"><b>{
   </b></font><font color="#0000FF"><b>if </b></font>member<font color="#008080"><b>(</b></font>ctAcao, sacao<font color="#008080"><b>) </b></font>= opPesquisar then
      slinha:=validaEntrada<font color="#008080"><b>(</b></font>tfCliente, sreg, 2, tCliente.nome,1,true,opTexto<font color="#008080"><b>)
   </b></font><font color="#0000FF"><b>else if </b></font>member<font color="#008080"><b>(</b></font>ctAcao, sacao<font color="#008080"><b>) </b></font>= opListarTodos then <font color="#008080"><b>{
      </b></font><font color="#0000FF"><b>if </b></font>ListarTodos<font color="#008080"><b>(</b></font>tfCliente, sreg, <font color="#800000">&quot;&quot;</font>, 0, 0, tamReg<font color="#008080"><b>(</b></font>sreg<font color="#008080"><b>)</b></font>,
        1, false<font color="#008080"><b>) </b></font>= false then
        <font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font>rotulo<font color="#008080"><b>(</b></font>sreg, 0<font color="#008080"><b>))
   }
} </b></font><font color="#0000FF"><b>else if </b></font>member<font color="#008080"><b>(</b></font>ctArqs, sreg<font color="#008080"><b>) </b></font>= opVenda then <font color="#008080"><b>{
   </b></font><font color="#0000FF"><b>if </b></font>member<font color="#008080"><b>(</b></font>ctAcao, sacao<font color="#008080"><b>) </b></font>= opPesquisar then
      slinha:=validaEntrada<font color="#008080"><b>(</b></font>tfVenda, sreg, 2, tVenda.cpf, 1, true,opTexto<font color="#008080"><b>)
   </b></font><font color="#0000FF"><b>else if </b></font>member<font color="#008080"><b>(</b></font>ctAcao, sacao<font color="#008080"><b>) </b></font>= opListarTodos then <font color="#008080"><b>{
      </b></font><font color="#0000FF"><b>if </b></font>ListarTodos<font color="#008080"><b>(</b></font>tfVenda, sreg, <font color="#800000">&quot;&quot;</font>, 0, 0, tamReg<font color="#008080"><b>(</b></font>sreg<font color="#008080"><b>)</b></font>,
        QTD_MAX_LINHA, false<font color="#008080"><b>) </b></font>= false then
        <font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font>rotulo<font color="#008080"><b>(</b></font>sreg, 0<font color="#008080"><b>))
   }
}
</b></font><font color="#0000FF"><b>if </b></font>slinha==<font color="#800000">&quot;&quot; </font>then
   writes<font color="#008080"><b>()
</b></font><font color="#0000FF"><b>end
</b></font><font color="#808080">#------------------------------------------------------------------------------
# Mostra a tela de altera&ccedil;&atilde;o de senha do sistema e realiza a altera&ccedil;&atilde;o.
#------------------------------------------------------------------------------
</font>procedure frmAlterarSenha<font color="#008080"><b>()
</b></font><font color="#800000"><b>local </b></font>bQuebra, sres, sSenhaAtual, sNovaSenha, sConfirmaSenha, nopcao

<font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font>rotulo<font color="#008080"><b>(</b></font>opUsuario, 1<font color="#008080"><b>) </b></font>|| tUsuario.login<font color="#008080"><b>)
</b></font>nopcao:=1
bQuebra:=false
<font color="#0000FF"><b>while </b></font><font color="#008080"><b>(</b></font>bQuebra=false<font color="#008080"><b>) </b></font>do <font color="#008080"><b>{
  </b></font><font color="#0000FF"><b>case </b></font>nopcao of <font color="#008080"><b>{
   </b></font>1: <font color="#008080"><b>{
       </b></font>sSenhaAtual:=digitaSenha<font color="#008080"><b>(</b></font><font color="#800000">&quot;Senha Atual: &quot;</font>,10<font color="#008080"><b>)
       </b></font><font color="#0000FF"><b>if </b></font>sSenhaAtual~==tUsuario.senha then <font color="#008080"><b>{
          </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font>MSG_SENCONFERE<font color="#008080"><b>)
          </b></font>bQuebra:=true
       <font color="#008080"><b>} </b></font><font color="#0000FF"><b>else </b></font>nopcao:=2
      <font color="#008080"><b>}
   </b></font>2: <font color="#008080"><b>{
       </b></font>sNovaSenha:=digitaSenha<font color="#008080"><b>(</b></font><font color="#800000">&quot;Nova Senha: &quot;</font>,10<font color="#008080"><b>)
       </b></font>sConfirmaSenha:=digitaSenha<font color="#008080"><b>(</b></font><font color="#800000">&quot;Confirma Senha: &quot;</font>,10<font color="#008080"><b>)
       </b></font><font color="#0000FF"><b>if </b></font>sNovaSenha~==sConfirmaSenha then <font color="#008080"><b>{
          </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font>MSG_SENCONFIRM<font color="#008080"><b>)
          </b></font>bQuebra:=true
       <font color="#008080"><b>} </b></font><font color="#0000FF"><b>else </b></font>nopcao:=3
      <font color="#008080"><b>}
   </b></font>3: <font color="#008080"><b>{
       </b></font>sres:=pesqArq<font color="#008080"><b>(</b></font>tfUsuario, tUsuario.login, 1, 10, tamReg<font color="#008080"><b>(</b></font>opUsuario<font color="#008080"><b>))
       </b></font><font color="#0000FF"><b>if </b></font>sres==<font color="#800000">&quot;&quot; </font>then
         <font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font>MSG_LOGINENCON<font color="#008080"><b>)
       </b></font><font color="#0000FF"><b>else </b></font><font color="#008080"><b>{
         </b></font>tUsuario.senha:=sConfirmaSenha
         subMenu<font color="#008080"><b>(9</b></font>,opUsuario<font color="#008080"><b>)
         </b></font>bQuebra:=true
       <font color="#008080"><b>}
      }
  }
}
</b></font><font color="#0000FF"><b>end
</b></font><font color="#808080">#------------------------------------------------------------------------------
# Executa uma a&ccedil;&atilde;o de grava&ccedil;&atilde;o de acordo com o tipo de arquivo.
# sreg - o tipo de arquivo
# sacao - a a&ccedil;&atilde;o a ser realizada
#------------------------------------------------------------------------------
</font>procedure btnAcao<font color="#008080"><b>(</b></font>sreg, sacao<font color="#008080"><b>)

</b></font><font color="#0000FF"><b>if </b></font>member<font color="#008080"><b>(</b></font>ctArqs, sreg<font color="#008080"><b>) </b></font>= opAssunto then <font color="#008080"><b>{
   </b></font><font color="#0000FF"><b>if </b></font>member<font color="#008080"><b>(</b></font>ctAcao, sacao<font color="#008080"><b>) </b></font>= opSalvarInclusao then
      escreveArq<font color="#008080"><b>(</b></font>tfAssunto, LinhaReg<font color="#008080"><b>(</b></font>sreg<font color="#008080"><b>)</b></font>, MSG_REGINC, MSG_REGNINC<font color="#008080"><b>)
   </b></font><font color="#0000FF"><b>else if </b></font>member<font color="#008080"><b>(</b></font>ctAcao, sacao<font color="#008080"><b>) </b></font>= opSalvarAlteracao then
      escreveArq<font color="#008080"><b>(</b></font>tfAssunto, LinhaReg<font color="#008080"><b>(</b></font>sreg<font color="#008080"><b>)</b></font>, MSG_REGALT, MSG_REGNALT<font color="#008080"><b>)
   </b></font><font color="#0000FF"><b>else if </b></font>member<font color="#008080"><b>(</b></font>ctAcao, sacao<font color="#008080"><b>) </b></font>= opConfirmaExclusao then
      escreveArq<font color="#008080"><b>(</b></font>tfAssunto, repl<font color="#008080"><b>(</b></font><font color="#800000">&quot;*&quot;</font>,tamReg<font color="#008080"><b>(</b></font>sreg<font color="#008080"><b>))</b></font>, MSG_REGEXC, MSG_REGNEXC<font color="#008080"><b>)
} </b></font><font color="#0000FF"><b>else if </b></font>member<font color="#008080"><b>(</b></font>ctArqs, sreg<font color="#008080"><b>) </b></font>= opAutor then <font color="#008080"><b>{
   </b></font><font color="#0000FF"><b>if </b></font>member<font color="#008080"><b>(</b></font>ctAcao, sacao<font color="#008080"><b>) </b></font>= opSalvarInclusao then
      escreveArq<font color="#008080"><b>(</b></font>tfAutor, LinhaReg<font color="#008080"><b>(</b></font>sreg<font color="#008080"><b>)</b></font>, MSG_REGINC, MSG_REGNINC<font color="#008080"><b>)
   </b></font><font color="#0000FF"><b>else if </b></font>member<font color="#008080"><b>(</b></font>ctAcao, sacao<font color="#008080"><b>) </b></font>= opSalvarAlteracao then
      escreveArq<font color="#008080"><b>(</b></font>tfAutor, LinhaReg<font color="#008080"><b>(</b></font>sreg<font color="#008080"><b>)</b></font>, MSG_REGALT, MSG_REGNALT<font color="#008080"><b>)
   </b></font><font color="#0000FF"><b>else if </b></font>member<font color="#008080"><b>(</b></font>ctAcao, sacao<font color="#008080"><b>) </b></font>= opConfirmaExclusao then
      escreveArq<font color="#008080"><b>(</b></font>tfAutor, repl<font color="#008080"><b>(</b></font><font color="#800000">&quot;*&quot;</font>,tamReg<font color="#008080"><b>(</b></font>sreg<font color="#008080"><b>))</b></font>, MSG_REGEXC, MSG_REGNEXC<font color="#008080"><b>)
} </b></font><font color="#0000FF"><b>else if </b></font>member<font color="#008080"><b>(</b></font>ctArqs, sreg<font color="#008080"><b>) </b></font>= opEditora then <font color="#008080"><b>{
   </b></font><font color="#0000FF"><b>if </b></font>member<font color="#008080"><b>(</b></font>ctAcao, sacao<font color="#008080"><b>) </b></font>= opSalvarInclusao then
      escreveArq<font color="#008080"><b>(</b></font>tfEditora, LinhaReg<font color="#008080"><b>(</b></font>sreg<font color="#008080"><b>)</b></font>, MSG_REGINC, MSG_REGNINC<font color="#008080"><b>)
   </b></font><font color="#0000FF"><b>else if </b></font>member<font color="#008080"><b>(</b></font>ctAcao, sacao<font color="#008080"><b>) </b></font>= opSalvarAlteracao then
      escreveArq<font color="#008080"><b>(</b></font>tfEditora, LinhaReg<font color="#008080"><b>(</b></font>sreg<font color="#008080"><b>)</b></font>, MSG_REGALT, MSG_REGNALT<font color="#008080"><b>)
   </b></font><font color="#0000FF"><b>else if </b></font>member<font color="#008080"><b>(</b></font>ctAcao, sacao<font color="#008080"><b>) </b></font>= opConfirmaExclusao then
      escreveArq<font color="#008080"><b>(</b></font>tfEditora, repl<font color="#008080"><b>(</b></font><font color="#800000">&quot;*&quot;</font>,tamReg<font color="#008080"><b>(</b></font>sreg<font color="#008080"><b>))</b></font>, MSG_REGEXC, MSG_REGNEXC<font color="#008080"><b>)
} </b></font><font color="#0000FF"><b>else if </b></font>member<font color="#008080"><b>(</b></font>ctArqs, sreg<font color="#008080"><b>) </b></font>= opEndereco then <font color="#008080"><b>{
   </b></font><font color="#0000FF"><b>if </b></font>member<font color="#008080"><b>(</b></font>ctAcao, sacao<font color="#008080"><b>) </b></font>= opSalvarInclusao then
      escreveArq<font color="#008080"><b>(</b></font>tfEndereco, LinhaReg<font color="#008080"><b>(</b></font>sreg<font color="#008080"><b>)</b></font>, MSG_REGINC, MSG_REGNINC<font color="#008080"><b>)
   </b></font><font color="#0000FF"><b>else if </b></font>member<font color="#008080"><b>(</b></font>ctAcao, sacao<font color="#008080"><b>) </b></font>= opSalvarAlteracao then
      escreveArq<font color="#008080"><b>(</b></font>tfEndereco, LinhaReg<font color="#008080"><b>(</b></font>sreg<font color="#008080"><b>)</b></font>, MSG_REGALT, MSG_REGNALT<font color="#008080"><b>)
   </b></font><font color="#0000FF"><b>else if </b></font>member<font color="#008080"><b>(</b></font>ctAcao, sacao<font color="#008080"><b>) </b></font>= opConfirmaExclusao then
      escreveArq<font color="#008080"><b>(</b></font>tfEndereco, repl<font color="#008080"><b>(</b></font><font color="#800000">&quot;*&quot;</font>,tamReg<font color="#008080"><b>(</b></font>sreg<font color="#008080"><b>))</b></font>, MSG_REGEXC, MSG_REGNEXC<font color="#008080"><b>)
} </b></font><font color="#0000FF"><b>else if </b></font>member<font color="#008080"><b>(</b></font>ctArqs, sreg<font color="#008080"><b>) </b></font>= opIdioma then <font color="#008080"><b>{
   </b></font><font color="#0000FF"><b>if </b></font>member<font color="#008080"><b>(</b></font>ctAcao, sacao<font color="#008080"><b>) </b></font>= opSalvarInclusao then
      escreveArq<font color="#008080"><b>(</b></font>tfIdioma, LinhaReg<font color="#008080"><b>(</b></font>sreg<font color="#008080"><b>)</b></font>, MSG_REGINC, MSG_REGNINC<font color="#008080"><b>)
   </b></font><font color="#0000FF"><b>else if </b></font>member<font color="#008080"><b>(</b></font>ctAcao, sacao<font color="#008080"><b>) </b></font>= opSalvarAlteracao then
      escreveArq<font color="#008080"><b>(</b></font>tfIdioma, LinhaReg<font color="#008080"><b>(</b></font>sreg<font color="#008080"><b>)</b></font>, MSG_REGALT, MSG_REGNALT<font color="#008080"><b>)
   </b></font><font color="#0000FF"><b>else if </b></font>member<font color="#008080"><b>(</b></font>ctAcao, sacao<font color="#008080"><b>) </b></font>= opConfirmaExclusao then
      escreveArq<font color="#008080"><b>(</b></font>tfIdioma, repl<font color="#008080"><b>(</b></font><font color="#800000">&quot;*&quot;</font>,tamReg<font color="#008080"><b>(</b></font>sreg<font color="#008080"><b>))</b></font>, MSG_REGEXC, MSG_REGNEXC<font color="#008080"><b>)
} </b></font><font color="#0000FF"><b>else if </b></font>member<font color="#008080"><b>(</b></font>ctArqs, sreg<font color="#008080"><b>) </b></font>= opPais then <font color="#008080"><b>{
   </b></font><font color="#0000FF"><b>if </b></font>member<font color="#008080"><b>(</b></font>ctAcao, sacao<font color="#008080"><b>) </b></font>= opSalvarInclusao then
      escreveArq<font color="#008080"><b>(</b></font>tfPais, LinhaReg<font color="#008080"><b>(</b></font>sreg<font color="#008080"><b>)</b></font>, MSG_REGINC, MSG_REGNINC<font color="#008080"><b>)
   </b></font><font color="#0000FF"><b>else if </b></font>member<font color="#008080"><b>(</b></font>ctAcao, sacao<font color="#008080"><b>) </b></font>= opSalvarAlteracao then
      escreveArq<font color="#008080"><b>(</b></font>tfPais, LinhaReg<font color="#008080"><b>(</b></font>sreg<font color="#008080"><b>)</b></font>, MSG_REGALT, MSG_REGNALT<font color="#008080"><b>)
   </b></font><font color="#0000FF"><b>else if </b></font>member<font color="#008080"><b>(</b></font>ctAcao, sacao<font color="#008080"><b>) </b></font>= opConfirmaExclusao then
      escreveArq<font color="#008080"><b>(</b></font>tfPais, repl<font color="#008080"><b>(</b></font><font color="#800000">&quot;*&quot;</font>,tamReg<font color="#008080"><b>(</b></font>sreg<font color="#008080"><b>))</b></font>, MSG_REGEXC, MSG_REGNEXC<font color="#008080"><b>)
} </b></font><font color="#0000FF"><b>else if </b></font>member<font color="#008080"><b>(</b></font>ctArqs, sreg<font color="#008080"><b>) </b></font>= opProfissao then <font color="#008080"><b>{
   </b></font><font color="#0000FF"><b>if </b></font>member<font color="#008080"><b>(</b></font>ctAcao, sacao<font color="#008080"><b>) </b></font>= opSalvarInclusao then
      escreveArq<font color="#008080"><b>(</b></font>tfProfissao, LinhaReg<font color="#008080"><b>(</b></font>sreg<font color="#008080"><b>)</b></font>, MSG_REGINC, MSG_REGNINC<font color="#008080"><b>)
   </b></font><font color="#0000FF"><b>else if </b></font>member<font color="#008080"><b>(</b></font>ctAcao, sacao<font color="#008080"><b>) </b></font>= opSalvarAlteracao then
      escreveArq<font color="#008080"><b>(</b></font>tfProfissao, LinhaReg<font color="#008080"><b>(</b></font>sreg<font color="#008080"><b>)</b></font>, MSG_REGALT, MSG_REGNALT<font color="#008080"><b>)
   </b></font><font color="#0000FF"><b>else if </b></font>member<font color="#008080"><b>(</b></font>ctAcao, sacao<font color="#008080"><b>) </b></font>= opConfirmaExclusao then
      escreveArq<font color="#008080"><b>(</b></font>tfProfissao, repl<font color="#008080"><b>(</b></font><font color="#800000">&quot;*&quot;</font>,tamReg<font color="#008080"><b>(</b></font>sreg<font color="#008080"><b>))</b></font>, MSG_REGEXC, MSG_REGNEXC<font color="#008080"><b>)
} </b></font><font color="#0000FF"><b>else if </b></font>member<font color="#008080"><b>(</b></font>ctArqs, sreg<font color="#008080"><b>) </b></font>= opLivro then <font color="#008080"><b>{
   </b></font><font color="#0000FF"><b>if </b></font>member<font color="#008080"><b>(</b></font>ctAcao, sacao<font color="#008080"><b>) </b></font>= opSalvarInclusao then
      escreveArq<font color="#008080"><b>(</b></font>tfLivro, LinhaReg<font color="#008080"><b>(</b></font>sreg<font color="#008080"><b>)</b></font>, MSG_REGINC, MSG_REGNINC<font color="#008080"><b>)
   </b></font><font color="#0000FF"><b>else if </b></font>member<font color="#008080"><b>(</b></font>ctAcao, sacao<font color="#008080"><b>) </b></font>= opSalvarAlteracao then
      escreveArq<font color="#008080"><b>(</b></font>tfLivro, LinhaReg<font color="#008080"><b>(</b></font>sreg<font color="#008080"><b>)</b></font>, MSG_REGALT, MSG_REGNALT<font color="#008080"><b>)
   </b></font><font color="#0000FF"><b>else if </b></font>member<font color="#008080"><b>(</b></font>ctAcao, sacao<font color="#008080"><b>) </b></font>= opConfirmaExclusao then
      escreveArq<font color="#008080"><b>(</b></font>tfLivro, repl<font color="#008080"><b>(</b></font><font color="#800000">&quot;*&quot;</font>,tamReg<font color="#008080"><b>(</b></font>sreg<font color="#008080"><b>))</b></font>, MSG_REGEXC, MSG_REGNEXC<font color="#008080"><b>)
} </b></font><font color="#0000FF"><b>else if </b></font>member<font color="#008080"><b>(</b></font>ctArqs, sreg<font color="#008080"><b>) </b></font>= opLivroAss then <font color="#008080"><b>{
   </b></font><font color="#0000FF"><b>if </b></font>member<font color="#008080"><b>(</b></font>ctAcao, sacao<font color="#008080"><b>) </b></font>= opSalvarInclusao then
      escreveArq<font color="#008080"><b>(</b></font>tfLivroAss, LinhaReg<font color="#008080"><b>(</b></font>sreg<font color="#008080"><b>)</b></font>, MSG_REGINC, MSG_REGNINC<font color="#008080"><b>)
   </b></font><font color="#0000FF"><b>else if </b></font>member<font color="#008080"><b>(</b></font>ctAcao, sacao<font color="#008080"><b>) </b></font>= opSalvarAlteracao then
      escreveArq<font color="#008080"><b>(</b></font>tfLivroAss, LinhaReg<font color="#008080"><b>(</b></font>sreg<font color="#008080"><b>)</b></font>, MSG_REGALT, MSG_REGNALT<font color="#008080"><b>)
   </b></font><font color="#0000FF"><b>else if </b></font>member<font color="#008080"><b>(</b></font>ctAcao, sacao<font color="#008080"><b>) </b></font>= opConfirmaExclusao then
      escreveArq<font color="#008080"><b>(</b></font>tfLivroAss, repl<font color="#008080"><b>(</b></font><font color="#800000">&quot;*&quot;</font>,tamReg<font color="#008080"><b>(</b></font>sreg<font color="#008080"><b>))</b></font>, MSG_REGEXC, MSG_REGNEXC<font color="#008080"><b>)
} </b></font><font color="#0000FF"><b>else if </b></font>member<font color="#008080"><b>(</b></font>ctArqs, sreg<font color="#008080"><b>) </b></font>= opLivroAut then <font color="#008080"><b>{
   </b></font><font color="#0000FF"><b>if </b></font>member<font color="#008080"><b>(</b></font>ctAcao, sacao<font color="#008080"><b>) </b></font>= opSalvarInclusao then
      escreveArq<font color="#008080"><b>(</b></font>tfLivroAut, LinhaReg<font color="#008080"><b>(</b></font>sreg<font color="#008080"><b>)</b></font>, MSG_REGINC, MSG_REGNINC<font color="#008080"><b>)
   </b></font><font color="#0000FF"><b>else if </b></font>member<font color="#008080"><b>(</b></font>ctAcao, sacao<font color="#008080"><b>) </b></font>= opSalvarAlteracao then
      escreveArq<font color="#008080"><b>(</b></font>tfLivroAut, LinhaReg<font color="#008080"><b>(</b></font>sreg<font color="#008080"><b>)</b></font>, MSG_REGALT, MSG_REGNALT<font color="#008080"><b>)
   </b></font><font color="#0000FF"><b>else if </b></font>member<font color="#008080"><b>(</b></font>ctAcao, sacao<font color="#008080"><b>) </b></font>= opConfirmaExclusao then
      escreveArq<font color="#008080"><b>(</b></font>tfLivroAut, repl<font color="#008080"><b>(</b></font><font color="#800000">&quot;*&quot;</font>,tamReg<font color="#008080"><b>(</b></font>sreg<font color="#008080"><b>))</b></font>, MSG_REGEXC, MSG_REGNEXC<font color="#008080"><b>)
} </b></font><font color="#0000FF"><b>else if </b></font>member<font color="#008080"><b>(</b></font>ctArqs, sreg<font color="#008080"><b>) </b></font>= opCliente then <font color="#008080"><b>{
   </b></font><font color="#0000FF"><b>if </b></font>member<font color="#008080"><b>(</b></font>ctAcao, sacao<font color="#008080"><b>) </b></font>= opSalvarInclusao then
      escreveArq<font color="#008080"><b>(</b></font>tfCliente, LinhaReg<font color="#008080"><b>(</b></font>sreg<font color="#008080"><b>)</b></font>, MSG_REGINC, MSG_REGNINC<font color="#008080"><b>)
   </b></font><font color="#0000FF"><b>else if </b></font>member<font color="#008080"><b>(</b></font>ctAcao, sacao<font color="#008080"><b>) </b></font>= opSalvarAlteracao then
      escreveArq<font color="#008080"><b>(</b></font>tfCliente, LinhaReg<font color="#008080"><b>(</b></font>sreg<font color="#008080"><b>)</b></font>, MSG_REGALT, MSG_REGNALT<font color="#008080"><b>)
   </b></font><font color="#0000FF"><b>else if </b></font>member<font color="#008080"><b>(</b></font>ctAcao, sacao<font color="#008080"><b>) </b></font>= opConfirmaExclusao then
      escreveArq<font color="#008080"><b>(</b></font>tfCliente, repl<font color="#008080"><b>(</b></font><font color="#800000">&quot;*&quot;</font>,tamReg<font color="#008080"><b>(</b></font>sreg<font color="#008080"><b>))</b></font>, MSG_REGEXC, MSG_REGNEXC<font color="#008080"><b>)
} </b></font><font color="#0000FF"><b>else if </b></font>member<font color="#008080"><b>(</b></font>ctArqs, sreg<font color="#008080"><b>) </b></font>= opVenda then <font color="#008080"><b>{
   </b></font><font color="#0000FF"><b>if </b></font>member<font color="#008080"><b>(</b></font>ctAcao, sacao<font color="#008080"><b>) </b></font>= opSalvarInclusao then
      escreveArq<font color="#008080"><b>(</b></font>tfVenda, LinhaReg<font color="#008080"><b>(</b></font>sreg<font color="#008080"><b>)</b></font>, MSG_REGINC, MSG_REGNINC<font color="#008080"><b>)
   </b></font><font color="#0000FF"><b>else if </b></font>member<font color="#008080"><b>(</b></font>ctAcao, sacao<font color="#008080"><b>) </b></font>= opSalvarAlteracao then
      escreveArq<font color="#008080"><b>(</b></font>tfVenda, LinhaReg<font color="#008080"><b>(</b></font>sreg<font color="#008080"><b>)</b></font>, MSG_REGALT, MSG_REGNALT<font color="#008080"><b>)
   </b></font><font color="#0000FF"><b>else if </b></font>member<font color="#008080"><b>(</b></font>ctAcao, sacao<font color="#008080"><b>) </b></font>= opConfirmaExclusao then
      escreveArq<font color="#008080"><b>(</b></font>tfVenda, repl<font color="#008080"><b>(</b></font><font color="#800000">&quot;*&quot;</font>,tamReg<font color="#008080"><b>(</b></font>sreg<font color="#008080"><b>))</b></font>, MSG_REGEXC, MSG_REGNEXC<font color="#008080"><b>)
} </b></font><font color="#0000FF"><b>else if </b></font>member<font color="#008080"><b>(</b></font>ctArqs, sreg<font color="#008080"><b>) </b></font>= opUsuario then <font color="#008080"><b>{
   </b></font><font color="#0000FF"><b>if </b></font>member<font color="#008080"><b>(</b></font>ctAcao, sacao<font color="#008080"><b>) </b></font>= opSalvarAlteracao then
      escreveArq<font color="#008080"><b>(</b></font>tfUsuario, LinhaReg<font color="#008080"><b>(</b></font>sreg<font color="#008080"><b>)</b></font>, MSG_REGALT, MSG_REGNALT<font color="#008080"><b>)
}
</b></font><font color="#0000FF"><b>end
</b></font><font color="#808080">#------------------------------------------------------------------------------
# Seleciona o menu e/ou a tela certa de acordo com o tipo de arquivo.
# nmenu - o n&uacute;mero do menu
# sreg - o tipo de arquivo
#------------------------------------------------------------------------------
</font>procedure subMenu<font color="#008080"><b>(</b></font>nmenu, sreg<font color="#008080"><b>)
</b></font><font color="#800000"><b>local </b></font>opSubMenu, opCSubMenu, bSOp

bSOp:=true
<font color="#0000FF"><b>case </b></font>nmenu of <font color="#008080"><b>{
 </b></font>6:<font color="#008080"><b>{
    </b></font><font color="#0000FF"><b>while </b></font><font color="#008080"><b>(</b></font>bSOp=true<font color="#008080"><b>) </b></font>do <font color="#008080"><b>{
      </b></font>menu<font color="#008080"><b>(</b></font>nmenu<font color="#008080"><b>)
      </b></font>opSubMenu:=<font color="#800000"><b>read</b></font><font color="#008080"><b>()
      </b></font><font color="#0000FF"><b>case </b></font>opSubMenu of <font color="#008080"><b>{
        </b></font><font color="#800000">&quot;1&quot;</font>: frmCadastros<font color="#008080"><b>(</b></font>sreg, opNovo<font color="#008080"><b>)
        </b></font><font color="#800000">&quot;2&quot;</font>: frmCadastros<font color="#008080"><b>(</b></font>sreg, opPesquisar<font color="#008080"><b>)
        </b></font><font color="#800000">&quot;3&quot;</font>: bSOp:=false
        <font color="#800000"><b>default</b></font>: <font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font>MSG_ERRO<font color="#008080"><b>)
      }
    }
   }
 </b></font>7:<font color="#008080"><b>{
    </b></font><font color="#0000FF"><b>while </b></font><font color="#008080"><b>(</b></font>bSOp=true<font color="#008080"><b>) </b></font>do <font color="#008080"><b>{
      </b></font>menu<font color="#008080"><b>(</b></font>nmenu<font color="#008080"><b>)
      </b></font>opSubMenu:=<font color="#800000"><b>read</b></font><font color="#008080"><b>()
      </b></font><font color="#0000FF"><b>case </b></font>opSubMenu of <font color="#008080"><b>{
        </b></font><font color="#800000">&quot;1&quot;</font>: <font color="#008080"><b>{ </b></font>btnAcao<font color="#008080"><b>(</b></font>sreg, opSalvarInclusao<font color="#008080"><b>) 
             </b></font>bSOp:=false 
           <font color="#008080"><b>}
        </b></font><font color="#800000">&quot;2&quot;</font>: bSOp:=false
        <font color="#800000"><b>default</b></font>: <font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font>MSG_ERRO<font color="#008080"><b>)
      }
    }
   }
 </b></font>8:<font color="#008080"><b>{
    </b></font><font color="#0000FF"><b>while</b></font><font color="#008080"><b>(</b></font>bSOp=true<font color="#008080"><b>) </b></font>do <font color="#008080"><b>{
      </b></font>menu<font color="#008080"><b>(</b></font>nmenu<font color="#008080"><b>)
      </b></font>opSubMenu:=<font color="#800000"><b>read</b></font><font color="#008080"><b>()
      </b></font><font color="#0000FF"><b>case </b></font>opSubMenu of <font color="#008080"><b>{
        </b></font><font color="#800000">&quot;1&quot;</font>: <font color="#008080"><b>{ </b></font>frmCadastros<font color="#008080"><b>(</b></font>sreg, opAlterar<font color="#008080"><b>) 
             </b></font>bSOp:=false 
           <font color="#008080"><b>}
        </b></font><font color="#800000">&quot;2&quot;</font>: <font color="#008080"><b>{ </b></font>frmCadastros<font color="#008080"><b>(</b></font>sreg, opExcluir<font color="#008080"><b>) 
             </b></font>bSOp:=false 
           <font color="#008080"><b>}
        </b></font><font color="#800000">&quot;3&quot;</font>: bSOp:=false
        <font color="#800000"><b>default</b></font>: <font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font>MSG_ERRO<font color="#008080"><b>)
      }
    }
   }
 </b></font>9:<font color="#008080"><b>{
    </b></font><font color="#0000FF"><b>while </b></font><font color="#008080"><b>(</b></font>bSOp=true<font color="#008080"><b>) </b></font>do <font color="#008080"><b>{
      </b></font>menu<font color="#008080"><b>(</b></font>nmenu<font color="#008080"><b>)
      </b></font>opSubMenu:=<font color="#800000"><b>read</b></font><font color="#008080"><b>()
      </b></font><font color="#0000FF"><b>case </b></font>opSubMenu of <font color="#008080"><b>{
        </b></font><font color="#800000">&quot;1&quot;</font>: <font color="#008080"><b>{ </b></font>btnAcao<font color="#008080"><b>(</b></font>sreg, opSalvarAlteracao<font color="#008080"><b>) 
             </b></font>bSOp:=false 
           <font color="#008080"><b>}
        </b></font><font color="#800000">&quot;2&quot;</font>: bSOp:=false
        <font color="#800000"><b>default</b></font>: <font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font>MSG_ERRO<font color="#008080"><b>)
      }
    }
   }
 </b></font>10:<font color="#008080"><b>{
    </b></font><font color="#0000FF"><b>while </b></font><font color="#008080"><b>(</b></font>bSOp=true<font color="#008080"><b>) </b></font>do <font color="#008080"><b>{
      </b></font>menu<font color="#008080"><b>(</b></font>nmenu<font color="#008080"><b>)
      </b></font>opCSubMenu:=<font color="#800000"><b>read</b></font><font color="#008080"><b>()
      </b></font><font color="#0000FF"><b>if </b></font><font color="#008080"><b>(</b></font>opCSubMenu==<font color="#800000">&quot;S&quot;</font><font color="#008080"><b>) </b></font>| <font color="#008080"><b>(</b></font>opCSubMenu==<font color="#800000">&quot;s&quot;</font><font color="#008080"><b>) </b></font>then <font color="#008080"><b>{
        </b></font>btnAcao<font color="#008080"><b>(</b></font>sreg, opConfirmaExclusao<font color="#008080"><b>)
        </b></font>bSOp:=false
      <font color="#008080"><b>} </b></font><font color="#0000FF"><b>else if </b></font><font color="#008080"><b>(</b></font>opCSubMenu=<font color="#800000">&quot;N&quot;</font><font color="#008080"><b>) </b></font>| <font color="#008080"><b>(</b></font>opCSubMenu=<font color="#800000">&quot;n&quot;</font><font color="#008080"><b>) </b></font>then bSOp:=false
      <font color="#0000FF"><b>else </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font>MSG_ERRO<font color="#008080"><b>)
    }
   }
 </b></font>12:<font color="#008080"><b>{
    </b></font><font color="#0000FF"><b>while </b></font><font color="#008080"><b>(</b></font>bSOp=true<font color="#008080"><b>) </b></font>do <font color="#008080"><b>{
      </b></font>menu<font color="#008080"><b>(</b></font>nmenu<font color="#008080"><b>)
      </b></font>opSubMenu:=<font color="#800000"><b>read</b></font><font color="#008080"><b>()
      </b></font><font color="#0000FF"><b>case </b></font>opSubMenu of <font color="#008080"><b>{
        </b></font><font color="#800000">&quot;1&quot;</font>: frmConsultas<font color="#008080"><b>(</b></font>sreg, opPesquisar<font color="#008080"><b>)
        </b></font><font color="#800000">&quot;2&quot;</font>: frmConsultas<font color="#008080"><b>(</b></font>sreg, opListarTodos<font color="#008080"><b>)
        </b></font><font color="#800000">&quot;3&quot;</font>: bSOp:=false
        defaul: <font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font>MSG_ERRO<font color="#008080"><b>)
      }
    }
   }
 </b></font>14:<font color="#008080"><b>{
    </b></font><font color="#0000FF"><b>while </b></font><font color="#008080"><b>(</b></font>bSOp=true<font color="#008080"><b>) </b></font>do <font color="#008080"><b>{
      </b></font>menu<font color="#008080"><b>(</b></font>nmenu<font color="#008080"><b>)
      </b></font>opCSubMenu:=<font color="#800000"><b>read</b></font><font color="#008080"><b>()
      </b></font><font color="#0000FF"><b>if </b></font><font color="#008080"><b>(</b></font>opCSubMenu==<font color="#800000">&quot;S&quot;</font><font color="#008080"><b>) </b></font>| <font color="#008080"><b>(</b></font>opCSubMenu==<font color="#800000">&quot;s&quot;</font><font color="#008080"><b>) </b></font>then <font color="#008080"><b>{
        </b></font>btnAcao<font color="#008080"><b>(</b></font>sreg, opSalvarInclusao<font color="#008080"><b>)
        </b></font>bSOp:=false
        g_SalvarInclusao:=true
      <font color="#008080"><b>} </b></font><font color="#0000FF"><b>else if </b></font><font color="#008080"><b>(</b></font>opCSubMenu==<font color="#800000">&quot;N&quot;</font><font color="#008080"><b>) </b></font>| <font color="#008080"><b>(</b></font>opCSubMenu==<font color="#800000">&quot;n&quot;</font><font color="#008080"><b>) </b></font>then bSOp:=false
      <font color="#0000FF"><b>else </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font>MSG_ERRO<font color="#008080"><b>)
    }
   }
}

</b></font><font color="#0000FF"><b>end
</b></font><font color="#808080">#------------------------------------------------------------------------------
# Seleciona o submenu e/ou a tela certa de acordo com n&uacute;mero do menu.
# nmenu - o n&uacute;mero do menu
#------------------------------------------------------------------------------
</font>procedure usaMenu<font color="#008080"><b>(</b></font>num<font color="#008080"><b>)
</b></font><font color="#800000"><b>local </b></font>opSubMenu, bSOp, opSair

 bSOp:=true
 <font color="#0000FF"><b>if </b></font>num = 1 then <font color="#008080"><b>{ </b></font><font color="#808080"># Cadastros
   </font><font color="#0000FF"><b>while </b></font><font color="#008080"><b>(</b></font>bSOp=true<font color="#008080"><b>) </b></font>do <font color="#008080"><b>{
     </b></font>menu<font color="#008080"><b>(2)
     </b></font>opSubMenu:=<font color="#800000"><b>read</b></font><font color="#008080"><b>()
     </b></font><font color="#0000FF"><b>case </b></font>opSubMenu of <font color="#008080"><b>{
       </b></font><font color="#800000">&quot;1&quot;</font>: subMenu<font color="#008080"><b>(6</b></font>, opAssunto<font color="#008080"><b>)
       </b></font><font color="#800000">&quot;2&quot;</font>: subMenu<font color="#008080"><b>(6</b></font>, opAutor<font color="#008080"><b>)
       </b></font><font color="#800000">&quot;3&quot;</font>: subMenu<font color="#008080"><b>(6</b></font>, opEditora<font color="#008080"><b>)
       </b></font><font color="#800000">&quot;4&quot;</font>: subMenu<font color="#008080"><b>(6</b></font>, opEndereco<font color="#008080"><b>)
       </b></font><font color="#800000">&quot;5&quot;</font>: subMenu<font color="#008080"><b>(6</b></font>, opIdioma<font color="#008080"><b>)
       </b></font><font color="#800000">&quot;6&quot;</font>: subMenu<font color="#008080"><b>(6</b></font>, opPais<font color="#008080"><b>)
       </b></font><font color="#800000">&quot;7&quot;</font>: subMenu<font color="#008080"><b>(6</b></font>, opProfissao<font color="#008080"><b>)
       </b></font><font color="#800000">&quot;8&quot;</font>: subMenu<font color="#008080"><b>(6</b></font>, opCliente<font color="#008080"><b>)
       </b></font><font color="#800000">&quot;9&quot;</font>: subMenu<font color="#008080"><b>(6</b></font>, opLivro<font color="#008080"><b>)
       </b></font><font color="#800000">&quot;10&quot;</font>: bSOp:=false
       <font color="#800000"><b>default</b></font>: <font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font>MSG_ERRO<font color="#008080"><b>)
     }
   }
 } </b></font><font color="#0000FF"><b>else if </b></font>num = 2 then <font color="#008080"><b>{ </b></font><font color="#808080"># Pesquisas
   </font><font color="#0000FF"><b>while </b></font><font color="#008080"><b>(</b></font>bSOp=true<font color="#008080"><b>) </b></font>do <font color="#008080"><b>{
     </b></font>menu<font color="#008080"><b>(3)
     </b></font>opSubMenu:=<font color="#800000"><b>read</b></font><font color="#008080"><b>()
     </b></font><font color="#0000FF"><b>case </b></font>opSubMenu of <font color="#008080"><b>{
       </b></font><font color="#800000">&quot;1&quot;</font>: subMenu<font color="#008080"><b>(12</b></font>, opAssunto<font color="#008080"><b>)
       </b></font><font color="#800000">&quot;2&quot;</font>: subMenu<font color="#008080"><b>(12</b></font>, opAutor<font color="#008080"><b>)
       </b></font><font color="#800000">&quot;3&quot;</font>: subMenu<font color="#008080"><b>(12</b></font>, opEditora<font color="#008080"><b>)
       </b></font><font color="#800000">&quot;4&quot;</font>: subMenu<font color="#008080"><b>(12</b></font>, opEndereco<font color="#008080"><b>)
       </b></font><font color="#800000">&quot;5&quot;</font>: subMenu<font color="#008080"><b>(12</b></font>, opIdioma<font color="#008080"><b>)
       </b></font><font color="#800000">&quot;6&quot;</font>: subMenu<font color="#008080"><b>(12</b></font>, opPais<font color="#008080"><b>)
       </b></font><font color="#800000">&quot;7&quot;</font>: subMenu<font color="#008080"><b>(12</b></font>, opProfissao<font color="#008080"><b>)
       </b></font><font color="#800000">&quot;8&quot;</font>: subMenu<font color="#008080"><b>(12</b></font>, opCliente<font color="#008080"><b>)
       </b></font><font color="#800000">&quot;9&quot;</font>: subMenu<font color="#008080"><b>(12</b></font>, opLivro<font color="#008080"><b>)
       </b></font><font color="#800000">&quot;10&quot;</font>: bSOp:=false
       <font color="#800000"><b>default</b></font>: <font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font>MSG_ERRO<font color="#008080"><b>)
     }
   }
 } </b></font><font color="#0000FF"><b>else if </b></font>num = 3 then <font color="#008080"><b>{ </b></font><font color="#808080"># Vendas
   </font><font color="#0000FF"><b>while </b></font><font color="#008080"><b>(</b></font>bSOp=true<font color="#008080"><b>) </b></font>do <font color="#008080"><b>{
     </b></font>menu<font color="#008080"><b>(4)
     </b></font>opSubMenu:=<font color="#800000"><b>read</b></font><font color="#008080"><b>()
     </b></font><font color="#0000FF"><b>case </b></font>opSubMenu of <font color="#008080"><b>{
       </b></font><font color="#800000">&quot;1&quot;</font>: subMenu<font color="#008080"><b>(6</b></font>, opVenda<font color="#008080"><b>)
       </b></font><font color="#800000">&quot;2&quot;</font>: subMenu<font color="#008080"><b>(12</b></font>, opVenda<font color="#008080"><b>)
       </b></font><font color="#800000">&quot;3&quot;</font>: bSOp:=false
       <font color="#800000"><b>default</b></font>: <font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font>MSG_ERRO<font color="#008080"><b>)
     }
   }
 } </b></font><font color="#0000FF"><b>else if </b></font>num = 4 then <font color="#008080"><b>{ </b></font><font color="#808080">#Opcoes
   </font><font color="#0000FF"><b>while </b></font><font color="#008080"><b>(</b></font>bSOp=true<font color="#008080"><b>) </b></font>do <font color="#008080"><b>{
     </b></font>menu<font color="#008080"><b>(5)
     </b></font>opSubMenu:=<font color="#800000"><b>read</b></font><font color="#008080"><b>()
     </b></font><font color="#0000FF"><b>case </b></font>opSubMenu of <font color="#008080"><b>{
       </b></font><font color="#800000">&quot;1&quot;</font>: frmAlterarSenha<font color="#008080"><b>()
       </b></font><font color="#800000">&quot;2&quot;</font>: frmSobre<font color="#008080"><b>()
       </b></font><font color="#800000">&quot;3&quot;</font>: <font color="#008080"><b>{
           </b></font>menu<font color="#008080"><b>(11)
           </b></font>opSair:=<font color="#800000"><b>read</b></font><font color="#008080"><b>()
           </b></font><font color="#0000FF"><b>if </b></font><font color="#008080"><b>(</b></font>opSair==<font color="#800000">&quot;S&quot;</font><font color="#008080"><b>) </b></font>| <font color="#008080"><b>(</b></font>opSair==<font color="#800000">&quot;s&quot;</font><font color="#008080"><b>) </b></font>then <font color="#008080"><b>{
              </b></font>fechaArqs<font color="#008080"><b>()
              </b></font><font color="#800000"><b>exit</b></font><font color="#008080"><b>(0)
           }
         }
       </b></font><font color="#800000">&quot;4&quot;</font>: bSOp:=false
       <font color="#800000"><b>default</b></font>: <font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font>MSG_ERRO<font color="#008080"><b>)
     }
   }
 }
</b></font><font color="#0000FF"><b>end
</b></font><font color="#808080">#------------------------------------------------------------------------------
# Mostra as entradas e as sa&iacute;das do sistema.
# sreg - o tipo de arquivo
# slinha - o registro com os dados
# nOpcao - indica qual op&ccedil;&atilde;o ser&aacute; mostrada
#------------------------------------------------------------------------------
</font>procedure mostrarDados<font color="#008080"><b>(</b></font>sreg, slinha, nOpcao<font color="#008080"><b>)

</b></font><font color="#0000FF"><b>if </b></font>member<font color="#008080"><b>(</b></font>ctArqs, sreg<font color="#008080"><b>) </b></font>= opAssunto then <font color="#008080"><b>{
  </b></font><font color="#0000FF"><b>case </b></font>nOpcao of <font color="#008080"><b>{
    </b></font>1: <font color="#008080"><b>{
        </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font>rotulo<font color="#008080"><b>(</b></font>sreg, 1<font color="#008080"><b>) </b></font>||  tAssunto.codigo<font color="#008080"><b>)
        </b></font>writes<font color="#008080"><b>(</b></font>rotulo<font color="#008080"><b>(</b></font>sreg, 2<font color="#008080"><b>))
        </b></font>tAssunto.assunto:=<font color="#800000"><b>read</b></font><font color="#008080"><b>()
       }
    </b></font>2: <font color="#008080"><b>{
        </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;C&oacute;digo     Assunto&quot;</font><font color="#008080"><b>)
        </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;------     -------&quot;</font><font color="#008080"><b>)
       }
    </b></font>3: <font color="#008080"><b>{
        </b></font>tAssunto.codigo:=substr<font color="#008080"><b>(</b></font>slinha, 1, 10<font color="#008080"><b>)
        </b></font>tAssunto.assunto:=substr<font color="#008080"><b>(</b></font>slinha, 11, 30<font color="#008080"><b>)
        </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font>tAssunto.codigo || <font color="#800000">&quot; &quot; </font>|| tAssunto.assunto<font color="#008080"><b>)
       }
  }
} </b></font><font color="#0000FF"><b>else if </b></font>member<font color="#008080"><b>(</b></font>ctArqs, sreg<font color="#008080"><b>) </b></font>= opAutor then <font color="#008080"><b>{
  </b></font><font color="#0000FF"><b>case </b></font>nOpcao of <font color="#008080"><b>{
    </b></font>1: <font color="#008080"><b>{
        </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font>rotulo<font color="#008080"><b>(</b></font>sreg, 1<font color="#008080"><b>) </b></font>||  tAutor.codigo<font color="#008080"><b>)
        </b></font>writes<font color="#008080"><b>(</b></font>rotulo<font color="#008080"><b>(</b></font>sreg, 2<font color="#008080"><b>))
        </b></font>tAutor.autor:=<font color="#800000"><b>read</b></font><font color="#008080"><b>()
       }
    </b></font>2: <font color="#008080"><b>{
        </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;C&oacute;digo     Autor&quot;</font><font color="#008080"><b>)
        </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;------     -----&quot;</font><font color="#008080"><b>)
       }
    </b></font>3: <font color="#008080"><b>{
        </b></font>tAutor.codigo:=substr<font color="#008080"><b>(</b></font>slinha, 1, 10<font color="#008080"><b>)
        </b></font>tAutor.autor:=substr<font color="#008080"><b>(</b></font>slinha, 11, 30<font color="#008080"><b>)
        </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font>tAutor.codigo || <font color="#800000">&quot; &quot; </font>|| tAutor.autor<font color="#008080"><b>)
       }
  }
} </b></font><font color="#0000FF"><b>else if </b></font>member<font color="#008080"><b>(</b></font>ctArqs, sreg<font color="#008080"><b>) </b></font>= opEditora then <font color="#008080"><b>{
  </b></font><font color="#0000FF"><b>case </b></font>nOpcao of <font color="#008080"><b>{
    </b></font>1: <font color="#008080"><b>{
        </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font>rotulo<font color="#008080"><b>(</b></font>sreg, 1<font color="#008080"><b>) </b></font>||  tEditora.codigo<font color="#008080"><b>)
        </b></font>writes<font color="#008080"><b>(</b></font>rotulo<font color="#008080"><b>(</b></font>sreg, 2<font color="#008080"><b>))
        </b></font>tEditora.editora:=<font color="#800000"><b>read</b></font><font color="#008080"><b>()
       }
    </b></font>2: <font color="#008080"><b>{
        </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;C&oacute;digo     Editora&quot;</font><font color="#008080"><b>)
        </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;------     -------&quot;</font><font color="#008080"><b>)
       }
    </b></font>3: <font color="#008080"><b>{
        </b></font>tEditora.codigo:=substr<font color="#008080"><b>(</b></font>slinha, 1, 10<font color="#008080"><b>)
        </b></font>tEditora.editora:=substr<font color="#008080"><b>(</b></font>slinha, 11, 50<font color="#008080"><b>)
        </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font>tEditora.codigo || <font color="#800000">&quot; &quot; </font>|| tEditora.editora<font color="#008080"><b>)
       }
  }
} </b></font><font color="#0000FF"><b>else if </b></font>member<font color="#008080"><b>(</b></font>ctArqs, sreg<font color="#008080"><b>) </b></font>= opEndereco then <font color="#008080"><b>{
  </b></font><font color="#0000FF"><b>case </b></font>nOpcao of <font color="#008080"><b>{
    </b></font>1: <font color="#008080"><b>{
        </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font>rotulo<font color="#008080"><b>(</b></font>sreg, 1<font color="#008080"><b>) </b></font>||  tEndereco.codigo<font color="#008080"><b>)
        </b></font>writes<font color="#008080"><b>(</b></font>rotulo<font color="#008080"><b>(</b></font>sreg, 2<font color="#008080"><b>))
        </b></font>tEndereco.Logradouro:=<font color="#800000"><b>read</b></font><font color="#008080"><b>()
        </b></font>writes<font color="#008080"><b>(</b></font>rotulo<font color="#008080"><b>(</b></font>sreg, 3<font color="#008080"><b>))
        </b></font>tEndereco.bairro:=<font color="#800000"><b>read</b></font><font color="#008080"><b>()
        </b></font>writes<font color="#008080"><b>(</b></font>rotulo<font color="#008080"><b>(</b></font>sreg, 4<font color="#008080"><b>))
        </b></font>tEndereco.cep:=<font color="#800000"><b>read</b></font><font color="#008080"><b>()
        </b></font>writes<font color="#008080"><b>(</b></font>rotulo<font color="#008080"><b>(</b></font>sreg, 5<font color="#008080"><b>))
        </b></font>tEndereco.cidade:=<font color="#800000"><b>read</b></font><font color="#008080"><b>()
        </b></font>writes<font color="#008080"><b>(</b></font>rotulo<font color="#008080"><b>(</b></font>sreg, 6<font color="#008080"><b>))
        </b></font>tEndereco.estado:=<font color="#800000"><b>read</b></font><font color="#008080"><b>()
       }
    </b></font>3: <font color="#008080"><b>{
        </b></font>tEndereco.codigo:=trim<font color="#008080"><b>(</b></font>substr<font color="#008080"><b>(</b></font>slinha, 1, 10<font color="#008080"><b>))
        </b></font>tEndereco.logradouro:=trim<font color="#008080"><b>(</b></font>substr<font color="#008080"><b>(</b></font>slinha, 11, 40<font color="#008080"><b>))
        </b></font>tEndereco.bairro:=trim<font color="#008080"><b>(</b></font>substr<font color="#008080"><b>(</b></font>slinha, 51, 15<font color="#008080"><b>))
        </b></font>tEndereco.cep:=trim<font color="#008080"><b>(</b></font>substr<font color="#008080"><b>(</b></font>slinha, 66, 8<font color="#008080"><b>))
        </b></font>tEndereco.cidade:=trim<font color="#008080"><b>(</b></font>substr<font color="#008080"><b>(</b></font>slinha, 74, 30<font color="#008080"><b>))
        </b></font>tEndereco.estado:=trim<font color="#008080"><b>(</b></font>substr<font color="#008080"><b>(</b></font>slinha, 104, 20<font color="#008080"><b>))
        </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;--------------------&quot;</font><font color="#008080"><b>)
        </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font>rotulo<font color="#008080"><b>(</b></font>sreg, 1<font color="#008080"><b>) </b></font>||  tEndereco.codigo<font color="#008080"><b>)
        </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font>rotulo<font color="#008080"><b>(</b></font>sreg, 2<font color="#008080"><b>) </b></font>||  tEndereco.Logradouro<font color="#008080"><b>)
        </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font>rotulo<font color="#008080"><b>(</b></font>sreg, 3<font color="#008080"><b>) </b></font>||  tEndereco.bairro<font color="#008080"><b>)
        </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font>rotulo<font color="#008080"><b>(</b></font>sreg, 4<font color="#008080"><b>) </b></font>||  tEndereco.cep<font color="#008080"><b>)
        </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font>rotulo<font color="#008080"><b>(</b></font>sreg, 5<font color="#008080"><b>) </b></font>||  tEndereco.cidade<font color="#008080"><b>)
        </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font>rotulo<font color="#008080"><b>(</b></font>sreg, 6<font color="#008080"><b>) </b></font>||  tEndereco.estado<font color="#008080"><b>)
       }
  }
} </b></font><font color="#0000FF"><b>else if </b></font>member<font color="#008080"><b>(</b></font>ctArqs, sreg<font color="#008080"><b>) </b></font>= opIdioma then <font color="#008080"><b>{
  </b></font><font color="#0000FF"><b>case </b></font>nOpcao of <font color="#008080"><b>{
    </b></font>1: <font color="#008080"><b>{
        </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font>rotulo<font color="#008080"><b>(</b></font>sreg, 1<font color="#008080"><b>) </b></font>||  tIdioma.codigo<font color="#008080"><b>)
        </b></font>writes<font color="#008080"><b>(</b></font>rotulo<font color="#008080"><b>(</b></font>sreg, 2<font color="#008080"><b>))
        </b></font>tIdioma.idioma:=<font color="#800000"><b>read</b></font><font color="#008080"><b>()
       }
    </b></font>2: <font color="#008080"><b>{
        </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;C&oacute;digo     Idioma&quot;</font><font color="#008080"><b>)
        </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;------     ------&quot;</font><font color="#008080"><b>)
       }
    </b></font>3: <font color="#008080"><b>{
        </b></font>tIdioma.codigo:=substr<font color="#008080"><b>(</b></font>slinha, 1, 10<font color="#008080"><b>)
        </b></font>tIdioma.idioma:=substr<font color="#008080"><b>(</b></font>slinha, 11, 20<font color="#008080"><b>)
        </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font>tIdioma.codigo || <font color="#800000">&quot; &quot; </font>|| tIdioma.idioma<font color="#008080"><b>)
       }
  }
} </b></font><font color="#0000FF"><b>else if </b></font>member<font color="#008080"><b>(</b></font>ctArqs, sreg<font color="#008080"><b>) </b></font>= opPais then <font color="#008080"><b>{
  </b></font><font color="#0000FF"><b>case </b></font>nOpcao of <font color="#008080"><b>{
    </b></font>1: <font color="#008080"><b>{
        </b></font>writes<font color="#008080"><b>(</b></font>rotulo<font color="#008080"><b>(</b></font>sreg, 2<font color="#008080"><b>))
        </b></font>tPais.pais:=<font color="#800000"><b>read</b></font><font color="#008080"><b>()
       }
    </b></font>2: <font color="#008080"><b>{
        </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;C&oacute;digo Pa&iacute;s&quot;</font><font color="#008080"><b>)
        </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;------ ----&quot;</font><font color="#008080"><b>)
       }
    </b></font>3: <font color="#008080"><b>{
        </b></font>tPais.codigo:=substr<font color="#008080"><b>(</b></font>slinha, 1, 3<font color="#008080"><b>)
        </b></font>tPais.pais:=substr<font color="#008080"><b>(</b></font>slinha, 4, 50<font color="#008080"><b>)
        </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font>tPais.codigo || <font color="#800000">&quot;    &quot; </font>|| tPais.pais<font color="#008080"><b>)
       }
  }
} </b></font><font color="#0000FF"><b>else if </b></font>member<font color="#008080"><b>(</b></font>ctArqs, sreg<font color="#008080"><b>) </b></font>= opProfissao then <font color="#008080"><b>{
  </b></font><font color="#0000FF"><b>case </b></font>nOpcao of <font color="#008080"><b>{
    </b></font>1: <font color="#008080"><b>{
        </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font>rotulo<font color="#008080"><b>(</b></font>sreg, 1<font color="#008080"><b>) </b></font>||  tProfissao.codigo<font color="#008080"><b>)
        </b></font>writes<font color="#008080"><b>(</b></font>rotulo<font color="#008080"><b>(</b></font>sreg, 2<font color="#008080"><b>))
        </b></font>tProfissao.profissao:=<font color="#800000"><b>read</b></font><font color="#008080"><b>()
       }
    </b></font>2: <font color="#008080"><b>{
        </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;C&oacute;digo     Profiss&atilde;o&quot;</font><font color="#008080"><b>)
        </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;------     ---------&quot;</font><font color="#008080"><b>)
       }
    </b></font>3: <font color="#008080"><b>{
        </b></font>tProfissao.codigo:=substr<font color="#008080"><b>(</b></font>slinha, 1, 10<font color="#008080"><b>)
        </b></font>tProfissao.profissao:=substr<font color="#008080"><b>(</b></font>slinha, 11, 50<font color="#008080"><b>)
        </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font>tProfissao.codigo || <font color="#800000">&quot; &quot; </font>|| tProfissao.profissao<font color="#008080"><b>)
       }
  }
} </b></font><font color="#0000FF"><b>else if </b></font>member<font color="#008080"><b>(</b></font>ctArqs, sreg<font color="#008080"><b>) </b></font>= opLivro then <font color="#008080"><b>{
  </b></font><font color="#0000FF"><b>case </b></font>nOpcao of <font color="#008080"><b>{
    </b></font>1: <font color="#008080"><b>{
        </b></font>writes<font color="#008080"><b>(</b></font>rotulo<font color="#008080"><b>(</b></font>sreg, 2<font color="#008080"><b>))
        </b></font>tLivro.titulo:=<font color="#800000"><b>read</b></font><font color="#008080"><b>()
        </b></font>tLivro.edicao:=validaNumero<font color="#008080"><b>(</b></font>rotulo<font color="#008080"><b>(</b></font>sreg, 3<font color="#008080"><b>) </b></font>||  tLivro.edicao<font color="#008080"><b>)
        </b></font>tLivro.anopubli:=validaNumero<font color="#008080"><b>(</b></font>rotulo<font color="#008080"><b>(</b></font>sreg, 4<font color="#008080"><b>) </b></font>||  tLivro.anopubli<font color="#008080"><b>)
        </b></font>mostrarSubDados<font color="#008080"><b>(</b></font>opLivro, opEditora, false<font color="#008080"><b>)
        </b></font>tLivro.volume:=validaNumero<font color="#008080"><b>(</b></font>rotulo<font color="#008080"><b>(</b></font>sreg, 6<font color="#008080"><b>)</b></font>, tLivro.volume<font color="#008080"><b>)
        </b></font>mostrarSubDados<font color="#008080"><b>(</b></font>opLivro, opIdioma, false<font color="#008080"><b>)
        </b></font>tLivro.npaginas:=validaNumero<font color="#008080"><b>(</b></font>rotulo<font color="#008080"><b>(</b></font>sreg, 8<font color="#008080"><b>)</b></font>, tLivro.npaginas<font color="#008080"><b>)
        </b></font>tLivro.preco:=validaNumero<font color="#008080"><b>(</b></font>rotulo<font color="#008080"><b>(</b></font>sreg, 9<font color="#008080"><b>)</b></font>, tLivro.preco<font color="#008080"><b>)
        </b></font>tLivro.qtdestoque:=validaNumero<font color="#008080"><b>(</b></font>rotulo<font color="#008080"><b>(</b></font>sreg, 10<font color="#008080"><b>)</b></font>, tLivro.qtdestoque<font color="#008080"><b>)
       }
    </b></font>3: <font color="#008080"><b>{
        </b></font>tLivro.isbn:=trim<font color="#008080"><b>(</b></font>substr<font color="#008080"><b>(</b></font>slinha, 1, 13<font color="#008080"><b>))
        </b></font>tLivro.titulo:=trim<font color="#008080"><b>(</b></font>substr<font color="#008080"><b>(</b></font>slinha, 14, 50<font color="#008080"><b>))
        </b></font>tLivro.edicao:=trim<font color="#008080"><b>(</b></font>substr<font color="#008080"><b>(</b></font>slinha, 64, 10<font color="#008080"><b>))
        </b></font>tLivro.anopubli:=trim<font color="#008080"><b>(</b></font>substr<font color="#008080"><b>(</b></font>slinha, 74, 10<font color="#008080"><b>))
        </b></font>tLivro.codeditora:=trim<font color="#008080"><b>(</b></font>substr<font color="#008080"><b>(</b></font>slinha, 84, 10<font color="#008080"><b>))
        </b></font>tLivro.volume:=trim<font color="#008080"><b>(</b></font>substr<font color="#008080"><b>(</b></font>slinha, 94, 10<font color="#008080"><b>))
        </b></font>tLivro.codidioma:=trim<font color="#008080"><b>(</b></font>substr<font color="#008080"><b>(</b></font>slinha, 104, 10<font color="#008080"><b>))
        </b></font>tLivro.npaginas:=trim<font color="#008080"><b>(</b></font>substr<font color="#008080"><b>(</b></font>slinha, 114, 10<font color="#008080"><b>))
        </b></font>tLivro.preco:=trim<font color="#008080"><b>(</b></font>substr<font color="#008080"><b>(</b></font>slinha, 124, 10<font color="#008080"><b>))
        </b></font>tLivro.qtdestoque:=trim<font color="#008080"><b>(</b></font>substr<font color="#008080"><b>(</b></font>slinha, 134, 10<font color="#008080"><b>))
        </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;--------------------&quot;</font><font color="#008080"><b>)
        </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font>rotulo<font color="#008080"><b>(</b></font>sreg, 1<font color="#008080"><b>) </b></font>||  tLivro.isbn<font color="#008080"><b>)
        </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font>rotulo<font color="#008080"><b>(</b></font>sreg, 2<font color="#008080"><b>) </b></font>||  tLivro.titulo<font color="#008080"><b>)
        </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font>rotulo<font color="#008080"><b>(</b></font>sreg, 3<font color="#008080"><b>) </b></font>||  tLivro.edicao<font color="#008080"><b>)
        </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font>rotulo<font color="#008080"><b>(</b></font>sreg, 4<font color="#008080"><b>) </b></font>||  tLivro.anopubli<font color="#008080"><b>)
        </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font>rotulo<font color="#008080"><b>(</b></font>sreg, 5<font color="#008080"><b>) </b></font>||  tLivro.codeditora<font color="#008080"><b>)
        </b></font>mostrarSubDados<font color="#008080"><b>(</b></font>opLivro, opEditora, true<font color="#008080"><b>)
        </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font>rotulo<font color="#008080"><b>(</b></font>sreg, 6<font color="#008080"><b>) </b></font>||  tLivro.volume<font color="#008080"><b>)
        </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font>rotulo<font color="#008080"><b>(</b></font>sreg, 7<font color="#008080"><b>) </b></font>||  tLivro.codidioma<font color="#008080"><b>)
        </b></font>mostrarSubDados<font color="#008080"><b>(</b></font>opLivro, opIdioma, true<font color="#008080"><b>)
        </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font>rotulo<font color="#008080"><b>(</b></font>sreg, 8<font color="#008080"><b>) </b></font>||  tLivro.npaginas<font color="#008080"><b>)
        </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font>rotulo<font color="#008080"><b>(</b></font>sreg, 9<font color="#008080"><b>) </b></font>||  tLivro.preco<font color="#008080"><b>)
        </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font>rotulo<font color="#008080"><b>(</b></font>sreg, 10<font color="#008080"><b>) </b></font>||  tLivro.qtdestoque<font color="#008080"><b>)
        </b></font>ListarRegLigados<font color="#008080"><b>(</b></font>tfLivroAss, opLivroAss, 1, 13, 14, 10, tLivro.isbn,
                         tfAssunto, opAssunto, 1, 4<font color="#008080"><b>)
        </b></font>ListarRegLigados<font color="#008080"><b>(</b></font>tfLivroAut, opLivroAut, 1, 13, 14, 10, tLivro.isbn,
                         tfAutor, opAutor, 1, 4<font color="#008080"><b>)
       }
  }
} </b></font><font color="#0000FF"><b>else if </b></font>member<font color="#008080"><b>(</b></font>ctArqs, sreg<font color="#008080"><b>) </b></font>= opCliente then <font color="#008080"><b>{
  </b></font><font color="#0000FF"><b>case </b></font>nOpcao of <font color="#008080"><b>{
    </b></font>1: <font color="#008080"><b>{
        </b></font>writes<font color="#008080"><b>(</b></font>rotulo<font color="#008080"><b>(</b></font>sreg, 2<font color="#008080"><b>))
        </b></font>tCliente.nome:=<font color="#800000"><b>read</b></font><font color="#008080"><b>()
        </b></font>writes<font color="#008080"><b>(</b></font>rotulo<font color="#008080"><b>(</b></font>sreg, 3<font color="#008080"><b>))
        </b></font>tCliente.email:=<font color="#800000"><b>read</b></font><font color="#008080"><b>()
        </b></font>writes<font color="#008080"><b>(</b></font>rotulo<font color="#008080"><b>(</b></font>sreg, 4<font color="#008080"><b>))
        </b></font>tCliente.identidade:=<font color="#800000"><b>read</b></font><font color="#008080"><b>()
        </b></font>writes<font color="#008080"><b>(</b></font>rotulo<font color="#008080"><b>(</b></font>sreg, 5<font color="#008080"><b>))
        </b></font>tCliente.sexo:=<font color="#800000"><b>read</b></font><font color="#008080"><b>()
        </b></font>writes<font color="#008080"><b>(</b></font>rotulo<font color="#008080"><b>(</b></font>sreg, 6<font color="#008080"><b>))
        </b></font>tCliente.telefone:=<font color="#800000"><b>read</b></font><font color="#008080"><b>()
        </b></font>tCliente.dtnascimento:=
                validaDataHora<font color="#008080"><b>(</b></font>rotulo<font color="#008080"><b>(</b></font>sreg, 7<font color="#008080"><b>)</b></font>, tCliente.dtnascimento, true<font color="#008080"><b>)
        </b></font>mostrarSubDados<font color="#008080"><b>(</b></font>opCliente, opEndereco, false<font color="#008080"><b>)
        </b></font>mostrarSubDados<font color="#008080"><b>(</b></font>opCliente, opPais, false<font color="#008080"><b>)
        </b></font>mostrarSubDados<font color="#008080"><b>(</b></font>opCliente, opProfissao, false<font color="#008080"><b>)
       }
    </b></font>3: <font color="#008080"><b>{
        </b></font>tCliente.cpf:=trim<font color="#008080"><b>(</b></font>substr<font color="#008080"><b>(</b></font>slinha, 1, 14<font color="#008080"><b>))
        </b></font>tCliente.nome:=trim<font color="#008080"><b>(</b></font>substr<font color="#008080"><b>(</b></font>slinha, 15, 30<font color="#008080"><b>))
        </b></font>tCliente.email:=trim<font color="#008080"><b>(</b></font>substr<font color="#008080"><b>(</b></font>slinha, 45, 30<font color="#008080"><b>))
        </b></font>tCliente.identidade:=trim<font color="#008080"><b>(</b></font>substr<font color="#008080"><b>(</b></font>slinha, 75, 10<font color="#008080"><b>))
        </b></font>tCliente.sexo:=trim<font color="#008080"><b>(</b></font>substr<font color="#008080"><b>(</b></font>slinha, 85, 1<font color="#008080"><b>))
        </b></font>tCliente.telefone:=trim<font color="#008080"><b>(</b></font>substr<font color="#008080"><b>(</b></font>slinha, 86, 17<font color="#008080"><b>))
        </b></font>tCliente.dtnascimento:=trim<font color="#008080"><b>(</b></font>substr<font color="#008080"><b>(</b></font>slinha, 103, 10<font color="#008080"><b>))
        </b></font>tCliente.codendereco:=trim<font color="#008080"><b>(</b></font>substr<font color="#008080"><b>(</b></font>slinha, 113, 10<font color="#008080"><b>))
        </b></font>tCliente.codpais:=trim<font color="#008080"><b>(</b></font>substr<font color="#008080"><b>(</b></font>slinha, 123, 3<font color="#008080"><b>))
        </b></font>tCliente.codprofissao:=trim<font color="#008080"><b>(</b></font>substr<font color="#008080"><b>(</b></font>slinha, 126, 10<font color="#008080"><b>))
        </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;--------------------&quot;</font><font color="#008080"><b>)
        </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font>rotulo<font color="#008080"><b>(</b></font>sreg, 1<font color="#008080"><b>) </b></font>||  tCliente.cpf<font color="#008080"><b>)
        </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font>rotulo<font color="#008080"><b>(</b></font>sreg, 2<font color="#008080"><b>) </b></font>||  tCliente.nome<font color="#008080"><b>)
        </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font>rotulo<font color="#008080"><b>(</b></font>sreg, 3<font color="#008080"><b>) </b></font>||  tCliente.email<font color="#008080"><b>)
        </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font>rotulo<font color="#008080"><b>(</b></font>sreg, 4<font color="#008080"><b>) </b></font>||  tCliente.identidade<font color="#008080"><b>)
        </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font>rotulo<font color="#008080"><b>(</b></font>sreg, 5<font color="#008080"><b>) </b></font>||  tCliente.sexo<font color="#008080"><b>)
        </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font>rotulo<font color="#008080"><b>(</b></font>sreg, 6<font color="#008080"><b>) </b></font>||  tCliente.telefone<font color="#008080"><b>)
        </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font>rotulo<font color="#008080"><b>(</b></font>sreg, 7<font color="#008080"><b>) </b></font>||  tCliente.dtnascimento<font color="#008080"><b>)
        </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font>rotulo<font color="#008080"><b>(</b></font>sreg, 8<font color="#008080"><b>) </b></font>||  tCliente.codendereco<font color="#008080"><b>)
        </b></font>mostrarSubDados<font color="#008080"><b>(</b></font>opCliente, opEndereco, true<font color="#008080"><b>)
        </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font>rotulo<font color="#008080"><b>(</b></font>sreg, 9<font color="#008080"><b>) </b></font>||  tCliente.codpais<font color="#008080"><b>)
        </b></font>mostrarSubDados<font color="#008080"><b>(</b></font>opCliente, opPais, true<font color="#008080"><b>)
        </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font>rotulo<font color="#008080"><b>(</b></font>sreg, 10<font color="#008080"><b>) </b></font>||  tCliente.codprofissao<font color="#008080"><b>)
        </b></font>mostrarSubDados<font color="#008080"><b>(</b></font>opCliente, opProfissao, true<font color="#008080"><b>)
       }
  }
} </b></font><font color="#0000FF"><b>else if </b></font>member<font color="#008080"><b>(</b></font>ctArqs, sreg<font color="#008080"><b>) </b></font>= opVenda then <font color="#008080"><b>{
  </b></font><font color="#0000FF"><b>case </b></font>nOpcao of <font color="#008080"><b>{
    </b></font>1: mostrarSubDados<font color="#008080"><b>(</b></font>opVenda,opVenda, false<font color="#008080"><b>)
    </b></font>2: <font color="#008080"><b>{
        </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;DataHoraVenda       CPF            ISBN          &quot;</font>+
        <font color="#800000">&quot;Pre&ccedil;oVenda&quot;</font><font color="#008080"><b>)
        </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;-------------       ---            ----          &quot;</font>+
        <font color="#800000">&quot;----------&quot;</font><font color="#008080"><b>)
       }
    </b></font>3: <font color="#008080"><b>{
        </b></font>tVenda.dthrvenda:=substr<font color="#008080"><b>(</b></font>slinha, 1, 19<font color="#008080"><b>)
        </b></font>tVenda.cpf:=substr<font color="#008080"><b>(</b></font>slinha, 20, 14<font color="#008080"><b>)
        </b></font>tVenda.isbn:=substr<font color="#008080"><b>(</b></font>slinha, 34, 13<font color="#008080"><b>)
        </b></font>tVenda.precovenda:=substr<font color="#008080"><b>(</b></font>slinha, 47, 10<font color="#008080"><b>)
        </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font>tVenda.dthrvenda || <font color="#800000">&quot; &quot; </font>|| tVenda.cpf || <font color="#800000">&quot; &quot; </font>|| 
        tVenda.isbn || <font color="#800000">&quot; &quot; </font>|| tVenda.precovenda<font color="#008080"><b>)
       }
  }
}
</b></font><font color="#0000FF"><b>end
</b></font><font color="#808080">#------------------------------------------------------------------------------
# Mostra as sub inform&ccedil;&otilde;es de entrada e de sa&iacute;da.
# sreg - o tipo de arquivo
# ssubreg - o subtipo de arquivo
# bSoMostrar - se vai s&oacute; mostrar na sa&iacute;da 
#------------------------------------------------------------------------------
</font>procedure mostrarSubDados<font color="#008080"><b>(</b></font>sreg, ssubreg, bSoMostrar<font color="#008080"><b>)
</b></font><font color="#800000"><b>local </b></font>sRegistro, sPreco, nMaxTentativas

nMaxTentativas:=3
<font color="#0000FF"><b>if </b></font>member<font color="#008080"><b>(</b></font>ctArqs, sreg<font color="#008080"><b>) </b></font>= opLivro then <font color="#008080"><b>{
  </b></font><font color="#0000FF"><b>if </b></font>member<font color="#008080"><b>(</b></font>ctArqs, ssubreg<font color="#008080"><b>) </b></font>= opEditora then <font color="#008080"><b>{
    </b></font><font color="#0000FF"><b>if </b></font>bSoMostrar then
       sRegistro:=pesqArq<font color="#008080"><b>(</b></font>tfEditora,tLivro.codeditora,1,10,tamReg<font color="#008080"><b>(</b></font>opEditora<font color="#008080"><b>))
    </b></font><font color="#0000FF"><b>else
       </b></font>sRegistro:=validaEntrada<font color="#008080"><b>(</b></font>tfEditora,ssubreg,1,tLivro.codeditora,
                  nMaxTentativas,false,opNumero<font color="#008080"><b>)
    </b></font><font color="#0000FF"><b>if </b></font>sRegistro~==<font color="#800000">&quot;&quot; </font>then <font color="#008080"><b>{
      </b></font>tLivro.codeditora:=trim<font color="#008080"><b>(</b></font>substr<font color="#008080"><b>(</b></font>sRegistro,1,10<font color="#008080"><b>))
      </b></font>writes<font color="#008080"><b>(</b></font><font color="#800000">&quot; &quot; </font>|| rotulo<font color="#008080"><b>(</b></font>opEditora, 2<font color="#008080"><b>))
      </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font>substr<font color="#008080"><b>(</b></font>sRegistro, g_nPosChave, g_nTamChave<font color="#008080"><b>))
    }
  } </b></font><font color="#0000FF"><b>else if </b></font>member<font color="#008080"><b>(</b></font>ctArqs, ssubreg<font color="#008080"><b>) </b></font>= opIdioma then <font color="#008080"><b>{
    </b></font><font color="#0000FF"><b>if </b></font>bSoMostrar=true then
       sRegistro:=pesqArq<font color="#008080"><b>(</b></font>tfIdioma, tLivro.codidioma, 1, 10,tamReg<font color="#008080"><b>(</b></font>opIdioma<font color="#008080"><b>))
    </b></font><font color="#0000FF"><b>else
       </b></font>sRegistro:=validaEntrada<font color="#008080"><b>(</b></font>tfIdioma,ssubreg,1,tLivro.codidioma,
                  nMaxTentativas,false,opNumero<font color="#008080"><b>)
    </b></font><font color="#0000FF"><b>if </b></font>sRegistro~==<font color="#800000">&quot;&quot; </font>then <font color="#008080"><b>{
      </b></font>tLivro.codidioma:=trim<font color="#008080"><b>(</b></font>substr<font color="#008080"><b>(</b></font>sRegistro,1,10<font color="#008080"><b>))
      </b></font>writes<font color="#008080"><b>(</b></font><font color="#800000">&quot; &quot; </font>|| rotulo<font color="#008080"><b>(</b></font>opIdioma, 2<font color="#008080"><b>))
      </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font>substr<font color="#008080"><b>(</b></font>sRegistro, g_nPosChave, g_nTamChave<font color="#008080"><b>))
    }
  }
} </b></font><font color="#0000FF"><b>else if </b></font>member<font color="#008080"><b>(</b></font>ctArqs, sreg<font color="#008080"><b>) </b></font>= opCliente then <font color="#008080"><b>{
  </b></font><font color="#0000FF"><b>if </b></font>member<font color="#008080"><b>(</b></font>ctArqs, ssubreg<font color="#008080"><b>) </b></font>= opEndereco then <font color="#008080"><b>{
    </b></font><font color="#0000FF"><b>if </b></font>bSoMostrar=true then
       sRegistro:=pesqArq<font color="#008080"><b>(</b></font>tfEndereco, tCliente.codendereco, 1, 10,
                  tamReg<font color="#008080"><b>(</b></font>opEndereco<font color="#008080"><b>))
    </b></font><font color="#0000FF"><b>else
       </b></font>sRegistro:=validaEntrada<font color="#008080"><b>(</b></font>tfEndereco,ssubreg,1,tCliente.codendereco,
                  nMaxTentativas,false,opNumero<font color="#008080"><b>)
    </b></font><font color="#0000FF"><b>if </b></font>sRegistro~==<font color="#800000">&quot;&quot; </font>then <font color="#008080"><b>{
      </b></font>tCliente.codendereco:=trim<font color="#008080"><b>(</b></font>substr<font color="#008080"><b>(</b></font>sRegistro,1,10<font color="#008080"><b>))
      </b></font>writes<font color="#008080"><b>(</b></font><font color="#800000">&quot; &quot; </font>|| rotulo<font color="#008080"><b>(</b></font>opEndereco, 2<font color="#008080"><b>))
      </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font>substr<font color="#008080"><b>(</b></font>sRegistro, g_nPosChave, g_nTamChave<font color="#008080"><b>))
      </b></font>writes<font color="#008080"><b>(</b></font><font color="#800000">&quot; &quot; </font>|| rotulo<font color="#008080"><b>(</b></font>opEndereco, 3<font color="#008080"><b>))
      </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font>substr<font color="#008080"><b>(</b></font>sRegistro, g_nPosChave, g_nTamChave<font color="#008080"><b>))
      </b></font>writes<font color="#008080"><b>(</b></font><font color="#800000">&quot; &quot; </font>|| rotulo<font color="#008080"><b>(</b></font>opEndereco, 4<font color="#008080"><b>))
      </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font>substr<font color="#008080"><b>(</b></font>sRegistro, g_nPosChave, g_nTamChave<font color="#008080"><b>))
      </b></font>writes<font color="#008080"><b>(</b></font><font color="#800000">&quot; &quot; </font>|| rotulo<font color="#008080"><b>(</b></font>opEndereco, 5<font color="#008080"><b>))
      </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font>substr<font color="#008080"><b>(</b></font>sRegistro, g_nPosChave, g_nTamChave<font color="#008080"><b>))
      </b></font>writes<font color="#008080"><b>(</b></font><font color="#800000">&quot; &quot; </font>|| rotulo<font color="#008080"><b>(</b></font>opEndereco, 6<font color="#008080"><b>))
      </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font>substr<font color="#008080"><b>(</b></font>sRegistro, g_nPosChave, g_nTamChave<font color="#008080"><b>))
    }
  } </b></font><font color="#0000FF"><b>else if </b></font>member<font color="#008080"><b>(</b></font>ctArqs, ssubreg<font color="#008080"><b>) </b></font>= opPais then <font color="#008080"><b>{
    </b></font><font color="#0000FF"><b>if </b></font>bSoMostrar=true then
       sRegistro:=pesqArq<font color="#008080"><b>(</b></font>tfPais, tCliente.codpais, 1, 3, tamReg<font color="#008080"><b>(</b></font>opPais<font color="#008080"><b>))
    </b></font><font color="#0000FF"><b>else
       </b></font>sRegistro:=validaEntrada<font color="#008080"><b>(</b></font>tfPais,ssubreg,1,tCliente.codpais,
                  nMaxTentativas,false,opTexto<font color="#008080"><b>)
    </b></font><font color="#0000FF"><b>if </b></font>sRegistro~==<font color="#800000">&quot;&quot; </font>then <font color="#008080"><b>{
      </b></font>tCliente.codpais:=trim<font color="#008080"><b>(</b></font>substr<font color="#008080"><b>(</b></font>sRegistro,1,3<font color="#008080"><b>))
      </b></font>writes<font color="#008080"><b>(</b></font><font color="#800000">&quot; &quot; </font>|| rotulo<font color="#008080"><b>(</b></font>opPais, 2<font color="#008080"><b>))
      </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font>substr<font color="#008080"><b>(</b></font>sRegistro, g_nPosChave, g_nTamChave<font color="#008080"><b>))
    }
  } </b></font><font color="#0000FF"><b>else if </b></font>member<font color="#008080"><b>(</b></font>ctArqs, ssubreg<font color="#008080"><b>) </b></font>= opProfissao then <font color="#008080"><b>{
    </b></font><font color="#0000FF"><b>if </b></font>bSoMostrar=true then
       sRegistro:=pesqArq<font color="#008080"><b>(</b></font>tfProfissao, tCliente.codprofissao, 1, 10,
                  tamReg<font color="#008080"><b>(</b></font>opProfissao<font color="#008080"><b>))
    </b></font><font color="#0000FF"><b>else
       </b></font>sRegistro:=validaEntrada<font color="#008080"><b>(</b></font>tfProfissao,ssubreg,1,tCliente.codprofissao,
                  nMaxTentativas,false,opNumero<font color="#008080"><b>)
    </b></font><font color="#0000FF"><b>if </b></font>sRegistro~==<font color="#800000">&quot;&quot; </font>then <font color="#008080"><b>{
      </b></font>tCliente.codprofissao:=trim<font color="#008080"><b>(</b></font>substr<font color="#008080"><b>(</b></font>sRegistro,1,10<font color="#008080"><b>))
      </b></font>writes<font color="#008080"><b>(</b></font><font color="#800000">&quot; &quot; </font>|| rotulo<font color="#008080"><b>(</b></font>opProfissao, 2<font color="#008080"><b>))
      </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font>substr<font color="#008080"><b>(</b></font>sRegistro, g_nPosChave, g_nTamChave<font color="#008080"><b>))
    }
  }
} </b></font><font color="#0000FF"><b>else if </b></font>member<font color="#008080"><b>(</b></font>ctArqs, sreg<font color="#008080"><b>) </b></font>= opVenda then <font color="#008080"><b>{
  </b></font>sRegistro:=pesqArq<font color="#008080"><b>(</b></font>tfLivro, tVenda.isbn, 1, 13, tamReg<font color="#008080"><b>(</b></font>opLivro<font color="#008080"><b>))
  </b></font><font color="#0000FF"><b>if </b></font>sRegistro~==<font color="#800000">&quot;&quot; </font>then <font color="#008080"><b>{
    </b></font>writes<font color="#008080"><b>(</b></font><font color="#800000">&quot; &quot; </font>|| rotulo<font color="#008080"><b>(</b></font>opLivro, 2<font color="#008080"><b>)) </b></font><font color="#808080"># Titulo
    </font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font>substr<font color="#008080"><b>(</b></font>sRegistro, g_nPosChave, g_nTamChave<font color="#008080"><b>))
    </b></font>writes<font color="#008080"><b>(</b></font><font color="#800000">&quot; &quot; </font>|| rotulo<font color="#008080"><b>(</b></font>opLivro, 9<font color="#008080"><b>)) </b></font><font color="#808080"># Preco
    </font>sPreco:=substr<font color="#008080"><b>(</b></font>sRegistro, g_nPosChave, g_nTamChave<font color="#008080"><b>)
    </b></font>g_nPreco:=real<font color="#008080"><b>(</b></font>sPreco<font color="#008080"><b>)
    </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font>sPreco<font color="#008080"><b>)
  }
}
</b></font><font color="#0000FF"><b>end
</b></font><font color="#808080">#------------------------------------------------------------------------------
# Realiza os cadastros dos arquivos que se ligam a outros arquivos.
# sreg - o tipo de arquivo
# sacao - a a&ccedil;&atilde;o a ser realizada
# sCodigo - um das chaves do arquivo de liga&ccedil;&atilde;o
#------------------------------------------------------------------------------
</font>procedure frmCadLigados<font color="#008080"><b>(</b></font>sreg, sacao, sCodigo<font color="#008080"><b>)
</b></font><font color="#800000"><b>local </b></font>nQtd, nCont, nQtdEstoque, nTotalPreco, slinha, sTotalPreco, sPreco, sQtd

<font color="#0000FF"><b>if </b></font>member<font color="#008080"><b>(</b></font>ctAcao, sacao<font color="#008080"><b>) </b></font>= opNovo then <font color="#008080"><b>{
  </b></font>nCont:=1
  <font color="#0000FF"><b>if </b></font>member<font color="#008080"><b>(</b></font>ctArqs, sreg<font color="#008080"><b>) </b></font>= opLivroAss then <font color="#008080"><b>{
    </b></font>sQtd:=validaNumero<font color="#008080"><b>(</b></font><font color="#800000">&quot;Quantos assuntos quer cadastrar?: &quot;</font>, sQtd<font color="#008080"><b>)
    </b></font>nQtd:=integer<font color="#008080"><b>(</b></font>sQtd<font color="#008080"><b>)
    </b></font><font color="#800000"><b>seek</b></font><font color="#008080"><b>(</b></font>tfLivroAss, 1<font color="#008080"><b>)
    </b></font><font color="#0000FF"><b>while </b></font>nCont &lt;= nQtd do <font color="#008080"><b>{
      </b></font>tLivroAss.isbn:=sCodigo
      <font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font>rotulo<font color="#008080"><b>(</b></font>opLivroAss, 2<font color="#008080"><b>))
      </b></font>tLivroAss.codassunto:=<font color="#800000"><b>read</b></font><font color="#008080"><b>()
      </b></font>slinha:=pesqArq<font color="#008080"><b>(</b></font>tfAssunto, tLivroAss.codassunto,1,10,tamReg<font color="#008080"><b>(</b></font>opAssunto<font color="#008080"><b>))
      </b></font>writes<font color="#008080"><b>(</b></font><font color="#800000">&quot; &quot; </font>|| rotulo<font color="#008080"><b>(</b></font>opAssunto, 2<font color="#008080"><b>))
      </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font>substr<font color="#008080"><b>(</b></font>slinha, g_nPosChave, g_nTamChave<font color="#008080"><b>))
      </b></font>pesqLinhaExcluida<font color="#008080"><b>(</b></font>tfLivroAss, tamReg<font color="#008080"><b>(</b></font>sreg<font color="#008080"><b>))
      </b></font>subMenu<font color="#008080"><b>(14</b></font>, sreg<font color="#008080"><b>)
      </b></font>nCont+:=1
    <font color="#008080"><b>}
  } </b></font><font color="#0000FF"><b>else if </b></font>member<font color="#008080"><b>(</b></font>ctArqs, sreg<font color="#008080"><b>) </b></font>= opLivroAut then <font color="#008080"><b>{
    </b></font>sQtd:=validaNumero<font color="#008080"><b>(</b></font><font color="#800000">&quot;Quantos autores quer cadastrar?: &quot;</font>,sQtd<font color="#008080"><b>)
    </b></font>nQtd:=integer<font color="#008080"><b>(</b></font>sQtd<font color="#008080"><b>)
    </b></font><font color="#800000"><b>seek</b></font><font color="#008080"><b>(</b></font>tfLivroAut, 1<font color="#008080"><b>)
    </b></font><font color="#0000FF"><b>while </b></font>nCont &lt;= nQtd do <font color="#008080"><b>{
      </b></font>tLivroAut.isbn:=sCodigo
      <font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font>rotulo<font color="#008080"><b>(</b></font>opLivroAut, 2<font color="#008080"><b>))
      </b></font>tLivroAut.codautor:=<font color="#800000"><b>read</b></font><font color="#008080"><b>()
      </b></font>slinha:=pesqArq<font color="#008080"><b>(</b></font>tfAutor, tLivroAut.codautor,1,10,tamReg<font color="#008080"><b>(</b></font>opAutor<font color="#008080"><b>))
      </b></font>writes<font color="#008080"><b>(</b></font><font color="#800000">&quot; &quot; </font>|| rotulo<font color="#008080"><b>(</b></font>opAutor, 2<font color="#008080"><b>))
      </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font>substr<font color="#008080"><b>(</b></font>slinha, g_nPosChave, g_nTamChave<font color="#008080"><b>))
      </b></font>pesqLinhaExcluida<font color="#008080"><b>(</b></font>tfLivroAut, tamReg<font color="#008080"><b>(</b></font>sreg<font color="#008080"><b>))
      </b></font>subMenu<font color="#008080"><b>(14</b></font>, sreg<font color="#008080"><b>)
      </b></font>nCont+:=1
    <font color="#008080"><b>}
  } </b></font><font color="#0000FF"><b>else if </b></font>member<font color="#008080"><b>(</b></font>ctArqs, sreg<font color="#008080"><b>) </b></font>= opVenda then <font color="#008080"><b>{
    </b></font>sQtd:=validaNumero<font color="#008080"><b>(</b></font><font color="#800000">&quot;Quantos livros quer vender?: &quot;</font>,sQtd<font color="#008080"><b>)
    </b></font>nQtd:=integer<font color="#008080"><b>(</b></font>sQtd<font color="#008080"><b>)
    </b></font>nTotalPreco:=0
    <font color="#0000FF"><b>while </b></font>nCont &lt;= nQtd do <font color="#008080"><b>{
      </b></font>slinha:=validaEntrada<font color="#008080"><b>(</b></font>tfLivro,opLivro,1,tVenda.isbn,3,false,opTexto<font color="#008080"><b>)
      </b></font><font color="#0000FF"><b>if </b></font>slinha~==<font color="#800000">&quot;&quot; </font>then <font color="#008080"><b>{
        </b></font>tVenda.isbn:=trim<font color="#008080"><b>(</b></font>substr<font color="#008080"><b>(</b></font>slinha,1,13<font color="#008080"><b>))
        </b></font><font color="#0000FF"><b>if </b></font>validaISBN<font color="#008080"><b>(</b></font>tVenda.isbn<font color="#008080"><b>)</b></font>=true then <font color="#008080"><b>{
          </b></font>mostrarDados<font color="#008080"><b>(</b></font>sreg, <font color="#800000">&quot;&quot;</font>, 1<font color="#008080"><b>)
          </b></font>tLivro.qtdestoque:=trim<font color="#008080"><b>(</b></font>substr<font color="#008080"><b>(</b></font>slinha,134,10<font color="#008080"><b>))
          </b></font>nQtdEstoque:=integer<font color="#008080"><b>(</b></font>tLivro.qtdestoque<font color="#008080"><b>)
          </b></font><font color="#0000FF"><b>if </b></font>nQtdEstoque &gt; 0 then <font color="#008080"><b>{
             </b></font>nTotalPreco:=nTotalPreco + g_nPreco
             sPreco:=<font color="#800000"><b>string</b></font><font color="#008080"><b>(</b></font>g_nPreco<font color="#008080"><b>)
             </b></font>tVenda.precovenda:=sPreco
             g_SalvarInclusao:=false
             subMenu<font color="#008080"><b>(14</b></font>, sreg<font color="#008080"><b>)
             </b></font><font color="#0000FF"><b>if </b></font>g_SalvarInclusao=true then <font color="#008080"><b>{
                </b></font>slinha:=pesqArq<font color="#008080"><b>(</b></font>tfLivro, tVenda.isbn, 1, 13, tamReg<font color="#008080"><b>(</b></font>opLivro<font color="#008080"><b>))
                </b></font><font color="#0000FF"><b>if </b></font>slinha~==<font color="#800000">&quot;&quot; </font>then <font color="#008080"><b>{
                   </b></font>nQtdEstoque:=nQtdEstoque-1
                   tLivro.qtdestoque:=<font color="#800000"><b>string</b></font><font color="#008080"><b>(</b></font>nQtdEstoque<font color="#008080"><b>)
                   </b></font>slinha:=substr<font color="#008080"><b>(</b></font>slinha,1,133<font color="#008080"><b>) </b></font>|| left<font color="#008080"><b>(</b></font>tLivro.qtdestoque,10<font color="#008080"><b>)
                   </b></font>escreveArq<font color="#008080"><b>(</b></font>tfLivro, slinha, <font color="#800000">&quot;&quot;</font>, <font color="#800000">&quot;&quot;</font><font color="#008080"><b>)
                }
             }
             </b></font>nCont+:=1
          <font color="#008080"><b>} </b></font><font color="#0000FF"><b>else </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font>MSG_SEMESTOQUE<font color="#008080"><b>)
        } </b></font><font color="#0000FF"><b>else </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font>MSG_ISBNINV<font color="#008080"><b>)
      }
    }
    </b></font>sTotalPreco:=<font color="#800000"><b>string</b></font><font color="#008080"><b>(</b></font>nTotalPreco<font color="#008080"><b>)
    </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font><font color="#800000">&quot;Total de &quot; </font>|| rotulo<font color="#008080"><b>(</b></font>sreg,4<font color="#008080"><b>) </b></font>|| sTotalPreco<font color="#008080"><b>)
  }
} </b></font><font color="#0000FF"><b>else if </b></font>member<font color="#008080"><b>(</b></font>ctAcao, sacao<font color="#008080"><b>) </b></font>= opExcluir then <font color="#008080"><b>{
  </b></font><font color="#0000FF"><b>if </b></font>member<font color="#008080"><b>(</b></font>ctArqs, sreg<font color="#008080"><b>) </b></font>= opLivroAss then 
     ExcluirRegLigados<font color="#008080"><b>(</b></font>tfLivroAss, sreg, 1, 13, sCodigo<font color="#008080"><b>)
  </b></font><font color="#0000FF"><b>else if </b></font>member<font color="#008080"><b>(</b></font>ctArqs, sreg<font color="#008080"><b>) </b></font>= opLivroAut then
     ExcluirRegLigados<font color="#008080"><b>(</b></font>tfLivroAut, sreg, 1, 13, sCodigo<font color="#008080"><b>)
}
</b></font><font color="#0000FF"><b>end
</b></font><font color="#808080">#------------------------------------------------------------------------------
# Realiza a exclus&atilde;o dos arquivos de liga&ccedil;&atilde;o.
# sArq - o arquivo de liga&ccedil;&atilde;o
# sreg - o tipo de arquivo de liga&ccedil;&atilde;o
# nPosChave - a posicao inicial da chave dentro do registro
# nTamChave - o tamanho da chave dentro do registro
# sChave - a chave a ser excluida
#------------------------------------------------------------------------------
</font>procedure ExcluirRegLigados<font color="#008080"><b>(</b></font>sArq, sreg, nPosChave, nTamChave, sChave<font color="#008080"><b>)
</b></font><font color="#800000"><b>local </b></font>slinha, sCodigo

  <font color="#800000"><b>seek</b></font><font color="#008080"><b>(</b></font>sArq, 1<font color="#008080"><b>)
  </b></font><font color="#0000FF"><b>while </b></font>slinha := <font color="#800000"><b>read</b></font><font color="#008080"><b>(</b></font>sArq<font color="#008080"><b>) </b></font>do <font color="#008080"><b>{
    </b></font>sCodigo:=trim<font color="#008080"><b>(</b></font>substr<font color="#008080"><b>(</b></font>slinha,nPosChave,nTamChave<font color="#008080"><b>))
    </b></font><font color="#0000FF"><b>if </b></font><font color="#008080"><b>(</b></font>\sCodigo<font color="#008080"><b>) </b></font>&amp; <font color="#008080"><b>(</b></font>sCodigo==sChave<font color="#008080"><b>) </b></font>then
       btnAcao<font color="#008080"><b>(</b></font>sreg,opConfirmaExclusao<font color="#008080"><b>)
  }
</b></font><font color="#0000FF"><b>end
</b></font><font color="#808080">#------------------------------------------------------------------------------
# Parte inicial do c&oacute;digo
#------------------------------------------------------------------------------
</font>procedure <font color="#800000"><b>main</b></font><font color="#008080"><b>(</b></font>args<font color="#008080"><b>)
 </b></font>constantes<font color="#008080"><b>()
 </b></font><font color="#0000FF"><b>if </b></font>!args==<font color="#800000">&quot;-cria&quot; </font>then
   abrecriaArqs<font color="#008080"><b>(</b></font>false<font color="#008080"><b>)
 </b></font><font color="#0000FF"><b>else </b></font><font color="#008080"><b>{
   </b></font>frmSplash<font color="#008080"><b>()
   </b></font>abrecriaArqs<font color="#008080"><b>(</b></font>true<font color="#008080"><b>)
   </b></font><font color="#0000FF"><b>if </b></font>frmLogin<font color="#008080"><b>()</b></font>=true then <font color="#008080"><b>{
     </b></font>bopcao:=true
     <font color="#0000FF"><b>while </b></font><font color="#008080"><b>(</b></font>bopcao=true<font color="#008080"><b>) </b></font>do <font color="#008080"><b>{
       </b></font>menu<font color="#008080"><b>(1)
       </b></font>opmenu:=<font color="#800000"><b>read</b></font><font color="#008080"><b>()
       </b></font><font color="#0000FF"><b>if </b></font><font color="#008080"><b>(</b></font>opmenu==<font color="#800000">&quot;C&quot;</font><font color="#008080"><b>) </b></font>| <font color="#008080"><b>(</b></font>opmenu==<font color="#800000">&quot;c&quot;</font><font color="#008080"><b>) </b></font>then usaMenu<font color="#008080"><b>(1)
       </b></font><font color="#0000FF"><b>else if </b></font><font color="#008080"><b>(</b></font>opmenu==<font color="#800000">&quot;P&quot;</font><font color="#008080"><b>) </b></font>| <font color="#008080"><b>(</b></font>opmenu==<font color="#800000">&quot;p&quot;</font><font color="#008080"><b>) </b></font>then usaMenu<font color="#008080"><b>(2)
       </b></font><font color="#0000FF"><b>else if </b></font><font color="#008080"><b>(</b></font>opmenu==<font color="#800000">&quot;V&quot;</font><font color="#008080"><b>) </b></font>| <font color="#008080"><b>(</b></font>opmenu==<font color="#800000">&quot;v&quot;</font><font color="#008080"><b>) </b></font>then usaMenu<font color="#008080"><b>(3)
       </b></font><font color="#0000FF"><b>else if </b></font><font color="#008080"><b>(</b></font>opmenu==<font color="#800000">&quot;O&quot;</font><font color="#008080"><b>) </b></font>| <font color="#008080"><b>(</b></font>opmenu==<font color="#800000">&quot;o&quot;</font><font color="#008080"><b>) </b></font>then usaMenu<font color="#008080"><b>(4)
       </b></font><font color="#0000FF"><b>else </b></font><font color="#800000"><b>write</b></font><font color="#008080"><b>(</b></font>MSG_ERRO<font color="#008080"><b>)
     }
   } </b></font><font color="#0000FF"><b>else </b></font><font color="#008080"><b>{
     </b></font>fechaArqs<font color="#008080"><b>()
     </b></font><font color="#800000"><b>exit</b></font><font color="#008080"><b>(0)
   }
 }
</b></font><font color="#0000FF"><b>end
</b></font></font>
</code></pre>
</body>
</html>