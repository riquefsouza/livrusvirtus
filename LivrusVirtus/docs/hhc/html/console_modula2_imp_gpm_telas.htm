<html>
<head>
<title>Livrus Virtus - Console - Modula-2 - Implementação - GPM - Telas</title>
</head>
<!-- Generated by ConTEXT HTML exporter -->
<body text="#000000" bgcolor="#FFFFFF">
<pre>
<code><font  face="Courier New"><font color="#0000FF">IMPLEMENTATION MODULE </font>Telas<font color="#808080">;

</font><font color="#0000FF">FROM </font>Rotinas <font color="#0000FF">IMPORT </font>String<font color="#808080">, </font>WriteLinha<font color="#808080">, </font>ReadLinha<font color="#808080">, </font>Ss<font color="#808080">,
</font>copy<font color="#808080">, </font>trim<font color="#808080">, </font>esp<font color="#808080">, </font>validaCPF<font color="#808080">, </font>validaISBN<font color="#808080">, </font>digitaSenha<font color="#808080">, </font>validaNumero<font color="#808080">, 
</font>retDataHora<font color="#808080">;
</font><font color="#0000FF">FROM </font>Arquivos <font color="#0000FF">IMPORT </font>tfAssunto<font color="#808080">, </font>tfAutor<font color="#808080">, </font>tfEditora<font color="#808080">, 
</font>tfIdioma<font color="#808080">, </font>tfEndereco<font color="#808080">, </font>tfPais<font color="#808080">, </font>tfProfissao<font color="#808080">, </font>tfLivro<font color="#808080">, </font>tfLivroAss<font color="#808080">, 
</font>tfLivroAut<font color="#808080">, </font>tfCliente<font color="#808080">, </font>tfUsuario<font color="#808080">, </font>tfVenda<font color="#808080">,
</font>tAssunto<font color="#808080">, </font>tAutor<font color="#808080">, </font>tEditora<font color="#808080">, </font>tIdioma<font color="#808080">, </font>tEndereco<font color="#808080">, </font>tPais<font color="#808080">, 
</font>tProfissao<font color="#808080">, </font>tLivro<font color="#808080">, </font>tLivroAss<font color="#808080">, </font>tLivroAut<font color="#808080">, </font>tCliente<font color="#808080">, </font>tUsuario<font color="#808080">, </font>tVenda<font color="#808080">,
</font>fechaArqs<font color="#808080">, </font>pesqArq<font color="#808080">, </font>pesqLinhaExcluida<font color="#808080">, </font>pesqMaxCod<font color="#808080">, </font>escreveArq<font color="#808080">,
</font>ctArqs<font color="#808080">, </font>ctAcao<font color="#808080">, </font>ctTipo<font color="#808080">, </font>tamReg<font color="#808080">;
</font><font color="#0000FF">FROM </font>Sistema <font color="#0000FF">IMPORT </font>QTD_MAX_LINHA<font color="#808080">, </font>MSG_ERRO<font color="#808080">, 
</font>g_nPosChave<font color="#808080">, </font>g_nTamChave<font color="#808080">, </font>g_nPreco<font color="#808080">, </font>rotulo<font color="#808080">, </font>menu<font color="#808080">, 
</font>ListarTodos<font color="#808080">, </font>validaEntrada<font color="#808080">, </font>mostrarDados<font color="#808080">, </font>btnAcao<font color="#808080">, </font>ExcluirRegLigados<font color="#808080">;
</font><font color="#0000FF">FROM </font>WholeStr <font color="#0000FF">IMPORT </font>StrToCard<font color="#808080">, </font>CardToStr<font color="#808080">;
</font><font color="#0000FF">IMPORT </font>RealConv<font color="#808080">;
</font><font color="#0000FF">FROM </font>RealStr <font color="#0000FF">IMPORT </font>ConvResults<font color="#808080">, </font>RealToStr<font color="#808080">; 
</font><font color="#0000FF">FROM </font>Strings <font color="#0000FF">IMPORT </font>Length<font color="#808080">, </font>Compare<font color="#808080">, </font>CompareResults<font color="#808080">;
</font><font color="#0000FF">FROM </font>RndFile <font color="#0000FF">IMPORT </font>SetPos<font color="#808080">;
</font><font color="#0000FF">FROM </font>InOut <font color="#0000FF">IMPORT </font>Read<font color="#808080">, </font>ReadLn<font color="#808080">, </font>WriteLn<font color="#808080">, </font>ReadInt<font color="#808080">, </font>WriteString<font color="#808080">;

(*------------------------------------------------------------------------------
</font>Mostra a tela de splash do sistema.
<font color="#808080">------------------------------------------------------------------------------*)
</font><font color="#0000FF">PROCEDURE </font>frmSplash<font color="#808080">();
</font><font color="#0000FF">VAR </font>cont<font color="#808080">: </font><font color="#0000FF">CARDINAL</font><font color="#808080">;
</font><font color="#0000FF">BEGIN
 </font>WriteLinha<font color="#808080">(</font><font color="#800000">'*---------------------------------------'</font><font color="#808080">+
 </font><font color="#800000">'-------------------------------------*'</font><font color="#808080">);
 </font>WriteLinha<font color="#808080">(</font><font color="#800000">'| LL    II VV   VV RRRRR  UU  UU   SSSS '</font><font color="#808080">+
 </font><font color="#800000">'VV   VV II RRRRR  TTTT UU  UU   SSSS |'</font><font color="#808080">);
 </font>WriteLinha<font color="#808080">(</font><font color="#800000">'| LL    II  VV VV  RR   R UU  UU  SS    '</font><font color="#808080">+
 </font><font color="#800000">' VV VV  II RR   R  TT  UU  UU  SS    |'</font><font color="#808080">);
 </font>WriteLinha<font color="#808080">(</font><font color="#800000">'| LL    II   VVV   RRRRR  UU  UU    SS  '</font><font color="#808080">+
 </font><font color="#800000">'  VVV   II RRRRR   TT  UU  UU    SS  |'</font><font color="#808080">);
 </font>WriteLinha<font color="#808080">(</font><font color="#800000">'| LLLLL II    V    RR   R  UUUU  SSSS   '</font><font color="#808080">+
 </font><font color="#800000">'   V    II RR   R  TT   UUUU  SSSS   |'</font><font color="#808080">);
 </font>WriteLinha<font color="#808080">(</font><font color="#800000">'*---------------------------------------'</font><font color="#808080">+
 </font><font color="#800000">'-------------------------------------*'</font><font color="#808080">);
 </font><font color="#0000FF">FOR </font>cont<font color="#808080">:=</font><font color="#FF0000">1 </font><font color="#0000FF">TO </font><font color="#FF0000">18 </font><font color="#0000FF">DO 
   </font>WriteLn<font color="#808080">;
 </font><font color="#0000FF">END</font><font color="#808080">; 
 </font>WriteString<font color="#808080">(</font>MSG_PRESS<font color="#808080">);
 </font>ReadLn<font color="#808080">;
</font><font color="#0000FF">END </font>frmSplash<font color="#808080">;
(*------------------------------------------------------------------------------
</font>Mostra a tela de sobre do sistema.
<font color="#808080">------------------------------------------------------------------------------*)
</font><font color="#0000FF">PROCEDURE </font>frmSobre<font color="#808080">();
</font><font color="#0000FF">VAR </font>cont<font color="#808080">: </font><font color="#0000FF">CARDINAL</font><font color="#808080">;
</font><font color="#0000FF">BEGIN
 </font>WriteLinha<font color="#808080">(</font><font color="#800000">'*------------------------------------------------------------*'</font><font color="#808080">);
 </font>WriteLinha<font color="#808080">(</font><font color="#800000">'|  LL        II  VV       VV  RRRRRRR   UU    UU   SSSSSSS   |'</font><font color="#808080">);
 </font>WriteLinha<font color="#808080">(</font><font color="#800000">'|  LL        II   VV     VV   RR     R  UU    UU  SS         |'</font><font color="#808080">);
 </font>WriteLinha<font color="#808080">(</font><font color="#800000">'|  LL        II    VV   VV    RR     R  UU    UU   SSSS      |'</font><font color="#808080">);
 </font>WriteLinha<font color="#808080">(</font><font color="#800000">'|  LL        II     VV VV     RRRRRRR   UU    UU     SSSS    |'</font><font color="#808080">);
 </font>WriteLinha<font color="#808080">(</font><font color="#800000">'|  LLLL      II      VVV      RR RR     UU    UU        SS   |'</font><font color="#808080">);
 </font>WriteLinha<font color="#808080">(</font><font color="#800000">'|  LLLLLLLL  II       V       RR   RR    UUUUUU   SSSSSSSS   |'</font><font color="#808080">);
 </font>WriteLinha<font color="#808080">(</font><font color="#800000">'|                                                            |'</font><font color="#808080">);
 </font>WriteLinha<font color="#808080">(</font><font color="#800000">'|  VV       VV  II  RRRRRRR   TTTTTTTT  UU    UU   SSSSSSS   |'</font><font color="#808080">);
 </font>WriteLinha<font color="#808080">(</font><font color="#800000">'|   VV     VV   II  RR     R     TT     UU    UU  SS         |'</font><font color="#808080">);
 </font>WriteLinha<font color="#808080">(</font><font color="#800000">'|    VV   VV    II  RR     R     TT     UU    UU   SSSS      |'</font><font color="#808080">);
 </font>WriteLinha<font color="#808080">(</font><font color="#800000">'|     VV VV     II  RRRRRRR      TT     UU    UU     SSSS    |'</font><font color="#808080">);
 </font>WriteLinha<font color="#808080">(</font><font color="#800000">'|      VVV      II  RR RR        TT     UU    UU        SS   |'</font><font color="#808080">);
 </font>WriteLinha<font color="#808080">(</font><font color="#800000">'|       V       II  RR   RR      TT      UUUUUU   SSSSSSSS   |'</font><font color="#808080">);
 </font>WriteLinha<font color="#808080">(</font><font color="#800000">'|                                                            |'</font><font color="#808080">);
 </font>WriteLinha<font color="#808080">(</font><font color="#800000">'|                                               Versao 1.0.0 |'</font><font color="#808080">);
 </font>WriteLinha<font color="#808080">(</font><font color="#800000">'| Sistema integrante do projeto Livrus Virtus.               |'</font><font color="#808080">);
 </font>WriteLinha<font color="#808080">(</font><font color="#800000">'| Todos os direitos reservados para Henrique F. de Souza.    |'</font><font color="#808080">);
 </font>WriteLinha<font color="#808080">(</font><font color="#800000">'| Versao programada na linguagem modula 2.                   |'</font><font color="#808080">);
 </font>WriteLinha<font color="#808080">(</font><font color="#800000">'*------------------------------------------------------------*'</font><font color="#808080">);
 </font><font color="#0000FF">FOR </font>cont<font color="#808080">:=</font><font color="#FF0000">1 </font><font color="#0000FF">TO </font><font color="#FF0000">4 </font><font color="#0000FF">DO 
   </font>WriteLn<font color="#808080">;
 </font><font color="#0000FF">END</font><font color="#808080">;
 </font>WriteString<font color="#808080">(</font>MSG_PRESS<font color="#808080">);
 </font>ReadLn<font color="#808080">;
</font><font color="#0000FF">END </font>frmSobre<font color="#808080">;
(*------------------------------------------------------------------------------
</font>Mostra a tela de login do sistema.
retorna <font color="#808080">- </font>se o login foi validado corretamente
<font color="#808080">------------------------------------------------------------------------------*)
</font><font color="#0000FF">PROCEDURE </font>frmLogin<font color="#808080">(): </font><font color="#0000FF">BOOLEAN</font><font color="#808080">;
</font><font color="#0000FF">VAR </font>bret<font color="#808080">: </font><font color="#0000FF">BOOLEAN</font><font color="#808080">;
    </font>slinha<font color="#808080">: </font>String<font color="#808080">;
</font><font color="#0000FF">BEGIN
  </font>bret<font color="#808080">:=</font>FALSE<font color="#808080">;
  </font>WriteLinha<font color="#808080">(</font><font color="#800000">'*--------------------------------------------------------------*'</font><font color="#808080">);
  </font>WriteLinha<font color="#808080">(</font><font color="#800000">'| Login do sistema                                             |'</font><font color="#808080">);
  </font>WriteLinha<font color="#808080">(</font><font color="#800000">'*--------------------------------------------------------------*'</font><font color="#808080">);
  </font>slinha<font color="#808080">:=</font>validaEntrada<font color="#808080">(</font>tfUsuario<font color="#808080">, </font>opUsuario<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font>tUsuario.login<font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">, </font>FALSE<font color="#808080">, </font>opTexto<font color="#808080">);
  </font><font color="#0000FF">IF </font>Compare<font color="#808080">(</font>slinha<font color="#808080">,</font><font color="#800000">''</font><font color="#808080">)&lt;&gt;</font>equal <font color="#0000FF">THEN 
     </font>slinha<font color="#808080">:=</font>validaEntrada<font color="#808080">(</font>tfUsuario<font color="#808080">, </font>opUsuario<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">, </font>tUsuario.senha<font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">,
        </font>FALSE<font color="#808080">, </font>opSenha<font color="#808080">);
     </font><font color="#0000FF">IF </font>Compare<font color="#808080">(</font>slinha<font color="#808080">,</font><font color="#800000">''</font><font color="#808080">)&lt;&gt;</font>equal <font color="#0000FF">THEN 
        </font>tUsuario.login<font color="#808080">:=</font>trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">));
        </font>tUsuario.senha<font color="#808080">:=</font>trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">11</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">));
        </font>bret<font color="#808080">:=</font>TRUE<font color="#808080">;
     </font><font color="#0000FF">END</font><font color="#808080">;
  </font><font color="#0000FF">END</font><font color="#808080">;
  </font>WriteLn<font color="#808080">;
  </font><font color="#0000FF">RETURN </font>bret<font color="#808080">;
</font><font color="#0000FF">END </font>frmLogin<font color="#808080">;

(*------------------------------------------------------------------------------
</font>Realiza os cadastros de acordo com o tipo de arquivo.
sreg <font color="#808080">- </font>o tipo de arquivo
sacao <font color="#808080">- </font>a a<font color="#808080">&ccedil;&atilde;</font>o a ser realizada
<font color="#808080">------------------------------------------------------------------------------*)
</font><font color="#0000FF">PROCEDURE </font>frmCadastros<font color="#808080">(</font>sreg<font color="#808080">: </font>ctArqs<font color="#808080">; </font>sacao<font color="#808080">: </font>ctAcao<font color="#808080">);
</font><font color="#0000FF">VAR </font>slinha<font color="#808080">: </font>String<font color="#808080">;
</font><font color="#0000FF">BEGIN
IF </font>sreg<font color="#808080">=</font>opAssunto <font color="#0000FF">THEN 
   IF </font>sacao<font color="#808080">=</font>opNovo <font color="#0000FF">THEN 
      </font>tAssunto.codigo<font color="#808080">:=</font>pesqMaxCod<font color="#808080">(</font>tfAssunto<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">));
      </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#800000">''</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">);
      </font>subMenu<font color="#808080">(</font><font color="#FF0000">7</font><font color="#808080">, </font>sreg<font color="#808080">);
   </font><font color="#0000FF">ELSIF </font>sacao<font color="#808080">=</font>opPesquisar <font color="#0000FF">THEN 
     </font>slinha<font color="#808080">:=</font>validaEntrada<font color="#808080">(</font>tfAssunto<font color="#808080">,</font>sreg<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font>tAssunto.codigo<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font>FALSE<font color="#808080">,</font>opNumero<font color="#808080">);
      </font><font color="#0000FF">IF </font>Compare<font color="#808080">(</font>slinha<font color="#808080">,</font><font color="#800000">''</font><font color="#808080">)&lt;&gt;</font>equal <font color="#0000FF">THEN 
        </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#800000">''</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">);
        </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font>slinha<font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">);
        </font>subMenu<font color="#808080">(</font><font color="#FF0000">8</font><font color="#808080">, </font>sreg<font color="#808080">);
      </font><font color="#0000FF">END</font><font color="#808080">;
   </font><font color="#0000FF">ELSIF </font>sacao<font color="#808080">=</font>opAlterar <font color="#0000FF">THEN 
      </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#800000">''</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">);
      </font>subMenu<font color="#808080">(</font><font color="#FF0000">9</font><font color="#808080">, </font>sreg<font color="#808080">);
   </font><font color="#0000FF">ELSIF </font>sacao<font color="#808080">=</font>opExcluir <font color="#0000FF">THEN 
      </font>subMenu<font color="#808080">(</font><font color="#FF0000">10</font><font color="#808080">, </font>sreg<font color="#808080">);
   </font><font color="#0000FF">END</font><font color="#808080">;
</font><font color="#0000FF">ELSIF </font>sreg<font color="#808080">=</font>opAutor <font color="#0000FF">THEN 
   IF </font>sacao<font color="#808080">=</font>opNovo <font color="#0000FF">THEN 
      </font>tAutor.codigo<font color="#808080">:=</font>pesqMaxCod<font color="#808080">(</font>tfAutor<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">));
      </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#800000">''</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">);
      </font>subMenu<font color="#808080">(</font><font color="#FF0000">7</font><font color="#808080">, </font>sreg<font color="#808080">);
   </font><font color="#0000FF">ELSIF </font>sacao<font color="#808080">=</font>opPesquisar <font color="#0000FF">THEN 
      </font>slinha<font color="#808080">:=</font>validaEntrada<font color="#808080">(</font>tfAutor<font color="#808080">, </font>sreg<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font>tAutor.codigo<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font>FALSE<font color="#808080">,</font>opNumero<font color="#808080">);
      </font><font color="#0000FF">IF </font>Compare<font color="#808080">(</font>slinha<font color="#808080">,</font><font color="#800000">''</font><font color="#808080">)&lt;&gt;</font>equal <font color="#0000FF">THEN 
        </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#800000">''</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">);
        </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font>slinha<font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">);
        </font>subMenu<font color="#808080">(</font><font color="#FF0000">8</font><font color="#808080">, </font>sreg<font color="#808080">);
      </font><font color="#0000FF">END</font><font color="#808080">;
   </font><font color="#0000FF">ELSIF </font>sacao<font color="#808080">=</font>opAlterar <font color="#0000FF">THEN 
      </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#800000">''</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">);
      </font>subMenu<font color="#808080">(</font><font color="#FF0000">9</font><font color="#808080">, </font>sreg<font color="#808080">);
   </font><font color="#0000FF">ELSIF </font>sacao<font color="#808080">=</font>opExcluir <font color="#0000FF">THEN 
      </font>subMenu<font color="#808080">(</font><font color="#FF0000">10</font><font color="#808080">, </font>sreg<font color="#808080">);
   </font><font color="#0000FF">END</font><font color="#808080">;
</font><font color="#0000FF">ELSIF </font>sreg<font color="#808080">=</font>opEditora <font color="#0000FF">THEN 
   IF </font>sacao<font color="#808080">=</font>opNovo <font color="#0000FF">THEN 
      </font>tEditora.codigo<font color="#808080">:=</font>pesqMaxCod<font color="#808080">(</font>tfEditora<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">));
      </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#800000">''</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">);
      </font>subMenu<font color="#808080">(</font><font color="#FF0000">7</font><font color="#808080">, </font>sreg<font color="#808080">);
   </font><font color="#0000FF">ELSIF </font>sacao<font color="#808080">=</font>opPesquisar <font color="#0000FF">THEN 
     </font>slinha<font color="#808080">:=</font>validaEntrada<font color="#808080">(</font>tfEditora<font color="#808080">,</font>sreg<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font>tEditora.codigo<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font>FALSE<font color="#808080">,</font>opNumero<font color="#808080">);
      </font><font color="#0000FF">IF </font>Compare<font color="#808080">(</font>slinha<font color="#808080">,</font><font color="#800000">''</font><font color="#808080">)&lt;&gt;</font>equal <font color="#0000FF">THEN 
        </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#800000">''</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">);
        </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font>slinha<font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">);
        </font>subMenu<font color="#808080">(</font><font color="#FF0000">8</font><font color="#808080">, </font>sreg<font color="#808080">);
      </font><font color="#0000FF">END</font><font color="#808080">;
   </font><font color="#0000FF">ELSIF </font>sacao<font color="#808080">=</font>opAlterar <font color="#0000FF">THEN 
      </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#800000">''</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">);
      </font>subMenu<font color="#808080">(</font><font color="#FF0000">9</font><font color="#808080">, </font>sreg<font color="#808080">);
   </font><font color="#0000FF">ELSIF </font>sacao<font color="#808080">=</font>opExcluir <font color="#0000FF">THEN 
      </font>subMenu<font color="#808080">(</font><font color="#FF0000">10</font><font color="#808080">, </font>sreg<font color="#808080">);
   </font><font color="#0000FF">END</font><font color="#808080">;
</font><font color="#0000FF">ELSIF </font>sreg<font color="#808080">=</font>opEndereco <font color="#0000FF">THEN 
   IF </font>sacao<font color="#808080">=</font>opNovo <font color="#0000FF">THEN 
      </font>tEndereco.codigo<font color="#808080">:=</font>pesqMaxCod<font color="#808080">(</font>tfEndereco<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">));
      </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#800000">''</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">);
      </font>subMenu<font color="#808080">(</font><font color="#FF0000">7</font><font color="#808080">, </font>sreg<font color="#808080">);
   </font><font color="#0000FF">ELSIF </font>sacao<font color="#808080">=</font>opPesquisar <font color="#0000FF">THEN 
      </font>slinha<font color="#808080">:=</font>validaEntrada<font color="#808080">(</font>tfEndereco<font color="#808080">,</font>sreg<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font>tEndereco.codigo<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,
              </font>FALSE<font color="#808080">,</font>opNumero<font color="#808080">);
      </font><font color="#0000FF">IF </font>Compare<font color="#808080">(</font>slinha<font color="#808080">,</font><font color="#800000">''</font><font color="#808080">)&lt;&gt;</font>equal <font color="#0000FF">THEN 
        </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#800000">''</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">);
        </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font>slinha<font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">);
        </font>subMenu<font color="#808080">(</font><font color="#FF0000">8</font><font color="#808080">, </font>sreg<font color="#808080">);
      </font><font color="#0000FF">END</font><font color="#808080">;
   </font><font color="#0000FF">ELSIF </font>sacao<font color="#808080">=</font>opAlterar <font color="#0000FF">THEN 
      </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#800000">''</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">);
      </font>subMenu<font color="#808080">(</font><font color="#FF0000">9</font><font color="#808080">, </font>sreg<font color="#808080">);
   </font><font color="#0000FF">ELSIF </font>sacao<font color="#808080">=</font>opExcluir <font color="#0000FF">THEN 
      </font>subMenu<font color="#808080">(</font><font color="#FF0000">10</font><font color="#808080">, </font>sreg<font color="#808080">);
   </font><font color="#0000FF">END</font><font color="#808080">;
</font><font color="#0000FF">ELSIF </font>sreg<font color="#808080">=</font>opIdioma <font color="#0000FF">THEN 
   IF </font>sacao<font color="#808080">=</font>opNovo <font color="#0000FF">THEN 
      </font>tIdioma.codigo<font color="#808080">:=</font>pesqMaxCod<font color="#808080">(</font>tfIdioma<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">));
      </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#800000">''</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">);
      </font>subMenu<font color="#808080">(</font><font color="#FF0000">7</font><font color="#808080">, </font>sreg<font color="#808080">);
   </font><font color="#0000FF">ELSIF </font>sacao<font color="#808080">=</font>opPesquisar <font color="#0000FF">THEN 
      </font>slinha<font color="#808080">:=</font>validaEntrada<font color="#808080">(</font>tfIdioma<font color="#808080">,</font>sreg<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font>tIdioma.codigo<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font>FALSE<font color="#808080">,</font>opNumero<font color="#808080">);
      </font><font color="#0000FF">IF </font>Compare<font color="#808080">(</font>slinha<font color="#808080">,</font><font color="#800000">''</font><font color="#808080">)&lt;&gt;</font>equal <font color="#0000FF">THEN 
        </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#800000">''</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">);
        </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font>slinha<font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">);
        </font>subMenu<font color="#808080">(</font><font color="#FF0000">8</font><font color="#808080">, </font>sreg<font color="#808080">);
      </font><font color="#0000FF">END</font><font color="#808080">;
   </font><font color="#0000FF">ELSIF </font>sacao<font color="#808080">=</font>opAlterar <font color="#0000FF">THEN 
      </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#800000">''</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">);
      </font>subMenu<font color="#808080">(</font><font color="#FF0000">9</font><font color="#808080">, </font>sreg<font color="#808080">);
   </font><font color="#0000FF">ELSIF </font>sacao<font color="#808080">=</font>opExcluir <font color="#0000FF">THEN 
      </font>subMenu<font color="#808080">(</font><font color="#FF0000">10</font><font color="#808080">, </font>sreg<font color="#808080">);
   </font><font color="#0000FF">END</font><font color="#808080">;
</font><font color="#0000FF">ELSIF </font>sreg<font color="#808080">=</font>opPais <font color="#0000FF">THEN 
   IF </font>sacao<font color="#808080">=</font>opNovo <font color="#0000FF">THEN 
      </font>WriteString<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">));
      </font>ReadLinha<font color="#808080">(</font>tPais.codigo<font color="#808080">);
      </font>slinha<font color="#808080">:=</font>pesqArq<font color="#808080">(</font>tfPais<font color="#808080">, </font>tPais.codigo<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">));
      </font><font color="#0000FF">IF </font>Compare<font color="#808080">(</font>slinha<font color="#808080">,</font><font color="#800000">''</font><font color="#808080">)=</font>equal <font color="#0000FF">THEN 
         </font>pesqLinhaExcluida<font color="#808080">(</font>tfPais<font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">));
         </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#800000">''</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">);
         </font>subMenu<font color="#808080">(</font><font color="#FF0000">7</font><font color="#808080">, </font>sreg<font color="#808080">);
      </font><font color="#0000FF">ELSE </font>WriteLinha<font color="#808080">(</font>MSG_REGEXST<font color="#808080">);
      </font><font color="#0000FF">END</font><font color="#808080">;
   </font><font color="#0000FF">ELSIF </font>sacao<font color="#808080">=</font>opPesquisar <font color="#0000FF">THEN 
      </font>slinha<font color="#808080">:=</font>validaEntrada<font color="#808080">(</font>tfPais<font color="#808080">, </font>sreg<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font>tPais.codigo<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font>FALSE<font color="#808080">, </font>opTexto<font color="#808080">);
      </font><font color="#0000FF">IF </font>Compare<font color="#808080">(</font>slinha<font color="#808080">,</font><font color="#800000">''</font><font color="#808080">)&lt;&gt;</font>equal <font color="#0000FF">THEN 
        </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#800000">''</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">);
        </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font>slinha<font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">);
        </font>subMenu<font color="#808080">(</font><font color="#FF0000">8</font><font color="#808080">, </font>sreg<font color="#808080">);
      </font><font color="#0000FF">END</font><font color="#808080">;
   </font><font color="#0000FF">ELSIF </font>sacao<font color="#808080">=</font>opAlterar <font color="#0000FF">THEN 
      </font>WriteLinha<font color="#808080">(</font>Ss<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">), </font>tPais.codigo<font color="#808080">));
      </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#800000">''</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">);
      </font>subMenu<font color="#808080">(</font><font color="#FF0000">9</font><font color="#808080">, </font>sreg<font color="#808080">);
   </font><font color="#0000FF">ELSIF </font>sacao<font color="#808080">=</font>opExcluir <font color="#0000FF">THEN 
      </font>subMenu<font color="#808080">(</font><font color="#FF0000">10</font><font color="#808080">, </font>sreg<font color="#808080">);
   </font><font color="#0000FF">END</font><font color="#808080">;
</font><font color="#0000FF">ELSIF </font>sreg<font color="#808080">=</font>opProfissao <font color="#0000FF">THEN 
   IF </font>sacao<font color="#808080">=</font>opNovo <font color="#0000FF">THEN 
      </font>tProfissao.codigo<font color="#808080">:=</font>pesqMaxCod<font color="#808080">(</font>tfProfissao<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">));
      </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#800000">''</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">);
      </font>subMenu<font color="#808080">(</font><font color="#FF0000">7</font><font color="#808080">, </font>sreg<font color="#808080">);
   </font><font color="#0000FF">ELSIF </font>sacao<font color="#808080">=</font>opPesquisar <font color="#0000FF">THEN 
      </font>slinha<font color="#808080">:=</font>validaEntrada<font color="#808080">(</font>tfProfissao<font color="#808080">,</font>sreg<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font>tProfissao.codigo<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,
              </font>FALSE<font color="#808080">,</font>opNumero<font color="#808080">);
      </font><font color="#0000FF">IF </font>Compare<font color="#808080">(</font>slinha<font color="#808080">,</font><font color="#800000">''</font><font color="#808080">)&lt;&gt;</font>equal <font color="#0000FF">THEN 
        </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#800000">''</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">);
        </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font>slinha<font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">);
        </font>subMenu<font color="#808080">(</font><font color="#FF0000">8</font><font color="#808080">, </font>sreg<font color="#808080">);
      </font><font color="#0000FF">END</font><font color="#808080">;
   </font><font color="#0000FF">ELSIF </font>sacao<font color="#808080">=</font>opAlterar <font color="#0000FF">THEN 
      </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#800000">''</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">);
      </font>subMenu<font color="#808080">(</font><font color="#FF0000">9</font><font color="#808080">, </font>sreg<font color="#808080">);
   </font><font color="#0000FF">ELSIF </font>sacao<font color="#808080">=</font>opExcluir <font color="#0000FF">THEN 
      </font>subMenu<font color="#808080">(</font><font color="#FF0000">10</font><font color="#808080">, </font>sreg<font color="#808080">);
   </font><font color="#0000FF">END</font><font color="#808080">;
</font><font color="#0000FF">ELSIF </font>sreg<font color="#808080">=</font>opLivro <font color="#0000FF">THEN 
   IF </font>sacao<font color="#808080">=</font>opNovo <font color="#0000FF">THEN 
      </font>WriteString<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">));
      </font>ReadLinha<font color="#808080">(</font>tLivro.isbn<font color="#808080">);
      </font><font color="#0000FF">IF </font>validaISBN<font color="#808080">(</font>tLivro.isbn<font color="#808080">) </font><font color="#0000FF">THEN 
          </font>slinha<font color="#808080">:=</font>pesqArq<font color="#808080">(</font>tfLivro<font color="#808080">, </font>tLivro.isbn<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">13</font><font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">));
          </font><font color="#0000FF">IF </font>Compare<font color="#808080">(</font>slinha<font color="#808080">,</font><font color="#800000">''</font><font color="#808080">)=</font>equal <font color="#0000FF">THEN 
             </font>pesqLinhaExcluida<font color="#808080">(</font>tfLivro<font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">));
             </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#800000">''</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">);
             </font>subMenu<font color="#808080">(</font><font color="#FF0000">7</font><font color="#808080">, </font>sreg<font color="#808080">);
             </font>frmCadLigados<font color="#808080">(</font>opLivroAss<font color="#808080">, </font>opNovo<font color="#808080">, </font>tLivro.isbn<font color="#808080">);
             </font>frmCadLigados<font color="#808080">(</font>opLivroAut<font color="#808080">, </font>opNovo<font color="#808080">, </font>tLivro.isbn<font color="#808080">);
          </font><font color="#0000FF">ELSE </font>WriteLinha<font color="#808080">(</font>MSG_REGEXST<font color="#808080">);
          </font><font color="#0000FF">END</font><font color="#808080">; 
      </font><font color="#0000FF">ELSE </font>WriteLinha<font color="#808080">(</font>MSG_ISBNINV<font color="#808080">);
      </font><font color="#0000FF">END</font><font color="#808080">;
   </font><font color="#0000FF">ELSIF </font>sacao<font color="#808080">=</font>opPesquisar <font color="#0000FF">THEN 
      </font>slinha<font color="#808080">:=</font>validaEntrada<font color="#808080">(</font>tfLivro<font color="#808080">, </font>sreg<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font>tLivro.isbn<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">,</font>FALSE<font color="#808080">,</font>opTexto<font color="#808080">);
      </font><font color="#0000FF">IF </font>Compare<font color="#808080">(</font>slinha<font color="#808080">,</font><font color="#800000">''</font><font color="#808080">)&lt;&gt;</font>equal <font color="#0000FF">THEN 
         </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#800000">''</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">);
         </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font>slinha<font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">);
         </font>subMenu<font color="#808080">(</font><font color="#FF0000">8</font><font color="#808080">, </font>sreg<font color="#808080">);
      </font><font color="#0000FF">END</font><font color="#808080">;
   </font><font color="#0000FF">ELSIF </font>sacao<font color="#808080">=</font>opAlterar <font color="#0000FF">THEN 
      </font>WriteLinha<font color="#808080">(</font>Ss<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">), </font>tLivro.isbn<font color="#808080">));
      </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#800000">''</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">);
      </font>subMenu<font color="#808080">(</font><font color="#FF0000">9</font><font color="#808080">, </font>sreg<font color="#808080">);
      </font>frmCadLigados<font color="#808080">(</font>opLivroAss<font color="#808080">, </font>opExcluir<font color="#808080">, </font>tLivro.isbn<font color="#808080">);
      </font>WriteLinha<font color="#808080">(</font><font color="#800000">'Assuntos dos livros exclu&iacute;dos, inclua novos!'</font><font color="#808080">);
      </font>frmCadLigados<font color="#808080">(</font>opLivroAss<font color="#808080">, </font>opNovo<font color="#808080">, </font>tLivro.isbn<font color="#808080">);
      </font>frmCadLigados<font color="#808080">(</font>opLivroAut<font color="#808080">, </font>opExcluir<font color="#808080">, </font>tLivro.isbn<font color="#808080">);
      </font>WriteLinha<font color="#808080">(</font><font color="#800000">'Autores dos livros exclu&iacute;dos, inclua novos!'</font><font color="#808080">);
      </font>frmCadLigados<font color="#808080">(</font>opLivroAut<font color="#808080">, </font>opNovo<font color="#808080">, </font>tLivro.isbn<font color="#808080">);
   </font><font color="#0000FF">ELSIF </font>sacao<font color="#808080">=</font>opExcluir <font color="#0000FF">THEN 
      </font>subMenu<font color="#808080">(</font><font color="#FF0000">10</font><font color="#808080">, </font>sreg<font color="#808080">);
      </font>WriteLinha<font color="#808080">(</font><font color="#800000">'Assuntos dos livros sendo exclu&iacute;dos!'</font><font color="#808080">);
      </font>frmCadLigados<font color="#808080">(</font>opLivroAss<font color="#808080">, </font>opExcluir<font color="#808080">, </font>tLivro.isbn<font color="#808080">);
      </font>WriteLinha<font color="#808080">(</font><font color="#800000">'Autores dos livros sendo exclu&iacute;dos!'</font><font color="#808080">);
      </font>frmCadLigados<font color="#808080">(</font>opLivroAut<font color="#808080">, </font>opExcluir<font color="#808080">, </font>tLivro.isbn<font color="#808080">);
   </font><font color="#0000FF">END</font><font color="#808080">;
</font><font color="#0000FF">ELSIF </font>sreg<font color="#808080">=</font>opCliente <font color="#0000FF">THEN 
   IF </font>sacao<font color="#808080">=</font>opNovo <font color="#0000FF">THEN 
      </font>WriteString<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">));
      </font>ReadLinha<font color="#808080">(</font>tCliente.cpf<font color="#808080">);
      </font><font color="#0000FF">IF </font>validaCPF<font color="#808080">(</font>tCliente.cpf<font color="#808080">) </font><font color="#0000FF">THEN 
          </font>slinha<font color="#808080">:=</font>pesqArq<font color="#808080">(</font>tfCliente<font color="#808080">, </font>tCliente.cpf<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">14</font><font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">));
          </font><font color="#0000FF">IF </font>Compare<font color="#808080">(</font>slinha<font color="#808080">,</font><font color="#800000">''</font><font color="#808080">)=</font>equal <font color="#0000FF">THEN 
             </font>pesqLinhaExcluida<font color="#808080">(</font>tfCliente<font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">));
             </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#800000">''</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">);
             </font>subMenu<font color="#808080">(</font><font color="#FF0000">7</font><font color="#808080">, </font>sreg<font color="#808080">);
          </font><font color="#0000FF">ELSE </font>WriteLinha<font color="#808080">(</font>MSG_REGEXST<font color="#808080">);
          </font><font color="#0000FF">END</font><font color="#808080">;
      </font><font color="#0000FF">ELSE </font>WriteLinha<font color="#808080">(</font>MSG_CPFINV<font color="#808080">);
      </font><font color="#0000FF">END</font><font color="#808080">;
   </font><font color="#0000FF">ELSIF </font>sacao<font color="#808080">=</font>opPesquisar <font color="#0000FF">THEN 
      </font>slinha<font color="#808080">:=</font>validaEntrada<font color="#808080">(</font>tfCliente<font color="#808080">, </font>sreg<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font>tCliente.cpf<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font>FALSE<font color="#808080">,</font>opTexto<font color="#808080">);
      </font><font color="#0000FF">IF </font>Compare<font color="#808080">(</font>slinha<font color="#808080">,</font><font color="#800000">''</font><font color="#808080">)&lt;&gt;</font>equal <font color="#0000FF">THEN 
         </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#800000">''</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">);
         </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font>slinha<font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">);
         </font>subMenu<font color="#808080">(</font><font color="#FF0000">8</font><font color="#808080">, </font>sreg<font color="#808080">);
      </font><font color="#0000FF">END</font><font color="#808080">;
   </font><font color="#0000FF">ELSIF </font>sacao<font color="#808080">=</font>opAlterar <font color="#0000FF">THEN 
      </font>WriteLinha<font color="#808080">(</font>Ss<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">), </font>tCliente.cpf<font color="#808080">));
      </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#800000">''</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">);
      </font>subMenu<font color="#808080">(</font><font color="#FF0000">9</font><font color="#808080">, </font>sreg<font color="#808080">);
   </font><font color="#0000FF">ELSIF </font>sacao<font color="#808080">=</font>opExcluir <font color="#0000FF">THEN 
      </font>subMenu<font color="#808080">(</font><font color="#FF0000">10</font><font color="#808080">, </font>sreg<font color="#808080">);
   </font><font color="#0000FF">END</font><font color="#808080">;
</font><font color="#0000FF">ELSIF </font>sreg<font color="#808080">=</font>opVenda <font color="#0000FF">THEN 
   IF </font>sacao<font color="#808080">=</font>opNovo <font color="#0000FF">THEN 
      </font>tVenda.dthrvenda<font color="#808080">:=</font>retDataHora<font color="#808080">();
      </font>WriteLinha<font color="#808080">(</font>Ss<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">), </font>tVenda.dthrvenda<font color="#808080">));
      </font>slinha<font color="#808080">:=</font>pesqArq<font color="#808080">(</font>tfVenda<font color="#808080">, </font>tVenda.dthrvenda<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">19</font><font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">));
      </font><font color="#0000FF">IF </font>Compare<font color="#808080">(</font>slinha<font color="#808080">,</font><font color="#800000">''</font><font color="#808080">)=</font>equal <font color="#0000FF">THEN 
         </font>slinha<font color="#808080">:=</font>validaEntrada<font color="#808080">(</font>tfCliente<font color="#808080">,</font>opCliente<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font>tVenda.cpf<font color="#808080">,</font><font color="#FF0000">3</font><font color="#808080">,
                 </font>FALSE<font color="#808080">,</font>opTexto<font color="#808080">);
         </font><font color="#0000FF">IF </font>Compare<font color="#808080">(</font>slinha<font color="#808080">,</font><font color="#800000">''</font><font color="#808080">)&lt;&gt;</font>equal <font color="#0000FF">THEN 
            </font>tVenda.cpf<font color="#808080">:=</font>trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#FF0000">14</font><font color="#808080">));
            </font><font color="#0000FF">IF </font>validaCPF<font color="#808080">(</font>tVenda.cpf<font color="#808080">) </font><font color="#0000FF">THEN 
               </font>WriteString<font color="#808080">(</font>Ss<font color="#808080">(</font><font color="#800000">' '</font><font color="#808080">,</font>rotulo<font color="#808080">(</font>opCliente<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">))); (* Nome *)
               </font>WriteLinha<font color="#808080">(</font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font>g_nPosChave<font color="#808080">, </font>g_nTamChave<font color="#808080">));
               </font>frmCadLigados<font color="#808080">(</font>opVenda<font color="#808080">, </font>opNovo<font color="#808080">, </font>tVenda.cpf<font color="#808080">);
            </font><font color="#0000FF">ELSE </font>WriteLinha<font color="#808080">(</font>MSG_CPFINV<font color="#808080">);
            </font><font color="#0000FF">END</font><font color="#808080">; 
         </font><font color="#0000FF">END</font><font color="#808080">;
      </font><font color="#0000FF">ELSE </font>WriteLinha<font color="#808080">(</font>MSG_REGEXST<font color="#808080">);
      </font><font color="#0000FF">END</font><font color="#808080">;
   </font><font color="#0000FF">ELSIF </font>sacao<font color="#808080">=</font>opPesquisar <font color="#0000FF">THEN 
      </font>slinha<font color="#808080">:=</font>validaEntrada<font color="#808080">(</font>tfVenda<font color="#808080">, </font>sreg<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font>tVenda.dthrvenda<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,
              </font>FALSE<font color="#808080">,</font>opDataHora<font color="#808080">);
      </font><font color="#0000FF">IF </font>Compare<font color="#808080">(</font>slinha<font color="#808080">,</font><font color="#800000">''</font><font color="#808080">)&lt;&gt;</font>equal <font color="#0000FF">THEN 
        </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#800000">''</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">);
        </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font>slinha<font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">);
        </font>subMenu<font color="#808080">(</font><font color="#FF0000">8</font><font color="#808080">, </font>sreg<font color="#808080">);
      </font><font color="#0000FF">END</font><font color="#808080">;
   </font><font color="#0000FF">END</font><font color="#808080">;
</font><font color="#0000FF">END</font><font color="#808080">;

</font><font color="#0000FF">END </font>frmCadastros<font color="#808080">;
(*------------------------------------------------------------------------------
</font>Realiza as consultas de acordo com o tipo de arquivo.
sreg <font color="#808080">- </font>o tipo de arquivo
sacao <font color="#808080">- </font>a a<font color="#808080">&ccedil;&atilde;</font>o a ser realizada
<font color="#808080">------------------------------------------------------------------------------*)
</font><font color="#0000FF">PROCEDURE </font>frmConsultas<font color="#808080">(</font>sreg<font color="#808080">: </font>ctArqs<font color="#808080">; </font>sacao<font color="#808080">: </font>ctAcao<font color="#808080">);
</font><font color="#0000FF">VAR </font>slinha<font color="#808080">: </font>String<font color="#808080">;
</font><font color="#0000FF">BEGIN
IF </font>sreg<font color="#808080">=</font>opAssunto <font color="#0000FF">THEN 
   IF </font>sacao<font color="#808080">=</font>opPesquisar <font color="#0000FF">THEN
      </font>slinha<font color="#808080">:=</font>validaEntrada<font color="#808080">(</font>tfAssunto<font color="#808080">,</font>sreg<font color="#808080">,</font><font color="#FF0000">2</font><font color="#808080">,</font>tAssunto.assunto<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font>TRUE<font color="#808080">,</font>opTexto<font color="#808080">)
   </font><font color="#0000FF">ELSIF </font>sacao<font color="#808080">=</font>opListarTodos <font color="#0000FF">THEN 
      IF </font>ListarTodos<font color="#808080">(</font>tfAssunto<font color="#808080">, </font>sreg<font color="#808080">, </font><font color="#800000">''</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">),
        </font>QTD_MAX_LINHA<font color="#808080">, </font>FALSE<font color="#808080">) = </font>FALSE <font color="#0000FF">THEN
        </font>WriteLinha<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">));
      </font><font color="#0000FF">END</font><font color="#808080">;
   </font><font color="#0000FF">END</font><font color="#808080">;
</font><font color="#0000FF">ELSIF </font>sreg<font color="#808080">=</font>opAutor <font color="#0000FF">THEN 
   IF </font>sacao<font color="#808080">=</font>opPesquisar <font color="#0000FF">THEN
      </font>slinha<font color="#808080">:=</font>validaEntrada<font color="#808080">(</font>tfAutor<font color="#808080">,</font>sreg<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">, </font>tAutor.autor<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font>TRUE<font color="#808080">,</font>opTexto<font color="#808080">)
   </font><font color="#0000FF">ELSIF </font>sacao<font color="#808080">=</font>opListarTodos <font color="#0000FF">THEN 
      IF </font>ListarTodos<font color="#808080">(</font>tfAutor<font color="#808080">, </font>sreg<font color="#808080">, </font><font color="#800000">''</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">),
        </font>QTD_MAX_LINHA<font color="#808080">, </font>FALSE<font color="#808080">) = </font>FALSE <font color="#0000FF">THEN
        </font>WriteLinha<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">));
      </font><font color="#0000FF">END</font><font color="#808080">;
   </font><font color="#0000FF">END</font><font color="#808080">;
</font><font color="#0000FF">ELSIF </font>sreg<font color="#808080">=</font>opEditora <font color="#0000FF">THEN 
   IF </font>sacao<font color="#808080">=</font>opPesquisar <font color="#0000FF">THEN
      </font>slinha<font color="#808080">:=</font>validaEntrada<font color="#808080">(</font>tfEditora<font color="#808080">,</font>sreg<font color="#808080">,</font><font color="#FF0000">2</font><font color="#808080">,</font>tEditora.editora<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font>TRUE<font color="#808080">,</font>opTexto<font color="#808080">)
   </font><font color="#0000FF">ELSIF </font>sacao<font color="#808080">=</font>opListarTodos <font color="#0000FF">THEN 
      IF </font>ListarTodos<font color="#808080">(</font>tfEditora<font color="#808080">, </font>sreg<font color="#808080">, </font><font color="#800000">''</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">),
        </font>QTD_MAX_LINHA<font color="#808080">, </font>FALSE<font color="#808080">) = </font>FALSE <font color="#0000FF">THEN
        </font>WriteLinha<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">));
      </font><font color="#0000FF">END</font><font color="#808080">;
   </font><font color="#0000FF">END</font><font color="#808080">;
</font><font color="#0000FF">ELSIF </font>sreg<font color="#808080">=</font>opEndereco <font color="#0000FF">THEN 
   IF </font>sacao<font color="#808080">=</font>opPesquisar <font color="#0000FF">THEN
      </font>slinha<font color="#808080">:=</font>validaEntrada<font color="#808080">(</font>tfEndereco<font color="#808080">,</font>sreg<font color="#808080">,</font><font color="#FF0000">2</font><font color="#808080">,</font>tEndereco.logradouro<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,
              </font>TRUE<font color="#808080">,</font>opTexto<font color="#808080">);
   </font><font color="#0000FF">ELSIF </font>sacao<font color="#808080">=</font>opListarTodos <font color="#0000FF">THEN 
      IF </font>ListarTodos<font color="#808080">(</font>tfEndereco<font color="#808080">, </font>sreg<font color="#808080">, </font><font color="#800000">''</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">),
         </font><font color="#FF0000">3</font><font color="#808080">, </font>FALSE<font color="#808080">) = </font>FALSE <font color="#0000FF">THEN
        </font>WriteLinha<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">));
      </font><font color="#0000FF">END</font><font color="#808080">;
   </font><font color="#0000FF">END</font><font color="#808080">;
</font><font color="#0000FF">ELSIF </font>sreg<font color="#808080">=</font>opIdioma <font color="#0000FF">THEN 
   IF </font>sacao<font color="#808080">=</font>opPesquisar <font color="#0000FF">THEN
      </font>slinha<font color="#808080">:=</font>validaEntrada<font color="#808080">(</font>tfIdioma<font color="#808080">, </font>sreg<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">, </font>tIdioma.idioma<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font>TRUE<font color="#808080">,</font>opTexto<font color="#808080">)
   </font><font color="#0000FF">ELSIF </font>sacao<font color="#808080">=</font>opListarTodos <font color="#0000FF">THEN 
      IF </font>ListarTodos<font color="#808080">(</font>tfIdioma<font color="#808080">, </font>sreg<font color="#808080">, </font><font color="#800000">''</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">),
        </font>QTD_MAX_LINHA<font color="#808080">, </font>FALSE<font color="#808080">) = </font>FALSE <font color="#0000FF">THEN
        </font>WriteLinha<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">));
      </font><font color="#0000FF">END</font><font color="#808080">;
   </font><font color="#0000FF">END</font><font color="#808080">;
</font><font color="#0000FF">ELSIF </font>sreg<font color="#808080">=</font>opPais <font color="#0000FF">THEN 
   IF </font>sacao<font color="#808080">=</font>opPesquisar <font color="#0000FF">THEN
      </font>slinha<font color="#808080">:=</font>validaEntrada<font color="#808080">(</font>tfPais<font color="#808080">, </font>sreg<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">, </font>tPais.pais<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font>TRUE<font color="#808080">,</font>opTexto<font color="#808080">)
   </font><font color="#0000FF">ELSIF </font>sacao<font color="#808080">=</font>opListarTodos <font color="#0000FF">THEN 
      IF </font>ListarTodos<font color="#808080">(</font>tfPais<font color="#808080">, </font>sreg<font color="#808080">, </font><font color="#800000">''</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">),
        </font>QTD_MAX_LINHA<font color="#808080">, </font>FALSE<font color="#808080">) = </font>FALSE <font color="#0000FF">THEN
        </font>WriteLinha<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">));
      </font><font color="#0000FF">END</font><font color="#808080">;
   </font><font color="#0000FF">END</font><font color="#808080">;
</font><font color="#0000FF">ELSIF </font>sreg<font color="#808080">=</font>opProfissao <font color="#0000FF">THEN 
   IF </font>sacao<font color="#808080">=</font>opPesquisar <font color="#0000FF">THEN
     </font>slinha<font color="#808080">:=</font>validaEntrada<font color="#808080">(</font>tfProfissao<font color="#808080">,</font>sreg<font color="#808080">,</font><font color="#FF0000">2</font><font color="#808080">,</font>tProfissao.profissao<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,
             </font>TRUE<font color="#808080">,</font>opTexto<font color="#808080">)
   </font><font color="#0000FF">ELSIF </font>sacao<font color="#808080">=</font>opListarTodos <font color="#0000FF">THEN 
      IF </font>ListarTodos<font color="#808080">(</font>tfProfissao<font color="#808080">, </font>sreg<font color="#808080">, </font><font color="#800000">''</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">),
        </font>QTD_MAX_LINHA<font color="#808080">, </font>FALSE<font color="#808080">) = </font>FALSE <font color="#0000FF">THEN
        </font>WriteLinha<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">));
      </font><font color="#0000FF">END</font><font color="#808080">;
   </font><font color="#0000FF">END</font><font color="#808080">;
</font><font color="#0000FF">ELSIF </font>sreg<font color="#808080">=</font>opLivro <font color="#0000FF">THEN 
   IF </font>sacao<font color="#808080">=</font>opPesquisar <font color="#0000FF">THEN
      </font>slinha<font color="#808080">:=</font>validaEntrada<font color="#808080">(</font>tfLivro<font color="#808080">, </font>sreg<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">, </font>tLivro.titulo<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font>TRUE<font color="#808080">,</font>opTexto<font color="#808080">)
   </font><font color="#0000FF">ELSIF </font>sacao<font color="#808080">=</font>opListarTodos <font color="#0000FF">THEN 
      IF </font>ListarTodos<font color="#808080">(</font>tfLivro<font color="#808080">, </font>sreg<font color="#808080">, </font><font color="#800000">''</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">),
        </font><font color="#FF0000">1</font><font color="#808080">, </font>FALSE<font color="#808080">) = </font>FALSE <font color="#0000FF">THEN
        </font>WriteLinha<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">));
      </font><font color="#0000FF">END</font><font color="#808080">;
   </font><font color="#0000FF">END</font><font color="#808080">;
</font><font color="#0000FF">ELSIF </font>sreg<font color="#808080">=</font>opCliente <font color="#0000FF">THEN 
   IF </font>sacao<font color="#808080">=</font>opPesquisar <font color="#0000FF">THEN
      </font>slinha<font color="#808080">:=</font>validaEntrada<font color="#808080">(</font>tfCliente<font color="#808080">, </font>sreg<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">, </font>tCliente.nome<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font>TRUE<font color="#808080">,</font>opTexto<font color="#808080">)
   </font><font color="#0000FF">ELSIF </font>sacao<font color="#808080">=</font>opListarTodos <font color="#0000FF">THEN 
      IF </font>ListarTodos<font color="#808080">(</font>tfCliente<font color="#808080">, </font>sreg<font color="#808080">, </font><font color="#800000">''</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">),
        </font><font color="#FF0000">1</font><font color="#808080">, </font>FALSE<font color="#808080">) = </font>FALSE <font color="#0000FF">THEN
        </font>WriteLinha<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">));
      </font><font color="#0000FF">END</font><font color="#808080">;
   </font><font color="#0000FF">END</font><font color="#808080">;
</font><font color="#0000FF">ELSIF </font>sreg<font color="#808080">=</font>opVenda <font color="#0000FF">THEN 
   IF </font>sacao<font color="#808080">=</font>opPesquisar <font color="#0000FF">THEN
      </font>slinha<font color="#808080">:=</font>validaEntrada<font color="#808080">(</font>tfVenda<font color="#808080">, </font>sreg<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">, </font>tVenda.cpf<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font>TRUE<font color="#808080">,</font>opTexto<font color="#808080">)
   </font><font color="#0000FF">ELSIF </font>sacao<font color="#808080">=</font>opListarTodos <font color="#0000FF">THEN 
      IF </font>ListarTodos<font color="#808080">(</font>tfVenda<font color="#808080">, </font>sreg<font color="#808080">, </font><font color="#800000">''</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">),
        </font>QTD_MAX_LINHA<font color="#808080">, </font>FALSE<font color="#808080">) = </font>FALSE <font color="#0000FF">THEN
        </font>WriteLinha<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">));
      </font><font color="#0000FF">END</font><font color="#808080">;
   </font><font color="#0000FF">END</font><font color="#808080">;
</font><font color="#0000FF">END</font><font color="#808080">;
</font><font color="#0000FF">IF </font>Compare<font color="#808080">(</font>slinha<font color="#808080">,</font><font color="#800000">''</font><font color="#808080">)=</font>equal <font color="#0000FF">THEN 
   </font>WriteString<font color="#808080">(</font><font color="#800000">''</font><font color="#808080">);
</font><font color="#0000FF">END</font><font color="#808080">;
</font><font color="#0000FF">END </font>frmConsultas<font color="#808080">;
(*------------------------------------------------------------------------------
</font>Mostra a tela de altera<font color="#808080">&ccedil;&atilde;</font>o de senha do sistema e realiza a altera<font color="#808080">&ccedil;&atilde;</font>o.
<font color="#808080">------------------------------------------------------------------------------*)
</font><font color="#0000FF">PROCEDURE </font>frmAlterarSenha<font color="#808080">;
</font><font color="#0000FF">VAR </font>bQuebra<font color="#808080">: </font><font color="#0000FF">BOOLEAN</font><font color="#808080">;
    </font>sres<font color="#808080">, </font>sSenhaAtual<font color="#808080">, </font>sNovaSenha<font color="#808080">, </font>sConfirmaSenha<font color="#808080">: </font>String<font color="#808080">;
    </font>nopcao<font color="#808080">: </font><font color="#0000FF">INTEGER</font><font color="#808080">;
</font><font color="#0000FF">BEGIN
</font>WriteLinha<font color="#808080">(</font>Ss<font color="#808080">(</font>rotulo<font color="#808080">(</font>opUsuario<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">), </font>tUsuario.login<font color="#808080">));
</font>nopcao<font color="#808080">:=</font><font color="#FF0000">1</font><font color="#808080">;
</font>bQuebra<font color="#808080">:=</font>FALSE<font color="#808080">;
</font><font color="#0000FF">WHILE </font><font color="#808080">(</font>bQuebra<font color="#808080">=</font>FALSE<font color="#808080">) </font><font color="#0000FF">DO 
  CASE </font>nopcao <font color="#0000FF">OF
  </font><font color="#808080">| </font><font color="#FF0000">1</font><font color="#808080">: </font>sSenhaAtual<font color="#808080">:=</font>digitaSenha<font color="#808080">(</font><font color="#800000">'Senha Atual: '</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">);
       </font><font color="#0000FF">IF </font>Compare<font color="#808080">(</font>sSenhaAtual<font color="#808080">,</font>tUsuario.senha<font color="#808080">)&lt;&gt;</font>equal <font color="#0000FF">THEN 
          </font>WriteLinha<font color="#808080">(</font>MSG_SENCONFERE<font color="#808080">);
          </font>bQuebra<font color="#808080">:=</font>TRUE<font color="#808080">;
       </font><font color="#0000FF">ELSE </font>nopcao<font color="#808080">:=</font><font color="#FF0000">2</font><font color="#808080">;
       </font><font color="#0000FF">END</font><font color="#808080">;
  | </font><font color="#FF0000">2</font><font color="#808080">: </font>sNovaSenha<font color="#808080">:=</font>digitaSenha<font color="#808080">(</font><font color="#800000">'Nova Senha: '</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">);
       </font>sConfirmaSenha<font color="#808080">:=</font>digitaSenha<font color="#808080">(</font><font color="#800000">'Confirma Senha: '</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">);
       </font><font color="#0000FF">IF </font>Compare<font color="#808080">(</font>sNovaSenha<font color="#808080">,</font>sConfirmaSenha<font color="#808080">)&lt;&gt;</font>equal <font color="#0000FF">THEN 
          </font>WriteLinha<font color="#808080">(</font>MSG_SENCONFIRM<font color="#808080">);
          </font>bQuebra<font color="#808080">:=</font>TRUE<font color="#808080">;
       </font><font color="#0000FF">ELSE </font>nopcao<font color="#808080">:=</font><font color="#FF0000">3</font><font color="#808080">;
       </font><font color="#0000FF">END</font><font color="#808080">;
  | </font><font color="#FF0000">3</font><font color="#808080">: </font>sres<font color="#808080">:=</font>pesqArq<font color="#808080">(</font>tfUsuario<font color="#808080">, </font>tUsuario.login<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">, </font>tamReg<font color="#808080">(</font>opUsuario<font color="#808080">));
       </font><font color="#0000FF">IF </font>Compare<font color="#808080">(</font>sres<font color="#808080">,</font><font color="#800000">''</font><font color="#808080">)=</font>equal <font color="#0000FF">THEN
         </font>WriteLinha<font color="#808080">(</font>MSG_LOGINENCON<font color="#808080">)
       </font><font color="#0000FF">ELSE 
         </font>tUsuario.senha<font color="#808080">:=</font>sConfirmaSenha<font color="#808080">;
         </font>subMenu<font color="#808080">(</font><font color="#FF0000">9</font><font color="#808080">,</font>opUsuario<font color="#808080">);
         </font>bQuebra<font color="#808080">:=</font>TRUE<font color="#808080">;
       </font><font color="#0000FF">END</font><font color="#808080">;
  </font><font color="#0000FF">END</font><font color="#808080">;
</font><font color="#0000FF">END</font><font color="#808080">;

</font><font color="#0000FF">END </font>frmAlterarSenha<font color="#808080">;
(*------------------------------------------------------------------------------
</font>Seleciona o menu e<font color="#808080">/</font>ou a tela certa de acordo com o tipo de arquivo.
nmenu <font color="#808080">- </font>o n<font color="#808080">&uacute;</font>mero do menu
sreg <font color="#808080">- </font>o tipo de arquivo
<font color="#808080">------------------------------------------------------------------------------*)
</font><font color="#0000FF">PROCEDURE </font>subMenu<font color="#808080">(</font>nmenu<font color="#808080">: </font><font color="#0000FF">INTEGER</font><font color="#808080">; </font>sreg<font color="#808080">: </font>ctArqs<font color="#808080">);
</font><font color="#0000FF">VAR </font>opSubMenu<font color="#808080">: </font><font color="#0000FF">INTEGER</font><font color="#808080">;
    </font>opCSubMenu<font color="#808080">: </font><font color="#0000FF">CHAR</font><font color="#808080">;
    </font>bSOp<font color="#808080">: </font><font color="#0000FF">BOOLEAN</font><font color="#808080">;
</font><font color="#0000FF">BEGIN
</font>bSOp<font color="#808080">:=</font>TRUE<font color="#808080">;
</font><font color="#0000FF">CASE </font>nmenu <font color="#0000FF">OF
</font><font color="#808080">| </font><font color="#FF0000">6</font><font color="#808080">: </font><font color="#0000FF">WHILE</font><font color="#808080">(</font>bSOp<font color="#808080">) </font><font color="#0000FF">DO 
       </font>menu<font color="#808080">(</font>nmenu<font color="#808080">);
       </font>ReadInt<font color="#808080">(</font>opSubMenu<font color="#808080">);
       </font><font color="#0000FF">CASE</font><font color="#808080">(</font>opSubMenu<font color="#808080">) </font><font color="#0000FF">OF
        </font><font color="#808080">| </font><font color="#FF0000">1</font><font color="#808080">: </font>frmCadastros<font color="#808080">(</font>sreg<font color="#808080">, </font>opNovo<font color="#808080">);
        | </font><font color="#FF0000">2</font><font color="#808080">: </font>frmCadastros<font color="#808080">(</font>sreg<font color="#808080">, </font>opPesquisar<font color="#808080">);
        | </font><font color="#FF0000">3</font><font color="#808080">: </font>bSOp<font color="#808080">:=</font>FALSE<font color="#808080">;
        </font><font color="#0000FF">ELSE </font>WriteLinha<font color="#808080">(</font>MSG_ERRO<font color="#808080">);
       </font><font color="#0000FF">END</font><font color="#808080">;
     </font><font color="#0000FF">END</font><font color="#808080">;
| </font><font color="#FF0000">7</font><font color="#808080">: </font><font color="#0000FF">WHILE</font><font color="#808080">(</font>bSOp<font color="#808080">) </font><font color="#0000FF">DO 
       </font>menu<font color="#808080">(</font>nmenu<font color="#808080">);
       </font>ReadInt<font color="#808080">(</font>opSubMenu<font color="#808080">);
       </font><font color="#0000FF">CASE</font><font color="#808080">(</font>opSubMenu<font color="#808080">) </font><font color="#0000FF">OF
       </font><font color="#808080">| </font><font color="#FF0000">1</font><font color="#808080">:  </font>btnAcao<font color="#808080">(</font>sreg<font color="#808080">, </font>opSalvarInclusao<font color="#808080">); </font>bSOp<font color="#808080">:=</font>FALSE<font color="#808080">;
       | </font><font color="#FF0000">2</font><font color="#808080">: </font>bSOp<font color="#808080">:=</font>FALSE<font color="#808080">;
       </font><font color="#0000FF">ELSE </font>WriteLinha<font color="#808080">(</font>MSG_ERRO<font color="#808080">);
       </font><font color="#0000FF">END</font><font color="#808080">;
     </font><font color="#0000FF">END</font><font color="#808080">;
| </font><font color="#FF0000">8</font><font color="#808080">: </font><font color="#0000FF">WHILE</font><font color="#808080">(</font>bSOp<font color="#808080">) </font><font color="#0000FF">DO 
       </font>menu<font color="#808080">(</font>nmenu<font color="#808080">);
       </font>ReadInt<font color="#808080">(</font>opSubMenu<font color="#808080">);
       </font><font color="#0000FF">CASE</font><font color="#808080">(</font>opSubMenu<font color="#808080">) </font><font color="#0000FF">OF
        </font><font color="#808080">| </font><font color="#FF0000">1</font><font color="#808080">:  </font>frmCadastros<font color="#808080">(</font>sreg<font color="#808080">, </font>opAlterar<font color="#808080">); </font>bSOp<font color="#808080">:=</font>FALSE<font color="#808080">;
        | </font><font color="#FF0000">2</font><font color="#808080">:  </font>frmCadastros<font color="#808080">(</font>sreg<font color="#808080">, </font>opExcluir<font color="#808080">); </font>bSOp<font color="#808080">:=</font>FALSE<font color="#808080">;
        | </font><font color="#FF0000">3</font><font color="#808080">: </font>bSOp<font color="#808080">:=</font>FALSE<font color="#808080">;
        </font><font color="#0000FF">ELSE </font>WriteLinha<font color="#808080">(</font>MSG_ERRO<font color="#808080">);
       </font><font color="#0000FF">END</font><font color="#808080">;
     </font><font color="#0000FF">END</font><font color="#808080">;
| </font><font color="#FF0000">9</font><font color="#808080">: </font><font color="#0000FF">WHILE</font><font color="#808080">(</font>bSOp<font color="#808080">) </font><font color="#0000FF">DO 
       </font>menu<font color="#808080">(</font>nmenu<font color="#808080">);
       </font>ReadInt<font color="#808080">(</font>opSubMenu<font color="#808080">);
       </font><font color="#0000FF">CASE</font><font color="#808080">(</font>opSubMenu<font color="#808080">) </font><font color="#0000FF">OF
        </font><font color="#808080">| </font><font color="#FF0000">1</font><font color="#808080">:  </font>btnAcao<font color="#808080">(</font>sreg<font color="#808080">, </font>opSalvarAlteracao<font color="#808080">); </font>bSOp<font color="#808080">:=</font>FALSE<font color="#808080">;
        | </font><font color="#FF0000">2</font><font color="#808080">: </font>bSOp<font color="#808080">:=</font>FALSE<font color="#808080">;
        </font><font color="#0000FF">ELSE </font>WriteLinha<font color="#808080">(</font>MSG_ERRO<font color="#808080">);
       </font><font color="#0000FF">END</font><font color="#808080">;
     </font><font color="#0000FF">END</font><font color="#808080">;
| </font><font color="#FF0000">10</font><font color="#808080">: </font><font color="#0000FF">WHILE</font><font color="#808080">(</font>bSOp<font color="#808080">) </font><font color="#0000FF">DO 
        </font>menu<font color="#808080">(</font>nmenu<font color="#808080">);
        </font>Read<font color="#808080">(</font>opCSubMenu<font color="#808080">);
        </font><font color="#0000FF">IF </font><font color="#808080">(</font>opCSubMenu<font color="#808080">=</font><font color="#800000">'S'</font><font color="#808080">) </font><font color="#0000FF">OR </font><font color="#808080">(</font>opCSubMenu<font color="#808080">=</font><font color="#800000">'s'</font><font color="#808080">) </font><font color="#0000FF">THEN 
          </font>btnAcao<font color="#808080">(</font>sreg<font color="#808080">, </font>opConfirmaExclusao<font color="#808080">);
          </font>bSOp<font color="#808080">:=</font>FALSE<font color="#808080">;
        </font><font color="#0000FF">ELSIF </font><font color="#808080">(</font>opCSubMenu<font color="#808080">=</font><font color="#800000">'N'</font><font color="#808080">) </font><font color="#0000FF">OR </font><font color="#808080">(</font>opCSubMenu<font color="#808080">=</font><font color="#800000">'n'</font><font color="#808080">) </font><font color="#0000FF">THEN </font>bSOp<font color="#808080">:=</font>FALSE<font color="#808080">;
        </font><font color="#0000FF">ELSE </font>WriteLinha<font color="#808080">(</font>MSG_ERRO<font color="#808080">);
        </font><font color="#0000FF">END</font><font color="#808080">;
      </font><font color="#0000FF">END</font><font color="#808080">;
| </font><font color="#FF0000">12</font><font color="#808080">: </font><font color="#0000FF">WHILE</font><font color="#808080">(</font>bSOp<font color="#808080">) </font><font color="#0000FF">DO 
        </font>menu<font color="#808080">(</font>nmenu<font color="#808080">);
        </font>ReadInt<font color="#808080">(</font>opSubMenu<font color="#808080">);
        </font><font color="#0000FF">CASE</font><font color="#808080">(</font>opSubMenu<font color="#808080">) </font><font color="#0000FF">OF
        </font><font color="#808080">| </font><font color="#FF0000">1</font><font color="#808080">: </font>frmConsultas<font color="#808080">(</font>sreg<font color="#808080">, </font>opPesquisar<font color="#808080">);
        | </font><font color="#FF0000">2</font><font color="#808080">: </font>frmConsultas<font color="#808080">(</font>sreg<font color="#808080">, </font>opListarTodos<font color="#808080">);
        | </font><font color="#FF0000">3</font><font color="#808080">: </font>bSOp<font color="#808080">:=</font>FALSE<font color="#808080">;
        </font><font color="#0000FF">ELSE </font>WriteLinha<font color="#808080">(</font>MSG_ERRO<font color="#808080">);
        </font><font color="#0000FF">END</font><font color="#808080">;
      </font><font color="#0000FF">END</font><font color="#808080">;
| </font><font color="#FF0000">14</font><font color="#808080">: </font><font color="#0000FF">WHILE</font><font color="#808080">(</font>bSOp<font color="#808080">) </font><font color="#0000FF">DO 
        </font>menu<font color="#808080">(</font>nmenu<font color="#808080">);
        </font>Read<font color="#808080">(</font>opCSubMenu<font color="#808080">);
        </font><font color="#0000FF">IF </font><font color="#808080">(</font>opCSubMenu<font color="#808080">=</font><font color="#800000">'S'</font><font color="#808080">) </font><font color="#0000FF">OR </font><font color="#808080">(</font>opCSubMenu<font color="#808080">=</font><font color="#800000">'s'</font><font color="#808080">) </font><font color="#0000FF">THEN 
          </font>btnAcao<font color="#808080">(</font>sreg<font color="#808080">, </font>opSalvarInclusao<font color="#808080">);
          </font>bSOp<font color="#808080">:=</font>FALSE<font color="#808080">;
          </font>g_SalvarInclusao<font color="#808080">:=</font>TRUE<font color="#808080">;
        </font><font color="#0000FF">ELSIF </font><font color="#808080">(</font>opCSubMenu<font color="#808080">=</font><font color="#800000">'N'</font><font color="#808080">) </font><font color="#0000FF">OR </font><font color="#808080">(</font>opCSubMenu<font color="#808080">=</font><font color="#800000">'n'</font><font color="#808080">) </font><font color="#0000FF">THEN </font>bSOp<font color="#808080">:=</font>FALSE<font color="#808080">;
        </font><font color="#0000FF">ELSE </font>WriteLinha<font color="#808080">(</font>MSG_ERRO<font color="#808080">);
        </font><font color="#0000FF">END</font><font color="#808080">;
      </font><font color="#0000FF">END</font><font color="#808080">;
</font><font color="#0000FF">END</font><font color="#808080">;

</font><font color="#0000FF">END </font>subMenu<font color="#808080">;
(*------------------------------------------------------------------------------
</font>Seleciona o submenu e<font color="#808080">/</font>ou a tela certa de acordo com n<font color="#808080">&uacute;</font>mero do menu.
nmenu <font color="#808080">- </font>o n<font color="#808080">&uacute;</font>mero do menu
<font color="#808080">------------------------------------------------------------------------------*)
</font><font color="#0000FF">PROCEDURE </font>usaMenu<font color="#808080">(</font>num<font color="#808080">: </font><font color="#0000FF">INTEGER</font><font color="#808080">);
</font><font color="#0000FF">VAR </font>opSubMenu<font color="#808080">: </font><font color="#0000FF">INTEGER</font><font color="#808080">;
    </font>bSOp<font color="#808080">: </font><font color="#0000FF">BOOLEAN</font><font color="#808080">;
    </font>opSair<font color="#808080">: </font><font color="#0000FF">CHAR</font><font color="#808080">;
</font><font color="#0000FF">BEGIN
 </font>bSOp<font color="#808080">:=</font>TRUE<font color="#808080">;
 </font><font color="#0000FF">IF </font>num <font color="#808080">= </font><font color="#FF0000">1 </font><font color="#0000FF">THEN  </font><font color="#808080">(* Cadastros *)
   </font><font color="#0000FF">WHILE</font><font color="#808080">(</font>bSOp<font color="#808080">) </font><font color="#0000FF">DO 
     </font>menu<font color="#808080">(</font><font color="#FF0000">2</font><font color="#808080">);
     </font>ReadInt<font color="#808080">(</font>opSubMenu<font color="#808080">);
     </font><font color="#0000FF">CASE </font>opSubMenu <font color="#0000FF">OF
      </font><font color="#808080">| </font><font color="#FF0000">1</font><font color="#808080">: </font>subMenu<font color="#808080">(</font><font color="#FF0000">6</font><font color="#808080">, </font>opAssunto<font color="#808080">);
      | </font><font color="#FF0000">2</font><font color="#808080">: </font>subMenu<font color="#808080">(</font><font color="#FF0000">6</font><font color="#808080">, </font>opAutor<font color="#808080">);
      | </font><font color="#FF0000">3</font><font color="#808080">: </font>subMenu<font color="#808080">(</font><font color="#FF0000">6</font><font color="#808080">, </font>opEditora<font color="#808080">);
      | </font><font color="#FF0000">4</font><font color="#808080">: </font>subMenu<font color="#808080">(</font><font color="#FF0000">6</font><font color="#808080">, </font>opEndereco<font color="#808080">);
      | </font><font color="#FF0000">5</font><font color="#808080">: </font>subMenu<font color="#808080">(</font><font color="#FF0000">6</font><font color="#808080">, </font>opIdioma<font color="#808080">);
      | </font><font color="#FF0000">6</font><font color="#808080">: </font>subMenu<font color="#808080">(</font><font color="#FF0000">6</font><font color="#808080">, </font>opPais<font color="#808080">);
      | </font><font color="#FF0000">7</font><font color="#808080">: </font>subMenu<font color="#808080">(</font><font color="#FF0000">6</font><font color="#808080">, </font>opProfissao<font color="#808080">);
      | </font><font color="#FF0000">8</font><font color="#808080">: </font>subMenu<font color="#808080">(</font><font color="#FF0000">6</font><font color="#808080">, </font>opCliente<font color="#808080">);
      | </font><font color="#FF0000">9</font><font color="#808080">: </font>subMenu<font color="#808080">(</font><font color="#FF0000">6</font><font color="#808080">, </font>opLivro<font color="#808080">);
      | </font><font color="#FF0000">10</font><font color="#808080">: </font>bSOp<font color="#808080">:=</font>FALSE<font color="#808080">;
      </font><font color="#0000FF">ELSE </font>WriteLinha<font color="#808080">(</font>MSG_ERRO<font color="#808080">);
     </font><font color="#0000FF">END</font><font color="#808080">;
   </font><font color="#0000FF">END</font><font color="#808080">;
 </font><font color="#0000FF">ELSIF </font>num <font color="#808080">= </font><font color="#FF0000">2 </font><font color="#0000FF">THEN  </font><font color="#808080">(* Pesquisas *)
   </font><font color="#0000FF">WHILE</font><font color="#808080">(</font>bSOp<font color="#808080">) </font><font color="#0000FF">DO 
     </font>menu<font color="#808080">(</font><font color="#FF0000">3</font><font color="#808080">);
     </font>ReadInt<font color="#808080">(</font>opSubMenu<font color="#808080">);
     </font><font color="#0000FF">CASE </font>opSubMenu <font color="#0000FF">OF
      </font><font color="#808080">| </font><font color="#FF0000">1</font><font color="#808080">: </font>subMenu<font color="#808080">(</font><font color="#FF0000">12</font><font color="#808080">, </font>opAssunto<font color="#808080">);
      | </font><font color="#FF0000">2</font><font color="#808080">: </font>subMenu<font color="#808080">(</font><font color="#FF0000">12</font><font color="#808080">, </font>opAutor<font color="#808080">);
      | </font><font color="#FF0000">3</font><font color="#808080">: </font>subMenu<font color="#808080">(</font><font color="#FF0000">12</font><font color="#808080">, </font>opEditora<font color="#808080">);
      | </font><font color="#FF0000">4</font><font color="#808080">: </font>subMenu<font color="#808080">(</font><font color="#FF0000">12</font><font color="#808080">, </font>opEndereco<font color="#808080">);
      | </font><font color="#FF0000">5</font><font color="#808080">: </font>subMenu<font color="#808080">(</font><font color="#FF0000">12</font><font color="#808080">, </font>opIdioma<font color="#808080">);
      | </font><font color="#FF0000">6</font><font color="#808080">: </font>subMenu<font color="#808080">(</font><font color="#FF0000">12</font><font color="#808080">, </font>opPais<font color="#808080">);
      | </font><font color="#FF0000">7</font><font color="#808080">: </font>subMenu<font color="#808080">(</font><font color="#FF0000">12</font><font color="#808080">, </font>opProfissao<font color="#808080">);
      | </font><font color="#FF0000">8</font><font color="#808080">: </font>subMenu<font color="#808080">(</font><font color="#FF0000">12</font><font color="#808080">, </font>opCliente<font color="#808080">);
      | </font><font color="#FF0000">9</font><font color="#808080">: </font>subMenu<font color="#808080">(</font><font color="#FF0000">12</font><font color="#808080">, </font>opLivro<font color="#808080">);
      | </font><font color="#FF0000">10</font><font color="#808080">: </font>bSOp<font color="#808080">:=</font>FALSE<font color="#808080">;
      </font><font color="#0000FF">ELSE </font>WriteLinha<font color="#808080">(</font>MSG_ERRO<font color="#808080">);
     </font><font color="#0000FF">END</font><font color="#808080">;
   </font><font color="#0000FF">END</font><font color="#808080">;
 </font><font color="#0000FF">ELSIF </font>num <font color="#808080">= </font><font color="#FF0000">3 </font><font color="#0000FF">THEN  </font><font color="#808080">(* Vendas *)
   </font><font color="#0000FF">WHILE</font><font color="#808080">(</font>bSOp<font color="#808080">) </font><font color="#0000FF">DO 
     </font>menu<font color="#808080">(</font><font color="#FF0000">4</font><font color="#808080">);
     </font>ReadInt<font color="#808080">(</font>opSubMenu<font color="#808080">);
     </font><font color="#0000FF">CASE</font><font color="#808080">(</font>opSubMenu<font color="#808080">) </font><font color="#0000FF">OF
      </font><font color="#808080">| </font><font color="#FF0000">1</font><font color="#808080">: </font>subMenu<font color="#808080">(</font><font color="#FF0000">6</font><font color="#808080">, </font>opVenda<font color="#808080">);
      | </font><font color="#FF0000">2</font><font color="#808080">: </font>subMenu<font color="#808080">(</font><font color="#FF0000">12</font><font color="#808080">, </font>opVenda<font color="#808080">);
      | </font><font color="#FF0000">3</font><font color="#808080">: </font>bSOp<font color="#808080">:=</font>FALSE<font color="#808080">;
      </font><font color="#0000FF">ELSE </font>WriteLinha<font color="#808080">(</font>MSG_ERRO<font color="#808080">);
     </font><font color="#0000FF">END</font><font color="#808080">;
   </font><font color="#0000FF">END</font><font color="#808080">;
 </font><font color="#0000FF">ELSIF </font>num <font color="#808080">= </font><font color="#FF0000">4 </font><font color="#0000FF">THEN  </font><font color="#808080">(* Opcoes *)
   </font><font color="#0000FF">WHILE</font><font color="#808080">(</font>bSOp<font color="#808080">) </font><font color="#0000FF">DO 
     </font>menu<font color="#808080">(</font><font color="#FF0000">5</font><font color="#808080">);
     </font>ReadInt<font color="#808080">(</font>opSubMenu<font color="#808080">);
     </font><font color="#0000FF">CASE</font><font color="#808080">(</font>opSubMenu<font color="#808080">) </font><font color="#0000FF">OF
      </font><font color="#808080">| </font><font color="#FF0000">1</font><font color="#808080">: </font>frmAlterarSenha<font color="#808080">;
      | </font><font color="#FF0000">2</font><font color="#808080">: </font>frmSobre<font color="#808080">;
      | </font><font color="#FF0000">3</font><font color="#808080">: </font>menu<font color="#808080">(</font><font color="#FF0000">11</font><font color="#808080">);
           </font>Read<font color="#808080">(</font>opSair<font color="#808080">);
           </font><font color="#0000FF">IF </font><font color="#808080">(</font>opSair<font color="#808080">=</font><font color="#800000">'S'</font><font color="#808080">) </font><font color="#0000FF">OR </font><font color="#808080">(</font>opSair<font color="#808080">=</font><font color="#800000">'s'</font><font color="#808080">) </font><font color="#0000FF">THEN 
              </font>fechaArqs<font color="#808080">();
              </font>HALT<font color="#808080">;
           </font><font color="#0000FF">END</font><font color="#808080">;
      | </font><font color="#FF0000">4</font><font color="#808080">: </font>bSOp<font color="#808080">:=</font>FALSE<font color="#808080">;
      </font><font color="#0000FF">ELSE </font>WriteLinha<font color="#808080">(</font>MSG_ERRO<font color="#808080">);
     </font><font color="#0000FF">END</font><font color="#808080">;
   </font><font color="#0000FF">END</font><font color="#808080">;
 </font><font color="#0000FF">END</font><font color="#808080">;
</font><font color="#0000FF">END </font>usaMenu<font color="#808080">;

(*------------------------------------------------------------------------------
</font>Realiza os cadastros dos arquivos que se ligam a outros arquivos.
sreg <font color="#808080">- </font>o tipo de arquivo
sacao <font color="#808080">- </font>a a<font color="#808080">&ccedil;&atilde;</font>o a ser realizada
sCodigo <font color="#808080">- </font>um das chaves do arquivo de liga<font color="#808080">&ccedil;&atilde;</font>o
<font color="#808080">------------------------------------------------------------------------------*)
</font><font color="#0000FF">PROCEDURE </font>frmCadLigados<font color="#808080">(</font>sreg<font color="#808080">: </font>ctArqs<font color="#808080">; </font>sacao<font color="#808080">: </font>ctAcao<font color="#808080">; </font>sCodigo<font color="#808080">: </font>String<font color="#808080">);
</font><font color="#0000FF">VAR </font>nQtd<font color="#808080">, </font>nCont<font color="#808080">, </font>nQtdEstoque<font color="#808080">: </font><font color="#0000FF">CARDINAL</font><font color="#808080">;
    </font>nTotalPreco<font color="#808080">: </font><font color="#0000FF">REAL</font><font color="#808080">;
    </font>slinha<font color="#808080">, </font>sTotalPreco<font color="#808080">, </font>sPreco<font color="#808080">, </font>sQtd<font color="#808080">: </font>String<font color="#808080">;
    </font>nStatus<font color="#808080">: </font>ConvResults<font color="#808080">;
</font><font color="#0000FF">BEGIN
IF </font>sacao<font color="#808080">=</font>opNovo <font color="#0000FF">THEN 
  </font>nCont<font color="#808080">:=</font><font color="#FF0000">1</font><font color="#808080">;
  </font><font color="#0000FF">IF </font>sreg<font color="#808080">=</font>opLivroAss <font color="#0000FF">THEN 
    </font>sQtd<font color="#808080">:=</font>validaNumero<font color="#808080">(</font><font color="#800000">'Quantos assuntos quer cadastrar?: '</font><font color="#808080">, </font>sQtd<font color="#808080">);
    </font>StrToCard<font color="#808080">(</font>sQtd<font color="#808080">, </font>nQtd<font color="#808080">, </font>nStatus<font color="#808080">);
    </font>SetPos<font color="#808080">(</font>tfLivroAss<font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">);
    </font><font color="#0000FF">WHILE </font>nCont <font color="#808080">&lt;= </font>nQtd <font color="#0000FF">DO 
      </font>tLivroAss.isbn<font color="#808080">:=</font>sCodigo<font color="#808080">;
      </font>WriteString<font color="#808080">(</font>rotulo<font color="#808080">(</font>opLivroAss<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">));
      </font>ReadLinha<font color="#808080">(</font>tLivroAss.codassunto<font color="#808080">);
      </font>slinha<font color="#808080">:=</font>pesqArq<font color="#808080">(</font>tfAssunto<font color="#808080">, </font>tLivroAss.codassunto<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">,</font>tamReg<font color="#808080">(</font>opAssunto<font color="#808080">));
      </font>WriteString<font color="#808080">(</font>Ss<font color="#808080">(</font><font color="#800000">' '</font><font color="#808080">,</font>rotulo<font color="#808080">(</font>opAssunto<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">)));
      </font>WriteLinha<font color="#808080">(</font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font>g_nPosChave<font color="#808080">, </font>g_nTamChave<font color="#808080">));
      </font>pesqLinhaExcluida<font color="#808080">(</font>tfLivroAss<font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">));
      </font>subMenu<font color="#808080">(</font><font color="#FF0000">14</font><font color="#808080">, </font>sreg<font color="#808080">);
      </font>nCont<font color="#808080">:=</font>nCont<font color="#808080">+</font><font color="#FF0000">1</font><font color="#808080">;
    </font><font color="#0000FF">END</font><font color="#808080">;
  </font><font color="#0000FF">ELSIF </font>sreg<font color="#808080">=</font>opLivroAut <font color="#0000FF">THEN 
    </font>sQtd<font color="#808080">:=</font>validaNumero<font color="#808080">(</font><font color="#800000">'Quantos autores quer cadastrar?: '</font><font color="#808080">,</font>sQtd<font color="#808080">);
    </font>StrToCard<font color="#808080">(</font>sQtd<font color="#808080">, </font>nQtd<font color="#808080">, </font>nStatus<font color="#808080">);
    </font>SetPos<font color="#808080">(</font>tfLivroAut<font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">);
    </font><font color="#0000FF">WHILE </font>nCont <font color="#808080">&lt;= </font>nQtd <font color="#0000FF">DO 
      </font>tLivroAut.isbn<font color="#808080">:=</font>sCodigo<font color="#808080">;
      </font>WriteString<font color="#808080">(</font>rotulo<font color="#808080">(</font>opLivroAut<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">));
      </font>ReadLinha<font color="#808080">(</font>tLivroAut.codautor<font color="#808080">);
      </font>slinha<font color="#808080">:=</font>pesqArq<font color="#808080">(</font>tfAutor<font color="#808080">, </font>tLivroAut.codautor<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">,</font>tamReg<font color="#808080">(</font>opAutor<font color="#808080">));
      </font>WriteString<font color="#808080">(</font>Ss<font color="#808080">(</font><font color="#800000">' '</font><font color="#808080">,</font>rotulo<font color="#808080">(</font>opAutor<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">)));
      </font>WriteLinha<font color="#808080">(</font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font>g_nPosChave<font color="#808080">, </font>g_nTamChave<font color="#808080">));
      </font>pesqLinhaExcluida<font color="#808080">(</font>tfLivroAut<font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">));
      </font>subMenu<font color="#808080">(</font><font color="#FF0000">14</font><font color="#808080">, </font>sreg<font color="#808080">);
      </font>nCont<font color="#808080">:=</font>nCont<font color="#808080">+</font><font color="#FF0000">1</font><font color="#808080">;
    </font><font color="#0000FF">END</font><font color="#808080">;
  </font><font color="#0000FF">ELSIF </font>sreg<font color="#808080">=</font>opVenda <font color="#0000FF">THEN 
    </font>sQtd<font color="#808080">:=</font>validaNumero<font color="#808080">(</font><font color="#800000">'Quantos livros quer vender?: '</font><font color="#808080">,</font>sQtd<font color="#808080">);
    </font>StrToCard<font color="#808080">(</font>sQtd<font color="#808080">, </font>nQtd<font color="#808080">, </font>nStatus<font color="#808080">);
    </font>nTotalPreco<font color="#808080">:=</font><font color="#FF0000">0</font>.0<font color="#808080">;
    </font><font color="#0000FF">WHILE </font>nCont <font color="#808080">&lt;= </font>nQtd <font color="#0000FF">DO 
      </font>slinha<font color="#808080">:=</font>validaEntrada<font color="#808080">(</font>tfLivro<font color="#808080">,</font>opLivro<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font>tVenda.isbn<font color="#808080">,</font><font color="#FF0000">3</font><font color="#808080">,</font>FALSE<font color="#808080">,</font>opTexto<font color="#808080">);
      </font><font color="#0000FF">IF </font>Compare<font color="#808080">(</font>slinha<font color="#808080">,</font><font color="#800000">''</font><font color="#808080">)&lt;&gt;</font>equal <font color="#0000FF">THEN 
        </font>tVenda.isbn<font color="#808080">:=</font>trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#FF0000">13</font><font color="#808080">));
        </font><font color="#0000FF">IF </font>validaISBN<font color="#808080">(</font>tVenda.isbn<font color="#808080">) </font><font color="#0000FF">THEN 
          </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#800000">''</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">);
          </font>tLivro.qtdestoque<font color="#808080">:=</font>trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha<font color="#808080">,</font><font color="#FF0000">134</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">));
          </font>StrToCard<font color="#808080">(</font>tLivro.qtdestoque<font color="#808080">, </font>nQtdEstoque<font color="#808080">, </font>nStatus<font color="#808080">);
          </font><font color="#0000FF">IF </font>nQtdEstoque <font color="#808080">&gt; </font><font color="#FF0000">0 </font><font color="#0000FF">THEN 
             </font>nTotalPreco<font color="#808080">:=</font>nTotalPreco <font color="#808080">+ </font>g_nPreco<font color="#808080">;
             </font>RealToStr<font color="#808080">(</font>g_nPreco<font color="#808080">,</font>sPreco<font color="#808080">);
             </font>tVenda.precovenda<font color="#808080">:=</font>sPreco<font color="#808080">;
             </font>g_SalvarInclusao<font color="#808080">:=</font>FALSE<font color="#808080">;
             </font>subMenu<font color="#808080">(</font><font color="#FF0000">14</font><font color="#808080">, </font>sreg<font color="#808080">);
             </font><font color="#0000FF">IF </font>g_SalvarInclusao <font color="#0000FF">THEN 
                </font>slinha<font color="#808080">:=</font>pesqArq<font color="#808080">(</font>tfLivro<font color="#808080">, </font>tVenda.isbn<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">13</font><font color="#808080">, </font>tamReg<font color="#808080">(</font>opLivro<font color="#808080">));
                </font><font color="#0000FF">IF </font>Compare<font color="#808080">(</font>slinha<font color="#808080">,</font><font color="#800000">''</font><font color="#808080">)&lt;&gt;</font>equal <font color="#0000FF">THEN 
                   </font>nQtdEstoque<font color="#808080">:=</font>nQtdEstoque<font color="#808080">-</font><font color="#FF0000">1</font><font color="#808080">;
                   </font>CardToStr<font color="#808080">(</font>nQtdEstoque<font color="#808080">,</font>tLivro.qtdestoque<font color="#808080">);
                   </font>slinha<font color="#808080">:=</font>Ss<font color="#808080">(</font>copy<font color="#808080">(</font>slinha<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#FF0000">133</font><font color="#808080">),</font>esp<font color="#808080">(</font>tLivro.qtdestoque<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">));
                   </font>escreveArq<font color="#808080">(</font>tfLivro<font color="#808080">, </font>slinha<font color="#808080">, </font><font color="#800000">''</font><font color="#808080">, </font><font color="#800000">''</font><font color="#808080">);
                </font><font color="#0000FF">END</font><font color="#808080">;
             </font><font color="#0000FF">END</font><font color="#808080">;
             </font>nCont<font color="#808080">:=</font>nCont<font color="#808080">+</font><font color="#FF0000">1</font><font color="#808080">;
          </font><font color="#0000FF">ELSE </font>WriteLinha<font color="#808080">(</font>MSG_SEMESTOQUE<font color="#808080">);
          </font><font color="#0000FF">END</font><font color="#808080">;
        </font><font color="#0000FF">ELSE </font>WriteLinha<font color="#808080">(</font>MSG_ISBNINV<font color="#808080">);
        </font><font color="#0000FF">END</font><font color="#808080">; 
      </font><font color="#0000FF">END</font><font color="#808080">;
    </font><font color="#0000FF">END</font><font color="#808080">;
    </font>RealToStr<font color="#808080">(</font>nTotalPreco<font color="#808080">, </font>sTotalPreco<font color="#808080">);
    </font>WriteLinha<font color="#808080">(</font>Ss<font color="#808080">(</font>Ss<font color="#808080">(</font><font color="#800000">'Total de '</font><font color="#808080">,</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">,</font><font color="#FF0000">4</font><font color="#808080">)),</font>sTotalPreco<font color="#808080">));
  </font><font color="#0000FF">END</font><font color="#808080">;
</font><font color="#0000FF">ELSIF </font>sacao<font color="#808080">=</font>opExcluir <font color="#0000FF">THEN 
  IF </font>sreg<font color="#808080">=</font>opLivroAss <font color="#0000FF">THEN 
     </font>ExcluirRegLigados<font color="#808080">(</font>tfLivroAss<font color="#808080">, </font>sreg<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">13</font><font color="#808080">, </font>sCodigo<font color="#808080">);
  </font><font color="#0000FF">ELSIF </font>sreg<font color="#808080">=</font>opLivroAut <font color="#0000FF">THEN 
     </font>ExcluirRegLigados<font color="#808080">(</font>tfLivroAut<font color="#808080">, </font>sreg<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">13</font><font color="#808080">, </font>sCodigo<font color="#808080">);
  </font><font color="#0000FF">END</font><font color="#808080">;
</font><font color="#0000FF">END</font><font color="#808080">;

</font><font color="#0000FF">END </font>frmCadLigados<font color="#808080">;

</font><font color="#0000FF">END </font>Telas.
</font>
</code></pre>
</body>
</html>