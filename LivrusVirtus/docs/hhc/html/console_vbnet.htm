<html>
<head>
<title>Livrus Virtus - Console - Visual Basic .NET</title>
</head>
<!-- Generated by ConTEXT HTML exporter -->
<body text="#000000" bgcolor="#FFFFFF">
<pre>
<code><font  face="Courier New"><font color="#808080"><i>'------------------------------------------------------------------------------
' Sistema integrante do projeto Livrus Virtus.
' Todos os direitos reservados para Henrique F. de Souza.
' Vers&atilde;o programada na linguagem Visual Basic.Net.
'------------------------------------------------------------------------------
' programa Livrus 

</i></font><font color="#000080"><b>Imports </b></font><font color="#0000FF"><b>System
</b></font><font color="#000080"><b>Imports </b></font><font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>IO
</b></font><font color="#000080"><b>Imports </b></font><font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Text
</b></font><font color="#000080"><b>Imports </b></font><font color="#0000FF"><b>Microsoft</b></font><font color="#808080">.</font><font color="#0000FF"><b>VisualBasic

</b></font><font color="#000080"><b>Namespace </b></font>Livrus

<font color="#000080"><b>Public Class </b></font>Livrus 
       <font color="#000080"><b>Inherits </b></font><font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#000080"><b>Object

  </b></font><font color="#808080"><i>'Declara&ccedil;&atilde;o de tipos

  </i></font><font color="#000080"><b>Structure </b></font>regAssunto
   public codigo <font color="#000080"><b>As </b></font>string <font color="#808080"><i>'10
   </i></font>public assunto <font color="#000080"><b>As </b></font>string <font color="#808080"><i>'30
  </i></font><font color="#000080"><b>End Structure
  Structure </b></font>regAutor 
   public codigo <font color="#000080"><b>As </b></font>string <font color="#808080"><i>'10
   </i></font>public autor <font color="#000080"><b>As </b></font>string <font color="#808080"><i>'30
  </i></font><font color="#000080"><b>End Structure
  Structure </b></font>regEditora 
   public codigo <font color="#000080"><b>As </b></font>string <font color="#808080"><i>'10
   </i></font>public editora <font color="#000080"><b>As </b></font>string <font color="#808080"><i>'50
  </i></font><font color="#000080"><b>End Structure
  Structure </b></font>regIdioma 
   public codigo <font color="#000080"><b>As </b></font>string <font color="#808080"><i>'10
   </i></font>public idioma <font color="#000080"><b>As </b></font>string <font color="#808080"><i>'20
  </i></font><font color="#000080"><b>End Structure
  Structure </b></font>regUsuario 
   public login <font color="#000080"><b>As </b></font>string <font color="#808080"><i>'10
   </i></font>public senha <font color="#000080"><b>As </b></font>string <font color="#808080"><i>'10
  </i></font><font color="#000080"><b>End Structure
  Structure </b></font>regPais 
   public codigo <font color="#000080"><b>As </b></font>string <font color="#808080"><i>'3
   </i></font>public pais <font color="#000080"><b>As </b></font>string <font color="#808080"><i>'50
  </i></font><font color="#000080"><b>End Structure
  Structure </b></font>regProfissao 
   public codigo <font color="#000080"><b>As </b></font>string <font color="#808080"><i>'10
   </i></font>public profissao <font color="#000080"><b>As </b></font>string <font color="#808080"><i>'50
  </i></font><font color="#000080"><b>End Structure
  Structure </b></font>regLivro 
   public isbn <font color="#000080"><b>As </b></font>string <font color="#808080"><i>'13
   </i></font>public titulo <font color="#000080"><b>As </b></font>string <font color="#808080"><i>'50
   </i></font>public edicao <font color="#000080"><b>As </b></font>string <font color="#808080"><i>'10
   </i></font>public anopubli <font color="#000080"><b>As </b></font>string <font color="#808080"><i>'10
   </i></font>public codeditora <font color="#000080"><b>As </b></font>string <font color="#808080"><i>'10
   </i></font>public volume <font color="#000080"><b>As </b></font>string <font color="#808080"><i>'10
   </i></font>public codidioma <font color="#000080"><b>As </b></font>string <font color="#808080"><i>'10
   </i></font>public npaginas <font color="#000080"><b>As </b></font>string <font color="#808080"><i>'10
   </i></font>public preco <font color="#000080"><b>As </b></font>string <font color="#808080"><i>'10
   </i></font>public qtdestoque <font color="#000080"><b>As </b></font>string <font color="#808080"><i>'10
  </i></font><font color="#000080"><b>End Structure
  Structure </b></font>regLivroAss 
   public isbn <font color="#000080"><b>As </b></font>string <font color="#808080"><i>'13
   </i></font>public codassunto <font color="#000080"><b>As </b></font>string <font color="#808080"><i>'10
  </i></font><font color="#000080"><b>End Structure
  Structure </b></font>regLivroAut 
   public isbn <font color="#000080"><b>As </b></font>string <font color="#808080"><i>'13
   </i></font>public codautor <font color="#000080"><b>As </b></font>string <font color="#808080"><i>'10
  </i></font><font color="#000080"><b>End Structure
  Structure </b></font>regCliente 
   public cpf <font color="#000080"><b>As </b></font>string <font color="#808080"><i>'14
   </i></font>public nome <font color="#000080"><b>As </b></font>string <font color="#808080"><i>'30
   </i></font>public email <font color="#000080"><b>As </b></font>string <font color="#808080"><i>'30
   </i></font>public identidade <font color="#000080"><b>As </b></font>string <font color="#808080"><i>'10
   </i></font>public sexo <font color="#000080"><b>As </b></font>string <font color="#808080"><i>'1
   </i></font>public telefone <font color="#000080"><b>As </b></font>string <font color="#808080"><i>'17
   </i></font>public dtnascimento <font color="#000080"><b>As </b></font>string <font color="#808080"><i>'10
   </i></font>public codendereco <font color="#000080"><b>As </b></font>string <font color="#808080"><i>'10
   </i></font>public codpais <font color="#000080"><b>As </b></font>string <font color="#808080"><i>'3
   </i></font>public codprofissao <font color="#000080"><b>As </b></font>string <font color="#808080"><i>'10
  </i></font><font color="#000080"><b>End Structure
  Structure </b></font>regEndereco 
   public codigo <font color="#000080"><b>As </b></font>string <font color="#808080"><i>'10
   </i></font>public logradouro <font color="#000080"><b>As </b></font>string <font color="#808080"><i>'40
   </i></font>public bairro <font color="#000080"><b>As </b></font>string <font color="#808080"><i>'15
   </i></font>public cep <font color="#000080"><b>As </b></font>string <font color="#808080"><i>'8
   </i></font>public cidade <font color="#000080"><b>As </b></font>string <font color="#808080"><i>'30
   </i></font>public estado <font color="#000080"><b>As </b></font>string <font color="#808080"><i>'20
  </i></font><font color="#000080"><b>End Structure
  Structure </b></font>regVenda 
   public dthrvenda <font color="#000080"><b>As </b></font>string <font color="#808080"><i>'19  'data/hora da venda dd/mm/yyyy hh:mm:ss
   </i></font>public cpf <font color="#000080"><b>As </b></font>string <font color="#808080"><i>'14
   </i></font>public isbn <font color="#000080"><b>As </b></font>string <font color="#808080"><i>'13
   </i></font>public precovenda <font color="#000080"><b>As </b></font>string <font color="#808080"><i>'10
  </i></font><font color="#000080"><b>End Structure

  Enum </b></font>ctTipo 
    opTexto
    opNumero
    opData
    opDataHora
    opSenha
  <font color="#000080"><b>End Enum
  Enum </b></font>ctArqs 
    opAssunto
    opAutor
    opEditora
    opEndereco
    opIdioma
    opPais
    opProfissao
    opCliente
    opLivro
    opLivroAss
    opLivroAut
    opUsuario
    opVenda
  <font color="#000080"><b>End Enum
  Enum </b></font>ctAcao 
    opNovo
    opAlterar
    opPesquisar
    opSalvarInclusao
    opSalvarAlteracao
    opExcluir
    opConfirmaExclusao
    opListarTodos
  <font color="#000080"><b>End Enum

  Dim </b></font>CRLF <font color="#000080"><b>As String </b></font><font color="#808080">= </font><font color="#800000">&quot;\r\n&quot; </font><font color="#808080"><i>'windows
  </i></font><font color="#000080"><b>Dim </b></font>TAM_CRLF <font color="#000080"><b>As Integer </b></font><font color="#808080">= </font><font color="#FF0000">2
  </font><font color="#808080"><i>' Dim CRLF As String = &quot;\n&quot;
  ' Dim TAM_CRLF As Integer = 1 'unix
  ' Dim CRLF As String = &quot;\r&quot;
  ' Dim TAM_CRLF As Integer = 1 'macintosh

  </i></font><font color="#000080"><b>Dim </b></font>QTD_MAX_LINHA <font color="#000080"><b>As Integer </b></font><font color="#808080">= </font><font color="#FF0000">18
  </font><font color="#000080"><b>Dim </b></font>TAM_MAX_REG <font color="#000080"><b>As Integer </b></font><font color="#808080">= </font><font color="#FF0000">145

  </font><font color="#000080"><b>Dim </b></font>MSG_ARQERRO <font color="#000080"><b>As String </b></font><font color="#808080">= </font><font color="#800000">&quot;Erro: O arquivo n&atilde;o pode ser aberto.&quot;
  </font><font color="#000080"><b>Dim </b></font>MSG_ERRO <font color="#000080"><b>As String </b></font><font color="#808080">= </font><font color="#800000">&quot;Erro: op&ccedil;&atilde;o inv&aacute;lida digite de novo.&quot;
  </font><font color="#000080"><b>Dim </b></font>MSG_OPCAO <font color="#000080"><b>As String </b></font><font color="#808080">= </font><font color="#800000">&quot;Escolha uma op&ccedil;&atilde;o: &quot;
  </font><font color="#000080"><b>Dim </b></font>MSG_PRESS <font color="#000080"><b>As String </b></font><font color="#808080">= </font><font color="#800000">&quot;pressione para continuar...&quot;

  </font><font color="#000080"><b>Dim </b></font>MSG_REGINC <font color="#000080"><b>As String </b></font><font color="#808080">= </font><font color="#800000">&quot;registro incluido!&quot;
  </font><font color="#000080"><b>Dim </b></font>MSG_REGNINC <font color="#000080"><b>As String </b></font><font color="#808080">= </font><font color="#800000">&quot;registro n&atilde;o incluido!&quot;
  </font><font color="#000080"><b>Dim </b></font>MSG_REGALT <font color="#000080"><b>As String </b></font><font color="#808080">= </font><font color="#800000">&quot;registro alterado!&quot;
  </font><font color="#000080"><b>Dim </b></font>MSG_REGNALT <font color="#000080"><b>As String </b></font><font color="#808080">= </font><font color="#800000">&quot;registro n&atilde;o alterado!&quot;
  </font><font color="#000080"><b>Dim </b></font>MSG_REGEXC <font color="#000080"><b>As String </b></font><font color="#808080">= </font><font color="#800000">&quot;registro excluido!&quot;
  </font><font color="#000080"><b>Dim </b></font>MSG_REGNEXC <font color="#000080"><b>As String </b></font><font color="#808080">= </font><font color="#800000">&quot;registro n&atilde;o excluido!&quot;
  </font><font color="#000080"><b>Dim </b></font>MSG_REGEXST <font color="#000080"><b>As String </b></font><font color="#808080">= </font><font color="#800000">&quot;registro j&aacute; existe!&quot;

  </font><font color="#000080"><b>Dim </b></font>MSG_NUMINV <font color="#000080"><b>As String </b></font><font color="#808080">= </font><font color="#800000">&quot;N&uacute;mero inv&aacute;lido ou menor do que 1!&quot;
  </font><font color="#000080"><b>Dim </b></font>MSG_DATAINV <font color="#000080"><b>As String </b></font><font color="#808080">= </font><font color="#800000">&quot;Data inv&aacute;lida!, formato correto (dd/mm/yyyy)&quot;
  </font><font color="#000080"><b>Dim </b></font>MSG_DTHRINV <font color="#000080"><b>As String </b></font><font color="#808080">= </font>_
		<font color="#800000">&quot;Data/hora inv&aacute;lida!, formato correto (dd/mm/yyyy hh:mm:ss)&quot;
  </font><font color="#000080"><b>Dim </b></font>MSG_ISBNINV <font color="#000080"><b>As String </b></font><font color="#808080">= </font><font color="#800000">&quot;ISBN inv&aacute;lido!&quot;
  </font><font color="#000080"><b>Dim </b></font>MSG_CPFINV <font color="#000080"><b>As String </b></font><font color="#808080">= </font><font color="#800000">&quot;CPF inv&aacute;lido!&quot;
  </font><font color="#000080"><b>Dim </b></font>MSG_SENCONFERE <font color="#000080"><b>As String </b></font><font color="#808080">= </font><font color="#800000">&quot;senha n&atilde;o confere com a senha atual!&quot;
  </font><font color="#000080"><b>Dim </b></font>MSG_SENCONFIRM<font color="#808080">=</font><font color="#800000">&quot;nova senha n&atilde;o confere com a senha confirmada!&quot;
  </font><font color="#000080"><b>Dim </b></font>MSG_LOGINENCON <font color="#000080"><b>As String </b></font><font color="#808080">= </font><font color="#800000">&quot;login n&atilde;o encontrado!&quot;
  </font><font color="#000080"><b>Dim </b></font>MSG_SEMESTOQUE <font color="#000080"><b>As String </b></font><font color="#808080">= </font><font color="#800000">&quot;livro n&atilde;o existe no estoque!&quot;

  </font><font color="#000080"><b>Dim </b></font>ARQ_ASSUNTO <font color="#000080"><b>As String </b></font><font color="#808080">= </font><font color="#800000">&quot;assunto.dat&quot;
  </font><font color="#000080"><b>Dim </b></font>ARQ_AUTOR <font color="#000080"><b>As String </b></font><font color="#808080">= </font><font color="#800000">&quot;autor.dat&quot;
  </font><font color="#000080"><b>Dim </b></font>ARQ_EDITORA <font color="#000080"><b>As String </b></font><font color="#808080">= </font><font color="#800000">&quot;editora.dat&quot;
  </font><font color="#000080"><b>Dim </b></font>ARQ_IDIOMA <font color="#000080"><b>As String </b></font><font color="#808080">= </font><font color="#800000">&quot;idioma.dat&quot;
  </font><font color="#000080"><b>Dim </b></font>ARQ_USUARIO <font color="#000080"><b>As String </b></font><font color="#808080">= </font><font color="#800000">&quot;usuario.dat&quot;
  </font><font color="#000080"><b>Dim </b></font>ARQ_PAIS <font color="#000080"><b>As String </b></font><font color="#808080">= </font><font color="#800000">&quot;pais.dat&quot;
  </font><font color="#000080"><b>Dim </b></font>ARQ_PROFISSAO <font color="#000080"><b>As String </b></font><font color="#808080">= </font><font color="#800000">&quot;profissao.dat&quot;
  </font><font color="#000080"><b>Dim </b></font>ARQ_LIVRO <font color="#000080"><b>As String </b></font><font color="#808080">= </font><font color="#800000">&quot;livro.dat&quot;
  </font><font color="#000080"><b>Dim </b></font>ARQ_LIVASS <font color="#000080"><b>As String </b></font><font color="#808080">= </font><font color="#800000">&quot;livroass.dat&quot;
  </font><font color="#000080"><b>Dim </b></font>ARQ_LIVAUT <font color="#000080"><b>As String </b></font><font color="#808080">= </font><font color="#800000">&quot;livroaut.dat&quot;
  </font><font color="#000080"><b>Dim </b></font>ARQ_CLIENTE <font color="#000080"><b>As String </b></font><font color="#808080">= </font><font color="#800000">&quot;cliente.dat&quot;
  </font><font color="#000080"><b>Dim </b></font>ARQ_ENDERECO <font color="#000080"><b>As String </b></font><font color="#808080">= </font><font color="#800000">&quot;endereco.dat&quot;
  </font><font color="#000080"><b>Dim </b></font>ARQ_VENDA <font color="#000080"><b>As String </b></font><font color="#808080">= </font><font color="#800000">&quot;venda.dat&quot;

  </font><font color="#000080"><b>Dim </b></font>TAM_ASSUNTO <font color="#000080"><b>As Integer </b></font><font color="#808080">= </font><font color="#FF0000">40
  </font><font color="#000080"><b>Dim </b></font>TAM_AUTOR <font color="#000080"><b>As Integer </b></font><font color="#808080">= </font><font color="#FF0000">40
  </font><font color="#000080"><b>Dim </b></font>TAM_EDITORA <font color="#000080"><b>As Integer </b></font><font color="#808080">= </font><font color="#FF0000">60
  </font><font color="#000080"><b>Dim </b></font>TAM_IDIOMA <font color="#000080"><b>As Integer </b></font><font color="#808080">= </font><font color="#FF0000">30
  </font><font color="#000080"><b>Dim </b></font>TAM_USUARIO <font color="#000080"><b>As Integer </b></font><font color="#808080">= </font><font color="#FF0000">20
  </font><font color="#000080"><b>Dim </b></font>TAM_PAIS <font color="#000080"><b>As Integer </b></font><font color="#808080">= </font><font color="#FF0000">53
  </font><font color="#000080"><b>Dim </b></font>TAM_PROFISSAO <font color="#000080"><b>As Integer </b></font><font color="#808080">= </font><font color="#FF0000">60
  </font><font color="#000080"><b>Dim </b></font>TAM_LIVRO <font color="#000080"><b>As Integer </b></font><font color="#808080">= </font><font color="#FF0000">143
  </font><font color="#000080"><b>Dim </b></font>TAM_LIVASS <font color="#000080"><b>As Integer </b></font><font color="#808080">= </font><font color="#FF0000">23
  </font><font color="#000080"><b>Dim </b></font>TAM_LIVAUT <font color="#000080"><b>As Integer </b></font><font color="#808080">= </font><font color="#FF0000">23
  </font><font color="#000080"><b>Dim </b></font>TAM_CLIENTE <font color="#000080"><b>As Integer </b></font><font color="#808080">= </font><font color="#FF0000">135
  </font><font color="#000080"><b>Dim </b></font>TAM_ENDERECO <font color="#000080"><b>As Integer </b></font><font color="#808080">= </font><font color="#FF0000">123
  </font><font color="#000080"><b>Dim </b></font>TAM_VENDA <font color="#000080"><b>As Integer </b></font><font color="#808080">= </font><font color="#FF0000">56

  </font><font color="#808080"><i>'variaveis gerais

  </i></font><font color="#000080"><b>Dim </b></font>bopcao <font color="#000080"><b>As Boolean
  Dim </b></font>opmenu <font color="#000080"><b>As Char
  Dim </b></font>g_nPosChave<font color="#808080">, </font>g_nTamChave <font color="#000080"><b>As Integer
  Dim </b></font>g_nPreco <font color="#000080"><b>As Double
  Dim </b></font>g_SalvarInclusao <font color="#000080"><b>As Boolean

  Dim </b></font>tAssunto <font color="#000080"><b>As </b></font>regAssunto
  <font color="#000080"><b>Dim </b></font>tAutor <font color="#000080"><b>As </b></font>regAutor
  <font color="#000080"><b>Dim </b></font>tEditora <font color="#000080"><b>As </b></font>regEditora
  <font color="#000080"><b>Dim </b></font>tIdioma <font color="#000080"><b>As </b></font>regIdioma
  <font color="#000080"><b>Dim </b></font>tEndereco <font color="#000080"><b>As </b></font>regEndereco
  <font color="#000080"><b>Dim </b></font>tPais <font color="#000080"><b>As </b></font>regPais
  <font color="#000080"><b>Dim </b></font>tProfissao <font color="#000080"><b>As </b></font>regProfissao
  <font color="#000080"><b>Dim </b></font>tLivro <font color="#000080"><b>As </b></font>regLivro
  <font color="#000080"><b>Dim </b></font>tLivroAss <font color="#000080"><b>As </b></font>regLivroAss
  <font color="#000080"><b>Dim </b></font>tLivroAut <font color="#000080"><b>As </b></font>regLivroAut
  <font color="#000080"><b>Dim </b></font>tCliente <font color="#000080"><b>As </b></font>regCliente
  <font color="#000080"><b>Dim </b></font>tUsuario <font color="#000080"><b>As </b></font>regUsuario
  <font color="#000080"><b>Dim </b></font>tVenda <font color="#000080"><b>As </b></font>regVenda

  <font color="#000080"><b>Dim </b></font>tfAssunto<font color="#808080">, </font>tfAutor<font color="#808080">, </font>tfEditora<font color="#808080">, </font>tfIdioma<font color="#808080">, </font>tfEndereco<font color="#808080">, </font>_ 
  tfPais<font color="#808080">, </font>tfProfissao<font color="#808080">, </font>tfLivro<font color="#808080">, </font>tfLivroAss<font color="#808080">, </font>tfLivroAut<font color="#808080">, </font>tfCliente<font color="#808080">, </font>_ 
  tfUsuario<font color="#808080">, </font>tfVenda <font color="#000080"><b>As </b></font>FileStream

<font color="#808080"><i>'Public Sub New()
'    MyBase.New()
'End Sub

'--- Rotinas b&aacute;sicas --------------------------------------------------------

'------------------------------------------------------------------------------
'Repete um texto um n&uacute;mero determinado de vezes.
'sTexto - o texto a ser repetido
'nQtd - a quantidade de vezes
'retorna - o texto repetido
'------------------------------------------------------------------------------
</i></font><font color="#000080"><b>Private </b></font>function repete<font color="#808080">(</font>sTexto as string<font color="#808080">, </font>nQtd as integer<font color="#808080">) </font><font color="#000080"><b>As String
</b></font>dim ncont as integer
dim sret as string <font color="#808080">= </font><font color="#800000">&quot;&quot;

  </font>for ncont <font color="#808080">= </font><font color="#FF0000">1 </font>to nQtd 
    sret <font color="#808080">= </font>sret <font color="#808080">&amp; </font>sTexto
  next ncont
  repete <font color="#808080">= </font>sret
end function
<font color="#808080"><i>'------------------------------------------------------------------------------
'Coloca espa&ccedil;os em branco a mais de acordo com o tamanho m&aacute;ximo do texto.
'sTexto - o texto
'nTam - tamanho m&aacute;ximo do texto
'retorna - o texto com espa&ccedil;os em branco a mais
'------------------------------------------------------------------------------
</i></font>private function esp<font color="#808080">(</font>sTexto as string<font color="#808080">, </font>nTam as integer<font color="#808080">) </font>as string
dim sret as string

sret <font color="#808080">= </font>sTexto <font color="#808080">&amp; </font>repete<font color="#808080">(</font><font color="#800000">&quot; &quot;</font><font color="#808080">,</font>nTam<font color="#808080">-</font><font color="#000080"><b>Len</b></font><font color="#808080">(</font>sTexto<font color="#808080">))
</font>esp <font color="#808080">= </font>sret
end function
<font color="#808080"><i>'------------------------------------------------------------------------------
'Faz uma pesquisa relativa de um texto atrav&eacute;s de um valor chave.
'sTexto - o texto
'sChave - a chave a ser pesquisada
'retorna - se achou ou n&atilde;o a chave dentro do texto
'------------------------------------------------------------------------------
</i></font>private function strRelativa<font color="#808080">(</font>sTexto as string<font color="#808080">, </font>sChave as string<font color="#808080">) </font>as <font color="#000080"><b>Boolean
</b></font>dim nCont<font color="#808080">, </font>nTamChave<font color="#808080">, </font>nTamTexto as integer
dim bret as <font color="#000080"><b>Boolean
</b></font>dim sPedaco as string

bret <font color="#808080">= </font><font color="#000080"><b>false
</b></font>nCont <font color="#808080">= </font><font color="#FF0000">1
</font>nTamChave <font color="#808080">= </font><font color="#000080"><b>Len</b></font><font color="#808080">(</font>sChave<font color="#808080">)
  </font>nTamTexto <font color="#808080">= </font><font color="#000080"><b>Len</b></font><font color="#808080">(</font>sTexto<font color="#808080">)
  </font>if nTamChave <font color="#808080">&lt;= </font>nTamTexto then
    while nCont <font color="#808080">&lt;= (</font>nTamTexto<font color="#808080">-</font>nTamChave<font color="#808080">+</font><font color="#FF0000">1</font><font color="#808080">)
       </font>sPedaco <font color="#808080">= </font><font color="#000080"><b>Mid</b></font><font color="#808080">(</font>sTexto<font color="#808080">,</font>nCont<font color="#808080">,</font>nTamChave<font color="#808080">)
       </font>if sPedaco <font color="#808080">= </font>sChave then
          bret <font color="#808080">= </font><font color="#000080"><b>true
       </b></font>end if
       nCont <font color="#808080">= </font>nCont <font color="#808080">+ </font><font color="#FF0000">1
    </font>end while
  end if
  strRelativa <font color="#808080">= </font>bret
end function

<font color="#808080"><i>'------------------------------------------------------------------------------
'Calcula o modulo11 de um valor qualquer.
'svalor - a string com o n&uacute;mero a ser calculado
'ndig - d&iacute;gito do valor a ser calculado
'retorna - o d&iacute;gito correto
'------------------------------------------------------------------------------
</i></font><font color="#000080"><b>Private Function </b></font>modulo11<font color="#808080">(</font>svalor <font color="#000080"><b>As String</b></font><font color="#808080">, </font>ndig <font color="#000080"><b>As Integer</b></font><font color="#808080">) </font><font color="#000080"><b>As Integer
Dim </b></font>ncont <font color="#000080"><b>As Integer</b></font><font color="#808080">, </font>nsoma <font color="#000080"><b>As Integer</b></font><font color="#808080">, </font>nstatus <font color="#000080"><b>As Integer 
Dim </b></font>nvalor <font color="#000080"><b>As Integer</b></font><font color="#808080">, </font>npos <font color="#000080"><b>As Integer
Dim </b></font>sres <font color="#000080"><b>As String</b></font><font color="#808080">, </font>slocal <font color="#000080"><b>As String

 </b></font>ncont <font color="#808080">= </font><font color="#FF0000">0
 </font>while ncont <font color="#808080">&lt; </font><font color="#FF0000">11 
   </font>slocal <font color="#808080">= </font>svalor<font color="#808080">.</font>Substring<font color="#808080">(</font>ncont<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">) + </font>slocal
   ncont <font color="#808080">= </font>ncont<font color="#808080">+</font><font color="#FF0000">1
 </font>end while
 nsoma <font color="#808080">= </font><font color="#FF0000">0
 </font>if ndig<font color="#808080">=</font><font color="#FF0000">1 </font>then
   ncont <font color="#808080">= </font><font color="#FF0000">2
 </font>else
   ncont <font color="#808080">= </font><font color="#FF0000">1
 </font>end if
 npos <font color="#808080">= </font><font color="#FF0000">2
 </font>while ncont <font color="#808080">&lt; </font><font color="#FF0000">11
   </font>sres <font color="#808080">= </font>slocal<font color="#808080">.</font>Substring<font color="#808080">(</font>ncont<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">)
   </font>nvalor <font color="#808080">= </font><font color="#000080"><b>CInt</b></font><font color="#808080">(</font>sres<font color="#808080">)
   </font>nsoma <font color="#808080">= </font>nsoma <font color="#808080">+ (</font>nvalor <font color="#808080">* </font>npos<font color="#808080">)
   </font>ncont <font color="#808080">= </font>ncont<font color="#808080">+</font><font color="#FF0000">1
   </font>npos <font color="#808080">= </font>npos<font color="#808080">+</font><font color="#FF0000">1
 </font>end while
 nsoma <font color="#808080">= (</font><font color="#FF0000">11 </font><font color="#808080">- (</font>nsoma mod <font color="#FF0000">11</font><font color="#808080">))

</font>if nsoma <font color="#808080">&gt; </font><font color="#FF0000">9 </font>then
  modulo11 <font color="#808080">= </font><font color="#FF0000">0
</font>else
  modulo11 <font color="#808080">= </font>nsoma
end if
<font color="#000080"><b>End Function
</b></font><font color="#808080"><i>'------------------------------------------------------------------------------
'Valida&ccedil;&atilde;o de um n&uacute;mero de CPF qualquer.
'cpf - a mstring com o n&uacute;mero do CPF
'retorna - se &eacute; valido ou n&atilde;o
'------------------------------------------------------------------------------
</i></font><font color="#000080"><b>Public Function </b></font>ValidaCPF<font color="#808080">(</font>cpf <font color="#000080"><b>As String</b></font><font color="#808080">) </font><font color="#000080"><b>As Boolean
Dim </b></font>sCPF <font color="#000080"><b>As String

If </b></font><font color="#808080">(</font>cpf<font color="#808080">.</font>length <font color="#808080">= </font><font color="#FF0000">14</font><font color="#808080">) </font><font color="#000080"><b>Then
  </b></font>sCPF <font color="#808080">= </font>cpf<font color="#808080">.</font>Substring<font color="#808080">(</font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">) + </font>cpf<font color="#808080">.</font>Substring<font color="#808080">(</font><font color="#FF0000">4</font><font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">) + </font>cpf<font color="#808080">.</font>Substring<font color="#808080">(</font><font color="#FF0000">8</font><font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">) + </font>_
	 cpf<font color="#808080">.</font>Substring<font color="#808080">(</font><font color="#FF0000">12</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">)
  </font><font color="#000080"><b>If </b></font><font color="#808080">((</font>modulo11<font color="#808080">(</font>sCPF<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">) = </font><font color="#000080"><b>CInt</b></font><font color="#808080">(</font>cpf<font color="#808080">.</font>Substring<font color="#808080">(</font><font color="#FF0000">12</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">))) </font><font color="#000080"><b>And </b></font>_
     <font color="#808080">(</font>modulo11<font color="#808080">(</font>sCPF<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">) = </font><font color="#000080"><b>CInt</b></font><font color="#808080">(</font>cpf<font color="#808080">.</font>Substring<font color="#808080">(</font><font color="#FF0000">13</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">)))) </font><font color="#000080"><b>Then
   </b></font>ValidaCPF <font color="#808080">= </font>True
  <font color="#000080"><b>Else
   </b></font>ValidaCPF <font color="#808080">= </font>False
  <font color="#000080"><b>End If
Else
 </b></font>ValidaCPF <font color="#808080">= </font>False
<font color="#000080"><b>End If
End Function
</b></font><font color="#808080"><i>'------------------------------------------------------------------------------
'Valida&ccedil;&atilde;o de um n&uacute;mero ISBN qualquer.
'isbn - a mstring com o n&uacute;mero do ISBN
'retorna - se &eacute; valido ou n&atilde;o
'------------------------------------------------------------------------------
</i></font><font color="#000080"><b>Public Function </b></font>ValidaISBN<font color="#808080">(</font>isbn <font color="#000080"><b>As String</b></font><font color="#808080">) </font><font color="#000080"><b>As Boolean
Dim </b></font>snum  <font color="#000080"><b>As String</b></font><font color="#808080">, </font>sdigito <font color="#000080"><b>As String</b></font><font color="#808080">, </font>sisbn <font color="#000080"><b>As String
Dim </b></font>nvalor <font color="#000080"><b>As Integer</b></font><font color="#808080">, </font>nsoma <font color="#000080"><b>As Integer</b></font><font color="#808080">, </font>nstatus <font color="#000080"><b>As Integer</b></font><font color="#808080">, </font>ncont <font color="#000080"><b>As Integer

If </b></font><font color="#808080">(</font>isbn<font color="#808080">.</font>length <font color="#808080">= </font><font color="#FF0000">13</font><font color="#808080">) </font><font color="#000080"><b>Then
  </b></font>sdigito <font color="#808080">= </font>isbn<font color="#808080">.</font>Substring<font color="#808080">(</font>isbn<font color="#808080">.</font>length<font color="#808080">()-</font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">)
  </font>sisbn<font color="#808080">=</font><font color="#800000">&quot;&quot;
  </font>for ncont<font color="#808080">=</font><font color="#FF0000">0 </font>to isbn<font color="#808080">.</font>length<font color="#808080">()-</font><font color="#FF0000">2
    </font>if isbn<font color="#808080">.</font>Substring<font color="#808080">(</font>ncont<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">)&lt;&gt;</font><font color="#800000">&quot;-&quot; </font>then
      sisbn<font color="#808080">=</font>sisbn <font color="#808080">+ </font>isbn<font color="#808080">.</font>Substring<font color="#808080">(</font>ncont<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">)
    </font>end if
  next ncont
  if sdigito <font color="#808080">= </font><font color="#800000">&quot;X&quot; </font>then
    nsoma <font color="#808080">= </font><font color="#FF0000">10
  </font>else
    nvalor <font color="#808080">= </font><font color="#000080"><b>CInt</b></font><font color="#808080">(</font>sdigito<font color="#808080">)
    </font>nsoma <font color="#808080">= </font>nvalor
  end if
  for ncont <font color="#808080">= </font><font color="#FF0000">1 </font>to <font color="#FF0000">9
    </font>snum <font color="#808080">= </font>sisbn<font color="#808080">.</font>Substring<font color="#808080">(</font>ncont<font color="#808080">-</font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">)
    </font>nvalor <font color="#808080">= </font><font color="#000080"><b>CInt</b></font><font color="#808080">(</font>snum<font color="#808080">)
    </font>nsoma <font color="#808080">= </font>nsoma <font color="#808080">+ (</font>nvalor <font color="#808080">* (</font><font color="#FF0000">11 </font><font color="#808080">- </font>ncont<font color="#808080">))
  </font>next ncont
  <font color="#000080"><b>If </b></font><font color="#808080">(</font>nsoma mod <font color="#FF0000">11</font><font color="#808080">) = </font><font color="#FF0000">0 </font><font color="#000080"><b>Then
    </b></font>validaISBN <font color="#808080">= </font><font color="#000080"><b>true
  </b></font>else
    validaISBN <font color="#808080">= </font><font color="#000080"><b>false
  </b></font>end if
<font color="#000080"><b>Else
 </b></font>ValidaISBN <font color="#808080">= </font>False
<font color="#000080"><b>End If
End Function
</b></font><font color="#808080"><i>'------------------------------------------------------------------------------
'Esconde a digita&ccedil;&atilde;o da senha
'retorna - a senha digitada
'------------------------------------------------------------------------------
</i></font>function digitaSenha<font color="#808080">(</font>sRotulo as string<font color="#808080">, </font>nTamSenha as integer<font color="#808080">) </font>as string
 dim sSenha as string <font color="#808080">= </font><font color="#800000">&quot;&quot;
</font><font color="#808080"><i>' dim sLetra as char
' dim ncont as integer

  </i></font><font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font><font color="#000080"><b>Write</b></font><font color="#808080">(</font>sRotulo<font color="#808080">)
  </font>sSenha <font color="#808080">= </font><font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font><font color="#000080"><b>In</b></font><font color="#808080">.</font>ReadLine<font color="#808080">()

<i>'  ncont  = 0
'  sLetra = &quot;\0&quot;C
'  while (sLetra&lt;&gt;&quot;\r&quot;C) and (ncont &lt; nTamSenha) 
'	sLetra = System.Console.Read()
'	if (sLetra&lt;&gt;&quot;\r&quot;C) then
'	   sSenha = sSenha + sLetra
'	end if
'	ncont = ncont + 1
'  end while
'System.Console.WriteLine()

</i></font>digitaSenha <font color="#808080">= </font>sSenha
end function
<font color="#808080"><i>'------------------------------------------------------------------------------
'Valida&ccedil;&atilde;o de um n&uacute;mero qualquer.
'sRotulo - o texto antes de se digitar o n&uacute;mero
'sNumero - a String com o valor do n&uacute;mero
'retorna - o sNumero
'------------------------------------------------------------------------------
</i></font>function validaNumero<font color="#808080">(</font>sRotulo as string<font color="#808080">, </font>sNumero as string<font color="#808080">) </font>as string
dim nnum as double
dim nStatus as integer

nStatus <font color="#808080">= -</font><font color="#FF0000">1
</font>while <font color="#808080">(</font>nStatus<font color="#808080">&lt;&gt;</font><font color="#FF0000">0</font><font color="#808080">) 
  </font><font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font><font color="#000080"><b>Write</b></font><font color="#808080">(</font>sRotulo<font color="#808080">)
  </font>sNumero <font color="#808080">= </font><font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font><font color="#000080"><b>In</b></font><font color="#808080">.</font>ReadLine<font color="#808080">()
  </font>try
    nnum <font color="#808080">= </font><font color="#000080"><b>CDbl</b></font><font color="#808080">(</font>sNumero<font color="#808080">)
    </font>if nnum <font color="#808080">&lt; </font><font color="#FF0000">1 </font>then
      <font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font>MSG_NUMINV<font color="#808080">)
    </font>else
      nStatus<font color="#808080">=</font><font color="#FF0000">0
    </font>end if
  <font color="#000080"><b>Catch </b></font>e <font color="#000080"><b>As Exception
    </b></font><font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font>MSG_NUMINV<font color="#808080">)
  </font>end try
end while
validaNumero <font color="#808080">= </font>sNumero
end function
<font color="#808080"><i>'------------------------------------------------------------------------------
'Valida&ccedil;&atilde;o de uma data ou data/hora qualquer.
'sRotulo - o texto antes de se digitar a data/hora
'sDataHora - a String com o valor da data/hora
'bSoData - indica se vai validar somente uma data sem a hora
'retorna - a sDataHora
'------------------------------------------------------------------------------
</i></font>function validaDataHora<font color="#808080">(</font>sRotulo as string<font color="#808080">, </font>sDataHora as string<font color="#808080">, </font>_
			bSoData as <font color="#000080"><b>Boolean</b></font><font color="#808080">) </font>as string
dim bvalida<font color="#808080">, </font>bdatavalida<font color="#808080">, </font>bhoravalida as boolean
dim sdia<font color="#808080">, </font>smes<font color="#808080">, </font>sano<font color="#808080">, </font>shora<font color="#808080">, </font>smin<font color="#808080">, </font>sseg as string
dim ndia<font color="#808080">, </font>nmes<font color="#808080">, </font>nano<font color="#808080">, </font>nhora<font color="#808080">, </font>nmin<font color="#808080">, </font>nseg<font color="#808080">, </font>nudiames<font color="#808080">, </font>ntam as integer

bvalida <font color="#808080">= </font><font color="#000080"><b>false
</b></font>bdatavalida <font color="#808080">= </font><font color="#000080"><b>false
</b></font>bhoravalida <font color="#808080">= </font><font color="#000080"><b>false
</b></font>nudiames <font color="#808080">= </font><font color="#FF0000">0
</font>if bSoData<font color="#808080">=</font><font color="#000080"><b>true </b></font>then 
  ntam<font color="#808080">=</font><font color="#FF0000">10
</font>else 
  ntam<font color="#808080">=</font><font color="#FF0000">19
</font>end if
while bvalida<font color="#808080">=</font><font color="#000080"><b>false
  </b></font><font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font><font color="#000080"><b>Write</b></font><font color="#808080">(</font>sRotulo<font color="#808080">)
  </font>sDataHora <font color="#808080">= </font><font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font><font color="#000080"><b>In</b></font><font color="#808080">.</font>ReadLine<font color="#808080">()
  </font>if len<font color="#808080">(</font>sDataHora<font color="#808080">)=</font>ntam then
    sdia <font color="#808080">= </font>mid<font color="#808080">(</font>sDataHora<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#FF0000">2</font><font color="#808080">)
    </font>ndia <font color="#808080">= </font><font color="#000080"><b>CInt</b></font><font color="#808080">(</font>sdia<font color="#808080">)
    </font>smes <font color="#808080">= </font>mid<font color="#808080">(</font>sDataHora<font color="#808080">,</font><font color="#FF0000">4</font><font color="#808080">,</font><font color="#FF0000">2</font><font color="#808080">)
    </font>nmes <font color="#808080">= </font><font color="#000080"><b>CInt</b></font><font color="#808080">(</font>smes<font color="#808080">)
    </font>sano <font color="#808080">= </font>mid<font color="#808080">(</font>sDataHora<font color="#808080">,</font><font color="#FF0000">7</font><font color="#808080">,</font><font color="#FF0000">4</font><font color="#808080">)
    </font>nano <font color="#808080">= </font><font color="#000080"><b>CInt</b></font><font color="#808080">(</font>sano<font color="#808080">)
    
    </font>if <font color="#808080">(</font>nano <font color="#808080">&gt;= </font><font color="#FF0000">1</font><font color="#808080">) </font>and <font color="#808080">(</font>nano <font color="#808080">&lt;= </font><font color="#FF0000">9999</font><font color="#808080">) </font>then
      if <font color="#808080">(</font>nmes <font color="#808080">&gt;= </font><font color="#FF0000">1</font><font color="#808080">) </font>and <font color="#808080">(</font>nmes <font color="#808080">&lt;= </font><font color="#FF0000">31</font><font color="#808080">) </font>then
        select nmes
          case <font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">, </font><font color="#FF0000">5</font><font color="#808080">, </font><font color="#FF0000">7</font><font color="#808080">, </font><font color="#FF0000">8</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">, </font><font color="#FF0000">12
            </font>nudiames <font color="#808080">= </font><font color="#FF0000">31
          </font>case <font color="#FF0000">2
            </font><font color="#808080"><i>' ano bissexto 
            </i></font>if <font color="#808080">(</font>nano mod <font color="#FF0000">4</font><font color="#808080">)=</font><font color="#FF0000">0 </font>then 
              nudiames <font color="#808080">= </font><font color="#FF0000">29
            </font>else 
              nudiames <font color="#808080">= </font><font color="#FF0000">28
            </font>end if
          case <font color="#FF0000">4</font><font color="#808080">, </font><font color="#FF0000">6</font><font color="#808080">, </font><font color="#FF0000">9</font><font color="#808080">, </font><font color="#FF0000">11
            </font>nudiames <font color="#808080">= </font><font color="#FF0000">30
        </font>end select
        if <font color="#808080">(</font>ndia <font color="#808080">&gt;=</font><font color="#FF0000">1</font><font color="#808080">) </font>and <font color="#808080">(</font>ndia <font color="#808080">&lt;=</font>nudiames<font color="#808080">) </font>then
           bdatavalida <font color="#808080">= </font><font color="#000080"><b>true
        </b></font>end if
      end if
    end if

    if bSoData then
      if bdatavalida then
        bvalida <font color="#808080">= </font><font color="#000080"><b>true
      </b></font>else
        <font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font>MSG_DATAINV<font color="#808080">)
      </font>end if
    else 
      if bdatavalida then
        shora <font color="#808080">= </font>mid<font color="#808080">(</font>sDataHora<font color="#808080">,</font><font color="#FF0000">12</font><font color="#808080">,</font><font color="#FF0000">2</font><font color="#808080">)
        </font>nhora <font color="#808080">= </font><font color="#000080"><b>CInt</b></font><font color="#808080">(</font>shora<font color="#808080">)
        </font>smin <font color="#808080">= </font>mid<font color="#808080">(</font>sDataHora<font color="#808080">,</font><font color="#FF0000">15</font><font color="#808080">,</font><font color="#FF0000">2</font><font color="#808080">)
        </font>nmin <font color="#808080">= </font><font color="#000080"><b>CInt</b></font><font color="#808080">(</font>smin<font color="#808080">)
        </font>sseg <font color="#808080">= </font>mid<font color="#808080">(</font>sDataHora<font color="#808080">,</font><font color="#FF0000">18</font><font color="#808080">,</font><font color="#FF0000">2</font><font color="#808080">)
        </font>nseg <font color="#808080">= </font><font color="#000080"><b>CInt</b></font><font color="#808080">(</font>sseg<font color="#808080">)
      
        </font>if <font color="#808080">(</font>nhora <font color="#808080">&gt;= </font><font color="#FF0000">0</font><font color="#808080">) </font>and <font color="#808080">(</font>nhora <font color="#808080">&lt;= </font><font color="#FF0000">23</font><font color="#808080">) </font>then
          if <font color="#808080">(</font>nmin <font color="#808080">&gt;= </font><font color="#FF0000">0</font><font color="#808080">) </font>and <font color="#808080">(</font>nmin <font color="#808080">&lt;= </font><font color="#FF0000">59</font><font color="#808080">) </font>then
            if <font color="#808080">(</font>nseg <font color="#808080">&gt;= </font><font color="#FF0000">0</font><font color="#808080">) </font>and <font color="#808080">(</font>nseg <font color="#808080">&lt;= </font><font color="#FF0000">59</font><font color="#808080">) </font>then
              bhoravalida <font color="#808080">= </font><font color="#000080"><b>true
            </b></font>end if
          end if
        end if
      
        if bhoravalida then
          bvalida <font color="#808080">= </font><font color="#000080"><b>true
        </b></font>else
          <font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font>MSG_DTHRINV<font color="#808080">)
        </font>end if
      else
        <font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font>MSG_DTHRINV<font color="#808080">)
      </font>end if
    end if
  else
    if bSoData<font color="#808080">=</font><font color="#000080"><b>true </b></font>then 
      <font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font>MSG_DATAINV<font color="#808080">)
    </font>else 
      <font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font>MSG_DTHRINV<font color="#808080">)
    </font>end if
  end if
end while
validaDataHora <font color="#808080">= </font>sDataHora
end function
<font color="#808080"><i>'------------------------------------------------------------------------------
'Retorna a Data e a hora do sistema.
'retorna - a data e a hora
'------------------------------------------------------------------------------
</i></font>function retDataHora<font color="#808080">() </font>as string
  retDataHora <font color="#808080">= </font><font color="#000080"><b>DateTime</b></font><font color="#808080">.</font><font color="#000080"><b>Now</b></font><font color="#808080">.</font>ToString<font color="#808080">(</font><font color="#800000">&quot;dd/MM/yyyy hh:mm:ss&quot;</font><font color="#808080">)
</font>end function
<font color="#808080"><i>'------------------------------------------------------------------------------
'Calcula o tamanho do arquivo.
'sArq - o arquivo
'retorna - o tamanho do arquivo
'------------------------------------------------------------------------------
</i></font>function tamArq<font color="#808080">(</font>sArq as FileStream<font color="#808080">) </font>as long
  tamArq <font color="#808080">= </font>sArq<font color="#808080">.</font>Length
end function
<font color="#808080"><i>'------------------------------------------------------------------------------
'Verifica se chegou ao fim do arquivo.
'sArq - o arquivo
'ntam - o tamanho do arquivo
'retorna - se chegou ao fim do arquivo
'------------------------------------------------------------------------------
</i></font>function fimArq<font color="#808080">(</font>sArq as FileStream<font color="#808080">) </font>as <font color="#000080"><b>Boolean
 </b></font>if sArq<font color="#808080">.</font>Position <font color="#808080">= </font>sArq<font color="#808080">.</font>Length then
  fimArq <font color="#808080">= </font><font color="#000080"><b>true
 </b></font>else
  fimArq <font color="#808080">= </font><font color="#000080"><b>false
 </b></font>end if
end function
<font color="#808080"><i>'------------------------------------------------------------------------------
'L&ecirc; uma linha do arquivo.
'sArq - o arquivo
'nTamLinha - o tamanho da linha
'nTamCRLF - o tamanho do retorno da linha
'npos - posicao dentro do arquivo
'retorna - o texto lido
'------------------------------------------------------------------------------
</i></font>function lerArq<font color="#808080">(</font>sArq as FileStream<font color="#808080">, </font>nTamLinha as integer<font color="#808080">, </font>_
		nTamCRLF as integer<font color="#808080">) </font>as string
dim nLidos<font color="#808080">, </font>ncont as integer
<font color="#000080"><b>Dim </b></font>slinha<font color="#808080">(</font>TAM_MAX_REG<font color="#808080">) </font><font color="#000080"><b>As Byte
Dim </b></font>slinha2<font color="#808080">(</font>TAM_MAX_REG<font color="#808080">) </font><font color="#000080"><b>As Char
</b></font>dim sret as string <font color="#808080">= </font><font color="#800000">&quot;&quot;

</font><font color="#808080"><i>'dim sLer as StreamReader = new StreamReader(sArq)
'sret = sLer.ReadLine()

</i></font>nLidos <font color="#808080">= </font>sArq<font color="#808080">.</font>Read<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">,(</font>nTamLinha <font color="#808080">+ </font>nTamCRLF<font color="#808080">))

</font>if nLidos <font color="#808080">&lt;&gt; (</font>nTamLinha <font color="#808080">+ </font>nTamCRLF<font color="#808080">) </font>then
  sret <font color="#808080">= </font><font color="#800000">&quot;&quot;
</font>else 
  for ncont<font color="#808080">=</font><font color="#FF0000">0 </font>to <font color="#808080">(</font>nLidos <font color="#808080">- </font>nTamCRLF <font color="#808080">- </font><font color="#FF0000">1</font><font color="#808080">)
    </font>slinha2<font color="#808080">(</font>ncont<font color="#808080">)= </font>Convert<font color="#808080">.</font>ToChar<font color="#808080">(</font>slinha<font color="#808080">(</font>ncont<font color="#808080">))
  </font>next ncont
  sret <font color="#808080">= </font>new <font color="#000080"><b>String</b></font><font color="#808080">(</font>slinha2<font color="#808080">,</font><font color="#FF0000">0</font><font color="#808080">,(</font>nLidos <font color="#808080">- </font>nTamCRLF<font color="#808080">))
</font>end if

lerArq <font color="#808080">= </font>sret
end function
<font color="#808080"><i>'------------------------------------------------------------------------------
'Abre ou cria os arquivos do sistema.
'bAbre - condi&ccedil;&atilde;o para abrir ou criar os arquivos do sistema
'------------------------------------------------------------------------------
</i></font>sub abrecriaArqs<font color="#808080">(</font>bAbre as <font color="#000080"><b>Boolean</b></font><font color="#808080">)
</font>if bAbre then
  if <font color="#0000FF"><b>File</b></font><font color="#808080">.</font>Exists<font color="#808080">(</font>ARQ_ASSUNTO<font color="#808080">) </font>then
    tfAssunto <font color="#808080">= </font>new FileStream<font color="#808080">(</font>ARQ_ASSUNTO<font color="#808080">,</font>FileMode<font color="#808080">.</font><font color="#000080"><b>Open</b></font><font color="#808080">,</font>FileAccess<font color="#808080">.</font>ReadWrite<font color="#808080">)
  </font>else
    <font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font>MSG_ARQERRO<font color="#808080">+</font><font color="#800000">&quot; --&gt; &quot;</font><font color="#808080">+</font>ARQ_ASSUNTO<font color="#808080">)
  </font>end if
  if <font color="#0000FF"><b>File</b></font><font color="#808080">.</font>Exists<font color="#808080">(</font>ARQ_AUTOR<font color="#808080">) </font>then
    tfAutor <font color="#808080">= </font>new FileStream<font color="#808080">(</font>ARQ_AUTOR<font color="#808080">, </font>FileMode<font color="#808080">.</font><font color="#000080"><b>Open</b></font><font color="#808080">, </font>FileAccess<font color="#808080">.</font>ReadWrite<font color="#808080">)
  </font>else
    <font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font>MSG_ARQERRO<font color="#808080">+</font><font color="#800000">&quot; --&gt; &quot;</font><font color="#808080">+</font>ARQ_AUTOR<font color="#808080">)
  </font>end if
  if <font color="#0000FF"><b>File</b></font><font color="#808080">.</font>Exists<font color="#808080">(</font>ARQ_EDITORA<font color="#808080">) </font>then
    tfEditora <font color="#808080">= </font>new FileStream<font color="#808080">(</font>ARQ_EDITORA<font color="#808080">,</font>FileMode<font color="#808080">.</font><font color="#000080"><b>Open</b></font><font color="#808080">,</font>FileAccess<font color="#808080">.</font>ReadWrite<font color="#808080">)
  </font>else
    <font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font>MSG_ARQERRO<font color="#808080">+</font><font color="#800000">&quot; --&gt; &quot;</font><font color="#808080">+</font>ARQ_EDITORA<font color="#808080">)
  </font>end if
  if <font color="#0000FF"><b>File</b></font><font color="#808080">.</font>Exists<font color="#808080">(</font>ARQ_IDIOMA<font color="#808080">) </font>then
    tfIdioma <font color="#808080">= </font>new FileStream<font color="#808080">(</font>ARQ_IDIOMA<font color="#808080">, </font>FileMode<font color="#808080">.</font><font color="#000080"><b>Open</b></font><font color="#808080">, </font>FileAccess<font color="#808080">.</font>ReadWrite<font color="#808080">)
  </font>else
    <font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font>MSG_ARQERRO<font color="#808080">+</font><font color="#800000">&quot; --&gt; &quot;</font><font color="#808080">+</font>ARQ_IDIOMA<font color="#808080">)
  </font>end if
  if <font color="#0000FF"><b>File</b></font><font color="#808080">.</font>Exists<font color="#808080">(</font>ARQ_ENDERECO<font color="#808080">) </font>then
    tfEndereco<font color="#808080">= </font>new FileStream<font color="#808080">(</font>ARQ_ENDERECO<font color="#808080">,</font>FileMode<font color="#808080">.</font><font color="#000080"><b>Open</b></font><font color="#808080">,</font>FileAccess<font color="#808080">.</font>ReadWrite<font color="#808080">)
  </font>else
    <font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font>MSG_ARQERRO<font color="#808080">+</font><font color="#800000">&quot; --&gt; &quot;</font><font color="#808080">+</font>ARQ_ENDERECO<font color="#808080">)
  </font>end if
  if <font color="#0000FF"><b>File</b></font><font color="#808080">.</font>Exists<font color="#808080">(</font>ARQ_PAIS<font color="#808080">) </font>then
    tfPais <font color="#808080">= </font>new FileStream<font color="#808080">(</font>ARQ_PAIS<font color="#808080">, </font>FileMode<font color="#808080">.</font><font color="#000080"><b>Open</b></font><font color="#808080">, </font>FileAccess<font color="#808080">.</font>ReadWrite<font color="#808080">)
  </font>else
    <font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font>MSG_ARQERRO<font color="#808080">+</font><font color="#800000">&quot; --&gt; &quot;</font><font color="#808080">+</font>ARQ_PAIS<font color="#808080">)
  </font>end if
  if <font color="#0000FF"><b>File</b></font><font color="#808080">.</font>Exists<font color="#808080">(</font>ARQ_PROFISSAO<font color="#808080">) </font>then
    tfProfissao<font color="#808080">=</font>new FileStream<font color="#808080">(</font>ARQ_PROFISSAO<font color="#808080">,</font>FileMode<font color="#808080">.</font><font color="#000080"><b>Open</b></font><font color="#808080">,</font>FileAccess<font color="#808080">.</font>ReadWrite<font color="#808080">)
  </font>else
    <font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font>MSG_ARQERRO<font color="#808080">+</font><font color="#800000">&quot; --&gt; &quot;</font><font color="#808080">+</font>ARQ_PROFISSAO<font color="#808080">)
  </font>end if
  if <font color="#0000FF"><b>File</b></font><font color="#808080">.</font>Exists<font color="#808080">(</font>ARQ_LIVRO<font color="#808080">) </font>then
    tfLivro <font color="#808080">= </font>new FileStream<font color="#808080">(</font>ARQ_LIVRO<font color="#808080">, </font>FileMode<font color="#808080">.</font><font color="#000080"><b>Open</b></font><font color="#808080">, </font>FileAccess<font color="#808080">.</font>ReadWrite<font color="#808080">)
  </font>else
    <font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font>MSG_ARQERRO<font color="#808080">+</font><font color="#800000">&quot; --&gt; &quot;</font><font color="#808080">+</font>ARQ_LIVRO<font color="#808080">)
  </font>end if
  if <font color="#0000FF"><b>File</b></font><font color="#808080">.</font>Exists<font color="#808080">(</font>ARQ_LIVASS<font color="#808080">) </font>then
    tfLivroAss <font color="#808080">= </font>new FileStream<font color="#808080">(</font>ARQ_LIVASS<font color="#808080">, </font>FileMode<font color="#808080">.</font><font color="#000080"><b>Open</b></font><font color="#808080">,</font>FileAccess<font color="#808080">.</font>ReadWrite<font color="#808080">)
  </font>else
    <font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font>MSG_ARQERRO<font color="#808080">+</font><font color="#800000">&quot; --&gt; &quot;</font><font color="#808080">+</font>ARQ_LIVASS<font color="#808080">)
  </font>end if
  if <font color="#0000FF"><b>File</b></font><font color="#808080">.</font>Exists<font color="#808080">(</font>ARQ_LIVAUT<font color="#808080">) </font>then
    tfLivroAut <font color="#808080">= </font>new FileStream<font color="#808080">(</font>ARQ_LIVAUT<font color="#808080">, </font>FileMode<font color="#808080">.</font><font color="#000080"><b>Open</b></font><font color="#808080">,</font>FileAccess<font color="#808080">.</font>ReadWrite<font color="#808080">)
  </font>else
    <font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font>MSG_ARQERRO<font color="#808080">+</font><font color="#800000">&quot; --&gt; &quot;</font><font color="#808080">+</font>ARQ_LIVAUT<font color="#808080">)
  </font>end if
  if <font color="#0000FF"><b>File</b></font><font color="#808080">.</font>Exists<font color="#808080">(</font>ARQ_CLIENTE<font color="#808080">) </font>then
    tfCliente <font color="#808080">= </font>new FileStream<font color="#808080">(</font>ARQ_CLIENTE<font color="#808080">, </font>FileMode<font color="#808080">.</font><font color="#000080"><b>Open</b></font><font color="#808080">,</font>FileAccess<font color="#808080">.</font>ReadWrite<font color="#808080">)
  </font>else
    <font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font>MSG_ARQERRO<font color="#808080">+</font><font color="#800000">&quot; --&gt; &quot;</font><font color="#808080">+</font>ARQ_CLIENTE<font color="#808080">)
  </font>end if
  if <font color="#0000FF"><b>File</b></font><font color="#808080">.</font>Exists<font color="#808080">(</font>ARQ_USUARIO<font color="#808080">) </font>then
    tfUsuario <font color="#808080">= </font>new FileStream<font color="#808080">(</font>ARQ_USUARIO<font color="#808080">, </font>FileMode<font color="#808080">.</font><font color="#000080"><b>Open</b></font><font color="#808080">,</font>FileAccess<font color="#808080">.</font>ReadWrite<font color="#808080">)
  </font>else
    <font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font>MSG_ARQERRO<font color="#808080">+</font><font color="#800000">&quot; --&gt; &quot;</font><font color="#808080">+</font>ARQ_USUARIO<font color="#808080">)
  </font>end if
  if <font color="#0000FF"><b>File</b></font><font color="#808080">.</font>Exists<font color="#808080">(</font>ARQ_VENDA<font color="#808080">) </font>then
    tfVenda <font color="#808080">= </font>new FileStream<font color="#808080">(</font>ARQ_VENDA<font color="#808080">, </font>FileMode<font color="#808080">.</font><font color="#000080"><b>Open</b></font><font color="#808080">, </font>FileAccess<font color="#808080">.</font>ReadWrite<font color="#808080">)
  </font>else
    <font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font>MSG_ARQERRO<font color="#808080">+</font><font color="#800000">&quot; --&gt; &quot;</font><font color="#808080">+</font>ARQ_VENDA<font color="#808080">)
  </font>end if
else
  tfAssunto <font color="#808080">= </font>new FileStream<font color="#808080">(</font>ARQ_ASSUNTO<font color="#808080">,</font>FileMode<font color="#808080">.</font>Create<font color="#808080">,</font>FileAccess<font color="#808080">.</font>ReadWrite<font color="#808080">)
  </font>tfAutor <font color="#808080">= </font>new FileStream<font color="#808080">(</font>ARQ_AUTOR<font color="#808080">,</font>FileMode<font color="#808080">.</font>Create<font color="#808080">,</font>FileAccess<font color="#808080">.</font>ReadWrite<font color="#808080">)
  </font>tfEditora <font color="#808080">= </font>new FileStream<font color="#808080">(</font>ARQ_EDITORA<font color="#808080">,</font>FileMode<font color="#808080">.</font>Create<font color="#808080">,</font>FileAccess<font color="#808080">.</font>ReadWrite<font color="#808080">)
  </font>tfIdioma <font color="#808080">= </font>new FileStream<font color="#808080">(</font>ARQ_IDIOMA<font color="#808080">,</font>FileMode<font color="#808080">.</font>Create<font color="#808080">,</font>FileAccess<font color="#808080">.</font>ReadWrite<font color="#808080">)
  </font>tfEndereco<font color="#808080">= </font>new FileStream<font color="#808080">(</font>ARQ_ENDERECO<font color="#808080">,</font>FileMode<font color="#808080">.</font>Create<font color="#808080">,</font>FileAccess<font color="#808080">.</font>ReadWrite<font color="#808080">)
  </font>tfPais <font color="#808080">= </font>new FileStream<font color="#808080">(</font>ARQ_PAIS<font color="#808080">,</font>FileMode<font color="#808080">.</font>Create<font color="#808080">,</font>FileAccess<font color="#808080">.</font>ReadWrite<font color="#808080">)
  </font>tfProfissao<font color="#808080">=</font>new FileStream<font color="#808080">(</font>ARQ_PROFISSAO<font color="#808080">,</font>FileMode<font color="#808080">.</font>Create<font color="#808080">,</font>FileAccess<font color="#808080">.</font>ReadWrite<font color="#808080">)
  </font>tfLivro <font color="#808080">= </font>new FileStream<font color="#808080">(</font>ARQ_LIVRO<font color="#808080">,</font>FileMode<font color="#808080">.</font>Create<font color="#808080">,</font>FileAccess<font color="#808080">.</font>ReadWrite<font color="#808080">)
  </font>tfLivroAss <font color="#808080">= </font>new FileStream<font color="#808080">(</font>ARQ_LIVASS<font color="#808080">,</font>FileMode<font color="#808080">.</font>Create<font color="#808080">,</font>FileAccess<font color="#808080">.</font>ReadWrite<font color="#808080">)
  </font>tfLivroAut <font color="#808080">= </font>new FileStream<font color="#808080">(</font>ARQ_LIVAUT<font color="#808080">,</font>FileMode<font color="#808080">.</font>Create<font color="#808080">,</font>FileAccess<font color="#808080">.</font>ReadWrite<font color="#808080">)
  </font>tfCliente <font color="#808080">= </font>new FileStream<font color="#808080">(</font>ARQ_CLIENTE<font color="#808080">,</font>FileMode<font color="#808080">.</font>Create<font color="#808080">,</font>FileAccess<font color="#808080">.</font>ReadWrite<font color="#808080">)
  </font>tfUsuario <font color="#808080">= </font>new FileStream<font color="#808080">(</font>ARQ_USUARIO<font color="#808080">,</font>FileMode<font color="#808080">.</font>Create<font color="#808080">,</font>FileAccess<font color="#808080">.</font>ReadWrite<font color="#808080">)
  </font>tfVenda <font color="#808080">= </font>new FileStream<font color="#808080">(</font>ARQ_VENDA<font color="#808080">,</font>FileMode<font color="#808080">.</font>Create<font color="#808080">,</font>FileAccess<font color="#808080">.</font>ReadWrite<font color="#808080">)
</font>end if

end sub
<font color="#808080"><i>'------------------------------------------------------------------------------
'Fecha todos os arquivos abertos.
'------------------------------------------------------------------------------
</i></font>sub fechaArqs<font color="#808080">()
  </font>tfAssunto<font color="#808080">.</font><font color="#000080"><b>Close</b></font><font color="#808080">()
  </font>tfAutor<font color="#808080">.</font><font color="#000080"><b>Close</b></font><font color="#808080">()
  </font>tfEditora<font color="#808080">.</font><font color="#000080"><b>Close</b></font><font color="#808080">()
  </font>tfIdioma<font color="#808080">.</font><font color="#000080"><b>Close</b></font><font color="#808080">()
  </font>tfEndereco<font color="#808080">.</font><font color="#000080"><b>Close</b></font><font color="#808080">()
  </font>tfPais<font color="#808080">.</font><font color="#000080"><b>Close</b></font><font color="#808080">()
  </font>tfProfissao<font color="#808080">.</font><font color="#000080"><b>Close</b></font><font color="#808080">()
  </font>tfLivro<font color="#808080">.</font><font color="#000080"><b>Close</b></font><font color="#808080">()
  </font>tfLivroAss<font color="#808080">.</font><font color="#000080"><b>Close</b></font><font color="#808080">()
  </font>tfLivroAut<font color="#808080">.</font><font color="#000080"><b>Close</b></font><font color="#808080">()
  </font>tfCliente<font color="#808080">.</font><font color="#000080"><b>Close</b></font><font color="#808080">()
  </font>tfUsuario<font color="#808080">.</font><font color="#000080"><b>Close</b></font><font color="#808080">()
  </font>tfVenda<font color="#808080">.</font><font color="#000080"><b>Close</b></font><font color="#808080">()
</font>end sub
<font color="#808080"><i>'------------------------------------------------------------------------------
'Pesquisa um registro atrav&eacute;s de um valor chave num arquivo.
'sArq - o arquivo
'sChave - a chave a ser pesquisada
'nPosChave - a posicao inicial da chave dentro do registro
'nTamChave - o tamanho da chave dentro do registro
'nTamLinha - o tamanho do registro
'retorna - o registro pesquisado
'------------------------------------------------------------------------------
</i></font>function pesqArq<font color="#808080">(</font>sArq as FileStream<font color="#808080">, </font>sChave as string<font color="#808080">, </font>nPosChave as integer<font color="#808080">, </font>_
		nTamChave as integer<font color="#808080">, </font>nTamLinha as integer<font color="#808080">) </font>as string
  dim sres<font color="#808080">, </font>slinha as string
  dim bQuebra as <font color="#000080"><b>Boolean
  </b></font>dim nPosicao as long

  sres <font color="#808080">= </font><font color="#800000">&quot;&quot;
  </font>slinha <font color="#808080">= </font><font color="#800000">&quot;&quot;
  </font>bQuebra <font color="#808080">= </font><font color="#000080"><b>false
  </b></font>sArq<font color="#808080">.</font><font color="#000080"><b>Seek</b></font><font color="#808080">(</font><font color="#FF0000">0</font><font color="#808080">,</font>SeekOrigin<font color="#808080">.</font>Begin<font color="#808080">)
  </font>while <font color="#808080">(</font>not fimArq<font color="#808080">(</font>sArq<font color="#808080">)) </font>and bQuebra <font color="#808080">= </font><font color="#000080"><b>false
    </b></font>slinha <font color="#808080">= </font>lerArq<font color="#808080">(</font>sArq<font color="#808080">, </font>nTamLinha<font color="#808080">, </font>TAM_CRLF<font color="#808080">)
    </font>if slinha<font color="#808080">&lt;&gt;</font><font color="#800000">&quot;&quot; </font>then
  	sres <font color="#808080">= </font>trim<font color="#808080">(</font>mid<font color="#808080">(</font>slinha<font color="#808080">, </font>nPosChave<font color="#808080">, </font>nTamChave<font color="#808080">))
    </font>end if
    if sres<font color="#808080">=</font>sChave
      bQuebra <font color="#808080">= </font><font color="#000080"><b>true
    </b></font>end if
  end while
  nPosicao <font color="#808080">= </font>sArq<font color="#808080">.</font>Position <font color="#808080">- (</font>nTamLinha <font color="#808080">+ </font>TAM_CRLF<font color="#808080">)
  </font>if nPosicao <font color="#808080">&gt; </font><font color="#FF0000">0 </font>then
    sArq<font color="#808080">.</font><font color="#000080"><b>Seek</b></font><font color="#808080">(</font>nPosicao<font color="#808080">, </font>SeekOrigin<font color="#808080">.</font>Current<font color="#808080">)
  </font>else
    sArq<font color="#808080">.</font><font color="#000080"><b>Seek</b></font><font color="#808080">(</font><font color="#FF0000">0</font><font color="#808080">, </font>SeekOrigin<font color="#808080">.</font>Begin<font color="#808080">)
  </font>end if
  if sres<font color="#808080">&lt;&gt;</font>sChave then
    pesqArq <font color="#808080">= </font><font color="#800000">&quot;&quot;
  </font>else
    pesqArq <font color="#808080">= </font>mid<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font>nTamLinha<font color="#808080">)
  </font>end if
end function
<font color="#808080"><i>'------------------------------------------------------------------------------
'Pesquisa se tem linha exclu&iacute;da sen&atilde;o vai para a &uacute;ltima linha do arquivo.
'sArq - o arquivo
'nTamLinha - o tamanho do registro
'------------------------------------------------------------------------------
</i></font>sub pesqLinhaExcluida<font color="#808080">(</font>sArq as FileStream<font color="#808080">, </font>nTamLinha as integer<font color="#808080">)
</font>dim sExcluido as string

  sExcluido <font color="#808080">= </font>pesqArq<font color="#808080">(</font>sArq<font color="#808080">, </font><font color="#800000">&quot;*&quot;</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font>nTamLinha<font color="#808080">)
  </font>if sExcluido<font color="#808080">=</font><font color="#800000">&quot;&quot; </font>then
    sArq<font color="#808080">.</font><font color="#000080"><b>Seek</b></font><font color="#808080">(</font>tamArq<font color="#808080">(</font>sArq<font color="#808080">),</font>SeekOrigin<font color="#808080">.</font>Begin<font color="#808080">)
  </font>end if
end sub
<font color="#808080"><i>'------------------------------------------------------------------------------
'Pesquisa o maior c&oacute;digo num arquivo.
'sArq - o arquivo
'nPosChave - a posicao inicial da chave dentro do registro
'nTamChave - o tamanho da chave dentro do registro
'nTamLinha - o tamanho do registro
'retorna - o maior c&oacute;digo
'------------------------------------------------------------------------------
</i></font>function pesqMaxCod<font color="#808080">(</font>sArq as FileStream<font color="#808080">, </font>nPosChave as integer<font color="#808080">, </font>_
		nTamChave as integer<font color="#808080">, </font>nTamLinha as integer<font color="#808080">) </font>as string
  dim sres<font color="#808080">, </font>slinha as string
  dim bQuebra as <font color="#000080"><b>Boolean
  </b></font>dim nMaior<font color="#808080">, </font>nCod as integer

  sres <font color="#808080">= </font><font color="#800000">&quot;&quot;
  </font>slinha <font color="#808080">= </font><font color="#800000">&quot;&quot;
  </font>bQuebra <font color="#808080">= </font><font color="#000080"><b>false
  </b></font>nMaior <font color="#808080">= </font><font color="#FF0000">0
  </font>sArq<font color="#808080">.</font><font color="#000080"><b>Seek</b></font><font color="#808080">(</font><font color="#FF0000">0</font><font color="#808080">,</font>SeekOrigin<font color="#808080">.</font>Begin<font color="#808080">)
  </font>while <font color="#808080">(</font>not fimArq<font color="#808080">(</font>sArq<font color="#808080">)) </font>and bQuebra <font color="#808080">= </font><font color="#000080"><b>false
    </b></font>slinha <font color="#808080">= </font>lerArq<font color="#808080">(</font>sArq<font color="#808080">, </font>nTamLinha<font color="#808080">, </font>TAM_CRLF<font color="#808080">)
    </font>if slinha<font color="#808080">&lt;&gt;</font><font color="#800000">&quot;&quot; </font>then
      sres <font color="#808080">= </font>trim<font color="#808080">(</font>mid<font color="#808080">(</font>slinha<font color="#808080">,</font>nPosChave<font color="#808080">,</font>nTamChave<font color="#808080">))
      </font>nCod <font color="#808080">= </font><font color="#000080"><b>CInt</b></font><font color="#808080">(</font>sres<font color="#808080">)
      </font>if nCod <font color="#808080">&gt; </font>nMaior then
         nMaior <font color="#808080">= </font>nCod
      end if
    end if
  end while
  pesqLinhaExcluida<font color="#808080">(</font>sArq<font color="#808080">, </font>nTamLinha<font color="#808080">)
  </font>nCod <font color="#808080">= (</font>nMaior<font color="#808080">+</font><font color="#FF0000">1</font><font color="#808080">)
  </font>sres <font color="#808080">= </font><font color="#000080"><b>CStr</b></font><font color="#808080">(</font>nCod<font color="#808080">)

</font>pesqMaxCod <font color="#808080">= </font>sres
end function
<font color="#808080"><i>'------------------------------------------------------------------------------
'Grava os registros num determinado arquivo.
'sArq - o arquivo
'sTexto - o registro a ser gravado
'sMsgAcerto - a mensagem caso o registro foi gravado
'sMsgErro - a mensagem caso o registro n&atilde;o foi gravado
'------------------------------------------------------------------------------
</i></font>sub escreveArq<font color="#808080">(</font>sArq as FileStream<font color="#808080">, </font>sTexto as string<font color="#808080">, </font>sMsgAcerto as string<font color="#808080">, </font>_
	sMsgErro as string<font color="#808080">)
  </font><font color="#000080"><b>Dim </b></font>slinha<font color="#808080">(</font>TAM_MAX_REG<font color="#808080">) </font><font color="#000080"><b>As Byte
  </b></font>dim ntam<font color="#808080">, </font>ncont as integer
  try 
    <font color="#808080"><i>'dim sGravar as StreamWriter = new StreamWriter(sArq)
    </i></font>sTexto <font color="#808080">= </font>sTexto <font color="#808080">+ </font>CRLF
    ntam <font color="#808080">= </font><font color="#000080"><b>Len</b></font><font color="#808080">(</font>sTexto<font color="#808080">)
    </font>for ncont<font color="#808080">=</font><font color="#FF0000">0 </font>to ntam<font color="#808080">-</font><font color="#FF0000">1
</font>    	slinha<font color="#808080">(</font>ncont<font color="#808080">) = </font>Convert<font color="#808080">.</font>ToByte<font color="#808080">(</font>GetChar<font color="#808080">(</font>sTexto<font color="#808080">,</font>ncont<font color="#808080">+</font><font color="#FF0000">1</font><font color="#808080">))
    </font>next ncont
    sArq<font color="#808080">.</font><font color="#000080"><b>Write</b></font><font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font>ntam<font color="#808080">)
    <i>'sGravar.WriteLine(sTexto)
    </i></font><font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font>sMsgAcerto<font color="#808080">)
  </font>catch e <font color="#000080"><b>As Exception
</b></font>	<font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font>sMsgErro<font color="#808080">)
  </font>end try
end sub
<font color="#808080"><i>'------------------------------------------------------------------------------
'Monta o tamanho do registro no arquivo de acordo com o tipo de arquivo.
'sreg - o tipo de arquivo
'retorna - o registro montado
'------------------------------------------------------------------------------
</i></font>function LinhaReg<font color="#808080">(</font>sreg as ctArqs<font color="#808080">) </font>as string
dim slinha as string <font color="#808080">= </font><font color="#800000">&quot;&quot;

</font>if sreg<font color="#808080">=</font>ctArqs<font color="#808080">.</font>opAssunto then
   slinha <font color="#808080">= </font>esp<font color="#808080">(</font>tAssunto<font color="#808080">.</font>codigo<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">)+</font>esp<font color="#808080">(</font>tAssunto<font color="#808080">.</font>assunto<font color="#808080">,</font><font color="#FF0000">30</font><font color="#808080">)
</font>elseif sreg<font color="#808080">=</font>ctArqs<font color="#808080">.</font>opAutor then
   slinha <font color="#808080">= </font>esp<font color="#808080">(</font>tAutor<font color="#808080">.</font>codigo<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">)+</font>esp<font color="#808080">(</font>tAutor<font color="#808080">.</font>autor<font color="#808080">,</font><font color="#FF0000">30</font><font color="#808080">)
</font>elseif sreg<font color="#808080">=</font>ctArqs<font color="#808080">.</font>opEditora then
   slinha <font color="#808080">= </font>esp<font color="#808080">(</font>tEditora<font color="#808080">.</font>codigo<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">)+</font>esp<font color="#808080">(</font>tEditora<font color="#808080">.</font>editora<font color="#808080">,</font><font color="#FF0000">50</font><font color="#808080">)
</font>elseif sreg<font color="#808080">=</font>ctArqs<font color="#808080">.</font>opEndereco then
   slinha <font color="#808080">= </font>esp<font color="#808080">(</font>tEndereco<font color="#808080">.</font>codigo<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">)+</font>esp<font color="#808080">(</font>tEndereco<font color="#808080">.</font>logradouro<font color="#808080">,</font><font color="#FF0000">40</font><font color="#808080">)+ </font>_
   esp<font color="#808080">(</font>tEndereco<font color="#808080">.</font>bairro<font color="#808080">,</font><font color="#FF0000">15</font><font color="#808080">)+</font>esp<font color="#808080">(</font>tEndereco<font color="#808080">.</font>cep<font color="#808080">,</font><font color="#FF0000">8</font><font color="#808080">)+</font>esp<font color="#808080">(</font>tEndereco<font color="#808080">.</font>cidade<font color="#808080">,</font><font color="#FF0000">30</font><font color="#808080">)+ </font>_
   esp<font color="#808080">(</font>tEndereco<font color="#808080">.</font>estado<font color="#808080">,</font><font color="#FF0000">20</font><font color="#808080">)
</font>elseif sreg<font color="#808080">=</font>ctArqs<font color="#808080">.</font>opIdioma then
   slinha <font color="#808080">= </font>esp<font color="#808080">(</font>tIdioma<font color="#808080">.</font>codigo<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">)+</font>esp<font color="#808080">(</font>tIdioma<font color="#808080">.</font>idioma<font color="#808080">,</font><font color="#FF0000">20</font><font color="#808080">)
</font>elseif sreg<font color="#808080">=</font>ctArqs<font color="#808080">.</font>opPais then 
   slinha <font color="#808080">= </font>esp<font color="#808080">(</font>tPais<font color="#808080">.</font>codigo<font color="#808080">,</font><font color="#FF0000">3</font><font color="#808080">)+</font>esp<font color="#808080">(</font>tPais<font color="#808080">.</font>pais<font color="#808080">,</font><font color="#FF0000">50</font><font color="#808080">)
</font>elseif sreg<font color="#808080">=</font>ctArqs<font color="#808080">.</font>opProfissao then 
   slinha <font color="#808080">= </font>esp<font color="#808080">(</font>tProfissao<font color="#808080">.</font>codigo<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">)+</font>esp<font color="#808080">(</font>tProfissao<font color="#808080">.</font>profissao<font color="#808080">,</font><font color="#FF0000">50</font><font color="#808080">)
</font>elseif sreg<font color="#808080">=</font>ctArqs<font color="#808080">.</font>opUsuario then 
   slinha <font color="#808080">= </font>esp<font color="#808080">(</font>tUsuario<font color="#808080">.</font>login<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">)+</font>esp<font color="#808080">(</font>tUsuario<font color="#808080">.</font>senha<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">)
</font>elseif sreg<font color="#808080">=</font>ctArqs<font color="#808080">.</font>opLivro then 
   slinha <font color="#808080">= </font>esp<font color="#808080">(</font>tLivro<font color="#808080">.</font>isbn<font color="#808080">,</font><font color="#FF0000">13</font><font color="#808080">)+</font>esp<font color="#808080">(</font>tLivro<font color="#808080">.</font>titulo<font color="#808080">,</font><font color="#FF0000">50</font><font color="#808080">)+ </font>_
   esp<font color="#808080">(</font>tLivro<font color="#808080">.</font>edicao<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">)+</font>esp<font color="#808080">(</font>tLivro<font color="#808080">.</font>anopubli<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">)+</font>esp<font color="#808080">(</font>tLivro<font color="#808080">.</font>codeditora<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">)+ </font>_
   esp<font color="#808080">(</font>tLivro<font color="#808080">.</font>volume<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">)+</font>esp<font color="#808080">(</font>tLivro<font color="#808080">.</font>codidioma<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">)+</font>esp<font color="#808080">(</font>tLivro<font color="#808080">.</font>npaginas<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">)+ </font>_
   esp<font color="#808080">(</font>tLivro<font color="#808080">.</font>preco<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">)+</font>esp<font color="#808080">(</font>tLivro<font color="#808080">.</font>qtdestoque<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">)
</font>elseif sreg<font color="#808080">=</font>ctArqs<font color="#808080">.</font>opLivroAss then 
   slinha <font color="#808080">= </font>esp<font color="#808080">(</font>tLivroAss<font color="#808080">.</font>isbn<font color="#808080">,</font><font color="#FF0000">13</font><font color="#808080">)+</font>esp<font color="#808080">(</font>tLivroAss<font color="#808080">.</font>codassunto<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">)
</font>elseif sreg<font color="#808080">=</font>ctArqs<font color="#808080">.</font>opLivroAut then 
   slinha <font color="#808080">= </font>esp<font color="#808080">(</font>tLivroAut<font color="#808080">.</font>isbn<font color="#808080">,</font><font color="#FF0000">13</font><font color="#808080">)+</font>esp<font color="#808080">(</font>tLivroAut<font color="#808080">.</font>codautor<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">)
</font>elseif sreg<font color="#808080">=</font>ctArqs<font color="#808080">.</font>opCliente then 
   slinha <font color="#808080">= </font>esp<font color="#808080">(</font>tCliente<font color="#808080">.</font>cpf<font color="#808080">,</font><font color="#FF0000">14</font><font color="#808080">)+</font>esp<font color="#808080">(</font>tCliente<font color="#808080">.</font>nome<font color="#808080">,</font><font color="#FF0000">30</font><font color="#808080">)+ </font>_
   esp<font color="#808080">(</font>tCliente<font color="#808080">.</font>email<font color="#808080">,</font><font color="#FF0000">30</font><font color="#808080">)+</font>esp<font color="#808080">(</font>tCliente<font color="#808080">.</font>identidade<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">)+</font>esp<font color="#808080">(</font>tCliente<font color="#808080">.</font>sexo<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">)+ </font>_
   esp<font color="#808080">(</font>tCliente<font color="#808080">.</font>telefone<font color="#808080">,</font><font color="#FF0000">17</font><font color="#808080">)+</font>esp<font color="#808080">(</font>tCliente<font color="#808080">.</font>dtnascimento<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">)+ </font>_
   esp<font color="#808080">(</font>tCliente<font color="#808080">.</font>codendereco<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">)+</font>esp<font color="#808080">(</font>tCliente<font color="#808080">.</font>codpais<font color="#808080">,</font><font color="#FF0000">3</font><font color="#808080">)+ </font>_
   esp<font color="#808080">(</font>tCliente<font color="#808080">.</font>codprofissao<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">)
</font>elseif sreg<font color="#808080">=</font>ctArqs<font color="#808080">.</font>opVenda then 
   slinha <font color="#808080">= </font>esp<font color="#808080">(</font>tVenda<font color="#808080">.</font>dthrvenda<font color="#808080">,</font><font color="#FF0000">19</font><font color="#808080">)+</font>esp<font color="#808080">(</font>tVenda<font color="#808080">.</font>cpf<font color="#808080">,</font><font color="#FF0000">14</font><font color="#808080">)+ </font>_
   esp<font color="#808080">(</font>tVenda<font color="#808080">.</font>isbn<font color="#808080">,</font><font color="#FF0000">13</font><font color="#808080">)+</font>esp<font color="#808080">(</font>tVenda<font color="#808080">.</font>precovenda<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">)
</font>end if
LinhaReg <font color="#808080">= </font>slinha
end function
<font color="#808080"><i>'------------------------------------------------------------------------------
'Retorna o tamanho do registro no arquivo de acordo com o tipo de arquivo.
'sreg - o tipo de arquivo
'retorna - o tamanho do registro
'------------------------------------------------------------------------------
</i></font>function tamReg<font color="#808080">(</font>sreg as ctArqs<font color="#808080">) </font>as integer
dim nret as integer <font color="#808080">= </font><font color="#FF0000">0

</font>if sreg<font color="#808080">=</font>ctArqs<font color="#808080">.</font>opAssunto then 
  nret <font color="#808080">= </font>TAM_ASSUNTO
elseif sreg<font color="#808080">=</font>ctArqs<font color="#808080">.</font>opAutor then 
  nret <font color="#808080">= </font>TAM_AUTOR
elseif sreg<font color="#808080">=</font>ctArqs<font color="#808080">.</font>opEditora then  
  nret <font color="#808080">= </font>TAM_EDITORA
elseif sreg<font color="#808080">=</font>ctArqs<font color="#808080">.</font>opEndereco then 
  nret <font color="#808080">= </font>TAM_ENDERECO
elseif sreg<font color="#808080">=</font>ctArqs<font color="#808080">.</font>opIdioma then 
  nret <font color="#808080">= </font>TAM_IDIOMA
elseif sreg<font color="#808080">=</font>ctArqs<font color="#808080">.</font>opPais then  
  nret <font color="#808080">= </font>TAM_PAIS
elseif sreg<font color="#808080">=</font>ctArqs<font color="#808080">.</font>opProfissao then 
  nret <font color="#808080">= </font>TAM_PROFISSAO
elseif sreg<font color="#808080">=</font>ctArqs<font color="#808080">.</font>opUsuario then 
  nret <font color="#808080">= </font>TAM_USUARIO
elseif sreg<font color="#808080">=</font>ctArqs<font color="#808080">.</font>opLivro then 
  nret <font color="#808080">= </font>TAM_LIVRO
elseif sreg<font color="#808080">=</font>ctArqs<font color="#808080">.</font>opLivroAss then 
  nret <font color="#808080">= </font>TAM_LIVASS
elseif sreg<font color="#808080">=</font>ctArqs<font color="#808080">.</font>opLivroAut then 
  nret <font color="#808080">= </font>TAM_LIVAUT
elseif sreg<font color="#808080">=</font>ctArqs<font color="#808080">.</font>opCliente then 
  nret <font color="#808080">= </font>TAM_CLIENTE
elseif sreg<font color="#808080">=</font>ctArqs<font color="#808080">.</font>opVenda then 
  nret <font color="#808080">= </font>TAM_VENDA
end if
tamReg <font color="#808080">= </font>nret
end function
<font color="#808080"><i>'------------------------------------------------------------------------------
'Seleciona o rotulo de cada campo de acordo com o tipo de arquivo.
'sreg - o tipo de arquivo
'nNum - indica qual rotulo ser&aacute; retornado
'retorna - o rotulo
'------------------------------------------------------------------------------
</i></font>function rotulo<font color="#808080">(</font>sreg as ctArqs<font color="#808080">, </font>nNum as integer<font color="#808080">) </font>as string
dim sret as string <font color="#808080">= </font><font color="#800000">&quot;&quot;

</font>if sreg<font color="#808080">=</font>ctArqs<font color="#808080">.</font>opAssunto then
  select case nNum
    case <font color="#FF0000">0
      </font>sret <font color="#808080">= </font><font color="#800000">&quot;Assunto(s) n&atilde;o encontrado(s)!&quot;
    </font>case <font color="#FF0000">1
      </font>sret <font color="#808080">= </font><font color="#800000">&quot;C&oacute;digo do assunto: &quot;
      </font>g_nPosChave <font color="#808080">= </font><font color="#FF0000">1
      </font>g_nTamChave <font color="#808080">= </font><font color="#FF0000">10
    </font>case <font color="#FF0000">2
      </font>sret <font color="#808080">= </font><font color="#800000">&quot;Assunto: &quot;
      </font>g_nPosChave <font color="#808080">= </font><font color="#FF0000">11
      </font>g_nTamChave <font color="#808080">= </font><font color="#FF0000">30
  </font>end select   
elseif sreg<font color="#808080">=</font>ctArqs<font color="#808080">.</font>opAutor then
  select case nNum
    case <font color="#FF0000">0
      </font>sret <font color="#808080">= </font><font color="#800000">&quot;Autor(es) n&atilde;o encontrado(s)!&quot;
    </font>case <font color="#FF0000">1
      </font>sret <font color="#808080">= </font><font color="#800000">&quot;C&oacute;digo do autor: &quot;
      </font>g_nPosChave <font color="#808080">= </font><font color="#FF0000">1
      </font>g_nTamChave <font color="#808080">= </font><font color="#FF0000">10
    </font>case <font color="#FF0000">2
      </font>sret <font color="#808080">= </font><font color="#800000">&quot;Autor: &quot;
      </font>g_nPosChave <font color="#808080">= </font><font color="#FF0000">11
      </font>g_nTamChave <font color="#808080">= </font><font color="#FF0000">30
  </font>end select   
elseif sreg<font color="#808080">=</font>ctArqs<font color="#808080">.</font>opEditora then
  select case nNum
    case <font color="#FF0000">0
      </font>sret <font color="#808080">= </font><font color="#800000">&quot;Editora(s) n&atilde;o encontrada(s)!&quot;
    </font>case <font color="#FF0000">1
      </font>sret <font color="#808080">= </font><font color="#800000">&quot;C&oacute;digo da editora: &quot;
      </font>g_nPosChave <font color="#808080">= </font><font color="#FF0000">1
      </font>g_nTamChave <font color="#808080">= </font><font color="#FF0000">10
    </font>case <font color="#FF0000">2
      </font>sret <font color="#808080">= </font><font color="#800000">&quot;Editora: &quot;
      </font>g_nPosChave <font color="#808080">= </font><font color="#FF0000">11
      </font>g_nTamChave <font color="#808080">= </font><font color="#FF0000">50
  </font>end select   
elseif sreg<font color="#808080">=</font>ctArqs<font color="#808080">.</font>opEndereco then
  select case nNum
    case <font color="#FF0000">0
      </font>sret <font color="#808080">= </font><font color="#800000">&quot;Endere&ccedil;o(s) n&atilde;o encontrado(s)!&quot;
    </font>case <font color="#FF0000">1
      </font>sret <font color="#808080">= </font><font color="#800000">&quot;C&oacute;digo do endere&ccedil;o: &quot;
      </font>g_nPosChave <font color="#808080">= </font><font color="#FF0000">1
      </font>g_nTamChave <font color="#808080">= </font><font color="#FF0000">10
    </font>case <font color="#FF0000">2
      </font>sret <font color="#808080">= </font><font color="#800000">&quot;Logradouro: &quot;
      </font>g_nPosChave <font color="#808080">= </font><font color="#FF0000">11
      </font>g_nTamChave <font color="#808080">= </font><font color="#FF0000">40
    </font>case <font color="#FF0000">3
      </font>sret <font color="#808080">= </font><font color="#800000">&quot;Bairro: &quot;
      </font>g_nPosChave <font color="#808080">= </font><font color="#FF0000">51
      </font>g_nTamChave <font color="#808080">= </font><font color="#FF0000">15
    </font>case <font color="#FF0000">4
      </font>sret <font color="#808080">= </font><font color="#800000">&quot;CEP: &quot;
      </font>g_nPosChave <font color="#808080">= </font><font color="#FF0000">66
      </font>g_nTamChave <font color="#808080">= </font><font color="#FF0000">8
    </font>case <font color="#FF0000">5
      </font>sret <font color="#808080">= </font><font color="#800000">&quot;Cidade: &quot;
      </font>g_nPosChave <font color="#808080">= </font><font color="#FF0000">74
      </font>g_nTamChave <font color="#808080">= </font><font color="#FF0000">30
    </font>case <font color="#FF0000">6
      </font>sret <font color="#808080">= </font><font color="#800000">&quot;Estado: &quot;
      </font>g_nPosChave <font color="#808080">= </font><font color="#FF0000">104
      </font>g_nTamChave <font color="#808080">= </font><font color="#FF0000">20
  </font>end select   
elseif sreg<font color="#808080">=</font>ctArqs<font color="#808080">.</font>opIdioma then
  select case nNum
    case <font color="#FF0000">0
      </font>sret <font color="#808080">= </font><font color="#800000">&quot;Idioma(s) n&atilde;o encontrado(s)!&quot;
    </font>case <font color="#FF0000">1
      </font>sret <font color="#808080">= </font><font color="#800000">&quot;C&oacute;digo do idioma: &quot;
      </font>g_nPosChave <font color="#808080">= </font><font color="#FF0000">1
      </font>g_nTamChave <font color="#808080">= </font><font color="#FF0000">10
    </font>case <font color="#FF0000">2
      </font>sret <font color="#808080">= </font><font color="#800000">&quot;Idioma: &quot;
      </font>g_nPosChave <font color="#808080">= </font><font color="#FF0000">11
      </font>g_nTamChave <font color="#808080">= </font><font color="#FF0000">20
  </font>end select   
elseif sreg<font color="#808080">=</font>ctArqs<font color="#808080">.</font>opPais then
  select case nNum
    case <font color="#FF0000">0
      </font>sret <font color="#808080">= </font><font color="#800000">&quot;Pa&iacute;s(es) n&atilde;o encontrado(s)!&quot;
    </font>case <font color="#FF0000">1
      </font>sret <font color="#808080">= </font><font color="#800000">&quot;C&oacute;digo do pa&iacute;s: &quot;
      </font>g_nPosChave <font color="#808080">= </font><font color="#FF0000">1
      </font>g_nTamChave <font color="#808080">= </font><font color="#FF0000">3
    </font>case <font color="#FF0000">2
      </font>sret <font color="#808080">= </font><font color="#800000">&quot;Pa&iacute;s: &quot;
      </font>g_nPosChave <font color="#808080">= </font><font color="#FF0000">4
      </font>g_nTamChave <font color="#808080">= </font><font color="#FF0000">50
  </font>end select   
elseif sreg<font color="#808080">=</font>ctArqs<font color="#808080">.</font>opProfissao then
  select case nNum
    case <font color="#FF0000">0
      </font>sret <font color="#808080">= </font><font color="#800000">&quot;Profiss&atilde;o(es) n&atilde;o encontrada(s)!&quot;
    </font>case <font color="#FF0000">1
      </font>sret <font color="#808080">= </font><font color="#800000">&quot;C&oacute;digo da profiss&atilde;o: &quot;
      </font>g_nPosChave <font color="#808080">= </font><font color="#FF0000">1
      </font>g_nTamChave <font color="#808080">= </font><font color="#FF0000">10
    </font>case <font color="#FF0000">2
      </font>sret <font color="#808080">= </font><font color="#800000">&quot;Profiss&atilde;o: &quot;
      </font>g_nPosChave <font color="#808080">= </font><font color="#FF0000">11
      </font>g_nTamChave <font color="#808080">= </font><font color="#FF0000">50
  </font>end select   
elseif sreg<font color="#808080">=</font>ctArqs<font color="#808080">.</font>opUsuario then
  select case nNum
    case <font color="#FF0000">0
      </font>sret <font color="#808080">= </font><font color="#800000">&quot;login ou senha incorreta, tente de novo!&quot;
    </font>case <font color="#FF0000">1
      </font>sret <font color="#808080">= </font><font color="#800000">&quot;Login: &quot;
      </font>g_nPosChave <font color="#808080">= </font><font color="#FF0000">1
      </font>g_nTamChave <font color="#808080">= </font><font color="#FF0000">10
    </font>case <font color="#FF0000">2
      </font>sret <font color="#808080">= </font><font color="#800000">&quot;Senha: &quot;
      </font>g_nPosChave <font color="#808080">= </font><font color="#FF0000">11
      </font>g_nTamChave <font color="#808080">= </font><font color="#FF0000">10
  </font>end select   
elseif sreg<font color="#808080">=</font>ctArqs<font color="#808080">.</font>opLivro then
  select case nNum
    case <font color="#FF0000">0
      </font>sret <font color="#808080">= </font><font color="#800000">&quot;Livro(s) n&atilde;o encontrado(s)!&quot;
    </font>case <font color="#FF0000">1
      </font>sret <font color="#808080">= </font><font color="#800000">&quot;ISBN: &quot;
      </font>g_nPosChave <font color="#808080">= </font><font color="#FF0000">1
      </font>g_nTamChave <font color="#808080">= </font><font color="#FF0000">13
    </font>case <font color="#FF0000">2
      </font>sret <font color="#808080">= </font><font color="#800000">&quot;T&iacute;tulo: &quot;
      </font>g_nPosChave <font color="#808080">= </font><font color="#FF0000">14
      </font>g_nTamChave <font color="#808080">= </font><font color="#FF0000">50
    </font>case <font color="#FF0000">3
      </font>sret <font color="#808080">= </font><font color="#800000">&quot;Edi&ccedil;&atilde;o: &quot;
      </font>g_nPosChave <font color="#808080">= </font><font color="#FF0000">64
      </font>g_nTamChave <font color="#808080">= </font><font color="#FF0000">10
    </font>case <font color="#FF0000">4
      </font>sret <font color="#808080">= </font><font color="#800000">&quot;Ano de Publica&ccedil;&atilde;o: &quot;
      </font>g_nPosChave <font color="#808080">= </font><font color="#FF0000">74
      </font>g_nTamChave <font color="#808080">= </font><font color="#FF0000">10
    </font>case <font color="#FF0000">5
      </font>sret <font color="#808080">= </font><font color="#800000">&quot;C&oacute;digo da editora: &quot;
      </font>g_nPosChave <font color="#808080">= </font><font color="#FF0000">84
      </font>g_nTamChave <font color="#808080">= </font><font color="#FF0000">10
    </font>case <font color="#FF0000">6
      </font>sret <font color="#808080">= </font><font color="#800000">&quot;Volume: &quot;
      </font>g_nPosChave <font color="#808080">= </font><font color="#FF0000">94
      </font>g_nTamChave <font color="#808080">= </font><font color="#FF0000">10
    </font>case <font color="#FF0000">7
      </font>sret <font color="#808080">= </font><font color="#800000">&quot;C&oacute;digo do idioma: &quot;
      </font>g_nPosChave <font color="#808080">= </font><font color="#FF0000">104
      </font>g_nTamChave <font color="#808080">= </font><font color="#FF0000">10
    </font>case <font color="#FF0000">8
      </font>sret <font color="#808080">= </font><font color="#800000">&quot;N&uacute;mero de p&aacute;ginas: &quot;
      </font>g_nPosChave <font color="#808080">= </font><font color="#FF0000">114
      </font>g_nTamChave <font color="#808080">= </font><font color="#FF0000">10
    </font>case <font color="#FF0000">9
      </font>sret <font color="#808080">= </font><font color="#800000">&quot;Pre&ccedil;o: &quot;
      </font>g_nPosChave <font color="#808080">= </font><font color="#FF0000">124
      </font>g_nTamChave <font color="#808080">= </font><font color="#FF0000">10
    </font>case <font color="#FF0000">10
      </font>sret <font color="#808080">= </font><font color="#800000">&quot;Qtd. Estoque: &quot;
      </font>g_nPosChave <font color="#808080">= </font><font color="#FF0000">134
      </font>g_nTamChave <font color="#808080">= </font><font color="#FF0000">10
  </font>end select   
elseif sreg<font color="#808080">=</font>ctArqs<font color="#808080">.</font>opLivroAss then
  select case nNum
    case <font color="#FF0000">0
      </font>sret <font color="#808080">= </font><font color="#800000">&quot;Assunto(s) n&atilde;o encontrado(s)!&quot;
    </font>case <font color="#FF0000">1
      </font>sret <font color="#808080">= </font><font color="#800000">&quot;ISBN: &quot;
      </font>g_nPosChave <font color="#808080">= </font><font color="#FF0000">1
      </font>g_nTamChave <font color="#808080">= </font><font color="#FF0000">13
    </font>case <font color="#FF0000">2
      </font>sret <font color="#808080">= </font><font color="#800000">&quot;C&oacute;digo do assunto: &quot;
      </font>g_nPosChave <font color="#808080">= </font><font color="#FF0000">14
      </font>g_nTamChave <font color="#808080">= </font><font color="#FF0000">10
  </font>end select   
elseif sreg<font color="#808080">=</font>ctArqs<font color="#808080">.</font>opLivroAut then
  select case nNum
    case <font color="#FF0000">0
      </font>sret <font color="#808080">= </font><font color="#800000">&quot;Autor(s) n&atilde;o encontrado(s)!&quot;
    </font>case <font color="#FF0000">1
      </font>sret <font color="#808080">= </font><font color="#800000">&quot;ISBN: &quot;
      </font>g_nPosChave <font color="#808080">= </font><font color="#FF0000">1
      </font>g_nTamChave <font color="#808080">= </font><font color="#FF0000">13
    </font>case <font color="#FF0000">2
      </font>sret <font color="#808080">= </font><font color="#800000">&quot;C&oacute;digo do autor: &quot;
      </font>g_nPosChave <font color="#808080">= </font><font color="#FF0000">14
      </font>g_nTamChave <font color="#808080">= </font><font color="#FF0000">10
  </font>end select   
elseif sreg<font color="#808080">=</font>ctArqs<font color="#808080">.</font>opCliente then
  select case nNum
    case <font color="#FF0000">0
      </font>sret <font color="#808080">= </font><font color="#800000">&quot;Cliente(s) n&atilde;o encontrado(s)!&quot;
    </font>case <font color="#FF0000">1
      </font>sret <font color="#808080">= </font><font color="#800000">&quot;CPF: &quot;
      </font>g_nPosChave <font color="#808080">= </font><font color="#FF0000">1
      </font>g_nTamChave <font color="#808080">= </font><font color="#FF0000">14
    </font>case <font color="#FF0000">2
      </font>sret <font color="#808080">= </font><font color="#800000">&quot;Nome: &quot;
      </font>g_nPosChave <font color="#808080">= </font><font color="#FF0000">15
      </font>g_nTamChave <font color="#808080">= </font><font color="#FF0000">30
    </font>case <font color="#FF0000">3
      </font>sret <font color="#808080">= </font><font color="#800000">&quot;E-mail: &quot;
      </font>g_nPosChave <font color="#808080">= </font><font color="#FF0000">45
      </font>g_nTamChave <font color="#808080">= </font><font color="#FF0000">30
    </font>case <font color="#FF0000">4
      </font>sret <font color="#808080">= </font><font color="#800000">&quot;Identidade: &quot;
      </font>g_nPosChave <font color="#808080">= </font><font color="#FF0000">75
      </font>g_nTamChave <font color="#808080">= </font><font color="#FF0000">10
    </font>case <font color="#FF0000">5
      </font>sret <font color="#808080">= </font><font color="#800000">&quot;Sexo: &quot;
      </font>g_nPosChave <font color="#808080">= </font><font color="#FF0000">85
      </font>g_nTamChave <font color="#808080">= </font><font color="#FF0000">1
    </font>case <font color="#FF0000">6
      </font>sret <font color="#808080">= </font><font color="#800000">&quot;Telefone: &quot;
      </font>g_nPosChave <font color="#808080">= </font><font color="#FF0000">86
      </font>g_nTamChave <font color="#808080">= </font><font color="#FF0000">17
    </font>case <font color="#FF0000">7
      </font>sret <font color="#808080">= </font><font color="#800000">&quot;Dt. Nascimento: &quot;
      </font>g_nPosChave <font color="#808080">= </font><font color="#FF0000">103
      </font>g_nTamChave <font color="#808080">= </font><font color="#FF0000">10
    </font>case <font color="#FF0000">8
      </font>sret <font color="#808080">= </font><font color="#800000">&quot;C&oacute;digo do endere&ccedil;o: &quot;
      </font>g_nPosChave <font color="#808080">= </font><font color="#FF0000">113
      </font>g_nTamChave <font color="#808080">= </font><font color="#FF0000">10
    </font>case <font color="#FF0000">9
      </font>sret <font color="#808080">= </font><font color="#800000">&quot;C&oacute;digo do pa&iacute;s: &quot;
      </font>g_nPosChave <font color="#808080">= </font><font color="#FF0000">123
      </font>g_nTamChave <font color="#808080">= </font><font color="#FF0000">3
    </font>case <font color="#FF0000">10
      </font>sret <font color="#808080">= </font><font color="#800000">&quot;C&oacute;digo da Profiss&atilde;o: &quot;
      </font>g_nPosChave <font color="#808080">= </font><font color="#FF0000">126
      </font>g_nTamChave <font color="#808080">= </font><font color="#FF0000">10
  </font>end select   
elseif sreg<font color="#808080">=</font>ctArqs<font color="#808080">.</font>opVenda then
  select case nNum
    case <font color="#FF0000">0
      </font>sret <font color="#808080">= </font><font color="#800000">&quot;Venda(s) n&atilde;o encontrada(s)!&quot;
    </font>case <font color="#FF0000">1
      </font>sret <font color="#808080">= </font><font color="#800000">&quot;Data/Hora venda: &quot;
      </font>g_nPosChave <font color="#808080">= </font><font color="#FF0000">1
      </font>g_nTamChave <font color="#808080">= </font><font color="#FF0000">19
    </font>case <font color="#FF0000">2
      </font>sret <font color="#808080">= </font><font color="#800000">&quot;CPF: &quot;
      </font>g_nPosChave <font color="#808080">= </font><font color="#FF0000">20
      </font>g_nTamChave <font color="#808080">= </font><font color="#FF0000">14
    </font>case <font color="#FF0000">3
      </font>sret <font color="#808080">= </font><font color="#800000">&quot;ISBN: &quot;
      </font>g_nPosChave <font color="#808080">= </font><font color="#FF0000">34
      </font>g_nTamChave <font color="#808080">= </font><font color="#FF0000">13
    </font>case <font color="#FF0000">4
      </font>sret <font color="#808080">= </font><font color="#800000">&quot;Pre&ccedil;o de venda: &quot;
      </font>g_nPosChave <font color="#808080">= </font><font color="#FF0000">47
      </font>g_nTamChave <font color="#808080">= </font><font color="#FF0000">10
  </font>end select   
end if

rotulo <font color="#808080">= </font>sret
end function
<font color="#808080"><i>'------------------------------------------------------------------------------
'Indica se continua ou n&atilde;o mostrando um n&uacute;mero m&aacute;ximo de linhas.
'nlinha - a linha a ser continuada
'nQtdLinha - a quantidade de linhas a serem mostradas
'retorna - se continua ou n&atilde;o
'------------------------------------------------------------------------------
</i></font>function ContinuaSN<font color="#808080">(</font>nlinha as integer<font color="#808080">, </font>nQtdLinha as integer<font color="#808080">) </font>as boolean
dim bSOp<font color="#808080">, </font>bret as <font color="#000080"><b>Boolean
</b></font>dim opCSubMenu as char

bret <font color="#808080">= </font><font color="#000080"><b>false
</b></font>if nlinha <font color="#808080">&gt; </font><font color="#FF0000">0 </font>then
  if  <font color="#808080">(</font>nlinha mod nQtdLinha<font color="#808080">) = </font><font color="#FF0000">0 </font>then
    bSOp <font color="#808080">= </font><font color="#000080"><b>true
    </b></font>while bSOp
      menu<font color="#808080">(</font><font color="#FF0000">13</font><font color="#808080">)
      </font>opCSubMenu <font color="#808080">= </font>GetChar<font color="#808080">(</font><font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font><font color="#000080"><b>In</b></font><font color="#808080">.</font>ReadLine<font color="#808080">(),</font><font color="#FF0000">1</font><font color="#808080">)
      </font>if <font color="#808080">(</font>opCSubMenu<font color="#808080">=</font><font color="#800000">&quot;S&quot;</font>C<font color="#808080">) </font>or <font color="#808080">(</font>opCSubMenu<font color="#808080">=</font><font color="#800000">&quot;s&quot;</font>C<font color="#808080">) </font>then 
        bSOp <font color="#808080">= </font><font color="#000080"><b>false
      </b></font>elseif <font color="#808080">(</font>opCSubMenu<font color="#808080">=</font><font color="#800000">&quot;N&quot;</font>C<font color="#808080">) </font>or <font color="#808080">(</font>opCSubMenu<font color="#808080">=</font><font color="#800000">&quot;n&quot;</font>C<font color="#808080">) </font>then
        bret <font color="#808080">= </font><font color="#000080"><b>true
        </b></font>bSOp <font color="#808080">= </font><font color="#000080"><b>false
      </b></font>else 
        <font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font>MSG_ERRO<font color="#808080">)
      </font>end if
    end while
  end if
end if

ContinuaSN <font color="#808080">= </font>bret
end function
<font color="#808080"><i>'------------------------------------------------------------------------------
'Lista v&aacute;rios registros de acordo com a pesquisa feita.
'sArq - o arquivo
'sreg - o tipo de arquivo
'sChave - a chave a ser pesquisada
'nPosChave - a posicao inicial da chave dentro do registro
'nTamChave - o tamanho da chave dentro do registro
'nTamLinha - o tamanho do registro
'nQtdLinha - a quantidade de linhas a serem mostradas
'retorna - se encontrou algum registro
'------------------------------------------------------------------------------
</i></font>function ListarTodos<font color="#808080">(</font>sArq as FileStream<font color="#808080">, </font>sreg as ctArqs<font color="#808080">, </font>sChave as string<font color="#808080">, </font>_
  nPosChave as integer<font color="#808080">, </font>nTamChave as integer<font color="#808080">, </font>nTamLinha as integer<font color="#808080">, </font>_
  nQtdLinha as integer<font color="#808080">, </font>bPesqRelativa as <font color="#000080"><b>Boolean</b></font><font color="#808080">) </font>as boolean

  dim bQuebra<font color="#808080">, </font>bAchou<font color="#808080">, </font>bRet as <font color="#000080"><b>Boolean
  </b></font>dim nCont as integer
  dim sres as string <font color="#808080">= </font><font color="#800000">&quot;&quot;
  </font>dim slinha as string <font color="#808080">= </font><font color="#800000">&quot;&quot;

  </font>bRet <font color="#808080">= </font><font color="#000080"><b>false
  </b></font>bQuebra <font color="#808080">= </font><font color="#000080"><b>false
  </b></font>nCont <font color="#808080">= </font><font color="#FF0000">0
  </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">)
  </font>sArq<font color="#808080">.</font><font color="#000080"><b>Seek</b></font><font color="#808080">(</font><font color="#FF0000">0</font><font color="#808080">,</font>SeekOrigin<font color="#808080">.</font>Begin<font color="#808080">)
  </font>while <font color="#808080">(</font>not fimArq<font color="#808080">(</font>sArq<font color="#808080">)) </font>and bQuebra <font color="#808080">= </font><font color="#000080"><b>false
    </b></font>slinha <font color="#808080">= </font>lerArq<font color="#808080">(</font>sArq<font color="#808080">, </font>nTamLinha<font color="#808080">, </font>TAM_CRLF<font color="#808080">)
    </font>if slinha<font color="#808080">&lt;&gt;</font><font color="#800000">&quot;&quot; </font>then
  	if bPesqRelativa then
  	  sres <font color="#808080">= </font>trim<font color="#808080">(</font>mid<font color="#808080">(</font>slinha<font color="#808080">,</font>nPosChave<font color="#808080">,</font>nTamChave<font color="#808080">))
</font>  	  if strRelativa<font color="#808080">(</font>sres<font color="#808080">,</font>sChave<font color="#808080">)=</font><font color="#000080"><b>true </b></font>then
  	    bAchou <font color="#808080">= </font><font color="#000080"><b>true
</b></font>  	    bRet <font color="#808080">= </font><font color="#000080"><b>true
</b></font>  	  else
  	    bAchou <font color="#808080">= </font><font color="#000080"><b>false
</b></font>  	  end if
  	else
  	  bAchou <font color="#808080">= </font><font color="#000080"><b>true
</b></font>  	  bRet <font color="#808080">= </font><font color="#000080"><b>true
</b></font>  	end if
  
  	if bAchou then
  	  mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font>mid<font color="#808080">(</font>slinha<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font>nTamLinha<font color="#808080">), </font><font color="#FF0000">3</font><font color="#808080">)
</font>  	  ncont <font color="#808080">= </font>ncont <font color="#808080">+ </font><font color="#FF0000">1
</font>  	end if
    end if
    bQuebra <font color="#808080">= </font>ContinuaSN<font color="#808080">(</font>nCont<font color="#808080">, </font>nQtdLinha<font color="#808080">)
  </font>end while

ListarTodos <font color="#808080">= </font>bRet
end function
<font color="#808080"><i>'------------------------------------------------------------------------------
'Lista v&aacute;rios registros entre arquivos de acordo com a pesquisa feita.
'sArq1 - o arquivo de liga&ccedil;&atilde;o
'sreg1 - o tipo de arquivo de liga&ccedil;&atilde;o
'nPosChave1 - a posicao inicial da primeira chave no arquivo de liga&ccedil;&atilde;o
'nTamChave1 - o tamanho da primeira chave no arquivo de liga&ccedil;&atilde;o
'nPosChave2 - a posicao inicial da segunda chave do arquivo de liga&ccedil;&atilde;o
'nTamChave2 - o tamanho da segunda chave do arquivo de liga&ccedil;&atilde;o
'sChave - a chave a ser pesquisada no arquivo de liga&ccedil;&atilde;o
'sArq2 - o arquivo a ser pesquisado
'sreg2 - o tipo de arquivo a ser pesquisado
'nPosChave3 - a posicao inicial da chave do arquivo pesquisado
'nQtdLinha - a quantidade de linhas a serem mostradas
'------------------------------------------------------------------------------
</i></font>sub ListarRegLigados<font color="#808080">(</font>sArq1 as FileStream<font color="#808080">, </font>sreg1 as ctArqs<font color="#808080">, </font>_
nPosChave1 as integer<font color="#808080">, </font>nTamChave1 as integer<font color="#808080">, </font>nPosChave2 as integer<font color="#808080">, </font>_
nTamChave2 as integer<font color="#808080">, </font>sChave as string<font color="#808080">, </font>sArq2 as FileStream<font color="#808080">, </font>_
sreg2 as ctArqs<font color="#808080">, </font>nPosChave3 as integer<font color="#808080">, </font>nQtdLinha as integer<font color="#808080">)
  </font>dim slinha1 as string <font color="#808080">= </font><font color="#800000">&quot;&quot;
  </font>dim bQuebra<font color="#808080">, </font>bRet as <font color="#000080"><b>Boolean
  </b></font>dim nCont as integer
  dim sCodigo1<font color="#808080">, </font>sCodigo2<font color="#808080">, </font>slinha2 as string

  bRet <font color="#808080">= </font><font color="#000080"><b>false
  </b></font>nCont <font color="#808080">= </font><font color="#FF0000">0
  </font>bQuebra <font color="#808080">= </font><font color="#000080"><b>false
  </b></font>mostrarDados<font color="#808080">(</font>sreg2<font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">)
  </font>sArq1<font color="#808080">.</font><font color="#000080"><b>Seek</b></font><font color="#808080">(</font><font color="#FF0000">0</font><font color="#808080">,</font>SeekOrigin<font color="#808080">.</font>Begin<font color="#808080">)
  </font>while <font color="#808080">(</font>not fimArq<font color="#808080">(</font>sArq1<font color="#808080">)) </font>and bQuebra <font color="#808080">= </font><font color="#000080"><b>false
    </b></font>slinha1 <font color="#808080">= </font>lerArq<font color="#808080">(</font>sArq1<font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg1<font color="#808080">), </font>TAM_CRLF<font color="#808080">)
    </font>if slinha1<font color="#808080">&lt;&gt;</font><font color="#800000">&quot;&quot; </font>then
  	sCodigo1 <font color="#808080">= </font>trim<font color="#808080">(</font>mid<font color="#808080">(</font>slinha1<font color="#808080">,</font>nPosChave1<font color="#808080">,</font>nTamChave1<font color="#808080">))
</font>  	if sCodigo1<font color="#808080">=</font>sChave then
  	  sCodigo2 <font color="#808080">= </font><font color="#000080"><b>Trim</b></font><font color="#808080">(</font>mid<font color="#808080">(</font>slinha1<font color="#808080">,</font>nPosChave2<font color="#808080">,</font>nTamChave2<font color="#808080">))
</font>  	  slinha2 <font color="#808080">= </font>pesqArq<font color="#808080">(</font>sArq2<font color="#808080">, </font>sCodigo2<font color="#808080">, </font>nPosChave3<font color="#808080">, </font>nTamChave2<font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg2<font color="#808080">))
</font>  	  mostrarDados<font color="#808080">(</font>sreg2<font color="#808080">, </font>mid<font color="#808080">(</font>slinha2<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg2<font color="#808080">)), </font><font color="#FF0000">3</font><font color="#808080">)
</font>  	  bRet <font color="#808080">= </font><font color="#000080"><b>true
</b></font>  	  nCont <font color="#808080">= </font>nCont <font color="#808080">+ </font><font color="#FF0000">1
</font>  	end if
    end if
    bQuebra <font color="#808080">= </font>ContinuaSN<font color="#808080">(</font>nCont<font color="#808080">, </font>nQtdLinha<font color="#808080">)
  </font>end while
  if bRet<font color="#808080">=</font><font color="#000080"><b>false </b></font>then
     <font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg2<font color="#808080">,</font><font color="#FF0000">0</font><font color="#808080">))
  </font>end if
end sub

<font color="#808080"><i>'------------------------------------------------------------------------------
'Valida a entrada de registros de acordo com a pesquisa feita.
'sArq - o arquivo
'sreg - o tipo de arquivo
'nTexto - o numero do r&oacute;tulo da entrada
'sEntrada - a chave a ser pesquisada e validada
'nTentativas - o n&uacute;mero m&aacute;ximo de tentativas
'bPesqRelativa - indica se vai realizar uma pesquisa relativa
'bTipoEntrada - indica o tipo de entrada
'retorna - o registro pesquisado e validado
'------------------------------------------------------------------------------
</i></font>function validaEntrada<font color="#808080">(</font>sArq as FileStream<font color="#808080">, </font>sreg as ctArqs<font color="#808080">, </font>nTexto as integer<font color="#808080">, </font>_
  sEntrada as string<font color="#808080">, </font>nTentativas as integer<font color="#808080">, </font>_
  bPesqRelativa as <font color="#000080"><b>Boolean</b></font><font color="#808080">, </font>bTipoEntrada as ctTipo<font color="#808080">) </font>as string 
dim bQuebra as <font color="#000080"><b>Boolean
</b></font>dim sres<font color="#808080">, </font>sTexto<font color="#808080">, </font>sMsgErro<font color="#808080">, </font>sLocal as string
dim ncont<font color="#808080">, </font>nPosChave<font color="#808080">, </font>nTamChave<font color="#808080">, </font>nTamLinha as integer

sres <font color="#808080">= </font><font color="#800000">&quot;&quot;
</font>sLocal <font color="#808080">= </font>sEntrada

nTamLinha <font color="#808080">= </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">)
</font>sMsgErro <font color="#808080">= </font>rotulo<font color="#808080">(</font>sreg<font color="#808080">,</font><font color="#FF0000">0</font><font color="#808080">)
</font>sTexto <font color="#808080">= </font>rotulo<font color="#808080">(</font>sreg<font color="#808080">,</font>nTexto<font color="#808080">)
</font>nPosChave <font color="#808080">= </font>g_nPosChave
nTamChave <font color="#808080">= </font>g_nTamChave

ncont <font color="#808080">= </font><font color="#FF0000">1
</font>bQuebra <font color="#808080">= </font><font color="#000080"><b>false
  </b></font>while <font color="#808080">(</font>bQuebra<font color="#808080">=</font><font color="#000080"><b>false</b></font><font color="#808080">) </font>and <font color="#808080">(</font>ncont <font color="#808080">&lt;= </font>nTentativas<font color="#808080">)
    </font>if bTipoEntrada<font color="#808080">=</font>ctTipo<font color="#808080">.</font>opTexto then
      <font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font><font color="#000080"><b>Write</b></font><font color="#808080">(</font>sTexto<font color="#808080">)
      </font>sLocal <font color="#808080">= </font><font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font><font color="#000080"><b>In</b></font><font color="#808080">.</font>ReadLine<font color="#808080">()
    </font>elseif bTipoEntrada<font color="#808080">=</font>ctTipo<font color="#808080">.</font>opNumero then
       sLocal <font color="#808080">= </font>validaNumero<font color="#808080">(</font>sTexto<font color="#808080">,</font>sLocal<font color="#808080">)
    </font>elseif bTipoEntrada<font color="#808080">=</font>ctTipo<font color="#808080">.</font>opData then
       sLocal <font color="#808080">= </font>validaDataHora<font color="#808080">(</font>sTexto<font color="#808080">,</font>sLocal<font color="#808080">,</font><font color="#000080"><b>true</b></font><font color="#808080">)
    </font>elseif bTipoEntrada<font color="#808080">=</font>ctTipo<font color="#808080">.</font>opDataHora then
       sLocal <font color="#808080">= </font>validaDataHora<font color="#808080">(</font>sTexto<font color="#808080">,</font>sLocal<font color="#808080">,</font><font color="#000080"><b>false</b></font><font color="#808080">)
    </font>elseif bTipoEntrada<font color="#808080">=</font>ctTipo<font color="#808080">.</font>opSenha then
       sLocal <font color="#808080">= </font>digitaSenha<font color="#808080">(</font>sTexto<font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">)
    </font>end if

    if bPesqRelativa then
       if ListarTodos<font color="#808080">(</font>sArq<font color="#808080">, </font>sreg<font color="#808080">, </font>sLocal<font color="#808080">, </font>nPosChave<font color="#808080">, </font>nTamChave<font color="#808080">, </font>nTamLinha<font color="#808080">, </font>_
          QTD_MAX_LINHA<font color="#808080">, </font><font color="#000080"><b>true</b></font><font color="#808080">) </font>then
          sres <font color="#808080">= </font><font color="#800000">&quot; &quot;
       </font>end if
    else
       sres <font color="#808080">= </font>pesqArq<font color="#808080">(</font>sArq<font color="#808080">, </font>sLocal<font color="#808080">, </font>nPosChave<font color="#808080">, </font>nTamChave<font color="#808080">, </font>nTamLinha<font color="#808080">)
    </font>end if
    
    if sres <font color="#808080">= </font><font color="#800000">&quot;&quot; </font>then
      <font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font>sMsgErro<font color="#808080">)
    </font>else
      bQuebra <font color="#808080">= </font><font color="#000080"><b>true
    </b></font>end if

    ncont <font color="#808080">= </font>ncont <font color="#808080">+ </font><font color="#FF0000">1
  </font>end while
validaEntrada <font color="#808080">= </font>sres
end function
<font color="#808080"><i>'------------------------------------------------------------------------------
'Mostra a tela de splash do sistema.
'------------------------------------------------------------------------------
</i></font>sub frmSplash<font color="#808080">()
</font>dim cont as integer

 <font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;*---------------------------------------&quot; </font><font color="#808080">+ </font>_
 <font color="#800000">&quot;-------------------------------------*&quot;</font><font color="#808080">)
 </font><font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;| LL    II VV   VV RRRRR  UU  UU   SSSS &quot; </font><font color="#808080">+ </font>_
 <font color="#800000">&quot;VV   VV II RRRRR  TTTT UU  UU   SSSS |&quot;</font><font color="#808080">)
 </font><font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;| LL    II  VV VV  RR   R UU  UU  SS    &quot; </font><font color="#808080">+ </font>_
 <font color="#800000">&quot; VV VV  II RR   R  TT  UU  UU  SS    |&quot;</font><font color="#808080">)
 </font><font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;| LL    II   VVV   RRRRR  UU  UU    SS  &quot; </font><font color="#808080">+ </font>_
 <font color="#800000">&quot;  VVV   II RRRRR   TT  UU  UU    SS  |&quot;</font><font color="#808080">)
 </font><font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;| LLLLL II    V    RR   R  UUUU  SSSS   &quot; </font><font color="#808080">+ </font>_
 <font color="#800000">&quot;   V    II RR   R  TT   UUUU  SSSS   |&quot;</font><font color="#808080">)
 </font><font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;*---------------------------------------&quot; </font><font color="#808080">+ </font>_
 <font color="#800000">&quot;-------------------------------------*&quot;</font><font color="#808080">)
 </font>for cont <font color="#808080">= </font><font color="#FF0000">1 </font>to <font color="#FF0000">18
   </font><font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">()
 </font>next cont
 <font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font><font color="#000080"><b>Write</b></font><font color="#808080">(</font>MSG_PRESS<font color="#808080">)
 </font><font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font><font color="#000080"><b>In</b></font><font color="#808080">.</font>ReadLine<font color="#808080">()
</font>end sub
<font color="#808080"><i>'------------------------------------------------------------------------------
'Mostra a tela de sobre do sistema.
'------------------------------------------------------------------------------
</i></font>sub frmSobre<font color="#808080">()
</font>dim cont as integer

 <font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;*------------------------------------------------------------*&quot;</font><font color="#808080">)
 </font><font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;|  LL        II  VV       VV  RRRRRRR   UU    UU   SSSSSSS   |&quot;</font><font color="#808080">)
 </font><font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;|  LL        II   VV     VV   RR     R  UU    UU  SS         |&quot;</font><font color="#808080">)
 </font><font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;|  LL        II    VV   VV    RR     R  UU    UU   SSSS      |&quot;</font><font color="#808080">)
 </font><font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;|  LL        II     VV VV     RRRRRRR   UU    UU     SSSS    |&quot;</font><font color="#808080">)
 </font><font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;|  LLLL      II      VVV      RR RR     UU    UU        SS   |&quot;</font><font color="#808080">)
 </font><font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;|  LLLLLLLL  II       V       RR   RR    UUUUUU   SSSSSSSS   |&quot;</font><font color="#808080">)
 </font><font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;|                                                            |&quot;</font><font color="#808080">)
 </font><font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;|  VV       VV  II  RRRRRRR   TTTTTTTT  UU    UU   SSSSSSS   |&quot;</font><font color="#808080">)
 </font><font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;|   VV     VV   II  RR     R     TT     UU    UU  SS         |&quot;</font><font color="#808080">)
 </font><font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;|    VV   VV    II  RR     R     TT     UU    UU   SSSS      |&quot;</font><font color="#808080">)
 </font><font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;|     VV VV     II  RRRRRRR      TT     UU    UU     SSSS    |&quot;</font><font color="#808080">)
 </font><font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;|      VVV      II  RR RR        TT     UU    UU        SS   |&quot;</font><font color="#808080">)
 </font><font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;|       V       II  RR   RR      TT      UUUUUU   SSSSSSSS   |&quot;</font><font color="#808080">)
 </font><font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;|                                                            |&quot;</font><font color="#808080">)
 </font><font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;|                                               Versao 1.0.0 |&quot;</font><font color="#808080">)
 </font><font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;| Sistema integrante do projeto Livrus Virtus.               |&quot;</font><font color="#808080">)
 </font><font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;| Todos os direitos reservados para Henrique F. de Souza.    |&quot;</font><font color="#808080">)
 </font><font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;| Versao programada na linguagem Visual Basic.NET.           |&quot;</font><font color="#808080">)
 </font><font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;*------------------------------------------------------------*&quot;</font><font color="#808080">)
 </font>for cont <font color="#808080">= </font><font color="#FF0000">1 </font>to <font color="#FF0000">4 
   </font><font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">()
 </font>next cont
 <font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font><font color="#000080"><b>Write</b></font><font color="#808080">(</font>MSG_PRESS<font color="#808080">)
 </font><font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font><font color="#000080"><b>In</b></font><font color="#808080">.</font>ReadLine<font color="#808080">()
</font>end sub
<font color="#808080"><i>'------------------------------------------------------------------------------
'Mostra a tela de login do sistema.
'retorna - se o login foi validado corretamente
'------------------------------------------------------------------------------
</i></font>function frmLogin<font color="#808080">() </font>as <font color="#000080"><b>Boolean
</b></font>dim bret as <font color="#000080"><b>Boolean
</b></font>dim slinha as string

  bret <font color="#808080">= </font><font color="#000080"><b>false
  </b></font><font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;*--------------------------------------------------------------*&quot;</font><font color="#808080">)
  </font><font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;| Login do sistema                                             |&quot;</font><font color="#808080">)
  </font><font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;*--------------------------------------------------------------*&quot;</font><font color="#808080">)
  </font>slinha <font color="#808080">= </font>validaEntrada<font color="#808080">(</font>tfUsuario<font color="#808080">, </font>ctArqs<font color="#808080">.</font>opUsuario<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font>tUsuario<font color="#808080">.</font>login<font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">, </font>_
		<font color="#000080"><b>false</b></font><font color="#808080">, </font>ctTipo<font color="#808080">.</font>opTexto<font color="#808080">)
  </font>if slinha<font color="#808080">&lt;&gt;</font><font color="#800000">&quot;&quot; </font>then
    slinha <font color="#808080">= </font>validaEntrada<font color="#808080">(</font>tfUsuario<font color="#808080">, </font>ctArqs<font color="#808080">.</font>opUsuario<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">, </font>tUsuario<font color="#808080">.</font>senha<font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">, </font>_
             <font color="#000080"><b>false</b></font><font color="#808080">, </font>ctTipo<font color="#808080">.</font>opSenha<font color="#808080">)
    </font>if slinha<font color="#808080">&lt;&gt;</font><font color="#800000">&quot;&quot; </font>then
      tUsuario<font color="#808080">.</font>login <font color="#808080">= </font><font color="#000080"><b>Trim</b></font><font color="#808080">(</font>mid<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">))
      </font>tUsuario<font color="#808080">.</font>senha <font color="#808080">= </font><font color="#000080"><b>Trim</b></font><font color="#808080">(</font>mid<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">11</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">))
      </font>bret <font color="#808080">= </font><font color="#000080"><b>true
    </b></font>end if
  end if
  <font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">()
  </font>frmLogin <font color="#808080">= </font>bret
end function
<font color="#808080"><i>'------------------------------------------------------------------------------
'Mostra os menus do sistema.
'num - o n&uacute;mero do menu
'------------------------------------------------------------------------------
</i></font>sub menu<font color="#808080">(</font>num as integer<font color="#808080">)
 </font>if num<font color="#808080">=</font><font color="#FF0000">1 </font>then
   <font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;*--------------------------------------------------------------*&quot;</font><font color="#808080">)
   </font><font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;| (C)adastros        (P)esquisas     (V)endas        (O)p&ccedil;&otilde;es  |&quot;</font><font color="#808080">)
   </font><font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;*--------------------------------------------------------------*&quot;</font><font color="#808080">)
 </font>elseif num<font color="#808080">=</font><font color="#FF0000">2 </font>then
   <font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;*---------------------------------*&quot;</font><font color="#808080">)
   </font><font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;| 01. Cadastro de Assuntos        |&quot;</font><font color="#808080">)
   </font><font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;| 02. Cadastro de Autores         |&quot;</font><font color="#808080">)
   </font><font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;| 03. Cadastro de Editoras        |&quot;</font><font color="#808080">)
   </font><font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;| 04. Cadastro de Endere&ccedil;os       |&quot;</font><font color="#808080">)
   </font><font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;| 05. Cadastro de Idiomas         |&quot;</font><font color="#808080">)
   </font><font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;| 06. Cadastro de Pa&iacute;ses          |&quot;</font><font color="#808080">)
   </font><font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;| 07. Cadastro de Profiss&otilde;es      |&quot;</font><font color="#808080">)
   </font><font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;| 08. Cadastro de Clientes        |&quot;</font><font color="#808080">)
   </font><font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;| 09. Cadastro de Livros          |&quot;</font><font color="#808080">)
   </font><font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;| 10. Voltar ao menu              |&quot;</font><font color="#808080">)
   </font><font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;*---------------------------------*&quot;</font><font color="#808080">)
 </font>elseif num<font color="#808080">=</font><font color="#FF0000">3 </font>then
   <font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;*---------------------------------*&quot;</font><font color="#808080">)
   </font><font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;| 01. Consulta de Assuntos        |&quot;</font><font color="#808080">)
   </font><font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;| 02. Consulta de Autores         |&quot;</font><font color="#808080">)
   </font><font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;| 03. Consulta de Editoras        |&quot;</font><font color="#808080">)
   </font><font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;| 04. Consulta de Endere&ccedil;os       |&quot;</font><font color="#808080">)
   </font><font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;| 05. Consulta de Idiomas         |&quot;</font><font color="#808080">)
   </font><font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;| 06. Consulta de Pa&iacute;ses          |&quot;</font><font color="#808080">)
   </font><font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;| 07. Consulta de Profiss&otilde;es      |&quot;</font><font color="#808080">)
   </font><font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;| 08. Consulta de Clientes        |&quot;</font><font color="#808080">)
   </font><font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;| 09. Consulta de Livros          |&quot;</font><font color="#808080">)
   </font><font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;| 10. Voltar ao menu              |&quot;</font><font color="#808080">)
   </font><font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;*---------------------------------*&quot;</font><font color="#808080">)
 </font>elseif num<font color="#808080">=</font><font color="#FF0000">4 </font>then
   <font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;*---------------------------------*&quot;</font><font color="#808080">)
   </font><font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;| 01. Vender Livros               |&quot;</font><font color="#808080">)
   </font><font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;| 02. Vendas Realizadas           |&quot;</font><font color="#808080">)
   </font><font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;| 03. Voltar ao menu              |&quot;</font><font color="#808080">)
   </font><font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;*---------------------------------*&quot;</font><font color="#808080">)
 </font>elseif num<font color="#808080">=</font><font color="#FF0000">5 </font>then
   <font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;*---------------------------------*&quot;</font><font color="#808080">)
   </font><font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;| 01. Alterar senha               |&quot;</font><font color="#808080">)
   </font><font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;| 02. Sobre o sistema             |&quot;</font><font color="#808080">)
   </font><font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;| 03. Sair do sistema             |&quot;</font><font color="#808080">)
   </font><font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;| 04. Voltar ao menu              |&quot;</font><font color="#808080">)
   </font><font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;*---------------------------------*&quot;</font><font color="#808080">)
 </font>elseif num<font color="#808080">=</font><font color="#FF0000">6 </font>then
   <font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;*--------------------------------------------------------------*&quot;</font><font color="#808080">)
   </font><font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;| (1) Novo  (2) Pesquisar   (3) Voltar ao menu                 |&quot;</font><font color="#808080">)
   </font><font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;*--------------------------------------------------------------*&quot;</font><font color="#808080">)
 </font>elseif num<font color="#808080">=</font><font color="#FF0000">7 </font>then
   <font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;*--------------------------------------------------------------*&quot;</font><font color="#808080">)
   </font><font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;| (1) Salvar inclus&atilde;o       (2) Voltar ao menu                 |&quot;</font><font color="#808080">)
   </font><font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;*--------------------------------------------------------------*&quot;</font><font color="#808080">)
 </font>elseif num<font color="#808080">=</font><font color="#FF0000">8 </font>then
   <font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;*--------------------------------------------------------------*&quot;</font><font color="#808080">)
   </font><font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;| (1) Alterar       (2) Excluir     (3) Voltar ao menu         |&quot;</font><font color="#808080">)
   </font><font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;*--------------------------------------------------------------*&quot;</font><font color="#808080">)
 </font>elseif num<font color="#808080">=</font><font color="#FF0000">9 </font>then
   <font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;*--------------------------------------------------------------*&quot;</font><font color="#808080">)
   </font><font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;| (1) Salvar altera&ccedil;&atilde;o      (2) Voltar ao menu                 |&quot;</font><font color="#808080">)
   </font><font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;*--------------------------------------------------------------*&quot;</font><font color="#808080">)
 </font>elseif num<font color="#808080">=</font><font color="#FF0000">10 </font>then
   <font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;*--------------------------------------------------------------*&quot;</font><font color="#808080">)
   </font><font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;| Certeza de excluir? (S/N)                                    |&quot;</font><font color="#808080">)
   </font><font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;*--------------------------------------------------------------*&quot;</font><font color="#808080">)
 </font>elseif num<font color="#808080">=</font><font color="#FF0000">11 </font>then
   <font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;*--------------------------------------------------------------*&quot;</font><font color="#808080">)
   </font><font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;| Deseja sair do sistema? (S/N)                                |&quot;</font><font color="#808080">)
   </font><font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;*--------------------------------------------------------------*&quot;</font><font color="#808080">)
 </font>elseif num<font color="#808080">=</font><font color="#FF0000">12 </font>then
   <font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;*--------------------------------------------------------------*&quot;</font><font color="#808080">)
   </font><font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;| (1) Pesquisar  (2) Listar todos   (3) Voltar ao menu         |&quot;</font><font color="#808080">)
   </font><font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;*--------------------------------------------------------------*&quot;</font><font color="#808080">)
 </font>elseif num<font color="#808080">=</font><font color="#FF0000">13 </font>then
   <font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;*--------------------------------------------------------------*&quot;</font><font color="#808080">)
   </font><font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;| Deseja continuar? (S/N)                                      |&quot;</font><font color="#808080">)
   </font><font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;*--------------------------------------------------------------*&quot;</font><font color="#808080">)
 </font>elseif num<font color="#808080">=</font><font color="#FF0000">14 </font>then
   <font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;*--------------------------------------------------------------*&quot;</font><font color="#808080">)
   </font><font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;| Salvar inclus&atilde;o (S/N)                                        |&quot;</font><font color="#808080">)
   </font><font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;*--------------------------------------------------------------*&quot;</font><font color="#808080">)
 </font>end if
 <font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font><font color="#000080"><b>Write</b></font><font color="#808080">(</font>MSG_OPCAO<font color="#808080">)
</font>end sub
<font color="#808080"><i>'------------------------------------------------------------------------------
'Realiza os cadastros de acordo com o tipo de arquivo.
'sreg - o tipo de arquivo
'sacao - a a&ccedil;&atilde;o a ser realizada
'------------------------------------------------------------------------------
</i></font>sub frmCadastros<font color="#808080">(</font>sreg as ctArqs<font color="#808080">, </font>sacao as ctAcao<font color="#808080">)
</font>dim slinha as string <font color="#808080">= </font><font color="#800000">&quot;&quot;

</font>if sreg<font color="#808080">=</font>ctArqs<font color="#808080">.</font>opAssunto then
   if sacao<font color="#808080">=</font>ctAcao<font color="#808080">.</font>opNovo then
     tAssunto<font color="#808080">.</font>codigo <font color="#808080">= </font>pesqMaxCod<font color="#808080">(</font>tfAssunto<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">))
     </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">)
     </font>subMenu<font color="#808080">(</font><font color="#FF0000">7</font><font color="#808080">, </font>sreg<font color="#808080">)
   </font>elseif sacao<font color="#808080">=</font>ctAcao<font color="#808080">.</font>opPesquisar then
     slinha <font color="#808080">= </font>validaEntrada<font color="#808080">(</font>tfAssunto<font color="#808080">,</font>sreg<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font>tAssunto<font color="#808080">.</font>codigo<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#000080"><b>false</b></font><font color="#808080">,</font>ctTipo<font color="#808080">.</font>opNumero<font color="#808080">)
      </font>if slinha<font color="#808080">&lt;&gt;</font><font color="#800000">&quot;&quot; </font>then
    	mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">)
</font>    	mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font>slinha<font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">)
</font>    	subMenu<font color="#808080">(</font><font color="#FF0000">8</font><font color="#808080">, </font>sreg<font color="#808080">)
      </font>end if
   elseif sacao<font color="#808080">=</font>ctAcao<font color="#808080">.</font>opAlterar then
     mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">)
     </font>subMenu<font color="#808080">(</font><font color="#FF0000">9</font><font color="#808080">, </font>sreg<font color="#808080">)
   </font>elseif sacao<font color="#808080">=</font>ctAcao<font color="#808080">.</font>opExcluir then
     subMenu<font color="#808080">(</font><font color="#FF0000">10</font><font color="#808080">, </font>sreg<font color="#808080">)
   </font>end if
elseif sreg<font color="#808080">=</font>ctArqs<font color="#808080">.</font>opAutor then
   if sacao<font color="#808080">=</font>ctAcao<font color="#808080">.</font>opNovo then
     tAutor<font color="#808080">.</font>codigo <font color="#808080">= </font>pesqMaxCod<font color="#808080">(</font>tfAutor<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">))
     </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">)
     </font>subMenu<font color="#808080">(</font><font color="#FF0000">7</font><font color="#808080">, </font>sreg<font color="#808080">)
   </font>elseif sacao<font color="#808080">=</font>ctAcao<font color="#808080">.</font>opPesquisar then
     slinha <font color="#808080">= </font>validaEntrada<font color="#808080">(</font>tfAutor<font color="#808080">, </font>sreg<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font>tAutor<font color="#808080">.</font>codigo<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#000080"><b>false</b></font><font color="#808080">,</font>ctTipo<font color="#808080">.</font>opNumero<font color="#808080">)
     </font>if slinha<font color="#808080">&lt;&gt;</font><font color="#800000">&quot;&quot; </font>then
       mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">)
       </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font>slinha<font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">)
       </font>subMenu<font color="#808080">(</font><font color="#FF0000">8</font><font color="#808080">, </font>sreg<font color="#808080">)
     </font>end if
   elseif sacao<font color="#808080">=</font>ctAcao<font color="#808080">.</font>opAlterar then
     mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">)
     </font>subMenu<font color="#808080">(</font><font color="#FF0000">9</font><font color="#808080">, </font>sreg<font color="#808080">)
   </font>elseif sacao<font color="#808080">=</font>ctAcao<font color="#808080">.</font>opExcluir then
     subMenu<font color="#808080">(</font><font color="#FF0000">10</font><font color="#808080">, </font>sreg<font color="#808080">)
   </font>end if
elseif sreg<font color="#808080">=</font>ctArqs<font color="#808080">.</font>opEditora then
   if sacao<font color="#808080">=</font>ctAcao<font color="#808080">.</font>opNovo then
     tEditora<font color="#808080">.</font>codigo <font color="#808080">= </font>pesqMaxCod<font color="#808080">(</font>tfEditora<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">))
     </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">)
     </font>subMenu<font color="#808080">(</font><font color="#FF0000">7</font><font color="#808080">, </font>sreg<font color="#808080">)
   </font>elseif sacao<font color="#808080">=</font>ctAcao<font color="#808080">.</font>opPesquisar then
     slinha <font color="#808080">= </font>validaEntrada<font color="#808080">(</font>tfEditora<font color="#808080">,</font>sreg<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font>tEditora<font color="#808080">.</font>codigo<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#000080"><b>false</b></font><font color="#808080">,</font>ctTipo<font color="#808080">.</font>opNumero<font color="#808080">)
     </font>if slinha<font color="#808080">&lt;&gt;</font><font color="#800000">&quot;&quot; </font>then
       mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">)
       </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font>slinha<font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">)
       </font>subMenu<font color="#808080">(</font><font color="#FF0000">8</font><font color="#808080">, </font>sreg<font color="#808080">)
     </font>end if
   elseif sacao<font color="#808080">=</font>ctAcao<font color="#808080">.</font>opAlterar then
     mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">)
     </font>subMenu<font color="#808080">(</font><font color="#FF0000">9</font><font color="#808080">, </font>sreg<font color="#808080">)
   </font>elseif sacao<font color="#808080">=</font>ctAcao<font color="#808080">.</font>opExcluir then
     subMenu<font color="#808080">(</font><font color="#FF0000">10</font><font color="#808080">, </font>sreg<font color="#808080">)
   </font>end if
elseif sreg<font color="#808080">=</font>ctArqs<font color="#808080">.</font>opEndereco then
   if sacao<font color="#808080">=</font>ctAcao<font color="#808080">.</font>opNovo then
     tEndereco<font color="#808080">.</font>codigo <font color="#808080">= </font>pesqMaxCod<font color="#808080">(</font>tfEndereco<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">))
     </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">)
     </font>subMenu<font color="#808080">(</font><font color="#FF0000">7</font><font color="#808080">, </font>sreg<font color="#808080">)
   </font>elseif sacao<font color="#808080">=</font>ctAcao<font color="#808080">.</font>opPesquisar then
     slinha <font color="#808080">= </font>validaEntrada<font color="#808080">(</font>tfEndereco<font color="#808080">,</font>sreg<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font>tEndereco<font color="#808080">.</font>codigo<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">, </font>_
              <font color="#000080"><b>false</b></font><font color="#808080">,</font>ctTipo<font color="#808080">.</font>opNumero<font color="#808080">)
     </font>if slinha<font color="#808080">&lt;&gt;</font><font color="#800000">&quot;&quot; </font>then
       mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">)
       </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font>slinha<font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">)
       </font>subMenu<font color="#808080">(</font><font color="#FF0000">8</font><font color="#808080">, </font>sreg<font color="#808080">)
     </font>end if
   elseif sacao<font color="#808080">=</font>ctAcao<font color="#808080">.</font>opAlterar then
     mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">)
     </font>subMenu<font color="#808080">(</font><font color="#FF0000">9</font><font color="#808080">, </font>sreg<font color="#808080">)
   </font>elseif sacao<font color="#808080">=</font>ctAcao<font color="#808080">.</font>opExcluir then
     subMenu<font color="#808080">(</font><font color="#FF0000">10</font><font color="#808080">, </font>sreg<font color="#808080">)
   </font>end if
elseif sreg<font color="#808080">=</font>ctArqs<font color="#808080">.</font>opIdioma then
   if sacao<font color="#808080">=</font>ctAcao<font color="#808080">.</font>opNovo then
     tIdioma<font color="#808080">.</font>codigo <font color="#808080">= </font>pesqMaxCod<font color="#808080">(</font>tfIdioma<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">))
     </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">)
     </font>subMenu<font color="#808080">(</font><font color="#FF0000">7</font><font color="#808080">, </font>sreg<font color="#808080">)
   </font>elseif sacao<font color="#808080">=</font>ctAcao<font color="#808080">.</font>opPesquisar then
     slinha <font color="#808080">= </font>validaEntrada<font color="#808080">(</font>tfIdioma<font color="#808080">,</font>sreg<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font>tIdioma<font color="#808080">.</font>codigo<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#000080"><b>false</b></font><font color="#808080">,</font>ctTipo<font color="#808080">.</font>opNumero<font color="#808080">)
     </font>if slinha<font color="#808080">&lt;&gt;</font><font color="#800000">&quot;&quot; </font>then
       mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">)
       </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font>slinha<font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">)
       </font>subMenu<font color="#808080">(</font><font color="#FF0000">8</font><font color="#808080">, </font>sreg<font color="#808080">)
     </font>end if
   elseif sacao<font color="#808080">=</font>ctAcao<font color="#808080">.</font>opAlterar then
     mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">)
     </font>subMenu<font color="#808080">(</font><font color="#FF0000">9</font><font color="#808080">, </font>sreg<font color="#808080">)
   </font>elseif sacao<font color="#808080">=</font>ctAcao<font color="#808080">.</font>opExcluir then
     subMenu<font color="#808080">(</font><font color="#FF0000">10</font><font color="#808080">, </font>sreg<font color="#808080">)
   </font>end if
elseif sreg<font color="#808080">=</font>ctArqs<font color="#808080">.</font>opPais then
   if sacao<font color="#808080">=</font>ctAcao<font color="#808080">.</font>opNovo then
     <font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font><font color="#000080"><b>Write</b></font><font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">))
     </font>tPais<font color="#808080">.</font>codigo <font color="#808080">= </font><font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font><font color="#000080"><b>In</b></font><font color="#808080">.</font>ReadLine<font color="#808080">()
     </font>slinha <font color="#808080">= </font>pesqArq<font color="#808080">(</font>tfPais<font color="#808080">, </font>tPais<font color="#808080">.</font>codigo<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">))
     </font>if slinha<font color="#808080">&lt;&gt;</font><font color="#800000">&quot;&quot; </font>then
       pesqLinhaExcluida<font color="#808080">(</font>tfPais<font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">))
       </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">)
       </font>subMenu<font color="#808080">(</font><font color="#FF0000">7</font><font color="#808080">, </font>sreg<font color="#808080">)
     </font>else 
       <font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font>MSG_REGEXST<font color="#808080">)
     </font>end if 
   elseif sacao<font color="#808080">=</font>ctAcao<font color="#808080">.</font>opPesquisar then
     slinha <font color="#808080">= </font>validaEntrada<font color="#808080">(</font>tfPais<font color="#808080">, </font>sreg<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font>tPais<font color="#808080">.</font>codigo<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#000080"><b>false</b></font><font color="#808080">, </font>ctTipo<font color="#808080">.</font>opTexto<font color="#808080">)
     </font>if slinha<font color="#808080">&lt;&gt;</font><font color="#800000">&quot;&quot; </font>then
       mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">)
       </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font>slinha<font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">)
       </font>subMenu<font color="#808080">(</font><font color="#FF0000">8</font><font color="#808080">, </font>sreg<font color="#808080">)
     </font>end if 
   elseif sacao<font color="#808080">=</font>ctAcao<font color="#808080">.</font>opAlterar then
     <font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">) + </font>tPais<font color="#808080">.</font>codigo<font color="#808080">)
     </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">)
     </font>subMenu<font color="#808080">(</font><font color="#FF0000">9</font><font color="#808080">, </font>sreg<font color="#808080">)
   </font>elseif sacao<font color="#808080">=</font>ctAcao<font color="#808080">.</font>opExcluir then
     subMenu<font color="#808080">(</font><font color="#FF0000">10</font><font color="#808080">, </font>sreg<font color="#808080">)
   </font>end if
elseif sreg<font color="#808080">=</font>ctArqs<font color="#808080">.</font>opProfissao then
   if sacao<font color="#808080">=</font>ctAcao<font color="#808080">.</font>opNovo then
     tProfissao<font color="#808080">.</font>codigo <font color="#808080">= </font>pesqMaxCod<font color="#808080">(</font>tfProfissao<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">))
     </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">)
     </font>subMenu<font color="#808080">(</font><font color="#FF0000">7</font><font color="#808080">, </font>sreg<font color="#808080">)
   </font>elseif sacao<font color="#808080">=</font>ctAcao<font color="#808080">.</font>opPesquisar then
     slinha <font color="#808080">= </font>validaEntrada<font color="#808080">(</font>tfProfissao<font color="#808080">,</font>sreg<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font>tProfissao<font color="#808080">.</font>codigo<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">, </font>_
              <font color="#000080"><b>false</b></font><font color="#808080">,</font>ctTipo<font color="#808080">.</font>opNumero<font color="#808080">)
     </font>if slinha<font color="#808080">&lt;&gt;</font><font color="#800000">&quot;&quot; </font>then
       mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">)
       </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font>slinha<font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">)
       </font>subMenu<font color="#808080">(</font><font color="#FF0000">8</font><font color="#808080">, </font>sreg<font color="#808080">)
     </font>end if
   elseif sacao<font color="#808080">=</font>ctAcao<font color="#808080">.</font>opAlterar then
     mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">)
     </font>subMenu<font color="#808080">(</font><font color="#FF0000">9</font><font color="#808080">, </font>sreg<font color="#808080">)
   </font>elseif sacao<font color="#808080">=</font>ctAcao<font color="#808080">.</font>opExcluir then
     subMenu<font color="#808080">(</font><font color="#FF0000">10</font><font color="#808080">, </font>sreg<font color="#808080">)
   </font>end if
elseif sreg<font color="#808080">=</font>ctArqs<font color="#808080">.</font>opLivro then
   if sacao<font color="#808080">=</font>ctAcao<font color="#808080">.</font>opNovo then
      <font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font><font color="#000080"><b>Write</b></font><font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">))
      </font>tLivro<font color="#808080">.</font>isbn <font color="#808080">= </font><font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font><font color="#000080"><b>In</b></font><font color="#808080">.</font>ReadLine<font color="#808080">()
      </font>if ValidaISBN<font color="#808080">(</font>tLivro<font color="#808080">.</font>isbn<font color="#808080">) </font>then
        slinha <font color="#808080">= </font>pesqArq<font color="#808080">(</font>tfLivro<font color="#808080">, </font>tLivro<font color="#808080">.</font>isbn<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">13</font><font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">))
        </font>if slinha<font color="#808080">=</font><font color="#800000">&quot;&quot; </font>then
          pesqLinhaExcluida<font color="#808080">(</font>tfLivro<font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">))
          </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">)
          </font>subMenu<font color="#808080">(</font><font color="#FF0000">7</font><font color="#808080">, </font>sreg<font color="#808080">)
          </font>frmCadLigados<font color="#808080">(</font>ctArqs<font color="#808080">.</font>opLivroAss<font color="#808080">, </font>ctAcao<font color="#808080">.</font>opNovo<font color="#808080">, </font>tLivro<font color="#808080">.</font>isbn<font color="#808080">)
          </font>frmCadLigados<font color="#808080">(</font>ctArqs<font color="#808080">.</font>opLivroAut<font color="#808080">, </font>ctAcao<font color="#808080">.</font>opNovo<font color="#808080">, </font>tLivro<font color="#808080">.</font>isbn<font color="#808080">)
        </font>else 
          <font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font>MSG_REGEXST<font color="#808080">)
        </font>end if
      else 
        <font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font>MSG_ISBNINV<font color="#808080">)
      </font>end if
   elseif sacao<font color="#808080">=</font>ctAcao<font color="#808080">.</font>opPesquisar then
      slinha <font color="#808080">= </font>validaEntrada<font color="#808080">(</font>tfLivro<font color="#808080">, </font>sreg<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font>tLivro<font color="#808080">.</font>isbn<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#000080"><b>false</b></font><font color="#808080">,</font>ctTipo<font color="#808080">.</font>opTexto<font color="#808080">)
      </font>if slinha<font color="#808080">&lt;&gt;</font><font color="#800000">&quot;&quot; </font>then
        mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">)
        </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font>slinha<font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">)
        </font>subMenu<font color="#808080">(</font><font color="#FF0000">8</font><font color="#808080">, </font>sreg<font color="#808080">)
      </font>end if
   elseif sacao<font color="#808080">=</font>ctAcao<font color="#808080">.</font>opAlterar then
      <font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">) + </font>tLivro<font color="#808080">.</font>isbn<font color="#808080">)
      </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">)
      </font>subMenu<font color="#808080">(</font><font color="#FF0000">9</font><font color="#808080">, </font>sreg<font color="#808080">)
      </font>frmCadLigados<font color="#808080">(</font>ctArqs<font color="#808080">.</font>opLivroAss<font color="#808080">, </font>ctAcao<font color="#808080">.</font>opExcluir<font color="#808080">, </font>tLivro<font color="#808080">.</font>isbn<font color="#808080">)
      </font><font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;Assuntos dos livros exclu&iacute;dos, inclua novos!&quot;</font><font color="#808080">)
      </font>frmCadLigados<font color="#808080">(</font>ctArqs<font color="#808080">.</font>opLivroAss<font color="#808080">, </font>ctAcao<font color="#808080">.</font>opNovo<font color="#808080">, </font>tLivro<font color="#808080">.</font>isbn<font color="#808080">)
      </font>frmCadLigados<font color="#808080">(</font>ctArqs<font color="#808080">.</font>opLivroAut<font color="#808080">, </font>ctAcao<font color="#808080">.</font>opExcluir<font color="#808080">, </font>tLivro<font color="#808080">.</font>isbn<font color="#808080">)
      </font><font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;Autores dos livros exclu&iacute;dos, inclua novos!&quot;</font><font color="#808080">)
      </font>frmCadLigados<font color="#808080">(</font>ctArqs<font color="#808080">.</font>opLivroAut<font color="#808080">, </font>ctAcao<font color="#808080">.</font>opNovo<font color="#808080">, </font>tLivro<font color="#808080">.</font>isbn<font color="#808080">)
   </font>elseif sacao<font color="#808080">=</font>ctAcao<font color="#808080">.</font>opExcluir then
      subMenu<font color="#808080">(</font><font color="#FF0000">10</font><font color="#808080">, </font>sreg<font color="#808080">)
      </font><font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;Assuntos dos livros sendo exclu&iacute;dos!&quot;</font><font color="#808080">)
      </font>frmCadLigados<font color="#808080">(</font>ctArqs<font color="#808080">.</font>opLivroAss<font color="#808080">, </font>ctAcao<font color="#808080">.</font>opExcluir<font color="#808080">, </font>tLivro<font color="#808080">.</font>isbn<font color="#808080">)
      </font><font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;Autores dos livros sendo exclu&iacute;dos!&quot;</font><font color="#808080">)
      </font>frmCadLigados<font color="#808080">(</font>ctArqs<font color="#808080">.</font>opLivroAut<font color="#808080">, </font>ctAcao<font color="#808080">.</font>opExcluir<font color="#808080">, </font>tLivro<font color="#808080">.</font>isbn<font color="#808080">)
   </font>end if
elseif sreg<font color="#808080">=</font>ctArqs<font color="#808080">.</font>opCliente then
   if sacao<font color="#808080">=</font>ctAcao<font color="#808080">.</font>opNovo then
      <font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font><font color="#000080"><b>Write</b></font><font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">))
      </font>tCliente<font color="#808080">.</font>cpf <font color="#808080">= </font><font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font><font color="#000080"><b>In</b></font><font color="#808080">.</font>ReadLine<font color="#808080">()
      </font>if ValidaCPF<font color="#808080">(</font>tCliente<font color="#808080">.</font>cpf<font color="#808080">) </font>then
        slinha <font color="#808080">= </font>pesqArq<font color="#808080">(</font>tfCliente<font color="#808080">, </font>tCliente<font color="#808080">.</font>cpf<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">14</font><font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">))
        </font>if slinha<font color="#808080">=</font><font color="#800000">&quot;&quot; </font>then
          pesqLinhaExcluida<font color="#808080">(</font>tfCliente<font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">))
          </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">)
          </font>subMenu<font color="#808080">(</font><font color="#FF0000">7</font><font color="#808080">, </font>sreg<font color="#808080">)
        </font>else 
          <font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font>MSG_REGEXST<font color="#808080">)
        </font>end if 
      else 
        <font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font>MSG_CPFINV<font color="#808080">)
      </font>end if 
   elseif sacao<font color="#808080">=</font>ctAcao<font color="#808080">.</font>opPesquisar then
      slinha <font color="#808080">= </font>validaEntrada<font color="#808080">(</font>tfCliente<font color="#808080">, </font>sreg<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font>tCliente<font color="#808080">.</font>cpf<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#000080"><b>false</b></font><font color="#808080">,</font>ctTipo<font color="#808080">.</font>opTexto<font color="#808080">)
      </font>if slinha<font color="#808080">&lt;&gt;</font><font color="#800000">&quot;&quot; </font>then
        mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">)
        </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font>slinha<font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">)
        </font>subMenu<font color="#808080">(</font><font color="#FF0000">8</font><font color="#808080">, </font>sreg<font color="#808080">)
      </font>end if
   elseif sacao<font color="#808080">=</font>ctAcao<font color="#808080">.</font>opAlterar then
      <font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">) + </font>tCliente<font color="#808080">.</font>cpf<font color="#808080">)
      </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">)
      </font>subMenu<font color="#808080">(</font><font color="#FF0000">9</font><font color="#808080">, </font>sreg<font color="#808080">)
   </font>elseif sacao<font color="#808080">=</font>ctAcao<font color="#808080">.</font>opExcluir then
      subMenu<font color="#808080">(</font><font color="#FF0000">10</font><font color="#808080">, </font>sreg<font color="#808080">)
   </font>end if
elseif sreg<font color="#808080">=</font>ctArqs<font color="#808080">.</font>opVenda then
   if sacao<font color="#808080">=</font>ctAcao<font color="#808080">.</font>opNovo then
      tVenda<font color="#808080">.</font>dthrvenda <font color="#808080">= </font>retDataHora<font color="#808080">()
      </font><font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">) + </font>tVenda<font color="#808080">.</font>dthrvenda<font color="#808080">)
      </font>slinha <font color="#808080">= </font>pesqArq<font color="#808080">(</font>tfVenda<font color="#808080">, </font>tVenda<font color="#808080">.</font>dthrvenda<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">19</font><font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">))
      </font>if slinha<font color="#808080">=</font><font color="#800000">&quot;&quot; </font>then
        slinha <font color="#808080">= </font>validaEntrada<font color="#808080">(</font>tfCliente<font color="#808080">,</font>ctArqs<font color="#808080">.</font>opCliente<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font>tVenda<font color="#808080">.</font>cpf<font color="#808080">,</font><font color="#FF0000">3</font><font color="#808080">, </font>_
        	 <font color="#000080"><b>false</b></font><font color="#808080">,</font>ctTipo<font color="#808080">.</font>opTexto<font color="#808080">)
        </font>if slinha<font color="#808080">&lt;&gt;</font><font color="#800000">&quot;&quot; </font>then
          tVenda<font color="#808080">.</font>cpf <font color="#808080">= </font>mid<font color="#808080">(</font>slinha<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#FF0000">14</font><font color="#808080">).</font><font color="#000080"><b>Trim</b></font><font color="#808080">()
          </font>if ValidaCPF<font color="#808080">(</font>tVenda<font color="#808080">.</font>cpf<font color="#808080">) </font>then
             <font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font><font color="#000080"><b>Write</b></font><font color="#808080">(</font><font color="#800000">&quot; &quot; </font><font color="#808080">+ </font>rotulo<font color="#808080">(</font>ctArqs<font color="#808080">.</font>opCliente<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">)) <i>'Nome
             </i></font><font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font>mid<font color="#808080">(</font>slinha<font color="#808080">, </font>g_nPosChave<font color="#808080">, </font>g_nTamChave<font color="#808080">))
             </font>frmCadLigados<font color="#808080">(</font>ctArqs<font color="#808080">.</font>opVenda<font color="#808080">, </font>ctAcao<font color="#808080">.</font>opNovo<font color="#808080">, </font>tVenda<font color="#808080">.</font>cpf<font color="#808080">)
          </font>else 
             <font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font>MSG_CPFINV<font color="#808080">)
          </font>end if
        end if
      else 
        <font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font>MSG_REGEXST<font color="#808080">)
      </font>end if 
   elseif sacao<font color="#808080">=</font>ctAcao<font color="#808080">.</font>opPesquisar then
      slinha <font color="#808080">= </font>validaEntrada<font color="#808080">(</font>tfVenda<font color="#808080">, </font>sreg<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font>tVenda<font color="#808080">.</font>dthrvenda<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">, </font>_
      	  <font color="#000080"><b>false</b></font><font color="#808080">,</font>ctTipo<font color="#808080">.</font>opDataHora<font color="#808080">)
      </font>if slinha<font color="#808080">&lt;&gt;</font><font color="#800000">&quot;&quot; </font>then
        mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">)
        </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font>slinha<font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">)
        </font>subMenu<font color="#808080">(</font><font color="#FF0000">8</font><font color="#808080">, </font>sreg<font color="#808080">)
      </font>end if
   end if
end if

end sub
<font color="#808080"><i>'------------------------------------------------------------------------------
'Realiza as consultas de acordo com o tipo de arquivo.
'sreg - o tipo de arquivo
'sacao - a a&ccedil;&atilde;o a ser realizada
'------------------------------------------------------------------------------
</i></font>sub frmConsultas<font color="#808080">(</font>sreg as ctArqs<font color="#808080">, </font>sacao as ctAcao<font color="#808080">)
 </font>dim slinha as string <font color="#808080">= </font><font color="#800000">&quot;&quot;

</font>if sreg<font color="#808080">=</font>ctArqs<font color="#808080">.</font>opAssunto then
  if sacao<font color="#808080">=</font>ctAcao<font color="#808080">.</font>opPesquisar then
    slinha <font color="#808080">= </font>validaEntrada<font color="#808080">(</font>tfAssunto<font color="#808080">,</font>sreg<font color="#808080">,</font><font color="#FF0000">2</font><font color="#808080">,</font>tAssunto<font color="#808080">.</font>assunto<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#000080"><b>true</b></font><font color="#808080">,</font>ctTipo<font color="#808080">.</font>opTexto<font color="#808080">)
  </font>elseif sacao<font color="#808080">=</font>ctAcao<font color="#808080">.</font>opListarTodos then
    if ListarTodos<font color="#808080">(</font>tfAssunto<font color="#808080">, </font>sreg<font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">), </font>_
                   QTD_MAX_LINHA<font color="#808080">, </font><font color="#000080"><b>false</b></font><font color="#808080">) = </font><font color="#000080"><b>false </b></font>then
      <font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">))
    </font>end if
  end if
elseif sreg<font color="#808080">=</font>ctArqs<font color="#808080">.</font>opAutor then
  if sacao<font color="#808080">=</font>ctAcao<font color="#808080">.</font>opPesquisar then
    slinha <font color="#808080">= </font>validaEntrada<font color="#808080">(</font>tfAutor<font color="#808080">,</font>sreg<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">, </font>tAutor<font color="#808080">.</font>autor<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#000080"><b>true</b></font><font color="#808080">,</font>ctTipo<font color="#808080">.</font>opTexto<font color="#808080">)
  </font>elseif sacao<font color="#808080">=</font>ctAcao<font color="#808080">.</font>opListarTodos then
    if ListarTodos<font color="#808080">(</font>tfAutor<font color="#808080">, </font>sreg<font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">), </font>_
                   QTD_MAX_LINHA<font color="#808080">, </font><font color="#000080"><b>false</b></font><font color="#808080">) = </font><font color="#000080"><b>false </b></font>then
      <font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">))
    </font>end if
  end if
elseif sreg<font color="#808080">=</font>ctArqs<font color="#808080">.</font>opEditora then
  if sacao<font color="#808080">=</font>ctAcao<font color="#808080">.</font>opPesquisar then
    slinha <font color="#808080">= </font>validaEntrada<font color="#808080">(</font>tfEditora<font color="#808080">,</font>sreg<font color="#808080">,</font><font color="#FF0000">2</font><font color="#808080">,</font>tEditora<font color="#808080">.</font>editora<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#000080"><b>true</b></font><font color="#808080">,</font>ctTipo<font color="#808080">.</font>opTexto<font color="#808080">)
  </font>elseif sacao<font color="#808080">=</font>ctAcao<font color="#808080">.</font>opListarTodos then
    if ListarTodos<font color="#808080">(</font>tfEditora<font color="#808080">, </font>sreg<font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">), </font>_
                   QTD_MAX_LINHA<font color="#808080">, </font><font color="#000080"><b>false</b></font><font color="#808080">) = </font><font color="#000080"><b>false </b></font>then
      <font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">))
    </font>end if
  end if
elseif sreg<font color="#808080">=</font>ctArqs<font color="#808080">.</font>opEndereco then
  if sacao<font color="#808080">=</font>ctAcao<font color="#808080">.</font>opPesquisar then
    slinha <font color="#808080">= </font>validaEntrada<font color="#808080">(</font>tfEndereco<font color="#808080">,</font>sreg<font color="#808080">,</font><font color="#FF0000">2</font><font color="#808080">,</font>tEndereco<font color="#808080">.</font>logradouro<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">, </font>_
    	  <font color="#000080"><b>true</b></font><font color="#808080">,</font>ctTipo<font color="#808080">.</font>opTexto<font color="#808080">)
  </font>elseif sacao<font color="#808080">=</font>ctAcao<font color="#808080">.</font>opListarTodos then
    if ListarTodos<font color="#808080">(</font>tfEndereco<font color="#808080">, </font>sreg<font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">), </font>_
       <font color="#FF0000">3</font><font color="#808080">, </font><font color="#000080"><b>false</b></font><font color="#808080">) = </font><font color="#000080"><b>false </b></font>then
      <font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">))
    </font>end if
  end if
elseif sreg<font color="#808080">=</font>ctArqs<font color="#808080">.</font>opIdioma then
  if sacao<font color="#808080">=</font>ctAcao<font color="#808080">.</font>opPesquisar then
    slinha <font color="#808080">= </font>validaEntrada<font color="#808080">(</font>tfIdioma<font color="#808080">, </font>sreg<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">, </font>tIdioma<font color="#808080">.</font>idioma<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#000080"><b>true</b></font><font color="#808080">,</font>ctTipo<font color="#808080">.</font>opTexto<font color="#808080">)
  </font>elseif sacao<font color="#808080">=</font>ctAcao<font color="#808080">.</font>opListarTodos then
    if ListarTodos<font color="#808080">(</font>tfIdioma<font color="#808080">, </font>sreg<font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">), </font>_
       QTD_MAX_LINHA<font color="#808080">, </font><font color="#000080"><b>false</b></font><font color="#808080">) = </font><font color="#000080"><b>false </b></font>then
      <font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">))
    </font>end if
  end if
elseif sreg<font color="#808080">=</font>ctArqs<font color="#808080">.</font>opPais then
  if sacao<font color="#808080">=</font>ctAcao<font color="#808080">.</font>opPesquisar then
    slinha <font color="#808080">= </font>validaEntrada<font color="#808080">(</font>tfPais<font color="#808080">, </font>sreg<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">, </font>tPais<font color="#808080">.</font>pais<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#000080"><b>true</b></font><font color="#808080">,</font>ctTipo<font color="#808080">.</font>opTexto<font color="#808080">)
  </font>elseif sacao<font color="#808080">=</font>ctAcao<font color="#808080">.</font>opListarTodos then
    if ListarTodos<font color="#808080">(</font>tfPais<font color="#808080">, </font>sreg<font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">), </font>_
                   QTD_MAX_LINHA<font color="#808080">, </font><font color="#000080"><b>false</b></font><font color="#808080">) = </font><font color="#000080"><b>false </b></font>then
      <font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">))
    </font>end if 
  end if
elseif sreg<font color="#808080">=</font>ctArqs<font color="#808080">.</font>opProfissao then
  if sacao<font color="#808080">=</font>ctAcao<font color="#808080">.</font>opPesquisar then
    slinha <font color="#808080">= </font>validaEntrada<font color="#808080">(</font>tfProfissao<font color="#808080">,</font>sreg<font color="#808080">,</font><font color="#FF0000">2</font><font color="#808080">,</font>tProfissao<font color="#808080">.</font>profissao<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">, </font>_
    	 <font color="#000080"><b>true</b></font><font color="#808080">,</font>ctTipo<font color="#808080">.</font>opTexto<font color="#808080">)
  </font>elseif sacao<font color="#808080">=</font>ctAcao<font color="#808080">.</font>opListarTodos then
    if ListarTodos<font color="#808080">(</font>tfProfissao<font color="#808080">, </font>sreg<font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">), </font>_
                   QTD_MAX_LINHA<font color="#808080">, </font><font color="#000080"><b>false</b></font><font color="#808080">) = </font><font color="#000080"><b>false </b></font>then
      <font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">))
    </font>end if
  end if
elseif sreg<font color="#808080">=</font>ctArqs<font color="#808080">.</font>opLivro then
  if sacao<font color="#808080">=</font>ctAcao<font color="#808080">.</font>opPesquisar then
    slinha <font color="#808080">= </font>validaEntrada<font color="#808080">(</font>tfLivro<font color="#808080">, </font>sreg<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">, </font>tLivro<font color="#808080">.</font>titulo<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#000080"><b>true</b></font><font color="#808080">,</font>ctTipo<font color="#808080">.</font>opTexto<font color="#808080">)
  </font>elseif sacao<font color="#808080">=</font>ctAcao<font color="#808080">.</font>opListarTodos then
    if ListarTodos<font color="#808080">(</font>tfLivro<font color="#808080">, </font>sreg<font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">), </font>_
                  <font color="#FF0000">1</font><font color="#808080">, </font><font color="#000080"><b>false</b></font><font color="#808080">) = </font><font color="#000080"><b>false </b></font>then
      <font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">))
    </font>end if
  end if
elseif sreg<font color="#808080">=</font>ctArqs<font color="#808080">.</font>opCliente then
  if sacao<font color="#808080">=</font>ctAcao<font color="#808080">.</font>opPesquisar then
    slinha <font color="#808080">= </font>validaEntrada<font color="#808080">(</font>tfCliente<font color="#808080">, </font>sreg<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">, </font>tCliente<font color="#808080">.</font>nome<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#000080"><b>true</b></font><font color="#808080">,</font>ctTipo<font color="#808080">.</font>opTexto<font color="#808080">)
  </font>elseif sacao<font color="#808080">=</font>ctAcao<font color="#808080">.</font>opListarTodos then
    if ListarTodos<font color="#808080">(</font>tfCliente<font color="#808080">, </font>sreg<font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">), </font>_
                   <font color="#FF0000">1</font><font color="#808080">, </font><font color="#000080"><b>false</b></font><font color="#808080">) = </font><font color="#000080"><b>false </b></font>then
      <font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">))
    </font>end if
  end if
elseif sreg<font color="#808080">=</font>ctArqs<font color="#808080">.</font>opVenda then
  if sacao<font color="#808080">=</font>ctAcao<font color="#808080">.</font>opPesquisar then
    slinha <font color="#808080">= </font>validaEntrada<font color="#808080">(</font>tfVenda<font color="#808080">, </font>sreg<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">, </font>tVenda<font color="#808080">.</font>cpf<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#000080"><b>true</b></font><font color="#808080">,</font>ctTipo<font color="#808080">.</font>opTexto<font color="#808080">)
  </font>elseif sacao<font color="#808080">=</font>ctAcao<font color="#808080">.</font>opListarTodos then
    if ListarTodos<font color="#808080">(</font>tfVenda<font color="#808080">, </font>sreg<font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">), </font>_
                   QTD_MAX_LINHA<font color="#808080">, </font><font color="#000080"><b>false</b></font><font color="#808080">) = </font><font color="#000080"><b>false </b></font>then
      <font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">))
    </font>end if
  end if
end if
if slinha<font color="#808080">=</font><font color="#800000">&quot;&quot; </font>then
   <font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font><font color="#000080"><b>Write</b></font><font color="#808080">(</font><font color="#800000">&quot;&quot;</font><font color="#808080">)
</font>end if
end sub
<font color="#808080"><i>'------------------------------------------------------------------------------
'Mostra a tela de altera&ccedil;&atilde;o de senha do sistema e realiza a altera&ccedil;&atilde;o.
'------------------------------------------------------------------------------
</i></font>sub frmAlterarSenha<font color="#808080">()
</font>dim bQuebra as <font color="#000080"><b>Boolean
</b></font>dim sres<font color="#808080">, </font>sSenhaAtual<font color="#808080">, </font>sNovaSenha<font color="#808080">, </font>sConfirmaSenha as string
dim nopcao as integer

sSenhaAtual <font color="#808080">= </font><font color="#800000">&quot;&quot;
</font>sNovaSenha <font color="#808080">= </font><font color="#800000">&quot;&quot;
</font>sConfirmaSenha <font color="#808080">= </font><font color="#800000">&quot;&quot;

</font><font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font>rotulo<font color="#808080">(</font>ctArqs<font color="#808080">.</font>opUsuario<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">) + </font>tUsuario<font color="#808080">.</font>login<font color="#808080">)
</font>nopcao <font color="#808080">= </font><font color="#FF0000">1
</font>bQuebra <font color="#808080">= </font><font color="#000080"><b>false
</b></font>while bQuebra<font color="#808080">=</font><font color="#000080"><b>false
  </b></font>select case nopcao
   case <font color="#FF0000">1
      </font>sSenhaAtual <font color="#808080">= </font>digitaSenha<font color="#808080">(</font><font color="#800000">&quot;Senha Atual: &quot;</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">)
      </font>if sSenhaAtual<font color="#808080">&lt;&gt;</font>tUsuario<font color="#808080">.</font>senha then
        <font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font>MSG_SENCONFERE<font color="#808080">)
        </font>bQuebra <font color="#808080">= </font><font color="#000080"><b>true
      </b></font>else 
        nopcao <font color="#808080">= </font><font color="#FF0000">2
      </font>end if
   case <font color="#FF0000">2
      </font>sNovaSenha <font color="#808080">= </font>digitaSenha<font color="#808080">(</font><font color="#800000">&quot;Nova Senha: &quot;</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">)
      </font>sConfirmaSenha <font color="#808080">= </font>digitaSenha<font color="#808080">(</font><font color="#800000">&quot;Confirma Senha: &quot;</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">)
      </font>if sNovaSenha<font color="#808080">&lt;&gt;</font>sConfirmaSenha then
        <font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font>MSG_SENCONFIRM<font color="#808080">)
        </font>bQuebra <font color="#808080">= </font><font color="#000080"><b>true
      </b></font>else 
        nopcao <font color="#808080">= </font><font color="#FF0000">3
      </font>end if
   case <font color="#FF0000">3
      </font>sres <font color="#808080">= </font>pesqArq<font color="#808080">(</font>tfUsuario<font color="#808080">, </font>tUsuario<font color="#808080">.</font>login<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">, </font>tamReg<font color="#808080">(</font>ctArqs<font color="#808080">.</font>opUsuario<font color="#808080">))
      </font>if sres<font color="#808080">=</font><font color="#800000">&quot;&quot; </font>then
        <font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font>MSG_LOGINENCON<font color="#808080">)
      </font>else 
        tUsuario<font color="#808080">.</font>senha <font color="#808080">= </font>sConfirmaSenha
        subMenu<font color="#808080">(</font><font color="#FF0000">9</font><font color="#808080">,</font>ctArqs<font color="#808080">.</font>opUsuario<font color="#808080">)
        </font>bQuebra <font color="#808080">= </font><font color="#000080"><b>true
      </b></font>end if  
  end select
end while
end sub
<font color="#808080"><i>'------------------------------------------------------------------------------
'Executa uma a&ccedil;&atilde;o de grava&ccedil;&atilde;o de acordo com o tipo de arquivo.
'sreg - o tipo de arquivo
'sacao - a a&ccedil;&atilde;o a ser realizada
'------------------------------------------------------------------------------
</i></font>sub btnAcao<font color="#808080">(</font>sreg as ctArqs<font color="#808080">, </font>sacao as ctAcao<font color="#808080">)
</font>if sreg<font color="#808080">=</font>ctArqs<font color="#808080">.</font>opAssunto then
   if sacao<font color="#808080">=</font>ctAcao<font color="#808080">.</font>opSalvarInclusao then
	  escreveArq<font color="#808080">(</font>tfAssunto<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGINC<font color="#808080">, </font>MSG_REGNINC<font color="#808080">)
   </font>elseif sacao<font color="#808080">=</font>ctAcao<font color="#808080">.</font>opSalvarAlteracao then
	  escreveArq<font color="#808080">(</font>tfAssunto<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGALT<font color="#808080">, </font>MSG_REGNALT<font color="#808080">)
   </font>elseif sacao<font color="#808080">=</font>ctAcao<font color="#808080">.</font>opConfirmaExclusao then
	  escreveArq<font color="#808080">(</font>tfAssunto<font color="#808080">, </font>repete<font color="#808080">(</font><font color="#800000">&quot;*&quot;</font><font color="#808080">,</font>tamReg<font color="#808080">(</font>sreg<font color="#808080">)), </font>MSG_REGEXC<font color="#808080">, </font>MSG_REGNEXC<font color="#808080">)
   </font>end if
elseif sreg<font color="#808080">=</font>ctArqs<font color="#808080">.</font>opAutor then
   if sacao<font color="#808080">=</font>ctAcao<font color="#808080">.</font>opSalvarInclusao then
	  escreveArq<font color="#808080">(</font>tfAutor<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGINC<font color="#808080">, </font>MSG_REGNINC<font color="#808080">)
   </font>elseif sacao<font color="#808080">=</font>ctAcao<font color="#808080">.</font>opSalvarAlteracao then
	  escreveArq<font color="#808080">(</font>tfAutor<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGALT<font color="#808080">, </font>MSG_REGNALT<font color="#808080">)
   </font>elseif sacao<font color="#808080">=</font>ctAcao<font color="#808080">.</font>opConfirmaExclusao then
	  escreveArq<font color="#808080">(</font>tfAutor<font color="#808080">, </font>repete<font color="#808080">(</font><font color="#800000">&quot;*&quot;</font><font color="#808080">,</font>tamReg<font color="#808080">(</font>sreg<font color="#808080">)), </font>MSG_REGEXC<font color="#808080">, </font>MSG_REGNEXC<font color="#808080">)
   </font>end if
elseif sreg<font color="#808080">=</font>ctArqs<font color="#808080">.</font>opEditora then
   if sacao<font color="#808080">=</font>ctAcao<font color="#808080">.</font>opSalvarInclusao then
	  escreveArq<font color="#808080">(</font>tfEditora<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGINC<font color="#808080">, </font>MSG_REGNINC<font color="#808080">)
   </font>elseif sacao<font color="#808080">=</font>ctAcao<font color="#808080">.</font>opSalvarAlteracao then
	  escreveArq<font color="#808080">(</font>tfEditora<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGALT<font color="#808080">, </font>MSG_REGNALT<font color="#808080">)
   </font>elseif sacao<font color="#808080">=</font>ctAcao<font color="#808080">.</font>opConfirmaExclusao then
	  escreveArq<font color="#808080">(</font>tfEditora<font color="#808080">, </font>repete<font color="#808080">(</font><font color="#800000">&quot;*&quot;</font><font color="#808080">,</font>tamReg<font color="#808080">(</font>sreg<font color="#808080">)), </font>MSG_REGEXC<font color="#808080">, </font>MSG_REGNEXC<font color="#808080">)
   </font>end if
elseif sreg<font color="#808080">=</font>ctArqs<font color="#808080">.</font>opEndereco then
   if sacao<font color="#808080">=</font>ctAcao<font color="#808080">.</font>opSalvarInclusao then
	  escreveArq<font color="#808080">(</font>tfEndereco<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGINC<font color="#808080">, </font>MSG_REGNINC<font color="#808080">)
   </font>elseif sacao<font color="#808080">=</font>ctAcao<font color="#808080">.</font>opSalvarAlteracao then
	  escreveArq<font color="#808080">(</font>tfEndereco<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGALT<font color="#808080">, </font>MSG_REGNALT<font color="#808080">)
   </font>elseif sacao<font color="#808080">=</font>ctAcao<font color="#808080">.</font>opConfirmaExclusao then
	  escreveArq<font color="#808080">(</font>tfEndereco<font color="#808080">, </font>repete<font color="#808080">(</font><font color="#800000">&quot;*&quot;</font><font color="#808080">,</font>tamReg<font color="#808080">(</font>sreg<font color="#808080">)), </font>MSG_REGEXC<font color="#808080">, </font>MSG_REGNEXC<font color="#808080">)
   </font>end if
elseif sreg<font color="#808080">=</font>ctArqs<font color="#808080">.</font>opIdioma then
   if sacao<font color="#808080">=</font>ctAcao<font color="#808080">.</font>opSalvarInclusao then
	  escreveArq<font color="#808080">(</font>tfIdioma<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGINC<font color="#808080">, </font>MSG_REGNINC<font color="#808080">)
   </font>elseif sacao<font color="#808080">=</font>ctAcao<font color="#808080">.</font>opSalvarAlteracao then
	  escreveArq<font color="#808080">(</font>tfIdioma<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGALT<font color="#808080">, </font>MSG_REGNALT<font color="#808080">)
   </font>elseif sacao<font color="#808080">=</font>ctAcao<font color="#808080">.</font>opConfirmaExclusao then
	  escreveArq<font color="#808080">(</font>tfIdioma<font color="#808080">, </font>repete<font color="#808080">(</font><font color="#800000">&quot;*&quot;</font><font color="#808080">,</font>tamReg<font color="#808080">(</font>sreg<font color="#808080">)), </font>MSG_REGEXC<font color="#808080">, </font>MSG_REGNEXC<font color="#808080">)
   </font>end if
elseif sreg<font color="#808080">=</font>ctArqs<font color="#808080">.</font>opPais then
   if sacao<font color="#808080">=</font>ctAcao<font color="#808080">.</font>opSalvarInclusao then
	  escreveArq<font color="#808080">(</font>tfPais<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGINC<font color="#808080">, </font>MSG_REGNINC<font color="#808080">)
   </font>elseif sacao<font color="#808080">=</font>ctAcao<font color="#808080">.</font>opSalvarAlteracao then
	  escreveArq<font color="#808080">(</font>tfPais<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGALT<font color="#808080">, </font>MSG_REGNALT<font color="#808080">)
   </font>elseif sacao<font color="#808080">=</font>ctAcao<font color="#808080">.</font>opConfirmaExclusao then
	  escreveArq<font color="#808080">(</font>tfPais<font color="#808080">, </font>repete<font color="#808080">(</font><font color="#800000">&quot;*&quot;</font><font color="#808080">,</font>tamReg<font color="#808080">(</font>sreg<font color="#808080">)), </font>MSG_REGEXC<font color="#808080">, </font>MSG_REGNEXC<font color="#808080">)
   </font>end if
elseif sreg<font color="#808080">=</font>ctArqs<font color="#808080">.</font>opProfissao then
   if sacao<font color="#808080">=</font>ctAcao<font color="#808080">.</font>opSalvarInclusao then
	  escreveArq<font color="#808080">(</font>tfProfissao<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGINC<font color="#808080">, </font>MSG_REGNINC<font color="#808080">)
   </font>elseif sacao<font color="#808080">=</font>ctAcao<font color="#808080">.</font>opSalvarAlteracao then
	  escreveArq<font color="#808080">(</font>tfProfissao<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGALT<font color="#808080">, </font>MSG_REGNALT<font color="#808080">)
   </font>elseif sacao<font color="#808080">=</font>ctAcao<font color="#808080">.</font>opConfirmaExclusao then
	 escreveArq<font color="#808080">(</font>tfProfissao<font color="#808080">, </font>repete<font color="#808080">(</font><font color="#800000">&quot;*&quot;</font><font color="#808080">,</font>tamReg<font color="#808080">(</font>sreg<font color="#808080">)), </font>MSG_REGEXC<font color="#808080">, </font>MSG_REGNEXC<font color="#808080">)
   </font>end if
elseif sreg<font color="#808080">=</font>ctArqs<font color="#808080">.</font>opLivro then
   if sacao<font color="#808080">=</font>ctAcao<font color="#808080">.</font>opSalvarInclusao then
	  escreveArq<font color="#808080">(</font>tfLivro<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGINC<font color="#808080">, </font>MSG_REGNINC<font color="#808080">)
   </font>elseif sacao<font color="#808080">=</font>ctAcao<font color="#808080">.</font>opSalvarAlteracao then
	  escreveArq<font color="#808080">(</font>tfLivro<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGALT<font color="#808080">, </font>MSG_REGNALT<font color="#808080">)
   </font>elseif sacao<font color="#808080">=</font>ctAcao<font color="#808080">.</font>opConfirmaExclusao then
	  escreveArq<font color="#808080">(</font>tfLivro<font color="#808080">, </font>repete<font color="#808080">(</font><font color="#800000">&quot;*&quot;</font><font color="#808080">,</font>tamReg<font color="#808080">(</font>sreg<font color="#808080">)), </font>MSG_REGEXC<font color="#808080">, </font>MSG_REGNEXC<font color="#808080">)
   </font>end if
elseif sreg<font color="#808080">=</font>ctArqs<font color="#808080">.</font>opLivroAss then
   if sacao<font color="#808080">=</font>ctAcao<font color="#808080">.</font>opSalvarInclusao then
	  escreveArq<font color="#808080">(</font>tfLivroAss<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGINC<font color="#808080">, </font>MSG_REGNINC<font color="#808080">)
   </font>elseif sacao<font color="#808080">=</font>ctAcao<font color="#808080">.</font>opSalvarAlteracao then
	  escreveArq<font color="#808080">(</font>tfLivroAss<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGALT<font color="#808080">, </font>MSG_REGNALT<font color="#808080">)
   </font>elseif sacao<font color="#808080">=</font>ctAcao<font color="#808080">.</font>opConfirmaExclusao then
	  escreveArq<font color="#808080">(</font>tfLivroAss<font color="#808080">, </font>repete<font color="#808080">(</font><font color="#800000">&quot;*&quot;</font><font color="#808080">,</font>tamReg<font color="#808080">(</font>sreg<font color="#808080">)), </font>MSG_REGEXC<font color="#808080">, </font>MSG_REGNEXC<font color="#808080">)
   </font>end if
elseif sreg<font color="#808080">=</font>ctArqs<font color="#808080">.</font>opLivroAut then
   if sacao<font color="#808080">=</font>ctAcao<font color="#808080">.</font>opSalvarInclusao then
	  escreveArq<font color="#808080">(</font>tfLivroAut<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGINC<font color="#808080">, </font>MSG_REGNINC<font color="#808080">)
   </font>elseif sacao<font color="#808080">=</font>ctAcao<font color="#808080">.</font>opSalvarAlteracao then
	  escreveArq<font color="#808080">(</font>tfLivroAut<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGALT<font color="#808080">, </font>MSG_REGNALT<font color="#808080">)
   </font>elseif sacao<font color="#808080">=</font>ctAcao<font color="#808080">.</font>opConfirmaExclusao then
	  escreveArq<font color="#808080">(</font>tfLivroAut<font color="#808080">, </font>repete<font color="#808080">(</font><font color="#800000">&quot;*&quot;</font><font color="#808080">,</font>tamReg<font color="#808080">(</font>sreg<font color="#808080">)), </font>MSG_REGEXC<font color="#808080">, </font>MSG_REGNEXC<font color="#808080">)
   </font>end if
elseif sreg<font color="#808080">=</font>ctArqs<font color="#808080">.</font>opCliente then
   if sacao<font color="#808080">=</font>ctAcao<font color="#808080">.</font>opSalvarInclusao then
	  escreveArq<font color="#808080">(</font>tfCliente<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGINC<font color="#808080">, </font>MSG_REGNINC<font color="#808080">)
   </font>elseif sacao<font color="#808080">=</font>ctAcao<font color="#808080">.</font>opSalvarAlteracao then
	  escreveArq<font color="#808080">(</font>tfCliente<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGALT<font color="#808080">, </font>MSG_REGNALT<font color="#808080">)
   </font>elseif sacao<font color="#808080">=</font>ctAcao<font color="#808080">.</font>opConfirmaExclusao then
	  escreveArq<font color="#808080">(</font>tfCliente<font color="#808080">, </font>repete<font color="#808080">(</font><font color="#800000">&quot;*&quot;</font><font color="#808080">,</font>tamReg<font color="#808080">(</font>sreg<font color="#808080">)), </font>MSG_REGEXC<font color="#808080">, </font>MSG_REGNEXC<font color="#808080">)
   </font>end if
elseif sreg<font color="#808080">=</font>ctArqs<font color="#808080">.</font>opVenda then
   if sacao<font color="#808080">=</font>ctAcao<font color="#808080">.</font>opSalvarInclusao then
	  escreveArq<font color="#808080">(</font>tfVenda<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGINC<font color="#808080">, </font>MSG_REGNINC<font color="#808080">)
   </font>elseif sacao<font color="#808080">=</font>ctAcao<font color="#808080">.</font>opSalvarAlteracao then
	  escreveArq<font color="#808080">(</font>tfVenda<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGALT<font color="#808080">, </font>MSG_REGNALT<font color="#808080">)
   </font>elseif sacao<font color="#808080">=</font>ctAcao<font color="#808080">.</font>opConfirmaExclusao then
	  escreveArq<font color="#808080">(</font>tfVenda<font color="#808080">, </font>repete<font color="#808080">(</font><font color="#800000">&quot;*&quot;</font><font color="#808080">,</font>tamReg<font color="#808080">(</font>sreg<font color="#808080">)), </font>MSG_REGEXC<font color="#808080">, </font>MSG_REGNEXC<font color="#808080">)
   </font>end if
elseif sreg<font color="#808080">=</font>ctArqs<font color="#808080">.</font>opUsuario then
   if sacao<font color="#808080">=</font>ctAcao<font color="#808080">.</font>opSalvarAlteracao then
	  escreveArq<font color="#808080">(</font>tfUsuario<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGALT<font color="#808080">, </font>MSG_REGNALT<font color="#808080">)
   </font>end if
end if
end sub
<font color="#808080"><i>'------------------------------------------------------------------------------
'Seleciona o menu e/ou a tela certa de acordo com o tipo de arquivo.
'nmenu - o n&uacute;mero do menu
'sreg - o tipo de arquivo
'------------------------------------------------------------------------------
</i></font>sub subMenu<font color="#808080">(</font>nmenu as integer<font color="#808080">, </font>sreg as ctArqs<font color="#808080">)
</font>dim opSubMenu as string
dim opCSubMenu as char
dim bSOp as <font color="#000080"><b>Boolean

</b></font>bSOp <font color="#808080">= </font><font color="#000080"><b>true
</b></font>select case nmenu
 case <font color="#FF0000">6
    </font>while bSOp
      menu<font color="#808080">(</font>nmenu<font color="#808080">)
      </font>opSubMenu <font color="#808080">= </font><font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font><font color="#000080"><b>In</b></font><font color="#808080">.</font>ReadLine<font color="#808080">()
      </font>select case opSubMenu
        case <font color="#800000">&quot;1&quot;
          </font>frmCadastros<font color="#808080">(</font>sreg<font color="#808080">, </font>ctAcao<font color="#808080">.</font>opNovo<font color="#808080">)
        </font>case <font color="#800000">&quot;2&quot; 
          </font>frmCadastros<font color="#808080">(</font>sreg<font color="#808080">, </font>ctAcao<font color="#808080">.</font>opPesquisar<font color="#808080">)
        </font>case <font color="#800000">&quot;3&quot; 
          </font>bSOp <font color="#808080">= </font><font color="#000080"><b>false
        </b></font>case else 
          <font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font>MSG_ERRO<font color="#808080">)
      </font>end select
    end while
 case <font color="#FF0000">7
    </font>while bSOp
      menu<font color="#808080">(</font>nmenu<font color="#808080">)
      </font>opSubMenu <font color="#808080">= </font><font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font><font color="#000080"><b>In</b></font><font color="#808080">.</font>ReadLine<font color="#808080">()
      </font>select case opSubMenu
        case <font color="#800000">&quot;1&quot;
          </font>btnAcao<font color="#808080">(</font>sreg<font color="#808080">, </font>ctAcao<font color="#808080">.</font>opSalvarInclusao<font color="#808080">) 
          </font>bSOp <font color="#808080">= </font><font color="#000080"><b>false 
        </b></font>case <font color="#800000">&quot;2&quot;
          </font>bSOp <font color="#808080">= </font><font color="#000080"><b>false
        </b></font>case else 
          <font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font>MSG_ERRO<font color="#808080">)
      </font>end select
    end while
 case <font color="#FF0000">8
    </font>while bSOp
      menu<font color="#808080">(</font>nmenu<font color="#808080">)
      </font>opSubMenu <font color="#808080">= </font><font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font><font color="#000080"><b>In</b></font><font color="#808080">.</font>ReadLine<font color="#808080">()
      </font>select case opSubMenu
	case <font color="#800000">&quot;1&quot;
          </font>frmCadastros<font color="#808080">(</font>sreg<font color="#808080">, </font>ctAcao<font color="#808080">.</font>opAlterar<font color="#808080">) 
          </font>bSOp <font color="#808080">= </font><font color="#000080"><b>false 
</b></font>	case <font color="#800000">&quot;2&quot;
          </font>frmCadastros<font color="#808080">(</font>sreg<font color="#808080">, </font>ctAcao<font color="#808080">.</font>opExcluir<font color="#808080">) 
          </font>bSOp <font color="#808080">= </font><font color="#000080"><b>false 
</b></font>	case <font color="#800000">&quot;3&quot;
          </font>bSOp <font color="#808080">= </font><font color="#000080"><b>false
        </b></font>case else 
          <font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font>MSG_ERRO<font color="#808080">)
      </font>end select
    end while
 case <font color="#FF0000">9
    </font>while bSOp
      menu<font color="#808080">(</font>nmenu<font color="#808080">)
      </font>opSubMenu <font color="#808080">= </font><font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font><font color="#000080"><b>In</b></font><font color="#808080">.</font>ReadLine<font color="#808080">()
      </font>select case opSubMenu
        case <font color="#800000">&quot;1&quot;
          </font>btnAcao<font color="#808080">(</font>sreg<font color="#808080">, </font>ctAcao<font color="#808080">.</font>opSalvarAlteracao<font color="#808080">) 
          </font>bSOp <font color="#808080">= </font><font color="#000080"><b>false 
        </b></font>case <font color="#800000">&quot;2&quot;
          </font>bSOp <font color="#808080">= </font><font color="#000080"><b>false
        </b></font>case else 
          <font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font>MSG_ERRO<font color="#808080">)
      </font>end select
    end while
 case <font color="#FF0000">10
    </font>while bSOp
      menu<font color="#808080">(</font>nmenu<font color="#808080">)
      </font>opCSubMenu <font color="#808080">= </font>GetChar<font color="#808080">(</font><font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font><font color="#000080"><b>In</b></font><font color="#808080">.</font>ReadLine<font color="#808080">(),</font><font color="#FF0000">1</font><font color="#808080">)
      </font>if <font color="#808080">(</font>opCSubMenu<font color="#808080">=</font><font color="#800000">&quot;S&quot;</font>C<font color="#808080">) </font>or <font color="#808080">(</font>opCSubMenu<font color="#808080">=</font><font color="#800000">&quot;s&quot;</font>C<font color="#808080">) </font>then
        btnAcao<font color="#808080">(</font>sreg<font color="#808080">, </font>ctAcao<font color="#808080">.</font>opConfirmaExclusao<font color="#808080">)
        </font>bSOp <font color="#808080">= </font><font color="#000080"><b>false
      </b></font>elseif <font color="#808080">(</font>opCSubMenu<font color="#808080">=</font><font color="#800000">&quot;N&quot;</font>C<font color="#808080">) </font>or <font color="#808080">(</font>opCSubMenu<font color="#808080">=</font><font color="#800000">&quot;n&quot;</font>C<font color="#808080">) </font>then
        bSOp <font color="#808080">= </font><font color="#000080"><b>false
      </b></font>else 
        <font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font>MSG_ERRO<font color="#808080">)
      </font>end if
    end while
 case <font color="#FF0000">12
    </font>while bSOp
      menu<font color="#808080">(</font>nmenu<font color="#808080">)
      </font>opSubMenu <font color="#808080">= </font><font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font><font color="#000080"><b>In</b></font><font color="#808080">.</font>ReadLine<font color="#808080">()
      </font>select case opSubMenu
        case <font color="#800000">&quot;1&quot;
          </font>frmConsultas<font color="#808080">(</font>sreg<font color="#808080">, </font>ctAcao<font color="#808080">.</font>opPesquisar<font color="#808080">)
        </font>case <font color="#800000">&quot;2&quot;
          </font>frmConsultas<font color="#808080">(</font>sreg<font color="#808080">, </font>ctAcao<font color="#808080">.</font>opListarTodos<font color="#808080">)
        </font>case <font color="#800000">&quot;3&quot;
          </font>bSOp <font color="#808080">= </font><font color="#000080"><b>false
        </b></font>case else 
          <font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font>MSG_ERRO<font color="#808080">)
      </font>end select
    end while
 case <font color="#FF0000">14
    </font>while bSOp
      menu<font color="#808080">(</font>nmenu<font color="#808080">)
      </font>opCSubMenu <font color="#808080">= </font>GetChar<font color="#808080">(</font><font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font><font color="#000080"><b>In</b></font><font color="#808080">.</font>ReadLine<font color="#808080">(),</font><font color="#FF0000">1</font><font color="#808080">)
      </font>if <font color="#808080">(</font>opCSubMenu<font color="#808080">=</font><font color="#800000">&quot;S&quot;</font>C<font color="#808080">) </font>or <font color="#808080">(</font>opCSubMenu<font color="#808080">=</font><font color="#800000">&quot;s&quot;</font>C<font color="#808080">) </font>then
        btnAcao<font color="#808080">(</font>sreg<font color="#808080">, </font>ctAcao<font color="#808080">.</font>opSalvarInclusao<font color="#808080">)
        </font>bSOp <font color="#808080">= </font><font color="#000080"><b>false
        </b></font>g_SalvarInclusao <font color="#808080">= </font><font color="#000080"><b>true
      </b></font>elseif <font color="#808080">(</font>opCSubMenu<font color="#808080">=</font><font color="#800000">&quot;N&quot;</font>C<font color="#808080">) </font>or <font color="#808080">(</font>opCSubMenu<font color="#808080">=</font><font color="#800000">&quot;n&quot;</font>C<font color="#808080">) </font>then
        bSOp <font color="#808080">= </font><font color="#000080"><b>false
      </b></font>else 
        <font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font>MSG_ERRO<font color="#808080">)
      </font>end if 
    end while
end select

end sub
<font color="#808080"><i>'------------------------------------------------------------------------------
'Seleciona o submenu e/ou a tela certa de acordo com n&uacute;mero do menu.
'nmenu - o n&uacute;mero do menu
'------------------------------------------------------------------------------
</i></font>sub usaMenu<font color="#808080">(</font>num as integer<font color="#808080">)
</font>dim opSubMenu as string
dim bSOp as <font color="#000080"><b>Boolean
</b></font>dim opSair as char

 bSOp <font color="#808080">= </font><font color="#000080"><b>true
 </b></font>if num <font color="#808080">= </font><font color="#FF0000">1 </font>then <font color="#808080"><i>'Cadastros
   </i></font>while bSOp
      menu<font color="#808080">(</font><font color="#FF0000">2</font><font color="#808080">)
      </font>opSubMenu <font color="#808080">= </font><font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font><font color="#000080"><b>In</b></font><font color="#808080">.</font>ReadLine<font color="#808080">()
      </font>select case opSubMenu
        case <font color="#800000">&quot;1&quot;
          </font>subMenu<font color="#808080">(</font><font color="#FF0000">6</font><font color="#808080">, </font>ctArqs<font color="#808080">.</font>opAssunto<font color="#808080">)
        </font>case <font color="#800000">&quot;2&quot;
          </font>subMenu<font color="#808080">(</font><font color="#FF0000">6</font><font color="#808080">, </font>ctArqs<font color="#808080">.</font>opAutor<font color="#808080">)
        </font>case <font color="#800000">&quot;3&quot;
          </font>subMenu<font color="#808080">(</font><font color="#FF0000">6</font><font color="#808080">, </font>ctArqs<font color="#808080">.</font>opEditora<font color="#808080">)
        </font>case <font color="#800000">&quot;4&quot;
          </font>subMenu<font color="#808080">(</font><font color="#FF0000">6</font><font color="#808080">, </font>ctArqs<font color="#808080">.</font>opEndereco<font color="#808080">)
        </font>case <font color="#800000">&quot;5&quot;
          </font>subMenu<font color="#808080">(</font><font color="#FF0000">6</font><font color="#808080">, </font>ctArqs<font color="#808080">.</font>opIdioma<font color="#808080">)
        </font>case <font color="#800000">&quot;6&quot;
          </font>subMenu<font color="#808080">(</font><font color="#FF0000">6</font><font color="#808080">, </font>ctArqs<font color="#808080">.</font>opPais<font color="#808080">)
        </font>case <font color="#800000">&quot;7&quot;
          </font>subMenu<font color="#808080">(</font><font color="#FF0000">6</font><font color="#808080">, </font>ctArqs<font color="#808080">.</font>opProfissao<font color="#808080">)
        </font>case <font color="#800000">&quot;8&quot;
          </font>subMenu<font color="#808080">(</font><font color="#FF0000">6</font><font color="#808080">, </font>ctArqs<font color="#808080">.</font>opCliente<font color="#808080">)
        </font>case <font color="#800000">&quot;9&quot;
          </font>subMenu<font color="#808080">(</font><font color="#FF0000">6</font><font color="#808080">, </font>ctArqs<font color="#808080">.</font>opLivro<font color="#808080">)
        </font>case <font color="#800000">&quot;10&quot;
          </font>bSOp <font color="#808080">= </font><font color="#000080"><b>false
        </b></font>case else 
          <font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font>MSG_ERRO<font color="#808080">)
      </font>end select
   end while
 elseif num <font color="#808080">= </font><font color="#FF0000">2 </font>then <font color="#808080"><i>'Pesquisas
   </i></font>while bSOp
      menu<font color="#808080">(</font><font color="#FF0000">3</font><font color="#808080">)
      </font>opSubMenu <font color="#808080">= </font><font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font><font color="#000080"><b>In</b></font><font color="#808080">.</font>ReadLine<font color="#808080">()
      </font>select case opSubMenu
        case <font color="#800000">&quot;1&quot;
          </font>subMenu<font color="#808080">(</font><font color="#FF0000">12</font><font color="#808080">, </font>ctArqs<font color="#808080">.</font>opAssunto<font color="#808080">)
        </font>case <font color="#800000">&quot;2&quot;
          </font>subMenu<font color="#808080">(</font><font color="#FF0000">12</font><font color="#808080">, </font>ctArqs<font color="#808080">.</font>opAutor<font color="#808080">)
        </font>case <font color="#800000">&quot;3&quot;
          </font>subMenu<font color="#808080">(</font><font color="#FF0000">12</font><font color="#808080">, </font>ctArqs<font color="#808080">.</font>opEditora<font color="#808080">)
        </font>case <font color="#800000">&quot;4&quot;
          </font>subMenu<font color="#808080">(</font><font color="#FF0000">12</font><font color="#808080">, </font>ctArqs<font color="#808080">.</font>opEndereco<font color="#808080">)
        </font>case <font color="#800000">&quot;5&quot;
          </font>subMenu<font color="#808080">(</font><font color="#FF0000">12</font><font color="#808080">, </font>ctArqs<font color="#808080">.</font>opIdioma<font color="#808080">)
        </font>case <font color="#800000">&quot;6&quot;
          </font>subMenu<font color="#808080">(</font><font color="#FF0000">12</font><font color="#808080">, </font>ctArqs<font color="#808080">.</font>opPais<font color="#808080">)
        </font>case <font color="#800000">&quot;7&quot;
          </font>subMenu<font color="#808080">(</font><font color="#FF0000">12</font><font color="#808080">, </font>ctArqs<font color="#808080">.</font>opProfissao<font color="#808080">)
        </font>case <font color="#800000">&quot;8&quot;
          </font>subMenu<font color="#808080">(</font><font color="#FF0000">12</font><font color="#808080">, </font>ctArqs<font color="#808080">.</font>opCliente<font color="#808080">)
        </font>case <font color="#800000">&quot;9&quot;
          </font>subMenu<font color="#808080">(</font><font color="#FF0000">12</font><font color="#808080">, </font>ctArqs<font color="#808080">.</font>opLivro<font color="#808080">)
        </font>case <font color="#800000">&quot;10&quot;
          </font>bSOp <font color="#808080">= </font><font color="#000080"><b>false
        </b></font>case else 
          <font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font>MSG_ERRO<font color="#808080">)
      </font>end select
   end while
 elseif num <font color="#808080">= </font><font color="#FF0000">3 </font>then <font color="#808080"><i>'Vendas
   </i></font>while bSOp
      menu<font color="#808080">(</font><font color="#FF0000">4</font><font color="#808080">)
      </font>opSubMenu <font color="#808080">= </font><font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font><font color="#000080"><b>In</b></font><font color="#808080">.</font>ReadLine<font color="#808080">()
      </font>select case opSubMenu
	case <font color="#800000">&quot;1&quot;
          </font>subMenu<font color="#808080">(</font><font color="#FF0000">6</font><font color="#808080">, </font>ctArqs<font color="#808080">.</font>opVenda<font color="#808080">)
        </font>case <font color="#800000">&quot;2&quot;
          </font>subMenu<font color="#808080">(</font><font color="#FF0000">12</font><font color="#808080">, </font>ctArqs<font color="#808080">.</font>opVenda<font color="#808080">)
        </font>case <font color="#800000">&quot;3&quot;
          </font>bSOp <font color="#808080">= </font><font color="#000080"><b>false
        </b></font>case else 
          <font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font>MSG_ERRO<font color="#808080">)
      </font>end select
   end while
 elseif num <font color="#808080">= </font><font color="#FF0000">4 </font>then <font color="#808080"><i>'Opcoes
   </i></font>while bSOp
     menu<font color="#808080">(</font><font color="#FF0000">5</font><font color="#808080">)
     </font>opSubMenu <font color="#808080">= </font><font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font><font color="#000080"><b>In</b></font><font color="#808080">.</font>ReadLine<font color="#808080">()
     </font>select case opSubMenu
        case <font color="#800000">&quot;1&quot;
          </font>frmAlterarSenha<font color="#808080">()
        </font>case <font color="#800000">&quot;2&quot;
          </font>frmSobre<font color="#808080">()
        </font>case <font color="#800000">&quot;3&quot;
          </font>menu<font color="#808080">(</font><font color="#FF0000">11</font><font color="#808080">)
          </font>opSair <font color="#808080">= </font>GetChar<font color="#808080">(</font><font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font><font color="#000080"><b>In</b></font><font color="#808080">.</font>ReadLine<font color="#808080">(),</font><font color="#FF0000">1</font><font color="#808080">)
          </font>if <font color="#808080">(</font>opSair<font color="#808080">=</font><font color="#800000">&quot;S&quot;</font>C<font color="#808080">) </font>or <font color="#808080">(</font>opSair<font color="#808080">=</font><font color="#800000">&quot;s&quot;</font>C<font color="#808080">) </font>then
            fechaArqs<font color="#808080">()
            </font><font color="#0000FF"><b>System</b></font><font color="#808080">.</font>Environment<font color="#808080">.</font><font color="#000080"><b>Exit</b></font><font color="#808080">(</font><font color="#FF0000">0</font><font color="#808080">)
          </font>end if
        case <font color="#800000">&quot;4&quot;
          </font>bSOp <font color="#808080">= </font><font color="#000080"><b>false
        </b></font>case else 
          <font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font>MSG_ERRO<font color="#808080">)
     </font>end select
   end while
 end if
end sub
<font color="#808080"><i>'------------------------------------------------------------------------------
'Mostra as entradas e as sa&iacute;das do sistema.
'sreg - o tipo de arquivo
'slinha - o registro com os dados
'nOpcao - indica qual op&ccedil;&atilde;o ser&aacute; mostrada
'------------------------------------------------------------------------------
</i></font>sub mostrarDados<font color="#808080">(</font>sreg as ctArqs<font color="#808080">, </font>slinha as string<font color="#808080">, </font>nOpcao as integer<font color="#808080">)
</font>if sreg<font color="#808080">=</font>ctArqs<font color="#808080">.</font>opAssunto then
  select case nOpcao
    case <font color="#FF0000">1
</font>    	<font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">) + </font>tAssunto<font color="#808080">.</font>codigo<font color="#808080">)
</font>    	<font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font><font color="#000080"><b>Write</b></font><font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">))
</font>    	tAssunto<font color="#808080">.</font>assunto <font color="#808080">= </font><font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font><font color="#000080"><b>In</b></font><font color="#808080">.</font>ReadLine<font color="#808080">()
    </font>case <font color="#FF0000">2
</font>    	<font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;C&oacute;digo     Assunto&quot;</font><font color="#808080">)
</font>    	<font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;------     -------&quot;</font><font color="#808080">)
    </font>case <font color="#FF0000">3
</font>    	tAssunto<font color="#808080">.</font>codigo <font color="#808080">= </font><font color="#000080"><b>Trim</b></font><font color="#808080">(</font>mid<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">))
</font>    	tAssunto<font color="#808080">.</font>assunto <font color="#808080">= </font><font color="#000080"><b>Trim</b></font><font color="#808080">(</font>mid<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">11</font><font color="#808080">, </font><font color="#FF0000">30</font><font color="#808080">))
</font>    	<font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font>esp<font color="#808080">(</font>tAssunto<font color="#808080">.</font>codigo<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">) + </font><font color="#800000">&quot; &quot; </font><font color="#808080">+ </font>_
    					   esp<font color="#808080">(</font>tAssunto<font color="#808080">.</font>assunto<font color="#808080">,</font><font color="#FF0000">30</font><font color="#808080">))
  </font>end select
elseif sreg<font color="#808080">=</font>ctArqs<font color="#808080">.</font>opAutor then
  select case nOpcao
      case <font color="#FF0000">1
</font>      	<font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">) + </font>tAutor<font color="#808080">.</font>codigo<font color="#808080">)
</font>      	<font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font><font color="#000080"><b>Write</b></font><font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">))
</font>      	tAutor<font color="#808080">.</font>autor <font color="#808080">= </font><font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font><font color="#000080"><b>In</b></font><font color="#808080">.</font>ReadLine<font color="#808080">()
      </font>case <font color="#FF0000">2
</font>      	<font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;C&oacute;digo     Autor&quot;</font><font color="#808080">)
</font>      	<font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;------     -----&quot;</font><font color="#808080">)
      </font>case <font color="#FF0000">3
</font>      	tAutor<font color="#808080">.</font>codigo <font color="#808080">= </font><font color="#000080"><b>Trim</b></font><font color="#808080">(</font>mid<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">))
</font>      	tAutor<font color="#808080">.</font>autor <font color="#808080">= </font><font color="#000080"><b>Trim</b></font><font color="#808080">(</font>mid<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">11</font><font color="#808080">, </font><font color="#FF0000">30</font><font color="#808080">))
</font>      	<font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font>esp<font color="#808080">(</font>tAutor<font color="#808080">.</font>codigo<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">)+</font><font color="#800000">&quot; &quot;</font><font color="#808080">+</font>esp<font color="#808080">(</font>tAutor<font color="#808080">.</font>autor<font color="#808080">,</font><font color="#FF0000">30</font><font color="#808080">))
  </font>end select
elseif sreg<font color="#808080">=</font>ctArqs<font color="#808080">.</font>opEditora then
  select case nOpcao
    case <font color="#FF0000">1
</font>    	<font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">) + </font>tEditora<font color="#808080">.</font>codigo<font color="#808080">)
</font>    	<font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font><font color="#000080"><b>Write</b></font><font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">))
</font>    	tEditora<font color="#808080">.</font>editora <font color="#808080">= </font><font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font><font color="#000080"><b>In</b></font><font color="#808080">.</font>ReadLine<font color="#808080">()
    </font>case <font color="#FF0000">2
</font>    	<font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;C&oacute;digo     Editora&quot;</font><font color="#808080">)
</font>    	<font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;------     -------&quot;</font><font color="#808080">)
    </font>case <font color="#FF0000">3
</font>    	tEditora<font color="#808080">.</font>codigo <font color="#808080">= </font><font color="#000080"><b>Trim</b></font><font color="#808080">(</font>mid<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">))
</font>    	tEditora<font color="#808080">.</font>editora <font color="#808080">= </font><font color="#000080"><b>Trim</b></font><font color="#808080">(</font>mid<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">11</font><font color="#808080">, </font><font color="#FF0000">50</font><font color="#808080">))
</font>    	<font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font>esp<font color="#808080">(</font>tEditora<font color="#808080">.</font>codigo<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">)+</font><font color="#800000">&quot; &quot;</font><font color="#808080">+ </font>_
    					   esp<font color="#808080">(</font>tEditora<font color="#808080">.</font>editora<font color="#808080">,</font><font color="#FF0000">50</font><font color="#808080">))
  </font>end select
elseif sreg<font color="#808080">=</font>ctArqs<font color="#808080">.</font>opEndereco then
  select case nOpcao
    case <font color="#FF0000">1
</font>    	<font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">) + </font>tEndereco<font color="#808080">.</font>codigo<font color="#808080">)
</font>    	<font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font><font color="#000080"><b>Write</b></font><font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">))
</font>    	tEndereco<font color="#808080">.</font>logradouro <font color="#808080">= </font><font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font><font color="#000080"><b>In</b></font><font color="#808080">.</font>ReadLine<font color="#808080">()
</font>    	<font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font><font color="#000080"><b>Write</b></font><font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">))
</font>    	tEndereco<font color="#808080">.</font>bairro <font color="#808080">= </font><font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font><font color="#000080"><b>In</b></font><font color="#808080">.</font>ReadLine<font color="#808080">()
</font>    	<font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font><font color="#000080"><b>Write</b></font><font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">4</font><font color="#808080">))
</font>    	tEndereco<font color="#808080">.</font>cep <font color="#808080">= </font><font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font><font color="#000080"><b>In</b></font><font color="#808080">.</font>ReadLine<font color="#808080">()
</font>    	<font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font><font color="#000080"><b>Write</b></font><font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">5</font><font color="#808080">))
</font>    	tEndereco<font color="#808080">.</font>cidade <font color="#808080">= </font><font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font><font color="#000080"><b>In</b></font><font color="#808080">.</font>ReadLine<font color="#808080">()
</font>    	<font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font><font color="#000080"><b>Write</b></font><font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">6</font><font color="#808080">))
</font>    	tEndereco<font color="#808080">.</font>estado <font color="#808080">= </font><font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font><font color="#000080"><b>In</b></font><font color="#808080">.</font>ReadLine<font color="#808080">()
    </font>case <font color="#FF0000">3
</font>    	tEndereco<font color="#808080">.</font>codigo <font color="#808080">= </font><font color="#000080"><b>Trim</b></font><font color="#808080">(</font>mid<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">))
</font>    	tEndereco<font color="#808080">.</font>logradouro <font color="#808080">= </font><font color="#000080"><b>Trim</b></font><font color="#808080">(</font>mid<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">11</font><font color="#808080">, </font><font color="#FF0000">40</font><font color="#808080">))
</font>    	tEndereco<font color="#808080">.</font>bairro <font color="#808080">= </font><font color="#000080"><b>Trim</b></font><font color="#808080">(</font>mid<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">51</font><font color="#808080">, </font><font color="#FF0000">15</font><font color="#808080">))
</font>    	tEndereco<font color="#808080">.</font>cep <font color="#808080">= </font><font color="#000080"><b>Trim</b></font><font color="#808080">(</font>mid<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">66</font><font color="#808080">, </font><font color="#FF0000">8</font><font color="#808080">))
</font>    	tEndereco<font color="#808080">.</font>cidade <font color="#808080">= </font><font color="#000080"><b>Trim</b></font><font color="#808080">(</font>mid<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">74</font><font color="#808080">, </font><font color="#FF0000">30</font><font color="#808080">))
</font>    	tEndereco<font color="#808080">.</font>estado <font color="#808080">= </font><font color="#000080"><b>Trim</b></font><font color="#808080">(</font>mid<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">104</font><font color="#808080">, </font><font color="#FF0000">20</font><font color="#808080">))
</font>    	<font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;--------------------&quot;</font><font color="#808080">)
</font>    	<font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">) + </font>tEndereco<font color="#808080">.</font>codigo<font color="#808080">)
</font>    	<font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">) + </font>tEndereco<font color="#808080">.</font>logradouro<font color="#808080">)
</font>    	<font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">) + </font>tEndereco<font color="#808080">.</font>bairro<font color="#808080">)
</font>    	<font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">4</font><font color="#808080">) + </font>tEndereco<font color="#808080">.</font>cep<font color="#808080">)
</font>    	<font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">5</font><font color="#808080">) + </font>tEndereco<font color="#808080">.</font>cidade<font color="#808080">)
</font>    	<font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">6</font><font color="#808080">) + </font>tEndereco<font color="#808080">.</font>estado<font color="#808080">)
  </font>end select
elseif sreg<font color="#808080">=</font>ctArqs<font color="#808080">.</font>opIdioma then
   select case nOpcao
    case <font color="#FF0000">1
</font>    	<font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">) + </font>tIdioma<font color="#808080">.</font>codigo<font color="#808080">)
</font>    	<font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font><font color="#000080"><b>Write</b></font><font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">))
</font>    	tIdioma<font color="#808080">.</font>idioma <font color="#808080">= </font><font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font><font color="#000080"><b>In</b></font><font color="#808080">.</font>ReadLine<font color="#808080">()
    </font>case <font color="#FF0000">2
</font>    	<font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;C&oacute;digo     Idioma&quot;</font><font color="#808080">)
</font>    	<font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;------     ------&quot;</font><font color="#808080">)
    </font>case <font color="#FF0000">3
</font>    	tIdioma<font color="#808080">.</font>codigo <font color="#808080">= </font><font color="#000080"><b>Trim</b></font><font color="#808080">(</font>mid<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">))
</font>    	tIdioma<font color="#808080">.</font>idioma <font color="#808080">= </font><font color="#000080"><b>Trim</b></font><font color="#808080">(</font>mid<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">11</font><font color="#808080">, </font><font color="#FF0000">20</font><font color="#808080">))
</font>    	<font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font>esp<font color="#808080">(</font>tIdioma<font color="#808080">.</font>codigo<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">) + </font><font color="#800000">&quot; &quot; </font><font color="#808080">+ </font>_
    					   esp<font color="#808080">(</font>tIdioma<font color="#808080">.</font>idioma<font color="#808080">,</font><font color="#FF0000">20</font><font color="#808080">))
  </font>end select
elseif sreg<font color="#808080">=</font>ctArqs<font color="#808080">.</font>opPais then
  select case nOpcao
    case <font color="#FF0000">1
</font>    	<font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font><font color="#000080"><b>Write</b></font><font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">))
</font>    	tPais<font color="#808080">.</font>pais <font color="#808080">= </font><font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font><font color="#000080"><b>In</b></font><font color="#808080">.</font>ReadLine<font color="#808080">()
    </font>case <font color="#FF0000">2
</font>    	<font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;C&oacute;digo Pa&iacute;s&quot;</font><font color="#808080">)
</font>    	<font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;------ ----&quot;</font><font color="#808080">)
    </font>case <font color="#FF0000">3
</font>    	tPais<font color="#808080">.</font>codigo <font color="#808080">= </font><font color="#000080"><b>Trim</b></font><font color="#808080">(</font>mid<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">))
</font>    	tPais<font color="#808080">.</font>pais <font color="#808080">= </font><font color="#000080"><b>Trim</b></font><font color="#808080">(</font>mid<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">4</font><font color="#808080">, </font><font color="#FF0000">50</font><font color="#808080">))
</font>    	<font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font>esp<font color="#808080">(</font>tPais<font color="#808080">.</font>codigo<font color="#808080">,</font><font color="#FF0000">3</font><font color="#808080">)+</font><font color="#800000">&quot;    &quot;</font><font color="#808080">+</font>esp<font color="#808080">(</font>tPais<font color="#808080">.</font>pais<font color="#808080">,</font><font color="#FF0000">50</font><font color="#808080">))
  </font>end select
elseif sreg<font color="#808080">=</font>ctArqs<font color="#808080">.</font>opProfissao then
  select case nOpcao
    case <font color="#FF0000">1
</font>    	<font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">) + </font>tProfissao<font color="#808080">.</font>codigo<font color="#808080">)
</font>    	<font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">))
</font>    	tProfissao<font color="#808080">.</font>profissao <font color="#808080">= </font><font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font><font color="#000080"><b>In</b></font><font color="#808080">.</font>ReadLine<font color="#808080">()
    </font>case <font color="#FF0000">2
</font>    	<font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;C&oacute;digo     Profiss&atilde;o&quot;</font><font color="#808080">)
</font>    	<font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;------     ---------&quot;</font><font color="#808080">)
    </font>case <font color="#FF0000">3
</font>    	tProfissao<font color="#808080">.</font>codigo <font color="#808080">= </font><font color="#000080"><b>Trim</b></font><font color="#808080">(</font>mid<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">))
</font>    	tProfissao<font color="#808080">.</font>profissao <font color="#808080">= </font><font color="#000080"><b>Trim</b></font><font color="#808080">(</font>mid<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">11</font><font color="#808080">, </font><font color="#FF0000">50</font><font color="#808080">))
</font>    	<font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font>esp<font color="#808080">(</font>tProfissao<font color="#808080">.</font>codigo<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">)+</font><font color="#800000">&quot; &quot;</font><font color="#808080">+ </font>_
    			esp<font color="#808080">(</font>tProfissao<font color="#808080">.</font>profissao<font color="#808080">,</font><font color="#FF0000">50</font><font color="#808080">))
  </font>end select
elseif sreg<font color="#808080">=</font>ctArqs<font color="#808080">.</font>opLivro then
  select case nOpcao
    case <font color="#FF0000">1
</font>    	<font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font><font color="#000080"><b>Write</b></font><font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">))
</font>    	tLivro<font color="#808080">.</font>titulo <font color="#808080">= </font><font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font><font color="#000080"><b>In</b></font><font color="#808080">.</font>ReadLine<font color="#808080">()
</font>    	tLivro<font color="#808080">.</font>edicao <font color="#808080">= </font>validaNumero<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">), </font>tLivro<font color="#808080">.</font>edicao<font color="#808080">)
</font>    	tLivro<font color="#808080">.</font>anopubli <font color="#808080">= </font>validaNumero<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">4</font><font color="#808080">), </font>tLivro<font color="#808080">.</font>anopubli<font color="#808080">)
</font>    	mostrarSubDados<font color="#808080">(</font>ctArqs<font color="#808080">.</font>opLivro<font color="#808080">, </font>ctArqs<font color="#808080">.</font>opEditora<font color="#808080">, </font><font color="#000080"><b>false</b></font><font color="#808080">)
</font>    	tLivro<font color="#808080">.</font>volume <font color="#808080">= </font>validaNumero<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">6</font><font color="#808080">), </font>tLivro<font color="#808080">.</font>volume<font color="#808080">)
</font>    	mostrarSubDados<font color="#808080">(</font>ctArqs<font color="#808080">.</font>opLivro<font color="#808080">, </font>ctArqs<font color="#808080">.</font>opIdioma<font color="#808080">, </font><font color="#000080"><b>false</b></font><font color="#808080">)
</font>    	tLivro<font color="#808080">.</font>npaginas <font color="#808080">= </font>validaNumero<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">8</font><font color="#808080">), </font>tLivro<font color="#808080">.</font>npaginas<font color="#808080">)
</font>    	tLivro<font color="#808080">.</font>preco <font color="#808080">= </font>validaNumero<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">9</font><font color="#808080">), </font>tLivro<font color="#808080">.</font>preco<font color="#808080">)
</font>    	tLivro<font color="#808080">.</font>qtdestoque <font color="#808080">= </font>validaNumero<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">), </font>tLivro<font color="#808080">.</font>qtdestoque<font color="#808080">)
    </font>case <font color="#FF0000">3
</font>    	tLivro<font color="#808080">.</font>isbn <font color="#808080">= </font><font color="#000080"><b>Trim</b></font><font color="#808080">(</font>mid<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">13</font><font color="#808080">))
</font>    	tLivro<font color="#808080">.</font>titulo <font color="#808080">= </font><font color="#000080"><b>Trim</b></font><font color="#808080">(</font>mid<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">14</font><font color="#808080">, </font><font color="#FF0000">50</font><font color="#808080">))
</font>    	tLivro<font color="#808080">.</font>edicao <font color="#808080">= </font><font color="#000080"><b>Trim</b></font><font color="#808080">(</font>mid<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">64</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">))
</font>    	tLivro<font color="#808080">.</font>anopubli <font color="#808080">= </font><font color="#000080"><b>Trim</b></font><font color="#808080">(</font>mid<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">74</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">))
</font>    	tLivro<font color="#808080">.</font>codeditora <font color="#808080">= </font><font color="#000080"><b>Trim</b></font><font color="#808080">(</font>mid<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">84</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">))
</font>    	tLivro<font color="#808080">.</font>volume <font color="#808080">= </font><font color="#000080"><b>Trim</b></font><font color="#808080">(</font>mid<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">94</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">))
</font>    	tLivro<font color="#808080">.</font>codidioma <font color="#808080">= </font><font color="#000080"><b>Trim</b></font><font color="#808080">(</font>mid<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">104</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">))
</font>    	tLivro<font color="#808080">.</font>npaginas <font color="#808080">= </font><font color="#000080"><b>Trim</b></font><font color="#808080">(</font>mid<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">114</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">))
</font>    	tLivro<font color="#808080">.</font>preco <font color="#808080">= </font><font color="#000080"><b>Trim</b></font><font color="#808080">(</font>mid<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">124</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">))
</font>    	tLivro<font color="#808080">.</font>qtdestoque <font color="#808080">= </font><font color="#000080"><b>Trim</b></font><font color="#808080">(</font>mid<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">134</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">))
</font>    	<font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;--------------------&quot;</font><font color="#808080">)
</font>    	<font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">) + </font>tLivro<font color="#808080">.</font>isbn<font color="#808080">)
</font>    	<font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">) + </font>tLivro<font color="#808080">.</font>titulo<font color="#808080">)
</font>    	<font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">) + </font>tLivro<font color="#808080">.</font>edicao<font color="#808080">)
</font>    	<font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">4</font><font color="#808080">) + </font>tLivro<font color="#808080">.</font>anopubli<font color="#808080">)
</font>    	<font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">5</font><font color="#808080">) + </font>tLivro<font color="#808080">.</font>codeditora<font color="#808080">)
</font>    	mostrarSubDados<font color="#808080">(</font>ctArqs<font color="#808080">.</font>opLivro<font color="#808080">, </font>ctArqs<font color="#808080">.</font>opEditora<font color="#808080">, </font><font color="#000080"><b>true</b></font><font color="#808080">)
</font>    	<font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">6</font><font color="#808080">) + </font>tLivro<font color="#808080">.</font>volume<font color="#808080">)
</font>    	<font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">7</font><font color="#808080">) + </font>tLivro<font color="#808080">.</font>codidioma<font color="#808080">)
</font>    	mostrarSubDados<font color="#808080">(</font>ctArqs<font color="#808080">.</font>opLivro<font color="#808080">, </font>ctArqs<font color="#808080">.</font>opIdioma<font color="#808080">, </font><font color="#000080"><b>true</b></font><font color="#808080">)
</font>    	<font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">8</font><font color="#808080">) + </font>tLivro<font color="#808080">.</font>npaginas<font color="#808080">)
</font>    	<font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">9</font><font color="#808080">) + </font>tLivro<font color="#808080">.</font>preco<font color="#808080">)
</font>    	<font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">) + </font>tLivro<font color="#808080">.</font>qtdestoque<font color="#808080">)
</font>    	ListarRegLigados<font color="#808080">(</font>tfLivroAss<font color="#808080">, </font>ctArqs<font color="#808080">.</font>opLivroAss<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">13</font><font color="#808080">, </font><font color="#FF0000">14</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">, </font>_
               tLivro<font color="#808080">.</font>isbn<font color="#808080">, </font>tfAssunto<font color="#808080">, </font>ctArqs<font color="#808080">.</font>opAssunto<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">4</font><font color="#808080">)
</font>    	ListarRegLigados<font color="#808080">(</font>tfLivroAut<font color="#808080">, </font>ctArqs<font color="#808080">.</font>opLivroAut<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">13</font><font color="#808080">, </font><font color="#FF0000">14</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">, </font>_
               tLivro<font color="#808080">.</font>isbn<font color="#808080">, </font>tfAutor<font color="#808080">, </font>ctArqs<font color="#808080">.</font>opAutor<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">4</font><font color="#808080">)
  </font>end select
elseif sreg<font color="#808080">=</font>ctArqs<font color="#808080">.</font>opCliente then
  select case nOpcao
    case <font color="#FF0000">1
</font>    	<font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font><font color="#000080"><b>Write</b></font><font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">))
</font>    	tCliente<font color="#808080">.</font>nome <font color="#808080">= </font><font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font><font color="#000080"><b>In</b></font><font color="#808080">.</font>ReadLine<font color="#808080">()
</font>    	<font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font><font color="#000080"><b>Write</b></font><font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">))
</font>    	tCliente<font color="#808080">.</font>email <font color="#808080">= </font><font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font><font color="#000080"><b>In</b></font><font color="#808080">.</font>ReadLine<font color="#808080">()
</font>    	<font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font><font color="#000080"><b>Write</b></font><font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">4</font><font color="#808080">))
</font>    	tCliente<font color="#808080">.</font>identidade <font color="#808080">= </font><font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font><font color="#000080"><b>In</b></font><font color="#808080">.</font>ReadLine<font color="#808080">()
</font>    	<font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font><font color="#000080"><b>Write</b></font><font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">5</font><font color="#808080">))
</font>    	tCliente<font color="#808080">.</font>sexo <font color="#808080">= </font><font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font><font color="#000080"><b>In</b></font><font color="#808080">.</font>ReadLine<font color="#808080">()
</font>    	<font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font><font color="#000080"><b>Write</b></font><font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">6</font><font color="#808080">))
</font>    	tCliente<font color="#808080">.</font>telefone <font color="#808080">= </font><font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font><font color="#000080"><b>In</b></font><font color="#808080">.</font>ReadLine<font color="#808080">()
</font>    	tCliente<font color="#808080">.</font>dtnascimento <font color="#808080">= </font>_
		validaDataHora<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">7</font><font color="#808080">), </font>tCliente<font color="#808080">.</font>dtnascimento<font color="#808080">, </font><font color="#000080"><b>true</b></font><font color="#808080">)
</font>    	mostrarSubDados<font color="#808080">(</font>ctArqs<font color="#808080">.</font>opCliente<font color="#808080">, </font>ctArqs<font color="#808080">.</font>opEndereco<font color="#808080">, </font><font color="#000080"><b>false</b></font><font color="#808080">)
</font>    	mostrarSubDados<font color="#808080">(</font>ctArqs<font color="#808080">.</font>opCliente<font color="#808080">, </font>ctArqs<font color="#808080">.</font>opPais<font color="#808080">, </font><font color="#000080"><b>false</b></font><font color="#808080">)
</font>    	mostrarSubDados<font color="#808080">(</font>ctArqs<font color="#808080">.</font>opCliente<font color="#808080">, </font>ctArqs<font color="#808080">.</font>opProfissao<font color="#808080">, </font><font color="#000080"><b>false</b></font><font color="#808080">)
    </font>case <font color="#FF0000">3
</font>    	tCliente<font color="#808080">.</font>cpf <font color="#808080">= </font><font color="#000080"><b>Trim</b></font><font color="#808080">(</font>mid<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">14</font><font color="#808080">))
</font>    	tCliente<font color="#808080">.</font>nome <font color="#808080">= </font><font color="#000080"><b>Trim</b></font><font color="#808080">(</font>mid<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">15</font><font color="#808080">, </font><font color="#FF0000">30</font><font color="#808080">))
</font>    	tCliente<font color="#808080">.</font>email <font color="#808080">= </font><font color="#000080"><b>Trim</b></font><font color="#808080">(</font>mid<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">45</font><font color="#808080">, </font><font color="#FF0000">30</font><font color="#808080">))
</font>    	tCliente<font color="#808080">.</font>identidade <font color="#808080">= </font><font color="#000080"><b>Trim</b></font><font color="#808080">(</font>mid<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">75</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">))
</font>    	tCliente<font color="#808080">.</font>sexo <font color="#808080">= </font><font color="#000080"><b>Trim</b></font><font color="#808080">(</font>mid<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">85</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">))
</font>    	tCliente<font color="#808080">.</font>telefone <font color="#808080">= </font><font color="#000080"><b>Trim</b></font><font color="#808080">(</font>mid<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">86</font><font color="#808080">, </font><font color="#FF0000">17</font><font color="#808080">))
</font>    	tCliente<font color="#808080">.</font>dtnascimento <font color="#808080">= </font><font color="#000080"><b>Trim</b></font><font color="#808080">(</font>mid<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">103</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">))
</font>    	tCliente<font color="#808080">.</font>codendereco <font color="#808080">= </font><font color="#000080"><b>Trim</b></font><font color="#808080">(</font>mid<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">113</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">))
</font>    	tCliente<font color="#808080">.</font>codpais <font color="#808080">= </font><font color="#000080"><b>Trim</b></font><font color="#808080">(</font>mid<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">123</font><font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">))
</font>    	tCliente<font color="#808080">.</font>codprofissao <font color="#808080">= </font><font color="#000080"><b>Trim</b></font><font color="#808080">(</font>mid<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">126</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">))
</font>    	<font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;--------------------&quot;</font><font color="#808080">)
</font>    	<font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">) + </font>tCliente<font color="#808080">.</font>cpf<font color="#808080">)
</font>    	<font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">) + </font>tCliente<font color="#808080">.</font>nome<font color="#808080">)
</font>    	<font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">) + </font>tCliente<font color="#808080">.</font>email<font color="#808080">)
</font>    	<font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">4</font><font color="#808080">) + </font>tCliente<font color="#808080">.</font>identidade<font color="#808080">)
</font>    	<font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">5</font><font color="#808080">) + </font>tCliente<font color="#808080">.</font>sexo<font color="#808080">)
</font>    	<font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">6</font><font color="#808080">) + </font>tCliente<font color="#808080">.</font>telefone<font color="#808080">)
</font>    	<font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">7</font><font color="#808080">) + </font>tCliente<font color="#808080">.</font>dtnascimento<font color="#808080">)
</font>    	<font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">8</font><font color="#808080">) + </font>tCliente<font color="#808080">.</font>codendereco<font color="#808080">)
</font>    	mostrarSubDados<font color="#808080">(</font>ctArqs<font color="#808080">.</font>opCliente<font color="#808080">, </font>ctArqs<font color="#808080">.</font>opEndereco<font color="#808080">, </font><font color="#000080"><b>true</b></font><font color="#808080">)
</font>    	<font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">9</font><font color="#808080">) + </font>tCliente<font color="#808080">.</font>codpais<font color="#808080">)
</font>    	mostrarSubDados<font color="#808080">(</font>ctArqs<font color="#808080">.</font>opCliente<font color="#808080">, </font>ctArqs<font color="#808080">.</font>opPais<font color="#808080">, </font><font color="#000080"><b>true</b></font><font color="#808080">)
</font>    	<font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">) + </font>tCliente<font color="#808080">.</font>codprofissao<font color="#808080">)
</font>    	mostrarSubDados<font color="#808080">(</font>ctArqs<font color="#808080">.</font>opCliente<font color="#808080">, </font>ctArqs<font color="#808080">.</font>opProfissao<font color="#808080">, </font><font color="#000080"><b>true</b></font><font color="#808080">)
  </font>end select
elseif sreg<font color="#808080">=</font>ctArqs<font color="#808080">.</font>opVenda then
  select case nOpcao
    case <font color="#FF0000">1 
      </font>mostrarSubDados<font color="#808080">(</font>ctArqs<font color="#808080">.</font>opVenda<font color="#808080">,</font>ctArqs<font color="#808080">.</font>opVenda<font color="#808080">, </font><font color="#000080"><b>false</b></font><font color="#808080">)
    </font>case <font color="#FF0000">2
      </font><font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">( </font>_
      <font color="#800000">&quot;DataHoraVenda       CPF            ISBN          Pre&ccedil;oVenda&quot;</font><font color="#808080">)
      </font><font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">( </font>_
      <font color="#800000">&quot;-------------       ---            ----          ----------&quot;</font><font color="#808080">)
    </font>case <font color="#FF0000">3
      </font>tVenda<font color="#808080">.</font>dthrvenda <font color="#808080">= </font><font color="#000080"><b>Trim</b></font><font color="#808080">(</font>mid<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">19</font><font color="#808080">))
      </font>tVenda<font color="#808080">.</font>cpf <font color="#808080">= </font><font color="#000080"><b>Trim</b></font><font color="#808080">(</font>mid<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">20</font><font color="#808080">, </font><font color="#FF0000">14</font><font color="#808080">))
      </font>tVenda<font color="#808080">.</font>isbn <font color="#808080">= </font><font color="#000080"><b>Trim</b></font><font color="#808080">(</font>mid<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">34</font><font color="#808080">, </font><font color="#FF0000">13</font><font color="#808080">))
      </font>tVenda<font color="#808080">.</font>precovenda <font color="#808080">= </font><font color="#000080"><b>Trim</b></font><font color="#808080">(</font>mid<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">47</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">))
      </font><font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font>esp<font color="#808080">(</font>tVenda<font color="#808080">.</font>dthrvenda<font color="#808080">,</font><font color="#FF0000">19</font><font color="#808080">)+</font><font color="#800000">&quot; &quot;</font><font color="#808080">+ </font>_
      esp<font color="#808080">(</font>tVenda<font color="#808080">.</font>cpf<font color="#808080">,</font><font color="#FF0000">14</font><font color="#808080">)+</font><font color="#800000">&quot; &quot;</font><font color="#808080">+</font>esp<font color="#808080">(</font>tVenda<font color="#808080">.</font>isbn<font color="#808080">,</font><font color="#FF0000">13</font><font color="#808080">)+</font><font color="#800000">&quot; &quot;</font><font color="#808080">+</font>esp<font color="#808080">(</font>tVenda<font color="#808080">.</font>precovenda<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">))
  </font>end select
end if

end sub
<font color="#808080"><i>'------------------------------------------------------------------------------
'Mostra as sub inform&ccedil;&otilde;es de entrada e de sa&iacute;da.
'sreg - o tipo de arquivo
'ssubreg - o subtipo de arquivo
'bSoMostrar - se vai s&oacute; mostrar na sa&iacute;da
'------------------------------------------------------------------------------
</i></font><font color="#000080"><b>Sub </b></font>mostrarSubDados<font color="#808080">(</font>sreg as ctArqs<font color="#808080">, </font>ssubreg as ctArqs<font color="#808080">, </font>bSoMostrar as <font color="#000080"><b>Boolean</b></font><font color="#808080">)
</font><font color="#000080"><b>Dim </b></font>sRegistro<font color="#808080">, </font>sPreco <font color="#000080"><b>As </b></font>string
dim nMaxTentativas as integer

nMaxTentativas <font color="#808080">= </font><font color="#FF0000">3
</font>if sreg<font color="#808080">=</font>ctArqs<font color="#808080">.</font>opLivro then
  if ssubreg<font color="#808080">=</font>ctArqs<font color="#808080">.</font>opEditora then
    if bSoMostrar then
       sRegistro <font color="#808080">= </font>pesqArq<font color="#808080">(</font>tfEditora<font color="#808080">,</font>tLivro<font color="#808080">.</font>codeditora<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">,</font>tamReg<font color="#808080">(</font>ctArqs<font color="#808080">.</font>opEditora<font color="#808080">))
    </font>else
       sRegistro <font color="#808080">= </font>validaEntrada<font color="#808080">(</font>tfEditora<font color="#808080">,</font>ssubreg<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font>tLivro<font color="#808080">.</font>codeditora<font color="#808080">, </font>_
    			  nMaxTentativas<font color="#808080">,</font><font color="#000080"><b>false</b></font><font color="#808080">,</font>ctTipo<font color="#808080">.</font>opNumero<font color="#808080">)
    </font>end if
    if sRegistro<font color="#808080">&lt;&gt;</font><font color="#800000">&quot;&quot; </font>then
      tLivro<font color="#808080">.</font>codeditora <font color="#808080">= </font><font color="#000080"><b>Trim</b></font><font color="#808080">(</font>mid<font color="#808080">(</font>sRegistro<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">))
      </font><font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font><font color="#000080"><b>Write</b></font><font color="#808080">(</font><font color="#800000">&quot; &quot;</font><font color="#808080">+</font>rotulo<font color="#808080">(</font>ctArqs<font color="#808080">.</font>opEditora<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">))
      </font><font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font>mid<font color="#808080">(</font>sRegistro<font color="#808080">, </font>g_nPosChave<font color="#808080">, </font>g_nTamChave<font color="#808080">))
    </font>end if
  elseif ssubreg<font color="#808080">=</font>ctArqs<font color="#808080">.</font>opIdioma then
    if bSoMostrar then
       sRegistro <font color="#808080">= </font>pesqArq<font color="#808080">(</font>tfIdioma<font color="#808080">, </font>tLivro<font color="#808080">.</font>codidioma<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">,</font>tamReg<font color="#808080">(</font>ctArqs<font color="#808080">.</font>opIdioma<font color="#808080">))
    </font>else
       sRegistro <font color="#808080">= </font>validaEntrada<font color="#808080">(</font>tfIdioma<font color="#808080">,</font>ssubreg<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font>tLivro<font color="#808080">.</font>codidioma<font color="#808080">, </font>_
    			  nMaxTentativas<font color="#808080">,</font><font color="#000080"><b>false</b></font><font color="#808080">,</font>ctTipo<font color="#808080">.</font>opNumero<font color="#808080">)
    </font>end if
    if sRegistro<font color="#808080">&lt;&gt;</font><font color="#800000">&quot;&quot; </font>then
      tLivro<font color="#808080">.</font>codidioma <font color="#808080">= </font><font color="#000080"><b>Trim</b></font><font color="#808080">(</font>mid<font color="#808080">(</font>sRegistro<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">))
      </font><font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font><font color="#000080"><b>Write</b></font><font color="#808080">(</font><font color="#800000">&quot; &quot;</font><font color="#808080">+</font>rotulo<font color="#808080">(</font>ctArqs<font color="#808080">.</font>opIdioma<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">))
      </font><font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font>mid<font color="#808080">(</font>sRegistro<font color="#808080">, </font>g_nPosChave<font color="#808080">, </font>g_nTamChave<font color="#808080">))
    </font>end if
  end if
elseif sreg<font color="#808080">=</font>ctArqs<font color="#808080">.</font>opCliente then
  if ssubreg<font color="#808080">=</font>ctArqs<font color="#808080">.</font>opEndereco then
    if bSoMostrar then
       sRegistro <font color="#808080">= </font>pesqArq<font color="#808080">(</font>tfEndereco<font color="#808080">, </font>tCliente<font color="#808080">.</font>codendereco<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">, </font>_
    			  tamReg<font color="#808080">(</font>ctArqs<font color="#808080">.</font>opEndereco<font color="#808080">))
    </font>else
       sRegistro <font color="#808080">= </font>validaEntrada<font color="#808080">(</font>tfEndereco<font color="#808080">,</font>ssubreg<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font>tCliente<font color="#808080">.</font>codendereco<font color="#808080">, </font>_
    			  nMaxTentativas<font color="#808080">,</font><font color="#000080"><b>false</b></font><font color="#808080">,</font>ctTipo<font color="#808080">.</font>opNumero<font color="#808080">)
    </font>end if
    if sRegistro<font color="#808080">&lt;&gt;</font><font color="#800000">&quot;&quot; </font>then
      tCliente<font color="#808080">.</font>codendereco <font color="#808080">= </font><font color="#000080"><b>Trim</b></font><font color="#808080">(</font>mid<font color="#808080">(</font>sRegistro<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">))
      </font><font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font><font color="#000080"><b>Write</b></font><font color="#808080">(</font><font color="#800000">&quot; &quot;</font><font color="#808080">+</font>rotulo<font color="#808080">(</font>ctArqs<font color="#808080">.</font>opEndereco<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">))
      </font><font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font>mid<font color="#808080">(</font>sRegistro<font color="#808080">, </font>g_nPosChave<font color="#808080">, </font>g_nTamChave<font color="#808080">))
      </font><font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font><font color="#000080"><b>Write</b></font><font color="#808080">(</font><font color="#800000">&quot; &quot;</font><font color="#808080">+</font>rotulo<font color="#808080">(</font>ctArqs<font color="#808080">.</font>opEndereco<font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">))
      </font><font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font>mid<font color="#808080">(</font>sRegistro<font color="#808080">, </font>g_nPosChave<font color="#808080">, </font>g_nTamChave<font color="#808080">))
      </font><font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font><font color="#000080"><b>Write</b></font><font color="#808080">(</font><font color="#800000">&quot; &quot;</font><font color="#808080">+</font>rotulo<font color="#808080">(</font>ctArqs<font color="#808080">.</font>opEndereco<font color="#808080">, </font><font color="#FF0000">4</font><font color="#808080">))
      </font><font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font>mid<font color="#808080">(</font>sRegistro<font color="#808080">, </font>g_nPosChave<font color="#808080">, </font>g_nTamChave<font color="#808080">))
      </font><font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font><font color="#000080"><b>Write</b></font><font color="#808080">(</font><font color="#800000">&quot; &quot;</font><font color="#808080">+</font>rotulo<font color="#808080">(</font>ctArqs<font color="#808080">.</font>opEndereco<font color="#808080">, </font><font color="#FF0000">5</font><font color="#808080">))
      </font><font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font>mid<font color="#808080">(</font>sRegistro<font color="#808080">, </font>g_nPosChave<font color="#808080">, </font>g_nTamChave<font color="#808080">))
      </font><font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font><font color="#000080"><b>Write</b></font><font color="#808080">(</font><font color="#800000">&quot; &quot;</font><font color="#808080">+</font>rotulo<font color="#808080">(</font>ctArqs<font color="#808080">.</font>opEndereco<font color="#808080">, </font><font color="#FF0000">6</font><font color="#808080">))
      </font><font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font>mid<font color="#808080">(</font>sRegistro<font color="#808080">, </font>g_nPosChave<font color="#808080">, </font>g_nTamChave<font color="#808080">))
    </font>end if
  elseif ssubreg<font color="#808080">=</font>ctArqs<font color="#808080">.</font>opPais then
    if bSoMostrar then
       sRegistro <font color="#808080">= </font>pesqArq<font color="#808080">(</font>tfPais<font color="#808080">, </font>tCliente<font color="#808080">.</font>codpais<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">, </font>tamReg<font color="#808080">(</font>ctArqs<font color="#808080">.</font>opPais<font color="#808080">))
    </font>else
       sRegistro <font color="#808080">= </font>validaEntrada<font color="#808080">(</font>tfPais<font color="#808080">,</font>ssubreg<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font>tCliente<font color="#808080">.</font>codpais<font color="#808080">, </font>_
    			  nMaxTentativas<font color="#808080">,</font><font color="#000080"><b>false</b></font><font color="#808080">,</font>ctTipo<font color="#808080">.</font>opTexto<font color="#808080">)
    </font>end if
    if sRegistro<font color="#808080">&lt;&gt;</font><font color="#800000">&quot;&quot; </font>then
      tCliente<font color="#808080">.</font>codpais <font color="#808080">= </font><font color="#000080"><b>Trim</b></font><font color="#808080">(</font>mid<font color="#808080">(</font>sRegistro<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#FF0000">3</font><font color="#808080">))
      </font><font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font><font color="#000080"><b>Write</b></font><font color="#808080">(</font><font color="#800000">&quot; &quot;</font><font color="#808080">+</font>rotulo<font color="#808080">(</font>ctArqs<font color="#808080">.</font>opPais<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">))
      </font><font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font>mid<font color="#808080">(</font>sRegistro<font color="#808080">, </font>g_nPosChave<font color="#808080">, </font>g_nTamChave<font color="#808080">))
    </font>end if
  elseif ssubreg<font color="#808080">=</font>ctArqs<font color="#808080">.</font>opProfissao then
    if bSoMostrar then
       sRegistro <font color="#808080">= </font>pesqArq<font color="#808080">(</font>tfProfissao<font color="#808080">, </font>tCliente<font color="#808080">.</font>codprofissao<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">, </font>_
    			  tamReg<font color="#808080">(</font>ctArqs<font color="#808080">.</font>opProfissao<font color="#808080">))
    </font>else
       sRegistro <font color="#808080">= </font>validaEntrada<font color="#808080">(</font>tfProfissao<font color="#808080">,</font>ssubreg<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font>tCliente<font color="#808080">.</font>codprofissao<font color="#808080">, </font>_
    			  nMaxTentativas<font color="#808080">,</font><font color="#000080"><b>false</b></font><font color="#808080">,</font>ctTipo<font color="#808080">.</font>opNumero<font color="#808080">)
    </font>end if
    if sRegistro<font color="#808080">&lt;&gt;</font><font color="#800000">&quot;&quot; </font>then
      tCliente<font color="#808080">.</font>codprofissao <font color="#808080">= </font><font color="#000080"><b>Trim</b></font><font color="#808080">(</font>mid<font color="#808080">(</font>sRegistro<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">))
      </font><font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font><font color="#000080"><b>Write</b></font><font color="#808080">(</font><font color="#800000">&quot; &quot;</font><font color="#808080">+</font>rotulo<font color="#808080">(</font>ctArqs<font color="#808080">.</font>opProfissao<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">))
      </font><font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font>mid<font color="#808080">(</font>sRegistro<font color="#808080">, </font>g_nPosChave<font color="#808080">, </font>g_nTamChave<font color="#808080">))
    </font>end if
  end if
elseif sreg<font color="#808080">=</font>ctArqs<font color="#808080">.</font>opVenda then
  sRegistro <font color="#808080">= </font>pesqArq<font color="#808080">(</font>tfLivro<font color="#808080">, </font>tVenda<font color="#808080">.</font>isbn<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">13</font><font color="#808080">, </font>tamReg<font color="#808080">(</font>ctArqs<font color="#808080">.</font>opLivro<font color="#808080">))
  </font>if sRegistro<font color="#808080">&lt;&gt;</font><font color="#800000">&quot;&quot; </font>then
    <font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font><font color="#000080"><b>Write</b></font><font color="#808080">(</font><font color="#800000">&quot; &quot;</font><font color="#808080">+</font>rotulo<font color="#808080">(</font>ctArqs<font color="#808080">.</font>opLivro<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">)) <i>'Titulo
    </i></font><font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font>mid<font color="#808080">(</font>sRegistro<font color="#808080">, </font>g_nPosChave<font color="#808080">, </font>g_nTamChave<font color="#808080">))
    </font><font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font><font color="#000080"><b>Write</b></font><font color="#808080">(</font><font color="#800000">&quot; &quot;</font><font color="#808080">+</font>rotulo<font color="#808080">(</font>ctArqs<font color="#808080">.</font>opLivro<font color="#808080">, </font><font color="#FF0000">9</font><font color="#808080">)) <i>'Preco
    </i></font>sPreco <font color="#808080">= </font>mid<font color="#808080">(</font>sRegistro<font color="#808080">, </font>g_nPosChave<font color="#808080">, </font>g_nTamChave<font color="#808080">)
    </font>g_nPreco <font color="#808080">= </font><font color="#000080"><b>CDbl</b></font><font color="#808080">(</font>sPreco<font color="#808080">)
    </font><font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font>sPreco<font color="#808080">)
  </font>end if
end if
end sub
<font color="#808080"><i>'------------------------------------------------------------------------------
'Realiza os cadastros dos arquivos que se ligam a outros arquivos.
'sreg - o tipo de arquivo
'sacao - a a&ccedil;&atilde;o a ser realizada
'sCodigo - um das chaves do arquivo de liga&ccedil;&atilde;o
'------------------------------------------------------------------------------
</i></font>sub frmCadLigados<font color="#808080">(</font>sreg as ctArqs<font color="#808080">, </font>sacao as ctAcao<font color="#808080">, </font>sCodigo as <font color="#000080"><b>String</b></font><font color="#808080">)
</font>dim nQtd<font color="#808080">, </font>nCont<font color="#808080">, </font>nQtdEstoque as integer
dim nTotalPreco as double
dim slinha<font color="#808080">, </font>sTotalPreco<font color="#808080">, </font>sPreco as string
dim sQtd as string <font color="#808080">= </font><font color="#800000">&quot;&quot;

</font>if sacao<font color="#808080">=</font>ctAcao<font color="#808080">.</font>opNovo then
  nCont <font color="#808080">= </font><font color="#FF0000">1
  </font>if sreg<font color="#808080">=</font>ctArqs<font color="#808080">.</font>opLivroAss then
    sQtd <font color="#808080">= </font>validaNumero<font color="#808080">(</font><font color="#800000">&quot;Quantos assuntos quer cadastrar?: &quot;</font><font color="#808080">,</font>sQtd<font color="#808080">)
    </font>nQtd <font color="#808080">= </font><font color="#000080"><b>CInt</b></font><font color="#808080">(</font>sQtd<font color="#808080">)
    </font>tfLivroAss<font color="#808080">.</font><font color="#000080"><b>Seek</b></font><font color="#808080">(</font><font color="#FF0000">0</font><font color="#808080">, </font>SeekOrigin<font color="#808080">.</font>Begin<font color="#808080">)
    </font>while <font color="#808080">(</font>nCont <font color="#808080">&lt;= </font>nQtd<font color="#808080">) 
      </font>tLivroAss<font color="#808080">.</font>isbn <font color="#808080">= </font>sCodigo
      <font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font><font color="#000080"><b>Write</b></font><font color="#808080">(</font>rotulo<font color="#808080">(</font>ctArqs<font color="#808080">.</font>opLivroAss<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">))
      </font>tLivroAss<font color="#808080">.</font>codassunto <font color="#808080">= </font><font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font><font color="#000080"><b>In</b></font><font color="#808080">.</font>ReadLine<font color="#808080">()
      </font>slinha <font color="#808080">= </font>pesqArq<font color="#808080">(</font>tfAssunto<font color="#808080">, </font>tLivroAss<font color="#808080">.</font>codassunto<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">,</font>tamReg<font color="#808080">(</font>ctArqs<font color="#808080">.</font>opAssunto<font color="#808080">))
      </font><font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font><font color="#000080"><b>Write</b></font><font color="#808080">(</font><font color="#800000">&quot; &quot;</font><font color="#808080">+</font>rotulo<font color="#808080">(</font>ctArqs<font color="#808080">.</font>opAssunto<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">))
      </font><font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font>mid<font color="#808080">(</font>slinha<font color="#808080">, </font>g_nPosChave<font color="#808080">, </font>g_nTamChave<font color="#808080">))
      </font>pesqLinhaExcluida<font color="#808080">(</font>tfLivroAss<font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">))
      </font>subMenu<font color="#808080">(</font><font color="#FF0000">14</font><font color="#808080">, </font>sreg<font color="#808080">)
      </font>nCont <font color="#808080">= </font>nCont <font color="#808080">+ </font><font color="#FF0000">1
    </font>end while
  elseif sreg<font color="#808080">=</font>ctArqs<font color="#808080">.</font>opLivroAut then
    sQtd <font color="#808080">= </font>validaNumero<font color="#808080">(</font><font color="#800000">&quot;Quantos autores quer cadastrar?: &quot;</font><font color="#808080">,</font>sQtd<font color="#808080">)
    </font>nQtd <font color="#808080">= </font><font color="#000080"><b>CInt</b></font><font color="#808080">(</font>sQtd<font color="#808080">)
    </font>tfLivroAut<font color="#808080">.</font><font color="#000080"><b>Seek</b></font><font color="#808080">(</font><font color="#FF0000">0</font><font color="#808080">, </font>SeekOrigin<font color="#808080">.</font>Begin<font color="#808080">)
    </font>while <font color="#808080">(</font>nCont <font color="#808080">&lt;= </font>nQtd<font color="#808080">) 
      </font>tLivroAut<font color="#808080">.</font>isbn <font color="#808080">= </font>sCodigo
      <font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font><font color="#000080"><b>Write</b></font><font color="#808080">(</font>rotulo<font color="#808080">(</font>ctArqs<font color="#808080">.</font>opLivroAut<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">))
      </font>tLivroAut<font color="#808080">.</font>codautor <font color="#808080">= </font><font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font><font color="#000080"><b>In</b></font><font color="#808080">.</font>ReadLine<font color="#808080">()
      </font>slinha <font color="#808080">= </font>pesqArq<font color="#808080">(</font>tfAutor<font color="#808080">, </font>tLivroAut<font color="#808080">.</font>codautor<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">,</font>tamReg<font color="#808080">(</font>ctArqs<font color="#808080">.</font>opAutor<font color="#808080">))
      </font><font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font><font color="#000080"><b>Write</b></font><font color="#808080">(</font><font color="#800000">&quot; &quot;</font><font color="#808080">+</font>rotulo<font color="#808080">(</font>ctArqs<font color="#808080">.</font>opAutor<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">))
      </font><font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font>mid<font color="#808080">(</font>slinha<font color="#808080">, </font>g_nPosChave<font color="#808080">, </font>g_nTamChave<font color="#808080">))
      </font>pesqLinhaExcluida<font color="#808080">(</font>tfLivroAut<font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">))
      </font>subMenu<font color="#808080">(</font><font color="#FF0000">14</font><font color="#808080">, </font>sreg<font color="#808080">)
      </font>nCont <font color="#808080">= </font>nCont <font color="#808080">+ </font><font color="#FF0000">1
    </font>end while
  elseif sreg<font color="#808080">=</font>ctArqs<font color="#808080">.</font>opVenda then
    sPreco <font color="#808080">= </font><font color="#800000">&quot;&quot;
    </font>sTotalPreco <font color="#808080">= </font><font color="#800000">&quot;&quot;
    </font>sQtd <font color="#808080">= </font>validaNumero<font color="#808080">(</font><font color="#800000">&quot;Quantos livros quer vender?: &quot;</font><font color="#808080">,</font>sQtd<font color="#808080">)
    </font>nQtd <font color="#808080">= </font><font color="#000080"><b>CInt</b></font><font color="#808080">(</font>sQtd<font color="#808080">)
    </font>nTotalPreco <font color="#808080">= </font><font color="#FF0000">0
    </font>while <font color="#808080">(</font>nCont <font color="#808080">&lt;= </font>nQtd<font color="#808080">) 
      </font>slinha <font color="#808080">= </font>validaEntrada<font color="#808080">(</font>tfLivro<font color="#808080">,</font>ctArqs<font color="#808080">.</font>opLivro<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font>tVenda<font color="#808080">.</font>isbn<font color="#808080">,</font><font color="#FF0000">3</font><font color="#808080">,</font><font color="#000080"><b>false</b></font><font color="#808080">,</font>ctTipo<font color="#808080">.</font>opTexto<font color="#808080">)
      </font>if slinha<font color="#808080">&lt;&gt;</font><font color="#800000">&quot;&quot; </font>then
    	tVenda<font color="#808080">.</font>isbn <font color="#808080">= </font><font color="#000080"><b>Trim</b></font><font color="#808080">(</font>mid<font color="#808080">(</font>slinha<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#FF0000">13</font><font color="#808080">))
</font>    	if ValidaISBN<font color="#808080">(</font>tVenda<font color="#808080">.</font>isbn<font color="#808080">) </font>then
    	  mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">)
</font>    	  tLivro<font color="#808080">.</font>qtdestoque <font color="#808080">= </font>mid<font color="#808080">(</font>slinha<font color="#808080">,</font><font color="#FF0000">134</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">).</font><font color="#000080"><b>Trim</b></font><font color="#808080">()
</font>    	  nQtdEstoque <font color="#808080">= </font><font color="#000080"><b>CInt</b></font><font color="#808080">(</font>tLivro<font color="#808080">.</font>qtdestoque<font color="#808080">)
</font>    	  if nQtdEstoque <font color="#808080">&gt; </font><font color="#FF0000">0 </font>then
            nTotalPreco <font color="#808080">= </font>nTotalPreco <font color="#808080">+ </font>g_nPreco
            sPreco <font color="#808080">= </font><font color="#000080"><b>CStr</b></font><font color="#808080">(</font>g_nPreco<font color="#808080">)
            </font>tVenda<font color="#808080">.</font>precovenda <font color="#808080">= </font>sPreco
            g_SalvarInclusao <font color="#808080">= </font><font color="#000080"><b>false
            </b></font>subMenu<font color="#808080">(</font><font color="#FF0000">14</font><font color="#808080">, </font>sreg<font color="#808080">)
            </font>if g_SalvarInclusao then
              slinha <font color="#808080">= </font>pesqArq<font color="#808080">(</font>tfLivro<font color="#808080">, </font>tVenda<font color="#808080">.</font>isbn<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">13</font><font color="#808080">, </font>tamReg<font color="#808080">(</font>ctArqs<font color="#808080">.</font>opLivro<font color="#808080">))
              </font>if slinha<font color="#808080">&lt;&gt;</font><font color="#800000">&quot;&quot; </font>then
                 nQtdEstoque <font color="#808080">= </font>nQtdEstoque<font color="#808080">-</font><font color="#FF0000">1
                 </font>tLivro<font color="#808080">.</font>qtdestoque <font color="#808080">= </font>nQtdEstoque<font color="#808080">.</font>ToString<font color="#808080">()
                 </font>slinha<font color="#808080">=</font>mid<font color="#808080">(</font>slinha<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#FF0000">133</font><font color="#808080">) + </font>esp<font color="#808080">(</font>tLivro<font color="#808080">.</font>qtdestoque<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">)
                 </font>escreveArq<font color="#808080">(</font>tfLivro<font color="#808080">, </font>slinha<font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">)
              </font>end if
            end if
            nCont <font color="#808080">= </font>nCont <font color="#808080">+ </font><font color="#FF0000">1
</font>    	  else 
            <font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font>MSG_SEMESTOQUE<font color="#808080">)
          </font>end if
    	else 
          <font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font>MSG_ISBNINV<font color="#808080">)
        </font>end if
      end if
    end while
    sTotalPreco <font color="#808080">= </font><font color="#000080"><b>CStr</b></font><font color="#808080">(</font>nTotalPreco<font color="#808080">)
    </font><font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;Total de &quot;</font><font color="#808080">+</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">,</font><font color="#FF0000">4</font><font color="#808080">)+</font>sTotalPreco<font color="#808080">)
  </font>end if
elseif sacao<font color="#808080">=</font>ctAcao<font color="#808080">.</font>opExcluir then
  if sreg<font color="#808080">=</font>ctArqs<font color="#808080">.</font>opLivroAss then
    ExcluirRegLigados<font color="#808080">(</font>tfLivroAss<font color="#808080">, </font>sreg<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">13</font><font color="#808080">, </font>sCodigo<font color="#808080">)
  </font>elseif sreg<font color="#808080">=</font>ctArqs<font color="#808080">.</font>opLivroAut then
    ExcluirRegLigados<font color="#808080">(</font>tfLivroAut<font color="#808080">, </font>sreg<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">13</font><font color="#808080">, </font>sCodigo<font color="#808080">)
  </font>end if
end if

end sub
<font color="#808080"><i>'------------------------------------------------------------------------------
'Realiza a exclus&atilde;o dos arquivos de liga&ccedil;&atilde;o.
'sArq - o arquivo de liga&ccedil;&atilde;o
'sreg - o tipo de arquivo de liga&ccedil;&atilde;o
'nPosChave - a posicao inicial da chave dentro do registro
'nTamChave - o tamanho da chave dentro do registro
'sChave - a chave a ser excluida
'------------------------------------------------------------------------------
</i></font>sub ExcluirRegLigados<font color="#808080">(</font>sArq as FileStream<font color="#808080">, </font>sreg as ctArqs<font color="#808080">, </font>_
    nPosChave as integer<font color="#808080">, </font>nTamChave as integer<font color="#808080">, </font>sChave as string<font color="#808080">) 
  </font>dim slinha as string <font color="#808080">= </font><font color="#800000">&quot;&quot;
  </font>dim sCodigo as string

  sArq<font color="#808080">.</font><font color="#000080"><b>Seek</b></font><font color="#808080">(</font><font color="#FF0000">0</font><font color="#808080">, </font>SeekOrigin<font color="#808080">.</font>Begin<font color="#808080">)
  </font>while <font color="#808080">(</font>not fimArq<font color="#808080">(</font>sArq<font color="#808080">))
    </font>slinha <font color="#808080">= </font>lerArq<font color="#808080">(</font>sArq<font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">), </font>TAM_CRLF<font color="#808080">)
    </font>if slinha<font color="#808080">&lt;&gt;</font><font color="#800000">&quot;&quot; </font>then
      sCodigo <font color="#808080">= </font><font color="#000080"><b>Trim</b></font><font color="#808080">(</font>mid<font color="#808080">(</font>slinha<font color="#808080">,</font>nPosChave<font color="#808080">,</font>nTamChave<font color="#808080">))
      </font>if sCodigo<font color="#808080">=</font>sChave then
        btnAcao<font color="#808080">(</font>sreg<font color="#808080">,</font>ctAcao<font color="#808080">.</font>opConfirmaExclusao<font color="#808080">)
      </font>end if 
    end if
  end while

end sub

<font color="#808080">&lt;</font>STAThread<font color="#808080">()&gt; </font><font color="#000080"><b>Shared Sub </b></font>Main<font color="#808080">(</font><font color="#000080"><b>ByVal </b></font>CmdArgs<font color="#808080">() </font><font color="#000080"><b>As String</b></font><font color="#808080">)
  </font><font color="#000080"><b>Dim </b></font>cl <font color="#000080"><b>As New </b></font>Livrus<font color="#808080">()

  </font><font color="#000080"><b>If </b></font>CmdArgs<font color="#808080">.</font>Length <font color="#808080">&gt; </font><font color="#FF0000">0 </font>then
    <font color="#000080"><b>If </b></font>CmdArgs<font color="#808080">(</font><font color="#FF0000">0</font><font color="#808080">)=</font><font color="#800000">&quot;-cria&quot; </font><font color="#000080"><b>Then
      </b></font>cl<font color="#808080">.</font>abrecriaArqs<font color="#808080">(</font><font color="#000080"><b>false</b></font><font color="#808080">)
    </font><font color="#000080"><b>End If 
  </b></font>else
    cl<font color="#808080">.</font>frmSplash<font color="#808080">()
    </font>cl<font color="#808080">.</font>abrecriaArqs<font color="#808080">(</font><font color="#000080"><b>true</b></font><font color="#808080">)
    </font>if cl<font color="#808080">.</font>frmLogin<font color="#808080">() </font>then
      cl<font color="#808080">.</font>bopcao <font color="#808080">= </font><font color="#000080"><b>true
      </b></font>while cl<font color="#808080">.</font>bopcao
        cl<font color="#808080">.</font>menu<font color="#808080">(</font><font color="#FF0000">1</font><font color="#808080">)
        </font>cl<font color="#808080">.</font>opmenu <font color="#808080">= </font>GetChar<font color="#808080">(</font><font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font><font color="#000080"><b>In</b></font><font color="#808080">.</font>ReadLine<font color="#808080">(),</font><font color="#FF0000">1</font><font color="#808080">)
        </font>if <font color="#808080">(</font>cl<font color="#808080">.</font>opmenu<font color="#808080">=</font><font color="#800000">&quot;C&quot;</font>C<font color="#808080">) </font>or <font color="#808080">(</font>cl<font color="#808080">.</font>opmenu<font color="#808080">=</font><font color="#800000">&quot;c&quot;</font>C<font color="#808080">) </font>then
          cl<font color="#808080">.</font>usaMenu<font color="#808080">(</font><font color="#FF0000">1</font><font color="#808080">)
        </font>elseif <font color="#808080">(</font>cl<font color="#808080">.</font>opmenu<font color="#808080">=</font><font color="#800000">&quot;P&quot;</font>C<font color="#808080">) </font>or <font color="#808080">(</font>cl<font color="#808080">.</font>opmenu<font color="#808080">=</font><font color="#800000">&quot;p&quot;</font>C<font color="#808080">) </font>then
          cl<font color="#808080">.</font>usaMenu<font color="#808080">(</font><font color="#FF0000">2</font><font color="#808080">)
        </font>elseif <font color="#808080">(</font>cl<font color="#808080">.</font>opmenu<font color="#808080">=</font><font color="#800000">&quot;V&quot;</font>C<font color="#808080">) </font>or <font color="#808080">(</font>cl<font color="#808080">.</font>opmenu<font color="#808080">=</font><font color="#800000">&quot;v&quot;</font>C<font color="#808080">) </font>then
          cl<font color="#808080">.</font>usaMenu<font color="#808080">(</font><font color="#FF0000">3</font><font color="#808080">)
        </font>elseif <font color="#808080">(</font>cl<font color="#808080">.</font>opmenu<font color="#808080">=</font><font color="#800000">&quot;O&quot;</font>C<font color="#808080">) </font>or <font color="#808080">(</font>cl<font color="#808080">.</font>opmenu<font color="#808080">=</font><font color="#800000">&quot;o&quot;</font>C<font color="#808080">) </font>then
          cl<font color="#808080">.</font>usaMenu<font color="#808080">(</font><font color="#FF0000">4</font><font color="#808080">)
        </font>else 
          <font color="#0000FF"><b>System</b></font><font color="#808080">.</font><font color="#0000FF"><b>Console</b></font><font color="#808080">.</font>WriteLine<font color="#808080">(</font>cl<font color="#808080">.</font>MSG_ERRO<font color="#808080">)
        </font>end if
      end while
    else
      cl<font color="#808080">.</font>fechaArqs<font color="#808080">()
      </font><font color="#0000FF"><b>System</b></font><font color="#808080">.</font>Environment<font color="#808080">.</font><font color="#000080"><b>Exit</b></font><font color="#808080">(</font><font color="#FF0000">0</font><font color="#808080">)
    </font>end if
  <font color="#000080"><b>End If
  </b></font><font color="#0000FF"><b>System</b></font><font color="#808080">.</font>Environment<font color="#808080">.</font><font color="#000080"><b>Exit</b></font><font color="#808080">(</font><font color="#FF0000">0</font><font color="#808080">)
</font><font color="#000080"><b>End Sub

End Class

End </b></font>NameSpace
</font>
</code></pre>
</body>
</html>