<html>
<head>
<title>Livrus Virtus - Console - Fortran 77</title>
</head>
<!-- Generated by ConTEXT HTML exporter -->
<body text="#000000" bgcolor="#FFFFFF">
<pre>
<code><font  face="Courier New"><font color="#808080"><i>C     ------------------------------------------------------------------
C     Sistema integrante do projeto Livrus Virtus.
C     Todos os direitos reservados para Henrique F. de Souza.
C     Vers&atilde;o programada na linguagem fortran 77.
C     ------------------------------------------------------------------
      </i></font><font color="#0000FF">program </font><font color="#000080">Livrus
      </font><font color="#0000FF">include </font><font color="#800000">'livrus.h'
</font><font color="#808080"><i>C     ---------
C     variaveis
C     ---------
      </i></font><font color="#0000FF">logical </font><font color="#000080">bopcao</font><font color="#808080">, </font><font color="#000080">frmlogin
      </font><font color="#0000FF">character</font><font color="#808080">*</font><font color="#FF0000">255 </font><font color="#000080">repete</font><font color="#808080">, </font><font color="#000080">srepete</font><font color="#808080">, </font><font color="#000080">retDataHora</font><font color="#808080">, </font><font color="#000080">ftrim
      </font><font color="#0000FF">character </font><font color="#000080">opmenu
      </font><font color="#0000FF">character </font><font color="#000080">sarg      
      </font><font color="#0000FF">integer </font><font color="#000080">modulo11
</font><font color="#808080"><i>C     ------------------------------------------------------------------
C     Parte inicial do c&oacute;digo
C     ------------------------------------------------------------------
      </i></font><font color="#0000FF">Call </font><font color="#000080">GetArg</font><font color="#808080">(</font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#000080">sarg</font><font color="#808080">)
      </font><font color="#0000FF">if </font><font color="#808080">(</font><font color="#000080">sarg</font><font color="#0000FF">.eq.</font><font color="#800000">'-cria'</font><font color="#808080">) </font><font color="#0000FF">then
         call </font><font color="#000080">abrecriaArqs</font><font color="#808080">(</font><font color="#0000FF">.false.</font><font color="#808080">)
      </font><font color="#0000FF">else
        call </font><font color="#000080">frmSplash
        </font><font color="#0000FF">call </font><font color="#000080">abrecriaArqs</font><font color="#808080">(</font><font color="#0000FF">.true.</font><font color="#808080">)
        </font><font color="#0000FF">if </font><font color="#808080">(</font><font color="#000080">frmLogin</font><font color="#808080">() </font><font color="#000080">.eqv. </font><font color="#0000FF">.true.</font><font color="#808080">) </font><font color="#0000FF">then
          </font><font color="#000080">bopcao </font><font color="#808080">= </font><font color="#0000FF">.true.
          do while </font><font color="#808080">(</font><font color="#000080">bopcao</font><font color="#808080">)
           </font><font color="#0000FF">call </font><font color="#000080">menu</font><font color="#808080">(</font><font color="#FF0000">1</font><font color="#808080">)
           </font><font color="#0000FF">read</font><font color="#808080">(*,</font><font color="#800000">'(A1)'</font><font color="#808080">) </font><font color="#000080">opmenu
           </font><font color="#0000FF">if </font><font color="#808080">(</font><font color="#000080">opmenu</font><font color="#0000FF">.eq.</font><font color="#800000">'C' </font><font color="#0000FF">.or. </font><font color="#000080">opmenu</font><font color="#0000FF">.eq.</font><font color="#800000">'c'</font><font color="#808080">) </font><font color="#0000FF">then
             call </font><font color="#000080">usaMenu</font><font color="#808080">(</font><font color="#FF0000">1</font><font color="#808080">)
           </font><font color="#0000FF">else if </font><font color="#808080">(</font><font color="#000080">opmenu</font><font color="#0000FF">.eq.</font><font color="#800000">'P' </font><font color="#0000FF">.or. </font><font color="#000080">opmenu</font><font color="#0000FF">.eq.</font><font color="#800000">'p'</font><font color="#808080">) </font><font color="#0000FF">then
             call </font><font color="#000080">usaMenu</font><font color="#808080">(</font><font color="#FF0000">2</font><font color="#808080">)
           </font><font color="#0000FF">else if </font><font color="#808080">(</font><font color="#000080">opmenu</font><font color="#0000FF">.eq.</font><font color="#800000">'V' </font><font color="#0000FF">.or. </font><font color="#000080">opmenu</font><font color="#0000FF">.eq.</font><font color="#800000">'v'</font><font color="#808080">) </font><font color="#0000FF">then
             call </font><font color="#000080">usaMenu</font><font color="#808080">(</font><font color="#FF0000">3</font><font color="#808080">)
           </font><font color="#0000FF">else if </font><font color="#808080">(</font><font color="#000080">opmenu</font><font color="#0000FF">.eq.</font><font color="#800000">'O' </font><font color="#0000FF">.or. </font><font color="#000080">opmenu</font><font color="#0000FF">.eq.</font><font color="#800000">'o'</font><font color="#808080">) </font><font color="#0000FF">then
             call </font><font color="#000080">usaMenu</font><font color="#808080">(</font><font color="#FF0000">4</font><font color="#808080">)
           </font><font color="#0000FF">else
             write</font><font color="#808080">(*,*) </font><font color="#000080">MSG_ERRO
           </font><font color="#0000FF">end if
          end do
        else
         call </font><font color="#000080">fechaArqs
         </font><font color="#0000FF">stop
        end if
      end if

      stop
      end
</font><font color="#808080"><i>C     ------------------------------------------------------------------
C     Bloco de dados
C     ------------------------------------------------------------------
      </i></font><font color="#000080">block </font><font color="#0000FF">data
      include </font><font color="#800000">'livrus.h'
</font><font color="#808080"><i>C     ctTipo
      </i></font><font color="#0000FF">data </font><font color="#000080">opTexto </font><font color="#808080">/</font><font color="#FF0000">1</font><font color="#808080">/ 
      </font><font color="#0000FF">data </font><font color="#000080">opNumero </font><font color="#808080">/</font><font color="#FF0000">2</font><font color="#808080">/
      </font><font color="#0000FF">data </font><font color="#000080">opData </font><font color="#808080">/</font><font color="#FF0000">3</font><font color="#808080">/
      </font><font color="#0000FF">data </font><font color="#000080">opDataHora </font><font color="#808080">/</font><font color="#FF0000">4</font><font color="#808080">/
      </font><font color="#0000FF">data </font><font color="#000080">opSenha </font><font color="#808080">/</font><font color="#FF0000">5</font><font color="#808080">/
<i>C     ctArqs
      </i></font><font color="#0000FF">data </font><font color="#000080">opAssunto </font><font color="#808080">/</font><font color="#FF0000">1</font><font color="#808080">/
      </font><font color="#0000FF">data </font><font color="#000080">opAutor </font><font color="#808080">/</font><font color="#FF0000">2</font><font color="#808080">/
      </font><font color="#0000FF">data </font><font color="#000080">opEditora </font><font color="#808080">/</font><font color="#FF0000">3</font><font color="#808080">/
      </font><font color="#0000FF">data </font><font color="#000080">opEndereco </font><font color="#808080">/</font><font color="#FF0000">4</font><font color="#808080">/
      </font><font color="#0000FF">data </font><font color="#000080">opIdioma </font><font color="#808080">/</font><font color="#FF0000">5</font><font color="#808080">/
      </font><font color="#0000FF">data </font><font color="#000080">opPais </font><font color="#808080">/</font><font color="#FF0000">6</font><font color="#808080">/
      </font><font color="#0000FF">data </font><font color="#000080">opProfissao </font><font color="#808080">/</font><font color="#FF0000">7</font><font color="#808080">/
      </font><font color="#0000FF">data </font><font color="#000080">opCliente </font><font color="#808080">/</font><font color="#FF0000">8</font><font color="#808080">/
      </font><font color="#0000FF">data </font><font color="#000080">opLivro </font><font color="#808080">/</font><font color="#FF0000">9</font><font color="#808080">/
      </font><font color="#0000FF">data </font><font color="#000080">opLivroAss </font><font color="#808080">/</font><font color="#FF0000">10</font><font color="#808080">/
      </font><font color="#0000FF">data </font><font color="#000080">opLivroAut </font><font color="#808080">/</font><font color="#FF0000">11</font><font color="#808080">/
      </font><font color="#0000FF">data </font><font color="#000080">opUsuario </font><font color="#808080">/</font><font color="#FF0000">12</font><font color="#808080">/
      </font><font color="#0000FF">data </font><font color="#000080">opVenda </font><font color="#808080">/</font><font color="#FF0000">13</font><font color="#808080">/
<i>C     ctAcao
      </i></font><font color="#0000FF">data </font><font color="#000080">opNovo </font><font color="#808080">/</font><font color="#FF0000">1</font><font color="#808080">/
      </font><font color="#0000FF">data </font><font color="#000080">opAlterar </font><font color="#808080">/</font><font color="#FF0000">2</font><font color="#808080">/
      </font><font color="#0000FF">data </font><font color="#000080">opPesquisar </font><font color="#808080">/</font><font color="#FF0000">3</font><font color="#808080">/
      </font><font color="#0000FF">data </font><font color="#000080">opSalvarInclusao </font><font color="#808080">/</font><font color="#FF0000">4</font><font color="#808080">/
      </font><font color="#0000FF">data </font><font color="#000080">opSalvarAlteracao </font><font color="#808080">/</font><font color="#FF0000">5</font><font color="#808080">/
      </font><font color="#0000FF">data </font><font color="#000080">opExcluir </font><font color="#808080">/</font><font color="#FF0000">6</font><font color="#808080">/
      </font><font color="#0000FF">data </font><font color="#000080">opConfirmaExclusao </font><font color="#808080">/</font><font color="#FF0000">7</font><font color="#808080">/
      </font><font color="#0000FF">data </font><font color="#000080">opListarTodos </font><font color="#808080">/</font><font color="#FF0000">8</font><font color="#808080">/

      </font><font color="#0000FF">data </font><font color="#000080">TAM_CRLF </font><font color="#808080">/</font><font color="#FF0000">2</font><font color="#808080">/
      </font><font color="#0000FF">data </font><font color="#000080">QTD_MAX_LINHA </font><font color="#808080">/</font><font color="#FF0000">18</font><font color="#808080">/
      </font><font color="#0000FF">data </font><font color="#000080">MSG_ERRO </font><font color="#808080">/ </font><font color="#800000">'Erro: opcao invalida digite de novo' </font><font color="#808080">/
      </font><font color="#0000FF">data </font><font color="#000080">MSG_OPCAO </font><font color="#808080">/ </font><font color="#800000">'Escolha uma op&ccedil;&atilde;o: ' </font><font color="#808080">/
      </font><font color="#0000FF">data </font><font color="#000080">MSG_PRESS </font><font color="#808080">/ </font><font color="#800000">'pressione para continuar...' </font><font color="#808080">/
      </font><font color="#0000FF">data </font><font color="#000080">MSG_ARQERRO </font><font color="#808080">/ </font><font color="#800000">'Erro: O arquivo n&atilde;o pode ser aberto.' </font><font color="#808080">/ 

      </font><font color="#0000FF">data </font><font color="#000080">MSG_REGINC </font><font color="#808080">/ </font><font color="#800000">'registro incluido!' </font><font color="#808080">/
      </font><font color="#0000FF">data </font><font color="#000080">MSG_REGNINC </font><font color="#808080">/ </font><font color="#800000">'registro n&atilde;o incluido!' </font><font color="#808080">/
      </font><font color="#0000FF">data </font><font color="#000080">MSG_REGALT </font><font color="#808080">/ </font><font color="#800000">'registro alterado!' </font><font color="#808080">/
      </font><font color="#0000FF">data </font><font color="#000080">MSG_REGNALT </font><font color="#808080">/ </font><font color="#800000">'registro n&atilde;o alterado!' </font><font color="#808080">/
      </font><font color="#0000FF">data </font><font color="#000080">MSG_REGEXC </font><font color="#808080">/ </font><font color="#800000">'registro excluido!' </font><font color="#808080">/
      </font><font color="#0000FF">data </font><font color="#000080">MSG_REGNEXC </font><font color="#808080">/ </font><font color="#800000">'registro n&atilde;o excluido!' </font><font color="#808080">/
      </font><font color="#0000FF">data </font><font color="#000080">MSG_REGEXST </font><font color="#808080">/ </font><font color="#800000">'registro j&aacute; existe!' </font><font color="#808080">/

      </font><font color="#0000FF">data </font><font color="#000080">MSG_NUMINV </font><font color="#808080">/ </font><font color="#800000">'N&uacute;mero inv&aacute;lido ou menor do que 1!' </font><font color="#808080">/
      </font><font color="#0000FF">data </font><font color="#000080">MSG_DATAINV </font><font color="#808080">/ </font><font color="#800000">'Data inv&aacute;lida!, formato correto (dd/mm/yyyy)'</font><font color="#808080">/
      </font><font color="#0000FF">data </font><font color="#000080">MSG_DTHRINV </font><font color="#808080">/ 
     *</font><font color="#800000">'Data/hora inv&aacute;lida!, formato correto (dd/mm/yyyy hh:mm:ss)' </font><font color="#808080">/
      </font><font color="#0000FF">data </font><font color="#000080">MSG_ISBNINV </font><font color="#808080">/ </font><font color="#800000">'ISBN inv&aacute;lido!' </font><font color="#808080">/
      </font><font color="#0000FF">data </font><font color="#000080">MSG_CPFINV </font><font color="#808080">/ </font><font color="#800000">'CPF inv&aacute;lido!' </font><font color="#808080">/
      </font><font color="#0000FF">data </font><font color="#000080">MSG_SENCONFERE </font><font color="#808080">/ </font><font color="#800000">'senha n&atilde;o confere com a senha atual!' </font><font color="#808080">/
      </font><font color="#0000FF">data </font><font color="#000080">MSG_SENCONFIRM </font><font color="#808080">/ 
     *</font><font color="#800000">'nova senha n&atilde;o confere com a senha confirmada!' </font><font color="#808080">/
      </font><font color="#0000FF">data </font><font color="#000080">MSG_LOGINENCON </font><font color="#808080">/ </font><font color="#800000">'login n&atilde;o encontrado!' </font><font color="#808080">/
      </font><font color="#0000FF">data </font><font color="#000080">MSG_SEMESTOQUE </font><font color="#808080">/ </font><font color="#800000">'livro n&atilde;o existe no estoque!' </font><font color="#808080">/

      </font><font color="#0000FF">data </font><font color="#000080">ARQ_ASSUNTO </font><font color="#808080">/</font><font color="#800000">'assunto.dat'</font><font color="#808080">/
      </font><font color="#0000FF">data </font><font color="#000080">ARQ_AUTOR </font><font color="#808080">/</font><font color="#800000">'autor.dat'</font><font color="#808080">/
      </font><font color="#0000FF">data </font><font color="#000080">ARQ_EDITORA </font><font color="#808080">/</font><font color="#800000">'editora.dat'</font><font color="#808080">/
      </font><font color="#0000FF">data </font><font color="#000080">ARQ_IDIOMA </font><font color="#808080">/</font><font color="#800000">'idioma.dat'</font><font color="#808080">/
      </font><font color="#0000FF">data </font><font color="#000080">ARQ_USUARIO </font><font color="#808080">/</font><font color="#800000">'usuario.dat'</font><font color="#808080">/
      </font><font color="#0000FF">data </font><font color="#000080">ARQ_PAIS </font><font color="#808080">/</font><font color="#800000">'pais.dat'</font><font color="#808080">/
      </font><font color="#0000FF">data </font><font color="#000080">ARQ_PROFISSAO </font><font color="#808080">/</font><font color="#800000">'profissao.dat'</font><font color="#808080">/
      </font><font color="#0000FF">data </font><font color="#000080">ARQ_LIVRO </font><font color="#808080">/</font><font color="#800000">'livro.dat'</font><font color="#808080">/
      </font><font color="#0000FF">data </font><font color="#000080">ARQ_LIVASS </font><font color="#808080">/</font><font color="#800000">'livroass.dat'</font><font color="#808080">/
      </font><font color="#0000FF">data </font><font color="#000080">ARQ_LIVAUT </font><font color="#808080">/</font><font color="#800000">'livroaut.dat'</font><font color="#808080">/
      </font><font color="#0000FF">data </font><font color="#000080">ARQ_CLIENTE </font><font color="#808080">/</font><font color="#800000">'cliente.dat'</font><font color="#808080">/
      </font><font color="#0000FF">data </font><font color="#000080">ARQ_ENDERECO </font><font color="#808080">/</font><font color="#800000">'endereco.dat'</font><font color="#808080">/
      </font><font color="#0000FF">data </font><font color="#000080">ARQ_VENDA </font><font color="#808080">/</font><font color="#800000">'venda.dat'</font><font color="#808080">/

      </font><font color="#0000FF">data </font><font color="#000080">TAM_ASSUNTO </font><font color="#808080">/</font><font color="#FF0000">40</font><font color="#808080">/
      </font><font color="#0000FF">data </font><font color="#000080">TAM_AUTOR </font><font color="#808080">/</font><font color="#FF0000">40</font><font color="#808080">/
      </font><font color="#0000FF">data </font><font color="#000080">TAM_EDITORA </font><font color="#808080">/</font><font color="#FF0000">60</font><font color="#808080">/
      </font><font color="#0000FF">data </font><font color="#000080">TAM_IDIOMA </font><font color="#808080">/</font><font color="#FF0000">30</font><font color="#808080">/
      </font><font color="#0000FF">data </font><font color="#000080">TAM_USUARIO </font><font color="#808080">/</font><font color="#FF0000">20</font><font color="#808080">/
      </font><font color="#0000FF">data </font><font color="#000080">TAM_PAIS </font><font color="#808080">/</font><font color="#FF0000">53</font><font color="#808080">/
      </font><font color="#0000FF">data </font><font color="#000080">TAM_PROFISSAO </font><font color="#808080">/</font><font color="#FF0000">60</font><font color="#808080">/
      </font><font color="#0000FF">data </font><font color="#000080">TAM_LIVRO </font><font color="#808080">/</font><font color="#FF0000">143</font><font color="#808080">/
      </font><font color="#0000FF">data </font><font color="#000080">TAM_LIVASS </font><font color="#808080">/</font><font color="#FF0000">23</font><font color="#808080">/
      </font><font color="#0000FF">data </font><font color="#000080">TAM_LIVAUT </font><font color="#808080">/</font><font color="#FF0000">23</font><font color="#808080">/
      </font><font color="#0000FF">data </font><font color="#000080">TAM_CLIENTE </font><font color="#808080">/</font><font color="#FF0000">135</font><font color="#808080">/
      </font><font color="#0000FF">data </font><font color="#000080">TAM_ENDERECO </font><font color="#808080">/</font><font color="#FF0000">123</font><font color="#808080">/
      </font><font color="#0000FF">data </font><font color="#000080">TAM_VENDA </font><font color="#808080">/</font><font color="#FF0000">56</font><font color="#808080">/
</font>	
      <font color="#0000FF">data </font><font color="#000080">tfAssunto </font><font color="#808080">/</font><font color="#FF0000">1</font><font color="#808080">/
      </font><font color="#0000FF">data </font><font color="#000080">tfAutor </font><font color="#808080">/</font><font color="#FF0000">2</font><font color="#808080">/
      </font><font color="#0000FF">data </font><font color="#000080">tfEditora </font><font color="#808080">/</font><font color="#FF0000">3</font><font color="#808080">/
      </font><font color="#0000FF">data </font><font color="#000080">tfIdioma </font><font color="#808080">/</font><font color="#FF0000">4</font><font color="#808080">/ 
      </font><font color="#0000FF">data </font><font color="#000080">tfEndereco </font><font color="#808080">/</font><font color="#FF0000">5</font><font color="#808080">/
      </font><font color="#0000FF">data </font><font color="#000080">tfPais </font><font color="#808080">/</font><font color="#FF0000">6</font><font color="#808080">/
      </font><font color="#0000FF">data </font><font color="#000080">tfProfissao </font><font color="#808080">/</font><font color="#FF0000">7</font><font color="#808080">/  
      </font><font color="#0000FF">data </font><font color="#000080">tfLivro </font><font color="#808080">/</font><font color="#FF0000">8</font><font color="#808080">/ 
      </font><font color="#0000FF">data </font><font color="#000080">tfLivroAss </font><font color="#808080">/</font><font color="#FF0000">9</font><font color="#808080">/
      </font><font color="#0000FF">data </font><font color="#000080">tfLivroAut </font><font color="#808080">/</font><font color="#FF0000">10</font><font color="#808080">/
      </font><font color="#0000FF">data </font><font color="#000080">tfCliente </font><font color="#808080">/</font><font color="#FF0000">11</font><font color="#808080">/
      </font><font color="#0000FF">data </font><font color="#000080">tfUsuario </font><font color="#808080">/</font><font color="#FF0000">12</font><font color="#808080">/ 
      </font><font color="#0000FF">data </font><font color="#000080">tfVenda </font><font color="#808080">/</font><font color="#FF0000">13</font><font color="#808080">/

      </font><font color="#0000FF">end

</font><font color="#808080"><i>C     ------------------------------------------------------------------
C     Fun&ccedil;&atilde;o que retorna o tamanho de uma string.
C     sTexto - indica a string
C     retorna - o tamanho da string
C     ------------------------------------------------------------------
      </i></font><font color="#0000FF">integer function </font><font color="#000080">TamStr</font><font color="#808080">(</font><font color="#000080">sTexto</font><font color="#808080">)
      </font><font color="#0000FF">character</font><font color="#808080">*(*) </font><font color="#000080">sTexto

      </font><font color="#0000FF">integer </font><font color="#000080">ncont

      TamStr </font><font color="#808080">= </font><font color="#000080">LEN</font><font color="#808080">(</font><font color="#000080">sTexto</font><font color="#808080">)
      </font><font color="#0000FF">do </font><font color="#000080">ncont</font><font color="#808080">=</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#000080">TamStr
        </font><font color="#0000FF">if </font><font color="#808080">(</font><font color="#000080">sTexto</font><font color="#808080">(</font><font color="#000080">ncont:ncont</font><font color="#808080">)</font><font color="#000080">.EQ.char</font><font color="#808080">(</font><font color="#FF0000">0</font><font color="#808080">)) </font><font color="#0000FF">then
          </font><font color="#000080">TamStr </font><font color="#808080">= </font><font color="#000080">ncont</font><font color="#808080">-</font><font color="#FF0000">1
          </font><font color="#0000FF">exit
        end if
      end do
      return
      end
</font><font color="#808080"><i>C     ------------------------------------------------------------------
C     Fun&ccedil;&atilde;o que concatena uma string com a outra.
C     sDestino - indica a string a ser retornada
C     sOrigem  - indica a string a ser somada
C     retorna - a string concatenada
C     ------------------------------------------------------------------
      </i></font><font color="#0000FF">subroutine </font><font color="#000080">SomaStr</font><font color="#808080">(</font><font color="#000080">sDestino</font><font color="#808080">,</font><font color="#000080">sOrigem</font><font color="#808080">)
      </font><font color="#0000FF">character</font><font color="#808080">*(*) </font><font color="#000080">sDestino</font><font color="#808080">,</font><font color="#000080">sOrigem

      </font><font color="#0000FF">integer </font><font color="#000080">nDestino</font><font color="#808080">,</font><font color="#000080">nOrigem</font><font color="#808080">,</font><font color="#000080">TamStr

      nDestino </font><font color="#808080">= </font><font color="#000080">TamStr</font><font color="#808080">(</font><font color="#000080">sDestino</font><font color="#808080">)
      </font><font color="#000080">nOrigem </font><font color="#808080">= </font><font color="#000080">TamStr</font><font color="#808080">(</font><font color="#000080">sOrigem</font><font color="#808080">)
      </font><font color="#000080">sDestino</font><font color="#808080">(</font><font color="#000080">nDestino</font><font color="#808080">+</font><font color="#FF0000">1</font><font color="#000080">:</font><font color="#808080">) = </font><font color="#000080">sOrigem
      sDestino</font><font color="#808080">(</font><font color="#000080">nDestino</font><font color="#808080">+</font><font color="#000080">nOrigem</font><font color="#808080">+</font><font color="#FF0000">1</font><font color="#000080">:</font><font color="#808080">) = </font><font color="#000080">char</font><font color="#808080">(</font><font color="#FF0000">0</font><font color="#808080">)
      </font><font color="#0000FF">return
      end
</font><font color="#808080"><i>C     ------------------------------------------------------------------
C     Fun&ccedil;&atilde;o que insere uma string num determinado indice.
C     sDestino - indica a string a ser retornada
C     sOrigem  - indica a string a ser inserida
C     nIndice  - indica a posicao na string
C     retorna - a string inserida
C     ------------------------------------------------------------------
      </i></font><font color="#0000FF">subroutine </font><font color="#000080">InsereStr</font><font color="#808080">(</font><font color="#000080">sDestino</font><font color="#808080">,</font><font color="#000080">sOrigem</font><font color="#808080">,</font><font color="#000080">nIndice</font><font color="#808080">)
      </font><font color="#0000FF">character</font><font color="#808080">*(*) </font><font color="#000080">sDestino</font><font color="#808080">,</font><font color="#000080">sOrigem
      </font><font color="#0000FF">integer </font><font color="#000080">nIndice

      </font><font color="#0000FF">integer </font><font color="#000080">ntam</font><font color="#808080">,</font><font color="#000080">TamStr

      ntam </font><font color="#808080">= </font><font color="#000080">TamStr</font><font color="#808080">(</font><font color="#000080">sOrigem</font><font color="#808080">)
      </font><font color="#000080">sDestino</font><font color="#808080">(</font><font color="#000080">ntam</font><font color="#808080">+</font><font color="#000080">nIndice:</font><font color="#808080">) = </font><font color="#000080">sDestino</font><font color="#808080">(</font><font color="#000080">nIndice:</font><font color="#808080">)
      </font><font color="#000080">sDestino</font><font color="#808080">(</font><font color="#000080">nIndice:ntam</font><font color="#808080">+</font><font color="#000080">nIndice</font><font color="#808080">-</font><font color="#FF0000">1</font><font color="#808080">) = </font><font color="#000080">sOrigem</font><font color="#808080">(</font><font color="#000080">:ntam</font><font color="#808080">)
      </font><font color="#0000FF">return
      end
</font><font color="#808080"><i>C     ------------------------------------------------------------------
C     Fun&ccedil;&atilde;o que converte de string para inteiro
C     sTexto - indica a string
C     retorna - o inteiro convertido
C     ------------------------------------------------------------------
      </i></font><font color="#0000FF">integer function </font><font color="#000080">StrToInt</font><font color="#808080">(</font><font color="#000080">sTexto</font><font color="#808080">)
      </font><font color="#0000FF">character</font><font color="#808080">*(*) </font><font color="#000080">sTexto

      </font><font color="#0000FF">integer </font><font color="#000080">ncont</font><font color="#808080">,</font><font color="#000080">TamStr</font><font color="#808080">,</font><font color="#000080">nnum</font><font color="#808080">,</font><font color="#000080">vnum

      StrToInt </font><font color="#808080">= </font><font color="#FF0000">0
      </font><font color="#000080">nnum </font><font color="#808080">= </font><font color="#FF0000">1
      </font><font color="#0000FF">do </font><font color="#000080">ncont</font><font color="#808080">=</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#000080">TamStr</font><font color="#808080">(</font><font color="#000080">sTexto</font><font color="#808080">)
        </font><font color="#000080">vnum </font><font color="#808080">= </font><font color="#000080">ICHAR</font><font color="#808080">(</font><font color="#000080">sTexto</font><font color="#808080">(</font><font color="#000080">ncont:ncont</font><font color="#808080">))
        </font><font color="#0000FF">select case </font><font color="#808080">(</font><font color="#000080">vnum</font><font color="#808080">)
          </font><font color="#0000FF">case </font><font color="#808080">(</font><font color="#FF0000">45</font><font color="#808080">) <i>!ICHAR('-')
            </i></font><font color="#0000FF">if </font><font color="#808080">(</font><font color="#000080">ncont</font><font color="#0000FF">.EQ.</font><font color="#FF0000">1</font><font color="#808080">) </font><font color="#0000FF">then
              </font><font color="#000080">nnum </font><font color="#808080">= -</font><font color="#FF0000">1
            </font><font color="#0000FF">else
              return
            endif
          case </font><font color="#808080">(</font><font color="#FF0000">48</font><font color="#000080">:</font><font color="#FF0000">57</font><font color="#808080">)
            </font><font color="#000080">StrToInt </font><font color="#808080">= </font><font color="#000080">StrToInt</font><font color="#808080">*</font><font color="#FF0000">10 </font><font color="#808080">+ (</font><font color="#000080">vnum</font><font color="#808080">-</font><font color="#FF0000">48</font><font color="#808080">)
          </font><font color="#0000FF">case default
            return
        end select
      end do
      </font><font color="#000080">StrToInt </font><font color="#808080">= </font><font color="#000080">StrToInt</font><font color="#808080">*</font><font color="#000080">nnum
      </font><font color="#0000FF">return
      end
</font><font color="#808080"><i>C     ------------------------------------------------------------------
C     Fun&ccedil;&atilde;o que converte de inteiro para string
C     nNumero - indica o numero a ser convertido
C     retorna - a string convertida
C     ------------------------------------------------------------------
      </i></font><font color="#0000FF">character</font><font color="#808080">*(*) </font><font color="#0000FF">function </font><font color="#000080">IntToStr</font><font color="#808080">(</font><font color="#000080">nNumero</font><font color="#808080">)
      </font><font color="#0000FF">integer </font><font color="#000080">nNumero

      </font><font color="#0000FF">integer </font><font color="#000080">ncont

      ncont </font><font color="#808080">= </font><font color="#000080">ABS</font><font color="#808080">(</font><font color="#000080">nNumero</font><font color="#808080">)
      </font><font color="#000080">IntToStr </font><font color="#808080">= </font><font color="#000080">char</font><font color="#808080">(</font><font color="#FF0000">0</font><font color="#808080">)
      </font><font color="#0000FF">do while </font><font color="#808080">(</font><font color="#000080">ncont</font><font color="#0000FF">.GE.</font><font color="#FF0000">10</font><font color="#808080">)
        </font><font color="#0000FF">call </font><font color="#000080">InsereStr</font><font color="#808080">(</font><font color="#000080">IntToStr</font><font color="#808080">,</font><font color="#000080">CHAR</font><font color="#808080">(</font><font color="#000080">MOD</font><font color="#808080">(</font><font color="#000080">ncont</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">)+</font><font color="#FF0000">48</font><font color="#808080">),</font><font color="#FF0000">1</font><font color="#808080">)
        </font><font color="#000080">ncont </font><font color="#808080">= </font><font color="#000080">ncont </font><font color="#808080">/ </font><font color="#FF0000">10
      </font><font color="#0000FF">end do
      call </font><font color="#000080">InsereStr</font><font color="#808080">(</font><font color="#000080">IntToStr</font><font color="#808080">,</font><font color="#000080">CHAR</font><font color="#808080">(</font><font color="#000080">MOD</font><font color="#808080">(</font><font color="#000080">ncont</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">)+</font><font color="#FF0000">48</font><font color="#808080">),</font><font color="#FF0000">1</font><font color="#808080">)
      </font><font color="#0000FF">if </font><font color="#808080">(</font><font color="#000080">nNumero</font><font color="#0000FF">.LT.</font><font color="#FF0000">0</font><font color="#808080">) </font><font color="#0000FF">then
        call </font><font color="#000080">InsereStr</font><font color="#808080">(</font><font color="#000080">IntToStr</font><font color="#808080">,</font><font color="#800000">'-'</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">)
      </font><font color="#0000FF">endif
      return
      end
</font><font color="#808080"><i>C     ------------------------------------------------------------------
C     Fun&ccedil;&atilde;o que retorna um peda&ccedil;o de uma string.
C     str - indica a string
C     ini - indica a posicao inicial do pedaco
C     tam - indica o tamanho do pedaco
C     retorna - o peda&ccedil;o da string
C     ------------------------------------------------------------------
      </i></font><font color="#0000FF">character</font><font color="#808080">*(*) </font><font color="#0000FF">function </font><font color="#000080">copy</font><font color="#808080">(</font><font color="#000080">stexto</font><font color="#808080">,</font><font color="#000080">nini</font><font color="#808080">,</font><font color="#000080">ntam</font><font color="#808080">)
      </font><font color="#0000FF">character</font><font color="#808080">*</font><font color="#FF0000">255 </font><font color="#000080">stexto
      </font><font color="#0000FF">integer </font><font color="#000080">nini</font><font color="#808080">, </font><font color="#000080">ntam

      ntam </font><font color="#808080">= </font><font color="#000080">nini</font><font color="#808080">+</font><font color="#000080">ntam</font><font color="#808080">-</font><font color="#FF0000">1
      </font><font color="#000080">copy </font><font color="#808080">= </font><font color="#000080">stexto</font><font color="#808080">(</font><font color="#000080">nini:ntam</font><font color="#808080">)
      </font><font color="#0000FF">return
      end

</font><font color="#808080"><i>C     ------------------------------------------------------------------
C     Retira os espa&ccedil;os em branco antes ou depois do texto.
C     sTexto - o texto a ser retirado os espa&ccedil;os em branco
C     retorna - o texto sem os espa&ccedil;os em branco
C     ------------------------------------------------------------------
      </i></font><font color="#0000FF">character</font><font color="#808080">*(*) </font><font color="#0000FF">function </font><font color="#000080">ftrim</font><font color="#808080">(</font><font color="#000080">sTexto</font><font color="#808080">)
      </font><font color="#0000FF">character</font><font color="#808080">*</font><font color="#FF0000">255 </font><font color="#000080">sTexto

      </font><font color="#0000FF">integer </font><font color="#000080">ncont</font><font color="#808080">, </font><font color="#000080">nPosIni</font><font color="#808080">, </font><font color="#000080">nPosFim
      </font><font color="#0000FF">logical </font><font color="#000080">bQuebra
      </font><font color="#0000FF">character</font><font color="#808080">*</font><font color="#FF0000">255 </font><font color="#000080">sret</font><font color="#808080">, </font><font color="#000080">copy

      sret </font><font color="#808080">= </font><font color="#000080">char</font><font color="#808080">(</font><font color="#FF0000">0</font><font color="#808080">)
      </font><font color="#000080">nPosIni</font><font color="#808080">=</font><font color="#FF0000">0
      </font><font color="#000080">nPosFim</font><font color="#808080">=</font><font color="#FF0000">0
      </font><font color="#000080">ncont</font><font color="#808080">=</font><font color="#FF0000">1
      </font><font color="#000080">bQuebra</font><font color="#808080">=</font><font color="#0000FF">.false.
      do while </font><font color="#808080">(</font><font color="#000080">ncont.le.len</font><font color="#808080">(</font><font color="#000080">sTexto</font><font color="#808080">) </font><font color="#0000FF">.and. </font><font color="#000080">bQuebra .eqv. </font><font color="#0000FF">.false.</font><font color="#808080">)
        </font><font color="#0000FF">if </font><font color="#808080">(</font><font color="#000080">sTexto</font><font color="#808080">(</font><font color="#000080">ncont:ncont</font><font color="#808080">)</font><font color="#0000FF">.ne.</font><font color="#800000">' '</font><font color="#808080">) </font><font color="#0000FF">then
           </font><font color="#000080">nPosIni</font><font color="#808080">=</font><font color="#000080">ncont
           bQuebra</font><font color="#808080">=</font><font color="#0000FF">.true.
        end if
        </font><font color="#000080">ncont</font><font color="#808080">=</font><font color="#000080">ncont</font><font color="#808080">+</font><font color="#FF0000">1
      </font><font color="#0000FF">end do
      </font><font color="#000080">ncont</font><font color="#808080">=</font><font color="#000080">len</font><font color="#808080">(</font><font color="#000080">sTexto</font><font color="#808080">)
      </font><font color="#000080">bQuebra</font><font color="#808080">=</font><font color="#0000FF">.false.
      do while </font><font color="#808080">(</font><font color="#000080">ncont </font><font color="#0000FF">.ge. </font><font color="#FF0000">1 </font><font color="#0000FF">.and. </font><font color="#000080">bQuebra .eqv. </font><font color="#0000FF">.false.</font><font color="#808080">)
        </font><font color="#0000FF">if </font><font color="#808080">(</font><font color="#000080">sTexto</font><font color="#808080">(</font><font color="#000080">ncont:ncont</font><font color="#808080">)</font><font color="#0000FF">.ne.</font><font color="#800000">' '</font><font color="#808080">) </font><font color="#0000FF">then
           </font><font color="#000080">nPosFim</font><font color="#808080">=</font><font color="#000080">ncont
           bQuebra</font><font color="#808080">=</font><font color="#0000FF">.true.
        end if
        </font><font color="#000080">ncont</font><font color="#808080">=</font><font color="#000080">ncont</font><font color="#808080">-</font><font color="#FF0000">1
      </font><font color="#0000FF">end do
      </font><font color="#000080">sret</font><font color="#808080">=</font><font color="#000080">sTexto</font><font color="#808080">(</font><font color="#000080">nPosIni:nPosFim</font><font color="#808080">)
      </font><font color="#000080">sret</font><font color="#808080">(</font><font color="#000080">nPosFim</font><font color="#808080">+</font><font color="#FF0000">1</font><font color="#000080">:nPosFim</font><font color="#808080">+</font><font color="#FF0000">1</font><font color="#808080">) = </font><font color="#000080">char</font><font color="#808080">(</font><font color="#FF0000">0</font><font color="#808080">)
<i>C      sret=copy(sTexto,nPosIni,(nPosFim-nPosIni)+1)
      </i></font><font color="#000080">ftrim </font><font color="#808080">= </font><font color="#000080">sret
      </font><font color="#0000FF">return 
      end
</font><font color="#808080"><i>C     ------------------------------------------------------------------
C     Repete um texto um n&uacute;mero determinado de vezes.
C     sTexto - o texto a ser repetido
C     nQtd - a quantidade de vezes
C     retorna - o texto repetido
C     ------------------------------------------------------------------
      </i></font><font color="#0000FF">character</font><font color="#808080">*(*) </font><font color="#0000FF">function </font><font color="#000080">repete</font><font color="#808080">(</font><font color="#000080">sTexto</font><font color="#808080">, </font><font color="#000080">nQtd</font><font color="#808080">)
      </font><font color="#0000FF">character</font><font color="#808080">*(*) </font><font color="#000080">sTexto 
      </font><font color="#0000FF">integer </font><font color="#000080">nQtd

      </font><font color="#0000FF">integer </font><font color="#000080">ncont
      </font><font color="#0000FF">character</font><font color="#808080">*</font><font color="#FF0000">255 </font><font color="#000080">sret

      sret </font><font color="#808080">= </font><font color="#000080">char</font><font color="#808080">(</font><font color="#FF0000">0</font><font color="#808080">)
      </font><font color="#0000FF">do </font><font color="#000080">ncont</font><font color="#808080">=</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#000080">nQtd
        </font><font color="#0000FF">call </font><font color="#000080">SomaStr</font><font color="#808080">(</font><font color="#000080">sret</font><font color="#808080">,</font><font color="#000080">sTexto</font><font color="#808080">)
      </font><font color="#0000FF">end do
      </font><font color="#000080">repete </font><font color="#808080">= </font><font color="#000080">sret 
      </font><font color="#0000FF">return
      end
</font><font color="#808080"><i>C     ------------------------------------------------------------------
C     Coloca espa&ccedil;os em branco a mais de acordo com o tamanho m&aacute;ximo do texto.
C     sTexto - o texto
C     nTam - tamanho m&aacute;ximo do texto
C     retorna - o texto com espa&ccedil;os em branco a mais
C     ------------------------------------------------------------------
      </i></font><font color="#0000FF">character</font><font color="#808080">*(*) </font><font color="#0000FF">function </font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">sTexto</font><font color="#808080">, </font><font color="#000080">nTam</font><font color="#808080">)
      </font><font color="#0000FF">character</font><font color="#808080">*(*) </font><font color="#000080">sTexto
      </font><font color="#0000FF">character</font><font color="#808080">*</font><font color="#FF0000">255 </font><font color="#000080">repete
      </font><font color="#0000FF">integer </font><font color="#000080">nTam</font><font color="#808080">, </font><font color="#000080">TamStr

      </font><font color="#0000FF">call </font><font color="#000080">SomaStr</font><font color="#808080">(</font><font color="#000080">sTexto</font><font color="#808080">, </font><font color="#000080">repete</font><font color="#808080">(</font><font color="#800000">&quot; &quot;</font><font color="#808080">,</font><font color="#000080">nTam</font><font color="#808080">-</font><font color="#000080">TamStr</font><font color="#808080">(</font><font color="#000080">sTexto</font><font color="#808080">)))
      </font><font color="#000080">esp </font><font color="#808080">= </font><font color="#000080">sTexto
      </font><font color="#0000FF">return
      end

</font><font color="#808080"><i>C     ------------------------------------------------------------------
C     Faz uma pesquisa relativa de um texto atrav&eacute;s de um valor chave.
C     sTexto - o texto
C     sChave - a chave a ser pesquisada
C     retorna - se achou ou n&atilde;o a chave dentro do texto
C     ------------------------------------------------------------------
      </i></font><font color="#0000FF">logical function </font><font color="#000080">strRelativa</font><font color="#808080">(</font><font color="#000080">sTexto</font><font color="#808080">, </font><font color="#000080">sChave</font><font color="#808080">)
      </font><font color="#0000FF">character</font><font color="#808080">*</font><font color="#FF0000">255 </font><font color="#000080">sTexto</font><font color="#808080">, </font><font color="#000080">sChave

      </font><font color="#0000FF">integer </font><font color="#000080">nCont</font><font color="#808080">, </font><font color="#000080">nTamChave</font><font color="#808080">, </font><font color="#000080">nTamTexto
      </font><font color="#0000FF">logical </font><font color="#000080">bret
      </font><font color="#0000FF">character</font><font color="#808080">*</font><font color="#FF0000">255 </font><font color="#000080">sPedaco</font><font color="#808080">, </font><font color="#000080">copy

      bret</font><font color="#808080">=</font><font color="#0000FF">.false.
      </font><font color="#000080">nCont</font><font color="#808080">=</font><font color="#FF0000">1
      </font><font color="#000080">nTamChave</font><font color="#808080">=</font><font color="#000080">len</font><font color="#808080">(</font><font color="#000080">sChave</font><font color="#808080">)
      </font><font color="#000080">nTamTexto</font><font color="#808080">=</font><font color="#000080">len</font><font color="#808080">(</font><font color="#000080">sTexto</font><font color="#808080">)
      </font><font color="#0000FF">if </font><font color="#808080">(</font><font color="#000080">nTamChave </font><font color="#0000FF">.le. </font><font color="#000080">nTamTexto</font><font color="#808080">) </font><font color="#0000FF">then
        do while </font><font color="#808080">(</font><font color="#000080">nCont </font><font color="#0000FF">.le. </font><font color="#808080">(</font><font color="#000080">nTamTexto</font><font color="#808080">-</font><font color="#000080">nTamChave</font><font color="#808080">+</font><font color="#FF0000">1</font><font color="#808080">))
           </font><font color="#000080">sPedaco</font><font color="#808080">=</font><font color="#000080">copy</font><font color="#808080">(</font><font color="#000080">sTexto</font><font color="#808080">,</font><font color="#000080">nCont</font><font color="#808080">,</font><font color="#000080">nTamChave</font><font color="#808080">)
           </font><font color="#0000FF">if </font><font color="#808080">(</font><font color="#000080">sPedaco.eq.sChave</font><font color="#808080">) </font><font color="#0000FF">then
              </font><font color="#000080">bret</font><font color="#808080">=</font><font color="#0000FF">.true.
           end if
           </font><font color="#000080">nCont</font><font color="#808080">=</font><font color="#000080">nCont</font><font color="#808080">+</font><font color="#FF0000">1
        </font><font color="#0000FF">end do
      end if
      </font><font color="#000080">strRelativa</font><font color="#808080">=</font><font color="#000080">bret
      </font><font color="#0000FF">return
      end
</font><font color="#808080"><i>C     ------------------------------------------------------------------
C     Calcula o modulo11 de um valor qualquer.
C     svalor - a mstring com o n&uacute;mero a ser calculado
C     ndig - d&iacute;gito do valor a ser calculado
C     retorna - o d&iacute;gito correto
C     ------------------------------------------------------------------
      </i></font><font color="#0000FF">integer function </font><font color="#000080">modulo11</font><font color="#808080">(</font><font color="#000080">svalor</font><font color="#808080">, </font><font color="#000080">ndig</font><font color="#808080">)
      </font><font color="#0000FF">character</font><font color="#808080">*</font><font color="#FF0000">255 </font><font color="#000080">svalor
      </font><font color="#0000FF">integer </font><font color="#000080">ndig

      </font><font color="#0000FF">integer </font><font color="#000080">ncont</font><font color="#808080">, </font><font color="#000080">nsoma</font><font color="#808080">, </font><font color="#000080">nvalor</font><font color="#808080">, </font><font color="#000080">npos</font><font color="#808080">, </font><font color="#000080">StrToInt
      </font><font color="#0000FF">character</font><font color="#808080">*</font><font color="#FF0000">255 </font><font color="#000080">sres</font><font color="#808080">, </font><font color="#000080">slocal</font><font color="#808080">, </font><font color="#000080">copy

      ncont</font><font color="#808080">=</font><font color="#FF0000">1
      </font><font color="#000080">slocal</font><font color="#808080">=</font><font color="#000080">char</font><font color="#808080">(</font><font color="#FF0000">0</font><font color="#808080">)
      </font><font color="#000080">sres </font><font color="#808080">= </font><font color="#000080">char</font><font color="#808080">(</font><font color="#FF0000">0</font><font color="#808080">) 
      </font><font color="#000080">npos </font><font color="#808080">= </font><font color="#FF0000">11
      </font><font color="#0000FF">do while </font><font color="#808080">(</font><font color="#000080">ncont </font><font color="#0000FF">.le. </font><font color="#FF0000">11</font><font color="#808080">)
        </font><font color="#000080">sres </font><font color="#808080">= </font><font color="#000080">copy</font><font color="#808080">(</font><font color="#000080">svalor</font><font color="#808080">,</font><font color="#000080">npos</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">)
        </font><font color="#000080">sres</font><font color="#808080">(</font><font color="#FF0000">2</font><font color="#000080">:</font><font color="#FF0000">2</font><font color="#808080">)=</font><font color="#000080">char</font><font color="#808080">(</font><font color="#FF0000">0</font><font color="#808080">)
        </font><font color="#0000FF">call </font><font color="#000080">InsereStr</font><font color="#808080">(</font><font color="#000080">slocal</font><font color="#808080">, </font><font color="#000080">sres</font><font color="#808080">, </font><font color="#000080">ncont</font><font color="#808080">)
        </font><font color="#000080">ncont</font><font color="#808080">=</font><font color="#000080">ncont</font><font color="#808080">+</font><font color="#FF0000">1 
        </font><font color="#000080">npos</font><font color="#808080">=</font><font color="#000080">npos</font><font color="#808080">-</font><font color="#FF0000">1
      </font><font color="#0000FF">end do
      </font><font color="#000080">nsoma</font><font color="#808080">=</font><font color="#FF0000">0
      </font><font color="#0000FF">if </font><font color="#808080">(</font><font color="#000080">ndig </font><font color="#0000FF">.eq. </font><font color="#FF0000">1</font><font color="#808080">) </font><font color="#0000FF">then
        </font><font color="#000080">ncont</font><font color="#808080">=</font><font color="#FF0000">3
      </font><font color="#0000FF">else
        </font><font color="#000080">ncont</font><font color="#808080">=</font><font color="#FF0000">2
      </font><font color="#0000FF">end if
      </font><font color="#000080">npos</font><font color="#808080">=</font><font color="#FF0000">2
      </font><font color="#0000FF">do while </font><font color="#808080">(</font><font color="#000080">ncont </font><font color="#0000FF">.le. </font><font color="#FF0000">11</font><font color="#808080">)
        </font><font color="#000080">sres </font><font color="#808080">= </font><font color="#000080">copy</font><font color="#808080">(</font><font color="#000080">slocal</font><font color="#808080">,</font><font color="#000080">ncont</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">)
        </font><font color="#000080">sres</font><font color="#808080">(</font><font color="#FF0000">2</font><font color="#000080">:</font><font color="#FF0000">2</font><font color="#808080">)=</font><font color="#000080">char</font><font color="#808080">(</font><font color="#FF0000">0</font><font color="#808080">)
        </font><font color="#000080">nvalor </font><font color="#808080">= </font><font color="#000080">StrToInt</font><font color="#808080">(</font><font color="#000080">sres</font><font color="#808080">)
        </font><font color="#000080">nsoma</font><font color="#808080">=</font><font color="#000080">nsoma </font><font color="#808080">+ (</font><font color="#000080">nvalor </font><font color="#808080">* </font><font color="#000080">npos</font><font color="#808080">)
        </font><font color="#000080">ncont</font><font color="#808080">=</font><font color="#000080">ncont</font><font color="#808080">+</font><font color="#FF0000">1
        </font><font color="#000080">npos</font><font color="#808080">=</font><font color="#000080">npos</font><font color="#808080">+</font><font color="#FF0000">1
      </font><font color="#0000FF">end do
      </font><font color="#000080">nsoma</font><font color="#808080">=(</font><font color="#FF0000">11 </font><font color="#808080">- </font><font color="#000080">mod</font><font color="#808080">(</font><font color="#000080">nsoma</font><font color="#808080">,</font><font color="#FF0000">11</font><font color="#808080">))
     
      </font><font color="#0000FF">if </font><font color="#808080">(</font><font color="#000080">nsoma </font><font color="#0000FF">.gt. </font><font color="#FF0000">9</font><font color="#808080">) </font><font color="#0000FF">then
        </font><font color="#000080">modulo11</font><font color="#808080">=</font><font color="#FF0000">0
      </font><font color="#0000FF">else
        </font><font color="#000080">modulo11</font><font color="#808080">=</font><font color="#000080">nsoma
      </font><font color="#0000FF">end if 
      return 
      end
</font><font color="#808080"><i>C     ------------------------------------------------------------------
C     Valida&ccedil;&atilde;o de um n&uacute;mero de CPF qualquer.
C     cpf - a mstring com o n&uacute;mero do CPF
C     retorna - se &eacute; valido ou n&atilde;o
C     ------------------------------------------------------------------
      </i></font><font color="#0000FF">logical function </font><font color="#000080">validaCPF</font><font color="#808080">(</font><font color="#000080">cpf</font><font color="#808080">)
      </font><font color="#0000FF">character</font><font color="#808080">*</font><font color="#FF0000">255 </font><font color="#000080">cpf 

      </font><font color="#0000FF">character</font><font color="#808080">*</font><font color="#FF0000">255 </font><font color="#000080">scpf</font><font color="#808080">, </font><font color="#000080">sres</font><font color="#808080">, </font><font color="#000080">copy
      </font><font color="#0000FF">integer </font><font color="#000080">nvalor1</font><font color="#808080">, </font><font color="#000080">nvalor2</font><font color="#808080">, </font><font color="#000080">TamStr</font><font color="#808080">, </font><font color="#000080">StrToInt</font><font color="#808080">, </font><font color="#000080">modulo11

      </font><font color="#0000FF">if </font><font color="#808080">(</font><font color="#000080">TamStr</font><font color="#808080">(</font><font color="#000080">cpf</font><font color="#808080">) </font><font color="#0000FF">.eq. </font><font color="#FF0000">14</font><font color="#808080">) </font><font color="#0000FF">then
        call </font><font color="#000080">SomaStr</font><font color="#808080">(</font><font color="#000080">scpf</font><font color="#808080">, </font><font color="#000080">copy</font><font color="#808080">(</font><font color="#000080">cpf</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#FF0000">3</font><font color="#808080">))
        </font><font color="#0000FF">call </font><font color="#000080">SomaStr</font><font color="#808080">(</font><font color="#000080">scpf</font><font color="#808080">, </font><font color="#000080">copy</font><font color="#808080">(</font><font color="#000080">cpf</font><font color="#808080">,</font><font color="#FF0000">5</font><font color="#808080">,</font><font color="#FF0000">3</font><font color="#808080">))
        </font><font color="#0000FF">call </font><font color="#000080">SomaStr</font><font color="#808080">(</font><font color="#000080">scpf</font><font color="#808080">, </font><font color="#000080">copy</font><font color="#808080">(</font><font color="#000080">cpf</font><font color="#808080">,</font><font color="#FF0000">9</font><font color="#808080">,</font><font color="#FF0000">3</font><font color="#808080">))
        </font><font color="#0000FF">call </font><font color="#000080">SomaStr</font><font color="#808080">(</font><font color="#000080">scpf</font><font color="#808080">, </font><font color="#000080">copy</font><font color="#808080">(</font><font color="#000080">cpf</font><font color="#808080">,</font><font color="#FF0000">13</font><font color="#808080">,</font><font color="#FF0000">2</font><font color="#808080">))
        </font><font color="#000080">sres</font><font color="#808080">=</font><font color="#000080">copy</font><font color="#808080">(</font><font color="#000080">cpf</font><font color="#808080">,</font><font color="#FF0000">13</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">)
        </font><font color="#000080">sres</font><font color="#808080">(</font><font color="#FF0000">2</font><font color="#000080">:</font><font color="#FF0000">2</font><font color="#808080">)=</font><font color="#000080">char</font><font color="#808080">(</font><font color="#FF0000">0</font><font color="#808080">) 
        </font><font color="#000080">nvalor1 </font><font color="#808080">= </font><font color="#000080">StrToInt</font><font color="#808080">(</font><font color="#000080">sres</font><font color="#808080">)
        </font><font color="#000080">sres</font><font color="#808080">=</font><font color="#000080">copy</font><font color="#808080">(</font><font color="#000080">cpf</font><font color="#808080">,</font><font color="#FF0000">14</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">)
        </font><font color="#000080">sres</font><font color="#808080">(</font><font color="#FF0000">2</font><font color="#000080">:</font><font color="#FF0000">2</font><font color="#808080">)=</font><font color="#000080">char</font><font color="#808080">(</font><font color="#FF0000">0</font><font color="#808080">) 
        </font><font color="#000080">nvalor2 </font><font color="#808080">= </font><font color="#000080">StrToInt</font><font color="#808080">(</font><font color="#000080">sres</font><font color="#808080">)
        </font><font color="#0000FF">if </font><font color="#808080">((</font><font color="#000080">modulo11</font><font color="#808080">(</font><font color="#000080">scpf</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">) </font><font color="#0000FF">.eq. </font><font color="#000080">nvalor1</font><font color="#808080">) 
     *    </font><font color="#0000FF">.and. </font><font color="#808080">(</font><font color="#000080">modulo11</font><font color="#808080">(</font><font color="#000080">scpf</font><font color="#808080">,</font><font color="#FF0000">2</font><font color="#808080">) </font><font color="#0000FF">.eq. </font><font color="#000080">nvalor2</font><font color="#808080">)) </font><font color="#0000FF">then
          </font><font color="#000080">validaCPF</font><font color="#808080">=</font><font color="#0000FF">.true.
        else
          </font><font color="#000080">validaCPF</font><font color="#808080">=</font><font color="#0000FF">.false.
        end if
      else
        </font><font color="#000080">validaCPF</font><font color="#808080">=</font><font color="#0000FF">.false.
      end if
      return
      end
</font><font color="#808080"><i>C     ------------------------------------------------------------------
C     Valida&ccedil;&atilde;o de um n&uacute;mero ISBN qualquer.
C     isbn - a mstring com o n&uacute;mero do ISBN
C     retorna - se &eacute; valido ou n&atilde;o
C     ------------------------------------------------------------------
      </i></font><font color="#0000FF">logical function </font><font color="#000080">validaISBN</font><font color="#808080">(</font><font color="#000080">isbn</font><font color="#808080">)
      </font><font color="#0000FF">character</font><font color="#808080">*</font><font color="#FF0000">255 </font><font color="#000080">isbn
  
      </font><font color="#0000FF">character</font><font color="#808080">*</font><font color="#FF0000">255 </font><font color="#000080">snum</font><font color="#808080">, </font><font color="#000080">sdigito</font><font color="#808080">, </font><font color="#000080">sisbn</font><font color="#808080">, </font><font color="#000080">copy
      </font><font color="#0000FF">integer </font><font color="#000080">nvalor</font><font color="#808080">, </font><font color="#000080">nsoma</font><font color="#808080">, </font><font color="#000080">nstatus</font><font color="#808080">, </font><font color="#000080">ncont</font><font color="#808080">, </font><font color="#000080">TamStr</font><font color="#808080">, </font><font color="#000080">StrToInt
      
      </font><font color="#0000FF">if </font><font color="#808080">(</font><font color="#000080">TamStr</font><font color="#808080">(</font><font color="#000080">isbn</font><font color="#808080">) </font><font color="#0000FF">.eq. </font><font color="#FF0000">13</font><font color="#808080">) </font><font color="#0000FF">then
        </font><font color="#000080">sdigito </font><font color="#808080">= </font><font color="#000080">copy</font><font color="#808080">(</font><font color="#000080">isbn</font><font color="#808080">, </font><font color="#000080">TamStr</font><font color="#808080">(</font><font color="#000080">isbn</font><font color="#808080">), </font><font color="#FF0000">1</font><font color="#808080">)
        </font><font color="#000080">sisbn </font><font color="#808080">= </font><font color="#000080">char</font><font color="#808080">(</font><font color="#FF0000">0</font><font color="#808080">)
        </font><font color="#0000FF">do </font><font color="#000080">ncont</font><font color="#808080">=</font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#000080">TamStr</font><font color="#808080">(</font><font color="#000080">isbn</font><font color="#808080">)-</font><font color="#FF0000">1 
          </font><font color="#0000FF">if </font><font color="#808080">(</font><font color="#000080">copy</font><font color="#808080">(</font><font color="#000080">isbn</font><font color="#808080">,</font><font color="#000080">ncont</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">) </font><font color="#0000FF">.ne. </font><font color="#800000">&quot;-&quot;</font><font color="#808080">) </font><font color="#0000FF">then
            call </font><font color="#000080">SomaStr</font><font color="#808080">(</font><font color="#000080">sisbn</font><font color="#808080">,</font><font color="#000080">copy</font><font color="#808080">(</font><font color="#000080">isbn</font><font color="#808080">,</font><font color="#000080">ncont</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">)) 
          </font><font color="#0000FF">end if
        end do
        if </font><font color="#808080">(</font><font color="#000080">sdigito </font><font color="#0000FF">.eq. </font><font color="#800000">&quot;X&quot;</font><font color="#808080">) </font><font color="#0000FF">then
          </font><font color="#000080">nsoma </font><font color="#808080">= </font><font color="#FF0000">10
        </font><font color="#0000FF">else
          </font><font color="#000080">nvalor </font><font color="#808080">= </font><font color="#000080">StrToInt</font><font color="#808080">(</font><font color="#000080">sdigito</font><font color="#808080">)
          </font><font color="#000080">nsoma </font><font color="#808080">= </font><font color="#000080">nvalor
        </font><font color="#0000FF">end if
        do </font><font color="#000080">ncont</font><font color="#808080">=</font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">9 
          </font><font color="#000080">snum</font><font color="#808080">=</font><font color="#000080">copy</font><font color="#808080">(</font><font color="#000080">sisbn</font><font color="#808080">, </font><font color="#000080">ncont</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">)
          </font><font color="#000080">nvalor </font><font color="#808080">= </font><font color="#000080">StrToInt</font><font color="#808080">(</font><font color="#000080">snum</font><font color="#808080">)
          </font><font color="#000080">nsoma</font><font color="#808080">=</font><font color="#000080">nsoma </font><font color="#808080">+ (</font><font color="#000080">nvalor </font><font color="#808080">* (</font><font color="#FF0000">11 </font><font color="#808080">- </font><font color="#000080">ncont</font><font color="#808080">))
        </font><font color="#0000FF">end do
        if </font><font color="#808080">(</font><font color="#000080">mod</font><font color="#808080">(</font><font color="#000080">nsoma</font><font color="#808080">, </font><font color="#FF0000">11</font><font color="#808080">) </font><font color="#0000FF">.eq. </font><font color="#FF0000">0</font><font color="#808080">) </font><font color="#0000FF">Then
          </font><font color="#000080">validaISBN</font><font color="#808080">=</font><font color="#0000FF">.true.
        else
          </font><font color="#000080">validaISBN</font><font color="#808080">=</font><font color="#0000FF">.false.
        end if
      else
        </font><font color="#000080">validaISBN</font><font color="#808080">=</font><font color="#0000FF">.false.
      end if
      return 
      end
</font><font color="#808080"><i>C     ------------------------------------------------------------------
C     Esconde a digita&ccedil;&atilde;o da senha
C     retorna - a senha digitada
C     ------------------------------------------------------------------
      </i></font><font color="#0000FF">character</font><font color="#808080">*</font><font color="#FF0000">255 </font><font color="#0000FF">function </font><font color="#000080">digitaSenha</font><font color="#808080">(</font><font color="#000080">sRotulo</font><font color="#808080">, </font><font color="#000080">nTamSenha</font><font color="#808080">)
      </font><font color="#0000FF">character</font><font color="#808080">*</font><font color="#FF0000">255 </font><font color="#000080">sRotulo
      </font><font color="#0000FF">integer </font><font color="#000080">nTamSenha

      </font><font color="#0000FF">character</font><font color="#808080">*</font><font color="#FF0000">255 </font><font color="#000080">sSenha
</font><font color="#808080"><i>C      character sLetra
C      integer ncont

      </i></font><font color="#0000FF">write</font><font color="#808080">(*,*) </font><font color="#000080">sRotulo
      </font><font color="#0000FF">read</font><font color="#808080">(*,*) </font><font color="#000080">sSenha
</font><font color="#808080"><i>C        ncont = 0
C        sSenha=char(0)
C        sLetra=char(0)
C        do while ((sLetra .ne. char(13)) .and. (ncont .lt. nTamSenha))
C          sLetra=readkey
C          call SomaStr(sSenha, sLetra)
C          ncont=ncont+1
C        end dos
      </i></font><font color="#000080">digitaSenha</font><font color="#808080">=</font><font color="#000080">sSenha
      </font><font color="#0000FF">return
      end
</font><font color="#808080"><i>C     ------------------------------------------------------------------
C     Valida&ccedil;&atilde;o de um n&uacute;mero qualquer.
C     sRotulo - o texto antes de se digitar o n&uacute;mero
C     sNumero - a mstring com o valor do n&uacute;mero
C     retorna - o sNumero
C     ------------------------------------------------------------------
      </i></font><font color="#0000FF">character</font><font color="#808080">*</font><font color="#FF0000">255 </font><font color="#0000FF">function </font><font color="#000080">validaNumero</font><font color="#808080">(</font><font color="#000080">sRotulo</font><font color="#808080">, </font><font color="#000080">sNumero</font><font color="#808080">)
      </font><font color="#0000FF">character</font><font color="#808080">*</font><font color="#FF0000">255 </font><font color="#000080">sRotulo</font><font color="#808080">, </font><font color="#000080">sNumero
        
      </font><font color="#0000FF">include </font><font color="#800000">'livrus.h'
      </font><font color="#0000FF">integer </font><font color="#000080">nnum
      </font><font color="#0000FF">integer </font><font color="#000080">nStatus</font><font color="#808080">, </font><font color="#000080">StrToInt

      nStatus</font><font color="#808080">=-</font><font color="#FF0000">1
      </font><font color="#0000FF">do while </font><font color="#808080">(</font><font color="#000080">nStatus </font><font color="#0000FF">.ne. </font><font color="#FF0000">0</font><font color="#808080">)
        </font><font color="#0000FF">write</font><font color="#808080">(*,*) </font><font color="#000080">sRotulo
        </font><font color="#0000FF">read</font><font color="#808080">(*,*) </font><font color="#000080">sNumero
        nnum </font><font color="#808080">= </font><font color="#000080">StrToInt</font><font color="#808080">(</font><font color="#000080">sNumero</font><font color="#808080">)
        </font><font color="#0000FF">if </font><font color="#808080">((</font><font color="#000080">nnum </font><font color="#0000FF">.lt. </font><font color="#FF0000">1</font><font color="#808080">) </font><font color="#0000FF">.or. </font><font color="#808080">(</font><font color="#000080">nStatus</font><font color="#0000FF">.ne.</font><font color="#FF0000">0</font><font color="#808080">)) </font><font color="#0000FF">then
           write</font><font color="#808080">(*,*) </font><font color="#000080">MSG_NUMINV
        </font><font color="#0000FF">end if
      end do
      </font><font color="#000080">validaNumero</font><font color="#808080">=</font><font color="#000080">sNumero
      </font><font color="#0000FF">return
      end
</font><font color="#808080"><i>C     ------------------------------------------------------------------
C     Valida&ccedil;&atilde;o de uma data ou data/hora qualquer.
C     sRotulo - o texto antes de se digitar a data/hora
C     sDataHora - a mstring com o valor da data/hora
C     bSoData - indica se vai validar somente uma data sem a hora
C     retorna - a sDataHora
C     ------------------------------------------------------------------
      </i></font><font color="#0000FF">character</font><font color="#808080">*</font><font color="#FF0000">255 </font><font color="#0000FF">function </font><font color="#000080">validaDataHora</font><font color="#808080">(</font><font color="#000080">sRotulo</font><font color="#808080">, </font><font color="#000080">sDataHora</font><font color="#808080">, </font><font color="#000080">bSoData</font><font color="#808080">)
      </font><font color="#0000FF">character</font><font color="#808080">*</font><font color="#FF0000">255 </font><font color="#000080">sRotulo</font><font color="#808080">, </font><font color="#000080">sDataHora
      </font><font color="#0000FF">logical </font><font color="#000080">bSoData

      </font><font color="#0000FF">include </font><font color="#800000">'livrus.h'
      </font><font color="#0000FF">logical </font><font color="#000080">bvalida</font><font color="#808080">, </font><font color="#000080">bdatavalida</font><font color="#808080">, </font><font color="#000080">bhoravalida
      </font><font color="#0000FF">character</font><font color="#808080">*</font><font color="#FF0000">255 </font><font color="#000080">sdia</font><font color="#808080">, </font><font color="#000080">smes</font><font color="#808080">, </font><font color="#000080">sano</font><font color="#808080">, </font><font color="#000080">shora</font><font color="#808080">, </font><font color="#000080">smin</font><font color="#808080">, </font><font color="#000080">sseg</font><font color="#808080">, </font><font color="#000080">copy
      </font><font color="#0000FF">integer </font><font color="#000080">ndia</font><font color="#808080">, </font><font color="#000080">nmes</font><font color="#808080">, </font><font color="#000080">nano</font><font color="#808080">, </font><font color="#000080">nhora</font><font color="#808080">, </font><font color="#000080">nmin</font><font color="#808080">, </font><font color="#000080">nseg</font><font color="#808080">, </font><font color="#000080">nudiames
      </font><font color="#0000FF">integer </font><font color="#000080">ntam</font><font color="#808080">, </font><font color="#000080">TamStr</font><font color="#808080">, </font><font color="#000080">StrToInt

      bvalida</font><font color="#808080">=</font><font color="#0000FF">.false.
      </font><font color="#000080">bdatavalida</font><font color="#808080">=</font><font color="#0000FF">.false.
      </font><font color="#000080">bhoravalida</font><font color="#808080">=</font><font color="#0000FF">.false.
      </font><font color="#000080">nudiames</font><font color="#808080">=</font><font color="#FF0000">0
      
      </font><font color="#0000FF">if </font><font color="#808080">(</font><font color="#000080">bSoData .eqv. </font><font color="#0000FF">.true.</font><font color="#808080">) </font><font color="#0000FF">then 
        </font><font color="#000080">ntam</font><font color="#808080">=</font><font color="#FF0000">10
      </font><font color="#0000FF">else 
        </font><font color="#000080">ntam</font><font color="#808080">=</font><font color="#FF0000">19
      </font><font color="#0000FF">end if
      do while </font><font color="#808080">(</font><font color="#000080">bvalida .eqv. </font><font color="#0000FF">.false.</font><font color="#808080">)
        </font><font color="#0000FF">write</font><font color="#808080">(*,*) </font><font color="#000080">sRotulo
        </font><font color="#0000FF">read</font><font color="#808080">(*,*) </font><font color="#000080">sDataHora
        </font><font color="#0000FF">if </font><font color="#808080">(</font><font color="#000080">TamStr</font><font color="#808080">(</font><font color="#000080">sDataHora</font><font color="#808080">) </font><font color="#0000FF">.eq. </font><font color="#000080">ntam</font><font color="#808080">) </font><font color="#0000FF">then
          </font><font color="#000080">sdia</font><font color="#808080">=</font><font color="#000080">copy</font><font color="#808080">(</font><font color="#000080">sDataHora</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#FF0000">2</font><font color="#808080">)
          </font><font color="#000080">ndia </font><font color="#808080">= </font><font color="#000080">StrToInt</font><font color="#808080">(</font><font color="#000080">sdia</font><font color="#808080">)
          </font><font color="#000080">smes</font><font color="#808080">=</font><font color="#000080">copy</font><font color="#808080">(</font><font color="#000080">sDataHora</font><font color="#808080">,</font><font color="#FF0000">4</font><font color="#808080">,</font><font color="#FF0000">2</font><font color="#808080">)
          </font><font color="#000080">nmes </font><font color="#808080">= </font><font color="#000080">StrToInt</font><font color="#808080">(</font><font color="#000080">smes</font><font color="#808080">)
          </font><font color="#000080">sano</font><font color="#808080">=</font><font color="#000080">copy</font><font color="#808080">(</font><font color="#000080">sDataHora</font><font color="#808080">,</font><font color="#FF0000">7</font><font color="#808080">,</font><font color="#FF0000">4</font><font color="#808080">)
          </font><font color="#000080">nano </font><font color="#808080">= </font><font color="#000080">StrToInt</font><font color="#808080">(</font><font color="#000080">sano</font><font color="#808080">)
        
          </font><font color="#0000FF">if </font><font color="#808080">((</font><font color="#000080">nano </font><font color="#0000FF">.ge. </font><font color="#FF0000">1</font><font color="#808080">) </font><font color="#0000FF">.and. </font><font color="#808080">(</font><font color="#000080">nano </font><font color="#0000FF">.le. </font><font color="#FF0000">9999</font><font color="#808080">)) </font><font color="#0000FF">then
            if </font><font color="#808080">((</font><font color="#000080">nmes </font><font color="#0000FF">.ge. </font><font color="#FF0000">1</font><font color="#808080">) </font><font color="#0000FF">.and. </font><font color="#808080">(</font><font color="#000080">nmes </font><font color="#0000FF">.le. </font><font color="#FF0000">31</font><font color="#808080">)) </font><font color="#0000FF">then
                if </font><font color="#808080">((</font><font color="#000080">nmes</font><font color="#0000FF">.eq.</font><font color="#FF0000">1</font><font color="#808080">) </font><font color="#0000FF">.or. </font><font color="#808080">(</font><font color="#000080">nmes</font><font color="#0000FF">.eq.</font><font color="#FF0000">3</font><font color="#808080">) </font><font color="#0000FF">.or. </font><font color="#808080">(</font><font color="#000080">nmes</font><font color="#0000FF">.eq.</font><font color="#FF0000">5</font><font color="#808080">) </font><font color="#0000FF">.or. 
     </font><font color="#808080">*               (</font><font color="#000080">nmes</font><font color="#0000FF">.eq.</font><font color="#FF0000">7</font><font color="#808080">) </font><font color="#0000FF">.or. </font><font color="#808080">(</font><font color="#000080">nmes</font><font color="#0000FF">.eq.</font><font color="#FF0000">8</font><font color="#808080">) </font><font color="#0000FF">.or. 
     </font><font color="#808080">*               (</font><font color="#000080">nmes</font><font color="#0000FF">.eq.</font><font color="#FF0000">10</font><font color="#808080">) </font><font color="#0000FF">.or. </font><font color="#808080">(</font><font color="#000080">nmes</font><font color="#0000FF">.eq.</font><font color="#FF0000">12</font><font color="#808080">)) </font><font color="#0000FF">then
                   </font><font color="#000080">nudiames</font><font color="#808080">=</font><font color="#FF0000">31
                </font><font color="#0000FF">else if </font><font color="#808080">(</font><font color="#000080">nmes</font><font color="#0000FF">.eq.</font><font color="#FF0000">2</font><font color="#808080">) </font><font color="#0000FF">then
</font><font color="#808080"><i>C                  ano bissexto 
                   </i></font><font color="#0000FF">if </font><font color="#808080">(</font><font color="#000080">mod</font><font color="#808080">(</font><font color="#000080">nano</font><font color="#808080">, </font><font color="#FF0000">4</font><font color="#808080">)</font><font color="#0000FF">.eq.</font><font color="#FF0000">0</font><font color="#808080">) </font><font color="#0000FF">then 
                     </font><font color="#000080">nudiames</font><font color="#808080">=</font><font color="#FF0000">29
                   </font><font color="#0000FF">else 
                     </font><font color="#000080">nudiames</font><font color="#808080">=</font><font color="#FF0000">28
                   </font><font color="#0000FF">end if
                else if </font><font color="#808080">((</font><font color="#000080">nmes</font><font color="#0000FF">.eq.</font><font color="#FF0000">4</font><font color="#808080">) </font><font color="#0000FF">.or. </font><font color="#808080">(</font><font color="#000080">nmes</font><font color="#0000FF">.eq.</font><font color="#FF0000">6</font><font color="#808080">) </font><font color="#0000FF">.or. 
     </font><font color="#808080">*           (</font><font color="#000080">nmes</font><font color="#0000FF">.eq.</font><font color="#FF0000">9</font><font color="#808080">) </font><font color="#0000FF">.or. </font><font color="#808080">(</font><font color="#000080">nmes</font><font color="#0000FF">.eq.</font><font color="#FF0000">11</font><font color="#808080">)) </font><font color="#0000FF">then 
                  </font><font color="#000080">nudiames</font><font color="#808080">=</font><font color="#FF0000">30
                </font><font color="#0000FF">end if
                if </font><font color="#808080">((</font><font color="#000080">ndia </font><font color="#0000FF">.ge. </font><font color="#FF0000">1</font><font color="#808080">) </font><font color="#0000FF">.and. </font><font color="#808080">(</font><font color="#000080">ndia </font><font color="#0000FF">.le. </font><font color="#000080">nudiames</font><font color="#808080">)) </font><font color="#0000FF">then
                   </font><font color="#000080">bdatavalida</font><font color="#808080">=</font><font color="#0000FF">.true.
                end if 
            end if
          end if
        
          if </font><font color="#808080">(</font><font color="#000080">bSoData .eqv. </font><font color="#0000FF">.true.</font><font color="#808080">) </font><font color="#0000FF">then
             if </font><font color="#808080">(</font><font color="#000080">bdatavalida .eqv. </font><font color="#0000FF">.true.</font><font color="#808080">) </font><font color="#0000FF">then 
               </font><font color="#000080">bvalida</font><font color="#808080">=</font><font color="#0000FF">.true.
             else 
               write</font><font color="#808080">(*,*) </font><font color="#000080">MSG_DATAINV
             </font><font color="#0000FF">end if       
          else
            if </font><font color="#808080">(</font><font color="#000080">bdatavalida .eqv. </font><font color="#0000FF">.true.</font><font color="#808080">) </font><font color="#0000FF">then
                </font><font color="#000080">shora</font><font color="#808080">=</font><font color="#000080">copy</font><font color="#808080">(</font><font color="#000080">sDataHora</font><font color="#808080">,</font><font color="#FF0000">12</font><font color="#808080">,</font><font color="#FF0000">2</font><font color="#808080">)
                </font><font color="#000080">nhora </font><font color="#808080">= </font><font color="#000080">StrToInt</font><font color="#808080">(</font><font color="#000080">shora</font><font color="#808080">)
                </font><font color="#000080">smin </font><font color="#808080">= </font><font color="#000080">copy</font><font color="#808080">(</font><font color="#000080">sDataHora</font><font color="#808080">,</font><font color="#FF0000">15</font><font color="#808080">,</font><font color="#FF0000">2</font><font color="#808080">)
                </font><font color="#000080">nmin </font><font color="#808080">= </font><font color="#000080">StrToInt</font><font color="#808080">(</font><font color="#000080">smin</font><font color="#808080">)
                </font><font color="#000080">sseg</font><font color="#808080">=</font><font color="#000080">copy</font><font color="#808080">(</font><font color="#000080">sDataHora</font><font color="#808080">,</font><font color="#FF0000">18</font><font color="#808080">,</font><font color="#FF0000">2</font><font color="#808080">)
                </font><font color="#000080">nseg </font><font color="#808080">= </font><font color="#000080">StrToInt</font><font color="#808080">(</font><font color="#000080">sseg</font><font color="#808080">)
        
                </font><font color="#0000FF">if </font><font color="#808080">((</font><font color="#000080">nhora </font><font color="#0000FF">.ge. </font><font color="#FF0000">0</font><font color="#808080">) </font><font color="#0000FF">.and. </font><font color="#808080">(</font><font color="#000080">nhora </font><font color="#0000FF">.le. </font><font color="#FF0000">23</font><font color="#808080">)) </font><font color="#0000FF">then
                  if </font><font color="#808080">((</font><font color="#000080">nmin </font><font color="#0000FF">.ge. </font><font color="#FF0000">0</font><font color="#808080">) </font><font color="#0000FF">.and. </font><font color="#808080">(</font><font color="#000080">nmin </font><font color="#0000FF">.le. </font><font color="#FF0000">59</font><font color="#808080">)) </font><font color="#0000FF">then
                    if </font><font color="#808080">((</font><font color="#000080">nseg </font><font color="#0000FF">.ge. </font><font color="#FF0000">0</font><font color="#808080">) </font><font color="#0000FF">.and. </font><font color="#808080">(</font><font color="#000080">nseg </font><font color="#0000FF">.le. </font><font color="#FF0000">59</font><font color="#808080">)) </font><font color="#0000FF">then
                       </font><font color="#000080">bhoravalida</font><font color="#808080">=</font><font color="#0000FF">.true.
                    end if
                  end if
                end if
        
                if </font><font color="#808080">(</font><font color="#000080">bhoravalida .eqv. </font><font color="#0000FF">.true.</font><font color="#808080">) </font><font color="#0000FF">then 
                  </font><font color="#000080">bvalida</font><font color="#808080">=</font><font color="#0000FF">.true.
                else 
                  write</font><font color="#808080">(*,*) </font><font color="#000080">MSG_DTHRINV
                </font><font color="#0000FF">end if
            else
              write</font><font color="#808080">(*,*) </font><font color="#000080">MSG_DTHRINV
            </font><font color="#0000FF">end if
          end if
        else
          if </font><font color="#808080">(</font><font color="#000080">bSoData .eqv. </font><font color="#0000FF">.true.</font><font color="#808080">) </font><font color="#0000FF">then 
            write</font><font color="#808080">(*,*) </font><font color="#000080">MSG_DATAINV
          </font><font color="#0000FF">else 
            write</font><font color="#808080">(*,*) </font><font color="#000080">MSG_DTHRINV
          </font><font color="#0000FF">end if    
        end if
      end do
      </font><font color="#000080">validaDataHora</font><font color="#808080">=</font><font color="#000080">sDataHora
      </font><font color="#0000FF">return
      end
</font><font color="#808080"><i>C     ------------------------------------------------------------------
C     Retorna a Data e a hora do sistema.
C     retorna - a data e a hora
C     ------------------------------------------------------------------
      </i></font><font color="#0000FF">character</font><font color="#808080">*(*) </font><font color="#0000FF">function </font><font color="#000080">retDataHora</font><font color="#808080">()
      </font><font color="#0000FF">character</font><font color="#808080">*</font><font color="#FF0000">255 </font><font color="#000080">sano</font><font color="#808080">, </font><font color="#000080">smes</font><font color="#808080">, </font><font color="#000080">sdia</font><font color="#808080">, </font><font color="#000080">shora</font><font color="#808080">, </font><font color="#000080">smin</font><font color="#808080">, </font><font color="#000080">sseg</font><font color="#808080">, </font><font color="#000080">sDataHora
      </font><font color="#0000FF">character</font><font color="#808080">*</font><font color="#FF0000">255 </font><font color="#000080">IntToStr
      </font><font color="#0000FF">integer </font><font color="#000080">tempo</font><font color="#808080">(</font><font color="#FF0000">9</font><font color="#808080">)

      </font><font color="#0000FF">call </font><font color="#000080">GMTime</font><font color="#808080">(</font><font color="#000080">time</font><font color="#808080">(), </font><font color="#000080">tempo</font><font color="#808080">)
      </font><font color="#000080">sseg </font><font color="#808080">= </font><font color="#000080">IntToStr</font><font color="#808080">(</font><font color="#000080">tempo</font><font color="#808080">(</font><font color="#FF0000">1</font><font color="#808080">))
      </font><font color="#000080">smin </font><font color="#808080">= </font><font color="#000080">IntToStr</font><font color="#808080">(</font><font color="#000080">tempo</font><font color="#808080">(</font><font color="#FF0000">2</font><font color="#808080">))
      </font><font color="#000080">shora </font><font color="#808080">= </font><font color="#000080">IntToStr</font><font color="#808080">(</font><font color="#000080">tempo</font><font color="#808080">(</font><font color="#FF0000">3</font><font color="#808080">))
      </font><font color="#000080">sdia </font><font color="#808080">= </font><font color="#000080">IntToStr</font><font color="#808080">(</font><font color="#000080">tempo</font><font color="#808080">(</font><font color="#FF0000">4</font><font color="#808080">))
      </font><font color="#000080">smes </font><font color="#808080">= </font><font color="#000080">IntToStr</font><font color="#808080">(</font><font color="#000080">tempo</font><font color="#808080">(</font><font color="#FF0000">5</font><font color="#808080">))
      </font><font color="#000080">sano </font><font color="#808080">= </font><font color="#000080">IntToStr</font><font color="#808080">(</font><font color="#000080">tempo</font><font color="#808080">(</font><font color="#FF0000">6</font><font color="#808080">) + </font><font color="#FF0000">1900</font><font color="#808080">)
      </font><font color="#0000FF">if </font><font color="#808080">(</font><font color="#000080">tempo</font><font color="#808080">(</font><font color="#FF0000">4</font><font color="#808080">) </font><font color="#0000FF">.lt. </font><font color="#FF0000">10</font><font color="#808080">) </font><font color="#0000FF">then
         call </font><font color="#000080">SomaStr</font><font color="#808080">(</font><font color="#000080">sDataHora</font><font color="#808080">,</font><font color="#800000">&quot;0&quot;</font><font color="#808080">)
      </font><font color="#0000FF">end if
      call </font><font color="#000080">SomaStr</font><font color="#808080">(</font><font color="#000080">sDataHora</font><font color="#808080">,</font><font color="#000080">sdia</font><font color="#808080">)
      </font><font color="#0000FF">call </font><font color="#000080">SomaStr</font><font color="#808080">(</font><font color="#000080">sDataHora</font><font color="#808080">,</font><font color="#800000">&quot;/&quot;</font><font color="#808080">)
      </font><font color="#0000FF">if </font><font color="#808080">(</font><font color="#000080">tempo</font><font color="#808080">(</font><font color="#FF0000">5</font><font color="#808080">) </font><font color="#0000FF">.lt. </font><font color="#FF0000">10</font><font color="#808080">) </font><font color="#0000FF">then
         call </font><font color="#000080">SomaStr</font><font color="#808080">(</font><font color="#000080">sDataHora</font><font color="#808080">,</font><font color="#800000">&quot;0&quot;</font><font color="#808080">)
      </font><font color="#0000FF">end if
      call </font><font color="#000080">SomaStr</font><font color="#808080">(</font><font color="#000080">sDataHora</font><font color="#808080">,</font><font color="#000080">smes</font><font color="#808080">)
      </font><font color="#0000FF">call </font><font color="#000080">SomaStr</font><font color="#808080">(</font><font color="#000080">sDataHora</font><font color="#808080">,</font><font color="#800000">&quot;/&quot;</font><font color="#808080">)
      </font><font color="#0000FF">call </font><font color="#000080">SomaStr</font><font color="#808080">(</font><font color="#000080">sDataHora</font><font color="#808080">,</font><font color="#000080">sano</font><font color="#808080">)
      </font><font color="#0000FF">call </font><font color="#000080">SomaStr</font><font color="#808080">(</font><font color="#000080">sDataHora</font><font color="#808080">,</font><font color="#800000">&quot; &quot;</font><font color="#808080">)
      </font><font color="#0000FF">if </font><font color="#808080">(</font><font color="#000080">tempo</font><font color="#808080">(</font><font color="#FF0000">3</font><font color="#808080">) </font><font color="#0000FF">.lt. </font><font color="#FF0000">10</font><font color="#808080">) </font><font color="#0000FF">then
         call </font><font color="#000080">SomaStr</font><font color="#808080">(</font><font color="#000080">sDataHora</font><font color="#808080">,</font><font color="#800000">&quot;0&quot;</font><font color="#808080">)
      </font><font color="#0000FF">end if
      call </font><font color="#000080">SomaStr</font><font color="#808080">(</font><font color="#000080">sDataHora</font><font color="#808080">,</font><font color="#000080">shora</font><font color="#808080">)
      </font><font color="#0000FF">call </font><font color="#000080">SomaStr</font><font color="#808080">(</font><font color="#000080">sDataHora</font><font color="#808080">,</font><font color="#800000">&quot;:&quot;</font><font color="#808080">)
      </font><font color="#0000FF">if </font><font color="#808080">(</font><font color="#000080">tempo</font><font color="#808080">(</font><font color="#FF0000">2</font><font color="#808080">) </font><font color="#0000FF">.lt. </font><font color="#FF0000">10</font><font color="#808080">) </font><font color="#0000FF">then
         call </font><font color="#000080">SomaStr</font><font color="#808080">(</font><font color="#000080">sDataHora</font><font color="#808080">,</font><font color="#800000">&quot;0&quot;</font><font color="#808080">)
      </font><font color="#0000FF">end if
      call </font><font color="#000080">SomaStr</font><font color="#808080">(</font><font color="#000080">sDataHora</font><font color="#808080">,</font><font color="#000080">smin</font><font color="#808080">)
      </font><font color="#0000FF">call </font><font color="#000080">SomaStr</font><font color="#808080">(</font><font color="#000080">sDataHora</font><font color="#808080">,</font><font color="#800000">&quot;:&quot;</font><font color="#808080">)
      </font><font color="#0000FF">if </font><font color="#808080">(</font><font color="#000080">tempo</font><font color="#808080">(</font><font color="#FF0000">1</font><font color="#808080">) </font><font color="#0000FF">.lt. </font><font color="#FF0000">10</font><font color="#808080">) </font><font color="#0000FF">then
         call </font><font color="#000080">SomaStr</font><font color="#808080">(</font><font color="#000080">sDataHora</font><font color="#808080">,</font><font color="#800000">&quot;0&quot;</font><font color="#808080">)
      </font><font color="#0000FF">end if
      call </font><font color="#000080">SomaStr</font><font color="#808080">(</font><font color="#000080">sDataHora</font><font color="#808080">,</font><font color="#000080">sseg</font><font color="#808080">)
      </font><font color="#000080">retDataHora </font><font color="#808080">= </font><font color="#000080">sDataHora
      </font><font color="#0000FF">end

</font><font color="#808080"><i>C     ------------------------------------------------------------------
C     Calcula o tamanho do arquivo.
C     sArq - o arquivo
C     retorna - o tamanho do arquivo
C     ------------------------------------------------------------------
      </i></font><font color="#0000FF">integer function </font><font color="#000080">tamArq</font><font color="#808080">(</font><font color="#000080">sArq</font><font color="#808080">)
      </font><font color="#0000FF">integer </font><font color="#000080">sArq
      </font><font color="#0000FF">integer </font><font color="#000080">fimarq</font><font color="#808080">,</font><font color="#000080">cont
      cont</font><font color="#808080">=</font><font color="#FF0000">1
      </font><font color="#0000FF">do while </font><font color="#808080">(</font><font color="#000080">fimarq</font><font color="#0000FF">.ne.</font><font color="#808080">-</font><font color="#FF0000">1</font><font color="#808080">)
        </font><font color="#0000FF">read</font><font color="#808080">(</font><font color="#000080">sArq</font><font color="#808080">,</font><font color="#000080">rec</font><font color="#808080">=</font><font color="#000080">cont</font><font color="#808080">,</font><font color="#000080">iostat</font><font color="#808080">=</font><font color="#000080">fimarq</font><font color="#808080">) 
        </font><font color="#000080">cont</font><font color="#808080">=</font><font color="#000080">cont</font><font color="#808080">+</font><font color="#FF0000">1
      </font><font color="#0000FF">end do
      </font><font color="#000080">tamArq </font><font color="#808080">= </font><font color="#000080">cont
      </font><font color="#0000FF">end

</font><font color="#808080"><i>C     ------------------------------------------------------------------
C     Abre ou cria os arquivos do sistema.
C     bAbre - condi&ccedil;&atilde;o para abrir ou criar os arquivos do sistema
C     ------------------------------------------------------------------
      </i></font><font color="#0000FF">subroutine </font><font color="#000080">abrecriaArqs</font><font color="#808080">(</font><font color="#000080">bAbre</font><font color="#808080">)
      </font><font color="#0000FF">logical </font><font color="#000080">bAbre
       
      </font><font color="#0000FF">include </font><font color="#800000">'livrus.h'
      </font><font color="#0000FF">logical </font><font color="#000080">bexiste

      </font><font color="#0000FF">if </font><font color="#808080">(</font><font color="#000080">bAbre</font><font color="#808080">) </font><font color="#0000FF">then
        </font><font color="#000080">inquire</font><font color="#808080">(</font><font color="#000080">file</font><font color="#808080">=</font><font color="#000080">ARQ_ASSUNTO</font><font color="#808080">,</font><font color="#000080">exist</font><font color="#808080">=</font><font color="#000080">bexiste</font><font color="#808080">)
        </font><font color="#0000FF">if </font><font color="#808080">(</font><font color="#000080">bexiste</font><font color="#808080">) </font><font color="#0000FF">then
          open</font><font color="#808080">(</font><font color="#000080">tfAssunto</font><font color="#808080">,</font><font color="#000080">file</font><font color="#808080">=</font><font color="#000080">ARQ_ASSUNTO</font><font color="#808080">,</font><font color="#000080">status</font><font color="#808080">=</font><font color="#800000">'old'</font><font color="#808080">,</font><font color="#000080">access</font><font color="#808080">=</font><font color="#800000">'direct'</font><font color="#808080">,
     *         </font><font color="#000080">form</font><font color="#808080">=</font><font color="#800000">'formatted'</font><font color="#808080">,</font><font color="#000080">recl</font><font color="#808080">=</font><font color="#000080">TAM_ASSUNTO</font><font color="#808080">)
        </font><font color="#0000FF">else
          write</font><font color="#808080">(*,</font><font color="#800000">&quot;(A37,' --&gt; ',A15)&quot;</font><font color="#808080">) </font><font color="#000080">MSG_ARQERRO</font><font color="#808080">, </font><font color="#000080">ARQ_ASSUNTO
        </font><font color="#0000FF">end if
        </font><font color="#000080">inquire</font><font color="#808080">(</font><font color="#000080">file</font><font color="#808080">=</font><font color="#000080">ARQ_AUTOR</font><font color="#808080">,</font><font color="#000080">exist</font><font color="#808080">=</font><font color="#000080">bexiste</font><font color="#808080">)
        </font><font color="#0000FF">if </font><font color="#808080">(</font><font color="#000080">bexiste</font><font color="#808080">) </font><font color="#0000FF">then
          open</font><font color="#808080">(</font><font color="#000080">tfAutor</font><font color="#808080">,</font><font color="#000080">file</font><font color="#808080">=</font><font color="#000080">ARQ_AUTOR</font><font color="#808080">,</font><font color="#000080">status</font><font color="#808080">=</font><font color="#800000">'old'</font><font color="#808080">,</font><font color="#000080">access</font><font color="#808080">=</font><font color="#800000">'direct'</font><font color="#808080">,
     *         </font><font color="#000080">form</font><font color="#808080">=</font><font color="#800000">'formatted'</font><font color="#808080">,</font><font color="#000080">recl</font><font color="#808080">=</font><font color="#000080">TAM_AUTOR</font><font color="#808080">)
        </font><font color="#0000FF">else
          write</font><font color="#808080">(*,</font><font color="#800000">&quot;(A37,' --&gt; ',A15)&quot;</font><font color="#808080">) </font><font color="#000080">MSG_ARQERRO</font><font color="#808080">, </font><font color="#000080">ARQ_AUTOR
        </font><font color="#0000FF">end if
        </font><font color="#000080">inquire</font><font color="#808080">(</font><font color="#000080">file</font><font color="#808080">=</font><font color="#000080">ARQ_EDITORA</font><font color="#808080">,</font><font color="#000080">exist</font><font color="#808080">=</font><font color="#000080">bexiste</font><font color="#808080">)
        </font><font color="#0000FF">if </font><font color="#808080">(</font><font color="#000080">bexiste</font><font color="#808080">) </font><font color="#0000FF">then
          open</font><font color="#808080">(</font><font color="#000080">tfEditora</font><font color="#808080">,</font><font color="#000080">file</font><font color="#808080">=</font><font color="#000080">ARQ_EDITORA</font><font color="#808080">,</font><font color="#000080">status</font><font color="#808080">=</font><font color="#800000">'old'</font><font color="#808080">,</font><font color="#000080">access</font><font color="#808080">=</font><font color="#800000">'direct'</font><font color="#808080">,
     *         </font><font color="#000080">form</font><font color="#808080">=</font><font color="#800000">'formatted'</font><font color="#808080">,</font><font color="#000080">recl</font><font color="#808080">=</font><font color="#000080">TAM_EDITORA</font><font color="#808080">)
        </font><font color="#0000FF">else
          write</font><font color="#808080">(*,</font><font color="#800000">&quot;(A37,' --&gt; ',A15)&quot;</font><font color="#808080">) </font><font color="#000080">MSG_ARQERRO</font><font color="#808080">, </font><font color="#000080">ARQ_EDITORA
        </font><font color="#0000FF">end if
        </font><font color="#000080">inquire</font><font color="#808080">(</font><font color="#000080">file</font><font color="#808080">=</font><font color="#000080">ARQ_IDIOMA</font><font color="#808080">,</font><font color="#000080">exist</font><font color="#808080">=</font><font color="#000080">bexiste</font><font color="#808080">)
        </font><font color="#0000FF">if </font><font color="#808080">(</font><font color="#000080">bexiste</font><font color="#808080">) </font><font color="#0000FF">then
          open</font><font color="#808080">(</font><font color="#000080">tfIdioma</font><font color="#808080">,</font><font color="#000080">file</font><font color="#808080">=</font><font color="#000080">ARQ_IDIOMA</font><font color="#808080">,</font><font color="#000080">status</font><font color="#808080">=</font><font color="#800000">'old'</font><font color="#808080">,</font><font color="#000080">access</font><font color="#808080">=</font><font color="#800000">'direct'</font><font color="#808080">,
     *         </font><font color="#000080">form</font><font color="#808080">=</font><font color="#800000">'formatted'</font><font color="#808080">,</font><font color="#000080">recl</font><font color="#808080">=</font><font color="#000080">TAM_IDIOMA</font><font color="#808080">)
        </font><font color="#0000FF">else
          write</font><font color="#808080">(*,</font><font color="#800000">&quot;(A37,' --&gt; ',A15)&quot;</font><font color="#808080">) </font><font color="#000080">MSG_ARQERRO</font><font color="#808080">, </font><font color="#000080">ARQ_IDIOMA
        </font><font color="#0000FF">end if
        </font><font color="#000080">inquire</font><font color="#808080">(</font><font color="#000080">file</font><font color="#808080">=</font><font color="#000080">ARQ_ENDERECO</font><font color="#808080">,</font><font color="#000080">exist</font><font color="#808080">=</font><font color="#000080">bexiste</font><font color="#808080">)
        </font><font color="#0000FF">if </font><font color="#808080">(</font><font color="#000080">bexiste</font><font color="#808080">) </font><font color="#0000FF">then
          open</font><font color="#808080">(</font><font color="#000080">tfEndereco</font><font color="#808080">,</font><font color="#000080">file</font><font color="#808080">=</font><font color="#000080">ARQ_ENDERECO</font><font color="#808080">,</font><font color="#000080">status</font><font color="#808080">=</font><font color="#800000">'old'</font><font color="#808080">,
     *         </font><font color="#000080">access</font><font color="#808080">=</font><font color="#800000">'direct'</font><font color="#808080">, </font><font color="#000080">form</font><font color="#808080">=</font><font color="#800000">'formatted'</font><font color="#808080">,</font><font color="#000080">recl</font><font color="#808080">=</font><font color="#000080">TAM_ENDERECO</font><font color="#808080">)
        </font><font color="#0000FF">else
          write</font><font color="#808080">(*,</font><font color="#800000">&quot;(A37,' --&gt; ',A15)&quot;</font><font color="#808080">) </font><font color="#000080">MSG_ARQERRO</font><font color="#808080">, </font><font color="#000080">ARQ_ENDERECO
        </font><font color="#0000FF">end if
        </font><font color="#000080">inquire</font><font color="#808080">(</font><font color="#000080">file</font><font color="#808080">=</font><font color="#000080">ARQ_PAIS</font><font color="#808080">,</font><font color="#000080">exist</font><font color="#808080">=</font><font color="#000080">bexiste</font><font color="#808080">)
        </font><font color="#0000FF">if </font><font color="#808080">(</font><font color="#000080">bexiste</font><font color="#808080">) </font><font color="#0000FF">then
          open</font><font color="#808080">(</font><font color="#000080">tfPais</font><font color="#808080">,</font><font color="#000080">file</font><font color="#808080">=</font><font color="#000080">ARQ_PAIS</font><font color="#808080">,</font><font color="#000080">status</font><font color="#808080">=</font><font color="#800000">'old'</font><font color="#808080">,</font><font color="#000080">access</font><font color="#808080">=</font><font color="#800000">'direct'</font><font color="#808080">,
     *         </font><font color="#000080">form</font><font color="#808080">=</font><font color="#800000">'formatted'</font><font color="#808080">,</font><font color="#000080">recl</font><font color="#808080">=</font><font color="#000080">TAM_PAIS</font><font color="#808080">)
        </font><font color="#0000FF">else
          write</font><font color="#808080">(*,</font><font color="#800000">&quot;(A37,' --&gt; ',A15)&quot;</font><font color="#808080">) </font><font color="#000080">MSG_ARQERRO</font><font color="#808080">, </font><font color="#000080">ARQ_PAIS
        </font><font color="#0000FF">end if
        </font><font color="#000080">inquire</font><font color="#808080">(</font><font color="#000080">file</font><font color="#808080">=</font><font color="#000080">ARQ_PROFISSAO</font><font color="#808080">,</font><font color="#000080">exist</font><font color="#808080">=</font><font color="#000080">bexiste</font><font color="#808080">)
        </font><font color="#0000FF">if </font><font color="#808080">(</font><font color="#000080">bexiste</font><font color="#808080">) </font><font color="#0000FF">then
          open</font><font color="#808080">(</font><font color="#000080">tfProfissao</font><font color="#808080">,</font><font color="#000080">file</font><font color="#808080">=</font><font color="#000080">ARQ_PROFISSAO</font><font color="#808080">,</font><font color="#000080">status</font><font color="#808080">=</font><font color="#800000">'old'</font><font color="#808080">,
     *         </font><font color="#000080">access</font><font color="#808080">=</font><font color="#800000">'direct'</font><font color="#808080">, </font><font color="#000080">form</font><font color="#808080">=</font><font color="#800000">'formatted'</font><font color="#808080">,</font><font color="#000080">recl</font><font color="#808080">=</font><font color="#000080">TAM_PROFISSAO</font><font color="#808080">)
        </font><font color="#0000FF">else
          write</font><font color="#808080">(*,</font><font color="#800000">&quot;(A37,' --&gt; ',A15)&quot;</font><font color="#808080">) </font><font color="#000080">MSG_ARQERRO</font><font color="#808080">, </font><font color="#000080">ARQ_PROFISSAO
        </font><font color="#0000FF">end if
        </font><font color="#000080">inquire</font><font color="#808080">(</font><font color="#000080">file</font><font color="#808080">=</font><font color="#000080">ARQ_LIVRO</font><font color="#808080">,</font><font color="#000080">exist</font><font color="#808080">=</font><font color="#000080">bexiste</font><font color="#808080">)
        </font><font color="#0000FF">if </font><font color="#808080">(</font><font color="#000080">bexiste</font><font color="#808080">) </font><font color="#0000FF">then
          open</font><font color="#808080">(</font><font color="#000080">tfLivro</font><font color="#808080">,</font><font color="#000080">file</font><font color="#808080">=</font><font color="#000080">ARQ_LIVRO</font><font color="#808080">,</font><font color="#000080">status</font><font color="#808080">=</font><font color="#800000">'old'</font><font color="#808080">,</font><font color="#000080">access</font><font color="#808080">=</font><font color="#800000">'direct'</font><font color="#808080">,
     *         </font><font color="#000080">form</font><font color="#808080">=</font><font color="#800000">'formatted'</font><font color="#808080">,</font><font color="#000080">recl</font><font color="#808080">=</font><font color="#000080">TAM_LIVRO</font><font color="#808080">)
        </font><font color="#0000FF">else
          write</font><font color="#808080">(*,</font><font color="#800000">&quot;(A37,' --&gt; ',A15)&quot;</font><font color="#808080">) </font><font color="#000080">MSG_ARQERRO</font><font color="#808080">, </font><font color="#000080">ARQ_LIVRO
        </font><font color="#0000FF">end if
        </font><font color="#000080">inquire</font><font color="#808080">(</font><font color="#000080">file</font><font color="#808080">=</font><font color="#000080">ARQ_LIVASS</font><font color="#808080">,</font><font color="#000080">exist</font><font color="#808080">=</font><font color="#000080">bexiste</font><font color="#808080">)
        </font><font color="#0000FF">if </font><font color="#808080">(</font><font color="#000080">bexiste</font><font color="#808080">) </font><font color="#0000FF">then
          open</font><font color="#808080">(</font><font color="#000080">tfLivroAss</font><font color="#808080">,</font><font color="#000080">file</font><font color="#808080">=</font><font color="#000080">ARQ_LIVASS</font><font color="#808080">,</font><font color="#000080">status</font><font color="#808080">=</font><font color="#800000">'old'</font><font color="#808080">,</font><font color="#000080">access</font><font color="#808080">=</font><font color="#800000">'direct'</font><font color="#808080">,
     *         </font><font color="#000080">form</font><font color="#808080">=</font><font color="#800000">'formatted'</font><font color="#808080">,</font><font color="#000080">recl</font><font color="#808080">=</font><font color="#000080">TAM_LIVASS</font><font color="#808080">)
        </font><font color="#0000FF">else
          write</font><font color="#808080">(*,</font><font color="#800000">&quot;(A37,' --&gt; ',A15)&quot;</font><font color="#808080">) </font><font color="#000080">MSG_ARQERRO</font><font color="#808080">, </font><font color="#000080">ARQ_LIVASS
        </font><font color="#0000FF">end if
        </font><font color="#000080">inquire</font><font color="#808080">(</font><font color="#000080">file</font><font color="#808080">=</font><font color="#000080">ARQ_LIVAUT</font><font color="#808080">,</font><font color="#000080">exist</font><font color="#808080">=</font><font color="#000080">bexiste</font><font color="#808080">)
        </font><font color="#0000FF">if </font><font color="#808080">(</font><font color="#000080">bexiste</font><font color="#808080">) </font><font color="#0000FF">then
          open</font><font color="#808080">(</font><font color="#000080">tfLivroAut</font><font color="#808080">,</font><font color="#000080">file</font><font color="#808080">=</font><font color="#000080">ARQ_LIVAUT</font><font color="#808080">,</font><font color="#000080">status</font><font color="#808080">=</font><font color="#800000">'old'</font><font color="#808080">,</font><font color="#000080">access</font><font color="#808080">=</font><font color="#800000">'direct'</font><font color="#808080">,
     *         </font><font color="#000080">form</font><font color="#808080">=</font><font color="#800000">'formatted'</font><font color="#808080">,</font><font color="#000080">recl</font><font color="#808080">=</font><font color="#000080">TAM_LIVAUT</font><font color="#808080">)
        </font><font color="#0000FF">else
          write</font><font color="#808080">(*,</font><font color="#800000">&quot;(A37,' --&gt; ',A15)&quot;</font><font color="#808080">) </font><font color="#000080">MSG_ARQERRO</font><font color="#808080">, </font><font color="#000080">ARQ_LIVAUT
        </font><font color="#0000FF">end if
        </font><font color="#000080">inquire</font><font color="#808080">(</font><font color="#000080">file</font><font color="#808080">=</font><font color="#000080">ARQ_CLIENTE</font><font color="#808080">,</font><font color="#000080">exist</font><font color="#808080">=</font><font color="#000080">bexiste</font><font color="#808080">)
        </font><font color="#0000FF">if </font><font color="#808080">(</font><font color="#000080">bexiste</font><font color="#808080">) </font><font color="#0000FF">then
          open</font><font color="#808080">(</font><font color="#000080">tfCliente</font><font color="#808080">,</font><font color="#000080">file</font><font color="#808080">=</font><font color="#000080">ARQ_CLIENTE</font><font color="#808080">,</font><font color="#000080">status</font><font color="#808080">=</font><font color="#800000">'old'</font><font color="#808080">,</font><font color="#000080">access</font><font color="#808080">=</font><font color="#800000">'direct'</font><font color="#808080">,
     *         </font><font color="#000080">form</font><font color="#808080">=</font><font color="#800000">'formatted'</font><font color="#808080">,</font><font color="#000080">recl</font><font color="#808080">=</font><font color="#000080">TAM_CLIENTE</font><font color="#808080">)
        </font><font color="#0000FF">else
          write</font><font color="#808080">(*,</font><font color="#800000">&quot;(A37,' --&gt; ',A15)&quot;</font><font color="#808080">) </font><font color="#000080">MSG_ARQERRO</font><font color="#808080">, </font><font color="#000080">ARQ_CLIENTE
        </font><font color="#0000FF">end if
        </font><font color="#000080">inquire</font><font color="#808080">(</font><font color="#000080">file</font><font color="#808080">=</font><font color="#000080">ARQ_USUARIO</font><font color="#808080">,</font><font color="#000080">exist</font><font color="#808080">=</font><font color="#000080">bexiste</font><font color="#808080">)
        </font><font color="#0000FF">if </font><font color="#808080">(</font><font color="#000080">bexiste</font><font color="#808080">) </font><font color="#0000FF">then
          open</font><font color="#808080">(</font><font color="#000080">tfUsuario</font><font color="#808080">,</font><font color="#000080">file</font><font color="#808080">=</font><font color="#000080">ARQ_USUARIO</font><font color="#808080">,</font><font color="#000080">status</font><font color="#808080">=</font><font color="#800000">'old'</font><font color="#808080">,</font><font color="#000080">access</font><font color="#808080">=</font><font color="#800000">'direct'</font><font color="#808080">,
     *         </font><font color="#000080">form</font><font color="#808080">=</font><font color="#800000">'formatted'</font><font color="#808080">,</font><font color="#000080">recl</font><font color="#808080">=</font><font color="#000080">TAM_USUARIO</font><font color="#808080">)
        </font><font color="#0000FF">else
          write</font><font color="#808080">(*,</font><font color="#800000">&quot;(A37,' --&gt; ',A15)&quot;</font><font color="#808080">) </font><font color="#000080">MSG_ARQERRO</font><font color="#808080">, </font><font color="#000080">ARQ_USUARIO
        </font><font color="#0000FF">end if
        </font><font color="#000080">inquire</font><font color="#808080">(</font><font color="#000080">file</font><font color="#808080">=</font><font color="#000080">ARQ_VENDA</font><font color="#808080">,</font><font color="#000080">exist</font><font color="#808080">=</font><font color="#000080">bexiste</font><font color="#808080">)
        </font><font color="#0000FF">if </font><font color="#808080">(</font><font color="#000080">bexiste</font><font color="#808080">) </font><font color="#0000FF">then
          open</font><font color="#808080">(</font><font color="#000080">tfVenda</font><font color="#808080">,</font><font color="#000080">file</font><font color="#808080">=</font><font color="#000080">ARQ_VENDA</font><font color="#808080">,</font><font color="#000080">status</font><font color="#808080">=</font><font color="#800000">'old'</font><font color="#808080">,</font><font color="#000080">access</font><font color="#808080">=</font><font color="#800000">'direct'</font><font color="#808080">,
     *         </font><font color="#000080">form</font><font color="#808080">=</font><font color="#800000">'formatted'</font><font color="#808080">,</font><font color="#000080">recl</font><font color="#808080">=</font><font color="#000080">TAM_VENDA</font><font color="#808080">)
        </font><font color="#0000FF">else
          write</font><font color="#808080">(*,</font><font color="#800000">&quot;(A37,' --&gt; ',A15)&quot;</font><font color="#808080">) </font><font color="#000080">MSG_ARQERRO</font><font color="#808080">, </font><font color="#000080">ARQ_VENDA
        </font><font color="#0000FF">end if
      else
        open</font><font color="#808080">(</font><font color="#000080">tfAssunto</font><font color="#808080">,</font><font color="#000080">file</font><font color="#808080">=</font><font color="#000080">ARQ_ASSUNTO</font><font color="#808080">,</font><font color="#000080">status</font><font color="#808080">=</font><font color="#800000">'new'</font><font color="#808080">,</font><font color="#000080">access</font><font color="#808080">=</font><font color="#800000">'direct'</font><font color="#808080">,
     *       </font><font color="#000080">form</font><font color="#808080">=</font><font color="#800000">'formatted'</font><font color="#808080">,</font><font color="#000080">recl</font><font color="#808080">=</font><font color="#000080">TAM_ASSUNTO</font><font color="#808080">)
        </font><font color="#0000FF">open</font><font color="#808080">(</font><font color="#000080">tfAutor</font><font color="#808080">,</font><font color="#000080">file</font><font color="#808080">=</font><font color="#000080">ARQ_AUTOR</font><font color="#808080">,</font><font color="#000080">status</font><font color="#808080">=</font><font color="#800000">'new'</font><font color="#808080">,</font><font color="#000080">access</font><font color="#808080">=</font><font color="#800000">'direct'</font><font color="#808080">,
     *       </font><font color="#000080">form</font><font color="#808080">=</font><font color="#800000">'formatted'</font><font color="#808080">,</font><font color="#000080">recl</font><font color="#808080">=</font><font color="#000080">TAM_AUTOR</font><font color="#808080">)
        </font><font color="#0000FF">open</font><font color="#808080">(</font><font color="#000080">tfEditora</font><font color="#808080">,</font><font color="#000080">file</font><font color="#808080">=</font><font color="#000080">ARQ_EDITORA</font><font color="#808080">,</font><font color="#000080">status</font><font color="#808080">=</font><font color="#800000">'new'</font><font color="#808080">,</font><font color="#000080">access</font><font color="#808080">=</font><font color="#800000">'direct'</font><font color="#808080">,
     *       </font><font color="#000080">form</font><font color="#808080">=</font><font color="#800000">'formatted'</font><font color="#808080">,</font><font color="#000080">recl</font><font color="#808080">=</font><font color="#000080">TAM_EDITORA</font><font color="#808080">)
        </font><font color="#0000FF">open</font><font color="#808080">(</font><font color="#000080">tfIdioma</font><font color="#808080">,</font><font color="#000080">file</font><font color="#808080">=</font><font color="#000080">ARQ_IDIOMA</font><font color="#808080">,</font><font color="#000080">status</font><font color="#808080">=</font><font color="#800000">'new'</font><font color="#808080">,</font><font color="#000080">access</font><font color="#808080">=</font><font color="#800000">'direct'</font><font color="#808080">,
     *       </font><font color="#000080">form</font><font color="#808080">=</font><font color="#800000">'formatted'</font><font color="#808080">,</font><font color="#000080">recl</font><font color="#808080">=</font><font color="#000080">TAM_IDIOMA</font><font color="#808080">)
        </font><font color="#0000FF">open</font><font color="#808080">(</font><font color="#000080">tfEndereco</font><font color="#808080">,</font><font color="#000080">file</font><font color="#808080">=</font><font color="#000080">ARQ_ENDERECO</font><font color="#808080">,</font><font color="#000080">status</font><font color="#808080">=</font><font color="#800000">'new'</font><font color="#808080">,</font><font color="#000080">access</font><font color="#808080">=</font><font color="#800000">'direct'</font><font color="#808080">,
     *       </font><font color="#000080">form</font><font color="#808080">=</font><font color="#800000">'formatted'</font><font color="#808080">,</font><font color="#000080">recl</font><font color="#808080">=</font><font color="#000080">TAM_ENDERECO</font><font color="#808080">)
        </font><font color="#0000FF">open</font><font color="#808080">(</font><font color="#000080">tfPais</font><font color="#808080">,</font><font color="#000080">file</font><font color="#808080">=</font><font color="#000080">ARQ_PAIS</font><font color="#808080">,</font><font color="#000080">status</font><font color="#808080">=</font><font color="#800000">'new'</font><font color="#808080">,</font><font color="#000080">access</font><font color="#808080">=</font><font color="#800000">'direct'</font><font color="#808080">,
     *       </font><font color="#000080">form</font><font color="#808080">=</font><font color="#800000">'formatted'</font><font color="#808080">,</font><font color="#000080">recl</font><font color="#808080">=</font><font color="#000080">TAM_PAIS</font><font color="#808080">)
        </font><font color="#0000FF">open</font><font color="#808080">(</font><font color="#000080">tfProfissao</font><font color="#808080">,</font><font color="#000080">file</font><font color="#808080">=</font><font color="#000080">ARQ_PROFISSAO</font><font color="#808080">,</font><font color="#000080">status</font><font color="#808080">=</font><font color="#800000">'new'</font><font color="#808080">,
     *       </font><font color="#000080">access</font><font color="#808080">=</font><font color="#800000">'direct'</font><font color="#808080">, </font><font color="#000080">form</font><font color="#808080">=</font><font color="#800000">'formatted'</font><font color="#808080">,</font><font color="#000080">recl</font><font color="#808080">=</font><font color="#000080">TAM_PROFISSAO</font><font color="#808080">)
        </font><font color="#0000FF">open</font><font color="#808080">(</font><font color="#000080">tfLivro</font><font color="#808080">,</font><font color="#000080">file</font><font color="#808080">=</font><font color="#000080">ARQ_LIVRO</font><font color="#808080">,</font><font color="#000080">status</font><font color="#808080">=</font><font color="#800000">'new'</font><font color="#808080">,</font><font color="#000080">access</font><font color="#808080">=</font><font color="#800000">'direct'</font><font color="#808080">,
     *       </font><font color="#000080">form</font><font color="#808080">=</font><font color="#800000">'formatted'</font><font color="#808080">,</font><font color="#000080">recl</font><font color="#808080">=</font><font color="#000080">TAM_LIVRO</font><font color="#808080">)
        </font><font color="#0000FF">open</font><font color="#808080">(</font><font color="#000080">tfLivroAss</font><font color="#808080">,</font><font color="#000080">file</font><font color="#808080">=</font><font color="#000080">ARQ_LIVASS</font><font color="#808080">,</font><font color="#000080">status</font><font color="#808080">=</font><font color="#800000">'new'</font><font color="#808080">,</font><font color="#000080">access</font><font color="#808080">=</font><font color="#800000">'direct'</font><font color="#808080">,
     *       </font><font color="#000080">form</font><font color="#808080">=</font><font color="#800000">'formatted'</font><font color="#808080">,</font><font color="#000080">recl</font><font color="#808080">=</font><font color="#000080">TAM_LIVASS</font><font color="#808080">)
        </font><font color="#0000FF">open</font><font color="#808080">(</font><font color="#000080">tfLivroAut</font><font color="#808080">,</font><font color="#000080">file</font><font color="#808080">=</font><font color="#000080">ARQ_LIVAUT</font><font color="#808080">,</font><font color="#000080">status</font><font color="#808080">=</font><font color="#800000">'new'</font><font color="#808080">,</font><font color="#000080">access</font><font color="#808080">=</font><font color="#800000">'direct'</font><font color="#808080">,
     *       </font><font color="#000080">form</font><font color="#808080">=</font><font color="#800000">'formatted'</font><font color="#808080">,</font><font color="#000080">recl</font><font color="#808080">=</font><font color="#000080">TAM_LIVAUT</font><font color="#808080">)
        </font><font color="#0000FF">open</font><font color="#808080">(</font><font color="#000080">tfCliente</font><font color="#808080">,</font><font color="#000080">file</font><font color="#808080">=</font><font color="#000080">ARQ_CLIENTE</font><font color="#808080">,</font><font color="#000080">status</font><font color="#808080">=</font><font color="#800000">'new'</font><font color="#808080">,</font><font color="#000080">access</font><font color="#808080">=</font><font color="#800000">'direct'</font><font color="#808080">,
     *       </font><font color="#000080">form</font><font color="#808080">=</font><font color="#800000">'formatted'</font><font color="#808080">,</font><font color="#000080">recl</font><font color="#808080">=</font><font color="#000080">TAM_CLIENTE</font><font color="#808080">)
        </font><font color="#0000FF">open</font><font color="#808080">(</font><font color="#000080">tfUsuario</font><font color="#808080">,</font><font color="#000080">file</font><font color="#808080">=</font><font color="#000080">ARQ_USUARIO</font><font color="#808080">,</font><font color="#000080">status</font><font color="#808080">=</font><font color="#800000">'new'</font><font color="#808080">,</font><font color="#000080">access</font><font color="#808080">=</font><font color="#800000">'direct'</font><font color="#808080">,
     *       </font><font color="#000080">form</font><font color="#808080">=</font><font color="#800000">'formatted'</font><font color="#808080">,</font><font color="#000080">recl</font><font color="#808080">=</font><font color="#000080">TAM_USUARIO</font><font color="#808080">)
        </font><font color="#0000FF">open</font><font color="#808080">(</font><font color="#000080">tfVenda</font><font color="#808080">,</font><font color="#000080">file</font><font color="#808080">=</font><font color="#000080">ARQ_VENDA</font><font color="#808080">,</font><font color="#000080">status</font><font color="#808080">=</font><font color="#800000">'new'</font><font color="#808080">,</font><font color="#000080">access</font><font color="#808080">=</font><font color="#800000">'direct'</font><font color="#808080">,
     *       </font><font color="#000080">form</font><font color="#808080">=</font><font color="#800000">'formatted'</font><font color="#808080">,</font><font color="#000080">recl</font><font color="#808080">=</font><font color="#000080">TAM_VENDA</font><font color="#808080">)
      </font><font color="#0000FF">end if
      return 
      end

</font><font color="#808080"><i>C     ------------------------------------------------------------------
C     Fecha todos os arquivos abertos.
C     ------------------------------------------------------------------
      </i></font><font color="#0000FF">subroutine </font><font color="#000080">fechaArqs

      </font><font color="#0000FF">include </font><font color="#800000">'livrus.h'

      </font><font color="#0000FF">close</font><font color="#808080">(</font><font color="#000080">tfAssunto</font><font color="#808080">)
      </font><font color="#0000FF">close</font><font color="#808080">(</font><font color="#000080">tfAutor</font><font color="#808080">)
      </font><font color="#0000FF">close</font><font color="#808080">(</font><font color="#000080">tfEditora</font><font color="#808080">)
      </font><font color="#0000FF">close</font><font color="#808080">(</font><font color="#000080">tfIdioma</font><font color="#808080">)
      </font><font color="#0000FF">close</font><font color="#808080">(</font><font color="#000080">tfEndereco</font><font color="#808080">)
      </font><font color="#0000FF">close</font><font color="#808080">(</font><font color="#000080">tfPais</font><font color="#808080">)
      </font><font color="#0000FF">close</font><font color="#808080">(</font><font color="#000080">tfProfissao</font><font color="#808080">)
      </font><font color="#0000FF">close</font><font color="#808080">(</font><font color="#000080">tfLivro</font><font color="#808080">)
      </font><font color="#0000FF">close</font><font color="#808080">(</font><font color="#000080">tfLivroAss</font><font color="#808080">)
      </font><font color="#0000FF">close</font><font color="#808080">(</font><font color="#000080">tfLivroAut</font><font color="#808080">)
      </font><font color="#0000FF">close</font><font color="#808080">(</font><font color="#000080">tfCliente</font><font color="#808080">)
      </font><font color="#0000FF">close</font><font color="#808080">(</font><font color="#000080">tfUsuario</font><font color="#808080">)
      </font><font color="#0000FF">close</font><font color="#808080">(</font><font color="#000080">tfVenda</font><font color="#808080">)
      </font><font color="#0000FF">end
</font><font color="#808080"><i>C     ------------------------------------------------------------------
C     Pesquisa um registro atrav&eacute;s de um valor chave num arquivo.
C     sArq - o arquivo
C     sChave - a chave a ser pesquisada
C     nPosChave - a posicao inicial da chave dentro do registro
C     nTamChave - o tamanho da chave dentro do registro
C     nTamLinha - o tamanho do registro
C     retorna - o registro pesquisado
C     ------------------------------------------------------------------
      </i></font><font color="#0000FF">character</font><font color="#808080">*(*) </font><font color="#0000FF">function </font><font color="#000080">pesqArq</font><font color="#808080">(</font><font color="#000080">sArq</font><font color="#808080">, </font><font color="#000080">sChave</font><font color="#808080">, </font><font color="#000080">nPosChave</font><font color="#808080">, </font><font color="#000080">nTamChave
     </font><font color="#808080">*, </font><font color="#000080">nTamLinha</font><font color="#808080">)
      </font><font color="#0000FF">integer </font><font color="#000080">sArq</font><font color="#808080">, </font><font color="#000080">nPosChave</font><font color="#808080">, </font><font color="#000080">nTamChave</font><font color="#808080">, </font><font color="#000080">nTamLinha
      </font><font color="#0000FF">character</font><font color="#808080">*</font><font color="#FF0000">255 </font><font color="#000080">sChave
     
      </font><font color="#0000FF">character</font><font color="#808080">*</font><font color="#FF0000">255 </font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#000080">sres</font><font color="#808080">, </font><font color="#000080">ftrim</font><font color="#808080">, </font><font color="#000080">copy
      </font><font color="#0000FF">logical </font><font color="#000080">bQuebra
      </font><font color="#0000FF">integer </font><font color="#000080">nPosicao</font><font color="#808080">, </font><font color="#000080">fimarq

      slinha </font><font color="#808080">=</font><font color="#800000">'\0'
      </font><font color="#000080">sres</font><font color="#808080">=</font><font color="#800000">'\0'
      </font><font color="#000080">nPosicao </font><font color="#808080">= </font><font color="#FF0000">1
      </font><font color="#000080">bQuebra</font><font color="#808080">=</font><font color="#0000FF">.false.
</font><font color="#808080"><i>C      fseek(sArq, 0)
      </i></font><font color="#0000FF">do while </font><font color="#808080">((</font><font color="#000080">fimarq</font><font color="#0000FF">.ne.</font><font color="#808080">-</font><font color="#FF0000">1</font><font color="#808080">) </font><font color="#0000FF">.and. </font><font color="#808080">(</font><font color="#000080">bQuebra .eqv. </font><font color="#0000FF">.false.</font><font color="#808080">))
        </font><font color="#0000FF">read</font><font color="#808080">(</font><font color="#000080">sArq</font><font color="#808080">,</font><font color="#000080">rec</font><font color="#808080">=</font><font color="#000080">nPosicao</font><font color="#808080">,</font><font color="#000080">iostat</font><font color="#808080">=</font><font color="#000080">fimarq</font><font color="#808080">) </font><font color="#000080">slinha
</font><font color="#808080"><i>C        sres=ftrim(slinha(nPosChave:nPosChave+nTamChave-1))
C        sres=slinha(nPosChave:nPosChave+nTamChave-1)
        </i></font><font color="#000080">sres </font><font color="#808080">= </font><font color="#000080">ftrim</font><font color="#808080">(</font><font color="#000080">copy</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">,</font><font color="#000080">nPosChave</font><font color="#808080">,</font><font color="#000080">nTamChave</font><font color="#808080">))
        </font><font color="#0000FF">if </font><font color="#808080">(</font><font color="#000080">sres.eq.sChave</font><font color="#808080">) </font><font color="#0000FF">then
           </font><font color="#000080">bQuebra</font><font color="#808080">=</font><font color="#0000FF">.true.
        end if 
        </font><font color="#000080">nPosicao</font><font color="#808080">=</font><font color="#000080">nPosicao</font><font color="#808080">+</font><font color="#FF0000">1
      </font><font color="#0000FF">end do

      </font><font color="#000080">nPosicao</font><font color="#808080">=</font><font color="#000080">ftell</font><font color="#808080">(</font><font color="#000080">sArq</font><font color="#808080">)-(</font><font color="#000080">nTamLinha </font><font color="#808080">+ </font><font color="#000080">TAM_CRLF</font><font color="#808080">)
<i>C      if (nPosicao.gt.0) then
C         seek(sArq, nPosicao)
C      else
C         seek(sArq, 0)
C      end if
      </i></font><font color="#0000FF">if </font><font color="#808080">(</font><font color="#000080">sRes.ne.sChave</font><font color="#808080">) </font><font color="#0000FF">then
         </font><font color="#000080">pesqArq</font><font color="#808080">=</font><font color="#800000">'\0'
      </font><font color="#0000FF">else
         </font><font color="#000080">pesqArq </font><font color="#808080">= </font><font color="#000080">copy</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#000080">nTamLinha</font><font color="#808080">)
      </font><font color="#0000FF">end if
      end
</font><font color="#808080"><i>C     ------------------------------------------------------------------
C     Pesquisa se tem linha exclu&iacute;da sen&atilde;o vai para a &uacute;ltima linha do arquivo.
C     sArq - o arquivo
C     nTamLinha - o tamanho do registro
C     ------------------------------------------------------------------
      </i></font><font color="#0000FF">subroutine </font><font color="#000080">pesqLinhaExcluida</font><font color="#808080">(</font><font color="#000080">sArq</font><font color="#808080">, </font><font color="#000080">nTamLinha</font><font color="#808080">)
      </font><font color="#0000FF">integer </font><font color="#000080">sArq</font><font color="#808080">, </font><font color="#000080">nTamLinha
      </font><font color="#0000FF">character</font><font color="#808080">*</font><font color="#FF0000">255 </font><font color="#000080">sExcluido</font><font color="#808080">, </font><font color="#000080">pesqArq
      
      sExcluido </font><font color="#808080">= </font><font color="#000080">pesqArq</font><font color="#808080">(</font><font color="#000080">sArq</font><font color="#808080">, </font><font color="#800000">&quot;*&quot;</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#000080">nTamLinha</font><font color="#808080">)
<i>C      if (sExcluido .eq. &quot;&quot;) then
C         fseek(sArq, tamArq(sArq))
C      end if
      </i></font><font color="#0000FF">return
      end
</font><font color="#808080"><i>C     ------------------------------------------------------------------
C     Pesquisa o maior c&oacute;digo num arquivo.
C     sArq - o arquivo
C     nPosChave - a posicao inicial da chave dentro do registro
C     nTamChave - o tamanho da chave dentro do registro
C     nTamLinha - o tamanho do registro
C     retorna - o maior c&oacute;digo
C     ------------------------------------------------------------------
      </i></font><font color="#0000FF">character</font><font color="#808080">*(*) </font><font color="#0000FF">function </font><font color="#000080">pesqMaxCod</font><font color="#808080">(</font><font color="#000080">sArq</font><font color="#808080">, </font><font color="#000080">nPosChave</font><font color="#808080">, 
     * </font><font color="#000080">nTamChave</font><font color="#808080">, </font><font color="#000080">nTamLinha</font><font color="#808080">)
      </font><font color="#0000FF">integer </font><font color="#000080">sArq</font><font color="#808080">, </font><font color="#000080">nPosChave</font><font color="#808080">, </font><font color="#000080">nTamChave</font><font color="#808080">, </font><font color="#000080">nTamLinha

      </font><font color="#0000FF">character</font><font color="#808080">*</font><font color="#FF0000">255 </font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#000080">sres</font><font color="#808080">, </font><font color="#000080">IntToStr</font><font color="#808080">, </font><font color="#000080">ftrim</font><font color="#808080">, </font><font color="#000080">copy
      </font><font color="#0000FF">logical </font><font color="#000080">bQuebra
      </font><font color="#0000FF">integer </font><font color="#000080">nMaior</font><font color="#808080">, </font><font color="#000080">nCod</font><font color="#808080">, </font><font color="#000080">fimarq</font><font color="#808080">, </font><font color="#000080">nPosicao</font><font color="#808080">, </font><font color="#000080">StrToInt

      bQuebra</font><font color="#808080">=</font><font color="#0000FF">.false.
      </font><font color="#000080">nMaior</font><font color="#808080">=</font><font color="#FF0000">0
</font><font color="#808080"><i>C      fseek(sArq, 0)

      </i></font><font color="#0000FF">do while </font><font color="#808080">((</font><font color="#000080">fimarq</font><font color="#0000FF">.ne.</font><font color="#808080">-</font><font color="#FF0000">1</font><font color="#808080">) </font><font color="#0000FF">.and. </font><font color="#808080">(</font><font color="#000080">bQuebra .eqv. </font><font color="#0000FF">.false.</font><font color="#808080">))
        </font><font color="#0000FF">read</font><font color="#808080">(</font><font color="#000080">sArq</font><font color="#808080">,</font><font color="#000080">rec</font><font color="#808080">=</font><font color="#000080">nPosicao</font><font color="#808080">,</font><font color="#000080">iostat</font><font color="#808080">=</font><font color="#000080">fimarq</font><font color="#808080">) </font><font color="#000080">slinha
        sres</font><font color="#808080">=</font><font color="#000080">ftrim</font><font color="#808080">(</font><font color="#000080">copy</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">,</font><font color="#000080">nPosChave</font><font color="#808080">,</font><font color="#000080">nTamChave</font><font color="#808080">))
        </font><font color="#000080">nCod </font><font color="#808080">= </font><font color="#000080">StrToInt</font><font color="#808080">(</font><font color="#000080">sres</font><font color="#808080">)
        </font><font color="#0000FF">if </font><font color="#808080">(</font><font color="#000080">nCod </font><font color="#0000FF">.gt. </font><font color="#000080">nMaior</font><font color="#808080">) </font><font color="#0000FF">then
           </font><font color="#000080">nMaior</font><font color="#808080">=</font><font color="#000080">nCod
        </font><font color="#0000FF">end if
        </font><font color="#000080">nPosicao</font><font color="#808080">=</font><font color="#000080">nPosicao</font><font color="#808080">+</font><font color="#FF0000">1
      </font><font color="#0000FF">end do
      call </font><font color="#000080">pesqLinhaExcluida</font><font color="#808080">(</font><font color="#000080">sArq</font><font color="#808080">, </font><font color="#000080">nTamLinha</font><font color="#808080">)
      </font><font color="#000080">sres</font><font color="#808080">=</font><font color="#000080">IntToStr</font><font color="#808080">(</font><font color="#000080">nMaior</font><font color="#808080">+</font><font color="#FF0000">1</font><font color="#808080">)
      </font><font color="#000080">pesqMaxCod</font><font color="#808080">=</font><font color="#000080">sres
      </font><font color="#0000FF">return
      end
</font><font color="#808080"><i>C     ------------------------------------------------------------------
C     Grava os registros num determinado arquivo.
C     sArq - o arquivo
C     sTexto - o registro a ser gravado
C     sMsgAcerto - a mensagem caso o registro foi gravado
C     sMsgErro - a mensagem caso o registro n&atilde;o foi gravado
C     ------------------------------------------------------------------
      </i></font><font color="#0000FF">subroutine </font><font color="#000080">escreveArq</font><font color="#808080">(</font><font color="#000080">sArq</font><font color="#808080">, </font><font color="#000080">sTexto</font><font color="#808080">, </font><font color="#000080">sMsgAcerto</font><font color="#808080">,</font>	<font color="#000080">sMsgErro</font><font color="#808080">)
      </font><font color="#0000FF">integer </font><font color="#000080">sArq 
      </font><font color="#0000FF">character</font><font color="#808080">*</font><font color="#FF0000">255 </font><font color="#000080">sTexto</font><font color="#808080">, </font><font color="#000080">sMsgAcerto</font><font color="#808080">,</font>	<font color="#000080">sMsgErro

      </font><font color="#0000FF">include </font><font color="#800000">'livrus.h'
      </font><font color="#0000FF">integer </font><font color="#000080">nStatus

      </font><font color="#0000FF">call </font><font color="#000080">SomaStr</font><font color="#808080">(</font><font color="#000080">sTexto</font><font color="#808080">, </font><font color="#000080">CRLF</font><font color="#808080">)
      </font><font color="#0000FF">write</font><font color="#808080">(</font><font color="#000080">sArq</font><font color="#808080">,</font><font color="#000080">rec</font><font color="#808080">=</font><font color="#000080">nPosicao</font><font color="#808080">,</font><font color="#000080">iostat</font><font color="#808080">=</font><font color="#000080">nStatus</font><font color="#808080">) </font><font color="#000080">sTexto
      </font><font color="#0000FF">if </font><font color="#808080">(</font><font color="#000080">nStatus </font><font color="#808080">&gt; </font><font color="#FF0000">0</font><font color="#808080">) </font><font color="#0000FF">then 
        write</font><font color="#808080">(*,*) </font><font color="#000080">sMsgAcerto
      </font><font color="#0000FF">else
        write</font><font color="#808080">(*,*) </font><font color="#000080">sMsgErro
      </font><font color="#0000FF">end if

      return
      end
</font><font color="#808080"><i>C     ------------------------------------------------------------------
C     Monta o tamanho do registro no arquivo de acordo com o tipo de arquivo.
C     sreg - o tipo de arquivo
C     retorna - o registro montado
C     ------------------------------------------------------------------
      </i></font><font color="#0000FF">character</font><font color="#808080">*(*) </font><font color="#0000FF">function </font><font color="#000080">LinhaReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">)
      </font><font color="#0000FF">integer </font><font color="#000080">sreg

      </font><font color="#0000FF">include </font><font color="#800000">'livrus.h'
      </font><font color="#0000FF">character</font><font color="#808080">*</font><font color="#FF0000">255 </font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#000080">esp

      slinha</font><font color="#808080">=</font><font color="#000080">char</font><font color="#808080">(</font><font color="#FF0000">0</font><font color="#808080">)
      </font><font color="#0000FF">if </font><font color="#808080">(</font><font color="#000080">sreg </font><font color="#0000FF">.eq. </font><font color="#000080">opAssunto</font><font color="#808080">) </font><font color="#0000FF">then
         </font><font color="#000080">slinha</font><font color="#808080">=</font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">tAssunto_codigo</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">)
         </font><font color="#0000FF">call </font><font color="#000080">SomaStr</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">,</font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">tAssunto_assunto</font><font color="#808080">,</font><font color="#FF0000">30</font><font color="#808080">))
      </font><font color="#0000FF">else if </font><font color="#808080">(</font><font color="#000080">sreg </font><font color="#0000FF">.eq. </font><font color="#000080">opAutor</font><font color="#808080">) </font><font color="#0000FF">then
         </font><font color="#000080">slinha</font><font color="#808080">=</font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">tAutor_codigo</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">)
         </font><font color="#0000FF">call </font><font color="#000080">SomaStr</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">,</font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">tAutor_autor</font><font color="#808080">,</font><font color="#FF0000">30</font><font color="#808080">))
      </font><font color="#0000FF">else if </font><font color="#808080">(</font><font color="#000080">sreg </font><font color="#0000FF">.eq. </font><font color="#000080">opEditora</font><font color="#808080">) </font><font color="#0000FF">then
         </font><font color="#000080">slinha</font><font color="#808080">=</font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">tEditora_codigo</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">)
         </font><font color="#0000FF">call </font><font color="#000080">SomaStr</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">,</font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">tEditora_editora</font><font color="#808080">,</font><font color="#FF0000">50</font><font color="#808080">))
      </font><font color="#0000FF">else if </font><font color="#808080">(</font><font color="#000080">sreg </font><font color="#0000FF">.eq. </font><font color="#000080">opEndereco</font><font color="#808080">) </font><font color="#0000FF">then
         </font><font color="#000080">slinha</font><font color="#808080">=</font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">tEndereco_codigo</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">)
         </font><font color="#0000FF">call </font><font color="#000080">SomaStr</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">,</font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">tEndereco_logradouro</font><font color="#808080">,</font><font color="#FF0000">40</font><font color="#808080">))
         </font><font color="#0000FF">call </font><font color="#000080">SomaStr</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">,</font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">tEndereco_bairro</font><font color="#808080">,</font><font color="#FF0000">15</font><font color="#808080">))
         </font><font color="#0000FF">call </font><font color="#000080">SomaStr</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">,</font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">tEndereco_cep</font><font color="#808080">,</font><font color="#FF0000">8</font><font color="#808080">))
         </font><font color="#0000FF">call </font><font color="#000080">SomaStr</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">,</font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">tEndereco_cidade</font><font color="#808080">,</font><font color="#FF0000">30</font><font color="#808080">))
         </font><font color="#0000FF">call </font><font color="#000080">SomaStr</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">,</font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">tEndereco_estado</font><font color="#808080">,</font><font color="#FF0000">20</font><font color="#808080">))
      </font><font color="#0000FF">else if </font><font color="#808080">(</font><font color="#000080">sreg </font><font color="#0000FF">.eq. </font><font color="#000080">opIdioma</font><font color="#808080">) </font><font color="#0000FF">then
         </font><font color="#000080">slinha</font><font color="#808080">=</font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">tIdioma_codigo</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">)
         </font><font color="#0000FF">call </font><font color="#000080">SomaStr</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">,</font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">tIdioma_idioma</font><font color="#808080">,</font><font color="#FF0000">20</font><font color="#808080">))
      </font><font color="#0000FF">else if </font><font color="#808080">(</font><font color="#000080">sreg </font><font color="#0000FF">.eq. </font><font color="#000080">opPais</font><font color="#808080">) </font><font color="#0000FF">then
         </font><font color="#000080">slinha</font><font color="#808080">=</font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">tPais_codigo</font><font color="#808080">,</font><font color="#FF0000">3</font><font color="#808080">)
         </font><font color="#0000FF">call </font><font color="#000080">SomaStr</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">,</font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">tPais_pais</font><font color="#808080">,</font><font color="#FF0000">50</font><font color="#808080">))
      </font><font color="#0000FF">else if </font><font color="#808080">(</font><font color="#000080">sreg </font><font color="#0000FF">.eq. </font><font color="#000080">opProfissao</font><font color="#808080">) </font><font color="#0000FF">then
         </font><font color="#000080">slinha</font><font color="#808080">=</font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">tProfissao_codigo</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">)
         </font><font color="#0000FF">call </font><font color="#000080">SomaStr</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">,</font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">tProfissao_profissao</font><font color="#808080">,</font><font color="#FF0000">50</font><font color="#808080">))
      </font><font color="#0000FF">else if </font><font color="#808080">(</font><font color="#000080">sreg </font><font color="#0000FF">.eq. </font><font color="#000080">opUsuario</font><font color="#808080">) </font><font color="#0000FF">then
         </font><font color="#000080">slinha</font><font color="#808080">=</font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">tUsuario_login</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">)
         </font><font color="#0000FF">call </font><font color="#000080">SomaStr</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">,</font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">tUsuario_senha</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">))
      </font><font color="#0000FF">else if </font><font color="#808080">(</font><font color="#000080">sreg </font><font color="#0000FF">.eq. </font><font color="#000080">opLivro</font><font color="#808080">) </font><font color="#0000FF">then
         </font><font color="#000080">slinha</font><font color="#808080">=</font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">tLivro_isbn</font><font color="#808080">,</font><font color="#FF0000">13</font><font color="#808080">)
         </font><font color="#0000FF">call </font><font color="#000080">SomaStr</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">,</font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">tLivro_titulo</font><font color="#808080">,</font><font color="#FF0000">50</font><font color="#808080">))
         </font><font color="#0000FF">call </font><font color="#000080">SomaStr</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">,</font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">tLivro_edicao</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">))
         </font><font color="#0000FF">call </font><font color="#000080">SomaStr</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">,</font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">tLivro_anopubli</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">))
         </font><font color="#0000FF">call </font><font color="#000080">SomaStr</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">,</font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">tLivro_codeditora</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">))
         </font><font color="#0000FF">call </font><font color="#000080">SomaStr</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">,</font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">tLivro_volume</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">))
         </font><font color="#0000FF">call </font><font color="#000080">SomaStr</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">,</font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">tLivro_codidioma</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">))
         </font><font color="#0000FF">call </font><font color="#000080">SomaStr</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">,</font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">tLivro_npaginas</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">))
         </font><font color="#0000FF">call </font><font color="#000080">SomaStr</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">,</font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">tLivro_preco</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">))
         </font><font color="#0000FF">call </font><font color="#000080">SomaStr</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">,</font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">tLivro_qtdestoque</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">))         
      </font><font color="#0000FF">else if </font><font color="#808080">(</font><font color="#000080">sreg </font><font color="#0000FF">.eq. </font><font color="#000080">opLivroAss</font><font color="#808080">) </font><font color="#0000FF">then
         </font><font color="#000080">slinha</font><font color="#808080">=</font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">tLivroAss_isbn</font><font color="#808080">,</font><font color="#FF0000">13</font><font color="#808080">)
         </font><font color="#0000FF">call </font><font color="#000080">SomaStr</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">,</font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">tlivroAss_codassunto</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">))
      </font><font color="#0000FF">else if </font><font color="#808080">(</font><font color="#000080">sreg </font><font color="#0000FF">.eq. </font><font color="#000080">opLivroAut</font><font color="#808080">) </font><font color="#0000FF">then
         </font><font color="#000080">slinha</font><font color="#808080">=</font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">tLivroAut_isbn</font><font color="#808080">,</font><font color="#FF0000">13</font><font color="#808080">)
         </font><font color="#0000FF">call </font><font color="#000080">SomaStr</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">,</font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">tlivroAut_codautor</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">))
      </font><font color="#0000FF">else if </font><font color="#808080">(</font><font color="#000080">sreg </font><font color="#0000FF">.eq. </font><font color="#000080">opCliente</font><font color="#808080">) </font><font color="#0000FF">then
         </font><font color="#000080">slinha</font><font color="#808080">=</font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">tCliente_cpf</font><font color="#808080">,</font><font color="#FF0000">14</font><font color="#808080">)
         </font><font color="#0000FF">call </font><font color="#000080">SomaStr</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">,</font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">tCliente_nome</font><font color="#808080">,</font><font color="#FF0000">30</font><font color="#808080">))
         </font><font color="#0000FF">call </font><font color="#000080">SomaStr</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">,</font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">tCliente_email</font><font color="#808080">,</font><font color="#FF0000">30</font><font color="#808080">))
         </font><font color="#0000FF">call </font><font color="#000080">SomaStr</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">,</font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">tCliente_identidade</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">))
         </font><font color="#0000FF">call </font><font color="#000080">SomaStr</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">,</font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">tCliente_sexo</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">))
         </font><font color="#0000FF">call </font><font color="#000080">SomaStr</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">,</font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">tCliente_telefone</font><font color="#808080">,</font><font color="#FF0000">17</font><font color="#808080">))
         </font><font color="#0000FF">call </font><font color="#000080">SomaStr</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">,</font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">tCliente_dtnascimento</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">))
         </font><font color="#0000FF">call </font><font color="#000080">SomaStr</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">,</font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">tCliente_codendereco</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">))
         </font><font color="#0000FF">call </font><font color="#000080">SomaStr</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">,</font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">tCliente_codpais</font><font color="#808080">,</font><font color="#FF0000">3</font><font color="#808080">))
         </font><font color="#0000FF">call </font><font color="#000080">SomaStr</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">,</font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">tCliente_codprofissao</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">))
      </font><font color="#0000FF">else if </font><font color="#808080">(</font><font color="#000080">sreg </font><font color="#0000FF">.eq. </font><font color="#000080">opVenda</font><font color="#808080">) </font><font color="#0000FF">then
         </font><font color="#000080">slinha</font><font color="#808080">=</font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">tVenda_dthrvenda</font><font color="#808080">,</font><font color="#FF0000">19</font><font color="#808080">)
         </font><font color="#0000FF">call </font><font color="#000080">SomaStr</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">,</font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">tVenda_cpf</font><font color="#808080">,</font><font color="#FF0000">14</font><font color="#808080">))
         </font><font color="#0000FF">call </font><font color="#000080">SomaStr</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">,</font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">tVenda_isbn</font><font color="#808080">,</font><font color="#FF0000">13</font><font color="#808080">))         
         </font><font color="#0000FF">call </font><font color="#000080">SomaStr</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">,</font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">tVenda_precovenda</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">))
      </font><font color="#0000FF">end if
      </font><font color="#000080">LinhaReg</font><font color="#808080">=</font><font color="#000080">slinha
      </font><font color="#0000FF">return
      end
</font><font color="#808080"><i>C     ------------------------------------------------------------------
C     Retorna o tamanho do registro no arquivo de acordo com o tipo de arquivo.
C     sreg - o tipo de arquivo
C     retorna - o tamanho do registro
C     ------------------------------------------------------------------
      </i></font><font color="#0000FF">integer function </font><font color="#000080">tamReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">)
      </font><font color="#0000FF">integer </font><font color="#000080">sreg

      </font><font color="#0000FF">include </font><font color="#800000">'livrus.h'
      </font><font color="#0000FF">integer </font><font color="#000080">nret

      nret</font><font color="#808080">=</font><font color="#FF0000">0
      </font><font color="#0000FF">if </font><font color="#808080">(</font><font color="#000080">sreg </font><font color="#0000FF">.eq. </font><font color="#000080">opAssunto</font><font color="#808080">) </font><font color="#0000FF">then 
        </font><font color="#000080">nret</font><font color="#808080">=</font><font color="#000080">TAM_ASSUNTO
      </font><font color="#0000FF">else if </font><font color="#808080">(</font><font color="#000080">sreg </font><font color="#0000FF">.eq. </font><font color="#000080">opAutor</font><font color="#808080">) </font><font color="#0000FF">then 
        </font><font color="#000080">nret</font><font color="#808080">=</font><font color="#000080">TAM_AUTOR
      </font><font color="#0000FF">else if </font><font color="#808080">(</font><font color="#000080">sreg </font><font color="#0000FF">.eq. </font><font color="#000080">opEditora</font><font color="#808080">) </font><font color="#0000FF">then 
        </font><font color="#000080">nret</font><font color="#808080">=</font><font color="#000080">TAM_EDITORA
      </font><font color="#0000FF">else if </font><font color="#808080">(</font><font color="#000080">sreg </font><font color="#0000FF">.eq. </font><font color="#000080">opEndereco</font><font color="#808080">) </font><font color="#0000FF">then 
        </font><font color="#000080">nret</font><font color="#808080">=</font><font color="#000080">TAM_ENDERECO
      </font><font color="#0000FF">else if </font><font color="#808080">(</font><font color="#000080">sreg </font><font color="#0000FF">.eq. </font><font color="#000080">opIdioma</font><font color="#808080">) </font><font color="#0000FF">then 
        </font><font color="#000080">nret</font><font color="#808080">=</font><font color="#000080">TAM_IDIOMA
      </font><font color="#0000FF">else if </font><font color="#808080">(</font><font color="#000080">sreg </font><font color="#0000FF">.eq. </font><font color="#000080">opPais</font><font color="#808080">) </font><font color="#0000FF">then 
        </font><font color="#000080">nret</font><font color="#808080">=</font><font color="#000080">TAM_PAIS
      </font><font color="#0000FF">else if </font><font color="#808080">(</font><font color="#000080">sreg </font><font color="#0000FF">.eq. </font><font color="#000080">opProfissao</font><font color="#808080">) </font><font color="#0000FF">then 
        </font><font color="#000080">nret</font><font color="#808080">=</font><font color="#000080">TAM_PROFISSAO
      </font><font color="#0000FF">else if </font><font color="#808080">(</font><font color="#000080">sreg </font><font color="#0000FF">.eq. </font><font color="#000080">opUsuario</font><font color="#808080">) </font><font color="#0000FF">then 
        </font><font color="#000080">nret</font><font color="#808080">=</font><font color="#000080">TAM_USUARIO
      </font><font color="#0000FF">else if </font><font color="#808080">(</font><font color="#000080">sreg </font><font color="#0000FF">.eq. </font><font color="#000080">opLivro</font><font color="#808080">) </font><font color="#0000FF">then 
        </font><font color="#000080">nret</font><font color="#808080">=</font><font color="#000080">TAM_LIVRO
      </font><font color="#0000FF">else if </font><font color="#808080">(</font><font color="#000080">sreg </font><font color="#0000FF">.eq. </font><font color="#000080">opLivroAss</font><font color="#808080">) </font><font color="#0000FF">then 
        </font><font color="#000080">nret</font><font color="#808080">=</font><font color="#000080">TAM_LIVASS
      </font><font color="#0000FF">else if </font><font color="#808080">(</font><font color="#000080">sreg </font><font color="#0000FF">.eq. </font><font color="#000080">opLivroAut</font><font color="#808080">) </font><font color="#0000FF">then 
        </font><font color="#000080">nret</font><font color="#808080">=</font><font color="#000080">TAM_LIVAUT
      </font><font color="#0000FF">else if </font><font color="#808080">(</font><font color="#000080">sreg </font><font color="#0000FF">.eq. </font><font color="#000080">opCliente</font><font color="#808080">) </font><font color="#0000FF">then  
        </font><font color="#000080">nret</font><font color="#808080">=</font><font color="#000080">TAM_CLIENTE
      </font><font color="#0000FF">else if </font><font color="#808080">(</font><font color="#000080">sreg </font><font color="#0000FF">.eq. </font><font color="#000080">opVenda</font><font color="#808080">) </font><font color="#0000FF">then 
        </font><font color="#000080">nret</font><font color="#808080">=</font><font color="#000080">TAM_VENDA
      </font><font color="#0000FF">end if
      </font><font color="#000080">tamReg</font><font color="#808080">=</font><font color="#000080">nret
      </font><font color="#0000FF">return
      end
</font><font color="#808080"><i>C     ------------------------------------------------------------------
C     Seleciona o rotulo de cada campo de acordo com o tipo de arquivo.
C     sreg - o tipo de arquivo
C     nNum - indica qual rotulo ser&aacute; retornado
C     retorna - o rotulo
C     ------------------------------------------------------------------
      </i></font><font color="#0000FF">character</font><font color="#808080">*(*) </font><font color="#0000FF">function </font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#000080">nNum</font><font color="#808080">)
      </font><font color="#0000FF">integer </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#000080">nNum

      </font><font color="#0000FF">include </font><font color="#800000">'livrus.h'
      </font><font color="#0000FF">character</font><font color="#808080">*</font><font color="#FF0000">255 </font><font color="#000080">sret

      sret</font><font color="#808080">=</font><font color="#000080">char</font><font color="#808080">(</font><font color="#FF0000">0</font><font color="#808080">)
      </font><font color="#0000FF">if </font><font color="#808080">(</font><font color="#000080">sreg </font><font color="#0000FF">.eq. </font><font color="#000080">opAssunto</font><font color="#808080">) </font><font color="#0000FF">then
         select case </font><font color="#808080">(</font><font color="#000080">nNum</font><font color="#808080">)
           </font><font color="#0000FF">case </font><font color="#808080">(</font><font color="#FF0000">0</font><font color="#808080">)
               </font><font color="#000080">sret</font><font color="#808080">=</font><font color="#800000">'Assunto(s) n&atilde;o encontrado(s)!'
           </font><font color="#0000FF">case </font><font color="#808080">(</font><font color="#FF0000">1</font><font color="#808080">) 
               </font><font color="#000080">sret</font><font color="#808080">=</font><font color="#800000">'C&oacute;digo do assunto: '
               </font><font color="#000080">g_nPosChave</font><font color="#808080">=</font><font color="#FF0000">1
               </font><font color="#000080">g_nTamChave</font><font color="#808080">=</font><font color="#FF0000">10
           </font><font color="#0000FF">case </font><font color="#808080">(</font><font color="#FF0000">2</font><font color="#808080">) 
               </font><font color="#000080">sret</font><font color="#808080">=</font><font color="#800000">'Assunto: '
               </font><font color="#000080">g_nPosChave</font><font color="#808080">=</font><font color="#FF0000">11
               </font><font color="#000080">g_nTamChave</font><font color="#808080">=</font><font color="#FF0000">30
         </font><font color="#0000FF">end select
      else if </font><font color="#808080">(</font><font color="#000080">sreg </font><font color="#0000FF">.eq. </font><font color="#000080">opAutor</font><font color="#808080">) </font><font color="#0000FF">then 
         select case </font><font color="#808080">(</font><font color="#000080">nNum</font><font color="#808080">)
           </font><font color="#0000FF">case </font><font color="#808080">(</font><font color="#FF0000">0</font><font color="#808080">) 
               </font><font color="#000080">sret</font><font color="#808080">=</font><font color="#800000">'Autor(es) n&atilde;o encontrado(s)!'
           </font><font color="#0000FF">case </font><font color="#808080">(</font><font color="#FF0000">1</font><font color="#808080">) 
               </font><font color="#000080">sret</font><font color="#808080">=</font><font color="#800000">'C&oacute;digo do autor: '
               </font><font color="#000080">g_nPosChave</font><font color="#808080">=</font><font color="#FF0000">1
               </font><font color="#000080">g_nTamChave</font><font color="#808080">=</font><font color="#FF0000">10
           </font><font color="#0000FF">case </font><font color="#808080">(</font><font color="#FF0000">2</font><font color="#808080">) 
               </font><font color="#000080">sret</font><font color="#808080">=</font><font color="#800000">'Autor: '
               </font><font color="#000080">g_nPosChave</font><font color="#808080">=</font><font color="#FF0000">11
               </font><font color="#000080">g_nTamChave</font><font color="#808080">=</font><font color="#FF0000">30
         </font><font color="#0000FF">end select
      else if </font><font color="#808080">(</font><font color="#000080">sreg </font><font color="#0000FF">.eq. </font><font color="#000080">opEditora</font><font color="#808080">) </font><font color="#0000FF">then 
         select case </font><font color="#808080">(</font><font color="#000080">nNum</font><font color="#808080">)
           </font><font color="#0000FF">case </font><font color="#808080">(</font><font color="#FF0000">0</font><font color="#808080">) 
               </font><font color="#000080">sret</font><font color="#808080">=</font><font color="#800000">'Editora(s) n&atilde;o encontrada(s)!'
           </font><font color="#0000FF">case </font><font color="#808080">(</font><font color="#FF0000">1</font><font color="#808080">) 
               </font><font color="#000080">sret</font><font color="#808080">=</font><font color="#800000">'C&oacute;digo da editora: '
               </font><font color="#000080">g_nPosChave</font><font color="#808080">=</font><font color="#FF0000">1
               </font><font color="#000080">g_nTamChave</font><font color="#808080">=</font><font color="#FF0000">10
           </font><font color="#0000FF">case </font><font color="#808080">(</font><font color="#FF0000">2</font><font color="#808080">) 
               </font><font color="#000080">sret</font><font color="#808080">=</font><font color="#800000">'Editora: '
               </font><font color="#000080">g_nPosChave</font><font color="#808080">=</font><font color="#FF0000">11
               </font><font color="#000080">g_nTamChave</font><font color="#808080">=</font><font color="#FF0000">50
         </font><font color="#0000FF">end select
      else if </font><font color="#808080">(</font><font color="#000080">sreg </font><font color="#0000FF">.eq. </font><font color="#000080">opEndereco</font><font color="#808080">) </font><font color="#0000FF">then 
         select case </font><font color="#808080">(</font><font color="#000080">nNum</font><font color="#808080">)
           </font><font color="#0000FF">case </font><font color="#808080">(</font><font color="#FF0000">0</font><font color="#808080">) 
               </font><font color="#000080">sret</font><font color="#808080">=</font><font color="#800000">'Endere&ccedil;o(s) n&atilde;o encontrado(s)!'
           </font><font color="#0000FF">case </font><font color="#808080">(</font><font color="#FF0000">1</font><font color="#808080">) 
               </font><font color="#000080">sret</font><font color="#808080">=</font><font color="#800000">'C&oacute;digo do endere&ccedil;o: '
               </font><font color="#000080">g_nPosChave</font><font color="#808080">=</font><font color="#FF0000">1
               </font><font color="#000080">g_nTamChave</font><font color="#808080">=</font><font color="#FF0000">10
           </font><font color="#0000FF">case </font><font color="#808080">(</font><font color="#FF0000">2</font><font color="#808080">) 
               </font><font color="#000080">sret</font><font color="#808080">=</font><font color="#800000">'Logradouro: '
               </font><font color="#000080">g_nPosChave</font><font color="#808080">=</font><font color="#FF0000">11
               </font><font color="#000080">g_nTamChave</font><font color="#808080">=</font><font color="#FF0000">40
           </font><font color="#0000FF">case </font><font color="#808080">(</font><font color="#FF0000">3</font><font color="#808080">) 
               </font><font color="#000080">sret</font><font color="#808080">=</font><font color="#800000">'Bairro: '
               </font><font color="#000080">g_nPosChave</font><font color="#808080">=</font><font color="#FF0000">51
               </font><font color="#000080">g_nTamChave</font><font color="#808080">=</font><font color="#FF0000">15
           </font><font color="#0000FF">case </font><font color="#808080">(</font><font color="#FF0000">4</font><font color="#808080">) 
               </font><font color="#000080">sret</font><font color="#808080">=</font><font color="#800000">'CEP: '
               </font><font color="#000080">g_nPosChave</font><font color="#808080">=</font><font color="#FF0000">66
               </font><font color="#000080">g_nTamChave</font><font color="#808080">=</font><font color="#FF0000">8
           </font><font color="#0000FF">case </font><font color="#808080">(</font><font color="#FF0000">5</font><font color="#808080">) 
               </font><font color="#000080">sret</font><font color="#808080">=</font><font color="#800000">'Cidade: '
               </font><font color="#000080">g_nPosChave</font><font color="#808080">=</font><font color="#FF0000">74
               </font><font color="#000080">g_nTamChave</font><font color="#808080">=</font><font color="#FF0000">30
           </font><font color="#0000FF">case </font><font color="#808080">(</font><font color="#FF0000">6</font><font color="#808080">) 
               </font><font color="#000080">sret</font><font color="#808080">=</font><font color="#800000">'Estado: '
               </font><font color="#000080">g_nPosChave</font><font color="#808080">=</font><font color="#FF0000">104
               </font><font color="#000080">g_nTamChave</font><font color="#808080">=</font><font color="#FF0000">20
         </font><font color="#0000FF">end select
      else if </font><font color="#808080">(</font><font color="#000080">sreg </font><font color="#0000FF">.eq. </font><font color="#000080">opIdioma</font><font color="#808080">) </font><font color="#0000FF">then 
         select case </font><font color="#808080">(</font><font color="#000080">nNum</font><font color="#808080">)
           </font><font color="#0000FF">case </font><font color="#808080">(</font><font color="#FF0000">0</font><font color="#808080">) 
               </font><font color="#000080">sret</font><font color="#808080">=</font><font color="#800000">'Idioma(s) n&atilde;o encontrado(s)!'
           </font><font color="#0000FF">case </font><font color="#808080">(</font><font color="#FF0000">1</font><font color="#808080">)
               </font><font color="#000080">sret</font><font color="#808080">=</font><font color="#800000">'C&oacute;digo do idioma: '
               </font><font color="#000080">g_nPosChave</font><font color="#808080">=</font><font color="#FF0000">1
               </font><font color="#000080">g_nTamChave</font><font color="#808080">=</font><font color="#FF0000">10
           </font><font color="#0000FF">case </font><font color="#808080">(</font><font color="#FF0000">2</font><font color="#808080">) 
               </font><font color="#000080">sret</font><font color="#808080">=</font><font color="#800000">'Idioma: '
               </font><font color="#000080">g_nPosChave</font><font color="#808080">=</font><font color="#FF0000">11
               </font><font color="#000080">g_nTamChave</font><font color="#808080">=</font><font color="#FF0000">20
         </font><font color="#0000FF">end select
      else if </font><font color="#808080">(</font><font color="#000080">sreg </font><font color="#0000FF">.eq. </font><font color="#000080">opPais</font><font color="#808080">) </font><font color="#0000FF">then 
         select case </font><font color="#808080">(</font><font color="#000080">nNum</font><font color="#808080">)
           </font><font color="#0000FF">case </font><font color="#808080">(</font><font color="#FF0000">0</font><font color="#808080">) 
               </font><font color="#000080">sret</font><font color="#808080">=</font><font color="#800000">'Pa&iacute;s(es) n&atilde;o encontrado(s)!'
           </font><font color="#0000FF">case </font><font color="#808080">(</font><font color="#FF0000">1</font><font color="#808080">) 
               </font><font color="#000080">sret</font><font color="#808080">=</font><font color="#800000">'C&oacute;digo do pa&iacute;s: '
               </font><font color="#000080">g_nPosChave</font><font color="#808080">=</font><font color="#FF0000">1
               </font><font color="#000080">g_nTamChave</font><font color="#808080">=</font><font color="#FF0000">3
           </font><font color="#0000FF">case </font><font color="#808080">(</font><font color="#FF0000">2</font><font color="#808080">) 
               </font><font color="#000080">sret</font><font color="#808080">=</font><font color="#800000">'Pa&iacute;s: '
               </font><font color="#000080">g_nPosChave</font><font color="#808080">=</font><font color="#FF0000">4
               </font><font color="#000080">g_nTamChave</font><font color="#808080">=</font><font color="#FF0000">50
         </font><font color="#0000FF">end select
      else if </font><font color="#808080">(</font><font color="#000080">sreg </font><font color="#0000FF">.eq. </font><font color="#000080">opProfissao</font><font color="#808080">) </font><font color="#0000FF">then 
         select case </font><font color="#808080">(</font><font color="#000080">nNum</font><font color="#808080">)
           </font><font color="#0000FF">case </font><font color="#808080">(</font><font color="#FF0000">0</font><font color="#808080">) 
               </font><font color="#000080">sret</font><font color="#808080">=</font><font color="#800000">'Profiss&atilde;o(es) n&atilde;o encontrada(s)!'
           </font><font color="#0000FF">case </font><font color="#808080">(</font><font color="#FF0000">1</font><font color="#808080">) 
               </font><font color="#000080">sret</font><font color="#808080">=</font><font color="#800000">'C&oacute;digo da profiss&atilde;o: '
               </font><font color="#000080">g_nPosChave</font><font color="#808080">=</font><font color="#FF0000">1
               </font><font color="#000080">g_nTamChave</font><font color="#808080">=</font><font color="#FF0000">10
           </font><font color="#0000FF">case </font><font color="#808080">(</font><font color="#FF0000">2</font><font color="#808080">) 
               </font><font color="#000080">sret</font><font color="#808080">=</font><font color="#800000">'Profiss&atilde;o: '
               </font><font color="#000080">g_nPosChave</font><font color="#808080">=</font><font color="#FF0000">11
               </font><font color="#000080">g_nTamChave</font><font color="#808080">=</font><font color="#FF0000">50
         </font><font color="#0000FF">end select
      else if </font><font color="#808080">(</font><font color="#000080">sreg </font><font color="#0000FF">.eq. </font><font color="#000080">opUsuario</font><font color="#808080">) </font><font color="#0000FF">then 
         select case </font><font color="#808080">(</font><font color="#000080">nNum</font><font color="#808080">)
           </font><font color="#0000FF">case </font><font color="#808080">(</font><font color="#FF0000">0</font><font color="#808080">) 
               </font><font color="#000080">sret</font><font color="#808080">=</font><font color="#800000">'login ou senha incorreta, tente de novo!'
           </font><font color="#0000FF">case </font><font color="#808080">(</font><font color="#FF0000">1</font><font color="#808080">) 
               </font><font color="#000080">sret</font><font color="#808080">=</font><font color="#800000">'Login: '
               </font><font color="#000080">g_nPosChave</font><font color="#808080">=</font><font color="#FF0000">1
               </font><font color="#000080">g_nTamChave</font><font color="#808080">=</font><font color="#FF0000">10
           </font><font color="#0000FF">case </font><font color="#808080">(</font><font color="#FF0000">2</font><font color="#808080">) 
               </font><font color="#000080">sret</font><font color="#808080">=</font><font color="#800000">'Senha: '
               </font><font color="#000080">g_nPosChave</font><font color="#808080">=</font><font color="#FF0000">11
               </font><font color="#000080">g_nTamChave</font><font color="#808080">=</font><font color="#FF0000">10
         </font><font color="#0000FF">end select
      else if </font><font color="#808080">(</font><font color="#000080">sreg </font><font color="#0000FF">.eq. </font><font color="#000080">opLivro</font><font color="#808080">) </font><font color="#0000FF">then 
         select case </font><font color="#808080">(</font><font color="#000080">nNum</font><font color="#808080">)
           </font><font color="#0000FF">case </font><font color="#808080">(</font><font color="#FF0000">0</font><font color="#808080">) 
               </font><font color="#000080">sret</font><font color="#808080">=</font><font color="#800000">'Livro(s) n&atilde;o encontrado(s)!'
           </font><font color="#0000FF">case </font><font color="#808080">(</font><font color="#FF0000">1</font><font color="#808080">) 
               </font><font color="#000080">sret</font><font color="#808080">=</font><font color="#800000">'ISBN: '
               </font><font color="#000080">g_nPosChave</font><font color="#808080">=</font><font color="#FF0000">1
               </font><font color="#000080">g_nTamChave</font><font color="#808080">=</font><font color="#FF0000">13
           </font><font color="#0000FF">case </font><font color="#808080">(</font><font color="#FF0000">2</font><font color="#808080">) 
               </font><font color="#000080">sret</font><font color="#808080">=</font><font color="#800000">'T&iacute;tulo: '
               </font><font color="#000080">g_nPosChave</font><font color="#808080">=</font><font color="#FF0000">14
               </font><font color="#000080">g_nTamChave</font><font color="#808080">=</font><font color="#FF0000">50
           </font><font color="#0000FF">case </font><font color="#808080">(</font><font color="#FF0000">3</font><font color="#808080">) 
               </font><font color="#000080">sret</font><font color="#808080">=</font><font color="#800000">'Edi&ccedil;&atilde;o: '
               </font><font color="#000080">g_nPosChave</font><font color="#808080">=</font><font color="#FF0000">64
               </font><font color="#000080">g_nTamChave</font><font color="#808080">=</font><font color="#FF0000">10
           </font><font color="#0000FF">case </font><font color="#808080">(</font><font color="#FF0000">4</font><font color="#808080">) 
               </font><font color="#000080">sret</font><font color="#808080">=</font><font color="#800000">'Ano de Publica&ccedil;&atilde;o: '
               </font><font color="#000080">g_nPosChave</font><font color="#808080">=</font><font color="#FF0000">74
               </font><font color="#000080">g_nTamChave</font><font color="#808080">=</font><font color="#FF0000">10
           </font><font color="#0000FF">case </font><font color="#808080">(</font><font color="#FF0000">5</font><font color="#808080">) 
               </font><font color="#000080">sret</font><font color="#808080">=</font><font color="#800000">'C&oacute;digo da editora: '
               </font><font color="#000080">g_nPosChave</font><font color="#808080">=</font><font color="#FF0000">84
               </font><font color="#000080">g_nTamChave</font><font color="#808080">=</font><font color="#FF0000">10
           </font><font color="#0000FF">case </font><font color="#808080">(</font><font color="#FF0000">6</font><font color="#808080">) 
               </font><font color="#000080">sret</font><font color="#808080">=</font><font color="#800000">'Volume: '
               </font><font color="#000080">g_nPosChave</font><font color="#808080">=</font><font color="#FF0000">94
               </font><font color="#000080">g_nTamChave</font><font color="#808080">=</font><font color="#FF0000">10
           </font><font color="#0000FF">case </font><font color="#808080">(</font><font color="#FF0000">7</font><font color="#808080">) 
               </font><font color="#000080">sret</font><font color="#808080">=</font><font color="#800000">'C&oacute;digo do idioma: '
               </font><font color="#000080">g_nPosChave</font><font color="#808080">=</font><font color="#FF0000">104
               </font><font color="#000080">g_nTamChave</font><font color="#808080">=</font><font color="#FF0000">10
           </font><font color="#0000FF">case </font><font color="#808080">(</font><font color="#FF0000">8</font><font color="#808080">) 
               </font><font color="#000080">sret</font><font color="#808080">=</font><font color="#800000">'N&uacute;mero de p&aacute;ginas: '
               </font><font color="#000080">g_nPosChave</font><font color="#808080">=</font><font color="#FF0000">114
               </font><font color="#000080">g_nTamChave</font><font color="#808080">=</font><font color="#FF0000">10
           </font><font color="#0000FF">case </font><font color="#808080">(</font><font color="#FF0000">9</font><font color="#808080">) 
               </font><font color="#000080">sret</font><font color="#808080">=</font><font color="#800000">'Pre&ccedil;o: '
               </font><font color="#000080">g_nPosChave</font><font color="#808080">=</font><font color="#FF0000">124
               </font><font color="#000080">g_nTamChave</font><font color="#808080">=</font><font color="#FF0000">10
           </font><font color="#0000FF">case </font><font color="#808080">(</font><font color="#FF0000">10</font><font color="#808080">) 
                </font><font color="#000080">sret</font><font color="#808080">=</font><font color="#800000">'Qtd. Estoque: '
                </font><font color="#000080">g_nPosChave</font><font color="#808080">=</font><font color="#FF0000">134
                </font><font color="#000080">g_nTamChave</font><font color="#808080">=</font><font color="#FF0000">10
         </font><font color="#0000FF">end select
      else if </font><font color="#808080">(</font><font color="#000080">sreg </font><font color="#0000FF">.eq. </font><font color="#000080">opLivroAss</font><font color="#808080">) </font><font color="#0000FF">then 
         select case </font><font color="#808080">(</font><font color="#000080">nNum</font><font color="#808080">)
           </font><font color="#0000FF">case </font><font color="#808080">(</font><font color="#FF0000">0</font><font color="#808080">) 
               </font><font color="#000080">sret</font><font color="#808080">=</font><font color="#800000">'Assunto(s) n&atilde;o encontrado(s)!'
           </font><font color="#0000FF">case </font><font color="#808080">(</font><font color="#FF0000">1</font><font color="#808080">) 
               </font><font color="#000080">sret</font><font color="#808080">=</font><font color="#800000">'ISBN: '
               </font><font color="#000080">g_nPosChave</font><font color="#808080">=</font><font color="#FF0000">1
               </font><font color="#000080">g_nTamChave</font><font color="#808080">=</font><font color="#FF0000">13
           </font><font color="#0000FF">case </font><font color="#808080">(</font><font color="#FF0000">2</font><font color="#808080">) 
               </font><font color="#000080">sret</font><font color="#808080">=</font><font color="#800000">'C&oacute;digo do assunto: '
               </font><font color="#000080">g_nPosChave</font><font color="#808080">=</font><font color="#FF0000">14
               </font><font color="#000080">g_nTamChave</font><font color="#808080">=</font><font color="#FF0000">10
         </font><font color="#0000FF">end select
      else if </font><font color="#808080">(</font><font color="#000080">sreg </font><font color="#0000FF">.eq. </font><font color="#000080">opLivroAut</font><font color="#808080">) </font><font color="#0000FF">then 
         select case </font><font color="#808080">(</font><font color="#000080">nNum</font><font color="#808080">)
           </font><font color="#0000FF">case </font><font color="#808080">(</font><font color="#FF0000">0</font><font color="#808080">) 
               </font><font color="#000080">sret</font><font color="#808080">=</font><font color="#800000">'Autor(s) n&atilde;o encontrado(s)!'
           </font><font color="#0000FF">case </font><font color="#808080">(</font><font color="#FF0000">1</font><font color="#808080">) 
               </font><font color="#000080">sret</font><font color="#808080">=</font><font color="#800000">'ISBN: '
               </font><font color="#000080">g_nPosChave</font><font color="#808080">=</font><font color="#FF0000">1
               </font><font color="#000080">g_nTamChave</font><font color="#808080">=</font><font color="#FF0000">13
           </font><font color="#0000FF">case </font><font color="#808080">(</font><font color="#FF0000">2</font><font color="#808080">) 
               </font><font color="#000080">sret</font><font color="#808080">=</font><font color="#800000">'C&oacute;digo do autor: '
               </font><font color="#000080">g_nPosChave</font><font color="#808080">=</font><font color="#FF0000">14
               </font><font color="#000080">g_nTamChave</font><font color="#808080">=</font><font color="#FF0000">10
         </font><font color="#0000FF">end select
      else if </font><font color="#808080">(</font><font color="#000080">sreg </font><font color="#0000FF">.eq. </font><font color="#000080">opCliente</font><font color="#808080">) </font><font color="#0000FF">then 
         select case </font><font color="#808080">(</font><font color="#000080">nNum</font><font color="#808080">)
           </font><font color="#0000FF">case </font><font color="#808080">(</font><font color="#FF0000">0</font><font color="#808080">) 
               </font><font color="#000080">sret</font><font color="#808080">=</font><font color="#800000">'Cliente(s) n&atilde;o encontrado(s)!'
           </font><font color="#0000FF">case </font><font color="#808080">(</font><font color="#FF0000">1</font><font color="#808080">) 
               </font><font color="#000080">sret</font><font color="#808080">=</font><font color="#800000">'CPF: '
               </font><font color="#000080">g_nPosChave</font><font color="#808080">=</font><font color="#FF0000">1
               </font><font color="#000080">g_nTamChave</font><font color="#808080">=</font><font color="#FF0000">14
           </font><font color="#0000FF">case </font><font color="#808080">(</font><font color="#FF0000">2</font><font color="#808080">) 
               </font><font color="#000080">sret</font><font color="#808080">=</font><font color="#800000">'Nome: '
               </font><font color="#000080">g_nPosChave</font><font color="#808080">=</font><font color="#FF0000">15
               </font><font color="#000080">g_nTamChave</font><font color="#808080">=</font><font color="#FF0000">30
           </font><font color="#0000FF">case </font><font color="#808080">(</font><font color="#FF0000">3</font><font color="#808080">)
               </font><font color="#000080">sret</font><font color="#808080">=</font><font color="#800000">'E-mail: '
               </font><font color="#000080">g_nPosChave</font><font color="#808080">=</font><font color="#FF0000">45
               </font><font color="#000080">g_nTamChave</font><font color="#808080">=</font><font color="#FF0000">30
           </font><font color="#0000FF">case </font><font color="#808080">(</font><font color="#FF0000">4</font><font color="#808080">) 
               </font><font color="#000080">sret</font><font color="#808080">=</font><font color="#800000">'Identidade: '
               </font><font color="#000080">g_nPosChave</font><font color="#808080">=</font><font color="#FF0000">75
               </font><font color="#000080">g_nTamChave</font><font color="#808080">=</font><font color="#FF0000">10
           </font><font color="#0000FF">case </font><font color="#808080">(</font><font color="#FF0000">5</font><font color="#808080">) 
               </font><font color="#000080">sret</font><font color="#808080">=</font><font color="#800000">'Sexo: '
               </font><font color="#000080">g_nPosChave</font><font color="#808080">=</font><font color="#FF0000">85
               </font><font color="#000080">g_nTamChave</font><font color="#808080">=</font><font color="#FF0000">1
           </font><font color="#0000FF">case </font><font color="#808080">(</font><font color="#FF0000">6</font><font color="#808080">) 
               </font><font color="#000080">sret</font><font color="#808080">=</font><font color="#800000">'Telefone: '
               </font><font color="#000080">g_nPosChave</font><font color="#808080">=</font><font color="#FF0000">86
               </font><font color="#000080">g_nTamChave</font><font color="#808080">=</font><font color="#FF0000">17
           </font><font color="#0000FF">case </font><font color="#808080">(</font><font color="#FF0000">7</font><font color="#808080">) 
               </font><font color="#000080">sret</font><font color="#808080">=</font><font color="#800000">'Dt. Nascimento: '
               </font><font color="#000080">g_nPosChave</font><font color="#808080">=</font><font color="#FF0000">103
               </font><font color="#000080">g_nTamChave</font><font color="#808080">=</font><font color="#FF0000">10
           </font><font color="#0000FF">case </font><font color="#808080">(</font><font color="#FF0000">8</font><font color="#808080">) 
               </font><font color="#000080">sret</font><font color="#808080">=</font><font color="#800000">'C&oacute;digo do endere&ccedil;o: '
               </font><font color="#000080">g_nPosChave</font><font color="#808080">=</font><font color="#FF0000">113
               </font><font color="#000080">g_nTamChave</font><font color="#808080">=</font><font color="#FF0000">10
           </font><font color="#0000FF">case </font><font color="#808080">(</font><font color="#FF0000">9</font><font color="#808080">) 
               </font><font color="#000080">sret</font><font color="#808080">=</font><font color="#800000">'C&oacute;digo do pa&iacute;s: '
               </font><font color="#000080">g_nPosChave</font><font color="#808080">=</font><font color="#FF0000">123
               </font><font color="#000080">g_nTamChave</font><font color="#808080">=</font><font color="#FF0000">3
           </font><font color="#0000FF">case </font><font color="#808080">(</font><font color="#FF0000">10</font><font color="#808080">)
                </font><font color="#000080">sret</font><font color="#808080">=</font><font color="#800000">'C&oacute;digo da Profiss&atilde;o: '
                </font><font color="#000080">g_nPosChave</font><font color="#808080">=</font><font color="#FF0000">126
                </font><font color="#000080">g_nTamChave</font><font color="#808080">=</font><font color="#FF0000">10
         </font><font color="#0000FF">end select
      else if </font><font color="#808080">(</font><font color="#000080">sreg </font><font color="#0000FF">.eq. </font><font color="#000080">opVenda</font><font color="#808080">) </font><font color="#0000FF">then 
         select case </font><font color="#808080">(</font><font color="#000080">nNum</font><font color="#808080">)
           </font><font color="#0000FF">case </font><font color="#808080">(</font><font color="#FF0000">0</font><font color="#808080">) 
               </font><font color="#000080">sret</font><font color="#808080">=</font><font color="#800000">'Venda(s) n&atilde;o encontrada(s)!'
           </font><font color="#0000FF">case </font><font color="#808080">(</font><font color="#FF0000">1</font><font color="#808080">) 
               </font><font color="#000080">sret</font><font color="#808080">=</font><font color="#800000">'Data/Hora venda: '
               </font><font color="#000080">g_nPosChave</font><font color="#808080">=</font><font color="#FF0000">1
               </font><font color="#000080">g_nTamChave</font><font color="#808080">=</font><font color="#FF0000">19
           </font><font color="#0000FF">case </font><font color="#808080">(</font><font color="#FF0000">2</font><font color="#808080">) 
               </font><font color="#000080">sret</font><font color="#808080">=</font><font color="#800000">'CPF: '
               </font><font color="#000080">g_nPosChave</font><font color="#808080">=</font><font color="#FF0000">20
               </font><font color="#000080">g_nTamChave</font><font color="#808080">=</font><font color="#FF0000">14
           </font><font color="#0000FF">case </font><font color="#808080">(</font><font color="#FF0000">3</font><font color="#808080">) 
               </font><font color="#000080">sret</font><font color="#808080">=</font><font color="#800000">'ISBN: '
               </font><font color="#000080">g_nPosChave</font><font color="#808080">=</font><font color="#FF0000">34
               </font><font color="#000080">g_nTamChave</font><font color="#808080">=</font><font color="#FF0000">13
           </font><font color="#0000FF">case </font><font color="#808080">(</font><font color="#FF0000">4</font><font color="#808080">) 
               </font><font color="#000080">sret</font><font color="#808080">=</font><font color="#800000">'Pre&ccedil;o de venda: '
               </font><font color="#000080">g_nPosChave</font><font color="#808080">=</font><font color="#FF0000">47
               </font><font color="#000080">g_nTamChave</font><font color="#808080">=</font><font color="#FF0000">10
         </font><font color="#0000FF">end select
      end if      
      </font><font color="#000080">rotulo</font><font color="#808080">=</font><font color="#000080">sret
      </font><font color="#0000FF">return
      end
</font><font color="#808080"><i>C     ------------------------------------------------------------------
C     Indica se continua ou n&atilde;o mostrando um n&uacute;mero m&aacute;ximo de linhas.
C     nlinha - a linha a ser continuada
C     nQtdLinha - a quantidade de linhas a serem mostradas
C     retorna - se continua ou n&atilde;o
C     ------------------------------------------------------------------
      </i></font><font color="#0000FF">logical function </font><font color="#000080">ContinuaSN</font><font color="#808080">(</font><font color="#000080">nlinha</font><font color="#808080">, </font><font color="#000080">nQtdLinha</font><font color="#808080">)
      </font><font color="#0000FF">integer </font><font color="#000080">nlinha</font><font color="#808080">, </font><font color="#000080">nQtdLinha

      </font><font color="#0000FF">include </font><font color="#800000">'livrus.h'
      </font><font color="#0000FF">logical </font><font color="#000080">bSOp</font><font color="#808080">, </font><font color="#000080">bret
      </font><font color="#0000FF">character </font><font color="#000080">opCSubMenu
      
      bret</font><font color="#808080">=</font><font color="#0000FF">.false.
      if </font><font color="#808080">(</font><font color="#000080">nlinha </font><font color="#0000FF">.gt. </font><font color="#FF0000">0</font><font color="#808080">) </font><font color="#0000FF">then
        if </font><font color="#808080">(</font><font color="#000080">mod</font><font color="#808080">(</font><font color="#000080">nlinha</font><font color="#808080">, </font><font color="#000080">nQtdLinha</font><font color="#808080">) </font><font color="#0000FF">.eq. </font><font color="#FF0000">0</font><font color="#808080">) </font><font color="#0000FF">then
           </font><font color="#000080">bSOp</font><font color="#808080">=</font><font color="#0000FF">.true.
           do while</font><font color="#808080">(</font><font color="#000080">bSOp .eqv. </font><font color="#0000FF">.true.</font><font color="#808080">)
             </font><font color="#0000FF">call </font><font color="#000080">menu</font><font color="#808080">(</font><font color="#FF0000">13</font><font color="#808080">)
             </font><font color="#0000FF">read</font><font color="#808080">(*,*) </font><font color="#000080">opCSubMenu
             </font><font color="#0000FF">if </font><font color="#808080">((</font><font color="#000080">opCSubMenu</font><font color="#0000FF">.eq.</font><font color="#800000">'S'</font><font color="#808080">) </font><font color="#0000FF">.or. </font><font color="#808080">(</font><font color="#000080">opCSubMenu</font><font color="#0000FF">.eq.</font><font color="#800000">'s'</font><font color="#808080">)) </font><font color="#0000FF">then 
               </font><font color="#000080">bSOp</font><font color="#808080">=</font><font color="#0000FF">.false.
             else if </font><font color="#808080">((</font><font color="#000080">opCSubMenu</font><font color="#0000FF">.eq.</font><font color="#800000">'N'</font><font color="#808080">) </font><font color="#0000FF">.or. </font><font color="#808080">(</font><font color="#000080">opCSubMenu</font><font color="#0000FF">.eq.</font><font color="#800000">'n'</font><font color="#808080">)) </font><font color="#0000FF">then
               </font><font color="#000080">bret</font><font color="#808080">=</font><font color="#0000FF">.true.
               </font><font color="#000080">bSOp</font><font color="#808080">=</font><font color="#0000FF">.false.
             else
               write</font><font color="#808080">(*,*) </font><font color="#000080">MSG_ERRO
             </font><font color="#0000FF">end if
           end do
        end if
      end if
      
      </font><font color="#000080">ContinuaSN</font><font color="#808080">=</font><font color="#000080">bret
      </font><font color="#0000FF">return
      end
</font><font color="#808080"><i>C     ------------------------------------------------------------------
C     Lista v&aacute;rios registros de acordo com a pesquisa feita.
C     sArq - o arquivo
C     sreg - o tipo de arquivo
C     sChave - a chave a ser pesquisada
C     nPosChave - a posicao inicial da chave dentro do registro
C     nTamChave - o tamanho da chave dentro do registro
C     nTamLinha - o tamanho do registro
C     nQtdLinha - a quantidade de linhas a serem mostradas
C     retorna - se encontrou algum registro
C     ------------------------------------------------------------------
      </i></font><font color="#0000FF">logical function </font><font color="#000080">ListarTodos</font><font color="#808080">(</font><font color="#000080">sArq</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#000080">sChave</font><font color="#808080">, </font><font color="#000080">nPosChave</font><font color="#808080">, 
     *  </font><font color="#000080">nTamChave</font><font color="#808080">, </font><font color="#000080">nTamLinha</font><font color="#808080">, </font><font color="#000080">nQtdLinha</font><font color="#808080">, </font><font color="#000080">bPesqRelativa</font><font color="#808080">)
      </font><font color="#0000FF">integer </font><font color="#000080">sArq</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#000080">nPosChave</font><font color="#808080">, </font><font color="#000080">nTamChave</font><font color="#808080">, </font><font color="#000080">nTamLinha</font><font color="#808080">, </font><font color="#000080">nQtdLinha
      </font><font color="#0000FF">character</font><font color="#808080">*</font><font color="#FF0000">255 </font><font color="#000080">sChave
      </font><font color="#0000FF">logical </font><font color="#000080">bPesqRelativa

      </font><font color="#0000FF">character</font><font color="#808080">*</font><font color="#FF0000">255 </font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#000080">sres</font><font color="#808080">, </font><font color="#000080">ftrim</font><font color="#808080">, </font><font color="#000080">copy
      </font><font color="#0000FF">logical </font><font color="#000080">bQuebra</font><font color="#808080">, </font><font color="#000080">bAchou</font><font color="#808080">, </font><font color="#000080">bRet</font><font color="#808080">, </font><font color="#000080">ContinuaSN</font><font color="#808080">, </font><font color="#000080">strRelativa
      </font><font color="#0000FF">integer </font><font color="#000080">nCont</font><font color="#808080">, </font><font color="#000080">fimarq

      bRet</font><font color="#808080">=</font><font color="#0000FF">.false.
      </font><font color="#000080">bQuebra</font><font color="#808080">=</font><font color="#0000FF">.false.
      </font><font color="#000080">nCont</font><font color="#808080">=</font><font color="#FF0000">0
      </font><font color="#0000FF">call </font><font color="#000080">mostrarDados</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#800000">''</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">)
<i>C      fseek(sArq, 0)
      </i></font><font color="#0000FF">do while </font><font color="#808080">((</font><font color="#000080">fimarq</font><font color="#0000FF">.ne.</font><font color="#808080">-</font><font color="#FF0000">1</font><font color="#808080">) </font><font color="#0000FF">.and. </font><font color="#808080">(</font><font color="#000080">bQuebra .eqv. </font><font color="#0000FF">.false.</font><font color="#808080">))
        </font><font color="#0000FF">read</font><font color="#808080">(</font><font color="#000080">sArq</font><font color="#808080">,</font><font color="#000080">rec</font><font color="#808080">=</font><font color="#000080">nPosicao</font><font color="#808080">,</font><font color="#000080">iostat</font><font color="#808080">=</font><font color="#000080">fimarq</font><font color="#808080">) </font><font color="#000080">slinha
      
        </font><font color="#0000FF">if </font><font color="#808080">(</font><font color="#000080">bPesqRelativa .eqv. </font><font color="#0000FF">.true.</font><font color="#808080">) </font><font color="#0000FF">then
          </font><font color="#000080">sres</font><font color="#808080">=</font><font color="#000080">ftrim</font><font color="#808080">(</font><font color="#000080">copy</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">,</font><font color="#000080">nPosChave</font><font color="#808080">,</font><font color="#000080">nTamChave</font><font color="#808080">))
          </font><font color="#0000FF">if </font><font color="#808080">(</font><font color="#000080">strRelativa</font><font color="#808080">(</font><font color="#000080">sres</font><font color="#808080">,</font><font color="#000080">sChave</font><font color="#808080">) </font><font color="#000080">.eqv. </font><font color="#0000FF">.true.</font><font color="#808080">) </font><font color="#0000FF">then
             </font><font color="#000080">bAchou</font><font color="#808080">=</font><font color="#0000FF">.true.
             </font><font color="#000080">bRet</font><font color="#808080">=</font><font color="#0000FF">.true.
          else
             </font><font color="#000080">bAchou</font><font color="#808080">=</font><font color="#0000FF">.false.
          end if
        else
          </font><font color="#000080">bAchou</font><font color="#808080">=</font><font color="#0000FF">.true.
          </font><font color="#000080">bRet</font><font color="#808080">=</font><font color="#0000FF">.true.
        end if
      
        if </font><font color="#808080">(</font><font color="#000080">bAchou .eqv. </font><font color="#0000FF">.true.</font><font color="#808080">) </font><font color="#0000FF">then
          call </font><font color="#000080">mostrarDados</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#000080">copy</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#000080">nTamLinha</font><font color="#808080">), </font><font color="#FF0000">3</font><font color="#808080">)
          </font><font color="#000080">nCont</font><font color="#808080">=</font><font color="#000080">nCont</font><font color="#808080">+</font><font color="#FF0000">1
        </font><font color="#0000FF">end if
      
        </font><font color="#000080">bQuebra</font><font color="#808080">=</font><font color="#000080">ContinuaSN</font><font color="#808080">(</font><font color="#000080">nCont</font><font color="#808080">, </font><font color="#000080">nQtdLinha</font><font color="#808080">)
      </font><font color="#0000FF">end do
      </font><font color="#000080">ListarTodos</font><font color="#808080">=</font><font color="#000080">bret
      </font><font color="#0000FF">return
      end
</font><font color="#808080"><i>C     ------------------------------------------------------------------
C     Lista v&aacute;rios registros entre arquivos de acordo com a pesquisa feita.
C     sArq1 - o arquivo de liga&ccedil;&atilde;o
C     sreg1 - o tipo de arquivo de liga&ccedil;&atilde;o
C     nPosChave1 - a posicao inicial da primeira chave no arquivo de liga&ccedil;&atilde;o
C     nTamChave1 - o tamanho da primeira chave no arquivo de liga&ccedil;&atilde;o
C     nPosChave2 - a posicao inicial da segunda chave do arquivo de liga&ccedil;&atilde;o
C     nTamChave2 - o tamanho da segunda chave do arquivo de liga&ccedil;&atilde;o
C     sChave - a chave a ser pesquisada no arquivo de liga&ccedil;&atilde;o
C     sArq2 - o arquivo a ser pesquisado
C     sreg2 - o tipo de arquivo a ser pesquisado
C     nPosChave3 - a posicao inicial da chave do arquivo pesquisado
C     nQtdLinha - a quantidade de linhas a serem mostradas
C     ------------------------------------------------------------------
      </i></font><font color="#0000FF">subroutine </font><font color="#000080">ListarRegLigados</font><font color="#808080">(</font><font color="#000080">sArq1</font><font color="#808080">, </font><font color="#000080">sreg1</font><font color="#808080">, </font><font color="#000080">nPosChave1</font><font color="#808080">, </font><font color="#000080">nTamChave1</font><font color="#808080">, 
     *  </font><font color="#000080">nPosChave2</font><font color="#808080">, </font><font color="#000080">nTamChave2</font><font color="#808080">, </font><font color="#000080">sChave</font><font color="#808080">, </font><font color="#000080">sArq2</font><font color="#808080">, </font><font color="#000080">sreg2</font><font color="#808080">, </font><font color="#000080">nPosChave3</font><font color="#808080">, 
     *  </font><font color="#000080">nQtdLinha</font><font color="#808080">)
      </font><font color="#0000FF">integer </font><font color="#000080">sArq1</font><font color="#808080">, </font><font color="#000080">sreg1</font><font color="#808080">, </font><font color="#000080">nPosChave1</font><font color="#808080">, </font><font color="#000080">nTamChave1</font><font color="#808080">, </font><font color="#000080">nPosChave2</font><font color="#808080">,    
     * </font><font color="#000080">nTamChave2</font><font color="#808080">, </font><font color="#000080">sArq2</font><font color="#808080">, </font><font color="#000080">sreg2</font><font color="#808080">, </font><font color="#000080">nPosChave3</font><font color="#808080">, </font><font color="#000080">nQtdLinha
      </font><font color="#0000FF">character</font><font color="#808080">*</font><font color="#FF0000">255 </font><font color="#000080">sChave

      </font><font color="#0000FF">character</font><font color="#808080">*</font><font color="#FF0000">255 </font><font color="#000080">slinha1</font><font color="#808080">, </font><font color="#000080">sCodigo1</font><font color="#808080">, </font><font color="#000080">sCodigo2</font><font color="#808080">, </font><font color="#000080">slinha2</font><font color="#808080">, 
     * </font><font color="#000080">ftrim</font><font color="#808080">, </font><font color="#000080">copy</font><font color="#808080">, </font><font color="#000080">pesqArq</font><font color="#808080">, </font><font color="#000080">rotulo
      </font><font color="#0000FF">logical </font><font color="#000080">bQuebra</font><font color="#808080">, </font><font color="#000080">bRet</font><font color="#808080">, </font><font color="#000080">ContinuaSN
      </font><font color="#0000FF">integer </font><font color="#000080">nCont</font><font color="#808080">, </font><font color="#000080">fimarq</font><font color="#808080">, </font><font color="#000080">nPosicao</font><font color="#808080">, </font><font color="#000080">tamReg

      bRet</font><font color="#808080">=</font><font color="#0000FF">.false.
      </font><font color="#000080">nCont</font><font color="#808080">=</font><font color="#FF0000">0
      </font><font color="#000080">bQuebra</font><font color="#808080">=</font><font color="#0000FF">.false.
      call </font><font color="#000080">mostrarDados</font><font color="#808080">(</font><font color="#000080">sreg2</font><font color="#808080">, </font><font color="#800000">''</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">)
<i>C      fseek(sArq1, 0)
      </i></font><font color="#0000FF">do while </font><font color="#808080">((</font><font color="#000080">fimarq</font><font color="#0000FF">.ne.</font><font color="#808080">-</font><font color="#FF0000">1</font><font color="#808080">) </font><font color="#0000FF">.and. </font><font color="#808080">(</font><font color="#000080">bQuebra .eqv. </font><font color="#0000FF">.false.</font><font color="#808080">))
        </font><font color="#0000FF">read</font><font color="#808080">(</font><font color="#000080">sArq1</font><font color="#808080">,</font><font color="#000080">rec</font><font color="#808080">=</font><font color="#000080">nPosicao</font><font color="#808080">,</font><font color="#000080">iostat</font><font color="#808080">=</font><font color="#000080">fimarq</font><font color="#808080">) </font><font color="#000080">slinha1

        sCodigo1</font><font color="#808080">=</font><font color="#000080">ftrim</font><font color="#808080">(</font><font color="#000080">copy</font><font color="#808080">(</font><font color="#000080">slinha1</font><font color="#808080">,</font><font color="#000080">nPosChave1</font><font color="#808080">,</font><font color="#000080">nTamChave1</font><font color="#808080">))
        </font><font color="#0000FF">if </font><font color="#808080">(</font><font color="#000080">sCodigo1 </font><font color="#0000FF">.eq. </font><font color="#000080">sChave</font><font color="#808080">) </font><font color="#0000FF">then
          </font><font color="#000080">sCodigo2</font><font color="#808080">=</font><font color="#000080">ftrim</font><font color="#808080">(</font><font color="#000080">copy</font><font color="#808080">(</font><font color="#000080">slinha1</font><font color="#808080">,</font><font color="#000080">nPosChave2</font><font color="#808080">,</font><font color="#000080">nTamChave2</font><font color="#808080">))
          </font><font color="#000080">slinha2</font><font color="#808080">=</font><font color="#000080">pesqArq</font><font color="#808080">(</font><font color="#000080">sArq2</font><font color="#808080">, </font><font color="#000080">sCodigo2</font><font color="#808080">, </font><font color="#000080">nPosChave3</font><font color="#808080">, 
     *            </font><font color="#000080">nTamChave2</font><font color="#808080">, </font><font color="#000080">tamReg</font><font color="#808080">(</font><font color="#000080">sreg2</font><font color="#808080">))
          </font><font color="#0000FF">call </font><font color="#000080">mostrarDados</font><font color="#808080">(</font><font color="#000080">sreg2</font><font color="#808080">, </font><font color="#000080">copy</font><font color="#808080">(</font><font color="#000080">slinha2</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#000080">tamReg</font><font color="#808080">(</font><font color="#000080">sreg2</font><font color="#808080">)), </font><font color="#FF0000">3</font><font color="#808080">)
          </font><font color="#000080">bRet</font><font color="#808080">=</font><font color="#0000FF">.true.
          </font><font color="#000080">nCont</font><font color="#808080">=</font><font color="#000080">nCont</font><font color="#808080">+</font><font color="#FF0000">1
        </font><font color="#0000FF">end if
        </font><font color="#000080">bQuebra</font><font color="#808080">=</font><font color="#000080">ContinuaSN</font><font color="#808080">(</font><font color="#000080">nCont</font><font color="#808080">, </font><font color="#000080">nQtdLinha</font><font color="#808080">)
      </font><font color="#0000FF">end do
      if </font><font color="#808080">(</font><font color="#000080">bRet .eqv. </font><font color="#0000FF">.false.</font><font color="#808080">) </font><font color="#0000FF">then
         write</font><font color="#808080">(*,*) </font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg2</font><font color="#808080">,</font><font color="#FF0000">0</font><font color="#808080">)
      </font><font color="#0000FF">end if
      return
      end
</font><font color="#808080"><i>C     ------------------------------------------------------------------
C     Valida a entrada de registros de acordo com a pesquisa feita.
C     sArq - o arquivo
C     sreg - o tipo de arquivo
C     nTexto - o numero do r&oacute;tulo da entrada
C     sEntrada - a chave a ser pesquisada e validada
C     nTentativas - o n&uacute;mero m&aacute;ximo de tentativas
C     bPesqRelativa - indica se vai realizar uma pesquisa relativa
C     bTipoEntrada - indica o tipo de entrada
C     retorna - o registro pesquisado e validado
C     ------------------------------------------------------------------
      </i></font><font color="#0000FF">character</font><font color="#808080">*(*) </font><font color="#0000FF">function </font><font color="#000080">validaEntrada</font><font color="#808080">(</font><font color="#000080">sArq</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#000080">nTexto</font><font color="#808080">,
     *  </font><font color="#000080">sEntrada</font><font color="#808080">, </font><font color="#000080">nTentativas</font><font color="#808080">, </font><font color="#000080">bPesqRelativa</font><font color="#808080">, </font><font color="#000080">bTipoEntrada</font><font color="#808080">)
      </font><font color="#0000FF">integer </font><font color="#000080">sArq</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#000080">nTexto</font><font color="#808080">, </font><font color="#000080">nTentativas</font><font color="#808080">, </font><font color="#000080">bTipoEntrada
      </font><font color="#0000FF">character</font><font color="#808080">*</font><font color="#FF0000">255 </font><font color="#000080">sEntrada
      </font><font color="#0000FF">logical </font><font color="#000080">bPesqRelativa

      </font><font color="#0000FF">include </font><font color="#800000">'livrus.h'
      </font><font color="#0000FF">logical </font><font color="#000080">bQuebra</font><font color="#808080">, </font><font color="#000080">ListarTodos
      </font><font color="#0000FF">character</font><font color="#808080">*</font><font color="#FF0000">255 </font><font color="#000080">sres</font><font color="#808080">, </font><font color="#000080">sTexto</font><font color="#808080">, </font><font color="#000080">sMsgErro</font><font color="#808080">, </font><font color="#000080">rotulo
      </font><font color="#0000FF">integer </font><font color="#000080">ncont</font><font color="#808080">, </font><font color="#000080">nPosChave</font><font color="#808080">, </font><font color="#000080">nTamChave</font><font color="#808080">, </font><font color="#000080">nTamLinha</font><font color="#808080">, </font><font color="#000080">tamReg
      </font><font color="#0000FF">character</font><font color="#808080">*</font><font color="#FF0000">255 </font><font color="#000080">validaNumero</font><font color="#808080">, </font><font color="#000080">validaDataHora</font><font color="#808080">, </font><font color="#000080">digitaSenha</font><font color="#808080">, </font><font color="#000080">pesqArq

      nTamLinha</font><font color="#808080">=</font><font color="#000080">tamReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">)
      </font><font color="#000080">sMsgErro</font><font color="#808080">=</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">,</font><font color="#FF0000">0</font><font color="#808080">)
      </font><font color="#000080">sTexto</font><font color="#808080">=</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">,</font><font color="#000080">nTexto</font><font color="#808080">)
      </font><font color="#000080">nPosChave</font><font color="#808080">=</font><font color="#000080">g_nPosChave
      nTamChave</font><font color="#808080">=</font><font color="#000080">g_nTamChave
      
      ncont</font><font color="#808080">=</font><font color="#FF0000">1
      </font><font color="#000080">bQuebra</font><font color="#808080">=</font><font color="#0000FF">.false.
      do while </font><font color="#808080">((</font><font color="#000080">bQuebra .eqv. </font><font color="#0000FF">.false.</font><font color="#808080">) </font><font color="#0000FF">.and. </font><font color="#808080">(</font><font color="#000080">ncont </font><font color="#0000FF">.le. </font><font color="#000080">nTentativas</font><font color="#808080">))
        </font><font color="#0000FF">if </font><font color="#808080">(</font><font color="#000080">bTipoEntrada </font><font color="#0000FF">.eq. </font><font color="#000080">opTexto</font><font color="#808080">) </font><font color="#0000FF">then
          write</font><font color="#808080">(*,*) </font><font color="#000080">sTexto
          </font><font color="#0000FF">read</font><font color="#808080">(*,*) </font><font color="#000080">sEntrada
        </font><font color="#0000FF">else if </font><font color="#808080">(</font><font color="#000080">bTipoEntrada </font><font color="#0000FF">.eq. </font><font color="#000080">opNumero</font><font color="#808080">) </font><font color="#0000FF">then
           </font><font color="#000080">sEntrada</font><font color="#808080">=</font><font color="#000080">validaNumero</font><font color="#808080">(</font><font color="#000080">sTexto</font><font color="#808080">,</font><font color="#000080">sEntrada</font><font color="#808080">)
        </font><font color="#0000FF">else if </font><font color="#808080">(</font><font color="#000080">bTipoEntrada </font><font color="#0000FF">.eq. </font><font color="#000080">opData</font><font color="#808080">) </font><font color="#0000FF">then
           </font><font color="#000080">sEntrada</font><font color="#808080">=</font><font color="#000080">validaDataHora</font><font color="#808080">(</font><font color="#000080">sTexto</font><font color="#808080">,</font><font color="#000080">sEntrada</font><font color="#808080">,</font><font color="#0000FF">.true.</font><font color="#808080">)
        </font><font color="#0000FF">else if </font><font color="#808080">(</font><font color="#000080">bTipoEntrada </font><font color="#0000FF">.eq. </font><font color="#000080">opDataHora</font><font color="#808080">) </font><font color="#0000FF">then
           </font><font color="#000080">sEntrada</font><font color="#808080">=</font><font color="#000080">validaDataHora</font><font color="#808080">(</font><font color="#000080">sTexto</font><font color="#808080">,</font><font color="#000080">sEntrada</font><font color="#808080">,</font><font color="#0000FF">.false.</font><font color="#808080">)
        </font><font color="#0000FF">else if </font><font color="#808080">(</font><font color="#000080">bTipoEntrada </font><font color="#0000FF">.eq. </font><font color="#000080">opSenha</font><font color="#808080">) </font><font color="#0000FF">then
           </font><font color="#000080">sEntrada</font><font color="#808080">=</font><font color="#000080">digitaSenha</font><font color="#808080">(</font><font color="#000080">sTexto</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">)
        </font><font color="#0000FF">end if
    
        if </font><font color="#808080">(</font><font color="#000080">bPesqRelativa .eqv. </font><font color="#0000FF">.true.</font><font color="#808080">) </font><font color="#0000FF">then
          if </font><font color="#808080">(</font><font color="#000080">ListarTodos</font><font color="#808080">(</font><font color="#000080">sArq</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#000080">sEntrada</font><font color="#808080">, </font><font color="#000080">nPosChave</font><font color="#808080">, </font><font color="#000080">nTamChave</font><font color="#808080">, 
     *       </font><font color="#000080">nTamLinha</font><font color="#808080">, </font><font color="#000080">QTD_MAX_LINHA</font><font color="#808080">, </font><font color="#0000FF">.true.</font><font color="#808080">) </font><font color="#000080">.eqv. </font><font color="#0000FF">.true.</font><font color="#808080">) </font><font color="#0000FF">then
            </font><font color="#000080">sres</font><font color="#808080">=</font><font color="#800000">' '
          </font><font color="#0000FF">end if
        else
           </font><font color="#000080">sres</font><font color="#808080">=</font><font color="#000080">pesqArq</font><font color="#808080">(</font><font color="#000080">sArq</font><font color="#808080">, </font><font color="#000080">sEntrada</font><font color="#808080">, </font><font color="#000080">nPosChave</font><font color="#808080">, </font><font color="#000080">nTamChave</font><font color="#808080">, </font><font color="#000080">nTamLinha</font><font color="#808080">)
        </font><font color="#0000FF">end if
        if </font><font color="#808080">(</font><font color="#000080">sres </font><font color="#0000FF">.eq. </font><font color="#800000">''</font><font color="#808080">) </font><font color="#0000FF">then
           write</font><font color="#808080">(*,*) </font><font color="#000080">sMsgErro
        </font><font color="#0000FF">else
           </font><font color="#000080">bQuebra</font><font color="#808080">=</font><font color="#0000FF">.true.
        end if
        </font><font color="#000080">ncont</font><font color="#808080">=</font><font color="#000080">ncont</font><font color="#808080">+</font><font color="#FF0000">1
      </font><font color="#0000FF">end do
      </font><font color="#000080">validaEntrada</font><font color="#808080">=</font><font color="#000080">sres
      </font><font color="#0000FF">return
      end
</font><font color="#808080"><i>C     ------------------------------------------------------------------
C     Mostra a tela de splash do sistema.
C     ------------------------------------------------------------------
      </i></font><font color="#0000FF">subroutine </font><font color="#000080">frmSplash
      </font><font color="#0000FF">integer </font><font color="#000080">cont

      </font><font color="#0000FF">include </font><font color="#800000">'livrus.h'

      </font><font color="#0000FF">write</font><font color="#808080">(*,*) </font><font color="#800000">'*-----------------------------------------------------
     </font><font color="#808080">*-----------------------*</font><font color="#800000">'
      </font><font color="#0000FF">write</font><font color="#808080">(*,*) </font><font color="#800000">'| LL    II VV   VV RRRRR  UU  UU   SSSS VV   VV II RRR
     </font><font color="#808080">*</font><font color="#000080">RR  TTTT UU  UU   SSSS |</font><font color="#800000">'
      </font><font color="#0000FF">write</font><font color="#808080">(*,*) </font><font color="#800000">'| LL    II  VV VV  RR   R UU  UU  SS     VV VV  II RR 
     </font><font color="#808080">*  </font><font color="#000080">R  TT  UU  UU  SS    |</font><font color="#800000">'
      </font><font color="#0000FF">write</font><font color="#808080">(*,*) </font><font color="#800000">'| LL    II   VVV   RRRRR  UU  UU    SS    VVV   II RRR
     </font><font color="#808080">*</font><font color="#000080">RR   TT  UU  UU    SS  |</font><font color="#800000">'
      </font><font color="#0000FF">write</font><font color="#808080">(*,*) </font><font color="#800000">'| LLLLL II    V    RR   R  UUUU  SSSS      V    II RR 
     </font><font color="#808080">*  </font><font color="#000080">R  TT   UUUU  SSSS   |</font><font color="#800000">'
      </font><font color="#0000FF">write</font><font color="#808080">(*,*) </font><font color="#800000">'*-----------------------------------------------------
     </font><font color="#808080">*-----------------------*</font><font color="#800000">'
      </font><font color="#0000FF">do </font><font color="#000080">cont</font><font color="#808080">=</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#FF0000">17
        </font><font color="#0000FF">write</font><font color="#808080">(*,*)
      </font><font color="#0000FF">end do
      write</font><font color="#808080">(*,*) </font><font color="#000080">MSG_PRESS
      </font><font color="#0000FF">read</font><font color="#808080">(*,*) 
      </font><font color="#0000FF">end
</font><font color="#808080"><i>C     ------------------------------------------------------------------
C     Mostra a tela de sobre do sistema.
C     ------------------------------------------------------------------
      </i></font><font color="#0000FF">subroutine </font><font color="#000080">frmSobre
      </font><font color="#0000FF">integer </font><font color="#000080">cont

      </font><font color="#0000FF">include </font><font color="#800000">'livrus.h'

      </font><font color="#0000FF">write</font><font color="#808080">(*,*) </font><font color="#800000">'*-----------------------------------------------------
     </font><font color="#808080">*-------*</font><font color="#800000">'
      </font><font color="#0000FF">write</font><font color="#808080">(*,*) </font><font color="#800000">'|  LL        II  VV       VV  RRRRRRR   UU    UU   SSS
     </font><font color="#808080">*</font><font color="#000080">SSSS   |</font><font color="#800000">'
      </font><font color="#0000FF">write</font><font color="#808080">(*,*) </font><font color="#800000">'|  LL        II   VV     VV   RR     R  UU    UU  SS  
     </font><font color="#808080">*       </font><font color="#000080">|</font><font color="#800000">'
      </font><font color="#0000FF">write</font><font color="#808080">(*,*) </font><font color="#800000">'|  LL        II    VV   VV    RR     R  UU    UU   SSS
     </font><font color="#808080">*</font><font color="#000080">S      |</font><font color="#800000">'
      </font><font color="#0000FF">write</font><font color="#808080">(*,*) </font><font color="#800000">'|  LL        II     VV VV     RRRRRRR   UU    UU     S
     </font><font color="#808080">*</font><font color="#000080">SSS    |</font><font color="#800000">'
      </font><font color="#0000FF">write</font><font color="#808080">(*,*) </font><font color="#800000">'|  LLLL      II      VVV      RR RR     UU    UU      
     </font><font color="#808080">*  </font><font color="#000080">SS   |</font><font color="#800000">'
      </font><font color="#0000FF">write</font><font color="#808080">(*,*) </font><font color="#800000">'|  LLLLLLLL  II       V       RR   RR    UUUUUU   SSSS
     </font><font color="#808080">*</font><font color="#000080">SSSS   |</font><font color="#800000">'
      </font><font color="#0000FF">write</font><font color="#808080">(*,*) </font><font color="#800000">'|                                                      
     </font><font color="#808080">*       </font><font color="#000080">|</font><font color="#800000">'
      </font><font color="#0000FF">write</font><font color="#808080">(*,*) </font><font color="#800000">'|  VV       VV  II  RRRRRRR   TTTTTTTT  UU    UU   SSS
     </font><font color="#808080">*</font><font color="#000080">SSSS   |</font><font color="#800000">'
      </font><font color="#0000FF">write</font><font color="#808080">(*,*) </font><font color="#800000">'|   VV     VV   II  RR     R     TT     UU    UU  SS  
     </font><font color="#808080">*       </font><font color="#000080">|</font><font color="#800000">'
      </font><font color="#0000FF">write</font><font color="#808080">(*,*) </font><font color="#800000">'|    VV   VV    II  RR     R     TT     UU    UU   SSS
     </font><font color="#808080">*</font><font color="#000080">S      |</font><font color="#800000">'
      </font><font color="#0000FF">write</font><font color="#808080">(*,*) </font><font color="#800000">'|     VV VV     II  RRRRRRR      TT     UU    UU     S
     </font><font color="#808080">*</font><font color="#000080">SSS    |</font><font color="#800000">'
      </font><font color="#0000FF">write</font><font color="#808080">(*,*) </font><font color="#800000">'|      VVV      II  RR RR        TT     UU    UU      
     </font><font color="#808080">*  </font><font color="#000080">SS   |</font><font color="#800000">'
      </font><font color="#0000FF">write</font><font color="#808080">(*,*) </font><font color="#800000">'|       V       II  RR   RR      TT      UUUUUU   SSSS
     </font><font color="#808080">*</font><font color="#000080">SSSS   |</font><font color="#800000">'
      </font><font color="#0000FF">write</font><font color="#808080">(*,*) </font><font color="#800000">'|                                                     
     </font><font color="#808080">*       </font><font color="#000080">|</font><font color="#800000">'
      </font><font color="#0000FF">write</font><font color="#808080">(*,*) </font><font color="#800000">'|                                               Versao
     </font><font color="#808080">* </font><font color="#FF0000">1.0.0 </font><font color="#000080">|</font><font color="#800000">'
      </font><font color="#0000FF">write</font><font color="#808080">(*,*) </font><font color="#800000">'| Sistema integrante do projeto Livrus Virtus.        
     </font><font color="#808080">*       </font><font color="#000080">|</font><font color="#800000">'
      </font><font color="#0000FF">write</font><font color="#808080">(*,*) </font><font color="#800000">'| Todos os direitos reservados para Henrique F. de Sou
     </font><font color="#808080">*</font><font color="#000080">za</font><font color="#808080">.    </font><font color="#000080">|</font><font color="#800000">'
      </font><font color="#0000FF">write</font><font color="#808080">(*,*) </font><font color="#800000">'| Versao programada na linguagem fortran 77.          
     </font><font color="#808080">*       </font><font color="#000080">|</font><font color="#800000">'
      </font><font color="#0000FF">write</font><font color="#808080">(*,*) </font><font color="#800000">'*-----------------------------------------------------
     </font><font color="#808080">*-------*</font><font color="#800000">'
      </font><font color="#0000FF">do </font><font color="#000080">cont</font><font color="#808080">=</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#FF0000">3
        </font><font color="#0000FF">write</font><font color="#808080">(*,*)
      </font><font color="#0000FF">end do
      write</font><font color="#808080">(*,*) </font><font color="#000080">MSG_PRESS
      </font><font color="#0000FF">read</font><font color="#808080">(*,*) 
      </font><font color="#0000FF">end
</font><font color="#808080"><i>C     ------------------------------------------------------------------
C     Mostra a tela de login do sistema.
C     retorna - se o login foi validado corretamente
C     ------------------------------------------------------------------
      </i></font><font color="#0000FF">logical function </font><font color="#000080">frmLogin</font><font color="#808080">()
      </font><font color="#0000FF">include </font><font color="#800000">'livrus.h'
      </font><font color="#0000FF">logical </font><font color="#000080">bret
      </font><font color="#0000FF">character</font><font color="#808080">*</font><font color="#FF0000">255 </font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#000080">ftrim</font><font color="#808080">, </font><font color="#000080">copy</font><font color="#808080">, </font><font color="#000080">validaEntrada
      
      bret</font><font color="#808080">=</font><font color="#0000FF">.false.
      write</font><font color="#808080">(*,*) </font><font color="#800000">'*-----------------------------------------------------
     </font><font color="#808080">*---------*</font><font color="#800000">'
      </font><font color="#0000FF">write</font><font color="#808080">(*,*) </font><font color="#800000">'| Login do sistema
     </font><font color="#808080">*         </font><font color="#000080">|</font><font color="#800000">'
      </font><font color="#0000FF">write</font><font color="#808080">(*,*) </font><font color="#800000">'*-----------------------------------------------------
     </font><font color="#808080">*---------*</font><font color="#800000">'
      </font><font color="#000080">slinha</font><font color="#808080">=</font><font color="#000080">validaEntrada</font><font color="#808080">(</font><font color="#000080">tfUsuario</font><font color="#808080">, </font><font color="#000080">opUsuario</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#000080">tUsuario_login</font><font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">,
     *    </font><font color="#0000FF">.false.</font><font color="#808080">, </font><font color="#000080">opTexto</font><font color="#808080">)
      </font><font color="#0000FF">if </font><font color="#808080">(</font><font color="#000080">slinha </font><font color="#0000FF">.ne. </font><font color="#800000">''</font><font color="#808080">) </font><font color="#0000FF">then
         </font><font color="#000080">slinha </font><font color="#808080">= </font><font color="#000080">validaEntrada</font><font color="#808080">(</font><font color="#000080">tfUsuario</font><font color="#808080">, </font><font color="#000080">opUsuario</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">, 
     *       </font><font color="#000080">tUsuario_senha</font><font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">, </font><font color="#0000FF">.false.</font><font color="#808080">, </font><font color="#000080">opSenha</font><font color="#808080">)
         </font><font color="#0000FF">if </font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#0000FF">.ne.</font><font color="#800000">''</font><font color="#808080">) </font><font color="#0000FF">then
           </font><font color="#000080">tUsuario_login</font><font color="#808080">=</font><font color="#000080">ftrim</font><font color="#808080">(</font><font color="#000080">copy</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">))
           </font><font color="#000080">tUsuario_senha</font><font color="#808080">=</font><font color="#000080">ftrim</font><font color="#808080">(</font><font color="#000080">copy</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">11</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">))
           </font><font color="#000080">bret</font><font color="#808080">=</font><font color="#0000FF">.true.
         end if
      end if
      write</font><font color="#808080">(*,*)
</font>	    <font color="#000080">frmLogin </font><font color="#808080">= </font><font color="#000080">bret
      </font><font color="#0000FF">return
      end
</font><font color="#808080"><i>C     ------------------------------------------------------------------
C     Mostra os menus do sistema.
C     num - o n&uacute;mero do menu
C     ------------------------------------------------------------------
      </i></font><font color="#0000FF">subroutine </font><font color="#000080">menu</font><font color="#808080">(</font><font color="#000080">num</font><font color="#808080">)
      </font><font color="#0000FF">integer </font><font color="#000080">num

      </font><font color="#0000FF">include </font><font color="#800000">'livrus.h'

      </font><font color="#0000FF">if </font><font color="#808080">(</font><font color="#000080">num</font><font color="#0000FF">.eq.</font><font color="#FF0000">1</font><font color="#808080">) </font><font color="#0000FF">then 
        write</font><font color="#808080">(*,*) </font><font color="#800000">'*---------------------------------------------------
     </font><font color="#808080">*-----------*</font><font color="#800000">'
        </font><font color="#0000FF">write</font><font color="#808080">(*,*) </font><font color="#800000">'| (C)adastros        (P)esquisas     (V)endas
     </font><font color="#808080">* (</font><font color="#000080">O</font><font color="#808080">)</font><font color="#000080">p&ccedil;&otilde;es  |</font><font color="#800000">'
        </font><font color="#0000FF">write</font><font color="#808080">(*,*) </font><font color="#800000">'*---------------------------------------------------
     </font><font color="#808080">*-----------*</font><font color="#800000">'
      </font><font color="#0000FF">else if </font><font color="#808080">(</font><font color="#000080">num</font><font color="#0000FF">.eq.</font><font color="#FF0000">2</font><font color="#808080">) </font><font color="#0000FF">then 
        write</font><font color="#808080">(*,*) </font><font color="#800000">'*---------------------------------*'
        </font><font color="#0000FF">write</font><font color="#808080">(*,*) </font><font color="#800000">'| 01. Cadastro de Assuntos        |'
        </font><font color="#0000FF">write</font><font color="#808080">(*,*) </font><font color="#800000">'| 02. Cadastro de Autores         |'
        </font><font color="#0000FF">write</font><font color="#808080">(*,*) </font><font color="#800000">'| 03. Cadastro de Editoras        |'
        </font><font color="#0000FF">write</font><font color="#808080">(*,*) </font><font color="#800000">'| 04. Cadastro de Endere&ccedil;os       |'
        </font><font color="#0000FF">write</font><font color="#808080">(*,*) </font><font color="#800000">'| 05. Cadastro de Idiomas         |'
        </font><font color="#0000FF">write</font><font color="#808080">(*,*) </font><font color="#800000">'| 06. Cadastro de Pa&iacute;ses          |'
        </font><font color="#0000FF">write</font><font color="#808080">(*,*) </font><font color="#800000">'| 07. Cadastro de Profiss&otilde;es      |'
        </font><font color="#0000FF">write</font><font color="#808080">(*,*) </font><font color="#800000">'| 08. Cadastro de Clientes        |'
        </font><font color="#0000FF">write</font><font color="#808080">(*,*) </font><font color="#800000">'| 09. Cadastro de Livros          |'
        </font><font color="#0000FF">write</font><font color="#808080">(*,*) </font><font color="#800000">'| 10. Voltar ao menu              |'
        </font><font color="#0000FF">write</font><font color="#808080">(*,*) </font><font color="#800000">'*---------------------------------*'
      </font><font color="#0000FF">else if </font><font color="#808080">(</font><font color="#000080">num</font><font color="#0000FF">.eq.</font><font color="#FF0000">3</font><font color="#808080">) </font><font color="#0000FF">then 
        write</font><font color="#808080">(*,*) </font><font color="#800000">'*---------------------------------*'
        </font><font color="#0000FF">write</font><font color="#808080">(*,*) </font><font color="#800000">'| 01. Consulta de Assuntos        |'
        </font><font color="#0000FF">write</font><font color="#808080">(*,*) </font><font color="#800000">'| 02. Consulta de Autores         |'
        </font><font color="#0000FF">write</font><font color="#808080">(*,*) </font><font color="#800000">'| 03. Consulta de Editoras        |'
        </font><font color="#0000FF">write</font><font color="#808080">(*,*) </font><font color="#800000">'| 04. Consulta de Endere&ccedil;os       |'
        </font><font color="#0000FF">write</font><font color="#808080">(*,*) </font><font color="#800000">'| 05. Consulta de Idiomas         |'
        </font><font color="#0000FF">write</font><font color="#808080">(*,*) </font><font color="#800000">'| 06. Consulta de Pa&iacute;ses          |'
        </font><font color="#0000FF">write</font><font color="#808080">(*,*) </font><font color="#800000">'| 07. Consulta de Profiss&otilde;es      |'
        </font><font color="#0000FF">write</font><font color="#808080">(*,*) </font><font color="#800000">'| 08. Consulta de Clientes        |'
        </font><font color="#0000FF">write</font><font color="#808080">(*,*) </font><font color="#800000">'| 09. Consulta de Livros          |'
        </font><font color="#0000FF">write</font><font color="#808080">(*,*) </font><font color="#800000">'| 10. Voltar ao menu              |'
        </font><font color="#0000FF">write</font><font color="#808080">(*,*) </font><font color="#800000">'*---------------------------------*'
      </font><font color="#0000FF">else if </font><font color="#808080">(</font><font color="#000080">num</font><font color="#0000FF">.eq.</font><font color="#FF0000">4</font><font color="#808080">) </font><font color="#0000FF">then 
        write</font><font color="#808080">(*,*) </font><font color="#800000">'*---------------------------------*'
        </font><font color="#0000FF">write</font><font color="#808080">(*,*) </font><font color="#800000">'| 01. Vender Livros               |'
        </font><font color="#0000FF">write</font><font color="#808080">(*,*) </font><font color="#800000">'| 02. Vendas Realizadas           |'
        </font><font color="#0000FF">write</font><font color="#808080">(*,*) </font><font color="#800000">'| 03. Voltar ao menu              |'
        </font><font color="#0000FF">write</font><font color="#808080">(*,*) </font><font color="#800000">'*---------------------------------*'
      </font><font color="#0000FF">else if </font><font color="#808080">(</font><font color="#000080">num</font><font color="#0000FF">.eq.</font><font color="#FF0000">5</font><font color="#808080">) </font><font color="#0000FF">then 
        write</font><font color="#808080">(*,*) </font><font color="#800000">'*---------------------------------*'
        </font><font color="#0000FF">write</font><font color="#808080">(*,*) </font><font color="#800000">'| 01. Alterar senha               |'
        </font><font color="#0000FF">write</font><font color="#808080">(*,*) </font><font color="#800000">'| 02. Sobre o sistema             |'
        </font><font color="#0000FF">write</font><font color="#808080">(*,*) </font><font color="#800000">'| 03. Sair do sistema             |'
        </font><font color="#0000FF">write</font><font color="#808080">(*,*) </font><font color="#800000">'| 04. Voltar ao menu              |'
        </font><font color="#0000FF">write</font><font color="#808080">(*,*) </font><font color="#800000">'*---------------------------------*'
      </font><font color="#0000FF">else if </font><font color="#808080">(</font><font color="#000080">num</font><font color="#0000FF">.eq.</font><font color="#FF0000">6</font><font color="#808080">) </font><font color="#0000FF">then 
        write</font><font color="#808080">(*,*) </font><font color="#800000">'*---------------------------------------------------
     </font><font color="#808080">*-----------*</font><font color="#800000">'
        </font><font color="#0000FF">write</font><font color="#808080">(*,*) </font><font color="#800000">'| (1) Novo  (2) Pesquisar   (3) Voltar ao menu
     </font><font color="#808080">*           </font><font color="#000080">|</font><font color="#800000">'
        </font><font color="#0000FF">write</font><font color="#808080">(*,*) </font><font color="#800000">'*---------------------------------------------------
     </font><font color="#808080">*-----------*</font><font color="#800000">'
      </font><font color="#0000FF">else if </font><font color="#808080">(</font><font color="#000080">num</font><font color="#0000FF">.eq.</font><font color="#FF0000">7</font><font color="#808080">) </font><font color="#0000FF">then 
        write</font><font color="#808080">(*,*) </font><font color="#800000">'*---------------------------------------------------
     </font><font color="#808080">*-----------*</font><font color="#800000">'
        </font><font color="#0000FF">write</font><font color="#808080">(*,*) </font><font color="#800000">'| (1) Salvar inclus&atilde;o       (2) Voltar ao menu
     </font><font color="#808080">*           </font><font color="#000080">|</font><font color="#800000">'
        </font><font color="#0000FF">write</font><font color="#808080">(*,*) </font><font color="#800000">'*---------------------------------------------------
     </font><font color="#808080">*-----------*</font><font color="#800000">'
      </font><font color="#0000FF">else if </font><font color="#808080">(</font><font color="#000080">num</font><font color="#0000FF">.eq.</font><font color="#FF0000">8</font><font color="#808080">) </font><font color="#0000FF">then 
        write</font><font color="#808080">(*,*) </font><font color="#800000">'*---------------------------------------------------
     </font><font color="#808080">*-----------*</font><font color="#800000">'
        </font><font color="#0000FF">write</font><font color="#808080">(*,*) </font><font color="#800000">'| (1) Alterar       (2) Excluir     (3) Voltar ao me
     </font><font color="#808080">*</font><font color="#000080">nu         |</font><font color="#800000">'
        </font><font color="#0000FF">write</font><font color="#808080">(*,*) </font><font color="#800000">'*---------------------------------------------------
     </font><font color="#808080">*-----------*</font><font color="#800000">'
      </font><font color="#0000FF">else if </font><font color="#808080">(</font><font color="#000080">num</font><font color="#0000FF">.eq.</font><font color="#FF0000">9</font><font color="#808080">) </font><font color="#0000FF">then 
        write</font><font color="#808080">(*,*) </font><font color="#800000">'*---------------------------------------------------
     </font><font color="#808080">*-----------*</font><font color="#800000">'
        </font><font color="#0000FF">write</font><font color="#808080">(*,*) </font><font color="#800000">'| (1) Salvar altera&ccedil;&atilde;o      (2) Voltar ao menu
     </font><font color="#808080">*           </font><font color="#000080">|</font><font color="#800000">'
        </font><font color="#0000FF">write</font><font color="#808080">(*,*) </font><font color="#800000">'*---------------------------------------------------
     </font><font color="#808080">*-----------*</font><font color="#800000">'
      </font><font color="#0000FF">else if </font><font color="#808080">(</font><font color="#000080">num</font><font color="#0000FF">.eq.</font><font color="#FF0000">10</font><font color="#808080">) </font><font color="#0000FF">then 
        write</font><font color="#808080">(*,*) </font><font color="#800000">'*---------------------------------------------------
     </font><font color="#808080">*-----------*</font><font color="#800000">'
        </font><font color="#0000FF">write</font><font color="#808080">(*,*) </font><font color="#800000">'| Certeza de excluir? (S/N)
     </font><font color="#808080">*           </font><font color="#000080">|</font><font color="#800000">'
        </font><font color="#0000FF">write</font><font color="#808080">(*,*) </font><font color="#800000">'*---------------------------------------------------
     </font><font color="#808080">*-----------*</font><font color="#800000">'
      </font><font color="#0000FF">else if </font><font color="#808080">(</font><font color="#000080">num</font><font color="#0000FF">.eq.</font><font color="#FF0000">11</font><font color="#808080">) </font><font color="#0000FF">then 
        write</font><font color="#808080">(*,*) </font><font color="#800000">'*---------------------------------------------------
     </font><font color="#808080">*-----------*</font><font color="#800000">'
        </font><font color="#0000FF">write</font><font color="#808080">(*,*) </font><font color="#800000">'| Deseja sair do sistema? (S/N)
     </font><font color="#808080">*           </font><font color="#000080">|</font><font color="#800000">'
        </font><font color="#0000FF">write</font><font color="#808080">(*,*) </font><font color="#800000">'*---------------------------------------------------
     </font><font color="#808080">*-----------*</font><font color="#800000">'
      </font><font color="#0000FF">else if </font><font color="#808080">(</font><font color="#000080">num</font><font color="#0000FF">.eq.</font><font color="#FF0000">12</font><font color="#808080">) </font><font color="#0000FF">then 
        write</font><font color="#808080">(*,*) </font><font color="#800000">'*---------------------------------------------------
     </font><font color="#808080">*-----------*</font><font color="#800000">'
        </font><font color="#0000FF">write</font><font color="#808080">(*,*) </font><font color="#800000">'| (1) Pesquisar  (2) Listar todos   (3) Voltar ao me
     </font><font color="#808080">*</font><font color="#000080">nu         |</font><font color="#800000">'
        </font><font color="#0000FF">write</font><font color="#808080">(*,*) </font><font color="#800000">'*---------------------------------------------------
     </font><font color="#808080">*-----------*</font><font color="#800000">'
      </font><font color="#0000FF">else if </font><font color="#808080">(</font><font color="#000080">num</font><font color="#0000FF">.eq.</font><font color="#FF0000">13</font><font color="#808080">) </font><font color="#0000FF">then 
        write</font><font color="#808080">(*,*) </font><font color="#800000">'*---------------------------------------------------
     </font><font color="#808080">*-----------*</font><font color="#800000">'
        </font><font color="#0000FF">write</font><font color="#808080">(*,*) </font><font color="#800000">'| Deseja continuar? (S/N)
     </font><font color="#808080">*           </font><font color="#000080">|</font><font color="#800000">'
        </font><font color="#0000FF">write</font><font color="#808080">(*,*) </font><font color="#800000">'*---------------------------------------------------
     </font><font color="#808080">*-----------*</font><font color="#800000">'
      </font><font color="#0000FF">else if </font><font color="#808080">(</font><font color="#000080">num</font><font color="#0000FF">.eq.</font><font color="#FF0000">14</font><font color="#808080">) </font><font color="#0000FF">then 
        write</font><font color="#808080">(*,*) </font><font color="#800000">'*---------------------------------------------------
     </font><font color="#808080">*-----------*</font><font color="#800000">'
        </font><font color="#0000FF">write</font><font color="#808080">(*,*) </font><font color="#800000">'| Salvar inclus&atilde;o (S/N)
     </font><font color="#808080">*           </font><font color="#000080">|</font><font color="#800000">'
        </font><font color="#0000FF">write</font><font color="#808080">(*,*) </font><font color="#800000">'*---------------------------------------------------
     </font><font color="#808080">*-----------*</font><font color="#800000">'
      </font><font color="#0000FF">end if
      write</font><font color="#808080">(*,*) </font><font color="#000080">MSG_OPCAO
      </font><font color="#0000FF">end
</font><font color="#808080"><i>C     ------------------------------------------------------------------
C     Realiza os cadastros de acordo com o tipo de arquivo.
C     sreg - o tipo de arquivo
C     sacao - a a&ccedil;&atilde;o a ser realizada
C     ------------------------------------------------------------------
      </i></font><font color="#0000FF">subroutine </font><font color="#000080">frmCadastros</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#000080">sacao</font><font color="#808080">)
      </font><font color="#0000FF">integer </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#000080">sacao

      </font><font color="#0000FF">include </font><font color="#800000">'livrus.h'
      </font><font color="#0000FF">integer </font><font color="#000080">tamReg
      </font><font color="#0000FF">character</font><font color="#808080">*</font><font color="#FF0000">255 </font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#000080">pesqMaxCod</font><font color="#808080">, </font><font color="#000080">validaEntrada</font><font color="#808080">, </font><font color="#000080">rotulo</font><font color="#808080">, 
     * </font><font color="#000080">retDataHora</font><font color="#808080">, </font><font color="#000080">ftrim</font><font color="#808080">, </font><font color="#000080">copy</font><font color="#808080">, </font><font color="#000080">pesqArq
      </font><font color="#0000FF">logical </font><font color="#000080">validaISBN</font><font color="#808080">, </font><font color="#000080">validaCPF

      </font><font color="#0000FF">if </font><font color="#808080">(</font><font color="#000080">sreg </font><font color="#0000FF">.eq. </font><font color="#000080">opAssunto</font><font color="#808080">) </font><font color="#0000FF">then
         if </font><font color="#808080">(</font><font color="#000080">sacao </font><font color="#0000FF">.eq. </font><font color="#000080">opNovo</font><font color="#808080">) </font><font color="#0000FF">then
           </font><font color="#000080">tAssunto_codigo</font><font color="#808080">=</font><font color="#000080">pesqMaxCod</font><font color="#808080">(</font><font color="#000080">tfAssunto</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">, </font><font color="#000080">tamReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">))
           </font><font color="#0000FF">call </font><font color="#000080">mostrarDados</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#800000">''</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">)
           </font><font color="#0000FF">call </font><font color="#000080">subMenu</font><font color="#808080">(</font><font color="#FF0000">7</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">)
         </font><font color="#0000FF">else if </font><font color="#808080">(</font><font color="#000080">sacao </font><font color="#0000FF">.eq. </font><font color="#000080">opPesquisar</font><font color="#808080">) </font><font color="#0000FF">then
           </font><font color="#000080">slinha</font><font color="#808080">=</font><font color="#000080">validaEntrada</font><font color="#808080">(</font><font color="#000080">tfAssunto</font><font color="#808080">,</font><font color="#000080">sreg</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,
     *       </font><font color="#000080">tAssunto_codigo</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#0000FF">.false.</font><font color="#808080">,</font><font color="#000080">opNumero</font><font color="#808080">)
            </font><font color="#0000FF">if </font><font color="#808080">(</font><font color="#000080">slinha </font><font color="#0000FF">.ne. </font><font color="#800000">''</font><font color="#808080">) </font><font color="#0000FF">then
              call </font><font color="#000080">mostrarDados</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#800000">''</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">)
              </font><font color="#0000FF">call </font><font color="#000080">mostrarDados</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">)
              </font><font color="#0000FF">call </font><font color="#000080">subMenu</font><font color="#808080">(</font><font color="#FF0000">8</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">)
            </font><font color="#0000FF">end if
         else if </font><font color="#808080">(</font><font color="#000080">sacao </font><font color="#0000FF">.eq. </font><font color="#000080">opAlterar</font><font color="#808080">) </font><font color="#0000FF">then
            call </font><font color="#000080">mostrarDados</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#800000">''</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">)
            </font><font color="#0000FF">call </font><font color="#000080">subMenu</font><font color="#808080">(</font><font color="#FF0000">9</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">)
         </font><font color="#0000FF">else if </font><font color="#808080">(</font><font color="#000080">sacao </font><font color="#0000FF">.eq. </font><font color="#000080">opExcluir</font><font color="#808080">) </font><font color="#0000FF">then
            call </font><font color="#000080">subMenu</font><font color="#808080">(</font><font color="#FF0000">10</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">)
         </font><font color="#0000FF">end if
      else if </font><font color="#808080">(</font><font color="#000080">sreg </font><font color="#0000FF">.eq. </font><font color="#000080">opAutor</font><font color="#808080">) </font><font color="#0000FF">then 
         if </font><font color="#808080">(</font><font color="#000080">sacao </font><font color="#0000FF">.eq. </font><font color="#000080">opNovo</font><font color="#808080">) </font><font color="#0000FF">then
            </font><font color="#000080">tAutor_codigo</font><font color="#808080">=</font><font color="#000080">pesqMaxCod</font><font color="#808080">(</font><font color="#000080">tfAutor</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">, </font><font color="#000080">tamReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">))
            </font><font color="#0000FF">call </font><font color="#000080">mostrarDados</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#800000">''</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">)
            </font><font color="#0000FF">call </font><font color="#000080">subMenu</font><font color="#808080">(</font><font color="#FF0000">7</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">)
         </font><font color="#0000FF">else if </font><font color="#808080">(</font><font color="#000080">sacao </font><font color="#0000FF">.eq. </font><font color="#000080">opPesquisar</font><font color="#808080">) </font><font color="#0000FF">then
            </font><font color="#000080">slinha</font><font color="#808080">=</font><font color="#000080">validaEntrada</font><font color="#808080">(</font><font color="#000080">tfAutor</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, 
     *        </font><font color="#000080">tAutor_codigo</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#0000FF">.false.</font><font color="#808080">,</font><font color="#000080">opNumero</font><font color="#808080">)
            </font><font color="#0000FF">if </font><font color="#808080">(</font><font color="#000080">slinha </font><font color="#0000FF">.ne. </font><font color="#800000">''</font><font color="#808080">) </font><font color="#0000FF">then 
              call </font><font color="#000080">mostrarDados</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#800000">''</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">)
              </font><font color="#0000FF">call </font><font color="#000080">mostrarDados</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">)
              </font><font color="#0000FF">call </font><font color="#000080">subMenu</font><font color="#808080">(</font><font color="#FF0000">8</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">)
            </font><font color="#0000FF">end if
         else if </font><font color="#808080">(</font><font color="#000080">sacao </font><font color="#0000FF">.eq. </font><font color="#000080">opAlterar</font><font color="#808080">) </font><font color="#0000FF">then
            call </font><font color="#000080">mostrarDados</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#800000">''</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">)
            </font><font color="#0000FF">call </font><font color="#000080">subMenu</font><font color="#808080">(</font><font color="#FF0000">9</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">)
         </font><font color="#0000FF">else if </font><font color="#808080">(</font><font color="#000080">sacao </font><font color="#0000FF">.eq. </font><font color="#000080">opExcluir</font><font color="#808080">) </font><font color="#0000FF">then
            call </font><font color="#000080">subMenu</font><font color="#808080">(</font><font color="#FF0000">10</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">)
         </font><font color="#0000FF">end if
      else if </font><font color="#808080">(</font><font color="#000080">sreg </font><font color="#0000FF">.eq. </font><font color="#000080">opEditora</font><font color="#808080">) </font><font color="#0000FF">then 
         if </font><font color="#808080">(</font><font color="#000080">sacao </font><font color="#0000FF">.eq. </font><font color="#000080">opNovo</font><font color="#808080">) </font><font color="#0000FF">then
            </font><font color="#000080">tEditora_codigo</font><font color="#808080">=</font><font color="#000080">pesqMaxCod</font><font color="#808080">(</font><font color="#000080">tfEditora</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">, </font><font color="#000080">tamReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">))
            </font><font color="#0000FF">call </font><font color="#000080">mostrarDados</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#800000">''</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">)
            </font><font color="#0000FF">call </font><font color="#000080">subMenu</font><font color="#808080">(</font><font color="#FF0000">7</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">)
         </font><font color="#0000FF">else if </font><font color="#808080">(</font><font color="#000080">sacao </font><font color="#0000FF">.eq. </font><font color="#000080">opPesquisar</font><font color="#808080">) </font><font color="#0000FF">then
           </font><font color="#000080">slinha</font><font color="#808080">=</font><font color="#000080">validaEntrada</font><font color="#808080">(</font><font color="#000080">tfEditora</font><font color="#808080">,</font><font color="#000080">sreg</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,
     *       </font><font color="#000080">tEditora_codigo</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#0000FF">.false.</font><font color="#808080">,</font><font color="#000080">opNumero</font><font color="#808080">)
            </font><font color="#0000FF">if </font><font color="#808080">(</font><font color="#000080">slinha </font><font color="#0000FF">.ne. </font><font color="#800000">''</font><font color="#808080">) </font><font color="#0000FF">then 
              call </font><font color="#000080">mostrarDados</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#800000">''</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">)
              </font><font color="#0000FF">call </font><font color="#000080">mostrarDados</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">)
              </font><font color="#0000FF">call </font><font color="#000080">subMenu</font><font color="#808080">(</font><font color="#FF0000">8</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">)
            </font><font color="#0000FF">end if
         else if </font><font color="#808080">(</font><font color="#000080">sacao </font><font color="#0000FF">.eq. </font><font color="#000080">opAlterar</font><font color="#808080">) </font><font color="#0000FF">then
            call </font><font color="#000080">mostrarDados</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#800000">''</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">)
            </font><font color="#0000FF">call </font><font color="#000080">subMenu</font><font color="#808080">(</font><font color="#FF0000">9</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">)
         </font><font color="#0000FF">else if </font><font color="#808080">(</font><font color="#000080">sacao </font><font color="#0000FF">.eq. </font><font color="#000080">opExcluir</font><font color="#808080">) </font><font color="#0000FF">then
            call </font><font color="#000080">subMenu</font><font color="#808080">(</font><font color="#FF0000">10</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">)
         </font><font color="#0000FF">end if
      else if </font><font color="#808080">(</font><font color="#000080">sreg </font><font color="#0000FF">.eq. </font><font color="#000080">opEndereco</font><font color="#808080">) </font><font color="#0000FF">then 
         if </font><font color="#808080">(</font><font color="#000080">sacao </font><font color="#0000FF">.eq. </font><font color="#000080">opNovo</font><font color="#808080">) </font><font color="#0000FF">then
            </font><font color="#000080">tEndereco_codigo</font><font color="#808080">=</font><font color="#000080">pesqMaxCod</font><font color="#808080">(</font><font color="#000080">tfEndereco</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">, </font><font color="#000080">tamReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">))
            </font><font color="#0000FF">call </font><font color="#000080">mostrarDados</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#800000">''</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">)
            </font><font color="#0000FF">call </font><font color="#000080">subMenu</font><font color="#808080">(</font><font color="#FF0000">7</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">)
         </font><font color="#0000FF">else if </font><font color="#808080">(</font><font color="#000080">sacao </font><font color="#0000FF">.eq. </font><font color="#000080">opPesquisar</font><font color="#808080">) </font><font color="#0000FF">then
            </font><font color="#000080">slinha</font><font color="#808080">=</font><font color="#000080">validaEntrada</font><font color="#808080">(</font><font color="#000080">tfEndereco</font><font color="#808080">,</font><font color="#000080">sreg</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#000080">tEndereco_codigo</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,
     *               </font><font color="#0000FF">.false.</font><font color="#808080">,</font><font color="#000080">opNumero</font><font color="#808080">)
            </font><font color="#0000FF">if </font><font color="#808080">(</font><font color="#000080">slinha </font><font color="#0000FF">.ne. </font><font color="#800000">''</font><font color="#808080">) </font><font color="#0000FF">then 
              call </font><font color="#000080">mostrarDados</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#800000">''</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">)
              </font><font color="#0000FF">call </font><font color="#000080">mostrarDados</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">)
              </font><font color="#0000FF">call </font><font color="#000080">subMenu</font><font color="#808080">(</font><font color="#FF0000">8</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">)
            </font><font color="#0000FF">end if
         else if </font><font color="#808080">(</font><font color="#000080">sacao </font><font color="#0000FF">.eq. </font><font color="#000080">opAlterar</font><font color="#808080">) </font><font color="#0000FF">then
            call </font><font color="#000080">mostrarDados</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#800000">''</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">)
            </font><font color="#0000FF">call </font><font color="#000080">subMenu</font><font color="#808080">(</font><font color="#FF0000">9</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">)
         </font><font color="#0000FF">else if </font><font color="#808080">(</font><font color="#000080">sacao </font><font color="#0000FF">.eq. </font><font color="#000080">opExcluir</font><font color="#808080">) </font><font color="#0000FF">then
            call </font><font color="#000080">subMenu</font><font color="#808080">(</font><font color="#FF0000">10</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">)
         </font><font color="#0000FF">end if
      else if </font><font color="#808080">(</font><font color="#000080">sreg </font><font color="#0000FF">.eq. </font><font color="#000080">opIdioma</font><font color="#808080">) </font><font color="#0000FF">then 
         if </font><font color="#808080">(</font><font color="#000080">sacao </font><font color="#0000FF">.eq. </font><font color="#000080">opNovo</font><font color="#808080">) </font><font color="#0000FF">then
            </font><font color="#000080">tIdioma_codigo</font><font color="#808080">=</font><font color="#000080">pesqMaxCod</font><font color="#808080">(</font><font color="#000080">tfIdioma</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">, </font><font color="#000080">tamReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">))
            </font><font color="#0000FF">call </font><font color="#000080">mostrarDados</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#800000">''</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">)
            </font><font color="#0000FF">call </font><font color="#000080">subMenu</font><font color="#808080">(</font><font color="#FF0000">7</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">)
         </font><font color="#0000FF">else if </font><font color="#808080">(</font><font color="#000080">sacao </font><font color="#0000FF">.eq. </font><font color="#000080">opPesquisar</font><font color="#808080">) </font><font color="#0000FF">then
            </font><font color="#000080">slinha</font><font color="#808080">=</font><font color="#000080">validaEntrada</font><font color="#808080">(</font><font color="#000080">tfIdioma</font><font color="#808080">,</font><font color="#000080">sreg</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,
     *       </font><font color="#000080">tIdioma_codigo</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#0000FF">.false.</font><font color="#808080">,</font><font color="#000080">opNumero</font><font color="#808080">)
            </font><font color="#0000FF">if </font><font color="#808080">(</font><font color="#000080">slinha </font><font color="#0000FF">.ne. </font><font color="#800000">''</font><font color="#808080">) </font><font color="#0000FF">then 
              call </font><font color="#000080">mostrarDados</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#800000">''</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">)
              </font><font color="#0000FF">call </font><font color="#000080">mostrarDados</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">)
              </font><font color="#0000FF">call </font><font color="#000080">subMenu</font><font color="#808080">(</font><font color="#FF0000">8</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">)
            </font><font color="#0000FF">end if
         else if </font><font color="#808080">(</font><font color="#000080">sacao </font><font color="#0000FF">.eq. </font><font color="#000080">opAlterar</font><font color="#808080">) </font><font color="#0000FF">then
            call </font><font color="#000080">mostrarDados</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#800000">''</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">)
            </font><font color="#0000FF">call </font><font color="#000080">subMenu</font><font color="#808080">(</font><font color="#FF0000">9</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">)
         </font><font color="#0000FF">else if </font><font color="#808080">(</font><font color="#000080">sacao </font><font color="#0000FF">.eq. </font><font color="#000080">opExcluir</font><font color="#808080">) </font><font color="#0000FF">then
            call </font><font color="#000080">subMenu</font><font color="#808080">(</font><font color="#FF0000">10</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">)
         </font><font color="#0000FF">end if
      else if </font><font color="#808080">(</font><font color="#000080">sreg </font><font color="#0000FF">.eq. </font><font color="#000080">opPais</font><font color="#808080">) </font><font color="#0000FF">then 
         if </font><font color="#808080">(</font><font color="#000080">sacao </font><font color="#0000FF">.eq. </font><font color="#000080">opNovo</font><font color="#808080">) </font><font color="#0000FF">then
            write</font><font color="#808080">(*,*) </font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">)
            </font><font color="#0000FF">read</font><font color="#808080">(*,*) </font><font color="#000080">tPais_codigo
            slinha</font><font color="#808080">=</font><font color="#000080">pesqArq</font><font color="#808080">(</font><font color="#000080">tfPais</font><font color="#808080">, </font><font color="#000080">tPais_codigo</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">, </font><font color="#000080">tamReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">))
            </font><font color="#0000FF">if </font><font color="#808080">(</font><font color="#000080">slinha </font><font color="#0000FF">.eq. </font><font color="#800000">''</font><font color="#808080">) </font><font color="#0000FF">then 
               call </font><font color="#000080">pesqLinhaExcluida</font><font color="#808080">(</font><font color="#000080">tfPais</font><font color="#808080">, </font><font color="#000080">tamReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">))
               </font><font color="#0000FF">call </font><font color="#000080">mostrarDados</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#800000">''</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">)
               </font><font color="#0000FF">call </font><font color="#000080">subMenu</font><font color="#808080">(</font><font color="#FF0000">7</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">)
            </font><font color="#0000FF">else 
              write</font><font color="#808080">(*,*) </font><font color="#000080">MSG_REGEXST
            </font><font color="#0000FF">end if    
         else if </font><font color="#808080">(</font><font color="#000080">sacao </font><font color="#0000FF">.eq. </font><font color="#000080">opPesquisar</font><font color="#808080">) </font><font color="#0000FF">then
            </font><font color="#000080">slinha</font><font color="#808080">=</font><font color="#000080">validaEntrada</font><font color="#808080">(</font><font color="#000080">tfPais</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, 
     *       </font><font color="#000080">tPais_codigo</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#0000FF">.false.</font><font color="#808080">, </font><font color="#000080">opTexto</font><font color="#808080">)
            </font><font color="#0000FF">if </font><font color="#808080">(</font><font color="#000080">slinha </font><font color="#0000FF">.ne. </font><font color="#800000">''</font><font color="#808080">) </font><font color="#0000FF">then 
              call </font><font color="#000080">mostrarDados</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#800000">''</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">)
              </font><font color="#0000FF">call </font><font color="#000080">mostrarDados</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">)
              </font><font color="#0000FF">call </font><font color="#000080">subMenu</font><font color="#808080">(</font><font color="#FF0000">8</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">)
            </font><font color="#0000FF">end if
         else if </font><font color="#808080">(</font><font color="#000080">sacao </font><font color="#0000FF">.eq. </font><font color="#000080">opAlterar</font><font color="#808080">) </font><font color="#0000FF">then
            write</font><font color="#808080">(*,*) </font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">), </font><font color="#000080">tPais_codigo
            </font><font color="#0000FF">call </font><font color="#000080">mostrarDados</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#800000">''</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">)
            </font><font color="#0000FF">call </font><font color="#000080">subMenu</font><font color="#808080">(</font><font color="#FF0000">9</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">)
         </font><font color="#0000FF">else if </font><font color="#808080">(</font><font color="#000080">sacao </font><font color="#0000FF">.eq. </font><font color="#000080">opExcluir</font><font color="#808080">) </font><font color="#0000FF">then
            call </font><font color="#000080">subMenu</font><font color="#808080">(</font><font color="#FF0000">10</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">)
         </font><font color="#0000FF">end if
      else if </font><font color="#808080">(</font><font color="#000080">sreg </font><font color="#0000FF">.eq. </font><font color="#000080">opProfissao</font><font color="#808080">) </font><font color="#0000FF">then 
         if </font><font color="#808080">(</font><font color="#000080">sacao </font><font color="#0000FF">.eq. </font><font color="#000080">opNovo</font><font color="#808080">) </font><font color="#0000FF">then
            </font><font color="#000080">tProfissao_codigo</font><font color="#808080">=</font><font color="#000080">pesqMaxCod</font><font color="#808080">(</font><font color="#000080">tfProfissao</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">, 
     *       </font><font color="#000080">tamReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">))
            </font><font color="#0000FF">call </font><font color="#000080">mostrarDados</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#800000">''</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">)
            </font><font color="#0000FF">call </font><font color="#000080">subMenu</font><font color="#808080">(</font><font color="#FF0000">7</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">)
         </font><font color="#0000FF">else if </font><font color="#808080">(</font><font color="#000080">sacao </font><font color="#0000FF">.eq. </font><font color="#000080">opPesquisar</font><font color="#808080">) </font><font color="#0000FF">then
            </font><font color="#000080">slinha</font><font color="#808080">=</font><font color="#000080">validaEntrada</font><font color="#808080">(</font><font color="#000080">tfProfissao</font><font color="#808080">,</font><font color="#000080">sreg</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#000080">tProfissao_codigo</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,
     *               </font><font color="#0000FF">.false.</font><font color="#808080">,</font><font color="#000080">opNumero</font><font color="#808080">)
            </font><font color="#0000FF">if </font><font color="#808080">(</font><font color="#000080">slinha </font><font color="#0000FF">.ne. </font><font color="#800000">''</font><font color="#808080">) </font><font color="#0000FF">then 
              call </font><font color="#000080">mostrarDados</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#800000">''</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">)
              </font><font color="#0000FF">call </font><font color="#000080">mostrarDados</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">)
              </font><font color="#0000FF">call </font><font color="#000080">subMenu</font><font color="#808080">(</font><font color="#FF0000">8</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">)
            </font><font color="#0000FF">end if
         else if </font><font color="#808080">(</font><font color="#000080">sacao </font><font color="#0000FF">.eq. </font><font color="#000080">opAlterar</font><font color="#808080">) </font><font color="#0000FF">then
            call </font><font color="#000080">mostrarDados</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#800000">''</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">)
            </font><font color="#0000FF">call </font><font color="#000080">subMenu</font><font color="#808080">(</font><font color="#FF0000">9</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">)
         </font><font color="#0000FF">else if </font><font color="#808080">(</font><font color="#000080">sacao </font><font color="#0000FF">.eq. </font><font color="#000080">opExcluir</font><font color="#808080">) </font><font color="#0000FF">then
            call </font><font color="#000080">subMenu</font><font color="#808080">(</font><font color="#FF0000">10</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">)
         </font><font color="#0000FF">end if
      else if </font><font color="#808080">(</font><font color="#000080">sreg </font><font color="#0000FF">.eq. </font><font color="#000080">opLivro</font><font color="#808080">) </font><font color="#0000FF">then 
         if </font><font color="#808080">(</font><font color="#000080">sacao </font><font color="#0000FF">.eq. </font><font color="#000080">opNovo</font><font color="#808080">) </font><font color="#0000FF">then
            write</font><font color="#808080">(*,*) </font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">)
            </font><font color="#0000FF">read</font><font color="#808080">(*,*) </font><font color="#000080">tLivro_isbn
            </font><font color="#0000FF">if </font><font color="#808080">(</font><font color="#000080">validaISBN</font><font color="#808080">(</font><font color="#000080">tLivro_isbn</font><font color="#808080">) </font><font color="#000080">.eqv. </font><font color="#0000FF">.true.</font><font color="#808080">) </font><font color="#0000FF">then 
                </font><font color="#000080">slinha</font><font color="#808080">=</font><font color="#000080">pesqArq</font><font color="#808080">(</font><font color="#000080">tfLivro</font><font color="#808080">, </font><font color="#000080">tLivro_isbn</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">13</font><font color="#808080">,</font><font color="#000080">tamReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">))
                </font><font color="#0000FF">if </font><font color="#808080">(</font><font color="#000080">slinha </font><font color="#0000FF">.eq. </font><font color="#800000">''</font><font color="#808080">) </font><font color="#0000FF">then 
                   call </font><font color="#000080">pesqLinhaExcluida</font><font color="#808080">(</font><font color="#000080">tfLivro</font><font color="#808080">, </font><font color="#000080">tamReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">))
                   </font><font color="#0000FF">call </font><font color="#000080">mostrarDados</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#800000">''</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">)
                   </font><font color="#0000FF">call </font><font color="#000080">subMenu</font><font color="#808080">(</font><font color="#FF0000">7</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">)
                   </font><font color="#0000FF">call </font><font color="#000080">frmCadLigados</font><font color="#808080">(</font><font color="#000080">opLivroAss</font><font color="#808080">, </font><font color="#000080">opNovo</font><font color="#808080">, </font><font color="#000080">tLivro_isbn</font><font color="#808080">)
                   </font><font color="#0000FF">call </font><font color="#000080">frmCadLigados</font><font color="#808080">(</font><font color="#000080">opLivroAut</font><font color="#808080">, </font><font color="#000080">opNovo</font><font color="#808080">, </font><font color="#000080">tLivro_isbn</font><font color="#808080">)
                </font><font color="#0000FF">else 
                  write</font><font color="#808080">(*,*) </font><font color="#000080">MSG_REGEXST
                </font><font color="#0000FF">end if    
            else 
              write</font><font color="#808080">(*,*) </font><font color="#000080">MSG_ISBNINV
            </font><font color="#0000FF">end if
         else if </font><font color="#808080">(</font><font color="#000080">sacao </font><font color="#0000FF">.eq. </font><font color="#000080">opPesquisar</font><font color="#808080">) </font><font color="#0000FF">then
            </font><font color="#000080">slinha</font><font color="#808080">=</font><font color="#000080">validaEntrada</font><font color="#808080">(</font><font color="#000080">tfLivro</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, 
     *        </font><font color="#000080">tLivro_isbn</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#0000FF">.false.</font><font color="#808080">,</font><font color="#000080">opTexto</font><font color="#808080">)
            </font><font color="#0000FF">if </font><font color="#808080">(</font><font color="#000080">slinha </font><font color="#0000FF">.ne. </font><font color="#800000">''</font><font color="#808080">) </font><font color="#0000FF">then 
               call </font><font color="#000080">mostrarDados</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#800000">''</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">)
               </font><font color="#0000FF">call </font><font color="#000080">mostrarDados</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">)
               </font><font color="#0000FF">call </font><font color="#000080">subMenu</font><font color="#808080">(</font><font color="#FF0000">8</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">)
            </font><font color="#0000FF">end if
         else if </font><font color="#808080">(</font><font color="#000080">sacao </font><font color="#0000FF">.eq. </font><font color="#000080">opAlterar</font><font color="#808080">) </font><font color="#0000FF">then
            write</font><font color="#808080">(*,*) </font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">), </font><font color="#000080">tLivro_isbn
            </font><font color="#0000FF">call </font><font color="#000080">mostrarDados</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#800000">''</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">)
            </font><font color="#0000FF">call </font><font color="#000080">subMenu</font><font color="#808080">(</font><font color="#FF0000">9</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">)
            </font><font color="#0000FF">call </font><font color="#000080">frmCadLigados</font><font color="#808080">(</font><font color="#000080">opLivroAss</font><font color="#808080">, </font><font color="#000080">opExcluir</font><font color="#808080">, </font><font color="#000080">tLivro_isbn</font><font color="#808080">)
            </font><font color="#0000FF">write</font><font color="#808080">(*,*) </font><font color="#800000">'Assuntos dos livros exclu&iacute;dos, inclua novos!'
            </font><font color="#0000FF">call </font><font color="#000080">frmCadLigados</font><font color="#808080">(</font><font color="#000080">opLivroAss</font><font color="#808080">, </font><font color="#000080">opNovo</font><font color="#808080">, </font><font color="#000080">tLivro_isbn</font><font color="#808080">)
            </font><font color="#0000FF">call </font><font color="#000080">frmCadLigados</font><font color="#808080">(</font><font color="#000080">opLivroAut</font><font color="#808080">, </font><font color="#000080">opExcluir</font><font color="#808080">, </font><font color="#000080">tLivro_isbn</font><font color="#808080">)
            </font><font color="#0000FF">write</font><font color="#808080">(*,*) </font><font color="#800000">'Autores dos livros exclu&iacute;dos, inclua novos!'
            </font><font color="#0000FF">call </font><font color="#000080">frmCadLigados</font><font color="#808080">(</font><font color="#000080">opLivroAut</font><font color="#808080">, </font><font color="#000080">opNovo</font><font color="#808080">, </font><font color="#000080">tLivro_isbn</font><font color="#808080">)
         </font><font color="#0000FF">else if </font><font color="#808080">(</font><font color="#000080">sacao </font><font color="#0000FF">.eq. </font><font color="#000080">opExcluir</font><font color="#808080">) </font><font color="#0000FF">then
            call </font><font color="#000080">subMenu</font><font color="#808080">(</font><font color="#FF0000">10</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">)
            </font><font color="#0000FF">write</font><font color="#808080">(*,*) </font><font color="#800000">'Assuntos dos livros sendo exclu&iacute;dos!'
            </font><font color="#0000FF">call </font><font color="#000080">frmCadLigados</font><font color="#808080">(</font><font color="#000080">opLivroAss</font><font color="#808080">, </font><font color="#000080">opExcluir</font><font color="#808080">, </font><font color="#000080">tLivro_isbn</font><font color="#808080">)
            </font><font color="#0000FF">write</font><font color="#808080">(*,*) </font><font color="#800000">'Autores dos livros sendo exclu&iacute;dos!'
            </font><font color="#0000FF">call </font><font color="#000080">frmCadLigados</font><font color="#808080">(</font><font color="#000080">opLivroAut</font><font color="#808080">, </font><font color="#000080">opExcluir</font><font color="#808080">, </font><font color="#000080">tLivro_isbn</font><font color="#808080">)
         </font><font color="#0000FF">end if
      else if </font><font color="#808080">(</font><font color="#000080">sreg </font><font color="#0000FF">.eq. </font><font color="#000080">opCliente</font><font color="#808080">) </font><font color="#0000FF">then 
         if </font><font color="#808080">(</font><font color="#000080">sacao </font><font color="#0000FF">.eq. </font><font color="#000080">opNovo</font><font color="#808080">) </font><font color="#0000FF">then
            write</font><font color="#808080">(*,*) </font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">)
            </font><font color="#0000FF">read</font><font color="#808080">(*,*) </font><font color="#000080">tCliente_cpf
            </font><font color="#0000FF">if </font><font color="#808080">(</font><font color="#000080">validaCPF</font><font color="#808080">(</font><font color="#000080">tCliente_cpf</font><font color="#808080">) </font><font color="#000080">.eqv. </font><font color="#0000FF">.true.</font><font color="#808080">) </font><font color="#0000FF">then 
                </font><font color="#000080">slinha</font><font color="#808080">=</font><font color="#000080">pesqArq</font><font color="#808080">(</font><font color="#000080">tfCliente</font><font color="#808080">, </font><font color="#000080">tCliente_cpf</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">14</font><font color="#808080">, 
     *           </font><font color="#000080">tamReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">))
                </font><font color="#0000FF">if </font><font color="#808080">(</font><font color="#000080">slinha </font><font color="#0000FF">.eq. </font><font color="#800000">''</font><font color="#808080">) </font><font color="#0000FF">then 
                   call </font><font color="#000080">pesqLinhaExcluida</font><font color="#808080">(</font><font color="#000080">tfCliente</font><font color="#808080">, </font><font color="#000080">tamReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">))
                   </font><font color="#0000FF">call </font><font color="#000080">mostrarDados</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#800000">''</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">)
                   </font><font color="#0000FF">call </font><font color="#000080">subMenu</font><font color="#808080">(</font><font color="#FF0000">7</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">)
                </font><font color="#0000FF">else 
                  write</font><font color="#808080">(*,*) </font><font color="#000080">MSG_REGEXST
                </font><font color="#0000FF">end if
            else 
              write</font><font color="#808080">(*,*) </font><font color="#000080">MSG_CPFINV
            </font><font color="#0000FF">end if
         else if </font><font color="#808080">(</font><font color="#000080">sacao </font><font color="#0000FF">.eq. </font><font color="#000080">opPesquisar</font><font color="#808080">) </font><font color="#0000FF">then
            </font><font color="#000080">slinha</font><font color="#808080">=</font><font color="#000080">validaEntrada</font><font color="#808080">(</font><font color="#000080">tfCliente</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, 
     *       </font><font color="#000080">tCliente_cpf</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#0000FF">.false.</font><font color="#808080">,</font><font color="#000080">opTexto</font><font color="#808080">)
            </font><font color="#0000FF">if </font><font color="#808080">(</font><font color="#000080">slinha </font><font color="#0000FF">.ne. </font><font color="#800000">''</font><font color="#808080">) </font><font color="#0000FF">then 
               call </font><font color="#000080">mostrarDados</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#800000">''</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">)
               </font><font color="#0000FF">call </font><font color="#000080">mostrarDados</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">)
               </font><font color="#0000FF">call </font><font color="#000080">subMenu</font><font color="#808080">(</font><font color="#FF0000">8</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">)
            </font><font color="#0000FF">end if
         else if </font><font color="#808080">(</font><font color="#000080">sacao </font><font color="#0000FF">.eq. </font><font color="#000080">opAlterar</font><font color="#808080">) </font><font color="#0000FF">then
            write</font><font color="#808080">(*,*) </font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">), </font><font color="#000080">tCliente_cpf
            </font><font color="#0000FF">call </font><font color="#000080">mostrarDados</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#800000">''</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">)
            </font><font color="#0000FF">call </font><font color="#000080">subMenu</font><font color="#808080">(</font><font color="#FF0000">9</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">)
         </font><font color="#0000FF">else if </font><font color="#808080">(</font><font color="#000080">sacao </font><font color="#0000FF">.eq. </font><font color="#000080">opExcluir</font><font color="#808080">) </font><font color="#0000FF">then
            call </font><font color="#000080">subMenu</font><font color="#808080">(</font><font color="#FF0000">10</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">)
         </font><font color="#0000FF">end if
      else if </font><font color="#808080">(</font><font color="#000080">sreg </font><font color="#0000FF">.eq. </font><font color="#000080">opVenda</font><font color="#808080">) </font><font color="#0000FF">then 
         if </font><font color="#808080">(</font><font color="#000080">sacao </font><font color="#0000FF">.eq. </font><font color="#000080">opNovo</font><font color="#808080">) </font><font color="#0000FF">then
            </font><font color="#000080">tVenda_dthrvenda</font><font color="#808080">=</font><font color="#000080">retDataHora</font><font color="#808080">()
            </font><font color="#0000FF">write</font><font color="#808080">(*,*) </font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">), </font><font color="#000080">tVenda_dthrvenda
            slinha</font><font color="#808080">=</font><font color="#000080">pesqArq</font><font color="#808080">(</font><font color="#000080">tfVenda</font><font color="#808080">, </font><font color="#000080">tVenda_dthrvenda</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">19</font><font color="#808080">, 
     *       </font><font color="#000080">tamReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">))
            </font><font color="#0000FF">if </font><font color="#808080">(</font><font color="#000080">slinha </font><font color="#0000FF">.eq. </font><font color="#800000">''</font><font color="#808080">) </font><font color="#0000FF">then 
               </font><font color="#000080">slinha</font><font color="#808080">=</font><font color="#000080">validaEntrada</font><font color="#808080">(</font><font color="#000080">tfCliente</font><font color="#808080">,</font><font color="#000080">opCliente</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#000080">tVenda_cpf</font><font color="#808080">,</font><font color="#FF0000">3</font><font color="#808080">,
     *                  </font><font color="#0000FF">.false.</font><font color="#808080">,</font><font color="#000080">opTexto</font><font color="#808080">)
               </font><font color="#0000FF">if </font><font color="#808080">(</font><font color="#000080">slinha </font><font color="#0000FF">.ne. </font><font color="#800000">''</font><font color="#808080">) </font><font color="#0000FF">then 
                  </font><font color="#000080">tVenda_cpf</font><font color="#808080">=</font><font color="#000080">ftrim</font><font color="#808080">(</font><font color="#000080">copy</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#FF0000">14</font><font color="#808080">))
                  </font><font color="#0000FF">if </font><font color="#808080">(</font><font color="#000080">validaCPF</font><font color="#808080">(</font><font color="#000080">tVenda_cpf</font><font color="#808080">) </font><font color="#000080">.eqv. </font><font color="#0000FF">.true.</font><font color="#808080">) </font><font color="#0000FF">then 
                     write</font><font color="#808080">(*,*) </font><font color="#800000">' '</font><font color="#808080">,</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">opCliente</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">)
                     </font><font color="#0000FF">write</font><font color="#808080">(*,*) </font><font color="#000080">copy</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#000080">g_nPosChave</font><font color="#808080">, </font><font color="#000080">g_nTamChave</font><font color="#808080">)
                     </font><font color="#0000FF">call </font><font color="#000080">frmCadLigados</font><font color="#808080">(</font><font color="#000080">opVenda</font><font color="#808080">, </font><font color="#000080">opNovo</font><font color="#808080">, </font><font color="#000080">tVenda_cpf</font><font color="#808080">)
                  </font><font color="#0000FF">else 
                    write</font><font color="#808080">(*,*) </font><font color="#000080">MSG_CPFINV
                  </font><font color="#0000FF">end if
               end if
            else 
              write</font><font color="#808080">(*,*) </font><font color="#000080">MSG_REGEXST
            </font><font color="#0000FF">end if
         else if </font><font color="#808080">(</font><font color="#000080">sacao </font><font color="#0000FF">.eq. </font><font color="#000080">opPesquisar</font><font color="#808080">) </font><font color="#0000FF">then
            </font><font color="#000080">slinha</font><font color="#808080">=</font><font color="#000080">validaEntrada</font><font color="#808080">(</font><font color="#000080">tfVenda</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#000080">tVenda_dthrvenda</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,
     *               </font><font color="#0000FF">.false.</font><font color="#808080">,</font><font color="#000080">opDataHora</font><font color="#808080">)
            </font><font color="#0000FF">if </font><font color="#808080">(</font><font color="#000080">slinha </font><font color="#0000FF">.ne. </font><font color="#800000">''</font><font color="#808080">) </font><font color="#0000FF">then 
              call </font><font color="#000080">mostrarDados</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#800000">''</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">)
              </font><font color="#0000FF">call </font><font color="#000080">mostrarDados</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">)
              </font><font color="#0000FF">call </font><font color="#000080">subMenu</font><font color="#808080">(</font><font color="#FF0000">8</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">)
            </font><font color="#0000FF">end if
         end if
      end if
      return
      end
</font><font color="#808080"><i>C     ------------------------------------------------------------------
C     Realiza as consultas de acordo com o tipo de arquivo.
C     sreg - o tipo de arquivo
C     sacao - a a&ccedil;&atilde;o a ser realizada
C     ------------------------------------------------------------------
      </i></font><font color="#0000FF">subroutine </font><font color="#000080">frmConsultas</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#000080">sacao</font><font color="#808080">)
      </font><font color="#0000FF">integer </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#000080">sacao

      </font><font color="#0000FF">include </font><font color="#800000">'livrus.h' 
      </font><font color="#0000FF">character</font><font color="#808080">*</font><font color="#FF0000">255 </font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#000080">validaEntrada</font><font color="#808080">, </font><font color="#000080">rotulo
      </font><font color="#0000FF">logical </font><font color="#000080">ListarTodos
      </font><font color="#0000FF">integer </font><font color="#000080">tamReg

      </font><font color="#0000FF">if </font><font color="#808080">(</font><font color="#000080">sreg </font><font color="#0000FF">.eq. </font><font color="#000080">opAssunto</font><font color="#808080">) </font><font color="#0000FF">then
         if </font><font color="#808080">(</font><font color="#000080">sacao </font><font color="#0000FF">.eq. </font><font color="#000080">opPesquisar</font><font color="#808080">) </font><font color="#0000FF">then
            </font><font color="#000080">slinha</font><font color="#808080">=</font><font color="#000080">validaEntrada</font><font color="#808080">(</font><font color="#000080">tfAssunto</font><font color="#808080">,</font><font color="#000080">sreg</font><font color="#808080">,</font><font color="#FF0000">2</font><font color="#808080">,
     *       </font><font color="#000080">tAssunto_assunto</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#0000FF">.true.</font><font color="#808080">,</font><font color="#000080">opTexto</font><font color="#808080">)
         </font><font color="#0000FF">else if </font><font color="#808080">(</font><font color="#000080">sacao </font><font color="#0000FF">.eq. </font><font color="#000080">opListarTodos</font><font color="#808080">) </font><font color="#0000FF">then
            if </font><font color="#808080">(</font><font color="#000080">ListarTodos</font><font color="#808080">(</font><font color="#000080">tfAssunto</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#800000">''</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#000080">tamReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">),
     *         </font><font color="#000080">QTD_MAX_LINHA</font><font color="#808080">, </font><font color="#0000FF">.false.</font><font color="#808080">) </font><font color="#000080">.eqv. </font><font color="#0000FF">.false.</font><font color="#808080">) </font><font color="#0000FF">then
              write</font><font color="#808080">(*,*) </font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">)
            </font><font color="#0000FF">end if
         end if
      else if </font><font color="#808080">(</font><font color="#000080">sreg </font><font color="#0000FF">.eq. </font><font color="#000080">opAutor</font><font color="#808080">) </font><font color="#0000FF">then
         if </font><font color="#808080">(</font><font color="#000080">sacao </font><font color="#0000FF">.eq. </font><font color="#000080">opPesquisar</font><font color="#808080">) </font><font color="#0000FF">then
            </font><font color="#000080">slinha</font><font color="#808080">=</font><font color="#000080">validaEntrada</font><font color="#808080">(</font><font color="#000080">tfAutor</font><font color="#808080">,</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">, 
     *       </font><font color="#000080">tAutor_autor</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#0000FF">.true.</font><font color="#808080">,</font><font color="#000080">opTexto</font><font color="#808080">)
         </font><font color="#0000FF">else if </font><font color="#808080">(</font><font color="#000080">sacao </font><font color="#0000FF">.eq. </font><font color="#000080">opListarTodos</font><font color="#808080">) </font><font color="#0000FF">then
            if </font><font color="#808080">(</font><font color="#000080">ListarTodos</font><font color="#808080">(</font><font color="#000080">tfAutor</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#800000">''</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#000080">tamReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">),
     *         </font><font color="#000080">QTD_MAX_LINHA</font><font color="#808080">, </font><font color="#0000FF">.false.</font><font color="#808080">) </font><font color="#000080">.eqv. </font><font color="#0000FF">.false.</font><font color="#808080">) </font><font color="#0000FF">then
              write</font><font color="#808080">(*,*) </font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">)
            </font><font color="#0000FF">end if
         end if
      else if </font><font color="#808080">(</font><font color="#000080">sreg </font><font color="#0000FF">.eq. </font><font color="#000080">opEditora</font><font color="#808080">) </font><font color="#0000FF">then
         if </font><font color="#808080">(</font><font color="#000080">sacao </font><font color="#0000FF">.eq. </font><font color="#000080">opPesquisar</font><font color="#808080">) </font><font color="#0000FF">then
            </font><font color="#000080">slinha</font><font color="#808080">=</font><font color="#000080">validaEntrada</font><font color="#808080">(</font><font color="#000080">tfEditora</font><font color="#808080">,</font><font color="#000080">sreg</font><font color="#808080">,</font><font color="#FF0000">2</font><font color="#808080">,</font><font color="#000080">tEditora_editora</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,
     *       </font><font color="#0000FF">.true.</font><font color="#808080">,</font><font color="#000080">opTexto</font><font color="#808080">)
         </font><font color="#0000FF">else if </font><font color="#808080">(</font><font color="#000080">sacao </font><font color="#0000FF">.eq. </font><font color="#000080">opListarTodos</font><font color="#808080">) </font><font color="#0000FF">then
            if </font><font color="#808080">(</font><font color="#000080">ListarTodos</font><font color="#808080">(</font><font color="#000080">tfEditora</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#800000">''</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#000080">tamReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">),
     *         </font><font color="#000080">QTD_MAX_LINHA</font><font color="#808080">, </font><font color="#0000FF">.false.</font><font color="#808080">) </font><font color="#000080">.eqv. </font><font color="#0000FF">.false.</font><font color="#808080">) </font><font color="#0000FF">then
              write</font><font color="#808080">(*,*) </font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">)
            </font><font color="#0000FF">end if
         end if
      else if </font><font color="#808080">(</font><font color="#000080">sreg </font><font color="#0000FF">.eq. </font><font color="#000080">opEndereco</font><font color="#808080">) </font><font color="#0000FF">then
         if </font><font color="#808080">(</font><font color="#000080">sacao </font><font color="#0000FF">.eq. </font><font color="#000080">opPesquisar</font><font color="#808080">) </font><font color="#0000FF">then
            </font><font color="#000080">slinha</font><font color="#808080">=</font><font color="#000080">validaEntrada</font><font color="#808080">(</font><font color="#000080">tfEndereco</font><font color="#808080">,</font><font color="#000080">sreg</font><font color="#808080">,</font><font color="#FF0000">2</font><font color="#808080">,</font><font color="#000080">tEndereco_Logradouro</font><font color="#808080">,
     *         </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#0000FF">.true.</font><font color="#808080">,</font><font color="#000080">opTexto</font><font color="#808080">)
         </font><font color="#0000FF">else if </font><font color="#808080">(</font><font color="#000080">sacao </font><font color="#0000FF">.eq. </font><font color="#000080">opListarTodos</font><font color="#808080">) </font><font color="#0000FF">then
            if </font><font color="#808080">(</font><font color="#000080">ListarTodos</font><font color="#808080">(</font><font color="#000080">tfEndereco</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#800000">''</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#000080">tamReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">),
     *          </font><font color="#FF0000">3</font><font color="#808080">, </font><font color="#0000FF">.false.</font><font color="#808080">) </font><font color="#000080">.eqv. </font><font color="#0000FF">.false.</font><font color="#808080">) </font><font color="#0000FF">then
              write</font><font color="#808080">(*,*) </font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">)
            </font><font color="#0000FF">end if
         end if
      else if </font><font color="#808080">(</font><font color="#000080">sreg </font><font color="#0000FF">.eq. </font><font color="#000080">opIdioma</font><font color="#808080">) </font><font color="#0000FF">then
         if </font><font color="#808080">(</font><font color="#000080">sacao </font><font color="#0000FF">.eq. </font><font color="#000080">opPesquisar</font><font color="#808080">) </font><font color="#0000FF">then
            </font><font color="#000080">slinha</font><font color="#808080">=</font><font color="#000080">validaEntrada</font><font color="#808080">(</font><font color="#000080">tfIdioma</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">, </font><font color="#000080">tIdioma_idioma</font><font color="#808080">,
     *       </font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#0000FF">.true.</font><font color="#808080">,</font><font color="#000080">opTexto</font><font color="#808080">)
         </font><font color="#0000FF">else if </font><font color="#808080">(</font><font color="#000080">sacao </font><font color="#0000FF">.eq. </font><font color="#000080">opListarTodos</font><font color="#808080">) </font><font color="#0000FF">then
            if </font><font color="#808080">(</font><font color="#000080">ListarTodos</font><font color="#808080">(</font><font color="#000080">tfIdioma</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#800000">''</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#000080">tamReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">),
     *        </font><font color="#000080">QTD_MAX_LINHA</font><font color="#808080">, </font><font color="#0000FF">.false.</font><font color="#808080">) </font><font color="#000080">.eqv. </font><font color="#0000FF">.false.</font><font color="#808080">) </font><font color="#0000FF">then
              write</font><font color="#808080">(*,*) </font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">)
            </font><font color="#0000FF">end if
         end if
      else if </font><font color="#808080">(</font><font color="#000080">sreg </font><font color="#0000FF">.eq. </font><font color="#000080">opPais</font><font color="#808080">) </font><font color="#0000FF">then
         if </font><font color="#808080">(</font><font color="#000080">sacao </font><font color="#0000FF">.eq. </font><font color="#000080">opPesquisar</font><font color="#808080">) </font><font color="#0000FF">then
            </font><font color="#000080">slinha</font><font color="#808080">=</font><font color="#000080">validaEntrada</font><font color="#808080">(</font><font color="#000080">tfPais</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">, </font><font color="#000080">tPais_pais</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, 
     *       </font><font color="#0000FF">.true.</font><font color="#808080">,</font><font color="#000080">opTexto</font><font color="#808080">)
         </font><font color="#0000FF">else if </font><font color="#808080">(</font><font color="#000080">sacao </font><font color="#0000FF">.eq. </font><font color="#000080">opListarTodos</font><font color="#808080">) </font><font color="#0000FF">then
            if </font><font color="#808080">(</font><font color="#000080">ListarTodos</font><font color="#808080">(</font><font color="#000080">tfPais</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#800000">''</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#000080">tamReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">),
     *        </font><font color="#000080">QTD_MAX_LINHA</font><font color="#808080">, </font><font color="#0000FF">.false.</font><font color="#808080">) </font><font color="#000080">.eqv. </font><font color="#0000FF">.false.</font><font color="#808080">) </font><font color="#0000FF">then
              write</font><font color="#808080">(*,*) </font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">)
            </font><font color="#0000FF">end if
         end if
      else if </font><font color="#808080">(</font><font color="#000080">sreg </font><font color="#0000FF">.eq. </font><font color="#000080">opProfissao</font><font color="#808080">) </font><font color="#0000FF">then
         if </font><font color="#808080">(</font><font color="#000080">sacao </font><font color="#0000FF">.eq. </font><font color="#000080">opPesquisar</font><font color="#808080">) </font><font color="#0000FF">then
           </font><font color="#000080">slinha</font><font color="#808080">=</font><font color="#000080">validaEntrada</font><font color="#808080">(</font><font color="#000080">tfProfissao</font><font color="#808080">,</font><font color="#000080">sreg</font><font color="#808080">,</font><font color="#FF0000">2</font><font color="#808080">,
     *      </font><font color="#000080">tProfissao_profissao</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#0000FF">.true.</font><font color="#808080">,</font><font color="#000080">opTexto</font><font color="#808080">)
         </font><font color="#0000FF">else if </font><font color="#808080">(</font><font color="#000080">sacao </font><font color="#0000FF">.eq. </font><font color="#000080">opListarTodos</font><font color="#808080">) </font><font color="#0000FF">then
            if </font><font color="#808080">(</font><font color="#000080">ListarTodos</font><font color="#808080">(</font><font color="#000080">tfProfissao</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#800000">''</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#000080">tamReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">),
     *        </font><font color="#000080">QTD_MAX_LINHA</font><font color="#808080">, </font><font color="#0000FF">.false.</font><font color="#808080">) </font><font color="#000080">.eqv. </font><font color="#0000FF">.false.</font><font color="#808080">) </font><font color="#0000FF">then
              write</font><font color="#808080">(*,*) </font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">)
            </font><font color="#0000FF">end if
         end if
      else if </font><font color="#808080">(</font><font color="#000080">sreg </font><font color="#0000FF">.eq. </font><font color="#000080">opLivro</font><font color="#808080">) </font><font color="#0000FF">then
         if </font><font color="#808080">(</font><font color="#000080">sacao </font><font color="#0000FF">.eq. </font><font color="#000080">opPesquisar</font><font color="#808080">) </font><font color="#0000FF">then
            </font><font color="#000080">slinha</font><font color="#808080">=</font><font color="#000080">validaEntrada</font><font color="#808080">(</font><font color="#000080">tfLivro</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">, 
     *       </font><font color="#000080">tLivro_titulo</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#0000FF">.true.</font><font color="#808080">,</font><font color="#000080">opTexto</font><font color="#808080">)
         </font><font color="#0000FF">else if </font><font color="#808080">(</font><font color="#000080">sacao </font><font color="#0000FF">.eq. </font><font color="#000080">opListarTodos</font><font color="#808080">) </font><font color="#0000FF">then
            if </font><font color="#808080">(</font><font color="#000080">ListarTodos</font><font color="#808080">(</font><font color="#000080">tfLivro</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#800000">''</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#000080">tamReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">),
     *         </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#0000FF">.false.</font><font color="#808080">) </font><font color="#000080">.eqv. </font><font color="#0000FF">.false.</font><font color="#808080">) </font><font color="#0000FF">then
              write</font><font color="#808080">(*,*) </font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">)
            </font><font color="#0000FF">end if
         end if
      else if </font><font color="#808080">(</font><font color="#000080">sreg </font><font color="#0000FF">.eq. </font><font color="#000080">opCliente</font><font color="#808080">) </font><font color="#0000FF">then
         if </font><font color="#808080">(</font><font color="#000080">sacao </font><font color="#0000FF">.eq. </font><font color="#000080">opPesquisar</font><font color="#808080">) </font><font color="#0000FF">then
            </font><font color="#000080">slinha</font><font color="#808080">=</font><font color="#000080">validaEntrada</font><font color="#808080">(</font><font color="#000080">tfCliente</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">, </font><font color="#000080">tCliente_nome</font><font color="#808080">,
     *       </font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#0000FF">.true.</font><font color="#808080">,</font><font color="#000080">opTexto</font><font color="#808080">)
         </font><font color="#0000FF">else if </font><font color="#808080">(</font><font color="#000080">sacao </font><font color="#0000FF">.eq. </font><font color="#000080">opListarTodos</font><font color="#808080">) </font><font color="#0000FF">then
            if </font><font color="#808080">(</font><font color="#000080">ListarTodos</font><font color="#808080">(</font><font color="#000080">tfCliente</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#800000">''</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#000080">tamReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">),
     *         </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#0000FF">.false.</font><font color="#808080">) </font><font color="#000080">.eqv. </font><font color="#0000FF">.false.</font><font color="#808080">) </font><font color="#0000FF">then
              write</font><font color="#808080">(*,*) </font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">)
            </font><font color="#0000FF">end if
         end if
      else if </font><font color="#808080">(</font><font color="#000080">sreg </font><font color="#0000FF">.eq. </font><font color="#000080">opVenda</font><font color="#808080">) </font><font color="#0000FF">then
         if </font><font color="#808080">(</font><font color="#000080">sacao </font><font color="#0000FF">.eq. </font><font color="#000080">opPesquisar</font><font color="#808080">) </font><font color="#0000FF">then
            </font><font color="#000080">slinha</font><font color="#808080">=</font><font color="#000080">validaEntrada</font><font color="#808080">(</font><font color="#000080">tfVenda</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">, </font><font color="#000080">tVenda_cpf</font><font color="#808080">, 
     *       </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#0000FF">.true.</font><font color="#808080">,</font><font color="#000080">opTexto</font><font color="#808080">)
         </font><font color="#0000FF">else if </font><font color="#808080">(</font><font color="#000080">sacao </font><font color="#0000FF">.eq. </font><font color="#000080">opListarTodos</font><font color="#808080">) </font><font color="#0000FF">then
            if </font><font color="#808080">(</font><font color="#000080">ListarTodos</font><font color="#808080">(</font><font color="#000080">tfVenda</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#800000">''</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#000080">tamReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">),
     *         </font><font color="#000080">QTD_MAX_LINHA</font><font color="#808080">, </font><font color="#0000FF">.false.</font><font color="#808080">) </font><font color="#000080">.eqv. </font><font color="#0000FF">.false.</font><font color="#808080">) </font><font color="#0000FF">then
              write</font><font color="#808080">(*,*) </font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">)
            </font><font color="#0000FF">end if
         end if
      end if
      if </font><font color="#808080">(</font><font color="#000080">slinha </font><font color="#0000FF">.eq. </font><font color="#800000">''</font><font color="#808080">) </font><font color="#0000FF">then
         write</font><font color="#808080">(*,*) </font><font color="#800000">''
      </font><font color="#0000FF">end if
      return
      end
</font><font color="#808080"><i>C     ------------------------------------------------------------------
C     Mostra a tela de altera&ccedil;&atilde;o de senha do sistema e realiza a altera&ccedil;&atilde;o.
C     ------------------------------------------------------------------
      </i></font><font color="#0000FF">subroutine </font><font color="#000080">frmAlterarSenha</font><font color="#808080">()

      </font><font color="#0000FF">include </font><font color="#800000">'livrus.h'
      </font><font color="#0000FF">logical </font><font color="#000080">bQuebra
      </font><font color="#0000FF">character</font><font color="#808080">*</font><font color="#FF0000">255 </font><font color="#000080">sres</font><font color="#808080">, </font><font color="#000080">sSenhaAtual</font><font color="#808080">, </font><font color="#000080">sNovaSenha</font><font color="#808080">, </font><font color="#000080">sConfirmaSenha</font><font color="#808080">, 
     * </font><font color="#000080">digitaSenha</font><font color="#808080">, </font><font color="#000080">pesqArq</font><font color="#808080">, </font><font color="#000080">rotulo
      </font><font color="#0000FF">integer </font><font color="#000080">nopcao</font><font color="#808080">, </font><font color="#000080">tamReg

      </font><font color="#0000FF">write</font><font color="#808080">(*,*) </font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">opUsuario</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">), </font><font color="#000080">tUsuario_login
      nopcao</font><font color="#808080">=</font><font color="#FF0000">1
      </font><font color="#000080">bQuebra</font><font color="#808080">=</font><font color="#0000FF">.false.
      do while </font><font color="#808080">(</font><font color="#000080">bQuebra .eqv. </font><font color="#0000FF">.false.</font><font color="#808080">)
        </font><font color="#0000FF">select case </font><font color="#808080">(</font><font color="#000080">nopcao</font><font color="#808080">)
          </font><font color="#0000FF">case </font><font color="#808080">(</font><font color="#FF0000">1</font><font color="#808080">)
             </font><font color="#000080">sSenhaAtual</font><font color="#808080">=</font><font color="#000080">digitaSenha</font><font color="#808080">(</font><font color="#800000">'Senha Atual: '</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">)
             </font><font color="#0000FF">if </font><font color="#808080">(</font><font color="#000080">sSenhaAtual </font><font color="#0000FF">.ne. </font><font color="#000080">tUsuario_senha</font><font color="#808080">) </font><font color="#0000FF">then
                write</font><font color="#808080">(*,*) </font><font color="#000080">MSG_SENCONFERE
                bQuebra</font><font color="#808080">=</font><font color="#0000FF">.true.
             else 
                </font><font color="#000080">nopcao</font><font color="#808080">=</font><font color="#FF0000">2
             </font><font color="#0000FF">end if
          case </font><font color="#808080">(</font><font color="#FF0000">2</font><font color="#808080">)
             </font><font color="#000080">sNovaSenha</font><font color="#808080">=</font><font color="#000080">digitaSenha</font><font color="#808080">(</font><font color="#800000">'Nova Senha: '</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">)
             </font><font color="#000080">sConfirmaSenha</font><font color="#808080">=</font><font color="#000080">digitaSenha</font><font color="#808080">(</font><font color="#800000">'Confirma Senha: '</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">)
             </font><font color="#0000FF">if </font><font color="#808080">(</font><font color="#000080">sNovaSenha </font><font color="#0000FF">.ne. </font><font color="#000080">sConfirmaSenha</font><font color="#808080">) </font><font color="#0000FF">then
                write</font><font color="#808080">(*,*) </font><font color="#000080">MSG_SENCONFIRM
                bQuebra</font><font color="#808080">=</font><font color="#0000FF">.true.
             else 
                </font><font color="#000080">nopcao</font><font color="#808080">=</font><font color="#FF0000">3
             </font><font color="#0000FF">end if
         case </font><font color="#808080">(</font><font color="#FF0000">3</font><font color="#808080">)
             </font><font color="#000080">sres</font><font color="#808080">=</font><font color="#000080">pesqArq</font><font color="#808080">(</font><font color="#000080">tfUsuario</font><font color="#808080">, </font><font color="#000080">tUsuario_login</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">, 
     *        </font><font color="#000080">tamReg</font><font color="#808080">(</font><font color="#000080">opUsuario</font><font color="#808080">))
             </font><font color="#0000FF">if </font><font color="#808080">(</font><font color="#000080">sres </font><font color="#0000FF">.eq. </font><font color="#800000">''</font><font color="#808080">) </font><font color="#0000FF">then
               write</font><font color="#808080">(*,*) </font><font color="#000080">MSG_LOGINENCON
             </font><font color="#0000FF">else
               </font><font color="#000080">tUsuario_senha</font><font color="#808080">=</font><font color="#000080">sConfirmaSenha
               </font><font color="#0000FF">call </font><font color="#000080">subMenu</font><font color="#808080">(</font><font color="#FF0000">9</font><font color="#808080">,</font><font color="#000080">opUsuario</font><font color="#808080">)
               </font><font color="#000080">bQuebra</font><font color="#808080">=</font><font color="#0000FF">.true.
             end if
        end select
      end do
      return
      end
</font><font color="#808080"><i>C     ------------------------------------------------------------------
C     Executa uma a&ccedil;&atilde;o de grava&ccedil;&atilde;o de acordo com o tipo de arquivo.
C     sreg - o tipo de arquivo
C     sacao - a a&ccedil;&atilde;o a ser realizada
C     ------------------------------------------------------------------
      </i></font><font color="#0000FF">subroutine </font><font color="#000080">btnAcao</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#000080">sacao</font><font color="#808080">)
      </font><font color="#0000FF">integer </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#000080">sacao

      </font><font color="#0000FF">include </font><font color="#800000">'livrus.h'
      </font><font color="#0000FF">integer </font><font color="#000080">tamReg
      </font><font color="#0000FF">character</font><font color="#808080">*</font><font color="#FF0000">255 </font><font color="#000080">LinhaReg</font><font color="#808080">, </font><font color="#000080">repete

      </font><font color="#0000FF">if </font><font color="#808080">(</font><font color="#000080">sreg </font><font color="#0000FF">.eq. </font><font color="#000080">opAssunto</font><font color="#808080">) </font><font color="#0000FF">then
         if </font><font color="#808080">(</font><font color="#000080">sacao </font><font color="#0000FF">.eq. </font><font color="#000080">opSalvarInclusao</font><font color="#808080">) </font><font color="#0000FF">then
           call </font><font color="#000080">escreveArq</font><font color="#808080">(</font><font color="#000080">tfAssunto</font><font color="#808080">, </font><font color="#000080">LinhaReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">), </font><font color="#000080">MSG_REGINC</font><font color="#808080">, 
     *      </font><font color="#000080">MSG_REGNINC</font><font color="#808080">)
         </font><font color="#0000FF">else if </font><font color="#808080">(</font><font color="#000080">sacao </font><font color="#0000FF">.eq. </font><font color="#000080">opSalvarAlteracao</font><font color="#808080">) </font><font color="#0000FF">then
           call </font><font color="#000080">escreveArq</font><font color="#808080">(</font><font color="#000080">tfAssunto</font><font color="#808080">, </font><font color="#000080">LinhaReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">), </font><font color="#000080">MSG_REGALT</font><font color="#808080">, 
     *      </font><font color="#000080">MSG_REGNALT</font><font color="#808080">)
         </font><font color="#0000FF">else if </font><font color="#808080">(</font><font color="#000080">sacao </font><font color="#0000FF">.eq. </font><font color="#000080">opConfirmaExclusao</font><font color="#808080">) </font><font color="#0000FF">then
           call </font><font color="#000080">escreveArq</font><font color="#808080">(</font><font color="#000080">tfAssunto</font><font color="#808080">, </font><font color="#000080">repete</font><font color="#808080">(</font><font color="#800000">'*'</font><font color="#808080">,</font><font color="#000080">tamReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">)), 
     *      </font><font color="#000080">MSG_REGEXC</font><font color="#808080">, </font><font color="#000080">MSG_REGNEXC</font><font color="#808080">)
         </font><font color="#0000FF">end if 
      else if </font><font color="#808080">(</font><font color="#000080">sreg </font><font color="#0000FF">.eq. </font><font color="#000080">opAutor</font><font color="#808080">) </font><font color="#0000FF">then
         if </font><font color="#808080">(</font><font color="#000080">sacao </font><font color="#0000FF">.eq. </font><font color="#000080">opSalvarInclusao</font><font color="#808080">) </font><font color="#0000FF">then
           call </font><font color="#000080">escreveArq</font><font color="#808080">(</font><font color="#000080">tfAutor</font><font color="#808080">, </font><font color="#000080">LinhaReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">), </font><font color="#000080">MSG_REGINC</font><font color="#808080">, 
     *     </font><font color="#000080">MSG_REGNINC</font><font color="#808080">)
         </font><font color="#0000FF">else if </font><font color="#808080">(</font><font color="#000080">sacao </font><font color="#0000FF">.eq. </font><font color="#000080">opSalvarAlteracao</font><font color="#808080">) </font><font color="#0000FF">then
           call </font><font color="#000080">escreveArq</font><font color="#808080">(</font><font color="#000080">tfAutor</font><font color="#808080">, </font><font color="#000080">LinhaReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">), </font><font color="#000080">MSG_REGALT</font><font color="#808080">, 
     *     </font><font color="#000080">MSG_REGNALT</font><font color="#808080">)
         </font><font color="#0000FF">else if </font><font color="#808080">(</font><font color="#000080">sacao </font><font color="#0000FF">.eq. </font><font color="#000080">opConfirmaExclusao</font><font color="#808080">) </font><font color="#0000FF">then
           call </font><font color="#000080">escreveArq</font><font color="#808080">(</font><font color="#000080">tfAutor</font><font color="#808080">, </font><font color="#000080">repete</font><font color="#808080">(</font><font color="#800000">'*'</font><font color="#808080">,</font><font color="#000080">tamReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">)), 
     *      </font><font color="#000080">MSG_REGEXC</font><font color="#808080">, </font><font color="#000080">MSG_REGNEXC</font><font color="#808080">)
         </font><font color="#0000FF">end if 
      else if </font><font color="#808080">(</font><font color="#000080">sreg </font><font color="#0000FF">.eq. </font><font color="#000080">opEditora</font><font color="#808080">) </font><font color="#0000FF">then
         if </font><font color="#808080">(</font><font color="#000080">sacao </font><font color="#0000FF">.eq. </font><font color="#000080">opSalvarInclusao</font><font color="#808080">) </font><font color="#0000FF">then
           call </font><font color="#000080">escreveArq</font><font color="#808080">(</font><font color="#000080">tfEditora</font><font color="#808080">, </font><font color="#000080">LinhaReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">), </font><font color="#000080">MSG_REGINC</font><font color="#808080">, 
     *     </font><font color="#000080">MSG_REGNINC</font><font color="#808080">)
         </font><font color="#0000FF">else if </font><font color="#808080">(</font><font color="#000080">sacao </font><font color="#0000FF">.eq. </font><font color="#000080">opSalvarAlteracao</font><font color="#808080">) </font><font color="#0000FF">then
           call </font><font color="#000080">escreveArq</font><font color="#808080">(</font><font color="#000080">tfEditora</font><font color="#808080">, </font><font color="#000080">LinhaReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">), </font><font color="#000080">MSG_REGALT</font><font color="#808080">, 
     *     </font><font color="#000080">MSG_REGNALT</font><font color="#808080">)
         </font><font color="#0000FF">else if </font><font color="#808080">(</font><font color="#000080">sacao </font><font color="#0000FF">.eq. </font><font color="#000080">opConfirmaExclusao</font><font color="#808080">) </font><font color="#0000FF">then
           call </font><font color="#000080">escreveArq</font><font color="#808080">(</font><font color="#000080">tfEditora</font><font color="#808080">, </font><font color="#000080">repete</font><font color="#808080">(</font><font color="#800000">'*'</font><font color="#808080">,</font><font color="#000080">tamReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">)),
     *      </font><font color="#000080">MSG_REGEXC</font><font color="#808080">, </font><font color="#000080">MSG_REGNEXC</font><font color="#808080">)
         </font><font color="#0000FF">end if 
      else if </font><font color="#808080">(</font><font color="#000080">sreg </font><font color="#0000FF">.eq. </font><font color="#000080">opEndereco</font><font color="#808080">) </font><font color="#0000FF">then
         if </font><font color="#808080">(</font><font color="#000080">sacao </font><font color="#0000FF">.eq. </font><font color="#000080">opSalvarInclusao</font><font color="#808080">) </font><font color="#0000FF">then
           call </font><font color="#000080">escreveArq</font><font color="#808080">(</font><font color="#000080">tfEndereco</font><font color="#808080">, </font><font color="#000080">LinhaReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">), </font><font color="#000080">MSG_REGINC</font><font color="#808080">, 
     *     </font><font color="#000080">MSG_REGNINC</font><font color="#808080">)
         </font><font color="#0000FF">else if </font><font color="#808080">(</font><font color="#000080">sacao </font><font color="#0000FF">.eq. </font><font color="#000080">opSalvarAlteracao</font><font color="#808080">) </font><font color="#0000FF">then
           call </font><font color="#000080">escreveArq</font><font color="#808080">(</font><font color="#000080">tfEndereco</font><font color="#808080">, </font><font color="#000080">LinhaReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">), </font><font color="#000080">MSG_REGALT</font><font color="#808080">, 
     *     </font><font color="#000080">MSG_REGNALT</font><font color="#808080">)
         </font><font color="#0000FF">else if </font><font color="#808080">(</font><font color="#000080">sacao </font><font color="#0000FF">.eq. </font><font color="#000080">opConfirmaExclusao</font><font color="#808080">) </font><font color="#0000FF">then
           call </font><font color="#000080">escreveArq</font><font color="#808080">(</font><font color="#000080">tfEndereco</font><font color="#808080">, </font><font color="#000080">repete</font><font color="#808080">(</font><font color="#800000">'*'</font><font color="#808080">,</font><font color="#000080">tamReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">)),
     *      </font><font color="#000080">MSG_REGEXC</font><font color="#808080">, </font><font color="#000080">MSG_REGNEXC</font><font color="#808080">)
         </font><font color="#0000FF">end if 
      else if </font><font color="#808080">(</font><font color="#000080">sreg </font><font color="#0000FF">.eq. </font><font color="#000080">opIdioma</font><font color="#808080">) </font><font color="#0000FF">then
         if </font><font color="#808080">(</font><font color="#000080">sacao </font><font color="#0000FF">.eq. </font><font color="#000080">opSalvarInclusao</font><font color="#808080">) </font><font color="#0000FF">then
           call </font><font color="#000080">escreveArq</font><font color="#808080">(</font><font color="#000080">tfIdioma</font><font color="#808080">, </font><font color="#000080">LinhaReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">), </font><font color="#000080">MSG_REGINC</font><font color="#808080">, 
     *     </font><font color="#000080">MSG_REGNINC</font><font color="#808080">)
         </font><font color="#0000FF">else if </font><font color="#808080">(</font><font color="#000080">sacao </font><font color="#0000FF">.eq. </font><font color="#000080">opSalvarAlteracao</font><font color="#808080">) </font><font color="#0000FF">then
           call </font><font color="#000080">escreveArq</font><font color="#808080">(</font><font color="#000080">tfIdioma</font><font color="#808080">, </font><font color="#000080">LinhaReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">), </font><font color="#000080">MSG_REGALT</font><font color="#808080">, 
     *     </font><font color="#000080">MSG_REGNALT</font><font color="#808080">)
         </font><font color="#0000FF">else if </font><font color="#808080">(</font><font color="#000080">sacao </font><font color="#0000FF">.eq. </font><font color="#000080">opConfirmaExclusao</font><font color="#808080">) </font><font color="#0000FF">then
           call </font><font color="#000080">escreveArq</font><font color="#808080">(</font><font color="#000080">tfIdioma</font><font color="#808080">, </font><font color="#000080">repete</font><font color="#808080">(</font><font color="#800000">'*'</font><font color="#808080">,</font><font color="#000080">tamReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">)),
     *      </font><font color="#000080">MSG_REGEXC</font><font color="#808080">, </font><font color="#000080">MSG_REGNEXC</font><font color="#808080">)
         </font><font color="#0000FF">end if 
      else if </font><font color="#808080">(</font><font color="#000080">sreg </font><font color="#0000FF">.eq. </font><font color="#000080">opPais</font><font color="#808080">) </font><font color="#0000FF">then
         if </font><font color="#808080">(</font><font color="#000080">sacao </font><font color="#0000FF">.eq. </font><font color="#000080">opSalvarInclusao</font><font color="#808080">) </font><font color="#0000FF">then
           call </font><font color="#000080">escreveArq</font><font color="#808080">(</font><font color="#000080">tfPais</font><font color="#808080">, </font><font color="#000080">LinhaReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">), </font><font color="#000080">MSG_REGINC</font><font color="#808080">, 
     *     </font><font color="#000080">MSG_REGNINC</font><font color="#808080">)
         </font><font color="#0000FF">else if </font><font color="#808080">(</font><font color="#000080">sacao </font><font color="#0000FF">.eq. </font><font color="#000080">opSalvarAlteracao</font><font color="#808080">) </font><font color="#0000FF">then
           call </font><font color="#000080">escreveArq</font><font color="#808080">(</font><font color="#000080">tfPais</font><font color="#808080">, </font><font color="#000080">LinhaReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">), </font><font color="#000080">MSG_REGALT</font><font color="#808080">, 
     *     </font><font color="#000080">MSG_REGNALT</font><font color="#808080">)
         </font><font color="#0000FF">else if </font><font color="#808080">(</font><font color="#000080">sacao </font><font color="#0000FF">.eq. </font><font color="#000080">opConfirmaExclusao</font><font color="#808080">) </font><font color="#0000FF">then
           call </font><font color="#000080">escreveArq</font><font color="#808080">(</font><font color="#000080">tfPais</font><font color="#808080">, </font><font color="#000080">repete</font><font color="#808080">(</font><font color="#800000">'*'</font><font color="#808080">,</font><font color="#000080">tamReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">)),
     *      </font><font color="#000080">MSG_REGEXC</font><font color="#808080">, </font><font color="#000080">MSG_REGNEXC</font><font color="#808080">)
         </font><font color="#0000FF">end if 
      else if </font><font color="#808080">(</font><font color="#000080">sreg </font><font color="#0000FF">.eq. </font><font color="#000080">opProfissao</font><font color="#808080">) </font><font color="#0000FF">then
         if </font><font color="#808080">(</font><font color="#000080">sacao </font><font color="#0000FF">.eq. </font><font color="#000080">opSalvarInclusao</font><font color="#808080">) </font><font color="#0000FF">then
           call </font><font color="#000080">escreveArq</font><font color="#808080">(</font><font color="#000080">tfProfissao</font><font color="#808080">, </font><font color="#000080">LinhaReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">), </font><font color="#000080">MSG_REGINC</font><font color="#808080">, 
     *     </font><font color="#000080">MSG_REGNINC</font><font color="#808080">)
         </font><font color="#0000FF">else if </font><font color="#808080">(</font><font color="#000080">sacao </font><font color="#0000FF">.eq. </font><font color="#000080">opSalvarAlteracao</font><font color="#808080">) </font><font color="#0000FF">then
           call </font><font color="#000080">escreveArq</font><font color="#808080">(</font><font color="#000080">tfProfissao</font><font color="#808080">, </font><font color="#000080">LinhaReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">), </font><font color="#000080">MSG_REGALT</font><font color="#808080">, 
     *     </font><font color="#000080">MSG_REGNALT</font><font color="#808080">)
         </font><font color="#0000FF">else if </font><font color="#808080">(</font><font color="#000080">sacao </font><font color="#0000FF">.eq. </font><font color="#000080">opConfirmaExclusao</font><font color="#808080">) </font><font color="#0000FF">then
           call </font><font color="#000080">escreveArq</font><font color="#808080">(</font><font color="#000080">tfProfissao</font><font color="#808080">, </font><font color="#000080">repete</font><font color="#808080">(</font><font color="#800000">'*'</font><font color="#808080">,</font><font color="#000080">tamReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">)),
     *      </font><font color="#000080">MSG_REGEXC</font><font color="#808080">, </font><font color="#000080">MSG_REGNEXC</font><font color="#808080">)
         </font><font color="#0000FF">end if 
      else if </font><font color="#808080">(</font><font color="#000080">sreg </font><font color="#0000FF">.eq. </font><font color="#000080">opLivro</font><font color="#808080">) </font><font color="#0000FF">then
         if </font><font color="#808080">(</font><font color="#000080">sacao </font><font color="#0000FF">.eq. </font><font color="#000080">opSalvarInclusao</font><font color="#808080">) </font><font color="#0000FF">then
           call </font><font color="#000080">escreveArq</font><font color="#808080">(</font><font color="#000080">tfLivro</font><font color="#808080">, </font><font color="#000080">LinhaReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">), </font><font color="#000080">MSG_REGINC</font><font color="#808080">, 
     *     </font><font color="#000080">MSG_REGNINC</font><font color="#808080">)
         </font><font color="#0000FF">else if </font><font color="#808080">(</font><font color="#000080">sacao </font><font color="#0000FF">.eq. </font><font color="#000080">opSalvarAlteracao</font><font color="#808080">) </font><font color="#0000FF">then
           call </font><font color="#000080">escreveArq</font><font color="#808080">(</font><font color="#000080">tfLivro</font><font color="#808080">, </font><font color="#000080">LinhaReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">), </font><font color="#000080">MSG_REGALT</font><font color="#808080">, 
     *     </font><font color="#000080">MSG_REGNALT</font><font color="#808080">)
         </font><font color="#0000FF">else if </font><font color="#808080">(</font><font color="#000080">sacao </font><font color="#0000FF">.eq. </font><font color="#000080">opConfirmaExclusao</font><font color="#808080">) </font><font color="#0000FF">then
           call </font><font color="#000080">escreveArq</font><font color="#808080">(</font><font color="#000080">tfLivro</font><font color="#808080">, </font><font color="#000080">repete</font><font color="#808080">(</font><font color="#800000">'*'</font><font color="#808080">,</font><font color="#000080">tamReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">)),
     *      </font><font color="#000080">MSG_REGEXC</font><font color="#808080">, </font><font color="#000080">MSG_REGNEXC</font><font color="#808080">)
         </font><font color="#0000FF">end if 
      else if </font><font color="#808080">(</font><font color="#000080">sreg </font><font color="#0000FF">.eq. </font><font color="#000080">opLivroAss</font><font color="#808080">) </font><font color="#0000FF">then
         if </font><font color="#808080">(</font><font color="#000080">sacao </font><font color="#0000FF">.eq. </font><font color="#000080">opSalvarInclusao</font><font color="#808080">) </font><font color="#0000FF">then
           call </font><font color="#000080">escreveArq</font><font color="#808080">(</font><font color="#000080">tfLivroAss</font><font color="#808080">, </font><font color="#000080">LinhaReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">), </font><font color="#000080">MSG_REGINC</font><font color="#808080">, 
     *     </font><font color="#000080">MSG_REGNINC</font><font color="#808080">)
         </font><font color="#0000FF">else if </font><font color="#808080">(</font><font color="#000080">sacao </font><font color="#0000FF">.eq. </font><font color="#000080">opSalvarAlteracao</font><font color="#808080">) </font><font color="#0000FF">then
           call </font><font color="#000080">escreveArq</font><font color="#808080">(</font><font color="#000080">tfLivroAss</font><font color="#808080">, </font><font color="#000080">LinhaReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">), </font><font color="#000080">MSG_REGALT</font><font color="#808080">, 
     *     </font><font color="#000080">MSG_REGNALT</font><font color="#808080">)
         </font><font color="#0000FF">else if </font><font color="#808080">(</font><font color="#000080">sacao </font><font color="#0000FF">.eq. </font><font color="#000080">opConfirmaExclusao</font><font color="#808080">) </font><font color="#0000FF">then
           call </font><font color="#000080">escreveArq</font><font color="#808080">(</font><font color="#000080">tfLivroAss</font><font color="#808080">, </font><font color="#000080">repete</font><font color="#808080">(</font><font color="#800000">'*'</font><font color="#808080">,</font><font color="#000080">tamReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">)),
     *      </font><font color="#000080">MSG_REGEXC</font><font color="#808080">, </font><font color="#000080">MSG_REGNEXC</font><font color="#808080">)
         </font><font color="#0000FF">end if 
      else if </font><font color="#808080">(</font><font color="#000080">sreg </font><font color="#0000FF">.eq. </font><font color="#000080">opLivroAut</font><font color="#808080">) </font><font color="#0000FF">then
         if </font><font color="#808080">(</font><font color="#000080">sacao </font><font color="#0000FF">.eq. </font><font color="#000080">opSalvarInclusao</font><font color="#808080">) </font><font color="#0000FF">then
           call </font><font color="#000080">escreveArq</font><font color="#808080">(</font><font color="#000080">tfLivroAut</font><font color="#808080">, </font><font color="#000080">LinhaReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">), </font><font color="#000080">MSG_REGINC</font><font color="#808080">, 
     *     </font><font color="#000080">MSG_REGNINC</font><font color="#808080">)
         </font><font color="#0000FF">else if </font><font color="#808080">(</font><font color="#000080">sacao </font><font color="#0000FF">.eq. </font><font color="#000080">opSalvarAlteracao</font><font color="#808080">) </font><font color="#0000FF">then
           call </font><font color="#000080">escreveArq</font><font color="#808080">(</font><font color="#000080">tfLivroAut</font><font color="#808080">, </font><font color="#000080">LinhaReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">), </font><font color="#000080">MSG_REGALT</font><font color="#808080">, 
     *     </font><font color="#000080">MSG_REGNALT</font><font color="#808080">)
         </font><font color="#0000FF">else if </font><font color="#808080">(</font><font color="#000080">sacao </font><font color="#0000FF">.eq. </font><font color="#000080">opConfirmaExclusao</font><font color="#808080">) </font><font color="#0000FF">then
           call </font><font color="#000080">escreveArq</font><font color="#808080">(</font><font color="#000080">tfLivroAut</font><font color="#808080">, </font><font color="#000080">repete</font><font color="#808080">(</font><font color="#800000">'*'</font><font color="#808080">,</font><font color="#000080">tamReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">)),
     *      </font><font color="#000080">MSG_REGEXC</font><font color="#808080">, </font><font color="#000080">MSG_REGNEXC</font><font color="#808080">)
         </font><font color="#0000FF">end if 
      else if </font><font color="#808080">(</font><font color="#000080">sreg </font><font color="#0000FF">.eq. </font><font color="#000080">opCliente</font><font color="#808080">) </font><font color="#0000FF">then
         if </font><font color="#808080">(</font><font color="#000080">sacao </font><font color="#0000FF">.eq. </font><font color="#000080">opSalvarInclusao</font><font color="#808080">) </font><font color="#0000FF">then
           call </font><font color="#000080">escreveArq</font><font color="#808080">(</font><font color="#000080">tfCliente</font><font color="#808080">, </font><font color="#000080">LinhaReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">), </font><font color="#000080">MSG_REGINC</font><font color="#808080">, 
     *     </font><font color="#000080">MSG_REGNINC</font><font color="#808080">)
         </font><font color="#0000FF">else if </font><font color="#808080">(</font><font color="#000080">sacao </font><font color="#0000FF">.eq. </font><font color="#000080">opSalvarAlteracao</font><font color="#808080">) </font><font color="#0000FF">then
           call </font><font color="#000080">escreveArq</font><font color="#808080">(</font><font color="#000080">tfCliente</font><font color="#808080">, </font><font color="#000080">LinhaReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">), </font><font color="#000080">MSG_REGALT</font><font color="#808080">, 
     *     </font><font color="#000080">MSG_REGNALT</font><font color="#808080">)
         </font><font color="#0000FF">else if </font><font color="#808080">(</font><font color="#000080">sacao </font><font color="#0000FF">.eq. </font><font color="#000080">opConfirmaExclusao</font><font color="#808080">) </font><font color="#0000FF">then
           call </font><font color="#000080">escreveArq</font><font color="#808080">(</font><font color="#000080">tfCliente</font><font color="#808080">, </font><font color="#000080">repete</font><font color="#808080">(</font><font color="#800000">'*'</font><font color="#808080">,</font><font color="#000080">tamReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">)),
     *      </font><font color="#000080">MSG_REGEXC</font><font color="#808080">, </font><font color="#000080">MSG_REGNEXC</font><font color="#808080">)
         </font><font color="#0000FF">end if 
      else if </font><font color="#808080">(</font><font color="#000080">sreg </font><font color="#0000FF">.eq. </font><font color="#000080">opVenda</font><font color="#808080">) </font><font color="#0000FF">then
         if </font><font color="#808080">(</font><font color="#000080">sacao </font><font color="#0000FF">.eq. </font><font color="#000080">opSalvarInclusao</font><font color="#808080">) </font><font color="#0000FF">then
           call </font><font color="#000080">escreveArq</font><font color="#808080">(</font><font color="#000080">tfVenda</font><font color="#808080">, </font><font color="#000080">LinhaReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">), </font><font color="#000080">MSG_REGINC</font><font color="#808080">, 
     *     </font><font color="#000080">MSG_REGNINC</font><font color="#808080">)
         </font><font color="#0000FF">else if </font><font color="#808080">(</font><font color="#000080">sacao </font><font color="#0000FF">.eq. </font><font color="#000080">opSalvarAlteracao</font><font color="#808080">) </font><font color="#0000FF">then
           call </font><font color="#000080">escreveArq</font><font color="#808080">(</font><font color="#000080">tfVenda</font><font color="#808080">, </font><font color="#000080">LinhaReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">), </font><font color="#000080">MSG_REGALT</font><font color="#808080">, 
     *     </font><font color="#000080">MSG_REGNALT</font><font color="#808080">)
         </font><font color="#0000FF">else if </font><font color="#808080">(</font><font color="#000080">sacao </font><font color="#0000FF">.eq. </font><font color="#000080">opConfirmaExclusao</font><font color="#808080">) </font><font color="#0000FF">then
           call </font><font color="#000080">escreveArq</font><font color="#808080">(</font><font color="#000080">tfVenda</font><font color="#808080">, </font><font color="#000080">repete</font><font color="#808080">(</font><font color="#800000">'*'</font><font color="#808080">,</font><font color="#000080">tamReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">)),
     *      </font><font color="#000080">MSG_REGEXC</font><font color="#808080">, </font><font color="#000080">MSG_REGNEXC</font><font color="#808080">)
         </font><font color="#0000FF">end if 
      else if </font><font color="#808080">(</font><font color="#000080">sreg </font><font color="#0000FF">.eq. </font><font color="#000080">opUsuario</font><font color="#808080">) </font><font color="#0000FF">then
         if </font><font color="#808080">(</font><font color="#000080">sacao </font><font color="#0000FF">.eq. </font><font color="#000080">opSalvarAlteracao</font><font color="#808080">) </font><font color="#0000FF">then
           call </font><font color="#000080">escreveArq</font><font color="#808080">(</font><font color="#000080">tfUsuario</font><font color="#808080">, </font><font color="#000080">LinhaReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">), 
     *      </font><font color="#000080">MSG_REGALT</font><font color="#808080">, </font><font color="#000080">MSG_REGNALT</font><font color="#808080">)
         </font><font color="#0000FF">end if
      end if
      return  
      end
</font><font color="#808080"><i>C     ------------------------------------------------------------------
C     Seleciona o menu e/ou a tela certa de acordo com o tipo de arquivo.
C     nmenu - o n&uacute;mero do menu
C     sreg - o tipo de arquivo
C     ------------------------------------------------------------------
      </i></font><font color="#0000FF">subroutine </font><font color="#000080">subMenu</font><font color="#808080">(</font><font color="#000080">nmenu</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">)
      </font><font color="#0000FF">integer </font><font color="#000080">nmenu</font><font color="#808080">, </font><font color="#000080">sreg

      </font><font color="#0000FF">include </font><font color="#800000">'livrus.h'
      
      </font><font color="#0000FF">integer </font><font color="#000080">opSubMenu
      </font><font color="#0000FF">character </font><font color="#000080">opCSubMenu
      </font><font color="#0000FF">logical </font><font color="#000080">bSOp

      bSOp</font><font color="#808080">=</font><font color="#0000FF">.true.
      select case </font><font color="#808080">(</font><font color="#000080">nmenu</font><font color="#808080">)
        </font><font color="#0000FF">case </font><font color="#808080">(</font><font color="#FF0000">6</font><font color="#808080">)
          </font><font color="#0000FF">do while</font><font color="#808080">(</font><font color="#000080">bSOp</font><font color="#808080">) 
            </font><font color="#0000FF">call </font><font color="#000080">menu</font><font color="#808080">(</font><font color="#000080">nmenu</font><font color="#808080">)
            </font><font color="#0000FF">read</font><font color="#808080">(*,</font><font color="#800000">'(I1)'</font><font color="#808080">) </font><font color="#000080">opSubMenu
            </font><font color="#0000FF">select case </font><font color="#808080">(</font><font color="#000080">opSubMenu</font><font color="#808080">)
              </font><font color="#0000FF">case </font><font color="#808080">(</font><font color="#FF0000">1</font><font color="#808080">)
                </font><font color="#0000FF">call </font><font color="#000080">frmCadastros</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#000080">opNovo</font><font color="#808080">)
                </font><font color="#0000FF">if </font><font color="#808080">(</font><font color="#000080">sreg </font><font color="#0000FF">.eq. </font><font color="#000080">opAssunto</font><font color="#808080">) </font><font color="#0000FF">then
                  write</font><font color="#808080">(*,*) </font><font color="#800000">'cadastro novo'
                </font><font color="#0000FF">end if
              case </font><font color="#808080">(</font><font color="#FF0000">2</font><font color="#808080">)
                </font><font color="#0000FF">call </font><font color="#000080">frmCadastros</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#000080">opPesquisar</font><font color="#808080">)
              </font><font color="#0000FF">case </font><font color="#808080">(</font><font color="#FF0000">3</font><font color="#808080">)
                </font><font color="#000080">bSOp</font><font color="#808080">=</font><font color="#0000FF">.false.
              case default 
                write</font><font color="#808080">(*,*) </font><font color="#000080">MSG_ERRO
            </font><font color="#0000FF">end select 
          end do
        case </font><font color="#808080">(</font><font color="#FF0000">7</font><font color="#808080">)
          </font><font color="#0000FF">do while</font><font color="#808080">(</font><font color="#000080">bSOp</font><font color="#808080">) 
            </font><font color="#0000FF">call </font><font color="#000080">menu</font><font color="#808080">(</font><font color="#000080">nmenu</font><font color="#808080">)
            </font><font color="#0000FF">read</font><font color="#808080">(*,</font><font color="#800000">'(I1)'</font><font color="#808080">) </font><font color="#000080">opSubMenu
            </font><font color="#0000FF">select case </font><font color="#808080">(</font><font color="#000080">opSubMenu</font><font color="#808080">)
              </font><font color="#0000FF">case </font><font color="#808080">(</font><font color="#FF0000">1</font><font color="#808080">)
                </font><font color="#0000FF">call </font><font color="#000080">btnAcao</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#000080">opSalvarInclusao</font><font color="#808080">)
                </font><font color="#000080">bSOp</font><font color="#808080">=</font><font color="#0000FF">.false.
              case </font><font color="#808080">(</font><font color="#FF0000">2</font><font color="#808080">)
                </font><font color="#000080">bSOp</font><font color="#808080">=</font><font color="#0000FF">.false.
              case default 
                write</font><font color="#808080">(*,*) </font><font color="#000080">MSG_ERRO
            </font><font color="#0000FF">end select 
          end do
        case </font><font color="#808080">(</font><font color="#FF0000">8</font><font color="#808080">)
          </font><font color="#0000FF">do while</font><font color="#808080">(</font><font color="#000080">bSOp</font><font color="#808080">) 
            </font><font color="#0000FF">call </font><font color="#000080">menu</font><font color="#808080">(</font><font color="#000080">nmenu</font><font color="#808080">)
            </font><font color="#0000FF">read</font><font color="#808080">(*,</font><font color="#800000">'(I1)'</font><font color="#808080">) </font><font color="#000080">opSubMenu
            </font><font color="#0000FF">select case </font><font color="#808080">(</font><font color="#000080">opSubMenu</font><font color="#808080">)
              </font><font color="#0000FF">case </font><font color="#808080">(</font><font color="#FF0000">1</font><font color="#808080">)
                </font><font color="#0000FF">call </font><font color="#000080">frmCadastros</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#000080">opAlterar</font><font color="#808080">)
                </font><font color="#000080">bSOp</font><font color="#808080">=</font><font color="#0000FF">.false. 
              case </font><font color="#808080">(</font><font color="#FF0000">2</font><font color="#808080">) 
                </font><font color="#0000FF">call </font><font color="#000080">frmCadastros</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#000080">opExcluir</font><font color="#808080">)
                </font><font color="#000080">bSOp</font><font color="#808080">=</font><font color="#0000FF">.false.
              case </font><font color="#808080">(</font><font color="#FF0000">3</font><font color="#808080">)
                </font><font color="#000080">bSOp</font><font color="#808080">=</font><font color="#0000FF">.false.
              case default 
                write</font><font color="#808080">(*,*) </font><font color="#000080">MSG_ERRO
            </font><font color="#0000FF">end select 
          end do
        case </font><font color="#808080">(</font><font color="#FF0000">9</font><font color="#808080">)
          </font><font color="#0000FF">do while</font><font color="#808080">(</font><font color="#000080">bSOp</font><font color="#808080">) 
            </font><font color="#0000FF">call </font><font color="#000080">menu</font><font color="#808080">(</font><font color="#000080">nmenu</font><font color="#808080">)
            </font><font color="#0000FF">read</font><font color="#808080">(*,</font><font color="#800000">'(I1)'</font><font color="#808080">) </font><font color="#000080">opSubMenu
            </font><font color="#0000FF">select case </font><font color="#808080">(</font><font color="#000080">opSubMenu</font><font color="#808080">)
              </font><font color="#0000FF">case </font><font color="#808080">(</font><font color="#FF0000">1</font><font color="#808080">)
                </font><font color="#0000FF">call </font><font color="#000080">btnAcao</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#000080">opSalvarAlteracao</font><font color="#808080">)
                </font><font color="#000080">bSOp</font><font color="#808080">=</font><font color="#0000FF">.false.
              case </font><font color="#808080">(</font><font color="#FF0000">2</font><font color="#808080">)
                </font><font color="#000080">bSOp</font><font color="#808080">=</font><font color="#0000FF">.false.
              case default 
                write</font><font color="#808080">(*,*) </font><font color="#000080">MSG_ERRO
            </font><font color="#0000FF">end select 
          end do
        case </font><font color="#808080">(</font><font color="#FF0000">10</font><font color="#808080">)
          </font><font color="#0000FF">do while</font><font color="#808080">(</font><font color="#000080">bSOp</font><font color="#808080">) 
            </font><font color="#0000FF">call </font><font color="#000080">menu</font><font color="#808080">(</font><font color="#000080">nmenu</font><font color="#808080">)
            </font><font color="#0000FF">read</font><font color="#808080">(*,</font><font color="#800000">'(A1)'</font><font color="#808080">) </font><font color="#000080">opCSubMenu
            </font><font color="#0000FF">if </font><font color="#808080">(</font><font color="#000080">opCSubMenu</font><font color="#0000FF">.eq.</font><font color="#800000">'S' </font><font color="#0000FF">.or. </font><font color="#000080">opCSubMenu</font><font color="#0000FF">.eq.</font><font color="#800000">'s'</font><font color="#808080">) </font><font color="#0000FF">then
              call </font><font color="#000080">btnAcao</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#000080">opConfirmaExclusao</font><font color="#808080">)
              </font><font color="#000080">bSOp</font><font color="#808080">=</font><font color="#0000FF">.false.
            else if </font><font color="#808080">(</font><font color="#000080">opCSubMenu</font><font color="#0000FF">.eq.</font><font color="#800000">'N' </font><font color="#0000FF">.or. </font><font color="#000080">opCSubMenu</font><font color="#0000FF">.eq.</font><font color="#800000">'n'</font><font color="#808080">) </font><font color="#0000FF">then 
              </font><font color="#000080">bSOp</font><font color="#808080">=</font><font color="#0000FF">.false.
            else 
              write</font><font color="#808080">(*,*) </font><font color="#000080">MSG_ERRO
            </font><font color="#0000FF">end if
          end do
        case </font><font color="#808080">(</font><font color="#FF0000">12</font><font color="#808080">)
          </font><font color="#0000FF">do while</font><font color="#808080">(</font><font color="#000080">bSOp</font><font color="#808080">) 
            </font><font color="#0000FF">call </font><font color="#000080">menu</font><font color="#808080">(</font><font color="#000080">nmenu</font><font color="#808080">)
            </font><font color="#0000FF">read</font><font color="#808080">(*,</font><font color="#800000">'(I1)'</font><font color="#808080">) </font><font color="#000080">opSubMenu
            </font><font color="#0000FF">select case </font><font color="#808080">(</font><font color="#000080">opSubMenu</font><font color="#808080">)
              </font><font color="#0000FF">case </font><font color="#808080">(</font><font color="#FF0000">1</font><font color="#808080">)
                </font><font color="#0000FF">call </font><font color="#000080">frmConsultas</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#000080">opPesquisar</font><font color="#808080">)
              </font><font color="#0000FF">case </font><font color="#808080">(</font><font color="#FF0000">2</font><font color="#808080">) 
                </font><font color="#0000FF">call </font><font color="#000080">frmConsultas</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#000080">opListarTodos</font><font color="#808080">)
              </font><font color="#0000FF">case </font><font color="#808080">(</font><font color="#FF0000">3</font><font color="#808080">)
                </font><font color="#000080">bSOp</font><font color="#808080">=</font><font color="#0000FF">.false.
              case default 
                write</font><font color="#808080">(*,*) </font><font color="#000080">MSG_ERRO
            </font><font color="#0000FF">end select 
          end do
        case </font><font color="#808080">(</font><font color="#FF0000">14</font><font color="#808080">)
          </font><font color="#0000FF">do while</font><font color="#808080">(</font><font color="#000080">bSOp</font><font color="#808080">) 
            </font><font color="#0000FF">call </font><font color="#000080">menu</font><font color="#808080">(</font><font color="#000080">nmenu</font><font color="#808080">)
            </font><font color="#0000FF">read</font><font color="#808080">(*,</font><font color="#800000">'(A1)'</font><font color="#808080">) </font><font color="#000080">opCSubMenu
            </font><font color="#0000FF">if </font><font color="#808080">(</font><font color="#000080">opCSubMenu</font><font color="#0000FF">.eq.</font><font color="#800000">'S' </font><font color="#0000FF">.or. </font><font color="#000080">opCSubMenu</font><font color="#0000FF">.eq.</font><font color="#800000">'s'</font><font color="#808080">) </font><font color="#0000FF">then
              call </font><font color="#000080">btnAcao</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#000080">opSalvarInclusao</font><font color="#808080">)
              </font><font color="#000080">bSOp</font><font color="#808080">=</font><font color="#0000FF">.false.
              </font><font color="#000080">g_SalvarInclusao </font><font color="#808080">= </font><font color="#0000FF">.true.
            else if </font><font color="#808080">(</font><font color="#000080">opCSubMenu</font><font color="#0000FF">.eq.</font><font color="#800000">'N' </font><font color="#0000FF">.or. </font><font color="#000080">opCSubMenu</font><font color="#0000FF">.eq.</font><font color="#800000">'n'</font><font color="#808080">) </font><font color="#0000FF">then
              </font><font color="#000080">bSOp</font><font color="#808080">=</font><font color="#0000FF">.false.
            else
              write</font><font color="#808080">(*,*) </font><font color="#000080">MSG_ERRO
            </font><font color="#0000FF">end if
          end do
      end select      
      end
</font><font color="#808080"><i>C     ------------------------------------------------------------------
C     Seleciona o submenu e/ou a tela certa de acordo com n&uacute;mero do menu.
C     nmenu - o n&uacute;mero do menu
C     ------------------------------------------------------------------
      </i></font><font color="#0000FF">subroutine </font><font color="#000080">usaMenu</font><font color="#808080">(</font><font color="#000080">num</font><font color="#808080">)
      </font><font color="#0000FF">integer </font><font color="#000080">num   

      </font><font color="#0000FF">include </font><font color="#800000">'livrus.h'

      </font><font color="#0000FF">integer </font><font color="#000080">opSubMenu
      </font><font color="#0000FF">logical </font><font color="#000080">bSOp
      </font><font color="#0000FF">character </font><font color="#000080">opSair

      bSOp</font><font color="#808080">=</font><font color="#0000FF">.true.
</font><font color="#808080"><i>C     ---------
C     Cadastros
C     ---------  
      </i></font><font color="#0000FF">if </font><font color="#808080">(</font><font color="#000080">num</font><font color="#0000FF">.eq.</font><font color="#FF0000">1</font><font color="#808080">) </font><font color="#0000FF">then  
        do while</font><font color="#808080">(</font><font color="#000080">bSOp</font><font color="#808080">)
          </font><font color="#0000FF">call </font><font color="#000080">menu</font><font color="#808080">(</font><font color="#FF0000">2</font><font color="#808080">)
          </font><font color="#0000FF">read</font><font color="#808080">(*,</font><font color="#800000">'(I2)'</font><font color="#808080">) </font><font color="#000080">opSubMenu
          </font><font color="#0000FF">select case </font><font color="#808080">(</font><font color="#000080">opSubMenu</font><font color="#808080">)
            </font><font color="#0000FF">case </font><font color="#808080">(</font><font color="#FF0000">1</font><font color="#808080">) 
              </font><font color="#0000FF">call </font><font color="#000080">subMenu</font><font color="#808080">(</font><font color="#FF0000">6</font><font color="#808080">, </font><font color="#000080">opAssunto</font><font color="#808080">)
            </font><font color="#0000FF">case </font><font color="#808080">(</font><font color="#FF0000">2</font><font color="#808080">)
              </font><font color="#0000FF">call </font><font color="#000080">subMenu</font><font color="#808080">(</font><font color="#FF0000">6</font><font color="#808080">, </font><font color="#000080">opAutor</font><font color="#808080">)
            </font><font color="#0000FF">case </font><font color="#808080">(</font><font color="#FF0000">3</font><font color="#808080">)
              </font><font color="#0000FF">call </font><font color="#000080">subMenu</font><font color="#808080">(</font><font color="#FF0000">6</font><font color="#808080">, </font><font color="#000080">opEditora</font><font color="#808080">)
            </font><font color="#0000FF">case </font><font color="#808080">(</font><font color="#FF0000">4</font><font color="#808080">)
              </font><font color="#0000FF">call </font><font color="#000080">subMenu</font><font color="#808080">(</font><font color="#FF0000">6</font><font color="#808080">, </font><font color="#000080">opEndereco</font><font color="#808080">)
            </font><font color="#0000FF">case </font><font color="#808080">(</font><font color="#FF0000">5</font><font color="#808080">)
              </font><font color="#0000FF">call </font><font color="#000080">subMenu</font><font color="#808080">(</font><font color="#FF0000">6</font><font color="#808080">, </font><font color="#000080">opIdioma</font><font color="#808080">)
            </font><font color="#0000FF">case </font><font color="#808080">(</font><font color="#FF0000">6</font><font color="#808080">)
              </font><font color="#0000FF">call </font><font color="#000080">subMenu</font><font color="#808080">(</font><font color="#FF0000">6</font><font color="#808080">, </font><font color="#000080">opPais</font><font color="#808080">)
            </font><font color="#0000FF">case </font><font color="#808080">(</font><font color="#FF0000">7</font><font color="#808080">)
              </font><font color="#0000FF">call </font><font color="#000080">subMenu</font><font color="#808080">(</font><font color="#FF0000">6</font><font color="#808080">, </font><font color="#000080">opProfissao</font><font color="#808080">)
            </font><font color="#0000FF">case </font><font color="#808080">(</font><font color="#FF0000">8</font><font color="#808080">)
              </font><font color="#0000FF">call </font><font color="#000080">subMenu</font><font color="#808080">(</font><font color="#FF0000">6</font><font color="#808080">, </font><font color="#000080">opCliente</font><font color="#808080">)
            </font><font color="#0000FF">case </font><font color="#808080">(</font><font color="#FF0000">9</font><font color="#808080">)
              </font><font color="#0000FF">call </font><font color="#000080">subMenu</font><font color="#808080">(</font><font color="#FF0000">6</font><font color="#808080">, </font><font color="#000080">opLivro</font><font color="#808080">)
            </font><font color="#0000FF">case </font><font color="#808080">(</font><font color="#FF0000">10</font><font color="#808080">)
              </font><font color="#000080">bSOp</font><font color="#808080">=</font><font color="#0000FF">.false.
            case default 
              write</font><font color="#808080">(*,*) </font><font color="#000080">MSG_ERRO
          </font><font color="#0000FF">end select
        end do
</font><font color="#808080"><i>C     ---------
C     Pesquisas
C     ---------
      </i></font><font color="#0000FF">else if </font><font color="#808080">(</font><font color="#000080">num</font><font color="#0000FF">.eq.</font><font color="#FF0000">2</font><font color="#808080">) </font><font color="#0000FF">then  
        do while</font><font color="#808080">(</font><font color="#000080">bSOp</font><font color="#808080">)
          </font><font color="#0000FF">call </font><font color="#000080">menu</font><font color="#808080">(</font><font color="#FF0000">3</font><font color="#808080">)
          </font><font color="#0000FF">read</font><font color="#808080">(*,</font><font color="#800000">'(I2)'</font><font color="#808080">) </font><font color="#000080">opSubMenu
          </font><font color="#0000FF">select case </font><font color="#808080">(</font><font color="#000080">opSubMenu</font><font color="#808080">)
            </font><font color="#0000FF">case </font><font color="#808080">(</font><font color="#FF0000">1</font><font color="#808080">) 
              </font><font color="#0000FF">call </font><font color="#000080">subMenu</font><font color="#808080">(</font><font color="#FF0000">12</font><font color="#808080">, </font><font color="#000080">opAssunto</font><font color="#808080">)
            </font><font color="#0000FF">case </font><font color="#808080">(</font><font color="#FF0000">2</font><font color="#808080">)
              </font><font color="#0000FF">call </font><font color="#000080">subMenu</font><font color="#808080">(</font><font color="#FF0000">12</font><font color="#808080">, </font><font color="#000080">opAutor</font><font color="#808080">)
            </font><font color="#0000FF">case </font><font color="#808080">(</font><font color="#FF0000">3</font><font color="#808080">)
              </font><font color="#0000FF">call </font><font color="#000080">subMenu</font><font color="#808080">(</font><font color="#FF0000">12</font><font color="#808080">, </font><font color="#000080">opEditora</font><font color="#808080">)
            </font><font color="#0000FF">case </font><font color="#808080">(</font><font color="#FF0000">4</font><font color="#808080">)
              </font><font color="#0000FF">call </font><font color="#000080">subMenu</font><font color="#808080">(</font><font color="#FF0000">12</font><font color="#808080">, </font><font color="#000080">opEndereco</font><font color="#808080">)
            </font><font color="#0000FF">case </font><font color="#808080">(</font><font color="#FF0000">5</font><font color="#808080">)
              </font><font color="#0000FF">call </font><font color="#000080">subMenu</font><font color="#808080">(</font><font color="#FF0000">12</font><font color="#808080">, </font><font color="#000080">opIdioma</font><font color="#808080">)
            </font><font color="#0000FF">case </font><font color="#808080">(</font><font color="#FF0000">6</font><font color="#808080">)
              </font><font color="#0000FF">call </font><font color="#000080">subMenu</font><font color="#808080">(</font><font color="#FF0000">12</font><font color="#808080">, </font><font color="#000080">opPais</font><font color="#808080">)
            </font><font color="#0000FF">case </font><font color="#808080">(</font><font color="#FF0000">7</font><font color="#808080">)
              </font><font color="#0000FF">call </font><font color="#000080">subMenu</font><font color="#808080">(</font><font color="#FF0000">12</font><font color="#808080">, </font><font color="#000080">opProfissao</font><font color="#808080">)
            </font><font color="#0000FF">case </font><font color="#808080">(</font><font color="#FF0000">8</font><font color="#808080">)
              </font><font color="#0000FF">call </font><font color="#000080">subMenu</font><font color="#808080">(</font><font color="#FF0000">12</font><font color="#808080">, </font><font color="#000080">opCliente</font><font color="#808080">)
            </font><font color="#0000FF">case </font><font color="#808080">(</font><font color="#FF0000">9</font><font color="#808080">)
              </font><font color="#0000FF">call </font><font color="#000080">subMenu</font><font color="#808080">(</font><font color="#FF0000">12</font><font color="#808080">, </font><font color="#000080">opLivro</font><font color="#808080">)
            </font><font color="#0000FF">case </font><font color="#808080">(</font><font color="#FF0000">10</font><font color="#808080">)
              </font><font color="#000080">bSOp</font><font color="#808080">=</font><font color="#0000FF">.false.
            case default 
              write</font><font color="#808080">(*,*) </font><font color="#000080">MSG_ERRO
          </font><font color="#0000FF">end select
        end do
</font><font color="#808080"><i>C     ------
C     Vendas 
C     ------
      </i></font><font color="#0000FF">else if </font><font color="#808080">(</font><font color="#000080">num</font><font color="#0000FF">.eq.</font><font color="#FF0000">3</font><font color="#808080">) </font><font color="#0000FF">then 
        do while</font><font color="#808080">(</font><font color="#000080">bSOp</font><font color="#808080">)
          </font><font color="#0000FF">call </font><font color="#000080">menu</font><font color="#808080">(</font><font color="#FF0000">4</font><font color="#808080">)
          </font><font color="#0000FF">read</font><font color="#808080">(*,</font><font color="#800000">'(I2)'</font><font color="#808080">) </font><font color="#000080">opSubMenu
          </font><font color="#0000FF">select case </font><font color="#808080">(</font><font color="#000080">opSubMenu</font><font color="#808080">)
            </font><font color="#0000FF">case </font><font color="#808080">(</font><font color="#FF0000">1</font><font color="#808080">) 
              </font><font color="#0000FF">call </font><font color="#000080">subMenu</font><font color="#808080">(</font><font color="#FF0000">6</font><font color="#808080">, </font><font color="#000080">opVenda</font><font color="#808080">)
            </font><font color="#0000FF">case </font><font color="#808080">(</font><font color="#FF0000">2</font><font color="#808080">)
              </font><font color="#0000FF">call </font><font color="#000080">subMenu</font><font color="#808080">(</font><font color="#FF0000">12</font><font color="#808080">, </font><font color="#000080">opVenda</font><font color="#808080">)
            </font><font color="#0000FF">case </font><font color="#808080">(</font><font color="#FF0000">3</font><font color="#808080">)
              </font><font color="#000080">bSOp</font><font color="#808080">=</font><font color="#0000FF">.false.
            case default 
              write</font><font color="#808080">(*,*) </font><font color="#000080">MSG_ERRO
          </font><font color="#0000FF">end select
        end do
</font><font color="#808080"><i>C     ------
C     Opcoes
C     ------
      </i></font><font color="#0000FF">else if </font><font color="#808080">(</font><font color="#000080">num</font><font color="#0000FF">.eq.</font><font color="#FF0000">4</font><font color="#808080">) </font><font color="#0000FF">then
        do while</font><font color="#808080">(</font><font color="#000080">bSOp</font><font color="#808080">)
          </font><font color="#0000FF">call </font><font color="#000080">menu</font><font color="#808080">(</font><font color="#FF0000">5</font><font color="#808080">)
          </font><font color="#0000FF">read</font><font color="#808080">(*,</font><font color="#800000">'(I2)'</font><font color="#808080">) </font><font color="#000080">opSubMenu
          </font><font color="#0000FF">select case </font><font color="#808080">(</font><font color="#000080">opSubMenu</font><font color="#808080">)
            </font><font color="#0000FF">case </font><font color="#808080">(</font><font color="#FF0000">1</font><font color="#808080">) 
              </font><font color="#0000FF">call </font><font color="#000080">frmAlterarSenha
            </font><font color="#0000FF">case </font><font color="#808080">(</font><font color="#FF0000">2</font><font color="#808080">)
              </font><font color="#0000FF">call </font><font color="#000080">frmSobre
            </font><font color="#0000FF">case </font><font color="#808080">(</font><font color="#FF0000">3</font><font color="#808080">)
              </font><font color="#0000FF">call </font><font color="#000080">menu</font><font color="#808080">(</font><font color="#FF0000">11</font><font color="#808080">)
              </font><font color="#0000FF">read</font><font color="#808080">(*,</font><font color="#800000">'(A1)'</font><font color="#808080">) </font><font color="#000080">opSair
              </font><font color="#0000FF">if </font><font color="#808080">(</font><font color="#000080">opSair</font><font color="#0000FF">.eq.</font><font color="#800000">'S' </font><font color="#0000FF">.or. </font><font color="#000080">opSair</font><font color="#0000FF">.eq.</font><font color="#800000">'s'</font><font color="#808080">) </font><font color="#0000FF">then 
                call </font><font color="#000080">fechaArqs
                </font><font color="#0000FF">stop
              end if
            case </font><font color="#808080">(</font><font color="#FF0000">4</font><font color="#808080">) 
              </font><font color="#000080">bSOp</font><font color="#808080">=</font><font color="#0000FF">.false.
            case default 
              write</font><font color="#808080">(*,*) </font><font color="#000080">MSG_ERRO
          </font><font color="#0000FF">end select
        end do
      end if
      end
</font><font color="#808080"><i>C     ------------------------------------------------------------------
C     Mostra as entradas e as sa&iacute;das do sistema.
C     sreg - o tipo de arquivo
C     slinha - o registro com os dados
C     nOpcao - indica qual op&ccedil;&atilde;o ser&aacute; mostrada
C     ------------------------------------------------------------------
      </i></font><font color="#0000FF">subroutine </font><font color="#000080">mostrarDados</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#000080">nOpcao</font><font color="#808080">)
      </font><font color="#0000FF">integer </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#000080">nOpcao
      </font><font color="#0000FF">character</font><font color="#808080">*</font><font color="#FF0000">255 </font><font color="#000080">slinha 

      </font><font color="#0000FF">include </font><font color="#800000">'livrus.h'
      </font><font color="#0000FF">character</font><font color="#808080">*</font><font color="#FF0000">255 </font><font color="#000080">rotulo</font><font color="#808080">, </font><font color="#000080">ftrim</font><font color="#808080">, </font><font color="#000080">copy</font><font color="#808080">, </font><font color="#000080">validaNumero</font><font color="#808080">, </font><font color="#000080">validaDataHora

      </font><font color="#0000FF">if </font><font color="#808080">(</font><font color="#000080">sreg </font><font color="#0000FF">.eq. </font><font color="#000080">opAssunto</font><font color="#808080">) </font><font color="#0000FF">then
         select case </font><font color="#808080">(</font><font color="#000080">nOpcao</font><font color="#808080">)
           </font><font color="#0000FF">case </font><font color="#808080">(</font><font color="#FF0000">1</font><font color="#808080">)
              </font><font color="#0000FF">write</font><font color="#808080">(*,*) </font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">), </font><font color="#000080">tAssunto_codigo
              </font><font color="#0000FF">write</font><font color="#808080">(*,*) </font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">)
              </font><font color="#0000FF">read</font><font color="#808080">(*,*) </font><font color="#000080">tAssunto_assunto
           </font><font color="#0000FF">case </font><font color="#808080">(</font><font color="#FF0000">2</font><font color="#808080">)
              </font><font color="#0000FF">write</font><font color="#808080">(*,*) </font><font color="#800000">'C&oacute;digo     Assunto'
              </font><font color="#0000FF">write</font><font color="#808080">(*,*) </font><font color="#800000">'------     -------'
           </font><font color="#0000FF">case </font><font color="#808080">(</font><font color="#FF0000">3</font><font color="#808080">)
              </font><font color="#000080">tAssunto_codigo</font><font color="#808080">=</font><font color="#000080">copy</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">)
              </font><font color="#000080">tAssunto_assunto</font><font color="#808080">=</font><font color="#000080">copy</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">11</font><font color="#808080">, </font><font color="#FF0000">30</font><font color="#808080">)
              </font><font color="#0000FF">write</font><font color="#808080">(*,*) </font><font color="#000080">tAssunto_codigo</font><font color="#808080">,</font><font color="#800000">' '</font><font color="#808080">,</font><font color="#000080">tAssunto_assunto
         </font><font color="#0000FF">end select
      else if </font><font color="#808080">(</font><font color="#000080">sreg </font><font color="#0000FF">.eq. </font><font color="#000080">opAutor</font><font color="#808080">) </font><font color="#0000FF">then
         select case </font><font color="#808080">(</font><font color="#000080">nOpcao</font><font color="#808080">)
           </font><font color="#0000FF">case </font><font color="#808080">(</font><font color="#FF0000">1</font><font color="#808080">)
              </font><font color="#0000FF">write</font><font color="#808080">(*,*) </font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">), </font><font color="#000080">tAutor_codigo
              </font><font color="#0000FF">write</font><font color="#808080">(*,*) </font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">)
              </font><font color="#0000FF">read</font><font color="#808080">(*,*) </font><font color="#000080">tAutor_autor
           </font><font color="#0000FF">case </font><font color="#808080">(</font><font color="#FF0000">2</font><font color="#808080">)
              </font><font color="#0000FF">write</font><font color="#808080">(*,*) </font><font color="#800000">'C&oacute;digo     Autor'
              </font><font color="#0000FF">write</font><font color="#808080">(*,*) </font><font color="#800000">'------     -----'
           </font><font color="#0000FF">case </font><font color="#808080">(</font><font color="#FF0000">3</font><font color="#808080">)
              </font><font color="#000080">tAutor_codigo</font><font color="#808080">=</font><font color="#000080">copy</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">)
              </font><font color="#000080">tAutor_autor</font><font color="#808080">=</font><font color="#000080">copy</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">11</font><font color="#808080">, </font><font color="#FF0000">30</font><font color="#808080">)
              </font><font color="#0000FF">write</font><font color="#808080">(*,*) </font><font color="#000080">tAutor_codigo</font><font color="#808080">,</font><font color="#800000">' '</font><font color="#808080">,</font><font color="#000080">tAutor_autor
         </font><font color="#0000FF">end select
      else if </font><font color="#808080">(</font><font color="#000080">sreg </font><font color="#0000FF">.eq. </font><font color="#000080">opEditora</font><font color="#808080">) </font><font color="#0000FF">then
         select case </font><font color="#808080">(</font><font color="#000080">nOpcao</font><font color="#808080">)
           </font><font color="#0000FF">case </font><font color="#808080">(</font><font color="#FF0000">1</font><font color="#808080">)
              </font><font color="#0000FF">write</font><font color="#808080">(*,*) </font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">), </font><font color="#000080">tEditora_codigo
              </font><font color="#0000FF">write</font><font color="#808080">(*,*) </font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">)
              </font><font color="#0000FF">read</font><font color="#808080">(*,*) </font><font color="#000080">tEditora_editora
           </font><font color="#0000FF">case </font><font color="#808080">(</font><font color="#FF0000">2</font><font color="#808080">)
              </font><font color="#0000FF">write</font><font color="#808080">(*,*) </font><font color="#800000">'C&oacute;digo     Editora'
              </font><font color="#0000FF">write</font><font color="#808080">(*,*) </font><font color="#800000">'------     -------'
           </font><font color="#0000FF">case </font><font color="#808080">(</font><font color="#FF0000">3</font><font color="#808080">)
              </font><font color="#000080">tEditora_codigo</font><font color="#808080">=</font><font color="#000080">copy</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">)
              </font><font color="#000080">tEditora_editora</font><font color="#808080">=</font><font color="#000080">copy</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">11</font><font color="#808080">, </font><font color="#FF0000">50</font><font color="#808080">)
              </font><font color="#0000FF">write</font><font color="#808080">(*,*) </font><font color="#000080">tEditora_codigo</font><font color="#808080">,</font><font color="#800000">' '</font><font color="#808080">,</font><font color="#000080">tEditora_editora
         </font><font color="#0000FF">end select
      else if </font><font color="#808080">(</font><font color="#000080">sreg </font><font color="#0000FF">.eq. </font><font color="#000080">opEndereco</font><font color="#808080">) </font><font color="#0000FF">then
         select case </font><font color="#808080">(</font><font color="#000080">nOpcao</font><font color="#808080">)
           </font><font color="#0000FF">case </font><font color="#808080">(</font><font color="#FF0000">1</font><font color="#808080">)
              </font><font color="#0000FF">write</font><font color="#808080">(*,*) </font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">), </font><font color="#000080">tEndereco_codigo
              </font><font color="#0000FF">write</font><font color="#808080">(*,*) </font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">)
              </font><font color="#0000FF">read</font><font color="#808080">(*,*) </font><font color="#000080">tEndereco_Logradouro
              </font><font color="#0000FF">write</font><font color="#808080">(*,*) </font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">)
              </font><font color="#0000FF">read</font><font color="#808080">(*,*) </font><font color="#000080">tEndereco_bairro
              </font><font color="#0000FF">write</font><font color="#808080">(*,*) </font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">4</font><font color="#808080">)
              </font><font color="#0000FF">read</font><font color="#808080">(*,*) </font><font color="#000080">tEndereco_cep
              </font><font color="#0000FF">write</font><font color="#808080">(*,*) </font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">5</font><font color="#808080">)
              </font><font color="#0000FF">read</font><font color="#808080">(*,*) </font><font color="#000080">tEndereco_cidade
              </font><font color="#0000FF">write</font><font color="#808080">(*,*) </font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">6</font><font color="#808080">)
              </font><font color="#0000FF">read</font><font color="#808080">(*,*) </font><font color="#000080">tEndereco_estado
           </font><font color="#0000FF">case </font><font color="#808080">(</font><font color="#FF0000">3</font><font color="#808080">)
              </font><font color="#000080">tEndereco_codigo</font><font color="#808080">=</font><font color="#000080">ftrim</font><font color="#808080">(</font><font color="#000080">copy</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">))
              </font><font color="#000080">tEndereco_logradouro</font><font color="#808080">=</font><font color="#000080">ftrim</font><font color="#808080">(</font><font color="#000080">copy</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">11</font><font color="#808080">, </font><font color="#FF0000">40</font><font color="#808080">))
              </font><font color="#000080">tEndereco_bairro</font><font color="#808080">=</font><font color="#000080">ftrim</font><font color="#808080">(</font><font color="#000080">copy</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">51</font><font color="#808080">, </font><font color="#FF0000">15</font><font color="#808080">))
              </font><font color="#000080">tEndereco_cep</font><font color="#808080">=</font><font color="#000080">ftrim</font><font color="#808080">(</font><font color="#000080">copy</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">66</font><font color="#808080">, </font><font color="#FF0000">8</font><font color="#808080">))
              </font><font color="#000080">tEndereco_cidade</font><font color="#808080">=</font><font color="#000080">ftrim</font><font color="#808080">(</font><font color="#000080">copy</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">74</font><font color="#808080">, </font><font color="#FF0000">30</font><font color="#808080">))
              </font><font color="#000080">tEndereco_estado</font><font color="#808080">=</font><font color="#000080">ftrim</font><font color="#808080">(</font><font color="#000080">copy</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">104</font><font color="#808080">, </font><font color="#FF0000">20</font><font color="#808080">))
              </font><font color="#0000FF">write</font><font color="#808080">(*,*) </font><font color="#800000">'--------------------'
              </font><font color="#0000FF">write</font><font color="#808080">(*,*) </font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">), </font><font color="#000080">tEndereco_codigo
              </font><font color="#0000FF">write</font><font color="#808080">(*,*) </font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">), </font><font color="#000080">tEndereco_Logradouro
              </font><font color="#0000FF">write</font><font color="#808080">(*,*) </font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">), </font><font color="#000080">tEndereco_bairro
              </font><font color="#0000FF">write</font><font color="#808080">(*,*) </font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">4</font><font color="#808080">), </font><font color="#000080">tEndereco_cep
              </font><font color="#0000FF">write</font><font color="#808080">(*,*) </font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">5</font><font color="#808080">), </font><font color="#000080">tEndereco_cidade
              </font><font color="#0000FF">write</font><font color="#808080">(*,*) </font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">6</font><font color="#808080">), </font><font color="#000080">tEndereco_estado
         </font><font color="#0000FF">end select
      else if </font><font color="#808080">(</font><font color="#000080">sreg </font><font color="#0000FF">.eq. </font><font color="#000080">opIdioma</font><font color="#808080">) </font><font color="#0000FF">then
         select case </font><font color="#808080">(</font><font color="#000080">nOpcao</font><font color="#808080">)
           </font><font color="#0000FF">case </font><font color="#808080">(</font><font color="#FF0000">1</font><font color="#808080">)
              </font><font color="#0000FF">write</font><font color="#808080">(*,*) </font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">), </font><font color="#000080">tIdioma_codigo
              </font><font color="#0000FF">write</font><font color="#808080">(*,*) </font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">)
              </font><font color="#0000FF">read</font><font color="#808080">(*,*) </font><font color="#000080">tIdioma_idioma
           </font><font color="#0000FF">case </font><font color="#808080">(</font><font color="#FF0000">2</font><font color="#808080">)
              </font><font color="#0000FF">write</font><font color="#808080">(*,*) </font><font color="#800000">'C&oacute;digo     Idioma'
              </font><font color="#0000FF">write</font><font color="#808080">(*,*) </font><font color="#800000">'------     ------'
           </font><font color="#0000FF">case </font><font color="#808080">(</font><font color="#FF0000">3</font><font color="#808080">)
              </font><font color="#000080">tIdioma_codigo</font><font color="#808080">=</font><font color="#000080">copy</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">)
              </font><font color="#000080">tIdioma_idioma</font><font color="#808080">=</font><font color="#000080">copy</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">11</font><font color="#808080">, </font><font color="#FF0000">20</font><font color="#808080">)
              </font><font color="#0000FF">write</font><font color="#808080">(*,*) </font><font color="#000080">tIdioma_codigo</font><font color="#808080">,</font><font color="#800000">' '</font><font color="#808080">,</font><font color="#000080">tIdioma_idioma
         </font><font color="#0000FF">end select
      else if </font><font color="#808080">(</font><font color="#000080">sreg </font><font color="#0000FF">.eq. </font><font color="#000080">opPais</font><font color="#808080">) </font><font color="#0000FF">then
         select case </font><font color="#808080">(</font><font color="#000080">nOpcao</font><font color="#808080">)
           </font><font color="#0000FF">case </font><font color="#808080">(</font><font color="#FF0000">1</font><font color="#808080">)
              </font><font color="#0000FF">write</font><font color="#808080">(*,*) </font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">)
              </font><font color="#0000FF">read</font><font color="#808080">(*,*) </font><font color="#000080">tPais_pais
           </font><font color="#0000FF">case </font><font color="#808080">(</font><font color="#FF0000">2</font><font color="#808080">)
              </font><font color="#0000FF">write</font><font color="#808080">(*,*) </font><font color="#800000">'C&oacute;digo Pa&iacute;s'
              </font><font color="#0000FF">write</font><font color="#808080">(*,*) </font><font color="#800000">'------ ----'
           </font><font color="#0000FF">case </font><font color="#808080">(</font><font color="#FF0000">3</font><font color="#808080">)
              </font><font color="#000080">tPais_codigo</font><font color="#808080">=</font><font color="#000080">copy</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">)
              </font><font color="#000080">tPais_pais</font><font color="#808080">=</font><font color="#000080">copy</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">4</font><font color="#808080">, </font><font color="#FF0000">50</font><font color="#808080">)
              </font><font color="#0000FF">write</font><font color="#808080">(*,*) </font><font color="#000080">tPais_codigo</font><font color="#808080">,</font><font color="#800000">'    '</font><font color="#808080">,</font><font color="#000080">tPais_pais
         </font><font color="#0000FF">end select
      else if </font><font color="#808080">(</font><font color="#000080">sreg </font><font color="#0000FF">.eq. </font><font color="#000080">opProfissao</font><font color="#808080">) </font><font color="#0000FF">then
         select case </font><font color="#808080">(</font><font color="#000080">nOpcao</font><font color="#808080">)
           </font><font color="#0000FF">case </font><font color="#808080">(</font><font color="#FF0000">1</font><font color="#808080">)
              </font><font color="#0000FF">write</font><font color="#808080">(*,*) </font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">), </font><font color="#000080">tProfissao_codigo
              </font><font color="#0000FF">write</font><font color="#808080">(*,*) </font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">)
              </font><font color="#0000FF">read</font><font color="#808080">(*,*) </font><font color="#000080">tProfissao_profissao
           </font><font color="#0000FF">case </font><font color="#808080">(</font><font color="#FF0000">2</font><font color="#808080">)
              </font><font color="#0000FF">write</font><font color="#808080">(*,*) </font><font color="#800000">'C&oacute;digo     Profiss&atilde;o'
              </font><font color="#0000FF">write</font><font color="#808080">(*,*) </font><font color="#800000">'------     ---------'
           </font><font color="#0000FF">case </font><font color="#808080">(</font><font color="#FF0000">3</font><font color="#808080">)
              </font><font color="#000080">tProfissao_codigo</font><font color="#808080">=</font><font color="#000080">copy</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">)
              </font><font color="#000080">tProfissao_profissao</font><font color="#808080">=</font><font color="#000080">copy</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">11</font><font color="#808080">, </font><font color="#FF0000">50</font><font color="#808080">)
              </font><font color="#0000FF">write</font><font color="#808080">(*,*) </font><font color="#000080">tProfissao_codigo</font><font color="#808080">,</font><font color="#800000">' '</font><font color="#808080">,</font><font color="#000080">tProfissao_profissao
         </font><font color="#0000FF">end select
      else if </font><font color="#808080">(</font><font color="#000080">sreg </font><font color="#0000FF">.eq. </font><font color="#000080">opLivro</font><font color="#808080">) </font><font color="#0000FF">then
         select case </font><font color="#808080">(</font><font color="#000080">nOpcao</font><font color="#808080">)
           </font><font color="#0000FF">case </font><font color="#808080">(</font><font color="#FF0000">1</font><font color="#808080">)
              </font><font color="#0000FF">write</font><font color="#808080">(*,*) </font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">)
              </font><font color="#0000FF">read</font><font color="#808080">(*,*) </font><font color="#000080">tLivro_titulo
              tLivro_edicao</font><font color="#808080">=</font><font color="#000080">validaNumero</font><font color="#808080">(</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">), </font><font color="#000080">tLivro_edicao</font><font color="#808080">)
              </font><font color="#000080">tLivro_anopubli</font><font color="#808080">=</font><font color="#000080">validaNumero</font><font color="#808080">(</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">4</font><font color="#808080">), 
     *         </font><font color="#000080">tLivro_anopubli</font><font color="#808080">)
              </font><font color="#0000FF">call </font><font color="#000080">mostrarSubDados</font><font color="#808080">(</font><font color="#000080">opLivro</font><font color="#808080">, </font><font color="#000080">opEditora</font><font color="#808080">, </font><font color="#0000FF">.false.</font><font color="#808080">)
              </font><font color="#000080">tLivro_volume</font><font color="#808080">=</font><font color="#000080">validaNumero</font><font color="#808080">(</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">6</font><font color="#808080">), </font><font color="#000080">tLivro_volume</font><font color="#808080">)
              </font><font color="#0000FF">call </font><font color="#000080">mostrarSubDados</font><font color="#808080">(</font><font color="#000080">opLivro</font><font color="#808080">, </font><font color="#000080">opIdioma</font><font color="#808080">, </font><font color="#0000FF">.false.</font><font color="#808080">)
              </font><font color="#000080">tLivro_npaginas</font><font color="#808080">=</font><font color="#000080">validaNumero</font><font color="#808080">(</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">8</font><font color="#808080">), 
     *         </font><font color="#000080">tLivro_npaginas</font><font color="#808080">)
              </font><font color="#000080">tLivro_preco</font><font color="#808080">=</font><font color="#000080">validaNumero</font><font color="#808080">(</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">9</font><font color="#808080">), </font><font color="#000080">tLivro_preco</font><font color="#808080">)
              </font><font color="#000080">tLivro_qtdestoque</font><font color="#808080">=</font><font color="#000080">validaNumero</font><font color="#808080">(</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">), 
     *         </font><font color="#000080">tLivro_qtdestoque</font><font color="#808080">)
           </font><font color="#0000FF">case </font><font color="#808080">(</font><font color="#FF0000">3</font><font color="#808080">)
              </font><font color="#000080">tLivro_isbn</font><font color="#808080">=</font><font color="#000080">ftrim</font><font color="#808080">(</font><font color="#000080">copy</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">13</font><font color="#808080">))
              </font><font color="#000080">tLivro_titulo</font><font color="#808080">=</font><font color="#000080">ftrim</font><font color="#808080">(</font><font color="#000080">copy</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">14</font><font color="#808080">, </font><font color="#FF0000">50</font><font color="#808080">))
              </font><font color="#000080">tLivro_edicao</font><font color="#808080">=</font><font color="#000080">ftrim</font><font color="#808080">(</font><font color="#000080">copy</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">64</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">))
              </font><font color="#000080">tLivro_anopubli</font><font color="#808080">=</font><font color="#000080">ftrim</font><font color="#808080">(</font><font color="#000080">copy</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">74</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">))
              </font><font color="#000080">tLivro_codeditora</font><font color="#808080">=</font><font color="#000080">ftrim</font><font color="#808080">(</font><font color="#000080">copy</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">84</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">))
              </font><font color="#000080">tLivro_volume</font><font color="#808080">=</font><font color="#000080">ftrim</font><font color="#808080">(</font><font color="#000080">copy</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">94</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">))
              </font><font color="#000080">tLivro_codidioma</font><font color="#808080">=</font><font color="#000080">ftrim</font><font color="#808080">(</font><font color="#000080">copy</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">104</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">))
              </font><font color="#000080">tLivro_npaginas</font><font color="#808080">=</font><font color="#000080">ftrim</font><font color="#808080">(</font><font color="#000080">copy</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">114</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">))
              </font><font color="#000080">tLivro_preco</font><font color="#808080">=</font><font color="#000080">ftrim</font><font color="#808080">(</font><font color="#000080">copy</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">124</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">))
              </font><font color="#000080">tLivro_qtdestoque</font><font color="#808080">=</font><font color="#000080">ftrim</font><font color="#808080">(</font><font color="#000080">copy</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">134</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">))
              </font><font color="#0000FF">write</font><font color="#808080">(*,*) </font><font color="#800000">'--------------------'
              </font><font color="#0000FF">write</font><font color="#808080">(*,*) </font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">), </font><font color="#000080">tLivro_isbn
              </font><font color="#0000FF">write</font><font color="#808080">(*,*) </font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">), </font><font color="#000080">tLivro_titulo
              </font><font color="#0000FF">write</font><font color="#808080">(*,*) </font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">), </font><font color="#000080">tLivro_edicao
              </font><font color="#0000FF">write</font><font color="#808080">(*,*) </font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">4</font><font color="#808080">), </font><font color="#000080">tLivro_anopubli
              </font><font color="#0000FF">write</font><font color="#808080">(*,*) </font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">5</font><font color="#808080">), </font><font color="#000080">tLivro_codeditora
              </font><font color="#0000FF">call </font><font color="#000080">mostrarSubDados</font><font color="#808080">(</font><font color="#000080">opLivro</font><font color="#808080">, </font><font color="#000080">opEditora</font><font color="#808080">, </font><font color="#0000FF">.true.</font><font color="#808080">)
              </font><font color="#0000FF">write</font><font color="#808080">(*,*) </font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">6</font><font color="#808080">), </font><font color="#000080">tLivro_volume
              </font><font color="#0000FF">write</font><font color="#808080">(*,*) </font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">7</font><font color="#808080">), </font><font color="#000080">tLivro_codidioma
              </font><font color="#0000FF">call </font><font color="#000080">mostrarSubDados</font><font color="#808080">(</font><font color="#000080">opLivro</font><font color="#808080">, </font><font color="#000080">opIdioma</font><font color="#808080">, </font><font color="#0000FF">.true.</font><font color="#808080">)
              </font><font color="#0000FF">write</font><font color="#808080">(*,*) </font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">8</font><font color="#808080">), </font><font color="#000080">tLivro_npaginas
              </font><font color="#0000FF">write</font><font color="#808080">(*,*) </font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">9</font><font color="#808080">), </font><font color="#000080">tLivro_preco
              </font><font color="#0000FF">write</font><font color="#808080">(*,*) </font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">), </font><font color="#000080">tLivro_qtdestoque
              </font><font color="#0000FF">call </font><font color="#000080">ListarRegLigados</font><font color="#808080">(</font><font color="#000080">tfLivroAss</font><font color="#808080">, </font><font color="#000080">opLivroAss</font><font color="#808080">, 
     *         </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">13</font><font color="#808080">, </font><font color="#FF0000">14</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">, </font><font color="#000080">tLivro_isbn</font><font color="#808080">, </font><font color="#000080">tfAssunto</font><font color="#808080">, </font><font color="#000080">opAssunto</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">4</font><font color="#808080">)
              </font><font color="#0000FF">call </font><font color="#000080">ListarRegLigados</font><font color="#808080">(</font><font color="#000080">tfLivroAut</font><font color="#808080">, </font><font color="#000080">opLivroAut</font><font color="#808080">, 
     *         </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">13</font><font color="#808080">, </font><font color="#FF0000">14</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">, </font><font color="#000080">tLivro_isbn</font><font color="#808080">, </font><font color="#000080">tfAutor</font><font color="#808080">, </font><font color="#000080">opAutor</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">4</font><font color="#808080">)
         </font><font color="#0000FF">end select
      else if </font><font color="#808080">(</font><font color="#000080">sreg </font><font color="#0000FF">.eq. </font><font color="#000080">opCliente</font><font color="#808080">) </font><font color="#0000FF">then
         select case </font><font color="#808080">(</font><font color="#000080">nOpcao</font><font color="#808080">)
           </font><font color="#0000FF">case </font><font color="#808080">(</font><font color="#FF0000">1</font><font color="#808080">)
              </font><font color="#0000FF">write</font><font color="#808080">(*,*) </font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">)
              </font><font color="#0000FF">read</font><font color="#808080">(*,*) </font><font color="#000080">tCliente_nome
              </font><font color="#0000FF">write</font><font color="#808080">(*,*) </font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">)
              </font><font color="#0000FF">read</font><font color="#808080">(*,*) </font><font color="#000080">tCliente_email
              </font><font color="#0000FF">write</font><font color="#808080">(*,*) </font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">4</font><font color="#808080">)
              </font><font color="#0000FF">read</font><font color="#808080">(*,*) </font><font color="#000080">tCliente_identidade
              </font><font color="#0000FF">write</font><font color="#808080">(*,*) </font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">5</font><font color="#808080">)
              </font><font color="#0000FF">read</font><font color="#808080">(*,*) </font><font color="#000080">tCliente_sexo
              </font><font color="#0000FF">write</font><font color="#808080">(*,*) </font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">6</font><font color="#808080">)
              </font><font color="#0000FF">read</font><font color="#808080">(*,*) </font><font color="#000080">tCliente_telefone
              tCliente_dtnascimento</font><font color="#808080">=</font><font color="#000080">validaDataHora</font><font color="#808080">(</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">7</font><font color="#808080">), 
     *         </font><font color="#000080">tCliente_dtnascimento</font><font color="#808080">, </font><font color="#0000FF">.true.</font><font color="#808080">)
              </font><font color="#0000FF">call </font><font color="#000080">mostrarSubDados</font><font color="#808080">(</font><font color="#000080">opCliente</font><font color="#808080">, </font><font color="#000080">opEndereco</font><font color="#808080">, </font><font color="#0000FF">.false.</font><font color="#808080">)
              </font><font color="#0000FF">call </font><font color="#000080">mostrarSubDados</font><font color="#808080">(</font><font color="#000080">opCliente</font><font color="#808080">, </font><font color="#000080">opPais</font><font color="#808080">, </font><font color="#0000FF">.false.</font><font color="#808080">)
              </font><font color="#0000FF">call </font><font color="#000080">mostrarSubDados</font><font color="#808080">(</font><font color="#000080">opCliente</font><font color="#808080">, </font><font color="#000080">opProfissao</font><font color="#808080">, </font><font color="#0000FF">.false.</font><font color="#808080">)
           </font><font color="#0000FF">case </font><font color="#808080">(</font><font color="#FF0000">3</font><font color="#808080">)
              </font><font color="#000080">tCliente_cpf</font><font color="#808080">=</font><font color="#000080">ftrim</font><font color="#808080">(</font><font color="#000080">copy</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">14</font><font color="#808080">))
              </font><font color="#000080">tCliente_nome</font><font color="#808080">=</font><font color="#000080">ftrim</font><font color="#808080">(</font><font color="#000080">copy</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">15</font><font color="#808080">, </font><font color="#FF0000">30</font><font color="#808080">))
              </font><font color="#000080">tCliente_email</font><font color="#808080">=</font><font color="#000080">ftrim</font><font color="#808080">(</font><font color="#000080">copy</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">45</font><font color="#808080">, </font><font color="#FF0000">30</font><font color="#808080">))
              </font><font color="#000080">tCliente_identidade</font><font color="#808080">=</font><font color="#000080">ftrim</font><font color="#808080">(</font><font color="#000080">copy</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">75</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">))
              </font><font color="#000080">tCliente_sexo</font><font color="#808080">=</font><font color="#000080">ftrim</font><font color="#808080">(</font><font color="#000080">copy</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">85</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">))
              </font><font color="#000080">tCliente_telefone</font><font color="#808080">=</font><font color="#000080">ftrim</font><font color="#808080">(</font><font color="#000080">copy</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">86</font><font color="#808080">, </font><font color="#FF0000">17</font><font color="#808080">))
              </font><font color="#000080">tCliente_dtnascimento</font><font color="#808080">=</font><font color="#000080">ftrim</font><font color="#808080">(</font><font color="#000080">copy</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">103</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">))
              </font><font color="#000080">tCliente_codendereco</font><font color="#808080">=</font><font color="#000080">ftrim</font><font color="#808080">(</font><font color="#000080">copy</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">113</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">))
              </font><font color="#000080">tCliente_codpais</font><font color="#808080">=</font><font color="#000080">ftrim</font><font color="#808080">(</font><font color="#000080">copy</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">123</font><font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">))
              </font><font color="#000080">tCliente_codprofissao</font><font color="#808080">=</font><font color="#000080">ftrim</font><font color="#808080">(</font><font color="#000080">copy</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">126</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">))
              </font><font color="#0000FF">write</font><font color="#808080">(*,*) </font><font color="#800000">'--------------------'
              </font><font color="#0000FF">write</font><font color="#808080">(*,*) </font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">), </font><font color="#000080">tCliente_cpf
              </font><font color="#0000FF">write</font><font color="#808080">(*,*) </font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">), </font><font color="#000080">tCliente_nome
              </font><font color="#0000FF">write</font><font color="#808080">(*,*) </font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">), </font><font color="#000080">tCliente_email
              </font><font color="#0000FF">write</font><font color="#808080">(*,*) </font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">4</font><font color="#808080">), </font><font color="#000080">tCliente_identidade
              </font><font color="#0000FF">write</font><font color="#808080">(*,*) </font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">5</font><font color="#808080">), </font><font color="#000080">tCliente_sexo
              </font><font color="#0000FF">write</font><font color="#808080">(*,*) </font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">6</font><font color="#808080">), </font><font color="#000080">tCliente_telefone
              </font><font color="#0000FF">write</font><font color="#808080">(*,*) </font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">7</font><font color="#808080">), </font><font color="#000080">tCliente_dtnascimento
              </font><font color="#0000FF">write</font><font color="#808080">(*,*) </font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">8</font><font color="#808080">), </font><font color="#000080">tCliente_codendereco
              </font><font color="#0000FF">call </font><font color="#000080">mostrarSubDados</font><font color="#808080">(</font><font color="#000080">opCliente</font><font color="#808080">, </font><font color="#000080">opEndereco</font><font color="#808080">, </font><font color="#0000FF">.true.</font><font color="#808080">)
              </font><font color="#0000FF">write</font><font color="#808080">(*,*) </font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">9</font><font color="#808080">), </font><font color="#000080">tCliente_codpais
              </font><font color="#0000FF">call </font><font color="#000080">mostrarSubDados</font><font color="#808080">(</font><font color="#000080">opCliente</font><font color="#808080">, </font><font color="#000080">opPais</font><font color="#808080">, </font><font color="#0000FF">.true.</font><font color="#808080">)
              </font><font color="#0000FF">write</font><font color="#808080">(*,*) </font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">), </font><font color="#000080">tCliente_codprofissao
              </font><font color="#0000FF">call </font><font color="#000080">mostrarSubDados</font><font color="#808080">(</font><font color="#000080">opCliente</font><font color="#808080">, </font><font color="#000080">opProfissao</font><font color="#808080">, </font><font color="#0000FF">.true.</font><font color="#808080">)
         </font><font color="#0000FF">end select
      else if </font><font color="#808080">(</font><font color="#000080">sreg </font><font color="#0000FF">.eq. </font><font color="#000080">opVenda</font><font color="#808080">) </font><font color="#0000FF">then
         select case </font><font color="#808080">(</font><font color="#000080">nOpcao</font><font color="#808080">)
           </font><font color="#0000FF">case </font><font color="#808080">(</font><font color="#FF0000">1</font><font color="#808080">) 
              </font><font color="#0000FF">call </font><font color="#000080">mostrarSubDados</font><font color="#808080">(</font><font color="#000080">opVenda</font><font color="#808080">,</font><font color="#000080">opVenda</font><font color="#808080">, </font><font color="#0000FF">.false.</font><font color="#808080">)
           </font><font color="#0000FF">case </font><font color="#808080">(</font><font color="#FF0000">2</font><font color="#808080">)
              </font><font color="#0000FF">write</font><font color="#808080">(*,*) </font><font color="#800000">'DataHoraVenda       CPF            ISBN       
     </font><font color="#808080">*   </font><font color="#000080">Pre&ccedil;oVenda</font><font color="#800000">'
              </font><font color="#0000FF">write</font><font color="#808080">(*,*) </font><font color="#800000">'-------------       ---            ----       
     </font><font color="#808080">*   ----------</font><font color="#800000">'
           </font><font color="#0000FF">case </font><font color="#808080">(</font><font color="#FF0000">3</font><font color="#808080">)
              </font><font color="#000080">tVenda_dthrvenda</font><font color="#808080">=</font><font color="#000080">copy</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">19</font><font color="#808080">)
              </font><font color="#000080">tVenda_cpf</font><font color="#808080">=</font><font color="#000080">copy</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">20</font><font color="#808080">, </font><font color="#FF0000">14</font><font color="#808080">)
              </font><font color="#000080">tVenda_isbn</font><font color="#808080">=</font><font color="#000080">copy</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">34</font><font color="#808080">, </font><font color="#FF0000">13</font><font color="#808080">)
              </font><font color="#000080">tVenda_precovenda</font><font color="#808080">=</font><font color="#000080">copy</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">47</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">)
              </font><font color="#0000FF">write</font><font color="#808080">(*,*) </font><font color="#000080">tVenda_dthrvenda</font><font color="#808080">,</font><font color="#800000">' '</font><font color="#808080">,</font><font color="#000080">tVenda_cpf</font><font color="#808080">,</font><font color="#800000">' '</font><font color="#808080">,
     *         </font><font color="#000080">tVenda_isbn</font><font color="#808080">,</font><font color="#800000">' '</font><font color="#808080">,</font><font color="#000080">tVenda_precovenda
         </font><font color="#0000FF">end select
      end if
      return
      end
</font><font color="#808080"><i>C     ------------------------------------------------------------------
C     Mostra as sub inform&ccedil;&otilde;es de entrada e de sa&iacute;da.
C     sreg - o tipo de arquivo
C     ssubreg - o subtipo de arquivo
C     bSoMostrar - se vai s&oacute; mostrar na sa&iacute;da 
C     ------------------------------------------------------------------
      </i></font><font color="#0000FF">subroutine </font><font color="#000080">mostrarSubDados</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#000080">ssubreg</font><font color="#808080">, </font><font color="#000080">bSoMostrar</font><font color="#808080">)
      </font><font color="#0000FF">integer </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#000080">ssubreg
      </font><font color="#0000FF">logical </font><font color="#000080">bSoMostrar

      </font><font color="#0000FF">include </font><font color="#800000">'livrus.h'
      </font><font color="#0000FF">character</font><font color="#808080">*</font><font color="#FF0000">255 </font><font color="#000080">sRegistro</font><font color="#808080">, </font><font color="#000080">sPreco</font><font color="#808080">, </font><font color="#000080">pesqArq</font><font color="#808080">, 
     * </font><font color="#000080">validaEntrada</font><font color="#808080">, </font><font color="#000080">ftrim</font><font color="#808080">, </font><font color="#000080">copy</font><font color="#808080">, </font><font color="#000080">rotulo
      </font><font color="#0000FF">integer </font><font color="#000080">nMaxTentativas</font><font color="#808080">, </font><font color="#000080">tamReg

      nMaxTentativas</font><font color="#808080">=</font><font color="#FF0000">3
      </font><font color="#0000FF">if </font><font color="#808080">(</font><font color="#000080">sreg </font><font color="#0000FF">.eq. </font><font color="#000080">opLivro</font><font color="#808080">) </font><font color="#0000FF">then
        if </font><font color="#808080">(</font><font color="#000080">sreg </font><font color="#0000FF">.eq. </font><font color="#000080">opEditora</font><font color="#808080">) </font><font color="#0000FF">then
          if </font><font color="#808080">(</font><font color="#000080">bSoMostrar .eqv. </font><font color="#0000FF">.true.</font><font color="#808080">) </font><font color="#0000FF">then
             </font><font color="#000080">sRegistro</font><font color="#808080">=</font><font color="#000080">pesqArq</font><font color="#808080">(</font><font color="#000080">tfEditora</font><font color="#808080">,</font><font color="#000080">tLivro_codeditora</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">,
     *        </font><font color="#000080">tamReg</font><font color="#808080">(</font><font color="#000080">opEditora</font><font color="#808080">))
          </font><font color="#0000FF">else
             </font><font color="#000080">sRegistro</font><font color="#808080">=</font><font color="#000080">validaEntrada</font><font color="#808080">(</font><font color="#000080">tfEditora</font><font color="#808080">,</font><font color="#000080">ssubreg</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,
     *        </font><font color="#000080">tLivro_codeditora</font><font color="#808080">,</font><font color="#000080">nMaxTentativas</font><font color="#808080">,</font><font color="#0000FF">.false.</font><font color="#808080">,</font><font color="#000080">opNumero</font><font color="#808080">)
          </font><font color="#0000FF">end if  
          if </font><font color="#808080">(</font><font color="#000080">sRegistro </font><font color="#0000FF">.ne. </font><font color="#800000">''</font><font color="#808080">) </font><font color="#0000FF">then
            </font><font color="#000080">tLivro_codeditora</font><font color="#808080">=</font><font color="#000080">ftrim</font><font color="#808080">(</font><font color="#000080">copy</font><font color="#808080">(</font><font color="#000080">sRegistro</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">))
            </font><font color="#0000FF">write</font><font color="#808080">(*,*) </font><font color="#800000">' '</font><font color="#808080">,</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">opEditora</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">)
            </font><font color="#0000FF">write</font><font color="#808080">(*,*) </font><font color="#000080">copy</font><font color="#808080">(</font><font color="#000080">sRegistro</font><font color="#808080">, </font><font color="#000080">g_nPosChave</font><font color="#808080">, </font><font color="#000080">g_nTamChave</font><font color="#808080">)
          </font><font color="#0000FF">end if
        else if </font><font color="#808080">(</font><font color="#000080">ssubreg </font><font color="#0000FF">.eq. </font><font color="#000080">opIdioma</font><font color="#808080">) </font><font color="#0000FF">then
          if </font><font color="#808080">(</font><font color="#000080">bSoMostrar .eqv. </font><font color="#0000FF">.true.</font><font color="#808080">) </font><font color="#0000FF">then
             </font><font color="#000080">sRegistro</font><font color="#808080">=</font><font color="#000080">pesqArq</font><font color="#808080">(</font><font color="#000080">tfIdioma</font><font color="#808080">, </font><font color="#000080">tLivro_codidioma</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">,
     *        </font><font color="#000080">tamReg</font><font color="#808080">(</font><font color="#000080">opIdioma</font><font color="#808080">))
          </font><font color="#0000FF">else
             </font><font color="#000080">sRegistro</font><font color="#808080">=</font><font color="#000080">validaEntrada</font><font color="#808080">(</font><font color="#000080">tfIdioma</font><font color="#808080">,</font><font color="#000080">ssubreg</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,
     *        </font><font color="#000080">tLivro_codidioma</font><font color="#808080">,</font><font color="#000080">nMaxTentativas</font><font color="#808080">,</font><font color="#0000FF">.false.</font><font color="#808080">,</font><font color="#000080">opNumero</font><font color="#808080">)
          </font><font color="#0000FF">end if  
          if </font><font color="#808080">(</font><font color="#000080">sRegistro </font><font color="#0000FF">.ne. </font><font color="#800000">''</font><font color="#808080">) </font><font color="#0000FF">then
            </font><font color="#000080">tLivro_codidioma</font><font color="#808080">=</font><font color="#000080">ftrim</font><font color="#808080">(</font><font color="#000080">copy</font><font color="#808080">(</font><font color="#000080">sRegistro</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">))
            </font><font color="#0000FF">write</font><font color="#808080">(*,*) </font><font color="#800000">' '</font><font color="#808080">,</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">opIdioma</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">)
            </font><font color="#0000FF">write</font><font color="#808080">(*,*) </font><font color="#000080">copy</font><font color="#808080">(</font><font color="#000080">sRegistro</font><font color="#808080">, </font><font color="#000080">g_nPosChave</font><font color="#808080">, </font><font color="#000080">g_nTamChave</font><font color="#808080">)
          </font><font color="#0000FF">end if
        end if
      else if </font><font color="#808080">(</font><font color="#000080">sreg </font><font color="#0000FF">.eq. </font><font color="#000080">opCliente</font><font color="#808080">) </font><font color="#0000FF">then
        if </font><font color="#808080">(</font><font color="#000080">ssubreg </font><font color="#0000FF">.eq. </font><font color="#000080">opEndereco</font><font color="#808080">) </font><font color="#0000FF">then
          if </font><font color="#808080">(</font><font color="#000080">bSoMostrar .eqv. </font><font color="#0000FF">.true.</font><font color="#808080">) </font><font color="#0000FF">then
             </font><font color="#000080">sRegistro</font><font color="#808080">=</font><font color="#000080">pesqArq</font><font color="#808080">(</font><font color="#000080">tfEndereco</font><font color="#808080">, </font><font color="#000080">tCliente_codendereco</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">,
     *                 </font><font color="#000080">tamReg</font><font color="#808080">(</font><font color="#000080">opEndereco</font><font color="#808080">))
          </font><font color="#0000FF">else
             </font><font color="#000080">sRegistro</font><font color="#808080">=</font><font color="#000080">validaEntrada</font><font color="#808080">(</font><font color="#000080">tfEndereco</font><font color="#808080">,</font><font color="#000080">ssubreg</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,
     *       </font><font color="#000080">tCliente_codendereco</font><font color="#808080">,</font><font color="#000080">nMaxTentativas</font><font color="#808080">,</font><font color="#0000FF">.false.</font><font color="#808080">,</font><font color="#000080">opNumero</font><font color="#808080">)
          </font><font color="#0000FF">end if  
          if </font><font color="#808080">(</font><font color="#000080">sRegistro</font><font color="#0000FF">.ne.</font><font color="#800000">''</font><font color="#808080">) </font><font color="#0000FF">then
            </font><font color="#000080">tCliente_codendereco</font><font color="#808080">=</font><font color="#000080">ftrim</font><font color="#808080">(</font><font color="#000080">copy</font><font color="#808080">(</font><font color="#000080">sRegistro</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">))
            </font><font color="#0000FF">write</font><font color="#808080">(*,*) </font><font color="#800000">' '</font><font color="#808080">,</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">opEndereco</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">)
            </font><font color="#0000FF">write</font><font color="#808080">(*,*) </font><font color="#000080">copy</font><font color="#808080">(</font><font color="#000080">sRegistro</font><font color="#808080">, </font><font color="#000080">g_nPosChave</font><font color="#808080">, </font><font color="#000080">g_nTamChave</font><font color="#808080">)
            </font><font color="#0000FF">write</font><font color="#808080">(*,*) </font><font color="#800000">' '</font><font color="#808080">,</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">opEndereco</font><font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">)
            </font><font color="#0000FF">write</font><font color="#808080">(*,*) </font><font color="#000080">copy</font><font color="#808080">(</font><font color="#000080">sRegistro</font><font color="#808080">, </font><font color="#000080">g_nPosChave</font><font color="#808080">, </font><font color="#000080">g_nTamChave</font><font color="#808080">)
            </font><font color="#0000FF">write</font><font color="#808080">(*,*) </font><font color="#800000">' '</font><font color="#808080">,</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">opEndereco</font><font color="#808080">, </font><font color="#FF0000">4</font><font color="#808080">)
            </font><font color="#0000FF">write</font><font color="#808080">(*,*) </font><font color="#000080">copy</font><font color="#808080">(</font><font color="#000080">sRegistro</font><font color="#808080">, </font><font color="#000080">g_nPosChave</font><font color="#808080">, </font><font color="#000080">g_nTamChave</font><font color="#808080">)
            </font><font color="#0000FF">write</font><font color="#808080">(*,*) </font><font color="#800000">' '</font><font color="#808080">,</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">opEndereco</font><font color="#808080">, </font><font color="#FF0000">5</font><font color="#808080">)
            </font><font color="#0000FF">write</font><font color="#808080">(*,*) </font><font color="#000080">copy</font><font color="#808080">(</font><font color="#000080">sRegistro</font><font color="#808080">, </font><font color="#000080">g_nPosChave</font><font color="#808080">, </font><font color="#000080">g_nTamChave</font><font color="#808080">)
            </font><font color="#0000FF">write</font><font color="#808080">(*,*) </font><font color="#800000">' '</font><font color="#808080">,</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">opEndereco</font><font color="#808080">, </font><font color="#FF0000">6</font><font color="#808080">)
            </font><font color="#0000FF">write</font><font color="#808080">(*,*) </font><font color="#000080">copy</font><font color="#808080">(</font><font color="#000080">sRegistro</font><font color="#808080">, </font><font color="#000080">g_nPosChave</font><font color="#808080">, </font><font color="#000080">g_nTamChave</font><font color="#808080">)
          </font><font color="#0000FF">end if
        else if </font><font color="#808080">(</font><font color="#000080">ssubreg </font><font color="#0000FF">.eq. </font><font color="#000080">opPais</font><font color="#808080">) </font><font color="#0000FF">then
          if </font><font color="#808080">(</font><font color="#000080">bSoMostrar .eqv. </font><font color="#0000FF">.true.</font><font color="#808080">) </font><font color="#0000FF">then
             </font><font color="#000080">sRegistro</font><font color="#808080">=</font><font color="#000080">pesqArq</font><font color="#808080">(</font><font color="#000080">tfPais</font><font color="#808080">, </font><font color="#000080">tCliente_codpais</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">, 
     *        </font><font color="#000080">tamReg</font><font color="#808080">(</font><font color="#000080">opPais</font><font color="#808080">))
          </font><font color="#0000FF">else
             </font><font color="#000080">sRegistro</font><font color="#808080">=</font><font color="#000080">validaEntrada</font><font color="#808080">(</font><font color="#000080">tfPais</font><font color="#808080">,</font><font color="#000080">ssubreg</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#000080">tCliente_codpais</font><font color="#808080">,
     *                   </font><font color="#000080">nMaxTentativas</font><font color="#808080">,</font><font color="#0000FF">.false.</font><font color="#808080">,</font><font color="#000080">opTexto</font><font color="#808080">)
          </font><font color="#0000FF">end if
          if </font><font color="#808080">(</font><font color="#000080">sRegistro</font><font color="#0000FF">.ne.</font><font color="#800000">''</font><font color="#808080">) </font><font color="#0000FF">then
            </font><font color="#000080">tCliente_codpais</font><font color="#808080">=</font><font color="#000080">ftrim</font><font color="#808080">(</font><font color="#000080">copy</font><font color="#808080">(</font><font color="#000080">sRegistro</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#FF0000">3</font><font color="#808080">))
            </font><font color="#0000FF">write</font><font color="#808080">(*,*) </font><font color="#800000">' '</font><font color="#808080">,</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">opPais</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">)
            </font><font color="#0000FF">write</font><font color="#808080">(*,*) </font><font color="#000080">copy</font><font color="#808080">(</font><font color="#000080">sRegistro</font><font color="#808080">, </font><font color="#000080">g_nPosChave</font><font color="#808080">, </font><font color="#000080">g_nTamChave</font><font color="#808080">)
          </font><font color="#0000FF">end if
        else if </font><font color="#808080">(</font><font color="#000080">ssubreg </font><font color="#0000FF">.eq. </font><font color="#000080">opProfissao</font><font color="#808080">) </font><font color="#0000FF">then
          if </font><font color="#808080">(</font><font color="#000080">bSoMostrar .eqv. </font><font color="#0000FF">.true.</font><font color="#808080">) </font><font color="#0000FF">then
             </font><font color="#000080">sRegistro</font><font color="#808080">=</font><font color="#000080">pesqArq</font><font color="#808080">(</font><font color="#000080">tfProfissao</font><font color="#808080">,</font><font color="#000080">tCliente_codprofissao</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">,
     *                  </font><font color="#000080">tamReg</font><font color="#808080">(</font><font color="#000080">opProfissao</font><font color="#808080">))
          </font><font color="#0000FF">else
             </font><font color="#000080">sRegistro</font><font color="#808080">=</font><font color="#000080">validaEntrada</font><font color="#808080">(</font><font color="#000080">tfProfissao</font><font color="#808080">,</font><font color="#000080">ssubreg</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,
     *       </font><font color="#000080">tCliente_codprofissao</font><font color="#808080">,</font><font color="#000080">nMaxTentativas</font><font color="#808080">,</font><font color="#0000FF">.false.</font><font color="#808080">,</font><font color="#000080">opNumero</font><font color="#808080">)
          </font><font color="#0000FF">end if
          if </font><font color="#808080">(</font><font color="#000080">sRegistro</font><font color="#0000FF">.ne.</font><font color="#800000">''</font><font color="#808080">) </font><font color="#0000FF">then
            </font><font color="#000080">tCliente_codprofissao</font><font color="#808080">=</font><font color="#000080">ftrim</font><font color="#808080">(</font><font color="#000080">copy</font><font color="#808080">(</font><font color="#000080">sRegistro</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">))
            </font><font color="#0000FF">write</font><font color="#808080">(*,*) </font><font color="#800000">' '</font><font color="#808080">,</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">opProfissao</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">)
            </font><font color="#0000FF">write</font><font color="#808080">(*,*) </font><font color="#000080">copy</font><font color="#808080">(</font><font color="#000080">sRegistro</font><font color="#808080">, </font><font color="#000080">g_nPosChave</font><font color="#808080">, </font><font color="#000080">g_nTamChave</font><font color="#808080">)
          </font><font color="#0000FF">end if
        end if
      else if </font><font color="#808080">(</font><font color="#000080">sreg </font><font color="#0000FF">.eq. </font><font color="#000080">opVenda</font><font color="#808080">) </font><font color="#0000FF">then
        </font><font color="#000080">sRegistro</font><font color="#808080">=</font><font color="#000080">pesqArq</font><font color="#808080">(</font><font color="#000080">tfLivro</font><font color="#808080">, </font><font color="#000080">tVenda_isbn</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">13</font><font color="#808080">,</font><font color="#000080">tamReg</font><font color="#808080">(</font><font color="#000080">opLivro</font><font color="#808080">))
        </font><font color="#0000FF">if </font><font color="#808080">(</font><font color="#000080">sRegistro</font><font color="#0000FF">.ne.</font><font color="#800000">''</font><font color="#808080">) </font><font color="#0000FF">then
          write</font><font color="#808080">(*,*) </font><font color="#800000">' '</font><font color="#808080">,</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">opLivro</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">)
          </font><font color="#0000FF">write</font><font color="#808080">(*,*) </font><font color="#000080">copy</font><font color="#808080">(</font><font color="#000080">sRegistro</font><font color="#808080">, </font><font color="#000080">g_nPosChave</font><font color="#808080">, </font><font color="#000080">g_nTamChave</font><font color="#808080">)
          </font><font color="#0000FF">write</font><font color="#808080">(*,*) </font><font color="#800000">' '</font><font color="#808080">,</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">opLivro</font><font color="#808080">, </font><font color="#FF0000">9</font><font color="#808080">)
          </font><font color="#000080">sPreco</font><font color="#808080">=</font><font color="#000080">copy</font><font color="#808080">(</font><font color="#000080">sRegistro</font><font color="#808080">, </font><font color="#000080">g_nPosChave</font><font color="#808080">, </font><font color="#000080">g_nTamChave</font><font color="#808080">)
<i>C          g_nPreco = FloatToStr(sPreco)
          </i></font><font color="#0000FF">write</font><font color="#808080">(*,*) </font><font color="#000080">sPreco
        </font><font color="#0000FF">end if
      end if
      return
      end
</font><font color="#808080"><i>C     ------------------------------------------------------------------
C     Realiza os cadastros dos arquivos que se ligam a outros arquivos.
C     sreg - o tipo de arquivo
C     sacao - a a&ccedil;&atilde;o a ser realizada
C     sCodigo - um das chaves do arquivo de liga&ccedil;&atilde;o
C     ------------------------------------------------------------------
      </i></font><font color="#0000FF">subroutine </font><font color="#000080">frmCadLigados</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#000080">sacao</font><font color="#808080">, </font><font color="#000080">sCodigo</font><font color="#808080">)
      </font><font color="#0000FF">integer </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#000080">sacao 
      </font><font color="#0000FF">character</font><font color="#808080">*</font><font color="#FF0000">255 </font><font color="#000080">sCodigo

      </font><font color="#0000FF">include </font><font color="#800000">'livrus.h'
      </font><font color="#0000FF">integer </font><font color="#000080">nQtd</font><font color="#808080">, </font><font color="#000080">nCont</font><font color="#808080">, </font><font color="#000080">nQtdEstoque</font><font color="#808080">, </font><font color="#000080">tamReg</font><font color="#808080">, </font><font color="#000080">StrToInt
      </font><font color="#0000FF">real </font><font color="#000080">nTotalPreco
      </font><font color="#0000FF">character</font><font color="#808080">*</font><font color="#FF0000">255 </font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#000080">sTotalPreco</font><font color="#808080">, </font><font color="#000080">sPreco</font><font color="#808080">, </font><font color="#000080">sQtd</font><font color="#808080">, </font><font color="#000080">rotulo</font><font color="#808080">,
     * </font><font color="#000080">pesqArq</font><font color="#808080">, </font><font color="#000080">validaNumero</font><font color="#808080">, </font><font color="#000080">ftrim</font><font color="#808080">, </font><font color="#000080">copy</font><font color="#808080">, </font><font color="#000080">IntToStr</font><font color="#808080">, </font><font color="#000080">validaEntrada</font><font color="#808080">, </font><font color="#000080">esp
      </font><font color="#0000FF">logical </font><font color="#000080">validaISBN

      </font><font color="#0000FF">if </font><font color="#808080">(</font><font color="#000080">sacao </font><font color="#0000FF">.eq. </font><font color="#000080">opNovo</font><font color="#808080">) </font><font color="#0000FF">then
        </font><font color="#000080">nCont</font><font color="#808080">=</font><font color="#FF0000">1
        </font><font color="#0000FF">if </font><font color="#808080">(</font><font color="#000080">sreg </font><font color="#0000FF">.eq. </font><font color="#000080">opLivroAss</font><font color="#808080">) </font><font color="#0000FF">then
          </font><font color="#000080">sQtd</font><font color="#808080">=</font><font color="#000080">validaNumero</font><font color="#808080">(</font><font color="#800000">'Quantos assuntos quer cadastrar?: '</font><font color="#808080">, </font><font color="#000080">sQtd</font><font color="#808080">)
          </font><font color="#000080">nQtd</font><font color="#808080">=</font><font color="#000080">StrToInt</font><font color="#808080">(</font><font color="#000080">sQtd</font><font color="#808080">)
<i>C          seek(tfLivroAss, 0)
          </i></font><font color="#0000FF">do while </font><font color="#808080">(</font><font color="#000080">nCont </font><font color="#0000FF">.le. </font><font color="#000080">nQtd</font><font color="#808080">)
            </font><font color="#000080">tLivroAss_isbn</font><font color="#808080">=</font><font color="#000080">sCodigo
            </font><font color="#0000FF">write</font><font color="#808080">(*,*) </font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">opLivroAss</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">)
            </font><font color="#0000FF">read</font><font color="#808080">(*,*) </font><font color="#000080">tLivroAss_codassunto
            slinha</font><font color="#808080">=</font><font color="#000080">pesqArq</font><font color="#808080">(</font><font color="#000080">tfAssunto</font><font color="#808080">, </font><font color="#000080">tLivroAss_codassunto</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">,
     *       </font><font color="#000080">tamReg</font><font color="#808080">(</font><font color="#000080">opAssunto</font><font color="#808080">))
            </font><font color="#0000FF">write</font><font color="#808080">(*,*) </font><font color="#800000">' '</font><font color="#808080">,</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">opAssunto</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">)
            </font><font color="#0000FF">write</font><font color="#808080">(*,*) </font><font color="#000080">copy</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#000080">g_nPosChave</font><font color="#808080">, </font><font color="#000080">g_nTamChave</font><font color="#808080">)
            </font><font color="#0000FF">call </font><font color="#000080">pesqLinhaExcluida</font><font color="#808080">(</font><font color="#000080">tfLivroAss</font><font color="#808080">, </font><font color="#000080">tamReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">))
            </font><font color="#0000FF">call </font><font color="#000080">subMenu</font><font color="#808080">(</font><font color="#FF0000">14</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">)
            </font><font color="#000080">nCont</font><font color="#808080">=</font><font color="#000080">nCont</font><font color="#808080">+</font><font color="#FF0000">1
          </font><font color="#0000FF">end do
        else if </font><font color="#808080">(</font><font color="#000080">sreg </font><font color="#0000FF">.eq. </font><font color="#000080">opLivroAut</font><font color="#808080">) </font><font color="#0000FF">then
          </font><font color="#000080">sQtd</font><font color="#808080">=</font><font color="#000080">validaNumero</font><font color="#808080">(</font><font color="#800000">'Quantos autores quer cadastrar?: '</font><font color="#808080">,</font><font color="#000080">sQtd</font><font color="#808080">)
          </font><font color="#000080">nQtd</font><font color="#808080">=</font><font color="#000080">StrToInt</font><font color="#808080">(</font><font color="#000080">sQtd</font><font color="#808080">)
<i>C          seek(tfLivroAut, 0)
          </i></font><font color="#0000FF">do while </font><font color="#808080">(</font><font color="#000080">nCont </font><font color="#0000FF">.le. </font><font color="#000080">nQtd</font><font color="#808080">)
            </font><font color="#000080">tLivroAut_isbn</font><font color="#808080">=</font><font color="#000080">sCodigo
            </font><font color="#0000FF">write</font><font color="#808080">(*,*) </font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">opLivroAut</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">)
            </font><font color="#0000FF">read</font><font color="#808080">(*,*) </font><font color="#000080">tLivroAut_codautor
            slinha</font><font color="#808080">=</font><font color="#000080">pesqArq</font><font color="#808080">(</font><font color="#000080">tfAutor</font><font color="#808080">, </font><font color="#000080">tLivroAut_codautor</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">,
     *       </font><font color="#000080">tamReg</font><font color="#808080">(</font><font color="#000080">opAutor</font><font color="#808080">))
            </font><font color="#0000FF">write</font><font color="#808080">(*,*) </font><font color="#800000">' '</font><font color="#808080">,</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">opAutor</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">)
            </font><font color="#0000FF">write</font><font color="#808080">(*,*) </font><font color="#000080">copy</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#000080">g_nPosChave</font><font color="#808080">, </font><font color="#000080">g_nTamChave</font><font color="#808080">)
            </font><font color="#0000FF">call </font><font color="#000080">pesqLinhaExcluida</font><font color="#808080">(</font><font color="#000080">tfLivroAut</font><font color="#808080">, </font><font color="#000080">tamReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">))
            </font><font color="#0000FF">call </font><font color="#000080">subMenu</font><font color="#808080">(</font><font color="#FF0000">14</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">)
            </font><font color="#000080">nCont</font><font color="#808080">=</font><font color="#000080">nCont</font><font color="#808080">+</font><font color="#FF0000">1
          </font><font color="#0000FF">end do
        else if </font><font color="#808080">(</font><font color="#000080">sreg </font><font color="#0000FF">.eq. </font><font color="#000080">opVenda</font><font color="#808080">) </font><font color="#0000FF">then
          </font><font color="#000080">sQtd</font><font color="#808080">=</font><font color="#000080">validaNumero</font><font color="#808080">(</font><font color="#800000">'Quantos livros quer vender?: '</font><font color="#808080">,</font><font color="#000080">sQtd</font><font color="#808080">)
          </font><font color="#000080">nQtd</font><font color="#808080">=</font><font color="#000080">StrToInt</font><font color="#808080">(</font><font color="#000080">sQtd</font><font color="#808080">)
          </font><font color="#000080">nTotalPreco</font><font color="#808080">=</font><font color="#FF0000">0
          </font><font color="#0000FF">do while </font><font color="#808080">(</font><font color="#000080">nCont </font><font color="#0000FF">.le. </font><font color="#000080">nQtd</font><font color="#808080">)
            </font><font color="#000080">slinha</font><font color="#808080">=</font><font color="#000080">validaEntrada</font><font color="#808080">(</font><font color="#000080">tfLivro</font><font color="#808080">,</font><font color="#000080">opLivro</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#000080">tVenda_isbn</font><font color="#808080">,</font><font color="#FF0000">3</font><font color="#808080">,
     *       </font><font color="#0000FF">.false.</font><font color="#808080">,</font><font color="#000080">opTexto</font><font color="#808080">)
            </font><font color="#0000FF">if </font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#0000FF">.ne.</font><font color="#800000">''</font><font color="#808080">) </font><font color="#0000FF">then
              </font><font color="#000080">tVenda_isbn</font><font color="#808080">=</font><font color="#000080">ftrim</font><font color="#808080">(</font><font color="#000080">copy</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#FF0000">13</font><font color="#808080">))
              </font><font color="#0000FF">if </font><font color="#808080">(</font><font color="#000080">validaISBN</font><font color="#808080">(</font><font color="#000080">tVenda_isbn</font><font color="#808080">) </font><font color="#000080">.eqv. </font><font color="#0000FF">.true.</font><font color="#808080">) </font><font color="#0000FF">then
                call </font><font color="#000080">mostrarDados</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#800000">''</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">)
                </font><font color="#000080">tLivro_qtdestoque</font><font color="#808080">=</font><font color="#000080">ftrim</font><font color="#808080">(</font><font color="#000080">copy</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">,</font><font color="#FF0000">134</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">))
                </font><font color="#000080">nQtdEstoque</font><font color="#808080">=</font><font color="#000080">StrToInt</font><font color="#808080">(</font><font color="#000080">tLivro_qtdestoque</font><font color="#808080">)
                </font><font color="#0000FF">if </font><font color="#808080">(</font><font color="#000080">nQtdEstoque </font><font color="#0000FF">.gt. </font><font color="#FF0000">0</font><font color="#808080">) </font><font color="#0000FF">then
                   </font><font color="#000080">nTotalPreco</font><font color="#808080">=</font><font color="#000080">nTotalPreco </font><font color="#808080">+ </font><font color="#000080">g_nPreco
</font><font color="#808080"><i>C                   sPreco = FloatToStr(g_nPreco)
                   </i></font><font color="#000080">tVenda_precovenda</font><font color="#808080">=</font><font color="#000080">sPreco
                   g_SalvarInclusao</font><font color="#808080">=</font><font color="#0000FF">.false.
                   call </font><font color="#000080">subMenu</font><font color="#808080">(</font><font color="#FF0000">14</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">)
                   </font><font color="#0000FF">if </font><font color="#808080">(</font><font color="#000080">g_SalvarInclusao .eqv. </font><font color="#0000FF">.true.</font><font color="#808080">) </font><font color="#0000FF">then
                      </font><font color="#000080">slinha</font><font color="#808080">=</font><font color="#000080">pesqArq</font><font color="#808080">(</font><font color="#000080">tfLivro</font><font color="#808080">, </font><font color="#000080">tVenda_isbn</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">13</font><font color="#808080">, 
     *                 </font><font color="#000080">tamReg</font><font color="#808080">(</font><font color="#000080">opLivro</font><font color="#808080">))
                      </font><font color="#0000FF">if </font><font color="#808080">(</font><font color="#000080">slinha </font><font color="#0000FF">.ne. </font><font color="#800000">''</font><font color="#808080">) </font><font color="#0000FF">then
                         </font><font color="#000080">nQtdEstoque</font><font color="#808080">=</font><font color="#000080">nQtdEstoque</font><font color="#808080">-</font><font color="#FF0000">1
                         </font><font color="#000080">tLivro_qtdestoque </font><font color="#808080">= </font><font color="#000080">IntToStr</font><font color="#808080">(</font><font color="#000080">nQtdEstoque</font><font color="#808080">)
                         </font><font color="#0000FF">call </font><font color="#000080">SomaStr</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#000080">copy</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#FF0000">133</font><font color="#808080">))
                         </font><font color="#0000FF">call </font><font color="#000080">SomaStr</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">tLivro_qtdestoque</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">))
                         </font><font color="#0000FF">call </font><font color="#000080">escreveArq</font><font color="#808080">(</font><font color="#000080">tfLivro</font><font color="#808080">, </font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#800000">''</font><font color="#808080">, </font><font color="#800000">''</font><font color="#808080">)
                      </font><font color="#0000FF">end if
                   end if
                   </font><font color="#000080">nCont</font><font color="#808080">=</font><font color="#000080">nCont</font><font color="#808080">+</font><font color="#FF0000">1
                </font><font color="#0000FF">else 
                  write</font><font color="#808080">(*,*) </font><font color="#000080">MSG_SEMESTOQUE
                </font><font color="#0000FF">end if    
              else 
                write</font><font color="#808080">(*,*) </font><font color="#000080">MSG_ISBNINV
              </font><font color="#0000FF">end if    
            end if
          end do
</font><font color="#808080"><i>C          sTotalPreco = FloatToStr(nTotalPreco)
          </i></font><font color="#0000FF">write</font><font color="#808080">(*,*) </font><font color="#800000">'Total de '</font><font color="#808080">,</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">,</font><font color="#FF0000">4</font><font color="#808080">), </font><font color="#000080">sTotalPreco
        </font><font color="#0000FF">end if  
      else if </font><font color="#808080">(</font><font color="#000080">sacao </font><font color="#0000FF">.eq. </font><font color="#000080">opExcluir</font><font color="#808080">) </font><font color="#0000FF">then
        if </font><font color="#808080">(</font><font color="#000080">sreg </font><font color="#0000FF">.eq. </font><font color="#000080">opLivroAss</font><font color="#808080">) </font><font color="#0000FF">then
          call </font><font color="#000080">ExcluirRegLigados</font><font color="#808080">(</font><font color="#000080">tfLivroAss</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">13</font><font color="#808080">, </font><font color="#000080">sCodigo</font><font color="#808080">)
        </font><font color="#0000FF">else if </font><font color="#808080">(</font><font color="#000080">sreg </font><font color="#0000FF">.eq. </font><font color="#000080">opLivroAut</font><font color="#808080">) </font><font color="#0000FF">then
          call </font><font color="#000080">ExcluirRegLigados</font><font color="#808080">(</font><font color="#000080">tfLivroAut</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">13</font><font color="#808080">, </font><font color="#000080">sCodigo</font><font color="#808080">)
        </font><font color="#0000FF">end if
      end if
      return
      end
</font><font color="#808080"><i>C     ------------------------------------------------------------------
C     Realiza a exclus&atilde;o dos arquivos de liga&ccedil;&atilde;o.
C     sArq - o arquivo de liga&ccedil;&atilde;o
C     sreg - o tipo de arquivo de liga&ccedil;&atilde;o
C     nPosChave - a posicao inicial da chave dentro do registro
C     nTamChave - o tamanho da chave dentro do registro
C     sChave - a chave a ser excluida
C     ------------------------------------------------------------------
      </i></font><font color="#0000FF">subroutine </font><font color="#000080">ExcluirRegLigados</font><font color="#808080">(</font><font color="#000080">sArq</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#000080">nPosChave</font><font color="#808080">, 
     * </font><font color="#000080">nTamChave</font><font color="#808080">, </font><font color="#000080">sChave</font><font color="#808080">)
      </font><font color="#0000FF">integer </font><font color="#000080">sArq</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#000080">nPosChave</font><font color="#808080">, </font><font color="#000080">nTamChave
      </font><font color="#0000FF">character</font><font color="#808080">*</font><font color="#FF0000">255 </font><font color="#000080">sChave

      </font><font color="#0000FF">include </font><font color="#800000">'livrus.h' 
      </font><font color="#0000FF">character</font><font color="#808080">*</font><font color="#FF0000">255 </font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#000080">sCodigo</font><font color="#808080">, </font><font color="#000080">ftrim</font><font color="#808080">, </font><font color="#000080">copy
      </font><font color="#0000FF">integer </font><font color="#000080">fimarq</font><font color="#808080">, </font><font color="#000080">nPosicao

</font><font color="#808080"><i>C        seek(sArq, 0)
        </i></font><font color="#0000FF">do while </font><font color="#808080">(</font><font color="#000080">fimarq</font><font color="#0000FF">.ne.</font><font color="#808080">-</font><font color="#FF0000">1</font><font color="#808080">)
          </font><font color="#0000FF">read</font><font color="#808080">(</font><font color="#000080">sArq</font><font color="#808080">,</font><font color="#000080">rec</font><font color="#808080">=</font><font color="#000080">nPosicao</font><font color="#808080">,</font><font color="#000080">iostat</font><font color="#808080">=</font><font color="#000080">fimarq</font><font color="#808080">) </font><font color="#000080">slinha
          sCodigo</font><font color="#808080">=</font><font color="#000080">ftrim</font><font color="#808080">(</font><font color="#000080">copy</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">,</font><font color="#000080">nPosChave</font><font color="#808080">,</font><font color="#000080">nTamChave</font><font color="#808080">))
          </font><font color="#0000FF">if </font><font color="#808080">(</font><font color="#000080">sCodigo </font><font color="#0000FF">.eq. </font><font color="#000080">sChave</font><font color="#808080">) </font><font color="#0000FF">then
             call </font><font color="#000080">btnAcao</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">,</font><font color="#000080">opConfirmaExclusao</font><font color="#808080">)
          </font><font color="#0000FF">end if  
          </font><font color="#000080">nPosicao </font><font color="#808080">= </font><font color="#000080">nPosicao </font><font color="#808080">+ </font><font color="#FF0000">1
        </font><font color="#0000FF">end do
      return
      end      
</font></font>
</code></pre>
</body>
</html>