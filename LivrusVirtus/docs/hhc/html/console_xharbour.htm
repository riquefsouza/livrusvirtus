<html>
<head>
<title>Livrus Virtus - Console - xHarbour</title>
</head>
<!-- Generated by ConTEXT HTML exporter -->
<body text="#000000" bgcolor="#FFFFFF">
<pre>
<code><font  face="Courier New"><font color="#808080">/*------------------------------------------------------------------------------
 </font><font color="#000080">Sistema integrante </font><font color="#0000FF">do </font><font color="#000080">projeto Livrus Virtus</font><font color="#808080">.
 </font><font color="#000080">Todos os direitos reservados </font><font color="#0000FF">para </font><font color="#000080">Henrique F</font><font color="#808080">. </font><font color="#000080">de Souza</font><font color="#808080">.
 </font><font color="#000080">Vers&atilde;o programada na linguagem harbour</font><font color="#808080">.
------------------------------------------------------------------------------*/
/* </font><font color="#000080">programa Livrus </font><font color="#808080">*/

</font><font color="#000080">#include </font><font color="#800000">&quot;Inkey.ch&quot;
</font><font color="#000080">#include </font><font color="#800000">&quot;Fileio.ch&quot;

</font><font color="#808080">/* </font><font color="#000080">registros </font><font color="#808080">*/
</font><font color="#000080">static tAssunto_codigo </font><font color="#808080">/* </font><font color="#FF0000">10 </font><font color="#808080">*/
</font><font color="#000080">static tAssunto_assunto </font><font color="#808080">/* </font><font color="#FF0000">30 </font><font color="#808080">*/ 

</font><font color="#000080">static tAutor_codigo </font><font color="#808080">/* </font><font color="#FF0000">10 </font><font color="#808080">*/ 
</font><font color="#000080">static tAutor_autor </font><font color="#808080">/* </font><font color="#FF0000">30 </font><font color="#808080">*/ 

</font><font color="#000080">static tEditora_codigo </font><font color="#808080">/* </font><font color="#FF0000">10 </font><font color="#808080">*/ 
</font><font color="#000080">static tEditora_editora </font><font color="#808080">/* </font><font color="#FF0000">50 </font><font color="#808080">*/ 

</font><font color="#000080">static tIdioma_codigo </font><font color="#808080">/* </font><font color="#FF0000">10 </font><font color="#808080">*/ 
</font><font color="#000080">static tIdioma_idioma </font><font color="#808080">/* </font><font color="#FF0000">20 </font><font color="#808080">*/ 

</font><font color="#000080">static tUsuario_login </font><font color="#808080">/* </font><font color="#FF0000">10 </font><font color="#808080">*/ 
</font><font color="#000080">static tUsuario_senha </font><font color="#808080">/* </font><font color="#FF0000">10 </font><font color="#808080">*/ 

</font><font color="#000080">static tPais_codigo </font><font color="#808080">/* </font><font color="#FF0000">3 </font><font color="#808080">*/ 
</font><font color="#000080">static tPais_pais </font><font color="#808080">/* </font><font color="#FF0000">50 </font><font color="#808080">*/ 

</font><font color="#000080">static tProfiss_codigo </font><font color="#808080">/* </font><font color="#FF0000">10 </font><font color="#808080">*/ 
</font><font color="#000080">static tProfiss_profissao </font><font color="#808080">/* </font><font color="#FF0000">50 </font><font color="#808080">*/ 

</font><font color="#000080">static tLiv_isbn </font><font color="#808080">/* </font><font color="#FF0000">13 </font><font color="#808080">*/ 
</font><font color="#000080">static tLiv_titulo </font><font color="#808080">/* </font><font color="#FF0000">50 </font><font color="#808080">*/ 
</font><font color="#000080">static tLiv_edicao </font><font color="#808080">/* </font><font color="#FF0000">10 </font><font color="#808080">*/ 
</font><font color="#000080">static tLiv_anopubli </font><font color="#808080">/* </font><font color="#FF0000">10 </font><font color="#808080">*/ 
</font><font color="#000080">static tLiv_codeditora </font><font color="#808080">/* </font><font color="#FF0000">10 </font><font color="#808080">*/ 
</font><font color="#000080">static tLiv_volume </font><font color="#808080">/* </font><font color="#FF0000">10 </font><font color="#808080">*/ 
</font><font color="#000080">static tLiv_codidioma </font><font color="#808080">/* </font><font color="#FF0000">10 </font><font color="#808080">*/ 
</font><font color="#000080">static tLiv_npaginas </font><font color="#808080">/* </font><font color="#FF0000">10 </font><font color="#808080">*/ 
</font><font color="#000080">static tLiv_preco </font><font color="#808080">/* </font><font color="#FF0000">10 </font><font color="#808080">*/ 
</font><font color="#000080">static tLiv_qtdestoque </font><font color="#808080">/* </font><font color="#FF0000">10 </font><font color="#808080">*/ 

</font><font color="#000080">static tLivAss_isbn </font><font color="#808080">/* </font><font color="#FF0000">13 </font><font color="#808080">*/ 
</font><font color="#000080">static tLivAss_codassunto </font><font color="#808080">/* </font><font color="#FF0000">10 </font><font color="#808080">*/ 

</font><font color="#000080">static tLivAut_isbn </font><font color="#808080">/* </font><font color="#FF0000">13 </font><font color="#808080">*/ 
</font><font color="#000080">static tLivAut_codautor </font><font color="#808080">/* </font><font color="#FF0000">10 </font><font color="#808080">*/ 

</font><font color="#000080">static tCli_cpf </font><font color="#808080">/* </font><font color="#FF0000">14 </font><font color="#808080">*/ 
</font><font color="#000080">static tCli_nome </font><font color="#808080">/* </font><font color="#FF0000">30 </font><font color="#808080">*/ 
</font><font color="#000080">static tCli_email </font><font color="#808080">/* </font><font color="#FF0000">30 </font><font color="#808080">*/ 
</font><font color="#000080">static tCli_identidade </font><font color="#808080">/* </font><font color="#FF0000">10 </font><font color="#808080">*/ 
</font><font color="#000080">static tCli_sexo </font><font color="#808080">/* </font><font color="#FF0000">1 </font><font color="#808080">*/ 
</font><font color="#000080">static tCli_telefone </font><font color="#808080">/* </font><font color="#FF0000">17 </font><font color="#808080">*/ 
</font><font color="#000080">static tCli_dtnascimento </font><font color="#808080">/* </font><font color="#FF0000">10 </font><font color="#808080">*/ 
</font><font color="#000080">static tCli_codendereco </font><font color="#808080">/* </font><font color="#FF0000">10 </font><font color="#808080">*/ 
</font><font color="#000080">static tCli_codpais </font><font color="#808080">/* </font><font color="#FF0000">3 </font><font color="#808080">*/ 
</font><font color="#000080">static tCli_codprofissao </font><font color="#808080">/* </font><font color="#FF0000">10 </font><font color="#808080">*/ 

</font><font color="#000080">static tEnd_codigo </font><font color="#808080">/* </font><font color="#FF0000">10 </font><font color="#808080">*/ 
</font><font color="#000080">static tEnd_logradouro </font><font color="#808080">/* </font><font color="#FF0000">40 </font><font color="#808080">*/ 
</font><font color="#000080">static tEnd_bairro </font><font color="#808080">/* </font><font color="#FF0000">15 </font><font color="#808080">*/ 
</font><font color="#000080">static tEnd_cep </font><font color="#808080">/* </font><font color="#FF0000">8 </font><font color="#808080">*/ 
</font><font color="#000080">static tEnd_cidade </font><font color="#808080">/* </font><font color="#FF0000">30 </font><font color="#808080">*/ 
</font><font color="#000080">static tEnd_estado </font><font color="#808080">/* </font><font color="#FF0000">20 </font><font color="#808080">*/ 

</font><font color="#000080">static tVenda_dthrvenda </font><font color="#808080">/* </font><font color="#FF0000">19 </font><font color="#808080">*/   /* </font><font color="#000080">data</font><font color="#808080">/</font><font color="#000080">hora da venda dd</font><font color="#808080">/</font><font color="#000080">mm</font><font color="#808080">/</font><font color="#000080">yyyy hh</font><font color="#808080">:</font><font color="#000080">mm</font><font color="#808080">:</font><font color="#000080">ss </font><font color="#808080">*/
</font><font color="#000080">static tVenda_cpf </font><font color="#808080">/* </font><font color="#FF0000">14 </font><font color="#808080">*/ 
</font><font color="#000080">static tVenda_isbn </font><font color="#808080">/* </font><font color="#FF0000">13 </font><font color="#808080">*/ 
</font><font color="#000080">static tVenda_precovenda </font><font color="#808080">/* </font><font color="#FF0000">10 </font><font color="#808080">*/ 

/* </font><font color="#000080">constantes </font><font color="#808080">*/

/* </font><font color="#000080">ctTipo </font><font color="#808080">*/ 
</font><font color="#000080">#</font><font color="#0000FF">define </font><font color="#000080">opTexto </font><font color="#FF0000">1 
</font><font color="#000080">#</font><font color="#0000FF">define </font><font color="#000080">opNumero </font><font color="#FF0000">2
</font><font color="#000080">#</font><font color="#0000FF">define </font><font color="#000080">opData </font><font color="#FF0000">3
</font><font color="#000080">#</font><font color="#0000FF">define </font><font color="#000080">opDataHora </font><font color="#FF0000">4
</font><font color="#000080">#</font><font color="#0000FF">define </font><font color="#000080">opSenha </font><font color="#FF0000">5
</font><font color="#808080">/* </font><font color="#000080">ctArqs </font><font color="#808080">*/
</font><font color="#000080">#</font><font color="#0000FF">define </font><font color="#000080">opAssunto </font><font color="#FF0000">1
</font><font color="#000080">#</font><font color="#0000FF">define </font><font color="#000080">opAutor </font><font color="#FF0000">2
</font><font color="#000080">#</font><font color="#0000FF">define </font><font color="#000080">opEditora </font><font color="#FF0000">3
</font><font color="#000080">#</font><font color="#0000FF">define </font><font color="#000080">opEndereco </font><font color="#FF0000">4
</font><font color="#000080">#</font><font color="#0000FF">define </font><font color="#000080">opIdioma </font><font color="#FF0000">5
</font><font color="#000080">#</font><font color="#0000FF">define </font><font color="#000080">opPais </font><font color="#FF0000">6
</font><font color="#000080">#</font><font color="#0000FF">define </font><font color="#000080">opProfissao </font><font color="#FF0000">7
</font><font color="#000080">#</font><font color="#0000FF">define </font><font color="#000080">opCliente </font><font color="#FF0000">8
</font><font color="#000080">#</font><font color="#0000FF">define </font><font color="#000080">opLivro </font><font color="#FF0000">9
</font><font color="#000080">#</font><font color="#0000FF">define </font><font color="#000080">opLivroAss </font><font color="#FF0000">10
</font><font color="#000080">#</font><font color="#0000FF">define </font><font color="#000080">opLivroAut </font><font color="#FF0000">11
</font><font color="#000080">#</font><font color="#0000FF">define </font><font color="#000080">opUsuario </font><font color="#FF0000">12
</font><font color="#000080">#</font><font color="#0000FF">define </font><font color="#000080">opVenda </font><font color="#FF0000">13
</font><font color="#808080">/* </font><font color="#000080">ctAcao </font><font color="#808080">*/ 
</font><font color="#000080">#</font><font color="#0000FF">define </font><font color="#000080">opNovo </font><font color="#FF0000">1
</font><font color="#000080">#</font><font color="#0000FF">define </font><font color="#000080">opAlterar </font><font color="#FF0000">2
</font><font color="#000080">#</font><font color="#0000FF">define </font><font color="#000080">opPesquisar </font><font color="#FF0000">3
</font><font color="#000080">#</font><font color="#0000FF">define </font><font color="#000080">opSalvarInclusao </font><font color="#FF0000">4
</font><font color="#000080">#</font><font color="#0000FF">define </font><font color="#000080">opSalvarAlteracao </font><font color="#FF0000">5
</font><font color="#000080">#</font><font color="#0000FF">define </font><font color="#000080">opExcluir </font><font color="#FF0000">6
</font><font color="#000080">#</font><font color="#0000FF">define </font><font color="#000080">opConfirmaExclusao </font><font color="#FF0000">7
</font><font color="#000080">#</font><font color="#0000FF">define </font><font color="#000080">opListarTodos </font><font color="#FF0000">8

</font><font color="#000080">#</font><font color="#0000FF">define </font><font color="#000080">CRLF </font><font color="#0000FF">chr</font><font color="#808080">(</font><font color="#FF0000">13</font><font color="#808080">)+</font><font color="#0000FF">chr</font><font color="#808080">(</font><font color="#FF0000">10</font><font color="#808080">) /* </font><font color="#000080">windows </font><font color="#808080">*/
</font><font color="#000080">#</font><font color="#0000FF">define </font><font color="#000080">TAM_CRLF </font><font color="#FF0000">2
</font><font color="#808080">/* </font><font color="#000080">#</font><font color="#0000FF">define </font><font color="#000080">CRLF </font><font color="#0000FF">chr</font><font color="#808080">(</font><font color="#FF0000">10</font><font color="#808080">)
   </font><font color="#000080">#</font><font color="#0000FF">define </font><font color="#000080">TAM_CRLF </font><font color="#FF0000">1 </font><font color="#808080">*/ /* </font><font color="#000080">unix </font><font color="#808080">*/
/* </font><font color="#000080">#</font><font color="#0000FF">define </font><font color="#000080">CRLF </font><font color="#0000FF">chr</font><font color="#808080">(</font><font color="#FF0000">13</font><font color="#808080">)
   </font><font color="#000080">#</font><font color="#0000FF">define </font><font color="#000080">TAM_CRLF </font><font color="#FF0000">1 </font><font color="#808080">*/ /* </font><font color="#000080">macintosh </font><font color="#808080">*/

</font><font color="#000080">#</font><font color="#0000FF">define </font><font color="#000080">QTD_MAX_LINHA </font><font color="#FF0000">18

</font><font color="#000080">#</font><font color="#0000FF">define </font><font color="#000080">MSG_ARQERRO </font><font color="#800000">&quot;Erro: O arquivo n&atilde;o pode ser aberto.&quot;
</font><font color="#000080">#</font><font color="#0000FF">define </font><font color="#000080">MSG_ARQCERRO </font><font color="#800000">&quot;Erro: O arquivo n&atilde;o pode ser criado.&quot;
</font><font color="#000080">#</font><font color="#0000FF">define </font><font color="#000080">MSG_ERRO </font><font color="#800000">&quot;Erro: op&ccedil;&atilde;o inv&aacute;lida digite de novo&quot;
</font><font color="#000080">#</font><font color="#0000FF">define </font><font color="#000080">MSG_OPCAO </font><font color="#800000">&quot;Escolha uma op&ccedil;&atilde;o: &quot;
</font><font color="#000080">#</font><font color="#0000FF">define </font><font color="#000080">MSG_PRESS </font><font color="#800000">&quot;pressione para continuar...&quot;

</font><font color="#000080">#</font><font color="#0000FF">define </font><font color="#000080">MSG_REGINC </font><font color="#800000">&quot;registro incluido!&quot;
</font><font color="#000080">#</font><font color="#0000FF">define </font><font color="#000080">MSG_REGNINC </font><font color="#800000">&quot;registro n&atilde;o incluido!&quot;
</font><font color="#000080">#</font><font color="#0000FF">define </font><font color="#000080">MSG_REGALT </font><font color="#800000">&quot;registro alterado!&quot;
</font><font color="#000080">#</font><font color="#0000FF">define </font><font color="#000080">MSG_REGNALT </font><font color="#800000">&quot;registro n&atilde;o alterado!&quot;
</font><font color="#000080">#</font><font color="#0000FF">define </font><font color="#000080">MSG_REGEXC </font><font color="#800000">&quot;registro excluido!&quot;
</font><font color="#000080">#</font><font color="#0000FF">define </font><font color="#000080">MSG_REGNEXC </font><font color="#800000">&quot;registro n&atilde;o excluido!&quot;
</font><font color="#000080">#</font><font color="#0000FF">define </font><font color="#000080">MSG_REGEXST </font><font color="#800000">&quot;registro j&aacute; existe!&quot;

</font><font color="#000080">#</font><font color="#0000FF">define </font><font color="#000080">MSG_NUMINV </font><font color="#800000">&quot;N&uacute;mero inv&aacute;lido ou menor do que 1!&quot;
</font><font color="#000080">#</font><font color="#0000FF">define </font><font color="#000080">MSG_DATAINV </font><font color="#800000">&quot;Data inv&aacute;lida!, formato correto (dd/mm/yyyy)&quot;
</font><font color="#000080">#</font><font color="#0000FF">define </font><font color="#000080">MSG_DTHRINV </font><font color="#800000">&quot;Data/hora inv&aacute;lida!, formato correto (dd/mm/yyyy hh:mm:ss)&quot;
</font><font color="#000080">#</font><font color="#0000FF">define </font><font color="#000080">MSG_ISBNINV </font><font color="#800000">&quot;ISBN inv&aacute;lido!&quot;
</font><font color="#000080">#</font><font color="#0000FF">define </font><font color="#000080">MSG_CPFINV </font><font color="#800000">&quot;CPF inv&aacute;lido!&quot;
</font><font color="#000080">#</font><font color="#0000FF">define </font><font color="#000080">MSG_SENCONFERE </font><font color="#800000">&quot;senha n&atilde;o confere com a senha atual!&quot;
</font><font color="#000080">#</font><font color="#0000FF">define </font><font color="#000080">MSG_SENCONFIRM </font><font color="#800000">&quot;nova senha n&atilde;o confere com a senha confirmada!&quot;
</font><font color="#000080">#</font><font color="#0000FF">define </font><font color="#000080">MSG_LOGINENCON </font><font color="#800000">&quot;login n&atilde;o encontrado!&quot;
</font><font color="#000080">#</font><font color="#0000FF">define </font><font color="#000080">MSG_SEMESTOQUE </font><font color="#800000">&quot;livro n&atilde;o existe no estoque!&quot;

</font><font color="#000080">#</font><font color="#0000FF">define </font><font color="#000080">ARQ_ASSUNTO </font><font color="#800000">&quot;assunto.dat&quot;
</font><font color="#000080">#</font><font color="#0000FF">define </font><font color="#000080">ARQ_AUTOR </font><font color="#800000">&quot;autor.dat&quot;
</font><font color="#000080">#</font><font color="#0000FF">define </font><font color="#000080">ARQ_EDITORA </font><font color="#800000">&quot;editora.dat&quot;
</font><font color="#000080">#</font><font color="#0000FF">define </font><font color="#000080">ARQ_IDIOMA </font><font color="#800000">&quot;idioma.dat&quot;
</font><font color="#000080">#</font><font color="#0000FF">define </font><font color="#000080">ARQ_USUARIO </font><font color="#800000">&quot;usuario.dat&quot;
</font><font color="#000080">#</font><font color="#0000FF">define </font><font color="#000080">ARQ_PAIS </font><font color="#800000">&quot;pais.dat&quot;
</font><font color="#000080">#</font><font color="#0000FF">define </font><font color="#000080">ARQ_PROFISSAO </font><font color="#800000">&quot;profissao.dat&quot;
</font><font color="#000080">#</font><font color="#0000FF">define </font><font color="#000080">ARQ_LIVRO </font><font color="#800000">&quot;livro.dat&quot;
</font><font color="#000080">#</font><font color="#0000FF">define </font><font color="#000080">ARQ_LIVASS </font><font color="#800000">&quot;livroass.dat&quot;
</font><font color="#000080">#</font><font color="#0000FF">define </font><font color="#000080">ARQ_LIVAUT </font><font color="#800000">&quot;livroaut.dat&quot;
</font><font color="#000080">#</font><font color="#0000FF">define </font><font color="#000080">ARQ_CLIENTE </font><font color="#800000">&quot;cliente.dat&quot;
</font><font color="#000080">#</font><font color="#0000FF">define </font><font color="#000080">ARQ_ENDERECO </font><font color="#800000">&quot;endereco.dat&quot;
</font><font color="#000080">#</font><font color="#0000FF">define </font><font color="#000080">ARQ_VENDA </font><font color="#800000">&quot;venda.dat&quot;

</font><font color="#000080">#</font><font color="#0000FF">define </font><font color="#000080">TAM_ASSUNTO </font><font color="#FF0000">40
</font><font color="#000080">#</font><font color="#0000FF">define </font><font color="#000080">TAM_AUTOR </font><font color="#FF0000">40
</font><font color="#000080">#</font><font color="#0000FF">define </font><font color="#000080">TAM_EDITORA </font><font color="#FF0000">60
</font><font color="#000080">#</font><font color="#0000FF">define </font><font color="#000080">TAM_IDIOMA </font><font color="#FF0000">30
</font><font color="#000080">#</font><font color="#0000FF">define </font><font color="#000080">TAM_USUARIO </font><font color="#FF0000">20
</font><font color="#000080">#</font><font color="#0000FF">define </font><font color="#000080">TAM_PAIS </font><font color="#FF0000">53
</font><font color="#000080">#</font><font color="#0000FF">define </font><font color="#000080">TAM_PROFISSAO </font><font color="#FF0000">60
</font><font color="#000080">#</font><font color="#0000FF">define </font><font color="#000080">TAM_LIVRO </font><font color="#FF0000">143
</font><font color="#000080">#</font><font color="#0000FF">define </font><font color="#000080">TAM_LIVASS </font><font color="#FF0000">23
</font><font color="#000080">#</font><font color="#0000FF">define </font><font color="#000080">TAM_LIVAUT </font><font color="#FF0000">23
</font><font color="#000080">#</font><font color="#0000FF">define </font><font color="#000080">TAM_CLIENTE </font><font color="#FF0000">135
</font><font color="#000080">#</font><font color="#0000FF">define </font><font color="#000080">TAM_ENDERECO </font><font color="#FF0000">123
</font><font color="#000080">#</font><font color="#0000FF">define </font><font color="#000080">TAM_VENDA </font><font color="#FF0000">56

</font><font color="#808080">/* </font><font color="#000080">vari&aacute;veis globais </font><font color="#808080">*/
</font><font color="#000080">static bopcao
static opmenu
static g_nPosChave</font><font color="#808080">, </font><font color="#000080">g_nTamChave
static g_nPreco
static g_SalvarInclusao

static tfAssunto</font><font color="#808080">, </font><font color="#000080">tfAutor</font><font color="#808080">, </font><font color="#000080">tfEditora</font><font color="#808080">, </font><font color="#000080">tfIdioma</font><font color="#808080">, </font><font color="#000080">tfEndereco</font><font color="#808080">, </font><font color="#000080">tfPais</font><font color="#808080">, </font><font color="#000080">tfProfissao</font><font color="#808080">,;
 </font><font color="#000080">tfLivro</font><font color="#808080">, </font><font color="#000080">tfLivroAss</font><font color="#808080">, </font><font color="#000080">tfLivroAut</font><font color="#808080">, </font><font color="#000080">tfCliente</font><font color="#808080">, </font><font color="#000080">tfUsuario</font><font color="#808080">, </font><font color="#000080">tfVenda

</font><font color="#808080">/*------------------------------------------------------------------------------
</font><font color="#000080">Parte inicial </font><font color="#0000FF">do </font><font color="#000080">c&oacute;digo
</font><font color="#808080">------------------------------------------------------------------------------*/
</font><font color="#0000FF">Function </font><font color="#000080">Main</font><font color="#808080">() 

/* </font><font color="#000080">Defini&ccedil;&otilde;es </font><font color="#0000FF">do </font><font color="#000080">programa </font><font color="#808080">*/

</font><font color="#0000FF">set date to </font><font color="#000080">british
</font><font color="#0000FF">set century on
set console on
set scoreboard off
set device to screen

</font><font color="#808080">/* </font><font color="#0000FF">if </font><font color="#000080">ParamStr</font><font color="#808080">(</font><font color="#FF0000">1</font><font color="#808080">)=</font><font color="#800000">&quot;-cria&quot;
     </font><font color="#000080">abrecriaArqs</font><font color="#808080">(.f.)
 </font><font color="#0000FF">else </font><font color="#808080">*/
   </font><font color="#000080">frmSplash</font><font color="#808080">()
   </font><font color="#000080">abrecriaArqs</font><font color="#808080">(.t.)
   </font><font color="#0000FF">if </font><font color="#000080">frmLogin</font><font color="#808080">() 
     </font><font color="#000080">bopcao</font><font color="#808080">:=.t.
     </font><font color="#0000FF">do while</font><font color="#808080">(</font><font color="#000080">bopcao</font><font color="#808080">)      
       </font><font color="#0000FF">accept menu</font><font color="#808080">(</font><font color="#FF0000">1</font><font color="#808080">) </font><font color="#0000FF">to </font><font color="#000080">opmenu
       </font><font color="#0000FF">if </font><font color="#808080">(</font><font color="#000080">opmenu</font><font color="#808080">=</font><font color="#800000">&quot;C&quot;</font><font color="#808080">) .or. (</font><font color="#000080">opmenu</font><font color="#808080">=</font><font color="#800000">&quot;c&quot;</font><font color="#808080">) 
         </font><font color="#000080">usaMenu</font><font color="#808080">(</font><font color="#FF0000">1</font><font color="#808080">)
       </font><font color="#000080">elseif </font><font color="#808080">(</font><font color="#000080">opmenu</font><font color="#808080">=</font><font color="#800000">&quot;P&quot;</font><font color="#808080">) .or. (</font><font color="#000080">opmenu</font><font color="#808080">=</font><font color="#800000">&quot;p&quot;</font><font color="#808080">) 
         </font><font color="#000080">usaMenu</font><font color="#808080">(</font><font color="#FF0000">2</font><font color="#808080">)
       </font><font color="#000080">elseif </font><font color="#808080">(</font><font color="#000080">opmenu</font><font color="#808080">=</font><font color="#800000">&quot;V&quot;</font><font color="#808080">) .or. (</font><font color="#000080">opmenu</font><font color="#808080">=</font><font color="#800000">&quot;v&quot;</font><font color="#808080">) 
         </font><font color="#000080">usaMenu</font><font color="#808080">(</font><font color="#FF0000">3</font><font color="#808080">)
       </font><font color="#000080">elseif </font><font color="#808080">(</font><font color="#000080">opmenu</font><font color="#808080">=</font><font color="#800000">&quot;O&quot;</font><font color="#808080">) .or. (</font><font color="#000080">opmenu</font><font color="#808080">=</font><font color="#800000">&quot;o&quot;</font><font color="#808080">) 
         </font><font color="#000080">usaMenu</font><font color="#808080">(</font><font color="#FF0000">4</font><font color="#808080">)
       </font><font color="#0000FF">else 
         </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#000080">MSG_ERRO</font><font color="#808080">)
       </font><font color="#0000FF">endif 
     enddo
   else 
     </font><font color="#000080">fechaArqs</font><font color="#808080">()
     </font><font color="#0000FF">quit
   endif
</font><font color="#808080">/* </font><font color="#0000FF">endif</font><font color="#808080">*/

</font><font color="#0000FF">return</font><font color="#808080">(</font><font color="#000080">nil</font><font color="#808080">)

/*--- </font><font color="#000080">Rotinas b&aacute;sicas </font><font color="#808080">---------------------------------------------------------*/

/*------------------------------------------------------------------------------
</font><font color="#000080">Coloca espa&ccedil;os em branco a mais de acordo com o tamanho m&aacute;ximo </font><font color="#0000FF">do </font><font color="#000080">texto</font><font color="#808080">.
</font><font color="#000080">sTexto </font><font color="#808080">- </font><font color="#000080">o texto
nTam </font><font color="#808080">- </font><font color="#000080">tamanho m&aacute;ximo </font><font color="#0000FF">do </font><font color="#000080">texto
retorna </font><font color="#808080">- </font><font color="#000080">o texto com espa&ccedil;os em branco a mais
</font><font color="#808080">------------------------------------------------------------------------------*/
</font><font color="#0000FF">function </font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">sTexto</font><font color="#808080">, </font><font color="#000080">nTam</font><font color="#808080">)
</font><font color="#0000FF">return</font><font color="#808080">(</font><font color="#000080">sTexto</font><font color="#808080">+</font><font color="#0000FF">space</font><font color="#808080">(</font><font color="#000080">nTam</font><font color="#808080">-</font><font color="#000080">len</font><font color="#808080">(</font><font color="#000080">sTexto</font><font color="#808080">)))
/*------------------------------------------------------------------------------
</font><font color="#000080">Escreve zeros na frente de um texto</font><font color="#808080">.
</font><font color="#000080">stexto </font><font color="#808080">- </font><font color="#000080">o texto </font><font color="#0000FF">para </font><font color="#000080">receber zeros a frente
ntam </font><font color="#808080">- </font><font color="#000080">o tamanho da string
retorna </font><font color="#808080">- </font><font color="#000080">o texto com o zeros antes
</font><font color="#808080">------------------------------------------------------------------------------*/
</font><font color="#0000FF">function </font><font color="#000080">zeros</font><font color="#808080">(</font><font color="#000080">stexto</font><font color="#808080">, </font><font color="#000080">ntam</font><font color="#808080">)
</font><font color="#0000FF">local </font><font color="#000080">ncont</font><font color="#808080">, </font><font color="#000080">saux

  saux</font><font color="#808080">:=</font><font color="#800000">&quot;&quot;
  </font><font color="#0000FF">if </font><font color="#000080">ntam</font><font color="#808080">&lt;&gt;</font><font color="#000080">len</font><font color="#808080">(</font><font color="#000080">stexto</font><font color="#808080">) 
      </font><font color="#0000FF">for </font><font color="#000080">ncont</font><font color="#808080">:=</font><font color="#FF0000">1 </font><font color="#0000FF">to </font><font color="#000080">ntam</font><font color="#808080">-</font><font color="#000080">len</font><font color="#808080">(</font><font color="#000080">stexto</font><font color="#808080">)
        </font><font color="#000080">saux</font><font color="#808080">:=</font><font color="#000080">saux </font><font color="#808080">+ </font><font color="#800000">&quot;0&quot;
      </font><font color="#0000FF">next  
  endif
return</font><font color="#808080">(</font><font color="#000080">saux</font><font color="#808080">+</font><font color="#000080">stexto</font><font color="#808080">)
/*------------------------------------------------------------------------------
</font><font color="#000080">Faz uma pesquisa relativa de um texto atrav&eacute;s de um valor chave</font><font color="#808080">.
</font><font color="#000080">sTexto </font><font color="#808080">- </font><font color="#000080">o texto
sChave </font><font color="#808080">- </font><font color="#000080">a chave a ser pesquisada
retorna </font><font color="#808080">- </font><font color="#000080">se achou ou n&atilde;o a chave dentro </font><font color="#0000FF">do </font><font color="#000080">texto
</font><font color="#808080">------------------------------------------------------------------------------*/
</font><font color="#0000FF">function </font><font color="#000080">strRelativa</font><font color="#808080">(</font><font color="#000080">sTexto</font><font color="#808080">, </font><font color="#000080">sChave</font><font color="#808080">)
</font><font color="#0000FF">local </font><font color="#000080">nCont</font><font color="#808080">, </font><font color="#000080">nTamChave</font><font color="#808080">, </font><font color="#000080">nTamTexto</font><font color="#808080">, </font><font color="#000080">bret</font><font color="#808080">, </font><font color="#000080">sPedaco

bret</font><font color="#808080">:=.f.
</font><font color="#000080">nCont</font><font color="#808080">:=</font><font color="#FF0000">1
</font><font color="#000080">nTamChave</font><font color="#808080">:=</font><font color="#000080">len</font><font color="#808080">(</font><font color="#000080">sChave</font><font color="#808080">)
</font><font color="#000080">nTamTexto</font><font color="#808080">:=</font><font color="#000080">len</font><font color="#808080">(</font><font color="#000080">sTexto</font><font color="#808080">)
</font><font color="#0000FF">if </font><font color="#000080">nTamChave </font><font color="#808080">&lt;= </font><font color="#000080">nTamTexto 
  </font><font color="#0000FF">do while </font><font color="#000080">nCont </font><font color="#808080">&lt;= (</font><font color="#000080">nTamTexto</font><font color="#808080">-</font><font color="#000080">nTamChave</font><font color="#808080">+</font><font color="#FF0000">1</font><font color="#808080">)
     </font><font color="#000080">sPedaco</font><font color="#808080">:=</font><font color="#000080">substr</font><font color="#808080">(</font><font color="#000080">sTexto</font><font color="#808080">,</font><font color="#000080">nCont</font><font color="#808080">,</font><font color="#000080">nTamChave</font><font color="#808080">)
     </font><font color="#0000FF">if </font><font color="#000080">sPedaco</font><font color="#808080">==</font><font color="#000080">sChave
        bret</font><font color="#808080">:=.t.
     </font><font color="#0000FF">endif
     </font><font color="#000080">nCont</font><font color="#808080">++
  </font><font color="#0000FF">enddo 
endif
return</font><font color="#808080">(</font><font color="#000080">bret</font><font color="#808080">)
/*------------------------------------------------------------------------------
</font><font color="#000080">Calcula o modulo11 de um valor qualquer</font><font color="#808080">.
</font><font color="#000080">svalor </font><font color="#808080">- </font><font color="#000080">a mstring com o n&uacute;mero a ser calculado
ndig </font><font color="#808080">- </font><font color="#000080">d&iacute;gito </font><font color="#0000FF">do </font><font color="#000080">valor a ser calculado
retorna </font><font color="#808080">- </font><font color="#000080">o d&iacute;gito correto
</font><font color="#808080">------------------------------------------------------------------------------*/
</font><font color="#0000FF">function </font><font color="#000080">modulo11</font><font color="#808080">(</font><font color="#000080">svalor</font><font color="#808080">, </font><font color="#000080">ndig</font><font color="#808080">)
</font><font color="#0000FF">local </font><font color="#000080">nmodulo11</font><font color="#808080">, </font><font color="#000080">ncont</font><font color="#808080">, </font><font color="#000080">nsoma</font><font color="#808080">, </font><font color="#000080">nvalor</font><font color="#808080">, </font><font color="#000080">npos</font><font color="#808080">, </font><font color="#000080">sres</font><font color="#808080">, </font><font color="#000080">slocal

 ncont</font><font color="#808080">:=</font><font color="#FF0000">1
 </font><font color="#000080">slocal</font><font color="#808080">:=</font><font color="#800000">&quot;&quot;
 </font><font color="#0000FF">do while </font><font color="#000080">ncont </font><font color="#808080">&lt;= </font><font color="#FF0000">11
   </font><font color="#000080">slocal</font><font color="#808080">:=</font><font color="#000080">substr</font><font color="#808080">(</font><font color="#000080">svalor</font><font color="#808080">,</font><font color="#000080">ncont</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">) + </font><font color="#000080">slocal
   ncont</font><font color="#808080">:=</font><font color="#000080">ncont</font><font color="#808080">+</font><font color="#FF0000">1
 </font><font color="#0000FF">enddo
 </font><font color="#000080">nsoma</font><font color="#808080">:=</font><font color="#FF0000">0
 </font><font color="#0000FF">if </font><font color="#000080">ndig</font><font color="#808080">=</font><font color="#FF0000">1
   </font><font color="#000080">ncont</font><font color="#808080">:=</font><font color="#FF0000">3
 </font><font color="#0000FF">else
   </font><font color="#000080">ncont</font><font color="#808080">:=</font><font color="#FF0000">2
 </font><font color="#0000FF">endif
 </font><font color="#000080">npos</font><font color="#808080">:=</font><font color="#FF0000">2
 </font><font color="#0000FF">do while </font><font color="#000080">ncont </font><font color="#808080">&lt;= </font><font color="#FF0000">11
   </font><font color="#000080">sres</font><font color="#808080">:=</font><font color="#000080">substr</font><font color="#808080">(</font><font color="#000080">slocal</font><font color="#808080">,</font><font color="#000080">ncont</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">)
   </font><font color="#000080">nvalor</font><font color="#808080">:=</font><font color="#0000FF">Val</font><font color="#808080">(</font><font color="#000080">sres</font><font color="#808080">)
   </font><font color="#000080">nsoma</font><font color="#808080">:=</font><font color="#000080">nsoma </font><font color="#808080">+ (</font><font color="#000080">nvalor </font><font color="#808080">* </font><font color="#000080">npos</font><font color="#808080">)
   </font><font color="#000080">ncont</font><font color="#808080">++
   </font><font color="#000080">npos</font><font color="#808080">++
 </font><font color="#0000FF">enddo
 </font><font color="#000080">nsoma</font><font color="#808080">:=(</font><font color="#FF0000">11 </font><font color="#808080">- (</font><font color="#000080">nsoma </font><font color="#808080">% </font><font color="#FF0000">11</font><font color="#808080">))

</font><font color="#0000FF">if </font><font color="#000080">nsoma </font><font color="#808080">&gt; </font><font color="#FF0000">9
  </font><font color="#000080">nmodulo11</font><font color="#808080">:=</font><font color="#FF0000">0
</font><font color="#0000FF">else
  </font><font color="#000080">nmodulo11</font><font color="#808080">:=</font><font color="#000080">nsoma
</font><font color="#0000FF">endif
return</font><font color="#808080">(</font><font color="#000080">nmodulo11</font><font color="#808080">)

/*------------------------------------------------------------------------------
</font><font color="#000080">Valida&ccedil;&atilde;o de um n&uacute;mero de CPF qualquer</font><font color="#808080">.
</font><font color="#000080">cpf </font><font color="#808080">- </font><font color="#000080">a mstring com o n&uacute;mero </font><font color="#0000FF">do </font><font color="#000080">CPF
retorna </font><font color="#808080">- </font><font color="#000080">se &eacute; valido ou n&atilde;o
</font><font color="#808080">------------------------------------------------------------------------------*/
</font><font color="#0000FF">function </font><font color="#000080">validaCPF</font><font color="#808080">(</font><font color="#000080">cpf</font><font color="#808080">)
</font><font color="#0000FF">local </font><font color="#000080">scpf</font><font color="#808080">, </font><font color="#000080">sres</font><font color="#808080">, </font><font color="#000080">bvalidaCPF
</font><font color="#0000FF">local </font><font color="#000080">nstatus</font><font color="#808080">, </font><font color="#000080">nvalor1</font><font color="#808080">, </font><font color="#000080">nvalor2

</font><font color="#0000FF">if </font><font color="#808080">(</font><font color="#000080">len</font><font color="#808080">(</font><font color="#000080">cpf</font><font color="#808080">)=</font><font color="#FF0000">14</font><font color="#808080">) 
  </font><font color="#000080">scpf</font><font color="#808080">:=</font><font color="#000080">substr</font><font color="#808080">(</font><font color="#000080">cpf</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#FF0000">3</font><font color="#808080">)+</font><font color="#000080">substr</font><font color="#808080">(</font><font color="#000080">cpf</font><font color="#808080">,</font><font color="#FF0000">5</font><font color="#808080">,</font><font color="#FF0000">3</font><font color="#808080">)+</font><font color="#000080">substr</font><font color="#808080">(</font><font color="#000080">cpf</font><font color="#808080">,</font><font color="#FF0000">9</font><font color="#808080">,</font><font color="#FF0000">3</font><font color="#808080">)+</font><font color="#000080">substr</font><font color="#808080">(</font><font color="#000080">cpf</font><font color="#808080">,</font><font color="#FF0000">13</font><font color="#808080">,</font><font color="#FF0000">2</font><font color="#808080">)
  </font><font color="#000080">sres</font><font color="#808080">:=</font><font color="#000080">substr</font><font color="#808080">(</font><font color="#000080">cpf</font><font color="#808080">,</font><font color="#FF0000">13</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">)
  </font><font color="#000080">nvalor1</font><font color="#808080">:=</font><font color="#0000FF">Val</font><font color="#808080">(</font><font color="#000080">sres</font><font color="#808080">)
  </font><font color="#000080">sres</font><font color="#808080">:=</font><font color="#000080">substr</font><font color="#808080">(</font><font color="#000080">cpf</font><font color="#808080">,</font><font color="#FF0000">14</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">)
  </font><font color="#000080">nvalor2</font><font color="#808080">:=</font><font color="#0000FF">Val</font><font color="#808080">(</font><font color="#000080">sres</font><font color="#808080">)
  </font><font color="#0000FF">if </font><font color="#808080">((</font><font color="#000080">modulo11</font><font color="#808080">(</font><font color="#000080">scpf</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">)=</font><font color="#000080">nvalor1</font><font color="#808080">) .and. (</font><font color="#000080">modulo11</font><font color="#808080">(</font><font color="#000080">scpf</font><font color="#808080">,</font><font color="#FF0000">2</font><font color="#808080">)=</font><font color="#000080">nvalor2</font><font color="#808080">))
    </font><font color="#000080">bvalidaCPF</font><font color="#808080">:=.t.
  </font><font color="#0000FF">else
    </font><font color="#000080">bvalidaCPF</font><font color="#808080">:=.f.
  </font><font color="#0000FF">endif
else
  </font><font color="#000080">bvalidaCPF</font><font color="#808080">:=.f.
</font><font color="#0000FF">endif
return</font><font color="#808080">(</font><font color="#000080">bvalidaCPF</font><font color="#808080">)
/*------------------------------------------------------------------------------
</font><font color="#000080">Valida&ccedil;&atilde;o de um n&uacute;mero ISBN qualquer</font><font color="#808080">.
</font><font color="#000080">isbn </font><font color="#808080">- </font><font color="#000080">a mstring com o n&uacute;mero </font><font color="#0000FF">do </font><font color="#000080">ISBN
retorna </font><font color="#808080">- </font><font color="#000080">se &eacute; valido ou n&atilde;o
</font><font color="#808080">------------------------------------------------------------------------------*/
</font><font color="#0000FF">function </font><font color="#000080">validaISBN</font><font color="#808080">(</font><font color="#000080">isbn</font><font color="#808080">)
</font><font color="#0000FF">local </font><font color="#000080">snum</font><font color="#808080">, </font><font color="#000080">sdigito</font><font color="#808080">, </font><font color="#000080">sisbn</font><font color="#808080">, </font><font color="#000080">bvalidaISBN
</font><font color="#0000FF">local </font><font color="#000080">nvalor</font><font color="#808080">, </font><font color="#000080">nsoma</font><font color="#808080">, </font><font color="#000080">ncont

</font><font color="#0000FF">if </font><font color="#808080">(</font><font color="#000080">len</font><font color="#808080">(</font><font color="#000080">isbn</font><font color="#808080">)=</font><font color="#FF0000">13</font><font color="#808080">) 
  </font><font color="#000080">sdigito </font><font color="#808080">:= </font><font color="#000080">substr</font><font color="#808080">(</font><font color="#000080">isbn</font><font color="#808080">, </font><font color="#000080">len</font><font color="#808080">(</font><font color="#000080">isbn</font><font color="#808080">), </font><font color="#FF0000">1</font><font color="#808080">)
  </font><font color="#000080">sisbn</font><font color="#808080">:=</font><font color="#800000">&quot;&quot;
  </font><font color="#0000FF">for </font><font color="#000080">ncont</font><font color="#808080">:=</font><font color="#FF0000">1 </font><font color="#0000FF">to </font><font color="#000080">len</font><font color="#808080">(</font><font color="#000080">isbn</font><font color="#808080">)-</font><font color="#FF0000">1
    </font><font color="#0000FF">if </font><font color="#808080">(</font><font color="#000080">substr</font><font color="#808080">(</font><font color="#000080">isbn</font><font color="#808080">,</font><font color="#000080">ncont</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">)&lt;&gt;</font><font color="#800000">&quot;-&quot;</font><font color="#808080">) 
      </font><font color="#000080">sisbn</font><font color="#808080">:=</font><font color="#000080">sisbn</font><font color="#808080">+</font><font color="#000080">substr</font><font color="#808080">(</font><font color="#000080">isbn</font><font color="#808080">,</font><font color="#000080">ncont</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">)
    </font><font color="#0000FF">endif 
  next
  if </font><font color="#000080">sdigito </font><font color="#808080">= </font><font color="#800000">&quot;X&quot;
    </font><font color="#000080">nsoma </font><font color="#808080">:= </font><font color="#FF0000">10
  </font><font color="#0000FF">else
    </font><font color="#000080">nvalor</font><font color="#808080">:=</font><font color="#0000FF">Val</font><font color="#808080">(</font><font color="#000080">sdigito</font><font color="#808080">)
    </font><font color="#000080">nsoma</font><font color="#808080">:=</font><font color="#000080">nvalor
  </font><font color="#0000FF">endif
  for </font><font color="#000080">ncont</font><font color="#808080">:=</font><font color="#FF0000">1 </font><font color="#0000FF">to </font><font color="#FF0000">9
    </font><font color="#000080">snum</font><font color="#808080">:=</font><font color="#000080">substr</font><font color="#808080">(</font><font color="#000080">sisbn</font><font color="#808080">, </font><font color="#000080">ncont</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">)
    </font><font color="#000080">nvalor</font><font color="#808080">:=</font><font color="#0000FF">Val</font><font color="#808080">(</font><font color="#000080">snum</font><font color="#808080">)
    </font><font color="#000080">nsoma</font><font color="#808080">:=</font><font color="#000080">nsoma </font><font color="#808080">+ (</font><font color="#000080">nvalor </font><font color="#808080">* (</font><font color="#FF0000">11 </font><font color="#808080">- </font><font color="#000080">ncont</font><font color="#808080">))
  </font><font color="#0000FF">next
  If </font><font color="#808080">(</font><font color="#000080">nsoma </font><font color="#808080">% </font><font color="#FF0000">11</font><font color="#808080">) = </font><font color="#FF0000">0
    </font><font color="#000080">bvalidaISBN</font><font color="#808080">:=.t.
  </font><font color="#0000FF">else
    </font><font color="#000080">bvalidaISBN</font><font color="#808080">:=.f.
  </font><font color="#0000FF">endif
else
  </font><font color="#000080">bvalidaISBN</font><font color="#808080">:=.f.
</font><font color="#0000FF">endif
return</font><font color="#808080">(</font><font color="#000080">bvalidaISBN</font><font color="#808080">)
/*------------------------------------------------------------------------------
</font><font color="#000080">Esconde a digita&ccedil;&atilde;o da senha
retorna </font><font color="#808080">- </font><font color="#000080">a senha digitada
</font><font color="#808080">------------------------------------------------------------------------------*/
</font><font color="#0000FF">function </font><font color="#000080">digitaSenha</font><font color="#808080">(</font><font color="#000080">sRotulo</font><font color="#808080">, </font><font color="#000080">nTamSenha</font><font color="#808080">)
</font><font color="#0000FF">local </font><font color="#000080">sSenha</font><font color="#808080">, </font><font color="#000080">ncont</font><font color="#808080">, </font><font color="#000080">nLetra
  
  qout</font><font color="#808080">(</font><font color="#000080">sRotulo</font><font color="#808080">)
  </font><font color="#000080">ncont </font><font color="#808080">:= </font><font color="#FF0000">0
  </font><font color="#000080">sSenha</font><font color="#808080">:=</font><font color="#800000">&quot;&quot;
  </font><font color="#000080">nLetra</font><font color="#808080">:=</font><font color="#FF0000">0
  </font><font color="#0000FF">do while</font><font color="#808080">((</font><font color="#000080">nLetra</font><font color="#808080">&lt;&gt;</font><font color="#000080">K_ENTER</font><font color="#808080">) .and. (</font><font color="#000080">ncont </font><font color="#808080">&lt; </font><font color="#000080">nTamSenha</font><font color="#808080">))    
    </font><font color="#000080">nLetra</font><font color="#808080">:=</font><font color="#000080">inkey</font><font color="#808080">(</font><font color="#FF0000">0</font><font color="#808080">)
    </font><font color="#0000FF">if </font><font color="#000080">nLetra</font><font color="#808080">&lt;&gt;</font><font color="#000080">K_ENTER 
      sSenha</font><font color="#808080">:=</font><font color="#000080">sSenha</font><font color="#808080">+</font><font color="#0000FF">chr</font><font color="#808080">(</font><font color="#000080">nLetra</font><font color="#808080">)
    </font><font color="#0000FF">endif
    </font><font color="#000080">ncont</font><font color="#808080">++
  </font><font color="#0000FF">enddo
return</font><font color="#808080">(</font><font color="#000080">sSenha</font><font color="#808080">)
/*------------------------------------------------------------------------------
</font><font color="#000080">Valida&ccedil;&atilde;o de um n&uacute;mero qualquer</font><font color="#808080">.
</font><font color="#000080">sRotulo </font><font color="#808080">- </font><font color="#000080">o texto antes de se digitar o n&uacute;mero
sNumero </font><font color="#808080">- </font><font color="#000080">a mstring com o valor </font><font color="#0000FF">do </font><font color="#000080">n&uacute;mero
retorna </font><font color="#808080">- </font><font color="#000080">o sNumero
</font><font color="#808080">------------------------------------------------------------------------------*/
</font><font color="#0000FF">function </font><font color="#000080">validaNumero</font><font color="#808080">(</font><font color="#000080">sRotulo</font><font color="#808080">, </font><font color="#000080">sNumero</font><font color="#808080">)
</font><font color="#0000FF">local </font><font color="#000080">nnum</font><font color="#808080">, </font><font color="#000080">nStatus

nStatus</font><font color="#808080">:=-</font><font color="#FF0000">1
</font><font color="#0000FF">do while </font><font color="#808080">(</font><font color="#000080">nStatus</font><font color="#808080">&lt;&gt;</font><font color="#FF0000">0</font><font color="#808080">)
  </font><font color="#0000FF">accept </font><font color="#000080">sRotulo </font><font color="#0000FF">to </font><font color="#000080">sNumero
  nnum</font><font color="#808080">:=</font><font color="#0000FF">Val</font><font color="#808080">(</font><font color="#000080">sNumero</font><font color="#808080">)
  </font><font color="#0000FF">if </font><font color="#808080">(</font><font color="#000080">ValType</font><font color="#808080">(</font><font color="#000080">nnum</font><font color="#808080">)&lt;&gt;</font><font color="#800000">&quot;N&quot;</font><font color="#808080">) .or. (</font><font color="#000080">nnum </font><font color="#808080">&lt; </font><font color="#FF0000">1</font><font color="#808080">)
     </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#000080">MSG_NUMINV</font><font color="#808080">)
  </font><font color="#0000FF">else
     </font><font color="#000080">nStatus </font><font color="#808080">= </font><font color="#FF0000">0
  </font><font color="#0000FF">endif
enddo
return</font><font color="#808080">(</font><font color="#000080">sNumero</font><font color="#808080">)
/*------------------------------------------------------------------------------
</font><font color="#000080">Valida&ccedil;&atilde;o de uma data ou data</font><font color="#808080">/</font><font color="#000080">hora qualquer</font><font color="#808080">.
</font><font color="#000080">sRotulo </font><font color="#808080">- </font><font color="#000080">o texto antes de se digitar a data</font><font color="#808080">/</font><font color="#000080">hora
sDataHora </font><font color="#808080">- </font><font color="#000080">a mstring com o valor da data</font><font color="#808080">/</font><font color="#000080">hora
bSoData </font><font color="#808080">- </font><font color="#000080">indica se vai validar somente uma data sem a hora
retorna </font><font color="#808080">- </font><font color="#000080">a sDataHora
</font><font color="#808080">------------------------------------------------------------------------------*/
</font><font color="#0000FF">function </font><font color="#000080">validaDataHora</font><font color="#808080">(</font><font color="#000080">sRotulo</font><font color="#808080">, </font><font color="#000080">sDataHora</font><font color="#808080">, </font><font color="#000080">bSoData</font><font color="#808080">)
</font><font color="#0000FF">local </font><font color="#000080">bvalida</font><font color="#808080">, </font><font color="#000080">bdatavalida</font><font color="#808080">, </font><font color="#000080">bhoravalida
</font><font color="#0000FF">local </font><font color="#000080">sdia</font><font color="#808080">, </font><font color="#000080">smes</font><font color="#808080">, </font><font color="#000080">sano</font><font color="#808080">, </font><font color="#000080">shora</font><font color="#808080">, </font><font color="#000080">smin</font><font color="#808080">, </font><font color="#000080">sseg
</font><font color="#0000FF">local </font><font color="#000080">ndia</font><font color="#808080">, </font><font color="#000080">nmes</font><font color="#808080">, </font><font color="#000080">nano</font><font color="#808080">, </font><font color="#000080">nhora</font><font color="#808080">, </font><font color="#000080">nmin</font><font color="#808080">, </font><font color="#000080">nseg</font><font color="#808080">, </font><font color="#000080">nudiames
</font><font color="#0000FF">local </font><font color="#000080">nStatus</font><font color="#808080">, </font><font color="#000080">ntam

bvalida</font><font color="#808080">:=.f.
</font><font color="#000080">bdatavalida</font><font color="#808080">:=.f.
</font><font color="#000080">bhoravalida</font><font color="#808080">:=.f.
</font><font color="#000080">nudiames</font><font color="#808080">:=</font><font color="#FF0000">0

</font><font color="#0000FF">if </font><font color="#000080">bSoData</font><font color="#808080">=.t. 
  </font><font color="#000080">ntam</font><font color="#808080">:=</font><font color="#FF0000">10
</font><font color="#0000FF">else 
  </font><font color="#000080">ntam</font><font color="#808080">:=</font><font color="#FF0000">19
</font><font color="#0000FF">endif
do while </font><font color="#808080">(</font><font color="#000080">bvalida</font><font color="#808080">=.f.)
  </font><font color="#0000FF">accept </font><font color="#000080">sRotulo </font><font color="#0000FF">to </font><font color="#000080">sDataHora
  </font><font color="#0000FF">if </font><font color="#000080">len</font><font color="#808080">(</font><font color="#000080">sDataHora</font><font color="#808080">)=</font><font color="#000080">ntam 
    sdia</font><font color="#808080">:=</font><font color="#000080">substr</font><font color="#808080">(</font><font color="#000080">sDataHora</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#FF0000">2</font><font color="#808080">)
    </font><font color="#000080">ndia</font><font color="#808080">:=</font><font color="#0000FF">Val</font><font color="#808080">(</font><font color="#000080">sdia</font><font color="#808080">)
    </font><font color="#000080">smes</font><font color="#808080">:=</font><font color="#000080">substr</font><font color="#808080">(</font><font color="#000080">sDataHora</font><font color="#808080">,</font><font color="#FF0000">4</font><font color="#808080">,</font><font color="#FF0000">2</font><font color="#808080">)
    </font><font color="#000080">nmes</font><font color="#808080">:=</font><font color="#0000FF">Val</font><font color="#808080">(</font><font color="#000080">smes</font><font color="#808080">)
    </font><font color="#000080">sano</font><font color="#808080">:=</font><font color="#000080">substr</font><font color="#808080">(</font><font color="#000080">sDataHora</font><font color="#808080">,</font><font color="#FF0000">7</font><font color="#808080">,</font><font color="#FF0000">4</font><font color="#808080">)
    </font><font color="#000080">nano</font><font color="#808080">:=</font><font color="#0000FF">Val</font><font color="#808080">(</font><font color="#000080">sano</font><font color="#808080">)
  
    </font><font color="#0000FF">if </font><font color="#808080">(</font><font color="#000080">nano </font><font color="#808080">&gt;= </font><font color="#FF0000">1</font><font color="#808080">) .and. (</font><font color="#000080">nano </font><font color="#808080">&lt;= </font><font color="#FF0000">9999</font><font color="#808080">) 
      </font><font color="#0000FF">if </font><font color="#808080">(</font><font color="#000080">nmes </font><font color="#808080">&gt;= </font><font color="#FF0000">1</font><font color="#808080">) .and. (</font><font color="#000080">nmes </font><font color="#808080">&lt;= </font><font color="#FF0000">31</font><font color="#808080">) 
          </font><font color="#0000FF">do case 
           case </font><font color="#000080">nmes </font><font color="#808080">= </font><font color="#FF0000">1 </font><font color="#808080">.or. </font><font color="#000080">nmes </font><font color="#808080">= </font><font color="#FF0000">3 </font><font color="#808080">.or. </font><font color="#000080">nmes </font><font color="#808080">= </font><font color="#FF0000">5 </font><font color="#808080">.or. </font><font color="#000080">nmes </font><font color="#808080">= </font><font color="#FF0000">7 </font><font color="#808080">.or.;
                </font><font color="#000080">nmes </font><font color="#808080">= </font><font color="#FF0000">8 </font><font color="#808080">.or. </font><font color="#000080">nmes </font><font color="#808080">= </font><font color="#FF0000">10 </font><font color="#808080">.or. </font><font color="#000080">nmes </font><font color="#808080">= </font><font color="#FF0000">12
               </font><font color="#000080">nudiames</font><font color="#808080">:=</font><font color="#FF0000">31
           </font><font color="#0000FF">case </font><font color="#000080">nmes </font><font color="#808080">= </font><font color="#FF0000">2
               </font><font color="#808080">/* </font><font color="#000080">ano bissexto </font><font color="#808080">*/
               </font><font color="#0000FF">if </font><font color="#808080">(</font><font color="#000080">nano </font><font color="#808080">% </font><font color="#FF0000">4</font><font color="#808080">)=</font><font color="#FF0000">0 
                 </font><font color="#000080">nudiames</font><font color="#808080">:=</font><font color="#FF0000">29
               </font><font color="#0000FF">else 
                 </font><font color="#000080">nudiames</font><font color="#808080">:=</font><font color="#FF0000">28
               </font><font color="#0000FF">endif
           case </font><font color="#000080">nmes </font><font color="#808080">= </font><font color="#FF0000">4 </font><font color="#808080">.or. </font><font color="#000080">nmes </font><font color="#808080">= </font><font color="#FF0000">6 </font><font color="#808080">.or. </font><font color="#000080">nmes </font><font color="#808080">= </font><font color="#FF0000">9 </font><font color="#808080">.or. </font><font color="#000080">nmes </font><font color="#808080">= </font><font color="#FF0000">11 
              </font><font color="#000080">nudiames</font><font color="#808080">:=</font><font color="#FF0000">30
          </font><font color="#0000FF">endcase
          if </font><font color="#808080">(</font><font color="#000080">ndia </font><font color="#808080">&gt;=</font><font color="#FF0000">1</font><font color="#808080">) .and. (</font><font color="#000080">ndia </font><font color="#808080">&lt;=</font><font color="#000080">nudiames</font><font color="#808080">)
             </font><font color="#000080">bdatavalida</font><font color="#808080">:=.t.
          </font><font color="#0000FF">endif
      endif
    endif
  
    if </font><font color="#000080">bSoData 
       </font><font color="#0000FF">if </font><font color="#000080">bdatavalida 
          bvalida</font><font color="#808080">:=.t.
       </font><font color="#0000FF">else 
          </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#000080">MSG_DATAINV</font><font color="#808080">)
       </font><font color="#0000FF">endif
    else 
      if </font><font color="#000080">bdatavalida 
          shora</font><font color="#808080">:=</font><font color="#000080">substr</font><font color="#808080">(</font><font color="#000080">sDataHora</font><font color="#808080">,</font><font color="#FF0000">12</font><font color="#808080">,</font><font color="#FF0000">2</font><font color="#808080">)
          </font><font color="#000080">nhora</font><font color="#808080">:=</font><font color="#0000FF">Val</font><font color="#808080">(</font><font color="#000080">shora</font><font color="#808080">)
          </font><font color="#000080">smin</font><font color="#808080">:=</font><font color="#000080">substr</font><font color="#808080">(</font><font color="#000080">sDataHora</font><font color="#808080">,</font><font color="#FF0000">15</font><font color="#808080">,</font><font color="#FF0000">2</font><font color="#808080">)
          </font><font color="#000080">nmin</font><font color="#808080">:=</font><font color="#0000FF">Val</font><font color="#808080">(</font><font color="#000080">smin</font><font color="#808080">)
          </font><font color="#000080">sseg</font><font color="#808080">:=</font><font color="#000080">substr</font><font color="#808080">(</font><font color="#000080">sDataHora</font><font color="#808080">,</font><font color="#FF0000">18</font><font color="#808080">,</font><font color="#FF0000">2</font><font color="#808080">)
          </font><font color="#000080">nseg</font><font color="#808080">:=</font><font color="#0000FF">Val</font><font color="#808080">(</font><font color="#000080">sseg</font><font color="#808080">)
  
          </font><font color="#0000FF">if </font><font color="#808080">(</font><font color="#000080">nhora </font><font color="#808080">&gt;= </font><font color="#FF0000">0</font><font color="#808080">) .and. (</font><font color="#000080">nhora </font><font color="#808080">&lt;= </font><font color="#FF0000">23</font><font color="#808080">) 
            </font><font color="#0000FF">if </font><font color="#808080">(</font><font color="#000080">nmin </font><font color="#808080">&gt;= </font><font color="#FF0000">0</font><font color="#808080">) .and. (</font><font color="#000080">nmin </font><font color="#808080">&lt;= </font><font color="#FF0000">59</font><font color="#808080">) 
              </font><font color="#0000FF">if </font><font color="#808080">(</font><font color="#000080">nseg </font><font color="#808080">&gt;= </font><font color="#FF0000">0</font><font color="#808080">) .and. (</font><font color="#000080">nseg </font><font color="#808080">&lt;= </font><font color="#FF0000">59</font><font color="#808080">)
                 </font><font color="#000080">bhoravalida</font><font color="#808080">:=.t.
              </font><font color="#0000FF">endif 
            endif
          endif
  
          if </font><font color="#000080">bhoravalida 
            bvalida</font><font color="#808080">:=.t.
          </font><font color="#0000FF">else 
            </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#000080">MSG_DTHRINV</font><font color="#808080">)
          </font><font color="#0000FF">endif
      else
        </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#000080">MSG_DTHRINV</font><font color="#808080">)
      </font><font color="#0000FF">endif
    endif
  else 
    if </font><font color="#000080">bSoData</font><font color="#808080">=.t. 
       </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#000080">MSG_DATAINV</font><font color="#808080">)
    </font><font color="#0000FF">else 
       </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#000080">MSG_DTHRINV</font><font color="#808080">)
    </font><font color="#0000FF">endif
  endif
enddo
return</font><font color="#808080">(</font><font color="#000080">sDataHora</font><font color="#808080">)
/*------------------------------------------------------------------------------
</font><font color="#000080">Retorna a Data e a hora </font><font color="#0000FF">do </font><font color="#000080">sistema</font><font color="#808080">.
</font><font color="#000080">retorna </font><font color="#808080">- </font><font color="#000080">a data e a hora
</font><font color="#808080">------------------------------------------------------------------------------*/
</font><font color="#0000FF">function </font><font color="#000080">retDataHora</font><font color="#808080">()
</font><font color="#0000FF">return</font><font color="#808080">(</font><font color="#000080">dtoc</font><font color="#808080">(</font><font color="#0000FF">date</font><font color="#808080">())+</font><font color="#800000">&quot; &quot;</font><font color="#808080">+</font><font color="#000080">time</font><font color="#808080">())

/*--- </font><font color="#000080">Rotinas de manipula&ccedil;&atilde;o de arquivos </font><font color="#808080">--------------------------------------*/

/*------------------------------------------------------------------------------
</font><font color="#000080">Calcula o tamanho </font><font color="#0000FF">do </font><font color="#000080">arquivo</font><font color="#808080">.
</font><font color="#000080">sArq </font><font color="#808080">- </font><font color="#000080">o arquivo
retorna </font><font color="#808080">- </font><font color="#000080">o tamanho </font><font color="#0000FF">do </font><font color="#000080">arquivo
</font><font color="#808080">------------------------------------------------------------------------------*/
</font><font color="#0000FF">function </font><font color="#000080">tamArq</font><font color="#808080">(</font><font color="#000080">sArq</font><font color="#808080">)
</font><font color="#0000FF">local </font><font color="#000080">npos</font><font color="#808080">, </font><font color="#000080">ntam

npos </font><font color="#808080">:= </font><font color="#000080">fseek</font><font color="#808080">( </font><font color="#000080">sArq</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#000080">FS_RELATIVE </font><font color="#808080">)
</font><font color="#000080">ntam </font><font color="#808080">:= </font><font color="#000080">fseek</font><font color="#808080">( </font><font color="#000080">sArq</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#000080">FS_END </font><font color="#808080">)
</font><font color="#000080">fseek</font><font color="#808080">(</font><font color="#000080">sArq</font><font color="#808080">, </font><font color="#000080">npos</font><font color="#808080">)
</font><font color="#0000FF">return</font><font color="#808080">(</font><font color="#000080">ntam</font><font color="#808080">)

/*------------------------------------------------------------------------------
</font><font color="#000080">Verifica se chegou no fim </font><font color="#0000FF">do </font><font color="#000080">arquivo</font><font color="#808080">.
</font><font color="#000080">sArq </font><font color="#808080">- </font><font color="#000080">o arquivo
retorna </font><font color="#808080">- </font><font color="#000080">se chegou ou n&atilde;o o fim de arquivo
</font><font color="#808080">------------------------------------------------------------------------------*/
</font><font color="#0000FF">function </font><font color="#000080">fimArq</font><font color="#808080">(</font><font color="#000080">sArq</font><font color="#808080">)
</font><font color="#0000FF">local </font><font color="#000080">bret

</font><font color="#0000FF">if </font><font color="#000080">tamArq</font><font color="#808080">(</font><font color="#000080">sArq</font><font color="#808080">) == </font><font color="#000080">fseek</font><font color="#808080">(</font><font color="#000080">sArq</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#000080">FS_RELATIVE</font><font color="#808080">)
   </font><font color="#000080">bret</font><font color="#808080">:=.t.
</font><font color="#0000FF">else
   </font><font color="#000080">bret</font><font color="#808080">:=.f.
</font><font color="#0000FF">endif
return</font><font color="#808080">(</font><font color="#000080">bret</font><font color="#808080">)

/*------------------------------------------------------------------------------
</font><font color="#000080">Abre ou cria os arquivos </font><font color="#0000FF">do </font><font color="#000080">sistema</font><font color="#808080">.
</font><font color="#000080">bAbre </font><font color="#808080">- </font><font color="#000080">condi&ccedil;&atilde;o </font><font color="#0000FF">para </font><font color="#000080">abrir ou criar os arquivos </font><font color="#0000FF">do </font><font color="#000080">sistema
</font><font color="#808080">------------------------------------------------------------------------------*/
</font><font color="#0000FF">procedure </font><font color="#000080">abrecriaArqs</font><font color="#808080">(</font><font color="#000080">bAbre</font><font color="#808080">)
</font><font color="#0000FF">if </font><font color="#000080">bAbre 
    </font><font color="#0000FF">if </font><font color="#808080">(</font><font color="#000080">tfAssunto</font><font color="#808080">:=</font><font color="#0000FF">fopen</font><font color="#808080">(</font><font color="#000080">ARQ_ASSUNTO</font><font color="#808080">,</font><font color="#000080">FO_READWRITE</font><font color="#808080">)) = -</font><font color="#FF0000">1
     </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#000080">MSG_ARQERRO</font><font color="#808080">+</font><font color="#800000">&quot; --&gt; &quot;</font><font color="#808080">+</font><font color="#000080">ARQ_ASSUNTO</font><font color="#808080">)
    </font><font color="#0000FF">endif
    if </font><font color="#808080">(</font><font color="#000080">tfAutor</font><font color="#808080">:=</font><font color="#0000FF">fopen</font><font color="#808080">(</font><font color="#000080">ARQ_AUTOR</font><font color="#808080">,</font><font color="#000080">FO_READWRITE</font><font color="#808080">)) = -</font><font color="#FF0000">1
     </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#000080">MSG_ARQERRO</font><font color="#808080">+</font><font color="#800000">&quot; --&gt; &quot;</font><font color="#808080">+</font><font color="#000080">ARQ_AUTOR</font><font color="#808080">)
    </font><font color="#0000FF">endif
    if </font><font color="#808080">(</font><font color="#000080">tfEditora</font><font color="#808080">:=</font><font color="#0000FF">fopen</font><font color="#808080">(</font><font color="#000080">ARQ_EDITORA</font><font color="#808080">,</font><font color="#000080">FO_READWRITE</font><font color="#808080">)) = -</font><font color="#FF0000">1
     </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#000080">MSG_ARQERRO</font><font color="#808080">+</font><font color="#800000">&quot; --&gt; &quot;</font><font color="#808080">+</font><font color="#000080">ARQ_EDITORA</font><font color="#808080">)
    </font><font color="#0000FF">endif
    if </font><font color="#808080">(</font><font color="#000080">tfIdioma</font><font color="#808080">:=</font><font color="#0000FF">fopen</font><font color="#808080">(</font><font color="#000080">ARQ_IDIOMA</font><font color="#808080">,</font><font color="#000080">FO_READWRITE</font><font color="#808080">)) = -</font><font color="#FF0000">1
     </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#000080">MSG_ARQERRO</font><font color="#808080">+</font><font color="#800000">&quot; --&gt; &quot;</font><font color="#808080">+</font><font color="#000080">ARQ_IDIOMA</font><font color="#808080">)
    </font><font color="#0000FF">endif
    if </font><font color="#808080">(</font><font color="#000080">tfEndereco</font><font color="#808080">:=</font><font color="#0000FF">fopen</font><font color="#808080">(</font><font color="#000080">ARQ_ENDERECO</font><font color="#808080">,</font><font color="#000080">FO_READWRITE</font><font color="#808080">)) = -</font><font color="#FF0000">1
     </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#000080">MSG_ARQERRO</font><font color="#808080">+</font><font color="#800000">&quot; --&gt; &quot;</font><font color="#808080">+</font><font color="#000080">ARQ_ENDERECO</font><font color="#808080">)
    </font><font color="#0000FF">endif
    if </font><font color="#808080">(</font><font color="#000080">tfPais</font><font color="#808080">:=</font><font color="#0000FF">fopen</font><font color="#808080">(</font><font color="#000080">ARQ_PAIS</font><font color="#808080">,</font><font color="#000080">FO_READWRITE</font><font color="#808080">)) = -</font><font color="#FF0000">1
     </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#000080">MSG_ARQERRO</font><font color="#808080">+</font><font color="#800000">&quot; --&gt; &quot;</font><font color="#808080">+</font><font color="#000080">ARQ_PAIS</font><font color="#808080">)
    </font><font color="#0000FF">endif
    if </font><font color="#808080">(</font><font color="#000080">tfProfissao</font><font color="#808080">:=</font><font color="#0000FF">fopen</font><font color="#808080">(</font><font color="#000080">ARQ_PROFISSAO</font><font color="#808080">,</font><font color="#000080">FO_READWRITE</font><font color="#808080">)) = -</font><font color="#FF0000">1
     </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#000080">MSG_ARQERRO</font><font color="#808080">+</font><font color="#800000">&quot; --&gt; &quot;</font><font color="#808080">+</font><font color="#000080">ARQ_PROFISSAO</font><font color="#808080">)
    </font><font color="#0000FF">endif
    if </font><font color="#808080">(</font><font color="#000080">tfLivro</font><font color="#808080">:=</font><font color="#0000FF">fopen</font><font color="#808080">(</font><font color="#000080">ARQ_LIVRO</font><font color="#808080">,</font><font color="#000080">FO_READWRITE</font><font color="#808080">)) = -</font><font color="#FF0000">1
     </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#000080">MSG_ARQERRO</font><font color="#808080">+</font><font color="#800000">&quot; --&gt; &quot;</font><font color="#808080">+</font><font color="#000080">ARQ_LIVRO</font><font color="#808080">)
    </font><font color="#0000FF">endif
    if </font><font color="#808080">(</font><font color="#000080">tfLivroAss</font><font color="#808080">:=</font><font color="#0000FF">fopen</font><font color="#808080">(</font><font color="#000080">ARQ_LIVASS</font><font color="#808080">,</font><font color="#000080">FO_READWRITE</font><font color="#808080">)) = -</font><font color="#FF0000">1
     </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#000080">MSG_ARQERRO</font><font color="#808080">+</font><font color="#800000">&quot; --&gt; &quot;</font><font color="#808080">+</font><font color="#000080">ARQ_LIVASS</font><font color="#808080">)
    </font><font color="#0000FF">endif
    if </font><font color="#808080">(</font><font color="#000080">tfLivroAut</font><font color="#808080">:=</font><font color="#0000FF">fopen</font><font color="#808080">(</font><font color="#000080">ARQ_LIVAUT</font><font color="#808080">,</font><font color="#000080">FO_READWRITE</font><font color="#808080">)) = -</font><font color="#FF0000">1
     </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#000080">MSG_ARQERRO</font><font color="#808080">+</font><font color="#800000">&quot; --&gt; &quot;</font><font color="#808080">+</font><font color="#000080">ARQ_LIVAUT</font><font color="#808080">)
    </font><font color="#0000FF">endif
    if </font><font color="#808080">(</font><font color="#000080">tfCliente</font><font color="#808080">:=</font><font color="#0000FF">fopen</font><font color="#808080">(</font><font color="#000080">ARQ_CLIENTE</font><font color="#808080">,</font><font color="#000080">FO_READWRITE</font><font color="#808080">)) = -</font><font color="#FF0000">1
     </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#000080">MSG_ARQERRO</font><font color="#808080">+</font><font color="#800000">&quot; --&gt; &quot;</font><font color="#808080">+</font><font color="#000080">ARQ_CLIENTE</font><font color="#808080">)
    </font><font color="#0000FF">endif
    if </font><font color="#808080">(</font><font color="#000080">tfUsuario</font><font color="#808080">:=</font><font color="#0000FF">fopen</font><font color="#808080">(</font><font color="#000080">ARQ_USUARIO</font><font color="#808080">,</font><font color="#000080">FO_READWRITE</font><font color="#808080">)) = -</font><font color="#FF0000">1
     </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#000080">MSG_ARQERRO</font><font color="#808080">+</font><font color="#800000">&quot; --&gt; &quot;</font><font color="#808080">+</font><font color="#000080">ARQ_USUARIO</font><font color="#808080">)
    </font><font color="#0000FF">endif
    if </font><font color="#808080">(</font><font color="#000080">tfVenda</font><font color="#808080">:=</font><font color="#0000FF">fopen</font><font color="#808080">(</font><font color="#000080">ARQ_VENDA</font><font color="#808080">,</font><font color="#000080">FO_READWRITE</font><font color="#808080">)) = -</font><font color="#FF0000">1
     </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#000080">MSG_ARQERRO</font><font color="#808080">+</font><font color="#800000">&quot; --&gt; &quot;</font><font color="#808080">+</font><font color="#000080">ARQ_VENDA</font><font color="#808080">)
    </font><font color="#0000FF">endif
else 
    if </font><font color="#808080">(</font><font color="#000080">tfAssunto</font><font color="#808080">:=</font><font color="#0000FF">fcreate</font><font color="#808080">(</font><font color="#000080">ARQ_ASSUNTO</font><font color="#808080">,</font><font color="#000080">FC_NORMAL</font><font color="#808080">)) = -</font><font color="#FF0000">1
     </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#000080">MSG_ARQCERRO</font><font color="#808080">+</font><font color="#800000">&quot; --&gt; &quot;</font><font color="#808080">+</font><font color="#000080">ARQ_ASSUNTO</font><font color="#808080">)
    </font><font color="#0000FF">endif 
    if </font><font color="#808080">(</font><font color="#000080">tfAutor</font><font color="#808080">:=</font><font color="#0000FF">fcreate</font><font color="#808080">(</font><font color="#000080">ARQ_AUTOR</font><font color="#808080">,</font><font color="#000080">FC_NORMAL</font><font color="#808080">)) = -</font><font color="#FF0000">1
     </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#000080">MSG_ARQCERRO</font><font color="#808080">+</font><font color="#800000">&quot; --&gt; &quot;</font><font color="#808080">+</font><font color="#000080">ARQ_AUTOR</font><font color="#808080">)
    </font><font color="#0000FF">endif
    if </font><font color="#808080">(</font><font color="#000080">tfEditora</font><font color="#808080">:=</font><font color="#0000FF">fcreate</font><font color="#808080">(</font><font color="#000080">ARQ_EDITORA</font><font color="#808080">,</font><font color="#000080">FC_NORMAL</font><font color="#808080">)) = -</font><font color="#FF0000">1
     </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#000080">MSG_ARQCERRO</font><font color="#808080">+</font><font color="#800000">&quot; --&gt; &quot;</font><font color="#808080">+</font><font color="#000080">ARQ_EDITORA</font><font color="#808080">)
    </font><font color="#0000FF">endif
    if </font><font color="#808080">(</font><font color="#000080">tfIdioma</font><font color="#808080">:=</font><font color="#0000FF">fcreate</font><font color="#808080">(</font><font color="#000080">ARQ_IDIOMA</font><font color="#808080">,</font><font color="#000080">FC_NORMAL</font><font color="#808080">)) = -</font><font color="#FF0000">1
     </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#000080">MSG_ARQCERRO</font><font color="#808080">+</font><font color="#800000">&quot; --&gt; &quot;</font><font color="#808080">+</font><font color="#000080">ARQ_IDIOMA</font><font color="#808080">)
    </font><font color="#0000FF">endif 
    if </font><font color="#808080">(</font><font color="#000080">tfEndereco</font><font color="#808080">:=</font><font color="#0000FF">fcreate</font><font color="#808080">(</font><font color="#000080">ARQ_ENDERECO</font><font color="#808080">,</font><font color="#000080">FC_NORMAL</font><font color="#808080">)) = -</font><font color="#FF0000">1
     </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#000080">MSG_ARQCERRO</font><font color="#808080">+</font><font color="#800000">&quot; --&gt; &quot;</font><font color="#808080">+</font><font color="#000080">ARQ_ENDERECO</font><font color="#808080">)
    </font><font color="#0000FF">endif 
    if </font><font color="#808080">(</font><font color="#000080">tfPais</font><font color="#808080">:=</font><font color="#0000FF">fcreate</font><font color="#808080">(</font><font color="#000080">ARQ_PAIS</font><font color="#808080">,</font><font color="#000080">FC_NORMAL</font><font color="#808080">)) = -</font><font color="#FF0000">1
     </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#000080">MSG_ARQCERRO</font><font color="#808080">+</font><font color="#800000">&quot; --&gt; &quot;</font><font color="#808080">+</font><font color="#000080">ARQ_PAIS</font><font color="#808080">)
    </font><font color="#0000FF">endif 
    if </font><font color="#808080">(</font><font color="#000080">tfProfissao</font><font color="#808080">:=</font><font color="#0000FF">fcreate</font><font color="#808080">(</font><font color="#000080">ARQ_PROFISSAO</font><font color="#808080">,</font><font color="#000080">FC_NORMAL</font><font color="#808080">)) = -</font><font color="#FF0000">1
     </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#000080">MSG_ARQCERRO</font><font color="#808080">+</font><font color="#800000">&quot; --&gt; &quot;</font><font color="#808080">+</font><font color="#000080">ARQ_PROFISSAO</font><font color="#808080">)
    </font><font color="#0000FF">endif 
    if </font><font color="#808080">(</font><font color="#000080">tfLivro</font><font color="#808080">:=</font><font color="#0000FF">fcreate</font><font color="#808080">(</font><font color="#000080">ARQ_LIVRO</font><font color="#808080">,</font><font color="#000080">FC_NORMAL</font><font color="#808080">)) = -</font><font color="#FF0000">1
     </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#000080">MSG_ARQCERRO</font><font color="#808080">+</font><font color="#800000">&quot; --&gt; &quot;</font><font color="#808080">+</font><font color="#000080">ARQ_LIVRO</font><font color="#808080">)
    </font><font color="#0000FF">endif 
    if </font><font color="#808080">(</font><font color="#000080">tfLivroAss</font><font color="#808080">:=</font><font color="#0000FF">fcreate</font><font color="#808080">(</font><font color="#000080">ARQ_LIVASS</font><font color="#808080">,</font><font color="#000080">FC_NORMAL</font><font color="#808080">)) = -</font><font color="#FF0000">1
     </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#000080">MSG_ARQCERRO</font><font color="#808080">+</font><font color="#800000">&quot; --&gt; &quot;</font><font color="#808080">+</font><font color="#000080">ARQ_LIVASS</font><font color="#808080">)
    </font><font color="#0000FF">endif 
    if </font><font color="#808080">(</font><font color="#000080">tfLivroAut</font><font color="#808080">:=</font><font color="#0000FF">fcreate</font><font color="#808080">(</font><font color="#000080">ARQ_LIVAUT</font><font color="#808080">,</font><font color="#000080">FC_NORMAL</font><font color="#808080">)) = -</font><font color="#FF0000">1
     </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#000080">MSG_ARQCERRO</font><font color="#808080">+</font><font color="#800000">&quot; --&gt; &quot;</font><font color="#808080">+</font><font color="#000080">ARQ_LIVAUT</font><font color="#808080">)
    </font><font color="#0000FF">endif
    if </font><font color="#808080">(</font><font color="#000080">tfCliente</font><font color="#808080">:=</font><font color="#0000FF">fcreate</font><font color="#808080">(</font><font color="#000080">ARQ_CLIENTE</font><font color="#808080">,</font><font color="#000080">FC_NORMAL</font><font color="#808080">)) = -</font><font color="#FF0000">1
     </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#000080">MSG_ARQCERRO</font><font color="#808080">+</font><font color="#800000">&quot; --&gt; &quot;</font><font color="#808080">+</font><font color="#000080">ARQ_CLIENTE</font><font color="#808080">)
    </font><font color="#0000FF">endif 
    if </font><font color="#808080">(</font><font color="#000080">tfUsuario</font><font color="#808080">:=</font><font color="#0000FF">fcreate</font><font color="#808080">(</font><font color="#000080">ARQ_USUARIO</font><font color="#808080">,</font><font color="#000080">FC_NORMAL</font><font color="#808080">)) = -</font><font color="#FF0000">1
     </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#000080">MSG_ARQCERRO</font><font color="#808080">+</font><font color="#800000">&quot; --&gt; &quot;</font><font color="#808080">+</font><font color="#000080">ARQ_USUARIO</font><font color="#808080">)
    </font><font color="#0000FF">endif 
    if </font><font color="#808080">(</font><font color="#000080">tfVenda</font><font color="#808080">:=</font><font color="#0000FF">fcreate</font><font color="#808080">(</font><font color="#000080">ARQ_VENDA</font><font color="#808080">,</font><font color="#000080">FC_NORMAL</font><font color="#808080">)) = -</font><font color="#FF0000">1
     </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#000080">MSG_ARQCERRO</font><font color="#808080">+</font><font color="#800000">&quot; --&gt; &quot;</font><font color="#808080">+</font><font color="#000080">ARQ_VENDA</font><font color="#808080">)
    </font><font color="#0000FF">endif
endif
return
</font><font color="#808080">/*------------------------------------------------------------------------------
</font><font color="#000080">Fecha todos os arquivos abertos</font><font color="#808080">.
------------------------------------------------------------------------------*/
</font><font color="#0000FF">procedure </font><font color="#000080">fechaArqs</font><font color="#808080">()
  </font><font color="#0000FF">fclose</font><font color="#808080">(</font><font color="#000080">tfAssunto</font><font color="#808080">)
  </font><font color="#0000FF">fclose</font><font color="#808080">(</font><font color="#000080">tfAutor</font><font color="#808080">)
  </font><font color="#0000FF">fclose</font><font color="#808080">(</font><font color="#000080">tfEditora</font><font color="#808080">)
  </font><font color="#0000FF">fclose</font><font color="#808080">(</font><font color="#000080">tfIdioma</font><font color="#808080">)
  </font><font color="#0000FF">fclose</font><font color="#808080">(</font><font color="#000080">tfEndereco</font><font color="#808080">)
  </font><font color="#0000FF">fclose</font><font color="#808080">(</font><font color="#000080">tfPais</font><font color="#808080">)
  </font><font color="#0000FF">fclose</font><font color="#808080">(</font><font color="#000080">tfProfissao</font><font color="#808080">)
  </font><font color="#0000FF">fclose</font><font color="#808080">(</font><font color="#000080">tfLivro</font><font color="#808080">)
  </font><font color="#0000FF">fclose</font><font color="#808080">(</font><font color="#000080">tfLivroAss</font><font color="#808080">)
  </font><font color="#0000FF">fclose</font><font color="#808080">(</font><font color="#000080">tfLivroAut</font><font color="#808080">)
  </font><font color="#0000FF">fclose</font><font color="#808080">(</font><font color="#000080">tfCliente</font><font color="#808080">)
  </font><font color="#0000FF">fclose</font><font color="#808080">(</font><font color="#000080">tfUsuario</font><font color="#808080">)
  </font><font color="#0000FF">fclose</font><font color="#808080">(</font><font color="#000080">tfVenda</font><font color="#808080">)
</font><font color="#0000FF">return
</font><font color="#808080">/*------------------------------------------------------------------------------
</font><font color="#000080">Pesquisa um registro atrav&eacute;s de um valor chave num arquivo</font><font color="#808080">.
</font><font color="#000080">sArq </font><font color="#808080">- </font><font color="#000080">o arquivo
sChave </font><font color="#808080">- </font><font color="#000080">a chave a ser pesquisada
nPosChave </font><font color="#808080">- </font><font color="#000080">a posicao inicial da chave dentro </font><font color="#0000FF">do </font><font color="#000080">registro
nTamChave </font><font color="#808080">- </font><font color="#000080">o tamanho da chave dentro </font><font color="#0000FF">do </font><font color="#000080">registro
nTamLinha </font><font color="#808080">- </font><font color="#000080">o tamanho </font><font color="#0000FF">do </font><font color="#000080">registro
retorna </font><font color="#808080">- </font><font color="#000080">o registro pesquisado
</font><font color="#808080">------------------------------------------------------------------------------*/
</font><font color="#0000FF">function </font><font color="#000080">pesqArq</font><font color="#808080">(</font><font color="#000080">sArq</font><font color="#808080">, </font><font color="#000080">sChave</font><font color="#808080">, </font><font color="#000080">nPosChave</font><font color="#808080">, </font><font color="#000080">nTamChave</font><font color="#808080">, </font><font color="#000080">nTamLinha</font><font color="#808080">)
</font><font color="#0000FF">local </font><font color="#000080">spesqArq</font><font color="#808080">, </font><font color="#000080">sres</font><font color="#808080">, </font><font color="#000080">bQuebra</font><font color="#808080">, </font><font color="#000080">nStatus</font><font color="#808080">, </font><font color="#000080">nPosicao</font><font color="#808080">, </font><font color="#000080">nler</font><font color="#808080">, </font><font color="#000080">slinha

nler</font><font color="#808080">:=</font><font color="#000080">nTamLinha </font><font color="#808080">+ </font><font color="#000080">TAM_CRLF
slinha</font><font color="#808080">:=</font><font color="#0000FF">space</font><font color="#808080">(</font><font color="#000080">nler</font><font color="#808080">)
</font><font color="#000080">bQuebra</font><font color="#808080">:=.f.
</font><font color="#000080">fseek</font><font color="#808080">(</font><font color="#000080">sArq</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#000080">FS_SET</font><font color="#808080">)
</font><font color="#0000FF">do while </font><font color="#808080">(!</font><font color="#000080">fimArq</font><font color="#808080">(</font><font color="#000080">sArq</font><font color="#808080">)) .and. (</font><font color="#000080">bQuebra</font><font color="#808080">=.f.) 
  </font><font color="#000080">fread</font><font color="#808080">(</font><font color="#000080">sArq</font><font color="#808080">, </font><font color="#0000FF">@</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#000080">nler</font><font color="#808080">)
  </font><font color="#000080">sres</font><font color="#808080">:=</font><font color="#0000FF">alltrim</font><font color="#808080">(</font><font color="#000080">substr</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">,</font><font color="#000080">nPosChave</font><font color="#808080">,</font><font color="#000080">nTamChave</font><font color="#808080">))
  </font><font color="#0000FF">if </font><font color="#000080">sres </font><font color="#808080">== </font><font color="#000080">sChave
     bQuebra</font><font color="#808080">:=.t.
  </font><font color="#0000FF">endif
enddo
</font><font color="#000080">nPosicao</font><font color="#808080">:=</font><font color="#000080">fseek</font><font color="#808080">(</font><font color="#000080">sArq</font><font color="#808080">,</font><font color="#FF0000">0</font><font color="#808080">,</font><font color="#000080">FS_RELATIVE</font><font color="#808080">)-(</font><font color="#000080">nTamLinha </font><font color="#808080">+ </font><font color="#000080">TAM_CRLF</font><font color="#808080">)
</font><font color="#0000FF">if </font><font color="#000080">nPosicao </font><font color="#808080">&gt; </font><font color="#FF0000">0
   </font><font color="#000080">fseek</font><font color="#808080">(</font><font color="#000080">sArq</font><font color="#808080">, </font><font color="#000080">nPosicao</font><font color="#808080">, </font><font color="#000080">FS_SET</font><font color="#808080">)
</font><font color="#0000FF">else
   </font><font color="#000080">fseek</font><font color="#808080">(</font><font color="#000080">sArq</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#000080">FS_SET</font><font color="#808080">)
</font><font color="#0000FF">endif
if </font><font color="#000080">sres</font><font color="#808080">==</font><font color="#000080">sChave
   spesqArq</font><font color="#808080">:=</font><font color="#000080">substr</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#000080">nTamLinha</font><font color="#808080">)
</font><font color="#0000FF">else
   </font><font color="#000080">spesqArq</font><font color="#808080">:=</font><font color="#800000">&quot;&quot;
</font><font color="#0000FF">endif
return</font><font color="#808080">(</font><font color="#000080">spesqArq</font><font color="#808080">)
/*------------------------------------------------------------------------------
</font><font color="#000080">Pesquisa se tem linha exclu&iacute;da sen&atilde;o vai </font><font color="#0000FF">para </font><font color="#000080">a &uacute;ltima linha </font><font color="#0000FF">do </font><font color="#000080">arquivo</font><font color="#808080">.
</font><font color="#000080">sArq </font><font color="#808080">- </font><font color="#000080">o arquivo
nTamLinha </font><font color="#808080">- </font><font color="#000080">o tamanho </font><font color="#0000FF">do </font><font color="#000080">registro
</font><font color="#808080">------------------------------------------------------------------------------*/
</font><font color="#0000FF">procedure </font><font color="#000080">pesqLinhaExcluida</font><font color="#808080">(</font><font color="#000080">sArq</font><font color="#808080">, </font><font color="#000080">nTamLinha</font><font color="#808080">)
</font><font color="#0000FF">local </font><font color="#000080">sExcluido

sExcluido</font><font color="#808080">:=</font><font color="#000080">pesqArq</font><font color="#808080">(</font><font color="#000080">sArq</font><font color="#808080">, </font><font color="#800000">&quot;*&quot;</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#000080">nTamLinha</font><font color="#808080">)
</font><font color="#0000FF">if empty</font><font color="#808080">(</font><font color="#000080">sExcluido</font><font color="#808080">)
   </font><font color="#000080">fseek</font><font color="#808080">(</font><font color="#000080">sArq</font><font color="#808080">, </font><font color="#000080">tamArq</font><font color="#808080">(</font><font color="#000080">sArq</font><font color="#808080">), </font><font color="#000080">FS_SET</font><font color="#808080">)
</font><font color="#0000FF">endif
return
</font><font color="#808080">/*------------------------------------------------------------------------------
</font><font color="#000080">Pesquisa o maior c&oacute;digo num arquivo</font><font color="#808080">.
</font><font color="#000080">sArq </font><font color="#808080">- </font><font color="#000080">o arquivo
nPosChave </font><font color="#808080">- </font><font color="#000080">a posicao inicial da chave dentro </font><font color="#0000FF">do </font><font color="#000080">registro
nTamChave </font><font color="#808080">- </font><font color="#000080">o tamanho da chave dentro </font><font color="#0000FF">do </font><font color="#000080">registro
nTamLinha </font><font color="#808080">- </font><font color="#000080">o tamanho </font><font color="#0000FF">do </font><font color="#000080">registro
retorna </font><font color="#808080">- </font><font color="#000080">o maior c&oacute;digo
</font><font color="#808080">------------------------------------------------------------------------------*/
</font><font color="#0000FF">function </font><font color="#000080">pesqMaxCod</font><font color="#808080">(</font><font color="#000080">sArq</font><font color="#808080">, </font><font color="#000080">nPosChave</font><font color="#808080">, </font><font color="#000080">nTamChave</font><font color="#808080">, </font><font color="#000080">nTamLinha</font><font color="#808080">)
</font><font color="#0000FF">local </font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#000080">sRes</font><font color="#808080">, </font><font color="#000080">nler
</font><font color="#0000FF">local </font><font color="#000080">bQuebra</font><font color="#808080">, </font><font color="#000080">nStatus</font><font color="#808080">, </font><font color="#000080">nMaior</font><font color="#808080">, </font><font color="#000080">nCod

nler</font><font color="#808080">:=</font><font color="#000080">nTamLinha </font><font color="#808080">+ </font><font color="#000080">TAM_CRLF
slinha</font><font color="#808080">:=</font><font color="#0000FF">space</font><font color="#808080">(</font><font color="#000080">nler</font><font color="#808080">)
</font><font color="#000080">bQuebra</font><font color="#808080">:=.f.
</font><font color="#000080">nMaior</font><font color="#808080">:=</font><font color="#FF0000">0
</font><font color="#000080">fseek</font><font color="#808080">(</font><font color="#000080">sArq</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#000080">FS_SET</font><font color="#808080">)
</font><font color="#0000FF">do while </font><font color="#808080">(!</font><font color="#000080">fimArq</font><font color="#808080">(</font><font color="#000080">sArq</font><font color="#808080">)) .and. (</font><font color="#000080">bQuebra</font><font color="#808080">=.f.) 
  </font><font color="#000080">fread</font><font color="#808080">(</font><font color="#000080">sArq</font><font color="#808080">, </font><font color="#0000FF">@</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#000080">nler</font><font color="#808080">)
  </font><font color="#000080">sres</font><font color="#808080">:=</font><font color="#0000FF">alltrim</font><font color="#808080">(</font><font color="#000080">substr</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">,</font><font color="#000080">nPosChave</font><font color="#808080">,</font><font color="#000080">nTamChave</font><font color="#808080">))
  </font><font color="#000080">ncod</font><font color="#808080">:=</font><font color="#0000FF">Val</font><font color="#808080">(</font><font color="#000080">sres</font><font color="#808080">)
  </font><font color="#0000FF">if </font><font color="#000080">nCod </font><font color="#808080">&gt; </font><font color="#000080">nMaior
     nMaior</font><font color="#808080">:=</font><font color="#000080">nCod
  </font><font color="#0000FF">endif
enddo
</font><font color="#000080">pesqLinhaExcluida</font><font color="#808080">(</font><font color="#000080">sArq</font><font color="#808080">, </font><font color="#000080">nTamLinha</font><font color="#808080">)
</font><font color="#000080">sres</font><font color="#808080">:=</font><font color="#0000FF">alltrim</font><font color="#808080">(</font><font color="#0000FF">str</font><font color="#808080">(</font><font color="#000080">nMaior</font><font color="#808080">+</font><font color="#FF0000">1</font><font color="#808080">))
</font><font color="#0000FF">return</font><font color="#808080">(</font><font color="#000080">sres</font><font color="#808080">)
/*------------------------------------------------------------------------------
</font><font color="#000080">Grava os registros num determinado arquivo</font><font color="#808080">.
</font><font color="#000080">sArq </font><font color="#808080">- </font><font color="#000080">o arquivo
sTexto </font><font color="#808080">- </font><font color="#000080">o registro a ser gravado
sMsgAcerto </font><font color="#808080">- </font><font color="#000080">a mensagem caso o registro foi gravado
sMsgErro </font><font color="#808080">- </font><font color="#000080">a mensagem caso o registro n&atilde;o foi gravado
</font><font color="#808080">------------------------------------------------------------------------------*/
</font><font color="#0000FF">procedure </font><font color="#000080">escreveArq</font><font color="#808080">(</font><font color="#000080">sArq</font><font color="#808080">,</font><font color="#000080">sTexto</font><font color="#808080">, </font><font color="#000080">sMsgAcerto</font><font color="#808080">, </font><font color="#000080">sMsgErro</font><font color="#808080">)

</font><font color="#000080">sTexto</font><font color="#808080">:=</font><font color="#000080">sTexto</font><font color="#808080">+</font><font color="#000080">CRLF
</font><font color="#0000FF">if fwrite</font><font color="#808080">(</font><font color="#000080">sArq</font><font color="#808080">, </font><font color="#000080">sTexto</font><font color="#808080">, </font><font color="#000080">len</font><font color="#808080">(</font><font color="#000080">sTexto</font><font color="#808080">)) = </font><font color="#000080">len</font><font color="#808080">(</font><font color="#000080">sTexto</font><font color="#808080">)
   </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#000080">sMsgAcerto</font><font color="#808080">)
</font><font color="#0000FF">else 
   </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#000080">sMsgErro</font><font color="#808080">)
</font><font color="#0000FF">endif
return

</font><font color="#808080">/*--- </font><font color="#000080">Rotinas de implementa&ccedil;&atilde;o </font><font color="#0000FF">do </font><font color="#000080">sistema e de interface </font><font color="#808080">----------------------*/

/*------------------------------------------------------------------------------
</font><font color="#000080">Monta o tamanho </font><font color="#0000FF">do </font><font color="#000080">registro no arquivo de acordo com o tipo de arquivo</font><font color="#808080">.
</font><font color="#000080">sreg </font><font color="#808080">- </font><font color="#000080">o tipo de arquivo
retorna </font><font color="#808080">- </font><font color="#000080">o registro montado
</font><font color="#808080">------------------------------------------------------------------------------*/
</font><font color="#0000FF">function </font><font color="#000080">LinhaReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">)
</font><font color="#0000FF">local </font><font color="#000080">slinha

slinha</font><font color="#808080">:=</font><font color="#800000">&quot;&quot;
</font><font color="#0000FF">if </font><font color="#000080">sreg </font><font color="#808080">= </font><font color="#000080">opAssunto
   slinha</font><font color="#808080">:=</font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">tAssunto_codigo</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">)+</font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">tAssunto_assunto</font><font color="#808080">,</font><font color="#FF0000">30</font><font color="#808080">)
</font><font color="#000080">elseif sreg </font><font color="#808080">= </font><font color="#000080">opAutor
   slinha</font><font color="#808080">:=</font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">tAutor_codigo</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">)+</font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">tAutor_autor</font><font color="#808080">,</font><font color="#FF0000">30</font><font color="#808080">)
</font><font color="#000080">elseif sreg </font><font color="#808080">= </font><font color="#000080">opEditora
   slinha</font><font color="#808080">:=</font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">tEditora_codigo</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">)+</font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">tEditora_editora</font><font color="#808080">,</font><font color="#FF0000">50</font><font color="#808080">)
</font><font color="#000080">elseif sreg </font><font color="#808080">= </font><font color="#000080">opEndereco
   slinha</font><font color="#808080">:=</font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">tEnd_codigo</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">)+</font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">tEnd_logradouro</font><font color="#808080">,</font><font color="#FF0000">40</font><font color="#808080">)+;
   </font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">tEnd_bairro</font><font color="#808080">,</font><font color="#FF0000">15</font><font color="#808080">)+</font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">tEnd_cep</font><font color="#808080">,</font><font color="#FF0000">8</font><font color="#808080">)+</font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">tEnd_cidade</font><font color="#808080">,</font><font color="#FF0000">30</font><font color="#808080">)+;
   </font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">tEnd_estado</font><font color="#808080">,</font><font color="#FF0000">20</font><font color="#808080">)
</font><font color="#000080">elseif sreg </font><font color="#808080">= </font><font color="#000080">opIdioma
   slinha</font><font color="#808080">:=</font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">tIdioma_codigo</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">)+</font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">tIdioma_idioma</font><font color="#808080">,</font><font color="#FF0000">20</font><font color="#808080">)
</font><font color="#000080">elseif sreg </font><font color="#808080">= </font><font color="#000080">opPais
   slinha</font><font color="#808080">:=</font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">tPais_codigo</font><font color="#808080">,</font><font color="#FF0000">3</font><font color="#808080">)+</font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">tPais_pais</font><font color="#808080">,</font><font color="#FF0000">50</font><font color="#808080">)
</font><font color="#000080">elseif sreg </font><font color="#808080">= </font><font color="#000080">opProfissao
   slinha</font><font color="#808080">:=</font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">tProfiss_codigo</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">)+</font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">tProfiss_profissao</font><font color="#808080">,</font><font color="#FF0000">50</font><font color="#808080">)
</font><font color="#000080">elseif sreg </font><font color="#808080">= </font><font color="#000080">opUsuario
   slinha</font><font color="#808080">:=</font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">tUsuario_login</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">)+</font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">tUsuario_senha</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">)
</font><font color="#000080">elseif sreg </font><font color="#808080">= </font><font color="#000080">opLivro
   slinha</font><font color="#808080">:=</font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">tLiv_isbn</font><font color="#808080">,</font><font color="#FF0000">13</font><font color="#808080">)+</font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">tLiv_titulo</font><font color="#808080">,</font><font color="#FF0000">50</font><font color="#808080">)+</font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">tLiv_edicao</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">)+;
   </font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">tLiv_anopubli</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">)+</font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">tLiv_codeditora</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">)+</font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">tLiv_volume</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">)+;
   </font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">tLiv_codidioma</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">)+</font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">tLiv_npaginas</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">)+</font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">tLiv_preco</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">)+;
   </font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">tLiv_qtdestoque</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">)
</font><font color="#000080">elseif sreg </font><font color="#808080">= </font><font color="#000080">opLivroAss
   slinha</font><font color="#808080">:=</font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">tLivAss_isbn</font><font color="#808080">,</font><font color="#FF0000">13</font><font color="#808080">)+</font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">tLivAss_codassunto</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">)
</font><font color="#000080">elseif sreg </font><font color="#808080">= </font><font color="#000080">opLivroAut
   slinha</font><font color="#808080">:=</font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">tLivAut_isbn</font><font color="#808080">,</font><font color="#FF0000">13</font><font color="#808080">)+</font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">tLivAut_codautor</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">)
</font><font color="#000080">elseif sreg </font><font color="#808080">= </font><font color="#000080">opCliente
   slinha</font><font color="#808080">:=</font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">tCli_cpf</font><font color="#808080">,</font><font color="#FF0000">14</font><font color="#808080">)+</font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">tCli_nome</font><font color="#808080">,</font><font color="#FF0000">30</font><font color="#808080">)+</font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">tCli_email</font><font color="#808080">,</font><font color="#FF0000">30</font><font color="#808080">)+;
   </font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">tCli_identidade</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">)+</font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">tCli_sexo</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">)+</font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">tCli_telefone</font><font color="#808080">,</font><font color="#FF0000">17</font><font color="#808080">)+;
   </font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">tCli_dtnascimento</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">)+</font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">tCli_codendereco</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">)+;
   </font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">tCli_codpais</font><font color="#808080">,</font><font color="#FF0000">3</font><font color="#808080">)+</font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">tCli_codprofissao</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">)
</font><font color="#000080">elseif sreg </font><font color="#808080">= </font><font color="#000080">opVenda
   slinha</font><font color="#808080">:=</font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">tVenda_dthrvenda</font><font color="#808080">,</font><font color="#FF0000">19</font><font color="#808080">)+</font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">tVenda_cpf</font><font color="#808080">,</font><font color="#FF0000">14</font><font color="#808080">)+</font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">tVenda_isbn</font><font color="#808080">,</font><font color="#FF0000">13</font><font color="#808080">)+;
   </font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">tVenda_precovenda</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">)
</font><font color="#0000FF">endif
return</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">)
/*------------------------------------------------------------------------------
</font><font color="#000080">Retorna o tamanho </font><font color="#0000FF">do </font><font color="#000080">registro no arquivo de acordo com o tipo de arquivo</font><font color="#808080">.
</font><font color="#000080">sreg </font><font color="#808080">- </font><font color="#000080">o tipo de arquivo
retorna </font><font color="#808080">- </font><font color="#000080">o tamanho </font><font color="#0000FF">do </font><font color="#000080">registro
</font><font color="#808080">------------------------------------------------------------------------------*/
</font><font color="#0000FF">function </font><font color="#000080">tamReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">)
</font><font color="#0000FF">local </font><font color="#000080">nret

nret</font><font color="#808080">:=</font><font color="#FF0000">0
</font><font color="#0000FF">if </font><font color="#000080">sreg </font><font color="#808080">= </font><font color="#000080">opAssunto 
   nret</font><font color="#808080">:=</font><font color="#000080">TAM_ASSUNTO
elseif sreg </font><font color="#808080">= </font><font color="#000080">opAutor 
   nret</font><font color="#808080">:=</font><font color="#000080">TAM_AUTOR
elseif sreg </font><font color="#808080">= </font><font color="#000080">opEditora 
   nret</font><font color="#808080">:=</font><font color="#000080">TAM_EDITORA
elseif sreg </font><font color="#808080">= </font><font color="#000080">opEndereco 
   nret</font><font color="#808080">:=</font><font color="#000080">TAM_ENDERECO
elseif sreg </font><font color="#808080">= </font><font color="#000080">opIdioma 
   nret</font><font color="#808080">:=</font><font color="#000080">TAM_IDIOMA
elseif sreg </font><font color="#808080">= </font><font color="#000080">opPais 
   nret</font><font color="#808080">:=</font><font color="#000080">TAM_PAIS
elseif sreg </font><font color="#808080">= </font><font color="#000080">opProfissao 
   nret</font><font color="#808080">:=</font><font color="#000080">TAM_PROFISSAO
elseif sreg </font><font color="#808080">= </font><font color="#000080">opUsuario 
   nret</font><font color="#808080">:=</font><font color="#000080">TAM_USUARIO
elseif sreg </font><font color="#808080">= </font><font color="#000080">opLivro 
   nret</font><font color="#808080">:=</font><font color="#000080">TAM_LIVRO
elseif sreg </font><font color="#808080">= </font><font color="#000080">opLivroAss 
   nret</font><font color="#808080">:=</font><font color="#000080">TAM_LIVASS
elseif sreg </font><font color="#808080">= </font><font color="#000080">opLivroAut 
   nret</font><font color="#808080">:=</font><font color="#000080">TAM_LIVAUT
elseif sreg </font><font color="#808080">= </font><font color="#000080">opCliente 
   nret</font><font color="#808080">:=</font><font color="#000080">TAM_CLIENTE
elseif sreg </font><font color="#808080">= </font><font color="#000080">opVenda 
   nret</font><font color="#808080">:=</font><font color="#000080">TAM_VENDA
</font><font color="#0000FF">endif
return</font><font color="#808080">(</font><font color="#000080">nret</font><font color="#808080">)
/*------------------------------------------------------------------------------
</font><font color="#000080">Seleciona o rotulo de cada campo de acordo com o tipo de arquivo</font><font color="#808080">.
</font><font color="#000080">sreg </font><font color="#808080">- </font><font color="#000080">o tipo de arquivo
nNum </font><font color="#808080">- </font><font color="#000080">indica qual rotulo ser&aacute; retornado
retorna </font><font color="#808080">- </font><font color="#000080">o rotulo
</font><font color="#808080">------------------------------------------------------------------------------*/
</font><font color="#0000FF">function </font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#000080">nNum</font><font color="#808080">)
</font><font color="#0000FF">local </font><font color="#000080">sret

sret</font><font color="#808080">:=</font><font color="#800000">&quot;&quot;
</font><font color="#0000FF">if </font><font color="#000080">sreg </font><font color="#808080">= </font><font color="#000080">opAssunto 
   </font><font color="#0000FF">do case
     case </font><font color="#000080">nNum </font><font color="#808080">= </font><font color="#FF0000">0 
       </font><font color="#000080">sret</font><font color="#808080">:=</font><font color="#800000">&quot;Assunto(s) n&atilde;o encontrado(s)!&quot;
     </font><font color="#0000FF">case </font><font color="#000080">nNum </font><font color="#808080">= </font><font color="#FF0000">1
         </font><font color="#000080">sret</font><font color="#808080">:=</font><font color="#800000">&quot;C&oacute;digo do assunto: &quot;
         </font><font color="#000080">g_nPosChave</font><font color="#808080">:=</font><font color="#FF0000">1
         </font><font color="#000080">g_nTamChave</font><font color="#808080">:=</font><font color="#FF0000">10
     </font><font color="#0000FF">case </font><font color="#000080">nNum </font><font color="#808080">= </font><font color="#FF0000">2
         </font><font color="#000080">sret</font><font color="#808080">:=</font><font color="#800000">&quot;Assunto: &quot;
         </font><font color="#000080">g_nPosChave</font><font color="#808080">:=</font><font color="#FF0000">11
         </font><font color="#000080">g_nTamChave</font><font color="#808080">:=</font><font color="#FF0000">30
   </font><font color="#0000FF">endcase
</font><font color="#000080">elseif sreg </font><font color="#808080">= </font><font color="#000080">opAutor 
   </font><font color="#0000FF">do case
     case </font><font color="#000080">nNum </font><font color="#808080">= </font><font color="#FF0000">0 
        </font><font color="#000080">sret</font><font color="#808080">:=</font><font color="#800000">&quot;Autor(es) n&atilde;o encontrado(s)!&quot;
     </font><font color="#0000FF">case </font><font color="#000080">nNum </font><font color="#808080">= </font><font color="#FF0000">1 
         </font><font color="#000080">sret</font><font color="#808080">:=</font><font color="#800000">&quot;C&oacute;digo do autor: &quot;
         </font><font color="#000080">g_nPosChave</font><font color="#808080">:=</font><font color="#FF0000">1
         </font><font color="#000080">g_nTamChave</font><font color="#808080">:=</font><font color="#FF0000">10
     </font><font color="#0000FF">case </font><font color="#000080">nNum </font><font color="#808080">= </font><font color="#FF0000">2
         </font><font color="#000080">sret</font><font color="#808080">:=</font><font color="#800000">&quot;Autor: &quot;
         </font><font color="#000080">g_nPosChave</font><font color="#808080">:=</font><font color="#FF0000">11
         </font><font color="#000080">g_nTamChave</font><font color="#808080">:=</font><font color="#FF0000">30
   </font><font color="#0000FF">endcase
</font><font color="#000080">elseif sreg </font><font color="#808080">= </font><font color="#000080">opEditora 
   </font><font color="#0000FF">do case
     case </font><font color="#000080">nNum </font><font color="#808080">= </font><font color="#FF0000">0 
         </font><font color="#000080">sret</font><font color="#808080">:=</font><font color="#800000">&quot;Editora(s) n&atilde;o encontrada(s)!&quot;
     </font><font color="#0000FF">case </font><font color="#000080">nNum </font><font color="#808080">= </font><font color="#FF0000">1 
         </font><font color="#000080">sret</font><font color="#808080">:=</font><font color="#800000">&quot;C&oacute;digo da editora: &quot;
         </font><font color="#000080">g_nPosChave</font><font color="#808080">:=</font><font color="#FF0000">1
         </font><font color="#000080">g_nTamChave</font><font color="#808080">:=</font><font color="#FF0000">10
     </font><font color="#0000FF">case </font><font color="#000080">nNum </font><font color="#808080">= </font><font color="#FF0000">2 
         </font><font color="#000080">sret</font><font color="#808080">:=</font><font color="#800000">&quot;Editora: &quot;
         </font><font color="#000080">g_nPosChave</font><font color="#808080">:=</font><font color="#FF0000">11
         </font><font color="#000080">g_nTamChave</font><font color="#808080">:=</font><font color="#FF0000">50
   </font><font color="#0000FF">endcase
</font><font color="#000080">elseif sreg </font><font color="#808080">= </font><font color="#000080">opEndereco 
   </font><font color="#0000FF">do case
     case </font><font color="#000080">nNum </font><font color="#808080">= </font><font color="#FF0000">0 
       </font><font color="#000080">sret</font><font color="#808080">:=</font><font color="#800000">&quot;Endere&ccedil;o(s) n&atilde;o encontrado(s)!&quot;
     </font><font color="#0000FF">case </font><font color="#000080">nNum </font><font color="#808080">= </font><font color="#FF0000">1
         </font><font color="#000080">sret</font><font color="#808080">:=</font><font color="#800000">&quot;C&oacute;digo do endere&ccedil;o: &quot;
         </font><font color="#000080">g_nPosChave</font><font color="#808080">:=</font><font color="#FF0000">1
         </font><font color="#000080">g_nTamChave</font><font color="#808080">:=</font><font color="#FF0000">10
     </font><font color="#0000FF">case </font><font color="#000080">nNum </font><font color="#808080">= </font><font color="#FF0000">2
         </font><font color="#000080">sret</font><font color="#808080">:=</font><font color="#800000">&quot;Logradouro: &quot;
         </font><font color="#000080">g_nPosChave</font><font color="#808080">:=</font><font color="#FF0000">11
         </font><font color="#000080">g_nTamChave</font><font color="#808080">:=</font><font color="#FF0000">40
     </font><font color="#0000FF">case </font><font color="#000080">nNum </font><font color="#808080">= </font><font color="#FF0000">3
         </font><font color="#000080">sret</font><font color="#808080">:=</font><font color="#800000">&quot;Bairro: &quot;
         </font><font color="#000080">g_nPosChave</font><font color="#808080">:=</font><font color="#FF0000">51
         </font><font color="#000080">g_nTamChave</font><font color="#808080">:=</font><font color="#FF0000">15
     </font><font color="#0000FF">case </font><font color="#000080">nNum </font><font color="#808080">= </font><font color="#FF0000">4
         </font><font color="#000080">sret</font><font color="#808080">:=</font><font color="#800000">&quot;CEP: &quot;
         </font><font color="#000080">g_nPosChave</font><font color="#808080">:=</font><font color="#FF0000">66
         </font><font color="#000080">g_nTamChave</font><font color="#808080">:=</font><font color="#FF0000">8
     </font><font color="#0000FF">case </font><font color="#000080">nNum </font><font color="#808080">= </font><font color="#FF0000">5
         </font><font color="#000080">sret</font><font color="#808080">:=</font><font color="#800000">&quot;Cidade: &quot;
         </font><font color="#000080">g_nPosChave</font><font color="#808080">:=</font><font color="#FF0000">74
         </font><font color="#000080">g_nTamChave</font><font color="#808080">:=</font><font color="#FF0000">30
     </font><font color="#0000FF">case </font><font color="#000080">nNum </font><font color="#808080">= </font><font color="#FF0000">6
         </font><font color="#000080">sret</font><font color="#808080">:=</font><font color="#800000">&quot;Estado: &quot;
         </font><font color="#000080">g_nPosChave</font><font color="#808080">:=</font><font color="#FF0000">104
         </font><font color="#000080">g_nTamChave</font><font color="#808080">:=</font><font color="#FF0000">20
   </font><font color="#0000FF">endcase
</font><font color="#000080">elseif sreg </font><font color="#808080">= </font><font color="#000080">opIdioma 
   </font><font color="#0000FF">do case
     case </font><font color="#000080">nNum </font><font color="#808080">= </font><font color="#FF0000">0
         </font><font color="#000080">sret</font><font color="#808080">:=</font><font color="#800000">&quot;Idioma(s) n&atilde;o encontrado(s)!&quot;
     </font><font color="#0000FF">case </font><font color="#000080">nNum </font><font color="#808080">= </font><font color="#FF0000">1 
         </font><font color="#000080">sret</font><font color="#808080">:=</font><font color="#800000">&quot;C&oacute;digo do idioma: &quot;
         </font><font color="#000080">g_nPosChave</font><font color="#808080">:=</font><font color="#FF0000">1
         </font><font color="#000080">g_nTamChave</font><font color="#808080">:=</font><font color="#FF0000">10
     </font><font color="#0000FF">case </font><font color="#000080">nNum </font><font color="#808080">= </font><font color="#FF0000">2 
         </font><font color="#000080">sret</font><font color="#808080">:=</font><font color="#800000">&quot;Idioma: &quot;
         </font><font color="#000080">g_nPosChave</font><font color="#808080">:=</font><font color="#FF0000">11
         </font><font color="#000080">g_nTamChave</font><font color="#808080">:=</font><font color="#FF0000">20
   </font><font color="#0000FF">endcase
</font><font color="#000080">elseif sreg </font><font color="#808080">= </font><font color="#000080">opPais 
   </font><font color="#0000FF">do case
     case </font><font color="#000080">nNum </font><font color="#808080">= </font><font color="#FF0000">0
         </font><font color="#000080">sret</font><font color="#808080">:=</font><font color="#800000">&quot;Pa&iacute;s(es) n&atilde;o encontrado(s)!&quot;
     </font><font color="#0000FF">case </font><font color="#000080">nNum </font><font color="#808080">= </font><font color="#FF0000">1 
         </font><font color="#000080">sret</font><font color="#808080">:=</font><font color="#800000">&quot;C&oacute;digo do pa&iacute;s: &quot;
         </font><font color="#000080">g_nPosChave</font><font color="#808080">:=</font><font color="#FF0000">1
         </font><font color="#000080">g_nTamChave</font><font color="#808080">:=</font><font color="#FF0000">3
     </font><font color="#0000FF">case </font><font color="#000080">nNum </font><font color="#808080">= </font><font color="#FF0000">2 
         </font><font color="#000080">sret</font><font color="#808080">:=</font><font color="#800000">&quot;Pa&iacute;s: &quot;
         </font><font color="#000080">g_nPosChave</font><font color="#808080">:=</font><font color="#FF0000">4
         </font><font color="#000080">g_nTamChave</font><font color="#808080">:=</font><font color="#FF0000">50
   </font><font color="#0000FF">endcase
</font><font color="#000080">elseif sreg </font><font color="#808080">= </font><font color="#000080">opProfissao 
   </font><font color="#0000FF">do case
     case </font><font color="#000080">nNum </font><font color="#808080">= </font><font color="#FF0000">0
         </font><font color="#000080">sret</font><font color="#808080">:=</font><font color="#800000">&quot;Profiss&atilde;o(es) n&atilde;o encontrada(s)!&quot;
     </font><font color="#0000FF">case </font><font color="#000080">nNum </font><font color="#808080">= </font><font color="#FF0000">1 
         </font><font color="#000080">sret</font><font color="#808080">:=</font><font color="#800000">&quot;C&oacute;digo da profiss&atilde;o: &quot;
         </font><font color="#000080">g_nPosChave</font><font color="#808080">:=</font><font color="#FF0000">1
         </font><font color="#000080">g_nTamChave</font><font color="#808080">:=</font><font color="#FF0000">10
     </font><font color="#0000FF">case </font><font color="#000080">nNum </font><font color="#808080">= </font><font color="#FF0000">2 
         </font><font color="#000080">sret</font><font color="#808080">:=</font><font color="#800000">&quot;Profiss&atilde;o: &quot;
         </font><font color="#000080">g_nPosChave</font><font color="#808080">:=</font><font color="#FF0000">11
         </font><font color="#000080">g_nTamChave</font><font color="#808080">:=</font><font color="#FF0000">50
   </font><font color="#0000FF">endcase
</font><font color="#000080">elseif sreg </font><font color="#808080">= </font><font color="#000080">opUsuario 
   </font><font color="#0000FF">do case
     case </font><font color="#000080">nNum </font><font color="#808080">= </font><font color="#FF0000">0
         </font><font color="#000080">sret</font><font color="#808080">:=</font><font color="#800000">&quot;login ou senha incorreta, tente de novo!&quot;
     </font><font color="#0000FF">case </font><font color="#000080">nNum </font><font color="#808080">= </font><font color="#FF0000">1
         </font><font color="#000080">sret</font><font color="#808080">:=</font><font color="#800000">&quot;Login: &quot;
         </font><font color="#000080">g_nPosChave</font><font color="#808080">:=</font><font color="#FF0000">1
         </font><font color="#000080">g_nTamChave</font><font color="#808080">:=</font><font color="#FF0000">10
     </font><font color="#0000FF">case </font><font color="#000080">nNum </font><font color="#808080">= </font><font color="#FF0000">2 
         </font><font color="#000080">sret</font><font color="#808080">:=</font><font color="#800000">&quot;Senha: &quot;
         </font><font color="#000080">g_nPosChave</font><font color="#808080">:=</font><font color="#FF0000">11
         </font><font color="#000080">g_nTamChave</font><font color="#808080">:=</font><font color="#FF0000">10
   </font><font color="#0000FF">endcase
</font><font color="#000080">elseif sreg </font><font color="#808080">= </font><font color="#000080">opLivro 
   </font><font color="#0000FF">do case
     case </font><font color="#000080">nNum </font><font color="#808080">= </font><font color="#FF0000">0
         </font><font color="#000080">sret</font><font color="#808080">:=</font><font color="#800000">&quot;Livro(s) n&atilde;o encontrado(s)!&quot;
     </font><font color="#0000FF">case </font><font color="#000080">nNum </font><font color="#808080">= </font><font color="#FF0000">1 
         </font><font color="#000080">sret</font><font color="#808080">:=</font><font color="#800000">&quot;ISBN: &quot;
         </font><font color="#000080">g_nPosChave</font><font color="#808080">:=</font><font color="#FF0000">1
         </font><font color="#000080">g_nTamChave</font><font color="#808080">:=</font><font color="#FF0000">13
     </font><font color="#0000FF">case </font><font color="#000080">nNum </font><font color="#808080">= </font><font color="#FF0000">2
         </font><font color="#000080">sret</font><font color="#808080">:=</font><font color="#800000">&quot;T&iacute;tulo: &quot;
         </font><font color="#000080">g_nPosChave</font><font color="#808080">:=</font><font color="#FF0000">14
         </font><font color="#000080">g_nTamChave</font><font color="#808080">:=</font><font color="#FF0000">50
     </font><font color="#0000FF">case </font><font color="#000080">nNum </font><font color="#808080">= </font><font color="#FF0000">3
         </font><font color="#000080">sret</font><font color="#808080">:=</font><font color="#800000">&quot;Edi&ccedil;&atilde;o: &quot;
         </font><font color="#000080">g_nPosChave</font><font color="#808080">:=</font><font color="#FF0000">64
         </font><font color="#000080">g_nTamChave</font><font color="#808080">:=</font><font color="#FF0000">10
     </font><font color="#0000FF">case </font><font color="#000080">nNum </font><font color="#808080">= </font><font color="#FF0000">4 
         </font><font color="#000080">sret</font><font color="#808080">:=</font><font color="#800000">&quot;Ano de Publica&ccedil;&atilde;o: &quot;
         </font><font color="#000080">g_nPosChave</font><font color="#808080">:=</font><font color="#FF0000">74
         </font><font color="#000080">g_nTamChave</font><font color="#808080">:=</font><font color="#FF0000">10
     </font><font color="#0000FF">case </font><font color="#000080">nNum </font><font color="#808080">= </font><font color="#FF0000">5 
         </font><font color="#000080">sret</font><font color="#808080">:=</font><font color="#800000">&quot;C&oacute;digo da editora: &quot;
         </font><font color="#000080">g_nPosChave</font><font color="#808080">:=</font><font color="#FF0000">84
         </font><font color="#000080">g_nTamChave</font><font color="#808080">:=</font><font color="#FF0000">10
     </font><font color="#0000FF">case </font><font color="#000080">nNum </font><font color="#808080">= </font><font color="#FF0000">6 
         </font><font color="#000080">sret</font><font color="#808080">:=</font><font color="#800000">&quot;Volume: &quot;
         </font><font color="#000080">g_nPosChave</font><font color="#808080">:=</font><font color="#FF0000">94
         </font><font color="#000080">g_nTamChave</font><font color="#808080">:=</font><font color="#FF0000">10
     </font><font color="#0000FF">case </font><font color="#000080">nNum </font><font color="#808080">= </font><font color="#FF0000">7 
         </font><font color="#000080">sret</font><font color="#808080">:=</font><font color="#800000">&quot;C&oacute;digo do idioma: &quot;
         </font><font color="#000080">g_nPosChave</font><font color="#808080">:=</font><font color="#FF0000">104
         </font><font color="#000080">g_nTamChave</font><font color="#808080">:=</font><font color="#FF0000">10
     </font><font color="#0000FF">case </font><font color="#000080">nNum </font><font color="#808080">= </font><font color="#FF0000">8 
         </font><font color="#000080">sret</font><font color="#808080">:=</font><font color="#800000">&quot;N&uacute;mero de p&aacute;ginas: &quot;
         </font><font color="#000080">g_nPosChave</font><font color="#808080">:=</font><font color="#FF0000">114
         </font><font color="#000080">g_nTamChave</font><font color="#808080">:=</font><font color="#FF0000">10
     </font><font color="#0000FF">case </font><font color="#000080">nNum </font><font color="#808080">= </font><font color="#FF0000">9 
         </font><font color="#000080">sret</font><font color="#808080">:=</font><font color="#800000">&quot;Pre&ccedil;o: &quot;
         </font><font color="#000080">g_nPosChave</font><font color="#808080">:=</font><font color="#FF0000">124
         </font><font color="#000080">g_nTamChave</font><font color="#808080">:=</font><font color="#FF0000">10
     </font><font color="#0000FF">case </font><font color="#000080">nNum </font><font color="#808080">= </font><font color="#FF0000">10 
          </font><font color="#000080">sret</font><font color="#808080">:=</font><font color="#800000">&quot;Qtd. Estoque: &quot;
          </font><font color="#000080">g_nPosChave</font><font color="#808080">:=</font><font color="#FF0000">134
          </font><font color="#000080">g_nTamChave</font><font color="#808080">:=</font><font color="#FF0000">10
   </font><font color="#0000FF">endcase
</font><font color="#000080">elseif sreg </font><font color="#808080">= </font><font color="#000080">opLivroAss 
   </font><font color="#0000FF">do case
     case </font><font color="#000080">nNum </font><font color="#808080">= </font><font color="#FF0000">0
         </font><font color="#000080">sret</font><font color="#808080">:=</font><font color="#800000">&quot;Assunto(s) n&atilde;o encontrado(s)!&quot;
     </font><font color="#0000FF">case </font><font color="#000080">nNum </font><font color="#808080">= </font><font color="#FF0000">1 
         </font><font color="#000080">sret</font><font color="#808080">:=</font><font color="#800000">&quot;ISBN: &quot;
         </font><font color="#000080">g_nPosChave</font><font color="#808080">:=</font><font color="#FF0000">1
         </font><font color="#000080">g_nTamChave</font><font color="#808080">:=</font><font color="#FF0000">13
     </font><font color="#0000FF">case </font><font color="#000080">nNum </font><font color="#808080">= </font><font color="#FF0000">2 
         </font><font color="#000080">sret</font><font color="#808080">:=</font><font color="#800000">&quot;C&oacute;digo do assunto: &quot;
         </font><font color="#000080">g_nPosChave</font><font color="#808080">:=</font><font color="#FF0000">14
         </font><font color="#000080">g_nTamChave</font><font color="#808080">:=</font><font color="#FF0000">10
   </font><font color="#0000FF">endcase
</font><font color="#000080">elseif sreg </font><font color="#808080">= </font><font color="#000080">opLivroAut
   </font><font color="#0000FF">do case
     case </font><font color="#000080">nNum </font><font color="#808080">= </font><font color="#FF0000">0
         </font><font color="#000080">sret</font><font color="#808080">:=</font><font color="#800000">&quot;Autor(s) n&atilde;o encontrado(s)!&quot;
     </font><font color="#0000FF">case </font><font color="#000080">nNum </font><font color="#808080">= </font><font color="#FF0000">1 
         </font><font color="#000080">sret</font><font color="#808080">:=</font><font color="#800000">&quot;ISBN: &quot;
         </font><font color="#000080">g_nPosChave</font><font color="#808080">:=</font><font color="#FF0000">1
         </font><font color="#000080">g_nTamChave</font><font color="#808080">:=</font><font color="#FF0000">13
     </font><font color="#0000FF">case </font><font color="#000080">nNum </font><font color="#808080">= </font><font color="#FF0000">2 
         </font><font color="#000080">sret</font><font color="#808080">:=</font><font color="#800000">&quot;C&oacute;digo do autor: &quot;
         </font><font color="#000080">g_nPosChave</font><font color="#808080">:=</font><font color="#FF0000">14
         </font><font color="#000080">g_nTamChave</font><font color="#808080">:=</font><font color="#FF0000">10
   </font><font color="#0000FF">endcase
</font><font color="#000080">elseif sreg </font><font color="#808080">= </font><font color="#000080">opCliente 
   </font><font color="#0000FF">do case
     case </font><font color="#000080">nNum </font><font color="#808080">= </font><font color="#FF0000">0
         </font><font color="#000080">sret</font><font color="#808080">:=</font><font color="#800000">&quot;Cliente(s) n&atilde;o encontrado(s)!&quot;
     </font><font color="#0000FF">case </font><font color="#000080">nNum </font><font color="#808080">= </font><font color="#FF0000">1 
         </font><font color="#000080">sret</font><font color="#808080">:=</font><font color="#800000">&quot;CPF: &quot;
         </font><font color="#000080">g_nPosChave</font><font color="#808080">:=</font><font color="#FF0000">1
         </font><font color="#000080">g_nTamChave</font><font color="#808080">:=</font><font color="#FF0000">14
     </font><font color="#0000FF">case </font><font color="#000080">nNum </font><font color="#808080">= </font><font color="#FF0000">2 
         </font><font color="#000080">sret</font><font color="#808080">:=</font><font color="#800000">&quot;Nome: &quot;
         </font><font color="#000080">g_nPosChave</font><font color="#808080">:=</font><font color="#FF0000">15
         </font><font color="#000080">g_nTamChave</font><font color="#808080">:=</font><font color="#FF0000">30
     </font><font color="#0000FF">case </font><font color="#000080">nNum </font><font color="#808080">= </font><font color="#FF0000">3
         </font><font color="#000080">sret</font><font color="#808080">:=</font><font color="#800000">&quot;E-mail: &quot;
         </font><font color="#000080">g_nPosChave</font><font color="#808080">:=</font><font color="#FF0000">45
         </font><font color="#000080">g_nTamChave</font><font color="#808080">:=</font><font color="#FF0000">30
     </font><font color="#0000FF">case </font><font color="#000080">nNum </font><font color="#808080">= </font><font color="#FF0000">4 
         </font><font color="#000080">sret</font><font color="#808080">:=</font><font color="#800000">&quot;Identidade: &quot;
         </font><font color="#000080">g_nPosChave</font><font color="#808080">:=</font><font color="#FF0000">75
         </font><font color="#000080">g_nTamChave</font><font color="#808080">:=</font><font color="#FF0000">10
     </font><font color="#0000FF">case </font><font color="#000080">nNum </font><font color="#808080">= </font><font color="#FF0000">5 
         </font><font color="#000080">sret</font><font color="#808080">:=</font><font color="#800000">&quot;Sexo: &quot;
         </font><font color="#000080">g_nPosChave</font><font color="#808080">:=</font><font color="#FF0000">85
         </font><font color="#000080">g_nTamChave</font><font color="#808080">:=</font><font color="#FF0000">1
     </font><font color="#0000FF">case </font><font color="#000080">nNum </font><font color="#808080">= </font><font color="#FF0000">6 
         </font><font color="#000080">sret</font><font color="#808080">:=</font><font color="#800000">&quot;Telefone: &quot;
         </font><font color="#000080">g_nPosChave</font><font color="#808080">:=</font><font color="#FF0000">86
         </font><font color="#000080">g_nTamChave</font><font color="#808080">:=</font><font color="#FF0000">17
     </font><font color="#0000FF">case </font><font color="#000080">nNum </font><font color="#808080">= </font><font color="#FF0000">7 
         </font><font color="#000080">sret</font><font color="#808080">:=</font><font color="#800000">&quot;Dt. Nascimento: &quot;
         </font><font color="#000080">g_nPosChave</font><font color="#808080">:=</font><font color="#FF0000">103
         </font><font color="#000080">g_nTamChave</font><font color="#808080">:=</font><font color="#FF0000">10
     </font><font color="#0000FF">case </font><font color="#000080">nNum </font><font color="#808080">= </font><font color="#FF0000">8 
         </font><font color="#000080">sret</font><font color="#808080">:=</font><font color="#800000">&quot;C&oacute;digo do endere&ccedil;o: &quot;
         </font><font color="#000080">g_nPosChave</font><font color="#808080">:=</font><font color="#FF0000">113
         </font><font color="#000080">g_nTamChave</font><font color="#808080">:=</font><font color="#FF0000">10
     </font><font color="#0000FF">case </font><font color="#000080">nNum </font><font color="#808080">= </font><font color="#FF0000">9 
         </font><font color="#000080">sret</font><font color="#808080">:=</font><font color="#800000">&quot;C&oacute;digo do pa&iacute;s: &quot;
         </font><font color="#000080">g_nPosChave</font><font color="#808080">:=</font><font color="#FF0000">123
         </font><font color="#000080">g_nTamChave</font><font color="#808080">:=</font><font color="#FF0000">3
     </font><font color="#0000FF">case </font><font color="#000080">nNum </font><font color="#808080">= </font><font color="#FF0000">10 
          </font><font color="#000080">sret</font><font color="#808080">:=</font><font color="#800000">&quot;C&oacute;digo da Profiss&atilde;o: &quot;
          </font><font color="#000080">g_nPosChave</font><font color="#808080">:=</font><font color="#FF0000">126
          </font><font color="#000080">g_nTamChave</font><font color="#808080">:=</font><font color="#FF0000">10
   </font><font color="#0000FF">endcase
</font><font color="#000080">elseif sreg </font><font color="#808080">= </font><font color="#000080">opVenda 
   </font><font color="#0000FF">do case
     case </font><font color="#000080">nNum </font><font color="#808080">= </font><font color="#FF0000">0
         </font><font color="#000080">sret</font><font color="#808080">:=</font><font color="#800000">&quot;Venda(s) n&atilde;o encontrada(s)!&quot;
     </font><font color="#0000FF">case </font><font color="#000080">nNum </font><font color="#808080">= </font><font color="#FF0000">1
         </font><font color="#000080">sret</font><font color="#808080">:=</font><font color="#800000">&quot;Data/Hora venda: &quot;
         </font><font color="#000080">g_nPosChave</font><font color="#808080">:=</font><font color="#FF0000">1
         </font><font color="#000080">g_nTamChave</font><font color="#808080">:=</font><font color="#FF0000">19
     </font><font color="#0000FF">case </font><font color="#000080">nNum </font><font color="#808080">= </font><font color="#FF0000">2
         </font><font color="#000080">sret</font><font color="#808080">:=</font><font color="#800000">&quot;CPF: &quot;
         </font><font color="#000080">g_nPosChave</font><font color="#808080">:=</font><font color="#FF0000">20
         </font><font color="#000080">g_nTamChave</font><font color="#808080">:=</font><font color="#FF0000">14
     </font><font color="#0000FF">case </font><font color="#000080">nNum </font><font color="#808080">= </font><font color="#FF0000">3
         </font><font color="#000080">sret</font><font color="#808080">:=</font><font color="#800000">&quot;ISBN: &quot;
         </font><font color="#000080">g_nPosChave</font><font color="#808080">:=</font><font color="#FF0000">34
         </font><font color="#000080">g_nTamChave</font><font color="#808080">:=</font><font color="#FF0000">13
     </font><font color="#0000FF">case </font><font color="#000080">nNum </font><font color="#808080">= </font><font color="#FF0000">4
         </font><font color="#000080">sret</font><font color="#808080">:=</font><font color="#800000">&quot;Pre+o de venda: &quot;
         </font><font color="#000080">g_nPosChave</font><font color="#808080">:=</font><font color="#FF0000">47
         </font><font color="#000080">g_nTamChave</font><font color="#808080">:=</font><font color="#FF0000">10
   </font><font color="#0000FF">endcase
endif

return</font><font color="#808080">(</font><font color="#000080">sret</font><font color="#808080">)
/*------------------------------------------------------------------------------
</font><font color="#000080">Indica se continua ou n&atilde;o mostrando um n&uacute;mero m&aacute;ximo de linhas</font><font color="#808080">.
</font><font color="#000080">nlinha </font><font color="#808080">- </font><font color="#000080">a linha a ser continuada
nQtdLinha </font><font color="#808080">- </font><font color="#000080">a quantidade de linhas a serem mostradas
retorna </font><font color="#808080">- </font><font color="#000080">se continua ou n&atilde;o
</font><font color="#808080">------------------------------------------------------------------------------*/
</font><font color="#0000FF">function </font><font color="#000080">ContinuaSN</font><font color="#808080">(</font><font color="#000080">nlinha</font><font color="#808080">, </font><font color="#000080">nQtdLinha</font><font color="#808080">)
</font><font color="#0000FF">local </font><font color="#000080">bSOp</font><font color="#808080">, </font><font color="#000080">bret</font><font color="#808080">, </font><font color="#000080">opCSubMenu

bret</font><font color="#808080">:=.f.
</font><font color="#0000FF">if </font><font color="#000080">nlinha </font><font color="#808080">&gt; </font><font color="#FF0000">0 
  </font><font color="#0000FF">if </font><font color="#808080">(</font><font color="#000080">nlinha </font><font color="#808080">% </font><font color="#000080">nQtdLinha</font><font color="#808080">) = </font><font color="#FF0000">0 
    </font><font color="#000080">bSOp</font><font color="#808080">:=.t.
    </font><font color="#0000FF">do while</font><font color="#808080">(</font><font color="#000080">bSOp</font><font color="#808080">)      
       </font><font color="#0000FF">accept menu</font><font color="#808080">(</font><font color="#FF0000">13</font><font color="#808080">) </font><font color="#0000FF">to </font><font color="#000080">opCSubMenu
       </font><font color="#0000FF">if </font><font color="#808080">(</font><font color="#000080">opCSubMenu</font><font color="#808080">=</font><font color="#800000">&quot;S&quot;</font><font color="#808080">) .or. (</font><font color="#000080">opCSubMenu</font><font color="#808080">=</font><font color="#800000">&quot;s&quot;</font><font color="#808080">) 
          </font><font color="#000080">bSOp</font><font color="#808080">:=.f.
       </font><font color="#000080">elseif </font><font color="#808080">(</font><font color="#000080">opCSubMenu</font><font color="#808080">=</font><font color="#800000">&quot;N&quot;</font><font color="#808080">) .or. (</font><font color="#000080">opCSubMenu</font><font color="#808080">=</font><font color="#800000">&quot;n&quot;</font><font color="#808080">) 
          </font><font color="#000080">bret</font><font color="#808080">:=.t.
          </font><font color="#000080">bSOp</font><font color="#808080">:=.f.
       </font><font color="#0000FF">else 
          </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#000080">MSG_ERRO</font><font color="#808080">)
       </font><font color="#0000FF">endif
    enddo
  endif
endif

return</font><font color="#808080">(</font><font color="#000080">bret</font><font color="#808080">)
/*------------------------------------------------------------------------------
</font><font color="#000080">Lista v&aacute;rios registros de acordo com a pesquisa feita</font><font color="#808080">.
</font><font color="#000080">sArq </font><font color="#808080">- </font><font color="#000080">o arquivo
sreg </font><font color="#808080">- </font><font color="#000080">o tipo de arquivo
sChave </font><font color="#808080">- </font><font color="#000080">a chave a ser pesquisada
nPosChave </font><font color="#808080">- </font><font color="#000080">a posicao inicial da chave dentro </font><font color="#0000FF">do </font><font color="#000080">registro
nTamChave </font><font color="#808080">- </font><font color="#000080">o tamanho da chave dentro </font><font color="#0000FF">do </font><font color="#000080">registro
nTamLinha </font><font color="#808080">- </font><font color="#000080">o tamanho </font><font color="#0000FF">do </font><font color="#000080">registro
nQtdLinha </font><font color="#808080">- </font><font color="#000080">a quantidade de linhas a serem mostradas
retorna </font><font color="#808080">- </font><font color="#000080">se encontrou algum registro
</font><font color="#808080">------------------------------------------------------------------------------*/
</font><font color="#0000FF">function </font><font color="#000080">ListarTodos</font><font color="#808080">(</font><font color="#000080">sArq</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#000080">sChave</font><font color="#808080">,;
   </font><font color="#000080">nPosChave</font><font color="#808080">, </font><font color="#000080">nTamChave</font><font color="#808080">, </font><font color="#000080">nTamLinha</font><font color="#808080">, </font><font color="#000080">nQtdLinha</font><font color="#808080">, </font><font color="#000080">bPesqRelativa</font><font color="#808080">)
</font><font color="#0000FF">local </font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#000080">bQuebra</font><font color="#808080">, </font><font color="#000080">bAchou</font><font color="#808080">, </font><font color="#000080">bRet
</font><font color="#0000FF">local </font><font color="#000080">nStatus</font><font color="#808080">, </font><font color="#000080">nCont</font><font color="#808080">, </font><font color="#000080">sres</font><font color="#808080">, </font><font color="#000080">nler

nler</font><font color="#808080">:=</font><font color="#000080">nTamLinha </font><font color="#808080">+ </font><font color="#000080">TAM_CRLF
slinha</font><font color="#808080">:=</font><font color="#0000FF">space</font><font color="#808080">(</font><font color="#000080">nler</font><font color="#808080">)
</font><font color="#000080">bRet</font><font color="#808080">:=.f.
</font><font color="#000080">bQuebra</font><font color="#808080">:=.f.
</font><font color="#000080">nCont</font><font color="#808080">:=</font><font color="#FF0000">0
</font><font color="#000080">mostrarDados</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">)
</font><font color="#000080">fseek</font><font color="#808080">(</font><font color="#000080">sArq</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#000080">FS_SET</font><font color="#808080">)
</font><font color="#0000FF">do while </font><font color="#808080">(!</font><font color="#000080">fimArq</font><font color="#808080">(</font><font color="#000080">sArq</font><font color="#808080">)) .and. (</font><font color="#000080">bQuebra</font><font color="#808080">=.f.) 
  </font><font color="#000080">fread</font><font color="#808080">(</font><font color="#000080">sArq</font><font color="#808080">, </font><font color="#0000FF">@</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#000080">nler</font><font color="#808080">)
  </font><font color="#0000FF">if </font><font color="#000080">bPesqRelativa 
    sres</font><font color="#808080">:=</font><font color="#0000FF">alltrim</font><font color="#808080">(</font><font color="#000080">substr</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">,</font><font color="#000080">nPosChave</font><font color="#808080">,</font><font color="#000080">nTamChave</font><font color="#808080">))
    </font><font color="#0000FF">if </font><font color="#000080">strRelativa</font><font color="#808080">(</font><font color="#000080">sres</font><font color="#808080">,</font><font color="#000080">sChave</font><font color="#808080">) 
       </font><font color="#000080">bAchou</font><font color="#808080">:=.t.
       </font><font color="#000080">bRet</font><font color="#808080">:=.t.
    </font><font color="#0000FF">else
       </font><font color="#000080">bAchou</font><font color="#808080">:=.f.
    </font><font color="#0000FF">endif 
  else 
    </font><font color="#000080">bAchou</font><font color="#808080">:=.t.
    </font><font color="#000080">bRet</font><font color="#808080">:=.t.
  </font><font color="#0000FF">endif

  if </font><font color="#000080">bAchou
    mostrarDados</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#000080">substr</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#000080">nTamLinha</font><font color="#808080">), </font><font color="#FF0000">3</font><font color="#808080">)
    </font><font color="#000080">nCont</font><font color="#808080">++
  </font><font color="#0000FF">endif

  </font><font color="#000080">bQuebra</font><font color="#808080">:=</font><font color="#000080">ContinuaSN</font><font color="#808080">(</font><font color="#000080">nCont</font><font color="#808080">, </font><font color="#000080">nQtdLinha</font><font color="#808080">)
</font><font color="#0000FF">enddo
return</font><font color="#808080">(</font><font color="#000080">bret</font><font color="#808080">)
/*------------------------------------------------------------------------------
</font><font color="#000080">Lista v&aacute;rios registros entre arquivos de acordo com a pesquisa feita</font><font color="#808080">.
</font><font color="#000080">sArq1 </font><font color="#808080">- </font><font color="#000080">o arquivo de liga&ccedil;&atilde;o
sreg1 </font><font color="#808080">- </font><font color="#000080">o tipo de arquivo de liga&ccedil;&atilde;o
nPosChave1 </font><font color="#808080">- </font><font color="#000080">a posicao inicial da primeira chave no arquivo de liga&ccedil;&atilde;o
nTamChave1 </font><font color="#808080">- </font><font color="#000080">o tamanho da primeira chave no arquivo de liga&ccedil;&atilde;o
nPosChave2 </font><font color="#808080">- </font><font color="#000080">a posicao inicial da segunda chave </font><font color="#0000FF">do </font><font color="#000080">arquivo de liga&ccedil;&atilde;o
nTamChave2 </font><font color="#808080">- </font><font color="#000080">o tamanho da segunda chave </font><font color="#0000FF">do </font><font color="#000080">arquivo de liga&ccedil;&atilde;o
sChave </font><font color="#808080">- </font><font color="#000080">a chave a ser pesquisada no arquivo de liga&ccedil;&atilde;o
sArq2 </font><font color="#808080">- </font><font color="#000080">o arquivo a ser pesquisado
sreg2 </font><font color="#808080">- </font><font color="#000080">o tipo de arquivo a ser pesquisado
nPosChave3 </font><font color="#808080">- </font><font color="#000080">a posicao inicial da chave </font><font color="#0000FF">do </font><font color="#000080">arquivo pesquisado
nQtdLinha </font><font color="#808080">- </font><font color="#000080">a quantidade de linhas a serem mostradas
</font><font color="#808080">------------------------------------------------------------------------------*/
</font><font color="#0000FF">procedure </font><font color="#000080">ListarRegLigados</font><font color="#808080">(</font><font color="#000080">sArq1</font><font color="#808080">, </font><font color="#000080">sreg1</font><font color="#808080">, </font><font color="#000080">nPosChave1</font><font color="#808080">,;
</font><font color="#000080">nTamChave1</font><font color="#808080">, </font><font color="#000080">nPosChave2</font><font color="#808080">, </font><font color="#000080">nTamChave2</font><font color="#808080">, </font><font color="#000080">sChave</font><font color="#808080">,;
</font><font color="#000080">sArq2</font><font color="#808080">, </font><font color="#000080">sreg2</font><font color="#808080">, </font><font color="#000080">nPosChave3</font><font color="#808080">, </font><font color="#000080">nQtdLinha</font><font color="#808080">)
</font><font color="#0000FF">local </font><font color="#000080">slinha1</font><font color="#808080">, </font><font color="#000080">bQuebra</font><font color="#808080">, </font><font color="#000080">bRet</font><font color="#808080">, </font><font color="#000080">nler
</font><font color="#0000FF">local </font><font color="#000080">nStatus</font><font color="#808080">, </font><font color="#000080">nCont</font><font color="#808080">, </font><font color="#000080">sCodigo1</font><font color="#808080">, </font><font color="#000080">sCodigo2</font><font color="#808080">, </font><font color="#000080">slinha2

nler</font><font color="#808080">:=</font><font color="#000080">tamReg</font><font color="#808080">(</font><font color="#000080">sreg1</font><font color="#808080">) + </font><font color="#000080">TAM_CRLF
slinha1</font><font color="#808080">:=</font><font color="#0000FF">space</font><font color="#808080">(</font><font color="#000080">nler</font><font color="#808080">)
</font><font color="#000080">bRet</font><font color="#808080">:=.f.
</font><font color="#000080">nCont</font><font color="#808080">:=</font><font color="#FF0000">0
</font><font color="#000080">bQuebra</font><font color="#808080">:=.f.
</font><font color="#000080">mostrarDados</font><font color="#808080">(</font><font color="#000080">sreg2</font><font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">)
</font><font color="#000080">fseek</font><font color="#808080">(</font><font color="#000080">sArq1</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#000080">FS_SET</font><font color="#808080">)
</font><font color="#0000FF">do while </font><font color="#808080">(!</font><font color="#000080">fimArq</font><font color="#808080">(</font><font color="#000080">sArq1</font><font color="#808080">)) .and. (</font><font color="#000080">bQuebra</font><font color="#808080">=.f.) 
  </font><font color="#000080">fread</font><font color="#808080">(</font><font color="#000080">sArq1</font><font color="#808080">, </font><font color="#0000FF">@</font><font color="#000080">slinha1</font><font color="#808080">, </font><font color="#000080">nler</font><font color="#808080">)
  </font><font color="#000080">sCodigo1</font><font color="#808080">:=</font><font color="#0000FF">alltrim</font><font color="#808080">(</font><font color="#000080">substr</font><font color="#808080">(</font><font color="#000080">slinha1</font><font color="#808080">,</font><font color="#000080">nPosChave1</font><font color="#808080">,</font><font color="#000080">nTamChave1</font><font color="#808080">))
  </font><font color="#0000FF">if </font><font color="#000080">sCodigo1</font><font color="#808080">==</font><font color="#000080">sChave 
    sCodigo2</font><font color="#808080">:=</font><font color="#0000FF">alltrim</font><font color="#808080">(</font><font color="#000080">substr</font><font color="#808080">(</font><font color="#000080">slinha1</font><font color="#808080">,</font><font color="#000080">nPosChave2</font><font color="#808080">,</font><font color="#000080">nTamChave2</font><font color="#808080">))
    </font><font color="#000080">slinha2</font><font color="#808080">:=</font><font color="#000080">pesqArq</font><font color="#808080">(</font><font color="#000080">sArq2</font><font color="#808080">, </font><font color="#000080">sCodigo2</font><font color="#808080">, </font><font color="#000080">nPosChave3</font><font color="#808080">, </font><font color="#000080">nTamChave2</font><font color="#808080">, </font><font color="#000080">tamReg</font><font color="#808080">(</font><font color="#000080">sreg2</font><font color="#808080">))
    </font><font color="#000080">mostrarDados</font><font color="#808080">(</font><font color="#000080">sreg2</font><font color="#808080">, </font><font color="#000080">substr</font><font color="#808080">(</font><font color="#000080">slinha2</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#000080">tamReg</font><font color="#808080">(</font><font color="#000080">sreg2</font><font color="#808080">)), </font><font color="#FF0000">3</font><font color="#808080">)
    </font><font color="#000080">bRet</font><font color="#808080">:=.t.
    </font><font color="#000080">nCont</font><font color="#808080">++
  </font><font color="#0000FF">endif
  </font><font color="#000080">bQuebra</font><font color="#808080">:=</font><font color="#000080">ContinuaSN</font><font color="#808080">(</font><font color="#000080">nCont</font><font color="#808080">, </font><font color="#000080">nQtdLinha</font><font color="#808080">)
</font><font color="#0000FF">enddo
if </font><font color="#000080">bRet</font><font color="#808080">=.f.
   </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg2</font><font color="#808080">,</font><font color="#FF0000">0</font><font color="#808080">))
</font><font color="#0000FF">endif
return
</font><font color="#808080">/*------------------------------------------------------------------------------
</font><font color="#000080">Valida a entrada de registros de acordo com a pesquisa feita</font><font color="#808080">.
</font><font color="#000080">sArq </font><font color="#808080">- </font><font color="#000080">o arquivo
sreg </font><font color="#808080">- </font><font color="#000080">o tipo de arquivo
nTexto </font><font color="#808080">- </font><font color="#000080">o numero </font><font color="#0000FF">do </font><font color="#000080">r&oacute;tulo da entrada
sEntrada </font><font color="#808080">- </font><font color="#000080">a chave a ser pesquisada e validada
nTentativas </font><font color="#808080">- </font><font color="#000080">o n&uacute;mero m&aacute;ximo de tentativas
bPesqRelativa </font><font color="#808080">- </font><font color="#000080">indica se vai realizar uma pesquisa relativa
bTipoEntrada </font><font color="#808080">- </font><font color="#000080">indica o tipo de entrada
retorna </font><font color="#808080">- </font><font color="#000080">o registro pesquisado e validado
</font><font color="#808080">------------------------------------------------------------------------------*/
</font><font color="#0000FF">function </font><font color="#000080">validaEntrada</font><font color="#808080">(</font><font color="#000080">sArq</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#000080">nTexto</font><font color="#808080">,;
        </font><font color="#000080">sEntrada</font><font color="#808080">, </font><font color="#000080">nTentativas</font><font color="#808080">, </font><font color="#000080">bPesqRelativa</font><font color="#808080">, </font><font color="#000080">bTipoEntrada</font><font color="#808080">)
</font><font color="#0000FF">local </font><font color="#000080">bQuebra</font><font color="#808080">, </font><font color="#000080">sres</font><font color="#808080">, </font><font color="#000080">sTexto</font><font color="#808080">, </font><font color="#000080">sMsgErro
</font><font color="#0000FF">local </font><font color="#000080">ncont</font><font color="#808080">, </font><font color="#000080">nPosChave</font><font color="#808080">, </font><font color="#000080">nTamChave</font><font color="#808080">, </font><font color="#000080">nTamLinha

nTamLinha</font><font color="#808080">:=</font><font color="#000080">tamReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">)
</font><font color="#000080">sMsgErro</font><font color="#808080">:=</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">,</font><font color="#FF0000">0</font><font color="#808080">)
</font><font color="#000080">sTexto</font><font color="#808080">:=</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">,</font><font color="#000080">nTexto</font><font color="#808080">)
</font><font color="#000080">nPosChave</font><font color="#808080">:=</font><font color="#000080">g_nPosChave
nTamChave</font><font color="#808080">:=</font><font color="#000080">g_nTamChave

ncont</font><font color="#808080">:=</font><font color="#FF0000">1
</font><font color="#000080">bQuebra</font><font color="#808080">:=.f.
  </font><font color="#0000FF">do while </font><font color="#808080">(</font><font color="#000080">bQuebra</font><font color="#808080">=.f.) .and. (</font><font color="#000080">ncont </font><font color="#808080">&lt;= </font><font color="#000080">nTentativas </font><font color="#808080">)
    </font><font color="#0000FF">if </font><font color="#000080">bTipoEntrada </font><font color="#808080">= </font><font color="#000080">opTexto 
      </font><font color="#0000FF">accept </font><font color="#000080">sTexto </font><font color="#0000FF">to </font><font color="#000080">sEntrada
    elseif bTipoEntrada </font><font color="#808080">= </font><font color="#000080">opNumero
       sEntrada</font><font color="#808080">:=</font><font color="#000080">validaNumero</font><font color="#808080">(</font><font color="#000080">sTexto</font><font color="#808080">,</font><font color="#000080">sEntrada</font><font color="#808080">)
    </font><font color="#000080">elseif bTipoEntrada </font><font color="#808080">= </font><font color="#000080">opData
       sEntrada</font><font color="#808080">:=</font><font color="#000080">validaDataHora</font><font color="#808080">(</font><font color="#000080">sTexto</font><font color="#808080">,</font><font color="#000080">sEntrada</font><font color="#808080">,.t.)
    </font><font color="#000080">elseif bTipoEntrada </font><font color="#808080">= </font><font color="#000080">opDataHora
       sEntrada</font><font color="#808080">:=</font><font color="#000080">validaDataHora</font><font color="#808080">(</font><font color="#000080">sTexto</font><font color="#808080">,</font><font color="#000080">sEntrada</font><font color="#808080">,.f.)
    </font><font color="#000080">elseif bTipoEntrada </font><font color="#808080">= </font><font color="#000080">opSenha
       sEntrada</font><font color="#808080">:=</font><font color="#000080">digitaSenha</font><font color="#808080">(</font><font color="#000080">sTexto</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">)
    </font><font color="#0000FF">endif

    if </font><font color="#000080">bPesqRelativa 
       </font><font color="#0000FF">if </font><font color="#000080">ListarTodos</font><font color="#808080">(</font><font color="#000080">sArq</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#000080">sEntrada</font><font color="#808080">, </font><font color="#000080">nPosChave</font><font color="#808080">, </font><font color="#000080">nTamChave</font><font color="#808080">,;
          </font><font color="#000080">nTamLinha</font><font color="#808080">, </font><font color="#000080">QTD_MAX_LINHA</font><font color="#808080">, .t.)
          </font><font color="#000080">sres</font><font color="#808080">:=</font><font color="#800000">&quot;0&quot;
       </font><font color="#0000FF">endif
    else
       </font><font color="#000080">sres</font><font color="#808080">:=</font><font color="#000080">pesqArq</font><font color="#808080">(</font><font color="#000080">sArq</font><font color="#808080">, </font><font color="#000080">sEntrada</font><font color="#808080">, </font><font color="#000080">nPosChave</font><font color="#808080">, </font><font color="#000080">nTamChave</font><font color="#808080">, </font><font color="#000080">nTamLinha</font><font color="#808080">)
    </font><font color="#0000FF">endif

    if empty</font><font color="#808080">(</font><font color="#000080">sres</font><font color="#808080">)
       </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#000080">sMsgErro</font><font color="#808080">)
    </font><font color="#0000FF">else
       </font><font color="#000080">bQuebra</font><font color="#808080">:=.t.
    </font><font color="#0000FF">endif
     
    </font><font color="#000080">ncont</font><font color="#808080">++
  </font><font color="#0000FF">enddo
return</font><font color="#808080">(</font><font color="#000080">sres</font><font color="#808080">)
/*------------------------------------------------------------------------------
</font><font color="#000080">Mostra a tela de splash </font><font color="#0000FF">do </font><font color="#000080">sistema</font><font color="#808080">.
------------------------------------------------------------------------------*/
</font><font color="#0000FF">procedure </font><font color="#000080">frmSplash</font><font color="#808080">()
</font><font color="#0000FF">local </font><font color="#000080">cont

 qout</font><font color="#808080">(</font><font color="#800000">&quot;*---------------------------------------&quot;</font><font color="#808080">+;
 </font><font color="#800000">&quot;-------------------------------------*&quot;</font><font color="#808080">)
 </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#800000">&quot;| LL    II VV   VV RRRRR  UU  UU   SSSS &quot;</font><font color="#808080">+;
 </font><font color="#800000">&quot;VV   VV II RRRRR  TTTT UU  UU   SSSS |&quot;</font><font color="#808080">)
 </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#800000">&quot;| LL    II  VV VV  RR   R UU  UU  SS    &quot;</font><font color="#808080">+;
 </font><font color="#800000">&quot; VV VV  II RR   R  TT  UU  UU  SS    |&quot;</font><font color="#808080">)
 </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#800000">&quot;| LL    II   VVV   RRRRR  UU  UU    SS  &quot;</font><font color="#808080">+;
 </font><font color="#800000">&quot;  VVV   II RRRRR   TT  UU  UU    SS  |&quot;</font><font color="#808080">)
 </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#800000">&quot;| LLLLL II    V    RR   R  UUUU  SSSS   &quot;</font><font color="#808080">+;
 </font><font color="#800000">&quot;   V    II RR   R  TT   UUUU  SSSS   |&quot;</font><font color="#808080">)
 </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#800000">&quot;*---------------------------------------&quot;</font><font color="#808080">+;
 </font><font color="#800000">&quot;-------------------------------------*&quot;</font><font color="#808080">)
 </font><font color="#0000FF">for </font><font color="#000080">cont</font><font color="#808080">:=</font><font color="#FF0000">1 </font><font color="#0000FF">to </font><font color="#FF0000">18 
   </font><font color="#000080">qout</font><font color="#808080">()
 </font><font color="#0000FF">next
 </font><font color="#000080">qqout</font><font color="#808080">(</font><font color="#000080">MSG_PRESS</font><font color="#808080">)
 </font><font color="#000080">inkey</font><font color="#808080">(</font><font color="#FF0000">0</font><font color="#808080">)
</font><font color="#0000FF">return
</font><font color="#808080">/*------------------------------------------------------------------------------
</font><font color="#000080">Mostra a tela de sobre </font><font color="#0000FF">do </font><font color="#000080">sistema</font><font color="#808080">.
------------------------------------------------------------------------------*/
</font><font color="#0000FF">procedure </font><font color="#000080">frmSobre</font><font color="#808080">()
</font><font color="#0000FF">local </font><font color="#000080">cont

 qout</font><font color="#808080">(</font><font color="#800000">&quot;*------------------------------------------------------------*&quot;</font><font color="#808080">)
 </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#800000">&quot;|  LL        II  VV       VV  RRRRRRR   UU    UU   SSSSSSS   |&quot;</font><font color="#808080">)
 </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#800000">&quot;|  LL        II   VV     VV   RR     R  UU    UU  SS         |&quot;</font><font color="#808080">)
 </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#800000">&quot;|  LL        II    VV   VV    RR     R  UU    UU   SSSS      |&quot;</font><font color="#808080">)
 </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#800000">&quot;|  LL        II     VV VV     RRRRRRR   UU    UU     SSSS    |&quot;</font><font color="#808080">)
 </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#800000">&quot;|  LLLL      II      VVV      RR RR     UU    UU        SS   |&quot;</font><font color="#808080">)
 </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#800000">&quot;|  LLLLLLLL  II       V       RR   RR    UUUUUU   SSSSSSSS   |&quot;</font><font color="#808080">)
 </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#800000">&quot;|                                                            |&quot;</font><font color="#808080">)
 </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#800000">&quot;|  VV       VV  II  RRRRRRR   TTTTTTTT  UU    UU   SSSSSSS   |&quot;</font><font color="#808080">)
 </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#800000">&quot;|   VV     VV   II  RR     R     TT     UU    UU  SS         |&quot;</font><font color="#808080">)
 </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#800000">&quot;|    VV   VV    II  RR     R     TT     UU    UU   SSSS      |&quot;</font><font color="#808080">)
 </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#800000">&quot;|     VV VV     II  RRRRRRR      TT     UU    UU     SSSS    |&quot;</font><font color="#808080">)
 </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#800000">&quot;|      VVV      II  RR RR        TT     UU    UU        SS   |&quot;</font><font color="#808080">)
 </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#800000">&quot;|       V       II  RR   RR      TT      UUUUUU   SSSSSSSS   |&quot;</font><font color="#808080">)
 </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#800000">&quot;|                                                            |&quot;</font><font color="#808080">)
 </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#800000">&quot;|                                               Versao 1.0.0 |&quot;</font><font color="#808080">)
 </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#800000">&quot;| Sistema integrante do projeto Livrus Virtus.               |&quot;</font><font color="#808080">)
 </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#800000">&quot;| Todos os direitos reservados para Henrique F. de Souza.    |&quot;</font><font color="#808080">)
 </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#800000">&quot;| Versao programada na linguagem harbour.                    |&quot;</font><font color="#808080">)
 </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#800000">&quot;*------------------------------------------------------------*&quot;</font><font color="#808080">)
 </font><font color="#0000FF">for </font><font color="#000080">cont</font><font color="#808080">:=</font><font color="#FF0000">1 </font><font color="#0000FF">to </font><font color="#FF0000">4 
   </font><font color="#000080">qout</font><font color="#808080">()
 </font><font color="#0000FF">next
 </font><font color="#000080">qqout</font><font color="#808080">(</font><font color="#000080">MSG_PRESS</font><font color="#808080">)
 </font><font color="#000080">inkey</font><font color="#808080">(</font><font color="#FF0000">0</font><font color="#808080">)
</font><font color="#0000FF">return
</font><font color="#808080">/*------------------------------------------------------------------------------
</font><font color="#000080">Mostra a tela de login </font><font color="#0000FF">do </font><font color="#000080">sistema</font><font color="#808080">.
</font><font color="#000080">retorna </font><font color="#808080">- </font><font color="#000080">se o login foi validado corretamente
</font><font color="#808080">------------------------------------------------------------------------------*/
</font><font color="#0000FF">function </font><font color="#000080">frmLogin</font><font color="#808080">()
</font><font color="#0000FF">local </font><font color="#000080">bret</font><font color="#808080">, </font><font color="#000080">slinha

  bret</font><font color="#808080">:=.f.
  </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#800000">&quot;*--------------------------------------------------------------*&quot;</font><font color="#808080">)
  </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#800000">&quot;| Login do sistema                                             |&quot;</font><font color="#808080">)
  </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#800000">&quot;*--------------------------------------------------------------*&quot;</font><font color="#808080">)
  </font><font color="#000080">slinha</font><font color="#808080">:=</font><font color="#000080">validaEntrada</font><font color="#808080">(</font><font color="#000080">tfUsuario</font><font color="#808080">, </font><font color="#000080">opUsuario</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#000080">tUsuario_login</font><font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">,;
        .f., </font><font color="#000080">opTexto</font><font color="#808080">)
  </font><font color="#0000FF">if </font><font color="#808080">!</font><font color="#0000FF">empty</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">)
     </font><font color="#000080">slinha</font><font color="#808080">:=</font><font color="#000080">validaEntrada</font><font color="#808080">(</font><font color="#000080">tfUsuario</font><font color="#808080">, </font><font color="#000080">opUsuario</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">, </font><font color="#000080">tUsuario_senha</font><font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">,;
        .f., </font><font color="#000080">opSenha</font><font color="#808080">)
     </font><font color="#0000FF">if </font><font color="#808080">!</font><font color="#0000FF">empty</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">)
        </font><font color="#000080">tUsuario_login</font><font color="#808080">:=</font><font color="#0000FF">alltrim</font><font color="#808080">(</font><font color="#000080">substr</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">))
        </font><font color="#000080">tUsuario_senha</font><font color="#808080">:=</font><font color="#0000FF">alltrim</font><font color="#808080">(</font><font color="#000080">substr</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">11</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">))
        </font><font color="#000080">bret</font><font color="#808080">:=.t.
     </font><font color="#0000FF">endif
  endif
  </font><font color="#000080">qout</font><font color="#808080">()
</font><font color="#0000FF">return</font><font color="#808080">(</font><font color="#000080">bret</font><font color="#808080">)
/*------------------------------------------------------------------------------
</font><font color="#000080">Mostra os menus </font><font color="#0000FF">do </font><font color="#000080">sistema</font><font color="#808080">.
</font><font color="#000080">num </font><font color="#808080">- </font><font color="#000080">o n&uacute;mero </font><font color="#0000FF">do menu
</font><font color="#808080">------------------------------------------------------------------------------*/
</font><font color="#0000FF">function menu</font><font color="#808080">(</font><font color="#000080">num</font><font color="#808080">)

 </font><font color="#0000FF">if </font><font color="#808080">(</font><font color="#000080">num</font><font color="#808080">=</font><font color="#FF0000">1</font><font color="#808080">) 
  </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#800000">&quot;*--------------------------------------------------------------*&quot;</font><font color="#808080">)
  </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#800000">&quot;| (C)adastros        (P)esquisas     (V)endas        (O)p&ccedil;&otilde;es  |&quot;</font><font color="#808080">)
  </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#800000">&quot;*--------------------------------------------------------------*&quot;</font><font color="#808080">)
 </font><font color="#000080">elseif </font><font color="#808080">(</font><font color="#000080">num</font><font color="#808080">=</font><font color="#FF0000">2</font><font color="#808080">) 
   </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#800000">&quot;*---------------------------------*&quot;</font><font color="#808080">)
   </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#800000">&quot;| 01. Cadastro de Assuntos        |&quot;</font><font color="#808080">)
   </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#800000">&quot;| 02. Cadastro de Autores         |&quot;</font><font color="#808080">)
   </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#800000">&quot;| 03. Cadastro de Editoras        |&quot;</font><font color="#808080">)
   </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#800000">&quot;| 04. Cadastro de Endere&ccedil;os       |&quot;</font><font color="#808080">)
   </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#800000">&quot;| 05. Cadastro de Idiomas         |&quot;</font><font color="#808080">)
   </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#800000">&quot;| 06. Cadastro de Pa&iacute;ses          |&quot;</font><font color="#808080">)
   </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#800000">&quot;| 07. Cadastro de Profiss&otilde;es      |&quot;</font><font color="#808080">)
   </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#800000">&quot;| 08. Cadastro de Clientes        |&quot;</font><font color="#808080">)
   </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#800000">&quot;| 09. Cadastro de Livros          |&quot;</font><font color="#808080">)
   </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#800000">&quot;| 10. Voltar ao menu              |&quot;</font><font color="#808080">)
   </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#800000">&quot;*---------------------------------*&quot;</font><font color="#808080">)
 </font><font color="#000080">elseif </font><font color="#808080">(</font><font color="#000080">num</font><font color="#808080">=</font><font color="#FF0000">3</font><font color="#808080">) 
   </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#800000">&quot;*---------------------------------*&quot;</font><font color="#808080">)
   </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#800000">&quot;| 01. Consulta de Assuntos        |&quot;</font><font color="#808080">)
   </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#800000">&quot;| 02. Consulta de Autores         |&quot;</font><font color="#808080">)
   </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#800000">&quot;| 03. Consulta de Editoras        |&quot;</font><font color="#808080">)
   </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#800000">&quot;| 04. Consulta de Endere&ccedil;os       |&quot;</font><font color="#808080">)
   </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#800000">&quot;| 05. Consulta de Idiomas         |&quot;</font><font color="#808080">)
   </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#800000">&quot;| 06. Consulta de Pa&iacute;ses          |&quot;</font><font color="#808080">)
   </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#800000">&quot;| 07. Consulta de Profiss&otilde;es      |&quot;</font><font color="#808080">)
   </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#800000">&quot;| 08. Consulta de Clientes        |&quot;</font><font color="#808080">)
   </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#800000">&quot;| 09. Consulta de Livros          |&quot;</font><font color="#808080">)
   </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#800000">&quot;| 10. Voltar ao menu              |&quot;</font><font color="#808080">)
   </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#800000">&quot;*---------------------------------*&quot;</font><font color="#808080">)
 </font><font color="#000080">elseif </font><font color="#808080">(</font><font color="#000080">num</font><font color="#808080">=</font><font color="#FF0000">4</font><font color="#808080">) 
   </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#800000">&quot;*---------------------------------*&quot;</font><font color="#808080">)
   </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#800000">&quot;| 01. Vender Livros               |&quot;</font><font color="#808080">)
   </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#800000">&quot;| 02. Vendas Realizadas           |&quot;</font><font color="#808080">)
   </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#800000">&quot;| 03. Voltar ao menu              |&quot;</font><font color="#808080">)
   </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#800000">&quot;*---------------------------------*&quot;</font><font color="#808080">)
 </font><font color="#000080">elseif </font><font color="#808080">(</font><font color="#000080">num</font><font color="#808080">=</font><font color="#FF0000">5</font><font color="#808080">) 
   </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#800000">&quot;*---------------------------------*&quot;</font><font color="#808080">)
   </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#800000">&quot;| 01. Alterar senha               |&quot;</font><font color="#808080">)
   </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#800000">&quot;| 02. Sobre o sistema             |&quot;</font><font color="#808080">)
   </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#800000">&quot;| 03. Sair do sistema             |&quot;</font><font color="#808080">)
   </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#800000">&quot;| 04. Voltar ao menu              |&quot;</font><font color="#808080">)
   </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#800000">&quot;*---------------------------------*&quot;</font><font color="#808080">)
 </font><font color="#000080">elseif </font><font color="#808080">(</font><font color="#000080">num</font><font color="#808080">=</font><font color="#FF0000">6</font><font color="#808080">) 
   </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#800000">&quot;*--------------------------------------------------------------*&quot;</font><font color="#808080">)
   </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#800000">&quot;| (1) Novo  (2) Pesquisar   (3) Voltar ao menu                 |&quot;</font><font color="#808080">)
   </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#800000">&quot;*--------------------------------------------------------------*&quot;</font><font color="#808080">)
 </font><font color="#000080">elseif </font><font color="#808080">(</font><font color="#000080">num</font><font color="#808080">=</font><font color="#FF0000">7</font><font color="#808080">) 
   </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#800000">&quot;*--------------------------------------------------------------*&quot;</font><font color="#808080">)
   </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#800000">&quot;| (1) Salvar inclus&atilde;o       (2) Voltar ao menu                 |&quot;</font><font color="#808080">)
   </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#800000">&quot;*--------------------------------------------------------------*&quot;</font><font color="#808080">)
 </font><font color="#000080">elseif </font><font color="#808080">(</font><font color="#000080">num</font><font color="#808080">=</font><font color="#FF0000">8</font><font color="#808080">) 
   </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#800000">&quot;*--------------------------------------------------------------*&quot;</font><font color="#808080">)
   </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#800000">&quot;| (1) Alterar       (2) Excluir     (3) Voltar ao menu         |&quot;</font><font color="#808080">)
   </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#800000">&quot;*--------------------------------------------------------------*&quot;</font><font color="#808080">)
 </font><font color="#000080">elseif </font><font color="#808080">(</font><font color="#000080">num</font><font color="#808080">=</font><font color="#FF0000">9</font><font color="#808080">) 
   </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#800000">&quot;*--------------------------------------------------------------*&quot;</font><font color="#808080">)
   </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#800000">&quot;| (1) Salvar altera&ccedil;&atilde;o      (2) Voltar ao menu                 |&quot;</font><font color="#808080">)
   </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#800000">&quot;*--------------------------------------------------------------*&quot;</font><font color="#808080">)
 </font><font color="#000080">elseif </font><font color="#808080">(</font><font color="#000080">num</font><font color="#808080">=</font><font color="#FF0000">10</font><font color="#808080">) 
   </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#800000">&quot;*--------------------------------------------------------------*&quot;</font><font color="#808080">)
   </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#800000">&quot;| Certeza de excluir? (S/N)                                    |&quot;</font><font color="#808080">)
   </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#800000">&quot;*--------------------------------------------------------------*&quot;</font><font color="#808080">)
 </font><font color="#000080">elseif </font><font color="#808080">(</font><font color="#000080">num</font><font color="#808080">=</font><font color="#FF0000">11</font><font color="#808080">) 
   </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#800000">&quot;*--------------------------------------------------------------*&quot;</font><font color="#808080">)
   </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#800000">&quot;| Deseja sair do sistema? (S/N)                                |&quot;</font><font color="#808080">)
   </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#800000">&quot;*--------------------------------------------------------------*&quot;</font><font color="#808080">)
 </font><font color="#000080">elseif </font><font color="#808080">(</font><font color="#000080">num</font><font color="#808080">=</font><font color="#FF0000">12</font><font color="#808080">) 
   </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#800000">&quot;*--------------------------------------------------------------*&quot;</font><font color="#808080">)
   </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#800000">&quot;| (1) Pesquisar  (2) Listar todos   (3) Voltar ao menu         |&quot;</font><font color="#808080">)
   </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#800000">&quot;*--------------------------------------------------------------*&quot;</font><font color="#808080">)
 </font><font color="#000080">elseif </font><font color="#808080">(</font><font color="#000080">num</font><font color="#808080">=</font><font color="#FF0000">13</font><font color="#808080">) 
   </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#800000">&quot;*--------------------------------------------------------------*&quot;</font><font color="#808080">)
   </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#800000">&quot;| Deseja continuar? (S/N)                                      |&quot;</font><font color="#808080">)
   </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#800000">&quot;*--------------------------------------------------------------*&quot;</font><font color="#808080">)
 </font><font color="#000080">elseif </font><font color="#808080">(</font><font color="#000080">num</font><font color="#808080">=</font><font color="#FF0000">14</font><font color="#808080">) 
   </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#800000">&quot;*--------------------------------------------------------------*&quot;</font><font color="#808080">)
   </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#800000">&quot;| Salvar inclus&atilde;o (S/N)                                        |&quot;</font><font color="#808080">)
   </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#800000">&quot;*--------------------------------------------------------------*&quot;</font><font color="#808080">)
 </font><font color="#0000FF">endif
return</font><font color="#808080">(</font><font color="#000080">MSG_OPCAO</font><font color="#808080">)
/*------------------------------------------------------------------------------
</font><font color="#000080">Realiza os cadastros de acordo com o tipo de arquivo</font><font color="#808080">.
</font><font color="#000080">sreg </font><font color="#808080">- </font><font color="#000080">o tipo de arquivo
sacao </font><font color="#808080">- </font><font color="#000080">a a&ccedil;&atilde;o a ser realizada
</font><font color="#808080">------------------------------------------------------------------------------*/
</font><font color="#0000FF">procedure </font><font color="#000080">frmCadastros</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#000080">sacao</font><font color="#808080">)
</font><font color="#0000FF">local </font><font color="#000080">slinha

</font><font color="#0000FF">if </font><font color="#000080">sreg </font><font color="#808080">= </font><font color="#000080">opAssunto 
   </font><font color="#0000FF">if </font><font color="#000080">sacao </font><font color="#808080">= </font><font color="#000080">opNovo 
      tAssunto_codigo</font><font color="#808080">:=</font><font color="#000080">pesqMaxCod</font><font color="#808080">(</font><font color="#000080">tfAssunto</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">, </font><font color="#000080">tamReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">))
      </font><font color="#000080">mostrarDados</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">)
      </font><font color="#000080">subMenu</font><font color="#808080">(</font><font color="#FF0000">7</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">)
   </font><font color="#000080">elseif sacao </font><font color="#808080">= </font><font color="#000080">opPesquisar 
     slinha</font><font color="#808080">:=</font><font color="#000080">validaEntrada</font><font color="#808080">(</font><font color="#000080">tfAssunto</font><font color="#808080">,</font><font color="#000080">sreg</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#000080">tAssunto_codigo</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,.f.,</font><font color="#000080">opNumero</font><font color="#808080">)
      </font><font color="#0000FF">if </font><font color="#808080">!</font><font color="#0000FF">empty</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">) 
        </font><font color="#000080">mostrarDados</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">)
        </font><font color="#000080">mostrarDados</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">)
        </font><font color="#000080">subMenu</font><font color="#808080">(</font><font color="#FF0000">8</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">)
      </font><font color="#0000FF">endif
   </font><font color="#000080">elseif sacao </font><font color="#808080">= </font><font color="#000080">opAlterar 
      mostrarDados</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">)
      </font><font color="#000080">subMenu</font><font color="#808080">(</font><font color="#FF0000">9</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">)
   </font><font color="#000080">elseif sacao </font><font color="#808080">= </font><font color="#000080">opExcluir 
      subMenu</font><font color="#808080">(</font><font color="#FF0000">10</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">)
   </font><font color="#0000FF">endif
</font><font color="#000080">elseif sreg </font><font color="#808080">= </font><font color="#000080">opAutor 
   </font><font color="#0000FF">if </font><font color="#000080">sacao </font><font color="#808080">= </font><font color="#000080">opNovo 
      tAutor_codigo</font><font color="#808080">:=</font><font color="#000080">pesqMaxCod</font><font color="#808080">(</font><font color="#000080">tfAutor</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">, </font><font color="#000080">tamReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">))
      </font><font color="#000080">mostrarDados</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">)
      </font><font color="#000080">subMenu</font><font color="#808080">(</font><font color="#FF0000">7</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">)
   </font><font color="#000080">elseif sacao </font><font color="#808080">= </font><font color="#000080">opPesquisar 
      slinha</font><font color="#808080">:=</font><font color="#000080">validaEntrada</font><font color="#808080">(</font><font color="#000080">tfAutor</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#000080">tAutor_codigo</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,.f.,</font><font color="#000080">opNumero</font><font color="#808080">)
      </font><font color="#0000FF">if </font><font color="#808080">!</font><font color="#0000FF">empty</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">) 
        </font><font color="#000080">mostrarDados</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">)
        </font><font color="#000080">mostrarDados</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">)
        </font><font color="#000080">subMenu</font><font color="#808080">(</font><font color="#FF0000">8</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">)
      </font><font color="#0000FF">endif
   </font><font color="#000080">elseif sacao </font><font color="#808080">= </font><font color="#000080">opAlterar 
      mostrarDados</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">)
      </font><font color="#000080">subMenu</font><font color="#808080">(</font><font color="#FF0000">9</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">)
   </font><font color="#000080">elseif sacao </font><font color="#808080">= </font><font color="#000080">opExcluir 
      subMenu</font><font color="#808080">(</font><font color="#FF0000">10</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">)
   </font><font color="#0000FF">endif
</font><font color="#000080">elseif sreg </font><font color="#808080">= </font><font color="#000080">opEditora 
   </font><font color="#0000FF">if </font><font color="#000080">sacao </font><font color="#808080">= </font><font color="#000080">opNovo 
      tEditora_codigo</font><font color="#808080">:=</font><font color="#000080">pesqMaxCod</font><font color="#808080">(</font><font color="#000080">tfEditora</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">, </font><font color="#000080">tamReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">))
      </font><font color="#000080">mostrarDados</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">)
      </font><font color="#000080">subMenu</font><font color="#808080">(</font><font color="#FF0000">7</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">)
   </font><font color="#000080">elseif sacao </font><font color="#808080">= </font><font color="#000080">opPesquisar 
     slinha</font><font color="#808080">:=</font><font color="#000080">validaEntrada</font><font color="#808080">(</font><font color="#000080">tfEditora</font><font color="#808080">,</font><font color="#000080">sreg</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#000080">tEditora_codigo</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,.f.,</font><font color="#000080">opNumero</font><font color="#808080">)
      </font><font color="#0000FF">if </font><font color="#808080">!</font><font color="#0000FF">empty</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">) 
        </font><font color="#000080">mostrarDados</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">)
        </font><font color="#000080">mostrarDados</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">)
        </font><font color="#000080">subMenu</font><font color="#808080">(</font><font color="#FF0000">8</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">)
      </font><font color="#0000FF">endif
   </font><font color="#000080">elseif sacao </font><font color="#808080">= </font><font color="#000080">opAlterar 
      mostrarDados</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">)
      </font><font color="#000080">subMenu</font><font color="#808080">(</font><font color="#FF0000">9</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">)
   </font><font color="#000080">elseif sacao </font><font color="#808080">= </font><font color="#000080">opExcluir 
      subMenu</font><font color="#808080">(</font><font color="#FF0000">10</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">)
   </font><font color="#0000FF">endif
</font><font color="#000080">elseif sreg </font><font color="#808080">= </font><font color="#000080">opEndereco 
   </font><font color="#0000FF">if </font><font color="#000080">sacao </font><font color="#808080">= </font><font color="#000080">opNovo 
      tEnd_codigo</font><font color="#808080">:=</font><font color="#000080">pesqMaxCod</font><font color="#808080">(</font><font color="#000080">tfEndereco</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">, </font><font color="#000080">tamReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">))
      </font><font color="#000080">mostrarDados</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">)
      </font><font color="#000080">subMenu</font><font color="#808080">(</font><font color="#FF0000">7</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">)
   </font><font color="#000080">elseif sacao </font><font color="#808080">= </font><font color="#000080">opPesquisar 
      slinha</font><font color="#808080">:=</font><font color="#000080">validaEntrada</font><font color="#808080">(</font><font color="#000080">tfEndereco</font><font color="#808080">,</font><font color="#000080">sreg</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#000080">tEnd_codigo</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,;
              .f.,</font><font color="#000080">opNumero</font><font color="#808080">)
      </font><font color="#0000FF">if </font><font color="#808080">!</font><font color="#0000FF">empty</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">) 
        </font><font color="#000080">mostrarDados</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">)
        </font><font color="#000080">mostrarDados</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">)
        </font><font color="#000080">subMenu</font><font color="#808080">(</font><font color="#FF0000">8</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">)
      </font><font color="#0000FF">endif
   </font><font color="#000080">elseif sacao </font><font color="#808080">= </font><font color="#000080">opAlterar 
      mostrarDados</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">)
      </font><font color="#000080">subMenu</font><font color="#808080">(</font><font color="#FF0000">9</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">)
   </font><font color="#000080">elseif sacao </font><font color="#808080">= </font><font color="#000080">opExcluir 
      subMenu</font><font color="#808080">(</font><font color="#FF0000">10</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">)
   </font><font color="#0000FF">endif
</font><font color="#000080">elseif sreg </font><font color="#808080">= </font><font color="#000080">opIdioma 
   </font><font color="#0000FF">if </font><font color="#000080">sacao </font><font color="#808080">= </font><font color="#000080">opNovo 
      tIdioma_codigo</font><font color="#808080">:=</font><font color="#000080">pesqMaxCod</font><font color="#808080">(</font><font color="#000080">tfIdioma</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">, </font><font color="#000080">tamReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">))
      </font><font color="#000080">mostrarDados</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">)
      </font><font color="#000080">subMenu</font><font color="#808080">(</font><font color="#FF0000">7</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">)
   </font><font color="#000080">elseif sacao </font><font color="#808080">= </font><font color="#000080">opPesquisar 
      slinha</font><font color="#808080">:=</font><font color="#000080">validaEntrada</font><font color="#808080">(</font><font color="#000080">tfIdioma</font><font color="#808080">,</font><font color="#000080">sreg</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#000080">tIdioma_codigo</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,.f.,</font><font color="#000080">opNumero</font><font color="#808080">)
      </font><font color="#0000FF">if </font><font color="#808080">!</font><font color="#0000FF">empty</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">) 
        </font><font color="#000080">mostrarDados</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">)
        </font><font color="#000080">mostrarDados</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">)
        </font><font color="#000080">subMenu</font><font color="#808080">(</font><font color="#FF0000">8</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">)
      </font><font color="#0000FF">endif
   </font><font color="#000080">elseif sacao </font><font color="#808080">= </font><font color="#000080">opAlterar 
      mostrarDados</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">)
      </font><font color="#000080">subMenu</font><font color="#808080">(</font><font color="#FF0000">9</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">)
   </font><font color="#000080">elseif sacao </font><font color="#808080">= </font><font color="#000080">opExcluir 
      subMenu</font><font color="#808080">(</font><font color="#FF0000">10</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">)
   </font><font color="#0000FF">endif
</font><font color="#000080">elseif sreg </font><font color="#808080">= </font><font color="#000080">opPais 
   </font><font color="#0000FF">if </font><font color="#000080">sacao </font><font color="#808080">= </font><font color="#000080">opNovo 
      </font><font color="#0000FF">accept </font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">) </font><font color="#0000FF">to </font><font color="#000080">tPais_codigo
      slinha</font><font color="#808080">:=</font><font color="#000080">pesqArq</font><font color="#808080">(</font><font color="#000080">tfPais</font><font color="#808080">, </font><font color="#000080">tPais_codigo</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">, </font><font color="#000080">tamReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">))
      </font><font color="#0000FF">if empty</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">)
         </font><font color="#000080">pesqLinhaExcluida</font><font color="#808080">(</font><font color="#000080">tfPais</font><font color="#808080">, </font><font color="#000080">tamReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">))
         </font><font color="#000080">mostrarDados</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">)
         </font><font color="#000080">subMenu</font><font color="#808080">(</font><font color="#FF0000">7</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">)
      </font><font color="#0000FF">else 
         </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#000080">MSG_REGEXST</font><font color="#808080">)
      </font><font color="#0000FF">endif
   </font><font color="#000080">elseif sacao </font><font color="#808080">= </font><font color="#000080">opPesquisar 
      slinha</font><font color="#808080">:=</font><font color="#000080">validaEntrada</font><font color="#808080">(</font><font color="#000080">tfPais</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#000080">tPais_codigo</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, .f., </font><font color="#000080">opTexto</font><font color="#808080">)
      </font><font color="#0000FF">if </font><font color="#808080">!</font><font color="#0000FF">empty</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">) 
        </font><font color="#000080">mostrarDados</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">)
        </font><font color="#000080">mostrarDados</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">)
        </font><font color="#000080">subMenu</font><font color="#808080">(</font><font color="#FF0000">8</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">)
      </font><font color="#0000FF">endif
   </font><font color="#000080">elseif sacao </font><font color="#808080">= </font><font color="#000080">opAlterar 
      qout</font><font color="#808080">(</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">)+ </font><font color="#000080">tPais_codigo</font><font color="#808080">)
      </font><font color="#000080">mostrarDados</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">)
      </font><font color="#000080">subMenu</font><font color="#808080">(</font><font color="#FF0000">9</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">)
   </font><font color="#000080">elseif sacao </font><font color="#808080">= </font><font color="#000080">opExcluir 
      subMenu</font><font color="#808080">(</font><font color="#FF0000">10</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">)
   </font><font color="#0000FF">endif
</font><font color="#000080">elseif sreg </font><font color="#808080">= </font><font color="#000080">opProfissao 
   </font><font color="#0000FF">if </font><font color="#000080">sacao </font><font color="#808080">= </font><font color="#000080">opNovo 
      tProfiss_codigo</font><font color="#808080">:=</font><font color="#000080">pesqMaxCod</font><font color="#808080">(</font><font color="#000080">tfProfissao</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">, </font><font color="#000080">tamReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">))
      </font><font color="#000080">mostrarDados</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">)
      </font><font color="#000080">subMenu</font><font color="#808080">(</font><font color="#FF0000">7</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">)
   </font><font color="#000080">elseif sacao </font><font color="#808080">= </font><font color="#000080">opPesquisar 
      slinha</font><font color="#808080">:=</font><font color="#000080">validaEntrada</font><font color="#808080">(</font><font color="#000080">tfProfissao</font><font color="#808080">,</font><font color="#000080">sreg</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#000080">tProfiss_codigo</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,;
              .f.,</font><font color="#000080">opNumero</font><font color="#808080">)
      </font><font color="#0000FF">if </font><font color="#808080">!</font><font color="#0000FF">empty</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">) 
        </font><font color="#000080">mostrarDados</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">)
        </font><font color="#000080">mostrarDados</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">)
        </font><font color="#000080">subMenu</font><font color="#808080">(</font><font color="#FF0000">8</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">)
      </font><font color="#0000FF">endif
   </font><font color="#000080">elseif sacao </font><font color="#808080">= </font><font color="#000080">opAlterar 
      mostrarDados</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">)
      </font><font color="#000080">subMenu</font><font color="#808080">(</font><font color="#FF0000">9</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">)
   </font><font color="#000080">elseif sacao </font><font color="#808080">= </font><font color="#000080">opExcluir 
      subMenu</font><font color="#808080">(</font><font color="#FF0000">10</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">)
   </font><font color="#0000FF">endif
</font><font color="#000080">elseif sreg </font><font color="#808080">= </font><font color="#000080">opLivro 
   </font><font color="#0000FF">if </font><font color="#000080">sacao </font><font color="#808080">= </font><font color="#000080">opNovo 
      </font><font color="#0000FF">accept </font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">) </font><font color="#0000FF">to </font><font color="#000080">tLiv_isbn
      </font><font color="#0000FF">if </font><font color="#000080">validaISBN</font><font color="#808080">(</font><font color="#000080">tLiv_isbn</font><font color="#808080">) 
          </font><font color="#000080">slinha</font><font color="#808080">:=</font><font color="#000080">pesqArq</font><font color="#808080">(</font><font color="#000080">tfLivro</font><font color="#808080">, </font><font color="#000080">tLiv_isbn</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">13</font><font color="#808080">, </font><font color="#000080">tamReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">))
          </font><font color="#0000FF">if empty</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">)
             </font><font color="#000080">pesqLinhaExcluida</font><font color="#808080">(</font><font color="#000080">tfLivro</font><font color="#808080">, </font><font color="#000080">tamReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">))
             </font><font color="#000080">mostrarDados</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">)
             </font><font color="#000080">subMenu</font><font color="#808080">(</font><font color="#FF0000">7</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">)
             </font><font color="#000080">frmCadLigados</font><font color="#808080">(</font><font color="#000080">opLivroAss</font><font color="#808080">, </font><font color="#000080">opNovo</font><font color="#808080">, </font><font color="#000080">tLiv_isbn</font><font color="#808080">)
             </font><font color="#000080">frmCadLigados</font><font color="#808080">(</font><font color="#000080">opLivroAut</font><font color="#808080">, </font><font color="#000080">opNovo</font><font color="#808080">, </font><font color="#000080">tLiv_isbn</font><font color="#808080">)
          </font><font color="#0000FF">else 
             </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#000080">MSG_REGEXST</font><font color="#808080">)
          </font><font color="#0000FF">endif
      else 
        </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#000080">MSG_ISBNINV</font><font color="#808080">)
      </font><font color="#0000FF">endif
   </font><font color="#000080">elseif sacao </font><font color="#808080">= </font><font color="#000080">opPesquisar 
      slinha</font><font color="#808080">:=</font><font color="#000080">validaEntrada</font><font color="#808080">(</font><font color="#000080">tfLivro</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#000080">tLiv_isbn</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">,.f.,</font><font color="#000080">opTexto</font><font color="#808080">)
      </font><font color="#0000FF">if </font><font color="#808080">!</font><font color="#0000FF">empty</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">) 
         </font><font color="#000080">mostrarDados</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">)
         </font><font color="#000080">mostrarDados</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">)
         </font><font color="#000080">subMenu</font><font color="#808080">(</font><font color="#FF0000">8</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">)
      </font><font color="#0000FF">endif
   </font><font color="#000080">elseif sacao </font><font color="#808080">= </font><font color="#000080">opAlterar 
      qout</font><font color="#808080">(</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">)+ </font><font color="#000080">tLiv_isbn</font><font color="#808080">)
      </font><font color="#000080">mostrarDados</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">)
      </font><font color="#000080">subMenu</font><font color="#808080">(</font><font color="#FF0000">9</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">)
      </font><font color="#000080">frmCadLigados</font><font color="#808080">(</font><font color="#000080">opLivroAss</font><font color="#808080">, </font><font color="#000080">opExcluir</font><font color="#808080">, </font><font color="#000080">tLiv_isbn</font><font color="#808080">)
      </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#800000">&quot;Assuntos dos livros exclu&iacute;dos, inclua novos!&quot;</font><font color="#808080">)
      </font><font color="#000080">frmCadLigados</font><font color="#808080">(</font><font color="#000080">opLivroAss</font><font color="#808080">, </font><font color="#000080">opNovo</font><font color="#808080">, </font><font color="#000080">tLiv_isbn</font><font color="#808080">)
      </font><font color="#000080">frmCadLigados</font><font color="#808080">(</font><font color="#000080">opLivroAut</font><font color="#808080">, </font><font color="#000080">opExcluir</font><font color="#808080">, </font><font color="#000080">tLiv_isbn</font><font color="#808080">)
      </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#800000">&quot;Autores dos livros exclu&iacute;dos, inclua novos!&quot;</font><font color="#808080">)
      </font><font color="#000080">frmCadLigados</font><font color="#808080">(</font><font color="#000080">opLivroAut</font><font color="#808080">, </font><font color="#000080">opNovo</font><font color="#808080">, </font><font color="#000080">tLiv_isbn</font><font color="#808080">)
   </font><font color="#000080">elseif sacao </font><font color="#808080">= </font><font color="#000080">opExcluir 
      subMenu</font><font color="#808080">(</font><font color="#FF0000">10</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">)
      </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#800000">&quot;Assuntos dos livros sendo exclu&iacute;dos!&quot;</font><font color="#808080">)
      </font><font color="#000080">frmCadLigados</font><font color="#808080">(</font><font color="#000080">opLivroAss</font><font color="#808080">, </font><font color="#000080">opExcluir</font><font color="#808080">, </font><font color="#000080">tLiv_isbn</font><font color="#808080">)
      </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#800000">&quot;Autores dos livros sendo exclu&iacute;dos!&quot;</font><font color="#808080">)
      </font><font color="#000080">frmCadLigados</font><font color="#808080">(</font><font color="#000080">opLivroAut</font><font color="#808080">, </font><font color="#000080">opExcluir</font><font color="#808080">, </font><font color="#000080">tLiv_isbn</font><font color="#808080">)
   </font><font color="#0000FF">endif
</font><font color="#000080">elseif sreg </font><font color="#808080">= </font><font color="#000080">opCliente 
   </font><font color="#0000FF">if </font><font color="#000080">sacao </font><font color="#808080">= </font><font color="#000080">opNovo 
      </font><font color="#0000FF">accept </font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">) </font><font color="#0000FF">to </font><font color="#000080">tCli_cpf
      </font><font color="#0000FF">if </font><font color="#000080">validaCPF</font><font color="#808080">(</font><font color="#000080">tCli_cpf</font><font color="#808080">) 
          </font><font color="#000080">slinha</font><font color="#808080">:=</font><font color="#000080">pesqArq</font><font color="#808080">(</font><font color="#000080">tfCliente</font><font color="#808080">, </font><font color="#000080">tCli_cpf</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">14</font><font color="#808080">, </font><font color="#000080">tamReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">))
          </font><font color="#0000FF">if empty</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">)
             </font><font color="#000080">pesqLinhaExcluida</font><font color="#808080">(</font><font color="#000080">tfCliente</font><font color="#808080">, </font><font color="#000080">tamReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">))
             </font><font color="#000080">mostrarDados</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">)
             </font><font color="#000080">subMenu</font><font color="#808080">(</font><font color="#FF0000">7</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">)
          </font><font color="#0000FF">else 
            </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#000080">MSG_REGEXST</font><font color="#808080">)
          </font><font color="#0000FF">endif
      else 
        </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#000080">MSG_CPFINV</font><font color="#808080">)
      </font><font color="#0000FF">endif 
   </font><font color="#000080">elseif sacao </font><font color="#808080">= </font><font color="#000080">opPesquisar 
      slinha</font><font color="#808080">:=</font><font color="#000080">validaEntrada</font><font color="#808080">(</font><font color="#000080">tfCliente</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#000080">tCli_cpf</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,.f.,</font><font color="#000080">opTexto</font><font color="#808080">)
      </font><font color="#0000FF">if </font><font color="#808080">!</font><font color="#0000FF">empty</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">) 
         </font><font color="#000080">mostrarDados</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">)
         </font><font color="#000080">mostrarDados</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">)
         </font><font color="#000080">subMenu</font><font color="#808080">(</font><font color="#FF0000">8</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">)
      </font><font color="#0000FF">endif
   </font><font color="#000080">elseif sacao </font><font color="#808080">= </font><font color="#000080">opAlterar 
      qout</font><font color="#808080">(</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">)+ </font><font color="#000080">tCli_cpf</font><font color="#808080">)
      </font><font color="#000080">mostrarDados</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">)
      </font><font color="#000080">subMenu</font><font color="#808080">(</font><font color="#FF0000">9</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">)
   </font><font color="#000080">elseif sacao </font><font color="#808080">= </font><font color="#000080">opExcluir 
      subMenu</font><font color="#808080">(</font><font color="#FF0000">10</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">)
   </font><font color="#0000FF">endif
</font><font color="#000080">elseif sreg </font><font color="#808080">= </font><font color="#000080">opVenda 
   </font><font color="#0000FF">if </font><font color="#000080">sacao </font><font color="#808080">= </font><font color="#000080">opNovo 
      tVenda_dthrvenda</font><font color="#808080">:=</font><font color="#000080">retDataHora</font><font color="#808080">()
      </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">)+ </font><font color="#000080">tVenda_dthrvenda</font><font color="#808080">)
      </font><font color="#000080">slinha</font><font color="#808080">:=</font><font color="#000080">pesqArq</font><font color="#808080">(</font><font color="#000080">tfVenda</font><font color="#808080">, </font><font color="#000080">tVenda_dthrvenda</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">19</font><font color="#808080">, </font><font color="#000080">tamReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">))
      </font><font color="#0000FF">if empty</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">) 
         </font><font color="#000080">slinha</font><font color="#808080">:=</font><font color="#000080">validaEntrada</font><font color="#808080">(</font><font color="#000080">tfCliente</font><font color="#808080">,</font><font color="#000080">opCliente</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#000080">tVenda_cpf</font><font color="#808080">,</font><font color="#FF0000">3</font><font color="#808080">,;
                 .f.,</font><font color="#000080">opTexto</font><font color="#808080">)
         </font><font color="#0000FF">if </font><font color="#808080">!</font><font color="#0000FF">empty</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">) 
            </font><font color="#000080">tVenda_cpf</font><font color="#808080">:=</font><font color="#0000FF">alltrim</font><font color="#808080">(</font><font color="#000080">substr</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#FF0000">14</font><font color="#808080">))
            </font><font color="#0000FF">if </font><font color="#000080">validaCPF</font><font color="#808080">(</font><font color="#000080">tVenda_cpf</font><font color="#808080">) 
               </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#800000">&quot; &quot;</font><font color="#808080">+</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">opCliente</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">)) /* </font><font color="#000080">Nome </font><font color="#808080">*/
               </font><font color="#000080">qqout</font><font color="#808080">(</font><font color="#000080">substr</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#000080">g_nPosChave</font><font color="#808080">, </font><font color="#000080">g_nTamChave</font><font color="#808080">))
               </font><font color="#000080">frmCadLigados</font><font color="#808080">(</font><font color="#000080">opVenda</font><font color="#808080">, </font><font color="#000080">opNovo</font><font color="#808080">, </font><font color="#000080">tVenda_cpf</font><font color="#808080">)
            </font><font color="#0000FF">else 
               </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#000080">MSG_CPFINV</font><font color="#808080">)
            </font><font color="#0000FF">endif
         endif
      else 
         </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#000080">MSG_REGEXST</font><font color="#808080">)
      </font><font color="#0000FF">endif
   </font><font color="#000080">elseif sacao </font><font color="#808080">= </font><font color="#000080">opPesquisar 
      slinha</font><font color="#808080">:=</font><font color="#000080">validaEntrada</font><font color="#808080">(</font><font color="#000080">tfVenda</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#000080">tVenda_dthrvenda</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,;
              .f.,</font><font color="#000080">opDataHora</font><font color="#808080">)
      </font><font color="#0000FF">if </font><font color="#808080">!</font><font color="#0000FF">empty</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">) 
        </font><font color="#000080">mostrarDados</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">)
        </font><font color="#000080">mostrarDados</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">)
        </font><font color="#000080">subMenu</font><font color="#808080">(</font><font color="#FF0000">8</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">)
      </font><font color="#0000FF">endif
   endif
endif

return
</font><font color="#808080">/*------------------------------------------------------------------------------
</font><font color="#000080">Realiza as consultas de acordo com o tipo de arquivo</font><font color="#808080">.
</font><font color="#000080">sreg </font><font color="#808080">- </font><font color="#000080">o tipo de arquivo
sacao </font><font color="#808080">- </font><font color="#000080">a a&ccedil;&atilde;o a ser realizada
</font><font color="#808080">------------------------------------------------------------------------------*/
</font><font color="#0000FF">procedure </font><font color="#000080">frmConsultas</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#000080">sacao</font><font color="#808080">)
</font><font color="#0000FF">local </font><font color="#000080">slinha

</font><font color="#0000FF">if </font><font color="#000080">sreg </font><font color="#808080">= </font><font color="#000080">opAssunto 
   </font><font color="#0000FF">if </font><font color="#000080">sacao </font><font color="#808080">= </font><font color="#000080">opPesquisar
      slinha</font><font color="#808080">:=</font><font color="#000080">validaEntrada</font><font color="#808080">(</font><font color="#000080">tfAssunto</font><font color="#808080">,</font><font color="#000080">sreg</font><font color="#808080">,</font><font color="#FF0000">2</font><font color="#808080">,</font><font color="#000080">tAssunto_assunto</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,.t.,</font><font color="#000080">opTexto</font><font color="#808080">)
   </font><font color="#000080">elseif sacao </font><font color="#808080">= </font><font color="#000080">opListarTodos 
      </font><font color="#0000FF">if </font><font color="#000080">ListarTodos</font><font color="#808080">(</font><font color="#000080">tfAssunto</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#000080">tamReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">),;
        </font><font color="#000080">QTD_MAX_LINHA</font><font color="#808080">, .f.) = .f.
        </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">))
      </font><font color="#0000FF">endif
   endif
</font><font color="#000080">elseif sreg </font><font color="#808080">= </font><font color="#000080">opAutor 
   </font><font color="#0000FF">if </font><font color="#000080">sacao </font><font color="#808080">= </font><font color="#000080">opPesquisar
      slinha</font><font color="#808080">:=</font><font color="#000080">validaEntrada</font><font color="#808080">(</font><font color="#000080">tfAutor</font><font color="#808080">,</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">, </font><font color="#000080">tAutor_autor</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, .t.,</font><font color="#000080">opTexto</font><font color="#808080">)
   </font><font color="#000080">elseif sacao </font><font color="#808080">= </font><font color="#000080">opListarTodos 
      </font><font color="#0000FF">if </font><font color="#000080">ListarTodos</font><font color="#808080">(</font><font color="#000080">tfAutor</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#000080">tamReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">),;
        </font><font color="#000080">QTD_MAX_LINHA</font><font color="#808080">, .f.) = .f.
        </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">))
      </font><font color="#0000FF">endif
   endif
</font><font color="#000080">elseif sreg </font><font color="#808080">= </font><font color="#000080">opEditora 
   </font><font color="#0000FF">if </font><font color="#000080">sacao </font><font color="#808080">= </font><font color="#000080">opPesquisar
      slinha</font><font color="#808080">:=</font><font color="#000080">validaEntrada</font><font color="#808080">(</font><font color="#000080">tfEditora</font><font color="#808080">,</font><font color="#000080">sreg</font><font color="#808080">,</font><font color="#FF0000">2</font><font color="#808080">,</font><font color="#000080">tEditora_editora</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,.t.,</font><font color="#000080">opTexto</font><font color="#808080">)
   </font><font color="#000080">elseif sacao </font><font color="#808080">= </font><font color="#000080">opListarTodos 
      </font><font color="#0000FF">if </font><font color="#000080">ListarTodos</font><font color="#808080">(</font><font color="#000080">tfEditora</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#000080">tamReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">),;
        </font><font color="#000080">QTD_MAX_LINHA</font><font color="#808080">, .f.) = .f.
        </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">))
      </font><font color="#0000FF">endif
   endif
</font><font color="#000080">elseif sreg </font><font color="#808080">= </font><font color="#000080">opEndereco 
   </font><font color="#0000FF">if </font><font color="#000080">sacao </font><font color="#808080">= </font><font color="#000080">opPesquisar
      slinha</font><font color="#808080">:=</font><font color="#000080">validaEntrada</font><font color="#808080">(</font><font color="#000080">tfEndereco</font><font color="#808080">,</font><font color="#000080">sreg</font><font color="#808080">,</font><font color="#FF0000">2</font><font color="#808080">,</font><font color="#000080">tEnd_Logradouro</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,;
              .t.,</font><font color="#000080">opTexto</font><font color="#808080">)
   </font><font color="#000080">elseif sacao </font><font color="#808080">= </font><font color="#000080">opListarTodos 
      </font><font color="#0000FF">if </font><font color="#000080">ListarTodos</font><font color="#808080">(</font><font color="#000080">tfEndereco</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#000080">tamReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">),;
         </font><font color="#FF0000">3</font><font color="#808080">, .f.) = .f.
        </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">))
      </font><font color="#0000FF">endif
   endif
</font><font color="#000080">elseif sreg </font><font color="#808080">= </font><font color="#000080">opIdioma 
   </font><font color="#0000FF">if </font><font color="#000080">sacao </font><font color="#808080">= </font><font color="#000080">opPesquisar
      slinha</font><font color="#808080">:=</font><font color="#000080">validaEntrada</font><font color="#808080">(</font><font color="#000080">tfIdioma</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">, </font><font color="#000080">tIdioma_idioma</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,.t.,</font><font color="#000080">opTexto</font><font color="#808080">)
   </font><font color="#000080">elseif sacao </font><font color="#808080">= </font><font color="#000080">opListarTodos 
      </font><font color="#0000FF">if </font><font color="#000080">ListarTodos</font><font color="#808080">(</font><font color="#000080">tfIdioma</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#000080">tamReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">),;
        </font><font color="#000080">QTD_MAX_LINHA</font><font color="#808080">, .f.) = .f.
        </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">))
      </font><font color="#0000FF">endif
   endif
</font><font color="#000080">elseif sreg </font><font color="#808080">= </font><font color="#000080">opPais 
   </font><font color="#0000FF">if </font><font color="#000080">sacao </font><font color="#808080">= </font><font color="#000080">opPesquisar
      slinha</font><font color="#808080">:=</font><font color="#000080">validaEntrada</font><font color="#808080">(</font><font color="#000080">tfPais</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">, </font><font color="#000080">tPais_pais</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, .t.,</font><font color="#000080">opTexto</font><font color="#808080">)
   </font><font color="#000080">elseif sacao </font><font color="#808080">= </font><font color="#000080">opListarTodos 
      </font><font color="#0000FF">if </font><font color="#000080">ListarTodos</font><font color="#808080">(</font><font color="#000080">tfPais</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#000080">tamReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">),;
        </font><font color="#000080">QTD_MAX_LINHA</font><font color="#808080">, .f.) = .f.
        </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">))
      </font><font color="#0000FF">endif
   endif
</font><font color="#000080">elseif sreg </font><font color="#808080">= </font><font color="#000080">opProfissao 
   </font><font color="#0000FF">if </font><font color="#000080">sacao </font><font color="#808080">= </font><font color="#000080">opPesquisar
     slinha</font><font color="#808080">:=</font><font color="#000080">validaEntrada</font><font color="#808080">(</font><font color="#000080">tfProfissao</font><font color="#808080">,</font><font color="#000080">sreg</font><font color="#808080">,</font><font color="#FF0000">2</font><font color="#808080">,</font><font color="#000080">tProfiss_profissao</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,;
             .t.,</font><font color="#000080">opTexto</font><font color="#808080">)
   </font><font color="#000080">elseif sacao </font><font color="#808080">= </font><font color="#000080">opListarTodos 
      </font><font color="#0000FF">if </font><font color="#000080">ListarTodos</font><font color="#808080">(</font><font color="#000080">tfProfissao</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#000080">tamReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">),;
        </font><font color="#000080">QTD_MAX_LINHA</font><font color="#808080">, .f.) = .f.
        </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">))
      </font><font color="#0000FF">endif
   endif
</font><font color="#000080">elseif sreg </font><font color="#808080">= </font><font color="#000080">opLivro 
   </font><font color="#0000FF">if </font><font color="#000080">sacao </font><font color="#808080">= </font><font color="#000080">opPesquisar
      slinha</font><font color="#808080">:=</font><font color="#000080">validaEntrada</font><font color="#808080">(</font><font color="#000080">tfLivro</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">, </font><font color="#000080">tLiv_titulo</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, .t.,</font><font color="#000080">opTexto</font><font color="#808080">)
   </font><font color="#000080">elseif sacao </font><font color="#808080">= </font><font color="#000080">opListarTodos 
      </font><font color="#0000FF">if </font><font color="#000080">ListarTodos</font><font color="#808080">(</font><font color="#000080">tfLivro</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#000080">tamReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">),;
        </font><font color="#FF0000">1</font><font color="#808080">, .f.) = .f.
        </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">))
      </font><font color="#0000FF">endif
   endif
</font><font color="#000080">elseif sreg </font><font color="#808080">= </font><font color="#000080">opCliente 
   </font><font color="#0000FF">if </font><font color="#000080">sacao </font><font color="#808080">= </font><font color="#000080">opPesquisar
      slinha</font><font color="#808080">:=</font><font color="#000080">validaEntrada</font><font color="#808080">(</font><font color="#000080">tfCliente</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">, </font><font color="#000080">tCli_nome</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,.t.,</font><font color="#000080">opTexto</font><font color="#808080">)
   </font><font color="#000080">elseif sacao </font><font color="#808080">= </font><font color="#000080">opListarTodos 
      </font><font color="#0000FF">if </font><font color="#000080">ListarTodos</font><font color="#808080">(</font><font color="#000080">tfCliente</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#000080">tamReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">),;
        </font><font color="#FF0000">1</font><font color="#808080">, .f.) = .f.
        </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">))
      </font><font color="#0000FF">endif
   endif
</font><font color="#000080">elseif sreg </font><font color="#808080">= </font><font color="#000080">opVenda 
   </font><font color="#0000FF">if </font><font color="#000080">sacao </font><font color="#808080">= </font><font color="#000080">opPesquisar
      slinha</font><font color="#808080">:=</font><font color="#000080">validaEntrada</font><font color="#808080">(</font><font color="#000080">tfVenda</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">, </font><font color="#000080">tVenda_cpf</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, .t.,</font><font color="#000080">opTexto</font><font color="#808080">)
   </font><font color="#000080">elseif sacao </font><font color="#808080">= </font><font color="#000080">opListarTodos 
      </font><font color="#0000FF">if </font><font color="#000080">ListarTodos</font><font color="#808080">(</font><font color="#000080">tfVenda</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#000080">tamReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">),;
        </font><font color="#000080">QTD_MAX_LINHA</font><font color="#808080">, .f.) = .f.
        </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">))
      </font><font color="#0000FF">endif
   endif
endif
if empty</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">)
   </font><font color="#000080">qqout</font><font color="#808080">(</font><font color="#800000">&quot;&quot;</font><font color="#808080">)
</font><font color="#0000FF">endif
return
</font><font color="#808080">/*------------------------------------------------------------------------------
</font><font color="#000080">Mostra a tela de altera&ccedil;&atilde;o de senha </font><font color="#0000FF">do </font><font color="#000080">sistema e realiza a altera&ccedil;&atilde;o</font><font color="#808080">.
------------------------------------------------------------------------------*/
</font><font color="#0000FF">procedure </font><font color="#000080">frmAlterarSenha</font><font color="#808080">()
</font><font color="#0000FF">local </font><font color="#000080">bQuebra</font><font color="#808080">, </font><font color="#000080">sres</font><font color="#808080">, </font><font color="#000080">sSenhaAtual</font><font color="#808080">, </font><font color="#000080">sNovaSenha</font><font color="#808080">, </font><font color="#000080">sConfirmaSenha</font><font color="#808080">, </font><font color="#000080">nopcao

qout</font><font color="#808080">(</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">opUsuario</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">)+ </font><font color="#000080">tUsuario_login</font><font color="#808080">)
</font><font color="#000080">nopcao</font><font color="#808080">:=</font><font color="#FF0000">1
</font><font color="#000080">bQuebra</font><font color="#808080">:=.f.
</font><font color="#0000FF">do while </font><font color="#808080">(</font><font color="#000080">bQuebra</font><font color="#808080">=.f.)
  </font><font color="#0000FF">do case
   case </font><font color="#000080">nopcao </font><font color="#808080">= </font><font color="#FF0000">1 
       </font><font color="#000080">sSenhaAtual</font><font color="#808080">:=</font><font color="#000080">digitaSenha</font><font color="#808080">(</font><font color="#800000">&quot;Senha Atual: &quot;</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">)
       </font><font color="#0000FF">if </font><font color="#000080">sSenhaAtual</font><font color="#808080">&lt;&gt;</font><font color="#000080">tUsuario_senha 
          qout</font><font color="#808080">(</font><font color="#000080">MSG_SENCONFERE</font><font color="#808080">)
          </font><font color="#000080">bQuebra</font><font color="#808080">:=.t.
       </font><font color="#0000FF">else 
          </font><font color="#000080">nopcao</font><font color="#808080">:=</font><font color="#FF0000">2
       </font><font color="#0000FF">endif
   case </font><font color="#000080">nopcao </font><font color="#808080">= </font><font color="#FF0000">2
       </font><font color="#000080">sNovaSenha</font><font color="#808080">:=</font><font color="#000080">digitaSenha</font><font color="#808080">(</font><font color="#800000">&quot;Nova Senha: &quot;</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">)
       </font><font color="#000080">sConfirmaSenha</font><font color="#808080">:=</font><font color="#000080">digitaSenha</font><font color="#808080">(</font><font color="#800000">&quot;Confirma Senha: &quot;</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">)
       </font><font color="#0000FF">if </font><font color="#000080">sNovaSenha</font><font color="#808080">&lt;&gt;</font><font color="#000080">sConfirmaSenha 
          qout</font><font color="#808080">(</font><font color="#000080">MSG_SENCONFIRM</font><font color="#808080">)
          </font><font color="#000080">bQuebra</font><font color="#808080">:=.t.
       </font><font color="#0000FF">else 
          </font><font color="#000080">nopcao</font><font color="#808080">:=</font><font color="#FF0000">3
       </font><font color="#0000FF">endif
   case </font><font color="#000080">nopcao </font><font color="#808080">= </font><font color="#FF0000">3
       </font><font color="#000080">sres</font><font color="#808080">:=</font><font color="#000080">pesqArq</font><font color="#808080">(</font><font color="#000080">tfUsuario</font><font color="#808080">, </font><font color="#000080">tUsuario_login</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">, </font><font color="#000080">tamReg</font><font color="#808080">(</font><font color="#000080">opUsuario</font><font color="#808080">))
       </font><font color="#0000FF">if empty</font><font color="#808080">(</font><font color="#000080">sres</font><font color="#808080">)
         </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#000080">MSG_LOGINENCON</font><font color="#808080">)
       </font><font color="#0000FF">else 
         </font><font color="#000080">tUsuario_senha</font><font color="#808080">:=</font><font color="#000080">sConfirmaSenha
         subMenu</font><font color="#808080">(</font><font color="#FF0000">9</font><font color="#808080">,</font><font color="#000080">opUsuario</font><font color="#808080">)
         </font><font color="#000080">bQuebra</font><font color="#808080">:=.t.
       </font><font color="#0000FF">endif
  endcase
enddo

return
</font><font color="#808080">/*------------------------------------------------------------------------------
</font><font color="#000080">Executa uma a&ccedil;&atilde;o de grava&ccedil;&atilde;o de acordo com o tipo de arquivo</font><font color="#808080">.
</font><font color="#000080">sreg </font><font color="#808080">- </font><font color="#000080">o tipo de arquivo
sacao </font><font color="#808080">- </font><font color="#000080">a a&ccedil;&atilde;o a ser realizada
</font><font color="#808080">------------------------------------------------------------------------------*/
</font><font color="#0000FF">procedure </font><font color="#000080">btnAcao</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#000080">sacao</font><font color="#808080">)

</font><font color="#0000FF">if </font><font color="#000080">sreg </font><font color="#808080">= </font><font color="#000080">opAssunto 
   </font><font color="#0000FF">if </font><font color="#000080">sacao </font><font color="#808080">= </font><font color="#000080">opSalvarInclusao
      escreveArq</font><font color="#808080">(</font><font color="#000080">tfAssunto</font><font color="#808080">, </font><font color="#000080">LinhaReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">), </font><font color="#000080">MSG_REGINC</font><font color="#808080">, </font><font color="#000080">MSG_REGNINC</font><font color="#808080">)
   </font><font color="#000080">elseif sacao </font><font color="#808080">= </font><font color="#000080">opSalvarAlteracao
      escreveArq</font><font color="#808080">(</font><font color="#000080">tfAssunto</font><font color="#808080">, </font><font color="#000080">LinhaReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">), </font><font color="#000080">MSG_REGALT</font><font color="#808080">, </font><font color="#000080">MSG_REGNALT</font><font color="#808080">)
   </font><font color="#000080">elseif sacao </font><font color="#808080">= </font><font color="#000080">opConfirmaExclusao
      escreveArq</font><font color="#808080">(</font><font color="#000080">tfAssunto</font><font color="#808080">, </font><font color="#000080">replicate</font><font color="#808080">(</font><font color="#800000">&quot;*&quot;</font><font color="#808080">,</font><font color="#000080">tamReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">)), </font><font color="#000080">MSG_REGEXC</font><font color="#808080">, </font><font color="#000080">MSG_REGNEXC</font><font color="#808080">)
   </font><font color="#0000FF">endif
</font><font color="#000080">elseif sreg </font><font color="#808080">= </font><font color="#000080">opAutor 
   </font><font color="#0000FF">if </font><font color="#000080">sacao </font><font color="#808080">= </font><font color="#000080">opSalvarInclusao
      escreveArq</font><font color="#808080">(</font><font color="#000080">tfAutor</font><font color="#808080">, </font><font color="#000080">LinhaReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">), </font><font color="#000080">MSG_REGINC</font><font color="#808080">, </font><font color="#000080">MSG_REGNINC</font><font color="#808080">)
   </font><font color="#000080">elseif sacao </font><font color="#808080">= </font><font color="#000080">opSalvarAlteracao
      escreveArq</font><font color="#808080">(</font><font color="#000080">tfAutor</font><font color="#808080">, </font><font color="#000080">LinhaReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">), </font><font color="#000080">MSG_REGALT</font><font color="#808080">, </font><font color="#000080">MSG_REGNALT</font><font color="#808080">)
   </font><font color="#000080">elseif sacao </font><font color="#808080">= </font><font color="#000080">opConfirmaExclusao
      escreveArq</font><font color="#808080">(</font><font color="#000080">tfAutor</font><font color="#808080">, </font><font color="#000080">replicate</font><font color="#808080">(</font><font color="#800000">&quot;*&quot;</font><font color="#808080">,</font><font color="#000080">tamReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">)), </font><font color="#000080">MSG_REGEXC</font><font color="#808080">, </font><font color="#000080">MSG_REGNEXC</font><font color="#808080">)
   </font><font color="#0000FF">endif
</font><font color="#000080">elseif sreg </font><font color="#808080">= </font><font color="#000080">opEditora 
   </font><font color="#0000FF">if </font><font color="#000080">sacao </font><font color="#808080">= </font><font color="#000080">opSalvarInclusao
      escreveArq</font><font color="#808080">(</font><font color="#000080">tfEditora</font><font color="#808080">, </font><font color="#000080">LinhaReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">), </font><font color="#000080">MSG_REGINC</font><font color="#808080">, </font><font color="#000080">MSG_REGNINC</font><font color="#808080">)
   </font><font color="#000080">elseif sacao </font><font color="#808080">= </font><font color="#000080">opSalvarAlteracao
      escreveArq</font><font color="#808080">(</font><font color="#000080">tfEditora</font><font color="#808080">, </font><font color="#000080">LinhaReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">), </font><font color="#000080">MSG_REGALT</font><font color="#808080">, </font><font color="#000080">MSG_REGNALT</font><font color="#808080">)
   </font><font color="#000080">elseif sacao </font><font color="#808080">= </font><font color="#000080">opConfirmaExclusao
      escreveArq</font><font color="#808080">(</font><font color="#000080">tfEditora</font><font color="#808080">, </font><font color="#000080">replicate</font><font color="#808080">(</font><font color="#800000">&quot;*&quot;</font><font color="#808080">,</font><font color="#000080">tamReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">)), </font><font color="#000080">MSG_REGEXC</font><font color="#808080">, </font><font color="#000080">MSG_REGNEXC</font><font color="#808080">)
   </font><font color="#0000FF">endif
</font><font color="#000080">elseif sreg </font><font color="#808080">= </font><font color="#000080">opEndereco 
   </font><font color="#0000FF">if </font><font color="#000080">sacao </font><font color="#808080">= </font><font color="#000080">opSalvarInclusao
      escreveArq</font><font color="#808080">(</font><font color="#000080">tfEndereco</font><font color="#808080">, </font><font color="#000080">LinhaReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">), </font><font color="#000080">MSG_REGINC</font><font color="#808080">, </font><font color="#000080">MSG_REGNINC</font><font color="#808080">)
   </font><font color="#000080">elseif sacao </font><font color="#808080">= </font><font color="#000080">opSalvarAlteracao
      escreveArq</font><font color="#808080">(</font><font color="#000080">tfEndereco</font><font color="#808080">, </font><font color="#000080">LinhaReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">), </font><font color="#000080">MSG_REGALT</font><font color="#808080">, </font><font color="#000080">MSG_REGNALT</font><font color="#808080">)
   </font><font color="#000080">elseif sacao </font><font color="#808080">= </font><font color="#000080">opConfirmaExclusao
      escreveArq</font><font color="#808080">(</font><font color="#000080">tfEndereco</font><font color="#808080">, </font><font color="#000080">replicate</font><font color="#808080">(</font><font color="#800000">&quot;*&quot;</font><font color="#808080">,</font><font color="#000080">tamReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">)), </font><font color="#000080">MSG_REGEXC</font><font color="#808080">, </font><font color="#000080">MSG_REGNEXC</font><font color="#808080">)
   </font><font color="#0000FF">endif
</font><font color="#000080">elseif sreg </font><font color="#808080">= </font><font color="#000080">opIdioma 
   </font><font color="#0000FF">if </font><font color="#000080">sacao </font><font color="#808080">= </font><font color="#000080">opSalvarInclusao
      escreveArq</font><font color="#808080">(</font><font color="#000080">tfIdioma</font><font color="#808080">, </font><font color="#000080">LinhaReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">), </font><font color="#000080">MSG_REGINC</font><font color="#808080">, </font><font color="#000080">MSG_REGNINC</font><font color="#808080">)
   </font><font color="#000080">elseif sacao </font><font color="#808080">= </font><font color="#000080">opSalvarAlteracao
      escreveArq</font><font color="#808080">(</font><font color="#000080">tfIdioma</font><font color="#808080">, </font><font color="#000080">LinhaReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">), </font><font color="#000080">MSG_REGALT</font><font color="#808080">, </font><font color="#000080">MSG_REGNALT</font><font color="#808080">)
   </font><font color="#000080">elseif sacao </font><font color="#808080">= </font><font color="#000080">opConfirmaExclusao
      escreveArq</font><font color="#808080">(</font><font color="#000080">tfIdioma</font><font color="#808080">, </font><font color="#000080">replicate</font><font color="#808080">(</font><font color="#800000">&quot;*&quot;</font><font color="#808080">,</font><font color="#000080">tamReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">)), </font><font color="#000080">MSG_REGEXC</font><font color="#808080">, </font><font color="#000080">MSG_REGNEXC</font><font color="#808080">)
   </font><font color="#0000FF">endif
</font><font color="#000080">elseif sreg </font><font color="#808080">= </font><font color="#000080">opPais 
   </font><font color="#0000FF">if </font><font color="#000080">sacao </font><font color="#808080">= </font><font color="#000080">opSalvarInclusao
      escreveArq</font><font color="#808080">(</font><font color="#000080">tfPais</font><font color="#808080">, </font><font color="#000080">LinhaReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">), </font><font color="#000080">MSG_REGINC</font><font color="#808080">, </font><font color="#000080">MSG_REGNINC</font><font color="#808080">)
   </font><font color="#000080">elseif sacao </font><font color="#808080">= </font><font color="#000080">opSalvarAlteracao
      escreveArq</font><font color="#808080">(</font><font color="#000080">tfPais</font><font color="#808080">, </font><font color="#000080">LinhaReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">), </font><font color="#000080">MSG_REGALT</font><font color="#808080">, </font><font color="#000080">MSG_REGNALT</font><font color="#808080">)
   </font><font color="#000080">elseif sacao </font><font color="#808080">= </font><font color="#000080">opConfirmaExclusao
      escreveArq</font><font color="#808080">(</font><font color="#000080">tfPais</font><font color="#808080">, </font><font color="#000080">replicate</font><font color="#808080">(</font><font color="#800000">&quot;*&quot;</font><font color="#808080">,</font><font color="#000080">tamReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">)), </font><font color="#000080">MSG_REGEXC</font><font color="#808080">, </font><font color="#000080">MSG_REGNEXC</font><font color="#808080">)
   </font><font color="#0000FF">endif
</font><font color="#000080">elseif sreg </font><font color="#808080">= </font><font color="#000080">opProfissao 
   </font><font color="#0000FF">if </font><font color="#000080">sacao </font><font color="#808080">= </font><font color="#000080">opSalvarInclusao
      escreveArq</font><font color="#808080">(</font><font color="#000080">tfProfissao</font><font color="#808080">, </font><font color="#000080">LinhaReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">), </font><font color="#000080">MSG_REGINC</font><font color="#808080">, </font><font color="#000080">MSG_REGNINC</font><font color="#808080">)
   </font><font color="#000080">elseif sacao </font><font color="#808080">= </font><font color="#000080">opSalvarAlteracao
      escreveArq</font><font color="#808080">(</font><font color="#000080">tfProfissao</font><font color="#808080">, </font><font color="#000080">LinhaReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">), </font><font color="#000080">MSG_REGALT</font><font color="#808080">, </font><font color="#000080">MSG_REGNALT</font><font color="#808080">)
   </font><font color="#000080">elseif sacao </font><font color="#808080">= </font><font color="#000080">opConfirmaExclusao
      escreveArq</font><font color="#808080">(</font><font color="#000080">tfProfissao</font><font color="#808080">, </font><font color="#000080">replicate</font><font color="#808080">(</font><font color="#800000">&quot;*&quot;</font><font color="#808080">,</font><font color="#000080">tamReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">)), </font><font color="#000080">MSG_REGEXC</font><font color="#808080">, </font><font color="#000080">MSG_REGNEXC</font><font color="#808080">)
   </font><font color="#0000FF">endif
</font><font color="#000080">elseif sreg </font><font color="#808080">= </font><font color="#000080">opLivro 
   </font><font color="#0000FF">if </font><font color="#000080">sacao </font><font color="#808080">= </font><font color="#000080">opSalvarInclusao
      escreveArq</font><font color="#808080">(</font><font color="#000080">tfLivro</font><font color="#808080">, </font><font color="#000080">LinhaReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">), </font><font color="#000080">MSG_REGINC</font><font color="#808080">, </font><font color="#000080">MSG_REGNINC</font><font color="#808080">)
   </font><font color="#000080">elseif sacao </font><font color="#808080">= </font><font color="#000080">opSalvarAlteracao
      escreveArq</font><font color="#808080">(</font><font color="#000080">tfLivro</font><font color="#808080">, </font><font color="#000080">LinhaReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">), </font><font color="#000080">MSG_REGALT</font><font color="#808080">, </font><font color="#000080">MSG_REGNALT</font><font color="#808080">)
   </font><font color="#000080">elseif sacao </font><font color="#808080">= </font><font color="#000080">opConfirmaExclusao
      escreveArq</font><font color="#808080">(</font><font color="#000080">tfLivro</font><font color="#808080">, </font><font color="#000080">replicate</font><font color="#808080">(</font><font color="#800000">&quot;*&quot;</font><font color="#808080">,</font><font color="#000080">tamReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">)), </font><font color="#000080">MSG_REGEXC</font><font color="#808080">, </font><font color="#000080">MSG_REGNEXC</font><font color="#808080">)
   </font><font color="#0000FF">endif
</font><font color="#000080">elseif sreg </font><font color="#808080">= </font><font color="#000080">opLivroAss 
   </font><font color="#0000FF">if </font><font color="#000080">sacao </font><font color="#808080">= </font><font color="#000080">opSalvarInclusao
      escreveArq</font><font color="#808080">(</font><font color="#000080">tfLivroAss</font><font color="#808080">, </font><font color="#000080">LinhaReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">), </font><font color="#000080">MSG_REGINC</font><font color="#808080">, </font><font color="#000080">MSG_REGNINC</font><font color="#808080">)
   </font><font color="#000080">elseif sacao </font><font color="#808080">= </font><font color="#000080">opSalvarAlteracao
      escreveArq</font><font color="#808080">(</font><font color="#000080">tfLivroAss</font><font color="#808080">, </font><font color="#000080">LinhaReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">), </font><font color="#000080">MSG_REGALT</font><font color="#808080">, </font><font color="#000080">MSG_REGNALT</font><font color="#808080">)
   </font><font color="#000080">elseif sacao </font><font color="#808080">= </font><font color="#000080">opConfirmaExclusao
      escreveArq</font><font color="#808080">(</font><font color="#000080">tfLivroAss</font><font color="#808080">, </font><font color="#000080">replicate</font><font color="#808080">(</font><font color="#800000">&quot;*&quot;</font><font color="#808080">,</font><font color="#000080">tamReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">)), </font><font color="#000080">MSG_REGEXC</font><font color="#808080">, </font><font color="#000080">MSG_REGNEXC</font><font color="#808080">)
   </font><font color="#0000FF">endif
</font><font color="#000080">elseif sreg </font><font color="#808080">= </font><font color="#000080">opLivroAut 
   </font><font color="#0000FF">if </font><font color="#000080">sacao </font><font color="#808080">= </font><font color="#000080">opSalvarInclusao
      escreveArq</font><font color="#808080">(</font><font color="#000080">tfLivroAut</font><font color="#808080">, </font><font color="#000080">LinhaReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">), </font><font color="#000080">MSG_REGINC</font><font color="#808080">, </font><font color="#000080">MSG_REGNINC</font><font color="#808080">)
   </font><font color="#000080">elseif sacao </font><font color="#808080">= </font><font color="#000080">opSalvarAlteracao
      escreveArq</font><font color="#808080">(</font><font color="#000080">tfLivroAut</font><font color="#808080">, </font><font color="#000080">LinhaReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">), </font><font color="#000080">MSG_REGALT</font><font color="#808080">, </font><font color="#000080">MSG_REGNALT</font><font color="#808080">)
   </font><font color="#000080">elseif sacao </font><font color="#808080">= </font><font color="#000080">opConfirmaExclusao
      escreveArq</font><font color="#808080">(</font><font color="#000080">tfLivroAut</font><font color="#808080">, </font><font color="#000080">replicate</font><font color="#808080">(</font><font color="#800000">&quot;*&quot;</font><font color="#808080">,</font><font color="#000080">tamReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">)), </font><font color="#000080">MSG_REGEXC</font><font color="#808080">, </font><font color="#000080">MSG_REGNEXC</font><font color="#808080">)
   </font><font color="#0000FF">endif
</font><font color="#000080">elseif sreg </font><font color="#808080">= </font><font color="#000080">opCliente 
   </font><font color="#0000FF">if </font><font color="#000080">sacao </font><font color="#808080">= </font><font color="#000080">opSalvarInclusao
      escreveArq</font><font color="#808080">(</font><font color="#000080">tfCliente</font><font color="#808080">, </font><font color="#000080">LinhaReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">), </font><font color="#000080">MSG_REGINC</font><font color="#808080">, </font><font color="#000080">MSG_REGNINC</font><font color="#808080">)
   </font><font color="#000080">elseif sacao </font><font color="#808080">= </font><font color="#000080">opSalvarAlteracao
      escreveArq</font><font color="#808080">(</font><font color="#000080">tfCliente</font><font color="#808080">, </font><font color="#000080">LinhaReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">), </font><font color="#000080">MSG_REGALT</font><font color="#808080">, </font><font color="#000080">MSG_REGNALT</font><font color="#808080">)
   </font><font color="#000080">elseif sacao </font><font color="#808080">= </font><font color="#000080">opConfirmaExclusao
      escreveArq</font><font color="#808080">(</font><font color="#000080">tfCliente</font><font color="#808080">, </font><font color="#000080">replicate</font><font color="#808080">(</font><font color="#800000">&quot;*&quot;</font><font color="#808080">,</font><font color="#000080">tamReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">)), </font><font color="#000080">MSG_REGEXC</font><font color="#808080">, </font><font color="#000080">MSG_REGNEXC</font><font color="#808080">)
   </font><font color="#0000FF">endif
</font><font color="#000080">elseif sreg </font><font color="#808080">= </font><font color="#000080">opVenda 
   </font><font color="#0000FF">if </font><font color="#000080">sacao </font><font color="#808080">= </font><font color="#000080">opSalvarInclusao
      escreveArq</font><font color="#808080">(</font><font color="#000080">tfVenda</font><font color="#808080">, </font><font color="#000080">LinhaReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">), </font><font color="#000080">MSG_REGINC</font><font color="#808080">, </font><font color="#000080">MSG_REGNINC</font><font color="#808080">)
   </font><font color="#000080">elseif sacao </font><font color="#808080">= </font><font color="#000080">opSalvarAlteracao
      escreveArq</font><font color="#808080">(</font><font color="#000080">tfVenda</font><font color="#808080">, </font><font color="#000080">LinhaReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">), </font><font color="#000080">MSG_REGALT</font><font color="#808080">, </font><font color="#000080">MSG_REGNALT</font><font color="#808080">)
   </font><font color="#000080">elseif sacao </font><font color="#808080">= </font><font color="#000080">opConfirmaExclusao
      escreveArq</font><font color="#808080">(</font><font color="#000080">tfVenda</font><font color="#808080">, </font><font color="#000080">replicate</font><font color="#808080">(</font><font color="#800000">&quot;*&quot;</font><font color="#808080">,</font><font color="#000080">tamReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">)), </font><font color="#000080">MSG_REGEXC</font><font color="#808080">, </font><font color="#000080">MSG_REGNEXC</font><font color="#808080">)
   </font><font color="#0000FF">endif
</font><font color="#000080">elseif sreg </font><font color="#808080">= </font><font color="#000080">opUsuario 
   </font><font color="#0000FF">if </font><font color="#000080">sacao </font><font color="#808080">= </font><font color="#000080">opSalvarAlteracao
      escreveArq</font><font color="#808080">(</font><font color="#000080">tfUsuario</font><font color="#808080">, </font><font color="#000080">LinhaReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">), </font><font color="#000080">MSG_REGALT</font><font color="#808080">, </font><font color="#000080">MSG_REGNALT</font><font color="#808080">)
   </font><font color="#0000FF">endif
endif
return
</font><font color="#808080">/*------------------------------------------------------------------------------
</font><font color="#000080">Seleciona o </font><font color="#0000FF">menu </font><font color="#000080">e</font><font color="#808080">/</font><font color="#000080">ou a tela certa de acordo com o tipo de arquivo</font><font color="#808080">.
</font><font color="#000080">nmenu </font><font color="#808080">- </font><font color="#000080">o n&uacute;mero </font><font color="#0000FF">do menu
</font><font color="#000080">sreg </font><font color="#808080">- </font><font color="#000080">o tipo de arquivo
</font><font color="#808080">------------------------------------------------------------------------------*/
</font><font color="#0000FF">procedure </font><font color="#000080">subMenu</font><font color="#808080">(</font><font color="#000080">nmenu</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">)
</font><font color="#0000FF">local </font><font color="#000080">opSubMenu</font><font color="#808080">, </font><font color="#000080">opCSubMenu</font><font color="#808080">, </font><font color="#000080">bSOp

bSOp</font><font color="#808080">:=.t.
</font><font color="#0000FF">do case
 case </font><font color="#000080">nmenu </font><font color="#808080">= </font><font color="#FF0000">6
    </font><font color="#0000FF">do while</font><font color="#808080">(</font><font color="#000080">bSOp</font><font color="#808080">)    
     </font><font color="#0000FF">accept menu</font><font color="#808080">(</font><font color="#000080">nmenu</font><font color="#808080">) </font><font color="#0000FF">to </font><font color="#000080">opSubMenu
     </font><font color="#0000FF">do case
        case </font><font color="#000080">opSubMenu </font><font color="#808080">= </font><font color="#800000">&quot;1&quot; 
          </font><font color="#000080">frmCadastros</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#000080">opNovo</font><font color="#808080">)
        </font><font color="#0000FF">case </font><font color="#000080">opSubMenu </font><font color="#808080">= </font><font color="#800000">&quot;2&quot; 
          </font><font color="#000080">frmCadastros</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#000080">opPesquisar</font><font color="#808080">)
        </font><font color="#0000FF">case </font><font color="#000080">opSubMenu </font><font color="#808080">= </font><font color="#800000">&quot;3&quot; 
          </font><font color="#000080">bSOp</font><font color="#808080">:=.f.
        </font><font color="#0000FF">otherwise 
          </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#000080">MSG_ERRO</font><font color="#808080">)
     </font><font color="#0000FF">endcase
    enddo
 case </font><font color="#000080">nmenu </font><font color="#808080">= </font><font color="#FF0000">7
    </font><font color="#0000FF">do while</font><font color="#808080">(</font><font color="#000080">bSOp</font><font color="#808080">)    
     </font><font color="#0000FF">accept menu</font><font color="#808080">(</font><font color="#000080">nmenu</font><font color="#808080">) </font><font color="#0000FF">to </font><font color="#000080">opSubMenu
     </font><font color="#0000FF">do case
        case </font><font color="#000080">opSubMenu </font><font color="#808080">= </font><font color="#800000">&quot;1&quot;  
          </font><font color="#000080">btnAcao</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#000080">opSalvarInclusao</font><font color="#808080">) 
          </font><font color="#000080">bSOp</font><font color="#808080">:=.f.
        </font><font color="#0000FF">case </font><font color="#000080">opSubMenu </font><font color="#808080">= </font><font color="#800000">&quot;2&quot;
          </font><font color="#000080">bSOp</font><font color="#808080">:=.f.
        </font><font color="#0000FF">otherwise
          </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#000080">MSG_ERRO</font><font color="#808080">)
     </font><font color="#0000FF">endcase
    enddo
 case </font><font color="#000080">nmenu </font><font color="#808080">= </font><font color="#FF0000">8
    </font><font color="#0000FF">do while</font><font color="#808080">(</font><font color="#000080">bSOp</font><font color="#808080">)    
     </font><font color="#0000FF">accept menu</font><font color="#808080">(</font><font color="#000080">nmenu</font><font color="#808080">) </font><font color="#0000FF">to </font><font color="#000080">opSubMenu
     </font><font color="#0000FF">do case
        case </font><font color="#000080">opSubMenu </font><font color="#808080">= </font><font color="#800000">&quot;1&quot;  
          </font><font color="#000080">frmCadastros</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#000080">opAlterar</font><font color="#808080">) 
          </font><font color="#000080">bSOp</font><font color="#808080">:=.f.
        </font><font color="#0000FF">case </font><font color="#000080">opSubMenu </font><font color="#808080">= </font><font color="#800000">&quot;2&quot; 
          </font><font color="#000080">frmCadastros</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#000080">opExcluir</font><font color="#808080">) 
          </font><font color="#000080">bSOp</font><font color="#808080">:=.f.
        </font><font color="#0000FF">case </font><font color="#000080">opSubMenu </font><font color="#808080">= </font><font color="#800000">&quot;3&quot; 
          </font><font color="#000080">bSOp</font><font color="#808080">:=.f.
        </font><font color="#0000FF">otherwise 
          </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#000080">MSG_ERRO</font><font color="#808080">)
     </font><font color="#0000FF">endcase
    enddo
 case </font><font color="#000080">nmenu </font><font color="#808080">= </font><font color="#FF0000">9
    </font><font color="#0000FF">do while</font><font color="#808080">(</font><font color="#000080">bSOp</font><font color="#808080">)    
     </font><font color="#0000FF">accept menu</font><font color="#808080">(</font><font color="#000080">nmenu</font><font color="#808080">) </font><font color="#0000FF">to </font><font color="#000080">opSubMenu
     </font><font color="#0000FF">do case
        case </font><font color="#000080">opSubMenu </font><font color="#808080">= </font><font color="#800000">&quot;1&quot;  
          </font><font color="#000080">btnAcao</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#000080">opSalvarAlteracao</font><font color="#808080">) 
          </font><font color="#000080">bSOp</font><font color="#808080">:=.f.
        </font><font color="#0000FF">case </font><font color="#000080">opSubMenu </font><font color="#808080">= </font><font color="#800000">&quot;2&quot; 
          </font><font color="#000080">bSOp</font><font color="#808080">:=.f.
        </font><font color="#0000FF">otherwise 
          </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#000080">MSG_ERRO</font><font color="#808080">)
     </font><font color="#0000FF">endcase
    enddo
 case </font><font color="#000080">nmenu </font><font color="#808080">= </font><font color="#FF0000">10
    </font><font color="#0000FF">do while</font><font color="#808080">(</font><font color="#000080">bSOp</font><font color="#808080">)      
       </font><font color="#0000FF">accept menu</font><font color="#808080">(</font><font color="#000080">nmenu</font><font color="#808080">) </font><font color="#0000FF">to </font><font color="#000080">opCSubMenu
       </font><font color="#0000FF">if </font><font color="#808080">(</font><font color="#000080">opCSubMenu</font><font color="#808080">=</font><font color="#800000">&quot;S&quot;</font><font color="#808080">) .or. (</font><font color="#000080">opCSubMenu</font><font color="#808080">=</font><font color="#800000">&quot;s&quot;</font><font color="#808080">) 
          </font><font color="#000080">btnAcao</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#000080">opConfirmaExclusao</font><font color="#808080">)
          </font><font color="#000080">bSOp</font><font color="#808080">:=.f.
       </font><font color="#000080">elseif </font><font color="#808080">(</font><font color="#000080">opCSubMenu</font><font color="#808080">=</font><font color="#800000">&quot;N&quot;</font><font color="#808080">) .or. (</font><font color="#000080">opCSubMenu</font><font color="#808080">=</font><font color="#800000">&quot;n&quot;</font><font color="#808080">) 
          </font><font color="#000080">bSOp</font><font color="#808080">:=.f.
       </font><font color="#0000FF">else 
          </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#000080">MSG_ERRO</font><font color="#808080">)
       </font><font color="#0000FF">endif
    enddo
 case </font><font color="#000080">nmenu </font><font color="#808080">= </font><font color="#FF0000">12
    </font><font color="#0000FF">do while</font><font color="#808080">(</font><font color="#000080">bSOp</font><font color="#808080">)    
     </font><font color="#0000FF">accept menu</font><font color="#808080">(</font><font color="#000080">nmenu</font><font color="#808080">) </font><font color="#0000FF">to </font><font color="#000080">opSubMenu
     </font><font color="#0000FF">do case
        case </font><font color="#000080">opSubMenu </font><font color="#808080">= </font><font color="#800000">&quot;1&quot; 
          </font><font color="#000080">frmConsultas</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#000080">opPesquisar</font><font color="#808080">)
        </font><font color="#0000FF">case </font><font color="#000080">opSubMenu </font><font color="#808080">= </font><font color="#800000">&quot;2&quot;
          </font><font color="#000080">frmConsultas</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#000080">opListarTodos</font><font color="#808080">)
        </font><font color="#0000FF">case </font><font color="#000080">opSubMenu </font><font color="#808080">= </font><font color="#800000">&quot;3&quot; 
          </font><font color="#000080">bSOp</font><font color="#808080">:=.f.
        </font><font color="#0000FF">otherwise 
          </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#000080">MSG_ERRO</font><font color="#808080">)
     </font><font color="#0000FF">endcase
    enddo
 case </font><font color="#000080">nmenu </font><font color="#808080">= </font><font color="#FF0000">14
    </font><font color="#0000FF">do while</font><font color="#808080">(</font><font color="#000080">bSOp</font><font color="#808080">)    
     </font><font color="#0000FF">accept menu</font><font color="#808080">(</font><font color="#000080">nmenu</font><font color="#808080">) </font><font color="#0000FF">to </font><font color="#000080">opCSubMenu
     </font><font color="#0000FF">if </font><font color="#808080">(</font><font color="#000080">opCSubMenu</font><font color="#808080">=</font><font color="#800000">&quot;S&quot;</font><font color="#808080">) .or. (</font><font color="#000080">opCSubMenu</font><font color="#808080">=</font><font color="#800000">&quot;s&quot;</font><font color="#808080">) 
        </font><font color="#000080">btnAcao</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#000080">opSalvarInclusao</font><font color="#808080">)
        </font><font color="#000080">bSOp</font><font color="#808080">:=.f.
        </font><font color="#000080">g_SalvarInclusao</font><font color="#808080">:=.t.
     </font><font color="#000080">elseif </font><font color="#808080">(</font><font color="#000080">opCSubMenu</font><font color="#808080">=</font><font color="#800000">&quot;N&quot;</font><font color="#808080">) .or. (</font><font color="#000080">opCSubMenu</font><font color="#808080">=</font><font color="#800000">&quot;n&quot;</font><font color="#808080">) 
       </font><font color="#000080">bSOp</font><font color="#808080">:=.f.
     </font><font color="#0000FF">else 
       </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#000080">MSG_ERRO</font><font color="#808080">)
     </font><font color="#0000FF">endif 
    enddo
endcase

return
</font><font color="#808080">/*------------------------------------------------------------------------------
</font><font color="#000080">Seleciona o submenu e</font><font color="#808080">/</font><font color="#000080">ou a tela certa de acordo com n&uacute;mero </font><font color="#0000FF">do menu</font><font color="#808080">.
</font><font color="#000080">nmenu </font><font color="#808080">- </font><font color="#000080">o n&uacute;mero </font><font color="#0000FF">do menu
</font><font color="#808080">------------------------------------------------------------------------------*/
</font><font color="#0000FF">procedure </font><font color="#000080">usaMenu</font><font color="#808080">(</font><font color="#000080">num</font><font color="#808080">)
</font><font color="#0000FF">local </font><font color="#000080">opSubMenu</font><font color="#808080">, </font><font color="#000080">bSOp</font><font color="#808080">, </font><font color="#000080">opSair

 bSOp</font><font color="#808080">:=.t.
 </font><font color="#0000FF">if </font><font color="#000080">num </font><font color="#808080">= </font><font color="#FF0000">1  </font><font color="#808080">/* </font><font color="#000080">Cadastros </font><font color="#808080">*/
   </font><font color="#0000FF">do while</font><font color="#808080">(</font><font color="#000080">bSOp</font><font color="#808080">)    
     </font><font color="#0000FF">accept menu</font><font color="#808080">(</font><font color="#FF0000">2</font><font color="#808080">) </font><font color="#0000FF">to </font><font color="#000080">opSubMenu
     </font><font color="#0000FF">do case
      case </font><font color="#000080">opSubMenu </font><font color="#808080">== </font><font color="#800000">&quot;1&quot; 
        </font><font color="#000080">subMenu</font><font color="#808080">(</font><font color="#FF0000">6</font><font color="#808080">, </font><font color="#000080">opAssunto</font><font color="#808080">)
      </font><font color="#0000FF">case </font><font color="#000080">opSubMenu </font><font color="#808080">== </font><font color="#800000">&quot;2&quot; 
        </font><font color="#000080">subMenu</font><font color="#808080">(</font><font color="#FF0000">6</font><font color="#808080">, </font><font color="#000080">opAutor</font><font color="#808080">)
      </font><font color="#0000FF">case </font><font color="#000080">opSubMenu </font><font color="#808080">== </font><font color="#800000">&quot;3&quot; 
        </font><font color="#000080">subMenu</font><font color="#808080">(</font><font color="#FF0000">6</font><font color="#808080">, </font><font color="#000080">opEditora</font><font color="#808080">)
      </font><font color="#0000FF">case </font><font color="#000080">opSubMenu </font><font color="#808080">== </font><font color="#800000">&quot;4&quot; 
        </font><font color="#000080">subMenu</font><font color="#808080">(</font><font color="#FF0000">6</font><font color="#808080">, </font><font color="#000080">opEndereco</font><font color="#808080">)
      </font><font color="#0000FF">case </font><font color="#000080">opSubMenu </font><font color="#808080">== </font><font color="#800000">&quot;5&quot; 
        </font><font color="#000080">subMenu</font><font color="#808080">(</font><font color="#FF0000">6</font><font color="#808080">, </font><font color="#000080">opIdioma</font><font color="#808080">)
      </font><font color="#0000FF">case </font><font color="#000080">opSubMenu </font><font color="#808080">== </font><font color="#800000">&quot;6&quot; 
        </font><font color="#000080">subMenu</font><font color="#808080">(</font><font color="#FF0000">6</font><font color="#808080">, </font><font color="#000080">opPais</font><font color="#808080">)
      </font><font color="#0000FF">case </font><font color="#000080">opSubMenu </font><font color="#808080">== </font><font color="#800000">&quot;7&quot; 
        </font><font color="#000080">subMenu</font><font color="#808080">(</font><font color="#FF0000">6</font><font color="#808080">, </font><font color="#000080">opProfissao</font><font color="#808080">)
      </font><font color="#0000FF">case </font><font color="#000080">opSubMenu </font><font color="#808080">== </font><font color="#800000">&quot;8&quot; 
        </font><font color="#000080">subMenu</font><font color="#808080">(</font><font color="#FF0000">6</font><font color="#808080">, </font><font color="#000080">opCliente</font><font color="#808080">)
      </font><font color="#0000FF">case </font><font color="#000080">opSubMenu </font><font color="#808080">== </font><font color="#800000">&quot;9&quot; 
        </font><font color="#000080">subMenu</font><font color="#808080">(</font><font color="#FF0000">6</font><font color="#808080">, </font><font color="#000080">opLivro</font><font color="#808080">)
      </font><font color="#0000FF">case </font><font color="#000080">opSubMenu </font><font color="#808080">== </font><font color="#800000">&quot;10&quot; 
        </font><font color="#000080">bSOp</font><font color="#808080">:=.f.
      </font><font color="#0000FF">otherwise 
        </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#000080">MSG_ERRO</font><font color="#808080">)
     </font><font color="#0000FF">endcase
   enddo
 </font><font color="#000080">elseif num </font><font color="#808080">= </font><font color="#FF0000">2  </font><font color="#808080">/* </font><font color="#000080">Pesquisas </font><font color="#808080">*/
   </font><font color="#0000FF">do while</font><font color="#808080">(</font><font color="#000080">bSOp</font><font color="#808080">)    
     </font><font color="#0000FF">accept menu</font><font color="#808080">(</font><font color="#FF0000">3</font><font color="#808080">) </font><font color="#0000FF">to </font><font color="#000080">opSubMenu
     </font><font color="#0000FF">do case
      case </font><font color="#000080">opSubMenu </font><font color="#808080">== </font><font color="#800000">&quot;1&quot; 
        </font><font color="#000080">subMenu</font><font color="#808080">(</font><font color="#FF0000">12</font><font color="#808080">, </font><font color="#000080">opAssunto</font><font color="#808080">)
      </font><font color="#0000FF">case </font><font color="#000080">opSubMenu </font><font color="#808080">== </font><font color="#800000">&quot;2&quot; 
        </font><font color="#000080">subMenu</font><font color="#808080">(</font><font color="#FF0000">12</font><font color="#808080">, </font><font color="#000080">opAutor</font><font color="#808080">)
      </font><font color="#0000FF">case </font><font color="#000080">opSubMenu </font><font color="#808080">== </font><font color="#800000">&quot;3&quot; 
        </font><font color="#000080">subMenu</font><font color="#808080">(</font><font color="#FF0000">12</font><font color="#808080">, </font><font color="#000080">opEditora</font><font color="#808080">)
      </font><font color="#0000FF">case </font><font color="#000080">opSubMenu </font><font color="#808080">== </font><font color="#800000">&quot;4&quot; 
        </font><font color="#000080">subMenu</font><font color="#808080">(</font><font color="#FF0000">12</font><font color="#808080">, </font><font color="#000080">opEndereco</font><font color="#808080">)
      </font><font color="#0000FF">case </font><font color="#000080">opSubMenu </font><font color="#808080">== </font><font color="#800000">&quot;5&quot; 
        </font><font color="#000080">subMenu</font><font color="#808080">(</font><font color="#FF0000">12</font><font color="#808080">, </font><font color="#000080">opIdioma</font><font color="#808080">)
      </font><font color="#0000FF">case </font><font color="#000080">opSubMenu </font><font color="#808080">== </font><font color="#800000">&quot;6&quot; 
        </font><font color="#000080">subMenu</font><font color="#808080">(</font><font color="#FF0000">12</font><font color="#808080">, </font><font color="#000080">opPais</font><font color="#808080">)
      </font><font color="#0000FF">case </font><font color="#000080">opSubMenu </font><font color="#808080">== </font><font color="#800000">&quot;7&quot; 
        </font><font color="#000080">subMenu</font><font color="#808080">(</font><font color="#FF0000">12</font><font color="#808080">, </font><font color="#000080">opProfissao</font><font color="#808080">)
      </font><font color="#0000FF">case </font><font color="#000080">opSubMenu </font><font color="#808080">== </font><font color="#800000">&quot;8&quot; 
        </font><font color="#000080">subMenu</font><font color="#808080">(</font><font color="#FF0000">12</font><font color="#808080">, </font><font color="#000080">opCliente</font><font color="#808080">)
      </font><font color="#0000FF">case </font><font color="#000080">opSubMenu </font><font color="#808080">== </font><font color="#800000">&quot;9&quot; 
        </font><font color="#000080">subMenu</font><font color="#808080">(</font><font color="#FF0000">12</font><font color="#808080">, </font><font color="#000080">opLivro</font><font color="#808080">)
      </font><font color="#0000FF">case </font><font color="#000080">opSubMenu </font><font color="#808080">== </font><font color="#800000">&quot;10&quot; 
        </font><font color="#000080">bSOp</font><font color="#808080">:=.f.
      </font><font color="#0000FF">otherwise 
        </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#000080">MSG_ERRO</font><font color="#808080">)
     </font><font color="#0000FF">endcase
   enddo
 </font><font color="#000080">elseif num </font><font color="#808080">= </font><font color="#FF0000">3  </font><font color="#808080">/* </font><font color="#000080">Vendas </font><font color="#808080">*/
   </font><font color="#0000FF">do while</font><font color="#808080">(</font><font color="#000080">bSOp</font><font color="#808080">)    
     </font><font color="#0000FF">accept menu</font><font color="#808080">(</font><font color="#FF0000">4</font><font color="#808080">) </font><font color="#0000FF">to </font><font color="#000080">opSubMenu
     </font><font color="#0000FF">do case
      case </font><font color="#000080">opSubMenu </font><font color="#808080">== </font><font color="#800000">&quot;1&quot; 
        </font><font color="#000080">subMenu</font><font color="#808080">(</font><font color="#FF0000">6</font><font color="#808080">, </font><font color="#000080">opVenda</font><font color="#808080">)
      </font><font color="#0000FF">case </font><font color="#000080">opSubMenu </font><font color="#808080">== </font><font color="#800000">&quot;2&quot; 
        </font><font color="#000080">subMenu</font><font color="#808080">(</font><font color="#FF0000">12</font><font color="#808080">, </font><font color="#000080">opVenda</font><font color="#808080">)
      </font><font color="#0000FF">case </font><font color="#000080">opSubMenu </font><font color="#808080">== </font><font color="#800000">&quot;3&quot;
        </font><font color="#000080">bSOp</font><font color="#808080">:=.f.
      </font><font color="#0000FF">otherwise
        </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#000080">MSG_ERRO</font><font color="#808080">)
     </font><font color="#0000FF">endcase
   enddo
 </font><font color="#000080">elseif num </font><font color="#808080">= </font><font color="#FF0000">4  </font><font color="#808080">/* </font><font color="#000080">Opcoes </font><font color="#808080">*/
   </font><font color="#0000FF">do while</font><font color="#808080">(</font><font color="#000080">bSOp</font><font color="#808080">)    
     </font><font color="#0000FF">accept menu</font><font color="#808080">(</font><font color="#FF0000">5</font><font color="#808080">) </font><font color="#0000FF">to </font><font color="#000080">opSubMenu
     </font><font color="#0000FF">do case
      case </font><font color="#000080">opSubMenu </font><font color="#808080">== </font><font color="#800000">&quot;1&quot;
        </font><font color="#000080">frmAlterarSenha</font><font color="#808080">()
      </font><font color="#0000FF">case </font><font color="#000080">opSubMenu </font><font color="#808080">== </font><font color="#800000">&quot;2&quot;
        </font><font color="#000080">frmSobre</font><font color="#808080">()
      </font><font color="#0000FF">case </font><font color="#000080">opSubMenu </font><font color="#808080">== </font><font color="#800000">&quot;3&quot;          
           </font><font color="#0000FF">accept menu</font><font color="#808080">(</font><font color="#FF0000">11</font><font color="#808080">) </font><font color="#0000FF">to </font><font color="#000080">opSair
           </font><font color="#0000FF">if </font><font color="#808080">(</font><font color="#000080">opSair</font><font color="#808080">=</font><font color="#800000">&quot;S&quot;</font><font color="#808080">) .or. (</font><font color="#000080">opSair</font><font color="#808080">=</font><font color="#800000">&quot;s&quot;</font><font color="#808080">) 
              </font><font color="#000080">fechaArqs</font><font color="#808080">()
              </font><font color="#0000FF">quit
           endif
      case </font><font color="#000080">opSubMenu </font><font color="#808080">== </font><font color="#800000">&quot;4&quot;
        </font><font color="#000080">bSOp</font><font color="#808080">:=.f.
      </font><font color="#0000FF">otherwise 
        </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#000080">MSG_ERRO</font><font color="#808080">)
     </font><font color="#0000FF">endcase
   enddo
 endif
return
</font><font color="#808080">/*------------------------------------------------------------------------------
</font><font color="#000080">Mostra as entradas e as sa&iacute;das </font><font color="#0000FF">do </font><font color="#000080">sistema</font><font color="#808080">.
</font><font color="#000080">sreg </font><font color="#808080">- </font><font color="#000080">o tipo de arquivo
slinha </font><font color="#808080">- </font><font color="#000080">o registro com os dados
nOpcao </font><font color="#808080">- </font><font color="#000080">indica qual op&ccedil;&atilde;o ser&aacute; mostrada
</font><font color="#808080">------------------------------------------------------------------------------*/
</font><font color="#0000FF">procedure </font><font color="#000080">mostrarDados</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#000080">nOpcao</font><font color="#808080">)

</font><font color="#0000FF">if </font><font color="#000080">sreg </font><font color="#808080">= </font><font color="#000080">opAssunto 
   </font><font color="#0000FF">do case
    case </font><font color="#000080">nOpcao </font><font color="#808080">= </font><font color="#FF0000">1
        </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">)+ </font><font color="#000080">tAssunto_codigo</font><font color="#808080">)
        </font><font color="#0000FF">accept </font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">) </font><font color="#0000FF">to </font><font color="#000080">tAssunto_assunto
    </font><font color="#0000FF">case </font><font color="#000080">nOpcao </font><font color="#808080">= </font><font color="#FF0000">2
        </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#800000">&quot;C&oacute;digo     Assunto&quot;</font><font color="#808080">)
        </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#800000">&quot;------     -------&quot;</font><font color="#808080">)
    </font><font color="#0000FF">case </font><font color="#000080">nOpcao </font><font color="#808080">= </font><font color="#FF0000">3
        </font><font color="#000080">tAssunto_codigo</font><font color="#808080">:=</font><font color="#000080">substr</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">)
        </font><font color="#000080">tAssunto_assunto</font><font color="#808080">:=</font><font color="#000080">substr</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">11</font><font color="#808080">, </font><font color="#FF0000">30</font><font color="#808080">)
        </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#000080">tAssunto_codigo</font><font color="#808080">+</font><font color="#800000">&quot; &quot;</font><font color="#808080">+</font><font color="#000080">tAssunto_assunto</font><font color="#808080">)
   </font><font color="#0000FF">endcase
</font><font color="#000080">elseif sreg </font><font color="#808080">= </font><font color="#000080">opAutor 
   </font><font color="#0000FF">do case
    case </font><font color="#000080">nOpcao </font><font color="#808080">= </font><font color="#FF0000">1 
        </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">)+ </font><font color="#000080">tAutor_codigo</font><font color="#808080">)
        </font><font color="#0000FF">accept </font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">) </font><font color="#0000FF">to </font><font color="#000080">tAutor_autor
    </font><font color="#0000FF">case </font><font color="#000080">nOpcao </font><font color="#808080">= </font><font color="#FF0000">2
        </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#800000">&quot;C&oacute;digo     Autor&quot;</font><font color="#808080">)
        </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#800000">&quot;------     -----&quot;</font><font color="#808080">)
    </font><font color="#0000FF">case </font><font color="#000080">nOpcao </font><font color="#808080">= </font><font color="#FF0000">3
        </font><font color="#000080">tAutor_codigo</font><font color="#808080">:=</font><font color="#000080">substr</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">)
        </font><font color="#000080">tAutor_autor</font><font color="#808080">:=</font><font color="#000080">substr</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">11</font><font color="#808080">, </font><font color="#FF0000">30</font><font color="#808080">)
        </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#000080">tAutor_codigo</font><font color="#808080">+</font><font color="#800000">&quot; &quot;</font><font color="#808080">+</font><font color="#000080">tAutor_autor</font><font color="#808080">)
   </font><font color="#0000FF">endcase
</font><font color="#000080">elseif sreg </font><font color="#808080">= </font><font color="#000080">opEditora 
   </font><font color="#0000FF">do case
    case </font><font color="#000080">nOpcao </font><font color="#808080">= </font><font color="#FF0000">1 
        </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">)+ </font><font color="#000080">tEditora_codigo</font><font color="#808080">)
        </font><font color="#0000FF">accept </font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">) </font><font color="#0000FF">to </font><font color="#000080">tEditora_editora
    </font><font color="#0000FF">case </font><font color="#000080">nOpcao </font><font color="#808080">= </font><font color="#FF0000">2 
        </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#800000">&quot;C&oacute;digo     Editora&quot;</font><font color="#808080">)
        </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#800000">&quot;------     -------&quot;</font><font color="#808080">)
    </font><font color="#0000FF">case </font><font color="#000080">nOpcao </font><font color="#808080">= </font><font color="#FF0000">3 
        </font><font color="#000080">tEditora_codigo</font><font color="#808080">:=</font><font color="#000080">substr</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">)
        </font><font color="#000080">tEditora_editora</font><font color="#808080">:=</font><font color="#000080">substr</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">11</font><font color="#808080">, </font><font color="#FF0000">50</font><font color="#808080">)
        </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#000080">tEditora_codigo</font><font color="#808080">+</font><font color="#800000">&quot; &quot;</font><font color="#808080">+</font><font color="#000080">tEditora_editora</font><font color="#808080">)     
   </font><font color="#0000FF">endcase
</font><font color="#000080">elseif sreg </font><font color="#808080">= </font><font color="#000080">opEndereco 
   </font><font color="#0000FF">do case
    case </font><font color="#000080">nOpcao </font><font color="#808080">= </font><font color="#FF0000">1 
        </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">)+ </font><font color="#000080">tEnd_codigo</font><font color="#808080">)
        </font><font color="#0000FF">accept </font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">) </font><font color="#0000FF">to </font><font color="#000080">tEnd_Logradouro
        </font><font color="#0000FF">accept </font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">) </font><font color="#0000FF">to </font><font color="#000080">tEnd_bairro
        input rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">4</font><font color="#808080">) </font><font color="#0000FF">to </font><font color="#000080">tEnd_cep
        </font><font color="#0000FF">accept </font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">5</font><font color="#808080">) </font><font color="#0000FF">to </font><font color="#000080">tEnd_cidade
        </font><font color="#0000FF">accept </font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">6</font><font color="#808080">) </font><font color="#0000FF">to </font><font color="#000080">tEnd_estado
    </font><font color="#0000FF">case </font><font color="#000080">nOpcao </font><font color="#808080">= </font><font color="#FF0000">3 
        </font><font color="#000080">tEnd_codigo</font><font color="#808080">:=</font><font color="#0000FF">alltrim</font><font color="#808080">(</font><font color="#000080">substr</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">))
        </font><font color="#000080">tEnd_logradouro</font><font color="#808080">:=</font><font color="#0000FF">alltrim</font><font color="#808080">(</font><font color="#000080">substr</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">11</font><font color="#808080">, </font><font color="#FF0000">40</font><font color="#808080">))
        </font><font color="#000080">tEnd_bairro</font><font color="#808080">:=</font><font color="#0000FF">alltrim</font><font color="#808080">(</font><font color="#000080">substr</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">51</font><font color="#808080">, </font><font color="#FF0000">15</font><font color="#808080">))
        </font><font color="#000080">tEnd_cep</font><font color="#808080">:=</font><font color="#0000FF">alltrim</font><font color="#808080">(</font><font color="#000080">substr</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">66</font><font color="#808080">, </font><font color="#FF0000">8</font><font color="#808080">))
        </font><font color="#000080">tEnd_cidade</font><font color="#808080">:=</font><font color="#0000FF">alltrim</font><font color="#808080">(</font><font color="#000080">substr</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">74</font><font color="#808080">, </font><font color="#FF0000">30</font><font color="#808080">))
        </font><font color="#000080">tEnd_estado</font><font color="#808080">:=</font><font color="#0000FF">alltrim</font><font color="#808080">(</font><font color="#000080">substr</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">104</font><font color="#808080">, </font><font color="#FF0000">20</font><font color="#808080">))
        </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#800000">&quot;--------------------&quot;</font><font color="#808080">)
        </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">)+ </font><font color="#000080">tEnd_codigo</font><font color="#808080">)
        </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">)+ </font><font color="#000080">tEnd_Logradouro</font><font color="#808080">)
        </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">)+ </font><font color="#000080">tEnd_bairro</font><font color="#808080">)
        </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">4</font><font color="#808080">)+ </font><font color="#000080">tEnd_cep</font><font color="#808080">)
        </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">5</font><font color="#808080">)+ </font><font color="#000080">tEnd_cidade</font><font color="#808080">)
        </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">6</font><font color="#808080">)+ </font><font color="#000080">tEnd_estado</font><font color="#808080">)
   </font><font color="#0000FF">endcase
</font><font color="#000080">elseif sreg </font><font color="#808080">= </font><font color="#000080">opIdioma 
   </font><font color="#0000FF">do case
    case </font><font color="#000080">nOpcao </font><font color="#808080">= </font><font color="#FF0000">1 
        </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">)+ </font><font color="#000080">tIdioma_codigo</font><font color="#808080">)
        </font><font color="#0000FF">accept </font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">) </font><font color="#0000FF">to </font><font color="#000080">tIdioma_idioma
    </font><font color="#0000FF">case </font><font color="#000080">nOpcao </font><font color="#808080">= </font><font color="#FF0000">2 
        </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#800000">&quot;C&oacute;digo     Idioma&quot;</font><font color="#808080">)
        </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#800000">&quot;------     ------&quot;</font><font color="#808080">)
    </font><font color="#0000FF">case </font><font color="#000080">nOpcao </font><font color="#808080">= </font><font color="#FF0000">3
        </font><font color="#000080">tIdioma_codigo</font><font color="#808080">:=</font><font color="#000080">substr</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">)
        </font><font color="#000080">tIdioma_idioma</font><font color="#808080">:=</font><font color="#000080">substr</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">11</font><font color="#808080">, </font><font color="#FF0000">20</font><font color="#808080">)
        </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#000080">tIdioma_codigo</font><font color="#808080">+</font><font color="#800000">&quot; &quot;</font><font color="#808080">+</font><font color="#000080">tIdioma_idioma</font><font color="#808080">)
   </font><font color="#0000FF">endcase
</font><font color="#000080">elseif sreg </font><font color="#808080">= </font><font color="#000080">opPais 
   </font><font color="#0000FF">do case
    case </font><font color="#000080">nOpcao </font><font color="#808080">= </font><font color="#FF0000">1 
        </font><font color="#0000FF">accept </font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">) </font><font color="#0000FF">to </font><font color="#000080">tPais_pais
    </font><font color="#0000FF">case </font><font color="#000080">nOpcao </font><font color="#808080">= </font><font color="#FF0000">2 
        </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#800000">&quot;C&oacute;digo Pa&iacute;s&quot;</font><font color="#808080">)
        </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#800000">&quot;------ ----&quot;</font><font color="#808080">)
    </font><font color="#0000FF">case </font><font color="#000080">nOpcao </font><font color="#808080">= </font><font color="#FF0000">3 
        </font><font color="#000080">tPais_codigo</font><font color="#808080">:=</font><font color="#000080">substr</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">)
        </font><font color="#000080">tPais_pais</font><font color="#808080">:=</font><font color="#000080">substr</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">4</font><font color="#808080">, </font><font color="#FF0000">50</font><font color="#808080">)
        </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#000080">tPais_codigo</font><font color="#808080">+</font><font color="#800000">&quot;    &quot;</font><font color="#808080">+</font><font color="#000080">tPais_pais</font><font color="#808080">)
   </font><font color="#0000FF">endcase
</font><font color="#000080">elseif sreg </font><font color="#808080">= </font><font color="#000080">opProfissao 
   </font><font color="#0000FF">do case
    case </font><font color="#000080">nOpcao </font><font color="#808080">= </font><font color="#FF0000">1 
        </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">)+ </font><font color="#000080">tProfiss_codigo</font><font color="#808080">)
        </font><font color="#0000FF">accept </font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">) </font><font color="#0000FF">to </font><font color="#000080">tProfiss_profissao
    </font><font color="#0000FF">case </font><font color="#000080">nOpcao </font><font color="#808080">= </font><font color="#FF0000">2 
        </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#800000">&quot;C&oacute;digo     Profiss&atilde;o&quot;</font><font color="#808080">)
        </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#800000">&quot;------     ---------&quot;</font><font color="#808080">)
    </font><font color="#0000FF">case </font><font color="#000080">nOpcao </font><font color="#808080">= </font><font color="#FF0000">3 
        </font><font color="#000080">tProfiss_codigo</font><font color="#808080">:=</font><font color="#000080">substr</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">)
        </font><font color="#000080">tProfiss_profissao</font><font color="#808080">:=</font><font color="#000080">substr</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">11</font><font color="#808080">, </font><font color="#FF0000">50</font><font color="#808080">)
        </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#000080">tProfiss_codigo</font><font color="#808080">+</font><font color="#800000">&quot; &quot;</font><font color="#808080">+</font><font color="#000080">tProfiss_profissao</font><font color="#808080">)
   </font><font color="#0000FF">endcase
</font><font color="#000080">elseif sreg </font><font color="#808080">= </font><font color="#000080">opLivro 
   </font><font color="#0000FF">do case
    case </font><font color="#000080">nOpcao </font><font color="#808080">= </font><font color="#FF0000">1 
        </font><font color="#0000FF">accept </font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">) </font><font color="#0000FF">to </font><font color="#000080">tLiv_titulo
        tLiv_edicao</font><font color="#808080">:=</font><font color="#000080">validaNumero</font><font color="#808080">(</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">), </font><font color="#000080">tLiv_edicao</font><font color="#808080">)
        </font><font color="#000080">tLiv_anopubli</font><font color="#808080">:=</font><font color="#000080">validaNumero</font><font color="#808080">(</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">4</font><font color="#808080">), </font><font color="#000080">tLiv_anopubli</font><font color="#808080">)
        </font><font color="#000080">mostrarSubDados</font><font color="#808080">(</font><font color="#000080">opLivro</font><font color="#808080">, </font><font color="#000080">opEditora</font><font color="#808080">, .f.)
        </font><font color="#000080">tLiv_volume</font><font color="#808080">:=</font><font color="#000080">validaNumero</font><font color="#808080">(</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">6</font><font color="#808080">), </font><font color="#000080">tLiv_volume</font><font color="#808080">)
        </font><font color="#000080">mostrarSubDados</font><font color="#808080">(</font><font color="#000080">opLivro</font><font color="#808080">, </font><font color="#000080">opIdioma</font><font color="#808080">, .f.)
        </font><font color="#000080">tLiv_npaginas</font><font color="#808080">:=</font><font color="#000080">validaNumero</font><font color="#808080">(</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">8</font><font color="#808080">), </font><font color="#000080">tLiv_npaginas</font><font color="#808080">)
        </font><font color="#000080">tLiv_preco</font><font color="#808080">:=</font><font color="#000080">validaNumero</font><font color="#808080">(</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">9</font><font color="#808080">), </font><font color="#000080">tLiv_preco</font><font color="#808080">)
        </font><font color="#000080">tLiv_qtdestoque</font><font color="#808080">:=</font><font color="#000080">validaNumero</font><font color="#808080">(</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">), </font><font color="#000080">tLiv_qtdestoque</font><font color="#808080">)
    </font><font color="#0000FF">case </font><font color="#000080">nOpcao </font><font color="#808080">= </font><font color="#FF0000">3 
        </font><font color="#000080">tLiv_isbn</font><font color="#808080">:=</font><font color="#0000FF">alltrim</font><font color="#808080">(</font><font color="#000080">substr</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">13</font><font color="#808080">))
        </font><font color="#000080">tLiv_titulo</font><font color="#808080">:=</font><font color="#0000FF">alltrim</font><font color="#808080">(</font><font color="#000080">substr</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">14</font><font color="#808080">, </font><font color="#FF0000">50</font><font color="#808080">))
        </font><font color="#000080">tLiv_edicao</font><font color="#808080">:=</font><font color="#0000FF">alltrim</font><font color="#808080">(</font><font color="#000080">substr</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">64</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">))
        </font><font color="#000080">tLiv_anopubli</font><font color="#808080">:=</font><font color="#0000FF">alltrim</font><font color="#808080">(</font><font color="#000080">substr</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">74</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">))
        </font><font color="#000080">tLiv_codeditora</font><font color="#808080">:=</font><font color="#0000FF">alltrim</font><font color="#808080">(</font><font color="#000080">substr</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">84</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">))
        </font><font color="#000080">tLiv_volume</font><font color="#808080">:=</font><font color="#0000FF">alltrim</font><font color="#808080">(</font><font color="#000080">substr</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">94</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">))
        </font><font color="#000080">tLiv_codidioma</font><font color="#808080">:=</font><font color="#0000FF">alltrim</font><font color="#808080">(</font><font color="#000080">substr</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">104</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">))
        </font><font color="#000080">tLiv_npaginas</font><font color="#808080">:=</font><font color="#0000FF">alltrim</font><font color="#808080">(</font><font color="#000080">substr</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">114</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">))
        </font><font color="#000080">tLiv_preco</font><font color="#808080">:=</font><font color="#0000FF">alltrim</font><font color="#808080">(</font><font color="#000080">substr</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">124</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">))
        </font><font color="#000080">tLiv_qtdestoque</font><font color="#808080">:=</font><font color="#0000FF">alltrim</font><font color="#808080">(</font><font color="#000080">substr</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">134</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">))
        </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#800000">&quot;--------------------&quot;</font><font color="#808080">)
        </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">)+ </font><font color="#000080">tLiv_isbn</font><font color="#808080">)
        </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">)+ </font><font color="#000080">tLiv_titulo</font><font color="#808080">)
        </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">)+ </font><font color="#000080">tLiv_edicao</font><font color="#808080">)
        </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">4</font><font color="#808080">)+ </font><font color="#000080">tLiv_anopubli</font><font color="#808080">)
        </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">5</font><font color="#808080">)+ </font><font color="#000080">tLiv_codeditora</font><font color="#808080">)
        </font><font color="#000080">mostrarSubDados</font><font color="#808080">(</font><font color="#000080">opLivro</font><font color="#808080">, </font><font color="#000080">opEditora</font><font color="#808080">, .t.)
        </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">6</font><font color="#808080">)+ </font><font color="#000080">tLiv_volume</font><font color="#808080">)
        </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">7</font><font color="#808080">)+ </font><font color="#000080">tLiv_codidioma</font><font color="#808080">)
        </font><font color="#000080">mostrarSubDados</font><font color="#808080">(</font><font color="#000080">opLivro</font><font color="#808080">, </font><font color="#000080">opIdioma</font><font color="#808080">, .t.)
        </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">8</font><font color="#808080">)+ </font><font color="#000080">tLiv_npaginas</font><font color="#808080">)
        </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">9</font><font color="#808080">)+ </font><font color="#000080">tLiv_preco</font><font color="#808080">)
        </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">)+ </font><font color="#000080">tLiv_qtdestoque</font><font color="#808080">)
        </font><font color="#000080">ListarRegLigados</font><font color="#808080">(</font><font color="#000080">tfLivroAss</font><font color="#808080">, </font><font color="#000080">opLivroAss</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">13</font><font color="#808080">, </font><font color="#FF0000">14</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">, </font><font color="#000080">tLiv_isbn</font><font color="#808080">,;
                         </font><font color="#000080">tfAssunto</font><font color="#808080">, </font><font color="#000080">opAssunto</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">4</font><font color="#808080">)
        </font><font color="#000080">ListarRegLigados</font><font color="#808080">(</font><font color="#000080">tfLivroAut</font><font color="#808080">, </font><font color="#000080">opLivroAut</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">13</font><font color="#808080">, </font><font color="#FF0000">14</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">, </font><font color="#000080">tLiv_isbn</font><font color="#808080">,;
                         </font><font color="#000080">tfAutor</font><font color="#808080">, </font><font color="#000080">opAutor</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">4</font><font color="#808080">)
   </font><font color="#0000FF">endcase
</font><font color="#000080">elseif sreg </font><font color="#808080">= </font><font color="#000080">opCliente 
   </font><font color="#0000FF">do case
    case </font><font color="#000080">nOpcao </font><font color="#808080">= </font><font color="#FF0000">1 
        </font><font color="#0000FF">accept </font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">) </font><font color="#0000FF">to </font><font color="#000080">tCli_nome
        </font><font color="#0000FF">accept </font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">) </font><font color="#0000FF">to </font><font color="#000080">tCli_email 
        </font><font color="#0000FF">accept </font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">4</font><font color="#808080">) </font><font color="#0000FF">to </font><font color="#000080">tCli_identidade
        </font><font color="#0000FF">accept </font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">5</font><font color="#808080">) </font><font color="#0000FF">to </font><font color="#000080">tCli_sexo
        </font><font color="#0000FF">accept </font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">6</font><font color="#808080">) </font><font color="#0000FF">to </font><font color="#000080">tCli_telefone
        tCli_dtnascimento</font><font color="#808080">:=;
                </font><font color="#000080">validaDataHora</font><font color="#808080">(</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">7</font><font color="#808080">), </font><font color="#000080">tCli_dtnascimento</font><font color="#808080">, .t.)
        </font><font color="#000080">mostrarSubDados</font><font color="#808080">(</font><font color="#000080">opCliente</font><font color="#808080">, </font><font color="#000080">opEndereco</font><font color="#808080">, .f.)
        </font><font color="#000080">mostrarSubDados</font><font color="#808080">(</font><font color="#000080">opCliente</font><font color="#808080">, </font><font color="#000080">opPais</font><font color="#808080">, .f.)
        </font><font color="#000080">mostrarSubDados</font><font color="#808080">(</font><font color="#000080">opCliente</font><font color="#808080">, </font><font color="#000080">opProfissao</font><font color="#808080">, .f.)
    </font><font color="#0000FF">case </font><font color="#000080">nOpcao </font><font color="#808080">= </font><font color="#FF0000">3 
        </font><font color="#000080">tCli_cpf</font><font color="#808080">:=</font><font color="#0000FF">alltrim</font><font color="#808080">(</font><font color="#000080">substr</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">14</font><font color="#808080">))
        </font><font color="#000080">tCli_nome</font><font color="#808080">:=</font><font color="#0000FF">alltrim</font><font color="#808080">(</font><font color="#000080">substr</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">15</font><font color="#808080">, </font><font color="#FF0000">30</font><font color="#808080">))
        </font><font color="#000080">tCli_email</font><font color="#808080">:=</font><font color="#0000FF">alltrim</font><font color="#808080">(</font><font color="#000080">substr</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">45</font><font color="#808080">, </font><font color="#FF0000">30</font><font color="#808080">))
        </font><font color="#000080">tCli_identidade</font><font color="#808080">:=</font><font color="#0000FF">alltrim</font><font color="#808080">(</font><font color="#000080">substr</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">75</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">))
        </font><font color="#000080">tCli_sexo</font><font color="#808080">:=</font><font color="#0000FF">alltrim</font><font color="#808080">(</font><font color="#000080">substr</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">85</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">))
        </font><font color="#000080">tCli_telefone</font><font color="#808080">:=</font><font color="#0000FF">alltrim</font><font color="#808080">(</font><font color="#000080">substr</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">86</font><font color="#808080">, </font><font color="#FF0000">17</font><font color="#808080">))
        </font><font color="#000080">tCli_dtnascimento</font><font color="#808080">:=</font><font color="#0000FF">alltrim</font><font color="#808080">(</font><font color="#000080">substr</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">103</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">))
        </font><font color="#000080">tCli_codendereco</font><font color="#808080">:=</font><font color="#0000FF">alltrim</font><font color="#808080">(</font><font color="#000080">substr</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">113</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">))
        </font><font color="#000080">tCli_codpais</font><font color="#808080">:=</font><font color="#0000FF">alltrim</font><font color="#808080">(</font><font color="#000080">substr</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">123</font><font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">))
        </font><font color="#000080">tCli_codprofissao</font><font color="#808080">:=</font><font color="#0000FF">alltrim</font><font color="#808080">(</font><font color="#000080">substr</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">126</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">))
        </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#800000">&quot;--------------------&quot;</font><font color="#808080">)
        </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">)+ </font><font color="#000080">tCli_cpf</font><font color="#808080">)
        </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">)+ </font><font color="#000080">tCli_nome</font><font color="#808080">)
        </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">)+ </font><font color="#000080">tCli_email</font><font color="#808080">)
        </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">4</font><font color="#808080">)+ </font><font color="#000080">tCli_identidade</font><font color="#808080">)
        </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">5</font><font color="#808080">)+ </font><font color="#000080">tCli_sexo</font><font color="#808080">)
        </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">6</font><font color="#808080">)+ </font><font color="#000080">tCli_telefone</font><font color="#808080">)
        </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">7</font><font color="#808080">)+ </font><font color="#000080">tCli_dtnascimento</font><font color="#808080">)
        </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">8</font><font color="#808080">)+ </font><font color="#000080">tCli_codendereco</font><font color="#808080">)
        </font><font color="#000080">mostrarSubDados</font><font color="#808080">(</font><font color="#000080">opCliente</font><font color="#808080">, </font><font color="#000080">opEndereco</font><font color="#808080">, .t.)
        </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">9</font><font color="#808080">)+ </font><font color="#000080">tCli_codpais</font><font color="#808080">)
        </font><font color="#000080">mostrarSubDados</font><font color="#808080">(</font><font color="#000080">opCliente</font><font color="#808080">, </font><font color="#000080">opPais</font><font color="#808080">, .t.)
        </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">)+ </font><font color="#000080">tCli_codprofissao</font><font color="#808080">)
        </font><font color="#000080">mostrarSubDados</font><font color="#808080">(</font><font color="#000080">opCliente</font><font color="#808080">, </font><font color="#000080">opProfissao</font><font color="#808080">, .t.)
   </font><font color="#0000FF">endcase
</font><font color="#000080">elseif sreg </font><font color="#808080">= </font><font color="#000080">opVenda 
   </font><font color="#0000FF">do case
    case </font><font color="#000080">nOpcao </font><font color="#808080">= </font><font color="#FF0000">1
        </font><font color="#000080">mostrarSubDados</font><font color="#808080">(</font><font color="#000080">opVenda</font><font color="#808080">,</font><font color="#000080">opVenda</font><font color="#808080">, .f.)
    </font><font color="#0000FF">case </font><font color="#000080">nOpcao </font><font color="#808080">= </font><font color="#FF0000">2
        </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#800000">&quot;DataHoraVenda       CPF            ISBN          &quot;</font><font color="#808080">+;
        </font><font color="#800000">&quot;Pre&ccedil;oVenda&quot;</font><font color="#808080">)
        </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#800000">&quot;-------------       ---            ----          &quot;</font><font color="#808080">+;
        </font><font color="#800000">&quot;----------&quot;</font><font color="#808080">)
    </font><font color="#0000FF">case </font><font color="#000080">nOpcao </font><font color="#808080">= </font><font color="#FF0000">3 
        </font><font color="#000080">tVenda_dthrvenda</font><font color="#808080">:=</font><font color="#000080">substr</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">19</font><font color="#808080">)
        </font><font color="#000080">tVenda_cpf</font><font color="#808080">:=</font><font color="#000080">substr</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">20</font><font color="#808080">, </font><font color="#FF0000">14</font><font color="#808080">)
        </font><font color="#000080">tVenda_isbn</font><font color="#808080">:=</font><font color="#000080">substr</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">34</font><font color="#808080">, </font><font color="#FF0000">13</font><font color="#808080">)
        </font><font color="#000080">tVenda_precovenda</font><font color="#808080">:=</font><font color="#000080">substr</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">47</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">)
        </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#000080">tVenda_dthrvenda</font><font color="#808080">+</font><font color="#800000">&quot; &quot;</font><font color="#808080">+</font><font color="#000080">tVenda_cpf</font><font color="#808080">+</font><font color="#800000">&quot; &quot;</font><font color="#808080">+</font><font color="#000080">tVenda_isbn</font><font color="#808080">+</font><font color="#800000">&quot; &quot;</font><font color="#808080">+;
        </font><font color="#000080">tVenda_precovenda</font><font color="#808080">)
   </font><font color="#0000FF">endcase
endif

return
</font><font color="#808080">/*------------------------------------------------------------------------------
</font><font color="#000080">Mostra as sub inform&ccedil;&otilde;es de entrada e de sa&iacute;da</font><font color="#808080">.
</font><font color="#000080">sreg </font><font color="#808080">- </font><font color="#000080">o tipo de arquivo
ssubreg </font><font color="#808080">- </font><font color="#000080">o subtipo de arquivo
bSoMostrar </font><font color="#808080">- </font><font color="#000080">se vai s&oacute; mostrar na sa&iacute;da 
</font><font color="#808080">------------------------------------------------------------------------------*/
</font><font color="#0000FF">procedure </font><font color="#000080">mostrarSubDados</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#000080">ssubreg</font><font color="#808080">, </font><font color="#000080">bSoMostrar</font><font color="#808080">)
</font><font color="#0000FF">local </font><font color="#000080">sRegistro</font><font color="#808080">, </font><font color="#000080">sPreco</font><font color="#808080">, </font><font color="#000080">nStatus</font><font color="#808080">, </font><font color="#000080">nMaxTentativas

nMaxTentativas</font><font color="#808080">:=</font><font color="#FF0000">3
</font><font color="#0000FF">if </font><font color="#000080">sreg </font><font color="#808080">= </font><font color="#000080">opLivro 
  </font><font color="#0000FF">if </font><font color="#000080">ssubreg </font><font color="#808080">= </font><font color="#000080">opEditora
    </font><font color="#0000FF">if </font><font color="#000080">bSoMostrar
       sRegistro</font><font color="#808080">:=</font><font color="#000080">pesqArq</font><font color="#808080">(</font><font color="#000080">tfEditora</font><font color="#808080">,</font><font color="#000080">tLiv_codeditora</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">,</font><font color="#000080">tamReg</font><font color="#808080">(</font><font color="#000080">opEditora</font><font color="#808080">))
    </font><font color="#0000FF">else
       </font><font color="#000080">sRegistro</font><font color="#808080">:=</font><font color="#000080">validaEntrada</font><font color="#808080">(</font><font color="#000080">tfEditora</font><font color="#808080">,</font><font color="#000080">ssubreg</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#000080">tLiv_codeditora</font><font color="#808080">,;
                  </font><font color="#000080">nMaxTentativas</font><font color="#808080">,.f.,</font><font color="#000080">opNumero</font><font color="#808080">)
    </font><font color="#0000FF">endif
    if </font><font color="#808080">!</font><font color="#0000FF">empty</font><font color="#808080">(</font><font color="#000080">sRegistro</font><font color="#808080">) 
      </font><font color="#000080">tLiv_codeditora</font><font color="#808080">:=</font><font color="#0000FF">alltrim</font><font color="#808080">(</font><font color="#000080">substr</font><font color="#808080">(</font><font color="#000080">sRegistro</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">))
      </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#800000">&quot; &quot;</font><font color="#808080">+</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">opEditora</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">))
      </font><font color="#000080">qqout</font><font color="#808080">(</font><font color="#000080">substr</font><font color="#808080">(</font><font color="#000080">sRegistro</font><font color="#808080">, </font><font color="#000080">g_nPosChave</font><font color="#808080">, </font><font color="#000080">g_nTamChave</font><font color="#808080">))
    </font><font color="#0000FF">endif
  </font><font color="#000080">elseif ssubreg </font><font color="#808080">= </font><font color="#000080">opIdioma
    </font><font color="#0000FF">if </font><font color="#000080">bSoMostrar
       sRegistro</font><font color="#808080">:=</font><font color="#000080">pesqArq</font><font color="#808080">(</font><font color="#000080">tfIdioma</font><font color="#808080">, </font><font color="#000080">tLiv_codidioma</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">,</font><font color="#000080">tamReg</font><font color="#808080">(</font><font color="#000080">opIdioma</font><font color="#808080">))
    </font><font color="#0000FF">else
       </font><font color="#000080">sRegistro</font><font color="#808080">:=</font><font color="#000080">validaEntrada</font><font color="#808080">(</font><font color="#000080">tfIdioma</font><font color="#808080">,</font><font color="#000080">ssubreg</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#000080">tLiv_codidioma</font><font color="#808080">,;
                  </font><font color="#000080">nMaxTentativas</font><font color="#808080">,.f.,</font><font color="#000080">opNumero</font><font color="#808080">)
    </font><font color="#0000FF">endif
    if </font><font color="#808080">!</font><font color="#0000FF">empty</font><font color="#808080">(</font><font color="#000080">sRegistro</font><font color="#808080">) 
      </font><font color="#000080">tLiv_codidioma</font><font color="#808080">:=</font><font color="#0000FF">alltrim</font><font color="#808080">(</font><font color="#000080">substr</font><font color="#808080">(</font><font color="#000080">sRegistro</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">))
      </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#800000">&quot; &quot;</font><font color="#808080">+</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">opIdioma</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">))
      </font><font color="#000080">qqout</font><font color="#808080">(</font><font color="#000080">substr</font><font color="#808080">(</font><font color="#000080">sRegistro</font><font color="#808080">, </font><font color="#000080">g_nPosChave</font><font color="#808080">, </font><font color="#000080">g_nTamChave</font><font color="#808080">))
    </font><font color="#0000FF">endif
  endif
</font><font color="#000080">elseif sreg </font><font color="#808080">= </font><font color="#000080">opCliente 
  </font><font color="#0000FF">if </font><font color="#000080">ssubreg </font><font color="#808080">= </font><font color="#000080">opEndereco
    </font><font color="#0000FF">if </font><font color="#000080">bSoMostrar
       sRegistro</font><font color="#808080">:=</font><font color="#000080">pesqArq</font><font color="#808080">(</font><font color="#000080">tfEndereco</font><font color="#808080">, </font><font color="#000080">tCli_codendereco</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">,;
                  </font><font color="#000080">tamReg</font><font color="#808080">(</font><font color="#000080">opEndereco</font><font color="#808080">))
    </font><font color="#0000FF">else
       </font><font color="#000080">sRegistro</font><font color="#808080">:=</font><font color="#000080">validaEntrada</font><font color="#808080">(</font><font color="#000080">tfEndereco</font><font color="#808080">,</font><font color="#000080">ssubreg</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#000080">tCli_codendereco</font><font color="#808080">,;
                  </font><font color="#000080">nMaxTentativas</font><font color="#808080">,.f.,</font><font color="#000080">opNumero</font><font color="#808080">)
    </font><font color="#0000FF">endif
    if </font><font color="#808080">!</font><font color="#0000FF">empty</font><font color="#808080">(</font><font color="#000080">sRegistro</font><font color="#808080">) 
      </font><font color="#000080">tCli_codendereco</font><font color="#808080">:=</font><font color="#0000FF">alltrim</font><font color="#808080">(</font><font color="#000080">substr</font><font color="#808080">(</font><font color="#000080">sRegistro</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">))
      </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#800000">&quot; &quot;</font><font color="#808080">+</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">opEndereco</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">))
      </font><font color="#000080">qqout</font><font color="#808080">(</font><font color="#000080">substr</font><font color="#808080">(</font><font color="#000080">sRegistro</font><font color="#808080">, </font><font color="#000080">g_nPosChave</font><font color="#808080">, </font><font color="#000080">g_nTamChave</font><font color="#808080">))
      </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#800000">&quot; &quot;</font><font color="#808080">+</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">opEndereco</font><font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">))
      </font><font color="#000080">qqout</font><font color="#808080">(</font><font color="#000080">substr</font><font color="#808080">(</font><font color="#000080">sRegistro</font><font color="#808080">, </font><font color="#000080">g_nPosChave</font><font color="#808080">, </font><font color="#000080">g_nTamChave</font><font color="#808080">))
      </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#800000">&quot; &quot;</font><font color="#808080">+</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">opEndereco</font><font color="#808080">, </font><font color="#FF0000">4</font><font color="#808080">))
      </font><font color="#000080">qqout</font><font color="#808080">(</font><font color="#000080">substr</font><font color="#808080">(</font><font color="#000080">sRegistro</font><font color="#808080">, </font><font color="#000080">g_nPosChave</font><font color="#808080">, </font><font color="#000080">g_nTamChave</font><font color="#808080">))
      </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#800000">&quot; &quot;</font><font color="#808080">+</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">opEndereco</font><font color="#808080">, </font><font color="#FF0000">5</font><font color="#808080">))
      </font><font color="#000080">qqout</font><font color="#808080">(</font><font color="#000080">substr</font><font color="#808080">(</font><font color="#000080">sRegistro</font><font color="#808080">, </font><font color="#000080">g_nPosChave</font><font color="#808080">, </font><font color="#000080">g_nTamChave</font><font color="#808080">))
      </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#800000">&quot; &quot;</font><font color="#808080">+</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">opEndereco</font><font color="#808080">, </font><font color="#FF0000">6</font><font color="#808080">))
      </font><font color="#000080">qqout</font><font color="#808080">(</font><font color="#000080">substr</font><font color="#808080">(</font><font color="#000080">sRegistro</font><font color="#808080">, </font><font color="#000080">g_nPosChave</font><font color="#808080">, </font><font color="#000080">g_nTamChave</font><font color="#808080">))
    </font><font color="#0000FF">endif
  </font><font color="#000080">elseif ssubreg </font><font color="#808080">= </font><font color="#000080">opPais
    </font><font color="#0000FF">if </font><font color="#000080">bSoMostrar
       sRegistro</font><font color="#808080">:=</font><font color="#000080">pesqArq</font><font color="#808080">(</font><font color="#000080">tfPais</font><font color="#808080">, </font><font color="#000080">tCli_codpais</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">, </font><font color="#000080">tamReg</font><font color="#808080">(</font><font color="#000080">opPais</font><font color="#808080">))
    </font><font color="#0000FF">else
       </font><font color="#000080">sRegistro</font><font color="#808080">:=</font><font color="#000080">validaEntrada</font><font color="#808080">(</font><font color="#000080">tfPais</font><font color="#808080">,</font><font color="#000080">ssubreg</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#000080">tCli_codpais</font><font color="#808080">,;
                  </font><font color="#000080">nMaxTentativas</font><font color="#808080">,.f.,</font><font color="#000080">opTexto</font><font color="#808080">)
    </font><font color="#0000FF">endif
    if </font><font color="#808080">!</font><font color="#0000FF">empty</font><font color="#808080">(</font><font color="#000080">sRegistro</font><font color="#808080">) 
      </font><font color="#000080">tCli_codpais</font><font color="#808080">:=</font><font color="#0000FF">alltrim</font><font color="#808080">(</font><font color="#000080">substr</font><font color="#808080">(</font><font color="#000080">sRegistro</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#FF0000">3</font><font color="#808080">))
      </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#800000">&quot; &quot;</font><font color="#808080">+</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">opPais</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">))
      </font><font color="#000080">qqout</font><font color="#808080">(</font><font color="#000080">substr</font><font color="#808080">(</font><font color="#000080">sRegistro</font><font color="#808080">, </font><font color="#000080">g_nPosChave</font><font color="#808080">, </font><font color="#000080">g_nTamChave</font><font color="#808080">))
    </font><font color="#0000FF">endif
  </font><font color="#000080">elseif ssubreg </font><font color="#808080">= </font><font color="#000080">opProfissao
    </font><font color="#0000FF">if </font><font color="#000080">bSoMostrar
       sRegistro</font><font color="#808080">:=</font><font color="#000080">pesqArq</font><font color="#808080">(</font><font color="#000080">tfProfissao</font><font color="#808080">, </font><font color="#000080">tCli_codprofissao</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">,;
                  </font><font color="#000080">tamReg</font><font color="#808080">(</font><font color="#000080">opProfissao</font><font color="#808080">))
    </font><font color="#0000FF">else
       </font><font color="#000080">sRegistro</font><font color="#808080">:=</font><font color="#000080">validaEntrada</font><font color="#808080">(</font><font color="#000080">tfProfissao</font><font color="#808080">,</font><font color="#000080">ssubreg</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#000080">tCli_codprofissao</font><font color="#808080">,;
                  </font><font color="#000080">nMaxTentativas</font><font color="#808080">,.f.,</font><font color="#000080">opNumero</font><font color="#808080">)
    </font><font color="#0000FF">endif
    if </font><font color="#808080">!</font><font color="#0000FF">empty</font><font color="#808080">(</font><font color="#000080">sRegistro</font><font color="#808080">) 
      </font><font color="#000080">tCli_codprofissao</font><font color="#808080">:=</font><font color="#0000FF">alltrim</font><font color="#808080">(</font><font color="#000080">substr</font><font color="#808080">(</font><font color="#000080">sRegistro</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">))
      </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#800000">&quot; &quot;</font><font color="#808080">+</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">opProfissao</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">))
      </font><font color="#000080">qqout</font><font color="#808080">(</font><font color="#000080">substr</font><font color="#808080">(</font><font color="#000080">sRegistro</font><font color="#808080">, </font><font color="#000080">g_nPosChave</font><font color="#808080">, </font><font color="#000080">g_nTamChave</font><font color="#808080">))
    </font><font color="#0000FF">endif
  endif
</font><font color="#000080">elseif sreg </font><font color="#808080">= </font><font color="#000080">opVenda 
  sRegistro</font><font color="#808080">:=</font><font color="#000080">pesqArq</font><font color="#808080">(</font><font color="#000080">tfLivro</font><font color="#808080">, </font><font color="#000080">tVenda_isbn</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">13</font><font color="#808080">, </font><font color="#000080">tamReg</font><font color="#808080">(</font><font color="#000080">opLivro</font><font color="#808080">))
  </font><font color="#0000FF">if </font><font color="#808080">!</font><font color="#0000FF">empty</font><font color="#808080">(</font><font color="#000080">sRegistro</font><font color="#808080">) 
    </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#800000">&quot; &quot;</font><font color="#808080">+</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">opLivro</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">)) /* </font><font color="#000080">Titulo </font><font color="#808080">*/
    </font><font color="#000080">qqout</font><font color="#808080">(</font><font color="#000080">substr</font><font color="#808080">(</font><font color="#000080">sRegistro</font><font color="#808080">, </font><font color="#000080">g_nPosChave</font><font color="#808080">, </font><font color="#000080">g_nTamChave</font><font color="#808080">))
    </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#800000">&quot; &quot;</font><font color="#808080">+</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">opLivro</font><font color="#808080">, </font><font color="#FF0000">9</font><font color="#808080">)) /* </font><font color="#000080">Preco </font><font color="#808080">*/
    </font><font color="#000080">sPreco</font><font color="#808080">:=</font><font color="#000080">substr</font><font color="#808080">(</font><font color="#000080">sRegistro</font><font color="#808080">, </font><font color="#000080">g_nPosChave</font><font color="#808080">, </font><font color="#000080">g_nTamChave</font><font color="#808080">)
    </font><font color="#000080">g_nPreco</font><font color="#808080">:=</font><font color="#0000FF">val</font><font color="#808080">(</font><font color="#000080">sPreco</font><font color="#808080">)
    </font><font color="#000080">qqout</font><font color="#808080">(</font><font color="#000080">sPreco</font><font color="#808080">)
  </font><font color="#0000FF">endif
endif
return
</font><font color="#808080">/*------------------------------------------------------------------------------
</font><font color="#000080">Realiza os cadastros dos arquivos que se ligam a outros arquivos</font><font color="#808080">.
</font><font color="#000080">sreg </font><font color="#808080">- </font><font color="#000080">o tipo de arquivo
sacao </font><font color="#808080">- </font><font color="#000080">a a&ccedil;&atilde;o a ser realizada
sCodigo </font><font color="#808080">- </font><font color="#000080">um das chaves </font><font color="#0000FF">do </font><font color="#000080">arquivo de liga&ccedil;&atilde;o
</font><font color="#808080">------------------------------------------------------------------------------*/
</font><font color="#0000FF">procedure </font><font color="#000080">frmCadLigados</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#000080">sacao</font><font color="#808080">, </font><font color="#000080">sCodigo</font><font color="#808080">)
</font><font color="#0000FF">local </font><font color="#000080">nQtd</font><font color="#808080">, </font><font color="#000080">nCont</font><font color="#808080">, </font><font color="#000080">nQtdEstoque</font><font color="#808080">, </font><font color="#000080">nStatus
</font><font color="#0000FF">local </font><font color="#000080">nTotalPreco</font><font color="#808080">, </font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#000080">sTotalPreco</font><font color="#808080">, </font><font color="#000080">sPreco</font><font color="#808080">, </font><font color="#000080">sQtd

</font><font color="#0000FF">if </font><font color="#000080">sacao </font><font color="#808080">= </font><font color="#000080">opNovo 
  nCont</font><font color="#808080">:=</font><font color="#FF0000">1
  </font><font color="#0000FF">if </font><font color="#000080">sreg </font><font color="#808080">= </font><font color="#000080">opLivroAss 
    sQtd</font><font color="#808080">:=</font><font color="#000080">validaNumero</font><font color="#808080">(</font><font color="#800000">&quot;Quantos assuntos quer cadastrar?: &quot;</font><font color="#808080">, </font><font color="#000080">sQtd</font><font color="#808080">)
    </font><font color="#000080">nQtd</font><font color="#808080">:=</font><font color="#0000FF">Val</font><font color="#808080">(</font><font color="#000080">sQtd</font><font color="#808080">)
    </font><font color="#000080">fseek</font><font color="#808080">(</font><font color="#000080">tfLivroAss</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#000080">FS_SET</font><font color="#808080">)
    </font><font color="#0000FF">do while </font><font color="#000080">nCont </font><font color="#808080">&lt;= </font><font color="#000080">nQtd
      tLivAss_isbn</font><font color="#808080">:=</font><font color="#000080">sCodigo
      </font><font color="#0000FF">accept </font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">opLivroAss</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">) </font><font color="#0000FF">to </font><font color="#000080">tLivAss_codassunto
      slinha</font><font color="#808080">:=</font><font color="#000080">pesqArq</font><font color="#808080">(</font><font color="#000080">tfAssunto</font><font color="#808080">, </font><font color="#000080">tLivAss_codassunto</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">,</font><font color="#000080">tamReg</font><font color="#808080">(</font><font color="#000080">opAssunto</font><font color="#808080">))
      </font><font color="#000080">qqout</font><font color="#808080">(</font><font color="#800000">&quot; &quot;</font><font color="#808080">+</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">opAssunto</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">))
      </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#000080">substr</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#000080">g_nPosChave</font><font color="#808080">, </font><font color="#000080">g_nTamChave</font><font color="#808080">))
      </font><font color="#000080">pesqLinhaExcluida</font><font color="#808080">(</font><font color="#000080">tfLivroAss</font><font color="#808080">, </font><font color="#000080">tamReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">))
      </font><font color="#000080">subMenu</font><font color="#808080">(</font><font color="#FF0000">14</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">)
      </font><font color="#000080">nCont</font><font color="#808080">++
    </font><font color="#0000FF">enddo
  </font><font color="#000080">elseif sreg </font><font color="#808080">= </font><font color="#000080">opLivroAut 
    sQtd</font><font color="#808080">:=</font><font color="#000080">validaNumero</font><font color="#808080">(</font><font color="#800000">&quot;Quantos autores quer cadastrar?: &quot;</font><font color="#808080">,</font><font color="#000080">sQtd</font><font color="#808080">)
    </font><font color="#000080">nQtd</font><font color="#808080">:=</font><font color="#0000FF">Val</font><font color="#808080">(</font><font color="#000080">sQtd</font><font color="#808080">)
    </font><font color="#000080">fseek</font><font color="#808080">(</font><font color="#000080">tfLivroAut</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#000080">FS_SET</font><font color="#808080">)
    </font><font color="#0000FF">do while </font><font color="#000080">nCont </font><font color="#808080">&lt;= </font><font color="#000080">nQtd
      tLivAut_isbn</font><font color="#808080">:=</font><font color="#000080">sCodigo
      </font><font color="#0000FF">accept </font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">opLivroAut</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">) </font><font color="#0000FF">to </font><font color="#000080">tLivAut_codautor
      slinha</font><font color="#808080">:=</font><font color="#000080">pesqArq</font><font color="#808080">(</font><font color="#000080">tfAutor</font><font color="#808080">, </font><font color="#000080">tLivAut_codautor</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">,</font><font color="#000080">tamReg</font><font color="#808080">(</font><font color="#000080">opAutor</font><font color="#808080">))
      </font><font color="#000080">qqout</font><font color="#808080">(</font><font color="#800000">&quot; &quot;</font><font color="#808080">+</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">opAutor</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">))
      </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#000080">substr</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#000080">g_nPosChave</font><font color="#808080">, </font><font color="#000080">g_nTamChave</font><font color="#808080">))
      </font><font color="#000080">pesqLinhaExcluida</font><font color="#808080">(</font><font color="#000080">tfLivroAut</font><font color="#808080">, </font><font color="#000080">tamReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">))
      </font><font color="#000080">subMenu</font><font color="#808080">(</font><font color="#FF0000">14</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">)
      </font><font color="#000080">nCont</font><font color="#808080">++
    </font><font color="#0000FF">enddo
  </font><font color="#000080">elseif sreg </font><font color="#808080">= </font><font color="#000080">opVenda 
    sQtd</font><font color="#808080">:=</font><font color="#000080">validaNumero</font><font color="#808080">(</font><font color="#800000">&quot;Quantos livros quer vender?: &quot;</font><font color="#808080">,</font><font color="#000080">sQtd</font><font color="#808080">)
    </font><font color="#000080">nQtd</font><font color="#808080">:=</font><font color="#0000FF">Val</font><font color="#808080">(</font><font color="#000080">sQtd</font><font color="#808080">)
    </font><font color="#000080">nTotalPreco</font><font color="#808080">:=</font><font color="#FF0000">0
    </font><font color="#0000FF">do while </font><font color="#000080">nCont </font><font color="#808080">&lt;= </font><font color="#000080">nQtd
      slinha</font><font color="#808080">:=</font><font color="#000080">validaEntrada</font><font color="#808080">(</font><font color="#000080">tfLivro</font><font color="#808080">,</font><font color="#000080">opLivro</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#000080">tVenda_isbn</font><font color="#808080">,</font><font color="#FF0000">3</font><font color="#808080">,.f.,</font><font color="#000080">opTexto</font><font color="#808080">)
      </font><font color="#0000FF">if </font><font color="#808080">!</font><font color="#0000FF">empty</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">) 
        </font><font color="#000080">tVenda_isbn</font><font color="#808080">:=</font><font color="#0000FF">alltrim</font><font color="#808080">(</font><font color="#000080">substr</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#FF0000">13</font><font color="#808080">))
        </font><font color="#0000FF">if </font><font color="#000080">validaISBN</font><font color="#808080">(</font><font color="#000080">tVenda_isbn</font><font color="#808080">) 
          </font><font color="#000080">mostrarDados</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">)
          </font><font color="#000080">tLiv_qtdestoque</font><font color="#808080">:=</font><font color="#0000FF">alltrim</font><font color="#808080">(</font><font color="#000080">substr</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">,</font><font color="#FF0000">134</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">))
          </font><font color="#000080">nQtdEstoque</font><font color="#808080">:=</font><font color="#0000FF">val</font><font color="#808080">(</font><font color="#000080">tLiv_qtdestoque</font><font color="#808080">)
          </font><font color="#0000FF">if </font><font color="#000080">nQtdEstoque </font><font color="#808080">&gt; </font><font color="#FF0000">0 
             </font><font color="#000080">nTotalPreco</font><font color="#808080">:=</font><font color="#000080">nTotalPreco </font><font color="#808080">+ </font><font color="#000080">g_nPreco
             sPreco</font><font color="#808080">:=</font><font color="#0000FF">alltrim</font><font color="#808080">(</font><font color="#0000FF">str</font><font color="#808080">(</font><font color="#000080">g_nPreco</font><font color="#808080">,</font><font color="#FF0000">7</font><font color="#808080">,</font><font color="#FF0000">2</font><font color="#808080">))
             </font><font color="#000080">tVenda_precovenda</font><font color="#808080">:=</font><font color="#000080">sPreco
             g_SalvarInclusao</font><font color="#808080">:=.f.
             </font><font color="#000080">subMenu</font><font color="#808080">(</font><font color="#FF0000">14</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">)
             </font><font color="#0000FF">if </font><font color="#000080">g_SalvarInclusao 
                slinha</font><font color="#808080">:=</font><font color="#000080">pesqArq</font><font color="#808080">(</font><font color="#000080">tfLivro</font><font color="#808080">, </font><font color="#000080">tVenda_isbn</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">13</font><font color="#808080">, </font><font color="#000080">tamReg</font><font color="#808080">(</font><font color="#000080">opLivro</font><font color="#808080">))
                </font><font color="#0000FF">if </font><font color="#808080">!</font><font color="#0000FF">empty</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">) 
                   </font><font color="#000080">nQtdEstoque</font><font color="#808080">:=</font><font color="#000080">nQtdEstoque</font><font color="#808080">-</font><font color="#FF0000">1
                   </font><font color="#000080">tLiv_qtdestoque</font><font color="#808080">:=</font><font color="#0000FF">alltrim</font><font color="#808080">(</font><font color="#0000FF">str</font><font color="#808080">(</font><font color="#000080">nQtdEstoque</font><font color="#808080">))
                   </font><font color="#000080">slinha</font><font color="#808080">:=</font><font color="#000080">substr</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#FF0000">133</font><font color="#808080">)+</font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">tLiv_qtdestoque</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">)
                   </font><font color="#000080">escreveArq</font><font color="#808080">(</font><font color="#000080">tfLivro</font><font color="#808080">, </font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">)
                </font><font color="#0000FF">endif
             endif
             </font><font color="#000080">nCont</font><font color="#808080">++
          </font><font color="#0000FF">else 
            </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#000080">MSG_SEMESTOQUE</font><font color="#808080">)
          </font><font color="#0000FF">endif
        else 
          </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#000080">MSG_ISBNINV</font><font color="#808080">)
        </font><font color="#0000FF">endif    
      endif
    enddo
    </font><font color="#000080">sTotalPreco</font><font color="#808080">:=</font><font color="#0000FF">alltrim</font><font color="#808080">(</font><font color="#0000FF">str</font><font color="#808080">(</font><font color="#000080">nTotalPreco</font><font color="#808080">,</font><font color="#FF0000">7</font><font color="#808080">,</font><font color="#FF0000">2</font><font color="#808080">))
    </font><font color="#000080">qout</font><font color="#808080">(</font><font color="#800000">&quot;Total de &quot;</font><font color="#808080">+</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">,</font><font color="#FF0000">4</font><font color="#808080">)+</font><font color="#000080">sTotalPreco</font><font color="#808080">)
  </font><font color="#0000FF">endif
</font><font color="#000080">elseif sacao </font><font color="#808080">= </font><font color="#000080">opExcluir 
  </font><font color="#0000FF">if </font><font color="#000080">sreg </font><font color="#808080">= </font><font color="#000080">opLivroAss 
     ExcluirRegLigados</font><font color="#808080">(</font><font color="#000080">tfLivroAss</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">13</font><font color="#808080">, </font><font color="#000080">sCodigo</font><font color="#808080">)
  </font><font color="#000080">elseif sreg </font><font color="#808080">= </font><font color="#000080">opLivroAut 
     ExcluirRegLigados</font><font color="#808080">(</font><font color="#000080">tfLivroAut</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">13</font><font color="#808080">, </font><font color="#000080">sCodigo</font><font color="#808080">)
  </font><font color="#0000FF">endif
endif

return
</font><font color="#808080">/*------------------------------------------------------------------------------
</font><font color="#000080">Realiza a exclus&atilde;o dos arquivos de liga&ccedil;&atilde;o</font><font color="#808080">.
</font><font color="#000080">sArq </font><font color="#808080">- </font><font color="#000080">o arquivo de liga&ccedil;&atilde;o
sreg </font><font color="#808080">- </font><font color="#000080">o tipo de arquivo de liga&ccedil;&atilde;o
nPosChave </font><font color="#808080">- </font><font color="#000080">a posicao inicial da chave dentro </font><font color="#0000FF">do </font><font color="#000080">registro
nTamChave </font><font color="#808080">- </font><font color="#000080">o tamanho da chave dentro </font><font color="#0000FF">do </font><font color="#000080">registro
sChave </font><font color="#808080">- </font><font color="#000080">a chave a ser excluida
</font><font color="#808080">------------------------------------------------------------------------------*/
</font><font color="#0000FF">procedure </font><font color="#000080">ExcluirRegLigados</font><font color="#808080">(</font><font color="#000080">sArq</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#000080">nPosChave</font><font color="#808080">, </font><font color="#000080">nTamChave</font><font color="#808080">, </font><font color="#000080">sChave</font><font color="#808080">)
</font><font color="#0000FF">local </font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#000080">sCodigo</font><font color="#808080">, </font><font color="#000080">nStatus</font><font color="#808080">, </font><font color="#000080">nler

  nler </font><font color="#808080">:= </font><font color="#000080">tamReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">) + </font><font color="#000080">TAM_CRLF
  slinha</font><font color="#808080">:=</font><font color="#0000FF">space</font><font color="#808080">(</font><font color="#000080">nler</font><font color="#808080">)
  </font><font color="#000080">fseek</font><font color="#808080">(</font><font color="#000080">sArq</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#000080">FS_SET</font><font color="#808080">)
  </font><font color="#0000FF">do while </font><font color="#808080">!</font><font color="#000080">fimArq</font><font color="#808080">(</font><font color="#000080">sArq</font><font color="#808080">)
    </font><font color="#000080">fread</font><font color="#808080">(</font><font color="#000080">sArq</font><font color="#808080">, </font><font color="#0000FF">@</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#000080">nler</font><font color="#808080">)
    </font><font color="#000080">sCodigo</font><font color="#808080">:=</font><font color="#0000FF">alltrim</font><font color="#808080">(</font><font color="#000080">substr</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">,</font><font color="#000080">nPosChave</font><font color="#808080">,</font><font color="#000080">nTamChave</font><font color="#808080">))
    </font><font color="#0000FF">if </font><font color="#000080">sCodigo</font><font color="#808080">==</font><font color="#000080">sChave
       btnAcao</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">,</font><font color="#000080">opConfirmaExclusao</font><font color="#808080">)
    </font><font color="#0000FF">endif
  enddo
return
</font></font>
</code></pre>
</body>
</html>