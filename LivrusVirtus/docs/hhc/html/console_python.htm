<html>
<head>
<title>Livrus Virtus - Console - Python</title>
</head>
<!-- Generated by ConTEXT HTML exporter -->
<body text="#000000" bgcolor="#FFFFFF">
<pre>
<code><font  face="Courier New"><font color="#808080"><i>#!/usr/bin/env python

#------------------------------------------------------------------------------
# Sistema integrante do projeto Livrus Virtus.
# Todos os direitos reservados para Henrique F. de Souza.
# Versao programada na linguagem python.
#------------------------------------------------------------------------------
# programa Livrus

</i></font><font color="#000080"><b>import </b>os</font><font color="#808080">, </font><font color="#000080">sys</font><font color="#808080">, </font><font color="#000080">string</font><font color="#808080">, </font><font color="#000080">getpass
<b>from </b>time <b>import </b>localtime</font><font color="#808080">, </font><font color="#000080">strftime

</font><font color="#808080"><i># Tipos

</i></font><font color="#000080">tAssunto </font><font color="#808080">= { </font><font color="#800000">'codigo'</font><font color="#808080">: </font><font color="#800000">''</font><font color="#808080">, </font><font color="#800000">'assunto'</font><font color="#808080">: </font><font color="#800000">'' </font><font color="#808080">}
</font><font color="#000080">tAutor </font><font color="#808080">= { </font><font color="#800000">'codigo'</font><font color="#808080">: </font><font color="#800000">''</font><font color="#808080">, </font><font color="#800000">'autor'</font><font color="#808080">: </font><font color="#800000">'' </font><font color="#808080">}
</font><font color="#000080">tEditora </font><font color="#808080">= { </font><font color="#800000">'codigo'</font><font color="#808080">: </font><font color="#800000">''</font><font color="#808080">, </font><font color="#800000">'editora'</font><font color="#808080">: </font><font color="#800000">'' </font><font color="#808080">}
</font><font color="#000080">tIdioma </font><font color="#808080">= { </font><font color="#800000">'codigo'</font><font color="#808080">: </font><font color="#800000">''</font><font color="#808080">, </font><font color="#800000">'idioma'</font><font color="#808080">: </font><font color="#800000">'' </font><font color="#808080">}
</font><font color="#000080">tUsuario </font><font color="#808080">= { </font><font color="#800000">'login'</font><font color="#808080">: </font><font color="#800000">''</font><font color="#808080">, </font><font color="#800000">'senha'</font><font color="#808080">: </font><font color="#800000">'' </font><font color="#808080">}
</font><font color="#000080">tPais </font><font color="#808080">= { </font><font color="#800000">'codigo'</font><font color="#808080">: </font><font color="#800000">''</font><font color="#808080">, </font><font color="#800000">'pais'</font><font color="#808080">: </font><font color="#800000">'' </font><font color="#808080">}
</font><font color="#000080">tProfissao </font><font color="#808080">= { </font><font color="#800000">'codigo'</font><font color="#808080">: </font><font color="#800000">''</font><font color="#808080">, </font><font color="#800000">'profissao'</font><font color="#808080">: </font><font color="#800000">'' </font><font color="#808080">}
</font><font color="#000080">tLivro </font><font color="#808080">= { </font><font color="#800000">'isbn'</font><font color="#808080">: </font><font color="#800000">''</font><font color="#808080">, </font><font color="#800000">'titulo'</font><font color="#808080">: </font><font color="#800000">''</font><font color="#808080">, </font><font color="#800000">'edicao'</font><font color="#808080">: </font><font color="#800000">''</font><font color="#808080">, </font><font color="#800000">'anopubli'</font><font color="#808080">: </font><font color="#800000">''</font><font color="#808080">, 
           </font><font color="#800000">'codeditora'</font><font color="#808080">: </font><font color="#800000">''</font><font color="#808080">, </font><font color="#800000">'volume'</font><font color="#808080">: </font><font color="#800000">''</font><font color="#808080">, </font><font color="#800000">'codidioma'</font><font color="#808080">: </font><font color="#800000">''</font><font color="#808080">, 
           </font><font color="#800000">'npaginas'</font><font color="#808080">: </font><font color="#800000">''</font><font color="#808080">, </font><font color="#800000">'preco'</font><font color="#808080">: </font><font color="#800000">''</font><font color="#808080">, </font><font color="#800000">'qtdestoque'</font><font color="#808080">: </font><font color="#800000">'' </font><font color="#808080">}
</font><font color="#000080">tLivroAss </font><font color="#808080">= { </font><font color="#800000">'isbn'</font><font color="#808080">: </font><font color="#800000">''</font><font color="#808080">, </font><font color="#800000">'codassunto'</font><font color="#808080">: </font><font color="#800000">'' </font><font color="#808080">}
</font><font color="#000080">tLivroAut </font><font color="#808080">= { </font><font color="#800000">'isbn'</font><font color="#808080">: </font><font color="#800000">''</font><font color="#808080">, </font><font color="#800000">'codautor'</font><font color="#808080">: </font><font color="#800000">'' </font><font color="#808080">}
</font><font color="#000080">tCliente </font><font color="#808080">= { </font><font color="#800000">'cpf'</font><font color="#808080">: </font><font color="#800000">''</font><font color="#808080">, </font><font color="#800000">'nome'</font><font color="#808080">: </font><font color="#800000">''</font><font color="#808080">, </font><font color="#800000">'email'</font><font color="#808080">: </font><font color="#800000">''</font><font color="#808080">, </font><font color="#800000">'identidade'</font><font color="#808080">: </font><font color="#800000">''</font><font color="#808080">, 
             </font><font color="#800000">'sexo'</font><font color="#808080">: </font><font color="#800000">''</font><font color="#808080">, </font><font color="#800000">'telefone'</font><font color="#808080">: </font><font color="#800000">''</font><font color="#808080">, </font><font color="#800000">'dtnascimento'</font><font color="#808080">: </font><font color="#800000">''</font><font color="#808080">, 
             </font><font color="#800000">'codendereco'</font><font color="#808080">: </font><font color="#800000">''</font><font color="#808080">, </font><font color="#800000">'codpais'</font><font color="#808080">: </font><font color="#800000">''</font><font color="#808080">, </font><font color="#800000">'codprofissao'</font><font color="#808080">: </font><font color="#800000">'' </font><font color="#808080">}
</font><font color="#000080">tEndereco </font><font color="#808080">= { </font><font color="#800000">'codigo'</font><font color="#808080">: </font><font color="#800000">''</font><font color="#808080">, </font><font color="#800000">'logradouro'</font><font color="#808080">: </font><font color="#800000">''</font><font color="#808080">, </font><font color="#800000">'bairro'</font><font color="#808080">: </font><font color="#800000">''</font><font color="#808080">, 
              </font><font color="#800000">'cep'</font><font color="#808080">: </font><font color="#800000">''</font><font color="#808080">, </font><font color="#800000">'cidade'</font><font color="#808080">: </font><font color="#800000">''</font><font color="#808080">, </font><font color="#800000">'estado'</font><font color="#808080">: </font><font color="#800000">'' </font><font color="#808080">} 
</font><font color="#000080">tVenda </font><font color="#808080">= { </font><font color="#800000">'dthrvenda'</font><font color="#808080">: </font><font color="#800000">''</font><font color="#808080">, </font><font color="#800000">'cpf'</font><font color="#808080">: </font><font color="#800000">''</font><font color="#808080">, </font><font color="#800000">'isbn'</font><font color="#808080">: </font><font color="#800000">''</font><font color="#808080">, </font><font color="#800000">'precovenda'</font><font color="#808080">: </font><font color="#800000">'' </font><font color="#808080">}

</font><font color="#000080">ctTipo </font><font color="#808080">= [</font><font color="#800000">'opTexto'</font><font color="#808080">, </font><font color="#800000">'opNumero'</font><font color="#808080">, </font><font color="#800000">'opData'</font><font color="#808080">, </font><font color="#800000">'opDataHora'</font><font color="#808080">, </font><font color="#800000">'opSenha'</font><font color="#808080">]
</font><font color="#000080">ctArqs </font><font color="#808080">= [</font><font color="#800000">'opAssunto'</font><font color="#808080">, </font><font color="#800000">'opAutor'</font><font color="#808080">, </font><font color="#800000">'opEditora'</font><font color="#808080">, </font><font color="#800000">'opEndereco'</font><font color="#808080">, </font><font color="#800000">'opIdioma'</font><font color="#808080">, </font><font color="#800000">'opPais'</font><font color="#808080">,
          </font><font color="#800000">'opProfissao'</font><font color="#808080">, </font><font color="#800000">'opCliente'</font><font color="#808080">, </font><font color="#800000">'opLivro'</font><font color="#808080">, </font><font color="#800000">'opLivroAss'</font><font color="#808080">, </font><font color="#800000">'opLivroAut'</font><font color="#808080">,
          </font><font color="#800000">'opUsuario'</font><font color="#808080">, </font><font color="#800000">'opVenda'</font><font color="#808080">]
</font><font color="#000080">ctAcao </font><font color="#808080">= [</font><font color="#800000">'opNovo'</font><font color="#808080">, </font><font color="#800000">'opAlterar'</font><font color="#808080">, </font><font color="#800000">'opPesquisar'</font><font color="#808080">, </font><font color="#800000">'opSalvarInclusao'</font><font color="#808080">,
          </font><font color="#800000">'opSalvarAlteracao'</font><font color="#808080">, </font><font color="#800000">'opExcluir'</font><font color="#808080">, </font><font color="#800000">'opConfirmaExclusao'</font><font color="#808080">, </font><font color="#800000">'opListarTodos'</font><font color="#808080">]

<i># constantes

</i></font><font color="#000080">CRLF </font><font color="#808080">= </font><font color="#800000">'\n' </font><font color="#808080"><i># windows
</i></font><font color="#000080">TAM_CRLF </font><font color="#808080">= </font><font color="#FF0000">1
</font><font color="#808080"><i># CRLF = '\n'
# TAM_CRLF = 1 # unix 
# CRLF = '\r'
# TAM_CRLF = 1 # macintosh 

</i></font><font color="#000080">ARQ_ABRE </font><font color="#808080">= </font><font color="#800000">'r+'
</font><font color="#000080">ARQ_CRIA </font><font color="#808080">= </font><font color="#800000">'w'

</font><font color="#000080">SEEK_SET </font><font color="#808080">= </font><font color="#FF0000">0
</font><font color="#000080">SEEK_CUR </font><font color="#808080">= </font><font color="#FF0000">1
</font><font color="#000080">SEEK_END </font><font color="#808080">= </font><font color="#FF0000">2

</font><font color="#000080">QTD_MAX_LINHA </font><font color="#808080">= </font><font color="#FF0000">18

</font><font color="#000080">MSG_ERRO </font><font color="#808080">= </font><font color="#800000">'Erro: opcao invalida digite de novo'
</font><font color="#000080">MSG_OPCAO </font><font color="#808080">= </font><font color="#800000">'Escolha uma opcao: '
</font><font color="#000080">MSG_PRESS </font><font color="#808080">= </font><font color="#800000">'pressione para continuar...'

</font><font color="#000080">MSG_REGINC </font><font color="#808080">= </font><font color="#800000">'registro incluido!'
</font><font color="#000080">MSG_REGNINC </font><font color="#808080">= </font><font color="#800000">'registro nao incluido!'
</font><font color="#000080">MSG_REGALT </font><font color="#808080">= </font><font color="#800000">'registro alterado!'
</font><font color="#000080">MSG_REGNALT </font><font color="#808080">= </font><font color="#800000">'registro nao alterado!'
</font><font color="#000080">MSG_REGEXC </font><font color="#808080">= </font><font color="#800000">'registro excluido!'
</font><font color="#000080">MSG_REGNEXC </font><font color="#808080">= </font><font color="#800000">'registro nao excluido!'
</font><font color="#000080">MSG_REGEXST </font><font color="#808080">= </font><font color="#800000">'registro ja existe!'

</font><font color="#000080">MSG_NUMINV </font><font color="#808080">= </font><font color="#800000">'Numero invalido ou menor do que 1!'
</font><font color="#000080">MSG_DATAINV </font><font color="#808080">= </font><font color="#800000">'Data invalida!, formato correto (dd/mm/yyyy)'
</font><font color="#000080">MSG_DTHRINV </font><font color="#808080">= </font><font color="#800000">'Data/hora invalida!, formato correto (dd/mm/yyyy hh:mm:ss)'
</font><font color="#000080">MSG_ISBNINV </font><font color="#808080">= </font><font color="#800000">'ISBN invalido!'
</font><font color="#000080">MSG_CPFINV </font><font color="#808080">= </font><font color="#800000">'CPF invalido!'
</font><font color="#000080">MSG_SENCONFERE </font><font color="#808080">= </font><font color="#800000">'senha nao confere com a senha atual!'
</font><font color="#000080">MSG_SENCONFIRM </font><font color="#808080">= </font><font color="#800000">'nova senha nao confere com a senha confirmada!'
</font><font color="#000080">MSG_LOGINENCON </font><font color="#808080">= </font><font color="#800000">'login nao encontrado!'
</font><font color="#000080">MSG_SEMESTOQUE </font><font color="#808080">= </font><font color="#800000">'livro nao existe no estoque!'

</font><font color="#000080">ARQ_ASSUNTO </font><font color="#808080">= </font><font color="#800000">'assunto.dat'
</font><font color="#000080">ARQ_AUTOR </font><font color="#808080">= </font><font color="#800000">'autor.dat'
</font><font color="#000080">ARQ_EDITORA </font><font color="#808080">= </font><font color="#800000">'editora.dat'
</font><font color="#000080">ARQ_IDIOMA </font><font color="#808080">= </font><font color="#800000">'idioma.dat'
</font><font color="#000080">ARQ_USUARIO </font><font color="#808080">= </font><font color="#800000">'usuario.dat'
</font><font color="#000080">ARQ_PAIS </font><font color="#808080">= </font><font color="#800000">'pais.dat'
</font><font color="#000080">ARQ_PROFISSAO </font><font color="#808080">= </font><font color="#800000">'profissao.dat'
</font><font color="#000080">ARQ_LIVRO </font><font color="#808080">= </font><font color="#800000">'livro.dat'
</font><font color="#000080">ARQ_LIVASS </font><font color="#808080">= </font><font color="#800000">'livroass.dat'
</font><font color="#000080">ARQ_LIVAUT </font><font color="#808080">= </font><font color="#800000">'livroaut.dat'
</font><font color="#000080">ARQ_CLIENTE </font><font color="#808080">= </font><font color="#800000">'cliente.dat'
</font><font color="#000080">ARQ_ENDERECO </font><font color="#808080">= </font><font color="#800000">'endereco.dat'
</font><font color="#000080">ARQ_VENDA </font><font color="#808080">= </font><font color="#800000">'venda.dat'

</font><font color="#000080">TAM_ASSUNTO </font><font color="#808080">= </font><font color="#FF0000">40
</font><font color="#000080">TAM_AUTOR </font><font color="#808080">= </font><font color="#FF0000">40
</font><font color="#000080">TAM_EDITORA </font><font color="#808080">= </font><font color="#FF0000">60
</font><font color="#000080">TAM_IDIOMA </font><font color="#808080">= </font><font color="#FF0000">30
</font><font color="#000080">TAM_USUARIO </font><font color="#808080">= </font><font color="#FF0000">20
</font><font color="#000080">TAM_PAIS </font><font color="#808080">= </font><font color="#FF0000">53
</font><font color="#000080">TAM_PROFISSAO </font><font color="#808080">= </font><font color="#FF0000">60
</font><font color="#000080">TAM_LIVRO </font><font color="#808080">= </font><font color="#FF0000">143
</font><font color="#000080">TAM_LIVASS </font><font color="#808080">= </font><font color="#FF0000">23
</font><font color="#000080">TAM_LIVAUT </font><font color="#808080">= </font><font color="#FF0000">23
</font><font color="#000080">TAM_CLIENTE </font><font color="#808080">= </font><font color="#FF0000">135
</font><font color="#000080">TAM_ENDERECO </font><font color="#808080">= </font><font color="#FF0000">123
</font><font color="#000080">TAM_VENDA </font><font color="#808080">= </font><font color="#FF0000">56

</font><font color="#808080"><i># variaveis globais

</i></font><font color="#000080">bopcao </font><font color="#808080">= </font><font color="#000080"><b>False
</b>opmenu </font><font color="#808080">= </font><font color="#800000">''
</font><font color="#000080">g_nPosChave </font><font color="#808080">= { </font><font color="#800000">'opAssunto'</font><font color="#808080">: [</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#FF0000">11</font><font color="#808080">], </font><font color="#800000">'opAutor'</font><font color="#808080">: [</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#FF0000">11</font><font color="#808080">], </font><font color="#800000">'opEditora'</font><font color="#808080">: [</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#FF0000">11</font><font color="#808080">], 
          </font><font color="#800000">'opEndereco'</font><font color="#808080">: [</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#FF0000">11</font><font color="#808080">,</font><font color="#FF0000">51</font><font color="#808080">,</font><font color="#FF0000">66</font><font color="#808080">,</font><font color="#FF0000">74</font><font color="#808080">,</font><font color="#FF0000">104</font><font color="#808080">], </font><font color="#800000">'opIdioma'</font><font color="#808080">: [</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#FF0000">11</font><font color="#808080">], </font><font color="#800000">'opPais'</font><font color="#808080">: [</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#FF0000">4</font><font color="#808080">],
          </font><font color="#800000">'opProfissao'</font><font color="#808080">: [</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#FF0000">11</font><font color="#808080">], </font><font color="#800000">'opCliente'</font><font color="#808080">: [</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#FF0000">15</font><font color="#808080">,</font><font color="#FF0000">45</font><font color="#808080">,</font><font color="#FF0000">75</font><font color="#808080">,</font><font color="#FF0000">85</font><font color="#808080">,</font><font color="#FF0000">86</font><font color="#808080">,</font><font color="#FF0000">103</font><font color="#808080">,</font><font color="#FF0000">113</font><font color="#808080">,</font><font color="#FF0000">123</font><font color="#808080">,</font><font color="#FF0000">126</font><font color="#808080">], 
          </font><font color="#800000">'opLivro'</font><font color="#808080">: [</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#FF0000">14</font><font color="#808080">,</font><font color="#FF0000">64</font><font color="#808080">,</font><font color="#FF0000">74</font><font color="#808080">,</font><font color="#FF0000">84</font><font color="#808080">,</font><font color="#FF0000">94</font><font color="#808080">,</font><font color="#FF0000">104</font><font color="#808080">,</font><font color="#FF0000">114</font><font color="#808080">,</font><font color="#FF0000">124</font><font color="#808080">,</font><font color="#FF0000">134</font><font color="#808080">], </font><font color="#800000">'opLivroAss'</font><font color="#808080">: [</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#FF0000">14</font><font color="#808080">], 
          </font><font color="#800000">'opLivroAut'</font><font color="#808080">: [</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#FF0000">14</font><font color="#808080">], </font><font color="#800000">'opUsuario'</font><font color="#808080">: [</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#FF0000">11</font><font color="#808080">], </font><font color="#800000">'opVenda'</font><font color="#808080">: [</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#FF0000">20</font><font color="#808080">,</font><font color="#FF0000">34</font><font color="#808080">,</font><font color="#FF0000">47</font><font color="#808080">] }
</font><font color="#000080">g_nTamChave </font><font color="#808080">= { </font><font color="#800000">'opAssunto'</font><font color="#808080">: [</font><font color="#FF0000">10</font><font color="#808080">,</font><font color="#FF0000">30</font><font color="#808080">], </font><font color="#800000">'opAutor'</font><font color="#808080">: [</font><font color="#FF0000">10</font><font color="#808080">,</font><font color="#FF0000">30</font><font color="#808080">], </font><font color="#800000">'opEditora'</font><font color="#808080">: [</font><font color="#FF0000">10</font><font color="#808080">,</font><font color="#FF0000">50</font><font color="#808080">], 
          </font><font color="#800000">'opEndereco'</font><font color="#808080">: [</font><font color="#FF0000">10</font><font color="#808080">,</font><font color="#FF0000">40</font><font color="#808080">,</font><font color="#FF0000">15</font><font color="#808080">,</font><font color="#FF0000">8</font><font color="#808080">,</font><font color="#FF0000">30</font><font color="#808080">,</font><font color="#FF0000">20</font><font color="#808080">], </font><font color="#800000">'opIdioma'</font><font color="#808080">: [</font><font color="#FF0000">10</font><font color="#808080">,</font><font color="#FF0000">20</font><font color="#808080">], </font><font color="#800000">'opPais'</font><font color="#808080">: [</font><font color="#FF0000">3</font><font color="#808080">,</font><font color="#FF0000">50</font><font color="#808080">],
          </font><font color="#800000">'opProfissao'</font><font color="#808080">: [</font><font color="#FF0000">10</font><font color="#808080">,</font><font color="#FF0000">50</font><font color="#808080">], </font><font color="#800000">'opCliente'</font><font color="#808080">: [</font><font color="#FF0000">14</font><font color="#808080">,</font><font color="#FF0000">30</font><font color="#808080">,</font><font color="#FF0000">30</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#FF0000">17</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">,</font><font color="#FF0000">3</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">], 
          </font><font color="#800000">'opLivro'</font><font color="#808080">: [</font><font color="#FF0000">13</font><font color="#808080">,</font><font color="#FF0000">50</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">], 
          </font><font color="#800000">'opLivroAss'</font><font color="#808080">: [</font><font color="#FF0000">13</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">], </font><font color="#800000">'opLivroAut'</font><font color="#808080">: [</font><font color="#FF0000">13</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">],
          </font><font color="#800000">'opUsuario'</font><font color="#808080">: [</font><font color="#FF0000">10</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">], </font><font color="#800000">'opVenda'</font><font color="#808080">: [</font><font color="#FF0000">19</font><font color="#808080">,</font><font color="#FF0000">14</font><font color="#808080">,</font><font color="#FF0000">13</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">] }
</font><font color="#000080">g_nPreco </font><font color="#808080">= { </font><font color="#800000">'valor'</font><font color="#808080">: </font><font color="#0000FF">0.0 </font><font color="#808080">}
</font><font color="#000080">g_SalvarInclusao </font><font color="#808080">=  { </font><font color="#800000">'valor'</font><font color="#808080">: </font><font color="#000080"><b>False </b></font><font color="#808080">}

</font><font color="#000080">tf </font><font color="#808080">= { </font><font color="#800000">'Assunto'</font><font color="#808080">: </font><font color="#000080"><b>None</b></font><font color="#808080">, </font><font color="#800000">'Autor'</font><font color="#808080">: </font><font color="#000080"><b>None</b></font><font color="#808080">, </font><font color="#800000">'Editora'</font><font color="#808080">: </font><font color="#000080"><b>None</b></font><font color="#808080">, </font><font color="#800000">'Idioma'</font><font color="#808080">: </font><font color="#000080"><b>None</b></font><font color="#808080">,
       </font><font color="#800000">'Endereco'</font><font color="#808080">: </font><font color="#000080"><b>None</b></font><font color="#808080">, </font><font color="#800000">'Pais'</font><font color="#808080">: </font><font color="#000080"><b>None</b></font><font color="#808080">, </font><font color="#800000">'Profissao'</font><font color="#808080">: </font><font color="#000080"><b>None</b></font><font color="#808080">, </font><font color="#800000">'Livro'</font><font color="#808080">: </font><font color="#000080"><b>None</b></font><font color="#808080">,
       </font><font color="#800000">'LivroAss'</font><font color="#808080">: </font><font color="#000080"><b>None</b></font><font color="#808080">, </font><font color="#800000">'LivroAut'</font><font color="#808080">: </font><font color="#000080"><b>None</b></font><font color="#808080">, </font><font color="#800000">'Cliente'</font><font color="#808080">: </font><font color="#000080"><b>None</b></font><font color="#808080">, 
       </font><font color="#800000">'Usuario'</font><font color="#808080">: </font><font color="#000080"><b>None</b></font><font color="#808080">, </font><font color="#800000">'Venda'</font><font color="#808080">: </font><font color="#000080"><b>None </b></font><font color="#808080">}

<i>#--- Rotinas basicas ---------------------------------------------------------

#------------------------------------------------------------------------------
# Repete um texto um numero determinado de vezes.
# sTexto - o texto a ser repetido
# nQtd - a quantidade de vezes
# retorna - o texto repetido
#------------------------------------------------------------------------------
</i></font><font color="#000080"><b>def </b>repete</font><font color="#808080">(</font><font color="#000080">sTexto</font><font color="#808080">, </font><font color="#000080">nQtd</font><font color="#808080">):
  </font><font color="#000080">sret </font><font color="#808080">= </font><font color="#000080">sTexto
  sret </font><font color="#808080">*= </font><font color="#000080">nQtd
  <b>return </b>sret

</font><font color="#808080"><i>#------------------------------------------------------------------------------
# Coloca espacos em branco a mais de acordo com o tamanho maximo do texto.
# sTexto - o texto
# nTam - tamanho maximo do texto
# retorna - o texto com espacos em branco a mais
# ------------------------------------------------------------------------------}
</i></font><font color="#000080"><b>def </b>esp</font><font color="#808080">(</font><font color="#000080">sTexto</font><font color="#808080">, </font><font color="#000080">nTam</font><font color="#808080">):
  </font><font color="#000080"><b>return </b>string</font><font color="#808080">.</font><font color="#000080">ljust</font><font color="#808080">(</font><font color="#000080">sTexto</font><font color="#808080">, </font><font color="#000080">nTam</font><font color="#808080">)

<i>#------------------------------------------------------------------------------
# Faz uma pesquisa relativa de um texto atraves de um valor chave.
# sTexto - o texto
# sChave - a chave a ser pesquisada
# retorna - se achou ou nao a chave dentro do texto
# ------------------------------------------------------------------------------
</i></font><font color="#000080"><b>def </b>strRelativa</font><font color="#808080">(</font><font color="#000080">sTexto</font><font color="#808080">, </font><font color="#000080">sChave</font><font color="#808080">):
  </font><font color="#000080"><b>if </b>string</font><font color="#808080">.</font><font color="#000080">find</font><font color="#808080">(</font><font color="#000080">sTexto</font><font color="#808080">, </font><font color="#000080">sChave</font><font color="#808080">)!=-</font><font color="#FF0000">1</font><font color="#808080">:
    </font><font color="#000080"><b>return True
  else</b></font><font color="#808080">: 
    </font><font color="#000080"><b>return False

</b></font><font color="#808080"><i>#------------------------------------------------------------------------------
# Funcao que retorna um pedaco de uma string.
# stexto - indica a string
# nini - indica a posicao inicial do pedaco
# ntam - indica o tamanho do pedaco
# retorna - o pedaco da string
#------------------------------------------------------------------------------
</i></font><font color="#000080"><b>def </b>copy</font><font color="#808080">(</font><font color="#000080">stexto</font><font color="#808080">, </font><font color="#000080">nini</font><font color="#808080">, </font><font color="#000080">ntam</font><font color="#808080">):
  </font><font color="#000080"><b>return </b>stexto</font><font color="#808080">[</font><font color="#000080">nini</font><font color="#808080">-</font><font color="#FF0000">1</font><font color="#808080">:</font><font color="#000080">nini</font><font color="#808080">+</font><font color="#000080">ntam</font><font color="#808080">-</font><font color="#FF0000">1</font><font color="#808080">]

<i>#------------------------------------------------------------------------------
# Calcula o modulo11 de um valor qualquer.
# svalor - a mstring com o numero a ser calculado
# ndig - digito do valor a ser calculado
# retorna - o digito correto
#------------------------------------------------------------------------------
</i></font><font color="#000080"><b>def </b>modulo11</font><font color="#808080">(</font><font color="#000080">svalor</font><font color="#808080">, </font><font color="#000080">ndig</font><font color="#808080">):
  </font><font color="#000080">ncont </font><font color="#808080">= </font><font color="#FF0000">1
  </font><font color="#000080">slocal </font><font color="#808080">= </font><font color="#800000">''
  </font><font color="#000080"><b>while </b></font><font color="#808080">(</font><font color="#000080">ncont </font><font color="#808080">&lt;= </font><font color="#FF0000">11</font><font color="#808080">):
    </font><font color="#000080">slocal</font><font color="#808080">=</font><font color="#000080">copy</font><font color="#808080">(</font><font color="#000080">svalor</font><font color="#808080">,</font><font color="#000080">ncont</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">) + </font><font color="#000080">slocal
    ncont</font><font color="#808080">=</font><font color="#000080">ncont</font><font color="#808080">+</font><font color="#FF0000">1
  </font><font color="#000080">nsoma</font><font color="#808080">=</font><font color="#FF0000">0</font><font color="#808080">;
  </font><font color="#000080"><b>if </b></font><font color="#808080">(</font><font color="#000080">ndig </font><font color="#808080">== </font><font color="#FF0000">1</font><font color="#808080">):
    </font><font color="#000080">ncont</font><font color="#808080">=</font><font color="#FF0000">3</font><font color="#808080">;
  </font><font color="#000080"><b>else</b></font><font color="#808080">:
    </font><font color="#000080">ncont</font><font color="#808080">=</font><font color="#FF0000">2</font><font color="#808080">;
  </font><font color="#000080">npos </font><font color="#808080">= </font><font color="#FF0000">2
  </font><font color="#000080"><b>while </b></font><font color="#808080">(</font><font color="#000080">ncont </font><font color="#808080">&lt;= </font><font color="#FF0000">11</font><font color="#808080">):
    </font><font color="#000080">sres </font><font color="#808080">= </font><font color="#000080">copy</font><font color="#808080">(</font><font color="#000080">slocal</font><font color="#808080">,</font><font color="#000080">ncont</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">)
    </font><font color="#000080">nvalor </font><font color="#808080">= </font><font color="#000080"><b>int</b></font><font color="#808080">(</font><font color="#000080">sres</font><font color="#808080">)
    </font><font color="#000080">nsoma</font><font color="#808080">=</font><font color="#000080">nsoma </font><font color="#808080">+ (</font><font color="#000080">nvalor </font><font color="#808080">* </font><font color="#000080">npos</font><font color="#808080">)
    </font><font color="#000080">ncont</font><font color="#808080">=</font><font color="#000080">ncont</font><font color="#808080">+</font><font color="#FF0000">1
    </font><font color="#000080">npos</font><font color="#808080">=</font><font color="#000080">npos</font><font color="#808080">+</font><font color="#FF0000">1

  </font><font color="#000080">nsoma</font><font color="#808080">=(</font><font color="#FF0000">11 </font><font color="#808080">- (</font><font color="#000080">nsoma </font><font color="#808080">% </font><font color="#FF0000">11</font><font color="#808080">))
  </font><font color="#000080"><b>if </b></font><font color="#808080">(</font><font color="#000080">nsoma </font><font color="#808080">&gt; </font><font color="#FF0000">9</font><font color="#808080">):
    </font><font color="#000080"><b>return </b></font><font color="#FF0000">0
  </font><font color="#000080"><b>else</b></font><font color="#808080">:
    </font><font color="#000080"><b>return </b>nsoma

</font><font color="#808080"><i>#------------------------------------------------------------------------------
# Validacao de um numero de CPF qualquer.
# cpf - a mstring com o numero do CPF
# retorna - se e valido ou nao
#------------------------------------------------------------------------------
</i></font><font color="#000080"><b>def </b>validaCPF</font><font color="#808080">(</font><font color="#000080">cpf</font><font color="#808080">):
  </font><font color="#000080"><b>if len</b></font><font color="#808080">(</font><font color="#000080">cpf</font><font color="#808080">)==</font><font color="#FF0000">14</font><font color="#808080">:
    </font><font color="#000080"><b>try</b></font><font color="#808080">:
      </font><font color="#000080">scpf</font><font color="#808080">=</font><font color="#000080">copy</font><font color="#808080">(</font><font color="#000080">cpf</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#FF0000">3</font><font color="#808080">)+</font><font color="#000080">copy</font><font color="#808080">(</font><font color="#000080">cpf</font><font color="#808080">,</font><font color="#FF0000">5</font><font color="#808080">,</font><font color="#FF0000">3</font><font color="#808080">)+</font><font color="#000080">copy</font><font color="#808080">(</font><font color="#000080">cpf</font><font color="#808080">,</font><font color="#FF0000">9</font><font color="#808080">,</font><font color="#FF0000">3</font><font color="#808080">)+</font><font color="#000080">copy</font><font color="#808080">(</font><font color="#000080">cpf</font><font color="#808080">,</font><font color="#FF0000">13</font><font color="#808080">,</font><font color="#FF0000">2</font><font color="#808080">)
      </font><font color="#000080">sres</font><font color="#808080">=</font><font color="#000080">copy</font><font color="#808080">(</font><font color="#000080">cpf</font><font color="#808080">,</font><font color="#FF0000">13</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">)
      </font><font color="#000080">nvalor1 </font><font color="#808080">= </font><font color="#000080"><b>int</b></font><font color="#808080">(</font><font color="#000080">sres</font><font color="#808080">)
      </font><font color="#000080">sres</font><font color="#808080">=</font><font color="#000080">copy</font><font color="#808080">(</font><font color="#000080">cpf</font><font color="#808080">,</font><font color="#FF0000">14</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">)
      </font><font color="#000080">nvalor2 </font><font color="#808080">= </font><font color="#000080"><b>int</b></font><font color="#808080">(</font><font color="#000080">sres</font><font color="#808080">)
      </font><font color="#000080"><b>if </b></font><font color="#808080">(</font><font color="#000080">modulo11</font><font color="#808080">(</font><font color="#000080">scpf</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">)==</font><font color="#000080">nvalor1</font><font color="#808080">) </font><font color="#000080"><b>and </b></font><font color="#808080">(</font><font color="#000080">modulo11</font><font color="#808080">(</font><font color="#000080">scpf</font><font color="#808080">,</font><font color="#FF0000">2</font><font color="#808080">)==</font><font color="#000080">nvalor2</font><font color="#808080">):
        </font><font color="#000080"><b>return True
      else</b></font><font color="#808080">:
        </font><font color="#000080"><b>return False
    except</b></font><font color="#808080">:
      </font><font color="#000080"><b>return False
  else</b></font><font color="#808080">:
    </font><font color="#000080"><b>return False

</b></font><font color="#808080"><i>#------------------------------------------------------------------------------
# Validacao de um numero ISBN qualquer.
# isbn - a mstring com o numero do ISBN
# retorna - se e valido ou nao
#------------------------------------------------------------------------------
</i></font><font color="#000080"><b>def </b>validaISBN</font><font color="#808080">(</font><font color="#000080">isbn</font><font color="#808080">):
  </font><font color="#000080"><b>if len</b></font><font color="#808080">(</font><font color="#000080">isbn</font><font color="#808080">)==</font><font color="#FF0000">13</font><font color="#808080">:
    </font><font color="#000080">sdigito </font><font color="#808080">= </font><font color="#000080">copy</font><font color="#808080">(</font><font color="#000080">isbn</font><font color="#808080">, </font><font color="#000080"><b>len</b></font><font color="#808080">(</font><font color="#000080">isbn</font><font color="#808080">), </font><font color="#FF0000">1</font><font color="#808080">)
    </font><font color="#000080">sisbn</font><font color="#808080">=</font><font color="#800000">''
    </font><font color="#000080"><b>for </b>ncont <b>in range</b></font><font color="#808080">(</font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#000080"><b>len</b></font><font color="#808080">(</font><font color="#000080">isbn</font><font color="#808080">)):
      </font><font color="#000080"><b>if </b>copy</font><font color="#808080">(</font><font color="#000080">isbn</font><font color="#808080">,</font><font color="#000080">ncont</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">)!=</font><font color="#800000">'-'</font><font color="#808080">:
        </font><font color="#000080">sisbn</font><font color="#808080">=</font><font color="#000080">sisbn</font><font color="#808080">+</font><font color="#000080">copy</font><font color="#808080">(</font><font color="#000080">isbn</font><font color="#808080">,</font><font color="#000080">ncont</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">)

    </font><font color="#000080"><b>if </b>sdigito </font><font color="#808080">== </font><font color="#800000">'X'</font><font color="#808080">:
      </font><font color="#000080">nsoma </font><font color="#808080">= </font><font color="#FF0000">10
    </font><font color="#000080"><b>else</b></font><font color="#808080">:
      </font><font color="#000080">nvalor </font><font color="#808080">= </font><font color="#000080"><b>int</b></font><font color="#808080">(</font><font color="#000080">sdigito</font><font color="#808080">)
      </font><font color="#000080">nsoma </font><font color="#808080">= </font><font color="#000080">nvalor

    <b>for </b>ncont <b>in range</b></font><font color="#808080">(</font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">):
      </font><font color="#000080">snum </font><font color="#808080">= </font><font color="#000080">copy</font><font color="#808080">(</font><font color="#000080">sisbn</font><font color="#808080">, </font><font color="#000080">ncont</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">)
      </font><font color="#000080">nvalor </font><font color="#808080">= </font><font color="#000080"><b>int</b></font><font color="#808080">(</font><font color="#000080">snum</font><font color="#808080">)
      </font><font color="#000080">nsoma</font><font color="#808080">=</font><font color="#000080">nsoma </font><font color="#808080">+ (</font><font color="#000080">nvalor </font><font color="#808080">* (</font><font color="#FF0000">11 </font><font color="#808080">- </font><font color="#000080">ncont</font><font color="#808080">))

    </font><font color="#000080"><b>if </b></font><font color="#808080">((</font><font color="#000080">nsoma </font><font color="#808080">% </font><font color="#FF0000">11</font><font color="#808080">) == </font><font color="#FF0000">0</font><font color="#808080">):
      </font><font color="#000080"><b>return True
    else</b></font><font color="#808080">:
      </font><font color="#000080"><b>return False
  else</b></font><font color="#808080">:
    </font><font color="#000080"><b>return False

</b></font><font color="#808080"><i>#------------------------------------------------------------------------------
# Esconde a digitacao da senha
# retorna - a senha digitada
#------------------------------------------------------------------------------
</i></font><font color="#000080"><b>def </b>digitaSenha</font><font color="#808080">(</font><font color="#000080">sRotulo</font><font color="#808080">, </font><font color="#000080">nTamSenha</font><font color="#808080">):
  </font><font color="#000080">bQuebra</font><font color="#808080">=</font><font color="#000080"><b>False
  while </b></font><font color="#808080">(</font><font color="#000080">bQuebra</font><font color="#808080">==</font><font color="#000080"><b>False</b></font><font color="#808080">):
    </font><font color="#000080">sSenha </font><font color="#808080">= </font><font color="#000080">getpass</font><font color="#808080">.</font><font color="#000080">getpass</font><font color="#808080">(</font><font color="#000080">sRotulo</font><font color="#808080">)
    </font><font color="#000080"><b>if len</b></font><font color="#808080">(</font><font color="#000080">sSenha</font><font color="#808080">) &gt; </font><font color="#000080">nTamSenha</font><font color="#808080">:
       </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#800000">'senha muito extensa!'</font><font color="#808080">)
    </font><font color="#000080"><b>else</b></font><font color="#808080">: </font><font color="#000080">bQuebra</font><font color="#808080">=</font><font color="#000080"><b>True
  print</b></font><font color="#808080">(</font><font color="#800000">''</font><font color="#808080">)
  </font><font color="#000080"><b>return </b>sSenha

</font><font color="#808080"><i>#------------------------------------------------------------------------------
# Validacao de um numero qualquer.
# sRotulo - o texto antes de se digitar o numero
# sNumero - a mstring com o valor do numero
# retorna - o sNumero
#------------------------------------------------------------------------------
</i></font><font color="#000080"><b>def </b>validaNumero</font><font color="#808080">(</font><font color="#000080">sRotulo</font><font color="#808080">, </font><font color="#000080">sNumero</font><font color="#808080">):
  </font><font color="#000080">nStatus </font><font color="#808080">= -</font><font color="#FF0000">1
  </font><font color="#000080"><b>while </b>nStatus</font><font color="#808080">!=</font><font color="#FF0000">0</font><font color="#808080">:
    </font><font color="#000080"><b>try</b></font><font color="#808080">:
      </font><font color="#000080">sNumero </font><font color="#808080">= </font><font color="#000080"><b>raw_input</b></font><font color="#808080">(</font><font color="#000080">sRotulo</font><font color="#808080">)
      </font><font color="#000080">nnum </font><font color="#808080">= </font><font color="#000080"><b>int</b></font><font color="#808080">(</font><font color="#000080">sNumero</font><font color="#808080">)
      </font><font color="#000080"><b>if </b></font><font color="#808080">(</font><font color="#000080">nnum </font><font color="#808080">&lt; </font><font color="#FF0000">1</font><font color="#808080">):
        </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#000080">MSG_NUMINV</font><font color="#808080">)
      </font><font color="#000080"><b>else</b></font><font color="#808080">:
        </font><font color="#000080">nStatus</font><font color="#808080">=</font><font color="#FF0000">0
    </font><font color="#000080"><b>except</b></font><font color="#808080">:
      </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#000080">MSG_NUMINV</font><font color="#808080">)
  
  </font><font color="#000080"><b>return </b>sNumero

</font><font color="#808080"><i>#------------------------------------------------------------------------------
# Validacao de uma data ou data/hora qualquer.
# sRotulo - o texto antes de se digitar a data/hora
# sDataHora - a mstring com o valor da data/hora
# bSoData - indica se vai validar somente uma data sem a hora
# retorna - a sDataHora
#------------------------------------------------------------------------------
</i></font><font color="#000080"><b>def </b>validaDataHora</font><font color="#808080">(</font><font color="#000080">sRotulo</font><font color="#808080">, </font><font color="#000080">sDataHora</font><font color="#808080">, </font><font color="#000080">bSoData</font><font color="#808080">):
  </font><font color="#000080">bvalida</font><font color="#808080">=</font><font color="#000080"><b>False
  </b>bdatavalida</font><font color="#808080">=</font><font color="#000080"><b>False
  </b>bhoravalida</font><font color="#808080">=</font><font color="#000080"><b>False
  </b>nudiames</font><font color="#808080">=</font><font color="#FF0000">0
  </font><font color="#000080"><b>if </b>bSoData</font><font color="#808080">==</font><font color="#000080"><b>True</b></font><font color="#808080">: </font><font color="#000080">ntam</font><font color="#808080">=</font><font color="#FF0000">10
  </font><font color="#000080"><b>else</b></font><font color="#808080">: </font><font color="#000080">ntam</font><font color="#808080">=</font><font color="#FF0000">19
  </font><font color="#000080"><b>while </b>bvalida</font><font color="#808080">==</font><font color="#000080"><b>False</b></font><font color="#808080">:
    </font><font color="#000080"><b>try</b></font><font color="#808080">:
      </font><font color="#000080">sDataHora </font><font color="#808080">= </font><font color="#000080"><b>raw_input</b></font><font color="#808080">(</font><font color="#000080">sRotulo</font><font color="#808080">)
  
      </font><font color="#000080"><b>if len</b></font><font color="#808080">(</font><font color="#000080">sDataHora</font><font color="#808080">)==</font><font color="#000080">ntam</font><font color="#808080">:
        </font><font color="#000080">sdia </font><font color="#808080">= </font><font color="#000080">copy</font><font color="#808080">(</font><font color="#000080">sDataHora</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#FF0000">2</font><font color="#808080">)
        </font><font color="#000080">ndia </font><font color="#808080">= </font><font color="#000080"><b>int</b></font><font color="#808080">(</font><font color="#000080">sdia</font><font color="#808080">)
        </font><font color="#000080">smes </font><font color="#808080">= </font><font color="#000080">copy</font><font color="#808080">(</font><font color="#000080">sDataHora</font><font color="#808080">,</font><font color="#FF0000">4</font><font color="#808080">,</font><font color="#FF0000">2</font><font color="#808080">)
        </font><font color="#000080">nmes </font><font color="#808080">= </font><font color="#000080"><b>int</b></font><font color="#808080">(</font><font color="#000080">smes</font><font color="#808080">)
        </font><font color="#000080">sano </font><font color="#808080">= </font><font color="#000080">copy</font><font color="#808080">(</font><font color="#000080">sDataHora</font><font color="#808080">,</font><font color="#FF0000">7</font><font color="#808080">,</font><font color="#FF0000">4</font><font color="#808080">)
        </font><font color="#000080">nano </font><font color="#808080">= </font><font color="#000080"><b>int</b></font><font color="#808080">(</font><font color="#000080">sano</font><font color="#808080">)
      
        </font><font color="#000080"><b>if </b></font><font color="#808080">(</font><font color="#000080">nano </font><font color="#808080">&gt;= </font><font color="#FF0000">1</font><font color="#808080">) </font><font color="#000080"><b>and </b></font><font color="#808080">(</font><font color="#000080">nano </font><font color="#808080">&lt;= </font><font color="#FF0000">9999</font><font color="#808080">):
          </font><font color="#000080"><b>if </b></font><font color="#808080">(</font><font color="#000080">nmes </font><font color="#808080">&gt;= </font><font color="#FF0000">1</font><font color="#808080">) </font><font color="#000080"><b>and </b></font><font color="#808080">(</font><font color="#000080">nmes </font><font color="#808080">&lt;= </font><font color="#FF0000">31</font><font color="#808080">):
              </font><font color="#000080"><b>if </b>nmes <b>in </b></font><font color="#808080">[</font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">, </font><font color="#FF0000">5</font><font color="#808080">, </font><font color="#FF0000">7</font><font color="#808080">, </font><font color="#FF0000">8</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">, </font><font color="#FF0000">12</font><font color="#808080">]: 
                </font><font color="#000080">nudiames </font><font color="#808080">= </font><font color="#FF0000">31
              </font><font color="#000080"><b>elif </b>nmes </font><font color="#808080">== </font><font color="#FF0000">2</font><font color="#808080">: 
                <i># ano bissexto 
                </i></font><font color="#000080"><b>if </b></font><font color="#808080">(</font><font color="#000080">nano </font><font color="#808080">% </font><font color="#FF0000">4</font><font color="#808080">) == </font><font color="#FF0000">0</font><font color="#808080">: 
                  </font><font color="#000080">nudiames </font><font color="#808080">= </font><font color="#FF0000">29
                </font><font color="#000080"><b>else</b></font><font color="#808080">: </font><font color="#000080">nudiames </font><font color="#808080">= </font><font color="#FF0000">28
              </font><font color="#000080"><b>elif </b>nmes <b>in </b></font><font color="#808080">[</font><font color="#FF0000">4</font><font color="#808080">, </font><font color="#FF0000">6</font><font color="#808080">, </font><font color="#FF0000">9</font><font color="#808080">, </font><font color="#FF0000">11</font><font color="#808080">]: 
                </font><font color="#000080">nudiames </font><font color="#808080">= </font><font color="#FF0000">30
              </font><font color="#000080"><b>if </b></font><font color="#808080">(</font><font color="#000080">ndia </font><font color="#808080">&gt;=</font><font color="#FF0000">1</font><font color="#808080">) </font><font color="#000080"><b>and </b></font><font color="#808080">(</font><font color="#000080">ndia </font><font color="#808080">&lt;=</font><font color="#000080">nudiames</font><font color="#808080">):
                 </font><font color="#000080">bdatavalida </font><font color="#808080">= </font><font color="#000080"><b>True
      
        if </b>bSoData</font><font color="#808080">:
           </font><font color="#000080"><b>if </b>bdatavalida</font><font color="#808080">: </font><font color="#000080">bvalida </font><font color="#808080">= </font><font color="#000080"><b>True
           else</b></font><font color="#808080">: </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#000080">MSG_DATAINV</font><font color="#808080">)
        </font><font color="#000080"><b>else</b></font><font color="#808080">:
          </font><font color="#000080"><b>if </b>bdatavalida</font><font color="#808080">:
              </font><font color="#000080">shora </font><font color="#808080">= </font><font color="#000080">copy</font><font color="#808080">(</font><font color="#000080">sDataHora</font><font color="#808080">,</font><font color="#FF0000">12</font><font color="#808080">,</font><font color="#FF0000">2</font><font color="#808080">)
              </font><font color="#000080">nhora </font><font color="#808080">= </font><font color="#000080"><b>int</b></font><font color="#808080">(</font><font color="#000080">shora</font><font color="#808080">)
              </font><font color="#000080">smin </font><font color="#808080">= </font><font color="#000080">copy</font><font color="#808080">(</font><font color="#000080">sDataHora</font><font color="#808080">,</font><font color="#FF0000">15</font><font color="#808080">,</font><font color="#FF0000">2</font><font color="#808080">)
              </font><font color="#000080">nmin </font><font color="#808080">= </font><font color="#000080"><b>int</b></font><font color="#808080">(</font><font color="#000080">smin</font><font color="#808080">)
              </font><font color="#000080">sseg </font><font color="#808080">= </font><font color="#000080">copy</font><font color="#808080">(</font><font color="#000080">sDataHora</font><font color="#808080">,</font><font color="#FF0000">18</font><font color="#808080">,</font><font color="#FF0000">2</font><font color="#808080">)
              </font><font color="#000080">nseg </font><font color="#808080">= </font><font color="#000080"><b>int</b></font><font color="#808080">(</font><font color="#000080">sseg</font><font color="#808080">)
          
              </font><font color="#000080"><b>if </b></font><font color="#808080">(</font><font color="#000080">nhora </font><font color="#808080">&gt;= </font><font color="#FF0000">0</font><font color="#808080">) </font><font color="#000080"><b>and </b></font><font color="#808080">(</font><font color="#000080">nhora </font><font color="#808080">&lt;= </font><font color="#FF0000">23</font><font color="#808080">):
                </font><font color="#000080"><b>if </b></font><font color="#808080">(</font><font color="#000080">nmin </font><font color="#808080">&gt;= </font><font color="#FF0000">0</font><font color="#808080">) </font><font color="#000080"><b>and </b></font><font color="#808080">(</font><font color="#000080">nmin </font><font color="#808080">&lt;= </font><font color="#FF0000">59</font><font color="#808080">):
                  </font><font color="#000080"><b>if </b></font><font color="#808080">(</font><font color="#000080">nseg </font><font color="#808080">&gt;= </font><font color="#FF0000">0</font><font color="#808080">) </font><font color="#000080"><b>and </b></font><font color="#808080">(</font><font color="#000080">nseg </font><font color="#808080">&lt;= </font><font color="#FF0000">59</font><font color="#808080">):
                     </font><font color="#000080">bhoravalida </font><font color="#808080">= </font><font color="#000080"><b>True
          
              if </b>bhoravalida</font><font color="#808080">: </font><font color="#000080">bvalida </font><font color="#808080">= </font><font color="#000080"><b>True
              else</b></font><font color="#808080">: </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#000080">MSG_DTHRINV</font><font color="#808080">)
          </font><font color="#000080"><b>else</b></font><font color="#808080">:
            </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#000080">MSG_DTHRINV</font><font color="#808080">)
      </font><font color="#000080"><b>else</b></font><font color="#808080">:
        </font><font color="#000080"><b>if </b>bSoData</font><font color="#808080">==</font><font color="#000080"><b>True</b></font><font color="#808080">: </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#000080">MSG_DATAINV</font><font color="#808080">)
        </font><font color="#000080"><b>else</b></font><font color="#808080">: </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#000080">MSG_DTHRINV</font><font color="#808080">)
    </font><font color="#000080"><b>except</b></font><font color="#808080">:
      </font><font color="#000080"><b>if </b>bSoData</font><font color="#808080">==</font><font color="#000080"><b>True</b></font><font color="#808080">: </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#000080">MSG_DATAINV</font><font color="#808080">)
      </font><font color="#000080"><b>else</b></font><font color="#808080">: </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#000080">MSG_DTHRINV</font><font color="#808080">)

  </font><font color="#000080"><b>return </b>sDataHora

</font><font color="#808080"><i>#------------------------------------------------------------------------------
# Retorna a Data e a hora do sistema.
# retorna - a data e a hora
#------------------------------------------------------------------------------
</i></font><font color="#000080"><b>def </b>retDataHora</font><font color="#808080">():
  </font><font color="#000080"><b>return </b>strftime</font><font color="#808080">(</font><font color="#800000">'%d/%m/%Y %H:%M:%S'</font><font color="#808080">, </font><font color="#000080">localtime</font><font color="#808080">())

<i>#--- Rotinas de manipulacao de arquivos --------------------------------------

#------------------------------------------------------------------------------
# Calcula o tamanho do arquivo.
# sArq - o arquivo
# retorna - o tamanho do arquivo
#------------------------------------------------------------------------------
</i></font><font color="#000080"><b>def </b>tamArq</font><font color="#808080">(</font><font color="#000080">sArq</font><font color="#808080">):
  </font><font color="#000080">ntam </font><font color="#808080">= </font><font color="#FF0000">0
  
  </font><font color="#000080">sArq</font><font color="#808080">.</font><font color="#000080">seek</font><font color="#808080">(</font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#000080">SEEK_END</font><font color="#808080">)
  </font><font color="#000080">ntam </font><font color="#808080">= </font><font color="#000080">sArq</font><font color="#808080">.</font><font color="#000080">tell</font><font color="#808080">()
  </font><font color="#000080">sArq</font><font color="#808080">.</font><font color="#000080">seek</font><font color="#808080">(</font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#000080">SEEK_SET</font><font color="#808080">)
  
  </font><font color="#000080"><b>return </b>ntam

</font><font color="#808080"><i>#------------------------------------------------------------------------------
# Abre ou cria os arquivos do sistema.
# bAbre - condicao para abrir ou criar os arquivos do sistema
#------------------------------------------------------------------------------
</i></font><font color="#000080"><b>def </b>abrecriaArqs</font><font color="#808080">(</font><font color="#000080">bAbre</font><font color="#808080">):
  </font><font color="#000080"><b>if </b>bAbre</font><font color="#808080">:
    </font><font color="#000080">tf</font><font color="#808080">[</font><font color="#800000">'Assunto'</font><font color="#808080">] = </font><font color="#000080"><b>open</b></font><font color="#808080">(</font><font color="#000080">ARQ_ASSUNTO</font><font color="#808080">,</font><font color="#000080">ARQ_ABRE</font><font color="#808080">)
    </font><font color="#000080">tf</font><font color="#808080">[</font><font color="#800000">'Autor'</font><font color="#808080">] = </font><font color="#000080"><b>open</b></font><font color="#808080">(</font><font color="#000080">ARQ_AUTOR</font><font color="#808080">,</font><font color="#000080">ARQ_ABRE</font><font color="#808080">)
    </font><font color="#000080">tf</font><font color="#808080">[</font><font color="#800000">'Editora'</font><font color="#808080">] = </font><font color="#000080"><b>open</b></font><font color="#808080">(</font><font color="#000080">ARQ_EDITORA</font><font color="#808080">,</font><font color="#000080">ARQ_ABRE</font><font color="#808080">)
    </font><font color="#000080">tf</font><font color="#808080">[</font><font color="#800000">'Idioma'</font><font color="#808080">] = </font><font color="#000080"><b>open</b></font><font color="#808080">(</font><font color="#000080">ARQ_IDIOMA</font><font color="#808080">,</font><font color="#000080">ARQ_ABRE</font><font color="#808080">)
    </font><font color="#000080">tf</font><font color="#808080">[</font><font color="#800000">'Endereco'</font><font color="#808080">] = </font><font color="#000080"><b>open</b></font><font color="#808080">(</font><font color="#000080">ARQ_ENDERECO</font><font color="#808080">,</font><font color="#000080">ARQ_ABRE</font><font color="#808080">)
    </font><font color="#000080">tf</font><font color="#808080">[</font><font color="#800000">'Pais'</font><font color="#808080">] = </font><font color="#000080"><b>open</b></font><font color="#808080">(</font><font color="#000080">ARQ_PAIS</font><font color="#808080">,</font><font color="#000080">ARQ_ABRE</font><font color="#808080">)
    </font><font color="#000080">tf</font><font color="#808080">[</font><font color="#800000">'Profissao'</font><font color="#808080">] = </font><font color="#000080"><b>open</b></font><font color="#808080">(</font><font color="#000080">ARQ_PROFISSAO</font><font color="#808080">,</font><font color="#000080">ARQ_ABRE</font><font color="#808080">)
    </font><font color="#000080">tf</font><font color="#808080">[</font><font color="#800000">'Livro'</font><font color="#808080">] = </font><font color="#000080"><b>open</b></font><font color="#808080">(</font><font color="#000080">ARQ_LIVRO</font><font color="#808080">,</font><font color="#000080">ARQ_ABRE</font><font color="#808080">)
    </font><font color="#000080">tf</font><font color="#808080">[</font><font color="#800000">'LivroAss'</font><font color="#808080">] = </font><font color="#000080"><b>open</b></font><font color="#808080">(</font><font color="#000080">ARQ_LIVASS</font><font color="#808080">,</font><font color="#000080">ARQ_ABRE</font><font color="#808080">)
    </font><font color="#000080">tf</font><font color="#808080">[</font><font color="#800000">'LivroAut'</font><font color="#808080">] = </font><font color="#000080"><b>open</b></font><font color="#808080">(</font><font color="#000080">ARQ_LIVAUT</font><font color="#808080">,</font><font color="#000080">ARQ_ABRE</font><font color="#808080">)
    </font><font color="#000080">tf</font><font color="#808080">[</font><font color="#800000">'Cliente'</font><font color="#808080">] = </font><font color="#000080"><b>open</b></font><font color="#808080">(</font><font color="#000080">ARQ_CLIENTE</font><font color="#808080">,</font><font color="#000080">ARQ_ABRE</font><font color="#808080">)
    </font><font color="#000080">tf</font><font color="#808080">[</font><font color="#800000">'Usuario'</font><font color="#808080">] = </font><font color="#000080"><b>open</b></font><font color="#808080">(</font><font color="#000080">ARQ_USUARIO</font><font color="#808080">,</font><font color="#000080">ARQ_ABRE</font><font color="#808080">)
    </font><font color="#000080">tf</font><font color="#808080">[</font><font color="#800000">'Venda'</font><font color="#808080">] = </font><font color="#000080"><b>open</b></font><font color="#808080">(</font><font color="#000080">ARQ_VENDA</font><font color="#808080">,</font><font color="#000080">ARQ_ABRE</font><font color="#808080">) 
  </font><font color="#000080"><b>else</b></font><font color="#808080">:
    </font><font color="#000080">tf</font><font color="#808080">[</font><font color="#800000">'Assunto'</font><font color="#808080">] = </font><font color="#000080"><b>open</b></font><font color="#808080">(</font><font color="#000080">ARQ_ASSUNTO</font><font color="#808080">,</font><font color="#000080">ARQ_CRIA</font><font color="#808080">)
    </font><font color="#000080">tf</font><font color="#808080">[</font><font color="#800000">'Autor'</font><font color="#808080">] = </font><font color="#000080"><b>open</b></font><font color="#808080">(</font><font color="#000080">ARQ_AUTOR</font><font color="#808080">,</font><font color="#000080">ARQ_CRIA</font><font color="#808080">)
    </font><font color="#000080">tf</font><font color="#808080">[</font><font color="#800000">'Editora'</font><font color="#808080">] = </font><font color="#000080"><b>open</b></font><font color="#808080">(</font><font color="#000080">ARQ_EDITORA</font><font color="#808080">,</font><font color="#000080">ARQ_CRIA</font><font color="#808080">)
    </font><font color="#000080">tf</font><font color="#808080">[</font><font color="#800000">'Idioma'</font><font color="#808080">] = </font><font color="#000080"><b>open</b></font><font color="#808080">(</font><font color="#000080">ARQ_IDIOMA</font><font color="#808080">,</font><font color="#000080">ARQ_CRIA</font><font color="#808080">)
    </font><font color="#000080">tf</font><font color="#808080">[</font><font color="#800000">'Endereco'</font><font color="#808080">] = </font><font color="#000080"><b>open</b></font><font color="#808080">(</font><font color="#000080">ARQ_ENDERECO</font><font color="#808080">,</font><font color="#000080">ARQ_CRIA</font><font color="#808080">)
    </font><font color="#000080">tf</font><font color="#808080">[</font><font color="#800000">'Pais'</font><font color="#808080">] = </font><font color="#000080"><b>open</b></font><font color="#808080">(</font><font color="#000080">ARQ_PAIS</font><font color="#808080">,</font><font color="#000080">ARQ_CRIA</font><font color="#808080">)
    </font><font color="#000080">tf</font><font color="#808080">[</font><font color="#800000">'Profissao'</font><font color="#808080">] = </font><font color="#000080"><b>open</b></font><font color="#808080">(</font><font color="#000080">ARQ_PROFISSAO</font><font color="#808080">,</font><font color="#000080">ARQ_CRIA</font><font color="#808080">)
    </font><font color="#000080">tf</font><font color="#808080">[</font><font color="#800000">'Livro'</font><font color="#808080">] = </font><font color="#000080"><b>open</b></font><font color="#808080">(</font><font color="#000080">ARQ_LIVRO</font><font color="#808080">,</font><font color="#000080">ARQ_CRIA</font><font color="#808080">)
    </font><font color="#000080">tf</font><font color="#808080">[</font><font color="#800000">'LivroAss'</font><font color="#808080">] = </font><font color="#000080"><b>open</b></font><font color="#808080">(</font><font color="#000080">ARQ_LIVASS</font><font color="#808080">,</font><font color="#000080">ARQ_CRIA</font><font color="#808080">)
    </font><font color="#000080">tf</font><font color="#808080">[</font><font color="#800000">'LivroAut'</font><font color="#808080">] = </font><font color="#000080"><b>open</b></font><font color="#808080">(</font><font color="#000080">ARQ_LIVAUT</font><font color="#808080">,</font><font color="#000080">ARQ_CRIA</font><font color="#808080">)
    </font><font color="#000080">tf</font><font color="#808080">[</font><font color="#800000">'Cliente'</font><font color="#808080">] = </font><font color="#000080"><b>open</b></font><font color="#808080">(</font><font color="#000080">ARQ_CLIENTE</font><font color="#808080">,</font><font color="#000080">ARQ_CRIA</font><font color="#808080">)
    </font><font color="#000080">tf</font><font color="#808080">[</font><font color="#800000">'Usuario'</font><font color="#808080">] = </font><font color="#000080"><b>open</b></font><font color="#808080">(</font><font color="#000080">ARQ_USUARIO</font><font color="#808080">,</font><font color="#000080">ARQ_CRIA</font><font color="#808080">)
    </font><font color="#000080">tf</font><font color="#808080">[</font><font color="#800000">'Venda'</font><font color="#808080">] = </font><font color="#000080"><b>open</b></font><font color="#808080">(</font><font color="#000080">ARQ_VENDA</font><font color="#808080">,</font><font color="#000080">ARQ_CRIA</font><font color="#808080">)

<i>#------------------------------------------------------------------------------
# Fecha todos os arquivos abertos.
#------------------------------------------------------------------------------
</i></font><font color="#000080"><b>def </b>fechaArqs</font><font color="#808080">():
  </font><font color="#000080">tf</font><font color="#808080">[</font><font color="#800000">'Assunto'</font><font color="#808080">].</font><font color="#000080">close</font><font color="#808080">()
  </font><font color="#000080">tf</font><font color="#808080">[</font><font color="#800000">'Autor'</font><font color="#808080">].</font><font color="#000080">close</font><font color="#808080">()
  </font><font color="#000080">tf</font><font color="#808080">[</font><font color="#800000">'Editora'</font><font color="#808080">].</font><font color="#000080">close</font><font color="#808080">()
  </font><font color="#000080">tf</font><font color="#808080">[</font><font color="#800000">'Idioma'</font><font color="#808080">].</font><font color="#000080">close</font><font color="#808080">()
  </font><font color="#000080">tf</font><font color="#808080">[</font><font color="#800000">'Endereco'</font><font color="#808080">].</font><font color="#000080">close</font><font color="#808080">()
  </font><font color="#000080">tf</font><font color="#808080">[</font><font color="#800000">'Pais'</font><font color="#808080">].</font><font color="#000080">close</font><font color="#808080">()
  </font><font color="#000080">tf</font><font color="#808080">[</font><font color="#800000">'Profissao'</font><font color="#808080">].</font><font color="#000080">close</font><font color="#808080">()
  </font><font color="#000080">tf</font><font color="#808080">[</font><font color="#800000">'Livro'</font><font color="#808080">].</font><font color="#000080">close</font><font color="#808080">()
  </font><font color="#000080">tf</font><font color="#808080">[</font><font color="#800000">'LivroAss'</font><font color="#808080">].</font><font color="#000080">close</font><font color="#808080">()
  </font><font color="#000080">tf</font><font color="#808080">[</font><font color="#800000">'LivroAut'</font><font color="#808080">].</font><font color="#000080">close</font><font color="#808080">()
  </font><font color="#000080">tf</font><font color="#808080">[</font><font color="#800000">'Cliente'</font><font color="#808080">].</font><font color="#000080">close</font><font color="#808080">()
  </font><font color="#000080">tf</font><font color="#808080">[</font><font color="#800000">'Usuario'</font><font color="#808080">].</font><font color="#000080">close</font><font color="#808080">()
  </font><font color="#000080">tf</font><font color="#808080">[</font><font color="#800000">'Venda'</font><font color="#808080">].</font><font color="#000080">close</font><font color="#808080">()

<i>#------------------------------------------------------------------------------
# Pesquisa um registro atraves de um valor chave num arquivo.
# sArq - o arquivo
# sChave - a chave a ser pesquisada
# nPosChave - a posicao inicial da chave dentro do registro
# nTamChave - o tamanho da chave dentro do registro
# nTamLinha - o tamanho do registro
# retorna - o registro pesquisado
#------------------------------------------------------------------------------
</i></font><font color="#000080"><b>def </b>pesqArq</font><font color="#808080">(</font><font color="#000080">sArq</font><font color="#808080">, </font><font color="#000080">sChave</font><font color="#808080">, </font><font color="#000080">nPosChave</font><font color="#808080">, </font><font color="#000080">nTamChave</font><font color="#808080">, </font><font color="#000080">nTamLinha</font><font color="#808080">):
  </font><font color="#000080">slinha</font><font color="#808080">=</font><font color="#800000">'0'
  </font><font color="#000080">bQuebra </font><font color="#808080">= </font><font color="#000080"><b>False
  </b>sArq</font><font color="#808080">.</font><font color="#000080">seek</font><font color="#808080">(</font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#000080">SEEK_SET</font><font color="#808080">)
  </font><font color="#000080"><b>while </b></font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">!=</font><font color="#800000">''</font><font color="#808080">) </font><font color="#000080"><b>and </b></font><font color="#808080">(</font><font color="#000080">bQuebra</font><font color="#808080">==</font><font color="#000080"><b>False</b></font><font color="#808080">): 
    </font><font color="#000080">slinha</font><font color="#808080">=</font><font color="#000080">sArq</font><font color="#808080">.</font><font color="#000080">readline</font><font color="#808080">()
    </font><font color="#000080">sres </font><font color="#808080">= </font><font color="#000080">string</font><font color="#808080">.</font><font color="#000080">strip</font><font color="#808080">(</font><font color="#000080">copy</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">,</font><font color="#000080">nPosChave</font><font color="#808080">,</font><font color="#000080">nTamChave</font><font color="#808080">))
    </font><font color="#000080"><b>if </b>sres </font><font color="#808080">== </font><font color="#000080">sChave</font><font color="#808080">:
       </font><font color="#000080">bQuebra </font><font color="#808080">= </font><font color="#000080"><b>True  
  </b>nPosicao </font><font color="#808080">= </font><font color="#000080">sArq</font><font color="#808080">.</font><font color="#000080">tell</font><font color="#808080">()-(</font><font color="#000080">nTamLinha </font><font color="#808080">+ </font><font color="#000080">TAM_CRLF</font><font color="#808080">)
  </font><font color="#000080"><b>if </b>nPosicao </font><font color="#808080">&gt; </font><font color="#FF0000">0</font><font color="#808080">:
     </font><font color="#000080">sArq</font><font color="#808080">.</font><font color="#000080">seek</font><font color="#808080">(</font><font color="#000080">nPosicao</font><font color="#808080">, </font><font color="#000080">SEEK_SET</font><font color="#808080">)
  </font><font color="#000080"><b>else</b></font><font color="#808080">:
     </font><font color="#000080">sArq</font><font color="#808080">.</font><font color="#000080">seek</font><font color="#808080">(</font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#000080">SEEK_SET</font><font color="#808080">)
  </font><font color="#000080"><b>if </b>sres </font><font color="#808080">!= </font><font color="#000080">sChave</font><font color="#808080">:
     </font><font color="#000080"><b>return </b></font><font color="#800000">''
  </font><font color="#000080"><b>else</b></font><font color="#808080">:
     </font><font color="#000080"><b>return </b>copy</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#000080">nTamLinha</font><font color="#808080">)

<i>#------------------------------------------------------------------------------
# Pesquisa se tem linha excluida senao vai para a ultima linha do arquivo.
# sArq - o arquivo
# nTamLinha - o tamanho do registro
#------------------------------------------------------------------------------
</i></font><font color="#000080"><b>def </b>pesqLinhaExcluida</font><font color="#808080">(</font><font color="#000080">sArq</font><font color="#808080">, </font><font color="#000080">nTamLinha</font><font color="#808080">):
  </font><font color="#000080">sExcluido</font><font color="#808080">=</font><font color="#000080">pesqArq</font><font color="#808080">(</font><font color="#000080">sArq</font><font color="#808080">, </font><font color="#800000">'*'</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#000080">nTamLinha</font><font color="#808080">)
  </font><font color="#000080"><b>if </b>sExcluido</font><font color="#808080">==</font><font color="#800000">''</font><font color="#808080">:
     </font><font color="#000080">sArq</font><font color="#808080">.</font><font color="#000080">seek</font><font color="#808080">(</font><font color="#000080">tamArq</font><font color="#808080">(</font><font color="#000080">sArq</font><font color="#808080">))

<i>#------------------------------------------------------------------------------
# Pesquisa o maior codigo num arquivo.
# sArq - o arquivo
# nPosChave - a posicao inicial da chave dentro do registro
# nTamChave - o tamanho da chave dentro do registro
# nTamLinha - o tamanho do registro
# retorna - o maior codigo
#------------------------------------------------------------------------------
</i></font><font color="#000080"><b>def </b>pesqMaxCod</font><font color="#808080">(</font><font color="#000080">sArq</font><font color="#808080">, </font><font color="#000080">nPosChave</font><font color="#808080">, </font><font color="#000080">nTamChave</font><font color="#808080">, </font><font color="#000080">nTamLinha</font><font color="#808080">):
  </font><font color="#000080">slinha</font><font color="#808080">=</font><font color="#800000">'0'
  </font><font color="#000080">bQuebra</font><font color="#808080">=</font><font color="#000080"><b>False
  </b>nMaior</font><font color="#808080">=</font><font color="#FF0000">0
  </font><font color="#000080">sArq</font><font color="#808080">.</font><font color="#000080">seek</font><font color="#808080">(</font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#000080">SEEK_SET</font><font color="#808080">)
  </font><font color="#000080"><b>while </b></font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">!=</font><font color="#800000">''</font><font color="#808080">) </font><font color="#000080"><b>and </b></font><font color="#808080">(</font><font color="#000080">bQuebra</font><font color="#808080">==</font><font color="#000080"><b>False</b></font><font color="#808080">): 
    </font><font color="#000080">slinha</font><font color="#808080">=</font><font color="#000080">sArq</font><font color="#808080">.</font><font color="#000080">readline</font><font color="#808080">()
    </font><font color="#000080">sres </font><font color="#808080">= </font><font color="#000080">string</font><font color="#808080">.</font><font color="#000080">strip</font><font color="#808080">(</font><font color="#000080">copy</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">,</font><font color="#000080">nPosChave</font><font color="#808080">,</font><font color="#000080">nTamChave</font><font color="#808080">))
    </font><font color="#000080"><b>if </b>slinha</font><font color="#808080">!=</font><font color="#800000">''</font><font color="#808080">:
      </font><font color="#000080">nCod </font><font color="#808080">= </font><font color="#000080"><b>int</b></font><font color="#808080">(</font><font color="#000080">sres</font><font color="#808080">)
      </font><font color="#000080"><b>if </b>nCod </font><font color="#808080">&gt; </font><font color="#000080">nMaior</font><font color="#808080">:
         </font><font color="#000080">nMaior</font><font color="#808080">=</font><font color="#000080">nCod
  pesqLinhaExcluida</font><font color="#808080">(</font><font color="#000080">sArq</font><font color="#808080">, </font><font color="#000080">nTamLinha</font><font color="#808080">)
  </font><font color="#000080">sres </font><font color="#808080">= </font><font color="#000080"><b>str</b></font><font color="#808080">(</font><font color="#000080">nMaior</font><font color="#808080">+</font><font color="#FF0000">1</font><font color="#808080">)
  </font><font color="#000080"><b>return </b>sres

</font><font color="#808080"><i>#------------------------------------------------------------------------------
# Grava os registros num determinado arquivo.
# sArq - o arquivo
# sTexto - o registro a ser gravado
# sMsgAcerto - a mensagem caso o registro foi gravado
# sMsgErro - a mensagem caso o registro nao foi gravado
#------------------------------------------------------------------------------
</i></font><font color="#000080"><b>def </b>escreveArq</font><font color="#808080">(</font><font color="#000080">sArq</font><font color="#808080">, </font><font color="#000080">sTexto</font><font color="#808080">, </font><font color="#000080">sMsgAcerto</font><font color="#808080">, </font><font color="#000080">sMsgErro</font><font color="#808080">):
  </font><font color="#000080">sTexto</font><font color="#808080">=</font><font color="#000080">sTexto</font><font color="#808080">+</font><font color="#000080">CRLF 
  <b>if </b>sArq</font><font color="#808080">.</font><font color="#000080">write</font><font color="#808080">(</font><font color="#000080">sTexto</font><font color="#808080">)==</font><font color="#000080"><b>None</b></font><font color="#808080">:
     </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#000080">sMsgAcerto</font><font color="#808080">)
  </font><font color="#000080"><b>else</b></font><font color="#808080">:
     </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#000080">sMsgErro</font><font color="#808080">)

<i>#--- Rotinas de implementacao do sistema e de interface ----------------------

#------------------------------------------------------------------------------
# Monta o tamanho do registro no arquivo de acordo com o tipo de arquivo.
# sreg - o tipo de arquivo
# retorna - o registro montado
#------------------------------------------------------------------------------
</i></font><font color="#000080"><b>def </b>LinhaReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">):
  </font><font color="#000080">slinha</font><font color="#808080">=</font><font color="#800000">''
  </font><font color="#000080"><b>if </b>sreg</font><font color="#808080">==</font><font color="#800000">'opAssunto'</font><font color="#808080">:
     </font><font color="#000080">slinha</font><font color="#808080">=</font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">tAssunto</font><font color="#808080">[</font><font color="#800000">'codigo'</font><font color="#808080">],</font><font color="#FF0000">10</font><font color="#808080">)+</font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">tAssunto</font><font color="#808080">[</font><font color="#800000">'assunto'</font><font color="#808080">],</font><font color="#FF0000">30</font><font color="#808080">)
  </font><font color="#000080"><b>elif </b>sreg</font><font color="#808080">==</font><font color="#800000">'opAutor'</font><font color="#808080">:
     </font><font color="#000080">slinha</font><font color="#808080">=</font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">tAutor</font><font color="#808080">[</font><font color="#800000">'codigo'</font><font color="#808080">],</font><font color="#FF0000">10</font><font color="#808080">)+</font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">tAutor</font><font color="#808080">[</font><font color="#800000">'autor'</font><font color="#808080">],</font><font color="#FF0000">30</font><font color="#808080">)
  </font><font color="#000080"><b>elif </b>sreg</font><font color="#808080">==</font><font color="#800000">'opEditora'</font><font color="#808080">:
     </font><font color="#000080">slinha</font><font color="#808080">=</font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">tEditora</font><font color="#808080">[</font><font color="#800000">'codigo'</font><font color="#808080">],</font><font color="#FF0000">10</font><font color="#808080">)+</font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">tEditora</font><font color="#808080">[</font><font color="#800000">'editora'</font><font color="#808080">],</font><font color="#FF0000">50</font><font color="#808080">)
  </font><font color="#000080"><b>elif </b>sreg</font><font color="#808080">==</font><font color="#800000">'opEndereco'</font><font color="#808080">:
     </font><font color="#000080">slinha</font><font color="#808080">=</font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">tEndereco</font><font color="#808080">[</font><font color="#800000">'codigo'</font><font color="#808080">],</font><font color="#FF0000">10</font><font color="#808080">)+</font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">tEndereco</font><font color="#808080">[</font><font color="#800000">'logradouro'</font><font color="#808080">],</font><font color="#FF0000">40</font><font color="#808080">)+ \
     </font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">tEndereco</font><font color="#808080">[</font><font color="#800000">'bairro'</font><font color="#808080">],</font><font color="#FF0000">15</font><font color="#808080">)+</font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">tEndereco</font><font color="#808080">[</font><font color="#800000">'cep'</font><font color="#808080">],</font><font color="#FF0000">8</font><font color="#808080">)+</font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">tEndereco</font><font color="#808080">[</font><font color="#800000">'cidade'</font><font color="#808080">],</font><font color="#FF0000">30</font><font color="#808080">)+ \
     </font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">tEndereco</font><font color="#808080">[</font><font color="#800000">'estado'</font><font color="#808080">],</font><font color="#FF0000">20</font><font color="#808080">)
  </font><font color="#000080"><b>elif </b>sreg</font><font color="#808080">==</font><font color="#800000">'opIdioma'</font><font color="#808080">:
     </font><font color="#000080">slinha</font><font color="#808080">=</font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">tIdioma</font><font color="#808080">[</font><font color="#800000">'codigo'</font><font color="#808080">],</font><font color="#FF0000">10</font><font color="#808080">)+</font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">tIdioma</font><font color="#808080">[</font><font color="#800000">'idioma'</font><font color="#808080">],</font><font color="#FF0000">20</font><font color="#808080">)
  </font><font color="#000080"><b>elif </b>sreg</font><font color="#808080">==</font><font color="#800000">'opPais'</font><font color="#808080">:
     </font><font color="#000080">slinha</font><font color="#808080">=</font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">tPais</font><font color="#808080">[</font><font color="#800000">'codigo'</font><font color="#808080">],</font><font color="#FF0000">3</font><font color="#808080">)+</font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">tPais</font><font color="#808080">[</font><font color="#800000">'pais'</font><font color="#808080">],</font><font color="#FF0000">50</font><font color="#808080">)
  </font><font color="#000080"><b>elif </b>sreg</font><font color="#808080">==</font><font color="#800000">'opProfissao'</font><font color="#808080">:
     </font><font color="#000080">slinha</font><font color="#808080">=</font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">tProfissao</font><font color="#808080">[</font><font color="#800000">'codigo'</font><font color="#808080">],</font><font color="#FF0000">10</font><font color="#808080">)+</font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">tProfissao</font><font color="#808080">[</font><font color="#800000">'profissao'</font><font color="#808080">],</font><font color="#FF0000">50</font><font color="#808080">)
  </font><font color="#000080"><b>elif </b>sreg</font><font color="#808080">==</font><font color="#800000">'opUsuario'</font><font color="#808080">:
     </font><font color="#000080">slinha</font><font color="#808080">=</font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">tUsuario</font><font color="#808080">[</font><font color="#800000">'login'</font><font color="#808080">],</font><font color="#FF0000">10</font><font color="#808080">)+</font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">tUsuario</font><font color="#808080">[</font><font color="#800000">'senha'</font><font color="#808080">],</font><font color="#FF0000">10</font><font color="#808080">)
  </font><font color="#000080"><b>elif </b>sreg</font><font color="#808080">==</font><font color="#800000">'opLivro'</font><font color="#808080">:
     </font><font color="#000080">slinha</font><font color="#808080">=</font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">tLivro</font><font color="#808080">[</font><font color="#800000">'isbn'</font><font color="#808080">],</font><font color="#FF0000">13</font><font color="#808080">)+</font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">tLivro</font><font color="#808080">[</font><font color="#800000">'titulo'</font><font color="#808080">],</font><font color="#FF0000">50</font><font color="#808080">)+</font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">tLivro</font><font color="#808080">[</font><font color="#800000">'edicao'</font><font color="#808080">],</font><font color="#FF0000">10</font><font color="#808080">)+ \
     </font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">tLivro</font><font color="#808080">[</font><font color="#800000">'anopubli'</font><font color="#808080">],</font><font color="#FF0000">10</font><font color="#808080">)+</font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">tLivro</font><font color="#808080">[</font><font color="#800000">'codeditora'</font><font color="#808080">],</font><font color="#FF0000">10</font><font color="#808080">)+</font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">tLivro</font><font color="#808080">[</font><font color="#800000">'volume'</font><font color="#808080">],</font><font color="#FF0000">10</font><font color="#808080">)+ \
     </font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">tLivro</font><font color="#808080">[</font><font color="#800000">'codidioma'</font><font color="#808080">],</font><font color="#FF0000">10</font><font color="#808080">)+</font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">tLivro</font><font color="#808080">[</font><font color="#800000">'npaginas'</font><font color="#808080">],</font><font color="#FF0000">10</font><font color="#808080">)+</font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">tLivro</font><font color="#808080">[</font><font color="#800000">'preco'</font><font color="#808080">],</font><font color="#FF0000">10</font><font color="#808080">)+ \
     </font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">tLivro</font><font color="#808080">[</font><font color="#800000">'qtdestoque'</font><font color="#808080">],</font><font color="#FF0000">10</font><font color="#808080">)
  </font><font color="#000080"><b>elif </b>sreg</font><font color="#808080">==</font><font color="#800000">'opLivroAss'</font><font color="#808080">:
     </font><font color="#000080">slinha</font><font color="#808080">=</font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">tLivroAss</font><font color="#808080">[</font><font color="#800000">'isbn'</font><font color="#808080">],</font><font color="#FF0000">13</font><font color="#808080">)+</font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">tlivroAss</font><font color="#808080">[</font><font color="#800000">'codassunto'</font><font color="#808080">],</font><font color="#FF0000">10</font><font color="#808080">)
  </font><font color="#000080"><b>elif </b>sreg</font><font color="#808080">==</font><font color="#800000">'opLivroAut'</font><font color="#808080">:
     </font><font color="#000080">slinha</font><font color="#808080">=</font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">tLivroAut</font><font color="#808080">[</font><font color="#800000">'isbn'</font><font color="#808080">],</font><font color="#FF0000">13</font><font color="#808080">)+</font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">tlivroAut</font><font color="#808080">[</font><font color="#800000">'codautor'</font><font color="#808080">],</font><font color="#FF0000">10</font><font color="#808080">)
  </font><font color="#000080"><b>elif </b>sreg</font><font color="#808080">==</font><font color="#800000">'opCliente'</font><font color="#808080">:
     </font><font color="#000080">slinha</font><font color="#808080">=</font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">tCliente</font><font color="#808080">[</font><font color="#800000">'cpf'</font><font color="#808080">],</font><font color="#FF0000">14</font><font color="#808080">)+</font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">tCliente</font><font color="#808080">[</font><font color="#800000">'nome'</font><font color="#808080">],</font><font color="#FF0000">30</font><font color="#808080">)+</font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">tCliente</font><font color="#808080">[</font><font color="#800000">'email'</font><font color="#808080">],</font><font color="#FF0000">30</font><font color="#808080">)+ \
     </font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">tCliente</font><font color="#808080">[</font><font color="#800000">'identidade'</font><font color="#808080">],</font><font color="#FF0000">10</font><font color="#808080">)+</font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">tCliente</font><font color="#808080">[</font><font color="#800000">'sexo'</font><font color="#808080">],</font><font color="#FF0000">1</font><font color="#808080">)+</font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">tCliente</font><font color="#808080">[</font><font color="#800000">'telefone'</font><font color="#808080">],</font><font color="#FF0000">17</font><font color="#808080">)+ \
     </font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">tCliente</font><font color="#808080">[</font><font color="#800000">'dtnascimento'</font><font color="#808080">],</font><font color="#FF0000">10</font><font color="#808080">)+</font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">tCliente</font><font color="#808080">[</font><font color="#800000">'codendereco'</font><font color="#808080">],</font><font color="#FF0000">10</font><font color="#808080">)+ \
     </font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">tCliente</font><font color="#808080">[</font><font color="#800000">'codpais'</font><font color="#808080">],</font><font color="#FF0000">3</font><font color="#808080">)+</font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">tCliente</font><font color="#808080">[</font><font color="#800000">'codprofissao'</font><font color="#808080">],</font><font color="#FF0000">10</font><font color="#808080">)
  </font><font color="#000080"><b>elif </b>sreg</font><font color="#808080">==</font><font color="#800000">'opVenda'</font><font color="#808080">:
     </font><font color="#000080">slinha</font><font color="#808080">=</font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">tVenda</font><font color="#808080">[</font><font color="#800000">'dthrvenda'</font><font color="#808080">],</font><font color="#FF0000">19</font><font color="#808080">)+</font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">tVenda</font><font color="#808080">[</font><font color="#800000">'cpf'</font><font color="#808080">],</font><font color="#FF0000">14</font><font color="#808080">)+</font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">tVenda</font><font color="#808080">[</font><font color="#800000">'isbn'</font><font color="#808080">],</font><font color="#FF0000">13</font><font color="#808080">)+ \
     </font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">tVenda</font><font color="#808080">[</font><font color="#800000">'precovenda'</font><font color="#808080">],</font><font color="#FF0000">10</font><font color="#808080">)
  
  </font><font color="#000080"><b>return </b>slinha

</font><font color="#808080"><i>#------------------------------------------------------------------------------
# Retorna o tamanho do registro no arquivo de acordo com o tipo de arquivo.
# sreg - o tipo de arquivo
# retorna - o tamanho do registro
#------------------------------------------------------------------------------
</i></font><font color="#000080"><b>def </b>tamReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">):
  </font><font color="#000080">nret</font><font color="#808080">=</font><font color="#FF0000">0
  </font><font color="#000080"><b>if </b>sreg</font><font color="#808080">==</font><font color="#800000">'opAssunto'</font><font color="#808080">: </font><font color="#000080">nret</font><font color="#808080">=</font><font color="#000080">TAM_ASSUNTO
  <b>elif </b>sreg</font><font color="#808080">==</font><font color="#800000">'opAutor'</font><font color="#808080">: </font><font color="#000080">nret</font><font color="#808080">=</font><font color="#000080">TAM_AUTOR
  <b>elif </b>sreg</font><font color="#808080">==</font><font color="#800000">'opEditora'</font><font color="#808080">: </font><font color="#000080">nret</font><font color="#808080">=</font><font color="#000080">TAM_EDITORA
  <b>elif </b>sreg</font><font color="#808080">==</font><font color="#800000">'opEndereco'</font><font color="#808080">: </font><font color="#000080">nret</font><font color="#808080">=</font><font color="#000080">TAM_ENDERECO
  <b>elif </b>sreg</font><font color="#808080">==</font><font color="#800000">'opIdioma'</font><font color="#808080">: </font><font color="#000080">nret</font><font color="#808080">=</font><font color="#000080">TAM_IDIOMA
  <b>elif </b>sreg</font><font color="#808080">==</font><font color="#800000">'opPais'</font><font color="#808080">: </font><font color="#000080">nret</font><font color="#808080">=</font><font color="#000080">TAM_PAIS
  <b>elif </b>sreg</font><font color="#808080">==</font><font color="#800000">'opProfissao'</font><font color="#808080">: </font><font color="#000080">nret</font><font color="#808080">=</font><font color="#000080">TAM_PROFISSAO
  <b>elif </b>sreg</font><font color="#808080">==</font><font color="#800000">'opUsuario'</font><font color="#808080">: </font><font color="#000080">nret</font><font color="#808080">=</font><font color="#000080">TAM_USUARIO
  <b>elif </b>sreg</font><font color="#808080">==</font><font color="#800000">'opLivro'</font><font color="#808080">: </font><font color="#000080">nret</font><font color="#808080">=</font><font color="#000080">TAM_LIVRO
  <b>elif </b>sreg</font><font color="#808080">==</font><font color="#800000">'opLivroAss'</font><font color="#808080">: </font><font color="#000080">nret</font><font color="#808080">=</font><font color="#000080">TAM_LIVASS
  <b>elif </b>sreg</font><font color="#808080">==</font><font color="#800000">'opLivroAut'</font><font color="#808080">: </font><font color="#000080">nret</font><font color="#808080">=</font><font color="#000080">TAM_LIVAUT
  <b>elif </b>sreg</font><font color="#808080">==</font><font color="#800000">'opCliente'</font><font color="#808080">: </font><font color="#000080">nret</font><font color="#808080">=</font><font color="#000080">TAM_CLIENTE
  <b>elif </b>sreg</font><font color="#808080">==</font><font color="#800000">'opVenda'</font><font color="#808080">: </font><font color="#000080">nret</font><font color="#808080">=</font><font color="#000080">TAM_VENDA
  
  <b>return </b>nret

</font><font color="#808080"><i>#------------------------------------------------------------------------------
# Seleciona o rotulo de cada campo de acordo com o tipo de arquivo.
# sreg - o tipo de arquivo
# nNum - indica qual rotulo sera retornado
# retorna - o rotulo
#------------------------------------------------------------------------------
</i></font><font color="#000080"><b>def </b>rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#000080">nNum</font><font color="#808080">):
  </font><font color="#000080">sret</font><font color="#808080">=</font><font color="#800000">''
  </font><font color="#000080"><b>if </b>sreg</font><font color="#808080">==</font><font color="#800000">'opAssunto'</font><font color="#808080">:
     </font><font color="#000080"><b>if </b>nNum </font><font color="#808080">== </font><font color="#FF0000">0</font><font color="#808080">: </font><font color="#000080">sret </font><font color="#808080">= </font><font color="#800000">'Assunto(s) nao encontrado(s)!'
     </font><font color="#000080"><b>elif </b>nNum </font><font color="#808080">== </font><font color="#FF0000">1</font><font color="#808080">: </font><font color="#000080">sret</font><font color="#808080">=</font><font color="#800000">'Codigo do assunto: '
     </font><font color="#000080"><b>elif </b>nNum </font><font color="#808080">== </font><font color="#FF0000">2</font><font color="#808080">: </font><font color="#000080">sret</font><font color="#808080">=</font><font color="#800000">'Assunto: '
  </font><font color="#000080"><b>elif </b>sreg</font><font color="#808080">==</font><font color="#800000">'opAutor'</font><font color="#808080">:
     </font><font color="#000080"><b>if </b>nNum </font><font color="#808080">== </font><font color="#FF0000">0</font><font color="#808080">: </font><font color="#000080">sret</font><font color="#808080">=</font><font color="#800000">'Autor(es) nao encontrado(s)!'
     </font><font color="#000080"><b>elif </b>nNum </font><font color="#808080">== </font><font color="#FF0000">1</font><font color="#808080">: </font><font color="#000080">sret</font><font color="#808080">=</font><font color="#800000">'Codigo do autor: '
     </font><font color="#000080"><b>elif </b>nNum </font><font color="#808080">== </font><font color="#FF0000">2</font><font color="#808080">: </font><font color="#000080">sret</font><font color="#808080">=</font><font color="#800000">'Autor: '
  </font><font color="#000080"><b>elif </b>sreg</font><font color="#808080">==</font><font color="#800000">'opEditora'</font><font color="#808080">:
     </font><font color="#000080"><b>if </b>nNum </font><font color="#808080">== </font><font color="#FF0000">0</font><font color="#808080">: </font><font color="#000080">sret</font><font color="#808080">=</font><font color="#800000">'Editora(s) nao encontrada(s)!'
     </font><font color="#000080"><b>elif </b>nNum </font><font color="#808080">== </font><font color="#FF0000">1</font><font color="#808080">: </font><font color="#000080">sret</font><font color="#808080">=</font><font color="#800000">'Codigo da editora: '
     </font><font color="#000080"><b>elif </b>nNum </font><font color="#808080">== </font><font color="#FF0000">2</font><font color="#808080">: </font><font color="#000080">sret</font><font color="#808080">=</font><font color="#800000">'Editora: '
  </font><font color="#000080"><b>elif </b>sreg</font><font color="#808080">==</font><font color="#800000">'opEndereco'</font><font color="#808080">:
     </font><font color="#000080"><b>if </b>nNum </font><font color="#808080">== </font><font color="#FF0000">0</font><font color="#808080">: </font><font color="#000080">sret</font><font color="#808080">=</font><font color="#800000">'Endereco(s) nao encontrado(s)!'
     </font><font color="#000080"><b>elif </b>nNum </font><font color="#808080">== </font><font color="#FF0000">1</font><font color="#808080">: </font><font color="#000080">sret</font><font color="#808080">=</font><font color="#800000">'Codigo do endereco: '
     </font><font color="#000080"><b>elif </b>nNum </font><font color="#808080">== </font><font color="#FF0000">2</font><font color="#808080">: </font><font color="#000080">sret</font><font color="#808080">=</font><font color="#800000">'Logradouro: '
     </font><font color="#000080"><b>elif </b>nNum </font><font color="#808080">== </font><font color="#FF0000">3</font><font color="#808080">: </font><font color="#000080">sret</font><font color="#808080">=</font><font color="#800000">'Bairro: '
     </font><font color="#000080"><b>elif </b>nNum </font><font color="#808080">== </font><font color="#FF0000">4</font><font color="#808080">: </font><font color="#000080">sret</font><font color="#808080">=</font><font color="#800000">'CEP: '
     </font><font color="#000080"><b>elif </b>nNum </font><font color="#808080">== </font><font color="#FF0000">5</font><font color="#808080">: </font><font color="#000080">sret</font><font color="#808080">=</font><font color="#800000">'Cidade: '
     </font><font color="#000080"><b>elif </b>nNum </font><font color="#808080">== </font><font color="#FF0000">6</font><font color="#808080">: </font><font color="#000080">sret</font><font color="#808080">=</font><font color="#800000">'Estado: '
  </font><font color="#000080"><b>elif </b>sreg</font><font color="#808080">==</font><font color="#800000">'opIdioma'</font><font color="#808080">:
     </font><font color="#000080"><b>if </b>nNum </font><font color="#808080">== </font><font color="#FF0000">0</font><font color="#808080">: </font><font color="#000080">sret</font><font color="#808080">=</font><font color="#800000">'Idioma(s) nao encontrado(s)!'
     </font><font color="#000080"><b>elif </b>nNum </font><font color="#808080">== </font><font color="#FF0000">1</font><font color="#808080">: </font><font color="#000080">sret</font><font color="#808080">=</font><font color="#800000">'Codigo do idioma: '
     </font><font color="#000080"><b>elif </b>nNum </font><font color="#808080">== </font><font color="#FF0000">2</font><font color="#808080">: </font><font color="#000080">sret</font><font color="#808080">=</font><font color="#800000">'Idioma: '
  </font><font color="#000080"><b>elif </b>sreg</font><font color="#808080">==</font><font color="#800000">'opPais'</font><font color="#808080">:
     </font><font color="#000080"><b>if </b>nNum </font><font color="#808080">== </font><font color="#FF0000">0</font><font color="#808080">: </font><font color="#000080">sret</font><font color="#808080">=</font><font color="#800000">'Pais(es) nao encontrado(s)!'
     </font><font color="#000080"><b>elif </b>nNum </font><font color="#808080">== </font><font color="#FF0000">1</font><font color="#808080">: </font><font color="#000080">sret</font><font color="#808080">=</font><font color="#800000">'Codigo do pais: '
     </font><font color="#000080"><b>elif </b>nNum </font><font color="#808080">== </font><font color="#FF0000">2</font><font color="#808080">: </font><font color="#000080">sret</font><font color="#808080">=</font><font color="#800000">'Pais: '
  </font><font color="#000080"><b>elif </b>sreg</font><font color="#808080">==</font><font color="#800000">'opProfissao'</font><font color="#808080">:
     </font><font color="#000080"><b>if </b>nNum </font><font color="#808080">== </font><font color="#FF0000">0</font><font color="#808080">: </font><font color="#000080">sret</font><font color="#808080">=</font><font color="#800000">'Profissao(es) nao encontrada(s)!'
     </font><font color="#000080"><b>elif </b>nNum </font><font color="#808080">== </font><font color="#FF0000">1</font><font color="#808080">: </font><font color="#000080">sret</font><font color="#808080">=</font><font color="#800000">'Codigo da profissao: '
     </font><font color="#000080"><b>elif </b>nNum </font><font color="#808080">== </font><font color="#FF0000">2</font><font color="#808080">: </font><font color="#000080">sret</font><font color="#808080">=</font><font color="#800000">'Profissao: '
  </font><font color="#000080"><b>elif </b>sreg</font><font color="#808080">==</font><font color="#800000">'opUsuario'</font><font color="#808080">:
     </font><font color="#000080"><b>if </b>nNum </font><font color="#808080">== </font><font color="#FF0000">0</font><font color="#808080">: </font><font color="#000080">sret</font><font color="#808080">=</font><font color="#800000">'login ou senha incorreta, tente de novo!'
     </font><font color="#000080"><b>elif </b>nNum </font><font color="#808080">== </font><font color="#FF0000">1</font><font color="#808080">: </font><font color="#000080">sret</font><font color="#808080">=</font><font color="#800000">'Login: '
     </font><font color="#000080"><b>elif </b>nNum </font><font color="#808080">== </font><font color="#FF0000">2</font><font color="#808080">: </font><font color="#000080">sret</font><font color="#808080">=</font><font color="#800000">'Senha: '
  </font><font color="#000080"><b>elif </b>sreg</font><font color="#808080">==</font><font color="#800000">'opLivro'</font><font color="#808080">:
     </font><font color="#000080"><b>if </b>nNum </font><font color="#808080">== </font><font color="#FF0000">0</font><font color="#808080">: </font><font color="#000080">sret</font><font color="#808080">=</font><font color="#800000">'Livro(s) nao encontrado(s)!'
     </font><font color="#000080"><b>elif </b>nNum </font><font color="#808080">== </font><font color="#FF0000">1</font><font color="#808080">: </font><font color="#000080">sret</font><font color="#808080">=</font><font color="#800000">'ISBN: '
     </font><font color="#000080"><b>elif </b>nNum </font><font color="#808080">== </font><font color="#FF0000">2</font><font color="#808080">: </font><font color="#000080">sret</font><font color="#808080">=</font><font color="#800000">'Titulo: '
     </font><font color="#000080"><b>elif </b>nNum </font><font color="#808080">== </font><font color="#FF0000">3</font><font color="#808080">: </font><font color="#000080">sret</font><font color="#808080">=</font><font color="#800000">'Edicao: '
     </font><font color="#000080"><b>elif </b>nNum </font><font color="#808080">== </font><font color="#FF0000">4</font><font color="#808080">: </font><font color="#000080">sret</font><font color="#808080">=</font><font color="#800000">'Ano de Publicacao: '
     </font><font color="#000080"><b>elif </b>nNum </font><font color="#808080">== </font><font color="#FF0000">5</font><font color="#808080">: </font><font color="#000080">sret</font><font color="#808080">=</font><font color="#800000">'Codigo da editora: '
     </font><font color="#000080"><b>elif </b>nNum </font><font color="#808080">== </font><font color="#FF0000">6</font><font color="#808080">: </font><font color="#000080">sret</font><font color="#808080">=</font><font color="#800000">'Volume: '
     </font><font color="#000080"><b>elif </b>nNum </font><font color="#808080">== </font><font color="#FF0000">7</font><font color="#808080">: </font><font color="#000080">sret</font><font color="#808080">=</font><font color="#800000">'Codigo do idioma: '
     </font><font color="#000080"><b>elif </b>nNum </font><font color="#808080">== </font><font color="#FF0000">8</font><font color="#808080">: </font><font color="#000080">sret</font><font color="#808080">=</font><font color="#800000">'Numero de paginas: '
     </font><font color="#000080"><b>elif </b>nNum </font><font color="#808080">== </font><font color="#FF0000">9</font><font color="#808080">: </font><font color="#000080">sret</font><font color="#808080">=</font><font color="#800000">'Preco: '
     </font><font color="#000080"><b>elif </b>nNum </font><font color="#808080">== </font><font color="#FF0000">10</font><font color="#808080">: </font><font color="#000080">sret</font><font color="#808080">=</font><font color="#800000">'Qtd. Estoque: '
  </font><font color="#000080"><b>elif </b>sreg</font><font color="#808080">==</font><font color="#800000">'opLivroAss'</font><font color="#808080">:
     </font><font color="#000080"><b>if </b>nNum </font><font color="#808080">== </font><font color="#FF0000">0</font><font color="#808080">: </font><font color="#000080">sret</font><font color="#808080">=</font><font color="#800000">'Assunto(s) nao encontrado(s)!'
     </font><font color="#000080"><b>elif </b>nNum </font><font color="#808080">== </font><font color="#FF0000">1</font><font color="#808080">: </font><font color="#000080">sret</font><font color="#808080">=</font><font color="#800000">'ISBN: '
     </font><font color="#000080"><b>elif </b>nNum </font><font color="#808080">== </font><font color="#FF0000">2</font><font color="#808080">: </font><font color="#000080">sret</font><font color="#808080">=</font><font color="#800000">'Codigo do assunto: '
  </font><font color="#000080"><b>elif </b>sreg</font><font color="#808080">==</font><font color="#800000">'opLivroAut'</font><font color="#808080">:
     </font><font color="#000080"><b>if </b>nNum </font><font color="#808080">== </font><font color="#FF0000">0</font><font color="#808080">: </font><font color="#000080">sret</font><font color="#808080">=</font><font color="#800000">'Autor(s) nao encontrado(s)!'
     </font><font color="#000080"><b>elif </b>nNum </font><font color="#808080">== </font><font color="#FF0000">1</font><font color="#808080">: </font><font color="#000080">sret</font><font color="#808080">=</font><font color="#800000">'ISBN: '
     </font><font color="#000080"><b>elif </b>nNum </font><font color="#808080">== </font><font color="#FF0000">2</font><font color="#808080">: </font><font color="#000080">sret</font><font color="#808080">=</font><font color="#800000">'Codigo do autor: '
  </font><font color="#000080"><b>elif </b>sreg</font><font color="#808080">==</font><font color="#800000">'opCliente'</font><font color="#808080">:
     </font><font color="#000080"><b>if </b>nNum </font><font color="#808080">== </font><font color="#FF0000">0</font><font color="#808080">: </font><font color="#000080">sret</font><font color="#808080">=</font><font color="#800000">'Cliente(s) nao encontrado(s)!'
     </font><font color="#000080"><b>elif </b>nNum </font><font color="#808080">== </font><font color="#FF0000">1</font><font color="#808080">: </font><font color="#000080">sret</font><font color="#808080">=</font><font color="#800000">'CPF: '
     </font><font color="#000080"><b>elif </b>nNum </font><font color="#808080">== </font><font color="#FF0000">2</font><font color="#808080">: </font><font color="#000080">sret</font><font color="#808080">=</font><font color="#800000">'Nome: '
     </font><font color="#000080"><b>elif </b>nNum </font><font color="#808080">== </font><font color="#FF0000">3</font><font color="#808080">: </font><font color="#000080">sret</font><font color="#808080">=</font><font color="#800000">'E-mail: '
     </font><font color="#000080"><b>elif </b>nNum </font><font color="#808080">== </font><font color="#FF0000">4</font><font color="#808080">: </font><font color="#000080">sret</font><font color="#808080">=</font><font color="#800000">'Identidade: '
     </font><font color="#000080"><b>elif </b>nNum </font><font color="#808080">== </font><font color="#FF0000">5</font><font color="#808080">: </font><font color="#000080">sret</font><font color="#808080">=</font><font color="#800000">'Sexo: '
     </font><font color="#000080"><b>elif </b>nNum </font><font color="#808080">== </font><font color="#FF0000">6</font><font color="#808080">: </font><font color="#000080">sret</font><font color="#808080">=</font><font color="#800000">'Telefone: '
     </font><font color="#000080"><b>elif </b>nNum </font><font color="#808080">== </font><font color="#FF0000">7</font><font color="#808080">: </font><font color="#000080">sret</font><font color="#808080">=</font><font color="#800000">'Dt. Nascimento: '
     </font><font color="#000080"><b>elif </b>nNum </font><font color="#808080">== </font><font color="#FF0000">8</font><font color="#808080">: </font><font color="#000080">sret</font><font color="#808080">=</font><font color="#800000">'Codigo do endereco: '
     </font><font color="#000080"><b>elif </b>nNum </font><font color="#808080">== </font><font color="#FF0000">9</font><font color="#808080">: </font><font color="#000080">sret</font><font color="#808080">=</font><font color="#800000">'Codigo do pais: '
     </font><font color="#000080"><b>elif </b>nNum </font><font color="#808080">== </font><font color="#FF0000">10</font><font color="#808080">: </font><font color="#000080">sret</font><font color="#808080">=</font><font color="#800000">'Codigo da Profissao: '
  </font><font color="#000080"><b>elif </b>sreg</font><font color="#808080">==</font><font color="#800000">'opVenda'</font><font color="#808080">:
     </font><font color="#000080"><b>if </b>nNum </font><font color="#808080">== </font><font color="#FF0000">0</font><font color="#808080">: </font><font color="#000080">sret</font><font color="#808080">=</font><font color="#800000">'Venda(s) nao encontrada(s)!'
     </font><font color="#000080"><b>elif </b>nNum </font><font color="#808080">== </font><font color="#FF0000">1</font><font color="#808080">: </font><font color="#000080">sret</font><font color="#808080">=</font><font color="#800000">'Data/Hora venda: '
     </font><font color="#000080"><b>elif </b>nNum </font><font color="#808080">== </font><font color="#FF0000">2</font><font color="#808080">: </font><font color="#000080">sret</font><font color="#808080">=</font><font color="#800000">'CPF: '
     </font><font color="#000080"><b>elif </b>nNum </font><font color="#808080">== </font><font color="#FF0000">3</font><font color="#808080">: </font><font color="#000080">sret</font><font color="#808080">=</font><font color="#800000">'ISBN: '
     </font><font color="#000080"><b>elif </b>nNum </font><font color="#808080">== </font><font color="#FF0000">4</font><font color="#808080">: </font><font color="#000080">sret</font><font color="#808080">=</font><font color="#800000">'Pre+o de venda: '
  
  </font><font color="#000080"><b>return </b>sret

</font><font color="#808080"><i>#------------------------------------------------------------------------------
# Indica se continua ou nao mostrando um numero maximo de linhas.
# nlinha - a linha a ser continuada
# nQtdLinha - a quantidade de linhas a serem mostradas
# retorna - se continua ou nao
#------------------------------------------------------------------------------
</i></font><font color="#000080"><b>def </b>ContinuaSN</font><font color="#808080">(</font><font color="#000080">nlinha</font><font color="#808080">, </font><font color="#000080">nQtdLinha</font><font color="#808080">):
  </font><font color="#000080">opCSubMenu</font><font color="#808080">=</font><font color="#800000">''
  </font><font color="#000080">bret</font><font color="#808080">=</font><font color="#000080"><b>False
  if </b>nlinha </font><font color="#808080">&gt; </font><font color="#FF0000">0</font><font color="#808080">:
    </font><font color="#000080"><b>if </b></font><font color="#808080">(</font><font color="#000080">nlinha </font><font color="#808080">% </font><font color="#000080">nQtdLinha</font><font color="#808080">) == </font><font color="#FF0000">0</font><font color="#808080">:
      </font><font color="#000080">bSOp</font><font color="#808080">=</font><font color="#000080"><b>True
      while </b></font><font color="#808080">(</font><font color="#000080">bSOp</font><font color="#808080">):
        </font><font color="#000080">menu</font><font color="#808080">(</font><font color="#FF0000">13</font><font color="#808080">)
        </font><font color="#000080">opCSubMenu </font><font color="#808080">= </font><font color="#000080"><b>raw_input</b></font><font color="#808080">()
        </font><font color="#000080"><b>if </b></font><font color="#808080">(</font><font color="#000080">opCSubMenu</font><font color="#808080">==</font><font color="#800000">'S'</font><font color="#808080">) </font><font color="#000080"><b>or </b></font><font color="#808080">(</font><font color="#000080">opCSubMenu</font><font color="#808080">==</font><font color="#800000">'s'</font><font color="#808080">): </font><font color="#000080">bSOp</font><font color="#808080">=</font><font color="#000080"><b>False
        elif </b></font><font color="#808080">(</font><font color="#000080">opCSubMenu</font><font color="#808080">==</font><font color="#800000">'N'</font><font color="#808080">) </font><font color="#000080"><b>or </b></font><font color="#808080">(</font><font color="#000080">opCSubMenu</font><font color="#808080">==</font><font color="#800000">'n'</font><font color="#808080">):
          </font><font color="#000080">bret</font><font color="#808080">=</font><font color="#000080"><b>True
          </b>bSOp</font><font color="#808080">=</font><font color="#000080"><b>False
        else</b></font><font color="#808080">: </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#000080">MSG_ERRO</font><font color="#808080">)
  </font><font color="#000080"><b>return </b>bret

</font><font color="#808080"><i>#------------------------------------------------------------------------------
# Lista varios registros de acordo com a pesquisa feita.
# sArq - o arquivo
# sreg - o tipo de arquivo
# sChave - a chave a ser pesquisada
# nPosChave - a posicao inicial da chave dentro do registro
# nTamChave - o tamanho da chave dentro do registro
# nTamLinha - o tamanho do registro
# nQtdLinha - a quantidade de linhas a serem mostradas
# retorna - se encontrou algum registro
#------------------------------------------------------------------------------
</i></font><font color="#000080"><b>def </b>ListarTodos</font><font color="#808080">(</font><font color="#000080">sArq</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#000080">sChave</font><font color="#808080">, </font><font color="#000080">nPosChave</font><font color="#808080">, </font><font color="#000080">nTamChave</font><font color="#808080">, 
                </font><font color="#000080">nTamLinha</font><font color="#808080">, </font><font color="#000080">nQtdLinha</font><font color="#808080">, </font><font color="#000080">bPesqRelativa</font><font color="#808080">):
  </font><font color="#000080">slinha</font><font color="#808080">=</font><font color="#800000">'0'
  </font><font color="#000080">bRet</font><font color="#808080">=</font><font color="#000080"><b>False
  </b>bQuebra</font><font color="#808080">=</font><font color="#000080"><b>False
  </b>nCont</font><font color="#808080">=</font><font color="#FF0000">0
  </font><font color="#000080">mostrarDados</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#800000">''</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">)
  </font><font color="#000080">sArq</font><font color="#808080">.</font><font color="#000080">seek</font><font color="#808080">(</font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#000080">SEEK_SET</font><font color="#808080">)
  </font><font color="#000080"><b>while </b></font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">!=</font><font color="#800000">''</font><font color="#808080">) </font><font color="#000080"><b>and </b></font><font color="#808080">(</font><font color="#000080">bQuebra</font><font color="#808080">==</font><font color="#000080"><b>False</b></font><font color="#808080">): 
    </font><font color="#000080">slinha</font><font color="#808080">=</font><font color="#000080">sArq</font><font color="#808080">.</font><font color="#000080">readline</font><font color="#808080">()
 
    </font><font color="#000080"><b>if </b>bPesqRelativa</font><font color="#808080">:
      </font><font color="#000080">sres</font><font color="#808080">=</font><font color="#000080">string</font><font color="#808080">.</font><font color="#000080">strip</font><font color="#808080">(</font><font color="#000080">copy</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">,</font><font color="#000080">nPosChave</font><font color="#808080">,</font><font color="#000080">nTamChave</font><font color="#808080">))
      </font><font color="#000080"><b>if </b>strRelativa</font><font color="#808080">(</font><font color="#000080">sres</font><font color="#808080">,</font><font color="#000080">sChave</font><font color="#808080">):
         </font><font color="#000080">bAchou</font><font color="#808080">=</font><font color="#000080"><b>True
         </b>bRet</font><font color="#808080">=</font><font color="#000080"><b>True
      else</b></font><font color="#808080">:
         </font><font color="#000080">bAchou</font><font color="#808080">=</font><font color="#000080"><b>False
    else</b></font><font color="#808080">:
      </font><font color="#000080">bAchou</font><font color="#808080">=</font><font color="#000080"><b>True
      </b>bRet</font><font color="#808080">=</font><font color="#000080"><b>True
  
    if </b>bAchou</font><font color="#808080">:
      </font><font color="#000080">mostrarDados</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#000080">copy</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#000080">nTamLinha</font><font color="#808080">), </font><font color="#FF0000">3</font><font color="#808080">)
      </font><font color="#000080">nCont</font><font color="#808080">+=</font><font color="#FF0000">1
  
    </font><font color="#000080">bQuebra</font><font color="#808080">=</font><font color="#000080">ContinuaSN</font><font color="#808080">(</font><font color="#000080">nCont</font><font color="#808080">, </font><font color="#000080">nQtdLinha</font><font color="#808080">)

  </font><font color="#000080"><b>return </b>bRet

</font><font color="#808080"><i>#------------------------------------------------------------------------------
# Lista varios registros entre arquivos de acordo com a pesquisa feita.
# sArq1 - o arquivo de ligacao
# sreg1 - o tipo de arquivo de ligacao
# nPosChave1 - a posicao inicial da primeira chave no arquivo de ligacao
# nTamChave1 - o tamanho da primeira chave no arquivo de ligacao
# nPosChave2 - a posicao inicial da segunda chave do arquivo de ligacao
# nTamChave2 - o tamanho da segunda chave do arquivo de ligacao
# sChave - a chave a ser pesquisada no arquivo de ligacao
# sArq2 - o arquivo a ser pesquisado
# sreg2 - o tipo de arquivo a ser pesquisado
# nPosChave3 - a posicao inicial da chave do arquivo pesquisado
# nQtdLinha - a quantidade de linhas a serem mostradas
#------------------------------------------------------------------------------
</i></font><font color="#000080"><b>def </b>ListarRegLigados</font><font color="#808080">(</font><font color="#000080">sArq1</font><font color="#808080">, </font><font color="#000080">sreg1</font><font color="#808080">, </font><font color="#000080">nPosChave1</font><font color="#808080">, </font><font color="#000080">nTamChave1</font><font color="#808080">, </font><font color="#000080">nPosChave2</font><font color="#808080">, 
                     </font><font color="#000080">nTamChave2</font><font color="#808080">, </font><font color="#000080">sChave</font><font color="#808080">, </font><font color="#000080">sArq2</font><font color="#808080">, </font><font color="#000080">sreg2</font><font color="#808080">, </font><font color="#000080">nPosChave3</font><font color="#808080">, </font><font color="#000080">nQtdLinha</font><font color="#808080">):
  </font><font color="#000080">slinha1</font><font color="#808080">=</font><font color="#800000">'0'
  </font><font color="#000080">bRet</font><font color="#808080">=</font><font color="#000080"><b>False
  </b>nCont</font><font color="#808080">=</font><font color="#FF0000">0
  </font><font color="#000080">bQuebra</font><font color="#808080">=</font><font color="#000080"><b>False
  </b>mostrarDados</font><font color="#808080">(</font><font color="#000080">sreg2</font><font color="#808080">, </font><font color="#800000">''</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">)
  </font><font color="#000080">sArq1</font><font color="#808080">.</font><font color="#000080">seek</font><font color="#808080">(</font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#000080">SEEK_SET</font><font color="#808080">)
  </font><font color="#000080"><b>while </b></font><font color="#808080">(</font><font color="#000080">slinha1</font><font color="#808080">!=</font><font color="#800000">''</font><font color="#808080">) </font><font color="#000080"><b>and </b></font><font color="#808080">(</font><font color="#000080">bQuebra</font><font color="#808080">==</font><font color="#000080"><b>False</b></font><font color="#808080">): 
    </font><font color="#000080">slinha1</font><font color="#808080">=</font><font color="#000080">sArq1</font><font color="#808080">.</font><font color="#000080">readline</font><font color="#808080">()
    </font><font color="#000080">sCodigo1</font><font color="#808080">=</font><font color="#000080">string</font><font color="#808080">.</font><font color="#000080">strip</font><font color="#808080">(</font><font color="#000080">copy</font><font color="#808080">(</font><font color="#000080">slinha1</font><font color="#808080">,</font><font color="#000080">nPosChave1</font><font color="#808080">,</font><font color="#000080">nTamChave1</font><font color="#808080">))
    </font><font color="#000080"><b>if </b>sCodigo1</font><font color="#808080">==</font><font color="#000080">sChave</font><font color="#808080">:
      </font><font color="#000080">sCodigo2</font><font color="#808080">=</font><font color="#000080">string</font><font color="#808080">.</font><font color="#000080">strip</font><font color="#808080">(</font><font color="#000080">copy</font><font color="#808080">(</font><font color="#000080">slinha1</font><font color="#808080">,</font><font color="#000080">nPosChave2</font><font color="#808080">,</font><font color="#000080">nTamChave2</font><font color="#808080">))
      </font><font color="#000080">slinha2</font><font color="#808080">=</font><font color="#000080">pesqArq</font><font color="#808080">(</font><font color="#000080">sArq2</font><font color="#808080">, </font><font color="#000080">sCodigo2</font><font color="#808080">, </font><font color="#000080">nPosChave3</font><font color="#808080">, </font><font color="#000080">nTamChave2</font><font color="#808080">, </font><font color="#000080">tamReg</font><font color="#808080">(</font><font color="#000080">sreg2</font><font color="#808080">))
      </font><font color="#000080">mostrarDados</font><font color="#808080">(</font><font color="#000080">sreg2</font><font color="#808080">, </font><font color="#000080">copy</font><font color="#808080">(</font><font color="#000080">slinha2</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#000080">tamReg</font><font color="#808080">(</font><font color="#000080">sreg2</font><font color="#808080">)), </font><font color="#FF0000">3</font><font color="#808080">)
      </font><font color="#000080">bRet</font><font color="#808080">=</font><font color="#000080"><b>True
      </b>nCont</font><font color="#808080">+=</font><font color="#FF0000">1
    </font><font color="#000080">bQuebra</font><font color="#808080">=</font><font color="#000080">ContinuaSN</font><font color="#808080">(</font><font color="#000080">nCont</font><font color="#808080">, </font><font color="#000080">nQtdLinha</font><font color="#808080">)

  </font><font color="#000080"><b>if </b>bRet</font><font color="#808080">==</font><font color="#000080"><b>False</b></font><font color="#808080">:
     </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg2</font><font color="#808080">,</font><font color="#FF0000">0</font><font color="#808080">))

<i>#------------------------------------------------------------------------------
# Valida a entrada de registros de acordo com a pesquisa feita.
# sArq - o arquivo
# sreg - o tipo de arquivo
# nTexto - o numero do rotulo da entrada
# sEntrada - a chave a ser pesquisada e validada
# nTentativas - o numero maximo de tentativas
# bPesqRelativa - indica se vai realizar uma pesquisa relativa
# bTipoEntrada - indica o tipo de entrada
# retorna - o registro pesquisado e validado
#------------------------------------------------------------------------------
</i></font><font color="#000080"><b>def </b>validaEntrada</font><font color="#808080">(</font><font color="#000080">sArq</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#000080">nTexto</font><font color="#808080">, </font><font color="#000080">sEntrada</font><font color="#808080">, </font><font color="#000080">nTentativas</font><font color="#808080">, 
                  </font><font color="#000080">bPesqRelativa</font><font color="#808080">, </font><font color="#000080">bTipoEntrada</font><font color="#808080">):
  </font><font color="#000080">nTamLinha</font><font color="#808080">=</font><font color="#000080">tamReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">)
  </font><font color="#000080">sMsgErro</font><font color="#808080">=</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">,</font><font color="#FF0000">0</font><font color="#808080">)
  </font><font color="#000080">sTexto</font><font color="#808080">=</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">,</font><font color="#000080">nTexto</font><font color="#808080">)
  </font><font color="#000080">nPosChave</font><font color="#808080">=</font><font color="#000080">g_nPosChave</font><font color="#808080">[</font><font color="#000080">sreg</font><font color="#808080">][</font><font color="#000080">nTexto</font><font color="#808080">-</font><font color="#FF0000">1</font><font color="#808080">]
  </font><font color="#000080">nTamChave</font><font color="#808080">=</font><font color="#000080">g_nTamChave</font><font color="#808080">[</font><font color="#000080">sreg</font><font color="#808080">][</font><font color="#000080">nTexto</font><font color="#808080">-</font><font color="#FF0000">1</font><font color="#808080">]

  </font><font color="#000080">ncont</font><font color="#808080">=</font><font color="#FF0000">1
  </font><font color="#000080">bQuebra</font><font color="#808080">=</font><font color="#000080"><b>False
  while </b></font><font color="#808080">(</font><font color="#000080">bQuebra</font><font color="#808080">==</font><font color="#000080"><b>False</b></font><font color="#808080">) </font><font color="#000080"><b>and </b></font><font color="#808080">(</font><font color="#000080">ncont </font><font color="#808080">&lt;= </font><font color="#000080">nTentativas </font><font color="#808080">):
    </font><font color="#000080"><b>if </b></font><font color="#800000">'opTexto' </font><font color="#000080"><b>in </b>bTipoEntrada</font><font color="#808080">:
      </font><font color="#000080">sEntrada </font><font color="#808080">= </font><font color="#000080"><b>raw_input</b></font><font color="#808080">(</font><font color="#000080">sTexto</font><font color="#808080">)
    </font><font color="#000080"><b>elif </b></font><font color="#800000">'opNumero' </font><font color="#000080"><b>in </b>bTipoEntrada</font><font color="#808080">:
       </font><font color="#000080">sEntrada </font><font color="#808080">= </font><font color="#000080">validaNumero</font><font color="#808080">(</font><font color="#000080">sTexto</font><font color="#808080">,</font><font color="#000080">sEntrada</font><font color="#808080">)
    </font><font color="#000080"><b>elif </b></font><font color="#800000">'opData' </font><font color="#000080"><b>in </b>bTipoEntrada</font><font color="#808080">:
       </font><font color="#000080">sEntrada </font><font color="#808080">= </font><font color="#000080">validaDataHora</font><font color="#808080">(</font><font color="#000080">sTexto</font><font color="#808080">,</font><font color="#000080">sEntrada</font><font color="#808080">,</font><font color="#000080"><b>True</b></font><font color="#808080">)
    </font><font color="#000080"><b>elif </b></font><font color="#800000">'opDataHora' </font><font color="#000080"><b>in </b>bTipoEntrada</font><font color="#808080">:
       </font><font color="#000080">sEntrada</font><font color="#808080">=</font><font color="#000080">validaDataHora</font><font color="#808080">(</font><font color="#000080">sTexto</font><font color="#808080">,</font><font color="#000080">sEntrada</font><font color="#808080">,</font><font color="#000080"><b>False</b></font><font color="#808080">)
    </font><font color="#000080"><b>elif </b></font><font color="#800000">'opSenha' </font><font color="#000080"><b>in </b>bTipoEntrada</font><font color="#808080">:
       </font><font color="#000080">sEntrada </font><font color="#808080">= </font><font color="#000080">digitaSenha</font><font color="#808080">(</font><font color="#000080">sTexto</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">)

    </font><font color="#000080">sres</font><font color="#808080">=</font><font color="#800000">''
    </font><font color="#000080"><b>if </b>bPesqRelativa</font><font color="#808080">:
       </font><font color="#000080"><b>if </b>ListarTodos</font><font color="#808080">(</font><font color="#000080">sArq</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#000080">sEntrada</font><font color="#808080">, </font><font color="#000080">nPosChave</font><font color="#808080">, </font><font color="#000080">nTamChave</font><font color="#808080">, 
         </font><font color="#000080">nTamLinha</font><font color="#808080">, </font><font color="#000080">QTD_MAX_LINHA</font><font color="#808080">, </font><font color="#000080"><b>True</b></font><font color="#808080">):
         </font><font color="#000080">sres </font><font color="#808080">= </font><font color="#800000">' '
    </font><font color="#000080"><b>else</b></font><font color="#808080">:
       </font><font color="#000080">sres </font><font color="#808080">= </font><font color="#000080">pesqArq</font><font color="#808080">(</font><font color="#000080">sArq</font><font color="#808080">, </font><font color="#000080">sEntrada</font><font color="#808080">, </font><font color="#000080">nPosChave</font><font color="#808080">, </font><font color="#000080">nTamChave</font><font color="#808080">, </font><font color="#000080">nTamLinha</font><font color="#808080">)

    </font><font color="#000080"><b>if </b>sres</font><font color="#808080">==</font><font color="#800000">''</font><font color="#808080">:
       </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#000080">sMsgErro</font><font color="#808080">)
    </font><font color="#000080"><b>else</b></font><font color="#808080">:
       </font><font color="#000080">bQuebra</font><font color="#808080">=</font><font color="#000080"><b>True

    </b>ncont</font><font color="#808080">+=</font><font color="#FF0000">1

  </font><font color="#000080"><b>return </b>sres

</font><font color="#808080"><i>#------------------------------------------------------------------------------
# Mostra a tela de splash do sistema.
#------------------------------------------------------------------------------
</i></font><font color="#000080"><b>def </b>frmSplash</font><font color="#808080">():
  </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#800000">'*---------------------------------------'</font><font color="#808080">+
  </font><font color="#800000">'-------------------------------------*'</font><font color="#808080">)
  </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#800000">'| LL    II VV   VV RRRRR  UU  UU   SSSS '</font><font color="#808080">+
  </font><font color="#800000">'VV   VV II RRRRR  TTTT UU  UU   SSSS |'</font><font color="#808080">)
  </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#800000">'| LL    II  VV VV  RR   R UU  UU  SS    '</font><font color="#808080">+
  </font><font color="#800000">' VV VV  II RR   R  TT  UU  UU  SS    |'</font><font color="#808080">)
  </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#800000">'| LL    II   VVV   RRRRR  UU  UU    SS  '</font><font color="#808080">+
  </font><font color="#800000">'  VVV   II RRRRR   TT  UU  UU    SS  |'</font><font color="#808080">)
  </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#800000">'| LLLLL II    V    RR   R  UUUU  SSSS   '</font><font color="#808080">+
  </font><font color="#800000">'   V    II RR   R  TT   UUUU  SSSS   |'</font><font color="#808080">)
  </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#800000">'*---------------------------------------'</font><font color="#808080">+
  </font><font color="#800000">'-------------------------------------*'</font><font color="#808080">)
  </font><font color="#000080"><b>for </b>cont <b>in range</b></font><font color="#808080">(</font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">19</font><font color="#808080">): </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#800000">''</font><font color="#808080">)
  </font><font color="#000080"><b>print </b>MSG_PRESS</font><font color="#808080">,
  </font><font color="#000080"><b>raw_input</b></font><font color="#808080">()

<i>#------------------------------------------------------------------------------
# Mostra a tela de sobre do sistema.
#------------------------------------------------------------------------------
</i></font><font color="#000080"><b>def </b>frmSobre</font><font color="#808080">():
  </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#800000">'*------------------------------------------------------------*'</font><font color="#808080">)
  </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#800000">'|  LL        II  VV       VV  RRRRRRR   UU    UU   SSSSSSS   |'</font><font color="#808080">)
  </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#800000">'|  LL        II   VV     VV   RR     R  UU    UU  SS         |'</font><font color="#808080">)
  </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#800000">'|  LL        II    VV   VV    RR     R  UU    UU   SSSS      |'</font><font color="#808080">)
  </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#800000">'|  LL        II     VV VV     RRRRRRR   UU    UU     SSSS    |'</font><font color="#808080">)
  </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#800000">'|  LLLL      II      VVV      RR RR     UU    UU        SS   |'</font><font color="#808080">)
  </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#800000">'|  LLLLLLLL  II       V       RR   RR    UUUUUU   SSSSSSSS   |'</font><font color="#808080">)
  </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#800000">'|                                                            |'</font><font color="#808080">)
  </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#800000">'|  VV       VV  II  RRRRRRR   TTTTTTTT  UU    UU   SSSSSSS   |'</font><font color="#808080">)
  </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#800000">'|   VV     VV   II  RR     R     TT     UU    UU  SS         |'</font><font color="#808080">)
  </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#800000">'|    VV   VV    II  RR     R     TT     UU    UU   SSSS      |'</font><font color="#808080">)
  </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#800000">'|     VV VV     II  RRRRRRR      TT     UU    UU     SSSS    |'</font><font color="#808080">)
  </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#800000">'|      VVV      II  RR RR        TT     UU    UU        SS   |'</font><font color="#808080">)
  </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#800000">'|       V       II  RR   RR      TT      UUUUUU   SSSSSSSS   |'</font><font color="#808080">)
  </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#800000">'|                                                            |'</font><font color="#808080">)
  </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#800000">'|                                               Versao 1.0.0 |'</font><font color="#808080">)
  </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#800000">'| Sistema integrante do projeto Livrus Virtus.               |'</font><font color="#808080">)
  </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#800000">'| Todos os direitos reservados para Henrique F. de Souza.    |'</font><font color="#808080">)
  </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#800000">'| Versao programada na linguagem python.                     |'</font><font color="#808080">)
  </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#800000">'*------------------------------------------------------------*'</font><font color="#808080">)
  </font><font color="#000080"><b>for </b>cont <b>in range</b></font><font color="#808080">(</font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">5</font><font color="#808080">): </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#800000">''</font><font color="#808080">)
  </font><font color="#000080"><b>print </b>MSG_PRESS</font><font color="#808080">,
  </font><font color="#000080"><b>raw_input</b></font><font color="#808080">()

<i>#------------------------------------------------------------------------------
# Mostra a tela de login do sistema.
# retorna - se o login foi validado corretamente
#------------------------------------------------------------------------------
</i></font><font color="#000080"><b>def </b>frmLogin</font><font color="#808080">():
  </font><font color="#000080">slinha </font><font color="#808080">= </font><font color="#800000">''
  </font><font color="#000080">bret </font><font color="#808080">= </font><font color="#000080"><b>False
  print</b></font><font color="#808080">(</font><font color="#800000">'*--------------------------------------------------------------*'</font><font color="#808080">)
  </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#800000">'| Login do sistema                                             |'</font><font color="#808080">)
  </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#800000">'*--------------------------------------------------------------*'</font><font color="#808080">)
  </font><font color="#000080">slinha</font><font color="#808080">=</font><font color="#000080">validaEntrada</font><font color="#808080">(</font><font color="#000080">tf</font><font color="#808080">[</font><font color="#800000">'Usuario'</font><font color="#808080">], </font><font color="#800000">'opUsuario'</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#000080">tUsuario</font><font color="#808080">[</font><font color="#800000">'login'</font><font color="#808080">], </font><font color="#FF0000">3</font><font color="#808080">,
         </font><font color="#000080"><b>False</b></font><font color="#808080">, </font><font color="#800000">'opTexto'</font><font color="#808080">)
  </font><font color="#000080"><b>if </b>slinha</font><font color="#808080">!=</font><font color="#800000">''</font><font color="#808080">:
     </font><font color="#000080">slinha</font><font color="#808080">=</font><font color="#000080">validaEntrada</font><font color="#808080">(</font><font color="#000080">tf</font><font color="#808080">[</font><font color="#800000">'Usuario'</font><font color="#808080">], </font><font color="#800000">'opUsuario'</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">, </font><font color="#000080">tUsuario</font><font color="#808080">[</font><font color="#800000">'senha'</font><font color="#808080">], </font><font color="#FF0000">3</font><font color="#808080">,
        </font><font color="#000080"><b>False</b></font><font color="#808080">, </font><font color="#800000">'opSenha'</font><font color="#808080">)
     </font><font color="#000080"><b>if </b>slinha</font><font color="#808080">!=</font><font color="#800000">''</font><font color="#808080">:
        </font><font color="#000080">tUsuario</font><font color="#808080">[</font><font color="#800000">'login'</font><font color="#808080">]=</font><font color="#000080">string</font><font color="#808080">.</font><font color="#000080">strip</font><font color="#808080">(</font><font color="#000080">copy</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">))
        </font><font color="#000080">tUsuario</font><font color="#808080">[</font><font color="#800000">'senha'</font><font color="#808080">]=</font><font color="#000080">string</font><font color="#808080">.</font><font color="#000080">strip</font><font color="#808080">(</font><font color="#000080">copy</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">11</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">))
        </font><font color="#000080">bret </font><font color="#808080">= </font><font color="#000080"><b>True
  return </b>bret

</font><font color="#808080"><i>#------------------------------------------------------------------------------
# Mostra os menus do sistema.
# num - o numero do menu
#------------------------------------------------------------------------------
</i></font><font color="#000080"><b>def </b>menu</font><font color="#808080">(</font><font color="#000080">num</font><font color="#808080">):
 </font><font color="#000080"><b>if </b></font><font color="#808080">(</font><font color="#000080">num</font><font color="#808080">==</font><font color="#FF0000">1</font><font color="#808080">): 
   </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#800000">'*--------------------------------------------------------------*'</font><font color="#808080">)
   </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#800000">'| (C)adastros        (P)esquisas     (V)endas        (O)pcoes  |'</font><font color="#808080">)
   </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#800000">'*--------------------------------------------------------------*'</font><font color="#808080">)
 </font><font color="#000080"><b>elif </b></font><font color="#808080">(</font><font color="#000080">num</font><font color="#808080">==</font><font color="#FF0000">2</font><font color="#808080">):
   </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#800000">'*---------------------------------*'</font><font color="#808080">)
   </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#800000">'| 01. Cadastro de Assuntos        |'</font><font color="#808080">)
   </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#800000">'| 02. Cadastro de Autores         |'</font><font color="#808080">)
   </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#800000">'| 03. Cadastro de Editoras        |'</font><font color="#808080">)
   </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#800000">'| 04. Cadastro de Enderecos       |'</font><font color="#808080">)
   </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#800000">'| 05. Cadastro de Idiomas         |'</font><font color="#808080">)
   </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#800000">'| 06. Cadastro de Paises          |'</font><font color="#808080">)
   </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#800000">'| 07. Cadastro de Profissoes      |'</font><font color="#808080">)
   </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#800000">'| 08. Cadastro de Clientes        |'</font><font color="#808080">)
   </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#800000">'| 09. Cadastro de Livros          |'</font><font color="#808080">)
   </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#800000">'| 10. Voltar ao menu              |'</font><font color="#808080">)
   </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#800000">'*---------------------------------*'</font><font color="#808080">)
 </font><font color="#000080"><b>elif </b></font><font color="#808080">(</font><font color="#000080">num</font><font color="#808080">==</font><font color="#FF0000">3</font><font color="#808080">):
   </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#800000">'*---------------------------------*'</font><font color="#808080">)
   </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#800000">'| 01. Consulta de Assuntos        |'</font><font color="#808080">)
   </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#800000">'| 02. Consulta de Autores         |'</font><font color="#808080">)
   </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#800000">'| 03. Consulta de Editoras        |'</font><font color="#808080">)
   </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#800000">'| 04. Consulta de Enderecos       |'</font><font color="#808080">)
   </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#800000">'| 05. Consulta de Idiomas         |'</font><font color="#808080">)
   </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#800000">'| 06. Consulta de Paises          |'</font><font color="#808080">)
   </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#800000">'| 07. Consulta de Profissoes      |'</font><font color="#808080">)
   </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#800000">'| 08. Consulta de Clientes        |'</font><font color="#808080">)
   </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#800000">'| 09. Consulta de Livros          |'</font><font color="#808080">)
   </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#800000">'| 10. Voltar ao menu              |'</font><font color="#808080">)
   </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#800000">'*---------------------------------*'</font><font color="#808080">)
 </font><font color="#000080"><b>elif </b></font><font color="#808080">(</font><font color="#000080">num</font><font color="#808080">==</font><font color="#FF0000">4</font><font color="#808080">):
   </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#800000">'*---------------------------------*'</font><font color="#808080">)
   </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#800000">'| 01. Vender Livros               |'</font><font color="#808080">)
   </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#800000">'| 02. Vendas Realizadas           |'</font><font color="#808080">)
   </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#800000">'| 03. Voltar ao menu              |'</font><font color="#808080">)
   </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#800000">'*---------------------------------*'</font><font color="#808080">)
 </font><font color="#000080"><b>elif </b></font><font color="#808080">(</font><font color="#000080">num</font><font color="#808080">==</font><font color="#FF0000">5</font><font color="#808080">):
   </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#800000">'*---------------------------------*'</font><font color="#808080">)
   </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#800000">'| 01. Alterar senha               |'</font><font color="#808080">)
   </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#800000">'| 02. Sobre o sistema             |'</font><font color="#808080">)
   </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#800000">'| 03. Sair do sistema             |'</font><font color="#808080">)
   </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#800000">'| 04. Voltar ao menu              |'</font><font color="#808080">)
   </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#800000">'*---------------------------------*'</font><font color="#808080">)
 </font><font color="#000080"><b>elif </b></font><font color="#808080">(</font><font color="#000080">num</font><font color="#808080">==</font><font color="#FF0000">6</font><font color="#808080">):
   </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#800000">'*--------------------------------------------------------------*'</font><font color="#808080">)
   </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#800000">'| (1) Novo  (2) Pesquisar   (3) Voltar ao menu                 |'</font><font color="#808080">)
   </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#800000">'*--------------------------------------------------------------*'</font><font color="#808080">)
 </font><font color="#000080"><b>elif </b></font><font color="#808080">(</font><font color="#000080">num</font><font color="#808080">==</font><font color="#FF0000">7</font><font color="#808080">):
   </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#800000">'*--------------------------------------------------------------*'</font><font color="#808080">)
   </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#800000">'| (1) Salvar inclusao       (2) Voltar ao menu                 |'</font><font color="#808080">)
   </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#800000">'*--------------------------------------------------------------*'</font><font color="#808080">)
 </font><font color="#000080"><b>elif </b></font><font color="#808080">(</font><font color="#000080">num</font><font color="#808080">==</font><font color="#FF0000">8</font><font color="#808080">):
   </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#800000">'*--------------------------------------------------------------*'</font><font color="#808080">)
   </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#800000">'| (1) Alterar       (2) Excluir     (3) Voltar ao menu         |'</font><font color="#808080">)
   </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#800000">'*--------------------------------------------------------------*'</font><font color="#808080">)
 </font><font color="#000080"><b>elif </b></font><font color="#808080">(</font><font color="#000080">num</font><font color="#808080">==</font><font color="#FF0000">9</font><font color="#808080">):
   </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#800000">'*--------------------------------------------------------------*'</font><font color="#808080">)
   </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#800000">'| (1) Salvar alteracao      (2) Voltar ao menu                 |'</font><font color="#808080">)
   </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#800000">'*--------------------------------------------------------------*'</font><font color="#808080">)
 </font><font color="#000080"><b>elif </b></font><font color="#808080">(</font><font color="#000080">num</font><font color="#808080">==</font><font color="#FF0000">10</font><font color="#808080">):
   </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#800000">'*--------------------------------------------------------------*'</font><font color="#808080">)
   </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#800000">'| Certeza de excluir? (S/N)                                    |'</font><font color="#808080">)
   </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#800000">'*--------------------------------------------------------------*'</font><font color="#808080">)
 </font><font color="#000080"><b>elif </b></font><font color="#808080">(</font><font color="#000080">num</font><font color="#808080">==</font><font color="#FF0000">11</font><font color="#808080">):
   </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#800000">'*--------------------------------------------------------------*'</font><font color="#808080">)
   </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#800000">'| Deseja sair do sistema? (S/N)                                |'</font><font color="#808080">)
   </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#800000">'*--------------------------------------------------------------*'</font><font color="#808080">)
 </font><font color="#000080"><b>elif </b></font><font color="#808080">(</font><font color="#000080">num</font><font color="#808080">==</font><font color="#FF0000">12</font><font color="#808080">):
   </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#800000">'*--------------------------------------------------------------*'</font><font color="#808080">)
   </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#800000">'| (1) Pesquisar  (2) Listar todos   (3) Voltar ao menu         |'</font><font color="#808080">)
   </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#800000">'*--------------------------------------------------------------*'</font><font color="#808080">)
 </font><font color="#000080"><b>elif </b></font><font color="#808080">(</font><font color="#000080">num</font><font color="#808080">==</font><font color="#FF0000">13</font><font color="#808080">):
   </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#800000">'*--------------------------------------------------------------*'</font><font color="#808080">)
   </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#800000">'| Deseja continuar? (S/N)                                      |'</font><font color="#808080">)
   </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#800000">'*--------------------------------------------------------------*'</font><font color="#808080">)
 </font><font color="#000080"><b>elif </b></font><font color="#808080">(</font><font color="#000080">num</font><font color="#808080">==</font><font color="#FF0000">14</font><font color="#808080">):
   </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#800000">'*--------------------------------------------------------------*'</font><font color="#808080">)
   </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#800000">'| Salvar inclusao (S/N)                                        |'</font><font color="#808080">)
   </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#800000">'*--------------------------------------------------------------*'</font><font color="#808080">)
 </font><font color="#000080"><b>print </b>MSG_OPCAO</font><font color="#808080">,

<i>#------------------------------------------------------------------------------
# Realiza os cadastros de acordo com o tipo de arquivo.
# sreg - o tipo de arquivo
# sacao - a acao a ser realizada
#------------------------------------------------------------------------------
</i></font><font color="#000080"><b>def </b>frmCadastros</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#000080">sacao</font><font color="#808080">):
  </font><font color="#000080">slinha </font><font color="#808080">= </font><font color="#800000">''
  
  </font><font color="#000080"><b>if </b>sreg</font><font color="#808080">==</font><font color="#800000">'opAssunto'</font><font color="#808080">:
     </font><font color="#000080"><b>if </b>sacao</font><font color="#808080">==</font><font color="#800000">'opNovo'</font><font color="#808080">:
        </font><font color="#000080">tAssunto</font><font color="#808080">[</font><font color="#800000">'codigo'</font><font color="#808080">]=</font><font color="#000080">pesqMaxCod</font><font color="#808080">(</font><font color="#000080">tf</font><font color="#808080">[</font><font color="#800000">'Assunto'</font><font color="#808080">], </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">, </font><font color="#000080">tamReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">))
        </font><font color="#000080">mostrarDados</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#800000">''</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">)
        </font><font color="#000080">subMenu</font><font color="#808080">(</font><font color="#FF0000">7</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">)
     </font><font color="#000080"><b>elif </b>sacao</font><font color="#808080">==</font><font color="#800000">'opPesquisar'</font><font color="#808080">:
       </font><font color="#000080">slinha</font><font color="#808080">=</font><font color="#000080">validaEntrada</font><font color="#808080">(</font><font color="#000080">tf</font><font color="#808080">[</font><font color="#800000">'Assunto'</font><font color="#808080">],</font><font color="#000080">sreg</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#000080">tAssunto</font><font color="#808080">[</font><font color="#800000">'codigo'</font><font color="#808080">],</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#000080"><b>False</b></font><font color="#808080">,</font><font color="#800000">'opNumero'</font><font color="#808080">)
       </font><font color="#000080"><b>if </b>slinha</font><font color="#808080">!=</font><font color="#800000">''</font><font color="#808080">:
          </font><font color="#000080">mostrarDados</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#800000">''</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">)
          </font><font color="#000080">mostrarDados</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">)
          </font><font color="#000080">subMenu</font><font color="#808080">(</font><font color="#FF0000">8</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">)        
     </font><font color="#000080"><b>elif </b>sacao</font><font color="#808080">==</font><font color="#800000">'opAlterar'</font><font color="#808080">:
        </font><font color="#000080">mostrarDados</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#800000">''</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">)
        </font><font color="#000080">subMenu</font><font color="#808080">(</font><font color="#FF0000">9</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">)
     </font><font color="#000080"><b>elif </b>sacao</font><font color="#808080">==</font><font color="#800000">'opExcluir'</font><font color="#808080">:
        </font><font color="#000080">subMenu</font><font color="#808080">(</font><font color="#FF0000">10</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">)     
  </font><font color="#000080"><b>elif </b>sreg</font><font color="#808080">==</font><font color="#800000">'opAutor'</font><font color="#808080">:
     </font><font color="#000080"><b>if </b>sacao</font><font color="#808080">==</font><font color="#800000">'opNovo'</font><font color="#808080">:
        </font><font color="#000080">tAutor</font><font color="#808080">[</font><font color="#800000">'codigo'</font><font color="#808080">]=</font><font color="#000080">pesqMaxCod</font><font color="#808080">(</font><font color="#000080">tf</font><font color="#808080">[</font><font color="#800000">'Autor'</font><font color="#808080">], </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">, </font><font color="#000080">tamReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">))
        </font><font color="#000080">mostrarDados</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#800000">''</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">)
        </font><font color="#000080">subMenu</font><font color="#808080">(</font><font color="#FF0000">7</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">)
     </font><font color="#000080"><b>elif </b>sacao</font><font color="#808080">==</font><font color="#800000">'opPesquisar'</font><font color="#808080">:
        </font><font color="#000080">slinha</font><font color="#808080">=</font><font color="#000080">validaEntrada</font><font color="#808080">(</font><font color="#000080">tf</font><font color="#808080">[</font><font color="#800000">'Autor'</font><font color="#808080">], </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#000080">tAutor</font><font color="#808080">[</font><font color="#800000">'codigo'</font><font color="#808080">],</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#000080"><b>False</b></font><font color="#808080">,</font><font color="#800000">'opNumero'</font><font color="#808080">)
        </font><font color="#000080"><b>if </b>slinha</font><font color="#808080">!=</font><font color="#800000">''</font><font color="#808080">:
          </font><font color="#000080">mostrarDados</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#800000">''</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">)
          </font><font color="#000080">mostrarDados</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">)
          </font><font color="#000080">subMenu</font><font color="#808080">(</font><font color="#FF0000">8</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">)        
     </font><font color="#000080"><b>elif </b>sacao</font><font color="#808080">==</font><font color="#800000">'opAlterar'</font><font color="#808080">:
        </font><font color="#000080">mostrarDados</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#800000">''</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">)
        </font><font color="#000080">subMenu</font><font color="#808080">(</font><font color="#FF0000">9</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">)
     </font><font color="#000080"><b>elif </b>sacao</font><font color="#808080">==</font><font color="#800000">'opExcluir'</font><font color="#808080">:
        </font><font color="#000080">subMenu</font><font color="#808080">(</font><font color="#FF0000">10</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">)     
  </font><font color="#000080"><b>elif </b>sreg</font><font color="#808080">==</font><font color="#800000">'opEditora'</font><font color="#808080">:
     </font><font color="#000080"><b>if </b>sacao</font><font color="#808080">==</font><font color="#800000">'opNovo'</font><font color="#808080">:
        </font><font color="#000080">tEditora</font><font color="#808080">[</font><font color="#800000">'codigo'</font><font color="#808080">]=</font><font color="#000080">pesqMaxCod</font><font color="#808080">(</font><font color="#000080">tf</font><font color="#808080">[</font><font color="#800000">'Editora'</font><font color="#808080">], </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">, </font><font color="#000080">tamReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">))
        </font><font color="#000080">mostrarDados</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#800000">''</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">)
        </font><font color="#000080">subMenu</font><font color="#808080">(</font><font color="#FF0000">7</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">)
     </font><font color="#000080"><b>elif </b>sacao</font><font color="#808080">==</font><font color="#800000">'opPesquisar'</font><font color="#808080">:
       </font><font color="#000080">slinha</font><font color="#808080">=</font><font color="#000080">validaEntrada</font><font color="#808080">(</font><font color="#000080">tf</font><font color="#808080">[</font><font color="#800000">'Editora'</font><font color="#808080">],</font><font color="#000080">sreg</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#000080">tEditora</font><font color="#808080">[</font><font color="#800000">'codigo'</font><font color="#808080">],</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#000080"><b>False</b></font><font color="#808080">,</font><font color="#800000">'opNumero'</font><font color="#808080">)
       </font><font color="#000080"><b>if </b>slinha</font><font color="#808080">!=</font><font color="#800000">''</font><font color="#808080">:
          </font><font color="#000080">mostrarDados</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#800000">''</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">)
          </font><font color="#000080">mostrarDados</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">)
          </font><font color="#000080">subMenu</font><font color="#808080">(</font><font color="#FF0000">8</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">)        
     </font><font color="#000080"><b>elif </b>sacao</font><font color="#808080">==</font><font color="#800000">'opAlterar'</font><font color="#808080">:
        </font><font color="#000080">mostrarDados</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#800000">''</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">)
        </font><font color="#000080">subMenu</font><font color="#808080">(</font><font color="#FF0000">9</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">)
     </font><font color="#000080"><b>elif </b>sacao</font><font color="#808080">==</font><font color="#800000">'opExcluir'</font><font color="#808080">:
        </font><font color="#000080">subMenu</font><font color="#808080">(</font><font color="#FF0000">10</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">)     
  </font><font color="#000080"><b>elif </b>sreg</font><font color="#808080">==</font><font color="#800000">'opEndereco'</font><font color="#808080">:
     </font><font color="#000080"><b>if </b>sacao</font><font color="#808080">==</font><font color="#800000">'opNovo'</font><font color="#808080">:
        </font><font color="#000080">tEndereco</font><font color="#808080">[</font><font color="#800000">'codigo'</font><font color="#808080">]=</font><font color="#000080">pesqMaxCod</font><font color="#808080">(</font><font color="#000080">tf</font><font color="#808080">[</font><font color="#800000">'Endereco'</font><font color="#808080">], </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">, </font><font color="#000080">tamReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">))
        </font><font color="#000080">mostrarDados</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#800000">''</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">)
        </font><font color="#000080">subMenu</font><font color="#808080">(</font><font color="#FF0000">7</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">)
     </font><font color="#000080"><b>elif </b>sacao</font><font color="#808080">==</font><font color="#800000">'opPesquisar'</font><font color="#808080">:
        </font><font color="#000080">slinha</font><font color="#808080">=</font><font color="#000080">validaEntrada</font><font color="#808080">(</font><font color="#000080">tf</font><font color="#808080">[</font><font color="#800000">'Endereco'</font><font color="#808080">],</font><font color="#000080">sreg</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#000080">tEndereco</font><font color="#808080">[</font><font color="#800000">'codigo'</font><font color="#808080">],</font><font color="#FF0000">1</font><font color="#808080">,
                </font><font color="#000080"><b>False</b></font><font color="#808080">,</font><font color="#800000">'opNumero'</font><font color="#808080">)
        </font><font color="#000080"><b>if </b>slinha</font><font color="#808080">!=</font><font color="#800000">''</font><font color="#808080">:
          </font><font color="#000080">mostrarDados</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#800000">''</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">)
          </font><font color="#000080">mostrarDados</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">)
          </font><font color="#000080">subMenu</font><font color="#808080">(</font><font color="#FF0000">8</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">)        
     </font><font color="#000080"><b>elif </b>sacao</font><font color="#808080">==</font><font color="#800000">'opAlterar'</font><font color="#808080">:
        </font><font color="#000080">mostrarDados</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#800000">''</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">)
        </font><font color="#000080">subMenu</font><font color="#808080">(</font><font color="#FF0000">9</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">)
     </font><font color="#000080"><b>elif </b>sacao</font><font color="#808080">==</font><font color="#800000">'opExcluir'</font><font color="#808080">:
        </font><font color="#000080">subMenu</font><font color="#808080">(</font><font color="#FF0000">10</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">)     
  </font><font color="#000080"><b>elif </b>sreg</font><font color="#808080">==</font><font color="#800000">'opIdioma'</font><font color="#808080">:
     </font><font color="#000080"><b>if </b>sacao</font><font color="#808080">==</font><font color="#800000">'opNovo'</font><font color="#808080">:
        </font><font color="#000080">tIdioma</font><font color="#808080">[</font><font color="#800000">'codigo'</font><font color="#808080">]=</font><font color="#000080">pesqMaxCod</font><font color="#808080">(</font><font color="#000080">tf</font><font color="#808080">[</font><font color="#800000">'Idioma'</font><font color="#808080">], </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">, </font><font color="#000080">tamReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">))
        </font><font color="#000080">mostrarDados</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#800000">''</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">)
        </font><font color="#000080">subMenu</font><font color="#808080">(</font><font color="#FF0000">7</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">)
     </font><font color="#000080"><b>elif </b>sacao</font><font color="#808080">==</font><font color="#800000">'opPesquisar'</font><font color="#808080">:
        </font><font color="#000080">slinha</font><font color="#808080">=</font><font color="#000080">validaEntrada</font><font color="#808080">(</font><font color="#000080">tf</font><font color="#808080">[</font><font color="#800000">'Idioma'</font><font color="#808080">],</font><font color="#000080">sreg</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#000080">tIdioma</font><font color="#808080">[</font><font color="#800000">'codigo'</font><font color="#808080">],</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#000080"><b>False</b></font><font color="#808080">,</font><font color="#800000">'opNumero'</font><font color="#808080">)
        </font><font color="#000080"><b>if </b>slinha</font><font color="#808080">!=</font><font color="#800000">''</font><font color="#808080">:
          </font><font color="#000080">mostrarDados</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#800000">''</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">)
          </font><font color="#000080">mostrarDados</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">)
          </font><font color="#000080">subMenu</font><font color="#808080">(</font><font color="#FF0000">8</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">)        
     </font><font color="#000080"><b>elif </b>sacao</font><font color="#808080">==</font><font color="#800000">'opAlterar'</font><font color="#808080">:
        </font><font color="#000080">mostrarDados</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#800000">''</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">)
        </font><font color="#000080">subMenu</font><font color="#808080">(</font><font color="#FF0000">9</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">)
     </font><font color="#000080"><b>elif </b>sacao</font><font color="#808080">==</font><font color="#800000">'opExcluir'</font><font color="#808080">:
        </font><font color="#000080">subMenu</font><font color="#808080">(</font><font color="#FF0000">10</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">)     
  </font><font color="#000080"><b>elif </b>sreg</font><font color="#808080">==</font><font color="#800000">'opPais'</font><font color="#808080">:
     </font><font color="#000080"><b>if </b>sacao</font><font color="#808080">==</font><font color="#800000">'opNovo'</font><font color="#808080">:
        </font><font color="#000080">tPais</font><font color="#808080">[</font><font color="#800000">'codigo'</font><font color="#808080">] = </font><font color="#000080"><b>raw_input</b></font><font color="#808080">(</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">))
        </font><font color="#000080">slinha</font><font color="#808080">=</font><font color="#000080">pesqArq</font><font color="#808080">(</font><font color="#000080">tf</font><font color="#808080">[</font><font color="#800000">'Pais'</font><font color="#808080">], </font><font color="#000080">tPais</font><font color="#808080">[</font><font color="#800000">'codigo'</font><font color="#808080">], </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">, </font><font color="#000080">tamReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">))
        </font><font color="#000080"><b>if </b>slinha</font><font color="#808080">==</font><font color="#800000">''</font><font color="#808080">:
           </font><font color="#000080">pesqLinhaExcluida</font><font color="#808080">(</font><font color="#000080">tf</font><font color="#808080">[</font><font color="#800000">'Pais'</font><font color="#808080">], </font><font color="#000080">tamReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">))
           </font><font color="#000080">mostrarDados</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#800000">''</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">)
           </font><font color="#000080">subMenu</font><font color="#808080">(</font><font color="#FF0000">7</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">)
        </font><font color="#000080"><b>else</b></font><font color="#808080">: </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#000080">MSG_REGEXST</font><font color="#808080">)
     </font><font color="#000080"><b>elif </b>sacao</font><font color="#808080">==</font><font color="#800000">'opPesquisar'</font><font color="#808080">:
        </font><font color="#000080">slinha</font><font color="#808080">=</font><font color="#000080">validaEntrada</font><font color="#808080">(</font><font color="#000080">tf</font><font color="#808080">[</font><font color="#800000">'Pais'</font><font color="#808080">], </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#000080">tPais</font><font color="#808080">[</font><font color="#800000">'codigo'</font><font color="#808080">], </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#000080"><b>False</b></font><font color="#808080">, </font><font color="#800000">'opTexto'</font><font color="#808080">)
        </font><font color="#000080"><b>if </b>slinha</font><font color="#808080">!=</font><font color="#800000">''</font><font color="#808080">:
          </font><font color="#000080">mostrarDados</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#800000">''</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">)
          </font><font color="#000080">mostrarDados</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">)
          </font><font color="#000080">subMenu</font><font color="#808080">(</font><font color="#FF0000">8</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">)        
     </font><font color="#000080"><b>elif </b>sacao</font><font color="#808080">==</font><font color="#800000">'opAlterar'</font><font color="#808080">:
        </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">) + </font><font color="#000080">tPais</font><font color="#808080">[</font><font color="#800000">'codigo'</font><font color="#808080">])
        </font><font color="#000080">mostrarDados</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#800000">''</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">)
        </font><font color="#000080">subMenu</font><font color="#808080">(</font><font color="#FF0000">9</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">)
     </font><font color="#000080"><b>elif </b>sacao</font><font color="#808080">==</font><font color="#800000">'opExcluir'</font><font color="#808080">:
        </font><font color="#000080">subMenu</font><font color="#808080">(</font><font color="#FF0000">10</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">)     
  </font><font color="#000080"><b>elif </b>sreg</font><font color="#808080">==</font><font color="#800000">'opProfissao'</font><font color="#808080">:
     </font><font color="#000080"><b>if </b>sacao</font><font color="#808080">==</font><font color="#800000">'opNovo'</font><font color="#808080">:
        </font><font color="#000080">tProfissao</font><font color="#808080">[</font><font color="#800000">'codigo'</font><font color="#808080">]=</font><font color="#000080">pesqMaxCod</font><font color="#808080">(</font><font color="#000080">tf</font><font color="#808080">[</font><font color="#800000">'Profissao'</font><font color="#808080">], </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">, </font><font color="#000080">tamReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">))
        </font><font color="#000080">mostrarDados</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#800000">''</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">)
        </font><font color="#000080">subMenu</font><font color="#808080">(</font><font color="#FF0000">7</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">)
     </font><font color="#000080"><b>elif </b>sacao</font><font color="#808080">==</font><font color="#800000">'opPesquisar'</font><font color="#808080">:
        </font><font color="#000080">slinha</font><font color="#808080">=</font><font color="#000080">validaEntrada</font><font color="#808080">(</font><font color="#000080">tf</font><font color="#808080">[</font><font color="#800000">'Profissao'</font><font color="#808080">],</font><font color="#000080">sreg</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#000080">tProfissao</font><font color="#808080">[</font><font color="#800000">'codigo'</font><font color="#808080">],</font><font color="#FF0000">1</font><font color="#808080">,
                </font><font color="#000080"><b>False</b></font><font color="#808080">,</font><font color="#800000">'opNumero'</font><font color="#808080">)
        </font><font color="#000080"><b>if </b>slinha</font><font color="#808080">!=</font><font color="#800000">''</font><font color="#808080">:
          </font><font color="#000080">mostrarDados</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#800000">''</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">)
          </font><font color="#000080">mostrarDados</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">)
          </font><font color="#000080">subMenu</font><font color="#808080">(</font><font color="#FF0000">8</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">)        
     </font><font color="#000080"><b>elif </b>sacao</font><font color="#808080">==</font><font color="#800000">'opAlterar'</font><font color="#808080">:
        </font><font color="#000080">mostrarDados</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#800000">''</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">)
        </font><font color="#000080">subMenu</font><font color="#808080">(</font><font color="#FF0000">9</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">)
     </font><font color="#000080"><b>elif </b>sacao</font><font color="#808080">==</font><font color="#800000">'opExcluir'</font><font color="#808080">:
        </font><font color="#000080">subMenu</font><font color="#808080">(</font><font color="#FF0000">10</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">)     
  </font><font color="#000080"><b>elif </b>sreg</font><font color="#808080">==</font><font color="#800000">'opLivro'</font><font color="#808080">:
     </font><font color="#000080"><b>if </b>sacao</font><font color="#808080">==</font><font color="#800000">'opNovo'</font><font color="#808080">:
        </font><font color="#000080">tLivro</font><font color="#808080">[</font><font color="#800000">'isbn'</font><font color="#808080">] = </font><font color="#000080"><b>raw_input</b></font><font color="#808080">(</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">))        
        </font><font color="#000080"><b>if </b>validaISBN</font><font color="#808080">(</font><font color="#000080">tLivro</font><font color="#808080">[</font><font color="#800000">'isbn'</font><font color="#808080">]):
            </font><font color="#000080">slinha</font><font color="#808080">=</font><font color="#000080">pesqArq</font><font color="#808080">(</font><font color="#000080">tf</font><font color="#808080">[</font><font color="#800000">'Livro'</font><font color="#808080">], </font><font color="#000080">tLivro</font><font color="#808080">[</font><font color="#800000">'isbn'</font><font color="#808080">], </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">13</font><font color="#808080">, </font><font color="#000080">tamReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">))
            </font><font color="#000080"><b>if </b>slinha</font><font color="#808080">==</font><font color="#800000">''</font><font color="#808080">:
               </font><font color="#000080">pesqLinhaExcluida</font><font color="#808080">(</font><font color="#000080">tf</font><font color="#808080">[</font><font color="#800000">'Livro'</font><font color="#808080">], </font><font color="#000080">tamReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">))
               </font><font color="#000080">mostrarDados</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#800000">''</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">)
               </font><font color="#000080">subMenu</font><font color="#808080">(</font><font color="#FF0000">7</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">)
               </font><font color="#000080">frmCadLigados</font><font color="#808080">(</font><font color="#800000">'opLivroAss'</font><font color="#808080">, </font><font color="#800000">'opNovo'</font><font color="#808080">, </font><font color="#000080">tLivro</font><font color="#808080">[</font><font color="#800000">'isbn'</font><font color="#808080">])
               </font><font color="#000080">frmCadLigados</font><font color="#808080">(</font><font color="#800000">'opLivroAut'</font><font color="#808080">, </font><font color="#800000">'opNovo'</font><font color="#808080">, </font><font color="#000080">tLivro</font><font color="#808080">[</font><font color="#800000">'isbn'</font><font color="#808080">])
            </font><font color="#000080"><b>else</b></font><font color="#808080">: </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#000080">MSG_REGEXST</font><font color="#808080">)
        </font><font color="#000080"><b>else</b></font><font color="#808080">: </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#000080">MSG_ISBNINV</font><font color="#808080">)
     </font><font color="#000080"><b>elif </b>sacao</font><font color="#808080">==</font><font color="#800000">'opPesquisar'</font><font color="#808080">:
        </font><font color="#000080">slinha</font><font color="#808080">=</font><font color="#000080">validaEntrada</font><font color="#808080">(</font><font color="#000080">tf</font><font color="#808080">[</font><font color="#800000">'Livro'</font><font color="#808080">], </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#000080">tLivro</font><font color="#808080">[</font><font color="#800000">'isbn'</font><font color="#808080">], </font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#000080"><b>False</b></font><font color="#808080">,</font><font color="#800000">'opTexto'</font><font color="#808080">)
        </font><font color="#000080"><b>if </b>slinha</font><font color="#808080">!=</font><font color="#800000">''</font><font color="#808080">:
           </font><font color="#000080">mostrarDados</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#800000">''</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">)
           </font><font color="#000080">mostrarDados</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">)
           </font><font color="#000080">subMenu</font><font color="#808080">(</font><font color="#FF0000">8</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">)        
     </font><font color="#000080"><b>elif </b>sacao</font><font color="#808080">==</font><font color="#800000">'opAlterar'</font><font color="#808080">:
        </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">) + </font><font color="#000080">tLivro</font><font color="#808080">[</font><font color="#800000">'isbn'</font><font color="#808080">])
        </font><font color="#000080">mostrarDados</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#800000">''</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">)
        </font><font color="#000080">subMenu</font><font color="#808080">(</font><font color="#FF0000">9</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">)
        </font><font color="#000080">frmCadLigados</font><font color="#808080">(</font><font color="#800000">'opLivroAss'</font><font color="#808080">, </font><font color="#800000">'opExcluir'</font><font color="#808080">, </font><font color="#000080">tLivro</font><font color="#808080">[</font><font color="#800000">'isbn'</font><font color="#808080">])
        </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#800000">'Assuntos dos livros excluidos, inclua novos!'</font><font color="#808080">)
        </font><font color="#000080">frmCadLigados</font><font color="#808080">(</font><font color="#800000">'opLivroAss'</font><font color="#808080">, </font><font color="#800000">'opNovo'</font><font color="#808080">, </font><font color="#000080">tLivro</font><font color="#808080">[</font><font color="#800000">'isbn'</font><font color="#808080">])
        </font><font color="#000080">frmCadLigados</font><font color="#808080">(</font><font color="#800000">'opLivroAut'</font><font color="#808080">, </font><font color="#800000">'opExcluir'</font><font color="#808080">, </font><font color="#000080">tLivro</font><font color="#808080">[</font><font color="#800000">'isbn'</font><font color="#808080">])
        </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#800000">'Autores dos livros excluidos, inclua novos!'</font><font color="#808080">)
        </font><font color="#000080">frmCadLigados</font><font color="#808080">(</font><font color="#800000">'opLivroAut'</font><font color="#808080">, </font><font color="#800000">'opNovo'</font><font color="#808080">, </font><font color="#000080">tLivro</font><font color="#808080">[</font><font color="#800000">'isbn'</font><font color="#808080">])
     </font><font color="#000080"><b>elif </b>sacao</font><font color="#808080">==</font><font color="#800000">'opExcluir'</font><font color="#808080">:
        </font><font color="#000080">subMenu</font><font color="#808080">(</font><font color="#FF0000">10</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">)
        </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#800000">'Assuntos dos livros sendo excluidos!'</font><font color="#808080">)
        </font><font color="#000080">frmCadLigados</font><font color="#808080">(</font><font color="#800000">'opLivroAss'</font><font color="#808080">, </font><font color="#800000">'opExcluir'</font><font color="#808080">, </font><font color="#000080">tLivro</font><font color="#808080">[</font><font color="#800000">'isbn'</font><font color="#808080">])
        </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#800000">'Autores dos livros sendo excluidos!'</font><font color="#808080">)
        </font><font color="#000080">frmCadLigados</font><font color="#808080">(</font><font color="#800000">'opLivroAut'</font><font color="#808080">, </font><font color="#800000">'opExcluir'</font><font color="#808080">, </font><font color="#000080">tLivro</font><font color="#808080">[</font><font color="#800000">'isbn'</font><font color="#808080">])     
  </font><font color="#000080"><b>elif </b>sreg</font><font color="#808080">==</font><font color="#800000">'opCliente'</font><font color="#808080">:
     </font><font color="#000080"><b>if </b>sacao</font><font color="#808080">==</font><font color="#800000">'opNovo'</font><font color="#808080">:
        </font><font color="#000080">tCliente</font><font color="#808080">[</font><font color="#800000">'cpf'</font><font color="#808080">] = </font><font color="#000080"><b>raw_input</b></font><font color="#808080">(</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">))        
        </font><font color="#000080"><b>if </b>validaCPF</font><font color="#808080">(</font><font color="#000080">tCliente</font><font color="#808080">[</font><font color="#800000">'cpf'</font><font color="#808080">]):
            </font><font color="#000080">slinha</font><font color="#808080">=</font><font color="#000080">pesqArq</font><font color="#808080">(</font><font color="#000080">tf</font><font color="#808080">[</font><font color="#800000">'Cliente'</font><font color="#808080">], </font><font color="#000080">tCliente</font><font color="#808080">[</font><font color="#800000">'cpf'</font><font color="#808080">], </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">14</font><font color="#808080">, </font><font color="#000080">tamReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">))
            </font><font color="#000080"><b>if </b>slinha</font><font color="#808080">==</font><font color="#800000">''</font><font color="#808080">:
               </font><font color="#000080">pesqLinhaExcluida</font><font color="#808080">(</font><font color="#000080">tf</font><font color="#808080">[</font><font color="#800000">'Cliente'</font><font color="#808080">], </font><font color="#000080">tamReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">))
               </font><font color="#000080">mostrarDados</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#800000">''</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">)
               </font><font color="#000080">subMenu</font><font color="#808080">(</font><font color="#FF0000">7</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">)
            </font><font color="#000080"><b>else</b></font><font color="#808080">: </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#000080">MSG_REGEXST</font><font color="#808080">)
        </font><font color="#000080"><b>else</b></font><font color="#808080">: </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#000080">MSG_CPFINV</font><font color="#808080">)
     </font><font color="#000080"><b>elif </b>sacao</font><font color="#808080">==</font><font color="#800000">'opPesquisar'</font><font color="#808080">:
        </font><font color="#000080">slinha</font><font color="#808080">=</font><font color="#000080">validaEntrada</font><font color="#808080">(</font><font color="#000080">tf</font><font color="#808080">[</font><font color="#800000">'Cliente'</font><font color="#808080">], </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#000080">tCliente</font><font color="#808080">[</font><font color="#800000">'cpf'</font><font color="#808080">],</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#000080"><b>False</b></font><font color="#808080">,</font><font color="#800000">'opTexto'</font><font color="#808080">)
        </font><font color="#000080"><b>if </b>slinha</font><font color="#808080">!=</font><font color="#800000">''</font><font color="#808080">:
           </font><font color="#000080">mostrarDados</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#800000">''</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">)
           </font><font color="#000080">mostrarDados</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">)
           </font><font color="#000080">subMenu</font><font color="#808080">(</font><font color="#FF0000">8</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">)        
     </font><font color="#000080"><b>elif </b>sacao</font><font color="#808080">==</font><font color="#800000">'opAlterar'</font><font color="#808080">:
        </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">) + </font><font color="#000080">tCliente</font><font color="#808080">[</font><font color="#800000">'cpf'</font><font color="#808080">])
        </font><font color="#000080">mostrarDados</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#800000">''</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">)
        </font><font color="#000080">subMenu</font><font color="#808080">(</font><font color="#FF0000">9</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">)
     </font><font color="#000080"><b>elif </b>sacao</font><font color="#808080">==</font><font color="#800000">'opExcluir'</font><font color="#808080">:
        </font><font color="#000080">subMenu</font><font color="#808080">(</font><font color="#FF0000">10</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">)     
  </font><font color="#000080"><b>elif </b>sreg</font><font color="#808080">==</font><font color="#800000">'opVenda'</font><font color="#808080">:
     </font><font color="#000080"><b>if </b>sacao</font><font color="#808080">==</font><font color="#800000">'opNovo'</font><font color="#808080">:
        </font><font color="#000080">tVenda</font><font color="#808080">[</font><font color="#800000">'dthrvenda'</font><font color="#808080">]=</font><font color="#000080">retDataHora</font><font color="#808080">()
        </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">) + </font><font color="#000080">tVenda</font><font color="#808080">[</font><font color="#800000">'dthrvenda'</font><font color="#808080">])
        </font><font color="#000080">slinha</font><font color="#808080">=</font><font color="#000080">pesqArq</font><font color="#808080">(</font><font color="#000080">tf</font><font color="#808080">[</font><font color="#800000">'Venda'</font><font color="#808080">], </font><font color="#000080">tVenda</font><font color="#808080">[</font><font color="#800000">'dthrvenda'</font><font color="#808080">], </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">19</font><font color="#808080">, </font><font color="#000080">tamReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">))
        </font><font color="#000080"><b>if </b>slinha</font><font color="#808080">==</font><font color="#800000">''</font><font color="#808080">:
           </font><font color="#000080">slinha</font><font color="#808080">=</font><font color="#000080">validaEntrada</font><font color="#808080">(</font><font color="#000080">tf</font><font color="#808080">[</font><font color="#800000">'Cliente'</font><font color="#808080">],</font><font color="#800000">'opCliente'</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#000080">tVenda</font><font color="#808080">[</font><font color="#800000">'cpf'</font><font color="#808080">],</font><font color="#FF0000">3</font><font color="#808080">,
                   </font><font color="#000080"><b>False</b></font><font color="#808080">,</font><font color="#800000">'opTexto'</font><font color="#808080">)
           </font><font color="#000080"><b>if </b>slinha</font><font color="#808080">!=</font><font color="#800000">''</font><font color="#808080">:
              </font><font color="#000080">tVenda</font><font color="#808080">[</font><font color="#800000">'cpf'</font><font color="#808080">]=</font><font color="#000080">string</font><font color="#808080">.</font><font color="#000080">strip</font><font color="#808080">(</font><font color="#000080">copy</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#FF0000">14</font><font color="#808080">))
              </font><font color="#000080"><b>if </b>validaCPF</font><font color="#808080">(</font><font color="#000080">tVenda</font><font color="#808080">[</font><font color="#800000">'cpf'</font><font color="#808080">]):
                 </font><font color="#000080"><b>print </b></font><font color="#800000">' '</font><font color="#808080">+</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#800000">'opCliente'</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">), <i># Nome 
                 </i></font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#000080">copy</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#000080">g_nPosChave</font><font color="#808080">[</font><font color="#800000">'opCliente'</font><font color="#808080">][</font><font color="#FF0000">1</font><font color="#808080">], </font><font color="#000080">g_nTamChave</font><font color="#808080">[</font><font color="#800000">'opCliente'</font><font color="#808080">][</font><font color="#FF0000">1</font><font color="#808080">]))
                 </font><font color="#000080">frmCadLigados</font><font color="#808080">(</font><font color="#800000">'opVenda'</font><font color="#808080">, </font><font color="#800000">'opNovo'</font><font color="#808080">, </font><font color="#000080">tVenda</font><font color="#808080">[</font><font color="#800000">'cpf'</font><font color="#808080">])
              </font><font color="#000080"><b>else</b></font><font color="#808080">: </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#000080">MSG_CPFINV</font><font color="#808080">)           
        </font><font color="#000080"><b>else</b></font><font color="#808080">: </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#000080">MSG_REGEXST</font><font color="#808080">)
     </font><font color="#000080"><b>elif </b>sacao</font><font color="#808080">==</font><font color="#800000">'opPesquisar'</font><font color="#808080">:
        </font><font color="#000080">slinha</font><font color="#808080">=</font><font color="#000080">validaEntrada</font><font color="#808080">(</font><font color="#000080">tf</font><font color="#808080">[</font><font color="#800000">'Venda'</font><font color="#808080">], </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#000080">tVenda</font><font color="#808080">[</font><font color="#800000">'dthrvenda'</font><font color="#808080">],</font><font color="#FF0000">1</font><font color="#808080">,
                </font><font color="#000080"><b>False</b></font><font color="#808080">,</font><font color="#800000">'opDataHora'</font><font color="#808080">)
        </font><font color="#000080"><b>if </b>slinha</font><font color="#808080">!=</font><font color="#800000">''</font><font color="#808080">:
          </font><font color="#000080">mostrarDados</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#800000">''</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">)
          </font><font color="#000080">mostrarDados</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">)
          </font><font color="#000080">subMenu</font><font color="#808080">(</font><font color="#FF0000">8</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">)        

<i>#------------------------------------------------------------------------------
# Realiza as consultas de acordo com o tipo de arquivo.
# sreg - o tipo de arquivo
# sacao - a acao a ser realizada
#------------------------------------------------------------------------------
</i></font><font color="#000080"><b>def </b>frmConsultas</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#000080">sacao</font><font color="#808080">):
  </font><font color="#000080">slinha </font><font color="#808080">= </font><font color="#800000">''
  
  </font><font color="#000080"><b>if </b>sreg</font><font color="#808080">==</font><font color="#800000">'opAssunto'</font><font color="#808080">:
     </font><font color="#000080"><b>if </b>sacao</font><font color="#808080">==</font><font color="#800000">'opPesquisar'</font><font color="#808080">:
        </font><font color="#000080">slinha</font><font color="#808080">=</font><font color="#000080">validaEntrada</font><font color="#808080">(</font><font color="#000080">tf</font><font color="#808080">[</font><font color="#800000">'Assunto'</font><font color="#808080">],</font><font color="#000080">sreg</font><font color="#808080">,</font><font color="#FF0000">2</font><font color="#808080">,</font><font color="#000080">tAssunto</font><font color="#808080">[</font><font color="#800000">'assunto'</font><font color="#808080">],</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#000080"><b>True</b></font><font color="#808080">,</font><font color="#800000">'opTexto'</font><font color="#808080">)
     </font><font color="#000080"><b>elif </b>sacao</font><font color="#808080">==</font><font color="#800000">'opListarTodos'</font><font color="#808080">:
        </font><font color="#000080"><b>if </b>ListarTodos</font><font color="#808080">(</font><font color="#000080">tf</font><font color="#808080">[</font><font color="#800000">'Assunto'</font><font color="#808080">], </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#800000">''</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#000080">tamReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">),
          </font><font color="#000080">QTD_MAX_LINHA</font><font color="#808080">, </font><font color="#000080"><b>False</b></font><font color="#808080">) == </font><font color="#000080"><b>False</b></font><font color="#808080">:
          </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">))     
  </font><font color="#000080"><b>elif </b>sreg</font><font color="#808080">==</font><font color="#800000">'opAutor'</font><font color="#808080">:
     </font><font color="#000080"><b>if </b>sacao</font><font color="#808080">==</font><font color="#800000">'opPesquisar'</font><font color="#808080">:
        </font><font color="#000080">slinha</font><font color="#808080">=</font><font color="#000080">validaEntrada</font><font color="#808080">(</font><font color="#000080">tf</font><font color="#808080">[</font><font color="#800000">'Autor'</font><font color="#808080">],</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">, </font><font color="#000080">tAutor</font><font color="#808080">[</font><font color="#800000">'autor'</font><font color="#808080">], </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#000080"><b>True</b></font><font color="#808080">,</font><font color="#800000">'opTexto'</font><font color="#808080">)
     </font><font color="#000080"><b>elif </b>sacao</font><font color="#808080">==</font><font color="#800000">'opListarTodos'</font><font color="#808080">:
        </font><font color="#000080"><b>if </b>ListarTodos</font><font color="#808080">(</font><font color="#000080">tf</font><font color="#808080">[</font><font color="#800000">'Autor'</font><font color="#808080">], </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#800000">''</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#000080">tamReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">),
          </font><font color="#000080">QTD_MAX_LINHA</font><font color="#808080">, </font><font color="#000080"><b>False</b></font><font color="#808080">) == </font><font color="#000080"><b>False</b></font><font color="#808080">:
          </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">))     
  </font><font color="#000080"><b>elif </b>sreg</font><font color="#808080">==</font><font color="#800000">'opEditora'</font><font color="#808080">:
     </font><font color="#000080"><b>if </b>sacao</font><font color="#808080">==</font><font color="#800000">'opPesquisar'</font><font color="#808080">:
        </font><font color="#000080">slinha</font><font color="#808080">=</font><font color="#000080">validaEntrada</font><font color="#808080">(</font><font color="#000080">tf</font><font color="#808080">[</font><font color="#800000">'Editora'</font><font color="#808080">],</font><font color="#000080">sreg</font><font color="#808080">,</font><font color="#FF0000">2</font><font color="#808080">,</font><font color="#000080">tEditora</font><font color="#808080">[</font><font color="#800000">'editora'</font><font color="#808080">],</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#000080"><b>True</b></font><font color="#808080">,</font><font color="#800000">'opTexto'</font><font color="#808080">)
     </font><font color="#000080"><b>elif </b>sacao</font><font color="#808080">==</font><font color="#800000">'opListarTodos'</font><font color="#808080">:
        </font><font color="#000080"><b>if </b>ListarTodos</font><font color="#808080">(</font><font color="#000080">tf</font><font color="#808080">[</font><font color="#800000">'Editora'</font><font color="#808080">], </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#800000">''</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#000080">tamReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">),
          </font><font color="#000080">QTD_MAX_LINHA</font><font color="#808080">, </font><font color="#000080"><b>False</b></font><font color="#808080">) == </font><font color="#000080"><b>False</b></font><font color="#808080">:
          </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">))     
  </font><font color="#000080"><b>elif </b>sreg</font><font color="#808080">==</font><font color="#800000">'opEndereco'</font><font color="#808080">:
     </font><font color="#000080"><b>if </b>sacao</font><font color="#808080">==</font><font color="#800000">'opPesquisar'</font><font color="#808080">:
        </font><font color="#000080">slinha</font><font color="#808080">=</font><font color="#000080">validaEntrada</font><font color="#808080">(</font><font color="#000080">tf</font><font color="#808080">[</font><font color="#800000">'Endereco'</font><font color="#808080">],</font><font color="#000080">sreg</font><font color="#808080">,</font><font color="#FF0000">2</font><font color="#808080">,</font><font color="#000080">tEndereco</font><font color="#808080">[</font><font color="#800000">'Logradouro'</font><font color="#808080">],</font><font color="#FF0000">1</font><font color="#808080">,
                </font><font color="#000080"><b>True</b></font><font color="#808080">,</font><font color="#800000">'opTexto'</font><font color="#808080">)
     </font><font color="#000080"><b>elif </b>sacao</font><font color="#808080">==</font><font color="#800000">'opListarTodos'</font><font color="#808080">:
        </font><font color="#000080"><b>if </b>ListarTodos</font><font color="#808080">(</font><font color="#000080">tf</font><font color="#808080">[</font><font color="#800000">'Endereco'</font><font color="#808080">], </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#800000">''</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#000080">tamReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">),
           </font><font color="#FF0000">3</font><font color="#808080">, </font><font color="#000080"><b>False</b></font><font color="#808080">) == </font><font color="#000080"><b>False</b></font><font color="#808080">:
          </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">))     
  </font><font color="#000080"><b>elif </b>sreg</font><font color="#808080">==</font><font color="#800000">'opIdioma'</font><font color="#808080">:
     </font><font color="#000080"><b>if </b>sacao</font><font color="#808080">==</font><font color="#800000">'opPesquisar'</font><font color="#808080">:
        </font><font color="#000080">slinha</font><font color="#808080">=</font><font color="#000080">validaEntrada</font><font color="#808080">(</font><font color="#000080">tf</font><font color="#808080">[</font><font color="#800000">'Idioma'</font><font color="#808080">], </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">, </font><font color="#000080">tIdioma</font><font color="#808080">[</font><font color="#800000">'idioma'</font><font color="#808080">],</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#000080"><b>True</b></font><font color="#808080">,</font><font color="#800000">'opTexto'</font><font color="#808080">)
     </font><font color="#000080"><b>elif </b>sacao</font><font color="#808080">==</font><font color="#800000">'opListarTodos'</font><font color="#808080">:
        </font><font color="#000080"><b>if </b>ListarTodos</font><font color="#808080">(</font><font color="#000080">tf</font><font color="#808080">[</font><font color="#800000">'Idioma'</font><font color="#808080">], </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#800000">''</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#000080">tamReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">),
          </font><font color="#000080">QTD_MAX_LINHA</font><font color="#808080">, </font><font color="#000080"><b>False</b></font><font color="#808080">) == </font><font color="#000080"><b>False</b></font><font color="#808080">:
          </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">))     
  </font><font color="#000080"><b>elif </b>sreg</font><font color="#808080">==</font><font color="#800000">'opPais'</font><font color="#808080">:
     </font><font color="#000080"><b>if </b>sacao</font><font color="#808080">==</font><font color="#800000">'opPesquisar'</font><font color="#808080">:
        </font><font color="#000080">slinha</font><font color="#808080">=</font><font color="#000080">validaEntrada</font><font color="#808080">(</font><font color="#000080">tf</font><font color="#808080">[</font><font color="#800000">'Pais'</font><font color="#808080">], </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">, </font><font color="#000080">tPais</font><font color="#808080">[</font><font color="#800000">'pais'</font><font color="#808080">], </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#000080"><b>True</b></font><font color="#808080">,</font><font color="#800000">'opTexto'</font><font color="#808080">)
     </font><font color="#000080"><b>elif </b>sacao</font><font color="#808080">==</font><font color="#800000">'opListarTodos'</font><font color="#808080">:
        </font><font color="#000080"><b>if </b>ListarTodos</font><font color="#808080">(</font><font color="#000080">tf</font><font color="#808080">[</font><font color="#800000">'Pais'</font><font color="#808080">], </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#800000">''</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#000080">tamReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">),
          </font><font color="#000080">QTD_MAX_LINHA</font><font color="#808080">, </font><font color="#000080"><b>False</b></font><font color="#808080">) == </font><font color="#000080"><b>False</b></font><font color="#808080">:
          </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">))     
  </font><font color="#000080"><b>elif </b>sreg</font><font color="#808080">==</font><font color="#800000">'opProfissao'</font><font color="#808080">:
     </font><font color="#000080"><b>if </b>sacao</font><font color="#808080">==</font><font color="#800000">'opPesquisar'</font><font color="#808080">:
       </font><font color="#000080">slinha</font><font color="#808080">=</font><font color="#000080">validaEntrada</font><font color="#808080">(</font><font color="#000080">tf</font><font color="#808080">[</font><font color="#800000">'Profissao'</font><font color="#808080">],</font><font color="#000080">sreg</font><font color="#808080">,</font><font color="#FF0000">2</font><font color="#808080">,</font><font color="#000080">tProfissao</font><font color="#808080">[</font><font color="#800000">'profissao'</font><font color="#808080">],</font><font color="#FF0000">1</font><font color="#808080">,
               </font><font color="#000080"><b>True</b></font><font color="#808080">,</font><font color="#800000">'opTexto'</font><font color="#808080">)
     </font><font color="#000080"><b>elif </b>sacao</font><font color="#808080">==</font><font color="#800000">'opListarTodos'</font><font color="#808080">:
        </font><font color="#000080"><b>if </b>ListarTodos</font><font color="#808080">(</font><font color="#000080">tf</font><font color="#808080">[</font><font color="#800000">'Profissao'</font><font color="#808080">], </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#800000">''</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#000080">tamReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">),
          </font><font color="#000080">QTD_MAX_LINHA</font><font color="#808080">, </font><font color="#000080"><b>False</b></font><font color="#808080">) == </font><font color="#000080"><b>False</b></font><font color="#808080">:
          </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">))     
  </font><font color="#000080"><b>elif </b>sreg</font><font color="#808080">==</font><font color="#800000">'opLivro'</font><font color="#808080">:
     </font><font color="#000080"><b>if </b>sacao</font><font color="#808080">==</font><font color="#800000">'opPesquisar'</font><font color="#808080">:
        </font><font color="#000080">slinha</font><font color="#808080">=</font><font color="#000080">validaEntrada</font><font color="#808080">(</font><font color="#000080">tf</font><font color="#808080">[</font><font color="#800000">'Livro'</font><font color="#808080">], </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">, </font><font color="#000080">tLivro</font><font color="#808080">[</font><font color="#800000">'titulo'</font><font color="#808080">], </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#000080"><b>True</b></font><font color="#808080">,</font><font color="#800000">'opTexto'</font><font color="#808080">)
     </font><font color="#000080"><b>elif </b>sacao</font><font color="#808080">==</font><font color="#800000">'opListarTodos'</font><font color="#808080">:
        </font><font color="#000080"><b>if </b>ListarTodos</font><font color="#808080">(</font><font color="#000080">tf</font><font color="#808080">[</font><font color="#800000">'Livro'</font><font color="#808080">], </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#800000">''</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#000080">tamReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">),
          </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#000080"><b>False</b></font><font color="#808080">) == </font><font color="#000080"><b>False</b></font><font color="#808080">:
          </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">))     
  </font><font color="#000080"><b>elif </b>sreg</font><font color="#808080">==</font><font color="#800000">'opCliente'</font><font color="#808080">:
     </font><font color="#000080"><b>if </b>sacao</font><font color="#808080">==</font><font color="#800000">'opPesquisar'</font><font color="#808080">:
        </font><font color="#000080">slinha</font><font color="#808080">=</font><font color="#000080">validaEntrada</font><font color="#808080">(</font><font color="#000080">tf</font><font color="#808080">[</font><font color="#800000">'Cliente'</font><font color="#808080">], </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">, </font><font color="#000080">tCliente</font><font color="#808080">[</font><font color="#800000">'nome'</font><font color="#808080">],</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#000080"><b>True</b></font><font color="#808080">,</font><font color="#800000">'opTexto'</font><font color="#808080">)
     </font><font color="#000080"><b>elif </b>sacao</font><font color="#808080">==</font><font color="#800000">'opListarTodos'</font><font color="#808080">:
        </font><font color="#000080"><b>if </b>ListarTodos</font><font color="#808080">(</font><font color="#000080">tf</font><font color="#808080">[</font><font color="#800000">'Cliente'</font><font color="#808080">], </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#800000">''</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#000080">tamReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">),
          </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#000080"><b>False</b></font><font color="#808080">) == </font><font color="#000080"><b>False</b></font><font color="#808080">:
          </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">))     
  </font><font color="#000080"><b>elif </b>sreg</font><font color="#808080">==</font><font color="#800000">'opVenda'</font><font color="#808080">:
     </font><font color="#000080"><b>if </b>sacao</font><font color="#808080">==</font><font color="#800000">'opPesquisar'</font><font color="#808080">:
        </font><font color="#000080">slinha</font><font color="#808080">=</font><font color="#000080">validaEntrada</font><font color="#808080">(</font><font color="#000080">tf</font><font color="#808080">[</font><font color="#800000">'Venda'</font><font color="#808080">], </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">, </font><font color="#000080">tVenda</font><font color="#808080">[</font><font color="#800000">'cpf'</font><font color="#808080">], </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#000080"><b>True</b></font><font color="#808080">,</font><font color="#800000">'opTexto'</font><font color="#808080">)
     </font><font color="#000080"><b>elif </b>sacao</font><font color="#808080">==</font><font color="#800000">'opListarTodos'</font><font color="#808080">:
        </font><font color="#000080"><b>if </b>ListarTodos</font><font color="#808080">(</font><font color="#000080">tf</font><font color="#808080">[</font><font color="#800000">'Venda'</font><font color="#808080">], </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#800000">''</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#000080">tamReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">),
          </font><font color="#000080">QTD_MAX_LINHA</font><font color="#808080">, </font><font color="#000080"><b>False</b></font><font color="#808080">) == </font><font color="#000080"><b>False</b></font><font color="#808080">:
          </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">))     
  
  </font><font color="#000080"><b>if </b>slinha</font><font color="#808080">==</font><font color="#800000">''</font><font color="#808080">:
     </font><font color="#000080"><b>print </b></font><font color="#800000">''</font><font color="#808080">,

<i>#------------------------------------------------------------------------------
# Mostra a tela de alteracao de senha do sistema e realiza a alteracao.
#------------------------------------------------------------------------------
</i></font><font color="#000080"><b>def </b>frmAlterarSenha</font><font color="#808080">():
  </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#800000">'opUsuario'</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">) + </font><font color="#000080">tUsuario</font><font color="#808080">[</font><font color="#800000">'login'</font><font color="#808080">])
  </font><font color="#000080">nopcao</font><font color="#808080">=</font><font color="#FF0000">1
  </font><font color="#000080">bQuebra</font><font color="#808080">=</font><font color="#000080"><b>False
  while </b></font><font color="#808080">(</font><font color="#000080">bQuebra</font><font color="#808080">==</font><font color="#000080"><b>False</b></font><font color="#808080">):
    </font><font color="#000080"><b>if </b>nopcao</font><font color="#808080">==</font><font color="#FF0000">1</font><font color="#808080">:
         </font><font color="#000080">sSenhaAtual </font><font color="#808080">= </font><font color="#000080">digitaSenha</font><font color="#808080">(</font><font color="#800000">'Senha Atual: '</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">)
         </font><font color="#000080"><b>if </b>sSenhaAtual</font><font color="#808080">!=</font><font color="#000080">tUsuario</font><font color="#808080">[</font><font color="#800000">'senha'</font><font color="#808080">]:
            </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#000080">MSG_SENCONFERE</font><font color="#808080">)
            </font><font color="#000080">bQuebra</font><font color="#808080">=</font><font color="#000080"><b>True
         else</b></font><font color="#808080">: </font><font color="#000080">nopcao</font><font color="#808080">=</font><font color="#FF0000">2        
    </font><font color="#000080"><b>elif </b>nopcao</font><font color="#808080">==</font><font color="#FF0000">2</font><font color="#808080">:
         </font><font color="#000080">sNovaSenha </font><font color="#808080">= </font><font color="#000080">digitaSenha</font><font color="#808080">(</font><font color="#800000">'Nova Senha: '</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">)
         </font><font color="#000080">sConfirmaSenha </font><font color="#808080">= </font><font color="#000080">digitaSenha</font><font color="#808080">(</font><font color="#800000">'Confirma Senha: '</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">)
         </font><font color="#000080"><b>if </b>sNovaSenha</font><font color="#808080">!=</font><font color="#000080">sConfirmaSenha</font><font color="#808080">:
            </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#000080">MSG_SENCONFIRM</font><font color="#808080">)
            </font><font color="#000080">bQuebra</font><font color="#808080">=</font><font color="#000080"><b>True
         else</b></font><font color="#808080">: </font><font color="#000080">nopcao</font><font color="#808080">=</font><font color="#FF0000">3        
    </font><font color="#000080"><b>elif </b>nopcao</font><font color="#808080">==</font><font color="#FF0000">3</font><font color="#808080">:
         </font><font color="#000080">sres</font><font color="#808080">=</font><font color="#000080">pesqArq</font><font color="#808080">(</font><font color="#000080">tf</font><font color="#808080">[</font><font color="#800000">'Usuario'</font><font color="#808080">], </font><font color="#000080">tUsuario</font><font color="#808080">[</font><font color="#800000">'login'</font><font color="#808080">], </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">, </font><font color="#000080">tamReg</font><font color="#808080">(</font><font color="#800000">'opUsuario'</font><font color="#808080">))
         </font><font color="#000080"><b>if </b>sres</font><font color="#808080">==</font><font color="#800000">''</font><font color="#808080">:
           </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#000080">MSG_LOGINENCON</font><font color="#808080">)
         </font><font color="#000080"><b>else</b></font><font color="#808080">: 
           </font><font color="#000080">tUsuario</font><font color="#808080">[</font><font color="#800000">'senha'</font><font color="#808080">]=</font><font color="#000080">sConfirmaSenha
           subMenu</font><font color="#808080">(</font><font color="#FF0000">9</font><font color="#808080">,</font><font color="#800000">'opUsuario'</font><font color="#808080">)
           </font><font color="#000080">bQuebra</font><font color="#808080">=</font><font color="#000080"><b>True

</b></font><font color="#808080"><i>#------------------------------------------------------------------------------
# Executa uma acao de gravacao de acordo com o tipo de arquivo.
# sreg - o tipo de arquivo
# sacao - a acao a ser realizada
# ------------------------------------------------------------------------------
</i></font><font color="#000080"><b>def </b>btnAcao</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#000080">sacao</font><font color="#808080">):
  </font><font color="#000080"><b>if </b>sreg</font><font color="#808080">==</font><font color="#800000">'opAssunto'</font><font color="#808080">:
     </font><font color="#000080"><b>if </b>sacao</font><font color="#808080">==</font><font color="#800000">'opSalvarInclusao'</font><font color="#808080">:
        </font><font color="#000080">escreveArq</font><font color="#808080">(</font><font color="#000080">tf</font><font color="#808080">[</font><font color="#800000">'Assunto'</font><font color="#808080">], </font><font color="#000080">LinhaReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">), </font><font color="#000080">MSG_REGINC</font><font color="#808080">, </font><font color="#000080">MSG_REGNINC</font><font color="#808080">)
     </font><font color="#000080"><b>elif </b>sacao</font><font color="#808080">==</font><font color="#800000">'opSalvarAlteracao'</font><font color="#808080">:
        </font><font color="#000080">escreveArq</font><font color="#808080">(</font><font color="#000080">tf</font><font color="#808080">[</font><font color="#800000">'Assunto'</font><font color="#808080">], </font><font color="#000080">LinhaReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">), </font><font color="#000080">MSG_REGALT</font><font color="#808080">, </font><font color="#000080">MSG_REGNALT</font><font color="#808080">)
     </font><font color="#000080"><b>elif </b>sacao</font><font color="#808080">==</font><font color="#800000">'opConfirmaExclusao'</font><font color="#808080">:
        </font><font color="#000080">escreveArq</font><font color="#808080">(</font><font color="#000080">tf</font><font color="#808080">[</font><font color="#800000">'Assunto'</font><font color="#808080">], </font><font color="#000080">repete</font><font color="#808080">(</font><font color="#800000">'*'</font><font color="#808080">,</font><font color="#000080">tamReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">)), </font><font color="#000080">MSG_REGEXC</font><font color="#808080">, </font><font color="#000080">MSG_REGNEXC</font><font color="#808080">)
  </font><font color="#000080"><b>elif </b>sreg</font><font color="#808080">==</font><font color="#800000">'opAutor'</font><font color="#808080">:
     </font><font color="#000080"><b>if </b>sacao</font><font color="#808080">==</font><font color="#800000">'opSalvarInclusao'</font><font color="#808080">:
        </font><font color="#000080">escreveArq</font><font color="#808080">(</font><font color="#000080">tf</font><font color="#808080">[</font><font color="#800000">'Autor'</font><font color="#808080">], </font><font color="#000080">LinhaReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">), </font><font color="#000080">MSG_REGINC</font><font color="#808080">, </font><font color="#000080">MSG_REGNINC</font><font color="#808080">)
     </font><font color="#000080"><b>elif </b>sacao</font><font color="#808080">==</font><font color="#800000">'opSalvarAlteracao'</font><font color="#808080">:
        </font><font color="#000080">escreveArq</font><font color="#808080">(</font><font color="#000080">tf</font><font color="#808080">[</font><font color="#800000">'Autor'</font><font color="#808080">], </font><font color="#000080">LinhaReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">), </font><font color="#000080">MSG_REGALT</font><font color="#808080">, </font><font color="#000080">MSG_REGNALT</font><font color="#808080">)
     </font><font color="#000080"><b>elif </b>sacao</font><font color="#808080">==</font><font color="#800000">'opConfirmaExclusao'</font><font color="#808080">:
        </font><font color="#000080">escreveArq</font><font color="#808080">(</font><font color="#000080">tf</font><font color="#808080">[</font><font color="#800000">'Autor'</font><font color="#808080">], </font><font color="#000080">repete</font><font color="#808080">(</font><font color="#800000">'*'</font><font color="#808080">,</font><font color="#000080">tamReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">)), </font><font color="#000080">MSG_REGEXC</font><font color="#808080">, </font><font color="#000080">MSG_REGNEXC</font><font color="#808080">)
  </font><font color="#000080"><b>elif </b>sreg</font><font color="#808080">==</font><font color="#800000">'opEditora'</font><font color="#808080">:
     </font><font color="#000080"><b>if </b>sacao</font><font color="#808080">==</font><font color="#800000">'opSalvarInclusao'</font><font color="#808080">:
        </font><font color="#000080">escreveArq</font><font color="#808080">(</font><font color="#000080">tf</font><font color="#808080">[</font><font color="#800000">'Editora'</font><font color="#808080">], </font><font color="#000080">LinhaReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">), </font><font color="#000080">MSG_REGINC</font><font color="#808080">, </font><font color="#000080">MSG_REGNINC</font><font color="#808080">)
     </font><font color="#000080"><b>elif </b>sacao</font><font color="#808080">==</font><font color="#800000">'opSalvarAlteracao'</font><font color="#808080">:
        </font><font color="#000080">escreveArq</font><font color="#808080">(</font><font color="#000080">tf</font><font color="#808080">[</font><font color="#800000">'Editora'</font><font color="#808080">], </font><font color="#000080">LinhaReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">), </font><font color="#000080">MSG_REGALT</font><font color="#808080">, </font><font color="#000080">MSG_REGNALT</font><font color="#808080">)
     </font><font color="#000080"><b>elif </b>sacao</font><font color="#808080">==</font><font color="#800000">'opConfirmaExclusao'</font><font color="#808080">:
        </font><font color="#000080">escreveArq</font><font color="#808080">(</font><font color="#000080">tf</font><font color="#808080">[</font><font color="#800000">'Editora'</font><font color="#808080">], </font><font color="#000080">repete</font><font color="#808080">(</font><font color="#800000">'*'</font><font color="#808080">,</font><font color="#000080">tamReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">)), </font><font color="#000080">MSG_REGEXC</font><font color="#808080">, </font><font color="#000080">MSG_REGNEXC</font><font color="#808080">)
  </font><font color="#000080"><b>elif </b>sreg</font><font color="#808080">==</font><font color="#800000">'opEndereco'</font><font color="#808080">:
     </font><font color="#000080"><b>if </b>sacao</font><font color="#808080">==</font><font color="#800000">'opSalvarInclusao'</font><font color="#808080">:
        </font><font color="#000080">escreveArq</font><font color="#808080">(</font><font color="#000080">tf</font><font color="#808080">[</font><font color="#800000">'Endereco'</font><font color="#808080">], </font><font color="#000080">LinhaReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">), </font><font color="#000080">MSG_REGINC</font><font color="#808080">, </font><font color="#000080">MSG_REGNINC</font><font color="#808080">)
     </font><font color="#000080"><b>elif </b>sacao</font><font color="#808080">==</font><font color="#800000">'opSalvarAlteracao'</font><font color="#808080">:
        </font><font color="#000080">escreveArq</font><font color="#808080">(</font><font color="#000080">tf</font><font color="#808080">[</font><font color="#800000">'Endereco'</font><font color="#808080">], </font><font color="#000080">LinhaReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">), </font><font color="#000080">MSG_REGALT</font><font color="#808080">, </font><font color="#000080">MSG_REGNALT</font><font color="#808080">)
     </font><font color="#000080"><b>elif </b>sacao</font><font color="#808080">==</font><font color="#800000">'opConfirmaExclusao'</font><font color="#808080">:
        </font><font color="#000080">escreveArq</font><font color="#808080">(</font><font color="#000080">tf</font><font color="#808080">[</font><font color="#800000">'Endereco'</font><font color="#808080">], </font><font color="#000080">repete</font><font color="#808080">(</font><font color="#800000">'*'</font><font color="#808080">,</font><font color="#000080">tamReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">)), </font><font color="#000080">MSG_REGEXC</font><font color="#808080">, </font><font color="#000080">MSG_REGNEXC</font><font color="#808080">)
  </font><font color="#000080"><b>elif </b>sreg</font><font color="#808080">==</font><font color="#800000">'opIdioma'</font><font color="#808080">:
     </font><font color="#000080"><b>if </b>sacao</font><font color="#808080">==</font><font color="#800000">'opSalvarInclusao'</font><font color="#808080">:
        </font><font color="#000080">escreveArq</font><font color="#808080">(</font><font color="#000080">tf</font><font color="#808080">[</font><font color="#800000">'Idioma'</font><font color="#808080">], </font><font color="#000080">LinhaReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">), </font><font color="#000080">MSG_REGINC</font><font color="#808080">, </font><font color="#000080">MSG_REGNINC</font><font color="#808080">)
     </font><font color="#000080"><b>elif </b>sacao</font><font color="#808080">==</font><font color="#800000">'opSalvarAlteracao'</font><font color="#808080">:
        </font><font color="#000080">escreveArq</font><font color="#808080">(</font><font color="#000080">tf</font><font color="#808080">[</font><font color="#800000">'Idioma'</font><font color="#808080">], </font><font color="#000080">LinhaReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">), </font><font color="#000080">MSG_REGALT</font><font color="#808080">, </font><font color="#000080">MSG_REGNALT</font><font color="#808080">)
     </font><font color="#000080"><b>elif </b>sacao</font><font color="#808080">==</font><font color="#800000">'opConfirmaExclusao'</font><font color="#808080">:
        </font><font color="#000080">escreveArq</font><font color="#808080">(</font><font color="#000080">tf</font><font color="#808080">[</font><font color="#800000">'Idioma'</font><font color="#808080">], </font><font color="#000080">repete</font><font color="#808080">(</font><font color="#800000">'*'</font><font color="#808080">,</font><font color="#000080">tamReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">)), </font><font color="#000080">MSG_REGEXC</font><font color="#808080">, </font><font color="#000080">MSG_REGNEXC</font><font color="#808080">)
  </font><font color="#000080"><b>elif </b>sreg</font><font color="#808080">==</font><font color="#800000">'opPais'</font><font color="#808080">:
     </font><font color="#000080"><b>if </b>sacao</font><font color="#808080">==</font><font color="#800000">'opSalvarInclusao'</font><font color="#808080">:
        </font><font color="#000080">escreveArq</font><font color="#808080">(</font><font color="#000080">tf</font><font color="#808080">[</font><font color="#800000">'Pais'</font><font color="#808080">], </font><font color="#000080">LinhaReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">), </font><font color="#000080">MSG_REGINC</font><font color="#808080">, </font><font color="#000080">MSG_REGNINC</font><font color="#808080">)
     </font><font color="#000080"><b>elif </b>sacao</font><font color="#808080">==</font><font color="#800000">'opSalvarAlteracao'</font><font color="#808080">:
        </font><font color="#000080">escreveArq</font><font color="#808080">(</font><font color="#000080">tf</font><font color="#808080">[</font><font color="#800000">'Pais'</font><font color="#808080">], </font><font color="#000080">LinhaReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">), </font><font color="#000080">MSG_REGALT</font><font color="#808080">, </font><font color="#000080">MSG_REGNALT</font><font color="#808080">)
     </font><font color="#000080"><b>elif </b>sacao</font><font color="#808080">==</font><font color="#800000">'opConfirmaExclusao'</font><font color="#808080">:
        </font><font color="#000080">escreveArq</font><font color="#808080">(</font><font color="#000080">tf</font><font color="#808080">[</font><font color="#800000">'Pais'</font><font color="#808080">], </font><font color="#000080">repete</font><font color="#808080">(</font><font color="#800000">'*'</font><font color="#808080">,</font><font color="#000080">tamReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">)), </font><font color="#000080">MSG_REGEXC</font><font color="#808080">, </font><font color="#000080">MSG_REGNEXC</font><font color="#808080">)
  </font><font color="#000080"><b>elif </b>sreg</font><font color="#808080">==</font><font color="#800000">'opProfissao'</font><font color="#808080">:
     </font><font color="#000080"><b>if </b>sacao</font><font color="#808080">==</font><font color="#800000">'opSalvarInclusao'</font><font color="#808080">:
        </font><font color="#000080">escreveArq</font><font color="#808080">(</font><font color="#000080">tf</font><font color="#808080">[</font><font color="#800000">'Profissao'</font><font color="#808080">], </font><font color="#000080">LinhaReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">), </font><font color="#000080">MSG_REGINC</font><font color="#808080">, </font><font color="#000080">MSG_REGNINC</font><font color="#808080">)
     </font><font color="#000080"><b>elif </b>sacao</font><font color="#808080">==</font><font color="#800000">'opSalvarAlteracao'</font><font color="#808080">:
        </font><font color="#000080">escreveArq</font><font color="#808080">(</font><font color="#000080">tf</font><font color="#808080">[</font><font color="#800000">'Profissao'</font><font color="#808080">], </font><font color="#000080">LinhaReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">), </font><font color="#000080">MSG_REGALT</font><font color="#808080">, </font><font color="#000080">MSG_REGNALT</font><font color="#808080">)
     </font><font color="#000080"><b>elif </b>sacao</font><font color="#808080">==</font><font color="#800000">'opConfirmaExclusao'</font><font color="#808080">:
        </font><font color="#000080">escreveArq</font><font color="#808080">(</font><font color="#000080">tf</font><font color="#808080">[</font><font color="#800000">'Profissao'</font><font color="#808080">], </font><font color="#000080">repete</font><font color="#808080">(</font><font color="#800000">'*'</font><font color="#808080">,</font><font color="#000080">tamReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">)), </font><font color="#000080">MSG_REGEXC</font><font color="#808080">, </font><font color="#000080">MSG_REGNEXC</font><font color="#808080">)
  </font><font color="#000080"><b>elif </b>sreg</font><font color="#808080">==</font><font color="#800000">'opLivro'</font><font color="#808080">:
     </font><font color="#000080"><b>if </b>sacao</font><font color="#808080">==</font><font color="#800000">'opSalvarInclusao'</font><font color="#808080">:
        </font><font color="#000080">escreveArq</font><font color="#808080">(</font><font color="#000080">tf</font><font color="#808080">[</font><font color="#800000">'Livro'</font><font color="#808080">], </font><font color="#000080">LinhaReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">), </font><font color="#000080">MSG_REGINC</font><font color="#808080">, </font><font color="#000080">MSG_REGNINC</font><font color="#808080">)
     </font><font color="#000080"><b>elif </b>sacao</font><font color="#808080">==</font><font color="#800000">'opSalvarAlteracao'</font><font color="#808080">:
        </font><font color="#000080">escreveArq</font><font color="#808080">(</font><font color="#000080">tf</font><font color="#808080">[</font><font color="#800000">'Livro'</font><font color="#808080">], </font><font color="#000080">LinhaReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">), </font><font color="#000080">MSG_REGALT</font><font color="#808080">, </font><font color="#000080">MSG_REGNALT</font><font color="#808080">)
     </font><font color="#000080"><b>elif </b>sacao</font><font color="#808080">==</font><font color="#800000">'opConfirmaExclusao'</font><font color="#808080">:
        </font><font color="#000080">escreveArq</font><font color="#808080">(</font><font color="#000080">tf</font><font color="#808080">[</font><font color="#800000">'Livro'</font><font color="#808080">], </font><font color="#000080">repete</font><font color="#808080">(</font><font color="#800000">'*'</font><font color="#808080">,</font><font color="#000080">tamReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">)), </font><font color="#000080">MSG_REGEXC</font><font color="#808080">, </font><font color="#000080">MSG_REGNEXC</font><font color="#808080">)
  </font><font color="#000080"><b>elif </b>sreg</font><font color="#808080">==</font><font color="#800000">'opLivroAss'</font><font color="#808080">:
     </font><font color="#000080"><b>if </b>sacao</font><font color="#808080">==</font><font color="#800000">'opSalvarInclusao'</font><font color="#808080">:
        </font><font color="#000080">escreveArq</font><font color="#808080">(</font><font color="#000080">tf</font><font color="#808080">[</font><font color="#800000">'LivroAss'</font><font color="#808080">], </font><font color="#000080">LinhaReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">), </font><font color="#000080">MSG_REGINC</font><font color="#808080">, </font><font color="#000080">MSG_REGNINC</font><font color="#808080">)
     </font><font color="#000080"><b>elif </b>sacao</font><font color="#808080">==</font><font color="#800000">'opSalvarAlteracao'</font><font color="#808080">:
        </font><font color="#000080">escreveArq</font><font color="#808080">(</font><font color="#000080">tf</font><font color="#808080">[</font><font color="#800000">'LivroAss'</font><font color="#808080">], </font><font color="#000080">LinhaReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">), </font><font color="#000080">MSG_REGALT</font><font color="#808080">, </font><font color="#000080">MSG_REGNALT</font><font color="#808080">)
     </font><font color="#000080"><b>elif </b>sacao</font><font color="#808080">==</font><font color="#800000">'opConfirmaExclusao'</font><font color="#808080">:
        </font><font color="#000080">escreveArq</font><font color="#808080">(</font><font color="#000080">tf</font><font color="#808080">[</font><font color="#800000">'LivroAss'</font><font color="#808080">], </font><font color="#000080">repete</font><font color="#808080">(</font><font color="#800000">'*'</font><font color="#808080">,</font><font color="#000080">tamReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">)), </font><font color="#000080">MSG_REGEXC</font><font color="#808080">, </font><font color="#000080">MSG_REGNEXC</font><font color="#808080">)
  </font><font color="#000080"><b>elif </b>sreg</font><font color="#808080">==</font><font color="#800000">'opLivroAut'</font><font color="#808080">:
     </font><font color="#000080"><b>if </b>sacao</font><font color="#808080">==</font><font color="#800000">'opSalvarInclusao'</font><font color="#808080">:
        </font><font color="#000080">escreveArq</font><font color="#808080">(</font><font color="#000080">tf</font><font color="#808080">[</font><font color="#800000">'LivroAut'</font><font color="#808080">], </font><font color="#000080">LinhaReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">), </font><font color="#000080">MSG_REGINC</font><font color="#808080">, </font><font color="#000080">MSG_REGNINC</font><font color="#808080">)
     </font><font color="#000080"><b>elif </b>sacao</font><font color="#808080">==</font><font color="#800000">'opSalvarAlteracao'</font><font color="#808080">:
        </font><font color="#000080">escreveArq</font><font color="#808080">(</font><font color="#000080">tf</font><font color="#808080">[</font><font color="#800000">'LivroAut'</font><font color="#808080">], </font><font color="#000080">LinhaReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">), </font><font color="#000080">MSG_REGALT</font><font color="#808080">, </font><font color="#000080">MSG_REGNALT</font><font color="#808080">)
     </font><font color="#000080"><b>elif </b>sacao</font><font color="#808080">==</font><font color="#800000">'opConfirmaExclusao'</font><font color="#808080">:
        </font><font color="#000080">escreveArq</font><font color="#808080">(</font><font color="#000080">tf</font><font color="#808080">[</font><font color="#800000">'LivroAut'</font><font color="#808080">], </font><font color="#000080">repete</font><font color="#808080">(</font><font color="#800000">'*'</font><font color="#808080">,</font><font color="#000080">tamReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">)), </font><font color="#000080">MSG_REGEXC</font><font color="#808080">, </font><font color="#000080">MSG_REGNEXC</font><font color="#808080">)
  </font><font color="#000080"><b>elif </b>sreg</font><font color="#808080">==</font><font color="#800000">'opCliente'</font><font color="#808080">:
     </font><font color="#000080"><b>if </b>sacao</font><font color="#808080">==</font><font color="#800000">'opSalvarInclusao'</font><font color="#808080">:
        </font><font color="#000080">escreveArq</font><font color="#808080">(</font><font color="#000080">tf</font><font color="#808080">[</font><font color="#800000">'Cliente'</font><font color="#808080">], </font><font color="#000080">LinhaReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">), </font><font color="#000080">MSG_REGINC</font><font color="#808080">, </font><font color="#000080">MSG_REGNINC</font><font color="#808080">)
     </font><font color="#000080"><b>elif </b>sacao</font><font color="#808080">==</font><font color="#800000">'opSalvarAlteracao'</font><font color="#808080">:
        </font><font color="#000080">escreveArq</font><font color="#808080">(</font><font color="#000080">tf</font><font color="#808080">[</font><font color="#800000">'Cliente'</font><font color="#808080">], </font><font color="#000080">LinhaReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">), </font><font color="#000080">MSG_REGALT</font><font color="#808080">, </font><font color="#000080">MSG_REGNALT</font><font color="#808080">)
     </font><font color="#000080"><b>elif </b>sacao</font><font color="#808080">==</font><font color="#800000">'opConfirmaExclusao'</font><font color="#808080">:
        </font><font color="#000080">escreveArq</font><font color="#808080">(</font><font color="#000080">tf</font><font color="#808080">[</font><font color="#800000">'Cliente'</font><font color="#808080">], </font><font color="#000080">repete</font><font color="#808080">(</font><font color="#800000">'*'</font><font color="#808080">,</font><font color="#000080">tamReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">)), </font><font color="#000080">MSG_REGEXC</font><font color="#808080">, </font><font color="#000080">MSG_REGNEXC</font><font color="#808080">)
  </font><font color="#000080"><b>elif </b>sreg</font><font color="#808080">==</font><font color="#800000">'opVenda'</font><font color="#808080">:
     </font><font color="#000080"><b>if </b>sacao</font><font color="#808080">==</font><font color="#800000">'opSalvarInclusao'</font><font color="#808080">:
        </font><font color="#000080">escreveArq</font><font color="#808080">(</font><font color="#000080">tf</font><font color="#808080">[</font><font color="#800000">'Venda'</font><font color="#808080">], </font><font color="#000080">LinhaReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">), </font><font color="#000080">MSG_REGINC</font><font color="#808080">, </font><font color="#000080">MSG_REGNINC</font><font color="#808080">)
     </font><font color="#000080"><b>elif </b>sacao</font><font color="#808080">==</font><font color="#800000">'opSalvarAlteracao'</font><font color="#808080">:
        </font><font color="#000080">escreveArq</font><font color="#808080">(</font><font color="#000080">tf</font><font color="#808080">[</font><font color="#800000">'Venda'</font><font color="#808080">], </font><font color="#000080">LinhaReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">), </font><font color="#000080">MSG_REGALT</font><font color="#808080">, </font><font color="#000080">MSG_REGNALT</font><font color="#808080">)
     </font><font color="#000080"><b>elif </b>sacao</font><font color="#808080">==</font><font color="#800000">'opConfirmaExclusao'</font><font color="#808080">:
        </font><font color="#000080">escreveArq</font><font color="#808080">(</font><font color="#000080">tf</font><font color="#808080">[</font><font color="#800000">'Venda'</font><font color="#808080">], </font><font color="#000080">repete</font><font color="#808080">(</font><font color="#800000">'*'</font><font color="#808080">,</font><font color="#000080">tamReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">)), </font><font color="#000080">MSG_REGEXC</font><font color="#808080">, </font><font color="#000080">MSG_REGNEXC</font><font color="#808080">)
  </font><font color="#000080"><b>elif </b>sreg</font><font color="#808080">==</font><font color="#800000">'opUsuario'</font><font color="#808080">:
     </font><font color="#000080"><b>if </b>sacao</font><font color="#808080">==</font><font color="#800000">'opSalvarAlteracao'</font><font color="#808080">:
        </font><font color="#000080">escreveArq</font><font color="#808080">(</font><font color="#000080">tf</font><font color="#808080">[</font><font color="#800000">'Usuario'</font><font color="#808080">], </font><font color="#000080">LinhaReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">), </font><font color="#000080">MSG_REGALT</font><font color="#808080">, </font><font color="#000080">MSG_REGNALT</font><font color="#808080">) 

<i>#------------------------------------------------------------------------------
# Seleciona o menu e/ou a tela certa de acordo com o tipo de arquivo.
# nmenu - o numero do menu
# sreg - o tipo de arquivo
#------------------------------------------------------------------------------
</i></font><font color="#000080"><b>def </b>subMenu</font><font color="#808080">(</font><font color="#000080">nmenu</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">):
  </font><font color="#000080">bSOp</font><font color="#808080">=</font><font color="#000080"><b>True
  if </b>nmenu </font><font color="#808080">== </font><font color="#FF0000">6</font><font color="#808080">:
      </font><font color="#000080"><b>while</b></font><font color="#808080">(</font><font color="#000080">bSOp</font><font color="#808080">):
       </font><font color="#000080">menu</font><font color="#808080">(</font><font color="#000080">nmenu</font><font color="#808080">)
       </font><font color="#000080">opSubMenu </font><font color="#808080">= </font><font color="#000080"><b>raw_input</b></font><font color="#808080">()
       </font><font color="#000080"><b>if </b>opSubMenu </font><font color="#808080">== </font><font color="#800000">'1'</font><font color="#808080">: </font><font color="#000080">frmCadastros</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#800000">'opNovo'</font><font color="#808080">)
       </font><font color="#000080"><b>elif </b>opSubMenu </font><font color="#808080">== </font><font color="#800000">'2'</font><font color="#808080">: </font><font color="#000080">frmCadastros</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#800000">'opPesquisar'</font><font color="#808080">)
       </font><font color="#000080"><b>elif </b>opSubMenu </font><font color="#808080">== </font><font color="#800000">'3'</font><font color="#808080">: </font><font color="#000080">bSOp</font><font color="#808080">=</font><font color="#000080"><b>False
       else</b></font><font color="#808080">: </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#000080">MSG_ERRO</font><font color="#808080">)
  </font><font color="#000080"><b>elif </b>nmenu </font><font color="#808080">== </font><font color="#FF0000">7</font><font color="#808080">:
      </font><font color="#000080"><b>while</b></font><font color="#808080">(</font><font color="#000080">bSOp</font><font color="#808080">):
       </font><font color="#000080">menu</font><font color="#808080">(</font><font color="#000080">nmenu</font><font color="#808080">)
       </font><font color="#000080">opSubMenu </font><font color="#808080">= </font><font color="#000080"><b>raw_input</b></font><font color="#808080">()
       </font><font color="#000080"><b>if </b>opSubMenu </font><font color="#808080">== </font><font color="#800000">'1'</font><font color="#808080">: 
           </font><font color="#000080">btnAcao</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#800000">'opSalvarInclusao'</font><font color="#808080">) 
           </font><font color="#000080">bSOp</font><font color="#808080">=</font><font color="#000080"><b>False
       elif </b>opSubMenu </font><font color="#808080">== </font><font color="#800000">'2'</font><font color="#808080">: </font><font color="#000080">bSOp</font><font color="#808080">=</font><font color="#000080"><b>False
       else</b></font><font color="#808080">: </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#000080">MSG_ERRO</font><font color="#808080">)
  </font><font color="#000080"><b>elif </b>nmenu </font><font color="#808080">== </font><font color="#FF0000">8</font><font color="#808080">:
      </font><font color="#000080"><b>while</b></font><font color="#808080">(</font><font color="#000080">bSOp</font><font color="#808080">):
       </font><font color="#000080">menu</font><font color="#808080">(</font><font color="#000080">nmenu</font><font color="#808080">)
       </font><font color="#000080">opSubMenu </font><font color="#808080">= </font><font color="#000080"><b>raw_input</b></font><font color="#808080">()
       </font><font color="#000080"><b>if </b>opSubMenu </font><font color="#808080">== </font><font color="#800000">'1'</font><font color="#808080">: 
          </font><font color="#000080">frmCadastros</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#800000">'opAlterar'</font><font color="#808080">) 
          </font><font color="#000080">bSOp</font><font color="#808080">=</font><font color="#000080"><b>False
       elif </b>opSubMenu </font><font color="#808080">== </font><font color="#800000">'2'</font><font color="#808080">: 
          </font><font color="#000080">frmCadastros</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#800000">'opExcluir'</font><font color="#808080">) 
          </font><font color="#000080">bSOp</font><font color="#808080">=</font><font color="#000080"><b>False
       elif </b>opSubMenu </font><font color="#808080">== </font><font color="#800000">'3'</font><font color="#808080">: </font><font color="#000080">bSOp</font><font color="#808080">=</font><font color="#000080"><b>False
       else</b></font><font color="#808080">: </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#000080">MSG_ERRO</font><font color="#808080">)
  </font><font color="#000080"><b>elif </b>nmenu </font><font color="#808080">== </font><font color="#FF0000">9</font><font color="#808080">:
      </font><font color="#000080"><b>while</b></font><font color="#808080">(</font><font color="#000080">bSOp</font><font color="#808080">):
       </font><font color="#000080">menu</font><font color="#808080">(</font><font color="#000080">nmenu</font><font color="#808080">)
       </font><font color="#000080">opSubMenu </font><font color="#808080">= </font><font color="#000080"><b>raw_input</b></font><font color="#808080">()
       </font><font color="#000080"><b>if </b>opSubMenu </font><font color="#808080">== </font><font color="#800000">'1'</font><font color="#808080">: 
          </font><font color="#000080">btnAcao</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#800000">'opSalvarAlteracao'</font><font color="#808080">) 
          </font><font color="#000080">bSOp</font><font color="#808080">=</font><font color="#000080"><b>False
       elif </b>opSubMenu </font><font color="#808080">== </font><font color="#800000">'2'</font><font color="#808080">: </font><font color="#000080">bSOp</font><font color="#808080">=</font><font color="#000080"><b>False
       else</b></font><font color="#808080">: </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#000080">MSG_ERRO</font><font color="#808080">)
  </font><font color="#000080"><b>elif </b>nmenu </font><font color="#808080">== </font><font color="#FF0000">10</font><font color="#808080">:
      </font><font color="#000080"><b>while</b></font><font color="#808080">(</font><font color="#000080">bSOp</font><font color="#808080">):
       </font><font color="#000080">menu</font><font color="#808080">(</font><font color="#000080">nmenu</font><font color="#808080">)
       </font><font color="#000080">opCSubMenu </font><font color="#808080">= </font><font color="#000080"><b>raw_input</b></font><font color="#808080">()
       </font><font color="#000080"><b>if </b></font><font color="#808080">(</font><font color="#000080">opCSubMenu</font><font color="#808080">==</font><font color="#800000">'S'</font><font color="#808080">) </font><font color="#000080"><b>or </b></font><font color="#808080">(</font><font color="#000080">opCSubMenu</font><font color="#808080">==</font><font color="#800000">'s'</font><font color="#808080">):
          </font><font color="#000080">btnAcao</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#800000">'opConfirmaExclusao'</font><font color="#808080">)
          </font><font color="#000080">bSOp</font><font color="#808080">=</font><font color="#000080"><b>False
       elif </b></font><font color="#808080">(</font><font color="#000080">opCSubMenu</font><font color="#808080">==</font><font color="#800000">'N'</font><font color="#808080">) </font><font color="#000080"><b>or </b></font><font color="#808080">(</font><font color="#000080">opCSubMenu</font><font color="#808080">==</font><font color="#800000">'n'</font><font color="#808080">): </font><font color="#000080">bSOp</font><font color="#808080">=</font><font color="#000080"><b>False
       else</b></font><font color="#808080">: </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#000080">MSG_ERRO</font><font color="#808080">)
  </font><font color="#000080"><b>elif </b>nmenu </font><font color="#808080">== </font><font color="#FF0000">12</font><font color="#808080">:
      </font><font color="#000080"><b>while</b></font><font color="#808080">(</font><font color="#000080">bSOp</font><font color="#808080">):
       </font><font color="#000080">menu</font><font color="#808080">(</font><font color="#000080">nmenu</font><font color="#808080">)
       </font><font color="#000080">opSubMenu </font><font color="#808080">= </font><font color="#000080"><b>raw_input</b></font><font color="#808080">()
       </font><font color="#000080"><b>if </b>opSubMenu </font><font color="#808080">== </font><font color="#800000">'1'</font><font color="#808080">: </font><font color="#000080">frmConsultas</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#800000">'opPesquisar'</font><font color="#808080">)
       </font><font color="#000080"><b>elif </b>opSubMenu </font><font color="#808080">== </font><font color="#800000">'2'</font><font color="#808080">: </font><font color="#000080">frmConsultas</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#800000">'opListarTodos'</font><font color="#808080">)
       </font><font color="#000080"><b>elif </b>opSubMenu </font><font color="#808080">== </font><font color="#800000">'3'</font><font color="#808080">: </font><font color="#000080">bSOp</font><font color="#808080">=</font><font color="#000080"><b>False
       else</b></font><font color="#808080">: </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#000080">MSG_ERRO</font><font color="#808080">)
  </font><font color="#000080"><b>elif </b>nmenu </font><font color="#808080">== </font><font color="#FF0000">14</font><font color="#808080">:
      </font><font color="#000080"><b>while</b></font><font color="#808080">(</font><font color="#000080">bSOp</font><font color="#808080">):
       </font><font color="#000080">menu</font><font color="#808080">(</font><font color="#000080">nmenu</font><font color="#808080">)
       </font><font color="#000080">opCSubMenu </font><font color="#808080">= </font><font color="#000080"><b>raw_input</b></font><font color="#808080">()
       </font><font color="#000080"><b>if </b></font><font color="#808080">(</font><font color="#000080">opCSubMenu</font><font color="#808080">==</font><font color="#800000">'S'</font><font color="#808080">) </font><font color="#000080"><b>or </b></font><font color="#808080">(</font><font color="#000080">opCSubMenu</font><font color="#808080">==</font><font color="#800000">'s'</font><font color="#808080">):
          </font><font color="#000080">btnAcao</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#800000">'opSalvarInclusao'</font><font color="#808080">)
          </font><font color="#000080">bSOp</font><font color="#808080">=</font><font color="#000080"><b>False
          </b>g_SalvarInclusao</font><font color="#808080">[</font><font color="#800000">'valor'</font><font color="#808080">]=</font><font color="#000080"><b>True
       elif </b></font><font color="#808080">(</font><font color="#000080">opCSubMenu</font><font color="#808080">==</font><font color="#800000">'N'</font><font color="#808080">) </font><font color="#000080"><b>or </b></font><font color="#808080">(</font><font color="#000080">opCSubMenu</font><font color="#808080">==</font><font color="#800000">'n'</font><font color="#808080">): </font><font color="#000080">bSOp</font><font color="#808080">=</font><font color="#000080"><b>False
       else</b></font><font color="#808080">: </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#000080">MSG_ERRO</font><font color="#808080">)

<i>#------------------------------------------------------------------------------
# Seleciona o submenu e/ou a tela certa de acordo com numero do menu.
# nmenu - o numero do menu
#------------------------------------------------------------------------------
</i></font><font color="#000080"><b>def </b>usaMenu</font><font color="#808080">(</font><font color="#000080">num</font><font color="#808080">):
  </font><font color="#000080">bSOp</font><font color="#808080">=</font><font color="#000080"><b>True
  if </b>num </font><font color="#808080">== </font><font color="#FF0000">1</font><font color="#808080">: <i># Cadastros 
   </i></font><font color="#000080"><b>while</b></font><font color="#808080">(</font><font color="#000080">bSOp</font><font color="#808080">):
     </font><font color="#000080">menu</font><font color="#808080">(</font><font color="#FF0000">2</font><font color="#808080">)
     </font><font color="#000080">opSubMenu </font><font color="#808080">= </font><font color="#000080"><b>raw_input</b></font><font color="#808080">()
     </font><font color="#000080"><b>if </b>opSubMenu </font><font color="#808080">== </font><font color="#800000">'1'</font><font color="#808080">: </font><font color="#000080">subMenu</font><font color="#808080">(</font><font color="#FF0000">6</font><font color="#808080">, </font><font color="#800000">'opAssunto'</font><font color="#808080">)
     </font><font color="#000080"><b>elif </b>opSubMenu </font><font color="#808080">== </font><font color="#800000">'2'</font><font color="#808080">: </font><font color="#000080">subMenu</font><font color="#808080">(</font><font color="#FF0000">6</font><font color="#808080">, </font><font color="#800000">'opAutor'</font><font color="#808080">)
     </font><font color="#000080"><b>elif </b>opSubMenu </font><font color="#808080">== </font><font color="#800000">'3'</font><font color="#808080">: </font><font color="#000080">subMenu</font><font color="#808080">(</font><font color="#FF0000">6</font><font color="#808080">, </font><font color="#800000">'opEditora'</font><font color="#808080">)
     </font><font color="#000080"><b>elif </b>opSubMenu </font><font color="#808080">== </font><font color="#800000">'4'</font><font color="#808080">: </font><font color="#000080">subMenu</font><font color="#808080">(</font><font color="#FF0000">6</font><font color="#808080">, </font><font color="#800000">'opEndereco'</font><font color="#808080">)
     </font><font color="#000080"><b>elif </b>opSubMenu </font><font color="#808080">== </font><font color="#800000">'5'</font><font color="#808080">: </font><font color="#000080">subMenu</font><font color="#808080">(</font><font color="#FF0000">6</font><font color="#808080">, </font><font color="#800000">'opIdioma'</font><font color="#808080">)
     </font><font color="#000080"><b>elif </b>opSubMenu </font><font color="#808080">== </font><font color="#800000">'6'</font><font color="#808080">: </font><font color="#000080">subMenu</font><font color="#808080">(</font><font color="#FF0000">6</font><font color="#808080">, </font><font color="#800000">'opPais'</font><font color="#808080">)
     </font><font color="#000080"><b>elif </b>opSubMenu </font><font color="#808080">== </font><font color="#800000">'7'</font><font color="#808080">: </font><font color="#000080">subMenu</font><font color="#808080">(</font><font color="#FF0000">6</font><font color="#808080">, </font><font color="#800000">'opProfissao'</font><font color="#808080">)
     </font><font color="#000080"><b>elif </b>opSubMenu </font><font color="#808080">== </font><font color="#800000">'8'</font><font color="#808080">: </font><font color="#000080">subMenu</font><font color="#808080">(</font><font color="#FF0000">6</font><font color="#808080">, </font><font color="#800000">'opCliente'</font><font color="#808080">)
     </font><font color="#000080"><b>elif </b>opSubMenu </font><font color="#808080">== </font><font color="#800000">'9'</font><font color="#808080">: </font><font color="#000080">subMenu</font><font color="#808080">(</font><font color="#FF0000">6</font><font color="#808080">, </font><font color="#800000">'opLivro'</font><font color="#808080">)
     </font><font color="#000080"><b>elif </b>opSubMenu </font><font color="#808080">== </font><font color="#800000">'10'</font><font color="#808080">: </font><font color="#000080">bSOp</font><font color="#808080">=</font><font color="#000080"><b>False
     else</b></font><font color="#808080">: </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#000080">MSG_ERRO</font><font color="#808080">)
  </font><font color="#000080"><b>elif </b>num </font><font color="#808080">== </font><font color="#FF0000">2</font><font color="#808080">: <i># Pesquisas 
   </i></font><font color="#000080"><b>while</b></font><font color="#808080">(</font><font color="#000080">bSOp</font><font color="#808080">):
     </font><font color="#000080">menu</font><font color="#808080">(</font><font color="#FF0000">3</font><font color="#808080">)
     </font><font color="#000080">opSubMenu </font><font color="#808080">= </font><font color="#000080"><b>raw_input</b></font><font color="#808080">()
     </font><font color="#000080"><b>if </b>opSubMenu </font><font color="#808080">== </font><font color="#800000">'1'</font><font color="#808080">: </font><font color="#000080">subMenu</font><font color="#808080">(</font><font color="#FF0000">12</font><font color="#808080">, </font><font color="#800000">'opAssunto'</font><font color="#808080">)
     </font><font color="#000080"><b>elif </b>opSubMenu </font><font color="#808080">== </font><font color="#800000">'2'</font><font color="#808080">: </font><font color="#000080">subMenu</font><font color="#808080">(</font><font color="#FF0000">12</font><font color="#808080">, </font><font color="#800000">'opAutor'</font><font color="#808080">)
     </font><font color="#000080"><b>elif </b>opSubMenu </font><font color="#808080">== </font><font color="#800000">'3'</font><font color="#808080">: </font><font color="#000080">subMenu</font><font color="#808080">(</font><font color="#FF0000">12</font><font color="#808080">, </font><font color="#800000">'opEditora'</font><font color="#808080">)
     </font><font color="#000080"><b>elif </b>opSubMenu </font><font color="#808080">== </font><font color="#800000">'4'</font><font color="#808080">: </font><font color="#000080">subMenu</font><font color="#808080">(</font><font color="#FF0000">12</font><font color="#808080">, </font><font color="#800000">'opEndereco'</font><font color="#808080">)
     </font><font color="#000080"><b>elif </b>opSubMenu </font><font color="#808080">== </font><font color="#800000">'5'</font><font color="#808080">: </font><font color="#000080">subMenu</font><font color="#808080">(</font><font color="#FF0000">12</font><font color="#808080">, </font><font color="#800000">'opIdioma'</font><font color="#808080">)
     </font><font color="#000080"><b>elif </b>opSubMenu </font><font color="#808080">== </font><font color="#800000">'6'</font><font color="#808080">: </font><font color="#000080">subMenu</font><font color="#808080">(</font><font color="#FF0000">12</font><font color="#808080">, </font><font color="#800000">'opPais'</font><font color="#808080">)
     </font><font color="#000080"><b>elif </b>opSubMenu </font><font color="#808080">== </font><font color="#800000">'7'</font><font color="#808080">: </font><font color="#000080">subMenu</font><font color="#808080">(</font><font color="#FF0000">12</font><font color="#808080">, </font><font color="#800000">'opProfissao'</font><font color="#808080">)
     </font><font color="#000080"><b>elif </b>opSubMenu </font><font color="#808080">== </font><font color="#800000">'8'</font><font color="#808080">: </font><font color="#000080">subMenu</font><font color="#808080">(</font><font color="#FF0000">12</font><font color="#808080">, </font><font color="#800000">'opCliente'</font><font color="#808080">)
     </font><font color="#000080"><b>elif </b>opSubMenu </font><font color="#808080">== </font><font color="#800000">'9'</font><font color="#808080">: </font><font color="#000080">subMenu</font><font color="#808080">(</font><font color="#FF0000">12</font><font color="#808080">, </font><font color="#800000">'opLivro'</font><font color="#808080">)
     </font><font color="#000080"><b>elif </b>opSubMenu </font><font color="#808080">== </font><font color="#800000">'10'</font><font color="#808080">: </font><font color="#000080">bSOp</font><font color="#808080">=</font><font color="#000080"><b>False
     else</b></font><font color="#808080">: </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#000080">MSG_ERRO</font><font color="#808080">)
  </font><font color="#000080"><b>elif </b>num </font><font color="#808080">== </font><font color="#FF0000">3</font><font color="#808080">: <i># Vendas 
   </i></font><font color="#000080"><b>while</b></font><font color="#808080">(</font><font color="#000080">bSOp</font><font color="#808080">):
     </font><font color="#000080">menu</font><font color="#808080">(</font><font color="#FF0000">4</font><font color="#808080">)
     </font><font color="#000080">opSubMenu </font><font color="#808080">= </font><font color="#000080"><b>raw_input</b></font><font color="#808080">()
     </font><font color="#000080"><b>if </b>opSubMenu </font><font color="#808080">== </font><font color="#800000">'1'</font><font color="#808080">: </font><font color="#000080">subMenu</font><font color="#808080">(</font><font color="#FF0000">6</font><font color="#808080">, </font><font color="#800000">'opVenda'</font><font color="#808080">)
     </font><font color="#000080"><b>elif </b>opSubMenu </font><font color="#808080">== </font><font color="#800000">'2'</font><font color="#808080">: </font><font color="#000080">subMenu</font><font color="#808080">(</font><font color="#FF0000">12</font><font color="#808080">, </font><font color="#800000">'opVenda'</font><font color="#808080">)
     </font><font color="#000080"><b>elif </b>opSubMenu </font><font color="#808080">== </font><font color="#800000">'3'</font><font color="#808080">: </font><font color="#000080">bSOp</font><font color="#808080">=</font><font color="#000080"><b>False
     else</b></font><font color="#808080">: </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#000080">MSG_ERRO</font><font color="#808080">)
  </font><font color="#000080"><b>elif </b>num </font><font color="#808080">== </font><font color="#FF0000">4</font><font color="#808080">: <i># Opcoes 
   </i></font><font color="#000080"><b>while</b></font><font color="#808080">(</font><font color="#000080">bSOp</font><font color="#808080">):
     </font><font color="#000080">menu</font><font color="#808080">(</font><font color="#FF0000">5</font><font color="#808080">)
     </font><font color="#000080">opSubMenu </font><font color="#808080">= </font><font color="#000080"><b>raw_input</b></font><font color="#808080">()
     </font><font color="#000080"><b>if </b>opSubMenu </font><font color="#808080">== </font><font color="#800000">'1'</font><font color="#808080">: </font><font color="#000080">frmAlterarSenha</font><font color="#808080">()
     </font><font color="#000080"><b>elif </b>opSubMenu </font><font color="#808080">== </font><font color="#800000">'2'</font><font color="#808080">: </font><font color="#000080">frmSobre</font><font color="#808080">()
     </font><font color="#000080"><b>elif </b>opSubMenu </font><font color="#808080">== </font><font color="#800000">'3'</font><font color="#808080">:
           </font><font color="#000080">menu</font><font color="#808080">(</font><font color="#FF0000">11</font><font color="#808080">)
           </font><font color="#000080">opSair </font><font color="#808080">= </font><font color="#000080"><b>raw_input</b></font><font color="#808080">()
           </font><font color="#000080"><b>if </b></font><font color="#808080">(</font><font color="#000080">opSair</font><font color="#808080">==</font><font color="#800000">'S'</font><font color="#808080">) </font><font color="#000080"><b>or </b></font><font color="#808080">(</font><font color="#000080">opSair</font><font color="#808080">==</font><font color="#800000">'s'</font><font color="#808080">):
              </font><font color="#000080">fechaArqs</font><font color="#808080">()
              </font><font color="#000080">sys</font><font color="#808080">.</font><font color="#000080">exit</font><font color="#808080">()
     </font><font color="#000080"><b>elif </b>opSubMenu </font><font color="#808080">== </font><font color="#FF0000">4</font><font color="#808080">: </font><font color="#000080">bSOp</font><font color="#808080">=</font><font color="#000080"><b>False
     else</b></font><font color="#808080">: </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#000080">MSG_ERRO</font><font color="#808080">)

<i>#------------------------------------------------------------------------------
# Mostra as entradas e as saidas do sistema.
# sreg - o tipo de arquivo
# slinha - o registro com os dados
# nOpcao - indica qual opcao sera mostrada
#------------------------------------------------------------------------------
</i></font><font color="#000080"><b>def </b>mostrarDados</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#000080">nOpcao</font><font color="#808080">):
  </font><font color="#000080"><b>if </b>sreg</font><font color="#808080">==</font><font color="#800000">'opAssunto'</font><font color="#808080">:
     </font><font color="#000080"><b>if </b>nOpcao </font><font color="#808080">== </font><font color="#FF0000">1</font><font color="#808080">:
          </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">) + </font><font color="#000080">tAssunto</font><font color="#808080">[</font><font color="#800000">'codigo'</font><font color="#808080">])
          </font><font color="#000080">tAssunto</font><font color="#808080">[</font><font color="#800000">'assunto'</font><font color="#808080">] = </font><font color="#000080"><b>raw_input</b></font><font color="#808080">(</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">))                 
     </font><font color="#000080"><b>elif </b>nOpcao </font><font color="#808080">== </font><font color="#FF0000">2</font><font color="#808080">:
          </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#800000">'Codigo     Assunto'</font><font color="#808080">)
          </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#800000">'------     -------'</font><font color="#808080">)         
     </font><font color="#000080"><b>elif </b>nOpcao </font><font color="#808080">== </font><font color="#FF0000">3</font><font color="#808080">:
          </font><font color="#000080">tAssunto</font><font color="#808080">[</font><font color="#800000">'codigo'</font><font color="#808080">]=</font><font color="#000080">copy</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">)
          </font><font color="#000080">tAssunto</font><font color="#808080">[</font><font color="#800000">'assunto'</font><font color="#808080">]=</font><font color="#000080">copy</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">11</font><font color="#808080">, </font><font color="#FF0000">30</font><font color="#808080">)
          </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#000080">tAssunto</font><font color="#808080">[</font><font color="#800000">'codigo'</font><font color="#808080">] + </font><font color="#800000">' ' </font><font color="#808080">+ </font><font color="#000080">tAssunto</font><font color="#808080">[</font><font color="#800000">'assunto'</font><font color="#808080">])
  </font><font color="#000080"><b>elif </b>sreg</font><font color="#808080">==</font><font color="#800000">'opAutor'</font><font color="#808080">:
     </font><font color="#000080"><b>if </b>nOpcao </font><font color="#808080">== </font><font color="#FF0000">1</font><font color="#808080">:
          </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">) + </font><font color="#000080">tAutor</font><font color="#808080">[</font><font color="#800000">'codigo'</font><font color="#808080">])
          </font><font color="#000080">tAutor</font><font color="#808080">[</font><font color="#800000">'autor'</font><font color="#808080">] = </font><font color="#000080"><b>raw_input</b></font><font color="#808080">(</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">))                 
     </font><font color="#000080"><b>elif </b>nOpcao </font><font color="#808080">== </font><font color="#FF0000">2</font><font color="#808080">:
          </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#800000">'Codigo     Autor'</font><font color="#808080">)
          </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#800000">'------     -----'</font><font color="#808080">)         
     </font><font color="#000080"><b>elif </b>nOpcao </font><font color="#808080">== </font><font color="#FF0000">3</font><font color="#808080">:
          </font><font color="#000080">tAutor</font><font color="#808080">[</font><font color="#800000">'codigo'</font><font color="#808080">]=</font><font color="#000080">copy</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">)
          </font><font color="#000080">tAutor</font><font color="#808080">[</font><font color="#800000">'autor'</font><font color="#808080">]=</font><font color="#000080">copy</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">11</font><font color="#808080">, </font><font color="#FF0000">30</font><font color="#808080">)
          </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#000080">tAutor</font><font color="#808080">[</font><font color="#800000">'codigo'</font><font color="#808080">] + </font><font color="#800000">' ' </font><font color="#808080">+ </font><font color="#000080">tAutor</font><font color="#808080">[</font><font color="#800000">'autor'</font><font color="#808080">])
  </font><font color="#000080"><b>elif </b>sreg</font><font color="#808080">==</font><font color="#800000">'opEditora'</font><font color="#808080">:
     </font><font color="#000080"><b>if </b>nOpcao </font><font color="#808080">== </font><font color="#FF0000">1</font><font color="#808080">:
          </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">) + </font><font color="#000080">tEditora</font><font color="#808080">[</font><font color="#800000">'codigo'</font><font color="#808080">])
          </font><font color="#000080">tEditora</font><font color="#808080">[</font><font color="#800000">'editora'</font><font color="#808080">] = </font><font color="#000080"><b>raw_input</b></font><font color="#808080">(</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">))               
     </font><font color="#000080"><b>elif </b>nOpcao </font><font color="#808080">== </font><font color="#FF0000">2</font><font color="#808080">:
          </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#800000">'Codigo     Editora'</font><font color="#808080">)
          </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#800000">'------     -------'</font><font color="#808080">)
     </font><font color="#000080"><b>elif </b>nOpcao </font><font color="#808080">== </font><font color="#FF0000">3</font><font color="#808080">:
          </font><font color="#000080">tEditora</font><font color="#808080">[</font><font color="#800000">'codigo'</font><font color="#808080">]=</font><font color="#000080">copy</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">)
          </font><font color="#000080">tEditora</font><font color="#808080">[</font><font color="#800000">'editora'</font><font color="#808080">]=</font><font color="#000080">copy</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">11</font><font color="#808080">, </font><font color="#FF0000">50</font><font color="#808080">)
          </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#000080">tEditora</font><font color="#808080">[</font><font color="#800000">'codigo'</font><font color="#808080">] + </font><font color="#800000">' ' </font><font color="#808080">+ </font><font color="#000080">tEditora</font><font color="#808080">[</font><font color="#800000">'editora'</font><font color="#808080">])
  </font><font color="#000080"><b>elif </b>sreg</font><font color="#808080">==</font><font color="#800000">'opEndereco'</font><font color="#808080">:
     </font><font color="#000080"><b>if </b>nOpcao </font><font color="#808080">== </font><font color="#FF0000">1</font><font color="#808080">:
          </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">) + </font><font color="#000080">tEndereco</font><font color="#808080">[</font><font color="#800000">'codigo'</font><font color="#808080">])
          </font><font color="#000080">tEndereco</font><font color="#808080">[</font><font color="#800000">'Logradouro'</font><font color="#808080">] = </font><font color="#000080"><b>raw_input</b></font><font color="#808080">(</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">))       
          </font><font color="#000080">tEndereco</font><font color="#808080">[</font><font color="#800000">'bairro'</font><font color="#808080">] = </font><font color="#000080"><b>raw_input</b></font><font color="#808080">(</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">))       
          </font><font color="#000080">tEndereco</font><font color="#808080">[</font><font color="#800000">'cep'</font><font color="#808080">] = </font><font color="#000080"><b>raw_input</b></font><font color="#808080">(</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">4</font><font color="#808080">))       
          </font><font color="#000080">tEndereco</font><font color="#808080">[</font><font color="#800000">'cidade'</font><font color="#808080">] = </font><font color="#000080"><b>raw_input</b></font><font color="#808080">(</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">5</font><font color="#808080">))
          </font><font color="#000080">tEndereco</font><font color="#808080">[</font><font color="#800000">'estado'</font><font color="#808080">] = </font><font color="#000080"><b>raw_input</b></font><font color="#808080">(</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">6</font><font color="#808080">))        
     </font><font color="#000080"><b>elif </b>nOpcao </font><font color="#808080">== </font><font color="#FF0000">3</font><font color="#808080">: 
          </font><font color="#000080">tEndereco</font><font color="#808080">[</font><font color="#800000">'codigo'</font><font color="#808080">]=</font><font color="#000080">string</font><font color="#808080">.</font><font color="#000080">strip</font><font color="#808080">(</font><font color="#000080">copy</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">))
          </font><font color="#000080">tEndereco</font><font color="#808080">[</font><font color="#800000">'logradouro'</font><font color="#808080">]=</font><font color="#000080">string</font><font color="#808080">.</font><font color="#000080">strip</font><font color="#808080">(</font><font color="#000080">copy</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">11</font><font color="#808080">, </font><font color="#FF0000">40</font><font color="#808080">))
          </font><font color="#000080">tEndereco</font><font color="#808080">[</font><font color="#800000">'bairro'</font><font color="#808080">]=</font><font color="#000080">string</font><font color="#808080">.</font><font color="#000080">strip</font><font color="#808080">(</font><font color="#000080">copy</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">51</font><font color="#808080">, </font><font color="#FF0000">15</font><font color="#808080">))
          </font><font color="#000080">tEndereco</font><font color="#808080">[</font><font color="#800000">'cep'</font><font color="#808080">]=</font><font color="#000080">string</font><font color="#808080">.</font><font color="#000080">strip</font><font color="#808080">(</font><font color="#000080">copy</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">66</font><font color="#808080">, </font><font color="#FF0000">8</font><font color="#808080">))
          </font><font color="#000080">tEndereco</font><font color="#808080">[</font><font color="#800000">'cidade'</font><font color="#808080">]=</font><font color="#000080">string</font><font color="#808080">.</font><font color="#000080">strip</font><font color="#808080">(</font><font color="#000080">copy</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">74</font><font color="#808080">, </font><font color="#FF0000">30</font><font color="#808080">))
          </font><font color="#000080">tEndereco</font><font color="#808080">[</font><font color="#800000">'estado'</font><font color="#808080">]=</font><font color="#000080">string</font><font color="#808080">.</font><font color="#000080">strip</font><font color="#808080">(</font><font color="#000080">copy</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">104</font><font color="#808080">, </font><font color="#FF0000">20</font><font color="#808080">))
          </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#800000">'--------------------'</font><font color="#808080">)
          </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">) + </font><font color="#000080">tEndereco</font><font color="#808080">[</font><font color="#800000">'codigo'</font><font color="#808080">])
          </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">) + </font><font color="#000080">tEndereco</font><font color="#808080">[</font><font color="#800000">'Logradouro'</font><font color="#808080">])
          </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">) + </font><font color="#000080">tEndereco</font><font color="#808080">[</font><font color="#800000">'bairro'</font><font color="#808080">])
          </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">4</font><font color="#808080">) + </font><font color="#000080">tEndereco</font><font color="#808080">[</font><font color="#800000">'cep'</font><font color="#808080">])
          </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">5</font><font color="#808080">) + </font><font color="#000080">tEndereco</font><font color="#808080">[</font><font color="#800000">'cidade'</font><font color="#808080">])
          </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">6</font><font color="#808080">) + </font><font color="#000080">tEndereco</font><font color="#808080">[</font><font color="#800000">'estado'</font><font color="#808080">])
  </font><font color="#000080"><b>elif </b>sreg</font><font color="#808080">==</font><font color="#800000">'opIdioma'</font><font color="#808080">:
     </font><font color="#000080"><b>if </b>nOpcao </font><font color="#808080">== </font><font color="#FF0000">1</font><font color="#808080">:
          </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">) + </font><font color="#000080">tIdioma</font><font color="#808080">[</font><font color="#800000">'codigo'</font><font color="#808080">])
          </font><font color="#000080">tIdioma</font><font color="#808080">[</font><font color="#800000">'idioma'</font><font color="#808080">] = </font><font color="#000080"><b>raw_input</b></font><font color="#808080">(</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">))        
     </font><font color="#000080"><b>elif </b>nOpcao </font><font color="#808080">== </font><font color="#FF0000">2</font><font color="#808080">:
          </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#800000">'Codigo     Idioma'</font><font color="#808080">)
          </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#800000">'------     ------'</font><font color="#808080">)
     </font><font color="#000080"><b>elif </b>nOpcao </font><font color="#808080">== </font><font color="#FF0000">3</font><font color="#808080">:
          </font><font color="#000080">tIdioma</font><font color="#808080">[</font><font color="#800000">'codigo'</font><font color="#808080">]=</font><font color="#000080">copy</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">)
          </font><font color="#000080">tIdioma</font><font color="#808080">[</font><font color="#800000">'idioma'</font><font color="#808080">]=</font><font color="#000080">copy</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">11</font><font color="#808080">, </font><font color="#FF0000">20</font><font color="#808080">)
          </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#000080">tIdioma</font><font color="#808080">[</font><font color="#800000">'codigo'</font><font color="#808080">] + </font><font color="#800000">' ' </font><font color="#808080">+ </font><font color="#000080">tIdioma</font><font color="#808080">[</font><font color="#800000">'idioma'</font><font color="#808080">])
  </font><font color="#000080"><b>elif </b>sreg</font><font color="#808080">==</font><font color="#800000">'opPais'</font><font color="#808080">:
     </font><font color="#000080"><b>if </b>nOpcao </font><font color="#808080">== </font><font color="#FF0000">1</font><font color="#808080">:
          </font><font color="#000080">tPais</font><font color="#808080">[</font><font color="#800000">'pais'</font><font color="#808080">] = </font><font color="#000080"><b>raw_input</b></font><font color="#808080">(</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">))        
     </font><font color="#000080"><b>elif </b>nOpcao </font><font color="#808080">== </font><font color="#FF0000">2</font><font color="#808080">: 
          </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#800000">'Codigo Pais'</font><font color="#808080">)
          </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#800000">'------ ----'</font><font color="#808080">)         
     </font><font color="#000080"><b>elif </b>nOpcao </font><font color="#808080">== </font><font color="#FF0000">3</font><font color="#808080">:
          </font><font color="#000080">tPais</font><font color="#808080">[</font><font color="#800000">'codigo'</font><font color="#808080">]=</font><font color="#000080">copy</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">)
          </font><font color="#000080">tPais</font><font color="#808080">[</font><font color="#800000">'pais'</font><font color="#808080">]=</font><font color="#000080">copy</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">4</font><font color="#808080">, </font><font color="#FF0000">50</font><font color="#808080">)
          </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#000080">tPais</font><font color="#808080">[</font><font color="#800000">'codigo'</font><font color="#808080">] + </font><font color="#800000">'    ' </font><font color="#808080">+ </font><font color="#000080">tPais</font><font color="#808080">[</font><font color="#800000">'pais'</font><font color="#808080">])
  </font><font color="#000080"><b>elif </b>sreg</font><font color="#808080">==</font><font color="#800000">'opProfissao'</font><font color="#808080">:
     </font><font color="#000080"><b>if </b>nOpcao </font><font color="#808080">== </font><font color="#FF0000">1</font><font color="#808080">:
          </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">) + </font><font color="#000080">tProfissao</font><font color="#808080">[</font><font color="#800000">'codigo'</font><font color="#808080">])
          </font><font color="#000080">tProfissao</font><font color="#808080">[</font><font color="#800000">'profissao'</font><font color="#808080">] = </font><font color="#000080"><b>raw_input</b></font><font color="#808080">(</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">))        
     </font><font color="#000080"><b>elif </b>nOpcao </font><font color="#808080">== </font><font color="#FF0000">2</font><font color="#808080">: 
          </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#800000">'Codigo     Profissao'</font><font color="#808080">)
          </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#800000">'------     ---------'</font><font color="#808080">)         
     </font><font color="#000080"><b>elif </b>nOpcao </font><font color="#808080">== </font><font color="#FF0000">3</font><font color="#808080">: 
          </font><font color="#000080">tProfissao</font><font color="#808080">[</font><font color="#800000">'codigo'</font><font color="#808080">]=</font><font color="#000080">copy</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">)
          </font><font color="#000080">tProfissao</font><font color="#808080">[</font><font color="#800000">'profissao'</font><font color="#808080">]=</font><font color="#000080">copy</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">11</font><font color="#808080">, </font><font color="#FF0000">50</font><font color="#808080">)
          </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#000080">tProfissao</font><font color="#808080">[</font><font color="#800000">'codigo'</font><font color="#808080">] + </font><font color="#800000">' ' </font><font color="#808080">+ </font><font color="#000080">tProfissao</font><font color="#808080">[</font><font color="#800000">'profissao'</font><font color="#808080">])
  </font><font color="#000080"><b>elif </b>sreg</font><font color="#808080">==</font><font color="#800000">'opLivro'</font><font color="#808080">:
     </font><font color="#000080"><b>if </b>nOpcao </font><font color="#808080">== </font><font color="#FF0000">1</font><font color="#808080">: 
          </font><font color="#000080">tLivro</font><font color="#808080">[</font><font color="#800000">'titulo'</font><font color="#808080">] = </font><font color="#000080"><b>raw_input</b></font><font color="#808080">(</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">))        
          </font><font color="#000080">tLivro</font><font color="#808080">[</font><font color="#800000">'edicao'</font><font color="#808080">]=</font><font color="#000080">validaNumero</font><font color="#808080">(</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">), </font><font color="#000080">tLivro</font><font color="#808080">[</font><font color="#800000">'edicao'</font><font color="#808080">])
          </font><font color="#000080">tLivro</font><font color="#808080">[</font><font color="#800000">'anopubli'</font><font color="#808080">]=</font><font color="#000080">validaNumero</font><font color="#808080">(</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">4</font><font color="#808080">), </font><font color="#000080">tLivro</font><font color="#808080">[</font><font color="#800000">'anopubli'</font><font color="#808080">])
          </font><font color="#000080">mostrarSubDados</font><font color="#808080">(</font><font color="#800000">'opLivro'</font><font color="#808080">, </font><font color="#800000">'opEditora'</font><font color="#808080">, </font><font color="#000080"><b>False</b></font><font color="#808080">)
          </font><font color="#000080">tLivro</font><font color="#808080">[</font><font color="#800000">'volume'</font><font color="#808080">]=</font><font color="#000080">validaNumero</font><font color="#808080">(</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">6</font><font color="#808080">), </font><font color="#000080">tLivro</font><font color="#808080">[</font><font color="#800000">'volume'</font><font color="#808080">])
          </font><font color="#000080">mostrarSubDados</font><font color="#808080">(</font><font color="#800000">'opLivro'</font><font color="#808080">, </font><font color="#800000">'opIdioma'</font><font color="#808080">, </font><font color="#000080"><b>False</b></font><font color="#808080">)
          </font><font color="#000080">tLivro</font><font color="#808080">[</font><font color="#800000">'npaginas'</font><font color="#808080">]=</font><font color="#000080">validaNumero</font><font color="#808080">(</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">8</font><font color="#808080">), </font><font color="#000080">tLivro</font><font color="#808080">[</font><font color="#800000">'npaginas'</font><font color="#808080">])
          </font><font color="#000080">tLivro</font><font color="#808080">[</font><font color="#800000">'preco'</font><font color="#808080">]=</font><font color="#000080">validaNumero</font><font color="#808080">(</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">9</font><font color="#808080">), </font><font color="#000080">tLivro</font><font color="#808080">[</font><font color="#800000">'preco'</font><font color="#808080">])
          </font><font color="#000080">tLivro</font><font color="#808080">[</font><font color="#800000">'qtdestoque'</font><font color="#808080">]=</font><font color="#000080">validaNumero</font><font color="#808080">(</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">), </font><font color="#000080">tLivro</font><font color="#808080">[</font><font color="#800000">'qtdestoque'</font><font color="#808080">])
     </font><font color="#000080"><b>elif </b>nOpcao </font><font color="#808080">== </font><font color="#FF0000">3</font><font color="#808080">: 
          </font><font color="#000080">tLivro</font><font color="#808080">[</font><font color="#800000">'isbn'</font><font color="#808080">]=</font><font color="#000080">string</font><font color="#808080">.</font><font color="#000080">strip</font><font color="#808080">(</font><font color="#000080">copy</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">13</font><font color="#808080">))
          </font><font color="#000080">tLivro</font><font color="#808080">[</font><font color="#800000">'titulo'</font><font color="#808080">]=</font><font color="#000080">string</font><font color="#808080">.</font><font color="#000080">strip</font><font color="#808080">(</font><font color="#000080">copy</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">14</font><font color="#808080">, </font><font color="#FF0000">50</font><font color="#808080">))
          </font><font color="#000080">tLivro</font><font color="#808080">[</font><font color="#800000">'edicao'</font><font color="#808080">]=</font><font color="#000080">string</font><font color="#808080">.</font><font color="#000080">strip</font><font color="#808080">(</font><font color="#000080">copy</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">64</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">))
          </font><font color="#000080">tLivro</font><font color="#808080">[</font><font color="#800000">'anopubli'</font><font color="#808080">]=</font><font color="#000080">string</font><font color="#808080">.</font><font color="#000080">strip</font><font color="#808080">(</font><font color="#000080">copy</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">74</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">))
          </font><font color="#000080">tLivro</font><font color="#808080">[</font><font color="#800000">'codeditora'</font><font color="#808080">]=</font><font color="#000080">string</font><font color="#808080">.</font><font color="#000080">strip</font><font color="#808080">(</font><font color="#000080">copy</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">84</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">))
          </font><font color="#000080">tLivro</font><font color="#808080">[</font><font color="#800000">'volume'</font><font color="#808080">]=</font><font color="#000080">string</font><font color="#808080">.</font><font color="#000080">strip</font><font color="#808080">(</font><font color="#000080">copy</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">94</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">))
          </font><font color="#000080">tLivro</font><font color="#808080">[</font><font color="#800000">'codidioma'</font><font color="#808080">]=</font><font color="#000080">string</font><font color="#808080">.</font><font color="#000080">strip</font><font color="#808080">(</font><font color="#000080">copy</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">104</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">))
          </font><font color="#000080">tLivro</font><font color="#808080">[</font><font color="#800000">'npaginas'</font><font color="#808080">]=</font><font color="#000080">string</font><font color="#808080">.</font><font color="#000080">strip</font><font color="#808080">(</font><font color="#000080">copy</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">114</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">))
          </font><font color="#000080">tLivro</font><font color="#808080">[</font><font color="#800000">'preco'</font><font color="#808080">]=</font><font color="#000080">string</font><font color="#808080">.</font><font color="#000080">strip</font><font color="#808080">(</font><font color="#000080">copy</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">124</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">))
          </font><font color="#000080">tLivro</font><font color="#808080">[</font><font color="#800000">'qtdestoque'</font><font color="#808080">]=</font><font color="#000080">string</font><font color="#808080">.</font><font color="#000080">strip</font><font color="#808080">(</font><font color="#000080">copy</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">134</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">))
          </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#800000">'--------------------'</font><font color="#808080">)
          </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">) + </font><font color="#000080">tLivro</font><font color="#808080">[</font><font color="#800000">'isbn'</font><font color="#808080">])
          </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">) + </font><font color="#000080">tLivro</font><font color="#808080">[</font><font color="#800000">'titulo'</font><font color="#808080">])
          </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">) + </font><font color="#000080">tLivro</font><font color="#808080">[</font><font color="#800000">'edicao'</font><font color="#808080">])
          </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">4</font><font color="#808080">) + </font><font color="#000080">tLivro</font><font color="#808080">[</font><font color="#800000">'anopubli'</font><font color="#808080">])
          </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">5</font><font color="#808080">) + </font><font color="#000080">tLivro</font><font color="#808080">[</font><font color="#800000">'codeditora'</font><font color="#808080">])
          </font><font color="#000080">mostrarSubDados</font><font color="#808080">(</font><font color="#800000">'opLivro'</font><font color="#808080">, </font><font color="#800000">'opEditora'</font><font color="#808080">, </font><font color="#000080"><b>True</b></font><font color="#808080">)
          </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">6</font><font color="#808080">) + </font><font color="#000080">tLivro</font><font color="#808080">[</font><font color="#800000">'volume'</font><font color="#808080">])
          </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">7</font><font color="#808080">) + </font><font color="#000080">tLivro</font><font color="#808080">[</font><font color="#800000">'codidioma'</font><font color="#808080">])
          </font><font color="#000080">mostrarSubDados</font><font color="#808080">(</font><font color="#800000">'opLivro'</font><font color="#808080">, </font><font color="#800000">'opIdioma'</font><font color="#808080">, </font><font color="#000080"><b>True</b></font><font color="#808080">)
          </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">8</font><font color="#808080">) + </font><font color="#000080">tLivro</font><font color="#808080">[</font><font color="#800000">'npaginas'</font><font color="#808080">])
          </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">9</font><font color="#808080">) + </font><font color="#000080">tLivro</font><font color="#808080">[</font><font color="#800000">'preco'</font><font color="#808080">])
          </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">) + </font><font color="#000080">tLivro</font><font color="#808080">[</font><font color="#800000">'qtdestoque'</font><font color="#808080">])
          </font><font color="#000080">ListarRegLigados</font><font color="#808080">(</font><font color="#000080">tf</font><font color="#808080">[</font><font color="#800000">'LivroAss'</font><font color="#808080">], </font><font color="#800000">'opLivroAss'</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">13</font><font color="#808080">, </font><font color="#FF0000">14</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">, </font><font color="#000080">tLivro</font><font color="#808080">[</font><font color="#800000">'isbn'</font><font color="#808080">],
                           </font><font color="#000080">tf</font><font color="#808080">[</font><font color="#800000">'Assunto'</font><font color="#808080">], </font><font color="#800000">'opAssunto'</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">4</font><font color="#808080">)
          </font><font color="#000080">ListarRegLigados</font><font color="#808080">(</font><font color="#000080">tf</font><font color="#808080">[</font><font color="#800000">'LivroAut'</font><font color="#808080">], </font><font color="#800000">'opLivroAut'</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">13</font><font color="#808080">, </font><font color="#FF0000">14</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">, </font><font color="#000080">tLivro</font><font color="#808080">[</font><font color="#800000">'isbn'</font><font color="#808080">],
                           </font><font color="#000080">tf</font><font color="#808080">[</font><font color="#800000">'Autor'</font><font color="#808080">], </font><font color="#800000">'opAutor'</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">4</font><font color="#808080">)
  </font><font color="#000080"><b>elif </b>sreg</font><font color="#808080">==</font><font color="#800000">'opCliente'</font><font color="#808080">:
     </font><font color="#000080"><b>if </b>nOpcao </font><font color="#808080">== </font><font color="#FF0000">1</font><font color="#808080">: 
          </font><font color="#000080">tCliente</font><font color="#808080">[</font><font color="#800000">'nome'</font><font color="#808080">] = </font><font color="#000080"><b>raw_input</b></font><font color="#808080">(</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">))        
          </font><font color="#000080">tCliente</font><font color="#808080">[</font><font color="#800000">'email'</font><font color="#808080">] = </font><font color="#000080"><b>raw_input</b></font><font color="#808080">(</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">))        
          </font><font color="#000080">tCliente</font><font color="#808080">[</font><font color="#800000">'identidade'</font><font color="#808080">] = </font><font color="#000080"><b>raw_input</b></font><font color="#808080">(</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">4</font><font color="#808080">))        
          </font><font color="#000080">tCliente</font><font color="#808080">[</font><font color="#800000">'sexo'</font><font color="#808080">] = </font><font color="#000080"><b>raw_input</b></font><font color="#808080">(</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">5</font><font color="#808080">))        
          </font><font color="#000080">tCliente</font><font color="#808080">[</font><font color="#800000">'telefone'</font><font color="#808080">] = </font><font color="#000080"><b>raw_input</b></font><font color="#808080">(</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">6</font><font color="#808080">))        
          </font><font color="#000080">tCliente</font><font color="#808080">[</font><font color="#800000">'dtnascimento'</font><font color="#808080">]= \
                  </font><font color="#000080">validaDataHora</font><font color="#808080">(</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">7</font><font color="#808080">), </font><font color="#000080">tCliente</font><font color="#808080">[</font><font color="#800000">'dtnascimento'</font><font color="#808080">], </font><font color="#000080"><b>True</b></font><font color="#808080">)
          </font><font color="#000080">mostrarSubDados</font><font color="#808080">(</font><font color="#800000">'opCliente'</font><font color="#808080">, </font><font color="#800000">'opEndereco'</font><font color="#808080">, </font><font color="#000080"><b>False</b></font><font color="#808080">)
          </font><font color="#000080">mostrarSubDados</font><font color="#808080">(</font><font color="#800000">'opCliente'</font><font color="#808080">, </font><font color="#800000">'opPais'</font><font color="#808080">, </font><font color="#000080"><b>False</b></font><font color="#808080">)
          </font><font color="#000080">mostrarSubDados</font><font color="#808080">(</font><font color="#800000">'opCliente'</font><font color="#808080">, </font><font color="#800000">'opProfissao'</font><font color="#808080">, </font><font color="#000080"><b>False</b></font><font color="#808080">)
     </font><font color="#000080"><b>elif </b>nOpcao </font><font color="#808080">== </font><font color="#FF0000">3</font><font color="#808080">: 
          </font><font color="#000080">tCliente</font><font color="#808080">[</font><font color="#800000">'cpf'</font><font color="#808080">]=</font><font color="#000080">string</font><font color="#808080">.</font><font color="#000080">strip</font><font color="#808080">(</font><font color="#000080">copy</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">14</font><font color="#808080">))
          </font><font color="#000080">tCliente</font><font color="#808080">[</font><font color="#800000">'nome'</font><font color="#808080">]=</font><font color="#000080">string</font><font color="#808080">.</font><font color="#000080">strip</font><font color="#808080">(</font><font color="#000080">copy</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">15</font><font color="#808080">, </font><font color="#FF0000">30</font><font color="#808080">))
          </font><font color="#000080">tCliente</font><font color="#808080">[</font><font color="#800000">'email'</font><font color="#808080">]=</font><font color="#000080">string</font><font color="#808080">.</font><font color="#000080">strip</font><font color="#808080">(</font><font color="#000080">copy</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">45</font><font color="#808080">, </font><font color="#FF0000">30</font><font color="#808080">))
          </font><font color="#000080">tCliente</font><font color="#808080">[</font><font color="#800000">'identidade'</font><font color="#808080">]=</font><font color="#000080">string</font><font color="#808080">.</font><font color="#000080">strip</font><font color="#808080">(</font><font color="#000080">copy</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">75</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">))
          </font><font color="#000080">tCliente</font><font color="#808080">[</font><font color="#800000">'sexo'</font><font color="#808080">]=</font><font color="#000080">string</font><font color="#808080">.</font><font color="#000080">strip</font><font color="#808080">(</font><font color="#000080">copy</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">85</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">))
          </font><font color="#000080">tCliente</font><font color="#808080">[</font><font color="#800000">'telefone'</font><font color="#808080">]=</font><font color="#000080">string</font><font color="#808080">.</font><font color="#000080">strip</font><font color="#808080">(</font><font color="#000080">copy</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">86</font><font color="#808080">, </font><font color="#FF0000">17</font><font color="#808080">))
          </font><font color="#000080">tCliente</font><font color="#808080">[</font><font color="#800000">'dtnascimento'</font><font color="#808080">]=</font><font color="#000080">string</font><font color="#808080">.</font><font color="#000080">strip</font><font color="#808080">(</font><font color="#000080">copy</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">103</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">))
          </font><font color="#000080">tCliente</font><font color="#808080">[</font><font color="#800000">'codendereco'</font><font color="#808080">]=</font><font color="#000080">string</font><font color="#808080">.</font><font color="#000080">strip</font><font color="#808080">(</font><font color="#000080">copy</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">113</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">))
          </font><font color="#000080">tCliente</font><font color="#808080">[</font><font color="#800000">'codpais'</font><font color="#808080">]=</font><font color="#000080">string</font><font color="#808080">.</font><font color="#000080">strip</font><font color="#808080">(</font><font color="#000080">copy</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">123</font><font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">))
          </font><font color="#000080">tCliente</font><font color="#808080">[</font><font color="#800000">'codprofissao'</font><font color="#808080">]=</font><font color="#000080">string</font><font color="#808080">.</font><font color="#000080">strip</font><font color="#808080">(</font><font color="#000080">copy</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">126</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">))
          </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#800000">'--------------------'</font><font color="#808080">)
          </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">) + </font><font color="#000080">tCliente</font><font color="#808080">[</font><font color="#800000">'cpf'</font><font color="#808080">])
          </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">) + </font><font color="#000080">tCliente</font><font color="#808080">[</font><font color="#800000">'nome'</font><font color="#808080">])
          </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">) + </font><font color="#000080">tCliente</font><font color="#808080">[</font><font color="#800000">'email'</font><font color="#808080">])
          </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">4</font><font color="#808080">) + </font><font color="#000080">tCliente</font><font color="#808080">[</font><font color="#800000">'identidade'</font><font color="#808080">])
          </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">5</font><font color="#808080">) + </font><font color="#000080">tCliente</font><font color="#808080">[</font><font color="#800000">'sexo'</font><font color="#808080">])
          </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">6</font><font color="#808080">) + </font><font color="#000080">tCliente</font><font color="#808080">[</font><font color="#800000">'telefone'</font><font color="#808080">])
          </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">7</font><font color="#808080">) + </font><font color="#000080">tCliente</font><font color="#808080">[</font><font color="#800000">'dtnascimento'</font><font color="#808080">])
          </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">8</font><font color="#808080">) + </font><font color="#000080">tCliente</font><font color="#808080">[</font><font color="#800000">'codendereco'</font><font color="#808080">])
          </font><font color="#000080">mostrarSubDados</font><font color="#808080">(</font><font color="#800000">'opCliente'</font><font color="#808080">, </font><font color="#800000">'opEndereco'</font><font color="#808080">, </font><font color="#000080"><b>True</b></font><font color="#808080">)
          </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">9</font><font color="#808080">) + </font><font color="#000080">tCliente</font><font color="#808080">[</font><font color="#800000">'codpais'</font><font color="#808080">])
          </font><font color="#000080">mostrarSubDados</font><font color="#808080">(</font><font color="#800000">'opCliente'</font><font color="#808080">, </font><font color="#800000">'opPais'</font><font color="#808080">, </font><font color="#000080"><b>True</b></font><font color="#808080">)
          </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">) + </font><font color="#000080">tCliente</font><font color="#808080">[</font><font color="#800000">'codprofissao'</font><font color="#808080">])
          </font><font color="#000080">mostrarSubDados</font><font color="#808080">(</font><font color="#800000">'opCliente'</font><font color="#808080">, </font><font color="#800000">'opProfissao'</font><font color="#808080">, </font><font color="#000080"><b>True</b></font><font color="#808080">)
  </font><font color="#000080"><b>elif </b>sreg</font><font color="#808080">==</font><font color="#800000">'opVenda'</font><font color="#808080">:
     </font><font color="#000080"><b>if </b>nOpcao </font><font color="#808080">== </font><font color="#FF0000">1</font><font color="#808080">: </font><font color="#000080">mostrarSubDados</font><font color="#808080">(</font><font color="#800000">'opVenda'</font><font color="#808080">,</font><font color="#800000">'opVenda'</font><font color="#808080">, </font><font color="#000080"><b>False</b></font><font color="#808080">)
     </font><font color="#000080"><b>elif </b>nOpcao </font><font color="#808080">== </font><font color="#FF0000">2</font><font color="#808080">:
          </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#800000">'DataHoraVenda       CPF            ISBN          '</font><font color="#808080">+
          </font><font color="#800000">'PrecoVenda'</font><font color="#808080">)
          </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#800000">'-------------       ---            ----          '</font><font color="#808080">+
          </font><font color="#800000">'----------'</font><font color="#808080">)
     </font><font color="#000080"><b>elif </b>nOpcao </font><font color="#808080">== </font><font color="#FF0000">3</font><font color="#808080">:
          </font><font color="#000080">tVenda</font><font color="#808080">[</font><font color="#800000">'dthrvenda'</font><font color="#808080">]=</font><font color="#000080">copy</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">19</font><font color="#808080">)
          </font><font color="#000080">tVenda</font><font color="#808080">[</font><font color="#800000">'cpf'</font><font color="#808080">]=</font><font color="#000080">copy</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">20</font><font color="#808080">, </font><font color="#FF0000">14</font><font color="#808080">)
          </font><font color="#000080">tVenda</font><font color="#808080">[</font><font color="#800000">'isbn'</font><font color="#808080">]=</font><font color="#000080">copy</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">34</font><font color="#808080">, </font><font color="#FF0000">13</font><font color="#808080">)
          </font><font color="#000080">tVenda</font><font color="#808080">[</font><font color="#800000">'precovenda'</font><font color="#808080">]=</font><font color="#000080">copy</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">47</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">)
          </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#000080">tVenda</font><font color="#808080">[</font><font color="#800000">'dthrvenda'</font><font color="#808080">] + </font><font color="#800000">' ' </font><font color="#808080">+ </font><font color="#000080">tVenda</font><font color="#808080">[</font><font color="#800000">'cpf'</font><font color="#808080">] + </font><font color="#800000">' ' </font><font color="#808080">+ </font><font color="#000080">tVenda</font><font color="#808080">[</font><font color="#800000">'isbn'</font><font color="#808080">] + </font><font color="#800000">' ' </font><font color="#808080">+ 
          </font><font color="#000080">tVenda</font><font color="#808080">[</font><font color="#800000">'precovenda'</font><font color="#808080">])

<i>#------------------------------------------------------------------------------
# Mostra as sub informcoes de entrada e de saida.
# sreg - o tipo de arquivo
# ssubreg - o subtipo de arquivo
# bSoMostrar - se vai so mostrar na saida 
#------------------------------------------------------------------------------
</i></font><font color="#000080"><b>def </b>mostrarSubDados</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#000080">ssubreg</font><font color="#808080">, </font><font color="#000080">bSoMostrar</font><font color="#808080">):
  </font><font color="#000080">nMaxTentativas</font><font color="#808080">=</font><font color="#FF0000">3
  </font><font color="#000080"><b>if </b>sreg</font><font color="#808080">==</font><font color="#800000">'opLivro'</font><font color="#808080">:
    </font><font color="#000080"><b>if </b>ssubreg</font><font color="#808080">==</font><font color="#800000">'opEditora'</font><font color="#808080">:
      </font><font color="#000080"><b>if </b>bSoMostrar</font><font color="#808080">:
         </font><font color="#000080">sRegistro</font><font color="#808080">=</font><font color="#000080">pesqArq</font><font color="#808080">(</font><font color="#000080">tf</font><font color="#808080">[</font><font color="#800000">'Editora'</font><font color="#808080">],</font><font color="#000080">tLivro</font><font color="#808080">[</font><font color="#800000">'codeditora'</font><font color="#808080">],</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">,</font><font color="#000080">tamReg</font><font color="#808080">(</font><font color="#800000">'opEditora'</font><font color="#808080">))
      </font><font color="#000080"><b>else</b></font><font color="#808080">:
         </font><font color="#000080">sRegistro</font><font color="#808080">=</font><font color="#000080">validaEntrada</font><font color="#808080">(</font><font color="#000080">tf</font><font color="#808080">[</font><font color="#800000">'Editora'</font><font color="#808080">],</font><font color="#000080">ssubreg</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#000080">tLivro</font><font color="#808080">[</font><font color="#800000">'codeditora'</font><font color="#808080">],
                    </font><font color="#000080">nMaxTentativas</font><font color="#808080">,</font><font color="#000080"><b>False</b></font><font color="#808080">,</font><font color="#800000">'opNumero'</font><font color="#808080">)
      </font><font color="#000080"><b>if </b>sRegistro</font><font color="#808080">!=</font><font color="#800000">''</font><font color="#808080">:
        </font><font color="#000080">tLivro</font><font color="#808080">[</font><font color="#800000">'codeditora'</font><font color="#808080">]=</font><font color="#000080">string</font><font color="#808080">.</font><font color="#000080">strip</font><font color="#808080">(</font><font color="#000080">copy</font><font color="#808080">(</font><font color="#000080">sRegistro</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">))
        </font><font color="#000080"><b>print </b></font><font color="#800000">' '</font><font color="#808080">+</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#800000">'opEditora'</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">),
        </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#000080">copy</font><font color="#808080">(</font><font color="#000080">sRegistro</font><font color="#808080">, </font><font color="#000080">g_nPosChave</font><font color="#808080">[</font><font color="#800000">'opEditora'</font><font color="#808080">][</font><font color="#FF0000">1</font><font color="#808080">], </font><font color="#000080">g_nTamChave</font><font color="#808080">[</font><font color="#800000">'opEditora'</font><font color="#808080">][</font><font color="#FF0000">1</font><font color="#808080">]))
    </font><font color="#000080"><b>elif </b>ssubreg</font><font color="#808080">==</font><font color="#800000">'opIdioma'</font><font color="#808080">:
      </font><font color="#000080"><b>if </b>bSoMostrar</font><font color="#808080">:
         </font><font color="#000080">sRegistro</font><font color="#808080">=</font><font color="#000080">pesqArq</font><font color="#808080">(</font><font color="#000080">tf</font><font color="#808080">[</font><font color="#800000">'Idioma'</font><font color="#808080">], </font><font color="#000080">tLivro</font><font color="#808080">[</font><font color="#800000">'codidioma'</font><font color="#808080">], </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">,</font><font color="#000080">tamReg</font><font color="#808080">(</font><font color="#800000">'opIdioma'</font><font color="#808080">))
      </font><font color="#000080"><b>else</b></font><font color="#808080">:
         </font><font color="#000080">sRegistro</font><font color="#808080">=</font><font color="#000080">validaEntrada</font><font color="#808080">(</font><font color="#000080">tf</font><font color="#808080">[</font><font color="#800000">'Idioma'</font><font color="#808080">],</font><font color="#000080">ssubreg</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#000080">tLivro</font><font color="#808080">[</font><font color="#800000">'codidioma'</font><font color="#808080">],
                    </font><font color="#000080">nMaxTentativas</font><font color="#808080">,</font><font color="#000080"><b>False</b></font><font color="#808080">,</font><font color="#800000">'opNumero'</font><font color="#808080">)
      </font><font color="#000080"><b>if </b>sRegistro</font><font color="#808080">!=</font><font color="#800000">''</font><font color="#808080">:
        </font><font color="#000080">tLivro</font><font color="#808080">[</font><font color="#800000">'codidioma'</font><font color="#808080">]=</font><font color="#000080">string</font><font color="#808080">.</font><font color="#000080">strip</font><font color="#808080">(</font><font color="#000080">copy</font><font color="#808080">(</font><font color="#000080">sRegistro</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">))
        </font><font color="#000080"><b>print </b></font><font color="#800000">' '</font><font color="#808080">+</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#800000">'opIdioma'</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">),
        </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#000080">copy</font><font color="#808080">(</font><font color="#000080">sRegistro</font><font color="#808080">, </font><font color="#000080">g_nPosChave</font><font color="#808080">[</font><font color="#800000">'opIdioma'</font><font color="#808080">][</font><font color="#FF0000">1</font><font color="#808080">], </font><font color="#000080">g_nTamChave</font><font color="#808080">[</font><font color="#800000">'opIdioma'</font><font color="#808080">][</font><font color="#FF0000">1</font><font color="#808080">]))
  </font><font color="#000080"><b>elif </b>sreg</font><font color="#808080">==</font><font color="#800000">'opCliente'</font><font color="#808080">:
    </font><font color="#000080"><b>if </b>ssubreg</font><font color="#808080">==</font><font color="#800000">'opEndereco'</font><font color="#808080">:
      </font><font color="#000080"><b>if </b>bSoMostrar</font><font color="#808080">:
         </font><font color="#000080">sRegistro</font><font color="#808080">=</font><font color="#000080">pesqArq</font><font color="#808080">(</font><font color="#000080">tf</font><font color="#808080">[</font><font color="#800000">'Endereco'</font><font color="#808080">], </font><font color="#000080">tCliente</font><font color="#808080">[</font><font color="#800000">'codendereco'</font><font color="#808080">], </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">,
                    </font><font color="#000080">tamReg</font><font color="#808080">(</font><font color="#800000">'opEndereco'</font><font color="#808080">))
      </font><font color="#000080"><b>else</b></font><font color="#808080">:
         </font><font color="#000080">sRegistro</font><font color="#808080">=</font><font color="#000080">validaEntrada</font><font color="#808080">(</font><font color="#000080">tf</font><font color="#808080">[</font><font color="#800000">'Endereco'</font><font color="#808080">],</font><font color="#000080">ssubreg</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#000080">tCliente</font><font color="#808080">[</font><font color="#800000">'codendereco'</font><font color="#808080">],
                    </font><font color="#000080">nMaxTentativas</font><font color="#808080">,</font><font color="#000080"><b>False</b></font><font color="#808080">,</font><font color="#800000">'opNumero'</font><font color="#808080">)
      </font><font color="#000080"><b>if </b>sRegistro</font><font color="#808080">!=</font><font color="#800000">''</font><font color="#808080">:
        </font><font color="#000080">tCliente</font><font color="#808080">[</font><font color="#800000">'codendereco'</font><font color="#808080">]=</font><font color="#000080">string</font><font color="#808080">.</font><font color="#000080">strip</font><font color="#808080">(</font><font color="#000080">copy</font><font color="#808080">(</font><font color="#000080">sRegistro</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">))
        </font><font color="#000080"><b>print </b></font><font color="#800000">' '</font><font color="#808080">+</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#800000">'opEndereco'</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">),
        </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#000080">copy</font><font color="#808080">(</font><font color="#000080">sRegistro</font><font color="#808080">, </font><font color="#000080">g_nPosChave</font><font color="#808080">[</font><font color="#800000">'opEndereco'</font><font color="#808080">][</font><font color="#FF0000">1</font><font color="#808080">], </font><font color="#000080">g_nTamChave</font><font color="#808080">[</font><font color="#800000">'opEndereco'</font><font color="#808080">][</font><font color="#FF0000">1</font><font color="#808080">]))
        </font><font color="#000080"><b>print </b></font><font color="#800000">' '</font><font color="#808080">+</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#800000">'opEndereco'</font><font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">),
        </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#000080">copy</font><font color="#808080">(</font><font color="#000080">sRegistro</font><font color="#808080">, </font><font color="#000080">g_nPosChave</font><font color="#808080">[</font><font color="#800000">'opEndereco'</font><font color="#808080">][</font><font color="#FF0000">2</font><font color="#808080">], </font><font color="#000080">g_nTamChave</font><font color="#808080">[</font><font color="#800000">'opEndereco'</font><font color="#808080">][</font><font color="#FF0000">2</font><font color="#808080">]))
        </font><font color="#000080"><b>print </b></font><font color="#800000">' '</font><font color="#808080">+</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#800000">'opEndereco'</font><font color="#808080">, </font><font color="#FF0000">4</font><font color="#808080">),
        </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#000080">copy</font><font color="#808080">(</font><font color="#000080">sRegistro</font><font color="#808080">, </font><font color="#000080">g_nPosChave</font><font color="#808080">[</font><font color="#800000">'opEndereco'</font><font color="#808080">][</font><font color="#FF0000">3</font><font color="#808080">], </font><font color="#000080">g_nTamChave</font><font color="#808080">[</font><font color="#800000">'opEndereco'</font><font color="#808080">][</font><font color="#FF0000">3</font><font color="#808080">]))
        </font><font color="#000080"><b>print </b></font><font color="#800000">' '</font><font color="#808080">+</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#800000">'opEndereco'</font><font color="#808080">, </font><font color="#FF0000">5</font><font color="#808080">),
        </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#000080">copy</font><font color="#808080">(</font><font color="#000080">sRegistro</font><font color="#808080">, </font><font color="#000080">g_nPosChave</font><font color="#808080">[</font><font color="#800000">'opEndereco'</font><font color="#808080">][</font><font color="#FF0000">4</font><font color="#808080">], </font><font color="#000080">g_nTamChave</font><font color="#808080">[</font><font color="#800000">'opEndereco'</font><font color="#808080">][</font><font color="#FF0000">4</font><font color="#808080">]))
        </font><font color="#000080"><b>print </b></font><font color="#800000">' '</font><font color="#808080">+</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#800000">'opEndereco'</font><font color="#808080">, </font><font color="#FF0000">6</font><font color="#808080">),
        </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#000080">copy</font><font color="#808080">(</font><font color="#000080">sRegistro</font><font color="#808080">, </font><font color="#000080">g_nPosChave</font><font color="#808080">[</font><font color="#800000">'opEndereco'</font><font color="#808080">][</font><font color="#FF0000">5</font><font color="#808080">], </font><font color="#000080">g_nTamChave</font><font color="#808080">[</font><font color="#800000">'opEndereco'</font><font color="#808080">][</font><font color="#FF0000">5</font><font color="#808080">]))
    </font><font color="#000080"><b>elif </b>ssubreg</font><font color="#808080">==</font><font color="#800000">'opPais'</font><font color="#808080">:
      </font><font color="#000080"><b>if </b>bSoMostrar</font><font color="#808080">:
         </font><font color="#000080">sRegistro</font><font color="#808080">=</font><font color="#000080">pesqArq</font><font color="#808080">(</font><font color="#000080">tf</font><font color="#808080">[</font><font color="#800000">'Pais'</font><font color="#808080">], </font><font color="#000080">tCliente</font><font color="#808080">[</font><font color="#800000">'codpais'</font><font color="#808080">], </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">, </font><font color="#000080">tamReg</font><font color="#808080">(</font><font color="#800000">'opPais'</font><font color="#808080">))
      </font><font color="#000080"><b>else</b></font><font color="#808080">:
         </font><font color="#000080">sRegistro</font><font color="#808080">=</font><font color="#000080">validaEntrada</font><font color="#808080">(</font><font color="#000080">tf</font><font color="#808080">[</font><font color="#800000">'Pais'</font><font color="#808080">],</font><font color="#000080">ssubreg</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#000080">tCliente</font><font color="#808080">[</font><font color="#800000">'codpais'</font><font color="#808080">],
                    </font><font color="#000080">nMaxTentativas</font><font color="#808080">,</font><font color="#000080"><b>False</b></font><font color="#808080">,</font><font color="#800000">'opTexto'</font><font color="#808080">)
      </font><font color="#000080"><b>if </b>sRegistro</font><font color="#808080">!=</font><font color="#800000">''</font><font color="#808080">:
        </font><font color="#000080">tCliente</font><font color="#808080">[</font><font color="#800000">'codpais'</font><font color="#808080">]=</font><font color="#000080">string</font><font color="#808080">.</font><font color="#000080">strip</font><font color="#808080">(</font><font color="#000080">copy</font><font color="#808080">(</font><font color="#000080">sRegistro</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#FF0000">3</font><font color="#808080">))
        </font><font color="#000080"><b>print </b></font><font color="#800000">' '</font><font color="#808080">+</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#800000">'opPais'</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">),
        </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#000080">copy</font><font color="#808080">(</font><font color="#000080">sRegistro</font><font color="#808080">, </font><font color="#000080">g_nPosChave</font><font color="#808080">[</font><font color="#800000">'opPais'</font><font color="#808080">][</font><font color="#FF0000">1</font><font color="#808080">], </font><font color="#000080">g_nTamChave</font><font color="#808080">[</font><font color="#800000">'opPais'</font><font color="#808080">][</font><font color="#FF0000">1</font><font color="#808080">]))
    </font><font color="#000080"><b>elif </b>ssubreg</font><font color="#808080">==</font><font color="#800000">'opProfissao'</font><font color="#808080">:
      </font><font color="#000080"><b>if </b>bSoMostrar</font><font color="#808080">:
         </font><font color="#000080">sRegistro</font><font color="#808080">=</font><font color="#000080">pesqArq</font><font color="#808080">(</font><font color="#000080">tf</font><font color="#808080">[</font><font color="#800000">'Profissao'</font><font color="#808080">], </font><font color="#000080">tCliente</font><font color="#808080">[</font><font color="#800000">'codprofissao'</font><font color="#808080">], </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">,
                    </font><font color="#000080">tamReg</font><font color="#808080">(</font><font color="#800000">'opProfissao'</font><font color="#808080">))
      </font><font color="#000080"><b>else</b></font><font color="#808080">:
         </font><font color="#000080">sRegistro</font><font color="#808080">=</font><font color="#000080">validaEntrada</font><font color="#808080">(</font><font color="#000080">tf</font><font color="#808080">[</font><font color="#800000">'Profissao'</font><font color="#808080">],</font><font color="#000080">ssubreg</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#000080">tCliente</font><font color="#808080">[</font><font color="#800000">'codprofissao'</font><font color="#808080">],
                    </font><font color="#000080">nMaxTentativas</font><font color="#808080">,</font><font color="#000080"><b>False</b></font><font color="#808080">,</font><font color="#800000">'opNumero'</font><font color="#808080">)
      </font><font color="#000080"><b>if </b>sRegistro</font><font color="#808080">!=</font><font color="#800000">''</font><font color="#808080">:
        </font><font color="#000080">tCliente</font><font color="#808080">[</font><font color="#800000">'codprofissao'</font><font color="#808080">]=</font><font color="#000080">string</font><font color="#808080">.</font><font color="#000080">strip</font><font color="#808080">(</font><font color="#000080">copy</font><font color="#808080">(</font><font color="#000080">sRegistro</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">))
        </font><font color="#000080"><b>print </b></font><font color="#800000">' '</font><font color="#808080">+</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#800000">'opProfissao'</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">),
        </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#000080">copy</font><font color="#808080">(</font><font color="#000080">sRegistro</font><font color="#808080">, </font><font color="#000080">g_nPosChave</font><font color="#808080">[</font><font color="#800000">'opProfissao'</font><font color="#808080">][</font><font color="#FF0000">1</font><font color="#808080">], </font><font color="#000080">g_nTamChave</font><font color="#808080">[</font><font color="#800000">'opProfissao'</font><font color="#808080">][</font><font color="#FF0000">1</font><font color="#808080">]))
  </font><font color="#000080"><b>elif </b>sreg</font><font color="#808080">==</font><font color="#800000">'opVenda'</font><font color="#808080">:
    </font><font color="#000080">sRegistro</font><font color="#808080">=</font><font color="#000080">pesqArq</font><font color="#808080">(</font><font color="#000080">tf</font><font color="#808080">[</font><font color="#800000">'Livro'</font><font color="#808080">], </font><font color="#000080">tVenda</font><font color="#808080">[</font><font color="#800000">'isbn'</font><font color="#808080">], </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">13</font><font color="#808080">, </font><font color="#000080">tamReg</font><font color="#808080">(</font><font color="#800000">'opLivro'</font><font color="#808080">))
    </font><font color="#000080"><b>if </b>sRegistro</font><font color="#808080">!=</font><font color="#800000">''</font><font color="#808080">:
      </font><font color="#000080"><b>print </b></font><font color="#800000">' '</font><font color="#808080">+</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#800000">'opLivro'</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">), <i># Titulo 
      </i></font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#000080">copy</font><font color="#808080">(</font><font color="#000080">sRegistro</font><font color="#808080">, </font><font color="#000080">g_nPosChave</font><font color="#808080">[</font><font color="#800000">'opLivro'</font><font color="#808080">][</font><font color="#FF0000">1</font><font color="#808080">], </font><font color="#000080">g_nTamChave</font><font color="#808080">[</font><font color="#800000">'opLivro'</font><font color="#808080">][</font><font color="#FF0000">1</font><font color="#808080">]))
      </font><font color="#000080"><b>print </b></font><font color="#800000">' '</font><font color="#808080">+</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#800000">'opLivro'</font><font color="#808080">, </font><font color="#FF0000">9</font><font color="#808080">), <i># Preco 
      </i></font><font color="#000080">sPreco</font><font color="#808080">=</font><font color="#000080">copy</font><font color="#808080">(</font><font color="#000080">sRegistro</font><font color="#808080">, </font><font color="#000080">g_nPosChave</font><font color="#808080">[</font><font color="#800000">'opLivro'</font><font color="#808080">][</font><font color="#FF0000">8</font><font color="#808080">], </font><font color="#000080">g_nTamChave</font><font color="#808080">[</font><font color="#800000">'opLivro'</font><font color="#808080">][</font><font color="#FF0000">8</font><font color="#808080">])
      </font><font color="#000080">g_nPreco</font><font color="#808080">[</font><font color="#800000">'valor'</font><font color="#808080">] = </font><font color="#000080"><b>float</b></font><font color="#808080">(</font><font color="#000080">sPreco</font><font color="#808080">)
      </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#000080">sPreco</font><font color="#808080">)

<i>#------------------------------------------------------------------------------
# Realiza os cadastros dos arquivos que se ligam a outros arquivos.
# sreg - o tipo de arquivo
# sacao - a acao a ser realizada
# sCodigo - um das chaves do arquivo de ligacao
#------------------------------------------------------------------------------
</i></font><font color="#000080"><b>def </b>frmCadLigados</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#000080">sacao</font><font color="#808080">, </font><font color="#000080">sCodigo</font><font color="#808080">):
  </font><font color="#000080"><b>if </b>sacao</font><font color="#808080">==</font><font color="#800000">'opNovo'</font><font color="#808080">:
    </font><font color="#000080">nCont</font><font color="#808080">=</font><font color="#FF0000">1
    </font><font color="#000080"><b>if </b>sreg</font><font color="#808080">==</font><font color="#800000">'opLivroAss'</font><font color="#808080">:
      </font><font color="#000080">nQtd </font><font color="#808080">= </font><font color="#000080"><b>int</b></font><font color="#808080">(</font><font color="#000080">validaNumero</font><font color="#808080">(</font><font color="#800000">'Quantos assuntos quer cadastrar?: '</font><font color="#808080">,</font><font color="#800000">'0'</font><font color="#808080">))
      </font><font color="#000080">tf</font><font color="#808080">[</font><font color="#800000">'LivroAss'</font><font color="#808080">].</font><font color="#000080">seek</font><font color="#808080">(</font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#000080">SEEK_SET</font><font color="#808080">)
      </font><font color="#000080"><b>while </b>nCont </font><font color="#808080">&lt;= </font><font color="#000080">nQtd</font><font color="#808080">:
        </font><font color="#000080">tLivroAss</font><font color="#808080">[</font><font color="#800000">'isbn'</font><font color="#808080">]=</font><font color="#000080">sCodigo
        tLivroAss</font><font color="#808080">[</font><font color="#800000">'codassunto'</font><font color="#808080">] = </font><font color="#000080"><b>raw_input</b></font><font color="#808080">(</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#800000">'opLivroAss'</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">))      
        </font><font color="#000080">slinha</font><font color="#808080">=</font><font color="#000080">pesqArq</font><font color="#808080">(</font><font color="#000080">tf</font><font color="#808080">[</font><font color="#800000">'Assunto'</font><font color="#808080">], </font><font color="#000080">tLivroAss</font><font color="#808080">[</font><font color="#800000">'codassunto'</font><font color="#808080">],</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">,</font><font color="#000080">tamReg</font><font color="#808080">(</font><font color="#800000">'opAssunto'</font><font color="#808080">))
        </font><font color="#000080"><b>print </b></font><font color="#800000">' '</font><font color="#808080">+</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#800000">'opAssunto'</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">),
        </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#000080">copy</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#000080">g_nPosChave</font><font color="#808080">[</font><font color="#800000">'opAssunto'</font><font color="#808080">][</font><font color="#FF0000">1</font><font color="#808080">], </font><font color="#000080">g_nTamChave</font><font color="#808080">[</font><font color="#800000">'opAssunto'</font><font color="#808080">][</font><font color="#FF0000">1</font><font color="#808080">]))
        </font><font color="#000080">pesqLinhaExcluida</font><font color="#808080">(</font><font color="#000080">tf</font><font color="#808080">[</font><font color="#800000">'LivroAss'</font><font color="#808080">], </font><font color="#000080">tamReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">))
        </font><font color="#000080">subMenu</font><font color="#808080">(</font><font color="#FF0000">14</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">)
        </font><font color="#000080">nCont</font><font color="#808080">+=</font><font color="#FF0000">1
    </font><font color="#000080"><b>elif </b>sreg</font><font color="#808080">==</font><font color="#800000">'opLivroAut'</font><font color="#808080">:
      </font><font color="#000080">nQtd </font><font color="#808080">= </font><font color="#000080"><b>int</b></font><font color="#808080">(</font><font color="#000080">validaNumero</font><font color="#808080">(</font><font color="#800000">'Quantos autores quer cadastrar?: '</font><font color="#808080">,</font><font color="#800000">'0'</font><font color="#808080">))
      </font><font color="#000080">tf</font><font color="#808080">[</font><font color="#800000">'LivroAut'</font><font color="#808080">].</font><font color="#000080">seek</font><font color="#808080">(</font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#000080">SEEK_SET</font><font color="#808080">)
      </font><font color="#000080"><b>while </b>nCont </font><font color="#808080">&lt;= </font><font color="#000080">nQtd</font><font color="#808080">:
        </font><font color="#000080">tLivroAut</font><font color="#808080">[</font><font color="#800000">'isbn'</font><font color="#808080">]=</font><font color="#000080">sCodigo
        tLivroAut</font><font color="#808080">[</font><font color="#800000">'codautor'</font><font color="#808080">] = </font><font color="#000080"><b>raw_input</b></font><font color="#808080">(</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#800000">'opLivroAut'</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">))
        </font><font color="#000080">slinha</font><font color="#808080">=</font><font color="#000080">pesqArq</font><font color="#808080">(</font><font color="#000080">tf</font><font color="#808080">[</font><font color="#800000">'Autor'</font><font color="#808080">], </font><font color="#000080">tLivroAut</font><font color="#808080">[</font><font color="#800000">'codautor'</font><font color="#808080">],</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">,</font><font color="#000080">tamReg</font><font color="#808080">(</font><font color="#800000">'opAutor'</font><font color="#808080">))
        </font><font color="#000080"><b>print </b></font><font color="#800000">' '</font><font color="#808080">+</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#800000">'opAutor'</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">),
        </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#000080">copy</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#000080">g_nPosChave</font><font color="#808080">[</font><font color="#800000">'opAutor'</font><font color="#808080">][</font><font color="#FF0000">1</font><font color="#808080">], </font><font color="#000080">g_nTamChave</font><font color="#808080">[</font><font color="#800000">'opAutor'</font><font color="#808080">][</font><font color="#FF0000">1</font><font color="#808080">]))
        </font><font color="#000080">pesqLinhaExcluida</font><font color="#808080">(</font><font color="#000080">tf</font><font color="#808080">[</font><font color="#800000">'LivroAut'</font><font color="#808080">], </font><font color="#000080">tamReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">))
        </font><font color="#000080">subMenu</font><font color="#808080">(</font><font color="#FF0000">14</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">)
        </font><font color="#000080">nCont</font><font color="#808080">+=</font><font color="#FF0000">1
    </font><font color="#000080"><b>elif </b>sreg</font><font color="#808080">==</font><font color="#800000">'opVenda'</font><font color="#808080">:
      </font><font color="#000080">nQtd </font><font color="#808080">= </font><font color="#000080"><b>int</b></font><font color="#808080">(</font><font color="#000080">validaNumero</font><font color="#808080">(</font><font color="#800000">'Quantos livros quer vender?: '</font><font color="#808080">,</font><font color="#800000">'0'</font><font color="#808080">))
      </font><font color="#000080">nTotalPreco</font><font color="#808080">=</font><font color="#FF0000">0
      </font><font color="#000080"><b>while </b>nCont </font><font color="#808080">&lt;= </font><font color="#000080">nQtd</font><font color="#808080">:
        </font><font color="#000080">slinha</font><font color="#808080">=</font><font color="#000080">validaEntrada</font><font color="#808080">(</font><font color="#000080">tf</font><font color="#808080">[</font><font color="#800000">'Livro'</font><font color="#808080">],</font><font color="#800000">'opLivro'</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#000080">tVenda</font><font color="#808080">[</font><font color="#800000">'isbn'</font><font color="#808080">],</font><font color="#FF0000">3</font><font color="#808080">,</font><font color="#000080"><b>False</b></font><font color="#808080">,</font><font color="#800000">'opTexto'</font><font color="#808080">)
        </font><font color="#000080"><b>if </b>slinha</font><font color="#808080">!=</font><font color="#800000">''</font><font color="#808080">:
          </font><font color="#000080">tVenda</font><font color="#808080">[</font><font color="#800000">'isbn'</font><font color="#808080">]=</font><font color="#000080">string</font><font color="#808080">.</font><font color="#000080">strip</font><font color="#808080">(</font><font color="#000080">copy</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#FF0000">13</font><font color="#808080">))
          </font><font color="#000080"><b>if </b>validaISBN</font><font color="#808080">(</font><font color="#000080">tVenda</font><font color="#808080">[</font><font color="#800000">'isbn'</font><font color="#808080">]):
            </font><font color="#000080">mostrarDados</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#800000">''</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">)
            </font><font color="#000080">tLivro</font><font color="#808080">[</font><font color="#800000">'qtdestoque'</font><font color="#808080">]=</font><font color="#000080">string</font><font color="#808080">.</font><font color="#000080">strip</font><font color="#808080">(</font><font color="#000080">copy</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">,</font><font color="#FF0000">134</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">))
            </font><font color="#000080">nQtdEstoque </font><font color="#808080">= </font><font color="#000080"><b>int</b></font><font color="#808080">(</font><font color="#000080">tLivro</font><font color="#808080">[</font><font color="#800000">'qtdestoque'</font><font color="#808080">])
            </font><font color="#000080"><b>if </b>nQtdEstoque </font><font color="#808080">&gt; </font><font color="#FF0000">0</font><font color="#808080">:
               </font><font color="#000080">nTotalPreco</font><font color="#808080">=</font><font color="#000080">nTotalPreco </font><font color="#808080">+ </font><font color="#000080">g_nPreco</font><font color="#808080">[</font><font color="#800000">'valor'</font><font color="#808080">]
               </font><font color="#000080">sPreco </font><font color="#808080">= </font><font color="#000080"><b>str</b></font><font color="#808080">(</font><font color="#000080">g_nPreco</font><font color="#808080">[</font><font color="#800000">'valor'</font><font color="#808080">])
               </font><font color="#000080">tVenda</font><font color="#808080">[</font><font color="#800000">'precovenda'</font><font color="#808080">]=</font><font color="#000080">sPreco
               g_SalvarInclusao</font><font color="#808080">[</font><font color="#800000">'valor'</font><font color="#808080">]=</font><font color="#000080"><b>False
               </b>subMenu</font><font color="#808080">(</font><font color="#FF0000">14</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">)
               </font><font color="#000080"><b>if </b>g_SalvarInclusao</font><font color="#808080">[</font><font color="#800000">'valor'</font><font color="#808080">]:
                  </font><font color="#000080">slinha</font><font color="#808080">=</font><font color="#000080">pesqArq</font><font color="#808080">(</font><font color="#000080">tf</font><font color="#808080">[</font><font color="#800000">'Livro'</font><font color="#808080">], </font><font color="#000080">tVenda</font><font color="#808080">[</font><font color="#800000">'isbn'</font><font color="#808080">], </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">13</font><font color="#808080">, </font><font color="#000080">tamReg</font><font color="#808080">(</font><font color="#800000">'opLivro'</font><font color="#808080">))
                  </font><font color="#000080"><b>if </b>slinha</font><font color="#808080">!=</font><font color="#800000">''</font><font color="#808080">:
                     </font><font color="#000080">nQtdEstoque</font><font color="#808080">=</font><font color="#000080">nQtdEstoque</font><font color="#808080">-</font><font color="#FF0000">1
                     </font><font color="#000080">tLivro</font><font color="#808080">[</font><font color="#800000">'qtdestoque'</font><font color="#808080">] = </font><font color="#000080"><b>str</b></font><font color="#808080">(</font><font color="#000080">nQtdEstoque</font><font color="#808080">)
                     </font><font color="#000080">slinha</font><font color="#808080">=</font><font color="#000080">copy</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#FF0000">133</font><font color="#808080">)+</font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">tLivro</font><font color="#808080">[</font><font color="#800000">'qtdestoque'</font><font color="#808080">],</font><font color="#FF0000">10</font><font color="#808080">)
                     </font><font color="#000080">escreveArq</font><font color="#808080">(</font><font color="#000080">tf</font><font color="#808080">[</font><font color="#800000">'Livro'</font><font color="#808080">], </font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#800000">''</font><font color="#808080">, </font><font color="#800000">''</font><font color="#808080">)
               </font><font color="#000080">nCont</font><font color="#808080">+=</font><font color="#FF0000">1
            </font><font color="#000080"><b>else</b></font><font color="#808080">: </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#000080">MSG_SEMESTOQUE</font><font color="#808080">)
          </font><font color="#000080"><b>else</b></font><font color="#808080">: </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#000080">MSG_ISBNINV</font><font color="#808080">)
      </font><font color="#000080">sTotalPreco </font><font color="#808080">= </font><font color="#000080"><b>str</b></font><font color="#808080">(</font><font color="#000080">nTotalPreco</font><font color="#808080">)
      </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#800000">'Total de ' </font><font color="#808080">+ </font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">,</font><font color="#FF0000">4</font><font color="#808080">) + </font><font color="#000080">sTotalPreco</font><font color="#808080">)
  </font><font color="#000080"><b>elif </b>sacao</font><font color="#808080">==</font><font color="#800000">'opExcluir'</font><font color="#808080">:
    </font><font color="#000080"><b>if </b>sreg</font><font color="#808080">==</font><font color="#800000">'opLivroAss'</font><font color="#808080">:
       </font><font color="#000080">ExcluirRegLigados</font><font color="#808080">(</font><font color="#000080">tf</font><font color="#808080">[</font><font color="#800000">'LivroAss'</font><font color="#808080">], </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">13</font><font color="#808080">, </font><font color="#000080">sCodigo</font><font color="#808080">)
    </font><font color="#000080"><b>elif </b>sreg</font><font color="#808080">==</font><font color="#800000">'opLivroAut'</font><font color="#808080">:
       </font><font color="#000080">ExcluirRegLigados</font><font color="#808080">(</font><font color="#000080">tf</font><font color="#808080">[</font><font color="#800000">'LivroAut'</font><font color="#808080">], </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">13</font><font color="#808080">, </font><font color="#000080">sCodigo</font><font color="#808080">)

<i>#------------------------------------------------------------------------------
# Realiza a exclusao dos arquivos de ligacao.
# sArq - o arquivo de ligacao
# sreg - o tipo de arquivo de ligacao
# nPosChave - a posicao inicial da chave dentro do registro
# nTamChave - o tamanho da chave dentro do registro
# sChave - a chave a ser excluida
#------------------------------------------------------------------------------
</i></font><font color="#000080"><b>def </b>ExcluirRegLigados</font><font color="#808080">(</font><font color="#000080">sArq</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#000080">nPosChave</font><font color="#808080">, </font><font color="#000080">nTamChave</font><font color="#808080">, </font><font color="#000080">sChave</font><font color="#808080">):
  </font><font color="#000080">slinha</font><font color="#808080">=</font><font color="#800000">'0'
  </font><font color="#000080">sArq</font><font color="#808080">.</font><font color="#000080">seek</font><font color="#808080">(</font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#000080">SEEK_SET</font><font color="#808080">)
  </font><font color="#000080"><b>while </b>slinha</font><font color="#808080">!=</font><font color="#800000">''</font><font color="#808080">:
    </font><font color="#000080">slinha </font><font color="#808080">= </font><font color="#000080">sArq</font><font color="#808080">.</font><font color="#000080">readline</font><font color="#808080">()
    </font><font color="#000080">sCodigo</font><font color="#808080">=</font><font color="#000080">string</font><font color="#808080">.</font><font color="#000080">strip</font><font color="#808080">(</font><font color="#000080">copy</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">,</font><font color="#000080">nPosChave</font><font color="#808080">,</font><font color="#000080">nTamChave</font><font color="#808080">))
    </font><font color="#000080"><b>if </b>sCodigo</font><font color="#808080">==</font><font color="#000080">sChave</font><font color="#808080">:
       </font><font color="#000080">btnAcao</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">,</font><font color="#800000">'opConfirmaExclusao'</font><font color="#808080">)

<i>#------------------------------------------------------------------------------
# Parte inicial do codigo
#------------------------------------------------------------------------------
</i></font><font color="#000080"><b>def </b>main</font><font color="#808080">():     
  </font><font color="#000080"><b>if </b></font><font color="#808080">(</font><font color="#000080"><b>len</b></font><font color="#808080">(</font><font color="#000080">sys</font><font color="#808080">.</font><font color="#000080">argv</font><font color="#808080">) &gt; </font><font color="#FF0000">1</font><font color="#808080">) </font><font color="#000080"><b>and </b></font><font color="#808080">(</font><font color="#000080">sys</font><font color="#808080">.</font><font color="#000080">argv</font><font color="#808080">[</font><font color="#FF0000">1</font><font color="#808080">]==</font><font color="#800000">'-cria'</font><font color="#808080">):
    </font><font color="#000080">abrecriaArqs</font><font color="#808080">(</font><font color="#000080"><b>False</b></font><font color="#808080">)
  </font><font color="#000080"><b>else</b></font><font color="#808080">:
    </font><font color="#000080">frmSplash</font><font color="#808080">()
    </font><font color="#000080">abrecriaArqs</font><font color="#808080">(</font><font color="#000080"><b>True</b></font><font color="#808080">)
    </font><font color="#000080"><b>if </b>frmLogin</font><font color="#808080">():
     </font><font color="#000080">bopcao </font><font color="#808080">= </font><font color="#000080"><b>True
     while</b></font><font color="#808080">(</font><font color="#000080">bopcao</font><font color="#808080">):
       </font><font color="#000080">menu</font><font color="#808080">(</font><font color="#FF0000">1</font><font color="#808080">)
       </font><font color="#000080">opmenu </font><font color="#808080">= </font><font color="#000080"><b>raw_input</b></font><font color="#808080">()
       </font><font color="#000080"><b>if </b></font><font color="#808080">(</font><font color="#000080">opmenu</font><font color="#808080">==</font><font color="#800000">'C'</font><font color="#808080">) </font><font color="#000080"><b>or </b></font><font color="#808080">(</font><font color="#000080">opmenu</font><font color="#808080">==</font><font color="#800000">'c'</font><font color="#808080">): </font><font color="#000080">usaMenu</font><font color="#808080">(</font><font color="#FF0000">1</font><font color="#808080">)
       </font><font color="#000080"><b>elif </b></font><font color="#808080">(</font><font color="#000080">opmenu</font><font color="#808080">==</font><font color="#800000">'P'</font><font color="#808080">) </font><font color="#000080"><b>or </b></font><font color="#808080">(</font><font color="#000080">opmenu</font><font color="#808080">==</font><font color="#800000">'p'</font><font color="#808080">): </font><font color="#000080">usaMenu</font><font color="#808080">(</font><font color="#FF0000">2</font><font color="#808080">)
       </font><font color="#000080"><b>elif </b></font><font color="#808080">(</font><font color="#000080">opmenu</font><font color="#808080">==</font><font color="#800000">'V'</font><font color="#808080">) </font><font color="#000080"><b>or </b></font><font color="#808080">(</font><font color="#000080">opmenu</font><font color="#808080">==</font><font color="#800000">'v'</font><font color="#808080">): </font><font color="#000080">usaMenu</font><font color="#808080">(</font><font color="#FF0000">3</font><font color="#808080">)
       </font><font color="#000080"><b>elif </b></font><font color="#808080">(</font><font color="#000080">opmenu</font><font color="#808080">==</font><font color="#800000">'O'</font><font color="#808080">) </font><font color="#000080"><b>or </b></font><font color="#808080">(</font><font color="#000080">opmenu</font><font color="#808080">==</font><font color="#800000">'o'</font><font color="#808080">): </font><font color="#000080">usaMenu</font><font color="#808080">(</font><font color="#FF0000">4</font><font color="#808080">)
       </font><font color="#000080"><b>else</b></font><font color="#808080">: </font><font color="#000080"><b>print</b></font><font color="#808080">(</font><font color="#000080">MSG_ERRO</font><font color="#808080">)
    </font><font color="#000080"><b>else</b></font><font color="#808080">:
     </font><font color="#000080">fechaArqs</font><font color="#808080">()
     </font><font color="#000080">sys</font><font color="#808080">.</font><font color="#000080">exit</font><font color="#808080">()

</font><font color="#000080"><b>if </b></font><b>__name__ </b><font color="#808080">== </font><font color="#800000">'__main__'</font><font color="#808080">:
    </font><font color="#000080">main</font><font color="#808080">()
</font></font>
</code></pre>
</body>
</html>