<html>
<head>
<title>Livrus Virtus - Console - Lua</title>
</head>
<!-- Generated by ConTEXT HTML exporter -->
<body text="#000000" bgcolor="#FFFFFF">
<pre>
<code><font  face="Courier New"><font color="#008080">-------------------------------------------------------------------------------
-- Sistema integrante do projeto Livrus Virtus.
-- Todos os direitos reservados para Henrique F. de Souza. 
-- Vers&atilde;o programada na linguagem Lua.
-------------------------------------------------------------------------------
-- programa Livrus

</font>tAssunto <font color="#808080">= { </font>codigo <font color="#808080">= </font><font color="#008000">&quot;&quot;</font><font color="#808080">, </font>assunto <font color="#808080">= </font><font color="#008000">&quot;&quot; </font><font color="#808080">}
</font>tAutor <font color="#808080">= { </font>codigo <font color="#808080">= </font><font color="#008000">&quot;&quot;</font><font color="#808080">, </font>autor <font color="#808080">= </font><font color="#008000">&quot;&quot; </font><font color="#808080">}
</font>tEditora <font color="#808080">= { </font>codigo <font color="#808080">= </font><font color="#008000">&quot;&quot;</font><font color="#808080">,  </font>editora <font color="#808080">= </font><font color="#008000">&quot;&quot; </font><font color="#808080">}
</font>tIdioma <font color="#808080">= { </font>codigo <font color="#808080">= </font><font color="#008000">&quot;&quot;</font><font color="#808080">, </font>idioma <font color="#808080">= </font><font color="#008000">&quot;&quot; </font><font color="#808080">}
</font>tUsuario <font color="#808080">= { </font>login <font color="#808080">= </font><font color="#008000">&quot;&quot;</font><font color="#808080">, </font>senha <font color="#808080">= </font><font color="#008000">&quot;&quot; </font><font color="#808080">}
</font>tPais <font color="#808080">= { </font>codigo <font color="#808080">= </font><font color="#008000">&quot;&quot;</font><font color="#808080">, </font>pais <font color="#808080">= </font><font color="#008000">&quot;&quot; </font><font color="#808080">}
</font>tProfissao <font color="#808080">= { </font>codigo <font color="#808080">= </font><font color="#008000">&quot;&quot;</font><font color="#808080">, </font>profissao <font color="#808080">= </font><font color="#008000">&quot;&quot; </font><font color="#808080">}
</font>tLivro <font color="#808080">= { </font>isbn <font color="#808080">= </font><font color="#008000">&quot;&quot;</font><font color="#808080">, </font>titulo <font color="#808080">= </font><font color="#008000">&quot;&quot;</font><font color="#808080">, </font>edicao <font color="#808080">= </font><font color="#008000">&quot;&quot;</font><font color="#808080">, </font>anopubli <font color="#808080">= </font><font color="#008000">&quot;&quot;</font><font color="#808080">, 
 </font>codeditora <font color="#808080">= </font><font color="#008000">&quot;&quot;</font><font color="#808080">, </font>volume <font color="#808080">= </font><font color="#008000">&quot;&quot;</font><font color="#808080">, </font>codidioma <font color="#808080">= </font><font color="#008000">&quot;&quot;</font><font color="#808080">, </font>npaginas <font color="#808080">= </font><font color="#008000">&quot;&quot;</font><font color="#808080">, 
 </font>preco <font color="#808080">= </font><font color="#008000">&quot;&quot;</font><font color="#808080">, </font>qtdestoque <font color="#808080">= </font><font color="#008000">&quot;&quot; </font><font color="#808080">}
</font>tLivroAss <font color="#808080">= { </font>isbn <font color="#808080">= </font><font color="#008000">&quot;&quot;</font><font color="#808080">, </font>codassunto <font color="#808080">= </font><font color="#008000">&quot;&quot; </font><font color="#808080">}
</font>tLivroAut <font color="#808080">= { </font>isbn <font color="#808080">= </font><font color="#008000">&quot;&quot;</font><font color="#808080">, </font>codautor <font color="#808080">= </font><font color="#008000">&quot;&quot; </font><font color="#808080">}
</font>tCliente <font color="#808080">= { </font>cpf <font color="#808080">= </font><font color="#008000">&quot;&quot;</font><font color="#808080">, </font>nome <font color="#808080">= </font><font color="#008000">&quot;&quot;</font><font color="#808080">, </font>email <font color="#808080">= </font><font color="#008000">&quot;&quot;</font><font color="#808080">, </font>identidade <font color="#808080">= </font><font color="#008000">&quot;&quot;</font><font color="#808080">, </font>sexo <font color="#808080">= </font><font color="#008000">&quot;&quot;</font><font color="#808080">,
 </font>telefone <font color="#808080">= </font><font color="#008000">&quot;&quot;</font><font color="#808080">, </font>dtnascimento <font color="#808080">= </font><font color="#008000">&quot;&quot;</font><font color="#808080">, </font>codendereco <font color="#808080">= </font><font color="#008000">&quot;&quot;</font><font color="#808080">, </font>codpais <font color="#808080">= </font><font color="#008000">&quot;&quot;</font><font color="#808080">,
 </font>codprofissao <font color="#808080">= </font><font color="#008000">&quot;&quot; </font><font color="#808080">}
</font>tEndereco <font color="#808080">= { </font>codigo <font color="#808080">= </font><font color="#008000">&quot;&quot;</font><font color="#808080">, </font>logradouro <font color="#808080">= </font><font color="#008000">&quot;&quot;</font><font color="#808080">, </font>bairro <font color="#808080">= </font><font color="#008000">&quot;&quot;</font><font color="#808080">, </font>cep <font color="#808080">= </font><font color="#008000">&quot;&quot;</font><font color="#808080">,
 </font>cidade <font color="#808080">= </font><font color="#008000">&quot;&quot;</font><font color="#808080">, </font>estado <font color="#808080">= </font><font color="#008000">&quot;&quot; </font><font color="#808080">}
</font>tVenda <font color="#808080">= { </font>dthrvenda <font color="#808080">= </font><font color="#008000">&quot;&quot;</font><font color="#808080">, </font>cpf <font color="#808080">= </font><font color="#008000">&quot;&quot;</font><font color="#808080">, </font>isbn <font color="#808080">= </font><font color="#008000">&quot;&quot;</font><font color="#808080">, </font>precovenda <font color="#808080">= </font><font color="#008000">&quot;&quot; </font><font color="#808080">}

</font>ctTipo <font color="#808080">= { </font>opTexto<font color="#808080">, </font>opNumero<font color="#808080">, </font>opData<font color="#808080">, </font>opDataHora<font color="#808080">, </font>opSenha <font color="#808080">}
</font>ctArqs <font color="#808080">= { </font>opAssunto<font color="#808080">, </font>opAutor<font color="#808080">, </font>opEditora<font color="#808080">, </font>opEndereco<font color="#808080">, </font>opIdioma<font color="#808080">, </font>opPais<font color="#808080">,
              </font>opProfissao<font color="#808080">, </font>opCliente<font color="#808080">, </font>opLivro<font color="#808080">, </font>opLivroAss<font color="#808080">, </font>opLivroAut<font color="#808080">,
              </font>opUsuario<font color="#808080">, </font>opVenda <font color="#808080">}
</font>ctAcao <font color="#808080">= { </font>opNovo<font color="#808080">, </font>opAlterar<font color="#808080">, </font>opPesquisar<font color="#808080">, </font>opSalvarInclusao<font color="#808080">,
            </font>opSalvarAlteracao<font color="#808080">, </font>opExcluir<font color="#808080">, </font>opConfirmaExclusao<font color="#808080">, </font>opListarTodos <font color="#808080">}

</font>CRLF <font color="#808080">= '\</font>n<font color="#808080">' </font><font color="#008080">-- windows 
</font>TAM_CRLF <font color="#808080">= </font><font color="#FF0000">1
</font><font color="#008080">--  CRLF = '\n'
--  TAM_CRLF = 1  -- unix
--  CRLF = '\r'
--  TAM_CRLF = 1 -- macintosh

</font>ARQ_ABRE <font color="#808080">= '</font>r<font color="#808080">+'
</font>ARQ_CRIA <font color="#808080">= '</font>w<font color="#808080">'

</font>QTD_MAX_LINHA <font color="#808080">= </font><font color="#FF0000">18

</font>MSG_ERRO <font color="#808080">= '</font>Erro<font color="#808080">: </font>op<font color="#808080">&ccedil;&atilde;</font>o inv<font color="#808080">&aacute;</font>lida digite de novo<font color="#808080">'
</font>MSG_OPCAO <font color="#808080">= '</font>Escolha uma op<font color="#808080">&ccedil;&atilde;</font>o<font color="#808080">: '
</font>MSG_PRESS <font color="#808080">= '</font>pressione para continuar...<font color="#808080">'

</font>MSG_REGINC <font color="#808080">= '</font>registro incluido<font color="#808080">!'
</font>MSG_REGNINC <font color="#808080">= '</font>registro n<font color="#808080">&atilde;</font>o incluido<font color="#808080">!'
</font>MSG_REGALT <font color="#808080">= '</font>registro alterado<font color="#808080">!'
</font>MSG_REGNALT <font color="#808080">= '</font>registro n<font color="#808080">&atilde;</font>o alterado<font color="#808080">!'
</font>MSG_REGEXC <font color="#808080">= '</font>registro excluido<font color="#808080">!'
</font>MSG_REGNEXC <font color="#808080">= '</font>registro n<font color="#808080">&atilde;</font>o excluido<font color="#808080">!'
</font>MSG_REGEXST <font color="#808080">= '</font>registro j<font color="#808080">&aacute; </font>existe<font color="#808080">!'

</font>MSG_NUMINV <font color="#808080">= '</font>N<font color="#808080">&uacute;</font>mero inv<font color="#808080">&aacute;</font>lido ou menor <font color="#0000FF">do </font>que <font color="#FF0000">1</font><font color="#808080">!'
</font>MSG_DATAINV <font color="#808080">= '</font>Data inv<font color="#808080">&aacute;</font>lida<font color="#808080">!, </font>formato correto <font color="#808080">(</font>dd<font color="#808080">/</font>mm<font color="#808080">/</font>yyyy<font color="#808080">)'
</font>MSG_DTHRINV <font color="#808080">= '</font>Data<font color="#808080">/</font>hora inv<font color="#808080">&aacute;</font>lida<font color="#808080">!, </font>formato correto <font color="#808080">(</font>dd<font color="#808080">/</font>mm<font color="#808080">/</font>yyyy hh<font color="#808080">:</font>mm<font color="#808080">:</font>ss<font color="#808080">)'
</font>MSG_ISBNINV <font color="#808080">= '</font>ISBN inv<font color="#808080">&aacute;</font>lido<font color="#808080">!'
</font>MSG_CPFINV <font color="#808080">= '</font>CPF inv<font color="#808080">&aacute;</font>lido<font color="#808080">!'
</font>MSG_SENCONFERE <font color="#808080">= '</font>senha n<font color="#808080">&atilde;</font>o confere com a senha atual<font color="#808080">!'
</font>MSG_SENCONFIRM <font color="#808080">= '</font>nova senha n<font color="#808080">&atilde;</font>o confere com a senha confirmada<font color="#808080">!'
</font>MSG_LOGINENCON <font color="#808080">= '</font>login n<font color="#808080">&atilde;</font>o encontrado<font color="#808080">!'
</font>MSG_SEMESTOQUE <font color="#808080">= '</font>livro n<font color="#808080">&atilde;</font>o existe no estoque<font color="#808080">!'

</font>ARQ_ASSUNTO <font color="#808080">= '</font>assunto.dat<font color="#808080">'
</font>ARQ_AUTOR <font color="#808080">= '</font>autor.dat<font color="#808080">'
</font>ARQ_EDITORA <font color="#808080">= '</font>editora.dat<font color="#808080">'
</font>ARQ_IDIOMA <font color="#808080">= '</font>idioma.dat<font color="#808080">'
</font>ARQ_USUARIO <font color="#808080">= '</font>usuario.dat<font color="#808080">'
</font>ARQ_PAIS <font color="#808080">= '</font>pais.dat<font color="#808080">'
</font>ARQ_PROFISSAO <font color="#808080">= '</font>profissao.dat<font color="#808080">'
</font>ARQ_LIVRO <font color="#808080">= '</font>livro.dat<font color="#808080">'
</font>ARQ_LIVASS <font color="#808080">= '</font>livroass.dat<font color="#808080">'
</font>ARQ_LIVAUT <font color="#808080">= '</font>livroaut.dat<font color="#808080">'
</font>ARQ_CLIENTE <font color="#808080">= '</font>cliente.dat<font color="#808080">'
</font>ARQ_ENDERECO <font color="#808080">= '</font>endereco.dat<font color="#808080">'
</font>ARQ_VENDA <font color="#808080">= '</font>venda.dat<font color="#808080">'

</font>TAM_ASSUNTO <font color="#808080">= </font><font color="#FF0000">40
</font>TAM_AUTOR <font color="#808080">= </font><font color="#FF0000">40
</font>TAM_EDITORA <font color="#808080">= </font><font color="#FF0000">60
</font>TAM_IDIOMA <font color="#808080">= </font><font color="#FF0000">30
</font>TAM_USUARIO <font color="#808080">= </font><font color="#FF0000">20
</font>TAM_PAIS <font color="#808080">= </font><font color="#FF0000">53
</font>TAM_PROFISSAO <font color="#808080">= </font><font color="#FF0000">60
</font>TAM_LIVRO <font color="#808080">= </font><font color="#FF0000">143
</font>TAM_LIVASS <font color="#808080">= </font><font color="#FF0000">23
</font>TAM_LIVAUT <font color="#808080">= </font><font color="#FF0000">23
</font>TAM_CLIENTE <font color="#808080">= </font><font color="#FF0000">135
</font>TAM_ENDERECO <font color="#808080">= </font><font color="#FF0000">123
</font>TAM_VENDA <font color="#808080">= </font><font color="#FF0000">56

</font>bopcao <font color="#808080">= </font><font color="#0000FF">false
</font>opmenu <font color="#808080">= ''
</font>g_nPosChave<font color="#808080">, </font>g_nTamChave <font color="#808080">= </font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#FF0000">0
</font>g_nPreco <font color="#808080">= </font><font color="#FF0000">0</font>.0
g_SalvarInclusao <font color="#808080">= </font><font color="#0000FF">false

</font><font color="#008080">-- tfAssunto, tfAutor, tfEditora, tfIdioma, tfEndereco, tfPais, tfProfissao,
-- tfLivro, tfLivroAss, tfLivroAut, tfCliente, tfUsuario, tfVenda: File

-- Rotinas b&aacute;sicas -----------------------------------------------------------

------------------------------------------------------------------------------
-- Mostra saida de dados formatada pela tela.
------------------------------------------------------------------------------
-- printf(&quot;Hello %s from %s on %s\n&quot;,os.getenv&quot;USER&quot; or &quot;there&quot;,_VERSION,os.date())
</font><font color="#0000FF">function </font>printf<font color="#808080">(</font>...<font color="#808080">)
 </font>io.write<font color="#808080">(</font>string.format<font color="#808080">(</font>unpack<font color="#808080">(</font>arg<font color="#808080">)))
</font><font color="#0000FF">end

</font><font color="#008080">------------------------------------------------------------------------------
-- Informa dados pela tela.
-- retorna os caracteres digitados.
------------------------------------------------------------------------------
</font><font color="#0000FF">function </font>digita<font color="#808080">()
  </font><font color="#0000FF">for </font>slinha <font color="#0000FF">in </font>io.lines<font color="#808080">() </font><font color="#0000FF">do 
    return </font>slinha
  <font color="#0000FF">end
end

</font><font color="#008080">-------------------------------------------------------------------------------
-- Retira os espa&ccedil;os em branco antes ou depois do texto.
-- sTexto - o texto a ser retirado os espa&ccedil;os em branco
-- retorna - o texto sem os espa&ccedil;os em branco
-------------------------------------------------------------------------------
</font><font color="#0000FF">function </font>trim<font color="#808080">(</font>sTexto<font color="#808080">)
  </font>nposini <font color="#808080">= </font>string.find<font color="#808080">(</font>sTexto<font color="#808080">,'</font>%a<font color="#808080">',</font><font color="#FF0000">1</font><font color="#808080">)
  </font><font color="#0000FF">if </font>nposini<font color="#808080">~=</font><font color="#0000FF">nil then
     </font>slocal <font color="#808080">= </font>string.sub<font color="#808080">(</font>sTexto<font color="#808080">,</font>nposini<font color="#808080">,</font>nposini<font color="#808080">+</font>string.len<font color="#808080">(</font>sTexto<font color="#808080">)-</font><font color="#FF0000">1</font><font color="#808080">)  
  </font><font color="#0000FF">else
     </font>slocal <font color="#808080">= </font>sTexto
     nposini <font color="#808080">= </font><font color="#FF0000">1
  </font><font color="#0000FF">end

  </font>nposfim <font color="#808080">= </font>string.find<font color="#808080">(</font>slocal<font color="#808080">,'</font>%s<font color="#808080">',</font><font color="#FF0000">1</font><font color="#808080">)
  </font><font color="#0000FF">if </font>nposfim<font color="#808080">~=</font><font color="#0000FF">nil then
     return </font>string.sub<font color="#808080">(</font>slocal<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font>nposfim<font color="#808080">-</font><font color="#FF0000">1</font><font color="#808080">)
  </font><font color="#0000FF">else
     return </font>string.sub<font color="#808080">(</font>slocal<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font>string.len<font color="#808080">(</font>slocal<font color="#808080">))
  </font><font color="#0000FF">end
end

</font><font color="#008080">-------------------------------------------------------------------------------
-- Coloca espa&ccedil;os em branco a mais de acordo com o tamanho m&aacute;ximo do texto.
-- sTexto - o texto
-- nTam - tamanho m&aacute;ximo do texto
-- retorna - o texto com espa&ccedil;os em branco a mais
-------------------------------------------------------------------------------
</font><font color="#0000FF">function </font>esp<font color="#808080">(</font>sTexto<font color="#808080">, </font>nTam<font color="#808080">)
  </font><font color="#0000FF">return </font>sTexto..string.rep<font color="#808080">(' ',</font>nTam<font color="#808080">-</font>string.len<font color="#808080">(</font>sTexto<font color="#808080">))
</font><font color="#0000FF">end

</font><font color="#008080">-------------------------------------------------------------------------------
-- Faz uma pesquisa relativa de um texto atrav&eacute;s de um valor chave.
-- sTexto - o texto
-- sChave - a chave a ser pesquisada
-- retorna - se achou ou n&atilde;o a chave dentro do texto
-------------------------------------------------------------------------------
</font><font color="#0000FF">function </font>strRelativa<font color="#808080">(</font>sTexto<font color="#808080">, </font>sChave<font color="#808080">)
  </font><font color="#0000FF">if </font>string.find<font color="#808080">(</font>sTexto<font color="#808080">,</font>sChave<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#0000FF">true</font><font color="#808080">)~=</font><font color="#0000FF">nil then
    return true
  else
    return false
  end
end

</font><font color="#008080">-------------------------------------------------------------------------------
-- Funcao que retorna um pedaco de uma string.
-- stexto - indica a string
-- nini - indica a posicao inicial do pedaco
-- ntam - indica o tamanho do pedaco
-- retorna - o pedaco da string
-------------------------------------------------------------------------------
</font><font color="#0000FF">function </font>copy<font color="#808080">(</font>stexto<font color="#808080">, </font>nini<font color="#808080">, </font>ntam<font color="#808080">)
  </font><font color="#0000FF">if </font>stexto<font color="#808080">~=</font><font color="#0000FF">nil then
     return </font>string.sub<font color="#808080">(</font>stexto<font color="#808080">, </font>nini<font color="#808080">, </font>nini<font color="#808080">+</font>ntam<font color="#808080">-</font><font color="#FF0000">1</font><font color="#808080">)
  </font><font color="#0000FF">else
     return </font><font color="#808080">''
  </font><font color="#0000FF">end
end

</font><font color="#008080">-------------------------------------------------------------------------------
-- Calcula o modulo11 de um valor qualquer.
-- svalor - a mstring com o n&uacute;mero a ser calculado
-- ndig - d&iacute;gito do valor a ser calculado
-- retorna - o d&iacute;gito correto
-------------------------------------------------------------------------------
</font><font color="#0000FF">function </font>modulo11<font color="#808080">(</font>svalor<font color="#808080">, </font>ndig<font color="#808080">)
 </font>ncont<font color="#808080">=</font><font color="#FF0000">1
 </font>slocal<font color="#808080">='' 
 </font>sres<font color="#808080">=''
 </font><font color="#0000FF">while </font><font color="#808080">(</font>ncont <font color="#808080">&lt;= </font><font color="#FF0000">11</font><font color="#808080">) </font><font color="#0000FF">do
   </font>slocal<font color="#808080">=</font>copy<font color="#808080">(</font>svalor<font color="#808080">,</font>ncont<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">) </font>.. slocal
   ncont<font color="#808080">=</font>ncont<font color="#808080">+</font><font color="#FF0000">1
 </font><font color="#0000FF">end
 </font>nsoma<font color="#808080">=</font><font color="#FF0000">0
 </font><font color="#0000FF">if </font>ndig<font color="#808080">==</font><font color="#FF0000">1 </font><font color="#0000FF">then
   </font>ncont<font color="#808080">=</font><font color="#FF0000">3
 </font><font color="#0000FF">else
   </font>ncont<font color="#808080">=</font><font color="#FF0000">2
 </font><font color="#0000FF">end
 </font>npos<font color="#808080">=</font><font color="#FF0000">2
 </font><font color="#0000FF">while </font><font color="#808080">(</font>ncont <font color="#808080">&lt;= </font><font color="#FF0000">11</font><font color="#808080">) </font><font color="#0000FF">do
   </font>sres <font color="#808080">= </font>copy<font color="#808080">(</font>slocal<font color="#808080">,</font>ncont<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">)
   </font>nvalor <font color="#808080">= </font>tonumber<font color="#808080">(</font>sres<font color="#808080">)
   </font>nsoma<font color="#808080">=</font>nsoma <font color="#808080">+ (</font>nvalor <font color="#808080">* </font>npos<font color="#808080">)
   </font>ncont<font color="#808080">=</font>ncont<font color="#808080">+</font><font color="#FF0000">1
   </font>npos<font color="#808080">=</font>npos<font color="#808080">+</font><font color="#FF0000">1
 </font><font color="#0000FF">end
 </font>nsoma<font color="#808080">=(</font><font color="#FF0000">11 </font><font color="#808080">- </font>math.mod<font color="#808080">(</font>nsoma<font color="#808080">, </font><font color="#FF0000">11</font><font color="#808080">))

 </font><font color="#0000FF">if </font>nsoma <font color="#808080">&gt; </font><font color="#FF0000">9 </font><font color="#0000FF">then
   return </font><font color="#FF0000">0
 </font><font color="#0000FF">else
   return </font>nsoma
 <font color="#0000FF">end
end
</font><font color="#008080">-------------------------------------------------------------------------------
-- Valida&ccedil;&atilde;o de um n&uacute;mero de CPF qualquer.
-- cpf - a mstring com o n&uacute;mero do CPF
-- retorna - se &eacute; valido ou n&atilde;o
-------------------------------------------------------------------------------
</font><font color="#0000FF">function </font>validaCPF<font color="#808080">(</font>cpf<font color="#808080">)
  </font><font color="#0000FF">if </font>string.len<font color="#808080">(</font>cpf<font color="#808080">)==</font><font color="#FF0000">14 </font><font color="#0000FF">then
    </font>scpf<font color="#808080">=</font>copy<font color="#808080">(</font>cpf<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#FF0000">3</font><font color="#808080">)</font>..copy<font color="#808080">(</font>cpf<font color="#808080">,</font><font color="#FF0000">5</font><font color="#808080">,</font><font color="#FF0000">3</font><font color="#808080">)</font>..copy<font color="#808080">(</font>cpf<font color="#808080">,</font><font color="#FF0000">9</font><font color="#808080">,</font><font color="#FF0000">3</font><font color="#808080">)</font>..copy<font color="#808080">(</font>cpf<font color="#808080">,</font><font color="#FF0000">13</font><font color="#808080">,</font><font color="#FF0000">2</font><font color="#808080">)
    </font>sres<font color="#808080">=</font>copy<font color="#808080">(</font>cpf<font color="#808080">,</font><font color="#FF0000">13</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">)
    </font>nvalor1 <font color="#808080">= </font>tonumber<font color="#808080">(</font>sres<font color="#808080">)
    </font>sres<font color="#808080">=</font>copy<font color="#808080">(</font>cpf<font color="#808080">,</font><font color="#FF0000">14</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">)
    </font>nvalor2 <font color="#808080">= </font>tonumber<font color="#808080">(</font>sres<font color="#808080">)
    </font><font color="#0000FF">if </font><font color="#808080">(</font>modulo11<font color="#808080">(</font>scpf<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">)==</font>nvalor1<font color="#808080">) </font><font color="#0000FF">and 
       </font><font color="#808080">(</font>modulo11<font color="#808080">(</font>scpf<font color="#808080">,</font><font color="#FF0000">2</font><font color="#808080">)==</font>nvalor2<font color="#808080">) </font><font color="#0000FF">then
      return true
    else
      return false
    end
  else
    return false
  end
end
</font><font color="#008080">-------------------------------------------------------------------------------
-- Valida&ccedil;&atilde;o de um n&uacute;mero ISBN qualquer.
-- isbn - a mstring com o n&uacute;mero do ISBN
-- retorna - se &eacute; valido ou n&atilde;o
-------------------------------------------------------------------------------
</font><font color="#0000FF">function </font>validaISBN<font color="#808080">(</font>isbn<font color="#808080">)
  </font><font color="#0000FF">if </font>string.len<font color="#808080">(</font>isbn<font color="#808080">)==</font><font color="#FF0000">13 </font><font color="#0000FF">then
    </font>sdigito <font color="#808080">= </font>copy<font color="#808080">(</font>isbn<font color="#808080">, </font>string.len<font color="#808080">(</font>isbn<font color="#808080">), </font><font color="#FF0000">1</font><font color="#808080">)
    </font>sisbn<font color="#808080">=''
    </font><font color="#0000FF">for </font>ncont <font color="#808080">= </font><font color="#FF0000">1</font><font color="#808080">, </font>string.len<font color="#808080">(</font>isbn<font color="#808080">)-</font><font color="#FF0000">1 </font><font color="#0000FF">do
      if </font>copy<font color="#808080">(</font>isbn<font color="#808080">,</font>ncont<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">)~='-' </font><font color="#0000FF">then
        </font>sisbn<font color="#808080">=</font>sisbn..copy<font color="#808080">(</font>isbn<font color="#808080">,</font>ncont<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">)
      </font><font color="#0000FF">end 
    end
    if </font>sdigito <font color="#808080">== '</font>X<font color="#808080">' </font><font color="#0000FF">then
      </font>nsoma <font color="#808080">= </font><font color="#FF0000">10
    </font><font color="#0000FF">else
      </font>nvalor <font color="#808080">= </font>tonumber<font color="#808080">(</font>sdigito<font color="#808080">)
      </font>nsoma <font color="#808080">= </font>nvalor
    <font color="#0000FF">end
    for </font>ncont <font color="#808080">= </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">9 </font><font color="#0000FF">do
      </font>snum<font color="#808080">=</font>copy<font color="#808080">(</font>sisbn<font color="#808080">, </font>ncont<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">)
      </font>nvalor <font color="#808080">= </font>tonumber<font color="#808080">(</font>snum<font color="#808080">)
      </font>nsoma<font color="#808080">=</font>nsoma <font color="#808080">+ (</font>nvalor <font color="#808080">* (</font><font color="#FF0000">11 </font><font color="#808080">- </font>ncont<font color="#808080">))
    </font><font color="#0000FF">end
    if </font>math.mod<font color="#808080">(</font>nsoma<font color="#808080">, </font><font color="#FF0000">11</font><font color="#808080">) == </font><font color="#FF0000">0 </font><font color="#0000FF">then
      return true
    else
      return false
    end
  else
    return false
  end
end
</font><font color="#008080">-------------------------------------------------------------------------------
-- Esconde a digita&ccedil;&atilde;o da senha
-- retorna - a senha digitada
-------------------------------------------------------------------------------
</font><font color="#0000FF">function </font>digitaSenha<font color="#808080">(</font>sRotulo<font color="#808080">, </font>nTamSenha<font color="#808080">)
</font>io.write<font color="#808080">(</font>sRotulo<font color="#808080">)
</font>sSenha <font color="#808080">= </font>digita<font color="#808080">()

</font><font color="#008080">--  ncont = 0
--  sSenha = ''
--  sLetra = '\0'
--  while (sLetra~='\r') and (ncont &lt; nTamSenha) do
--    sLetra=readkey
--    io.write('*')
--    sSenha = sSenha..sLetra
--    ncont=ncont+1
--  end
</font><font color="#0000FF">return </font>sSenha
<font color="#0000FF">end

</font><font color="#008080">-------------------------------------------------------------------------------
-- Valida&ccedil;&atilde;o de um n&uacute;mero qualquer.
-- sRotulo - o texto antes de se digitar o n&uacute;mero
-- sNumero - a mstring com o valor do n&uacute;mero
-- retorna - o sNumero
-------------------------------------------------------------------------------
</font><font color="#0000FF">function </font>validaNumero<font color="#808080">(</font>sRotulo<font color="#808080">, </font>sNumero<font color="#808080">)
</font>nStatus<font color="#808080">=-</font><font color="#FF0000">1
  </font><font color="#0000FF">while </font><font color="#808080">(</font>nStatus<font color="#808080">~=</font><font color="#FF0000">0</font><font color="#808080">) </font><font color="#0000FF">do
    </font>io.write<font color="#808080">(</font>sRotulo<font color="#808080">)
    </font>sNumero <font color="#808080">= </font>digita<font color="#808080">()
    </font>nnum <font color="#808080">= </font>tonumber<font color="#808080">(</font>sNumero<font color="#808080">)
    </font><font color="#0000FF">if </font>nnum <font color="#808080">== </font><font color="#0000FF">nil then
       </font>print<font color="#808080">(</font>MSG_NUMINV<font color="#808080">)
    </font><font color="#0000FF">elseif </font>nnum <font color="#808080">&lt; </font><font color="#FF0000">1 </font><font color="#0000FF">then
       </font>print<font color="#808080">(</font>MSG_NUMINV<font color="#808080">)
    </font><font color="#0000FF">else
       </font>nStatus <font color="#808080">= </font><font color="#FF0000">0
    </font><font color="#0000FF">end
  end
return </font>sNumero
<font color="#0000FF">end

</font><font color="#008080">-------------------------------------------------------------------------------
-- Valida&ccedil;&atilde;o de uma data ou data/hora qualquer.
-- sRotulo - o texto antes de se digitar a data/hora
-- sDataHora - a mstring com o valor da data/hora
-- bSoData - indica se vai validar somente uma data sem a hora
-- retorna - a sDataHora
-------------------------------------------------------------------------------
</font><font color="#0000FF">function </font>validaDataHora<font color="#808080">(</font>sRotulo<font color="#808080">, </font>sDataHora<font color="#808080">, </font>bSoData<font color="#808080">)
</font>bvalida<font color="#808080">=</font><font color="#0000FF">false
</font>bdatavalida<font color="#808080">=</font><font color="#0000FF">false
</font>bhoravalida<font color="#808080">=</font><font color="#0000FF">false
</font>nudiames<font color="#808080">=</font><font color="#FF0000">0
</font><font color="#0000FF">if </font>bSoData<font color="#808080">==</font><font color="#0000FF">true then </font>ntam<font color="#808080">=</font><font color="#FF0000">10
</font><font color="#0000FF">else </font>ntam<font color="#808080">=</font><font color="#FF0000">19 </font><font color="#0000FF">end
while </font>bvalida<font color="#808080">==</font><font color="#0000FF">false do
  </font>io.write<font color="#808080">(</font>sRotulo<font color="#808080">)
  </font>sDataHora <font color="#808080">= </font>digita<font color="#808080">()
  </font><font color="#0000FF">if </font>string.len<font color="#808080">(</font>sDataHora<font color="#808080">)==</font>ntam <font color="#0000FF">then
    </font>sdia<font color="#808080">=</font>copy<font color="#808080">(</font>sDataHora<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#FF0000">2</font><font color="#808080">)
    </font>ndia<font color="#808080">=</font>tonumber<font color="#808080">(</font>sdia<font color="#808080">)
    </font>smes<font color="#808080">=</font>copy<font color="#808080">(</font>sDataHora<font color="#808080">,</font><font color="#FF0000">4</font><font color="#808080">,</font><font color="#FF0000">2</font><font color="#808080">)
    </font>nmes<font color="#808080">=</font>tonumber<font color="#808080">(</font>smes<font color="#808080">)
    </font>sano<font color="#808080">=</font>copy<font color="#808080">(</font>sDataHora<font color="#808080">,</font><font color="#FF0000">7</font><font color="#808080">,</font><font color="#FF0000">4</font><font color="#808080">)
    </font>nano<font color="#808080">=</font>tonumber<font color="#808080">(</font>sano<font color="#808080">)
  
    </font><font color="#0000FF">if </font><font color="#808080">(</font>nano <font color="#808080">&gt;= </font><font color="#FF0000">1</font><font color="#808080">) </font><font color="#0000FF">and </font><font color="#808080">(</font>nano <font color="#808080">&lt;= </font><font color="#FF0000">9999</font><font color="#808080">) </font><font color="#0000FF">then
      if </font><font color="#808080">(</font>nmes <font color="#808080">&gt;= </font><font color="#FF0000">1</font><font color="#808080">) </font><font color="#0000FF">and </font><font color="#808080">(</font>nmes <font color="#808080">&lt;= </font><font color="#FF0000">31</font><font color="#808080">) </font><font color="#0000FF">then 
          if </font>nmes<font color="#808080">==</font><font color="#FF0000">1 </font><font color="#0000FF">or </font>nmes<font color="#808080">==</font><font color="#FF0000">3 </font><font color="#0000FF">or </font>nmes<font color="#808080">==</font><font color="#FF0000">5 </font><font color="#0000FF">or </font>nmes<font color="#808080">==</font><font color="#FF0000">7 </font><font color="#0000FF">or 
             </font>nmes<font color="#808080">==</font><font color="#FF0000">8 </font><font color="#0000FF">or </font>nmes<font color="#808080">==</font><font color="#FF0000">10 </font><font color="#0000FF">or </font>nmes<font color="#808080">==</font><font color="#FF0000">12 </font><font color="#0000FF">then 
             </font>nudiames<font color="#808080">=</font><font color="#FF0000">31
          </font><font color="#0000FF">elseif </font>nmes<font color="#808080">==</font><font color="#FF0000">2 </font><font color="#0000FF">then
               </font><font color="#008080">-- ano bissexto 
               </font><font color="#0000FF">if </font>math.mod<font color="#808080">(</font>nano<font color="#808080">, </font><font color="#FF0000">4</font><font color="#808080">)==</font><font color="#FF0000">0 </font><font color="#0000FF">then </font>nudiames<font color="#808080">=</font><font color="#FF0000">29
               </font><font color="#0000FF">else </font>nudiames<font color="#808080">=</font><font color="#FF0000">28 </font><font color="#0000FF">end
          elseif </font>nmes<font color="#808080">==</font><font color="#FF0000">4 </font><font color="#0000FF">or </font>nmes<font color="#808080">==</font><font color="#FF0000">6 </font><font color="#0000FF">or </font>nmes<font color="#808080">==</font><font color="#FF0000">9 </font><font color="#0000FF">or </font>nmes<font color="#808080">==</font><font color="#FF0000">11 </font><font color="#0000FF">then 
            </font>nudiames<font color="#808080">=</font><font color="#FF0000">30
          </font><font color="#0000FF">end
          if </font><font color="#808080">(</font>ndia <font color="#808080">&gt;=</font><font color="#FF0000">1</font><font color="#808080">) </font><font color="#0000FF">and </font><font color="#808080">(</font>ndia <font color="#808080">&lt;=</font>nudiames<font color="#808080">) </font><font color="#0000FF">then
             </font>bdatavalida <font color="#808080">= </font><font color="#0000FF">true
          end 
      end
    end
  
    if </font>bSoData<font color="#808080">==</font><font color="#0000FF">true then 
       if </font>bdatavalida<font color="#808080">==</font><font color="#0000FF">true then </font>bvalida<font color="#808080">=</font><font color="#0000FF">true
       else </font>print<font color="#808080">(</font>MSG_DATAINV<font color="#808080">) </font><font color="#0000FF">end
    else 
      if </font>bdatavalida<font color="#808080">==</font><font color="#0000FF">true then
          </font>shora<font color="#808080">=</font>copy<font color="#808080">(</font>sDataHora<font color="#808080">,</font><font color="#FF0000">12</font><font color="#808080">,</font><font color="#FF0000">2</font><font color="#808080">)
          </font>nhora <font color="#808080">= </font>tonumber<font color="#808080">(</font>shora<font color="#808080">)
          </font>smin<font color="#808080">=</font>copy<font color="#808080">(</font>sDataHora<font color="#808080">,</font><font color="#FF0000">15</font><font color="#808080">,</font><font color="#FF0000">2</font><font color="#808080">)
          </font>nmin<font color="#808080">=</font>tonumber<font color="#808080">(</font>smin<font color="#808080">)
          </font>sseg<font color="#808080">=</font>copy<font color="#808080">(</font>sDataHora<font color="#808080">,</font><font color="#FF0000">18</font><font color="#808080">,</font><font color="#FF0000">2</font><font color="#808080">)
          </font>nseg<font color="#808080">=</font>tonumber<font color="#808080">(</font>sseg<font color="#808080">)
  
          </font><font color="#0000FF">if </font><font color="#808080">(</font>nhora <font color="#808080">&gt;= </font><font color="#FF0000">0</font><font color="#808080">) </font><font color="#0000FF">and </font><font color="#808080">(</font>nhora <font color="#808080">&lt;= </font><font color="#FF0000">23</font><font color="#808080">) </font><font color="#0000FF">then
            if </font><font color="#808080">(</font>nmin <font color="#808080">&gt;= </font><font color="#FF0000">0</font><font color="#808080">) </font><font color="#0000FF">and </font><font color="#808080">(</font>nmin <font color="#808080">&lt;= </font><font color="#FF0000">59</font><font color="#808080">) </font><font color="#0000FF">then
              if </font><font color="#808080">(</font>nseg <font color="#808080">&gt;= </font><font color="#FF0000">0</font><font color="#808080">) </font><font color="#0000FF">and </font><font color="#808080">(</font>nseg <font color="#808080">&lt;= </font><font color="#FF0000">59</font><font color="#808080">) </font><font color="#0000FF">then
                 </font>bhoravalida<font color="#808080">=</font><font color="#0000FF">true
              end
            end
          end
      
          if </font>bhoravalida<font color="#808080">==</font><font color="#0000FF">true then </font>bvalida<font color="#808080">=</font><font color="#0000FF">true
          else </font>print<font color="#808080">(</font>MSG_DTHRINV<font color="#808080">) </font><font color="#0000FF">end
      else
        </font>print<font color="#808080">(</font>MSG_DTHRINV<font color="#808080">)
      </font><font color="#0000FF">end
    end
  else
    if </font>bSoData<font color="#808080">==</font><font color="#0000FF">true then </font>print<font color="#808080">(</font>MSG_DATAINV<font color="#808080">)
    </font><font color="#0000FF">else </font>print<font color="#808080">(</font>MSG_DTHRINV<font color="#808080">) </font><font color="#0000FF">end    
  end
end
return </font>sDataHora
<font color="#0000FF">end

</font><font color="#008080">-------------------------------------------------------------------------------
-- Retorna a Data e a hora do sistema.
-- retorna - a data e a hora
-------------------------------------------------------------------------------
</font><font color="#0000FF">function </font>retDataHora<font color="#808080">()
  </font><font color="#0000FF">return </font>os.date<font color="#808080">('</font>%d<font color="#808080">/</font>%m<font color="#808080">/</font>%Y %H<font color="#808080">:</font>%M<font color="#808080">:</font>%S<font color="#808080">')
</font><font color="#0000FF">end

</font><font color="#008080">-- Rotinas de manipulacao de arquivos ----------------------------------------

------------------------------------------------------------------------------
-- Calcula o tamanho do arquivo.
-- sArq - o arquivo
-- retorna - o tamanho do arquivo
------------------------------------------------------------------------------
</font><font color="#0000FF">function </font>tamArq<font color="#808080">(</font>sArq<font color="#808080">) 
  </font>ntam <font color="#808080">= </font>sArq<font color="#808080">:</font>seek<font color="#808080">('</font><font color="#0000FF">end</font><font color="#808080">')
  </font><font color="#0000FF">return </font>ntam
<font color="#0000FF">end

</font><font color="#008080">-------------------------------------------------------------------------------
-- Abre ou cria os arquivos do sistema.
-- bAbre - condi&ccedil;&atilde;o para abrir ou criar os arquivos do sistema
-------------------------------------------------------------------------------
</font><font color="#0000FF">function </font>abrecriaArqs<font color="#808080">(</font>bAbre<font color="#808080">)
  </font><font color="#0000FF">if </font>bAbre <font color="#0000FF">then
    </font>tfAssunto <font color="#808080">= </font>io.open<font color="#808080">(</font>ARQ_ASSUNTO<font color="#808080">, </font>ARQ_ABRE<font color="#808080">)
    </font>tfAutor <font color="#808080">= </font>io.open<font color="#808080">(</font>ARQ_AUTOR<font color="#808080">, </font>ARQ_ABRE<font color="#808080">)
    </font>tfEditora <font color="#808080">= </font>io.open<font color="#808080">(</font>ARQ_EDITORA<font color="#808080">, </font>ARQ_ABRE<font color="#808080">)
    </font>tfIdioma <font color="#808080">= </font>io.open<font color="#808080">(</font>ARQ_IDIOMA<font color="#808080">, </font>ARQ_ABRE<font color="#808080">)
    </font>tfEndereco <font color="#808080">= </font>io.open<font color="#808080">(</font>ARQ_ENDERECO<font color="#808080">, </font>ARQ_ABRE<font color="#808080">)
    </font>tfPais <font color="#808080">= </font>io.open<font color="#808080">(</font>ARQ_PAIS<font color="#808080">, </font>ARQ_ABRE<font color="#808080">)
    </font>tfProfissao <font color="#808080">= </font>io.open<font color="#808080">(</font>ARQ_PROFISSAO<font color="#808080">, </font>ARQ_ABRE<font color="#808080">)
    </font>tfLivro <font color="#808080">= </font>io.open<font color="#808080">(</font>ARQ_LIVRO<font color="#808080">, </font>ARQ_ABRE<font color="#808080">)
    </font>tfLivroAss <font color="#808080">= </font>io.open<font color="#808080">(</font>ARQ_LIVASS<font color="#808080">, </font>ARQ_ABRE<font color="#808080">)
    </font>tfLivroAut <font color="#808080">= </font>io.open<font color="#808080">(</font>ARQ_LIVAUT<font color="#808080">, </font>ARQ_ABRE<font color="#808080">)
    </font>tfCliente <font color="#808080">= </font>io.open<font color="#808080">(</font>ARQ_CLIENTE<font color="#808080">, </font>ARQ_ABRE<font color="#808080">)
    </font>tfUsuario <font color="#808080">= </font>io.open<font color="#808080">(</font>ARQ_USUARIO<font color="#808080">, </font>ARQ_ABRE<font color="#808080">)
    </font>tfVenda <font color="#808080">= </font>io.open<font color="#808080">(</font>ARQ_VENDA<font color="#808080">, </font>ARQ_ABRE<font color="#808080">)
  </font><font color="#0000FF">else
    </font>tfAssunto <font color="#808080">= </font>io.open<font color="#808080">(</font>ARQ_ASSUNTO<font color="#808080">, </font>ARQ_CRIA<font color="#808080">)
    </font>tfAutor <font color="#808080">= </font>io.open<font color="#808080">(</font>ARQ_AUTOR<font color="#808080">, </font>ARQ_CRIA<font color="#808080">)
    </font>tfEditora <font color="#808080">= </font>io.open<font color="#808080">(</font>ARQ_EDITORA<font color="#808080">, </font>ARQ_CRIA<font color="#808080">)
    </font>tfIdioma <font color="#808080">= </font>io.open<font color="#808080">(</font>ARQ_IDIOMA<font color="#808080">, </font>ARQ_CRIA<font color="#808080">)
    </font>tfEndereco <font color="#808080">= </font>io.open<font color="#808080">(</font>ARQ_ENDERECO<font color="#808080">, </font>ARQ_CRIA<font color="#808080">)
    </font>tfPais <font color="#808080">= </font>io.open<font color="#808080">(</font>ARQ_PAIS<font color="#808080">, </font>ARQ_CRIA<font color="#808080">)
    </font>tfProfissao <font color="#808080">= </font>io.open<font color="#808080">(</font>ARQ_PROFISSAO<font color="#808080">, </font>ARQ_CRIA<font color="#808080">)
    </font>tfLivro <font color="#808080">= </font>io.open<font color="#808080">(</font>ARQ_LIVRO<font color="#808080">, </font>ARQ_CRIA<font color="#808080">)
    </font>tfLivroAss <font color="#808080">= </font>io.open<font color="#808080">(</font>ARQ_LIVASS<font color="#808080">, </font>ARQ_CRIA<font color="#808080">)
    </font>tfLivroAut <font color="#808080">= </font>io.open<font color="#808080">(</font>ARQ_LIVAUT<font color="#808080">, </font>ARQ_CRIA<font color="#808080">)
    </font>tfCliente <font color="#808080">= </font>io.open<font color="#808080">(</font>ARQ_CLIENTE<font color="#808080">, </font>ARQ_CRIA<font color="#808080">)
    </font>tfUsuario <font color="#808080">= </font>io.open<font color="#808080">(</font>ARQ_USUARIO<font color="#808080">, </font>ARQ_CRIA<font color="#808080">)
    </font>tfVenda <font color="#808080">= </font>io.open<font color="#808080">(</font>ARQ_VENDA<font color="#808080">, </font>ARQ_CRIA<font color="#808080">)
  </font><font color="#0000FF">end
end
</font><font color="#008080">-------------------------------------------------------------------------------
-- Fecha todos os arquivos abertos.
-------------------------------------------------------------------------------
</font><font color="#0000FF">function </font>fechaArqs<font color="#808080">()
 </font>io.close<font color="#808080">(</font>tfAssunto<font color="#808080">)
 </font>io.close<font color="#808080">(</font>tfAutor<font color="#808080">)
 </font>io.close<font color="#808080">(</font>tfEditora<font color="#808080">)
 </font>io.close<font color="#808080">(</font>tfIdioma<font color="#808080">)
 </font>io.close<font color="#808080">(</font>tfEndereco<font color="#808080">)
 </font>io.close<font color="#808080">(</font>tfPais<font color="#808080">)
 </font>io.close<font color="#808080">(</font>tfProfissao<font color="#808080">)
 </font>io.close<font color="#808080">(</font>tfLivro<font color="#808080">)
 </font>io.close<font color="#808080">(</font>tfLivroAss<font color="#808080">)
 </font>io.close<font color="#808080">(</font>tfLivroAut<font color="#808080">)
 </font>io.close<font color="#808080">(</font>tfCliente<font color="#808080">)
 </font>io.close<font color="#808080">(</font>tfUsuario<font color="#808080">)
 </font>io.close<font color="#808080">(</font>tfVenda<font color="#808080">)
</font><font color="#0000FF">end

</font><font color="#008080">-------------------------------------------------------------------------------
-- Pesquisa um registro atrav&eacute;s de um valor chave num arquivo.
-- sArq - o arquivo
-- sChave - a chave a ser pesquisada
-- nPosChave - a posicao inicial da chave dentro do registro
-- nTamChave - o tamanho da chave dentro do registro
-- nTamLinha - o tamanho do registro
-- retorna - o registro pesquisado
-------------------------------------------------------------------------------
</font><font color="#0000FF">function </font>pesqArq<font color="#808080">(</font>sArq<font color="#808080">, </font>sChave<font color="#808080">, </font>nPosChave<font color="#808080">, </font>nTamChave<font color="#808080">, </font>nTamLinha<font color="#808080">)
  </font>sArq<font color="#808080">:</font>seek<font color="#808080">('</font>set<font color="#808080">')
  </font><font color="#0000FF">for </font>slinha <font color="#0000FF">in </font>sArq<font color="#808080">:</font>lines<font color="#808080">() </font><font color="#0000FF">do    
    </font>sres<font color="#808080">=</font>trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha<font color="#808080">,</font>nPosChave<font color="#808080">,</font>nTamChave<font color="#808080">))    
    </font><font color="#0000FF">if </font>sres<font color="#808080">==</font>sChave <font color="#0000FF">then
       </font>slocal <font color="#808080">= </font>slinha
       <font color="#0000FF">break
    end
  end
  </font>nPosicao<font color="#808080">=</font>sArq<font color="#808080">:</font>seek<font color="#808080">()-(</font>nTamLinha <font color="#808080">+ </font>TAM_CRLF<font color="#808080">)
  </font><font color="#0000FF">if </font>nPosicao <font color="#808080">&gt; </font><font color="#FF0000">0 </font><font color="#0000FF">then
     </font>sArq<font color="#808080">:</font>seek<font color="#808080">('</font>cur<font color="#808080">',</font>nPosicao<font color="#808080">)
  </font><font color="#0000FF">else
     </font>sArq<font color="#808080">:</font>seek<font color="#808080">('</font>set<font color="#808080">')
  </font><font color="#0000FF">end
  if </font>sres<font color="#808080">~=</font>sChave <font color="#0000FF">then
     return </font><font color="#808080">''
  </font><font color="#0000FF">else
     return </font>copy<font color="#808080">(</font>slocal<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font>nTamLinha<font color="#808080">)
  </font><font color="#0000FF">end
end

</font><font color="#008080">-------------------------------------------------------------------------------
-- Pesquisa se tem linha exclu&iacute;da sen&atilde;o vai para a &uacute;ltima linha do arquivo.
-- sArq - o arquivo
-- nTamLinha - o tamanho do registro
-------------------------------------------------------------------------------
</font><font color="#0000FF">function </font>pesqLinhaExcluida<font color="#808080">(</font>sArq<font color="#808080">, </font>nTamLinha<font color="#808080">)
  </font>sExcluido<font color="#808080">=</font>pesqArq<font color="#808080">(</font>sArq<font color="#808080">, '*', </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font>nTamLinha<font color="#808080">)
  </font><font color="#0000FF">if </font>sExcluido<font color="#808080">=='' </font><font color="#0000FF">then
     </font>sArq<font color="#808080">:</font>seek<font color="#808080">('</font><font color="#0000FF">end</font><font color="#808080">')
  </font><font color="#0000FF">end
end

</font><font color="#008080">-------------------------------------------------------------------------------
-- Pesquisa o maior c&oacute;digo num arquivo.
-- sArq - o arquivo
-- nPosChave - a posicao inicial da chave dentro do registro
-- nTamChave - o tamanho da chave dentro do registro
-- nTamLinha - o tamanho do registro
-- retorna - o maior c&oacute;digo
-------------------------------------------------------------------------------
</font><font color="#0000FF">function </font>pesqMaxCod<font color="#808080">(</font>sArq<font color="#808080">, </font>nPosChave<font color="#808080">, </font>nTamChave<font color="#808080">, </font>nTamLinha<font color="#808080">)
  </font>nMaior<font color="#808080">=</font><font color="#FF0000">0
  </font>sArq<font color="#808080">:</font>seek<font color="#808080">('</font>set<font color="#808080">')
  </font><font color="#0000FF">for </font>slinha <font color="#0000FF">in </font>sArq<font color="#808080">:</font>lines<font color="#808080">() </font><font color="#0000FF">do    
    </font>sres<font color="#808080">=</font>trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha<font color="#808080">,</font>nPosChave<font color="#808080">,</font>nTamChave<font color="#808080">))
    </font>nCod <font color="#808080">= </font>tonumber<font color="#808080">(</font>sres<font color="#808080">)
    </font><font color="#0000FF">if </font>nCod <font color="#808080">&gt; </font>nMaior <font color="#0000FF">then
       </font>nMaior <font color="#808080">= </font>nCod
    <font color="#0000FF">end
  end
  </font>pesqLinhaExcluida<font color="#808080">(</font>sArq<font color="#808080">, </font>nTamLinha<font color="#808080">)
  </font>sres <font color="#808080">= </font>tostring<font color="#808080">(</font>nMaior<font color="#808080">+</font><font color="#FF0000">1</font><font color="#808080">)
  </font><font color="#0000FF">return </font>sres
<font color="#0000FF">end
</font><font color="#008080">-------------------------------------------------------------------------------
-- Grava os registros num determinado arquivo.
-- sArq - o arquivo
-- sTexto - o registro a ser gravado
-- sMsgAcerto - a mensagem caso o registro foi gravado
-- sMsgErro - a mensagem caso o registro n&atilde;o foi gravado
-------------------------------------------------------------------------------
</font><font color="#0000FF">function </font>escreveArq<font color="#808080">(</font>sArq<font color="#808080">, </font>sTexto<font color="#808080">, </font>sMsgAcerto<font color="#808080">, </font>sMsgErro<font color="#808080">)
  </font>sTexto<font color="#808080">=</font>sTexto..CRLF
  sArq<font color="#808080">:</font>write<font color="#808080">(</font>sTexto<font color="#808080">)
  </font>print<font color="#808080">(</font>sMsgAcerto<font color="#808080">)
  </font><font color="#008080">-- else
  --   print(sMsgErro)
  -- end
</font><font color="#0000FF">end

</font><font color="#008080">-- Rotinas de implementa&ccedil;&atilde;o do sistema e de interface ------------------------

-------------------------------------------------------------------------------
-- Monta o tamanho do registro no arquivo de acordo com o tipo de arquivo.
-- sreg - o tipo de arquivo
-- retorna - o registro montado
-------------------------------------------------------------------------------
</font><font color="#0000FF">function </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">)
</font>slinha<font color="#808080">=''
</font><font color="#0000FF">if </font>sreg<font color="#808080">==[[</font>opAssunto<font color="#808080">]] </font><font color="#0000FF">then
   </font>slinha<font color="#808080">=</font>esp<font color="#808080">(</font>tAssunto.codigo<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">)</font>..esp<font color="#808080">(</font>tAssunto.assunto<font color="#808080">,</font><font color="#FF0000">30</font><font color="#808080">)
</font><font color="#0000FF">elseif </font>sreg<font color="#808080">==[[</font>opAutor<font color="#808080">]] </font><font color="#0000FF">then
   </font>slinha<font color="#808080">=</font>esp<font color="#808080">(</font>tAutor.codigo<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">)</font>..esp<font color="#808080">(</font>tAutor.autor<font color="#808080">,</font><font color="#FF0000">30</font><font color="#808080">)
</font><font color="#0000FF">elseif </font>sreg<font color="#808080">==[[</font>opEditora<font color="#808080">]] </font><font color="#0000FF">then
   </font>slinha<font color="#808080">=</font>esp<font color="#808080">(</font>tEditora.codigo<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">)</font>..esp<font color="#808080">(</font>tEditora.editora<font color="#808080">,</font><font color="#FF0000">50</font><font color="#808080">)
</font><font color="#0000FF">elseif </font>sreg<font color="#808080">==[[</font>opEndereco<font color="#808080">]] </font><font color="#0000FF">then
   </font>slinha<font color="#808080">=</font>esp<font color="#808080">(</font>tEndereco.codigo<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">)</font>..esp<font color="#808080">(</font>tEndereco.logradouro<font color="#808080">,</font><font color="#FF0000">40</font><font color="#808080">)</font>..
   esp<font color="#808080">(</font>tEndereco.bairro<font color="#808080">,</font><font color="#FF0000">15</font><font color="#808080">)</font>..esp<font color="#808080">(</font>tEndereco.cep<font color="#808080">,</font><font color="#FF0000">8</font><font color="#808080">)</font>..esp<font color="#808080">(</font>tEndereco.cidade<font color="#808080">,</font><font color="#FF0000">30</font><font color="#808080">)</font>..
   esp<font color="#808080">(</font>tEndereco.estado<font color="#808080">,</font><font color="#FF0000">20</font><font color="#808080">)
</font><font color="#0000FF">elseif </font>sreg<font color="#808080">==[[</font>opIdioma<font color="#808080">]] </font><font color="#0000FF">then
   </font>slinha<font color="#808080">=</font>esp<font color="#808080">(</font>tIdioma.codigo<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">)</font>..esp<font color="#808080">(</font>tIdioma.idioma<font color="#808080">,</font><font color="#FF0000">20</font><font color="#808080">)
</font><font color="#0000FF">elseif </font>sreg<font color="#808080">==[[</font>opPais<font color="#808080">]] </font><font color="#0000FF">then
   </font>slinha<font color="#808080">=</font>esp<font color="#808080">(</font>tPais.codigo<font color="#808080">,</font><font color="#FF0000">3</font><font color="#808080">)</font>..esp<font color="#808080">(</font>tPais.pais<font color="#808080">,</font><font color="#FF0000">50</font><font color="#808080">)
</font><font color="#0000FF">elseif </font>sreg<font color="#808080">==[[</font>opProfissao<font color="#808080">]] </font><font color="#0000FF">then
   </font>slinha<font color="#808080">=</font>esp<font color="#808080">(</font>tProfissao.codigo<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">)</font>..esp<font color="#808080">(</font>tProfissao.profissao<font color="#808080">,</font><font color="#FF0000">50</font><font color="#808080">)
</font><font color="#0000FF">elseif </font>sreg<font color="#808080">==[[</font>opUsuario<font color="#808080">]] </font><font color="#0000FF">then
   </font>slinha<font color="#808080">=</font>esp<font color="#808080">(</font>tUsuario.login<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">)</font>..esp<font color="#808080">(</font>tUsuario.senha<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">)
</font><font color="#0000FF">elseif </font>sreg<font color="#808080">==[[</font>opLivro<font color="#808080">]] </font><font color="#0000FF">then
   </font>slinha<font color="#808080">=</font>esp<font color="#808080">(</font>tLivro.isbn<font color="#808080">,</font><font color="#FF0000">13</font><font color="#808080">)</font>..esp<font color="#808080">(</font>tLivro.titulo<font color="#808080">,</font><font color="#FF0000">50</font><font color="#808080">)</font>..esp<font color="#808080">(</font>tLivro.edicao<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">)</font>..
   esp<font color="#808080">(</font>tLivro.anopubli<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">)</font>..esp<font color="#808080">(</font>tLivro.codeditora<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">)</font>..esp<font color="#808080">(</font>tLivro.volume<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">)</font>..
   esp<font color="#808080">(</font>tLivro.codidioma<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">)</font>..esp<font color="#808080">(</font>tLivro.npaginas<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">)</font>..esp<font color="#808080">(</font>tLivro.preco<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">)</font>..
   esp<font color="#808080">(</font>tLivro.qtdestoque<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">)
</font><font color="#0000FF">elseif </font>sreg<font color="#808080">==[[</font>opLivroAss<font color="#808080">]] </font><font color="#0000FF">then
   </font>slinha<font color="#808080">=</font>esp<font color="#808080">(</font>tLivroAss.isbn<font color="#808080">,</font><font color="#FF0000">13</font><font color="#808080">)</font>..esp<font color="#808080">(</font>tlivroAss.codassunto<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">)
</font><font color="#0000FF">elseif </font>sreg<font color="#808080">==[[</font>opLivroAut<font color="#808080">]] </font><font color="#0000FF">then
   </font>slinha<font color="#808080">=</font>esp<font color="#808080">(</font>tLivroAut.isbn<font color="#808080">,</font><font color="#FF0000">13</font><font color="#808080">)</font>..esp<font color="#808080">(</font>tlivroAut.codautor<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">)
</font><font color="#0000FF">elseif </font>sreg<font color="#808080">==[[</font>opCliente<font color="#808080">]] </font><font color="#0000FF">then
   </font>slinha<font color="#808080">=</font>esp<font color="#808080">(</font>tCliente.cpf<font color="#808080">,</font><font color="#FF0000">14</font><font color="#808080">)</font>..esp<font color="#808080">(</font>tCliente.nome<font color="#808080">,</font><font color="#FF0000">30</font><font color="#808080">)</font>..esp<font color="#808080">(</font>tCliente.email<font color="#808080">,</font><font color="#FF0000">30</font><font color="#808080">)</font>..
   esp<font color="#808080">(</font>tCliente.identidade<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">)</font>..esp<font color="#808080">(</font>tCliente.sexo<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">)</font>..esp<font color="#808080">(</font>tCliente.telefone<font color="#808080">,</font><font color="#FF0000">17</font><font color="#808080">)</font>..
   esp<font color="#808080">(</font>tCliente.dtnascimento<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">)</font>..esp<font color="#808080">(</font>tCliente.codendereco<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">)</font>..
   esp<font color="#808080">(</font>tCliente.codpais<font color="#808080">,</font><font color="#FF0000">3</font><font color="#808080">)</font>..esp<font color="#808080">(</font>tCliente.codprofissao<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">)
</font><font color="#0000FF">elseif </font>sreg<font color="#808080">==[[</font>opVenda<font color="#808080">]] </font><font color="#0000FF">then
   </font>slinha<font color="#808080">=</font>esp<font color="#808080">(</font>tVenda.dthrvenda<font color="#808080">,</font><font color="#FF0000">19</font><font color="#808080">)</font>..esp<font color="#808080">(</font>tVenda.cpf<font color="#808080">,</font><font color="#FF0000">14</font><font color="#808080">)</font>..esp<font color="#808080">(</font>tVenda.isbn<font color="#808080">,</font><font color="#FF0000">13</font><font color="#808080">)</font>..
   esp<font color="#808080">(</font>tVenda.precovenda<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">)
</font><font color="#0000FF">end
return </font>slinha
<font color="#0000FF">end
</font><font color="#008080">-------------------------------------------------------------------------------
-- Retorna o tamanho do registro no arquivo de acordo com o tipo de arquivo.
-- sreg - o tipo de arquivo
-- retorna - o tamanho do registro
-------------------------------------------------------------------------------
</font><font color="#0000FF">function </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">)
  </font>nret<font color="#808080">=</font><font color="#FF0000">0
  </font><font color="#0000FF">if </font>sreg<font color="#808080">==[[</font>opAssunto<font color="#808080">]] </font><font color="#0000FF">then </font>nret<font color="#808080">=</font>TAM_ASSUNTO
  <font color="#0000FF">elseif </font>sreg<font color="#808080">==[[</font>opAutor<font color="#808080">]] </font><font color="#0000FF">then </font>nret<font color="#808080">=</font>TAM_AUTOR
  <font color="#0000FF">elseif </font>sreg<font color="#808080">==[[</font>opEditora<font color="#808080">]] </font><font color="#0000FF">then </font>nret<font color="#808080">=</font>TAM_EDITORA
  <font color="#0000FF">elseif </font>sreg<font color="#808080">==[[</font>opEndereco<font color="#808080">]] </font><font color="#0000FF">then </font>nret<font color="#808080">=</font>TAM_ENDERECO
  <font color="#0000FF">elseif </font>sreg<font color="#808080">==[[</font>opIdioma<font color="#808080">]] </font><font color="#0000FF">then </font>nret<font color="#808080">=</font>TAM_IDIOMA
  <font color="#0000FF">elseif </font>sreg<font color="#808080">==[[</font>opPais<font color="#808080">]] </font><font color="#0000FF">then </font>nret<font color="#808080">=</font>TAM_PAIS
  <font color="#0000FF">elseif </font>sreg<font color="#808080">==[[</font>opProfissao<font color="#808080">]] </font><font color="#0000FF">then </font>nret<font color="#808080">=</font>TAM_PROFISSAO
  <font color="#0000FF">elseif </font>sreg<font color="#808080">==[[</font>opUsuario<font color="#808080">]] </font><font color="#0000FF">then </font>nret<font color="#808080">=</font>TAM_USUARIO
  <font color="#0000FF">elseif </font>sreg<font color="#808080">==[[</font>opLivro<font color="#808080">]] </font><font color="#0000FF">then </font>nret<font color="#808080">=</font>TAM_LIVRO
  <font color="#0000FF">elseif </font>sreg<font color="#808080">==[[</font>opLivroAss<font color="#808080">]] </font><font color="#0000FF">then </font>nret<font color="#808080">=</font>TAM_LIVASS
  <font color="#0000FF">elseif </font>sreg<font color="#808080">==[[</font>opLivroAut<font color="#808080">]] </font><font color="#0000FF">then </font>nret<font color="#808080">=</font>TAM_LIVAUT
  <font color="#0000FF">elseif </font>sreg<font color="#808080">==[[</font>opCliente<font color="#808080">]] </font><font color="#0000FF">then </font>nret<font color="#808080">=</font>TAM_CLIENTE
  <font color="#0000FF">elseif </font>sreg<font color="#808080">==[[</font>opVenda<font color="#808080">]] </font><font color="#0000FF">then </font>nret<font color="#808080">=</font>TAM_VENDA
  <font color="#0000FF">end
return </font>nret
<font color="#0000FF">end

</font><font color="#008080">-------------------------------------------------------------------------------
-- Seleciona o rotulo de cada campo de acordo com o tipo de arquivo.
-- sreg - o tipo de arquivo
-- nNum - indica qual rotulo ser&aacute; retornado
-- retorna - o rotulo
-------------------------------------------------------------------------------
</font><font color="#0000FF">function </font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font>nNum<font color="#808080">)
</font>sret<font color="#808080">=''
</font><font color="#0000FF">if </font>sreg<font color="#808080">==[[</font>opAssunto<font color="#808080">]] </font><font color="#0000FF">then
   if </font>nNum<font color="#808080">==</font><font color="#FF0000">0 </font><font color="#0000FF">then </font>sret<font color="#808080">='</font>Assunto<font color="#808080">(</font>s<font color="#808080">) </font>n<font color="#808080">&atilde;</font>o encontrado<font color="#808080">(</font>s<font color="#808080">)!'
   </font><font color="#0000FF">elseif </font>nNum<font color="#808080">==</font><font color="#FF0000">1 </font><font color="#0000FF">then
     </font>sret<font color="#808080">='</font>C<font color="#808080">&oacute;</font>digo <font color="#0000FF">do </font>assunto<font color="#808080">: '
     </font>g_nPosChave<font color="#808080">=</font><font color="#FF0000">1
     </font>g_nTamChave<font color="#808080">=</font><font color="#FF0000">10
   </font><font color="#0000FF">elseif </font>nNum<font color="#808080">==</font><font color="#FF0000">2 </font><font color="#0000FF">then
     </font>sret<font color="#808080">='</font>Assunto<font color="#808080">: '
     </font>g_nPosChave<font color="#808080">=</font><font color="#FF0000">11
     </font>g_nTamChave<font color="#808080">=</font><font color="#FF0000">30
   </font><font color="#0000FF">end
elseif </font>sreg<font color="#808080">==[[</font>opAutor<font color="#808080">]] </font><font color="#0000FF">then
   if </font>nNum<font color="#808080">==</font><font color="#FF0000">0 </font><font color="#0000FF">then </font>sret<font color="#808080">='</font>Autor<font color="#808080">(</font>es<font color="#808080">) </font>n<font color="#808080">&atilde;</font>o encontrado<font color="#808080">(</font>s<font color="#808080">)!'
   </font><font color="#0000FF">elseif </font>nNum<font color="#808080">==</font><font color="#FF0000">1 </font><font color="#0000FF">then
     </font>sret<font color="#808080">='</font>C<font color="#808080">&oacute;</font>digo <font color="#0000FF">do </font>autor<font color="#808080">: '
     </font>g_nPosChave<font color="#808080">=</font><font color="#FF0000">1
     </font>g_nTamChave<font color="#808080">=</font><font color="#FF0000">10
   </font><font color="#0000FF">elseif </font>nNum<font color="#808080">==</font><font color="#FF0000">2 </font><font color="#0000FF">then
     </font>sret<font color="#808080">='</font>Autor<font color="#808080">: '
     </font>g_nPosChave<font color="#808080">=</font><font color="#FF0000">11
     </font>g_nTamChave<font color="#808080">=</font><font color="#FF0000">30
   </font><font color="#0000FF">end
elseif </font>sreg<font color="#808080">==[[</font>opEditora<font color="#808080">]] </font><font color="#0000FF">then
   if </font>nNum<font color="#808080">==</font><font color="#FF0000">0 </font><font color="#0000FF">then </font>sret<font color="#808080">='</font>Editora<font color="#808080">(</font>s<font color="#808080">) </font>n<font color="#808080">&atilde;</font>o encontrada<font color="#808080">(</font>s<font color="#808080">)!'
   </font><font color="#0000FF">elseif </font>nNum<font color="#808080">==</font><font color="#FF0000">1 </font><font color="#0000FF">then
     </font>sret<font color="#808080">='</font>C<font color="#808080">&oacute;</font>digo da editora<font color="#808080">: '
     </font>g_nPosChave<font color="#808080">=</font><font color="#FF0000">1
     </font>g_nTamChave<font color="#808080">=</font><font color="#FF0000">10
   </font><font color="#0000FF">elseif </font>nNum<font color="#808080">==</font><font color="#FF0000">2 </font><font color="#0000FF">then
     </font>sret<font color="#808080">='</font>Editora<font color="#808080">: '
     </font>g_nPosChave<font color="#808080">=</font><font color="#FF0000">11
     </font>g_nTamChave<font color="#808080">=</font><font color="#FF0000">50
   </font><font color="#0000FF">end
elseif </font>sreg<font color="#808080">==[[</font>opEndereco<font color="#808080">]] </font><font color="#0000FF">then
   if </font>nNum<font color="#808080">==</font><font color="#FF0000">0 </font><font color="#0000FF">then </font>sret<font color="#808080">='</font>Endere<font color="#808080">&ccedil;</font>o<font color="#808080">(</font>s<font color="#808080">) </font>n<font color="#808080">&atilde;</font>o encontrado<font color="#808080">(</font>s<font color="#808080">)!'
   </font><font color="#0000FF">elseif </font>nNum<font color="#808080">==</font><font color="#FF0000">1 </font><font color="#0000FF">then
     </font>sret<font color="#808080">='</font>C<font color="#808080">&oacute;</font>digo <font color="#0000FF">do </font>endere<font color="#808080">&ccedil;</font>o<font color="#808080">: '
     </font>g_nPosChave<font color="#808080">=</font><font color="#FF0000">1
     </font>g_nTamChave<font color="#808080">=</font><font color="#FF0000">10
   </font><font color="#0000FF">elseif </font>nNum<font color="#808080">==</font><font color="#FF0000">2 </font><font color="#0000FF">then
     </font>sret<font color="#808080">='</font>Logradouro<font color="#808080">: '
     </font>g_nPosChave<font color="#808080">=</font><font color="#FF0000">11
     </font>g_nTamChave<font color="#808080">=</font><font color="#FF0000">40
   </font><font color="#0000FF">elseif </font>nNum<font color="#808080">==</font><font color="#FF0000">3 </font><font color="#0000FF">then
     </font>sret<font color="#808080">='</font>Bairro<font color="#808080">: '
     </font>g_nPosChave<font color="#808080">=</font><font color="#FF0000">51
     </font>g_nTamChave<font color="#808080">=</font><font color="#FF0000">15
   </font><font color="#0000FF">elseif </font>nNum<font color="#808080">==</font><font color="#FF0000">4 </font><font color="#0000FF">then
     </font>sret<font color="#808080">='</font>CEP<font color="#808080">: '
     </font>g_nPosChave<font color="#808080">=</font><font color="#FF0000">66
     </font>g_nTamChave<font color="#808080">=</font><font color="#FF0000">8
   </font><font color="#0000FF">elseif </font>nNum<font color="#808080">==</font><font color="#FF0000">5 </font><font color="#0000FF">then
     </font>sret<font color="#808080">='</font>Cidade<font color="#808080">: '
     </font>g_nPosChave<font color="#808080">=</font><font color="#FF0000">74
     </font>g_nTamChave<font color="#808080">=</font><font color="#FF0000">30
   </font><font color="#0000FF">elseif </font>nNum<font color="#808080">==</font><font color="#FF0000">6 </font><font color="#0000FF">then
     </font>sret<font color="#808080">='</font>Estado<font color="#808080">: '
     </font>g_nPosChave<font color="#808080">=</font><font color="#FF0000">104
     </font>g_nTamChave<font color="#808080">=</font><font color="#FF0000">20
   </font><font color="#0000FF">end
elseif </font>sreg<font color="#808080">==[[</font>opIdioma<font color="#808080">]] </font><font color="#0000FF">then
   if </font>nNum<font color="#808080">==</font><font color="#FF0000">0 </font><font color="#0000FF">then </font>sret<font color="#808080">='</font>Idioma<font color="#808080">(</font>s<font color="#808080">) </font>n<font color="#808080">&atilde;</font>o encontrado<font color="#808080">(</font>s<font color="#808080">)!'
   </font><font color="#0000FF">elseif </font>nNum<font color="#808080">==</font><font color="#FF0000">1 </font><font color="#0000FF">then
     </font>sret<font color="#808080">='</font>C<font color="#808080">&oacute;</font>digo <font color="#0000FF">do </font>idioma<font color="#808080">: '
     </font>g_nPosChave<font color="#808080">=</font><font color="#FF0000">1
     </font>g_nTamChave<font color="#808080">=</font><font color="#FF0000">10
   </font><font color="#0000FF">elseif </font>nNum<font color="#808080">==</font><font color="#FF0000">2 </font><font color="#0000FF">then
     </font>sret<font color="#808080">='</font>Idioma<font color="#808080">: '
     </font>g_nPosChave<font color="#808080">=</font><font color="#FF0000">11
     </font>g_nTamChave<font color="#808080">=</font><font color="#FF0000">20
   </font><font color="#0000FF">end
elseif </font>sreg<font color="#808080">==[[</font>opPais<font color="#808080">]] </font><font color="#0000FF">then
   if </font>nNum<font color="#808080">==</font><font color="#FF0000">0 </font><font color="#0000FF">then </font>sret<font color="#808080">='</font>Pa<font color="#808080">&iacute;</font>s<font color="#808080">(</font>es<font color="#808080">) </font>n<font color="#808080">&atilde;</font>o encontrado<font color="#808080">(</font>s<font color="#808080">)!'
   </font><font color="#0000FF">elseif </font>nNum<font color="#808080">==</font><font color="#FF0000">1 </font><font color="#0000FF">then
     </font>sret<font color="#808080">='</font>C<font color="#808080">&oacute;</font>digo <font color="#0000FF">do </font>pa<font color="#808080">&iacute;</font>s<font color="#808080">: '
     </font>g_nPosChave<font color="#808080">=</font><font color="#FF0000">1
     </font>g_nTamChave<font color="#808080">=</font><font color="#FF0000">3
   </font><font color="#0000FF">elseif </font>nNum<font color="#808080">==</font><font color="#FF0000">2 </font><font color="#0000FF">then
     </font>sret<font color="#808080">='</font>Pa<font color="#808080">&iacute;</font>s<font color="#808080">: '
     </font>g_nPosChave<font color="#808080">=</font><font color="#FF0000">4
     </font>g_nTamChave<font color="#808080">=</font><font color="#FF0000">50
   </font><font color="#0000FF">end
elseif </font>sreg<font color="#808080">==[[</font>opProfissao<font color="#808080">]] </font><font color="#0000FF">then
   if </font>nNum<font color="#808080">==</font><font color="#FF0000">0 </font><font color="#0000FF">then </font>sret<font color="#808080">='</font>Profiss<font color="#808080">&atilde;</font>o<font color="#808080">(</font>es<font color="#808080">) </font>n<font color="#808080">&atilde;</font>o encontrada<font color="#808080">(</font>s<font color="#808080">)!'
   </font><font color="#0000FF">elseif </font>nNum<font color="#808080">==</font><font color="#FF0000">1 </font><font color="#0000FF">then
     </font>sret<font color="#808080">='</font>C<font color="#808080">&oacute;</font>digo da profiss<font color="#808080">&atilde;</font>o<font color="#808080">: '
     </font>g_nPosChave<font color="#808080">=</font><font color="#FF0000">1
     </font>g_nTamChave<font color="#808080">=</font><font color="#FF0000">10
   </font><font color="#0000FF">elseif </font>nNum<font color="#808080">==</font><font color="#FF0000">2 </font><font color="#0000FF">then
     </font>sret<font color="#808080">='</font>Profiss<font color="#808080">&atilde;</font>o<font color="#808080">: '
     </font>g_nPosChave<font color="#808080">=</font><font color="#FF0000">11
     </font>g_nTamChave<font color="#808080">=</font><font color="#FF0000">50
   </font><font color="#0000FF">end
elseif </font>sreg<font color="#808080">==[[</font>opUsuario<font color="#808080">]] </font><font color="#0000FF">then
   if </font>nNum<font color="#808080">==</font><font color="#FF0000">0 </font><font color="#0000FF">then </font>sret<font color="#808080">='</font>login ou senha incorreta<font color="#808080">, </font>tente de novo<font color="#808080">!'
   </font><font color="#0000FF">elseif </font>nNum<font color="#808080">==</font><font color="#FF0000">1 </font><font color="#0000FF">then
     </font>sret<font color="#808080">='</font>Login<font color="#808080">: '
     </font>g_nPosChave<font color="#808080">=</font><font color="#FF0000">1
     </font>g_nTamChave<font color="#808080">=</font><font color="#FF0000">10
   </font><font color="#0000FF">elseif </font>nNum<font color="#808080">==</font><font color="#FF0000">2 </font><font color="#0000FF">then
     </font>sret<font color="#808080">='</font>Senha<font color="#808080">: '
     </font>g_nPosChave<font color="#808080">=</font><font color="#FF0000">11
     </font>g_nTamChave<font color="#808080">=</font><font color="#FF0000">10
   </font><font color="#0000FF">end
elseif </font>sreg<font color="#808080">==[[</font>opLivro<font color="#808080">]] </font><font color="#0000FF">then
   if </font>nNum<font color="#808080">==</font><font color="#FF0000">0 </font><font color="#0000FF">then </font>sret<font color="#808080">='</font>Livro<font color="#808080">(</font>s<font color="#808080">) </font>n<font color="#808080">&atilde;</font>o encontrado<font color="#808080">(</font>s<font color="#808080">)!'
   </font><font color="#0000FF">elseif </font>nNum<font color="#808080">==</font><font color="#FF0000">1 </font><font color="#0000FF">then
     </font>sret<font color="#808080">='</font>ISBN<font color="#808080">: '
     </font>g_nPosChave<font color="#808080">=</font><font color="#FF0000">1
     </font>g_nTamChave<font color="#808080">=</font><font color="#FF0000">13
   </font><font color="#0000FF">elseif </font>nNum<font color="#808080">==</font><font color="#FF0000">2 </font><font color="#0000FF">then
     </font>sret<font color="#808080">='</font>T<font color="#808080">&iacute;</font>tulo<font color="#808080">: '
     </font>g_nPosChave<font color="#808080">=</font><font color="#FF0000">14
     </font>g_nTamChave<font color="#808080">=</font><font color="#FF0000">50
   </font><font color="#0000FF">elseif </font>nNum<font color="#808080">==</font><font color="#FF0000">3 </font><font color="#0000FF">then
     </font>sret<font color="#808080">='</font>Edi<font color="#808080">&ccedil;&atilde;</font>o<font color="#808080">: '
     </font>g_nPosChave<font color="#808080">=</font><font color="#FF0000">64
     </font>g_nTamChave<font color="#808080">=</font><font color="#FF0000">10
   </font><font color="#0000FF">elseif </font>nNum<font color="#808080">==</font><font color="#FF0000">4 </font><font color="#0000FF">then
     </font>sret<font color="#808080">='</font>Ano de Publica<font color="#808080">&ccedil;&atilde;</font>o<font color="#808080">: '
     </font>g_nPosChave<font color="#808080">=</font><font color="#FF0000">74
     </font>g_nTamChave<font color="#808080">=</font><font color="#FF0000">10
   </font><font color="#0000FF">elseif </font>nNum<font color="#808080">==</font><font color="#FF0000">5 </font><font color="#0000FF">then
     </font>sret<font color="#808080">='</font>C<font color="#808080">&oacute;</font>digo da editora<font color="#808080">: '
     </font>g_nPosChave<font color="#808080">=</font><font color="#FF0000">84
     </font>g_nTamChave<font color="#808080">=</font><font color="#FF0000">10
   </font><font color="#0000FF">elseif </font>nNum<font color="#808080">==</font><font color="#FF0000">6 </font><font color="#0000FF">then
     </font>sret<font color="#808080">='</font>Volume<font color="#808080">: '
     </font>g_nPosChave<font color="#808080">=</font><font color="#FF0000">94
     </font>g_nTamChave<font color="#808080">=</font><font color="#FF0000">10
   </font><font color="#0000FF">elseif </font>nNum<font color="#808080">==</font><font color="#FF0000">7 </font><font color="#0000FF">then
     </font>sret<font color="#808080">='</font>C<font color="#808080">&oacute;</font>digo <font color="#0000FF">do </font>idioma<font color="#808080">: '
     </font>g_nPosChave<font color="#808080">=</font><font color="#FF0000">104
     </font>g_nTamChave<font color="#808080">=</font><font color="#FF0000">10
   </font><font color="#0000FF">elseif </font>nNum<font color="#808080">==</font><font color="#FF0000">8 </font><font color="#0000FF">then
     </font>sret<font color="#808080">='</font>N<font color="#808080">&uacute;</font>mero de p<font color="#808080">&aacute;</font>ginas<font color="#808080">: '
     </font>g_nPosChave<font color="#808080">=</font><font color="#FF0000">114
     </font>g_nTamChave<font color="#808080">=</font><font color="#FF0000">10
   </font><font color="#0000FF">elseif </font>nNum<font color="#808080">==</font><font color="#FF0000">9 </font><font color="#0000FF">then
     </font>sret<font color="#808080">='</font>Pre<font color="#808080">&ccedil;</font>o<font color="#808080">: '
     </font>g_nPosChave<font color="#808080">=</font><font color="#FF0000">124
     </font>g_nTamChave<font color="#808080">=</font><font color="#FF0000">10
   </font><font color="#0000FF">elseif </font>nNum<font color="#808080">==</font><font color="#FF0000">10 </font><font color="#0000FF">then
     </font>sret<font color="#808080">='</font>Qtd. Estoque<font color="#808080">: '
     </font>g_nPosChave<font color="#808080">=</font><font color="#FF0000">134
     </font>g_nTamChave<font color="#808080">=</font><font color="#FF0000">10
   </font><font color="#0000FF">end
elseif </font>sreg<font color="#808080">==[[</font>opLivroAss<font color="#808080">]] </font><font color="#0000FF">then
   if </font>nNum<font color="#808080">==</font><font color="#FF0000">0 </font><font color="#0000FF">then </font>sret<font color="#808080">='</font>Assunto<font color="#808080">(</font>s<font color="#808080">) </font>n<font color="#808080">&atilde;</font>o encontrado<font color="#808080">(</font>s<font color="#808080">)!'
   </font><font color="#0000FF">elseif </font>nNum<font color="#808080">==</font><font color="#FF0000">1 </font><font color="#0000FF">then
     </font>sret<font color="#808080">='</font>ISBN<font color="#808080">: '
     </font>g_nPosChave<font color="#808080">=</font><font color="#FF0000">1
     </font>g_nTamChave<font color="#808080">=</font><font color="#FF0000">13
   </font><font color="#0000FF">elseif </font>nNum<font color="#808080">==</font><font color="#FF0000">2 </font><font color="#0000FF">then
     </font>sret<font color="#808080">='</font>C<font color="#808080">&oacute;</font>digo <font color="#0000FF">do </font>assunto<font color="#808080">: '
     </font>g_nPosChave<font color="#808080">=</font><font color="#FF0000">14
     </font>g_nTamChave<font color="#808080">=</font><font color="#FF0000">10
   </font><font color="#0000FF">end
elseif </font>sreg<font color="#808080">==[[</font>opLivroAut<font color="#808080">]] </font><font color="#0000FF">then
   if </font>nNum<font color="#808080">==</font><font color="#FF0000">0 </font><font color="#0000FF">then </font>sret<font color="#808080">='</font>Autor<font color="#808080">(</font>s<font color="#808080">) </font>n<font color="#808080">&atilde;</font>o encontrado<font color="#808080">(</font>s<font color="#808080">)!'
   </font><font color="#0000FF">elseif </font>nNum<font color="#808080">==</font><font color="#FF0000">1 </font><font color="#0000FF">then
     </font>sret<font color="#808080">='</font>ISBN<font color="#808080">: '
     </font>g_nPosChave<font color="#808080">=</font><font color="#FF0000">1
     </font>g_nTamChave<font color="#808080">=</font><font color="#FF0000">13
   </font><font color="#0000FF">elseif </font>nNum<font color="#808080">==</font><font color="#FF0000">2 </font><font color="#0000FF">then
     </font>sret<font color="#808080">='</font>C<font color="#808080">&oacute;</font>digo <font color="#0000FF">do </font>autor<font color="#808080">: '
     </font>g_nPosChave<font color="#808080">=</font><font color="#FF0000">14
     </font>g_nTamChave<font color="#808080">=</font><font color="#FF0000">10
   </font><font color="#0000FF">end
elseif </font>sreg<font color="#808080">==[[</font>opCliente<font color="#808080">]] </font><font color="#0000FF">then
   if </font>nNum<font color="#808080">==</font><font color="#FF0000">0 </font><font color="#0000FF">then </font>sret<font color="#808080">='</font>Cliente<font color="#808080">(</font>s<font color="#808080">) </font>n<font color="#808080">&atilde;</font>o encontrado<font color="#808080">(</font>s<font color="#808080">)!'
   </font><font color="#0000FF">elseif </font>nNum<font color="#808080">==</font><font color="#FF0000">1 </font><font color="#0000FF">then
     </font>sret<font color="#808080">='</font>CPF<font color="#808080">: '
     </font>g_nPosChave<font color="#808080">=</font><font color="#FF0000">1
     </font>g_nTamChave<font color="#808080">=</font><font color="#FF0000">14
   </font><font color="#0000FF">elseif </font>nNum<font color="#808080">==</font><font color="#FF0000">2 </font><font color="#0000FF">then
     </font>sret<font color="#808080">='</font>Nome<font color="#808080">: '
     </font>g_nPosChave<font color="#808080">=</font><font color="#FF0000">15
     </font>g_nTamChave<font color="#808080">=</font><font color="#FF0000">30
   </font><font color="#0000FF">elseif </font>nNum<font color="#808080">==</font><font color="#FF0000">3 </font><font color="#0000FF">then
     </font>sret<font color="#808080">='</font>E<font color="#808080">-</font>mail<font color="#808080">: '
     </font>g_nPosChave<font color="#808080">=</font><font color="#FF0000">45
     </font>g_nTamChave<font color="#808080">=</font><font color="#FF0000">30
   </font><font color="#0000FF">elseif </font>nNum<font color="#808080">==</font><font color="#FF0000">4 </font><font color="#0000FF">then
     </font>sret<font color="#808080">='</font>Identidade<font color="#808080">: '
     </font>g_nPosChave<font color="#808080">=</font><font color="#FF0000">75
     </font>g_nTamChave<font color="#808080">=</font><font color="#FF0000">10
   </font><font color="#0000FF">elseif </font>nNum<font color="#808080">==</font><font color="#FF0000">5 </font><font color="#0000FF">then
     </font>sret<font color="#808080">='</font>Sexo<font color="#808080">: '
     </font>g_nPosChave<font color="#808080">=</font><font color="#FF0000">85
     </font>g_nTamChave<font color="#808080">=</font><font color="#FF0000">1
   </font><font color="#0000FF">elseif </font>nNum<font color="#808080">==</font><font color="#FF0000">6 </font><font color="#0000FF">then
     </font>sret<font color="#808080">='</font>Telefone<font color="#808080">: '
     </font>g_nPosChave<font color="#808080">=</font><font color="#FF0000">86
     </font>g_nTamChave<font color="#808080">=</font><font color="#FF0000">17
   </font><font color="#0000FF">elseif </font>nNum<font color="#808080">==</font><font color="#FF0000">7 </font><font color="#0000FF">then
     </font>sret<font color="#808080">='</font>Dt. Nascimento<font color="#808080">: '
     </font>g_nPosChave<font color="#808080">=</font><font color="#FF0000">103
     </font>g_nTamChave<font color="#808080">=</font><font color="#FF0000">10
   </font><font color="#0000FF">elseif </font>nNum<font color="#808080">==</font><font color="#FF0000">8 </font><font color="#0000FF">then
     </font>sret<font color="#808080">='</font>C<font color="#808080">&oacute;</font>digo <font color="#0000FF">do </font>endere<font color="#808080">&ccedil;</font>o<font color="#808080">: '
     </font>g_nPosChave<font color="#808080">=</font><font color="#FF0000">113
     </font>g_nTamChave<font color="#808080">=</font><font color="#FF0000">10
   </font><font color="#0000FF">elseif </font>nNum<font color="#808080">==</font><font color="#FF0000">9 </font><font color="#0000FF">then
     </font>sret<font color="#808080">='</font>C<font color="#808080">&oacute;</font>digo <font color="#0000FF">do </font>pa<font color="#808080">&iacute;</font>s<font color="#808080">: '
     </font>g_nPosChave<font color="#808080">=</font><font color="#FF0000">123
     </font>g_nTamChave<font color="#808080">=</font><font color="#FF0000">3
   </font><font color="#0000FF">elseif </font>nNum<font color="#808080">==</font><font color="#FF0000">10 </font><font color="#0000FF">then
     </font>sret<font color="#808080">='</font>C<font color="#808080">&oacute;</font>digo da Profiss<font color="#808080">&atilde;</font>o<font color="#808080">: '
     </font>g_nPosChave<font color="#808080">=</font><font color="#FF0000">126
     </font>g_nTamChave<font color="#808080">=</font><font color="#FF0000">10
   </font><font color="#0000FF">end
elseif </font>sreg<font color="#808080">==[[</font>opVenda<font color="#808080">]] </font><font color="#0000FF">then
   if </font>nNum<font color="#808080">==</font><font color="#FF0000">0 </font><font color="#0000FF">then </font>sret<font color="#808080">='</font>Venda<font color="#808080">(</font>s<font color="#808080">) </font>n<font color="#808080">&atilde;</font>o encontrada<font color="#808080">(</font>s<font color="#808080">)!'
   </font><font color="#0000FF">elseif </font>nNum<font color="#808080">==</font><font color="#FF0000">1 </font><font color="#0000FF">then
     </font>sret<font color="#808080">='</font>Data<font color="#808080">/</font>Hora venda<font color="#808080">: '
     </font>g_nPosChave<font color="#808080">=</font><font color="#FF0000">1
     </font>g_nTamChave<font color="#808080">=</font><font color="#FF0000">19
   </font><font color="#0000FF">elseif </font>nNum<font color="#808080">==</font><font color="#FF0000">2 </font><font color="#0000FF">then
     </font>sret<font color="#808080">='</font>CPF<font color="#808080">: '
     </font>g_nPosChave<font color="#808080">=</font><font color="#FF0000">20
     </font>g_nTamChave<font color="#808080">=</font><font color="#FF0000">14
   </font><font color="#0000FF">elseif </font>nNum<font color="#808080">==</font><font color="#FF0000">3 </font><font color="#0000FF">then
     </font>sret<font color="#808080">='</font>ISBN<font color="#808080">: '
     </font>g_nPosChave<font color="#808080">=</font><font color="#FF0000">34
     </font>g_nTamChave<font color="#808080">=</font><font color="#FF0000">13
   </font><font color="#0000FF">elseif </font>nNum<font color="#808080">==</font><font color="#FF0000">4 </font><font color="#0000FF">then
     </font>sret<font color="#808080">='</font>Pre<font color="#808080">&ccedil;</font>o de venda<font color="#808080">: '
     </font>g_nPosChave<font color="#808080">=</font><font color="#FF0000">47
     </font>g_nTamChave<font color="#808080">=</font><font color="#FF0000">10
   </font><font color="#0000FF">end
end

return </font>sret
<font color="#0000FF">end

</font><font color="#008080">-------------------------------------------------------------------------------
-- Indica se continua ou n&atilde;o mostrando um n&uacute;mero m&aacute;ximo de linhas.
-- nlinha - a linha a ser continuada
-- nQtdLinha - a quantidade de linhas a serem mostradas
-- retorna - se continua ou n&atilde;o
-------------------------------------------------------------------------------
</font><font color="#0000FF">function </font>ContinuaSN<font color="#808080">(</font>nlinha<font color="#808080">, </font>nQtdLinha<font color="#808080">)
</font>bret<font color="#808080">=</font><font color="#0000FF">false
if </font>nlinha <font color="#808080">&gt; </font><font color="#FF0000">0 </font><font color="#0000FF">then 
  if </font>math.mod<font color="#808080">(</font>nlinha<font color="#808080">, </font>nQtdLinha<font color="#808080">) == </font><font color="#FF0000">0 </font><font color="#0000FF">then
      </font>bSOp<font color="#808080">=</font><font color="#0000FF">true
      while </font><font color="#808080">(</font>bSOp<font color="#808080">==</font><font color="#0000FF">true</font><font color="#808080">) </font><font color="#0000FF">do
        </font>menu<font color="#808080">(</font><font color="#FF0000">13</font><font color="#808080">)
        </font>opCSubMenu <font color="#808080">= </font>digita<font color="#808080">()
        </font><font color="#0000FF">if </font><font color="#808080">(</font>opCSubMenu<font color="#808080">=='</font>S<font color="#808080">') </font><font color="#0000FF">or </font><font color="#808080">(</font>opCSubMenu<font color="#808080">=='</font>s<font color="#808080">') </font><font color="#0000FF">then </font>bSOp<font color="#808080">=</font><font color="#0000FF">false
        elseif </font><font color="#808080">(</font>opCSubMenu<font color="#808080">=='</font>N<font color="#808080">') </font><font color="#0000FF">or </font><font color="#808080">(</font>opCSubMenu<font color="#808080">=='</font>n<font color="#808080">') </font><font color="#0000FF">then
          </font>bret<font color="#808080">=</font><font color="#0000FF">true
          </font>bSOp<font color="#808080">=</font><font color="#0000FF">false
        else </font>print<font color="#808080">(</font>MSG_ERRO<font color="#808080">) </font><font color="#0000FF">end 
      end
  end
end

return </font>bret
<font color="#0000FF">end

</font><font color="#008080">-------------------------------------------------------------------------------
-- Lista v&aacute;rios registros de acordo com a pesquisa feita.
-- sArq - o arquivo
-- sreg - o tipo de arquivo
-- sChave - a chave a ser pesquisada
-- nPosChave - a posicao inicial da chave dentro do registro
-- nTamChave - o tamanho da chave dentro do registro
-- nTamLinha - o tamanho do registro
-- nQtdLinha - a quantidade de linhas a serem mostradas
-- retorna - se encontrou algum registro
-------------------------------------------------------------------------------
</font><font color="#0000FF">function </font>ListarTodos<font color="#808080">(</font>sArq<font color="#808080">, </font>sreg<font color="#808080">, </font>sChave<font color="#808080">, </font>nPosChave<font color="#808080">, </font>nTamChave<font color="#808080">, 
                     </font>nTamLinha<font color="#808080">, </font>nQtdLinha<font color="#808080">, </font>bPesqRelativa<font color="#808080">)
</font>bRet<font color="#808080">=</font><font color="#0000FF">false
</font>nCont<font color="#808080">=</font><font color="#FF0000">0
</font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, '', </font><font color="#FF0000">2</font><font color="#808080">)
</font>sArq<font color="#808080">:</font>seek<font color="#808080">('</font>set<font color="#808080">')
</font><font color="#0000FF">for </font>slinha <font color="#0000FF">in </font>sArq<font color="#808080">:</font>lines<font color="#808080">() </font><font color="#0000FF">do
  if </font>bPesqRelativa<font color="#808080">==</font><font color="#0000FF">true then
    </font>sres<font color="#808080">=</font>trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha<font color="#808080">,</font>nPosChave<font color="#808080">,</font>nTamChave<font color="#808080">))
    </font><font color="#0000FF">if </font>strRelativa<font color="#808080">(</font>sres<font color="#808080">,</font>sChave<font color="#808080">) </font><font color="#0000FF">then
       </font>bAchou<font color="#808080">=</font><font color="#0000FF">true
       </font>bRet<font color="#808080">=</font><font color="#0000FF">true
    else
       </font>bAchou<font color="#808080">=</font><font color="#0000FF">false
    end
  else
    </font>bAchou<font color="#808080">=</font><font color="#0000FF">true
    </font>bRet<font color="#808080">=</font><font color="#0000FF">true
  end

  if </font>bAchou <font color="#0000FF">then
    </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font>copy<font color="#808080">(</font>slinha<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font>nTamLinha<font color="#808080">), </font><font color="#FF0000">3</font><font color="#808080">)
    </font>nCont<font color="#808080">=</font>nCont<font color="#808080">+</font><font color="#FF0000">1
  </font><font color="#0000FF">end

  if </font>ContinuaSN<font color="#808080">(</font>nCont<font color="#808080">, </font>nQtdLinha<font color="#808080">) </font><font color="#0000FF">then
     break
  end
end
return </font>bRet
<font color="#0000FF">end

</font><font color="#008080">-------------------------------------------------------------------------------
-- Lista v&aacute;rios registros entre arquivos de acordo com a pesquisa feita.
-- sArq1 - o arquivo de liga&ccedil;&atilde;o
-- sreg1 - o tipo de arquivo de liga&ccedil;&atilde;o
-- nPosChave1 - a posicao inicial da primeira chave no arquivo de liga&ccedil;&atilde;o
-- nTamChave1 - o tamanho da primeira chave no arquivo de liga&ccedil;&atilde;o
-- nPosChave2 - a posicao inicial da segunda chave do arquivo de liga&ccedil;&atilde;o
-- nTamChave2 - o tamanho da segunda chave do arquivo de liga&ccedil;&atilde;o
-- sChave - a chave a ser pesquisada no arquivo de liga&ccedil;&atilde;o
-- sArq2 - o arquivo a ser pesquisado
-- sreg2 - o tipo de arquivo a ser pesquisado
-- nPosChave3 - a posicao inicial da chave do arquivo pesquisado
-- nQtdLinha - a quantidade de linhas a serem mostradas
-------------------------------------------------------------------------------
</font><font color="#0000FF">function </font>ListarRegLigados<font color="#808080">(</font>sArq1<font color="#808080">, </font>sreg1<font color="#808080">, </font>nPosChave1<font color="#808080">, </font>nTamChave1<font color="#808080">, 
</font>	 nPosChave2<font color="#808080">, </font>nTamChave2<font color="#808080">, </font>sChave<font color="#808080">, </font>sArq2<font color="#808080">, </font>sreg2<font color="#808080">, </font>nPosChave3<font color="#808080">, </font>nQtdLinha<font color="#808080">)
</font>bRet<font color="#808080">=</font><font color="#0000FF">false
</font>nCont<font color="#808080">=</font><font color="#FF0000">0
</font>mostrarDados<font color="#808080">(</font>sreg2<font color="#808080">, '', </font><font color="#FF0000">2</font><font color="#808080">)
</font>sArq1<font color="#808080">:</font>seek<font color="#808080">('</font>set<font color="#808080">')
  </font><font color="#0000FF">for </font>slinha1 <font color="#0000FF">in </font>sArq1<font color="#808080">:</font>lines<font color="#808080">() </font><font color="#0000FF">do
    </font>sCodigo1<font color="#808080">=</font>trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha1<font color="#808080">,</font>nPosChave1<font color="#808080">,</font>nTamChave1<font color="#808080">))
    </font><font color="#0000FF">if </font>sCodigo1<font color="#808080">==</font>sChave <font color="#0000FF">then
      </font>sCodigo2<font color="#808080">=</font>trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha1<font color="#808080">,</font>nPosChave2<font color="#808080">,</font>nTamChave2<font color="#808080">))
      </font>slinha2<font color="#808080">=</font>pesqArq<font color="#808080">(</font>sArq2<font color="#808080">, </font>sCodigo2<font color="#808080">, </font>nPosChave3<font color="#808080">, </font>nTamChave2<font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg2<font color="#808080">))
      </font>mostrarDados<font color="#808080">(</font>sreg2<font color="#808080">, </font>copy<font color="#808080">(</font>slinha2<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg2<font color="#808080">)), </font><font color="#FF0000">3</font><font color="#808080">)
      </font>bRet<font color="#808080">=</font><font color="#0000FF">true
      </font>nCont<font color="#808080">=</font>nCont<font color="#808080">+</font><font color="#FF0000">1
    </font><font color="#0000FF">end
    if </font>ContinuaSN<font color="#808080">(</font>nCont<font color="#808080">, </font>nQtdLinha<font color="#808080">) </font><font color="#0000FF">then
       break
    end
  end
  if </font>bRet<font color="#808080">==</font><font color="#0000FF">false then
     </font>print<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg2<font color="#808080">,</font><font color="#FF0000">0</font><font color="#808080">))
  </font><font color="#0000FF">end
end

</font><font color="#008080">-------------------------------------------------------------------------------
-- Valida a entrada de registros de acordo com a pesquisa feita.
-- sArq - o arquivo
-- sreg - o tipo de arquivo
-- nTexto - o numero do r&oacute;tulo da entrada
-- sEntrada - a chave a ser pesquisada e validada
-- nTentativas - o n&uacute;mero m&aacute;ximo de tentativas
-- bPesqRelativa - indica se vai realizar uma pesquisa relativa
-- bTipoEntrada - indica o tipo de entrada
-- retorna - o registro pesquisado e validado
-------------------------------------------------------------------------------
</font><font color="#0000FF">function </font>validaEntrada<font color="#808080">(</font>sArq<font color="#808080">, </font>sreg<font color="#808080">, </font>nTexto<font color="#808080">, </font>sEntrada<font color="#808080">, </font>nTentativas<font color="#808080">,
                       </font>bPesqRelativa<font color="#808080">, </font>bTipoEntrada<font color="#808080">)
</font>nTamLinha<font color="#808080">=</font>tamReg<font color="#808080">(</font>sreg<font color="#808080">)
</font>sMsgErro<font color="#808080">=</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">,</font><font color="#FF0000">0</font><font color="#808080">)
</font>sTexto<font color="#808080">=</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">,</font>nTexto<font color="#808080">)
</font>nPosChave<font color="#808080">=</font>g_nPosChave
nTamChave<font color="#808080">=</font>g_nTamChave

sres<font color="#808080">=''
</font>ncont<font color="#808080">=</font><font color="#FF0000">1
</font>bQuebra<font color="#808080">=</font><font color="#0000FF">false
  while </font><font color="#808080">(</font>bQuebra<font color="#808080">==</font><font color="#0000FF">false</font><font color="#808080">) </font><font color="#0000FF">and </font><font color="#808080">(</font>ncont <font color="#808080">&lt;= </font>nTentativas <font color="#808080">) </font><font color="#0000FF">do
    if </font>bTipoEntrada<font color="#808080">==[[</font>opTexto<font color="#808080">]] </font><font color="#0000FF">then
      </font>io.write<font color="#808080">(</font>sTexto<font color="#808080">)
      </font>sEntrada <font color="#808080">= </font>digita<font color="#808080">()
    </font><font color="#0000FF">elseif </font>bTipoEntrada<font color="#808080">==[[</font>opNumero<font color="#808080">]] </font><font color="#0000FF">then
       </font>sEntrada<font color="#808080">=</font>validaNumero<font color="#808080">(</font>sTexto<font color="#808080">,</font>sEntrada<font color="#808080">)
    </font><font color="#0000FF">elseif </font>bTipoEntrada<font color="#808080">==[[</font>opData<font color="#808080">]] </font><font color="#0000FF">then
       </font>sEntrada<font color="#808080">=</font>validaDataHora<font color="#808080">(</font>sTexto<font color="#808080">,</font>sEntrada<font color="#808080">,</font><font color="#0000FF">true</font><font color="#808080">)
    </font><font color="#0000FF">elseif </font>bTipoEntrada<font color="#808080">==[[</font>opDataHora<font color="#808080">]] </font><font color="#0000FF">then
       </font>sEntrada<font color="#808080">=</font>validaDataHora<font color="#808080">(</font>sTexto<font color="#808080">,</font>sEntrada<font color="#808080">,</font><font color="#0000FF">false</font><font color="#808080">)
    </font><font color="#0000FF">elseif </font>bTipoEntrada<font color="#808080">==[[</font>opSenha<font color="#808080">]] </font><font color="#0000FF">then
       </font>sEntrada<font color="#808080">=</font>digitaSenha<font color="#808080">(</font>sTexto<font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">)
    </font><font color="#0000FF">end

    if </font>bPesqRelativa<font color="#808080">==</font><font color="#0000FF">true then
       if </font>ListarTodos<font color="#808080">(</font>sArq<font color="#808080">, </font>sreg<font color="#808080">, </font>sEntrada<font color="#808080">, </font>nPosChave<font color="#808080">, </font>nTamChave<font color="#808080">, </font>nTamLinha<font color="#808080">,
       </font>QTD_MAX_LINHA<font color="#808080">, </font><font color="#0000FF">true</font><font color="#808080">)==</font><font color="#0000FF">true then
         </font>sres<font color="#808080">=' '
       </font><font color="#0000FF">end
    else
       </font>sres<font color="#808080">=</font>pesqArq<font color="#808080">(</font>sArq<font color="#808080">, </font>sEntrada<font color="#808080">, </font>nPosChave<font color="#808080">, </font>nTamChave<font color="#808080">, </font>nTamLinha<font color="#808080">)
    </font><font color="#0000FF">end
    if </font>sres<font color="#808080">=='' </font><font color="#0000FF">then
       </font>print<font color="#808080">(</font>sMsgErro<font color="#808080">)
    </font><font color="#0000FF">else
       </font>bQuebra<font color="#808080">=</font><font color="#0000FF">true
    end
    </font>ncont<font color="#808080">=</font>ncont<font color="#808080">+</font><font color="#FF0000">1
  </font><font color="#0000FF">end
return </font>sres
<font color="#0000FF">end

</font><font color="#008080">------------------------------------------------------------------------------
-- Mostra a tela de splash do sistema.
------------------------------------------------------------------------------
</font><font color="#0000FF">function </font>frmSplash<font color="#808080">()
 </font>print<font color="#808080">('*</font><font color="#008080">---------------------------------------' .. 
 </font><font color="#808080">'</font><font color="#008080">-------------------------------------*')
 </font>print<font color="#808080">('| </font>LL    II VV   VV RRRRR  UU  UU   SSSS <font color="#808080">' </font>..
 <font color="#808080">'</font>VV   VV II RRRRR  TTTT UU  UU   SSSS <font color="#808080">|')
 </font>print<font color="#808080">('| </font>LL    II  VV VV  RR   R UU  UU  SS    <font color="#808080">' </font>..
 <font color="#808080">' </font>VV VV  II RR   R  TT  UU  UU  SS    <font color="#808080">|')
 </font>print<font color="#808080">('| </font>LL    II   VVV   RRRRR  UU  UU    SS  <font color="#808080">' </font>..
 <font color="#808080">'  </font>VVV   II RRRRR   TT  UU  UU    SS  <font color="#808080">|')
 </font>print<font color="#808080">('| </font>LLLLL II    V    RR   R  UUUU  SSSS   <font color="#808080">' </font>..
 <font color="#808080">'   </font>V    II RR   R  TT   UUUU  SSSS   <font color="#808080">|')
 </font>print<font color="#808080">('*</font><font color="#008080">---------------------------------------' ..
 </font><font color="#808080">'</font><font color="#008080">-------------------------------------*')
 </font><font color="#0000FF">for </font>cont <font color="#808080">= </font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#FF0000">18 </font><font color="#0000FF">do </font>print<font color="#808080">('') </font><font color="#0000FF">end
 </font>io.write<font color="#808080">(</font>MSG_PRESS<font color="#808080">)
 </font>digita<font color="#808080">()
</font><font color="#0000FF">end

</font><font color="#008080">-------------------------------------------------------------------------------
-- Mostra a tela de sobre do sistema.
-------------------------------------------------------------------------------
</font><font color="#0000FF">function </font>frmSobre<font color="#808080">()
 </font>print<font color="#808080">('*</font><font color="#008080">------------------------------------------------------------*')
 </font>print<font color="#808080">('|  </font>LL        II  VV       VV  RRRRRRR   UU    UU   SSSSSSS   <font color="#808080">|')
 </font>print<font color="#808080">('|  </font>LL        II   VV     VV   RR     R  UU    UU  SS         <font color="#808080">|')
 </font>print<font color="#808080">('|  </font>LL        II    VV   VV    RR     R  UU    UU   SSSS      <font color="#808080">|')
 </font>print<font color="#808080">('|  </font>LL        II     VV VV     RRRRRRR   UU    UU     SSSS    <font color="#808080">|')
 </font>print<font color="#808080">('|  </font>LLLL      II      VVV      RR RR     UU    UU        SS   <font color="#808080">|')
 </font>print<font color="#808080">('|  </font>LLLLLLLL  II       V       RR   RR    UUUUUU   SSSSSSSS   <font color="#808080">|')
 </font>print<font color="#808080">('|                                                            |')
 </font>print<font color="#808080">('|  </font>VV       VV  II  RRRRRRR   TTTTTTTT  UU    UU   SSSSSSS   <font color="#808080">|')
 </font>print<font color="#808080">('|   </font>VV     VV   II  RR     R     TT     UU    UU  SS         <font color="#808080">|')
 </font>print<font color="#808080">('|    </font>VV   VV    II  RR     R     TT     UU    UU   SSSS      <font color="#808080">|')
 </font>print<font color="#808080">('|     </font>VV VV     II  RRRRRRR      TT     UU    UU     SSSS    <font color="#808080">|')
 </font>print<font color="#808080">('|      </font>VVV      II  RR RR        TT     UU    UU        SS   <font color="#808080">|')
 </font>print<font color="#808080">('|       </font>V       II  RR   RR      TT      UUUUUU   SSSSSSSS   <font color="#808080">|')
 </font>print<font color="#808080">('|                                                            |')
 </font>print<font color="#808080">('|                                               </font>Versao <font color="#FF0000">1</font>.0.0 <font color="#808080">|')
 </font>print<font color="#808080">('| </font>Sistema integrante <font color="#0000FF">do </font>projeto Livrus Virtus.               <font color="#808080">|')
 </font>print<font color="#808080">('| </font>Todos os direitos reservados para Henrique F. de Souza.    <font color="#808080">|')
 </font>print<font color="#808080">('| </font>Versao programada na linguagem lua.                        <font color="#808080">|')
 </font>print<font color="#808080">('*</font><font color="#008080">------------------------------------------------------------*')
 </font><font color="#0000FF">for </font>cont <font color="#808080">= </font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#FF0000">4 </font><font color="#0000FF">do </font>print<font color="#808080">('') </font><font color="#0000FF">end
 </font>io.write<font color="#808080">(</font>MSG_PRESS<font color="#808080">)
 </font>digita<font color="#808080">()
</font><font color="#0000FF">end

</font><font color="#008080">-------------------------------------------------------------------------------
-- Mostra a tela de login do sistema.
-- retorna - se o login foi validado corretamente
-------------------------------------------------------------------------------
</font><font color="#0000FF">function </font>frmLogin<font color="#808080">() 
  </font>bret<font color="#808080">=</font><font color="#0000FF">false
  </font>print<font color="#808080">('*</font><font color="#008080">--------------------------------------------------------------*')
  </font>print<font color="#808080">('| </font>Login <font color="#0000FF">do </font>sistema                                             <font color="#808080">|')
  </font>print<font color="#808080">('*</font><font color="#008080">--------------------------------------------------------------*')
  </font>slinha<font color="#808080">=</font>validaEntrada<font color="#808080">(</font>tfUsuario<font color="#808080">, [[</font>opUsuario<font color="#808080">]], </font><font color="#FF0000">1</font><font color="#808080">, </font>tUsuario.login<font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">,
        </font><font color="#0000FF">false</font><font color="#808080">, [[</font>opTexto<font color="#808080">]])
  </font><font color="#0000FF">if </font>slinha<font color="#808080">~='' </font><font color="#0000FF">then
     </font>slinha<font color="#808080">=</font>validaEntrada<font color="#808080">(</font>tfUsuario<font color="#808080">, [[</font>opUsuario<font color="#808080">]], </font><font color="#FF0000">2</font><font color="#808080">, </font>tUsuario.senha<font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">,
        </font><font color="#0000FF">false</font><font color="#808080">, [[</font>opSenha<font color="#808080">]])
     </font><font color="#0000FF">if </font>slinha<font color="#808080">~='' </font><font color="#0000FF">then
        </font>tUsuario.login<font color="#808080">=</font>trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">))
        </font>tUsuario.senha<font color="#808080">=</font>trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">11</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">))
        </font>bret<font color="#808080">=</font><font color="#0000FF">true
     end
  end
  </font>print<font color="#808080">('')
  </font><font color="#0000FF">return </font>bret
<font color="#0000FF">end

</font><font color="#008080">-------------------------------------------------------------------------------
-- Mostra os menus do sistema.
-- num - o n&uacute;mero do menu
-------------------------------------------------------------------------------
</font><font color="#0000FF">function </font>menu<font color="#808080">(</font>num<font color="#808080">)
 </font><font color="#0000FF">if </font><font color="#808080">(</font>num<font color="#808080">==</font><font color="#FF0000">1</font><font color="#808080">) </font><font color="#0000FF">then
   </font>print<font color="#808080">('*</font><font color="#008080">--------------------------------------------------------------*')
   </font>print<font color="#808080">('| (</font>C<font color="#808080">)</font>adastros        <font color="#808080">(</font>P<font color="#808080">)</font>esquisas     <font color="#808080">(</font>V<font color="#808080">)</font>endas        <font color="#808080">(</font>O<font color="#808080">)</font>p<font color="#808080">&ccedil;&otilde;</font>es  <font color="#808080">|')
   </font>print<font color="#808080">('*</font><font color="#008080">--------------------------------------------------------------*')
 </font><font color="#0000FF">elseif </font><font color="#808080">(</font>num<font color="#808080">==</font><font color="#FF0000">2</font><font color="#808080">) </font><font color="#0000FF">then 
   </font>print<font color="#808080">('*</font><font color="#008080">---------------------------------*')
   </font>print<font color="#808080">('| </font><font color="#FF0000">01</font>. Cadastro de Assuntos        <font color="#808080">|')
   </font>print<font color="#808080">('| </font><font color="#FF0000">02</font>. Cadastro de Autores         <font color="#808080">|')
   </font>print<font color="#808080">('| </font><font color="#FF0000">03</font>. Cadastro de Editoras        <font color="#808080">|')
   </font>print<font color="#808080">('| </font><font color="#FF0000">04</font>. Cadastro de Endere<font color="#808080">&ccedil;</font>os       <font color="#808080">|')
   </font>print<font color="#808080">('| </font><font color="#FF0000">05</font>. Cadastro de Idiomas         <font color="#808080">|')
   </font>print<font color="#808080">('| </font><font color="#FF0000">06</font>. Cadastro de Pa<font color="#808080">&iacute;</font>ses          <font color="#808080">|')
   </font>print<font color="#808080">('| </font><font color="#FF0000">07</font>. Cadastro de Profiss<font color="#808080">&otilde;</font>es      <font color="#808080">|')
   </font>print<font color="#808080">('| </font><font color="#FF0000">08</font>. Cadastro de Clientes        <font color="#808080">|')
   </font>print<font color="#808080">('| </font><font color="#FF0000">09</font>. Cadastro de Livros          <font color="#808080">|')
   </font>print<font color="#808080">('| </font><font color="#FF0000">10</font>. Voltar ao menu              <font color="#808080">|')
   </font>print<font color="#808080">('*</font><font color="#008080">---------------------------------*')
 </font><font color="#0000FF">elseif </font><font color="#808080">(</font>num<font color="#808080">==</font><font color="#FF0000">3</font><font color="#808080">) </font><font color="#0000FF">then 
   </font>print<font color="#808080">('*</font><font color="#008080">---------------------------------*')
   </font>print<font color="#808080">('| </font><font color="#FF0000">01</font>. Consulta de Assuntos        <font color="#808080">|')
   </font>print<font color="#808080">('| </font><font color="#FF0000">02</font>. Consulta de Autores         <font color="#808080">|')
   </font>print<font color="#808080">('| </font><font color="#FF0000">03</font>. Consulta de Editoras        <font color="#808080">|')
   </font>print<font color="#808080">('| </font><font color="#FF0000">04</font>. Consulta de Endere<font color="#808080">&ccedil;</font>os       <font color="#808080">|')
   </font>print<font color="#808080">('| </font><font color="#FF0000">05</font>. Consulta de Idiomas         <font color="#808080">|')
   </font>print<font color="#808080">('| </font><font color="#FF0000">06</font>. Consulta de Pa<font color="#808080">&iacute;</font>ses          <font color="#808080">|')
   </font>print<font color="#808080">('| </font><font color="#FF0000">07</font>. Consulta de Profiss<font color="#808080">&otilde;</font>es      <font color="#808080">|')
   </font>print<font color="#808080">('| </font><font color="#FF0000">08</font>. Consulta de Clientes        <font color="#808080">|')
   </font>print<font color="#808080">('| </font><font color="#FF0000">09</font>. Consulta de Livros          <font color="#808080">|')
   </font>print<font color="#808080">('| </font><font color="#FF0000">10</font>. Voltar ao menu              <font color="#808080">|')
   </font>print<font color="#808080">('*</font><font color="#008080">---------------------------------*')
 </font><font color="#0000FF">elseif </font><font color="#808080">(</font>num<font color="#808080">==</font><font color="#FF0000">4</font><font color="#808080">) </font><font color="#0000FF">then 
   </font>print<font color="#808080">('*</font><font color="#008080">---------------------------------*')
   </font>print<font color="#808080">('| </font><font color="#FF0000">01</font>. Vender Livros               <font color="#808080">|')
   </font>print<font color="#808080">('| </font><font color="#FF0000">02</font>. Vendas Realizadas           <font color="#808080">|')
   </font>print<font color="#808080">('| </font><font color="#FF0000">03</font>. Voltar ao menu              <font color="#808080">|')
   </font>print<font color="#808080">('*</font><font color="#008080">---------------------------------*')
 </font><font color="#0000FF">elseif </font><font color="#808080">(</font>num<font color="#808080">==</font><font color="#FF0000">5</font><font color="#808080">) </font><font color="#0000FF">then 
   </font>print<font color="#808080">('*</font><font color="#008080">---------------------------------*')
   </font>print<font color="#808080">('| </font><font color="#FF0000">01</font>. Alterar senha               <font color="#808080">|')
   </font>print<font color="#808080">('| </font><font color="#FF0000">02</font>. Sobre o sistema             <font color="#808080">|')
   </font>print<font color="#808080">('| </font><font color="#FF0000">03</font>. Sair <font color="#0000FF">do </font>sistema             <font color="#808080">|')
   </font>print<font color="#808080">('| </font><font color="#FF0000">04</font>. Voltar ao menu              <font color="#808080">|')
   </font>print<font color="#808080">('*</font><font color="#008080">---------------------------------*')
 </font><font color="#0000FF">elseif </font><font color="#808080">(</font>num<font color="#808080">==</font><font color="#FF0000">6</font><font color="#808080">) </font><font color="#0000FF">then 
   </font>print<font color="#808080">('*</font><font color="#008080">--------------------------------------------------------------*')
   </font>print<font color="#808080">('| (</font><font color="#FF0000">1</font><font color="#808080">) </font>Novo  <font color="#808080">(</font><font color="#FF0000">2</font><font color="#808080">) </font>Pesquisar   <font color="#808080">(</font><font color="#FF0000">3</font><font color="#808080">) </font>Voltar ao menu                 <font color="#808080">|')
   </font>print<font color="#808080">('*</font><font color="#008080">--------------------------------------------------------------*')
 </font><font color="#0000FF">elseif </font><font color="#808080">(</font>num<font color="#808080">==</font><font color="#FF0000">7</font><font color="#808080">) </font><font color="#0000FF">then 
   </font>print<font color="#808080">('*</font><font color="#008080">--------------------------------------------------------------*')
   </font>print<font color="#808080">('| (</font><font color="#FF0000">1</font><font color="#808080">) </font>Salvar inclus<font color="#808080">&atilde;</font>o       <font color="#808080">(</font><font color="#FF0000">2</font><font color="#808080">) </font>Voltar ao menu                 <font color="#808080">|')
   </font>print<font color="#808080">('*</font><font color="#008080">--------------------------------------------------------------*')
 </font><font color="#0000FF">elseif </font><font color="#808080">(</font>num<font color="#808080">==</font><font color="#FF0000">8</font><font color="#808080">) </font><font color="#0000FF">then 
   </font>print<font color="#808080">('*</font><font color="#008080">--------------------------------------------------------------*')
   </font>print<font color="#808080">('| (</font><font color="#FF0000">1</font><font color="#808080">) </font>Alterar       <font color="#808080">(</font><font color="#FF0000">2</font><font color="#808080">) </font>Excluir     <font color="#808080">(</font><font color="#FF0000">3</font><font color="#808080">) </font>Voltar ao menu         <font color="#808080">|')
   </font>print<font color="#808080">('*</font><font color="#008080">--------------------------------------------------------------*')
 </font><font color="#0000FF">elseif </font><font color="#808080">(</font>num<font color="#808080">==</font><font color="#FF0000">9</font><font color="#808080">) </font><font color="#0000FF">then 
   </font>print<font color="#808080">('*</font><font color="#008080">--------------------------------------------------------------*')
   </font>print<font color="#808080">('| (</font><font color="#FF0000">1</font><font color="#808080">) </font>Salvar altera<font color="#808080">&ccedil;&atilde;</font>o      <font color="#808080">(</font><font color="#FF0000">2</font><font color="#808080">) </font>Voltar ao menu                 <font color="#808080">|')
   </font>print<font color="#808080">('*</font><font color="#008080">--------------------------------------------------------------*')
 </font><font color="#0000FF">elseif </font><font color="#808080">(</font>num<font color="#808080">==</font><font color="#FF0000">10</font><font color="#808080">) </font><font color="#0000FF">then 
   </font>print<font color="#808080">('*</font><font color="#008080">--------------------------------------------------------------*')
   </font>print<font color="#808080">('| </font>Certeza de excluir<font color="#808080">? (</font>S<font color="#808080">/</font>N<font color="#808080">)                                    |')
   </font>print<font color="#808080">('*</font><font color="#008080">--------------------------------------------------------------*')
 </font><font color="#0000FF">elseif </font><font color="#808080">(</font>num<font color="#808080">==</font><font color="#FF0000">11</font><font color="#808080">) </font><font color="#0000FF">then 
   </font>print<font color="#808080">('*</font><font color="#008080">--------------------------------------------------------------*')
   </font>print<font color="#808080">('| </font>Deseja sair <font color="#0000FF">do </font>sistema<font color="#808080">? (</font>S<font color="#808080">/</font>N<font color="#808080">)                                |')
   </font>print<font color="#808080">('*</font><font color="#008080">--------------------------------------------------------------*')
 </font><font color="#0000FF">elseif </font><font color="#808080">(</font>num<font color="#808080">==</font><font color="#FF0000">12</font><font color="#808080">) </font><font color="#0000FF">then 
   </font>print<font color="#808080">('*</font><font color="#008080">--------------------------------------------------------------*')
   </font>print<font color="#808080">('| (</font><font color="#FF0000">1</font><font color="#808080">) </font>Pesquisar  <font color="#808080">(</font><font color="#FF0000">2</font><font color="#808080">) </font>Listar todos   <font color="#808080">(</font><font color="#FF0000">3</font><font color="#808080">) </font>Voltar ao menu         <font color="#808080">|')
   </font>print<font color="#808080">('*</font><font color="#008080">--------------------------------------------------------------*')
 </font><font color="#0000FF">elseif </font><font color="#808080">(</font>num<font color="#808080">==</font><font color="#FF0000">13</font><font color="#808080">) </font><font color="#0000FF">then 
   </font>print<font color="#808080">('*</font><font color="#008080">--------------------------------------------------------------*')
   </font>print<font color="#808080">('| </font>Deseja continuar<font color="#808080">? (</font>S<font color="#808080">/</font>N<font color="#808080">)                                      |')
   </font>print<font color="#808080">('*</font><font color="#008080">--------------------------------------------------------------*')
 </font><font color="#0000FF">elseif </font><font color="#808080">(</font>num<font color="#808080">==</font><font color="#FF0000">14</font><font color="#808080">) </font><font color="#0000FF">then 
   </font>print<font color="#808080">('*</font><font color="#008080">--------------------------------------------------------------*')
   </font>print<font color="#808080">('| </font>Salvar inclus<font color="#808080">&atilde;</font>o <font color="#808080">(</font>S<font color="#808080">/</font>N<font color="#808080">)                                        |')
   </font>print<font color="#808080">('*</font><font color="#008080">--------------------------------------------------------------*')
 </font><font color="#0000FF">end
 </font>io.write<font color="#808080">(</font>MSG_OPCAO<font color="#808080">)
</font><font color="#0000FF">end

</font><font color="#008080">-------------------------------------------------------------------------------
-- Realiza os cadastros de acordo com o tipo de arquivo.
-- sreg - o tipo de arquivo
-- sacao - a a&ccedil;&atilde;o a ser realizada
-------------------------------------------------------------------------------
</font><font color="#0000FF">function </font>frmCadastros<font color="#808080">(</font>sreg<font color="#808080">, </font>sacao<font color="#808080">)
</font><font color="#0000FF">if </font>sreg<font color="#808080">==[[</font>opAssunto<font color="#808080">]] </font><font color="#0000FF">then
   if </font>sacao<font color="#808080">==[[</font>opNovo<font color="#808080">]] </font><font color="#0000FF">then
      </font>tAssunto.codigo<font color="#808080">=</font>pesqMaxCod<font color="#808080">(</font>tfAssunto<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">))
      </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, '', </font><font color="#FF0000">1</font><font color="#808080">)
      </font>subMenu<font color="#808080">(</font><font color="#FF0000">7</font><font color="#808080">, </font>sreg<font color="#808080">)
   </font><font color="#0000FF">elseif </font>sacao<font color="#808080">==[[</font>opPesquisar<font color="#808080">]] </font><font color="#0000FF">then
     </font>slinha<font color="#808080">=</font>validaEntrada<font color="#808080">(</font>tfAssunto<font color="#808080">,</font>sreg<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font>tAssunto.codigo<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#0000FF">false</font><font color="#808080">,[[</font>opNumero<font color="#808080">]])
      </font><font color="#0000FF">if </font>slinha<font color="#808080">~='' </font><font color="#0000FF">then 
        </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, '', </font><font color="#FF0000">2</font><font color="#808080">)
        </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font>slinha<font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">)
        </font>subMenu<font color="#808080">(</font><font color="#FF0000">8</font><font color="#808080">, </font>sreg<font color="#808080">)
      </font><font color="#0000FF">end
   elseif </font>sacao<font color="#808080">==[[</font>opAlterar<font color="#808080">]] </font><font color="#0000FF">then
      </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, '', </font><font color="#FF0000">1</font><font color="#808080">)
      </font>subMenu<font color="#808080">(</font><font color="#FF0000">9</font><font color="#808080">, </font>sreg<font color="#808080">)
   </font><font color="#0000FF">elseif </font>sacao<font color="#808080">==[[</font>opExcluir<font color="#808080">]] </font><font color="#0000FF">then
      </font>subMenu<font color="#808080">(</font><font color="#FF0000">10</font><font color="#808080">, </font>sreg<font color="#808080">)
   </font><font color="#0000FF">end
elseif </font>sreg<font color="#808080">==[[</font>opAutor<font color="#808080">]] </font><font color="#0000FF">then
   if </font>sacao<font color="#808080">==[[</font>opNovo<font color="#808080">]] </font><font color="#0000FF">then
      </font>tAutor.codigo<font color="#808080">=</font>pesqMaxCod<font color="#808080">(</font>tfAutor<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">))
      </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, '', </font><font color="#FF0000">1</font><font color="#808080">)
      </font>subMenu<font color="#808080">(</font><font color="#FF0000">7</font><font color="#808080">, </font>sreg<font color="#808080">)
   </font><font color="#0000FF">elseif </font>sacao<font color="#808080">==[[</font>opPesquisar<font color="#808080">]] </font><font color="#0000FF">then
      </font>slinha<font color="#808080">=</font>validaEntrada<font color="#808080">(</font>tfAutor<font color="#808080">, </font>sreg<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font>tAutor.codigo<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#0000FF">false</font><font color="#808080">,[[</font>opNumero<font color="#808080">]])
      </font><font color="#0000FF">if </font>slinha<font color="#808080">~='' </font><font color="#0000FF">then 
        </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, '', </font><font color="#FF0000">2</font><font color="#808080">)
        </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font>slinha<font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">)
        </font>subMenu<font color="#808080">(</font><font color="#FF0000">8</font><font color="#808080">, </font>sreg<font color="#808080">)
      </font><font color="#0000FF">end
   elseif </font>sacao<font color="#808080">==[[</font>opAlterar<font color="#808080">]] </font><font color="#0000FF">then
      </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, '', </font><font color="#FF0000">1</font><font color="#808080">)
      </font>subMenu<font color="#808080">(</font><font color="#FF0000">9</font><font color="#808080">, </font>sreg<font color="#808080">)
   </font><font color="#0000FF">elseif </font>sacao<font color="#808080">==[[</font>opExcluir<font color="#808080">]] </font><font color="#0000FF">then
      </font>subMenu<font color="#808080">(</font><font color="#FF0000">10</font><font color="#808080">, </font>sreg<font color="#808080">)
   </font><font color="#0000FF">end
elseif </font>sreg<font color="#808080">==[[</font>opEditora<font color="#808080">]] </font><font color="#0000FF">then
   if </font>sacao<font color="#808080">==[[</font>opNovo<font color="#808080">]] </font><font color="#0000FF">then
      </font>tEditora.codigo<font color="#808080">=</font>pesqMaxCod<font color="#808080">(</font>tfEditora<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">))
      </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, '', </font><font color="#FF0000">1</font><font color="#808080">)
      </font>subMenu<font color="#808080">(</font><font color="#FF0000">7</font><font color="#808080">, </font>sreg<font color="#808080">)
   </font><font color="#0000FF">elseif </font>sacao<font color="#808080">==[[</font>opPesquisar<font color="#808080">]] </font><font color="#0000FF">then
     </font>slinha<font color="#808080">=</font>validaEntrada<font color="#808080">(</font>tfEditora<font color="#808080">,</font>sreg<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font>tEditora.codigo<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#0000FF">false</font><font color="#808080">,[[</font>opNumero<font color="#808080">]])
      </font><font color="#0000FF">if </font>slinha<font color="#808080">~='' </font><font color="#0000FF">then 
        </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, '', </font><font color="#FF0000">2</font><font color="#808080">)
        </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font>slinha<font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">)
        </font>subMenu<font color="#808080">(</font><font color="#FF0000">8</font><font color="#808080">, </font>sreg<font color="#808080">)
      </font><font color="#0000FF">end
   elseif </font>sacao<font color="#808080">==[[</font>opAlterar<font color="#808080">]] </font><font color="#0000FF">then
      </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, '', </font><font color="#FF0000">1</font><font color="#808080">)
      </font>subMenu<font color="#808080">(</font><font color="#FF0000">9</font><font color="#808080">, </font>sreg<font color="#808080">)
   </font><font color="#0000FF">elseif </font>sacao<font color="#808080">==[[</font>opExcluir<font color="#808080">]] </font><font color="#0000FF">then
      </font>subMenu<font color="#808080">(</font><font color="#FF0000">10</font><font color="#808080">, </font>sreg<font color="#808080">)
   </font><font color="#0000FF">end
elseif </font>sreg<font color="#808080">==[[</font>opEndereco<font color="#808080">]] </font><font color="#0000FF">then
   if </font>sacao<font color="#808080">==[[</font>opNovo<font color="#808080">]] </font><font color="#0000FF">then
      </font>tEndereco.codigo<font color="#808080">=</font>pesqMaxCod<font color="#808080">(</font>tfEndereco<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">))
      </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, '', </font><font color="#FF0000">1</font><font color="#808080">)
      </font>subMenu<font color="#808080">(</font><font color="#FF0000">7</font><font color="#808080">, </font>sreg<font color="#808080">)
   </font><font color="#0000FF">elseif </font>sacao<font color="#808080">==[[</font>opPesquisar<font color="#808080">]] </font><font color="#0000FF">then
      </font>slinha<font color="#808080">=</font>validaEntrada<font color="#808080">(</font>tfEndereco<font color="#808080">,</font>sreg<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font>tEndereco.codigo<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,
              </font><font color="#0000FF">false</font><font color="#808080">,[[</font>opNumero<font color="#808080">]])
      </font><font color="#0000FF">if </font>slinha<font color="#808080">~='' </font><font color="#0000FF">then 
        </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, '', </font><font color="#FF0000">2</font><font color="#808080">)
        </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font>slinha<font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">)
        </font>subMenu<font color="#808080">(</font><font color="#FF0000">8</font><font color="#808080">, </font>sreg<font color="#808080">)
      </font><font color="#0000FF">end
   elseif </font>sacao<font color="#808080">==[[</font>opAlterar<font color="#808080">]] </font><font color="#0000FF">then
      </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, '', </font><font color="#FF0000">1</font><font color="#808080">)
      </font>subMenu<font color="#808080">(</font><font color="#FF0000">9</font><font color="#808080">, </font>sreg<font color="#808080">)
   </font><font color="#0000FF">elseif </font>sacao<font color="#808080">==[[</font>opExcluir<font color="#808080">]] </font><font color="#0000FF">then
      </font>subMenu<font color="#808080">(</font><font color="#FF0000">10</font><font color="#808080">, </font>sreg<font color="#808080">)
   </font><font color="#0000FF">end
elseif </font>sreg<font color="#808080">==[[</font>opIdioma<font color="#808080">]] </font><font color="#0000FF">then
   if </font>sacao<font color="#808080">==[[</font>opNovo<font color="#808080">]] </font><font color="#0000FF">then
      </font>tIdioma.codigo<font color="#808080">=</font>pesqMaxCod<font color="#808080">(</font>tfIdioma<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">))
      </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, '', </font><font color="#FF0000">1</font><font color="#808080">)
      </font>subMenu<font color="#808080">(</font><font color="#FF0000">7</font><font color="#808080">, </font>sreg<font color="#808080">)
   </font><font color="#0000FF">elseif </font>sacao<font color="#808080">==[[</font>opPesquisar<font color="#808080">]] </font><font color="#0000FF">then
      </font>slinha<font color="#808080">=</font>validaEntrada<font color="#808080">(</font>tfIdioma<font color="#808080">,</font>sreg<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font>tIdioma.codigo<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#0000FF">false</font><font color="#808080">,[[</font>opNumero<font color="#808080">]])
      </font><font color="#0000FF">if </font>slinha<font color="#808080">~='' </font><font color="#0000FF">then 
        </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, '', </font><font color="#FF0000">2</font><font color="#808080">)
        </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font>slinha<font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">)
        </font>subMenu<font color="#808080">(</font><font color="#FF0000">8</font><font color="#808080">, </font>sreg<font color="#808080">)
      </font><font color="#0000FF">end
   elseif </font>sacao<font color="#808080">==[[</font>opAlterar<font color="#808080">]] </font><font color="#0000FF">then
      </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, '', </font><font color="#FF0000">1</font><font color="#808080">)
      </font>subMenu<font color="#808080">(</font><font color="#FF0000">9</font><font color="#808080">, </font>sreg<font color="#808080">)
   </font><font color="#0000FF">elseif </font>sacao<font color="#808080">==[[</font>opExcluir<font color="#808080">]] </font><font color="#0000FF">then
      </font>subMenu<font color="#808080">(</font><font color="#FF0000">10</font><font color="#808080">, </font>sreg<font color="#808080">)
   </font><font color="#0000FF">end
elseif </font>sreg<font color="#808080">==[[</font>opPais<font color="#808080">]] </font><font color="#0000FF">then
   if </font>sacao<font color="#808080">==[[</font>opNovo<font color="#808080">]] </font><font color="#0000FF">then
      </font>io.write<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">))
      </font>tPais.codigo <font color="#808080">= </font>digita<font color="#808080">()
      </font>slinha<font color="#808080">=</font>pesqArq<font color="#808080">(</font>tfPais<font color="#808080">, </font>tPais.codigo<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">))
      </font><font color="#0000FF">if </font>slinha<font color="#808080">=='' </font><font color="#0000FF">then 
         </font>pesqLinhaExcluida<font color="#808080">(</font>tfPais<font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">))
         </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, '', </font><font color="#FF0000">1</font><font color="#808080">)
         </font>subMenu<font color="#808080">(</font><font color="#FF0000">7</font><font color="#808080">, </font>sreg<font color="#808080">)
      </font><font color="#0000FF">else </font>print<font color="#808080">(</font>MSG_REGEXST<font color="#808080">) </font><font color="#0000FF">end
   elseif </font>sacao<font color="#808080">==[[</font>opPesquisar<font color="#808080">]] </font><font color="#0000FF">then
      </font>slinha<font color="#808080">=</font>validaEntrada<font color="#808080">(</font>tfPais<font color="#808080">, </font>sreg<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font>tPais.codigo<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#0000FF">false</font><font color="#808080">, [[</font>opTexto<font color="#808080">]])
      </font><font color="#0000FF">if </font>slinha<font color="#808080">~='' </font><font color="#0000FF">then 
        </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, '', </font><font color="#FF0000">2</font><font color="#808080">)
        </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font>slinha<font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">)
        </font>subMenu<font color="#808080">(</font><font color="#FF0000">8</font><font color="#808080">, </font>sreg<font color="#808080">)
      </font><font color="#0000FF">end
   elseif </font>sacao<font color="#808080">==[[</font>opAlterar<font color="#808080">]] </font><font color="#0000FF">then
      </font>print<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">)</font>..tPais.codigo<font color="#808080">)
      </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, '', </font><font color="#FF0000">1</font><font color="#808080">)
      </font>subMenu<font color="#808080">(</font><font color="#FF0000">9</font><font color="#808080">, </font>sreg<font color="#808080">)
   </font><font color="#0000FF">elseif </font>sacao<font color="#808080">==[[</font>opExcluir<font color="#808080">]] </font><font color="#0000FF">then
      </font>subMenu<font color="#808080">(</font><font color="#FF0000">10</font><font color="#808080">, </font>sreg<font color="#808080">)
   </font><font color="#0000FF">end
elseif </font>sreg<font color="#808080">==[[</font>opProfissao<font color="#808080">]] </font><font color="#0000FF">then
   if </font>sacao<font color="#808080">==[[</font>opNovo<font color="#808080">]] </font><font color="#0000FF">then
      </font>tProfissao.codigo<font color="#808080">=</font>pesqMaxCod<font color="#808080">(</font>tfProfissao<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">))
      </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, '', </font><font color="#FF0000">1</font><font color="#808080">)
      </font>subMenu<font color="#808080">(</font><font color="#FF0000">7</font><font color="#808080">, </font>sreg<font color="#808080">)
   </font><font color="#0000FF">elseif </font>sacao<font color="#808080">==[[</font>opPesquisar<font color="#808080">]] </font><font color="#0000FF">then
      </font>slinha<font color="#808080">=</font>validaEntrada<font color="#808080">(</font>tfProfissao<font color="#808080">,</font>sreg<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font>tProfissao.codigo<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,
              </font><font color="#0000FF">false</font><font color="#808080">,[[</font>opNumero<font color="#808080">]])
      </font><font color="#0000FF">if </font>slinha<font color="#808080">~='' </font><font color="#0000FF">then 
        </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, '', </font><font color="#FF0000">2</font><font color="#808080">)
        </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font>slinha<font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">)
        </font>subMenu<font color="#808080">(</font><font color="#FF0000">8</font><font color="#808080">, </font>sreg<font color="#808080">)
      </font><font color="#0000FF">end
   elseif </font>sacao<font color="#808080">==[[</font>opAlterar<font color="#808080">]] </font><font color="#0000FF">then
      </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, '', </font><font color="#FF0000">1</font><font color="#808080">)
      </font>subMenu<font color="#808080">(</font><font color="#FF0000">9</font><font color="#808080">, </font>sreg<font color="#808080">)
   </font><font color="#0000FF">elseif </font>sacao<font color="#808080">==[[</font>opExcluir<font color="#808080">]] </font><font color="#0000FF">then
      </font>subMenu<font color="#808080">(</font><font color="#FF0000">10</font><font color="#808080">, </font>sreg<font color="#808080">)
   </font><font color="#0000FF">end
elseif </font>sreg<font color="#808080">==[[</font>opLivro<font color="#808080">]] </font><font color="#0000FF">then
   if </font>sacao<font color="#808080">==[[</font>opNovo<font color="#808080">]] </font><font color="#0000FF">then
      </font>io.write<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">))
      </font>tLivro.isbn <font color="#808080">= </font>digita<font color="#808080">()
      </font><font color="#0000FF">if </font>validaISBN<font color="#808080">(</font>tLivro.isbn<font color="#808080">) </font><font color="#0000FF">then 
          </font>slinha<font color="#808080">=</font>pesqArq<font color="#808080">(</font>tfLivro<font color="#808080">, </font>tLivro.isbn<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">13</font><font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">))
          </font><font color="#0000FF">if </font>slinha<font color="#808080">=='' </font><font color="#0000FF">then 
             </font>pesqLinhaExcluida<font color="#808080">(</font>tfLivro<font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">))
             </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, '', </font><font color="#FF0000">1</font><font color="#808080">)
             </font>subMenu<font color="#808080">(</font><font color="#FF0000">7</font><font color="#808080">, </font>sreg<font color="#808080">)
             </font>frmCadLigados<font color="#808080">([[</font>opLivroAss<font color="#808080">]], [[</font>opNovo<font color="#808080">]], </font>tLivro.isbn<font color="#808080">)
             </font>frmCadLigados<font color="#808080">([[</font>opLivroAut<font color="#808080">]], [[</font>opNovo<font color="#808080">]], </font>tLivro.isbn<font color="#808080">)
          </font><font color="#0000FF">else </font>print<font color="#808080">(</font>MSG_REGEXST<font color="#808080">) </font><font color="#0000FF">end
      else </font>print<font color="#808080">(</font>MSG_ISBNINV<font color="#808080">) </font><font color="#0000FF">end
   elseif </font>sacao<font color="#808080">==[[</font>opPesquisar<font color="#808080">]] </font><font color="#0000FF">then
      </font>slinha<font color="#808080">=</font>validaEntrada<font color="#808080">(</font>tfLivro<font color="#808080">, </font>sreg<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font>tLivro.isbn<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#0000FF">false</font><font color="#808080">,[[</font>opTexto<font color="#808080">]])
      </font><font color="#0000FF">if </font>slinha<font color="#808080">~='' </font><font color="#0000FF">then 
         </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, '', </font><font color="#FF0000">2</font><font color="#808080">)
         </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font>slinha<font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">)
         </font>subMenu<font color="#808080">(</font><font color="#FF0000">8</font><font color="#808080">, </font>sreg<font color="#808080">)
      </font><font color="#0000FF">end
   elseif </font>sacao<font color="#808080">==[[</font>opAlterar<font color="#808080">]] </font><font color="#0000FF">then
      </font>print<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">)</font>..tLivro.isbn<font color="#808080">)
      </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, '', </font><font color="#FF0000">1</font><font color="#808080">)
      </font>subMenu<font color="#808080">(</font><font color="#FF0000">9</font><font color="#808080">, </font>sreg<font color="#808080">)
      </font>frmCadLigados<font color="#808080">([[</font>opLivroAss<font color="#808080">]], [[</font>opExcluir<font color="#808080">]], </font>tLivro.isbn<font color="#808080">)
      </font>print<font color="#808080">('</font>Assuntos dos livros exclu<font color="#808080">&iacute;</font>dos<font color="#808080">, </font>inclua novos<font color="#808080">!')
      </font>frmCadLigados<font color="#808080">([[</font>opLivroAss<font color="#808080">]], [[</font>opNovo<font color="#808080">]], </font>tLivro.isbn<font color="#808080">)
      </font>frmCadLigados<font color="#808080">([[</font>opLivroAut<font color="#808080">]], [[</font>opExcluir<font color="#808080">]], </font>tLivro.isbn<font color="#808080">)
      </font>print<font color="#808080">('</font>Autores dos livros exclu<font color="#808080">&iacute;</font>dos<font color="#808080">, </font>inclua novos<font color="#808080">!')
      </font>frmCadLigados<font color="#808080">([[</font>opLivroAut<font color="#808080">]], [[</font>opNovo<font color="#808080">]], </font>tLivro.isbn<font color="#808080">)
   </font><font color="#0000FF">elseif </font>sacao<font color="#808080">==[[</font>opExcluir<font color="#808080">]] </font><font color="#0000FF">then
      </font>subMenu<font color="#808080">(</font><font color="#FF0000">10</font><font color="#808080">, </font>sreg<font color="#808080">)
      </font>print<font color="#808080">('</font>Assuntos dos livros sendo exclu<font color="#808080">&iacute;</font>dos<font color="#808080">!')
      </font>frmCadLigados<font color="#808080">([[</font>opLivroAss<font color="#808080">]], [[</font>opExcluir<font color="#808080">]], </font>tLivro.isbn<font color="#808080">)
      </font>print<font color="#808080">('</font>Autores dos livros sendo exclu<font color="#808080">&iacute;</font>dos<font color="#808080">!')
      </font>frmCadLigados<font color="#808080">([[</font>opLivroAut<font color="#808080">]], [[</font>opExcluir<font color="#808080">]], </font>tLivro.isbn<font color="#808080">)
   </font><font color="#0000FF">end
elseif </font>sreg<font color="#808080">==[[</font>opCliente<font color="#808080">]] </font><font color="#0000FF">then
   if </font>sacao<font color="#808080">==[[</font>opNovo<font color="#808080">]] </font><font color="#0000FF">then
      </font>io.write<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">))
      </font>tCliente.cpf <font color="#808080">= </font>digita<font color="#808080">()
      </font><font color="#0000FF">if </font>validaCPF<font color="#808080">(</font>tCliente.cpf<font color="#808080">) </font><font color="#0000FF">then 
          </font>slinha<font color="#808080">=</font>pesqArq<font color="#808080">(</font>tfCliente<font color="#808080">, </font>tCliente.cpf<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">14</font><font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">))
          </font><font color="#0000FF">if </font>slinha<font color="#808080">=='' </font><font color="#0000FF">then 
             </font>pesqLinhaExcluida<font color="#808080">(</font>tfCliente<font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">))
             </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, '', </font><font color="#FF0000">1</font><font color="#808080">)
             </font>subMenu<font color="#808080">(</font><font color="#FF0000">7</font><font color="#808080">, </font>sreg<font color="#808080">)
          </font><font color="#0000FF">else </font>print<font color="#808080">(</font>MSG_REGEXST<font color="#808080">) </font><font color="#0000FF">end
      else </font>print<font color="#808080">(</font>MSG_CPFINV<font color="#808080">) </font><font color="#0000FF">end
   elseif </font>sacao<font color="#808080">==[[</font>opPesquisar<font color="#808080">]] </font><font color="#0000FF">then
      </font>slinha<font color="#808080">=</font>validaEntrada<font color="#808080">(</font>tfCliente<font color="#808080">, </font>sreg<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font>tCliente.cpf<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#0000FF">false</font><font color="#808080">,[[</font>opTexto<font color="#808080">]])
      </font><font color="#0000FF">if </font>slinha<font color="#808080">~='' </font><font color="#0000FF">then 
         </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, '', </font><font color="#FF0000">2</font><font color="#808080">)
         </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font>slinha<font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">)
         </font>subMenu<font color="#808080">(</font><font color="#FF0000">8</font><font color="#808080">, </font>sreg<font color="#808080">)
      </font><font color="#0000FF">end
   elseif </font>sacao<font color="#808080">==[[</font>opAlterar<font color="#808080">]] </font><font color="#0000FF">then
      </font>print<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">)</font>..tCliente.cpf<font color="#808080">)
      </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, '', </font><font color="#FF0000">1</font><font color="#808080">)
      </font>subMenu<font color="#808080">(</font><font color="#FF0000">9</font><font color="#808080">, </font>sreg<font color="#808080">)
   </font><font color="#0000FF">elseif </font>sacao<font color="#808080">==[[</font>opExcluir<font color="#808080">]] </font><font color="#0000FF">then
      </font>subMenu<font color="#808080">(</font><font color="#FF0000">10</font><font color="#808080">, </font>sreg<font color="#808080">)
   </font><font color="#0000FF">end
elseif </font>sreg<font color="#808080">==[[</font>opVenda<font color="#808080">]] </font><font color="#0000FF">then
   if </font>sacao<font color="#808080">==[[</font>opNovo<font color="#808080">]] </font><font color="#0000FF">then
      </font>tVenda.dthrvenda<font color="#808080">=</font>retDataHora<font color="#808080">()
      </font>print<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">)</font>..tVenda.dthrvenda<font color="#808080">)
      </font>slinha<font color="#808080">=</font>pesqArq<font color="#808080">(</font>tfVenda<font color="#808080">, </font>tVenda.dthrvenda<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">19</font><font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">))
      </font><font color="#0000FF">if </font>slinha<font color="#808080">=='' </font><font color="#0000FF">then 
         </font>slinha<font color="#808080">=</font>validaEntrada<font color="#808080">(</font>tfCliente<font color="#808080">,[[</font>opCliente<font color="#808080">]],</font><font color="#FF0000">1</font><font color="#808080">,</font>tVenda.cpf<font color="#808080">,</font><font color="#FF0000">3</font><font color="#808080">,
                 </font><font color="#0000FF">false</font><font color="#808080">,[[</font>opTexto<font color="#808080">]])
         </font><font color="#0000FF">if </font>slinha<font color="#808080">~='' </font><font color="#0000FF">then 
            </font>tVenda.cpf<font color="#808080">=</font>trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#FF0000">14</font><font color="#808080">))
            </font><font color="#0000FF">if </font>validaCPF<font color="#808080">(</font>tVenda.cpf<font color="#808080">) </font><font color="#0000FF">then 
               </font>io.write<font color="#808080">(' '</font>..rotulo<font color="#808080">([[</font>opCliente<font color="#808080">]], </font><font color="#FF0000">2</font><font color="#808080">)) </font><font color="#008080">-- Nome 
               </font>print<font color="#808080">(</font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font>g_nPosChave<font color="#808080">, </font>g_nTamChave<font color="#808080">))
               </font>frmCadLigados<font color="#808080">([[</font>opVenda<font color="#808080">]], [[</font>opNovo<font color="#808080">]], </font>tVenda.cpf<font color="#808080">)
            </font><font color="#0000FF">else </font>print<font color="#808080">(</font>MSG_CPFINV<font color="#808080">) </font><font color="#0000FF">end
         end
      else </font>print<font color="#808080">(</font>MSG_REGEXST<font color="#808080">) </font><font color="#0000FF">end
   elseif </font>sacao<font color="#808080">==[[</font>opPesquisar<font color="#808080">]] </font><font color="#0000FF">then
      </font>slinha<font color="#808080">=</font>validaEntrada<font color="#808080">(</font>tfVenda<font color="#808080">, </font>sreg<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font>tVenda.dthrvenda<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,
              </font><font color="#0000FF">false</font><font color="#808080">,[[</font>opDataHora<font color="#808080">]])
      </font><font color="#0000FF">if </font>slinha<font color="#808080">~='' </font><font color="#0000FF">then 
        </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, '', </font><font color="#FF0000">2</font><font color="#808080">)
        </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font>slinha<font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">)
        </font>subMenu<font color="#808080">(</font><font color="#FF0000">8</font><font color="#808080">, </font>sreg<font color="#808080">)
      </font><font color="#0000FF">end
   end
end

end

</font><font color="#008080">-------------------------------------------------------------------------------
-- Realiza as consultas de acordo com o tipo de arquivo.
-- sreg - o tipo de arquivo
-- sacao - a a&ccedil;&atilde;o a ser realizada
-------------------------------------------------------------------------------
</font><font color="#0000FF">function </font>frmConsultas<font color="#808080">(</font>sreg<font color="#808080">, </font>sacao<font color="#808080">)
</font>slinha<font color="#808080">=''
</font><font color="#0000FF">if </font>sreg<font color="#808080">==[[</font>opAssunto<font color="#808080">]] </font><font color="#0000FF">then
   if </font>sacao<font color="#808080">==[[</font>opPesquisar<font color="#808080">]] </font><font color="#0000FF">then
      </font>slinha<font color="#808080">=</font>validaEntrada<font color="#808080">(</font>tfAssunto<font color="#808080">,</font>sreg<font color="#808080">,</font><font color="#FF0000">2</font><font color="#808080">,</font>tAssunto.assunto<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#0000FF">true</font><font color="#808080">,[[</font>opTexto<font color="#808080">]])
   </font><font color="#0000FF">elseif </font>sacao<font color="#808080">==[[</font>opListarTodos<font color="#808080">]] </font><font color="#0000FF">then 
      if </font>ListarTodos<font color="#808080">(</font>tfAssunto<font color="#808080">, </font>sreg<font color="#808080">, '', </font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">),
        </font>QTD_MAX_LINHA<font color="#808080">, </font><font color="#0000FF">false</font><font color="#808080">) == </font><font color="#0000FF">false then
        </font>print<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">))
      </font><font color="#0000FF">end  
   end
elseif </font>sreg<font color="#808080">==[[</font>opAutor<font color="#808080">]] </font><font color="#0000FF">then
   if </font>sacao<font color="#808080">==[[</font>opPesquisar<font color="#808080">]] </font><font color="#0000FF">then
      </font>slinha<font color="#808080">=</font>validaEntrada<font color="#808080">(</font>tfAutor<font color="#808080">,</font>sreg<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">, </font>tAutor.autor<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#0000FF">true</font><font color="#808080">,[[</font>opTexto<font color="#808080">]])
   </font><font color="#0000FF">elseif </font>sacao<font color="#808080">==[[</font>opListarTodos<font color="#808080">]] </font><font color="#0000FF">then 
      if </font>ListarTodos<font color="#808080">(</font>tfAutor<font color="#808080">, </font>sreg<font color="#808080">, '', </font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">),
        </font>QTD_MAX_LINHA<font color="#808080">, </font><font color="#0000FF">false</font><font color="#808080">) == </font><font color="#0000FF">false then
        </font>print<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">))
      </font><font color="#0000FF">end  
   end
elseif </font>sreg<font color="#808080">==[[</font>opEditora<font color="#808080">]] </font><font color="#0000FF">then
   if </font>sacao<font color="#808080">==[[</font>opPesquisar<font color="#808080">]] </font><font color="#0000FF">then
      </font>slinha<font color="#808080">=</font>validaEntrada<font color="#808080">(</font>tfEditora<font color="#808080">,</font>sreg<font color="#808080">,</font><font color="#FF0000">2</font><font color="#808080">,</font>tEditora.editora<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#0000FF">true</font><font color="#808080">,[[</font>opTexto<font color="#808080">]])
   </font><font color="#0000FF">elseif </font>sacao<font color="#808080">==[[</font>opListarTodos<font color="#808080">]] </font><font color="#0000FF">then 
      if </font>ListarTodos<font color="#808080">(</font>tfEditora<font color="#808080">, </font>sreg<font color="#808080">, '', </font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">),
        </font>QTD_MAX_LINHA<font color="#808080">, </font><font color="#0000FF">false</font><font color="#808080">) == </font><font color="#0000FF">false then
        </font>print<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">))
      </font><font color="#0000FF">end  
   end
elseif </font>sreg<font color="#808080">==[[</font>opEndereco<font color="#808080">]] </font><font color="#0000FF">then
   if </font>sacao<font color="#808080">==[[</font>opPesquisar<font color="#808080">]] </font><font color="#0000FF">then
      </font>slinha<font color="#808080">=</font>validaEntrada<font color="#808080">(</font>tfEndereco<font color="#808080">,</font>sreg<font color="#808080">,</font><font color="#FF0000">2</font><font color="#808080">,</font>tEndereco.Logradouro<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,
              </font><font color="#0000FF">true</font><font color="#808080">,[[</font>opTexto<font color="#808080">]])
   </font><font color="#0000FF">elseif </font>sacao<font color="#808080">==[[</font>opListarTodos<font color="#808080">]] </font><font color="#0000FF">then 
      if </font>ListarTodos<font color="#808080">(</font>tfEndereco<font color="#808080">, </font>sreg<font color="#808080">, '', </font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">),
         </font><font color="#FF0000">3</font><font color="#808080">, </font><font color="#0000FF">false</font><font color="#808080">) == </font><font color="#0000FF">false then
        </font>print<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">))
      </font><font color="#0000FF">end  
   end
elseif </font>sreg<font color="#808080">==[[</font>opIdioma<font color="#808080">]] </font><font color="#0000FF">then
   if </font>sacao<font color="#808080">==[[</font>opPesquisar<font color="#808080">]] </font><font color="#0000FF">then
      </font>slinha<font color="#808080">=</font>validaEntrada<font color="#808080">(</font>tfIdioma<font color="#808080">, </font>sreg<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">, </font>tIdioma.idioma<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#0000FF">true</font><font color="#808080">,[[</font>opTexto<font color="#808080">]])
   </font><font color="#0000FF">elseif </font>sacao<font color="#808080">==[[</font>opListarTodos<font color="#808080">]] </font><font color="#0000FF">then 
      if </font>ListarTodos<font color="#808080">(</font>tfIdioma<font color="#808080">, </font>sreg<font color="#808080">, '', </font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">),
        </font>QTD_MAX_LINHA<font color="#808080">, </font><font color="#0000FF">false</font><font color="#808080">) == </font><font color="#0000FF">false then
        </font>print<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">))
      </font><font color="#0000FF">end  
   end
elseif </font>sreg<font color="#808080">==[[</font>opPais<font color="#808080">]] </font><font color="#0000FF">then
   if </font>sacao<font color="#808080">==[[</font>opPesquisar<font color="#808080">]] </font><font color="#0000FF">then
      </font>slinha<font color="#808080">=</font>validaEntrada<font color="#808080">(</font>tfPais<font color="#808080">, </font>sreg<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">, </font>tPais.pais<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#0000FF">true</font><font color="#808080">,[[</font>opTexto<font color="#808080">]])
   </font><font color="#0000FF">elseif </font>sacao<font color="#808080">==[[</font>opListarTodos<font color="#808080">]] </font><font color="#0000FF">then 
      if </font>ListarTodos<font color="#808080">(</font>tfPais<font color="#808080">, </font>sreg<font color="#808080">, '', </font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">),
        </font>QTD_MAX_LINHA<font color="#808080">, </font><font color="#0000FF">false</font><font color="#808080">) == </font><font color="#0000FF">false then
        </font>print<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">))
      </font><font color="#0000FF">end  
   end
elseif </font>sreg<font color="#808080">==[[</font>opProfissao<font color="#808080">]] </font><font color="#0000FF">then
   if </font>sacao<font color="#808080">==[[</font>opPesquisar<font color="#808080">]] </font><font color="#0000FF">then
     </font>slinha<font color="#808080">=</font>validaEntrada<font color="#808080">(</font>tfProfissao<font color="#808080">,</font>sreg<font color="#808080">,</font><font color="#FF0000">2</font><font color="#808080">,</font>tProfissao.profissao<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,
             </font><font color="#0000FF">true</font><font color="#808080">,[[</font>opTexto<font color="#808080">]])
   </font><font color="#0000FF">elseif </font>sacao<font color="#808080">==[[</font>opListarTodos<font color="#808080">]] </font><font color="#0000FF">then 
      if </font>ListarTodos<font color="#808080">(</font>tfProfissao<font color="#808080">, </font>sreg<font color="#808080">, '', </font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">),
        </font>QTD_MAX_LINHA<font color="#808080">, </font><font color="#0000FF">false</font><font color="#808080">) == </font><font color="#0000FF">false then
        </font>print<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">))
      </font><font color="#0000FF">end  
   end
elseif </font>sreg<font color="#808080">==[[</font>opLivro<font color="#808080">]] </font><font color="#0000FF">then
   if </font>sacao<font color="#808080">==[[</font>opPesquisar<font color="#808080">]] </font><font color="#0000FF">then
      </font>slinha<font color="#808080">=</font>validaEntrada<font color="#808080">(</font>tfLivro<font color="#808080">, </font>sreg<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">, </font>tLivro.titulo<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#0000FF">true</font><font color="#808080">,[[</font>opTexto<font color="#808080">]])
   </font><font color="#0000FF">elseif </font>sacao<font color="#808080">==[[</font>opListarTodos<font color="#808080">]] </font><font color="#0000FF">then 
      if </font>ListarTodos<font color="#808080">(</font>tfLivro<font color="#808080">, </font>sreg<font color="#808080">, '', </font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">),
        </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#0000FF">false</font><font color="#808080">) == </font><font color="#0000FF">false then
        </font>print<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">))
      </font><font color="#0000FF">end  
   end
elseif </font>sreg<font color="#808080">==[[</font>opCliente<font color="#808080">]] </font><font color="#0000FF">then
   if </font>sacao<font color="#808080">==[[</font>opPesquisar<font color="#808080">]] </font><font color="#0000FF">then
      </font>slinha<font color="#808080">=</font>validaEntrada<font color="#808080">(</font>tfCliente<font color="#808080">, </font>sreg<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">, </font>tCliente.nome<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#0000FF">true</font><font color="#808080">,[[</font>opTexto<font color="#808080">]])
   </font><font color="#0000FF">elseif </font>sacao<font color="#808080">==[[</font>opListarTodos<font color="#808080">]] </font><font color="#0000FF">then 
      if </font>ListarTodos<font color="#808080">(</font>tfCliente<font color="#808080">, </font>sreg<font color="#808080">, '', </font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">),
        </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#0000FF">false</font><font color="#808080">) == </font><font color="#0000FF">false then
        </font>print<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">))
      </font><font color="#0000FF">end  
   end
elseif </font>sreg<font color="#808080">==[[</font>opVenda<font color="#808080">]] </font><font color="#0000FF">then
   if </font>sacao<font color="#808080">==[[</font>opPesquisar<font color="#808080">]] </font><font color="#0000FF">then
      </font>slinha<font color="#808080">=</font>validaEntrada<font color="#808080">(</font>tfVenda<font color="#808080">, </font>sreg<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">, </font>tVenda.cpf<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#0000FF">true</font><font color="#808080">,[[</font>opTexto<font color="#808080">]])
   </font><font color="#0000FF">elseif </font>sacao<font color="#808080">==[[</font>opListarTodos<font color="#808080">]] </font><font color="#0000FF">then 
      if </font>ListarTodos<font color="#808080">(</font>tfVenda<font color="#808080">, </font>sreg<font color="#808080">, '', </font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">),
        </font>QTD_MAX_LINHA<font color="#808080">, </font><font color="#0000FF">false</font><font color="#808080">) == </font><font color="#0000FF">false then
        </font>print<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">))
      </font><font color="#0000FF">end  
   end
end
if </font>slinha<font color="#808080">=='' </font><font color="#0000FF">then
   </font>io.write<font color="#808080">('')
</font><font color="#0000FF">end
end

</font><font color="#008080">-------------------------------------------------------------------------------
-- Mostra a tela de altera&ccedil;&atilde;o de senha do sistema e realiza a altera&ccedil;&atilde;o.
-------------------------------------------------------------------------------
</font><font color="#0000FF">function </font>frmAlterarSenha<font color="#808080">()
</font>print<font color="#808080">(</font>rotulo<font color="#808080">([[</font>opUsuario<font color="#808080">]], </font><font color="#FF0000">1</font><font color="#808080">)</font>..tUsuario.login<font color="#808080">)
</font>nopcao<font color="#808080">=</font><font color="#FF0000">1
</font>bQuebra<font color="#808080">=</font><font color="#0000FF">false
  while </font><font color="#808080">(</font>bQuebra<font color="#808080">==</font><font color="#0000FF">false</font><font color="#808080">) </font><font color="#0000FF">do
    if </font>nopcao<font color="#808080">==</font><font color="#FF0000">1 </font><font color="#0000FF">then
      </font>sSenhaAtual<font color="#808080">=</font>digitaSenha<font color="#808080">('</font>Senha Atual<font color="#808080">: ',</font><font color="#FF0000">10</font><font color="#808080">)
      </font><font color="#0000FF">if </font>sSenhaAtual<font color="#808080">~=</font>tUsuario.senha <font color="#0000FF">then
         </font>print<font color="#808080">(</font>MSG_SENCONFERE<font color="#808080">)
         </font>bQuebra<font color="#808080">=</font><font color="#0000FF">true
      else 
         </font>nopcao<font color="#808080">=</font><font color="#FF0000">2 
      </font><font color="#0000FF">end
    elseif </font>nopcao<font color="#808080">==</font><font color="#FF0000">2 </font><font color="#0000FF">then
      </font>sNovaSenha<font color="#808080">=</font>digitaSenha<font color="#808080">('</font>Nova Senha<font color="#808080">: ',</font><font color="#FF0000">10</font><font color="#808080">)
      </font>sConfirmaSenha<font color="#808080">=</font>digitaSenha<font color="#808080">('</font>Confirma Senha<font color="#808080">: ',</font><font color="#FF0000">10</font><font color="#808080">)
      </font><font color="#0000FF">if </font>sNovaSenha<font color="#808080">~=</font>sConfirmaSenha <font color="#0000FF">then
         </font>print<font color="#808080">(</font>MSG_SENCONFIRM<font color="#808080">)
         </font>bQuebra<font color="#808080">=</font><font color="#0000FF">true
      else 
         </font>nopcao<font color="#808080">=</font><font color="#FF0000">3
      </font><font color="#0000FF">end
    elseif </font>nopcao<font color="#808080">==</font><font color="#FF0000">3 </font><font color="#0000FF">then
      </font>sres<font color="#808080">=</font>pesqArq<font color="#808080">(</font>tfUsuario<font color="#808080">, </font>tUsuario.login<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">, </font>tamReg<font color="#808080">([[</font>opUsuario<font color="#808080">]]))
      </font><font color="#0000FF">if </font>sres<font color="#808080">=='' </font><font color="#0000FF">then
         </font>print<font color="#808080">(</font>MSG_LOGINENCON<font color="#808080">)
      </font><font color="#0000FF">else
         </font>tUsuario.senha<font color="#808080">=</font>sConfirmaSenha
         subMenu<font color="#808080">(</font><font color="#FF0000">9</font><font color="#808080">,[[</font>opUsuario<font color="#808080">]])
         </font>bQuebra<font color="#808080">=</font><font color="#0000FF">true
      end
    end
  end
end

</font><font color="#008080">-------------------------------------------------------------------------------
-- Executa uma a&ccedil;&atilde;o de grava&ccedil;&atilde;o de acordo com o tipo de arquivo.
-- sreg - o tipo de arquivo
-- sacao - a a&ccedil;&atilde;o a ser realizada
-------------------------------------------------------------------------------
</font><font color="#0000FF">function </font>btnAcao<font color="#808080">(</font>sreg<font color="#808080">, </font>sacao<font color="#808080">)
</font><font color="#0000FF">if </font>sreg<font color="#808080">==[[</font>opAssunto<font color="#808080">]] </font><font color="#0000FF">then
   if </font>sacao<font color="#808080">==[[</font>opSalvarInclusao<font color="#808080">]] </font><font color="#0000FF">then
      </font>escreveArq<font color="#808080">(</font>tfAssunto<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGINC<font color="#808080">, </font>MSG_REGNINC<font color="#808080">)
   </font><font color="#0000FF">elseif </font>sacao<font color="#808080">==[[</font>opSalvarAlteracao<font color="#808080">]] </font><font color="#0000FF">then
      </font>escreveArq<font color="#808080">(</font>tfAssunto<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGALT<font color="#808080">, </font>MSG_REGNALT<font color="#808080">)
   </font><font color="#0000FF">elseif </font>sacao<font color="#808080">==[[</font>opConfirmaExclusao<font color="#808080">]] </font><font color="#0000FF">then
      </font>escreveArq<font color="#808080">(</font>tfAssunto<font color="#808080">, </font>repete<font color="#808080">('*',</font>tamReg<font color="#808080">(</font>sreg<font color="#808080">)), </font>MSG_REGEXC<font color="#808080">, </font>MSG_REGNEXC<font color="#808080">)
   </font><font color="#0000FF">end
elseif </font>sreg<font color="#808080">==[[</font>opAutor<font color="#808080">]] </font><font color="#0000FF">then
   if </font>sacao<font color="#808080">==[[</font>opSalvarInclusao<font color="#808080">]] </font><font color="#0000FF">then
      </font>escreveArq<font color="#808080">(</font>tfAutor<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGINC<font color="#808080">, </font>MSG_REGNINC<font color="#808080">)
   </font><font color="#0000FF">elseif </font>sacao<font color="#808080">==[[</font>opSalvarAlteracao<font color="#808080">]] </font><font color="#0000FF">then
      </font>escreveArq<font color="#808080">(</font>tfAutor<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGALT<font color="#808080">, </font>MSG_REGNALT<font color="#808080">)
   </font><font color="#0000FF">elseif </font>sacao<font color="#808080">==[[</font>opConfirmaExclusao<font color="#808080">]] </font><font color="#0000FF">then
      </font>escreveArq<font color="#808080">(</font>tfAutor<font color="#808080">, </font>repete<font color="#808080">('*',</font>tamReg<font color="#808080">(</font>sreg<font color="#808080">)), </font>MSG_REGEXC<font color="#808080">, </font>MSG_REGNEXC<font color="#808080">)
   </font><font color="#0000FF">end
elseif </font>sreg<font color="#808080">==[[</font>opEditora<font color="#808080">]] </font><font color="#0000FF">then
   if </font>sacao<font color="#808080">==[[</font>opSalvarInclusao<font color="#808080">]] </font><font color="#0000FF">then
      </font>escreveArq<font color="#808080">(</font>tfEditora<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGINC<font color="#808080">, </font>MSG_REGNINC<font color="#808080">)
   </font><font color="#0000FF">elseif </font>sacao<font color="#808080">==[[</font>opSalvarAlteracao<font color="#808080">]] </font><font color="#0000FF">then
      </font>escreveArq<font color="#808080">(</font>tfEditora<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGALT<font color="#808080">, </font>MSG_REGNALT<font color="#808080">)
   </font><font color="#0000FF">elseif </font>sacao<font color="#808080">==[[</font>opConfirmaExclusao<font color="#808080">]] </font><font color="#0000FF">then
      </font>escreveArq<font color="#808080">(</font>tfEditora<font color="#808080">, </font>repete<font color="#808080">('*',</font>tamReg<font color="#808080">(</font>sreg<font color="#808080">)), </font>MSG_REGEXC<font color="#808080">, </font>MSG_REGNEXC<font color="#808080">)
   </font><font color="#0000FF">end
elseif </font>sreg<font color="#808080">==[[</font>opEndereco<font color="#808080">]] </font><font color="#0000FF">then
   if </font>sacao<font color="#808080">==[[</font>opSalvarInclusao<font color="#808080">]] </font><font color="#0000FF">then
      </font>escreveArq<font color="#808080">(</font>tfEndereco<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGINC<font color="#808080">, </font>MSG_REGNINC<font color="#808080">)
   </font><font color="#0000FF">elseif </font>sacao<font color="#808080">==[[</font>opSalvarAlteracao<font color="#808080">]] </font><font color="#0000FF">then
      </font>escreveArq<font color="#808080">(</font>tfEndereco<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGALT<font color="#808080">, </font>MSG_REGNALT<font color="#808080">)
   </font><font color="#0000FF">elseif </font>sacao<font color="#808080">==[[</font>opConfirmaExclusao<font color="#808080">]] </font><font color="#0000FF">then
      </font>escreveArq<font color="#808080">(</font>tfEndereco<font color="#808080">, </font>repete<font color="#808080">('*',</font>tamReg<font color="#808080">(</font>sreg<font color="#808080">)), </font>MSG_REGEXC<font color="#808080">, </font>MSG_REGNEXC<font color="#808080">)
   </font><font color="#0000FF">end
elseif </font>sreg<font color="#808080">==[[</font>opIdioma<font color="#808080">]] </font><font color="#0000FF">then
   if </font>sacao<font color="#808080">==[[</font>opSalvarInclusao<font color="#808080">]] </font><font color="#0000FF">then
      </font>escreveArq<font color="#808080">(</font>tfIdioma<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGINC<font color="#808080">, </font>MSG_REGNINC<font color="#808080">)
   </font><font color="#0000FF">elseif </font>sacao<font color="#808080">==[[</font>opSalvarAlteracao<font color="#808080">]] </font><font color="#0000FF">then
      </font>escreveArq<font color="#808080">(</font>tfIdioma<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGALT<font color="#808080">, </font>MSG_REGNALT<font color="#808080">)
   </font><font color="#0000FF">elseif </font>sacao<font color="#808080">==[[</font>opConfirmaExclusao<font color="#808080">]] </font><font color="#0000FF">then
      </font>escreveArq<font color="#808080">(</font>tfIdioma<font color="#808080">, </font>repete<font color="#808080">('*',</font>tamReg<font color="#808080">(</font>sreg<font color="#808080">)), </font>MSG_REGEXC<font color="#808080">, </font>MSG_REGNEXC<font color="#808080">)
   </font><font color="#0000FF">end
elseif </font>sreg<font color="#808080">==[[</font>opPais<font color="#808080">]] </font><font color="#0000FF">then
   if </font>sacao<font color="#808080">==[[</font>opSalvarInclusao<font color="#808080">]] </font><font color="#0000FF">then
      </font>escreveArq<font color="#808080">(</font>tfPais<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGINC<font color="#808080">, </font>MSG_REGNINC<font color="#808080">)
   </font><font color="#0000FF">elseif </font>sacao<font color="#808080">==[[</font>opSalvarAlteracao<font color="#808080">]] </font><font color="#0000FF">then
      </font>escreveArq<font color="#808080">(</font>tfPais<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGALT<font color="#808080">, </font>MSG_REGNALT<font color="#808080">)
   </font><font color="#0000FF">elseif </font>sacao<font color="#808080">==[[</font>opConfirmaExclusao<font color="#808080">]] </font><font color="#0000FF">then
      </font>escreveArq<font color="#808080">(</font>tfPais<font color="#808080">, </font>repete<font color="#808080">('*',</font>tamReg<font color="#808080">(</font>sreg<font color="#808080">)), </font>MSG_REGEXC<font color="#808080">, </font>MSG_REGNEXC<font color="#808080">)
   </font><font color="#0000FF">end
elseif </font>sreg<font color="#808080">==[[</font>opProfissao<font color="#808080">]] </font><font color="#0000FF">then
   if </font>sacao<font color="#808080">==[[</font>opSalvarInclusao<font color="#808080">]] </font><font color="#0000FF">then
      </font>escreveArq<font color="#808080">(</font>tfProfissao<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGINC<font color="#808080">, </font>MSG_REGNINC<font color="#808080">)
   </font><font color="#0000FF">elseif </font>sacao<font color="#808080">==[[</font>opSalvarAlteracao<font color="#808080">]] </font><font color="#0000FF">then
      </font>escreveArq<font color="#808080">(</font>tfProfissao<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGALT<font color="#808080">, </font>MSG_REGNALT<font color="#808080">)
   </font><font color="#0000FF">elseif </font>sacao<font color="#808080">==[[</font>opConfirmaExclusao<font color="#808080">]] </font><font color="#0000FF">then
      </font>escreveArq<font color="#808080">(</font>tfProfissao<font color="#808080">, </font>repete<font color="#808080">('*',</font>tamReg<font color="#808080">(</font>sreg<font color="#808080">)), </font>MSG_REGEXC<font color="#808080">, </font>MSG_REGNEXC<font color="#808080">)
   </font><font color="#0000FF">end
elseif </font>sreg<font color="#808080">==[[</font>opLivro<font color="#808080">]] </font><font color="#0000FF">then
   if </font>sacao<font color="#808080">==[[</font>opSalvarInclusao<font color="#808080">]] </font><font color="#0000FF">then
      </font>escreveArq<font color="#808080">(</font>tfLivro<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGINC<font color="#808080">, </font>MSG_REGNINC<font color="#808080">)
   </font><font color="#0000FF">elseif </font>sacao<font color="#808080">==[[</font>opSalvarAlteracao<font color="#808080">]] </font><font color="#0000FF">then
      </font>escreveArq<font color="#808080">(</font>tfLivro<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGALT<font color="#808080">, </font>MSG_REGNALT<font color="#808080">)
   </font><font color="#0000FF">elseif </font>sacao<font color="#808080">==[[</font>opConfirmaExclusao<font color="#808080">]] </font><font color="#0000FF">then
      </font>escreveArq<font color="#808080">(</font>tfLivro<font color="#808080">, </font>repete<font color="#808080">('*',</font>tamReg<font color="#808080">(</font>sreg<font color="#808080">)), </font>MSG_REGEXC<font color="#808080">, </font>MSG_REGNEXC<font color="#808080">)
   </font><font color="#0000FF">end
elseif </font>sreg<font color="#808080">==[[</font>opLivroAss<font color="#808080">]] </font><font color="#0000FF">then
   if </font>sacao<font color="#808080">==[[</font>opSalvarInclusao<font color="#808080">]] </font><font color="#0000FF">then
      </font>escreveArq<font color="#808080">(</font>tfLivroAss<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGINC<font color="#808080">, </font>MSG_REGNINC<font color="#808080">)
   </font><font color="#0000FF">elseif </font>sacao<font color="#808080">==[[</font>opSalvarAlteracao<font color="#808080">]] </font><font color="#0000FF">then
      </font>escreveArq<font color="#808080">(</font>tfLivroAss<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGALT<font color="#808080">, </font>MSG_REGNALT<font color="#808080">)
   </font><font color="#0000FF">elseif </font>sacao<font color="#808080">==[[</font>opConfirmaExclusao<font color="#808080">]] </font><font color="#0000FF">then
      </font>escreveArq<font color="#808080">(</font>tfLivroAss<font color="#808080">, </font>repete<font color="#808080">('*',</font>tamReg<font color="#808080">(</font>sreg<font color="#808080">)), </font>MSG_REGEXC<font color="#808080">, </font>MSG_REGNEXC<font color="#808080">)
   </font><font color="#0000FF">end
elseif </font>sreg<font color="#808080">==[[</font>opLivroAut<font color="#808080">]] </font><font color="#0000FF">then
   if </font>sacao<font color="#808080">==[[</font>opSalvarInclusao<font color="#808080">]] </font><font color="#0000FF">then
      </font>escreveArq<font color="#808080">(</font>tfLivroAut<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGINC<font color="#808080">, </font>MSG_REGNINC<font color="#808080">)
   </font><font color="#0000FF">elseif </font>sacao<font color="#808080">==[[</font>opSalvarAlteracao<font color="#808080">]] </font><font color="#0000FF">then
      </font>escreveArq<font color="#808080">(</font>tfLivroAut<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGALT<font color="#808080">, </font>MSG_REGNALT<font color="#808080">)
   </font><font color="#0000FF">elseif </font>sacao<font color="#808080">==[[</font>opConfirmaExclusao<font color="#808080">]] </font><font color="#0000FF">then
      </font>escreveArq<font color="#808080">(</font>tfLivroAut<font color="#808080">, </font>repete<font color="#808080">('*',</font>tamReg<font color="#808080">(</font>sreg<font color="#808080">)), </font>MSG_REGEXC<font color="#808080">, </font>MSG_REGNEXC<font color="#808080">)
   </font><font color="#0000FF">end
elseif </font>sreg<font color="#808080">==[[</font>opCliente<font color="#808080">]] </font><font color="#0000FF">then
   if </font>sacao<font color="#808080">==[[</font>opSalvarInclusao<font color="#808080">]] </font><font color="#0000FF">then
      </font>escreveArq<font color="#808080">(</font>tfCliente<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGINC<font color="#808080">, </font>MSG_REGNINC<font color="#808080">)
   </font><font color="#0000FF">elseif </font>sacao<font color="#808080">==[[</font>opSalvarAlteracao<font color="#808080">]] </font><font color="#0000FF">then
      </font>escreveArq<font color="#808080">(</font>tfCliente<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGALT<font color="#808080">, </font>MSG_REGNALT<font color="#808080">)
   </font><font color="#0000FF">elseif </font>sacao<font color="#808080">==[[</font>opConfirmaExclusao<font color="#808080">]] </font><font color="#0000FF">then
      </font>escreveArq<font color="#808080">(</font>tfCliente<font color="#808080">, </font>repete<font color="#808080">('*',</font>tamReg<font color="#808080">(</font>sreg<font color="#808080">)), </font>MSG_REGEXC<font color="#808080">, </font>MSG_REGNEXC<font color="#808080">)
   </font><font color="#0000FF">end
elseif </font>sreg<font color="#808080">==[[</font>opVenda<font color="#808080">]] </font><font color="#0000FF">then
   if </font>sacao<font color="#808080">==[[</font>opSalvarInclusao<font color="#808080">]] </font><font color="#0000FF">then
      </font>escreveArq<font color="#808080">(</font>tfVenda<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGINC<font color="#808080">, </font>MSG_REGNINC<font color="#808080">)
   </font><font color="#0000FF">elseif </font>sacao<font color="#808080">==[[</font>opSalvarAlteracao<font color="#808080">]] </font><font color="#0000FF">then
      </font>escreveArq<font color="#808080">(</font>tfVenda<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGALT<font color="#808080">, </font>MSG_REGNALT<font color="#808080">)
   </font><font color="#0000FF">elseif </font>sacao<font color="#808080">==[[</font>opConfirmaExclusao<font color="#808080">]] </font><font color="#0000FF">then
      </font>escreveArq<font color="#808080">(</font>tfVenda<font color="#808080">, </font>repete<font color="#808080">('*',</font>tamReg<font color="#808080">(</font>sreg<font color="#808080">)), </font>MSG_REGEXC<font color="#808080">, </font>MSG_REGNEXC<font color="#808080">)
   </font><font color="#0000FF">end
elseif </font>sreg<font color="#808080">==[[</font>opUsuario<font color="#808080">]] </font><font color="#0000FF">then
   if </font>sacao<font color="#808080">==[[</font>opSalvarAlteracao<font color="#808080">]] </font><font color="#0000FF">then
      </font>escreveArq<font color="#808080">(</font>tfUsuario<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGALT<font color="#808080">, </font>MSG_REGNALT<font color="#808080">)
   </font><font color="#0000FF">end
end
end

</font><font color="#008080">-------------------------------------------------------------------------------
-- Seleciona o menu e/ou a tela certa de acordo com o tipo de arquivo.
-- nmenu - o n&uacute;mero do menu
-- sreg - o tipo de arquivo
-------------------------------------------------------------------------------
</font><font color="#0000FF">function </font>subMenu<font color="#808080">(</font>nmenu<font color="#808080">, </font>sreg<font color="#808080">)
</font>bSOp<font color="#808080">=</font><font color="#0000FF">true
if </font>nmenu<font color="#808080">==</font><font color="#FF0000">6 </font><font color="#0000FF">then
  while</font><font color="#808080">(</font>bSOp<font color="#808080">) </font><font color="#0000FF">do
    </font>menu<font color="#808080">(</font>nmenu<font color="#808080">)
    </font>opSubMenu <font color="#808080">= </font>digita<font color="#808080">()
    </font><font color="#0000FF">if </font>opSubMenu<font color="#808080">=='</font><font color="#FF0000">1</font><font color="#808080">' </font><font color="#0000FF">then </font>frmCadastros<font color="#808080">(</font>sreg<font color="#808080">, [[</font>opNovo<font color="#808080">]])
    </font><font color="#0000FF">elseif </font>opSubMenu<font color="#808080">=='</font><font color="#FF0000">2</font><font color="#808080">' </font><font color="#0000FF">then </font>frmCadastros<font color="#808080">(</font>sreg<font color="#808080">, [[</font>opPesquisar<font color="#808080">]])
    </font><font color="#0000FF">elseif </font>opSubMenu<font color="#808080">=='</font><font color="#FF0000">3</font><font color="#808080">' </font><font color="#0000FF">then </font>bSOp<font color="#808080">=</font><font color="#0000FF">false
    else </font>print<font color="#808080">(</font>MSG_ERRO<font color="#808080">) </font><font color="#0000FF">end
  end
elseif </font>nmenu<font color="#808080">==</font><font color="#FF0000">7 </font><font color="#0000FF">then
  while</font><font color="#808080">(</font>bSOp<font color="#808080">) </font><font color="#0000FF">do 
    </font>menu<font color="#808080">(</font>nmenu<font color="#808080">)
    </font>opSubMenu <font color="#808080">= </font>digita<font color="#808080">()
    </font><font color="#0000FF">if </font>opSubMenu<font color="#808080">=='</font><font color="#FF0000">1</font><font color="#808080">' </font><font color="#0000FF">then 
      </font>btnAcao<font color="#808080">(</font>sreg<font color="#808080">, [[</font>opSalvarInclusao<font color="#808080">]]) 
      </font>bSOp<font color="#808080">=</font><font color="#0000FF">false 
    elseif </font>opSubMenu<font color="#808080">=='</font><font color="#FF0000">2</font><font color="#808080">' </font><font color="#0000FF">then </font>bSOp<font color="#808080">=</font><font color="#0000FF">false
    else </font>print<font color="#808080">(</font>MSG_ERRO<font color="#808080">) </font><font color="#0000FF">end
  end
elseif </font>nmenu<font color="#808080">==</font><font color="#FF0000">8 </font><font color="#0000FF">then
  while</font><font color="#808080">(</font>bSOp<font color="#808080">) </font><font color="#0000FF">do 
    </font>menu<font color="#808080">(</font>nmenu<font color="#808080">)
    </font>opSubMenu <font color="#808080">= </font>digita<font color="#808080">()
    </font><font color="#0000FF">if </font>opSubMenu<font color="#808080">=='</font><font color="#FF0000">1</font><font color="#808080">' </font><font color="#0000FF">then 
      </font>frmCadastros<font color="#808080">(</font>sreg<font color="#808080">, [[</font>opAlterar<font color="#808080">]]) 
      </font>bSOp<font color="#808080">=</font><font color="#0000FF">false
    elseif </font>opSubMenu<font color="#808080">=='</font><font color="#FF0000">2</font><font color="#808080">' </font><font color="#0000FF">then 
      </font>frmCadastros<font color="#808080">(</font>sreg<font color="#808080">, [[</font>opExcluir<font color="#808080">]]) 
      </font>bSOp<font color="#808080">=</font><font color="#0000FF">false
    elseif </font>opSubMenu<font color="#808080">=='</font><font color="#FF0000">3</font><font color="#808080">' </font><font color="#0000FF">then </font>bSOp<font color="#808080">=</font><font color="#0000FF">false
    else </font>print<font color="#808080">(</font>MSG_ERRO<font color="#808080">) </font><font color="#0000FF">end
  end
elseif </font>nmenu<font color="#808080">==</font><font color="#FF0000">9 </font><font color="#0000FF">then
  while</font><font color="#808080">(</font>bSOp<font color="#808080">) </font><font color="#0000FF">do 
    </font>menu<font color="#808080">(</font>nmenu<font color="#808080">)
    </font>opSubMenu <font color="#808080">= </font>digita<font color="#808080">()
    </font><font color="#0000FF">if </font>opSubMenu<font color="#808080">=='</font><font color="#FF0000">1</font><font color="#808080">' </font><font color="#0000FF">then 
      </font>btnAcao<font color="#808080">(</font>sreg<font color="#808080">, [[</font>opSalvarAlteracao<font color="#808080">]]) 
      </font>bSOp<font color="#808080">=</font><font color="#0000FF">false
    elseif </font>opSubMenu<font color="#808080">=='</font><font color="#FF0000">2</font><font color="#808080">' </font><font color="#0000FF">then </font>bSOp<font color="#808080">=</font><font color="#0000FF">false
    else </font>print<font color="#808080">(</font>MSG_ERRO<font color="#808080">) </font><font color="#0000FF">end
  end
elseif </font>nmenu<font color="#808080">==</font><font color="#FF0000">10 </font><font color="#0000FF">then
  while</font><font color="#808080">(</font>bSOp<font color="#808080">) </font><font color="#0000FF">do 
    </font>menu<font color="#808080">(</font>nmenu<font color="#808080">)
    </font>opCSubMenu <font color="#808080">= </font>digita<font color="#808080">()
    </font><font color="#0000FF">if </font><font color="#808080">(</font>opCSubMenu<font color="#808080">=='</font>S<font color="#808080">') </font><font color="#0000FF">or </font><font color="#808080">(</font>opCSubMenu<font color="#808080">=='</font>s<font color="#808080">') </font><font color="#0000FF">then 
      </font>btnAcao<font color="#808080">(</font>sreg<font color="#808080">, [[</font>opConfirmaExclusao<font color="#808080">]])
      </font>bSOp<font color="#808080">=</font><font color="#0000FF">false
    elseif </font><font color="#808080">(</font>opCSubMenu<font color="#808080">=='</font>N<font color="#808080">') </font><font color="#0000FF">or </font><font color="#808080">(</font>opCSubMenu<font color="#808080">=='</font>n<font color="#808080">') </font><font color="#0000FF">then </font>bSOp<font color="#808080">=</font><font color="#0000FF">false
    else </font>print<font color="#808080">(</font>MSG_ERRO<font color="#808080">) </font><font color="#0000FF">end
  end
elseif </font>nmenu<font color="#808080">==</font><font color="#FF0000">12 </font><font color="#0000FF">then
  while</font><font color="#808080">(</font>bSOp<font color="#808080">) </font><font color="#0000FF">do 
    </font>menu<font color="#808080">(</font>nmenu<font color="#808080">)
    </font>opSubMenu <font color="#808080">= </font>digita<font color="#808080">()
    </font><font color="#0000FF">if </font>opSubMenu<font color="#808080">=='</font><font color="#FF0000">1</font><font color="#808080">' </font><font color="#0000FF">then </font>frmConsultas<font color="#808080">(</font>sreg<font color="#808080">, [[</font>opPesquisar<font color="#808080">]])
    </font><font color="#0000FF">elseif </font>opSubMenu<font color="#808080">=='</font><font color="#FF0000">2</font><font color="#808080">' </font><font color="#0000FF">then </font>frmConsultas<font color="#808080">(</font>sreg<font color="#808080">, [[</font>opListarTodos<font color="#808080">]])
    </font><font color="#0000FF">elseif </font>opSubMenu<font color="#808080">=='</font><font color="#FF0000">3</font><font color="#808080">' </font><font color="#0000FF">then </font>bSOp<font color="#808080">=</font><font color="#0000FF">false
    else </font>print<font color="#808080">(</font>MSG_ERRO<font color="#808080">) </font><font color="#0000FF">end
  end
elseif </font>nmenu<font color="#808080">==</font><font color="#FF0000">14 </font><font color="#0000FF">then
  while</font><font color="#808080">(</font>bSOp<font color="#808080">) </font><font color="#0000FF">do 
    </font>menu<font color="#808080">(</font>nmenu<font color="#808080">)
    </font>opCSubMenu <font color="#808080">= </font>digita<font color="#808080">()
    </font><font color="#0000FF">if </font><font color="#808080">(</font>opCSubMenu<font color="#808080">=='</font>S<font color="#808080">') </font><font color="#0000FF">or </font><font color="#808080">(</font>opCSubMenu<font color="#808080">=='</font>s<font color="#808080">') </font><font color="#0000FF">then 
       </font>btnAcao<font color="#808080">(</font>sreg<font color="#808080">, [[</font>opSalvarInclusao<font color="#808080">]])
       </font>bSOp<font color="#808080">=</font><font color="#0000FF">false
       </font>g_SalvarInclusao<font color="#808080">=</font><font color="#0000FF">true
    elseif </font><font color="#808080">(</font>opCSubMenu<font color="#808080">=='</font>N<font color="#808080">') </font><font color="#0000FF">or </font><font color="#808080">(</font>opCSubMenu<font color="#808080">=='</font>n<font color="#808080">') </font><font color="#0000FF">then </font>bSOp<font color="#808080">=</font><font color="#0000FF">false
    else </font>print<font color="#808080">(</font>MSG_ERRO<font color="#808080">) </font><font color="#0000FF">end
  end
end

end

</font><font color="#008080">-------------------------------------------------------------------------------
-- Seleciona o submenu e/ou a tela certa de acordo com n&uacute;mero do menu.
-- nmenu - o n&uacute;mero do menu
-------------------------------------------------------------------------------
</font><font color="#0000FF">function </font>usaMenu<font color="#808080">(</font>num<font color="#808080">)
 </font>bSOp<font color="#808080">=</font><font color="#0000FF">true
 if </font>num <font color="#808080">== </font><font color="#FF0000">1 </font><font color="#0000FF">then </font><font color="#008080">-- Cadastros 
   </font><font color="#0000FF">while</font><font color="#808080">(</font>bSOp<font color="#808080">) </font><font color="#0000FF">do 
     </font>menu<font color="#808080">(</font><font color="#FF0000">2</font><font color="#808080">)
     </font>opSubMenu <font color="#808080">= </font>digita<font color="#808080">()
     </font><font color="#0000FF">if </font>opSubMenu<font color="#808080">=='</font><font color="#FF0000">1</font><font color="#808080">' </font><font color="#0000FF">then </font>subMenu<font color="#808080">(</font><font color="#FF0000">6</font><font color="#808080">, [[</font>opAssunto<font color="#808080">]])
     </font><font color="#0000FF">elseif </font>opSubMenu<font color="#808080">=='</font><font color="#FF0000">2</font><font color="#808080">' </font><font color="#0000FF">then </font>subMenu<font color="#808080">(</font><font color="#FF0000">6</font><font color="#808080">, [[</font>opAutor<font color="#808080">]])
     </font><font color="#0000FF">elseif </font>opSubMenu<font color="#808080">=='</font><font color="#FF0000">3</font><font color="#808080">' </font><font color="#0000FF">then </font>subMenu<font color="#808080">(</font><font color="#FF0000">6</font><font color="#808080">, [[</font>opEditora<font color="#808080">]])
     </font><font color="#0000FF">elseif </font>opSubMenu<font color="#808080">=='</font><font color="#FF0000">4</font><font color="#808080">' </font><font color="#0000FF">then </font>subMenu<font color="#808080">(</font><font color="#FF0000">6</font><font color="#808080">, [[</font>opEndereco<font color="#808080">]])
     </font><font color="#0000FF">elseif </font>opSubMenu<font color="#808080">=='</font><font color="#FF0000">5</font><font color="#808080">' </font><font color="#0000FF">then </font>subMenu<font color="#808080">(</font><font color="#FF0000">6</font><font color="#808080">, [[</font>opIdioma<font color="#808080">]])
     </font><font color="#0000FF">elseif </font>opSubMenu<font color="#808080">=='</font><font color="#FF0000">6</font><font color="#808080">' </font><font color="#0000FF">then </font>subMenu<font color="#808080">(</font><font color="#FF0000">6</font><font color="#808080">, [[</font>opPais<font color="#808080">]])
     </font><font color="#0000FF">elseif </font>opSubMenu<font color="#808080">=='</font><font color="#FF0000">7</font><font color="#808080">' </font><font color="#0000FF">then </font>subMenu<font color="#808080">(</font><font color="#FF0000">6</font><font color="#808080">, [[</font>opProfissao<font color="#808080">]])
     </font><font color="#0000FF">elseif </font>opSubMenu<font color="#808080">=='</font><font color="#FF0000">8</font><font color="#808080">' </font><font color="#0000FF">then </font>subMenu<font color="#808080">(</font><font color="#FF0000">6</font><font color="#808080">, [[</font>opCliente<font color="#808080">]])
     </font><font color="#0000FF">elseif </font>opSubMenu<font color="#808080">=='</font><font color="#FF0000">9</font><font color="#808080">' </font><font color="#0000FF">then </font>subMenu<font color="#808080">(</font><font color="#FF0000">6</font><font color="#808080">, [[</font>opLivro<font color="#808080">]])
     </font><font color="#0000FF">elseif </font>opSubMenu<font color="#808080">=='</font><font color="#FF0000">10</font><font color="#808080">' </font><font color="#0000FF">then </font>bSOp<font color="#808080">=</font><font color="#0000FF">false
     else </font>print<font color="#808080">(</font>MSG_ERRO<font color="#808080">) </font><font color="#0000FF">end
   end
 elseif </font>num <font color="#808080">== </font><font color="#FF0000">2 </font><font color="#0000FF">then  </font><font color="#008080">-- Pesquisas 
   </font><font color="#0000FF">while</font><font color="#808080">(</font>bSOp<font color="#808080">) </font><font color="#0000FF">do 
     </font>menu<font color="#808080">(</font><font color="#FF0000">3</font><font color="#808080">)
     </font>opSubMenu <font color="#808080">= </font>digita<font color="#808080">()
     </font><font color="#0000FF">if </font>opSubMenu<font color="#808080">=='</font><font color="#FF0000">1</font><font color="#808080">' </font><font color="#0000FF">then </font>subMenu<font color="#808080">(</font><font color="#FF0000">12</font><font color="#808080">, [[</font>opAssunto<font color="#808080">]])
     </font><font color="#0000FF">elseif </font>opSubMenu<font color="#808080">=='</font><font color="#FF0000">2</font><font color="#808080">' </font><font color="#0000FF">then </font>subMenu<font color="#808080">(</font><font color="#FF0000">12</font><font color="#808080">, [[</font>opAutor<font color="#808080">]])
     </font><font color="#0000FF">elseif </font>opSubMenu<font color="#808080">=='</font><font color="#FF0000">3</font><font color="#808080">' </font><font color="#0000FF">then </font>subMenu<font color="#808080">(</font><font color="#FF0000">12</font><font color="#808080">, [[</font>opEditora<font color="#808080">]])
     </font><font color="#0000FF">elseif </font>opSubMenu<font color="#808080">=='</font><font color="#FF0000">4</font><font color="#808080">' </font><font color="#0000FF">then </font>subMenu<font color="#808080">(</font><font color="#FF0000">12</font><font color="#808080">, [[</font>opEndereco<font color="#808080">]])
     </font><font color="#0000FF">elseif </font>opSubMenu<font color="#808080">=='</font><font color="#FF0000">5</font><font color="#808080">' </font><font color="#0000FF">then </font>subMenu<font color="#808080">(</font><font color="#FF0000">12</font><font color="#808080">, [[</font>opIdioma<font color="#808080">]])
     </font><font color="#0000FF">elseif </font>opSubMenu<font color="#808080">=='</font><font color="#FF0000">6</font><font color="#808080">' </font><font color="#0000FF">then </font>subMenu<font color="#808080">(</font><font color="#FF0000">12</font><font color="#808080">, [[</font>opPais<font color="#808080">]])
     </font><font color="#0000FF">elseif </font>opSubMenu<font color="#808080">=='</font><font color="#FF0000">7</font><font color="#808080">' </font><font color="#0000FF">then </font>subMenu<font color="#808080">(</font><font color="#FF0000">12</font><font color="#808080">, [[</font>opProfissao<font color="#808080">]])
     </font><font color="#0000FF">elseif </font>opSubMenu<font color="#808080">=='</font><font color="#FF0000">8</font><font color="#808080">' </font><font color="#0000FF">then </font>subMenu<font color="#808080">(</font><font color="#FF0000">12</font><font color="#808080">, [[</font>opCliente<font color="#808080">]])
     </font><font color="#0000FF">elseif </font>opSubMenu<font color="#808080">=='</font><font color="#FF0000">9</font><font color="#808080">' </font><font color="#0000FF">then </font>subMenu<font color="#808080">(</font><font color="#FF0000">12</font><font color="#808080">, [[</font>opLivro<font color="#808080">]])
     </font><font color="#0000FF">elseif </font>opSubMenu<font color="#808080">=='</font><font color="#FF0000">10</font><font color="#808080">' </font><font color="#0000FF">then </font>bSOp<font color="#808080">=</font><font color="#0000FF">false
     else </font>print<font color="#808080">(</font>MSG_ERRO<font color="#808080">) </font><font color="#0000FF">end
   end
 elseif </font>num <font color="#808080">== </font><font color="#FF0000">3 </font><font color="#0000FF">then  </font><font color="#008080">-- Vendas 
   </font><font color="#0000FF">while</font><font color="#808080">(</font>bSOp<font color="#808080">) </font><font color="#0000FF">do 
     </font>menu<font color="#808080">(</font><font color="#FF0000">4</font><font color="#808080">)
     </font>opSubMenu <font color="#808080">= </font>digita<font color="#808080">()
     </font><font color="#0000FF">if </font>opSubMenu<font color="#808080">=='</font><font color="#FF0000">1</font><font color="#808080">' </font><font color="#0000FF">then </font>subMenu<font color="#808080">(</font><font color="#FF0000">6</font><font color="#808080">, [[</font>opVenda<font color="#808080">]])
     </font><font color="#0000FF">elseif </font>opSubMenu<font color="#808080">=='</font><font color="#FF0000">2</font><font color="#808080">' </font><font color="#0000FF">then </font>subMenu<font color="#808080">(</font><font color="#FF0000">12</font><font color="#808080">, [[</font>opVenda<font color="#808080">]])
     </font><font color="#0000FF">elseif </font>opSubMenu<font color="#808080">=='</font><font color="#FF0000">3</font><font color="#808080">' </font><font color="#0000FF">then </font>bSOp<font color="#808080">=</font><font color="#0000FF">false
     else </font>print<font color="#808080">(</font>MSG_ERRO<font color="#808080">) </font><font color="#0000FF">end
   end
 elseif </font>num <font color="#808080">== </font><font color="#FF0000">4 </font><font color="#0000FF">then  </font><font color="#008080">-- Opcoes 
   </font><font color="#0000FF">while</font><font color="#808080">(</font>bSOp<font color="#808080">) </font><font color="#0000FF">do 
     </font>menu<font color="#808080">(</font><font color="#FF0000">5</font><font color="#808080">)
     </font>opSubMenu <font color="#808080">= </font>digita<font color="#808080">()
     </font><font color="#0000FF">if </font>opSubMenu<font color="#808080">=='</font><font color="#FF0000">1</font><font color="#808080">' </font><font color="#0000FF">then </font>frmAlterarSenha<font color="#808080">()
     </font><font color="#0000FF">elseif </font>opSubMenu<font color="#808080">=='</font><font color="#FF0000">2</font><font color="#808080">' </font><font color="#0000FF">then </font>frmSobre<font color="#808080">()
     </font><font color="#0000FF">elseif </font>opSubMenu<font color="#808080">=='</font><font color="#FF0000">3</font><font color="#808080">' </font><font color="#0000FF">then
       </font>menu<font color="#808080">(</font><font color="#FF0000">11</font><font color="#808080">)
       </font>opSair <font color="#808080">= </font>digita<font color="#808080">()
       </font><font color="#0000FF">if </font><font color="#808080">(</font>opSair<font color="#808080">=='</font>S<font color="#808080">') </font><font color="#0000FF">or </font><font color="#808080">(</font>opSair<font color="#808080">=='</font>s<font color="#808080">') </font><font color="#0000FF">then 
          </font>fechaArqs<font color="#808080">()
          </font>os.exit<font color="#808080">(</font><font color="#FF0000">0</font><font color="#808080">)
       </font><font color="#0000FF">end
     elseif </font>opSubMenu<font color="#808080">=='</font><font color="#FF0000">4</font><font color="#808080">' </font><font color="#0000FF">then </font>bSOp<font color="#808080">=</font><font color="#0000FF">false
     else </font>print<font color="#808080">(</font>MSG_ERRO<font color="#808080">) </font><font color="#0000FF">end
   end
 end
end

</font><font color="#008080">-------------------------------------------------------------------------------
-- Mostra as entradas e as sa&iacute;das do sistema.
-- sreg - o tipo de arquivo
-- slinha - o registro com os dados
-- nOpcao - indica qual op&ccedil;&atilde;o ser&aacute; mostrada
-------------------------------------------------------------------------------
</font><font color="#0000FF">function </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font>slinha<font color="#808080">, </font>nOpcao<font color="#808080">)
</font><font color="#0000FF">if </font>sreg<font color="#808080">==[[</font>opAssunto<font color="#808080">]] </font><font color="#0000FF">then
  if </font>nOpcao<font color="#808080">==</font><font color="#FF0000">1 </font><font color="#0000FF">then
    </font>print<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">)</font>..tAssunto.codigo<font color="#808080">)
    </font>io.write<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">))
    </font>tAssunto.assunto <font color="#808080">= </font>digita<font color="#808080">()
  </font><font color="#0000FF">elseif </font>nOpcao<font color="#808080">==</font><font color="#FF0000">2 </font><font color="#0000FF">then
    </font>print<font color="#808080">('</font>C<font color="#808080">&oacute;</font>digo     Assunto<font color="#808080">')
    </font>print<font color="#808080">('</font><font color="#008080">------     -------')
  </font><font color="#0000FF">elseif </font>nOpcao<font color="#808080">==</font><font color="#FF0000">3 </font><font color="#0000FF">then
    </font>tAssunto.codigo<font color="#808080">=</font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">)
    </font>tAssunto.assunto<font color="#808080">=</font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">11</font><font color="#808080">, </font><font color="#FF0000">30</font><font color="#808080">)
    </font>print<font color="#808080">(</font>tAssunto.codigo..<font color="#808080">' '</font>..tAssunto.assunto<font color="#808080">)
  </font><font color="#0000FF">end
elseif </font>sreg<font color="#808080">==[[</font>opAutor<font color="#808080">]] </font><font color="#0000FF">then
  if </font>nOpcao<font color="#808080">==</font><font color="#FF0000">1 </font><font color="#0000FF">then
    </font>print<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">)</font>..tAutor.codigo<font color="#808080">)
    </font>io.write<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">))
    </font>tAutor.autor <font color="#808080">= </font>digita<font color="#808080">()
  </font><font color="#0000FF">elseif </font>nOpcao<font color="#808080">==</font><font color="#FF0000">2 </font><font color="#0000FF">then
    </font>print<font color="#808080">('</font>C<font color="#808080">&oacute;</font>digo     Autor<font color="#808080">')
    </font>print<font color="#808080">('</font><font color="#008080">------     -----')
  </font><font color="#0000FF">elseif </font>nOpcao<font color="#808080">==</font><font color="#FF0000">3 </font><font color="#0000FF">then
    </font>tAutor.codigo<font color="#808080">=</font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">)
    </font>tAutor.autor<font color="#808080">=</font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">11</font><font color="#808080">, </font><font color="#FF0000">30</font><font color="#808080">)
    </font>print<font color="#808080">(</font>tAutor.codigo..<font color="#808080">' '</font>..tAutor.autor<font color="#808080">)
  </font><font color="#0000FF">end
elseif </font>sreg<font color="#808080">==[[</font>opEditora<font color="#808080">]] </font><font color="#0000FF">then
  if </font>nOpcao<font color="#808080">==</font><font color="#FF0000">1 </font><font color="#0000FF">then
    </font>print<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">)</font>..tEditora.codigo<font color="#808080">)
    </font>io.write<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">))
    </font>tEditora.editora <font color="#808080">= </font>digita<font color="#808080">()
  </font><font color="#0000FF">elseif </font>nOpcao<font color="#808080">==</font><font color="#FF0000">2 </font><font color="#0000FF">then
    </font>print<font color="#808080">('</font>C<font color="#808080">&oacute;</font>digo     Editora<font color="#808080">')
    </font>print<font color="#808080">('</font><font color="#008080">------     -------')
  </font><font color="#0000FF">elseif </font>nOpcao<font color="#808080">==</font><font color="#FF0000">3 </font><font color="#0000FF">then
    </font>tEditora.codigo<font color="#808080">=</font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">)
    </font>tEditora.editora<font color="#808080">=</font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">11</font><font color="#808080">, </font><font color="#FF0000">50</font><font color="#808080">)
    </font>print<font color="#808080">(</font>tEditora.codigo..<font color="#808080">' '</font>..tEditora.editora<font color="#808080">)
  </font><font color="#0000FF">end
elseif </font>sreg<font color="#808080">==[[</font>opEndereco<font color="#808080">]] </font><font color="#0000FF">then
  if </font>nOpcao<font color="#808080">==</font><font color="#FF0000">1 </font><font color="#0000FF">then
    </font>print<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">)</font>..tEndereco.codigo<font color="#808080">)
    </font>io.write<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">))
    </font>tEndereco.Logradouro <font color="#808080">= </font>digita<font color="#808080">()
    </font>io.write<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">))
    </font>tEndereco.bairro <font color="#808080">= </font>digita<font color="#808080">()
    </font>io.write<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">4</font><font color="#808080">))
    </font>tEndereco.cep <font color="#808080">= </font>digita<font color="#808080">()
    </font>io.write<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">5</font><font color="#808080">))
    </font>tEndereco.cidade <font color="#808080">= </font>digita<font color="#808080">()
    </font>io.write<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">6</font><font color="#808080">))
    </font>tEndereco.estado <font color="#808080">= </font>digita<font color="#808080">()
  </font><font color="#0000FF">elseif </font>nOpcao<font color="#808080">==</font><font color="#FF0000">3 </font><font color="#0000FF">then
    </font>tEndereco.codigo<font color="#808080">=</font>trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">))
    </font>tEndereco.logradouro<font color="#808080">=</font>trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">11</font><font color="#808080">, </font><font color="#FF0000">40</font><font color="#808080">))
    </font>tEndereco.bairro<font color="#808080">=</font>trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">51</font><font color="#808080">, </font><font color="#FF0000">15</font><font color="#808080">))
    </font>tEndereco.cep<font color="#808080">=</font>trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">66</font><font color="#808080">, </font><font color="#FF0000">8</font><font color="#808080">))
    </font>tEndereco.cidade<font color="#808080">=</font>trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">74</font><font color="#808080">, </font><font color="#FF0000">30</font><font color="#808080">))
    </font>tEndereco.estado<font color="#808080">=</font>trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">104</font><font color="#808080">, </font><font color="#FF0000">20</font><font color="#808080">))
    </font>print<font color="#808080">('</font><font color="#008080">--------------------')
    </font>print<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">)</font>..tEndereco.codigo<font color="#808080">)
    </font>print<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">)</font>..tEndereco.Logradouro<font color="#808080">)
    </font>print<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">)</font>..tEndereco.bairro<font color="#808080">)
    </font>print<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">4</font><font color="#808080">)</font>..tEndereco.cep<font color="#808080">)
    </font>print<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">5</font><font color="#808080">)</font>..tEndereco.cidade<font color="#808080">)
    </font>print<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">6</font><font color="#808080">)</font>..tEndereco.estado<font color="#808080">)
  </font><font color="#0000FF">end
elseif </font>sreg<font color="#808080">==[[</font>opIdioma<font color="#808080">]] </font><font color="#0000FF">then
  if </font>nOpcao<font color="#808080">==</font><font color="#FF0000">1 </font><font color="#0000FF">then
    </font>print<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">)</font>..tIdioma.codigo<font color="#808080">)
    </font>io.write<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">))
    </font>tIdioma.idioma <font color="#808080">= </font>digita<font color="#808080">()
  </font><font color="#0000FF">elseif </font>nOpcao<font color="#808080">==</font><font color="#FF0000">2 </font><font color="#0000FF">then
    </font>print<font color="#808080">('</font>C<font color="#808080">&oacute;</font>digo     Idioma<font color="#808080">')
    </font>print<font color="#808080">('</font><font color="#008080">------     ------')
  </font><font color="#0000FF">elseif </font>nOpcao<font color="#808080">==</font><font color="#FF0000">3 </font><font color="#0000FF">then
    </font>tIdioma.codigo<font color="#808080">=</font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">)
    </font>tIdioma.idioma<font color="#808080">=</font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">11</font><font color="#808080">, </font><font color="#FF0000">20</font><font color="#808080">)
    </font>print<font color="#808080">(</font>tIdioma.codigo..<font color="#808080">' '</font>..tIdioma.idioma<font color="#808080">)
  </font><font color="#0000FF">end
elseif </font>sreg<font color="#808080">==[[</font>opPais<font color="#808080">]] </font><font color="#0000FF">then
  if </font>nOpcao<font color="#808080">==</font><font color="#FF0000">1 </font><font color="#0000FF">then
    </font>io.write<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">))
    </font>tPais.pais <font color="#808080">= </font>digita<font color="#808080">()
  </font><font color="#0000FF">elseif </font>nOpcao<font color="#808080">==</font><font color="#FF0000">2 </font><font color="#0000FF">then
    </font>print<font color="#808080">('</font>C<font color="#808080">&oacute;</font>digo Pa<font color="#808080">&iacute;</font>s<font color="#808080">')
    </font>print<font color="#808080">('</font><font color="#008080">------ ----')
  </font><font color="#0000FF">elseif </font>nOpcao<font color="#808080">==</font><font color="#FF0000">3 </font><font color="#0000FF">then
    </font>tPais.codigo<font color="#808080">=</font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">)
    </font>tPais.pais<font color="#808080">=</font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">4</font><font color="#808080">, </font><font color="#FF0000">50</font><font color="#808080">)
    </font>print<font color="#808080">(</font>tPais.codigo..<font color="#808080">'    '</font>..tPais.pais<font color="#808080">)
  </font><font color="#0000FF">end
elseif </font>sreg<font color="#808080">==[[</font>opProfissao<font color="#808080">]] </font><font color="#0000FF">then
  if </font>nOpcao<font color="#808080">==</font><font color="#FF0000">1 </font><font color="#0000FF">then
    </font>print<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">)</font>..tProfissao.codigo<font color="#808080">)
    </font>io.write<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">))
    </font>tProfissao.profissao <font color="#808080">= </font>digita<font color="#808080">()
  </font><font color="#0000FF">elseif </font>nOpcao<font color="#808080">==</font><font color="#FF0000">2 </font><font color="#0000FF">then
    </font>print<font color="#808080">('</font>C<font color="#808080">&oacute;</font>digo     Profiss<font color="#808080">&atilde;</font>o<font color="#808080">')
    </font>print<font color="#808080">('</font><font color="#008080">------     ---------')
  </font><font color="#0000FF">elseif </font>nOpcao<font color="#808080">==</font><font color="#FF0000">3 </font><font color="#0000FF">then
    </font>tProfissao.codigo<font color="#808080">=</font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">)
    </font>tProfissao.profissao<font color="#808080">=</font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">11</font><font color="#808080">, </font><font color="#FF0000">50</font><font color="#808080">)
    </font>print<font color="#808080">(</font>tProfissao.codigo..<font color="#808080">' '</font>..tProfissao.profissao<font color="#808080">)
  </font><font color="#0000FF">end
elseif </font>sreg<font color="#808080">==[[</font>opLivro<font color="#808080">]] </font><font color="#0000FF">then
  if </font>nOpcao<font color="#808080">==</font><font color="#FF0000">1 </font><font color="#0000FF">then
    </font>io.write<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">))
    </font>tLivro.titulo <font color="#808080">= </font>digita<font color="#808080">()
    </font>tLivro.edicao<font color="#808080">=</font>validaNumero<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">), </font>tLivro.edicao<font color="#808080">)
    </font>tLivro.anopubli<font color="#808080">=</font>validaNumero<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">4</font><font color="#808080">), </font>tLivro.anopubli<font color="#808080">)
    </font>mostrarSubDados<font color="#808080">([[</font>opLivro<font color="#808080">]], [[</font>opEditora<font color="#808080">]], </font><font color="#0000FF">false</font><font color="#808080">)
    </font>tLivro.volume<font color="#808080">=</font>validaNumero<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">6</font><font color="#808080">), </font>tLivro.volume<font color="#808080">)
    </font>mostrarSubDados<font color="#808080">([[</font>opLivro<font color="#808080">]], [[</font>opIdioma<font color="#808080">]], </font><font color="#0000FF">false</font><font color="#808080">)
    </font>tLivro.npaginas<font color="#808080">=</font>validaNumero<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">8</font><font color="#808080">), </font>tLivro.npaginas<font color="#808080">)
    </font>tLivro.preco<font color="#808080">=</font>validaNumero<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">9</font><font color="#808080">), </font>tLivro.preco<font color="#808080">)
    </font>tLivro.qtdestoque<font color="#808080">=</font>validaNumero<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">), </font>tLivro.qtdestoque<font color="#808080">)
  </font><font color="#0000FF">elseif </font>nOpcao<font color="#808080">==</font><font color="#FF0000">3 </font><font color="#0000FF">then
    </font>tLivro.isbn<font color="#808080">=</font>trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">13</font><font color="#808080">))
    </font>tLivro.titulo<font color="#808080">=</font>trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">14</font><font color="#808080">, </font><font color="#FF0000">50</font><font color="#808080">))
    </font>tLivro.edicao<font color="#808080">=</font>trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">64</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">))
    </font>tLivro.anopubli<font color="#808080">=</font>trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">74</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">))
    </font>tLivro.codeditora<font color="#808080">=</font>trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">84</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">))
    </font>tLivro.volume<font color="#808080">=</font>trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">94</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">))
    </font>tLivro.codidioma<font color="#808080">=</font>trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">104</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">))
    </font>tLivro.npaginas<font color="#808080">=</font>trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">114</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">))
    </font>tLivro.preco<font color="#808080">=</font>trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">124</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">))
    </font>tLivro.qtdestoque<font color="#808080">=</font>trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">134</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">))
    </font>print<font color="#808080">('</font><font color="#008080">--------------------')
    </font>print<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">)</font>..tLivro.isbn<font color="#808080">)
    </font>print<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">)</font>..tLivro.titulo<font color="#808080">)
    </font>print<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">)</font>..tLivro.edicao<font color="#808080">)
    </font>print<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">4</font><font color="#808080">)</font>..tLivro.anopubli<font color="#808080">)
    </font>print<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">5</font><font color="#808080">)</font>..tLivro.codeditora<font color="#808080">)
    </font>mostrarSubDados<font color="#808080">([[</font>opLivro<font color="#808080">]], [[</font>opEditora<font color="#808080">]], </font><font color="#0000FF">true</font><font color="#808080">)
    </font>print<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">6</font><font color="#808080">)</font>..tLivro.volume<font color="#808080">)
    </font>print<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">7</font><font color="#808080">)</font>..tLivro.codidioma<font color="#808080">)
    </font>mostrarSubDados<font color="#808080">([[</font>opLivro<font color="#808080">]], [[</font>opIdioma<font color="#808080">]], </font><font color="#0000FF">true</font><font color="#808080">)
    </font>print<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">8</font><font color="#808080">)</font>..tLivro.npaginas<font color="#808080">)
    </font>print<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">9</font><font color="#808080">)</font>..tLivro.preco<font color="#808080">)
    </font>print<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">)</font>..tLivro.qtdestoque<font color="#808080">)
    </font>ListarRegLigados<font color="#808080">(</font>tfLivroAss<font color="#808080">, [[</font>opLivroAss<font color="#808080">]], </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">13</font><font color="#808080">, </font><font color="#FF0000">14</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">, </font>tLivro.isbn<font color="#808080">,
                     </font>tfAssunto<font color="#808080">, [[</font>opAssunto<font color="#808080">]], </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">4</font><font color="#808080">)
    </font>ListarRegLigados<font color="#808080">(</font>tfLivroAut<font color="#808080">, [[</font>opLivroAut<font color="#808080">]], </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">13</font><font color="#808080">, </font><font color="#FF0000">14</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">, </font>tLivro.isbn<font color="#808080">,
                     </font>tfAutor<font color="#808080">, [[</font>opAutor<font color="#808080">]], </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">4</font><font color="#808080">)
  </font><font color="#0000FF">end
elseif </font>sreg<font color="#808080">==[[</font>opCliente<font color="#808080">]] </font><font color="#0000FF">then
  if </font>nOpcao<font color="#808080">==</font><font color="#FF0000">1 </font><font color="#0000FF">then
    </font>io.write<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">))
    </font>tCliente.nome <font color="#808080">= </font>digita<font color="#808080">()
    </font>io.write<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">))
    </font>tCliente.email <font color="#808080">= </font>digita<font color="#808080">()
    </font>io.write<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">4</font><font color="#808080">))
    </font>tCliente.identidade <font color="#808080">= </font>digita<font color="#808080">()
    </font>io.write<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">5</font><font color="#808080">))
    </font>tCliente.sexo <font color="#808080">= </font>digita<font color="#808080">()
    </font>io.write<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">6</font><font color="#808080">))
    </font>tCliente.telefone <font color="#808080">= </font>digita<font color="#808080">()
    </font>tCliente.dtnascimento<font color="#808080">=
            </font>validaDataHora<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">7</font><font color="#808080">), </font>tCliente.dtnascimento<font color="#808080">, </font><font color="#0000FF">true</font><font color="#808080">)
    </font>mostrarSubDados<font color="#808080">([[</font>opCliente<font color="#808080">]], [[</font>opEndereco<font color="#808080">]], </font><font color="#0000FF">false</font><font color="#808080">)
    </font>mostrarSubDados<font color="#808080">([[</font>opCliente<font color="#808080">]], [[</font>opPais<font color="#808080">]], </font><font color="#0000FF">false</font><font color="#808080">)
    </font>mostrarSubDados<font color="#808080">([[</font>opCliente<font color="#808080">]], [[</font>opProfissao<font color="#808080">]], </font><font color="#0000FF">false</font><font color="#808080">)
  </font><font color="#0000FF">elseif </font>nOpcao<font color="#808080">==</font><font color="#FF0000">3 </font><font color="#0000FF">then
    </font>tCliente.cpf<font color="#808080">=</font>trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">14</font><font color="#808080">))
    </font>tCliente.nome<font color="#808080">=</font>trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">15</font><font color="#808080">, </font><font color="#FF0000">30</font><font color="#808080">))
    </font>tCliente.email<font color="#808080">=</font>trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">45</font><font color="#808080">, </font><font color="#FF0000">30</font><font color="#808080">))
    </font>tCliente.identidade<font color="#808080">=</font>trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">75</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">))
    </font>tCliente.sexo<font color="#808080">=</font>trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">85</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">))
    </font>tCliente.telefone<font color="#808080">=</font>trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">86</font><font color="#808080">, </font><font color="#FF0000">17</font><font color="#808080">))
    </font>tCliente.dtnascimento<font color="#808080">=</font>trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">103</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">))
    </font>tCliente.codendereco<font color="#808080">=</font>trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">113</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">))
    </font>tCliente.codpais<font color="#808080">=</font>trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">123</font><font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">))
    </font>tCliente.codprofissao<font color="#808080">=</font>trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">126</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">))
    </font>print<font color="#808080">('</font><font color="#008080">--------------------')
    </font>print<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">)</font>..tCliente.cpf<font color="#808080">)
    </font>print<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">)</font>..tCliente.nome<font color="#808080">)
    </font>print<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">)</font>..tCliente.email<font color="#808080">)
    </font>print<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">4</font><font color="#808080">)</font>..tCliente.identidade<font color="#808080">)
    </font>print<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">5</font><font color="#808080">)</font>..tCliente.sexo<font color="#808080">)
    </font>print<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">6</font><font color="#808080">)</font>..tCliente.telefone<font color="#808080">)
    </font>print<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">7</font><font color="#808080">)</font>..tCliente.dtnascimento<font color="#808080">)
    </font>print<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">8</font><font color="#808080">)</font>..tCliente.codendereco<font color="#808080">)
    </font>mostrarSubDados<font color="#808080">([[</font>opCliente<font color="#808080">]], [[</font>opEndereco<font color="#808080">]], </font><font color="#0000FF">true</font><font color="#808080">)
    </font>print<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">9</font><font color="#808080">)</font>..tCliente.codpais<font color="#808080">)
    </font>mostrarSubDados<font color="#808080">([[</font>opCliente<font color="#808080">]], [[</font>opPais<font color="#808080">]], </font><font color="#0000FF">true</font><font color="#808080">)
    </font>print<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">)</font>..tCliente.codprofissao<font color="#808080">)
    </font>mostrarSubDados<font color="#808080">([[</font>opCliente<font color="#808080">]], [[</font>opProfissao<font color="#808080">]], </font><font color="#0000FF">true</font><font color="#808080">)
  </font><font color="#0000FF">end
elseif </font>sreg<font color="#808080">==[[</font>opVenda<font color="#808080">]] </font><font color="#0000FF">then
  if </font>nOpcao<font color="#808080">==</font><font color="#FF0000">1 </font><font color="#0000FF">then 
    </font>mostrarSubDados<font color="#808080">([[</font>opVenda<font color="#808080">]],[[</font>opVenda<font color="#808080">]], </font><font color="#0000FF">false</font><font color="#808080">)
  </font><font color="#0000FF">elseif </font>nOpcao<font color="#808080">==</font><font color="#FF0000">2 </font><font color="#0000FF">then
    </font>print<font color="#808080">('</font>DataHoraVenda       CPF            ISBN          <font color="#808080">'</font>..
    <font color="#808080">'</font>Pre<font color="#808080">&ccedil;</font>oVenda<font color="#808080">')
    </font>print<font color="#808080">('</font><font color="#008080">-------------       ---            ----          '..
    </font><font color="#808080">'</font><font color="#008080">----------')
  </font><font color="#0000FF">elseif </font>nOpcao<font color="#808080">==</font><font color="#FF0000">3 </font><font color="#0000FF">then
    </font>tVenda.dthrvenda<font color="#808080">=</font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">19</font><font color="#808080">)
    </font>tVenda.cpf<font color="#808080">=</font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">20</font><font color="#808080">, </font><font color="#FF0000">14</font><font color="#808080">)
    </font>tVenda.isbn<font color="#808080">=</font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">34</font><font color="#808080">, </font><font color="#FF0000">13</font><font color="#808080">)
    </font>tVenda.precovenda<font color="#808080">=</font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">47</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">)
    </font>print<font color="#808080">(</font>tVenda.dthrvenda..<font color="#808080">' '</font>..tVenda.cpf..<font color="#808080">' '</font>..tVenda.isbn..<font color="#808080">' '</font>..
    tVenda.precovenda<font color="#808080">)
  </font><font color="#0000FF">end
end

end

</font><font color="#008080">-------------------------------------------------------------------------------
-- Mostra as sub inform&ccedil;&otilde;es de entrada e de sa&iacute;da.
-- sreg - o tipo de arquivo
-- ssubreg - o subtipo de arquivo
-- bSoMostrar - se vai s&oacute; mostrar na sa&iacute;da 
-------------------------------------------------------------------------------
</font><font color="#0000FF">function </font>mostrarSubDados<font color="#808080">(</font>sreg<font color="#808080">, </font>ssubreg<font color="#808080">, </font>bSoMostrar<font color="#808080">)
</font>nMaxTentativas<font color="#808080">=</font><font color="#FF0000">3
</font><font color="#0000FF">if </font>sreg<font color="#808080">==[[</font>opLivro<font color="#808080">]] </font><font color="#0000FF">then
  if </font>ssubreg<font color="#808080">==[[</font>opEditora<font color="#808080">]] </font><font color="#0000FF">then
    if </font>bSoMostrar <font color="#0000FF">then
       </font>sRegistro<font color="#808080">=</font>pesqArq<font color="#808080">(</font>tfEditora<font color="#808080">,</font>tLivro.codeditora<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">,</font>tamReg<font color="#808080">([[</font>opEditora<font color="#808080">]]))
    </font><font color="#0000FF">else
       </font>sRegistro<font color="#808080">=</font>validaEntrada<font color="#808080">(</font>tfEditora<font color="#808080">,</font>ssubreg<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font>tLivro.codeditora<font color="#808080">,
                  </font>nMaxTentativas<font color="#808080">,</font><font color="#0000FF">false</font><font color="#808080">,[[</font>opNumero<font color="#808080">]])
    </font><font color="#0000FF">end
    if </font>sRegistro<font color="#808080">~='' </font><font color="#0000FF">then
      </font>tLivro.codeditora<font color="#808080">=</font>trim<font color="#808080">(</font>copy<font color="#808080">(</font>sRegistro<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">))
      </font>io.write<font color="#808080">(' '</font>..rotulo<font color="#808080">([[</font>opEditora<font color="#808080">]], </font><font color="#FF0000">2</font><font color="#808080">))
      </font>print<font color="#808080">(</font>copy<font color="#808080">(</font>sRegistro<font color="#808080">, </font>g_nPosChave<font color="#808080">, </font>g_nTamChave<font color="#808080">))
    </font><font color="#0000FF">end
  elseif </font>ssubreg<font color="#808080">==[[</font>opIdioma<font color="#808080">]] </font><font color="#0000FF">then 
    if </font>bSoMostrar <font color="#0000FF">then
       </font>sRegistro<font color="#808080">=</font>pesqArq<font color="#808080">(</font>tfIdioma<font color="#808080">, </font>tLivro.codidioma<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">,</font>tamReg<font color="#808080">([[</font>opIdioma<font color="#808080">]]))
    </font><font color="#0000FF">else
       </font>sRegistro<font color="#808080">=</font>validaEntrada<font color="#808080">(</font>tfIdioma<font color="#808080">,</font>ssubreg<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font>tLivro.codidioma<font color="#808080">,
                  </font>nMaxTentativas<font color="#808080">,</font><font color="#0000FF">false</font><font color="#808080">,[[</font>opNumero<font color="#808080">]])
    </font><font color="#0000FF">end
    if </font>sRegistro<font color="#808080">~='' </font><font color="#0000FF">then 
      </font>tLivro.codidioma<font color="#808080">=</font>trim<font color="#808080">(</font>copy<font color="#808080">(</font>sRegistro<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">))
      </font>io.write<font color="#808080">(' '</font>..rotulo<font color="#808080">([[</font>opIdioma<font color="#808080">]], </font><font color="#FF0000">2</font><font color="#808080">))
      </font>print<font color="#808080">(</font>copy<font color="#808080">(</font>sRegistro<font color="#808080">, </font>g_nPosChave<font color="#808080">, </font>g_nTamChave<font color="#808080">))
    </font><font color="#0000FF">end
  end
elseif </font>sreg<font color="#808080">==[[</font>opCliente<font color="#808080">]] </font><font color="#0000FF">then 
  if </font>ssubreg<font color="#808080">==[[</font>opEndereco<font color="#808080">]]  </font><font color="#0000FF">then 
    if </font>bSoMostrar <font color="#0000FF">then
       </font>sRegistro<font color="#808080">=</font>pesqArq<font color="#808080">(</font>tfEndereco<font color="#808080">, </font>tCliente.codendereco<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">,
                  </font>tamReg<font color="#808080">([[</font>opEndereco<font color="#808080">]]))
    </font><font color="#0000FF">else
       </font>sRegistro<font color="#808080">=</font>validaEntrada<font color="#808080">(</font>tfEndereco<font color="#808080">,</font>ssubreg<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font>tCliente.codendereco<font color="#808080">,
                  </font>nMaxTentativas<font color="#808080">,</font><font color="#0000FF">false</font><font color="#808080">,[[</font>opNumero<font color="#808080">]])
    </font><font color="#0000FF">end
    if </font>sRegistro<font color="#808080">~='' </font><font color="#0000FF">then 
      </font>tCliente.codendereco<font color="#808080">=</font>trim<font color="#808080">(</font>copy<font color="#808080">(</font>sRegistro<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">))
      </font>io.write<font color="#808080">(' '</font>..rotulo<font color="#808080">([[</font>opEndereco<font color="#808080">]], </font><font color="#FF0000">2</font><font color="#808080">))
      </font>print<font color="#808080">(</font>copy<font color="#808080">(</font>sRegistro<font color="#808080">, </font>g_nPosChave<font color="#808080">, </font>g_nTamChave<font color="#808080">))
      </font>io.write<font color="#808080">(' '</font>..rotulo<font color="#808080">([[</font>opEndereco<font color="#808080">]], </font><font color="#FF0000">3</font><font color="#808080">))
      </font>print<font color="#808080">(</font>copy<font color="#808080">(</font>sRegistro<font color="#808080">, </font>g_nPosChave<font color="#808080">, </font>g_nTamChave<font color="#808080">))
      </font>io.write<font color="#808080">(' '</font>..rotulo<font color="#808080">([[</font>opEndereco<font color="#808080">]], </font><font color="#FF0000">4</font><font color="#808080">))
      </font>print<font color="#808080">(</font>copy<font color="#808080">(</font>sRegistro<font color="#808080">, </font>g_nPosChave<font color="#808080">, </font>g_nTamChave<font color="#808080">))
      </font>io.write<font color="#808080">(' '</font>..rotulo<font color="#808080">([[</font>opEndereco<font color="#808080">]], </font><font color="#FF0000">5</font><font color="#808080">))
      </font>print<font color="#808080">(</font>copy<font color="#808080">(</font>sRegistro<font color="#808080">, </font>g_nPosChave<font color="#808080">, </font>g_nTamChave<font color="#808080">))
      </font>io.write<font color="#808080">(' '</font>..rotulo<font color="#808080">([[</font>opEndereco<font color="#808080">]], </font><font color="#FF0000">6</font><font color="#808080">))
      </font>print<font color="#808080">(</font>copy<font color="#808080">(</font>sRegistro<font color="#808080">, </font>g_nPosChave<font color="#808080">, </font>g_nTamChave<font color="#808080">))
    </font><font color="#0000FF">end
  elseif </font>ssubreg<font color="#808080">==[[</font>opPais<font color="#808080">]] </font><font color="#0000FF">then 
    if </font>bSoMostrar <font color="#0000FF">then
       </font>sRegistro<font color="#808080">=</font>pesqArq<font color="#808080">(</font>tfPais<font color="#808080">, </font>tCliente.codpais<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">, </font>tamReg<font color="#808080">([[</font>opPais<font color="#808080">]]))
    </font><font color="#0000FF">else
       </font>sRegistro<font color="#808080">=</font>validaEntrada<font color="#808080">(</font>tfPais<font color="#808080">,</font>ssubreg<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font>tCliente.codpais<font color="#808080">,
                  </font>nMaxTentativas<font color="#808080">,</font><font color="#0000FF">false</font><font color="#808080">,[[</font>opTexto<font color="#808080">]])
    </font><font color="#0000FF">end
    if </font>sRegistro<font color="#808080">~='' </font><font color="#0000FF">then 
      </font>tCliente.codpais<font color="#808080">=</font>trim<font color="#808080">(</font>copy<font color="#808080">(</font>sRegistro<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#FF0000">3</font><font color="#808080">))
      </font>io.write<font color="#808080">(' '</font>..rotulo<font color="#808080">([[</font>opPais<font color="#808080">]], </font><font color="#FF0000">2</font><font color="#808080">))
      </font>print<font color="#808080">(</font>copy<font color="#808080">(</font>sRegistro<font color="#808080">, </font>g_nPosChave<font color="#808080">, </font>g_nTamChave<font color="#808080">))
    </font><font color="#0000FF">end
  elseif </font>ssubreg<font color="#808080">==[[</font>opProfissao<font color="#808080">]] </font><font color="#0000FF">then 
    if </font>bSoMostrar <font color="#0000FF">then
       </font>sRegistro<font color="#808080">=</font>pesqArq<font color="#808080">(</font>tfProfissao<font color="#808080">, </font>tCliente.codprofissao<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">,
                  </font>tamReg<font color="#808080">([[</font>opProfissao<font color="#808080">]]))
    </font><font color="#0000FF">else
       </font>sRegistro<font color="#808080">=</font>validaEntrada<font color="#808080">(</font>tfProfissao<font color="#808080">,</font>ssubreg<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font>tCliente.codprofissao<font color="#808080">,
                  </font>nMaxTentativas<font color="#808080">,</font><font color="#0000FF">false</font><font color="#808080">,[[</font>opNumero<font color="#808080">]])
    </font><font color="#0000FF">end
    if </font>sRegistro<font color="#808080">~='' </font><font color="#0000FF">then 
      </font>tCliente.codprofissao<font color="#808080">=</font>trim<font color="#808080">(</font>copy<font color="#808080">(</font>sRegistro<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">))
      </font>io.write<font color="#808080">(' '</font>..rotulo<font color="#808080">([[</font>opProfissao<font color="#808080">]], </font><font color="#FF0000">2</font><font color="#808080">))
      </font>print<font color="#808080">(</font>copy<font color="#808080">(</font>sRegistro<font color="#808080">, </font>g_nPosChave<font color="#808080">, </font>g_nTamChave<font color="#808080">))
    </font><font color="#0000FF">end
  end
elseif </font>sreg<font color="#808080">==[[</font>opVenda<font color="#808080">]] </font><font color="#0000FF">then 
  </font>sRegistro<font color="#808080">=</font>pesqArq<font color="#808080">(</font>tfLivro<font color="#808080">, </font>tVenda.isbn<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">13</font><font color="#808080">, </font>tamReg<font color="#808080">([[</font>opLivro<font color="#808080">]]))
  </font><font color="#0000FF">if </font>sRegistro<font color="#808080">~='' </font><font color="#0000FF">then 
    </font>io.write<font color="#808080">(' '</font>..rotulo<font color="#808080">([[</font>opLivro<font color="#808080">]], </font><font color="#FF0000">2</font><font color="#808080">)) </font><font color="#008080">-- Titulo 
    </font>print<font color="#808080">(</font>copy<font color="#808080">(</font>sRegistro<font color="#808080">, </font>g_nPosChave<font color="#808080">, </font>g_nTamChave<font color="#808080">))
    </font>io.write<font color="#808080">(' '</font>..rotulo<font color="#808080">([[</font>opLivro<font color="#808080">]], </font><font color="#FF0000">9</font><font color="#808080">)) </font><font color="#008080">-- Preco 
    </font>sPreco<font color="#808080">=</font>copy<font color="#808080">(</font>sRegistro<font color="#808080">, </font>g_nPosChave<font color="#808080">, </font>g_nTamChave<font color="#808080">)
    </font>g_nPreco <font color="#808080">= </font>tonumber<font color="#808080">(</font>sPreco<font color="#808080">)
    </font>print<font color="#808080">(</font>sPreco<font color="#808080">)
  </font><font color="#0000FF">end
end
end
</font><font color="#008080">-------------------------------------------------------------------------------
-- Realiza os cadastros dos arquivos que se ligam a outros arquivos.
-- sreg - o tipo de arquivo
-- sacao - a a&ccedil;&atilde;o a ser realizada
-- sCodigo - um das chaves do arquivo de liga&ccedil;&atilde;o
-------------------------------------------------------------------------------
</font><font color="#0000FF">function </font>frmCadLigados<font color="#808080">(</font>sreg<font color="#808080">, </font>sacao<font color="#808080">, </font>sCodigo<font color="#808080">)
</font><font color="#0000FF">if </font>sacao<font color="#808080">==[[</font>opNovo<font color="#808080">]] </font><font color="#0000FF">then 
  </font>nCont<font color="#808080">=</font><font color="#FF0000">1
  </font><font color="#0000FF">if </font>sreg<font color="#808080">==[[</font>opLivroAss<font color="#808080">]] </font><font color="#0000FF">then 
    </font>sQtd<font color="#808080">=</font>validaNumero<font color="#808080">('</font>Quantos assuntos quer cadastrar<font color="#808080">?: ', </font>sQtd<font color="#808080">)
    </font>nQtd <font color="#808080">= </font>tonumber<font color="#808080">(</font>sQtd<font color="#808080">)
    </font>tfLivroAss<font color="#808080">:</font>seek<font color="#808080">('</font>set<font color="#808080">')
    </font><font color="#0000FF">while </font>nCont <font color="#808080">&lt;= </font>nQtd <font color="#0000FF">do 
      </font>tLivroAss.isbn<font color="#808080">=</font>sCodigo
      io.write<font color="#808080">(</font>rotulo<font color="#808080">([[</font>opLivroAss<font color="#808080">]], </font><font color="#FF0000">2</font><font color="#808080">))
      </font>tLivroAss.codassunto <font color="#808080">= </font>digita<font color="#808080">()
      </font>slinha<font color="#808080">=</font>pesqArq<font color="#808080">(</font>tfAssunto<font color="#808080">, </font>tLivroAss.codassunto<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">,</font>tamReg<font color="#808080">([[</font>opAssunto<font color="#808080">]]))
      </font>io.write<font color="#808080">(' '</font>..rotulo<font color="#808080">([[</font>opAssunto<font color="#808080">]], </font><font color="#FF0000">2</font><font color="#808080">))
      </font>print<font color="#808080">(</font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font>g_nPosChave<font color="#808080">, </font>g_nTamChave<font color="#808080">))
      </font>pesqLinhaExcluida<font color="#808080">(</font>tfLivroAss<font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">))
      </font>subMenu<font color="#808080">(</font><font color="#FF0000">14</font><font color="#808080">, </font>sreg<font color="#808080">)
      </font>nCont<font color="#808080">=</font>nCont<font color="#808080">+</font><font color="#FF0000">1
    </font><font color="#0000FF">end
  elseif </font>sreg<font color="#808080">==[[</font>opLivroAut<font color="#808080">]] </font><font color="#0000FF">then 
    </font>sQtd<font color="#808080">=</font>validaNumero<font color="#808080">('</font>Quantos autores quer cadastrar<font color="#808080">?: ',</font>sQtd<font color="#808080">)
    </font>nQtd <font color="#808080">= </font>tonumber<font color="#808080">(</font>sQtd<font color="#808080">)
    </font>tfLivroAut<font color="#808080">:</font>seek<font color="#808080">('</font>set<font color="#808080">')
    </font><font color="#0000FF">while </font>nCont <font color="#808080">&lt;= </font>nQtd <font color="#0000FF">do 
      </font>tLivroAut.isbn<font color="#808080">=</font>sCodigo
      io.write<font color="#808080">(</font>rotulo<font color="#808080">([[</font>opLivroAut<font color="#808080">]], </font><font color="#FF0000">2</font><font color="#808080">))
      </font>tLivroAut.codautor <font color="#808080">= </font>digita<font color="#808080">()
      </font>slinha<font color="#808080">=</font>pesqArq<font color="#808080">(</font>tfAutor<font color="#808080">, </font>tLivroAut.codautor<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">,</font>tamReg<font color="#808080">([[</font>opAutor<font color="#808080">]]))
      </font>io.write<font color="#808080">(' '</font>..rotulo<font color="#808080">([[</font>opAutor<font color="#808080">]], </font><font color="#FF0000">2</font><font color="#808080">))
      </font>print<font color="#808080">(</font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font>g_nPosChave<font color="#808080">, </font>g_nTamChave<font color="#808080">))
      </font>pesqLinhaExcluida<font color="#808080">(</font>tfLivroAut<font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">))
      </font>subMenu<font color="#808080">(</font><font color="#FF0000">14</font><font color="#808080">, </font>sreg<font color="#808080">)
      </font>nCont<font color="#808080">=</font>nCont<font color="#808080">+</font><font color="#FF0000">1
    </font><font color="#0000FF">end
  elseif </font>sreg<font color="#808080">==[[</font>opVenda<font color="#808080">]] </font><font color="#0000FF">then 
    </font>sQtd<font color="#808080">=</font>validaNumero<font color="#808080">('</font>Quantos livros quer vender<font color="#808080">?: ',</font>sQtd<font color="#808080">)
    </font>nQtd<font color="#808080">=</font>tonumber<font color="#808080">(</font>sQtd<font color="#808080">)
    </font>nTotalPreco<font color="#808080">=</font><font color="#FF0000">0
    </font><font color="#0000FF">while </font>nCont <font color="#808080">&lt;= </font>nQtd <font color="#0000FF">do 
      </font>slinha<font color="#808080">=</font>validaEntrada<font color="#808080">(</font>tfLivro<font color="#808080">,[[</font>opLivro<font color="#808080">]],</font><font color="#FF0000">1</font><font color="#808080">,</font>tVenda.isbn<font color="#808080">,</font><font color="#FF0000">3</font><font color="#808080">,</font><font color="#0000FF">false</font><font color="#808080">,[[</font>opTexto<font color="#808080">]])
      </font><font color="#0000FF">if </font>slinha<font color="#808080">~='' </font><font color="#0000FF">then 
        </font>tVenda.isbn<font color="#808080">=</font>trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#FF0000">13</font><font color="#808080">))
        </font><font color="#0000FF">if </font>validaISBN<font color="#808080">(</font>tVenda.isbn<font color="#808080">) </font><font color="#0000FF">then 
          </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, '', </font><font color="#FF0000">1</font><font color="#808080">)
          </font>tLivro.qtdestoque<font color="#808080">=</font>trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha<font color="#808080">,</font><font color="#FF0000">134</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">))
          </font>nQtdEstoque <font color="#808080">= </font>tonumber<font color="#808080">(</font>tLivro.qtdestoque<font color="#808080">)
          </font><font color="#0000FF">if </font>nQtdEstoque <font color="#808080">&gt; </font><font color="#FF0000">0 </font><font color="#0000FF">then 
             </font>nTotalPreco<font color="#808080">=</font>nTotalPreco <font color="#808080">+ </font>g_nPreco
             sPreco<font color="#808080">=</font>tostring<font color="#808080">(</font>g_nPreco<font color="#808080">)
             </font>tVenda.precovenda<font color="#808080">=</font>sPreco
             g_SalvarInclusao<font color="#808080">=</font><font color="#0000FF">false
             </font>subMenu<font color="#808080">(</font><font color="#FF0000">14</font><font color="#808080">, </font>sreg<font color="#808080">)
             </font><font color="#0000FF">if </font>g_SalvarInclusao <font color="#0000FF">then 
                </font>slinha<font color="#808080">=</font>pesqArq<font color="#808080">(</font>tfLivro<font color="#808080">, </font>tVenda.isbn<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">13</font><font color="#808080">, </font>tamReg<font color="#808080">([[</font>opLivro<font color="#808080">]]))
                </font><font color="#0000FF">if </font>slinha<font color="#808080">~='' </font><font color="#0000FF">then 
                   </font>nQtdEstoque<font color="#808080">=</font>nQtdEstoque<font color="#808080">-</font><font color="#FF0000">1
                   </font>tLivro.qtdestoque<font color="#808080">=</font>tostring<font color="#808080">(</font>nQtdEstoque<font color="#808080">)
                   </font>slinha<font color="#808080">=</font>copy<font color="#808080">(</font>slinha<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#FF0000">133</font><font color="#808080">)</font>..esp<font color="#808080">(</font>tLivro.qtdestoque<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">)
                   </font>escreveArq<font color="#808080">(</font>tfLivro<font color="#808080">, </font>slinha<font color="#808080">, '', '')
                </font><font color="#0000FF">end
             end
             </font>nCont<font color="#808080">=</font>nCont<font color="#808080">+</font><font color="#FF0000">1
          </font><font color="#0000FF">else </font>print<font color="#808080">(</font>MSG_SEMESTOQUE<font color="#808080">) </font><font color="#0000FF">end
        else </font>print<font color="#808080">(</font>MSG_ISBNINV<font color="#808080">) </font><font color="#0000FF">end
      end
    end
    </font>sTotalPreco <font color="#808080">= </font>tostring<font color="#808080">(</font>nTotalPreco<font color="#808080">)
    </font>print<font color="#808080">('</font>Total de <font color="#808080">'</font>..rotulo<font color="#808080">(</font>sreg<font color="#808080">,</font><font color="#FF0000">4</font><font color="#808080">)</font>..sTotalPreco<font color="#808080">)
  </font><font color="#0000FF">end
elseif </font>sacao<font color="#808080">==[[</font>opExcluir<font color="#808080">]] </font><font color="#0000FF">then 
  if </font>sreg<font color="#808080">==[[</font>opLivroAss<font color="#808080">]] </font><font color="#0000FF">then 
     </font>ExcluirRegLigados<font color="#808080">(</font>tfLivroAss<font color="#808080">, </font>sreg<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">13</font><font color="#808080">, </font>sCodigo<font color="#808080">)
  </font><font color="#0000FF">elseif </font>sreg<font color="#808080">==[[</font>opLivroAut<font color="#808080">]] </font><font color="#0000FF">then 
     </font>ExcluirRegLigados<font color="#808080">(</font>tfLivroAut<font color="#808080">, </font>sreg<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">13</font><font color="#808080">, </font>sCodigo<font color="#808080">)
  </font><font color="#0000FF">end
end

end

</font><font color="#008080">-------------------------------------------------------------------------------
-- Realiza a exclus&atilde;o dos arquivos de liga&ccedil;&atilde;o.
-- sArq - o arquivo de liga&ccedil;&atilde;o
-- sreg - o tipo de arquivo de liga&ccedil;&atilde;o
-- nPosChave - a posicao inicial da chave dentro do registro
-- nTamChave - o tamanho da chave dentro do registro
-- sChave - a chave a ser excluida
-------------------------------------------------------------------------------
</font><font color="#0000FF">function </font>ExcluirRegLigados<font color="#808080">(</font>sArq<font color="#808080">, </font>sreg<font color="#808080">, </font>nPosChave<font color="#808080">, </font>nTamChave<font color="#808080">, </font>sChave<font color="#808080">)
  </font>sArq<font color="#808080">:</font>seek<font color="#808080">('</font>set<font color="#808080">')
  </font><font color="#0000FF">for </font>slinha <font color="#0000FF">in </font>sArq<font color="#808080">:</font>lines<font color="#808080">() </font><font color="#0000FF">do
    </font>sCodigo<font color="#808080">=</font>trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha<font color="#808080">,</font>nPosChave<font color="#808080">,</font>nTamChave<font color="#808080">))
    </font><font color="#0000FF">if </font>sCodigo<font color="#808080">==</font>sChave <font color="#0000FF">then
       </font>btnAcao<font color="#808080">(</font>sreg<font color="#808080">,[[</font>opConfirmaExclusao<font color="#808080">]])
    </font><font color="#0000FF">end
  end
end

</font><font color="#008080">------------------------------------------------------------------------------
-- Parte inicial do c&oacute;digo
------------------------------------------------------------------------------
</font><font color="#0000FF">do
</font><font color="#008080">-- if ParamStr(1)='-cria' then
--   abrecriaArqs(false)
-- else 
   </font>frmSplash<font color="#808080">()
   </font>abrecriaArqs<font color="#808080">(</font><font color="#0000FF">true</font><font color="#808080">)
   </font><font color="#0000FF">if </font>frmLogin<font color="#808080">() </font><font color="#0000FF">then
     </font>bopcao<font color="#808080">=</font><font color="#0000FF">true
     while</font><font color="#808080">(</font>bopcao<font color="#808080">) </font><font color="#0000FF">do
       </font>menu<font color="#808080">(</font><font color="#FF0000">1</font><font color="#808080">)
       </font>opmenu <font color="#808080">= </font>digita<font color="#808080">()
       </font><font color="#0000FF">if </font><font color="#808080">(</font>opmenu<font color="#808080">=='</font>C<font color="#808080">') </font><font color="#0000FF">or </font><font color="#808080">(</font>opmenu<font color="#808080">=='</font>c<font color="#808080">') </font><font color="#0000FF">then </font>usaMenu<font color="#808080">(</font><font color="#FF0000">1</font><font color="#808080">)
       </font><font color="#0000FF">elseif </font><font color="#808080">(</font>opmenu<font color="#808080">=='</font>P<font color="#808080">') </font><font color="#0000FF">or </font><font color="#808080">(</font>opmenu<font color="#808080">=='</font>p<font color="#808080">') </font><font color="#0000FF">then </font>usaMenu<font color="#808080">(</font><font color="#FF0000">2</font><font color="#808080">)
       </font><font color="#0000FF">elseif </font><font color="#808080">(</font>opmenu<font color="#808080">=='</font>V<font color="#808080">') </font><font color="#0000FF">or </font><font color="#808080">(</font>opmenu<font color="#808080">=='</font>v<font color="#808080">') </font><font color="#0000FF">then </font>usaMenu<font color="#808080">(</font><font color="#FF0000">3</font><font color="#808080">)
       </font><font color="#0000FF">elseif </font><font color="#808080">(</font>opmenu<font color="#808080">=='</font>O<font color="#808080">') </font><font color="#0000FF">or </font><font color="#808080">(</font>opmenu<font color="#808080">=='</font>o<font color="#808080">') </font><font color="#0000FF">then </font>usaMenu<font color="#808080">(</font><font color="#FF0000">4</font><font color="#808080">)
       </font><font color="#0000FF">else </font>print<font color="#808080">(</font>MSG_ERRO<font color="#808080">) </font><font color="#0000FF">end
     end
   else 
     </font>fechaArqs<font color="#808080">()
     </font>os.exit<font color="#808080">(</font><font color="#FF0000">0</font><font color="#808080">)
   </font><font color="#0000FF">end
</font><font color="#008080">-- end 
</font><font color="#0000FF">end
</font></font>
</code></pre>
</body>
</html>