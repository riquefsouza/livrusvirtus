<html>
<head>
<title>Livrus Virtus - Console - QBasic</title>
</head>
<!-- Generated by ConTEXT HTML exporter -->
<body text="#000000" bgcolor="#FFFFFF">
<pre>
<code><font  face="Courier New"><font color="#808080"><i>'------------------------------------------------------------------------------
' Sistema integrante do projeto Livrus Virtus.
' Todos os direitos reservados para Henrique F. de Souza.
' Vers&AElig;o programada na linguagem qbasic.
'------------------------------------------------------------------------------
' programa Livrus


'--- Rotinas b sicas ---------------------------------------------------------
</i></font><font color="#000080">DECLARE <b>FUNCTION Trim</b>$ </font><font color="#808080">(</font><font color="#000080">sTexto <b>AS STRING</b></font><font color="#808080">)
</font><font color="#000080">DECLARE <b>FUNCTION </b>repete$ </font><font color="#808080">(</font><font color="#000080">sTexto <b>AS STRING</b></font><font color="#808080">, </font><font color="#000080">nQtd <b>AS INTEGER</b></font><font color="#808080">)
</font><font color="#000080">DECLARE <b>FUNCTION </b>esp$ </font><font color="#808080">(</font><font color="#000080">sTexto <b>AS STRING</b></font><font color="#808080">, </font><font color="#000080">ntam <b>AS INTEGER</b></font><font color="#808080">)
</font><font color="#000080">DECLARE <b>FUNCTION </b>zeros$ </font><font color="#808080">(</font><font color="#000080">sTexto <b>AS STRING</b></font><font color="#808080">, </font><font color="#000080">ntam <b>AS INTEGER</b></font><font color="#808080">)
</font><font color="#000080">DECLARE <b>FUNCTION </b>strRelativa! </font><font color="#808080">(</font><font color="#000080">sTexto <b>AS STRING</b></font><font color="#808080">, </font><font color="#000080">sChave <b>AS STRING</b></font><font color="#808080">)
</font><font color="#000080">DECLARE <b>FUNCTION </b>modulo11! </font><font color="#808080">(</font><font color="#000080">svalor <b>AS STRING</b></font><font color="#808080">, </font><font color="#000080">ndig <b>AS INTEGER</b></font><font color="#808080">)
</font><font color="#000080">DECLARE <b>FUNCTION </b>validaCPF! </font><font color="#808080">(</font><font color="#000080">cpf <b>AS STRING</b></font><font color="#808080">)
</font><font color="#000080">DECLARE <b>FUNCTION </b>validaISBN! </font><font color="#808080">(</font><font color="#000080">isbn <b>AS STRING</b></font><font color="#808080">)
</font><font color="#000080">DECLARE <b>FUNCTION </b>digitaSenha$ </font><font color="#808080">(</font><font color="#000080">sRotulo <b>AS STRING</b></font><font color="#808080">, </font><font color="#000080">nTamSenha <b>AS INTEGER</b></font><font color="#808080">)
</font><font color="#000080">DECLARE <b>FUNCTION </b>validaNumero$ </font><font color="#808080">(</font><font color="#000080">sRotulo <b>AS STRING</b></font><font color="#808080">, </font><font color="#000080">sNumero <b>AS STRING</b></font><font color="#808080">)
</font><font color="#000080">DECLARE <b>FUNCTION </b>validaDataHora$ </font><font color="#808080">(</font><font color="#000080">sRotulo <b>AS STRING</b></font><font color="#808080">, </font><font color="#000080">sDataHora <b>AS STRING</b></font><font color="#808080">, </font><font color="#000080">bSoData <b>AS INTEGER</b></font><font color="#808080">)
</font><font color="#000080">DECLARE <b>FUNCTION </b>retDataHora$ </font><font color="#808080">()

<i>'--- Rotinas de manipula‡&AElig;o de arquivos --------------------------------------
</i></font><font color="#000080">DECLARE <b>FUNCTION </b>tamArq! </font><font color="#808080">(</font><font color="#000080">sArq <b>AS INTEGER</b></font><font color="#808080">)
</font><font color="#000080">DECLARE <b>SUB </b>abreArqs </font><font color="#808080">(</font><font color="#000080">bAbre <b>AS INTEGER</b></font><font color="#808080">)
</font><font color="#000080">DECLARE <b>SUB </b>fechaArqs </font><font color="#808080">()
</font><font color="#000080">DECLARE <b>FUNCTION </b>pesqArq$ </font><font color="#808080">(</font><font color="#000080">sArq <b>AS INTEGER</b></font><font color="#808080">, </font><font color="#000080">sChave <b>AS STRING</b></font><font color="#808080">, </font><font color="#000080">nPosChave <b>AS INTEGER</b></font><font color="#808080">, </font><font color="#000080">nTamChave <b>AS INTEGER</b></font><font color="#808080">, </font><font color="#000080">nTamLinha <b>AS INTEGER</b></font><font color="#808080">)
</font><font color="#000080">DECLARE <b>SUB </b>pesqLinhaExcluida </font><font color="#808080">(</font><font color="#000080">sArq <b>AS INTEGER</b></font><font color="#808080">, </font><font color="#000080">nTamLinha <b>AS INTEGER</b></font><font color="#808080">)
</font><font color="#000080">DECLARE <b>FUNCTION </b>pesqMaxCod$ </font><font color="#808080">(</font><font color="#000080">sArq <b>AS INTEGER</b></font><font color="#808080">, </font><font color="#000080">nPosChave <b>AS INTEGER</b></font><font color="#808080">, </font><font color="#000080">nTamChave <b>AS INTEGER</b></font><font color="#808080">, </font><font color="#000080">nTamLinha <b>AS INTEGER</b></font><font color="#808080">)
</font><font color="#000080">DECLARE <b>SUB </b>escreveArq </font><font color="#808080">(</font><font color="#000080">sArq <b>AS INTEGER</b></font><font color="#808080">, </font><font color="#000080">sTexto <b>AS STRING</b></font><font color="#808080">, </font><font color="#000080">sMsgAcerto <b>AS STRING</b></font><font color="#808080">, </font><font color="#000080">sMsgErro <b>AS STRING</b></font><font color="#808080">)

<i>'--- Rotinas de implementa‡&AElig;o do sistema e de interface ----------------------
</i></font><font color="#000080">DECLARE <b>FUNCTION </b>LinhaReg$ </font><font color="#808080">(</font><font color="#000080">sreg <b>AS INTEGER</b></font><font color="#808080">)
</font><font color="#000080">DECLARE <b>FUNCTION </b>tamReg! </font><font color="#808080">(</font><font color="#000080">sreg <b>AS INTEGER</b></font><font color="#808080">)
</font><font color="#000080">DECLARE <b>FUNCTION </b>rotulo$ </font><font color="#808080">(</font><font color="#000080">sreg <b>AS INTEGER</b></font><font color="#808080">, </font><font color="#000080">nNum <b>AS INTEGER</b></font><font color="#808080">)
</font><font color="#000080">DECLARE <b>FUNCTION </b>ContinuaSN! </font><font color="#808080">(</font><font color="#000080">nlinha <b>AS INTEGER</b></font><font color="#808080">, </font><font color="#000080">nQtdLinha <b>AS INTEGER</b></font><font color="#808080">)
</font><font color="#000080">DECLARE <b>FUNCTION </b>ListarTodos! </font><font color="#808080">(</font><font color="#000080">sArq <b>AS INTEGER</b></font><font color="#808080">, </font><font color="#000080">sreg <b>AS INTEGER</b></font><font color="#808080">, </font><font color="#000080">sChave <b>AS STRING</b></font><font color="#808080">, </font><font color="#000080">nPosChave <b>AS INTEGER</b></font><font color="#808080">, </font><font color="#000080">nTamChave <b>AS INTEGER</b></font><font color="#808080">, </font><font color="#000080">nTamLinha <b>AS INTEGER</b></font><font color="#808080">, </font><font color="#000080">nQtdLinha <b>AS INTEGER</b></font><font color="#808080">, </font><font color="#000080">bPesqRelativa <b>AS INTEGER</b></font><font color="#808080">)
</font><font color="#000080">DECLARE <b>SUB </b>ListarRegLigados </font><font color="#808080">(</font><font color="#000080">sArq1 <b>AS INTEGER</b></font><font color="#808080">, </font><font color="#000080">sreg1 <b>AS INTEGER</b></font><font color="#808080">, </font><font color="#000080">nPosChave1 <b>AS INTEGER</b></font><font color="#808080">, </font><font color="#000080">nTamChave1 <b>AS INTEGER</b></font><font color="#808080">, </font><font color="#000080">nPosChave2 <b>AS INTEGER</b></font><font color="#808080">, </font><font color="#000080">nTamChave2 <b>AS INTEGER</b></font><font color="#808080">, </font><font color="#000080">sChave <b>AS STRING</b></font><font color="#808080">, </font><font color="#000080">sArq2 <b>AS INTEGER</b></font><font color="#808080">, </font><font color="#000080">sreg2 <b>AS INTEGER</b></font><font color="#808080">, </font><font color="#000080">nPosChave3 <b>AS INTEGER</b></font><font color="#808080">, </font><font color="#000080">nQtdLinha <b>AS  </b>_
<b>INTEGER</b></font><font color="#808080">)
</font><font color="#000080">DECLARE <b>FUNCTION </b>validaEntrada$ </font><font color="#808080">(</font><font color="#000080">sArq <b>AS INTEGER</b></font><font color="#808080">, </font><font color="#000080">sreg <b>AS INTEGER</b></font><font color="#808080">, </font><font color="#000080">nTexto <b>AS INTEGER</b></font><font color="#808080">, </font><font color="#000080">sEntrada <b>AS STRING</b></font><font color="#808080">, </font><font color="#000080">nTentativas <b>AS INTEGER</b></font><font color="#808080">, </font><font color="#000080">bPesqRelativa <b>AS INTEGER</b></font><font color="#808080">, </font><font color="#000080">bTipoEntrada <b>AS INTEGER</b></font><font color="#808080">)
</font><font color="#000080">DECLARE <b>SUB </b>frmSplash </font><font color="#808080">()
</font><font color="#000080">DECLARE <b>SUB </b>frmSobre </font><font color="#808080">()
</font><font color="#000080">DECLARE <b>FUNCTION </b>frmLogin! </font><font color="#808080">()
</font><font color="#000080">DECLARE <b>SUB </b>menu </font><font color="#808080">(</font><font color="#000080">num <b>AS INTEGER</b></font><font color="#808080">)
</font><font color="#000080">DECLARE <b>SUB </b>frmCadastros </font><font color="#808080">(</font><font color="#000080">sreg <b>AS INTEGER</b></font><font color="#808080">, </font><font color="#000080">sacao <b>AS INTEGER</b></font><font color="#808080">)
</font><font color="#000080">DECLARE <b>SUB </b>frmConsultas </font><font color="#808080">(</font><font color="#000080">sreg <b>AS INTEGER</b></font><font color="#808080">, </font><font color="#000080">sacao <b>AS INTEGER</b></font><font color="#808080">)
</font><font color="#000080">DECLARE <b>SUB </b>frmAlterarSenha </font><font color="#808080">()
</font><font color="#000080">DECLARE <b>SUB </b>btnAcao </font><font color="#808080">(</font><font color="#000080">sreg <b>AS INTEGER</b></font><font color="#808080">, </font><font color="#000080">sacao <b>AS INTEGER</b></font><font color="#808080">)
</font><font color="#000080">DECLARE <b>SUB </b>subMenu </font><font color="#808080">(</font><font color="#000080">nmenu <b>AS INTEGER</b></font><font color="#808080">, </font><font color="#000080">sreg <b>AS INTEGER</b></font><font color="#808080">)
</font><font color="#000080">DECLARE <b>SUB </b>usaMenu </font><font color="#808080">(</font><font color="#000080">num <b>AS INTEGER</b></font><font color="#808080">)
</font><font color="#000080">DECLARE <b>SUB </b>mostrarDados </font><font color="#808080">(</font><font color="#000080">sreg <b>AS INTEGER</b></font><font color="#808080">, </font><font color="#000080">slinha <b>AS STRING</b></font><font color="#808080">, </font><font color="#000080">nOpcao <b>AS INTEGER</b></font><font color="#808080">)
</font><font color="#000080">DECLARE <b>SUB </b>mostrarSubDados </font><font color="#808080">(</font><font color="#000080">sreg <b>AS INTEGER</b></font><font color="#808080">, </font><font color="#000080">ssubreg <b>AS INTEGER</b></font><font color="#808080">, </font><font color="#000080">bSoMostrar <b>AS INTEGER</b></font><font color="#808080">)
</font><font color="#000080">DECLARE <b>SUB </b>frmCadLigados </font><font color="#808080">(</font><font color="#000080">sreg <b>AS INTEGER</b></font><font color="#808080">, </font><font color="#000080">sacao <b>AS INTEGER</b></font><font color="#808080">, </font><font color="#000080">sCodigo <b>AS STRING</b></font><font color="#808080">)
</font><font color="#000080">DECLARE <b>SUB </b>ExcluirRegLigados </font><font color="#808080">(</font><font color="#000080">sArq <b>AS INTEGER</b></font><font color="#808080">, </font><font color="#000080">sreg <b>AS INTEGER</b></font><font color="#808080">, </font><font color="#000080">nPosChave <b>AS INTEGER</b></font><font color="#808080">, </font><font color="#000080">nTamChave <b>AS INTEGER</b></font><font color="#808080">, </font><font color="#000080">sChave <b>AS STRING</b></font><font color="#808080">)

<i>' tipos

</i></font><font color="#000080">TYPE regAssunto
   codigo <b>AS STRING </b></font><font color="#808080">* </font><font color="#FF0000">10
   </font><font color="#000080">assunto <b>AS STRING </b></font><font color="#808080">* </font><font color="#FF0000">30
</font><font color="#000080"><b>END </b>TYPE
TYPE regAutor
   codigo <b>AS STRING </b></font><font color="#808080">* </font><font color="#FF0000">10
   </font><font color="#000080">autor <b>AS STRING </b></font><font color="#808080">* </font><font color="#FF0000">30
</font><font color="#000080"><b>END </b>TYPE
TYPE regEditora
   codigo <b>AS STRING </b></font><font color="#808080">* </font><font color="#FF0000">10
   </font><font color="#000080">editora <b>AS STRING </b></font><font color="#808080">* </font><font color="#FF0000">50
</font><font color="#000080"><b>END </b>TYPE
TYPE regIdioma
   codigo <b>AS STRING </b></font><font color="#808080">* </font><font color="#FF0000">10
   </font><font color="#000080">idioma <b>AS STRING </b></font><font color="#808080">* </font><font color="#FF0000">20
</font><font color="#000080"><b>END </b>TYPE
TYPE regUsuario
   login <b>AS STRING </b></font><font color="#808080">* </font><font color="#FF0000">10
   </font><font color="#000080">senha <b>AS STRING </b></font><font color="#808080">* </font><font color="#FF0000">10
</font><font color="#000080"><b>END </b>TYPE
TYPE regPais
   codigo <b>AS STRING </b></font><font color="#808080">* </font><font color="#FF0000">3
   </font><font color="#000080">pais <b>AS STRING </b></font><font color="#808080">* </font><font color="#FF0000">50
</font><font color="#000080"><b>END </b>TYPE
TYPE regProfissao
   codigo <b>AS STRING </b></font><font color="#808080">* </font><font color="#FF0000">10
   </font><font color="#000080">profissao <b>AS STRING </b></font><font color="#808080">* </font><font color="#FF0000">50
</font><font color="#000080"><b>END </b>TYPE
TYPE regLivro
   isbn <b>AS STRING </b></font><font color="#808080">* </font><font color="#FF0000">13
   </font><font color="#000080">titulo <b>AS STRING </b></font><font color="#808080">* </font><font color="#FF0000">50
   </font><font color="#000080">edicao <b>AS STRING </b></font><font color="#808080">* </font><font color="#FF0000">10
   </font><font color="#000080">anopubli <b>AS STRING </b></font><font color="#808080">* </font><font color="#FF0000">10
   </font><font color="#000080">codeditora <b>AS STRING </b></font><font color="#808080">* </font><font color="#FF0000">10
   </font><font color="#000080">volume <b>AS STRING </b></font><font color="#808080">* </font><font color="#FF0000">10
   </font><font color="#000080">codidioma <b>AS STRING </b></font><font color="#808080">* </font><font color="#FF0000">10
   </font><font color="#000080">npaginas <b>AS STRING </b></font><font color="#808080">* </font><font color="#FF0000">10
   </font><font color="#000080">preco <b>AS STRING </b></font><font color="#808080">* </font><font color="#FF0000">10
   </font><font color="#000080">qtdestoque <b>AS STRING </b></font><font color="#808080">* </font><font color="#FF0000">10
</font><font color="#000080"><b>END </b>TYPE
TYPE regLivroAss
   isbn <b>AS STRING </b></font><font color="#808080">* </font><font color="#FF0000">13
   </font><font color="#000080">codassunto <b>AS STRING </b></font><font color="#808080">* </font><font color="#FF0000">10
</font><font color="#000080"><b>END </b>TYPE
TYPE regLivroAut
   isbn <b>AS STRING </b></font><font color="#808080">* </font><font color="#FF0000">13
   </font><font color="#000080">codautor <b>AS STRING </b></font><font color="#808080">* </font><font color="#FF0000">10
</font><font color="#000080"><b>END </b>TYPE
TYPE regCliente
   cpf <b>AS STRING </b></font><font color="#808080">* </font><font color="#FF0000">14
   </font><font color="#000080">nome <b>AS STRING </b></font><font color="#808080">* </font><font color="#FF0000">30
   </font><font color="#000080">email <b>AS STRING </b></font><font color="#808080">* </font><font color="#FF0000">30
   </font><font color="#000080">identidade <b>AS STRING </b></font><font color="#808080">* </font><font color="#FF0000">10
   </font><font color="#000080">sexo <b>AS STRING </b></font><font color="#808080">* </font><font color="#FF0000">1
   </font><font color="#000080">telefone <b>AS STRING </b></font><font color="#808080">* </font><font color="#FF0000">17
   </font><font color="#000080">dtnascimento <b>AS STRING </b></font><font color="#808080">* </font><font color="#FF0000">10
   </font><font color="#000080">codendereco <b>AS STRING </b></font><font color="#808080">* </font><font color="#FF0000">10
   </font><font color="#000080">codpais <b>AS STRING </b></font><font color="#808080">* </font><font color="#FF0000">3
   </font><font color="#000080">codprofissao <b>AS STRING </b></font><font color="#808080">* </font><font color="#FF0000">10
</font><font color="#000080"><b>END </b>TYPE
TYPE regEndereco
   codigo <b>AS STRING </b></font><font color="#808080">* </font><font color="#FF0000">10
   </font><font color="#000080">Logradouro <b>AS STRING </b></font><font color="#808080">* </font><font color="#FF0000">40
   </font><font color="#000080">bairro <b>AS STRING </b></font><font color="#808080">* </font><font color="#FF0000">15
   </font><font color="#000080">cep <b>AS STRING </b></font><font color="#808080">* </font><font color="#FF0000">8
   </font><font color="#000080">cidade <b>AS STRING </b></font><font color="#808080">* </font><font color="#FF0000">30
   </font><font color="#000080">estado <b>AS STRING </b></font><font color="#808080">* </font><font color="#FF0000">20
</font><font color="#000080"><b>END </b>TYPE
TYPE regVenda
   dthrvenda <b>AS STRING </b></font><font color="#808080">* </font><font color="#FF0000">19  </font><font color="#808080"><i>' data/hora da venda dd/mm/yyyy hh:mm:ss
   </i></font><font color="#000080">cpf <b>AS STRING </b></font><font color="#808080">* </font><font color="#FF0000">14
   </font><font color="#000080">isbn <b>AS STRING </b></font><font color="#808080">* </font><font color="#FF0000">13
   </font><font color="#000080">precovenda <b>AS STRING </b></font><font color="#808080">* </font><font color="#FF0000">10
</font><font color="#000080"><b>END </b>TYPE

</font><font color="#808080"><i>' vari veis globais
</i></font><font color="#000080">COMMON SHARED bopcao <b>AS INTEGER
</b>COMMON SHARED opmenu <b>AS STRING
</b>COMMON SHARED gnPosChave</font><font color="#808080">, </font><font color="#000080">gnTamChave <b>AS INTEGER
</b>COMMON SHARED gnPreco <b>AS DOUBLE
</b>COMMON SHARED gSalvarInclusao <b>AS INTEGER
</b>COMMON SHARED gnPosicao <b>AS INTEGER

</b>COMMON SHARED tAssunto <b>AS </b>regAssunto
COMMON SHARED tAutor <b>AS </b>regAutor
COMMON SHARED tEditora <b>AS </b>regEditora
COMMON SHARED tIdioma <b>AS </b>regIdioma
COMMON SHARED tEndereco <b>AS </b>regEndereco
COMMON SHARED tPais <b>AS </b>regPais
COMMON SHARED tProfissao <b>AS </b>regProfissao
COMMON SHARED tLivro <b>AS </b>regLivro
COMMON SHARED tLivroAss <b>AS </b>regLivroAss
COMMON SHARED tLivroAut <b>AS </b>regLivroAut
COMMON SHARED tCliente <b>AS </b>regCliente
COMMON SHARED tUsuario <b>AS </b>regUsuario
COMMON SHARED tVenda <b>AS </b>regVenda

COMMON SHARED CRLF <b>AS STRING

</b></font><font color="#808080"><i>' constantes

</i></font><font color="#000080"><b>CONST </b>true </font><font color="#808080">= </font><font color="#FF0000">1
</font><font color="#000080"><b>CONST </b>false </font><font color="#808080">= </font><font color="#FF0000">0
</font><font color="#808080"><i>' ctTipo
</i></font><font color="#000080"><b>CONST </b>opTexto </font><font color="#808080">= </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#000080">opNumero </font><font color="#808080">= </font><font color="#FF0000">2</font><font color="#808080">, </font><font color="#000080">opData </font><font color="#808080">= </font><font color="#FF0000">3</font><font color="#808080">, </font><font color="#000080">opDataHora </font><font color="#808080">= </font><font color="#FF0000">4</font><font color="#808080">, </font><font color="#000080">opSenha </font><font color="#808080">= </font><font color="#FF0000">5
</font><font color="#808080"><i>' ctArqs
</i></font><font color="#000080"><b>CONST </b>opAssunto </font><font color="#808080">= </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#000080">opAutor </font><font color="#808080">= </font><font color="#FF0000">2</font><font color="#808080">, </font><font color="#000080">opEditora </font><font color="#808080">= </font><font color="#FF0000">3</font><font color="#808080">, </font><font color="#000080">opEndereco </font><font color="#808080">= </font><font color="#FF0000">4
</font><font color="#000080"><b>CONST </b>opIdioma </font><font color="#808080">= </font><font color="#FF0000">5</font><font color="#808080">, </font><font color="#000080">opPais </font><font color="#808080">= </font><font color="#FF0000">6</font><font color="#808080">, </font><font color="#000080">opProfissao </font><font color="#808080">= </font><font color="#FF0000">7</font><font color="#808080">, </font><font color="#000080">opCliente </font><font color="#808080">= </font><font color="#FF0000">8</font><font color="#808080">, </font><font color="#000080">opLivro </font><font color="#808080">= </font><font color="#FF0000">9
</font><font color="#000080"><b>CONST </b>opLivroAss </font><font color="#808080">= </font><font color="#FF0000">10</font><font color="#808080">, </font><font color="#000080">opLivroAut </font><font color="#808080">= </font><font color="#FF0000">11</font><font color="#808080">, </font><font color="#000080">opUsuario </font><font color="#808080">= </font><font color="#FF0000">12</font><font color="#808080">, </font><font color="#000080">opVenda </font><font color="#808080">= </font><font color="#FF0000">13
</font><font color="#808080"><i>' ctAcao
</i></font><font color="#000080"><b>CONST </b>opNovo </font><font color="#808080">= </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#000080">opAlterar </font><font color="#808080">= </font><font color="#FF0000">2</font><font color="#808080">, </font><font color="#000080">opPesquisar </font><font color="#808080">= </font><font color="#FF0000">3</font><font color="#808080">, </font><font color="#000080">opSalvarInclusao </font><font color="#808080">= </font><font color="#FF0000">4
</font><font color="#000080"><b>CONST </b>opSalvarAlteracao </font><font color="#808080">= </font><font color="#FF0000">5</font><font color="#808080">, </font><font color="#000080">opExcluir </font><font color="#808080">= </font><font color="#FF0000">6
</font><font color="#000080"><b>CONST </b>opConfirmaExclusao </font><font color="#808080">= </font><font color="#FF0000">7</font><font color="#808080">, </font><font color="#000080">opListarTodos </font><font color="#808080">= </font><font color="#FF0000">8

</font><font color="#000080">CRLF </font><font color="#808080">= </font><font color="#000080"><b>CHR</b>$</font><font color="#808080">(</font><font color="#FF0000">13</font><font color="#808080">) + </font><font color="#000080"><b>CHR</b>$</font><font color="#808080">(</font><font color="#FF0000">10</font><font color="#808080">) <i>' windows
</i></font><font color="#000080"><b>CONST </b>TAMCRLF </font><font color="#808080">= </font><font color="#FF0000">2
</font><font color="#808080"><i>'CONST CRLF = chr$(10)
'CONST TAMCRLF = 1  ' unix
'CONST CRLF = chr$(13)
'CONST TAMCRLF = 1  ' macintosh

</i></font><font color="#000080"><b>CONST </b>QTDMAXLINHA </font><font color="#808080">= </font><font color="#FF0000">18

</font><font color="#000080"><b>CONST </b>MSGERRO </font><font color="#808080">= </font><font color="#800000">&quot;Erro: op‡&AElig;o inv lida digite de novo&quot;
</font><font color="#000080"><b>CONST </b>MSGOPCAO </font><font color="#808080">= </font><font color="#800000">&quot;Escolha uma op‡&AElig;o: &quot;
</font><font color="#000080"><b>CONST </b>MSGPRESS </font><font color="#808080">= </font><font color="#800000">&quot;pressione para continuar...&quot;

</font><font color="#000080"><b>CONST </b>MSGREGINC </font><font color="#808080">= </font><font color="#800000">&quot;registro incluido!&quot;
</font><font color="#000080"><b>CONST </b>MSGREGNINC </font><font color="#808080">= </font><font color="#800000">&quot;registro n&AElig;o incluido!&quot;
</font><font color="#000080"><b>CONST </b>MSGREGALT </font><font color="#808080">= </font><font color="#800000">&quot;registro alterado!&quot;
</font><font color="#000080"><b>CONST </b>MSGREGNALT </font><font color="#808080">= </font><font color="#800000">&quot;registro n&AElig;o alterado!&quot;
</font><font color="#000080"><b>CONST </b>MSGREGEXC </font><font color="#808080">= </font><font color="#800000">&quot;registro excluido!&quot;
</font><font color="#000080"><b>CONST </b>MSGREGNEXC </font><font color="#808080">= </font><font color="#800000">&quot;registro n&AElig;o excluido!&quot;
</font><font color="#000080"><b>CONST </b>MSGREGEXST </font><font color="#808080">= </font><font color="#800000">&quot;registro j  existe!&quot;

</font><font color="#000080"><b>CONST </b>MSGNUMINV </font><font color="#808080">= </font><font color="#800000">&quot;N&pound;mero inv lido ou menor do que 1!&quot;
</font><font color="#000080"><b>CONST </b>MSGDATAINV </font><font color="#808080">= </font><font color="#800000">&quot;Data inv lida!, formato correto (dd/mm/yyyy)&quot;
</font><font color="#000080"><b>CONST </b>MSGDTHRINV </font><font color="#808080">= </font><font color="#800000">&quot;Data/hora inv lida!, formato correto (dd/mm/yyyy hh:mm:ss)&quot;
</font><font color="#000080"><b>CONST </b>MSGISBNINV </font><font color="#808080">= </font><font color="#800000">&quot;ISBN inv lido!&quot;
</font><font color="#000080"><b>CONST </b>MSGCPFINV </font><font color="#808080">= </font><font color="#800000">&quot;CPF inv lido!&quot;
</font><font color="#000080"><b>CONST </b>MSGSENCONFERE </font><font color="#808080">= </font><font color="#800000">&quot;senha n&AElig;o confere com a senha atual!&quot;
</font><font color="#000080"><b>CONST </b>MSGSENCONFIRM </font><font color="#808080">= </font><font color="#800000">&quot;nova senha n&AElig;o confere com a senha confirmada!&quot;
</font><font color="#000080"><b>CONST </b>MSGLOGINENCON </font><font color="#808080">= </font><font color="#800000">&quot;login n&AElig;o encontrado!&quot;
</font><font color="#000080"><b>CONST </b>MSGSEMESTOQUE </font><font color="#808080">= </font><font color="#800000">&quot;livro n&AElig;o existe no estoque!&quot;

</font><font color="#000080"><b>CONST </b>ARQASSUNTO </font><font color="#808080">= </font><font color="#800000">&quot;assunto.dat&quot;
</font><font color="#000080"><b>CONST </b>ARQAUTOR </font><font color="#808080">= </font><font color="#800000">&quot;autor.dat&quot;
</font><font color="#000080"><b>CONST </b>ARQEDITORA </font><font color="#808080">= </font><font color="#800000">&quot;editora.dat&quot;
</font><font color="#000080"><b>CONST </b>ARQIDIOMA </font><font color="#808080">= </font><font color="#800000">&quot;idioma.dat&quot;
</font><font color="#000080"><b>CONST </b>ARQUSUARIO </font><font color="#808080">= </font><font color="#800000">&quot;usuario.dat&quot;
</font><font color="#000080"><b>CONST </b>ARQPAIS </font><font color="#808080">= </font><font color="#800000">&quot;pais.dat&quot;
</font><font color="#000080"><b>CONST </b>ARQPROFISSAO </font><font color="#808080">= </font><font color="#800000">&quot;profissa.dat&quot;
</font><font color="#000080"><b>CONST </b>ARQLIVRO </font><font color="#808080">= </font><font color="#800000">&quot;livro.dat&quot;
</font><font color="#000080"><b>CONST </b>ARQLIVASS </font><font color="#808080">= </font><font color="#800000">&quot;livroass.dat&quot;
</font><font color="#000080"><b>CONST </b>ARQLIVAUT </font><font color="#808080">= </font><font color="#800000">&quot;livroaut.dat&quot;
</font><font color="#000080"><b>CONST </b>ARQCLIENTE </font><font color="#808080">= </font><font color="#800000">&quot;cliente.dat&quot;
</font><font color="#000080"><b>CONST </b>ARQENDERECO </font><font color="#808080">= </font><font color="#800000">&quot;endereco.dat&quot;
</font><font color="#000080"><b>CONST </b>ARQVENDA </font><font color="#808080">= </font><font color="#800000">&quot;venda.dat&quot;

</font><font color="#000080"><b>CONST </b>TAMASSUNTO </font><font color="#808080">= </font><font color="#FF0000">40
</font><font color="#000080"><b>CONST </b>TAMAUTOR </font><font color="#808080">= </font><font color="#FF0000">40
</font><font color="#000080"><b>CONST </b>TAMEDITORA </font><font color="#808080">= </font><font color="#FF0000">60
</font><font color="#000080"><b>CONST </b>TAMIDIOMA </font><font color="#808080">= </font><font color="#FF0000">30
</font><font color="#000080"><b>CONST </b>TAMUSUARIO </font><font color="#808080">= </font><font color="#FF0000">20
</font><font color="#000080"><b>CONST </b>TAMPAIS </font><font color="#808080">= </font><font color="#FF0000">53
</font><font color="#000080"><b>CONST </b>TAMPROFISSAO </font><font color="#808080">= </font><font color="#FF0000">60
</font><font color="#000080"><b>CONST </b>TAMLIVRO </font><font color="#808080">= </font><font color="#FF0000">143
</font><font color="#000080"><b>CONST </b>TAMLIVASS </font><font color="#808080">= </font><font color="#FF0000">23
</font><font color="#000080"><b>CONST </b>TAMLIVAUT </font><font color="#808080">= </font><font color="#FF0000">23
</font><font color="#000080"><b>CONST </b>TAMCLIENTE </font><font color="#808080">= </font><font color="#FF0000">135
</font><font color="#000080"><b>CONST </b>TAMENDERECO </font><font color="#808080">= </font><font color="#FF0000">123
</font><font color="#000080"><b>CONST </b>TAMVENDA </font><font color="#808080">= </font><font color="#FF0000">56

</font><font color="#808080"><i>' Arquivos
</i></font><font color="#000080"><b>CONST </b>tfAssunto </font><font color="#808080">= </font><font color="#FF0000">1
</font><font color="#000080"><b>CONST </b>tfAutor </font><font color="#808080">= </font><font color="#FF0000">2
</font><font color="#000080"><b>CONST </b>tfEditora </font><font color="#808080">= </font><font color="#FF0000">3
</font><font color="#000080"><b>CONST </b>tfIdioma </font><font color="#808080">= </font><font color="#FF0000">4
</font><font color="#000080"><b>CONST </b>tfEndereco </font><font color="#808080">= </font><font color="#FF0000">5
</font><font color="#000080"><b>CONST </b>tfPais </font><font color="#808080">= </font><font color="#FF0000">6
</font><font color="#000080"><b>CONST </b>tfProfissao </font><font color="#808080">= </font><font color="#FF0000">7
</font><font color="#000080"><b>CONST </b>tfLivro </font><font color="#808080">= </font><font color="#FF0000">8
</font><font color="#000080"><b>CONST </b>tfLivroAss </font><font color="#808080">= </font><font color="#FF0000">9
</font><font color="#000080"><b>CONST </b>tfLivroAut </font><font color="#808080">= </font><font color="#FF0000">10
</font><font color="#000080"><b>CONST </b>tfCliente </font><font color="#808080">= </font><font color="#FF0000">11
</font><font color="#000080"><b>CONST </b>tfUsuario </font><font color="#808080">= </font><font color="#FF0000">12
</font><font color="#000080"><b>CONST </b>tfVenda </font><font color="#808080">= </font><font color="#FF0000">13

</font><font color="#808080"><i>'------------------------------------------------------------------------------
'Parte inicial do c&cent;digo
'------------------------------------------------------------------------------
'if ParamStr(1)=&quot;-cria&quot; then
'   abreArqs (false)
'else
 </i></font><font color="#000080">frmSplash
 abreArqs </font><font color="#808080">(</font><font color="#000080">true</font><font color="#808080">)
 </font><font color="#000080"><b>IF </b>frmLogin <b>THEN
   </b>bopcao </font><font color="#808080">= </font><font color="#000080">true
   <b>DO WHILE </b></font><font color="#808080">(</font><font color="#000080">bopcao</font><font color="#808080">)
     </font><font color="#000080">menu </font><font color="#808080">(</font><font color="#FF0000">1</font><font color="#808080">)
     </font><font color="#000080"><b>INPUT </b></font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#000080">opmenu
     <b>IF </b></font><font color="#808080">(</font><font color="#000080">opmenu </font><font color="#808080">= </font><font color="#800000">&quot;C&quot;</font><font color="#808080">) </font><font color="#000080"><b>OR </b></font><font color="#808080">(</font><font color="#000080">opmenu </font><font color="#808080">= </font><font color="#800000">&quot;c&quot;</font><font color="#808080">) </font><font color="#000080"><b>THEN
       </b>usaMenu </font><font color="#808080">(</font><font color="#FF0000">1</font><font color="#808080">)
     </font><font color="#000080"><b>ELSEIF </b></font><font color="#808080">(</font><font color="#000080">opmenu </font><font color="#808080">= </font><font color="#800000">&quot;P&quot;</font><font color="#808080">) </font><font color="#000080"><b>OR </b></font><font color="#808080">(</font><font color="#000080">opmenu </font><font color="#808080">= </font><font color="#800000">&quot;p&quot;</font><font color="#808080">) </font><font color="#000080"><b>THEN </b>usaMenu </font><font color="#808080">(</font><font color="#FF0000">2</font><font color="#808080">)
     </font><font color="#000080"><b>ELSEIF </b></font><font color="#808080">(</font><font color="#000080">opmenu </font><font color="#808080">= </font><font color="#800000">&quot;V&quot;</font><font color="#808080">) </font><font color="#000080"><b>OR </b></font><font color="#808080">(</font><font color="#000080">opmenu </font><font color="#808080">= </font><font color="#800000">&quot;v&quot;</font><font color="#808080">) </font><font color="#000080"><b>THEN </b>usaMenu </font><font color="#808080">(</font><font color="#FF0000">3</font><font color="#808080">)
     </font><font color="#000080"><b>ELSEIF </b></font><font color="#808080">(</font><font color="#000080">opmenu </font><font color="#808080">= </font><font color="#800000">&quot;O&quot;</font><font color="#808080">) </font><font color="#000080"><b>OR </b></font><font color="#808080">(</font><font color="#000080">opmenu </font><font color="#808080">= </font><font color="#800000">&quot;o&quot;</font><font color="#808080">) </font><font color="#000080"><b>THEN </b>usaMenu </font><font color="#808080">(</font><font color="#FF0000">4</font><font color="#808080">)
     </font><font color="#000080"><b>ELSE PRINT </b>MSGERRO
     <b>END IF
   LOOP
 ELSE
   </b>fechaArqs
   <b>END
 END IF
</b></font><font color="#808080"><i>'end if

'------------------------------------------------------------------------------
'Abre ou cria os arquivos do sistema.
'bAbre - condi‡&AElig;o para abrir ou criar os arquivos do sistema
'------------------------------------------------------------------------------
</i></font><font color="#000080"><b>SUB </b>abreArqs </font><font color="#808080">(</font><font color="#000080">bAbre <b>AS INTEGER</b></font><font color="#808080">)
</font><font color="#000080"><b>IF </b>bAbre <b>THEN
 OPEN </b>ARQASSUNTO <b>FOR INPUT AS </b>tfAssunto
 <b>OPEN </b>ARQAUTOR <b>FOR INPUT AS </b>tfAutor
 <b>OPEN </b>ARQEDITORA <b>FOR INPUT AS </b>tfEditora
 <b>OPEN </b>ARQIDIOMA <b>FOR INPUT AS </b>tfIdioma
 <b>OPEN </b>ARQENDERECO <b>FOR INPUT AS </b>tfEndereco
 <b>OPEN </b>ARQPAIS <b>FOR INPUT AS </b>tfPais
 <b>OPEN </b>ARQPROFISSAO <b>FOR INPUT AS </b>tfProfissao
 <b>OPEN </b>ARQLIVRO <b>FOR INPUT AS </b>tfLivro
 <b>OPEN </b>ARQLIVASS <b>FOR INPUT AS </b>tfLivroAss
 <b>OPEN </b>ARQLIVAUT <b>FOR INPUT AS </b>tfLivroAut
 <b>OPEN </b>ARQCLIENTE <b>FOR INPUT AS </b>tfCliente
 <b>OPEN </b>ARQUSUARIO <b>FOR INPUT AS </b>tfUsuario
 <b>OPEN </b>ARQVENDA <b>FOR INPUT AS </b>tfVenda
<b>ELSE
 OPEN </b>ARQASSUNTO <b>FOR </b>APPEND <b>AS </b>tfAssunto
 <b>OPEN </b>ARQAUTOR <b>FOR </b>APPEND <b>AS </b>tfAutor
 <b>OPEN </b>ARQEDITORA <b>FOR </b>APPEND <b>AS </b>tfEditora
 <b>OPEN </b>ARQIDIOMA <b>FOR </b>APPEND <b>AS </b>tfIdioma
 <b>OPEN </b>ARQENDERECO <b>FOR </b>APPEND <b>AS </b>tfEndereco
 <b>OPEN </b>ARQPAIS <b>FOR </b>APPEND <b>AS </b>tfPais
 <b>OPEN </b>ARQPROFISSAO <b>FOR </b>APPEND <b>AS </b>tfProfissao
 <b>OPEN </b>ARQLIVRO <b>FOR </b>APPEND <b>AS </b>tfLivro
 <b>OPEN </b>ARQLIVASS <b>FOR </b>APPEND <b>AS </b>tfLivroAss
 <b>OPEN </b>ARQLIVAUT <b>FOR </b>APPEND <b>AS </b>tfLivroAut
 <b>OPEN </b>ARQCLIENTE <b>FOR </b>APPEND <b>AS </b>tfCliente
 <b>OPEN </b>ARQUSUARIO <b>FOR </b>APPEND <b>AS </b>tfUsuario
 <b>OPEN </b>ARQVENDA <b>FOR </b>APPEND <b>AS </b>tfVenda
<b>END IF
END SUB

</b></font><font color="#808080"><i>'------------------------------------------------------------------------------
'Executa uma a‡&AElig;o de grava‡&AElig;o de acordo com o tipo de arquivo.
'sreg - o tipo de arquivo
'sacao - a a‡&AElig;o a ser realizada
'------------------------------------------------------------------------------
</i></font><font color="#000080"><b>SUB </b>btnAcao </font><font color="#808080">(</font><font color="#000080">sreg <b>AS INTEGER</b></font><font color="#808080">, </font><font color="#000080">sacao <b>AS INTEGER</b></font><font color="#808080">)
</font><font color="#000080"><b>DIM </b>nlinhareg <b>AS STRING</b></font><font color="#808080">, </font><font color="#000080">ntamreg <b>AS INTEGER

</b>nlinhareg </font><font color="#808080">= </font><font color="#000080">LinhaReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">)
</font><font color="#000080">ntamreg </font><font color="#808080">= </font><font color="#000080">tamReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">)
</font><font color="#000080"><b>IF </b>sreg </font><font color="#808080">= </font><font color="#000080">opAssunto <b>THEN
   IF </b>sacao </font><font color="#808080">= </font><font color="#000080">opSalvarInclusao <b>THEN
      </b>escreveArq tfAssunto</font><font color="#808080">, </font><font color="#000080">nlinhareg</font><font color="#808080">, </font><font color="#000080">MSGREGINC</font><font color="#808080">, </font><font color="#000080">MSGREGNINC
   <b>ELSEIF </b>sacao </font><font color="#808080">= </font><font color="#000080">opSalvarAlteracao <b>THEN
      </b>escreveArq tfAssunto</font><font color="#808080">, </font><font color="#000080">nlinhareg</font><font color="#808080">, </font><font color="#000080">MSGREGALT</font><font color="#808080">, </font><font color="#000080">MSGREGNALT
   <b>ELSEIF </b>sacao </font><font color="#808080">= </font><font color="#000080">opConfirmaExclusao <b>THEN
      </b>escreveArq tfAssunto</font><font color="#808080">, </font><font color="#000080">repete</font><font color="#808080">(</font><font color="#800000">&quot;*&quot;</font><font color="#808080">, </font><font color="#000080">ntamreg</font><font color="#808080">), </font><font color="#000080">MSGREGEXC</font><font color="#808080">, </font><font color="#000080">MSGREGNEXC
   <b>END IF
ELSEIF </b>sreg </font><font color="#808080">= </font><font color="#000080">opAutor <b>THEN
   IF </b>sacao </font><font color="#808080">= </font><font color="#000080">opSalvarInclusao <b>THEN
      </b>escreveArq tfAutor</font><font color="#808080">, </font><font color="#000080">nlinhareg</font><font color="#808080">, </font><font color="#000080">MSGREGINC</font><font color="#808080">, </font><font color="#000080">MSGREGNINC
   <b>ELSEIF </b>sacao </font><font color="#808080">= </font><font color="#000080">opSalvarAlteracao <b>THEN
      </b>escreveArq tfAutor</font><font color="#808080">, </font><font color="#000080">nlinhareg</font><font color="#808080">, </font><font color="#000080">MSGREGALT</font><font color="#808080">, </font><font color="#000080">MSGREGNALT
   <b>ELSEIF </b>sacao </font><font color="#808080">= </font><font color="#000080">opConfirmaExclusao <b>THEN
      </b>escreveArq tfAutor</font><font color="#808080">, </font><font color="#000080">repete</font><font color="#808080">(</font><font color="#800000">&quot;*&quot;</font><font color="#808080">, </font><font color="#000080">ntamreg</font><font color="#808080">), </font><font color="#000080">MSGREGEXC</font><font color="#808080">, </font><font color="#000080">MSGREGNEXC
   <b>END IF
ELSEIF </b>sreg </font><font color="#808080">= </font><font color="#000080">opEditora <b>THEN
   IF </b>sacao </font><font color="#808080">= </font><font color="#000080">opSalvarInclusao <b>THEN
      </b>escreveArq tfEditora</font><font color="#808080">, </font><font color="#000080">nlinhareg</font><font color="#808080">, </font><font color="#000080">MSGREGINC</font><font color="#808080">, </font><font color="#000080">MSGREGNINC
   <b>ELSEIF </b>sacao </font><font color="#808080">= </font><font color="#000080">opSalvarAlteracao <b>THEN
      </b>escreveArq tfEditora</font><font color="#808080">, </font><font color="#000080">nlinhareg</font><font color="#808080">, </font><font color="#000080">MSGREGALT</font><font color="#808080">, </font><font color="#000080">MSGREGNALT
   <b>ELSEIF </b>sacao </font><font color="#808080">= </font><font color="#000080">opConfirmaExclusao <b>THEN
      </b>escreveArq tfEditora</font><font color="#808080">, </font><font color="#000080">repete</font><font color="#808080">(</font><font color="#800000">&quot;*&quot;</font><font color="#808080">, </font><font color="#000080">ntamreg</font><font color="#808080">), </font><font color="#000080">MSGREGEXC</font><font color="#808080">, </font><font color="#000080">MSGREGNEXC
   <b>END IF
ELSEIF </b>sreg </font><font color="#808080">= </font><font color="#000080">opEndereco <b>THEN
   IF </b>sacao </font><font color="#808080">= </font><font color="#000080">opSalvarInclusao <b>THEN
      </b>escreveArq tfEndereco</font><font color="#808080">, </font><font color="#000080">nlinhareg</font><font color="#808080">, </font><font color="#000080">MSGREGINC</font><font color="#808080">, </font><font color="#000080">MSGREGNINC
   <b>ELSEIF </b>sacao </font><font color="#808080">= </font><font color="#000080">opSalvarAlteracao <b>THEN
      </b>escreveArq tfEndereco</font><font color="#808080">, </font><font color="#000080">nlinhareg</font><font color="#808080">, </font><font color="#000080">MSGREGALT</font><font color="#808080">, </font><font color="#000080">MSGREGNALT
   <b>ELSEIF </b>sacao </font><font color="#808080">= </font><font color="#000080">opConfirmaExclusao <b>THEN
      </b>escreveArq tfEndereco</font><font color="#808080">, </font><font color="#000080">repete</font><font color="#808080">(</font><font color="#800000">&quot;*&quot;</font><font color="#808080">, </font><font color="#000080">ntamreg</font><font color="#808080">), </font><font color="#000080">MSGREGEXC</font><font color="#808080">, </font><font color="#000080">MSGREGNEXC
   <b>END IF
ELSEIF </b>sreg </font><font color="#808080">= </font><font color="#000080">opIdioma <b>THEN
   IF </b>sacao </font><font color="#808080">= </font><font color="#000080">opSalvarInclusao <b>THEN
      </b>escreveArq tfIdioma</font><font color="#808080">, </font><font color="#000080">nlinhareg</font><font color="#808080">, </font><font color="#000080">MSGREGINC</font><font color="#808080">, </font><font color="#000080">MSGREGNINC
   <b>ELSEIF </b>sacao </font><font color="#808080">= </font><font color="#000080">opSalvarAlteracao <b>THEN
      </b>escreveArq tfIdioma</font><font color="#808080">, </font><font color="#000080">nlinhareg</font><font color="#808080">, </font><font color="#000080">MSGREGALT</font><font color="#808080">, </font><font color="#000080">MSGREGNALT
   <b>ELSEIF </b>sacao </font><font color="#808080">= </font><font color="#000080">opConfirmaExclusao <b>THEN
      </b>escreveArq tfIdioma</font><font color="#808080">, </font><font color="#000080">repete</font><font color="#808080">(</font><font color="#800000">&quot;*&quot;</font><font color="#808080">, </font><font color="#000080">ntamreg</font><font color="#808080">), </font><font color="#000080">MSGREGEXC</font><font color="#808080">, </font><font color="#000080">MSGREGNEXC
   <b>END IF
ELSEIF </b>sreg </font><font color="#808080">= </font><font color="#000080">opPais <b>THEN
   IF </b>sacao </font><font color="#808080">= </font><font color="#000080">opSalvarInclusao <b>THEN
      </b>escreveArq tfPais</font><font color="#808080">, </font><font color="#000080">nlinhareg</font><font color="#808080">, </font><font color="#000080">MSGREGINC</font><font color="#808080">, </font><font color="#000080">MSGREGNINC
   <b>ELSEIF </b>sacao </font><font color="#808080">= </font><font color="#000080">opSalvarAlteracao <b>THEN
      </b>escreveArq tfPais</font><font color="#808080">, </font><font color="#000080">nlinhareg</font><font color="#808080">, </font><font color="#000080">MSGREGALT</font><font color="#808080">, </font><font color="#000080">MSGREGNALT
   <b>ELSEIF </b>sacao </font><font color="#808080">= </font><font color="#000080">opConfirmaExclusao <b>THEN
      </b>escreveArq tfPais</font><font color="#808080">, </font><font color="#000080">repete</font><font color="#808080">(</font><font color="#800000">&quot;*&quot;</font><font color="#808080">, </font><font color="#000080">ntamreg</font><font color="#808080">), </font><font color="#000080">MSGREGEXC</font><font color="#808080">, </font><font color="#000080">MSGREGNEXC
   <b>END IF
ELSEIF </b>sreg </font><font color="#808080">= </font><font color="#000080">opProfissao <b>THEN
   IF </b>sacao </font><font color="#808080">= </font><font color="#000080">opSalvarInclusao <b>THEN
      </b>escreveArq tfProfissao</font><font color="#808080">, </font><font color="#000080">nlinhareg</font><font color="#808080">, </font><font color="#000080">MSGREGINC</font><font color="#808080">, </font><font color="#000080">MSGREGNINC
   <b>ELSEIF </b>sacao </font><font color="#808080">= </font><font color="#000080">opSalvarAlteracao <b>THEN
      </b>escreveArq tfProfissao</font><font color="#808080">, </font><font color="#000080">nlinhareg</font><font color="#808080">, </font><font color="#000080">MSGREGALT</font><font color="#808080">, </font><font color="#000080">MSGREGNALT
   <b>ELSEIF </b>sacao </font><font color="#808080">= </font><font color="#000080">opConfirmaExclusao <b>THEN
      </b>escreveArq tfProfissao</font><font color="#808080">, </font><font color="#000080">repete</font><font color="#808080">(</font><font color="#800000">&quot;*&quot;</font><font color="#808080">, </font><font color="#000080">ntamreg</font><font color="#808080">), </font><font color="#000080">MSGREGEXC</font><font color="#808080">, </font><font color="#000080">MSGREGNEXC
   <b>END IF
ELSEIF </b>sreg </font><font color="#808080">= </font><font color="#000080">opLivro <b>THEN
   IF </b>sacao </font><font color="#808080">= </font><font color="#000080">opSalvarInclusao <b>THEN
      </b>escreveArq tfLivro</font><font color="#808080">, </font><font color="#000080">nlinhareg</font><font color="#808080">, </font><font color="#000080">MSGREGINC</font><font color="#808080">, </font><font color="#000080">MSGREGNINC
   <b>ELSEIF </b>sacao </font><font color="#808080">= </font><font color="#000080">opSalvarAlteracao <b>THEN
      </b>escreveArq tfLivro</font><font color="#808080">, </font><font color="#000080">nlinhareg</font><font color="#808080">, </font><font color="#000080">MSGREGALT</font><font color="#808080">, </font><font color="#000080">MSGREGNALT
   <b>ELSEIF </b>sacao </font><font color="#808080">= </font><font color="#000080">opConfirmaExclusao <b>THEN
      </b>escreveArq tfLivro</font><font color="#808080">, </font><font color="#000080">repete</font><font color="#808080">(</font><font color="#800000">&quot;*&quot;</font><font color="#808080">, </font><font color="#000080">ntamreg</font><font color="#808080">), </font><font color="#000080">MSGREGEXC</font><font color="#808080">, </font><font color="#000080">MSGREGNEXC
   <b>END IF
ELSEIF </b>sreg </font><font color="#808080">= </font><font color="#000080">opLivroAss <b>THEN
   IF </b>sacao </font><font color="#808080">= </font><font color="#000080">opSalvarInclusao <b>THEN
      </b>escreveArq tfLivroAss</font><font color="#808080">, </font><font color="#000080">nlinhareg</font><font color="#808080">, </font><font color="#000080">MSGREGINC</font><font color="#808080">, </font><font color="#000080">MSGREGNINC
   <b>ELSEIF </b>sacao </font><font color="#808080">= </font><font color="#000080">opSalvarAlteracao <b>THEN
      </b>escreveArq tfLivroAss</font><font color="#808080">, </font><font color="#000080">nlinhareg</font><font color="#808080">, </font><font color="#000080">MSGREGALT</font><font color="#808080">, </font><font color="#000080">MSGREGNALT
   <b>ELSEIF </b>sacao </font><font color="#808080">= </font><font color="#000080">opConfirmaExclusao <b>THEN
      </b>escreveArq tfLivroAss</font><font color="#808080">, </font><font color="#000080">repete</font><font color="#808080">(</font><font color="#800000">&quot;*&quot;</font><font color="#808080">, </font><font color="#000080">ntamreg</font><font color="#808080">), </font><font color="#000080">MSGREGEXC</font><font color="#808080">, </font><font color="#000080">MSGREGNEXC
   <b>END IF
ELSEIF </b>sreg </font><font color="#808080">= </font><font color="#000080">opLivroAut <b>THEN
   IF </b>sacao </font><font color="#808080">= </font><font color="#000080">opSalvarInclusao <b>THEN
      </b>escreveArq tfLivroAut</font><font color="#808080">, </font><font color="#000080">nlinhareg</font><font color="#808080">, </font><font color="#000080">MSGREGINC</font><font color="#808080">, </font><font color="#000080">MSGREGNINC
   <b>ELSEIF </b>sacao </font><font color="#808080">= </font><font color="#000080">opSalvarAlteracao <b>THEN
      </b>escreveArq tfLivroAut</font><font color="#808080">, </font><font color="#000080">nlinhareg</font><font color="#808080">, </font><font color="#000080">MSGREGALT</font><font color="#808080">, </font><font color="#000080">MSGREGNALT
   <b>ELSEIF </b>sacao </font><font color="#808080">= </font><font color="#000080">opConfirmaExclusao <b>THEN
      </b>escreveArq tfLivroAut</font><font color="#808080">, </font><font color="#000080">repete</font><font color="#808080">(</font><font color="#800000">&quot;*&quot;</font><font color="#808080">, </font><font color="#000080">ntamreg</font><font color="#808080">), </font><font color="#000080">MSGREGEXC</font><font color="#808080">, </font><font color="#000080">MSGREGNEXC
   <b>END IF
ELSEIF </b>sreg </font><font color="#808080">= </font><font color="#000080">opCliente <b>THEN
   IF </b>sacao </font><font color="#808080">= </font><font color="#000080">opSalvarInclusao <b>THEN
      </b>escreveArq tfCliente</font><font color="#808080">, </font><font color="#000080">nlinhareg</font><font color="#808080">, </font><font color="#000080">MSGREGINC</font><font color="#808080">, </font><font color="#000080">MSGREGNINC
   <b>ELSEIF </b>sacao </font><font color="#808080">= </font><font color="#000080">opSalvarAlteracao <b>THEN
      </b>escreveArq tfCliente</font><font color="#808080">, </font><font color="#000080">nlinhareg</font><font color="#808080">, </font><font color="#000080">MSGREGALT</font><font color="#808080">, </font><font color="#000080">MSGREGNALT
   <b>ELSEIF </b>sacao </font><font color="#808080">= </font><font color="#000080">opConfirmaExclusao <b>THEN
      </b>escreveArq tfCliente</font><font color="#808080">, </font><font color="#000080">repete</font><font color="#808080">(</font><font color="#800000">&quot;*&quot;</font><font color="#808080">, </font><font color="#000080">ntamreg</font><font color="#808080">), </font><font color="#000080">MSGREGEXC</font><font color="#808080">, </font><font color="#000080">MSGREGNEXC
   <b>END IF
ELSEIF </b>sreg </font><font color="#808080">= </font><font color="#000080">opVenda <b>THEN
   IF </b>sacao </font><font color="#808080">= </font><font color="#000080">opSalvarInclusao <b>THEN
      </b>escreveArq tfVenda</font><font color="#808080">, </font><font color="#000080">nlinhareg</font><font color="#808080">, </font><font color="#000080">MSGREGINC</font><font color="#808080">, </font><font color="#000080">MSGREGNINC
   <b>ELSEIF </b>sacao </font><font color="#808080">= </font><font color="#000080">opSalvarAlteracao <b>THEN
      </b>escreveArq tfVenda</font><font color="#808080">, </font><font color="#000080">nlinhareg</font><font color="#808080">, </font><font color="#000080">MSGREGALT</font><font color="#808080">, </font><font color="#000080">MSGREGNALT
   <b>ELSEIF </b>sacao </font><font color="#808080">= </font><font color="#000080">opConfirmaExclusao <b>THEN
      </b>escreveArq tfVenda</font><font color="#808080">, </font><font color="#000080">repete</font><font color="#808080">(</font><font color="#800000">&quot;*&quot;</font><font color="#808080">, </font><font color="#000080">ntamreg</font><font color="#808080">), </font><font color="#000080">MSGREGEXC</font><font color="#808080">, </font><font color="#000080">MSGREGNEXC
   <b>END IF
ELSEIF </b>sreg </font><font color="#808080">= </font><font color="#000080">opUsuario <b>THEN
   IF </b>sacao </font><font color="#808080">= </font><font color="#000080">opSalvarAlteracao <b>THEN
      </b>escreveArq tfUsuario</font><font color="#808080">, </font><font color="#000080">nlinhareg</font><font color="#808080">, </font><font color="#000080">MSGREGALT</font><font color="#808080">, </font><font color="#000080">MSGREGNALT
   <b>END IF
END IF
END SUB

</b></font><font color="#808080"><i>'------------------------------------------------------------------------------
'Indica se continua ou n&AElig;o mostrando um n&pound;mero m ximo de linhas.
'nlinha - a linha a ser continuada
'nQtdLinha - a quantidade de linhas a serem mostradas
'retorna - se continua ou n&AElig;o
'------------------------------------------------------------------------------
</i></font><font color="#000080"><b>FUNCTION </b>ContinuaSN! </font><font color="#808080">(</font><font color="#000080">nlinha <b>AS INTEGER</b></font><font color="#808080">, </font><font color="#000080">nQtdLinha <b>AS INTEGER</b></font><font color="#808080">)
</font><font color="#000080"><b>DIM </b>bSOp</font><font color="#808080">, </font><font color="#000080">bret <b>AS INTEGER
DIM </b>opCSubMenu <b>AS STRING

</b>bret </font><font color="#808080">= </font><font color="#000080">false
<b>IF </b>nlinha </font><font color="#808080">&gt; </font><font color="#FF0000">0 </font><font color="#000080"><b>THEN
  IF </b></font><font color="#808080">(</font><font color="#000080">nlinha <b>MOD </b>nQtdLinha</font><font color="#808080">) = </font><font color="#FF0000">0 </font><font color="#000080"><b>THEN
     </b>bSOp </font><font color="#808080">= </font><font color="#000080">true
     <b>DO WHILE </b>bSOp
       menu </font><font color="#808080">(</font><font color="#FF0000">13</font><font color="#808080">)
       </font><font color="#000080"><b>INPUT </b></font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#000080">opCSubMenu
       <b>IF </b></font><font color="#808080">(</font><font color="#000080">opCSubMenu </font><font color="#808080">= </font><font color="#800000">&quot;S&quot;</font><font color="#808080">) </font><font color="#000080"><b>OR </b></font><font color="#808080">(</font><font color="#000080">opCSubMenu </font><font color="#808080">= </font><font color="#800000">&quot;s&quot;</font><font color="#808080">) </font><font color="#000080"><b>THEN
</b></font>	 <font color="#000080">bSOp </font><font color="#808080">= </font><font color="#000080">false
       <b>ELSEIF </b></font><font color="#808080">(</font><font color="#000080">opCSubMenu </font><font color="#808080">= </font><font color="#800000">&quot;N&quot;</font><font color="#808080">) </font><font color="#000080"><b>OR </b></font><font color="#808080">(</font><font color="#000080">opCSubMenu </font><font color="#808080">= </font><font color="#800000">&quot;n&quot;</font><font color="#808080">) </font><font color="#000080"><b>THEN
</b></font>	  <font color="#000080">bret </font><font color="#808080">= </font><font color="#000080">true
</font>	  <font color="#000080">bSOp </font><font color="#808080">= </font><font color="#000080">false
       <b>ELSE
</b></font>	 <font color="#000080"><b>PRINT </b>MSGERRO
       <b>END IF
     LOOP
  END IF
END IF

</b>ContinuaSN </font><font color="#808080">= </font><font color="#000080">bret
<b>END FUNCTION

</b></font><font color="#808080"><i>'------------------------------------------------------------------------------
'Esconde a digita‡&AElig;o da senha
'retorna - a senha digitada
'------------------------------------------------------------------------------
</i></font><font color="#000080"><b>FUNCTION </b>digitaSenha$ </font><font color="#808080">(</font><font color="#000080">sRotulo <b>AS STRING</b></font><font color="#808080">, </font><font color="#000080">nTamSenha <b>AS INTEGER</b></font><font color="#808080">)
</font><font color="#000080"><b>DIM </b>sSenha <b>AS STRING</b></font><font color="#808080">, </font><font color="#000080">sLetra <b>AS STRING
DIM </b>nCont <b>AS INTEGER

PRINT </b>sRotulo</font><font color="#808080">;
</font><font color="#000080">nCont </font><font color="#808080">= </font><font color="#FF0000">0
</font><font color="#000080">sSenha </font><font color="#808080">= </font><font color="#800000">&quot;&quot;
</font><font color="#000080">sLetra </font><font color="#808080">= </font><font color="#800000">&quot;&quot;
</font><font color="#000080"><b>DO
  </b>sLetra </font><font color="#808080">= </font><font color="#000080">INKEY$
  sSenha </font><font color="#808080">= </font><font color="#000080">sSenha </font><font color="#808080">+ </font><font color="#000080">sLetra
  </font><font color="#808080"><i>'nCont = nCont + 1
  'IF nCont = nTamSenha THEN
  '   EXIT DO
  'END IF
</i></font><font color="#000080"><b>LOOP UNTIL </b>sLetra </font><font color="#808080">= </font><font color="#000080"><b>CHR</b>$</font><font color="#808080">(</font><font color="#FF0000">13</font><font color="#808080">)
</font><font color="#000080">digitaSenha </font><font color="#808080">= </font><font color="#000080"><b>MID</b>$</font><font color="#808080">(</font><font color="#000080">sSenha</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#000080"><b>LEN</b></font><font color="#808080">(</font><font color="#000080">sSenha</font><font color="#808080">) - </font><font color="#FF0000">1</font><font color="#808080">)
</font><font color="#000080"><b>END FUNCTION

</b></font><font color="#808080"><i>'------------------------------------------------------------------------------
'Grava os registros num determinado arquivo.
'sArq - o arquivo
'sTexto - o registro a ser gravado
'sMsgAcerto - a mensagem caso o registro foi gravado
'sMsgErro - a mensagem caso o registro n&AElig;o foi gravado
'------------------------------------------------------------------------------
</i></font><font color="#000080"><b>SUB </b>escreveArq </font><font color="#808080">(</font><font color="#000080">sArq <b>AS INTEGER</b></font><font color="#808080">, </font><font color="#000080">sTexto <b>AS STRING</b></font><font color="#808080">, </font><font color="#000080">sMsgAcerto <b>AS STRING</b></font><font color="#808080">, </font><font color="#000080">sMsgErro <b>AS STRING</b></font><font color="#808080">)

</font><font color="#000080"><b>CLOSE
</b>abreArqs false
<b>SEEK </b>sArq</font><font color="#808080">, </font><font color="#000080">gnPosicao

</font><font color="#808080"><i>'sTexto = sTexto + CRLF
</i></font><font color="#000080"><b>PRINT </b></font><font color="#800000">#sArq, sTexto

</font><font color="#808080"><i>'if nStatus &gt; 0 then
   </i></font><font color="#000080"><b>PRINT </b>sMsgAcerto
</font><font color="#808080"><i>'else
'   print sMsgErro
'end if

</i></font><font color="#000080"><b>CLOSE
</b>abreArqs true

<b>END SUB

</b></font><font color="#808080"><i>'------------------------------------------------------------------------------
'Coloca espa‡os em branco a mais de acordo com o tamanho m ximo do texto.
'sTexto - o texto
'nTam - tamanho m ximo do texto
'retorna - o texto com espa‡os em branco a mais
'------------------------------------------------------------------------------
</i></font><font color="#000080"><b>FUNCTION </b>esp$ </font><font color="#808080">(</font><font color="#000080">sTexto <b>AS STRING</b></font><font color="#808080">, </font><font color="#000080">ntam <b>AS INTEGER</b></font><font color="#808080">)
  </font><font color="#000080">esp </font><font color="#808080">= </font><font color="#000080">sTexto </font><font color="#808080">+ </font><font color="#000080">repete$</font><font color="#808080">(</font><font color="#800000">&quot; &quot;</font><font color="#808080">, </font><font color="#000080">ntam </font><font color="#808080">- </font><font color="#000080"><b>LEN</b></font><font color="#808080">(</font><font color="#000080">sTexto</font><font color="#808080">))
</font><font color="#000080"><b>END FUNCTION

</b></font><font color="#808080"><i>'------------------------------------------------------------------------------
'Realiza a exclus&AElig;o dos arquivos de liga‡&AElig;o.
'sArq - o arquivo de liga‡&AElig;o
'sreg - o tipo de arquivo de liga‡&AElig;o
'nPosChave - a posicao inicial da chave dentro do registro
'nTamChave - o tamanho da chave dentro do registro
'sChave - a chave a ser excluida
'------------------------------------------------------------------------------
</i></font><font color="#000080"><b>SUB </b>ExcluirRegLigados </font><font color="#808080">(</font><font color="#000080">sArq <b>AS INTEGER</b></font><font color="#808080">, </font><font color="#000080">sreg <b>AS INTEGER</b></font><font color="#808080">, </font><font color="#000080">nPosChave <b>AS INTEGER</b></font><font color="#808080">, </font><font color="#000080">nTamChave <b>AS INTEGER</b></font><font color="#808080">, </font><font color="#000080">sChave <b>AS STRING</b></font><font color="#808080">)
</font><font color="#000080"><b>DIM </b>slinha <b>AS STRING
DIM </b>sCodigo <b>AS STRING

  SEEK </b>sArq</font><font color="#808080">, </font><font color="#FF0000">1
  </font><font color="#000080"><b>DO WHILE NOT EOF</b></font><font color="#808080">(</font><font color="#000080">sArq</font><font color="#808080">)
    </font><font color="#000080"><b>LINE INPUT </b></font><font color="#800000">#sArq, slinha
    </font><font color="#000080">sCodigo </font><font color="#808080">= </font><font color="#000080"><b>Trim</b>$</font><font color="#808080">(</font><font color="#000080"><b>MID</b>$</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#000080">nPosChave</font><font color="#808080">, </font><font color="#000080">nTamChave</font><font color="#808080">))
    </font><font color="#000080"><b>IF </b>sCodigo </font><font color="#808080">= </font><font color="#000080">sChave <b>THEN
       </b>btnAcao sreg</font><font color="#808080">, </font><font color="#000080">opConfirmaExclusao
    <b>END IF
  LOOP
END SUB

</b></font><font color="#808080"><i>'------------------------------------------------------------------------------
'Fecha todos os arquivos abertos.
'------------------------------------------------------------------------------
</i></font><font color="#000080"><b>SUB </b>fechaArqs
 <b>CLOSE </b>tfAssunto
 <b>CLOSE </b>tfAutor
 <b>CLOSE </b>tfEditora
 <b>CLOSE </b>tfIdioma
 <b>CLOSE </b>tfEndereco
 <b>CLOSE </b>tfPais
 <b>CLOSE </b>tfProfissao
 <b>CLOSE </b>tfLivro
 <b>CLOSE </b>fLivroAss
 <b>CLOSE </b>tfLivroAut
 <b>CLOSE </b>tfCliente
 <b>CLOSE </b>tfUsuario
 <b>CLOSE </b>tfVenda
<b>END SUB

</b></font><font color="#808080"><i>'------------------------------------------------------------------------------
'Mostra a tela de altera‡&AElig;o de senha do sistema e realiza a altera‡&AElig;o.
'------------------------------------------------------------------------------
</i></font><font color="#000080"><b>SUB </b>frmAlterarSenha
<b>DIM </b>bQuebra <b>AS INTEGER
DIM </b>sres <b>AS STRING</b></font><font color="#808080">, </font><font color="#000080">sSenhaAtual <b>AS STRING
DIM </b>sNovaSenha <b>AS STRING</b></font><font color="#808080">, </font><font color="#000080">sConfirmaSenha <b>AS STRING
DIM </b>nOpcao <b>AS INTEGER</b></font><font color="#808080">, </font><font color="#000080">ntam <b>AS INTEGER

PRINT </b>rotulo</font><font color="#808080">(</font><font color="#000080">opUsuario</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">) + </font><font color="#000080">tUsuario</font><font color="#808080">.</font><font color="#000080">login
nOpcao </font><font color="#808080">= </font><font color="#FF0000">1
</font><font color="#000080">bQuebra </font><font color="#808080">= </font><font color="#000080">false
<b>DO WHILE </b></font><font color="#808080">(</font><font color="#000080">bQuebra </font><font color="#808080">= </font><font color="#000080">false</font><font color="#808080">)
  </font><font color="#000080"><b>SELECT CASE </b>nOpcao
   <b>CASE </b></font><font color="#FF0000">1
       </font><font color="#000080">sSenhaAtual </font><font color="#808080">= </font><font color="#000080">digitaSenha</font><font color="#808080">(</font><font color="#800000">&quot;Senha Atual: &quot;</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">)
       </font><font color="#000080"><b>IF </b>sSenhaAtual </font><font color="#808080">&lt;&gt; </font><font color="#000080">tUsuario</font><font color="#808080">.</font><font color="#000080">senha <b>THEN
</b></font>	  <font color="#000080"><b>PRINT </b>MSGSENCONFERE
</font>	  <font color="#000080">bQuebra </font><font color="#808080">= </font><font color="#000080">true
       <b>ELSE </b>nOpcao </font><font color="#808080">= </font><font color="#FF0000">2
       </font><font color="#000080"><b>END IF
   CASE </b></font><font color="#FF0000">2
       </font><font color="#000080">sNovaSenha </font><font color="#808080">= </font><font color="#000080">digitaSenha</font><font color="#808080">(</font><font color="#800000">&quot;Nova Senha: &quot;</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">)
       </font><font color="#000080">sConfirmaSenha </font><font color="#808080">= </font><font color="#000080">digitaSenha</font><font color="#808080">(</font><font color="#800000">&quot;Confirma Senha: &quot;</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">)
       </font><font color="#000080"><b>IF </b>sNovaSenha </font><font color="#808080">&lt;&gt; </font><font color="#000080">sConfirmaSenha <b>THEN
</b></font>	  <font color="#000080"><b>PRINT </b>MSGSENCONFIRM
</font>	  <font color="#000080">bQuebra </font><font color="#808080">= </font><font color="#000080">true
       <b>ELSE </b>nOpcao </font><font color="#808080">= </font><font color="#FF0000">3
       </font><font color="#000080"><b>END IF
   CASE </b></font><font color="#FF0000">3
       </font><font color="#000080">ntam </font><font color="#808080">= </font><font color="#000080">tamReg</font><font color="#808080">(</font><font color="#000080">opUsuario</font><font color="#808080">)
       </font><font color="#000080">sres </font><font color="#808080">= </font><font color="#000080">pesqArq</font><font color="#808080">(</font><font color="#000080">tfUsuario</font><font color="#808080">, </font><font color="#000080">tUsuario</font><font color="#808080">.</font><font color="#000080">login</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">, </font><font color="#000080">ntam</font><font color="#808080">)
       </font><font color="#000080"><b>IF </b>sres </font><font color="#808080">= </font><font color="#800000">&quot;&quot; </font><font color="#000080"><b>THEN
</b></font>	 <font color="#000080"><b>PRINT </b>MSGLOGINENCON
       <b>ELSE
</b></font>	 <font color="#000080">tUsuario</font><font color="#808080">.</font><font color="#000080">senha </font><font color="#808080">= </font><font color="#000080">sConfirmaSenha
</font>	 <font color="#000080">subMenu </font><font color="#FF0000">9</font><font color="#808080">, </font><font color="#000080">opUsuario
</font>	 <font color="#000080">bQuebra </font><font color="#808080">= </font><font color="#000080">true
       <b>END IF
  END SELECT
LOOP

END SUB

</b></font><font color="#808080"><i>'------------------------------------------------------------------------------
'Realiza os cadastros de acordo com o tipo de arquivo.
'sreg - o tipo de arquivo
'sacao - a a‡&AElig;o a ser realizada
'------------------------------------------------------------------------------
</i></font><font color="#000080"><b>SUB </b>frmCadastros </font><font color="#808080">(</font><font color="#000080">sreg <b>AS INTEGER</b></font><font color="#808080">, </font><font color="#000080">sacao <b>AS INTEGER</b></font><font color="#808080">)
</font><font color="#000080"><b>DIM </b>slinha <b>AS STRING</b></font><font color="#808080">, </font><font color="#000080">ntam <b>AS INTEGER

</b>ntam </font><font color="#808080">= </font><font color="#000080">tamReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">)
</font><font color="#000080"><b>IF </b>sreg </font><font color="#808080">= </font><font color="#000080">opAssunto <b>THEN
   IF </b>sacao </font><font color="#808080">= </font><font color="#000080">opNovo <b>THEN
      </b>tAssunto</font><font color="#808080">.</font><font color="#000080">codigo </font><font color="#808080">= </font><font color="#000080">pesqMaxCod</font><font color="#808080">(</font><font color="#000080">tfAssunto</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">, </font><font color="#000080">ntam</font><font color="#808080">)
      </font><font color="#000080">mostrarDados sreg</font><font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">1
      </font><font color="#000080">subMenu </font><font color="#FF0000">7</font><font color="#808080">, </font><font color="#000080">sreg
   <b>ELSEIF </b>sacao </font><font color="#808080">= </font><font color="#000080">opPesquisar <b>THEN
     </b>slinha </font><font color="#808080">= </font><font color="#000080">validaEntrada</font><font color="#808080">(</font><font color="#000080">tfAssunto</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#000080">tAssunto</font><font color="#808080">.</font><font color="#000080">codigo</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#000080">false</font><font color="#808080">, </font><font color="#000080">opNumero</font><font color="#808080">)
      </font><font color="#000080"><b>IF </b>slinha </font><font color="#808080">&lt;&gt; </font><font color="#800000">&quot;&quot; </font><font color="#000080"><b>THEN
</b></font>	<font color="#000080">mostrarDados sreg</font><font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">2
</font>	<font color="#000080">mostrarDados sreg</font><font color="#808080">, </font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">3
</font>	<font color="#000080">subMenu </font><font color="#FF0000">8</font><font color="#808080">, </font><font color="#000080">sreg
      <b>END IF
   ELSEIF </b>sacao </font><font color="#808080">= </font><font color="#000080">opAlterar <b>THEN
      </b>mostrarDados sreg</font><font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">1
      </font><font color="#000080">subMenu </font><font color="#FF0000">9</font><font color="#808080">, </font><font color="#000080">sreg
   <b>ELSEIF </b>sacao </font><font color="#808080">= </font><font color="#000080">opExcluir <b>THEN
      </b>subMenu </font><font color="#FF0000">10</font><font color="#808080">, </font><font color="#000080">sreg
   <b>END IF
ELSEIF </b>sreg </font><font color="#808080">= </font><font color="#000080">opAutor <b>THEN
   IF </b>sacao </font><font color="#808080">= </font><font color="#000080">opNovo <b>THEN
      </b>tAutor</font><font color="#808080">.</font><font color="#000080">codigo </font><font color="#808080">= </font><font color="#000080">pesqMaxCod</font><font color="#808080">(</font><font color="#000080">tfAutor</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">, </font><font color="#000080">ntam</font><font color="#808080">)
      </font><font color="#000080">mostrarDados sreg</font><font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">1
      </font><font color="#000080">subMenu </font><font color="#FF0000">7</font><font color="#808080">, </font><font color="#000080">sreg
   <b>ELSEIF </b>sacao </font><font color="#808080">= </font><font color="#000080">opPesquisar <b>THEN
      </b>slinha </font><font color="#808080">= </font><font color="#000080">validaEntrada</font><font color="#808080">(</font><font color="#000080">tfAutor</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#000080">tAutor</font><font color="#808080">.</font><font color="#000080">codigo</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#000080">false</font><font color="#808080">, </font><font color="#000080">opNumero</font><font color="#808080">)
      </font><font color="#000080"><b>IF </b>slinha </font><font color="#808080">&lt;&gt; </font><font color="#800000">&quot;&quot; </font><font color="#000080"><b>THEN
</b></font>	<font color="#000080">mostrarDados sreg</font><font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">2
</font>	<font color="#000080">mostrarDados sreg</font><font color="#808080">, </font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">3
</font>	<font color="#000080">subMenu </font><font color="#FF0000">8</font><font color="#808080">, </font><font color="#000080">sreg
      <b>END IF
   ELSEIF </b>sacao </font><font color="#808080">= </font><font color="#000080">opAlterar <b>THEN
      </b>mostrarDados sreg</font><font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">1
      </font><font color="#000080">subMenu </font><font color="#FF0000">9</font><font color="#808080">, </font><font color="#000080">sreg
   <b>ELSEIF </b>sacao </font><font color="#808080">= </font><font color="#000080">opExcluir <b>THEN
      </b>subMenu </font><font color="#FF0000">10</font><font color="#808080">, </font><font color="#000080">sreg
   <b>END IF
ELSEIF </b>sreg </font><font color="#808080">= </font><font color="#000080">opEditora <b>THEN
   IF </b>sacao </font><font color="#808080">= </font><font color="#000080">opNovo <b>THEN
      </b>tEditora</font><font color="#808080">.</font><font color="#000080">codigo </font><font color="#808080">= </font><font color="#000080">pesqMaxCod</font><font color="#808080">(</font><font color="#000080">tfEditora</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">, </font><font color="#000080">ntam</font><font color="#808080">)
      </font><font color="#000080">mostrarDados sreg</font><font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">1
      </font><font color="#000080">subMenu </font><font color="#FF0000">7</font><font color="#808080">, </font><font color="#000080">sreg
   <b>ELSEIF </b>sacao </font><font color="#808080">= </font><font color="#000080">opPesquisar <b>THEN
     </b>slinha </font><font color="#808080">= </font><font color="#000080">validaEntrada</font><font color="#808080">(</font><font color="#000080">tfEditora</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#000080">tEditora</font><font color="#808080">.</font><font color="#000080">codigo</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#000080">false</font><font color="#808080">, </font><font color="#000080">opNumero</font><font color="#808080">)
      </font><font color="#000080"><b>IF </b>slinha </font><font color="#808080">&lt;&gt; </font><font color="#800000">&quot;&quot; </font><font color="#000080"><b>THEN
</b></font>	<font color="#000080">mostrarDados sreg</font><font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">2
</font>	<font color="#000080">mostrarDados sreg</font><font color="#808080">, </font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">3
</font>	<font color="#000080">subMenu </font><font color="#FF0000">8</font><font color="#808080">, </font><font color="#000080">sreg
      <b>END IF
   ELSEIF </b>sacao </font><font color="#808080">= </font><font color="#000080">opAlterar <b>THEN
      </b>mostrarDados sreg</font><font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">1
      </font><font color="#000080">subMenu </font><font color="#FF0000">9</font><font color="#808080">, </font><font color="#000080">sreg
   <b>ELSEIF </b>sacao </font><font color="#808080">= </font><font color="#000080">opExcluir <b>THEN
      </b>subMenu </font><font color="#FF0000">10</font><font color="#808080">, </font><font color="#000080">sreg
   <b>END IF
ELSEIF </b>sreg </font><font color="#808080">= </font><font color="#000080">opEndereco <b>THEN
   IF </b>sacao </font><font color="#808080">= </font><font color="#000080">opNovo <b>THEN
      </b>tEndereco</font><font color="#808080">.</font><font color="#000080">codigo </font><font color="#808080">= </font><font color="#000080">pesqMaxCod</font><font color="#808080">(</font><font color="#000080">tfEndereco</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">, </font><font color="#000080">ntam</font><font color="#808080">)
      </font><font color="#000080">mostrarDados sreg</font><font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">1
      </font><font color="#000080">subMenu </font><font color="#FF0000">7</font><font color="#808080">, </font><font color="#000080">sreg
   <b>ELSEIF </b>sacao </font><font color="#808080">= </font><font color="#000080">opPesquisar <b>THEN
      </b>slinha </font><font color="#808080">= </font><font color="#000080">validaEntrada</font><font color="#808080">(</font><font color="#000080">tfEndereco</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#000080">tEndereco</font><font color="#808080">.</font><font color="#000080">codigo</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#000080">false</font><font color="#808080">, </font><font color="#000080">opNumero</font><font color="#808080">)
      </font><font color="#000080"><b>IF </b>slinha </font><font color="#808080">&lt;&gt; </font><font color="#800000">&quot;&quot; </font><font color="#000080"><b>THEN
</b></font>	<font color="#000080">mostrarDados sreg</font><font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">2
</font>	<font color="#000080">mostrarDados sreg</font><font color="#808080">, </font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">3
</font>	<font color="#000080">subMenu </font><font color="#FF0000">8</font><font color="#808080">, </font><font color="#000080">sreg
      <b>END IF
   ELSEIF </b>sacao </font><font color="#808080">= </font><font color="#000080">opAlterar <b>THEN
      </b>mostrarDados sreg</font><font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">1
      </font><font color="#000080">subMenu </font><font color="#FF0000">9</font><font color="#808080">, </font><font color="#000080">sreg
   <b>ELSEIF </b>sacao </font><font color="#808080">= </font><font color="#000080">opExcluir <b>THEN
      </b>subMenu </font><font color="#FF0000">10</font><font color="#808080">, </font><font color="#000080">sreg
   <b>END IF
ELSEIF </b>sreg </font><font color="#808080">= </font><font color="#000080">opIdioma <b>THEN
   IF </b>sacao </font><font color="#808080">= </font><font color="#000080">opNovo <b>THEN
      </b>tIdioma</font><font color="#808080">.</font><font color="#000080">codigo </font><font color="#808080">= </font><font color="#000080">pesqMaxCod</font><font color="#808080">(</font><font color="#000080">tfIdioma</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">, </font><font color="#000080">ntam</font><font color="#808080">)
      </font><font color="#000080">mostrarDados sreg</font><font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">1
      </font><font color="#000080">subMenu </font><font color="#FF0000">7</font><font color="#808080">, </font><font color="#000080">sreg
   <b>ELSEIF </b>sacao </font><font color="#808080">= </font><font color="#000080">opPesquisar <b>THEN
      </b>slinha </font><font color="#808080">= </font><font color="#000080">validaEntrada</font><font color="#808080">(</font><font color="#000080">tfIdioma</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#000080">tIdioma</font><font color="#808080">.</font><font color="#000080">codigo</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#000080">false</font><font color="#808080">, </font><font color="#000080">opNumero</font><font color="#808080">)
      </font><font color="#000080"><b>IF </b>slinha </font><font color="#808080">&lt;&gt; </font><font color="#800000">&quot;&quot; </font><font color="#000080"><b>THEN
</b></font>	<font color="#000080">mostrarDados sreg</font><font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">2
</font>	<font color="#000080">mostrarDados sreg</font><font color="#808080">, </font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">3
</font>	<font color="#000080">subMenu </font><font color="#FF0000">8</font><font color="#808080">, </font><font color="#000080">sreg
      <b>END IF
   ELSEIF </b>sacao </font><font color="#808080">= </font><font color="#000080">opAlterar <b>THEN
      </b>mostrarDados sreg</font><font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">1
      </font><font color="#000080">subMenu </font><font color="#FF0000">9</font><font color="#808080">, </font><font color="#000080">sreg
   <b>ELSEIF </b>sacao </font><font color="#808080">= </font><font color="#000080">opExcluir <b>THEN
      </b>subMenu </font><font color="#FF0000">10</font><font color="#808080">, </font><font color="#000080">sreg
   <b>END IF
ELSEIF </b>sreg </font><font color="#808080">= </font><font color="#000080">opPais <b>THEN
   IF </b>sacao </font><font color="#808080">= </font><font color="#000080">opNovo <b>THEN
      PRINT </b>rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">);
      </font><font color="#000080"><b>INPUT </b></font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#000080">tPais</font><font color="#808080">.</font><font color="#000080">codigo
      slinha </font><font color="#808080">= </font><font color="#000080">pesqArq</font><font color="#808080">(</font><font color="#000080">tfPais</font><font color="#808080">, </font><font color="#000080">tPais</font><font color="#808080">.</font><font color="#000080">codigo</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">, </font><font color="#000080">ntam</font><font color="#808080">)
      </font><font color="#000080"><b>IF </b>slinha </font><font color="#808080">= </font><font color="#800000">&quot;&quot; </font><font color="#000080"><b>THEN
</b></font>	 <font color="#000080">pesqLinhaExcluida tfPais</font><font color="#808080">, </font><font color="#000080">ntam
</font>	 <font color="#000080">mostrarDados sreg</font><font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">1
</font>	 <font color="#000080">subMenu </font><font color="#FF0000">7</font><font color="#808080">, </font><font color="#000080">sreg
      <b>ELSE
</b></font>	 <font color="#000080"><b>PRINT </b>MSGREGEXST
      <b>END IF
   ELSEIF </b>sacao </font><font color="#808080">= </font><font color="#000080">opPesquisar <b>THEN
      </b>slinha </font><font color="#808080">= </font><font color="#000080">validaEntrada</font><font color="#808080">(</font><font color="#000080">tfPais</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#000080">tPais</font><font color="#808080">.</font><font color="#000080">codigo</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#000080">false</font><font color="#808080">, </font><font color="#000080">opTexto</font><font color="#808080">)
      </font><font color="#000080"><b>IF </b>slinha </font><font color="#808080">&lt;&gt; </font><font color="#800000">&quot;&quot; </font><font color="#000080"><b>THEN
</b></font>	<font color="#000080">mostrarDados sreg</font><font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">2
</font>	<font color="#000080">mostrarDados sreg</font><font color="#808080">, </font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">3
</font>	<font color="#000080">subMenu </font><font color="#FF0000">8</font><font color="#808080">, </font><font color="#000080">sreg
      <b>END IF
   ELSEIF </b>sacao </font><font color="#808080">= </font><font color="#000080">opAlterar <b>THEN
      PRINT </b>rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">) + </font><font color="#000080">tPais</font><font color="#808080">.</font><font color="#000080">codigo
      mostrarDados sreg</font><font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">1
      </font><font color="#000080">subMenu </font><font color="#FF0000">9</font><font color="#808080">, </font><font color="#000080">sreg
   <b>ELSEIF </b>sacao </font><font color="#808080">= </font><font color="#000080">opExcluir <b>THEN
      </b>subMenu </font><font color="#FF0000">10</font><font color="#808080">, </font><font color="#000080">sreg
   <b>END IF
ELSEIF </b>sreg </font><font color="#808080">= </font><font color="#000080">opProfissao <b>THEN
   IF </b>sacao </font><font color="#808080">= </font><font color="#000080">opNovo <b>THEN
      </b>tProfissao</font><font color="#808080">.</font><font color="#000080">codigo </font><font color="#808080">= </font><font color="#000080">pesqMaxCod</font><font color="#808080">(</font><font color="#000080">tfProfissao</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">, </font><font color="#000080">ntam</font><font color="#808080">)
      </font><font color="#000080">mostrarDados sreg</font><font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">1
      </font><font color="#000080">subMenu </font><font color="#FF0000">7</font><font color="#808080">, </font><font color="#000080">sreg
   <b>ELSEIF </b>sacao </font><font color="#808080">= </font><font color="#000080">opPesquisar <b>THEN
      </b>slinha </font><font color="#808080">= </font><font color="#000080">validaEntrada</font><font color="#808080">(</font><font color="#000080">tfProfissao</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#000080">tProfissao</font><font color="#808080">.</font><font color="#000080">codigo</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#000080">false</font><font color="#808080">, </font><font color="#000080">opNumero</font><font color="#808080">)
      </font><font color="#000080"><b>IF </b>slinha </font><font color="#808080">&lt;&gt; </font><font color="#800000">&quot;&quot; </font><font color="#000080"><b>THEN
</b></font>	<font color="#000080">mostrarDados sreg</font><font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">2
</font>	<font color="#000080">mostrarDados sreg</font><font color="#808080">, </font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">3
</font>	<font color="#000080">subMenu </font><font color="#FF0000">8</font><font color="#808080">, </font><font color="#000080">sreg
      <b>END IF
   ELSEIF </b>sacao </font><font color="#808080">= </font><font color="#000080">opAlterar <b>THEN
      </b>mostrarDados sreg</font><font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">1
      </font><font color="#000080">subMenu </font><font color="#FF0000">9</font><font color="#808080">, </font><font color="#000080">sreg
   <b>ELSEIF </b>sacao </font><font color="#808080">= </font><font color="#000080">opExcluir <b>THEN
      </b>subMenu </font><font color="#FF0000">10</font><font color="#808080">, </font><font color="#000080">sreg
   <b>END IF
ELSEIF </b>sreg </font><font color="#808080">= </font><font color="#000080">opLivro <b>THEN
   IF </b>sacao </font><font color="#808080">= </font><font color="#000080">opNovo <b>THEN
      PRINT </b>rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">);
      </font><font color="#000080"><b>INPUT </b></font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#000080">tLivro</font><font color="#808080">.</font><font color="#000080">isbn
      <b>IF </b>validaISBN</font><font color="#808080">(</font><font color="#000080">tLivro</font><font color="#808080">.</font><font color="#000080">isbn</font><font color="#808080">) </font><font color="#000080"><b>THEN
</b></font>	  <font color="#000080">slinha </font><font color="#808080">= </font><font color="#000080">pesqArq</font><font color="#808080">(</font><font color="#000080">tfLivro</font><font color="#808080">, </font><font color="#000080">tLivro</font><font color="#808080">.</font><font color="#000080">isbn</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">13</font><font color="#808080">, </font><font color="#000080">ntam</font><font color="#808080">)
</font>	  <font color="#000080"><b>IF </b>slinha </font><font color="#808080">= </font><font color="#800000">&quot;&quot; </font><font color="#000080"><b>THEN
</b></font>	     <font color="#000080">pesqLinhaExcluida tfLivro</font><font color="#808080">, </font><font color="#000080">ntam
</font>	     <font color="#000080">mostrarDados sreg</font><font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">1
</font>	     <font color="#000080">subMenu </font><font color="#FF0000">7</font><font color="#808080">, </font><font color="#000080">sreg
</font>	     <font color="#000080">frmCadLigados opLivroAss</font><font color="#808080">, </font><font color="#000080">opNovo</font><font color="#808080">, </font><font color="#000080">tLivro</font><font color="#808080">.</font><font color="#000080">isbn
</font>	     <font color="#000080">frmCadLigados opLivroAut</font><font color="#808080">, </font><font color="#000080">opNovo</font><font color="#808080">, </font><font color="#000080">tLivro</font><font color="#808080">.</font><font color="#000080">isbn
</font>	  <font color="#000080"><b>ELSE PRINT </b>MSGREGEXST
</font>	  <font color="#000080"><b>END IF
      ELSE PRINT </b>MSGISBNINV
      <b>END IF
   ELSEIF </b>sacao </font><font color="#808080">= </font><font color="#000080">opPesquisar <b>THEN
      </b>slinha </font><font color="#808080">= </font><font color="#000080">validaEntrada</font><font color="#808080">(</font><font color="#000080">tfLivro</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#000080">tLivro</font><font color="#808080">.</font><font color="#000080">isbn</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#000080">false</font><font color="#808080">, </font><font color="#000080">opTexto</font><font color="#808080">)
      </font><font color="#000080"><b>IF </b>slinha </font><font color="#808080">&lt;&gt; </font><font color="#800000">&quot;&quot; </font><font color="#000080"><b>THEN
</b></font>	 <font color="#000080">mostrarDados sreg</font><font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">2
</font>	 <font color="#000080">mostrarDados sreg</font><font color="#808080">, </font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">3
</font>	 <font color="#000080">subMenu </font><font color="#FF0000">8</font><font color="#808080">, </font><font color="#000080">sreg
      <b>END IF
   ELSEIF </b>sacao </font><font color="#808080">= </font><font color="#000080">opAlterar <b>THEN
      PRINT </b>rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">) + </font><font color="#000080">tLivro</font><font color="#808080">.</font><font color="#000080">isbn
      mostrarDados sreg</font><font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">1
      </font><font color="#000080">subMenu </font><font color="#FF0000">9</font><font color="#808080">, </font><font color="#000080">sreg
      frmCadLigados opLivroAss</font><font color="#808080">, </font><font color="#000080">opExcluir</font><font color="#808080">, </font><font color="#000080">tLivro</font><font color="#808080">.</font><font color="#000080">isbn
      <b>PRINT </b></font><font color="#800000">&quot;Assuntos dos livros exclu&iexcl;dos, inclua novos!&quot;
      </font><font color="#000080">frmCadLigados opLivroAss</font><font color="#808080">, </font><font color="#000080">opNovo</font><font color="#808080">, </font><font color="#000080">tLivro</font><font color="#808080">.</font><font color="#000080">isbn
      frmCadLigados opLivroAut</font><font color="#808080">, </font><font color="#000080">opExcluir</font><font color="#808080">, </font><font color="#000080">tLivro</font><font color="#808080">.</font><font color="#000080">isbn
      <b>PRINT </b></font><font color="#800000">&quot;Autores dos livros exclu&iexcl;dos, inclua novos!&quot;
      </font><font color="#000080">frmCadLigados opLivroAut</font><font color="#808080">, </font><font color="#000080">opNovo</font><font color="#808080">, </font><font color="#000080">tLivro</font><font color="#808080">.</font><font color="#000080">isbn
   <b>ELSEIF </b>sacao </font><font color="#808080">= </font><font color="#000080">opExcluir <b>THEN
      </b>subMenu </font><font color="#FF0000">10</font><font color="#808080">, </font><font color="#000080">sreg
      <b>PRINT </b></font><font color="#800000">&quot;Assuntos dos livros sendo exclu&iexcl;dos!&quot;
      </font><font color="#000080">frmCadLigados opLivroAss</font><font color="#808080">, </font><font color="#000080">opExcluir</font><font color="#808080">, </font><font color="#000080">tLivro</font><font color="#808080">.</font><font color="#000080">isbn
      <b>PRINT </b></font><font color="#800000">&quot;Autores dos livros sendo exclu&iexcl;dos!&quot;
      </font><font color="#000080">frmCadLigados opLivroAut</font><font color="#808080">, </font><font color="#000080">opExcluir</font><font color="#808080">, </font><font color="#000080">tLivro</font><font color="#808080">.</font><font color="#000080">isbn
   <b>END IF
ELSEIF </b>sreg </font><font color="#808080">= </font><font color="#000080">opCliente <b>THEN
   IF </b>sacao </font><font color="#808080">= </font><font color="#000080">opNovo <b>THEN
      PRINT </b>rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">);
      </font><font color="#000080"><b>INPUT </b></font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#000080">tCliente</font><font color="#808080">.</font><font color="#000080">cpf
      <b>IF </b>validaCPF</font><font color="#808080">(</font><font color="#000080">tCliente</font><font color="#808080">.</font><font color="#000080">cpf</font><font color="#808080">) </font><font color="#000080"><b>THEN
</b></font>	  <font color="#000080">slinha </font><font color="#808080">= </font><font color="#000080">pesqArq</font><font color="#808080">(</font><font color="#000080">tfCliente</font><font color="#808080">, </font><font color="#000080">tCliente</font><font color="#808080">.</font><font color="#000080">cpf</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">14</font><font color="#808080">, </font><font color="#000080">ntam</font><font color="#808080">)
</font>	  <font color="#000080"><b>IF </b>slinha </font><font color="#808080">= </font><font color="#800000">&quot;&quot; </font><font color="#000080"><b>THEN
</b></font>	     <font color="#000080">pesqLinhaExcluida tfCliente</font><font color="#808080">, </font><font color="#000080">ntam
</font>	     <font color="#000080">mostrarDados sreg</font><font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">1
</font>	     <font color="#000080">subMenu </font><font color="#FF0000">7</font><font color="#808080">, </font><font color="#000080">sreg
</font>	  <font color="#000080"><b>ELSE PRINT </b>MSGREGEXST
</font>	  <font color="#000080"><b>END IF
      ELSE PRINT </b>MSGCPFINV
      <b>END IF
   ELSEIF </b>sacao </font><font color="#808080">= </font><font color="#000080">opPesquisar <b>THEN
      </b>slinha </font><font color="#808080">= </font><font color="#000080">validaEntrada</font><font color="#808080">(</font><font color="#000080">tfCliente</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#000080">tCliente</font><font color="#808080">.</font><font color="#000080">cpf</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#000080">false</font><font color="#808080">, </font><font color="#000080">opTexto</font><font color="#808080">)
      </font><font color="#000080"><b>IF </b>slinha </font><font color="#808080">&lt;&gt; </font><font color="#800000">&quot;&quot; </font><font color="#000080"><b>THEN
</b></font>	 <font color="#000080">mostrarDados sreg</font><font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">2
</font>	 <font color="#000080">mostrarDados sreg</font><font color="#808080">, </font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">3
</font>	 <font color="#000080">subMenu </font><font color="#FF0000">8</font><font color="#808080">, </font><font color="#000080">sreg
      <b>END IF
   ELSEIF </b>sacao </font><font color="#808080">= </font><font color="#000080">opAlterar <b>THEN
      PRINT </b>rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">) + </font><font color="#000080">tCliente</font><font color="#808080">.</font><font color="#000080">cpf
      mostrarDados sreg</font><font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">1
      </font><font color="#000080">subMenu </font><font color="#FF0000">9</font><font color="#808080">, </font><font color="#000080">sreg
   <b>ELSEIF </b>sacao </font><font color="#808080">= </font><font color="#000080">opExcluir <b>THEN
      </b>subMenu </font><font color="#FF0000">10</font><font color="#808080">, </font><font color="#000080">sreg
   <b>END IF
ELSEIF </b>sreg </font><font color="#808080">= </font><font color="#000080">opVenda <b>THEN
   IF </b>sacao </font><font color="#808080">= </font><font color="#000080">opNovo <b>THEN
      </b>tVenda</font><font color="#808080">.</font><font color="#000080">dthrvenda </font><font color="#808080">= </font><font color="#000080">retDataHora
      <b>PRINT </b>rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">) + </font><font color="#000080">tVenda</font><font color="#808080">.</font><font color="#000080">dthrvenda
      slinha </font><font color="#808080">= </font><font color="#000080">pesqArq</font><font color="#808080">(</font><font color="#000080">tfVenda</font><font color="#808080">, </font><font color="#000080">tVenda</font><font color="#808080">.</font><font color="#000080">dthrvenda</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">19</font><font color="#808080">, </font><font color="#000080">ntam</font><font color="#808080">)
      </font><font color="#000080"><b>IF </b>slinha </font><font color="#808080">= </font><font color="#800000">&quot;&quot; </font><font color="#000080"><b>THEN
</b></font>	 <font color="#000080">slinha </font><font color="#808080">= </font><font color="#000080">validaEntrada</font><font color="#808080">(</font><font color="#000080">tfCliente</font><font color="#808080">, </font><font color="#000080">opCliente</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#000080">tVenda</font><font color="#808080">.</font><font color="#000080">cpf</font><font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">, </font><font color="#000080">false</font><font color="#808080">, </font><font color="#000080">opTexto</font><font color="#808080">)
</font>	 <font color="#000080"><b>IF </b>slinha </font><font color="#808080">&lt;&gt; </font><font color="#800000">&quot;&quot; </font><font color="#000080"><b>THEN
</b></font>	    <font color="#000080">tVenda</font><font color="#808080">.</font><font color="#000080">cpf </font><font color="#808080">= </font><font color="#000080"><b>Trim</b></font><font color="#808080">(</font><font color="#000080"><b>MID</b>$</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">14</font><font color="#808080">))
</font>	    <font color="#000080"><b>IF </b>validaCPF</font><font color="#808080">(</font><font color="#000080">tVenda</font><font color="#808080">.</font><font color="#000080">cpf</font><font color="#808080">) </font><font color="#000080"><b>THEN
</b></font>	       <font color="#000080"><b>PRINT </b></font><font color="#800000">&quot; &quot; </font><font color="#808080">+ </font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">opCliente</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">); <i>' Nome
</i></font>	       <font color="#000080"><b>PRINT MID</b>$</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#000080">gnPosChave</font><font color="#808080">, </font><font color="#000080">gnTamChave</font><font color="#808080">)
</font>	       <font color="#000080">frmCadLigados opVenda</font><font color="#808080">, </font><font color="#000080">opNovo</font><font color="#808080">, </font><font color="#000080">tVenda</font><font color="#808080">.</font><font color="#000080">cpf
</font>	    <font color="#000080"><b>ELSE PRINT </b>MSGCPFINV
</font>	    <font color="#000080"><b>END IF
</b></font>	 <font color="#000080"><b>END IF
      ELSE PRINT </b>MSGREGEXST
      <b>END IF
   ELSEIF </b>sacao </font><font color="#808080">= </font><font color="#000080">opPesquisar <b>THEN
      </b>slinha </font><font color="#808080">= </font><font color="#000080">validaEntrada</font><font color="#808080">(</font><font color="#000080">tfVenda</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#000080">tVenda</font><font color="#808080">.</font><font color="#000080">dthrvenda</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#000080">false</font><font color="#808080">, </font><font color="#000080">opDataHora</font><font color="#808080">)
      </font><font color="#000080"><b>IF </b>slinha </font><font color="#808080">&lt;&gt; </font><font color="#800000">&quot;&quot; </font><font color="#000080"><b>THEN
</b></font>	<font color="#000080">mostrarDados sreg</font><font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">2
</font>	<font color="#000080">mostrarDados sreg</font><font color="#808080">, </font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">3
</font>	<font color="#000080">subMenu </font><font color="#FF0000">8</font><font color="#808080">, </font><font color="#000080">sreg
      <b>END IF
   END IF
END IF

END SUB

</b></font><font color="#808080"><i>'------------------------------------------------------------------------------
'Realiza os cadastros dos arquivos que se ligam a outros arquivos.
'sreg - o tipo de arquivo
'sacao - a a‡&AElig;o a ser realizada
'sCodigo - um das chaves do arquivo de liga‡&AElig;o
'------------------------------------------------------------------------------
</i></font><font color="#000080"><b>SUB </b>frmCadLigados </font><font color="#808080">(</font><font color="#000080">sreg <b>AS INTEGER</b></font><font color="#808080">, </font><font color="#000080">sacao <b>AS INTEGER</b></font><font color="#808080">, </font><font color="#000080">sCodigo <b>AS STRING</b></font><font color="#808080">)
</font><font color="#000080"><b>DIM </b>nQtd <b>AS INTEGER</b></font><font color="#808080">, </font><font color="#000080">nCont <b>AS INTEGER</b></font><font color="#808080">, </font><font color="#000080">nQtdEstoque <b>AS INTEGER
DIM </b>nTotalPreco <b>AS DOUBLE</b></font><font color="#808080">, </font><font color="#000080">ntam <b>AS INTEGER
DIM </b>slinha <b>AS STRING</b></font><font color="#808080">, </font><font color="#000080">sTotalPreco <b>AS STRING
DIM </b>sPreco <b>AS STRING</b></font><font color="#808080">, </font><font color="#000080">sQtd <b>AS STRING

IF </b>sacao </font><font color="#808080">= </font><font color="#000080">opNovo <b>THEN
  </b>nCont </font><font color="#808080">= </font><font color="#FF0000">1
  </font><font color="#000080"><b>IF </b>sreg </font><font color="#808080">= </font><font color="#000080">opLivroAss <b>THEN
    </b>sQtd </font><font color="#808080">= </font><font color="#000080">validaNumero</font><font color="#808080">(</font><font color="#800000">&quot;Quantos assuntos quer cadastrar?: &quot;</font><font color="#808080">, </font><font color="#000080">sQtd</font><font color="#808080">)
    </font><font color="#000080">nQtd </font><font color="#808080">= </font><font color="#000080"><b>VAL</b></font><font color="#808080">(</font><font color="#000080">sQtd</font><font color="#808080">)
    </font><font color="#000080"><b>SEEK </b>tfLivroAss</font><font color="#808080">, </font><font color="#FF0000">1
    </font><font color="#000080"><b>DO WHILE </b>nCont </font><font color="#808080">&lt;= </font><font color="#000080">nQtd
      tLivroAss</font><font color="#808080">.</font><font color="#000080">isbn </font><font color="#808080">= </font><font color="#000080">sCodigo
      <b>PRINT </b>rotulo</font><font color="#808080">(</font><font color="#000080">opLivroAss</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">);
      </font><font color="#000080"><b>INPUT </b></font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#000080">tLivroAss</font><font color="#808080">.</font><font color="#000080">codassunto
      ntam </font><font color="#808080">= </font><font color="#000080">tamReg</font><font color="#808080">(</font><font color="#000080">opAssunto</font><font color="#808080">)
      </font><font color="#000080">slinha </font><font color="#808080">= </font><font color="#000080">pesqArq</font><font color="#808080">(</font><font color="#000080">tfAssunto</font><font color="#808080">, </font><font color="#000080">tLivroAss</font><font color="#808080">.</font><font color="#000080">codassunto</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">, </font><font color="#000080">ntam</font><font color="#808080">)
      </font><font color="#000080"><b>PRINT </b></font><font color="#800000">&quot; &quot; </font><font color="#808080">+ </font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">opAssunto</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">);
      </font><font color="#000080"><b>PRINT MID</b>$</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#000080">gnPosChave</font><font color="#808080">, </font><font color="#000080">gnTamChave</font><font color="#808080">)
      </font><font color="#000080">ntam </font><font color="#808080">= </font><font color="#000080">tamReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">)
      </font><font color="#000080">pesqLinhaExcluida tfLivroAss</font><font color="#808080">, </font><font color="#000080">ntam
      subMenu </font><font color="#FF0000">14</font><font color="#808080">, </font><font color="#000080">sreg
      nCont </font><font color="#808080">= </font><font color="#000080">nCont </font><font color="#808080">+ </font><font color="#FF0000">1
    </font><font color="#000080"><b>LOOP
  ELSEIF </b>sreg </font><font color="#808080">= </font><font color="#000080">opLivroAut <b>THEN
    </b>sQtd </font><font color="#808080">= </font><font color="#000080">validaNumero</font><font color="#808080">(</font><font color="#800000">&quot;Quantos autores quer cadastrar?: &quot;</font><font color="#808080">, </font><font color="#000080">sQtd</font><font color="#808080">)
    </font><font color="#000080">nQtd </font><font color="#808080">= </font><font color="#000080"><b>VAL</b></font><font color="#808080">(</font><font color="#000080">sQtd</font><font color="#808080">)
    </font><font color="#000080"><b>SEEK </b>tfLivroAut</font><font color="#808080">, </font><font color="#FF0000">1
    </font><font color="#000080"><b>DO WHILE </b>nCont </font><font color="#808080">&lt;= </font><font color="#000080">nQtd
      tLivroAut</font><font color="#808080">.</font><font color="#000080">isbn </font><font color="#808080">= </font><font color="#000080">sCodigo
      <b>PRINT </b>rotulo</font><font color="#808080">(</font><font color="#000080">opLivroAut</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">);
      </font><font color="#000080"><b>INPUT </b></font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#000080">tLivroAut</font><font color="#808080">.</font><font color="#000080">codautor
      ntam </font><font color="#808080">= </font><font color="#000080">tamReg</font><font color="#808080">(</font><font color="#000080">opAutor</font><font color="#808080">)
      </font><font color="#000080">slinha </font><font color="#808080">= </font><font color="#000080">pesqArq</font><font color="#808080">(</font><font color="#000080">tfAutor</font><font color="#808080">, </font><font color="#000080">tLivroAut</font><font color="#808080">.</font><font color="#000080">codautor</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">, </font><font color="#000080">ntam</font><font color="#808080">)
      </font><font color="#000080"><b>PRINT </b></font><font color="#800000">&quot; &quot; </font><font color="#808080">+ </font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">opAutor</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">);
      </font><font color="#000080"><b>PRINT MID</b>$</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#000080">gnPosChave</font><font color="#808080">, </font><font color="#000080">gnTamChave</font><font color="#808080">)
      </font><font color="#000080">ntam </font><font color="#808080">= </font><font color="#000080">tamReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">)
      </font><font color="#000080">pesqLinhaExcluida tfLivroAut</font><font color="#808080">, </font><font color="#000080">ntam
      subMenu </font><font color="#FF0000">14</font><font color="#808080">, </font><font color="#000080">sreg
      nCont </font><font color="#808080">= </font><font color="#000080">nCont </font><font color="#808080">+ </font><font color="#FF0000">1
    </font><font color="#000080"><b>LOOP
  ELSEIF </b>sreg </font><font color="#808080">= </font><font color="#000080">opVenda <b>THEN
    </b>sQtd </font><font color="#808080">= </font><font color="#000080">validaNumero</font><font color="#808080">(</font><font color="#800000">&quot;Quantos livros quer vender?: &quot;</font><font color="#808080">, </font><font color="#000080">sQtd</font><font color="#808080">)
    </font><font color="#000080">nQtd </font><font color="#808080">= </font><font color="#000080"><b>VAL</b></font><font color="#808080">(</font><font color="#000080">sQtd</font><font color="#808080">)
    </font><font color="#000080">nTotalPreco </font><font color="#808080">= </font><font color="#FF0000">0
    </font><font color="#000080"><b>DO WHILE </b>nCont </font><font color="#808080">&lt;= </font><font color="#000080">nQtd
      slinha </font><font color="#808080">= </font><font color="#000080">validaEntrada</font><font color="#808080">(</font><font color="#000080">tfLivro</font><font color="#808080">, </font><font color="#000080">opLivro</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#000080">tVenda</font><font color="#808080">.</font><font color="#000080">isbn</font><font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">, </font><font color="#000080">false</font><font color="#808080">, </font><font color="#000080">opTexto</font><font color="#808080">)
      </font><font color="#000080"><b>IF </b>slinha </font><font color="#808080">&lt;&gt; </font><font color="#800000">&quot;&quot; </font><font color="#000080"><b>THEN
</b></font>	<font color="#000080">tVenda</font><font color="#808080">.</font><font color="#000080">isbn </font><font color="#808080">= </font><font color="#000080"><b>Trim</b>$</font><font color="#808080">(</font><font color="#000080"><b>MID</b>$</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">13</font><font color="#808080">))
</font>	<font color="#000080"><b>IF </b>validaISBN</font><font color="#808080">(</font><font color="#000080">tVenda</font><font color="#808080">.</font><font color="#000080">isbn</font><font color="#808080">) </font><font color="#000080"><b>THEN
</b></font>	  <font color="#000080">mostrarDados sreg</font><font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">1
</font>	  <font color="#000080">tLivro</font><font color="#808080">.</font><font color="#000080">qtdestoque </font><font color="#808080">= </font><font color="#000080"><b>Trim</b>$</font><font color="#808080">(</font><font color="#000080"><b>MID</b>$</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">134</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">))
</font>	  <font color="#000080">nQtdEstoque </font><font color="#808080">= </font><font color="#000080"><b>VAL</b></font><font color="#808080">(</font><font color="#000080">tLivro</font><font color="#808080">.</font><font color="#000080">qtdestoque</font><font color="#808080">)
</font>	  <font color="#000080"><b>IF </b>nQtdEstoque </font><font color="#808080">&gt; </font><font color="#FF0000">0 </font><font color="#000080"><b>THEN
</b></font>	     <font color="#000080">nTotalPreco </font><font color="#808080">= </font><font color="#000080">nTotalPreco </font><font color="#808080">+ </font><font color="#000080">gnPreco
</font>	     <font color="#000080">sPreco </font><font color="#808080">= </font><font color="#000080"><b>STR</b>$</font><font color="#808080">(</font><font color="#000080">gnPreco</font><font color="#808080">)
</font>	     <font color="#000080">tVenda</font><font color="#808080">.</font><font color="#000080">precovenda </font><font color="#808080">= </font><font color="#000080">sPreco
</font>	     <font color="#000080">gSalvarInclusao </font><font color="#808080">= </font><font color="#000080">false
</font>	     <font color="#000080">subMenu </font><font color="#FF0000">14</font><font color="#808080">, </font><font color="#000080">sreg
</font>	     <font color="#000080"><b>IF </b>gSalvarInclusao <b>THEN
</b></font>		<font color="#000080">ntam </font><font color="#808080">= </font><font color="#000080">tamReg</font><font color="#808080">(</font><font color="#000080">opLivro</font><font color="#808080">)
</font>		<font color="#000080">slinha </font><font color="#808080">= </font><font color="#000080">pesqArq</font><font color="#808080">(</font><font color="#000080">tfLivro</font><font color="#808080">, </font><font color="#000080">tVenda</font><font color="#808080">.</font><font color="#000080">isbn</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">13</font><font color="#808080">, </font><font color="#000080">ntam</font><font color="#808080">)
</font>		<font color="#000080"><b>IF </b>slinha </font><font color="#808080">&lt;&gt; </font><font color="#800000">&quot;&quot; </font><font color="#000080"><b>THEN
</b></font>		   <font color="#000080">nQtdEstoque </font><font color="#808080">= </font><font color="#000080">nQtdEstoque </font><font color="#808080">- </font><font color="#FF0000">1
</font>		   <font color="#000080">tLivro</font><font color="#808080">.</font><font color="#000080">qtdestoque </font><font color="#808080">= </font><font color="#000080"><b>STR</b>$</font><font color="#808080">(</font><font color="#000080">nQtdEstoque</font><font color="#808080">)
</font>		   <font color="#000080">slinha </font><font color="#808080">= </font><font color="#000080"><b>MID</b>$</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">133</font><font color="#808080">) + </font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">tLivro</font><font color="#808080">.</font><font color="#000080">qtdestoque</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">)
</font>		   <font color="#000080">escreveArq tfLivro</font><font color="#808080">, </font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#800000">&quot;&quot;
</font>		<font color="#000080"><b>END IF
</b></font>	     <font color="#000080"><b>END IF
</b></font>	     <font color="#000080">nCont </font><font color="#808080">= </font><font color="#000080">nCont </font><font color="#808080">+ </font><font color="#FF0000">1
</font>	  <font color="#000080"><b>ELSE
</b></font>	    <font color="#000080"><b>PRINT </b>MSGSEMESTOQUE
</font>	  <font color="#000080"><b>END IF
</b></font>	<font color="#000080"><b>ELSE
</b></font>	  <font color="#000080"><b>PRINT </b>MSGISBNINV
</font>	<font color="#000080"><b>END IF
      END IF
    LOOP
    </b>sTotalPreco </font><font color="#808080">= </font><font color="#000080"><b>STR</b>$</font><font color="#808080">(</font><font color="#000080">nTotalPreco</font><font color="#808080">)
    </font><font color="#000080"><b>PRINT </b></font><font color="#800000">&quot;Total de &quot; </font><font color="#808080">+ </font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">4</font><font color="#808080">) + </font><font color="#000080">sTotalPreco
  <b>END IF
ELSEIF </b>sacao </font><font color="#808080">= </font><font color="#000080">opExcluir <b>THEN
  IF </b>sreg </font><font color="#808080">= </font><font color="#000080">opLivroAss <b>THEN
     </b>ExcluirRegLigados tfLivroAss</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">13</font><font color="#808080">, </font><font color="#000080">sCodigo
  <b>ELSEIF </b>sreg </font><font color="#808080">= </font><font color="#000080">opLivroAut <b>THEN
     </b>ExcluirRegLigados tfLivroAut</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">13</font><font color="#808080">, </font><font color="#000080">sCodigo
  <b>END IF
END IF

END SUB

</b></font><font color="#808080"><i>'------------------------------------------------------------------------------
'Realiza as consultas de acordo com o tipo de arquivo.
'sreg - o tipo de arquivo
'sacao - a a‡&AElig;o a ser realizada
'------------------------------------------------------------------------------
</i></font><font color="#000080"><b>SUB </b>frmConsultas </font><font color="#808080">(</font><font color="#000080">sreg <b>AS INTEGER</b></font><font color="#808080">, </font><font color="#000080">sacao <b>AS INTEGER</b></font><font color="#808080">)
</font><font color="#000080"><b>DIM </b>slinha <b>AS STRING</b></font><font color="#808080">, </font><font color="#000080">ntam <b>AS INTEGER

</b>ntam </font><font color="#808080">= </font><font color="#000080">tamReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">)
</font><font color="#000080"><b>IF </b>sreg </font><font color="#808080">= </font><font color="#000080">opAssunto <b>THEN
   IF </b>sacao </font><font color="#808080">= </font><font color="#000080">opPesquisar <b>THEN
      </b>slinha </font><font color="#808080">= </font><font color="#000080">validaEntrada</font><font color="#808080">(</font><font color="#000080">tfAssunto</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">, </font><font color="#000080">tAssunto</font><font color="#808080">.</font><font color="#000080">assunto</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#000080">true</font><font color="#808080">, </font><font color="#000080">opTexto</font><font color="#808080">)
   </font><font color="#000080"><b>ELSEIF </b>sacao </font><font color="#808080">= </font><font color="#000080">opListarTodos <b>THEN
      IF </b>ListarTodos</font><font color="#808080">(</font><font color="#000080">tfAssunto</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#000080">ntam</font><font color="#808080">, </font><font color="#000080">QTDMAXLINHA</font><font color="#808080">, </font><font color="#000080">false</font><font color="#808080">) = </font><font color="#000080">false <b>THEN
</b></font>	<font color="#000080"><b>PRINT </b>rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">)
      </font><font color="#000080"><b>END IF
   END IF
ELSEIF </b>sreg </font><font color="#808080">= </font><font color="#000080">opAutor <b>THEN
   IF </b>sacao </font><font color="#808080">= </font><font color="#000080">opPesquisar <b>THEN
      </b>slinha </font><font color="#808080">= </font><font color="#000080">validaEntrada</font><font color="#808080">(</font><font color="#000080">tfAutor</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">, </font><font color="#000080">tAutor</font><font color="#808080">.</font><font color="#000080">autor</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#000080">true</font><font color="#808080">, </font><font color="#000080">opTexto</font><font color="#808080">)
   </font><font color="#000080"><b>ELSEIF </b>sacao </font><font color="#808080">= </font><font color="#000080">opListarTodos <b>THEN
      IF </b>ListarTodos</font><font color="#808080">(</font><font color="#000080">tfAutor</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#000080">ntam</font><font color="#808080">, </font><font color="#000080">QTDMAXLINHA</font><font color="#808080">, </font><font color="#000080">false</font><font color="#808080">) = </font><font color="#000080">false <b>THEN
</b></font>	<font color="#000080"><b>PRINT </b>rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">)
      </font><font color="#000080"><b>END IF
   END IF
ELSEIF </b>sreg </font><font color="#808080">= </font><font color="#000080">opEditora <b>THEN
   IF </b>sacao </font><font color="#808080">= </font><font color="#000080">opPesquisar <b>THEN
      </b>slinha </font><font color="#808080">= </font><font color="#000080">validaEntrada</font><font color="#808080">(</font><font color="#000080">tfEditora</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">, </font><font color="#000080">tEditora</font><font color="#808080">.</font><font color="#000080">editora</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#000080">true</font><font color="#808080">, </font><font color="#000080">opTexto</font><font color="#808080">)
   </font><font color="#000080"><b>ELSEIF </b>sacao </font><font color="#808080">= </font><font color="#000080">opListarTodos <b>THEN
      IF </b>ListarTodos</font><font color="#808080">(</font><font color="#000080">tfEditora</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#000080">ntam</font><font color="#808080">, </font><font color="#000080">QTDMAXLINHA</font><font color="#808080">, </font><font color="#000080">false</font><font color="#808080">) = </font><font color="#000080">false <b>THEN
</b></font>	<font color="#000080"><b>PRINT </b>rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">)
      </font><font color="#000080"><b>END IF
   END IF
ELSEIF </b>sreg </font><font color="#808080">= </font><font color="#000080">opEndereco <b>THEN
   IF </b>sacao </font><font color="#808080">= </font><font color="#000080">opPesquisar <b>THEN
      </b>slinha </font><font color="#808080">= </font><font color="#000080">validaEntrada</font><font color="#808080">(</font><font color="#000080">tfEndereco</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">, </font><font color="#000080">tEndereco</font><font color="#808080">.</font><font color="#000080">Logradouro</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#000080">true</font><font color="#808080">, </font><font color="#000080">opTexto</font><font color="#808080">)
   </font><font color="#000080"><b>ELSEIF </b>sacao </font><font color="#808080">= </font><font color="#000080">opListarTodos <b>THEN
      IF </b>ListarTodos</font><font color="#808080">(</font><font color="#000080">tfEndereco</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#000080">ntam</font><font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">, </font><font color="#000080">false</font><font color="#808080">) = </font><font color="#000080">false <b>THEN
</b></font>	<font color="#000080"><b>PRINT </b>rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">)
      </font><font color="#000080"><b>END IF
   END IF
ELSEIF </b>sreg </font><font color="#808080">= </font><font color="#000080">opIdioma <b>THEN
   IF </b>sacao </font><font color="#808080">= </font><font color="#000080">opPesquisar <b>THEN
      </b>slinha </font><font color="#808080">= </font><font color="#000080">validaEntrada</font><font color="#808080">(</font><font color="#000080">tfIdioma</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">, </font><font color="#000080">tIdioma</font><font color="#808080">.</font><font color="#000080">idioma</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#000080">true</font><font color="#808080">, </font><font color="#000080">opTexto</font><font color="#808080">)
   </font><font color="#000080"><b>ELSEIF </b>sacao </font><font color="#808080">= </font><font color="#000080">opListarTodos <b>THEN
      IF </b>ListarTodos</font><font color="#808080">(</font><font color="#000080">tfIdioma</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#000080">ntam</font><font color="#808080">, </font><font color="#000080">QTDMAXLINHA</font><font color="#808080">, </font><font color="#000080">false</font><font color="#808080">) = </font><font color="#000080">false <b>THEN
</b></font>	<font color="#000080"><b>PRINT </b>rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">)
      </font><font color="#000080"><b>END IF
   END IF
ELSEIF </b>sreg </font><font color="#808080">= </font><font color="#000080">opPais <b>THEN
   IF </b>sacao </font><font color="#808080">= </font><font color="#000080">opPesquisar <b>THEN
      </b>slinha </font><font color="#808080">= </font><font color="#000080">validaEntrada</font><font color="#808080">(</font><font color="#000080">tfPais</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">, </font><font color="#000080">tPais</font><font color="#808080">.</font><font color="#000080">pais</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#000080">true</font><font color="#808080">, </font><font color="#000080">opTexto</font><font color="#808080">)
   </font><font color="#000080"><b>ELSEIF </b>sacao </font><font color="#808080">= </font><font color="#000080">opListarTodos <b>THEN
      IF </b>ListarTodos</font><font color="#808080">(</font><font color="#000080">tfPais</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#000080">ntam</font><font color="#808080">, </font><font color="#000080">QTDMAXLINHA</font><font color="#808080">, </font><font color="#000080">false</font><font color="#808080">) = </font><font color="#000080">false <b>THEN
</b></font>	<font color="#000080"><b>PRINT </b>rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">)
      </font><font color="#000080"><b>END IF
   END IF
ELSEIF </b>sreg </font><font color="#808080">= </font><font color="#000080">opProfissao <b>THEN
   IF </b>sacao </font><font color="#808080">= </font><font color="#000080">opPesquisar <b>THEN
     </b>slinha </font><font color="#808080">= </font><font color="#000080">validaEntrada</font><font color="#808080">(</font><font color="#000080">tfProfissao</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">, </font><font color="#000080">tProfissao</font><font color="#808080">.</font><font color="#000080">profissao</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#000080">true</font><font color="#808080">, </font><font color="#000080">opTexto</font><font color="#808080">)
   </font><font color="#000080"><b>ELSEIF </b>sacao </font><font color="#808080">= </font><font color="#000080">opListarTodos <b>THEN
      IF </b>ListarTodos</font><font color="#808080">(</font><font color="#000080">tfProfissao</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#000080">ntam</font><font color="#808080">, </font><font color="#000080">QTDMAXLINHA</font><font color="#808080">, </font><font color="#000080">false</font><font color="#808080">) = </font><font color="#000080">false <b>THEN
</b></font>	<font color="#000080"><b>PRINT </b>rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">)
      </font><font color="#000080"><b>END IF
   END IF
ELSEIF </b>sreg </font><font color="#808080">= </font><font color="#000080">opLivro <b>THEN
   IF </b>sacao </font><font color="#808080">= </font><font color="#000080">opPesquisar <b>THEN
      </b>slinha </font><font color="#808080">= </font><font color="#000080">validaEntrada</font><font color="#808080">(</font><font color="#000080">tfLivro</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">, </font><font color="#000080">tLivro</font><font color="#808080">.</font><font color="#000080">titulo</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#000080">true</font><font color="#808080">, </font><font color="#000080">opTexto</font><font color="#808080">)
   </font><font color="#000080"><b>ELSEIF </b>sacao </font><font color="#808080">= </font><font color="#000080">opListarTodos <b>THEN
      IF </b>ListarTodos</font><font color="#808080">(</font><font color="#000080">tfLivro</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#000080">ntam</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#000080">false</font><font color="#808080">) = </font><font color="#000080">false <b>THEN
</b></font>	<font color="#000080"><b>PRINT </b>rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">)
      </font><font color="#000080"><b>END IF
   END IF
ELSEIF </b>sreg </font><font color="#808080">= </font><font color="#000080">opCliente <b>THEN
   IF </b>sacao </font><font color="#808080">= </font><font color="#000080">opPesquisar <b>THEN
      </b>slinha </font><font color="#808080">= </font><font color="#000080">validaEntrada</font><font color="#808080">(</font><font color="#000080">tfCliente</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">, </font><font color="#000080">tCliente</font><font color="#808080">.</font><font color="#000080">nome</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#000080">true</font><font color="#808080">, </font><font color="#000080">opTexto</font><font color="#808080">)
   </font><font color="#000080"><b>ELSEIF </b>sacao </font><font color="#808080">= </font><font color="#000080">opListarTodos <b>THEN
      IF </b>ListarTodos</font><font color="#808080">(</font><font color="#000080">tfCliente</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#000080">ntam</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#000080">false</font><font color="#808080">) = </font><font color="#000080">false <b>THEN
</b></font>	<font color="#000080"><b>PRINT </b>rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">)
      </font><font color="#000080"><b>END IF
   END IF
ELSEIF </b>sreg </font><font color="#808080">= </font><font color="#000080">opVenda <b>THEN
   IF </b>sacao </font><font color="#808080">= </font><font color="#000080">opPesquisar <b>THEN
      </b>slinha </font><font color="#808080">= </font><font color="#000080">validaEntrada</font><font color="#808080">(</font><font color="#000080">tfVenda</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">, </font><font color="#000080">tVenda</font><font color="#808080">.</font><font color="#000080">cpf</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#000080">true</font><font color="#808080">, </font><font color="#000080">opTexto</font><font color="#808080">)
   </font><font color="#000080"><b>ELSEIF </b>sacao </font><font color="#808080">= </font><font color="#000080">opListarTodos <b>THEN
      IF </b>ListarTodos</font><font color="#808080">(</font><font color="#000080">tfVenda</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#000080">ntam</font><font color="#808080">, </font><font color="#000080">QTDMAXLINHA</font><font color="#808080">, </font><font color="#000080">false</font><font color="#808080">) = </font><font color="#000080">false <b>THEN
</b></font>	<font color="#000080"><b>PRINT </b>rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">)
      </font><font color="#000080"><b>END IF
   END IF
END IF
IF </b>slinha </font><font color="#808080">= </font><font color="#800000">&quot;&quot; </font><font color="#000080"><b>THEN
   PRINT </b></font><font color="#800000">&quot;&quot;</font><font color="#808080">;
</font><font color="#000080"><b>END IF
END SUB

</b></font><font color="#808080"><i>'------------------------------------------------------------------------------
'Mostra a tela de login do sistema.
'retorna - se o login foi validado corretamente
'------------------------------------------------------------------------------
</i></font><font color="#000080"><b>FUNCTION </b>frmLogin!
<b>DIM </b>bret <b>AS INTEGER
DIM </b>slinha <b>AS STRING

  </b>bret </font><font color="#808080">= </font><font color="#000080">false
  <b>PRINT </b></font><font color="#800000">&quot;*--------------------------------------------------------------*&quot;
  </font><font color="#000080"><b>PRINT </b></font><font color="#800000">&quot;| Login do sistema                                             |&quot;
  </font><font color="#000080"><b>PRINT </b></font><font color="#800000">&quot;*--------------------------------------------------------------*&quot;
  </font><font color="#000080">slinha </font><font color="#808080">= </font><font color="#000080">validaEntrada</font><font color="#808080">(</font><font color="#000080">tfUsuario</font><font color="#808080">, </font><font color="#000080">opUsuario</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#000080">tUsuario</font><font color="#808080">.</font><font color="#000080">login</font><font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">, </font><font color="#000080">false</font><font color="#808080">, </font><font color="#000080">opTexto</font><font color="#808080">)
  </font><font color="#000080"><b>IF </b>slinha </font><font color="#808080">&lt;&gt; </font><font color="#800000">&quot;&quot; </font><font color="#000080"><b>THEN
     </b>slinha </font><font color="#808080">= </font><font color="#000080">validaEntrada</font><font color="#808080">(</font><font color="#000080">tfUsuario</font><font color="#808080">, </font><font color="#000080">opUsuario</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">, </font><font color="#000080">tUsuario</font><font color="#808080">.</font><font color="#000080">senha</font><font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">, </font><font color="#000080">false</font><font color="#808080">, </font><font color="#000080">opSenha</font><font color="#808080">)
     </font><font color="#000080"><b>IF </b>slinha </font><font color="#808080">&lt;&gt; </font><font color="#800000">&quot;&quot; </font><font color="#000080"><b>THEN
</b></font>	<font color="#000080">tUsuario</font><font color="#808080">.</font><font color="#000080">login </font><font color="#808080">= </font><font color="#000080"><b>Trim</b>$</font><font color="#808080">(</font><font color="#000080"><b>MID</b>$</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">))
</font>	<font color="#000080">tUsuario</font><font color="#808080">.</font><font color="#000080">senha </font><font color="#808080">= </font><font color="#000080"><b>Trim</b>$</font><font color="#808080">(</font><font color="#000080"><b>MID</b>$</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">11</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">))
</font>	<font color="#000080">bret </font><font color="#808080">= </font><font color="#000080">true
     <b>END IF
  END IF
  PRINT
  </b>frmLogin </font><font color="#808080">= </font><font color="#000080">bret
<b>END FUNCTION

</b></font><font color="#808080"><i>'------------------------------------------------------------------------------
'Mostra a tela de sobre do sistema.
'------------------------------------------------------------------------------
</i></font><font color="#000080"><b>SUB </b>frmSobre
<b>DIM </b>cont <b>AS INTEGER

 PRINT </b></font><font color="#800000">&quot;*------------------------------------------------------------*&quot;
 </font><font color="#000080"><b>PRINT </b></font><font color="#800000">&quot;|  LL        II  VV       VV  RRRRRRR   UU    UU   SSSSSSS   |&quot;
 </font><font color="#000080"><b>PRINT </b></font><font color="#800000">&quot;|  LL        II   VV     VV   RR     R  UU    UU  SS         |&quot;
 </font><font color="#000080"><b>PRINT </b></font><font color="#800000">&quot;|  LL        II    VV   VV    RR     R  UU    UU   SSSS      |&quot;
 </font><font color="#000080"><b>PRINT </b></font><font color="#800000">&quot;|  LL        II     VV VV     RRRRRRR   UU    UU     SSSS    |&quot;
 </font><font color="#000080"><b>PRINT </b></font><font color="#800000">&quot;|  LLLL      II      VVV      RR RR     UU    UU        SS   |&quot;
 </font><font color="#000080"><b>PRINT </b></font><font color="#800000">&quot;|  LLLLLLLL  II       V       RR   RR    UUUUUU   SSSSSSSS   |&quot;
 </font><font color="#000080"><b>PRINT </b></font><font color="#800000">&quot;|                                                            |&quot;
 </font><font color="#000080"><b>PRINT </b></font><font color="#800000">&quot;|  VV       VV  II  RRRRRRR   TTTTTTTT  UU    UU   SSSSSSS   |&quot;
 </font><font color="#000080"><b>PRINT </b></font><font color="#800000">&quot;|   VV     VV   II  RR     R     TT     UU    UU  SS         |&quot;
 </font><font color="#000080"><b>PRINT </b></font><font color="#800000">&quot;|    VV   VV    II  RR     R     TT     UU    UU   SSSS      |&quot;
 </font><font color="#000080"><b>PRINT </b></font><font color="#800000">&quot;|     VV VV     II  RRRRRRR      TT     UU    UU     SSSS    |&quot;
 </font><font color="#000080"><b>PRINT </b></font><font color="#800000">&quot;|      VVV      II  RR RR        TT     UU    UU        SS   |&quot;
 </font><font color="#000080"><b>PRINT </b></font><font color="#800000">&quot;|       V       II  RR   RR      TT      UUUUUU   SSSSSSSS   |&quot;
 </font><font color="#000080"><b>PRINT </b></font><font color="#800000">&quot;|                                                            |&quot;
 </font><font color="#000080"><b>PRINT </b></font><font color="#800000">&quot;|                                               Versao 1.0.0 |&quot;
 </font><font color="#000080"><b>PRINT </b></font><font color="#800000">&quot;| Sistema integrante do projeto Livrus Virtus.               |&quot;
 </font><font color="#000080"><b>PRINT </b></font><font color="#800000">&quot;| Todos os direitos reservados para Henrique F. de Souza.    |&quot;
 </font><font color="#000080"><b>PRINT </b></font><font color="#800000">&quot;| Versao programada na linguagem qbasic.                     |&quot;
 </font><font color="#000080"><b>PRINT </b></font><font color="#800000">&quot;*------------------------------------------------------------*&quot;
 </font><font color="#000080"><b>FOR </b>cont </font><font color="#808080">= </font><font color="#FF0000">1 </font><font color="#000080"><b>TO </b></font><font color="#FF0000">3
     </font><font color="#000080"><b>PRINT </b></font><font color="#800000">&quot;&quot;
 </font><font color="#000080"><b>NEXT </b>cont
 <b>PRINT </b>MSGPRESS</font><font color="#808080">;
 </font><font color="#000080"><b>INPUT </b></font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#000080">cont
<b>END SUB

</b></font><font color="#808080"><i>'------------------------------------------------------------------------------
'Mostra a tela de splash do sistema.
'------------------------------------------------------------------------------
</i></font><font color="#000080"><b>SUB </b>frmSplash
<b>DIM </b>cont <b>AS INTEGER

 PRINT </b></font><font color="#800000">&quot;*----------------------------------------------------------------------------*&quot;
 </font><font color="#000080"><b>PRINT </b></font><font color="#800000">&quot;| LL    II VV   VV RRRRR  UU  UU   SSSS VV   VV II RRRRR  TTTT UU  UU   SSSS |&quot;
 </font><font color="#000080"><b>PRINT </b></font><font color="#800000">&quot;| LL    II  VV VV  RR   R UU  UU  SS     VV VV  II RR   R  TT  UU  UU  SS    |&quot;
 </font><font color="#000080"><b>PRINT </b></font><font color="#800000">&quot;| LL    II   VVV   RRRRR  UU  UU    SS    VVV   II RRRRR   TT  UU  UU    SS  |&quot;
 </font><font color="#000080"><b>PRINT </b></font><font color="#800000">&quot;| LLLLL II    V    RR   R  UUUU  SSSS      V    II RR   R  TT   UUUU  SSSS   |&quot;
 </font><font color="#000080"><b>PRINT </b></font><font color="#800000">&quot;*----------------------------------------------------------------------------*&quot;
 </font><font color="#000080"><b>FOR </b>cont </font><font color="#808080">= </font><font color="#FF0000">1 </font><font color="#000080"><b>TO </b></font><font color="#FF0000">17
     </font><font color="#000080"><b>PRINT </b></font><font color="#800000">&quot;&quot;
 </font><font color="#000080"><b>NEXT </b>cont
 <b>PRINT </b>MSGPRESS</font><font color="#808080">;
 </font><font color="#000080"><b>INPUT </b></font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#000080">cont
<b>END SUB

</b></font><font color="#808080"><i>'------------------------------------------------------------------------------
'Monta o tamanho do registro no arquivo de acordo com o tipo de arquivo.
'sreg - o tipo de arquivo
'retorna - o registro montado
'------------------------------------------------------------------------------
</i></font><font color="#000080"><b>FUNCTION </b>LinhaReg$ </font><font color="#808080">(</font><font color="#000080">sreg <b>AS INTEGER</b></font><font color="#808080">)
</font><font color="#000080"><b>DIM </b>slinha <b>AS STRING

</b>slinha </font><font color="#808080">= </font><font color="#800000">&quot;&quot;
</font><font color="#000080"><b>IF </b>sreg </font><font color="#808080">= </font><font color="#000080">opAssunto <b>THEN
   </b>slinha </font><font color="#808080">= </font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">tAssunto</font><font color="#808080">.</font><font color="#000080">codigo</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">) + </font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">tAssunto</font><font color="#808080">.</font><font color="#000080">assunto</font><font color="#808080">, </font><font color="#FF0000">30</font><font color="#808080">)
</font><font color="#000080"><b>ELSEIF </b>sreg </font><font color="#808080">= </font><font color="#000080">opAutor <b>THEN
   </b>slinha </font><font color="#808080">= </font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">tAutor</font><font color="#808080">.</font><font color="#000080">codigo</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">) + </font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">tAutor</font><font color="#808080">.</font><font color="#000080">autor</font><font color="#808080">, </font><font color="#FF0000">30</font><font color="#808080">)
</font><font color="#000080"><b>ELSEIF </b>sreg </font><font color="#808080">= </font><font color="#000080">opEditora <b>THEN
   </b>slinha </font><font color="#808080">= </font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">tEditora</font><font color="#808080">.</font><font color="#000080">codigo</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">) + </font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">tEditora</font><font color="#808080">.</font><font color="#000080">editora</font><font color="#808080">, </font><font color="#FF0000">50</font><font color="#808080">)
</font><font color="#000080"><b>ELSEIF </b>sreg </font><font color="#808080">= </font><font color="#000080">opEndereco <b>THEN
   </b>slinha </font><font color="#808080">= </font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">tEndereco</font><font color="#808080">.</font><font color="#000080">codigo</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">) + </font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">tEndereco</font><font color="#808080">.</font><font color="#000080">Logradouro</font><font color="#808080">, </font><font color="#FF0000">40</font><font color="#808080">) + </font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">tEndereco</font><font color="#808080">.</font><font color="#000080">bairro</font><font color="#808080">, </font><font color="#FF0000">15</font><font color="#808080">) + </font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">tEndereco</font><font color="#808080">.</font><font color="#000080">cep</font><font color="#808080">, </font><font color="#FF0000">8</font><font color="#808080">) + </font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">tEndereco</font><font color="#808080">.</font><font color="#000080">cidade</font><font color="#808080">, </font><font color="#FF0000">30</font><font color="#808080">) + </font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">tEndereco</font><font color="#808080">.</font><font color="#000080">estado</font><font color="#808080">, </font><font color="#FF0000">20</font><font color="#808080">)
</font><font color="#000080"><b>ELSEIF </b>sreg </font><font color="#808080">= </font><font color="#000080">opIdioma <b>THEN
   </b>slinha </font><font color="#808080">= </font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">tIdioma</font><font color="#808080">.</font><font color="#000080">codigo</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">) + </font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">tIdioma</font><font color="#808080">.</font><font color="#000080">idioma</font><font color="#808080">, </font><font color="#FF0000">20</font><font color="#808080">)
</font><font color="#000080"><b>ELSEIF </b>sreg </font><font color="#808080">= </font><font color="#000080">opPais <b>THEN
   </b>slinha </font><font color="#808080">= </font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">tPais</font><font color="#808080">.</font><font color="#000080">codigo</font><font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">) + </font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">tPais</font><font color="#808080">.</font><font color="#000080">pais</font><font color="#808080">, </font><font color="#FF0000">50</font><font color="#808080">)
</font><font color="#000080"><b>ELSEIF </b>sreg </font><font color="#808080">= </font><font color="#000080">opProfissao <b>THEN
   </b>slinha </font><font color="#808080">= </font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">tProfissao</font><font color="#808080">.</font><font color="#000080">codigo</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">) + </font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">tProfissao</font><font color="#808080">.</font><font color="#000080">profissao</font><font color="#808080">, </font><font color="#FF0000">50</font><font color="#808080">)
</font><font color="#000080"><b>ELSEIF </b>sreg </font><font color="#808080">= </font><font color="#000080">opUsuario <b>THEN
   </b>slinha </font><font color="#808080">= </font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">tUsuario</font><font color="#808080">.</font><font color="#000080">login</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">) + </font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">tUsuario</font><font color="#808080">.</font><font color="#000080">senha</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">)
</font><font color="#000080"><b>ELSEIF </b>sreg </font><font color="#808080">= </font><font color="#000080">opLivro <b>THEN
   </b>slinha </font><font color="#808080">= </font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">tLivro</font><font color="#808080">.</font><font color="#000080">isbn</font><font color="#808080">, </font><font color="#FF0000">13</font><font color="#808080">) + </font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">tLivro</font><font color="#808080">.</font><font color="#000080">titulo</font><font color="#808080">, </font><font color="#FF0000">50</font><font color="#808080">) + </font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">tLivro</font><font color="#808080">.</font><font color="#000080">edicao</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">) + </font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">tLivro</font><font color="#808080">.</font><font color="#000080">anopubli</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">) + </font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">tLivro</font><font color="#808080">.</font><font color="#000080">codeditora</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">) + </font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">tLivro</font><font color="#808080">.</font><font color="#000080">volume</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">) + </font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">tLivro</font><font color="#808080">.</font><font color="#000080">codidioma</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">) + </font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">tLivro</font><font color="#808080">.</font><font color="#000080">npaginas</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">) + </font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">tLivro</font><font color="#808080">.</font><font color="#000080">preco</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">) + </font><font color="#000080">esp</font><font color="#808080">( </font><font color="#000080">_
tLivro</font><font color="#808080">.</font><font color="#000080">qtdestoque</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">)
</font><font color="#000080"><b>ELSEIF </b>sreg </font><font color="#808080">= </font><font color="#000080">opLivroAss <b>THEN
   </b>slinha </font><font color="#808080">= </font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">tLivroAss</font><font color="#808080">.</font><font color="#000080">isbn</font><font color="#808080">, </font><font color="#FF0000">13</font><font color="#808080">) + </font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">tLivroAss</font><font color="#808080">.</font><font color="#000080">codassunto</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">)
</font><font color="#000080"><b>ELSEIF </b>sreg </font><font color="#808080">= </font><font color="#000080">opLivroAut <b>THEN
   </b>slinha </font><font color="#808080">= </font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">tLivroAut</font><font color="#808080">.</font><font color="#000080">isbn</font><font color="#808080">, </font><font color="#FF0000">13</font><font color="#808080">) + </font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">tLivroAut</font><font color="#808080">.</font><font color="#000080">codautor</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">)
</font><font color="#000080"><b>ELSEIF </b>sreg </font><font color="#808080">= </font><font color="#000080">opCliente <b>THEN
   </b>slinha </font><font color="#808080">= </font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">tCliente</font><font color="#808080">.</font><font color="#000080">cpf</font><font color="#808080">, </font><font color="#FF0000">14</font><font color="#808080">) + </font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">tCliente</font><font color="#808080">.</font><font color="#000080">nome</font><font color="#808080">, </font><font color="#FF0000">30</font><font color="#808080">) + </font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">tCliente</font><font color="#808080">.</font><font color="#000080">email</font><font color="#808080">, </font><font color="#FF0000">30</font><font color="#808080">) + </font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">tCliente</font><font color="#808080">.</font><font color="#000080">identidade</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">) + </font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">tCliente</font><font color="#808080">.</font><font color="#000080">sexo</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">) + </font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">tCliente</font><font color="#808080">.</font><font color="#000080">telefone</font><font color="#808080">, </font><font color="#FF0000">17</font><font color="#808080">) + </font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">tCliente</font><font color="#808080">.</font><font color="#000080">dtnascimento</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">) + </font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">tCliente</font><font color="#808080">.</font><font color="#000080">codendereco</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">) + </font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">tCliente</font><font color="#808080">. </font><font color="#000080">_
codpais</font><font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">) + </font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">tCliente</font><font color="#808080">.</font><font color="#000080">codprofissao</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">)
</font><font color="#000080"><b>ELSEIF </b>sreg </font><font color="#808080">= </font><font color="#000080">opVenda <b>THEN
   </b>slinha </font><font color="#808080">= </font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">tVenda</font><font color="#808080">.</font><font color="#000080">dthrvenda</font><font color="#808080">, </font><font color="#FF0000">19</font><font color="#808080">) + </font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">tVenda</font><font color="#808080">.</font><font color="#000080">cpf</font><font color="#808080">, </font><font color="#FF0000">14</font><font color="#808080">) + </font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">tVenda</font><font color="#808080">.</font><font color="#000080">isbn</font><font color="#808080">, </font><font color="#FF0000">13</font><font color="#808080">) + </font><font color="#000080">esp</font><font color="#808080">(</font><font color="#000080">tVenda</font><font color="#808080">.</font><font color="#000080">precovenda</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">)
</font><font color="#000080"><b>END IF
</b>LinhaReg </font><font color="#808080">= </font><font color="#000080">slinha
<b>END FUNCTION

</b></font><font color="#808080"><i>'------------------------------------------------------------------------------
'Lista v rios registros entre arquivos de acordo com a pesquisa feita.
'sArq1 - o arquivo de liga‡&AElig;o
'sreg1 - o tipo de arquivo de liga‡&AElig;o
'nPosChave1 - a posicao inicial da primeira chave no arquivo de liga‡&AElig;o
'nTamChave1 - o tamanho da primeira chave no arquivo de liga‡&AElig;o
'nPosChave2 - a posicao inicial da segunda chave do arquivo de liga‡&AElig;o
'nTamChave2 - o tamanho da segunda chave do arquivo de liga‡&AElig;o
'sChave - a chave a ser pesquisada no arquivo de liga‡&AElig;o
'sArq2 - o arquivo a ser pesquisado
'sreg2 - o tipo de arquivo a ser pesquisado
'nPosChave3 - a posicao inicial da chave do arquivo pesquisado
'nQtdLinha - a quantidade de linhas a serem mostradas
'------------------------------------------------------------------------------
</i></font><font color="#000080"><b>SUB </b>ListarRegLigados </font><font color="#808080">(</font><font color="#000080">sArq1 <b>AS INTEGER</b></font><font color="#808080">, </font><font color="#000080">sreg1 <b>AS INTEGER</b></font><font color="#808080">, </font><font color="#000080">nPosChave1 <b>AS INTEGER</b></font><font color="#808080">, </font><font color="#000080">nTamChave1 <b>AS INTEGER</b></font><font color="#808080">, </font><font color="#000080">nPosChave2 <b>AS INTEGER</b></font><font color="#808080">, </font><font color="#000080">nTamChave2 <b>AS INTEGER</b></font><font color="#808080">, </font><font color="#000080">sChave <b>AS STRING</b></font><font color="#808080">, </font><font color="#000080">sArq2 <b>AS INTEGER</b></font><font color="#808080">, </font><font color="#000080">sreg2 <b>AS INTEGER</b></font><font color="#808080">, </font><font color="#000080">nPosChave3 <b>AS INTEGER</b></font><font color="#808080">, </font><font color="#000080">nQtdLinha <b>AS INTEGER</b></font><font color="#808080">)
</font><font color="#000080"><b>DIM </b>slinha1 <b>AS STRING</b></font><font color="#808080">, </font><font color="#000080">ntam2 <b>AS INTEGER
DIM </b>bQuebra <b>AS INTEGER</b></font><font color="#808080">, </font><font color="#000080">bret <b>AS INTEGER
DIM </b>nStatus <b>AS INTEGER</b></font><font color="#808080">, </font><font color="#000080">nCont  <b>AS INTEGER
DIM </b>sCodigo1 <b>AS STRING</b></font><font color="#808080">, </font><font color="#000080">sCodigo2 <b>AS STRING</b></font><font color="#808080">, </font><font color="#000080">slinha2 <b>AS STRING

</b>bret </font><font color="#808080">= </font><font color="#000080">false
nCont </font><font color="#808080">= </font><font color="#FF0000">0
</font><font color="#000080">bQuebra </font><font color="#808080">= </font><font color="#000080">false
mostrarDados sreg2</font><font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">2
</font><font color="#000080"><b>SEEK </b>sArq1</font><font color="#808080">, </font><font color="#FF0000">1
</font><font color="#000080"><b>DO WHILE </b></font><font color="#808080">(</font><font color="#000080"><b>NOT EOF</b></font><font color="#808080">(</font><font color="#000080">sArq1</font><font color="#808080">)) </font><font color="#000080"><b>AND </b></font><font color="#808080">(</font><font color="#000080">bQuebra </font><font color="#808080">= </font><font color="#000080">false</font><font color="#808080">)
  </font><font color="#000080"><b>LINE INPUT </b></font><font color="#800000">#sArq1, slinha1
  </font><font color="#000080">sCodigo1 </font><font color="#808080">= </font><font color="#000080"><b>Trim</b>$</font><font color="#808080">(</font><font color="#000080"><b>MID</b>$</font><font color="#808080">(</font><font color="#000080">slinha1</font><font color="#808080">, </font><font color="#000080">nPosChave1</font><font color="#808080">, </font><font color="#000080">nTamChave1</font><font color="#808080">))
  </font><font color="#000080"><b>IF </b>sCodigo1 </font><font color="#808080">= </font><font color="#000080">sChave <b>THEN
    </b>sCodigo2 </font><font color="#808080">= </font><font color="#000080"><b>Trim</b>$</font><font color="#808080">(</font><font color="#000080"><b>MID</b>$</font><font color="#808080">(</font><font color="#000080">slinha1</font><font color="#808080">, </font><font color="#000080">nPosChave2</font><font color="#808080">, </font><font color="#000080">nTamChave2</font><font color="#808080">))
    </font><font color="#000080">ntam2 </font><font color="#808080">= </font><font color="#000080">tamReg</font><font color="#808080">(</font><font color="#000080">sreg2</font><font color="#808080">)
    </font><font color="#000080">slinha2 </font><font color="#808080">= </font><font color="#000080">pesqArq</font><font color="#808080">(</font><font color="#000080">sArq2</font><font color="#808080">, </font><font color="#000080">sCodigo2</font><font color="#808080">, </font><font color="#000080">nPosChave3</font><font color="#808080">, </font><font color="#000080">nTamChave2</font><font color="#808080">, </font><font color="#000080">ntam2</font><font color="#808080">)
    </font><font color="#000080">mostrarDados sreg2</font><font color="#808080">, </font><font color="#000080"><b>MID</b>$</font><font color="#808080">(</font><font color="#000080">slinha2</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#000080">tamReg</font><font color="#808080">(</font><font color="#000080">sreg2</font><font color="#808080">)), </font><font color="#FF0000">3
    </font><font color="#000080">bret </font><font color="#808080">= </font><font color="#000080">true
    nCont </font><font color="#808080">= </font><font color="#000080">nCont </font><font color="#808080">+ </font><font color="#FF0000">1
  </font><font color="#000080"><b>END IF
  </b>bQuebra </font><font color="#808080">= </font><font color="#000080">ContinuaSN</font><font color="#808080">(</font><font color="#000080">nCont</font><font color="#808080">, </font><font color="#000080">nQtdLinha</font><font color="#808080">)
</font><font color="#000080"><b>LOOP
IF </b>bret </font><font color="#808080">= </font><font color="#000080">false <b>THEN
   PRINT </b>rotulo</font><font color="#808080">(</font><font color="#000080">sreg2</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">)
</font><font color="#000080"><b>END IF
END SUB

</b></font><font color="#808080"><i>'------------------------------------------------------------------------------
'Lista v rios registros de acordo com a pesquisa feita.
'sArq - o arquivo
'sreg - o tipo de arquivo
'sChave - a chave a ser pesquisada
'nPosChave - a posicao inicial da chave dentro do registro
'nTamChave - o tamanho da chave dentro do registro
'nTamLinha - o tamanho do registro
'nQtdLinha - a quantidade de linhas a serem mostradas
'retorna - se encontrou algum registro
'------------------------------------------------------------------------------
</i></font><font color="#000080"><b>FUNCTION </b>ListarTodos! </font><font color="#808080">(</font><font color="#000080">sArq <b>AS INTEGER</b></font><font color="#808080">, </font><font color="#000080">sreg <b>AS INTEGER</b></font><font color="#808080">, </font><font color="#000080">sChave <b>AS STRING</b></font><font color="#808080">, </font><font color="#000080">nPosChave <b>AS INTEGER</b></font><font color="#808080">, </font><font color="#000080">nTamChave <b>AS INTEGER</b></font><font color="#808080">, </font><font color="#000080">nTamLinha <b>AS INTEGER</b></font><font color="#808080">, </font><font color="#000080">nQtdLinha <b>AS INTEGER</b></font><font color="#808080">, </font><font color="#000080">bPesqRelativa <b>AS INTEGER</b></font><font color="#808080">)
</font><font color="#000080"><b>DIM </b>slinha <b>AS STRING
DIM </b>bQuebra</font><font color="#808080">, </font><font color="#000080">bAchou</font><font color="#808080">, </font><font color="#000080">bret <b>AS INTEGER
DIM </b>nStatus</font><font color="#808080">, </font><font color="#000080">nCont <b>AS INTEGER
DIM </b>sres <b>AS STRING

</b>bret </font><font color="#808080">= </font><font color="#000080">false
bQuebra </font><font color="#808080">= </font><font color="#000080">false
nCont </font><font color="#808080">= </font><font color="#FF0000">0
</font><font color="#000080">mostrarDados sreg</font><font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">2
</font><font color="#000080"><b>SEEK </b>sArq</font><font color="#808080">, </font><font color="#FF0000">1
</font><font color="#000080"><b>DO WHILE </b></font><font color="#808080">(</font><font color="#000080"><b>NOT EOF</b></font><font color="#808080">(</font><font color="#000080">sArq</font><font color="#808080">)) </font><font color="#000080"><b>AND </b></font><font color="#808080">(</font><font color="#000080">bQuebra </font><font color="#808080">= </font><font color="#000080">false</font><font color="#808080">)
  </font><font color="#000080"><b>LINE INPUT </b></font><font color="#800000">#sArq, slinha
  </font><font color="#000080"><b>IF </b>bPesqRelativa <b>THEN
    </b>sres </font><font color="#808080">= </font><font color="#000080"><b>Trim</b>$</font><font color="#808080">(</font><font color="#000080"><b>MID</b>$</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#000080">nPosChave</font><font color="#808080">, </font><font color="#000080">nTamChave</font><font color="#808080">))
    </font><font color="#000080"><b>IF </b>strRelativa</font><font color="#808080">(</font><font color="#000080">sres</font><font color="#808080">, </font><font color="#000080">sChave</font><font color="#808080">) </font><font color="#000080"><b>THEN
       </b>bAchou </font><font color="#808080">= </font><font color="#000080">true
       bret </font><font color="#808080">= </font><font color="#000080">true
    <b>ELSE
       </b>bAchou </font><font color="#808080">= </font><font color="#000080">false
    <b>END IF
  ELSE
    </b>bAchou </font><font color="#808080">= </font><font color="#000080">true
    bret </font><font color="#808080">= </font><font color="#000080">true
  <b>END IF

  IF </b>bAchou <b>THEN
    </b>mostrarDados sreg</font><font color="#808080">, </font><font color="#000080"><b>MID</b>$</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#000080">nTamLinha</font><font color="#808080">), </font><font color="#FF0000">3
    </font><font color="#000080">nCont </font><font color="#808080">= </font><font color="#000080">nCont </font><font color="#808080">+ </font><font color="#FF0000">1
  </font><font color="#000080"><b>END IF

  </b>bQuebra </font><font color="#808080">= </font><font color="#000080">ContinuaSN</font><font color="#808080">(</font><font color="#000080">nCont</font><font color="#808080">, </font><font color="#000080">nQtdLinha</font><font color="#808080">)
</font><font color="#000080"><b>LOOP
</b>ListarTodos </font><font color="#808080">= </font><font color="#000080">bret
<b>END FUNCTION

</b></font><font color="#808080"><i>'------------------------------------------------------------------------------
'Mostra os menus do sistema.
'num - o n&pound;mero do menu
'------------------------------------------------------------------------------
</i></font><font color="#000080"><b>SUB </b>menu </font><font color="#808080">(</font><font color="#000080">num <b>AS INTEGER</b></font><font color="#808080">)
 </font><font color="#000080"><b>IF </b></font><font color="#808080">(</font><font color="#000080">num </font><font color="#808080">= </font><font color="#FF0000">1</font><font color="#808080">) </font><font color="#000080"><b>THEN
   PRINT </b></font><font color="#800000">&quot;*--------------------------------------------------------------*&quot;
   </font><font color="#000080"><b>PRINT </b></font><font color="#800000">&quot;| (C)adastros        (P)esquisas     (V)endas        (O)p‡&auml;es  |&quot;
   </font><font color="#000080"><b>PRINT </b></font><font color="#800000">&quot;*--------------------------------------------------------------*&quot;
 </font><font color="#000080"><b>ELSEIF </b></font><font color="#808080">(</font><font color="#000080">num </font><font color="#808080">= </font><font color="#FF0000">2</font><font color="#808080">) </font><font color="#000080"><b>THEN
   PRINT </b></font><font color="#800000">&quot;*---------------------------------*&quot;
   </font><font color="#000080"><b>PRINT </b></font><font color="#800000">&quot;| 01. Cadastro de Assuntos        |&quot;
   </font><font color="#000080"><b>PRINT </b></font><font color="#800000">&quot;| 02. Cadastro de Autores         |&quot;
   </font><font color="#000080"><b>PRINT </b></font><font color="#800000">&quot;| 03. Cadastro de Editoras        |&quot;
   </font><font color="#000080"><b>PRINT </b></font><font color="#800000">&quot;| 04. Cadastro de Endere‡os       |&quot;
   </font><font color="#000080"><b>PRINT </b></font><font color="#800000">&quot;| 05. Cadastro de Idiomas         |&quot;
   </font><font color="#000080"><b>PRINT </b></font><font color="#800000">&quot;| 06. Cadastro de Pa&iexcl;ses          |&quot;
   </font><font color="#000080"><b>PRINT </b></font><font color="#800000">&quot;| 07. Cadastro de Profiss&auml;es      |&quot;
   </font><font color="#000080"><b>PRINT </b></font><font color="#800000">&quot;| 08. Cadastro de Clientes        |&quot;
   </font><font color="#000080"><b>PRINT </b></font><font color="#800000">&quot;| 09. Cadastro de Livros          |&quot;
   </font><font color="#000080"><b>PRINT </b></font><font color="#800000">&quot;| 10. Voltar ao menu              |&quot;
   </font><font color="#000080"><b>PRINT </b></font><font color="#800000">&quot;*---------------------------------*&quot;
 </font><font color="#000080"><b>ELSEIF </b></font><font color="#808080">(</font><font color="#000080">num </font><font color="#808080">= </font><font color="#FF0000">3</font><font color="#808080">) </font><font color="#000080"><b>THEN
   PRINT </b></font><font color="#800000">&quot;*---------------------------------*&quot;
   </font><font color="#000080"><b>PRINT </b></font><font color="#800000">&quot;| 01. Consulta de Assuntos        |&quot;
   </font><font color="#000080"><b>PRINT </b></font><font color="#800000">&quot;| 02. Consulta de Autores         |&quot;
   </font><font color="#000080"><b>PRINT </b></font><font color="#800000">&quot;| 03. Consulta de Editoras        |&quot;
   </font><font color="#000080"><b>PRINT </b></font><font color="#800000">&quot;| 04. Consulta de Endere‡os       |&quot;
   </font><font color="#000080"><b>PRINT </b></font><font color="#800000">&quot;| 05. Consulta de Idiomas         |&quot;
   </font><font color="#000080"><b>PRINT </b></font><font color="#800000">&quot;| 06. Consulta de Pa&iexcl;ses          |&quot;
   </font><font color="#000080"><b>PRINT </b></font><font color="#800000">&quot;| 07. Consulta de Profiss&auml;es      |&quot;
   </font><font color="#000080"><b>PRINT </b></font><font color="#800000">&quot;| 08. Consulta de Clientes        |&quot;
   </font><font color="#000080"><b>PRINT </b></font><font color="#800000">&quot;| 09. Consulta de Livros          |&quot;
   </font><font color="#000080"><b>PRINT </b></font><font color="#800000">&quot;| 10. Voltar ao menu              |&quot;
   </font><font color="#000080"><b>PRINT </b></font><font color="#800000">&quot;*---------------------------------*&quot;
 </font><font color="#000080"><b>ELSEIF </b></font><font color="#808080">(</font><font color="#000080">num </font><font color="#808080">= </font><font color="#FF0000">4</font><font color="#808080">) </font><font color="#000080"><b>THEN
   PRINT </b></font><font color="#800000">&quot;*---------------------------------*&quot;
   </font><font color="#000080"><b>PRINT </b></font><font color="#800000">&quot;| 01. Vender Livros               |&quot;
   </font><font color="#000080"><b>PRINT </b></font><font color="#800000">&quot;| 02. Vendas Realizadas           |&quot;
   </font><font color="#000080"><b>PRINT </b></font><font color="#800000">&quot;| 03. Voltar ao menu              |&quot;
   </font><font color="#000080"><b>PRINT </b></font><font color="#800000">&quot;*---------------------------------*&quot;
 </font><font color="#000080"><b>ELSEIF </b></font><font color="#808080">(</font><font color="#000080">num </font><font color="#808080">= </font><font color="#FF0000">5</font><font color="#808080">) </font><font color="#000080"><b>THEN
   PRINT </b></font><font color="#800000">&quot;*---------------------------------*&quot;
   </font><font color="#000080"><b>PRINT </b></font><font color="#800000">&quot;| 01. Alterar senha               |&quot;
   </font><font color="#000080"><b>PRINT </b></font><font color="#800000">&quot;| 02. Sobre o sistema             |&quot;
   </font><font color="#000080"><b>PRINT </b></font><font color="#800000">&quot;| 03. Sair do sistema             |&quot;
   </font><font color="#000080"><b>PRINT </b></font><font color="#800000">&quot;| 04. Voltar ao menu              |&quot;
   </font><font color="#000080"><b>PRINT </b></font><font color="#800000">&quot;*---------------------------------*&quot;
 </font><font color="#000080"><b>ELSEIF </b></font><font color="#808080">(</font><font color="#000080">num </font><font color="#808080">= </font><font color="#FF0000">6</font><font color="#808080">) </font><font color="#000080"><b>THEN
   PRINT </b></font><font color="#800000">&quot;*--------------------------------------------------------------*&quot;
   </font><font color="#000080"><b>PRINT </b></font><font color="#800000">&quot;| (1) Novo  (2) Pesquisar   (3) Voltar ao menu                 |&quot;
   </font><font color="#000080"><b>PRINT </b></font><font color="#800000">&quot;*--------------------------------------------------------------*&quot;
 </font><font color="#000080"><b>ELSEIF </b></font><font color="#808080">(</font><font color="#000080">num </font><font color="#808080">= </font><font color="#FF0000">7</font><font color="#808080">) </font><font color="#000080"><b>THEN
   PRINT </b></font><font color="#800000">&quot;*--------------------------------------------------------------*&quot;
   </font><font color="#000080"><b>PRINT </b></font><font color="#800000">&quot;| (1) Salvar inclus&AElig;o       (2) Voltar ao menu                 |&quot;
   </font><font color="#000080"><b>PRINT </b></font><font color="#800000">&quot;*--------------------------------------------------------------*&quot;
 </font><font color="#000080"><b>ELSEIF </b></font><font color="#808080">(</font><font color="#000080">num </font><font color="#808080">= </font><font color="#FF0000">8</font><font color="#808080">) </font><font color="#000080"><b>THEN
   PRINT </b></font><font color="#800000">&quot;*--------------------------------------------------------------*&quot;
   </font><font color="#000080"><b>PRINT </b></font><font color="#800000">&quot;| (1) Alterar       (2) Excluir     (3) Voltar ao menu         |&quot;
   </font><font color="#000080"><b>PRINT </b></font><font color="#800000">&quot;*--------------------------------------------------------------*&quot;
 </font><font color="#000080"><b>ELSEIF </b></font><font color="#808080">(</font><font color="#000080">num </font><font color="#808080">= </font><font color="#FF0000">9</font><font color="#808080">) </font><font color="#000080"><b>THEN
   PRINT </b></font><font color="#800000">&quot;*--------------------------------------------------------------*&quot;
   </font><font color="#000080"><b>PRINT </b></font><font color="#800000">&quot;| (1) Salvar altera‡&AElig;o      (2) Voltar ao menu                 |&quot;
   </font><font color="#000080"><b>PRINT </b></font><font color="#800000">&quot;*--------------------------------------------------------------*&quot;
 </font><font color="#000080"><b>ELSEIF </b></font><font color="#808080">(</font><font color="#000080">num </font><font color="#808080">= </font><font color="#FF0000">10</font><font color="#808080">) </font><font color="#000080"><b>THEN
   PRINT </b></font><font color="#800000">&quot;*--------------------------------------------------------------*&quot;
   </font><font color="#000080"><b>PRINT </b></font><font color="#800000">&quot;| Certeza de excluir? (S/N)                                    |&quot;
   </font><font color="#000080"><b>PRINT </b></font><font color="#800000">&quot;*--------------------------------------------------------------*&quot;
 </font><font color="#000080"><b>ELSEIF </b></font><font color="#808080">(</font><font color="#000080">num </font><font color="#808080">= </font><font color="#FF0000">11</font><font color="#808080">) </font><font color="#000080"><b>THEN
   PRINT </b></font><font color="#800000">&quot;*--------------------------------------------------------------*&quot;
   </font><font color="#000080"><b>PRINT </b></font><font color="#800000">&quot;| Deseja sair do sistema? (S/N)                                |&quot;
   </font><font color="#000080"><b>PRINT </b></font><font color="#800000">&quot;*--------------------------------------------------------------*&quot;
 </font><font color="#000080"><b>ELSEIF </b></font><font color="#808080">(</font><font color="#000080">num </font><font color="#808080">= </font><font color="#FF0000">12</font><font color="#808080">) </font><font color="#000080"><b>THEN
   PRINT </b></font><font color="#800000">&quot;*--------------------------------------------------------------*&quot;
   </font><font color="#000080"><b>PRINT </b></font><font color="#800000">&quot;| (1) Pesquisar  (2) Listar todos   (3) Voltar ao menu         |&quot;
   </font><font color="#000080"><b>PRINT </b></font><font color="#800000">&quot;*--------------------------------------------------------------*&quot;
 </font><font color="#000080"><b>ELSEIF </b></font><font color="#808080">(</font><font color="#000080">num </font><font color="#808080">= </font><font color="#FF0000">13</font><font color="#808080">) </font><font color="#000080"><b>THEN
   PRINT </b></font><font color="#800000">&quot;*--------------------------------------------------------------*&quot;
   </font><font color="#000080"><b>PRINT </b></font><font color="#800000">&quot;| Deseja continuar? (S/N)                                      |&quot;
   </font><font color="#000080"><b>PRINT </b></font><font color="#800000">&quot;*--------------------------------------------------------------*&quot;
 </font><font color="#000080"><b>ELSEIF </b></font><font color="#808080">(</font><font color="#000080">num </font><font color="#808080">= </font><font color="#FF0000">14</font><font color="#808080">) </font><font color="#000080"><b>THEN
   PRINT </b></font><font color="#800000">&quot;*--------------------------------------------------------------*&quot;
   </font><font color="#000080"><b>PRINT </b></font><font color="#800000">&quot;| Salvar inclus&AElig;o (S/N)                                        |&quot;
   </font><font color="#000080"><b>PRINT </b></font><font color="#800000">&quot;*--------------------------------------------------------------*&quot;
 </font><font color="#000080"><b>END IF
 PRINT </b>MSGOPCAO</font><font color="#808080">;
</font><font color="#000080"><b>END SUB

</b></font><font color="#808080"><i>'------------------------------------------------------------------------------
'Calcula o modulo11 de um valor qualquer.
'svalor - a string com o n&pound;mero a ser calculado
'ndig - d&iexcl;gito do valor a ser calculado
'retorna - o d&iexcl;gito correto
'------------------------------------------------------------------------------
</i></font><font color="#000080"><b>FUNCTION </b>modulo11! </font><font color="#808080">(</font><font color="#000080">svalor <b>AS STRING</b></font><font color="#808080">, </font><font color="#000080">ndig <b>AS INTEGER</b></font><font color="#808080">)
</font><font color="#000080"><b>Dim </b>ncont <b>As Integer</b></font><font color="#808080">, </font><font color="#000080">nsoma <b>As Integer
Dim </b>nvalor <b>As Integer</b></font><font color="#808080">, </font><font color="#000080">npos <b>As Integer
Dim </b>sres <b>As String</b></font><font color="#808080">, </font><font color="#000080">slocal <b>As String

 </b>ncont </font><font color="#808080">= </font><font color="#FF0000">1
 </font><font color="#000080"><b>do while </b>ncont </font><font color="#808080">&lt;= </font><font color="#FF0000">11 
   </font><font color="#000080">slocal </font><font color="#808080">= </font><font color="#000080"><b>mid</b>$</font><font color="#808080">(</font><font color="#000080">svalor</font><font color="#808080">, </font><font color="#000080">ncont</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">) + </font><font color="#000080">slocal
   ncont </font><font color="#808080">= </font><font color="#000080">ncont</font><font color="#808080">+</font><font color="#FF0000">1
 </font><font color="#000080"><b>loop
 </b>nsoma </font><font color="#808080">= </font><font color="#FF0000">0
 </font><font color="#000080"><b>if </b>ndig</font><font color="#808080">=</font><font color="#FF0000">1 </font><font color="#000080"><b>then
   </b>ncont </font><font color="#808080">= </font><font color="#FF0000">3
 </font><font color="#000080"><b>else
   </b>ncont </font><font color="#808080">= </font><font color="#FF0000">2
 </font><font color="#000080"><b>end if
 </b>npos </font><font color="#808080">= </font><font color="#FF0000">2
 </font><font color="#000080"><b>do while </b>ncont </font><font color="#808080">&lt;= </font><font color="#FF0000">11
   </font><font color="#000080">sres </font><font color="#808080">= </font><font color="#000080"><b>mid</b>$</font><font color="#808080">(</font><font color="#000080">slocal</font><font color="#808080">,</font><font color="#000080">ncont</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">)
   </font><font color="#000080">nvalor </font><font color="#808080">= </font><font color="#000080"><b>Val</b></font><font color="#808080">(</font><font color="#000080">sres</font><font color="#808080">)
   </font><font color="#000080">nsoma </font><font color="#808080">= </font><font color="#000080">nsoma </font><font color="#808080">+ (</font><font color="#000080">nvalor </font><font color="#808080">* </font><font color="#000080">npos</font><font color="#808080">)
   </font><font color="#000080">ncont </font><font color="#808080">= </font><font color="#000080">ncont</font><font color="#808080">+</font><font color="#FF0000">1
   </font><font color="#000080">npos </font><font color="#808080">= </font><font color="#000080">npos</font><font color="#808080">+</font><font color="#FF0000">1
 </font><font color="#000080"><b>loop
 </b>nsoma </font><font color="#808080">= (</font><font color="#FF0000">11 </font><font color="#808080">- (</font><font color="#000080">nsoma <b>mod </b></font><font color="#FF0000">11</font><font color="#808080">))

 </font><font color="#000080"><b>if </b>nsoma </font><font color="#808080">&gt; </font><font color="#FF0000">9 </font><font color="#000080"><b>then
   </b>modulo11 </font><font color="#808080">= </font><font color="#FF0000">0
 </font><font color="#000080"><b>else
   </b>modulo11 </font><font color="#808080">= </font><font color="#000080">nsoma
 <b>end if
END FUNCTION

</b></font><font color="#808080"><i>'------------------------------------------------------------------------------
'Mostra as entradas e as sa&iexcl;das do sistema.
'sreg - o tipo de arquivo
'slinha - o registro com os dados
'nOpcao - indica qual op‡&AElig;o ser  mostrada
'------------------------------------------------------------------------------
</i></font><font color="#000080"><b>SUB </b>mostrarDados </font><font color="#808080">(</font><font color="#000080">sreg <b>AS INTEGER</b></font><font color="#808080">, </font><font color="#000080">slinha <b>AS STRING</b></font><font color="#808080">, </font><font color="#000080">nOpcao <b>AS INTEGER</b></font><font color="#808080">)
</font><font color="#000080"><b>IF </b>sreg </font><font color="#808080">= </font><font color="#000080">opAssunto <b>THEN
   SELECT CASE </b>nOpcao
     <b>CASE </b></font><font color="#FF0000">1
</font>	<font color="#000080"><b>PRINT </b>rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">) + </font><font color="#000080">tAssunto</font><font color="#808080">.</font><font color="#000080">codigo
</font>	<font color="#000080"><b>PRINT </b>rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">);
</font>	<font color="#000080"><b>INPUT </b></font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#000080">tAssunto</font><font color="#808080">.</font><font color="#000080">assunto
     <b>CASE </b></font><font color="#FF0000">2
</font>	<font color="#000080"><b>PRINT </b></font><font color="#800000">&quot;C&cent;digo     Assunto&quot;
</font>	<font color="#000080"><b>PRINT </b></font><font color="#800000">&quot;------     -------&quot;
     </font><font color="#000080"><b>CASE </b></font><font color="#FF0000">3
</font>	<font color="#000080">tAssunto</font><font color="#808080">.</font><font color="#000080">codigo </font><font color="#808080">= </font><font color="#000080"><b>MID</b>$</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">)
</font>	<font color="#000080">tAssunto</font><font color="#808080">.</font><font color="#000080">assunto </font><font color="#808080">= </font><font color="#000080"><b>MID</b>$</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">11</font><font color="#808080">, </font><font color="#FF0000">30</font><font color="#808080">)
</font>	<font color="#000080"><b>PRINT </b>tAssunto</font><font color="#808080">.</font><font color="#000080">codigo </font><font color="#808080">+ </font><font color="#800000">&quot; &quot; </font><font color="#808080">+ </font><font color="#000080">tAssunto</font><font color="#808080">.</font><font color="#000080">assunto
   <b>END SELECT
ELSEIF </b>sreg </font><font color="#808080">= </font><font color="#000080">opAutor <b>THEN
   SELECT CASE </b>nOpcao
     <b>CASE </b></font><font color="#FF0000">1
</font>	<font color="#000080"><b>PRINT </b>rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">) + </font><font color="#000080">tAutor</font><font color="#808080">.</font><font color="#000080">codigo
</font>	<font color="#000080"><b>PRINT </b>rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">);
</font>	<font color="#000080"><b>INPUT </b></font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#000080">tAutor</font><font color="#808080">.</font><font color="#000080">autor
     <b>CASE </b></font><font color="#FF0000">2
</font>	<font color="#000080"><b>PRINT </b></font><font color="#800000">&quot;C&cent;digo     Autor&quot;
</font>	<font color="#000080"><b>PRINT </b></font><font color="#800000">&quot;------     -----&quot;
     </font><font color="#000080"><b>CASE </b></font><font color="#FF0000">3
</font>	<font color="#000080">tAutor</font><font color="#808080">.</font><font color="#000080">codigo </font><font color="#808080">= </font><font color="#000080"><b>MID</b>$</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">)
</font>	<font color="#000080">tAutor</font><font color="#808080">.</font><font color="#000080">autor </font><font color="#808080">= </font><font color="#000080"><b>MID</b>$</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">11</font><font color="#808080">, </font><font color="#FF0000">30</font><font color="#808080">)
</font>	<font color="#000080"><b>PRINT </b>tAutor</font><font color="#808080">.</font><font color="#000080">codigo </font><font color="#808080">+ </font><font color="#800000">&quot; &quot; </font><font color="#808080">+ </font><font color="#000080">tAutor</font><font color="#808080">.</font><font color="#000080">autor
   <b>END SELECT
ELSEIF </b>sreg </font><font color="#808080">= </font><font color="#000080">opEditora <b>THEN
   SELECT CASE </b>nOpcao
     <b>CASE </b></font><font color="#FF0000">1
</font>	<font color="#000080"><b>PRINT </b>rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">) + </font><font color="#000080">tEditora</font><font color="#808080">.</font><font color="#000080">codigo
</font>	<font color="#000080"><b>PRINT </b>rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">);
</font>	<font color="#000080"><b>INPUT </b></font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#000080">tEditora</font><font color="#808080">.</font><font color="#000080">editora
     <b>CASE </b></font><font color="#FF0000">2
</font>	<font color="#000080"><b>PRINT </b></font><font color="#800000">&quot;C&cent;digo     Editora&quot;
</font>	<font color="#000080"><b>PRINT </b></font><font color="#800000">&quot;------     -------&quot;
     </font><font color="#000080"><b>CASE </b></font><font color="#FF0000">3
</font>	<font color="#000080">tEditora</font><font color="#808080">.</font><font color="#000080">codigo </font><font color="#808080">= </font><font color="#000080"><b>MID</b>$</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">)
</font>	<font color="#000080">tEditora</font><font color="#808080">.</font><font color="#000080">editora </font><font color="#808080">= </font><font color="#000080"><b>MID</b>$</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">11</font><font color="#808080">, </font><font color="#FF0000">50</font><font color="#808080">)
</font>	<font color="#000080"><b>PRINT </b>tEditora</font><font color="#808080">.</font><font color="#000080">codigo </font><font color="#808080">+ </font><font color="#800000">&quot; &quot; </font><font color="#808080">+ </font><font color="#000080">tEditora</font><font color="#808080">.</font><font color="#000080">editora
   <b>END SELECT
ELSEIF </b>sreg </font><font color="#808080">= </font><font color="#000080">opEndereco <b>THEN
   SELECT CASE </b>nOpcao
     <b>CASE </b></font><font color="#FF0000">1
</font>	<font color="#000080"><b>PRINT </b>rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">) + </font><font color="#000080">tEndereco</font><font color="#808080">.</font><font color="#000080">codigo
</font>	<font color="#000080"><b>PRINT </b>rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">);
</font>	<font color="#000080"><b>INPUT </b></font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#000080">tEndereco</font><font color="#808080">.</font><font color="#000080">Logradouro
</font>	<font color="#000080"><b>PRINT </b>rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">);
</font>	<font color="#000080"><b>INPUT </b></font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#000080">tEndereco</font><font color="#808080">.</font><font color="#000080">bairro
</font>	<font color="#000080"><b>PRINT </b>rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">4</font><font color="#808080">);
</font>	<font color="#000080"><b>INPUT </b></font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#000080">tEndereco</font><font color="#808080">.</font><font color="#000080">cep
</font>	<font color="#000080"><b>PRINT </b>rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">5</font><font color="#808080">);
</font>	<font color="#000080"><b>INPUT </b></font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#000080">tEndereco</font><font color="#808080">.</font><font color="#000080">cidade
</font>	<font color="#000080"><b>PRINT </b>rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">6</font><font color="#808080">);
</font>	<font color="#000080"><b>INPUT </b></font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#000080">tEndereco</font><font color="#808080">.</font><font color="#000080">estado
     <b>CASE </b></font><font color="#FF0000">3
</font>	<font color="#000080">tEndereco</font><font color="#808080">.</font><font color="#000080">codigo </font><font color="#808080">= </font><font color="#000080"><b>Trim</b>$</font><font color="#808080">(</font><font color="#000080"><b>MID</b>$</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">))
</font>	<font color="#000080">tEndereco</font><font color="#808080">.</font><font color="#000080">Logradouro </font><font color="#808080">= </font><font color="#000080"><b>Trim</b>$</font><font color="#808080">(</font><font color="#000080"><b>MID</b>$</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">11</font><font color="#808080">, </font><font color="#FF0000">40</font><font color="#808080">))
</font>	<font color="#000080">tEndereco</font><font color="#808080">.</font><font color="#000080">bairro </font><font color="#808080">= </font><font color="#000080"><b>Trim</b>$</font><font color="#808080">(</font><font color="#000080"><b>MID</b>$</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">51</font><font color="#808080">, </font><font color="#FF0000">15</font><font color="#808080">))
</font>	<font color="#000080">tEndereco</font><font color="#808080">.</font><font color="#000080">cep </font><font color="#808080">= </font><font color="#000080"><b>Trim</b>$</font><font color="#808080">(</font><font color="#000080"><b>MID</b>$</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">66</font><font color="#808080">, </font><font color="#FF0000">8</font><font color="#808080">))
</font>	<font color="#000080">tEndereco</font><font color="#808080">.</font><font color="#000080">cidade </font><font color="#808080">= </font><font color="#000080"><b>Trim</b>$</font><font color="#808080">(</font><font color="#000080"><b>MID</b>$</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">74</font><font color="#808080">, </font><font color="#FF0000">30</font><font color="#808080">))
</font>	<font color="#000080">tEndereco</font><font color="#808080">.</font><font color="#000080">estado </font><font color="#808080">= </font><font color="#000080"><b>Trim</b>$</font><font color="#808080">(</font><font color="#000080"><b>MID</b>$</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">104</font><font color="#808080">, </font><font color="#FF0000">20</font><font color="#808080">))
</font>	<font color="#000080"><b>PRINT </b></font><font color="#800000">&quot;--------------------&quot;
</font>	<font color="#000080"><b>PRINT </b>rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">) + </font><font color="#000080">tEndereco</font><font color="#808080">.</font><font color="#000080">codigo
</font>	<font color="#000080"><b>PRINT </b>rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">) + </font><font color="#000080">tEndereco</font><font color="#808080">.</font><font color="#000080">Logradouro
</font>	<font color="#000080"><b>PRINT </b>rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">) + </font><font color="#000080">tEndereco</font><font color="#808080">.</font><font color="#000080">bairro
</font>	<font color="#000080"><b>PRINT </b>rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">4</font><font color="#808080">) + </font><font color="#000080">tEndereco</font><font color="#808080">.</font><font color="#000080">cep
</font>	<font color="#000080"><b>PRINT </b>rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">5</font><font color="#808080">) + </font><font color="#000080">tEndereco</font><font color="#808080">.</font><font color="#000080">cidade
</font>	<font color="#000080"><b>PRINT </b>rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">6</font><font color="#808080">) + </font><font color="#000080">tEndereco</font><font color="#808080">.</font><font color="#000080">estado
   <b>END SELECT
ELSEIF </b>sreg </font><font color="#808080">= </font><font color="#000080">opIdioma <b>THEN
   SELECT CASE </b>nOpcao
     <b>CASE </b></font><font color="#FF0000">1
</font>	<font color="#000080"><b>PRINT </b>rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">) + </font><font color="#000080">tIdioma</font><font color="#808080">.</font><font color="#000080">codigo
</font>	<font color="#000080"><b>PRINT </b>rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">);
</font>	<font color="#000080"><b>INPUT </b></font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#000080">tIdioma</font><font color="#808080">.</font><font color="#000080">idioma
     <b>CASE </b></font><font color="#FF0000">2
</font>	<font color="#000080"><b>PRINT </b></font><font color="#800000">&quot;C&cent;digo     Idioma&quot;
</font>	<font color="#000080"><b>PRINT </b></font><font color="#800000">&quot;------     ------&quot;
     </font><font color="#000080"><b>CASE </b></font><font color="#FF0000">3
</font>	<font color="#000080">tIdioma</font><font color="#808080">.</font><font color="#000080">codigo </font><font color="#808080">= </font><font color="#000080"><b>MID</b>$</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">)
</font>	<font color="#000080">tIdioma</font><font color="#808080">.</font><font color="#000080">idioma </font><font color="#808080">= </font><font color="#000080"><b>MID</b>$</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">11</font><font color="#808080">, </font><font color="#FF0000">20</font><font color="#808080">)
</font>	<font color="#000080"><b>PRINT </b>tIdioma</font><font color="#808080">.</font><font color="#000080">codigo </font><font color="#808080">+ </font><font color="#800000">&quot; &quot; </font><font color="#808080">+ </font><font color="#000080">tIdioma</font><font color="#808080">.</font><font color="#000080">idioma
   <b>END SELECT
ELSEIF </b>sreg </font><font color="#808080">= </font><font color="#000080">opPais <b>THEN
   SELECT CASE </b>nOpcao
     <b>CASE </b></font><font color="#FF0000">1
</font>	<font color="#000080"><b>PRINT </b>rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">);
</font>	<font color="#000080"><b>INPUT </b></font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#000080">tPais</font><font color="#808080">.</font><font color="#000080">pais
     <b>CASE </b></font><font color="#FF0000">2
</font>	<font color="#000080"><b>PRINT </b></font><font color="#800000">&quot;C&cent;digo Pa&iexcl;s&quot;
</font>	<font color="#000080"><b>PRINT </b></font><font color="#800000">&quot;------ ----&quot;
     </font><font color="#000080"><b>CASE </b></font><font color="#FF0000">3
</font>	<font color="#000080">tPais</font><font color="#808080">.</font><font color="#000080">codigo </font><font color="#808080">= </font><font color="#000080"><b>MID</b>$</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">)
</font>	<font color="#000080">tPais</font><font color="#808080">.</font><font color="#000080">pais </font><font color="#808080">= </font><font color="#000080"><b>MID</b>$</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">4</font><font color="#808080">, </font><font color="#FF0000">50</font><font color="#808080">)
</font>	<font color="#000080"><b>PRINT </b>tPais</font><font color="#808080">.</font><font color="#000080">codigo </font><font color="#808080">+ </font><font color="#800000">&quot;    &quot; </font><font color="#808080">+ </font><font color="#000080">tPais</font><font color="#808080">.</font><font color="#000080">pais
   <b>END SELECT
ELSEIF </b>sreg </font><font color="#808080">= </font><font color="#000080">opProfissao <b>THEN
   SELECT CASE </b>nOpcao
     <b>CASE </b></font><font color="#FF0000">1
</font>	<font color="#000080"><b>PRINT </b>rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">) + </font><font color="#000080">tProfissao</font><font color="#808080">.</font><font color="#000080">codigo
</font>	<font color="#000080"><b>PRINT </b>rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">);
</font>	<font color="#000080"><b>INPUT </b></font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#000080">tProfissao</font><font color="#808080">.</font><font color="#000080">profissao
     <b>CASE </b></font><font color="#FF0000">2
</font>	<font color="#000080"><b>PRINT </b></font><font color="#800000">&quot;C&cent;digo     Profiss&AElig;o&quot;
</font>	<font color="#000080"><b>PRINT </b></font><font color="#800000">&quot;------     ---------&quot;
     </font><font color="#000080"><b>CASE </b></font><font color="#FF0000">3
</font>	<font color="#000080">tProfissao</font><font color="#808080">.</font><font color="#000080">codigo </font><font color="#808080">= </font><font color="#000080"><b>MID</b>$</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">)
</font>	<font color="#000080">tProfissao</font><font color="#808080">.</font><font color="#000080">profissao </font><font color="#808080">= </font><font color="#000080"><b>MID</b>$</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">11</font><font color="#808080">, </font><font color="#FF0000">50</font><font color="#808080">)
</font>	<font color="#000080"><b>PRINT </b>tProfissao</font><font color="#808080">.</font><font color="#000080">codigo </font><font color="#808080">+ </font><font color="#800000">&quot; &quot; </font><font color="#808080">+ </font><font color="#000080">tProfissao</font><font color="#808080">.</font><font color="#000080">profissao
   <b>END SELECT
ELSEIF </b>sreg </font><font color="#808080">= </font><font color="#000080">opLivro <b>THEN
   SELECT CASE </b>nOpcao
     <b>CASE </b></font><font color="#FF0000">1
</font>	<font color="#000080"><b>PRINT </b>rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">);
</font>	<font color="#000080"><b>INPUT </b></font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#000080">tLivro</font><font color="#808080">.</font><font color="#000080">titulo
</font>	<font color="#000080">tLivro</font><font color="#808080">.</font><font color="#000080">edicao </font><font color="#808080">= </font><font color="#000080">validaNumero</font><font color="#808080">(</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">), </font><font color="#000080">tLivro</font><font color="#808080">.</font><font color="#000080">edicao</font><font color="#808080">)
</font>	<font color="#000080">tLivro</font><font color="#808080">.</font><font color="#000080">anopubli </font><font color="#808080">= </font><font color="#000080">validaNumero</font><font color="#808080">(</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">4</font><font color="#808080">), </font><font color="#000080">tLivro</font><font color="#808080">.</font><font color="#000080">anopubli</font><font color="#808080">)
</font>	<font color="#000080">mostrarSubDados opLivro</font><font color="#808080">, </font><font color="#000080">opEditora</font><font color="#808080">, </font><font color="#000080">false
</font>	<font color="#000080">tLivro</font><font color="#808080">.</font><font color="#000080">volume </font><font color="#808080">= </font><font color="#000080">validaNumero</font><font color="#808080">(</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">6</font><font color="#808080">), </font><font color="#000080">tLivro</font><font color="#808080">.</font><font color="#000080">volume</font><font color="#808080">)
</font>	<font color="#000080">mostrarSubDados opLivro</font><font color="#808080">, </font><font color="#000080">opIdioma</font><font color="#808080">, </font><font color="#000080">false
</font>	<font color="#000080">tLivro</font><font color="#808080">.</font><font color="#000080">npaginas </font><font color="#808080">= </font><font color="#000080">validaNumero</font><font color="#808080">(</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">8</font><font color="#808080">), </font><font color="#000080">tLivro</font><font color="#808080">.</font><font color="#000080">npaginas</font><font color="#808080">)
</font>	<font color="#000080">tLivro</font><font color="#808080">.</font><font color="#000080">preco </font><font color="#808080">= </font><font color="#000080">validaNumero</font><font color="#808080">(</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">9</font><font color="#808080">), </font><font color="#000080">tLivro</font><font color="#808080">.</font><font color="#000080">preco</font><font color="#808080">)
</font>	<font color="#000080">tLivro</font><font color="#808080">.</font><font color="#000080">qtdestoque </font><font color="#808080">= </font><font color="#000080">validaNumero</font><font color="#808080">(</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">), </font><font color="#000080">tLivro</font><font color="#808080">.</font><font color="#000080">qtdestoque</font><font color="#808080">)
     </font><font color="#000080"><b>CASE </b></font><font color="#FF0000">3
</font>	<font color="#000080">tLivro</font><font color="#808080">.</font><font color="#000080">isbn </font><font color="#808080">= </font><font color="#000080"><b>Trim</b>$</font><font color="#808080">(</font><font color="#000080"><b>MID</b>$</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">13</font><font color="#808080">))
</font>	<font color="#000080">tLivro</font><font color="#808080">.</font><font color="#000080">titulo </font><font color="#808080">= </font><font color="#000080"><b>Trim</b>$</font><font color="#808080">(</font><font color="#000080"><b>MID</b>$</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">14</font><font color="#808080">, </font><font color="#FF0000">50</font><font color="#808080">))
</font>	<font color="#000080">tLivro</font><font color="#808080">.</font><font color="#000080">edicao </font><font color="#808080">= </font><font color="#000080"><b>Trim</b>$</font><font color="#808080">(</font><font color="#000080"><b>MID</b>$</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">64</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">))
</font>	<font color="#000080">tLivro</font><font color="#808080">.</font><font color="#000080">anopubli </font><font color="#808080">= </font><font color="#000080"><b>Trim</b>$</font><font color="#808080">(</font><font color="#000080"><b>MID</b>$</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">74</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">))
</font>	<font color="#000080">tLivro</font><font color="#808080">.</font><font color="#000080">codeditora </font><font color="#808080">= </font><font color="#000080"><b>Trim</b>$</font><font color="#808080">(</font><font color="#000080"><b>MID</b>$</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">84</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">))
</font>	<font color="#000080">tLivro</font><font color="#808080">.</font><font color="#000080">volume </font><font color="#808080">= </font><font color="#000080"><b>Trim</b>$</font><font color="#808080">(</font><font color="#000080"><b>MID</b>$</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">94</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">))
</font>	<font color="#000080">tLivro</font><font color="#808080">.</font><font color="#000080">codidioma </font><font color="#808080">= </font><font color="#000080"><b>Trim</b>$</font><font color="#808080">(</font><font color="#000080"><b>MID</b>$</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">104</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">))
</font>	<font color="#000080">tLivro</font><font color="#808080">.</font><font color="#000080">npaginas </font><font color="#808080">= </font><font color="#000080"><b>Trim</b>$</font><font color="#808080">(</font><font color="#000080"><b>MID</b>$</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">114</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">))
</font>	<font color="#000080">tLivro</font><font color="#808080">.</font><font color="#000080">preco </font><font color="#808080">= </font><font color="#000080"><b>Trim</b>$</font><font color="#808080">(</font><font color="#000080"><b>MID</b>$</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">124</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">))
</font>	<font color="#000080">tLivro</font><font color="#808080">.</font><font color="#000080">qtdestoque </font><font color="#808080">= </font><font color="#000080"><b>Trim</b>$</font><font color="#808080">(</font><font color="#000080"><b>MID</b>$</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">134</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">))
</font>	<font color="#000080"><b>PRINT </b></font><font color="#800000">&quot;--------------------&quot;
</font>	<font color="#000080"><b>PRINT </b>rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">) + </font><font color="#000080">tLivro</font><font color="#808080">.</font><font color="#000080">isbn
</font>	<font color="#000080"><b>PRINT </b>rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">) + </font><font color="#000080">tLivro</font><font color="#808080">.</font><font color="#000080">titulo
</font>	<font color="#000080"><b>PRINT </b>rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">) + </font><font color="#000080">tLivro</font><font color="#808080">.</font><font color="#000080">edicao
</font>	<font color="#000080"><b>PRINT </b>rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">4</font><font color="#808080">) + </font><font color="#000080">tLivro</font><font color="#808080">.</font><font color="#000080">anopubli
</font>	<font color="#000080"><b>PRINT </b>rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">5</font><font color="#808080">) + </font><font color="#000080">tLivro</font><font color="#808080">.</font><font color="#000080">codeditora
</font>	<font color="#000080">mostrarSubDados opLivro</font><font color="#808080">, </font><font color="#000080">opEditora</font><font color="#808080">, </font><font color="#000080">true
</font>	<font color="#000080"><b>PRINT </b>rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">6</font><font color="#808080">) + </font><font color="#000080">tLivro</font><font color="#808080">.</font><font color="#000080">volume
</font>	<font color="#000080"><b>PRINT </b>rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">7</font><font color="#808080">) + </font><font color="#000080">tLivro</font><font color="#808080">.</font><font color="#000080">codidioma
</font>	<font color="#000080">mostrarSubDados opLivro</font><font color="#808080">, </font><font color="#000080">opIdioma</font><font color="#808080">, </font><font color="#000080">true
</font>	<font color="#000080"><b>PRINT </b>rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">8</font><font color="#808080">) + </font><font color="#000080">tLivro</font><font color="#808080">.</font><font color="#000080">npaginas
</font>	<font color="#000080"><b>PRINT </b>rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">9</font><font color="#808080">) + </font><font color="#000080">tLivro</font><font color="#808080">.</font><font color="#000080">preco
</font>	<font color="#000080"><b>PRINT </b>rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">) + </font><font color="#000080">tLivro</font><font color="#808080">.</font><font color="#000080">qtdestoque
</font>	<font color="#000080">ListarRegLigados tfLivroAss</font><font color="#808080">, </font><font color="#000080">opLivroAss</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">13</font><font color="#808080">, </font><font color="#FF0000">14</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">, </font><font color="#000080">tLivro</font><font color="#808080">.</font><font color="#000080">isbn</font><font color="#808080">, </font><font color="#000080">tfAssunto</font><font color="#808080">, </font><font color="#000080">opAssunto</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">4
</font>	<font color="#000080">ListarRegLigados tfLivroAut</font><font color="#808080">, </font><font color="#000080">opLivroAut</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">13</font><font color="#808080">, </font><font color="#FF0000">14</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">, </font><font color="#000080">tLivro</font><font color="#808080">.</font><font color="#000080">isbn</font><font color="#808080">, </font><font color="#000080">tfAutor</font><font color="#808080">, </font><font color="#000080">opAutor</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">4
   </font><font color="#000080"><b>END SELECT
ELSEIF </b>sreg </font><font color="#808080">= </font><font color="#000080">opCliente <b>THEN
   SELECT CASE </b>nOpcao
     <b>CASE </b></font><font color="#FF0000">1
</font>	<font color="#000080"><b>PRINT </b>rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">);
</font>	<font color="#000080"><b>INPUT </b></font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#000080">tCliente</font><font color="#808080">.</font><font color="#000080">nome
</font>	<font color="#000080"><b>PRINT </b>rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">);
</font>	<font color="#000080"><b>PRINT </b></font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#000080">tCliente</font><font color="#808080">.</font><font color="#000080">email
</font>	<font color="#000080"><b>PRINT </b>rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">4</font><font color="#808080">);
</font>	<font color="#000080"><b>INPUT </b></font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#000080">tCliente</font><font color="#808080">.</font><font color="#000080">identidade
</font>	<font color="#000080"><b>PRINT </b>rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">5</font><font color="#808080">);
</font>	<font color="#000080"><b>INPUT </b></font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#000080">tCliente</font><font color="#808080">.</font><font color="#000080">sexo
</font>	<font color="#000080"><b>PRINT </b>rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">6</font><font color="#808080">);
</font>	<font color="#000080"><b>INPUT </b></font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#000080">tCliente</font><font color="#808080">.</font><font color="#000080">telefone
</font>	<font color="#000080">tCliente</font><font color="#808080">.</font><font color="#000080">dtnascimento </font><font color="#808080">= </font><font color="#000080">validaDataHora</font><font color="#808080">(</font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">7</font><font color="#808080">), </font><font color="#000080">tCliente</font><font color="#808080">.</font><font color="#000080">dtnascimento</font><font color="#808080">, </font><font color="#000080">true</font><font color="#808080">)
</font>	<font color="#000080">mostrarSubDados opCliente</font><font color="#808080">, </font><font color="#000080">opEndereco</font><font color="#808080">, </font><font color="#000080">false
</font>	<font color="#000080">mostrarSubDados opCliente</font><font color="#808080">, </font><font color="#000080">opPais</font><font color="#808080">, </font><font color="#000080">false
</font>	<font color="#000080">mostrarSubDados opCliente</font><font color="#808080">, </font><font color="#000080">opProfissao</font><font color="#808080">, </font><font color="#000080">false
     <b>CASE </b></font><font color="#FF0000">3
</font>	<font color="#000080">tCliente</font><font color="#808080">.</font><font color="#000080">cpf </font><font color="#808080">= </font><font color="#000080"><b>Trim</b>$</font><font color="#808080">(</font><font color="#000080"><b>MID</b>$</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">14</font><font color="#808080">))
</font>	<font color="#000080">tCliente</font><font color="#808080">.</font><font color="#000080">nome </font><font color="#808080">= </font><font color="#000080"><b>Trim</b>$</font><font color="#808080">(</font><font color="#000080"><b>MID</b>$</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">15</font><font color="#808080">, </font><font color="#FF0000">30</font><font color="#808080">))
</font>	<font color="#000080">tCliente</font><font color="#808080">.</font><font color="#000080">email </font><font color="#808080">= </font><font color="#000080"><b>Trim</b>$</font><font color="#808080">(</font><font color="#000080"><b>MID</b>$</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">45</font><font color="#808080">, </font><font color="#FF0000">30</font><font color="#808080">))
</font>	<font color="#000080">tCliente</font><font color="#808080">.</font><font color="#000080">identidade </font><font color="#808080">= </font><font color="#000080"><b>Trim</b>$</font><font color="#808080">(</font><font color="#000080"><b>MID</b>$</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">75</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">))
</font>	<font color="#000080">tCliente</font><font color="#808080">.</font><font color="#000080">sexo </font><font color="#808080">= </font><font color="#000080"><b>Trim</b>$</font><font color="#808080">(</font><font color="#000080"><b>MID</b>$</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">85</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">))
</font>	<font color="#000080">tCliente</font><font color="#808080">.</font><font color="#000080">telefone </font><font color="#808080">= </font><font color="#000080"><b>Trim</b>$</font><font color="#808080">(</font><font color="#000080"><b>MID</b>$</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">86</font><font color="#808080">, </font><font color="#FF0000">17</font><font color="#808080">))
</font>	<font color="#000080">tCliente</font><font color="#808080">.</font><font color="#000080">dtnascimento </font><font color="#808080">= </font><font color="#000080"><b>Trim</b>$</font><font color="#808080">(</font><font color="#000080"><b>MID</b>$</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">103</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">))
</font>	<font color="#000080">tCliente</font><font color="#808080">.</font><font color="#000080">codendereco </font><font color="#808080">= </font><font color="#000080"><b>Trim</b>$</font><font color="#808080">(</font><font color="#000080"><b>MID</b>$</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">113</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">))
</font>	<font color="#000080">tCliente</font><font color="#808080">.</font><font color="#000080">codpais </font><font color="#808080">= </font><font color="#000080"><b>Trim</b>$</font><font color="#808080">(</font><font color="#000080"><b>MID</b>$</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">123</font><font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">))
</font>	<font color="#000080">tCliente</font><font color="#808080">.</font><font color="#000080">codprofissao </font><font color="#808080">= </font><font color="#000080"><b>Trim</b>$</font><font color="#808080">(</font><font color="#000080"><b>MID</b>$</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">126</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">))
</font>	<font color="#000080"><b>PRINT </b></font><font color="#800000">&quot;--------------------&quot;
</font>	<font color="#000080"><b>PRINT </b>rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">) + </font><font color="#000080">tCliente</font><font color="#808080">.</font><font color="#000080">cpf
</font>	<font color="#000080"><b>PRINT </b>rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">) + </font><font color="#000080">tCliente</font><font color="#808080">.</font><font color="#000080">nome
</font>	<font color="#000080"><b>PRINT </b>rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">) + </font><font color="#000080">tCliente</font><font color="#808080">.</font><font color="#000080">email
</font>	<font color="#000080"><b>PRINT </b>rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">4</font><font color="#808080">) + </font><font color="#000080">tCliente</font><font color="#808080">.</font><font color="#000080">identidade
</font>	<font color="#000080"><b>PRINT </b>rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">5</font><font color="#808080">) + </font><font color="#000080">tCliente</font><font color="#808080">.</font><font color="#000080">sexo
</font>	<font color="#000080"><b>PRINT </b>rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">6</font><font color="#808080">) + </font><font color="#000080">tCliente</font><font color="#808080">.</font><font color="#000080">telefone
</font>	<font color="#000080"><b>PRINT </b>rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">7</font><font color="#808080">) + </font><font color="#000080">tCliente</font><font color="#808080">.</font><font color="#000080">dtnascimento
</font>	<font color="#000080"><b>PRINT </b>rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">8</font><font color="#808080">) + </font><font color="#000080">tCliente</font><font color="#808080">.</font><font color="#000080">codendereco
</font>	<font color="#000080">mostrarSubDados opCliente</font><font color="#808080">, </font><font color="#000080">opEndereco</font><font color="#808080">, </font><font color="#000080">true
</font>	<font color="#000080"><b>PRINT </b>rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">9</font><font color="#808080">) + </font><font color="#000080">tCliente</font><font color="#808080">.</font><font color="#000080">codpais
</font>	<font color="#000080">mostrarSubDados opCliente</font><font color="#808080">, </font><font color="#000080">opPais</font><font color="#808080">, </font><font color="#000080">true
</font>	<font color="#000080"><b>PRINT </b>rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">) + </font><font color="#000080">tCliente</font><font color="#808080">.</font><font color="#000080">codprofissao
</font>	<font color="#000080">mostrarSubDados opCliente</font><font color="#808080">, </font><font color="#000080">opProfissao</font><font color="#808080">, </font><font color="#000080">true
   <b>END SELECT
ELSEIF </b>sreg </font><font color="#808080">= </font><font color="#000080">opVenda <b>THEN
   SELECT CASE </b>nOpcao
     <b>CASE </b></font><font color="#FF0000">1
       </font><font color="#000080">mostrarSubDados opVenda</font><font color="#808080">, </font><font color="#000080">opVenda</font><font color="#808080">, </font><font color="#000080">false
     <b>CASE </b></font><font color="#FF0000">2
</font>	<font color="#000080"><b>PRINT </b></font><font color="#800000">&quot;DataHoraVenda       CPF            ISBN          Pre‡oVenda&quot;
</font>	<font color="#000080"><b>PRINT </b></font><font color="#800000">&quot;-------------       ---            ----          ----------&quot;
     </font><font color="#000080"><b>CASE </b></font><font color="#FF0000">3
</font>	<font color="#000080">tVenda</font><font color="#808080">.</font><font color="#000080">dthrvenda </font><font color="#808080">= </font><font color="#000080"><b>MID</b>$</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">19</font><font color="#808080">)
</font>	<font color="#000080">tVenda</font><font color="#808080">.</font><font color="#000080">cpf </font><font color="#808080">= </font><font color="#000080"><b>MID</b>$</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">20</font><font color="#808080">, </font><font color="#FF0000">14</font><font color="#808080">)
</font>	<font color="#000080">tVenda</font><font color="#808080">.</font><font color="#000080">isbn </font><font color="#808080">= </font><font color="#000080"><b>MID</b>$</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">34</font><font color="#808080">, </font><font color="#FF0000">13</font><font color="#808080">)
</font>	<font color="#000080">tVenda</font><font color="#808080">.</font><font color="#000080">precovenda </font><font color="#808080">= </font><font color="#000080"><b>MID</b>$</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">47</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">)
</font>	<font color="#000080"><b>PRINT </b>tVenda</font><font color="#808080">.</font><font color="#000080">dthrvenda </font><font color="#808080">+ </font><font color="#800000">&quot; &quot; </font><font color="#808080">+ </font><font color="#000080">tVenda</font><font color="#808080">.</font><font color="#000080">cpf </font><font color="#808080">+ </font><font color="#800000">&quot; &quot; </font><font color="#808080">+ </font><font color="#000080">tVenda</font><font color="#808080">.</font><font color="#000080">isbn </font><font color="#808080">+ </font><font color="#800000">&quot; &quot; </font><font color="#808080">+ </font><font color="#000080">tVenda</font><font color="#808080">.</font><font color="#000080">precovenda
   <b>END SELECT
END IF

END SUB

</b></font><font color="#808080"><i>'------------------------------------------------------------------------------
'Mostra as sub inform‡&auml;es de entrada e de sa&iexcl;da.
'sreg - o tipo de arquivo
'ssubreg - o subtipo de arquivo
'bSoMostrar - se vai s&cent; mostrar na sa&iexcl;da
'------------------------------------------------------------------------------
</i></font><font color="#000080"><b>SUB </b>mostrarSubDados </font><font color="#808080">(</font><font color="#000080">sreg <b>AS INTEGER</b></font><font color="#808080">, </font><font color="#000080">ssubreg <b>AS INTEGER</b></font><font color="#808080">, </font><font color="#000080">bSoMostrar <b>AS INTEGER</b></font><font color="#808080">)
</font><font color="#000080"><b>DIM </b>sRegistro <b>AS STRING</b></font><font color="#808080">, </font><font color="#000080">sPreco <b>AS STRING
DIM </b>ntam <b>AS INTEGER</b></font><font color="#808080">, </font><font color="#000080">nMaxTentativas <b>AS INTEGER

</b>nMaxTentativas </font><font color="#808080">= </font><font color="#FF0000">3
</font><font color="#000080"><b>IF </b>sreg </font><font color="#808080">= </font><font color="#000080">opLivro <b>THEN
  IF </b>ssubreg </font><font color="#808080">= </font><font color="#000080">opEditora <b>THEN
    IF </b>bSoMostrar <b>THEN
       </b>ntam </font><font color="#808080">= </font><font color="#000080">tamReg</font><font color="#808080">(</font><font color="#000080">opEditora</font><font color="#808080">)
       </font><font color="#000080">sRegistro </font><font color="#808080">= </font><font color="#000080">pesqArq</font><font color="#808080">(</font><font color="#000080">tfEditora</font><font color="#808080">, </font><font color="#000080">tLivro</font><font color="#808080">.</font><font color="#000080">codeditora</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">, </font><font color="#000080">ntam</font><font color="#808080">)
    </font><font color="#000080"><b>ELSE
       </b>sRegistro </font><font color="#808080">= </font><font color="#000080">validaEntrada</font><font color="#808080">(</font><font color="#000080">tfEditora</font><font color="#808080">, </font><font color="#000080">ssubreg</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#000080">tLivro</font><font color="#808080">.</font><font color="#000080">codeditora</font><font color="#808080">, </font><font color="#000080">nMaxTentativas</font><font color="#808080">, </font><font color="#000080">false</font><font color="#808080">, </font><font color="#000080">opNumero</font><font color="#808080">)
    </font><font color="#000080"><b>END IF
    IF </b>sRegistro </font><font color="#808080">&lt;&gt; </font><font color="#800000">&quot;&quot; </font><font color="#000080"><b>THEN
      </b>tLivro</font><font color="#808080">.</font><font color="#000080">codeditora </font><font color="#808080">= </font><font color="#000080"><b>Trim</b>$</font><font color="#808080">(</font><font color="#000080"><b>MID</b>$</font><font color="#808080">(</font><font color="#000080">sRegistro</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">))
      </font><font color="#000080"><b>PRINT </b></font><font color="#800000">&quot; &quot; </font><font color="#808080">+ </font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">opEditora</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">);
      </font><font color="#000080"><b>PRINT MID</b>$</font><font color="#808080">(</font><font color="#000080">sRegistro</font><font color="#808080">, </font><font color="#000080">gnPosChave</font><font color="#808080">, </font><font color="#000080">gnTamChave</font><font color="#808080">)
    </font><font color="#000080"><b>END IF
  ELSEIF </b>ssubreg </font><font color="#808080">= </font><font color="#000080">opIdioma <b>THEN
    IF </b>bSoMostrar <b>THEN
       </b>ntam </font><font color="#808080">= </font><font color="#000080">tamReg</font><font color="#808080">(</font><font color="#000080">opIdioma</font><font color="#808080">)
       </font><font color="#000080">sRegistro </font><font color="#808080">= </font><font color="#000080">pesqArq</font><font color="#808080">(</font><font color="#000080">tfIdioma</font><font color="#808080">, </font><font color="#000080">tLivro</font><font color="#808080">.</font><font color="#000080">codidioma</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">, </font><font color="#000080">ntam</font><font color="#808080">)
    </font><font color="#000080"><b>ELSE
       </b>sRegistro </font><font color="#808080">= </font><font color="#000080">validaEntrada</font><font color="#808080">(</font><font color="#000080">tfIdioma</font><font color="#808080">, </font><font color="#000080">ssubreg</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#000080">tLivro</font><font color="#808080">.</font><font color="#000080">codidioma</font><font color="#808080">, </font><font color="#000080">nMaxTentativas</font><font color="#808080">, </font><font color="#000080">false</font><font color="#808080">, </font><font color="#000080">opNumero</font><font color="#808080">)
    </font><font color="#000080"><b>END IF
    IF </b>sRegistro </font><font color="#808080">&lt;&gt; </font><font color="#800000">&quot;&quot; </font><font color="#000080"><b>THEN
      </b>tLivro</font><font color="#808080">.</font><font color="#000080">codidioma </font><font color="#808080">= </font><font color="#000080"><b>Trim</b>$</font><font color="#808080">(</font><font color="#000080"><b>MID</b>$</font><font color="#808080">(</font><font color="#000080">sRegistro</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">))
      </font><font color="#000080"><b>PRINT </b></font><font color="#800000">&quot; &quot; </font><font color="#808080">+ </font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">opIdioma</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">);
      </font><font color="#000080"><b>PRINT MID</b>$</font><font color="#808080">(</font><font color="#000080">sRegistro</font><font color="#808080">, </font><font color="#000080">gnPosChave</font><font color="#808080">, </font><font color="#000080">gnTamChave</font><font color="#808080">)
    </font><font color="#000080"><b>END IF
  END IF
ELSEIF </b>sreg </font><font color="#808080">= </font><font color="#000080">opCliente <b>THEN
  IF </b>ssubreg </font><font color="#808080">= </font><font color="#000080">opEndereco <b>THEN
    IF </b>bSoMostrar <b>THEN
       </b>ntam </font><font color="#808080">= </font><font color="#000080">tamReg</font><font color="#808080">(</font><font color="#000080">opEndereco</font><font color="#808080">)
       </font><font color="#000080">sRegistro </font><font color="#808080">= </font><font color="#000080">pesqArq</font><font color="#808080">(</font><font color="#000080">tfEndereco</font><font color="#808080">, </font><font color="#000080">tCliente</font><font color="#808080">.</font><font color="#000080">codendereco</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">, </font><font color="#000080">ntam</font><font color="#808080">)
    </font><font color="#000080"><b>ELSE
       </b>sRegistro </font><font color="#808080">= </font><font color="#000080">validaEntrada</font><font color="#808080">(</font><font color="#000080">tfEndereco</font><font color="#808080">, </font><font color="#000080">ssubreg</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#000080">tCliente</font><font color="#808080">.</font><font color="#000080">codendereco</font><font color="#808080">, </font><font color="#000080">nMaxTentativas</font><font color="#808080">, </font><font color="#000080">false</font><font color="#808080">, </font><font color="#000080">opNumero</font><font color="#808080">)
    </font><font color="#000080"><b>END IF
    IF </b>sRegistro </font><font color="#808080">&lt;&gt; </font><font color="#800000">&quot;&quot; </font><font color="#000080"><b>THEN
      </b>tCliente</font><font color="#808080">.</font><font color="#000080">codendereco </font><font color="#808080">= </font><font color="#000080"><b>Trim</b>$</font><font color="#808080">(</font><font color="#000080"><b>MID</b>$</font><font color="#808080">(</font><font color="#000080">sRegistro</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">))
      </font><font color="#000080"><b>PRINT </b></font><font color="#800000">&quot; &quot; </font><font color="#808080">+ </font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">opEndereco</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">);
      </font><font color="#000080"><b>PRINT MID</b>$</font><font color="#808080">(</font><font color="#000080">sRegistro</font><font color="#808080">, </font><font color="#000080">gnPosChave</font><font color="#808080">, </font><font color="#000080">gnTamChave</font><font color="#808080">)
      </font><font color="#000080"><b>PRINT </b></font><font color="#800000">&quot; &quot; </font><font color="#808080">+ </font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">opEndereco</font><font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">);
      </font><font color="#000080"><b>PRINT MID</b>$</font><font color="#808080">(</font><font color="#000080">sRegistro</font><font color="#808080">, </font><font color="#000080">gnPosChave</font><font color="#808080">, </font><font color="#000080">gnTamChave</font><font color="#808080">)
      </font><font color="#000080"><b>PRINT </b></font><font color="#800000">&quot; &quot; </font><font color="#808080">+ </font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">opEndereco</font><font color="#808080">, </font><font color="#FF0000">4</font><font color="#808080">);
      </font><font color="#000080"><b>PRINT MID</b>$</font><font color="#808080">(</font><font color="#000080">sRegistro</font><font color="#808080">, </font><font color="#000080">gnPosChave</font><font color="#808080">, </font><font color="#000080">gnTamChave</font><font color="#808080">)
      </font><font color="#000080"><b>PRINT </b></font><font color="#800000">&quot; &quot; </font><font color="#808080">+ </font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">opEndereco</font><font color="#808080">, </font><font color="#FF0000">5</font><font color="#808080">);
      </font><font color="#000080"><b>PRINT MID</b>$</font><font color="#808080">(</font><font color="#000080">sRegistro</font><font color="#808080">, </font><font color="#000080">gnPosChave</font><font color="#808080">, </font><font color="#000080">gnTamChave</font><font color="#808080">)
      </font><font color="#000080"><b>PRINT </b></font><font color="#800000">&quot; &quot; </font><font color="#808080">+ </font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">opEndereco</font><font color="#808080">, </font><font color="#FF0000">6</font><font color="#808080">);
      </font><font color="#000080"><b>PRINT MID</b>$</font><font color="#808080">(</font><font color="#000080">sRegistro</font><font color="#808080">, </font><font color="#000080">gnPosChave</font><font color="#808080">, </font><font color="#000080">gnTamChave</font><font color="#808080">)
    </font><font color="#000080"><b>END IF
  ELSEIF </b>ssubreg </font><font color="#808080">= </font><font color="#000080">opPais <b>THEN
    IF </b>bSoMostrar <b>THEN
       </b>ntam </font><font color="#808080">= </font><font color="#000080">tamReg</font><font color="#808080">(</font><font color="#000080">opPais</font><font color="#808080">)
       </font><font color="#000080">sRegistro </font><font color="#808080">= </font><font color="#000080">pesqArq</font><font color="#808080">(</font><font color="#000080">tfPais</font><font color="#808080">, </font><font color="#000080">tCliente</font><font color="#808080">.</font><font color="#000080">codpais</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">, </font><font color="#000080">ntam</font><font color="#808080">)
    </font><font color="#000080"><b>ELSE
       </b>sRegistro </font><font color="#808080">= </font><font color="#000080">validaEntrada</font><font color="#808080">(</font><font color="#000080">tfPais</font><font color="#808080">, </font><font color="#000080">ssubreg</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#000080">tCliente</font><font color="#808080">.</font><font color="#000080">codpais</font><font color="#808080">, </font><font color="#000080">nMaxTentativas</font><font color="#808080">, </font><font color="#000080">false</font><font color="#808080">, </font><font color="#000080">opTexto</font><font color="#808080">)
    </font><font color="#000080"><b>END IF
    IF </b>sRegistro </font><font color="#808080">&lt;&gt; </font><font color="#800000">&quot;&quot; </font><font color="#000080"><b>THEN
      </b>tCliente</font><font color="#808080">.</font><font color="#000080">codpais </font><font color="#808080">= </font><font color="#000080"><b>Trim</b>$</font><font color="#808080">(</font><font color="#000080"><b>MID</b>$</font><font color="#808080">(</font><font color="#000080">sRegistro</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">))
      </font><font color="#000080"><b>PRINT </b></font><font color="#800000">&quot; &quot; </font><font color="#808080">+ </font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">opPais</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">);
      </font><font color="#000080"><b>PRINT MID</b>$</font><font color="#808080">(</font><font color="#000080">sRegistro</font><font color="#808080">, </font><font color="#000080">gnPosChave</font><font color="#808080">, </font><font color="#000080">gnTamChave</font><font color="#808080">)
    </font><font color="#000080"><b>END IF
  ELSEIF </b>ssubreg </font><font color="#808080">= </font><font color="#000080">opProfissao <b>THEN
    IF </b>bSoMostrar <b>THEN
       </b>ntam </font><font color="#808080">= </font><font color="#000080">tamReg</font><font color="#808080">(</font><font color="#000080">opProfissao</font><font color="#808080">)
       </font><font color="#000080">sRegistro </font><font color="#808080">= </font><font color="#000080">pesqArq</font><font color="#808080">(</font><font color="#000080">tfProfissao</font><font color="#808080">, </font><font color="#000080">tCliente</font><font color="#808080">.</font><font color="#000080">codprofissao</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">, </font><font color="#000080">ntam</font><font color="#808080">)
    </font><font color="#000080"><b>ELSE
       </b>sRegistro </font><font color="#808080">= </font><font color="#000080">validaEntrada</font><font color="#808080">(</font><font color="#000080">tfProfissao</font><font color="#808080">, </font><font color="#000080">ssubreg</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#000080">tCliente</font><font color="#808080">.</font><font color="#000080">codprofissao</font><font color="#808080">, </font><font color="#000080">nMaxTentativas</font><font color="#808080">, </font><font color="#000080">false</font><font color="#808080">, </font><font color="#000080">opNumero</font><font color="#808080">)
    </font><font color="#000080"><b>END IF
    IF </b>sRegistro </font><font color="#808080">&lt;&gt; </font><font color="#800000">&quot;&quot; </font><font color="#000080"><b>THEN
      </b>tCliente</font><font color="#808080">.</font><font color="#000080">codprofissao </font><font color="#808080">= </font><font color="#000080"><b>Trim</b>$</font><font color="#808080">(</font><font color="#000080"><b>MID</b>$</font><font color="#808080">(</font><font color="#000080">sRegistro</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">))
      </font><font color="#000080"><b>PRINT </b></font><font color="#800000">&quot; &quot; </font><font color="#808080">+ </font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">opProfissao</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">);
      </font><font color="#000080"><b>PRINT MID</b>$</font><font color="#808080">(</font><font color="#000080">sRegistro</font><font color="#808080">, </font><font color="#000080">gnPosChave</font><font color="#808080">, </font><font color="#000080">gnTamChave</font><font color="#808080">)
    </font><font color="#000080"><b>END IF
  END IF
ELSEIF </b>sreg </font><font color="#808080">= </font><font color="#000080">opVenda <b>THEN
  </b>ntam </font><font color="#808080">= </font><font color="#000080">tamReg</font><font color="#808080">(</font><font color="#000080">opLivro</font><font color="#808080">)
  </font><font color="#000080">sRegistro </font><font color="#808080">= </font><font color="#000080">pesqArq</font><font color="#808080">(</font><font color="#000080">tfLivro</font><font color="#808080">, </font><font color="#000080">tVenda</font><font color="#808080">.</font><font color="#000080">isbn</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">13</font><font color="#808080">, </font><font color="#000080">ntam</font><font color="#808080">)
  </font><font color="#000080"><b>IF </b>sRegistro </font><font color="#808080">&lt;&gt; </font><font color="#800000">&quot;&quot; </font><font color="#000080"><b>THEN
    PRINT </b></font><font color="#800000">&quot; &quot; </font><font color="#808080">+ </font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">opLivro</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">); <i>' Titulo
    </i></font><font color="#000080"><b>PRINT MID</b>$</font><font color="#808080">(</font><font color="#000080">sRegistro</font><font color="#808080">, </font><font color="#000080">gnPosChave</font><font color="#808080">, </font><font color="#000080">gnTamChave</font><font color="#808080">)
    </font><font color="#000080"><b>PRINT </b></font><font color="#800000">&quot; &quot;</font><font color="#808080">, </font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">opLivro</font><font color="#808080">, </font><font color="#FF0000">9</font><font color="#808080">); <i>' Preco
    </i></font><font color="#000080">sPreco </font><font color="#808080">= </font><font color="#000080"><b>MID</b>$</font><font color="#808080">(</font><font color="#000080">sRegistro</font><font color="#808080">, </font><font color="#000080">gnPosChave</font><font color="#808080">, </font><font color="#000080">gnTamChave</font><font color="#808080">)
    </font><font color="#000080">gnPreco </font><font color="#808080">= </font><font color="#000080"><b>VAL</b></font><font color="#808080">(</font><font color="#000080">sPreco</font><font color="#808080">)
    </font><font color="#000080"><b>PRINT </b>sPreco
  <b>END IF
END IF
END SUB

</b></font><font color="#808080"><i>'------------------------------------------------------------------------------
'Pesquisa um registro atrav‚s de um valor chave num arquivo.
'sArq - o arquivo
'sChave - a chave a ser pesquisada
'nPosChave - a posicao inicial da chave dentro do registro
'nTamChave - o tamanho da chave dentro do registro
'nTamLinha - o tamanho do registro
'retorna - o registro pesquisado
'------------------------------------------------------------------------------
</i></font><font color="#000080"><b>FUNCTION </b>pesqArq$ </font><font color="#808080">(</font><font color="#000080">sArq <b>AS INTEGER</b></font><font color="#808080">, </font><font color="#000080">sChave <b>AS STRING</b></font><font color="#808080">, </font><font color="#000080">nPosChave <b>AS INTEGER</b></font><font color="#808080">, </font><font color="#000080">nTamChave <b>AS INTEGER</b></font><font color="#808080">, </font><font color="#000080">nTamLinha <b>AS INTEGER</b></font><font color="#808080">)
</font><font color="#000080"><b>DIM </b>slinha <b>AS STRING
DIM </b>sres <b>AS STRING
DIM </b>bQuebra <b>AS INTEGER

</b>bQuebra </font><font color="#808080">= </font><font color="#000080">false
<b>SEEK </b>sArq</font><font color="#808080">, </font><font color="#FF0000">1
</font><font color="#000080"><b>DO WHILE </b></font><font color="#808080">(</font><font color="#000080"><b>NOT EOF</b></font><font color="#808080">(</font><font color="#000080">sArq</font><font color="#808080">)) </font><font color="#000080"><b>AND </b></font><font color="#808080">(</font><font color="#000080">bQuebra </font><font color="#808080">= </font><font color="#000080">false</font><font color="#808080">)
  </font><font color="#000080"><b>LINE INPUT </b></font><font color="#800000">#sArq, slinha
  </font><font color="#000080">sres </font><font color="#808080">= </font><font color="#000080"><b>Trim</b>$</font><font color="#808080">(</font><font color="#000080"><b>MID</b>$</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#000080">nPosChave</font><font color="#808080">, </font><font color="#000080">nTamChave</font><font color="#808080">))
  </font><font color="#000080"><b>IF </b>sres </font><font color="#808080">= </font><font color="#000080">sChave <b>THEN
     </b>bQuebra </font><font color="#808080">= </font><font color="#000080">true
  <b>END IF
LOOP
</b>gnPosicao </font><font color="#808080">= </font><font color="#000080"><b>SEEK</b></font><font color="#808080">(</font><font color="#000080">sArq</font><font color="#808080">) - (</font><font color="#000080">nTamLinha </font><font color="#808080">+ </font><font color="#000080">TAMCRLF</font><font color="#808080">)
</font><font color="#000080"><b>IF </b>gnPosicao </font><font color="#808080">&gt; </font><font color="#FF0000">1 </font><font color="#000080"><b>THEN
   SEEK </b>sArq</font><font color="#808080">, </font><font color="#000080">gnPosicao
<b>ELSE
   SEEK </b>sArq</font><font color="#808080">, </font><font color="#FF0000">1
</font><font color="#000080"><b>END IF
IF </b>sres </font><font color="#808080">&lt;&gt; </font><font color="#000080">sChave <b>THEN
   </b>pesqArq </font><font color="#808080">= </font><font color="#800000">&quot;&quot;
</font><font color="#000080"><b>ELSE
   </b>pesqArq </font><font color="#808080">= </font><font color="#000080"><b>MID</b>$</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#000080">nTamLinha</font><font color="#808080">)
</font><font color="#000080"><b>END IF
END FUNCTION

</b></font><font color="#808080"><i>'------------------------------------------------------------------------------
'Pesquisa se tem linha exclu&iexcl;da sen&AElig;o vai para a &pound;ltima linha do arquivo.
'sArq - o arquivo
'nTamLinha - o tamanho do registro
'------------------------------------------------------------------------------
</i></font><font color="#000080"><b>SUB </b>pesqLinhaExcluida </font><font color="#808080">(</font><font color="#000080">sArq <b>AS INTEGER</b></font><font color="#808080">, </font><font color="#000080">nTamLinha <b>AS INTEGER</b></font><font color="#808080">)
</font><font color="#000080"><b>DIM </b>sExcluido <b>AS STRING

</b>sExcluido </font><font color="#808080">= </font><font color="#000080">pesqArq</font><font color="#808080">(</font><font color="#000080">sArq</font><font color="#808080">, </font><font color="#800000">&quot;*&quot;</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#000080">nTamLinha</font><font color="#808080">)
</font><font color="#000080"><b>IF </b>sExcluido </font><font color="#808080">= </font><font color="#800000">&quot;&quot; </font><font color="#000080"><b>THEN
   SEEK </b>sArq</font><font color="#808080">, </font><font color="#000080">tamArq</font><font color="#808080">(</font><font color="#000080">sArq</font><font color="#808080">)
   </font><font color="#000080">gnPosicao </font><font color="#808080">= </font><font color="#000080"><b>SEEK</b></font><font color="#808080">(</font><font color="#000080">sArq</font><font color="#808080">)
</font><font color="#000080"><b>END IF
END SUB

</b></font><font color="#808080"><i>'------------------------------------------------------------------------------
'Pesquisa o maior c&cent;digo num arquivo.
'sArq - o arquivo
'nPosChave - a posicao inicial da chave dentro do registro
'nTamChave - o tamanho da chave dentro do registro
'nTamLinha - o tamanho do registro
'retorna - o maior c&cent;digo
'------------------------------------------------------------------------------
</i></font><font color="#000080"><b>FUNCTION </b>pesqMaxCod$ </font><font color="#808080">(</font><font color="#000080">sArq <b>AS INTEGER</b></font><font color="#808080">, </font><font color="#000080">nPosChave <b>AS INTEGER</b></font><font color="#808080">, </font><font color="#000080">nTamChave <b>AS INTEGER</b></font><font color="#808080">, </font><font color="#000080">nTamLinha <b>AS INTEGER</b></font><font color="#808080">)
</font><font color="#000080"><b>DIM </b>slinha <b>AS STRING
DIM </b>sres <b>AS STRING
DIM </b>bQuebra <b>AS INTEGER
DIM </b>nStatus</font><font color="#808080">, </font><font color="#000080">nMaior</font><font color="#808080">, </font><font color="#000080">nCod <b>AS INTEGER

</b>bQuebra </font><font color="#808080">= </font><font color="#000080">false
nMaior </font><font color="#808080">= </font><font color="#FF0000">0
</font><font color="#000080"><b>SEEK </b>sArq</font><font color="#808080">, </font><font color="#FF0000">1
</font><font color="#000080"><b>DO WHILE </b></font><font color="#808080">(</font><font color="#000080"><b>NOT EOF</b></font><font color="#808080">(</font><font color="#000080">sArq</font><font color="#808080">)) </font><font color="#000080"><b>AND </b></font><font color="#808080">(</font><font color="#000080">bQuebra </font><font color="#808080">= </font><font color="#000080">false</font><font color="#808080">)
  </font><font color="#000080"><b>LINE INPUT </b></font><font color="#800000">#sArq, slinha
  </font><font color="#000080">sres </font><font color="#808080">= </font><font color="#000080"><b>Trim</b>$</font><font color="#808080">(</font><font color="#000080"><b>MID</b>$</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#000080">nPosChave</font><font color="#808080">, </font><font color="#000080">nTamChave</font><font color="#808080">))
  </font><font color="#000080">nCod </font><font color="#808080">= </font><font color="#000080"><b>VAL</b></font><font color="#808080">(</font><font color="#000080">sres</font><font color="#808080">)
  </font><font color="#000080"><b>IF </b>nCod </font><font color="#808080">&gt; </font><font color="#000080">nMaior <b>THEN
     </b>nMaior </font><font color="#808080">= </font><font color="#000080">nCod
  <b>END IF
LOOP
</b>pesqLinhaExcluida sArq</font><font color="#808080">, </font><font color="#000080">nTamLinha
sres </font><font color="#808080">= </font><font color="#000080"><b>STR</b>$</font><font color="#808080">(</font><font color="#000080">nMaior </font><font color="#808080">+ </font><font color="#FF0000">1</font><font color="#808080">)
</font><font color="#000080">pesqMaxCod </font><font color="#808080">= </font><font color="#000080"><b>Trim</b>$</font><font color="#808080">(</font><font color="#000080">sres</font><font color="#808080">)
</font><font color="#000080"><b>END FUNCTION

</b></font><font color="#808080"><i>'------------------------------------------------------------------------------
'Repete um texto um n&pound;mero determinado de vezes.
'sTexto - o texto a ser repetido
'nQtd - a quantidade de vezes
'retorna - o texto repetido
'------------------------------------------------------------------------------
</i></font><font color="#000080"><b>FUNCTION </b>repete$ </font><font color="#808080">(</font><font color="#000080">sTexto <b>AS STRING</b></font><font color="#808080">, </font><font color="#000080">nQtd <b>AS INTEGER</b></font><font color="#808080">)
</font><font color="#000080"><b>DIM </b>nCont <b>AS INTEGER
DIM </b>sret <b>AS STRING

</b>sret </font><font color="#808080">= </font><font color="#800000">&quot;&quot;
</font><font color="#000080"><b>FOR </b>nCont </font><font color="#808080">= </font><font color="#FF0000">1 </font><font color="#000080"><b>TO </b>nQtd
    sret </font><font color="#808080">= </font><font color="#000080">sret </font><font color="#808080">+ </font><font color="#000080">sTexto
<b>NEXT </b>nCont
repete </font><font color="#808080">= </font><font color="#000080">sret
<b>END FUNCTION

</b></font><font color="#808080"><i>'------------------------------------------------------------------------------
'Retorna a Data e a hora do sistema.
'retorna - a data e a hora
'------------------------------------------------------------------------------
</i></font><font color="#000080"><b>FUNCTION </b>retDataHora$
  retDataHora </font><font color="#808080">= </font><font color="#000080"><b>MID</b>$</font><font color="#808080">(</font><font color="#000080"><b>DATE</b>$</font><font color="#808080">, </font><font color="#FF0000">4</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">) + </font><font color="#800000">&quot;/&quot; </font><font color="#808080">+ </font><font color="#000080"><b>LEFT</b>$</font><font color="#808080">(</font><font color="#000080"><b>DATE</b>$</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">) + </font><font color="#800000">&quot;/&quot; </font><font color="#808080">+ </font><font color="#000080"><b>MID</b>$</font><font color="#808080">(</font><font color="#000080"><b>DATE</b>$</font><font color="#808080">, </font><font color="#FF0000">7</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">) + </font><font color="#800000">&quot; &quot; </font><font color="#808080">+ </font><font color="#000080"><b>TIME</b>$
<b>END FUNCTION

</b></font><font color="#808080"><i>'------------------------------------------------------------------------------
'Seleciona o rotulo de cada campo de acordo com o tipo de arquivo.
'sreg - o tipo de arquivo
'nNum - indica qual rotulo ser  retornado
'retorna - o rotulo
'------------------------------------------------------------------------------
</i></font><font color="#000080"><b>FUNCTION </b>rotulo$ </font><font color="#808080">(</font><font color="#000080">sreg <b>AS INTEGER</b></font><font color="#808080">, </font><font color="#000080">nNum <b>AS INTEGER</b></font><font color="#808080">)
</font><font color="#000080"><b>DIM </b>sret <b>AS STRING

</b>sret </font><font color="#808080">= </font><font color="#800000">&quot;&quot;
</font><font color="#000080"><b>IF </b>sreg </font><font color="#808080">= </font><font color="#000080">opAssunto <b>THEN
   SELECT CASE </b>nNum
     <b>CASE </b></font><font color="#FF0000">0
</font>	 <font color="#000080">sret </font><font color="#808080">= </font><font color="#800000">&quot;Assunto(s) n&AElig;o encontrado(s)!&quot;
     </font><font color="#000080"><b>CASE </b></font><font color="#FF0000">1
</font>	 <font color="#000080">sret </font><font color="#808080">= </font><font color="#800000">&quot;C&cent;digo do assunto: &quot;
</font>	 <font color="#000080">gnPosChave </font><font color="#808080">= </font><font color="#FF0000">1
</font>	 <font color="#000080">gnTamChave </font><font color="#808080">= </font><font color="#FF0000">10
     </font><font color="#000080"><b>CASE </b></font><font color="#FF0000">2
</font>	 <font color="#000080">sret </font><font color="#808080">= </font><font color="#800000">&quot;Assunto: &quot;
</font>	 <font color="#000080">gnPosChave </font><font color="#808080">= </font><font color="#FF0000">11
</font>	 <font color="#000080">gnTamChave </font><font color="#808080">= </font><font color="#FF0000">30
   </font><font color="#000080"><b>END SELECT
ELSEIF </b>sreg </font><font color="#808080">= </font><font color="#000080">opAutor <b>THEN
   SELECT CASE </b>nNum
     <b>CASE </b></font><font color="#FF0000">0
</font>	 <font color="#000080">sret </font><font color="#808080">= </font><font color="#800000">&quot;Autor(es) n&AElig;o encontrado(s)!&quot;
     </font><font color="#000080"><b>CASE </b></font><font color="#FF0000">1
</font>	 <font color="#000080">sret </font><font color="#808080">= </font><font color="#800000">&quot;C&cent;digo do autor: &quot;
</font>	 <font color="#000080">gnPosChave </font><font color="#808080">= </font><font color="#FF0000">1
</font>	 <font color="#000080">gnTamChave </font><font color="#808080">= </font><font color="#FF0000">10
     </font><font color="#000080"><b>CASE </b></font><font color="#FF0000">2
</font>	 <font color="#000080">sret </font><font color="#808080">= </font><font color="#800000">&quot;Autor: &quot;
</font>	 <font color="#000080">gnPosChave </font><font color="#808080">= </font><font color="#FF0000">11
</font>	 <font color="#000080">gnTamChave </font><font color="#808080">= </font><font color="#FF0000">30
   </font><font color="#000080"><b>END SELECT
ELSEIF </b>sreg </font><font color="#808080">= </font><font color="#000080">opEditora <b>THEN
   SELECT CASE </b>nNum
     <b>CASE </b></font><font color="#FF0000">0
</font>	 <font color="#000080">sret </font><font color="#808080">= </font><font color="#800000">&quot;Editora(s) n&AElig;o encontrada(s)!&quot;
     </font><font color="#000080"><b>CASE </b></font><font color="#FF0000">1
</font>	 <font color="#000080">sret </font><font color="#808080">= </font><font color="#800000">&quot;C&cent;digo da editora: &quot;
</font>	 <font color="#000080">gnPosChave </font><font color="#808080">= </font><font color="#FF0000">1
</font>	 <font color="#000080">gnTamChave </font><font color="#808080">= </font><font color="#FF0000">10
     </font><font color="#000080"><b>CASE </b></font><font color="#FF0000">2
</font>	 <font color="#000080">sret </font><font color="#808080">= </font><font color="#800000">&quot;Editora: &quot;
</font>	 <font color="#000080">gnPosChave </font><font color="#808080">= </font><font color="#FF0000">11
</font>	 <font color="#000080">gnTamChave </font><font color="#808080">= </font><font color="#FF0000">50
   </font><font color="#000080"><b>END SELECT
ELSEIF </b>sreg </font><font color="#808080">= </font><font color="#000080">opEndereco <b>THEN
   SELECT CASE </b>nNum
     <b>CASE </b></font><font color="#FF0000">0
</font>	 <font color="#000080">sret </font><font color="#808080">= </font><font color="#800000">&quot;Endere‡o(s) n&AElig;o encontrado(s)!&quot;
     </font><font color="#000080"><b>CASE </b></font><font color="#FF0000">1
</font>	 <font color="#000080">sret </font><font color="#808080">= </font><font color="#800000">&quot;C&cent;digo do endere‡o: &quot;
</font>	 <font color="#000080">gnPosChave </font><font color="#808080">= </font><font color="#FF0000">1
</font>	 <font color="#000080">gnTamChave </font><font color="#808080">= </font><font color="#FF0000">10
     </font><font color="#000080"><b>CASE </b></font><font color="#FF0000">2
</font>	 <font color="#000080">sret </font><font color="#808080">= </font><font color="#800000">&quot;Logradouro: &quot;
</font>	 <font color="#000080">gnPosChave </font><font color="#808080">= </font><font color="#FF0000">11
</font>	 <font color="#000080">gnTamChave </font><font color="#808080">= </font><font color="#FF0000">40
     </font><font color="#000080"><b>CASE </b></font><font color="#FF0000">3
</font>	 <font color="#000080">sret </font><font color="#808080">= </font><font color="#800000">&quot;Bairro: &quot;
</font>	 <font color="#000080">gnPosChave </font><font color="#808080">= </font><font color="#FF0000">51
</font>	 <font color="#000080">gnTamChave </font><font color="#808080">= </font><font color="#FF0000">15
     </font><font color="#000080"><b>CASE </b></font><font color="#FF0000">4
</font>	 <font color="#000080">sret </font><font color="#808080">= </font><font color="#800000">&quot;CEP: &quot;
</font>	 <font color="#000080">gnPosChave </font><font color="#808080">= </font><font color="#FF0000">66
</font>	 <font color="#000080">gnTamChave </font><font color="#808080">= </font><font color="#FF0000">8
     </font><font color="#000080"><b>CASE </b></font><font color="#FF0000">5
</font>	 <font color="#000080">sret </font><font color="#808080">= </font><font color="#800000">&quot;Cidade: &quot;
</font>	 <font color="#000080">gnPosChave </font><font color="#808080">= </font><font color="#FF0000">74
</font>	 <font color="#000080">gnTamChave </font><font color="#808080">= </font><font color="#FF0000">30
     </font><font color="#000080"><b>CASE </b></font><font color="#FF0000">6
</font>	 <font color="#000080">sret </font><font color="#808080">= </font><font color="#800000">&quot;Estado: &quot;
</font>	 <font color="#000080">gnPosChave </font><font color="#808080">= </font><font color="#FF0000">104
</font>	 <font color="#000080">gnTamChave </font><font color="#808080">= </font><font color="#FF0000">20
   </font><font color="#000080"><b>END SELECT
ELSEIF </b>sreg </font><font color="#808080">= </font><font color="#000080">opIdioma <b>THEN
   SELECT CASE </b>nNum
     <b>CASE </b></font><font color="#FF0000">0
</font>	 <font color="#000080">sret </font><font color="#808080">= </font><font color="#800000">&quot;Idioma(s) n&AElig;o encontrado(s)!&quot;
     </font><font color="#000080"><b>CASE </b></font><font color="#FF0000">1
</font>	 <font color="#000080">sret </font><font color="#808080">= </font><font color="#800000">&quot;C&cent;digo do idioma: &quot;
</font>	 <font color="#000080">gnPosChave </font><font color="#808080">= </font><font color="#FF0000">1
</font>	 <font color="#000080">gnTamChave </font><font color="#808080">= </font><font color="#FF0000">10
     </font><font color="#000080"><b>CASE </b></font><font color="#FF0000">2
</font>	 <font color="#000080">sret </font><font color="#808080">= </font><font color="#800000">&quot;Idioma: &quot;
</font>	 <font color="#000080">gnPosChave </font><font color="#808080">= </font><font color="#FF0000">11
</font>	 <font color="#000080">gnTamChave </font><font color="#808080">= </font><font color="#FF0000">20
   </font><font color="#000080"><b>END SELECT
ELSEIF </b>sreg </font><font color="#808080">= </font><font color="#000080">opPais <b>THEN
   SELECT CASE </b>nNum
     <b>CASE </b></font><font color="#FF0000">0
</font>	 <font color="#000080">sret </font><font color="#808080">= </font><font color="#800000">&quot;Pa&iexcl;s(es) n&AElig;o encontrado(s)!&quot;
     </font><font color="#000080"><b>CASE </b></font><font color="#FF0000">1
</font>	 <font color="#000080">sret </font><font color="#808080">= </font><font color="#800000">&quot;C&cent;digo do pa&iexcl;s: &quot;
</font>	 <font color="#000080">gnPosChave </font><font color="#808080">= </font><font color="#FF0000">1
</font>	 <font color="#000080">gnTamChave </font><font color="#808080">= </font><font color="#FF0000">3
     </font><font color="#000080"><b>CASE </b></font><font color="#FF0000">2
</font>	 <font color="#000080">sret </font><font color="#808080">= </font><font color="#800000">&quot;Pa&iexcl;s: &quot;
</font>	 <font color="#000080">gnPosChave </font><font color="#808080">= </font><font color="#FF0000">4
</font>	 <font color="#000080">gnTamChave </font><font color="#808080">= </font><font color="#FF0000">50
   </font><font color="#000080"><b>END SELECT
ELSEIF </b>sreg </font><font color="#808080">= </font><font color="#000080">opProfissao <b>THEN
   SELECT CASE </b>nNum
     <b>CASE </b></font><font color="#FF0000">0
</font>	 <font color="#000080">sret </font><font color="#808080">= </font><font color="#800000">&quot;Profiss&AElig;o(es) n&AElig;o encontrada(s)!&quot;
     </font><font color="#000080"><b>CASE </b></font><font color="#FF0000">1
</font>	 <font color="#000080">sret </font><font color="#808080">= </font><font color="#800000">&quot;C&cent;digo da profiss&AElig;o: &quot;
</font>	 <font color="#000080">gnPosChave </font><font color="#808080">= </font><font color="#FF0000">1
</font>	 <font color="#000080">gnTamChave </font><font color="#808080">= </font><font color="#FF0000">10
     </font><font color="#000080"><b>CASE </b></font><font color="#FF0000">2
</font>	 <font color="#000080">sret </font><font color="#808080">= </font><font color="#800000">&quot;Profiss&AElig;o: &quot;
</font>	 <font color="#000080">gnPosChave </font><font color="#808080">= </font><font color="#FF0000">11
</font>	 <font color="#000080">gnTamChave </font><font color="#808080">= </font><font color="#FF0000">50
   </font><font color="#000080"><b>END SELECT
ELSEIF </b>sreg </font><font color="#808080">= </font><font color="#000080">opUsuario <b>THEN
   SELECT CASE </b>nNum
     <b>CASE </b></font><font color="#FF0000">0
</font>	 <font color="#000080">sret </font><font color="#808080">= </font><font color="#800000">&quot;login ou senha incorreta, tente de novo!&quot;
     </font><font color="#000080"><b>CASE </b></font><font color="#FF0000">1
</font>	 <font color="#000080">sret </font><font color="#808080">= </font><font color="#800000">&quot;Login: &quot;
</font>	 <font color="#000080">gnPosChave </font><font color="#808080">= </font><font color="#FF0000">1
</font>	 <font color="#000080">gnTamChave </font><font color="#808080">= </font><font color="#FF0000">10
     </font><font color="#000080"><b>CASE </b></font><font color="#FF0000">2
</font>	 <font color="#000080">sret </font><font color="#808080">= </font><font color="#800000">&quot;Senha: &quot;
</font>	 <font color="#000080">gnPosChave </font><font color="#808080">= </font><font color="#FF0000">11
</font>	 <font color="#000080">gnTamChave </font><font color="#808080">= </font><font color="#FF0000">10
   </font><font color="#000080"><b>END SELECT
ELSEIF </b>sreg </font><font color="#808080">= </font><font color="#000080">opLivro <b>THEN
   SELECT CASE </b>nNum
     <b>CASE </b></font><font color="#FF0000">0
</font>	 <font color="#000080">sret </font><font color="#808080">= </font><font color="#800000">&quot;Livro(s) n&AElig;o encontrado(s)!&quot;
     </font><font color="#000080"><b>CASE </b></font><font color="#FF0000">1
</font>	 <font color="#000080">sret </font><font color="#808080">= </font><font color="#800000">&quot;ISBN: &quot;
</font>	 <font color="#000080">gnPosChave </font><font color="#808080">= </font><font color="#FF0000">1
</font>	 <font color="#000080">gnTamChave </font><font color="#808080">= </font><font color="#FF0000">13
     </font><font color="#000080"><b>CASE </b></font><font color="#FF0000">2
</font>	 <font color="#000080">sret </font><font color="#808080">= </font><font color="#800000">&quot;T&iexcl;tulo: &quot;
</font>	 <font color="#000080">gnPosChave </font><font color="#808080">= </font><font color="#FF0000">14
</font>	 <font color="#000080">gnTamChave </font><font color="#808080">= </font><font color="#FF0000">50
     </font><font color="#000080"><b>CASE </b></font><font color="#FF0000">3
</font>	 <font color="#000080">sret </font><font color="#808080">= </font><font color="#800000">&quot;Edi‡&AElig;o: &quot;
</font>	 <font color="#000080">gnPosChave </font><font color="#808080">= </font><font color="#FF0000">64
</font>	 <font color="#000080">gnTamChave </font><font color="#808080">= </font><font color="#FF0000">10
     </font><font color="#000080"><b>CASE </b></font><font color="#FF0000">4
</font>	 <font color="#000080">sret </font><font color="#808080">= </font><font color="#800000">&quot;Ano de Publica‡&AElig;o: &quot;
</font>	 <font color="#000080">gnPosChave </font><font color="#808080">= </font><font color="#FF0000">74
</font>	 <font color="#000080">gnTamChave </font><font color="#808080">= </font><font color="#FF0000">10
     </font><font color="#000080"><b>CASE </b></font><font color="#FF0000">5
</font>	 <font color="#000080">sret </font><font color="#808080">= </font><font color="#800000">&quot;C&cent;digo da editora: &quot;
</font>	 <font color="#000080">gnPosChave </font><font color="#808080">= </font><font color="#FF0000">84
</font>	 <font color="#000080">gnTamChave </font><font color="#808080">= </font><font color="#FF0000">10
     </font><font color="#000080"><b>CASE </b></font><font color="#FF0000">6
</font>	 <font color="#000080">sret </font><font color="#808080">= </font><font color="#800000">&quot;Volume: &quot;
</font>	 <font color="#000080">gnPosChave </font><font color="#808080">= </font><font color="#FF0000">94
</font>	 <font color="#000080">gnTamChave </font><font color="#808080">= </font><font color="#FF0000">10
     </font><font color="#000080"><b>CASE </b></font><font color="#FF0000">7
</font>	 <font color="#000080">sret </font><font color="#808080">= </font><font color="#800000">&quot;C&cent;digo do idioma: &quot;
</font>	 <font color="#000080">gnPosChave </font><font color="#808080">= </font><font color="#FF0000">104
</font>	 <font color="#000080">gnTamChave </font><font color="#808080">= </font><font color="#FF0000">10
     </font><font color="#000080"><b>CASE </b></font><font color="#FF0000">8
</font>	 <font color="#000080">sret </font><font color="#808080">= </font><font color="#800000">&quot;N&pound;mero de p ginas: &quot;
</font>	 <font color="#000080">gnPosChave </font><font color="#808080">= </font><font color="#FF0000">114
</font>	 <font color="#000080">gnTamChave </font><font color="#808080">= </font><font color="#FF0000">10
     </font><font color="#000080"><b>CASE </b></font><font color="#FF0000">9
</font>	 <font color="#000080">sret </font><font color="#808080">= </font><font color="#800000">&quot;Pre‡o: &quot;
</font>	 <font color="#000080">gnPosChave </font><font color="#808080">= </font><font color="#FF0000">124
</font>	 <font color="#000080">gnTamChave </font><font color="#808080">= </font><font color="#FF0000">10
     </font><font color="#000080"><b>CASE </b></font><font color="#FF0000">10
</font>	  <font color="#000080">sret </font><font color="#808080">= </font><font color="#800000">&quot;Qtd. Estoque: &quot;
</font>	  <font color="#000080">gnPosChave </font><font color="#808080">= </font><font color="#FF0000">134
</font>	  <font color="#000080">gnTamChave </font><font color="#808080">= </font><font color="#FF0000">10
   </font><font color="#000080"><b>END SELECT
ELSEIF </b>sreg </font><font color="#808080">= </font><font color="#000080">opLivroAss <b>THEN
   SELECT CASE </b>nNum
     <b>CASE </b></font><font color="#FF0000">0
</font>	 <font color="#000080">sret </font><font color="#808080">= </font><font color="#800000">&quot;Assunto(s) n&AElig;o encontrado(s)!&quot;
     </font><font color="#000080"><b>CASE </b></font><font color="#FF0000">1
</font>	 <font color="#000080">sret </font><font color="#808080">= </font><font color="#800000">&quot;ISBN: &quot;
</font>	 <font color="#000080">gnPosChave </font><font color="#808080">= </font><font color="#FF0000">1
</font>	 <font color="#000080">gnTamChave </font><font color="#808080">= </font><font color="#FF0000">13
     </font><font color="#000080"><b>CASE </b></font><font color="#FF0000">2
</font>	 <font color="#000080">sret </font><font color="#808080">= </font><font color="#800000">&quot;C&cent;digo do assunto: &quot;
</font>	 <font color="#000080">gnPosChave </font><font color="#808080">= </font><font color="#FF0000">14
</font>	 <font color="#000080">gnTamChave </font><font color="#808080">= </font><font color="#FF0000">10
   </font><font color="#000080"><b>END SELECT
ELSEIF </b>sreg </font><font color="#808080">= </font><font color="#000080">opLivroAut <b>THEN
   SELECT CASE </b>nNum
     <b>CASE </b></font><font color="#FF0000">0
</font>	 <font color="#000080">sret </font><font color="#808080">= </font><font color="#800000">&quot;Autor(s) n&AElig;o encontrado(s)!&quot;
     </font><font color="#000080"><b>CASE </b></font><font color="#FF0000">1
</font>	 <font color="#000080">sret </font><font color="#808080">= </font><font color="#800000">&quot;ISBN: &quot;
</font>	 <font color="#000080">gnPosChave </font><font color="#808080">= </font><font color="#FF0000">1
</font>	 <font color="#000080">gnTamChave </font><font color="#808080">= </font><font color="#FF0000">13
     </font><font color="#000080"><b>CASE </b></font><font color="#FF0000">2
</font>	 <font color="#000080">sret </font><font color="#808080">= </font><font color="#800000">&quot;C&cent;digo do autor: &quot;
</font>	 <font color="#000080">gnPosChave </font><font color="#808080">= </font><font color="#FF0000">14
</font>	 <font color="#000080">gnTamChave </font><font color="#808080">= </font><font color="#FF0000">10
   </font><font color="#000080"><b>END SELECT
ELSEIF </b>sreg </font><font color="#808080">= </font><font color="#000080">opCliente <b>THEN
   SELECT CASE </b>nNum
     <b>CASE </b></font><font color="#FF0000">0
</font>	 <font color="#000080">sret </font><font color="#808080">= </font><font color="#800000">&quot;Cliente(s) n&AElig;o encontrado(s)!&quot;
     </font><font color="#000080"><b>CASE </b></font><font color="#FF0000">1
</font>	 <font color="#000080">sret </font><font color="#808080">= </font><font color="#800000">&quot;CPF: &quot;
</font>	 <font color="#000080">gnPosChave </font><font color="#808080">= </font><font color="#FF0000">1
</font>	 <font color="#000080">gnTamChave </font><font color="#808080">= </font><font color="#FF0000">14
     </font><font color="#000080"><b>CASE </b></font><font color="#FF0000">2
</font>	 <font color="#000080">sret </font><font color="#808080">= </font><font color="#800000">&quot;Nome: &quot;
</font>	 <font color="#000080">gnPosChave </font><font color="#808080">= </font><font color="#FF0000">15
</font>	 <font color="#000080">gnTamChave </font><font color="#808080">= </font><font color="#FF0000">30
     </font><font color="#000080"><b>CASE </b></font><font color="#FF0000">3
</font>	 <font color="#000080">sret </font><font color="#808080">= </font><font color="#800000">&quot;E-mail: &quot;
</font>	 <font color="#000080">gnPosChave </font><font color="#808080">= </font><font color="#FF0000">45
</font>	 <font color="#000080">gnTamChave </font><font color="#808080">= </font><font color="#FF0000">30
     </font><font color="#000080"><b>CASE </b></font><font color="#FF0000">4
</font>	 <font color="#000080">sret </font><font color="#808080">= </font><font color="#800000">&quot;Identidade: &quot;
</font>	 <font color="#000080">gnPosChave </font><font color="#808080">= </font><font color="#FF0000">75
</font>	 <font color="#000080">gnTamChave </font><font color="#808080">= </font><font color="#FF0000">10
     </font><font color="#000080"><b>CASE </b></font><font color="#FF0000">5
</font>	 <font color="#000080">sret </font><font color="#808080">= </font><font color="#800000">&quot;Sexo: &quot;
</font>	 <font color="#000080">gnPosChave </font><font color="#808080">= </font><font color="#FF0000">85
</font>	 <font color="#000080">gnTamChave </font><font color="#808080">= </font><font color="#FF0000">1
     </font><font color="#000080"><b>CASE </b></font><font color="#FF0000">6
</font>	 <font color="#000080">sret </font><font color="#808080">= </font><font color="#800000">&quot;Telefone: &quot;
</font>	 <font color="#000080">gnPosChave </font><font color="#808080">= </font><font color="#FF0000">86
</font>	 <font color="#000080">gnTamChave </font><font color="#808080">= </font><font color="#FF0000">17
     </font><font color="#000080"><b>CASE </b></font><font color="#FF0000">7
</font>	 <font color="#000080">sret </font><font color="#808080">= </font><font color="#800000">&quot;Dt. Nascimento: &quot;
</font>	 <font color="#000080">gnPosChave </font><font color="#808080">= </font><font color="#FF0000">103
</font>	 <font color="#000080">gnTamChave </font><font color="#808080">= </font><font color="#FF0000">10
     </font><font color="#000080"><b>CASE </b></font><font color="#FF0000">8
</font>	 <font color="#000080">sret </font><font color="#808080">= </font><font color="#800000">&quot;C&cent;digo do endere‡o: &quot;
</font>	 <font color="#000080">gnPosChave </font><font color="#808080">= </font><font color="#FF0000">113
</font>	 <font color="#000080">gnTamChave </font><font color="#808080">= </font><font color="#FF0000">10
     </font><font color="#000080"><b>CASE </b></font><font color="#FF0000">9
</font>	 <font color="#000080">sret </font><font color="#808080">= </font><font color="#800000">&quot;C&cent;digo do pa&iexcl;s: &quot;
</font>	 <font color="#000080">gnPosChave </font><font color="#808080">= </font><font color="#FF0000">123
</font>	 <font color="#000080">gnTamChave </font><font color="#808080">= </font><font color="#FF0000">3
     </font><font color="#000080"><b>CASE </b></font><font color="#FF0000">10
</font>	  <font color="#000080">sret </font><font color="#808080">= </font><font color="#800000">&quot;C&cent;digo da Profiss&AElig;o: &quot;
</font>	  <font color="#000080">gnPosChave </font><font color="#808080">= </font><font color="#FF0000">126
</font>	  <font color="#000080">gnTamChave </font><font color="#808080">= </font><font color="#FF0000">10
   </font><font color="#000080"><b>END SELECT
ELSEIF </b>sreg </font><font color="#808080">= </font><font color="#000080">opVenda <b>THEN
   SELECT CASE </b>nNum
     <b>CASE </b></font><font color="#FF0000">0
</font>	 <font color="#000080">sret </font><font color="#808080">= </font><font color="#800000">&quot;Venda(s) n&AElig;o encontrada(s)!&quot;
     </font><font color="#000080"><b>CASE </b></font><font color="#FF0000">1
</font>	 <font color="#000080">sret </font><font color="#808080">= </font><font color="#800000">&quot;Data/Hora venda: &quot;
</font>	 <font color="#000080">gnPosChave </font><font color="#808080">= </font><font color="#FF0000">1
</font>	 <font color="#000080">gnTamChave </font><font color="#808080">= </font><font color="#FF0000">19
     </font><font color="#000080"><b>CASE </b></font><font color="#FF0000">2
</font>	 <font color="#000080">sret </font><font color="#808080">= </font><font color="#800000">&quot;CPF: &quot;
</font>	 <font color="#000080">gnPosChave </font><font color="#808080">= </font><font color="#FF0000">20
</font>	 <font color="#000080">gnTamChave </font><font color="#808080">= </font><font color="#FF0000">14
     </font><font color="#000080"><b>CASE </b></font><font color="#FF0000">3
</font>	 <font color="#000080">sret </font><font color="#808080">= </font><font color="#800000">&quot;ISBN: &quot;
</font>	 <font color="#000080">gnPosChave </font><font color="#808080">= </font><font color="#FF0000">34
</font>	 <font color="#000080">gnTamChave </font><font color="#808080">= </font><font color="#FF0000">13
     </font><font color="#000080"><b>CASE </b></font><font color="#FF0000">4
</font>	 <font color="#000080">sret </font><font color="#808080">= </font><font color="#800000">&quot;Pre+o de venda: &quot;
</font>	 <font color="#000080">gnPosChave </font><font color="#808080">= </font><font color="#FF0000">47
</font>	 <font color="#000080">gnTamChave </font><font color="#808080">= </font><font color="#FF0000">10
   </font><font color="#000080"><b>END SELECT
END IF

</b>rotulo </font><font color="#808080">= </font><font color="#000080">sret
<b>END FUNCTION

</b></font><font color="#808080"><i>'------------------------------------------------------------------------------
'Faz uma pesquisa relativa de um texto atrav‚s de um valor chave.
'sTexto - o texto
'sChave - a chave a ser pesquisada
'retorna - se achou ou n&AElig;o a chave dentro do texto
'------------------------------------------------------------------------------
</i></font><font color="#000080"><b>FUNCTION </b>strRelativa! </font><font color="#808080">(</font><font color="#000080">sTexto <b>AS STRING</b></font><font color="#808080">, </font><font color="#000080">sChave <b>AS STRING</b></font><font color="#808080">)
</font><font color="#000080"><b>DIM </b>nCont</font><font color="#808080">, </font><font color="#000080">nTamChave</font><font color="#808080">, </font><font color="#000080">nTamTexto <b>AS INTEGER
DIM </b>bret <b>AS INTEGER
DIM </b>sPedaco <b>AS STRING

</b>bret </font><font color="#808080">= </font><font color="#000080">false
nCont </font><font color="#808080">= </font><font color="#FF0000">1
</font><font color="#000080">nTamChave </font><font color="#808080">= </font><font color="#000080"><b>LEN</b></font><font color="#808080">(</font><font color="#000080">sChave</font><font color="#808080">)
</font><font color="#000080">nTamTexto </font><font color="#808080">= </font><font color="#000080"><b>LEN</b></font><font color="#808080">(</font><font color="#000080">sTexto</font><font color="#808080">)
</font><font color="#000080"><b>IF </b>nTamChave </font><font color="#808080">&lt;= </font><font color="#000080">nTamTexto <b>THEN
  DO WHILE </b>nCont </font><font color="#808080">&lt;= (</font><font color="#000080">nTamTexto </font><font color="#808080">- </font><font color="#000080">nTamChave </font><font color="#808080">+ </font><font color="#FF0000">1</font><font color="#808080">)
     </font><font color="#000080">sPedaco </font><font color="#808080">= </font><font color="#000080"><b>MID</b>$</font><font color="#808080">(</font><font color="#000080">sTexto</font><font color="#808080">, </font><font color="#000080">nCont</font><font color="#808080">, </font><font color="#000080">nTamChave</font><font color="#808080">)
     </font><font color="#000080"><b>IF </b>sPedaco </font><font color="#808080">= </font><font color="#000080">sChave <b>THEN
</b></font>	<font color="#000080">bret </font><font color="#808080">= </font><font color="#000080">true
     <b>END IF
     </b>nCont </font><font color="#808080">= </font><font color="#000080">nCont </font><font color="#808080">+ </font><font color="#FF0000">1
  </font><font color="#000080"><b>LOOP
END IF
</b>strRelativa </font><font color="#808080">= </font><font color="#000080">bret
<b>END FUNCTION

</b></font><font color="#808080"><i>'------------------------------------------------------------------------------
'Seleciona o menu e/ou a tela certa de acordo com o tipo de arquivo.
'nmenu - o n&pound;mero do menu
'sreg - o tipo de arquivo
'------------------------------------------------------------------------------
</i></font><font color="#000080"><b>SUB </b>subMenu </font><font color="#808080">(</font><font color="#000080">nmenu <b>AS INTEGER</b></font><font color="#808080">, </font><font color="#000080">sreg <b>AS INTEGER</b></font><font color="#808080">)
</font><font color="#000080"><b>DIM </b>opSubMenu <b>AS INTEGER
DIM </b>opCSubMenu <b>AS STRING
DIM </b>bSOp <b>AS INTEGER

</b>bSOp </font><font color="#808080">= </font><font color="#000080">true
<b>SELECT CASE </b>nmenu
 <b>CASE </b></font><font color="#FF0000">6
    </font><font color="#000080"><b>DO WHILE </b>bSOp
     menu </font><font color="#808080">(</font><font color="#000080">nmenu</font><font color="#808080">)
     </font><font color="#000080"><b>INPUT </b></font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#000080">opSubMenu
     <b>SELECT CASE </b>opSubMenu
       <b>CASE </b></font><font color="#FF0000">1
</font>	 <font color="#000080">frmCadastros sreg</font><font color="#808080">, </font><font color="#000080">opNovo
       <b>CASE </b></font><font color="#FF0000">2
</font>	 <font color="#000080">frmCadastros sreg</font><font color="#808080">, </font><font color="#000080">opPesquisar
       <b>CASE </b></font><font color="#FF0000">3
</font>	 <font color="#000080">bSOp </font><font color="#808080">= </font><font color="#000080">false
       <b>CASE ELSE
</b></font>	 <font color="#000080"><b>PRINT </b>MSGERRO
     <b>END SELECT
    LOOP
 CASE </b></font><font color="#FF0000">7
    </font><font color="#000080"><b>DO WHILE </b>bSOp
     menu </font><font color="#808080">(</font><font color="#000080">nmenu</font><font color="#808080">)
     </font><font color="#000080"><b>INPUT </b></font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#000080">opSubMenu
     <b>SELECT CASE </b>opSubMenu
       <b>CASE </b></font><font color="#FF0000">1
</font>	 <font color="#000080">btnAcao sreg</font><font color="#808080">, </font><font color="#000080">opSalvarInclusao
</font>	 <font color="#000080">bSOp </font><font color="#808080">= </font><font color="#000080">false
       <b>CASE </b></font><font color="#FF0000">2
</font>	 <font color="#000080">bSOp </font><font color="#808080">= </font><font color="#000080">false
       <b>CASE ELSE
</b></font>	 <font color="#000080"><b>PRINT </b>MSGERRO
     <b>END SELECT
    LOOP
 CASE </b></font><font color="#FF0000">8
    </font><font color="#000080"><b>DO WHILE </b>bSOp
     menu </font><font color="#808080">(</font><font color="#000080">nmenu</font><font color="#808080">)
     </font><font color="#000080"><b>INPUT </b></font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#000080">opSubMenu
     <b>SELECT CASE </b>opSubMenu
       <b>CASE </b></font><font color="#FF0000">1
</font>	 <font color="#000080">frmCadastros sreg</font><font color="#808080">, </font><font color="#000080">opAlterar
</font>	 <font color="#000080">bSOp </font><font color="#808080">= </font><font color="#000080">false
       <b>CASE </b></font><font color="#FF0000">2
</font>	 <font color="#000080">frmCadastros sreg</font><font color="#808080">, </font><font color="#000080">opExcluir
</font>	 <font color="#000080">bSOp </font><font color="#808080">= </font><font color="#000080">false
       <b>CASE </b></font><font color="#FF0000">3
</font>	 <font color="#000080">bSOp </font><font color="#808080">= </font><font color="#000080">false
       <b>CASE ELSE
</b></font>	 <font color="#000080"><b>PRINT </b>MSGERRO
     <b>END SELECT
    LOOP
 CASE </b></font><font color="#FF0000">9
    </font><font color="#000080"><b>DO WHILE </b>bSOp
     menu nmenu
     <b>INPUT </b></font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#000080">opSubMenu
     <b>SELECT CASE </b>opSubMenu
       <b>CASE </b></font><font color="#FF0000">1
</font>	 <font color="#000080">btnAcao sreg</font><font color="#808080">, </font><font color="#000080">opSalvarAlteracao
</font>	 <font color="#000080">bSOp </font><font color="#808080">= </font><font color="#000080">false
       <b>CASE </b></font><font color="#FF0000">2
</font>	 <font color="#000080">bSOp </font><font color="#808080">= </font><font color="#000080">false
       <b>CASE ELSE
</b></font>	 <font color="#000080"><b>PRINT </b>MSGERRO
     <b>END SELECT
    LOOP
 CASE </b></font><font color="#FF0000">10
    </font><font color="#000080"><b>DO WHILE </b>bSOp
     menu </font><font color="#808080">(</font><font color="#000080">nmenu</font><font color="#808080">)
     </font><font color="#000080"><b>INPUT </b></font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#000080">opCSubMenu
     <b>IF </b></font><font color="#808080">(</font><font color="#000080">opCSubMenu </font><font color="#808080">= </font><font color="#800000">&quot;S&quot;</font><font color="#808080">) </font><font color="#000080"><b>OR </b></font><font color="#808080">(</font><font color="#000080">opCSubMenu </font><font color="#808080">= </font><font color="#800000">&quot;s&quot;</font><font color="#808080">) </font><font color="#000080"><b>THEN
</b></font>	<font color="#000080">btnAcao sreg</font><font color="#808080">, </font><font color="#000080">opConfirmaExclusao
</font>	<font color="#000080">bSOp </font><font color="#808080">= </font><font color="#000080">false
     <b>ELSEIF </b></font><font color="#808080">(</font><font color="#000080">opCSubMenu </font><font color="#808080">= </font><font color="#800000">&quot;N&quot;</font><font color="#808080">) </font><font color="#000080"><b>OR </b></font><font color="#808080">(</font><font color="#000080">opCSubMenu </font><font color="#808080">= </font><font color="#800000">&quot;n&quot;</font><font color="#808080">) </font><font color="#000080"><b>THEN </b>bSOp </font><font color="#808080">= </font><font color="#000080">false
     <b>ELSE PRINT </b>MSGERRO
     <b>END IF
    LOOP
 CASE </b></font><font color="#FF0000">12
    </font><font color="#000080"><b>DO WHILE </b>bSOp
     menu </font><font color="#808080">(</font><font color="#000080">nmenu</font><font color="#808080">)
     </font><font color="#000080"><b>INPUT </b></font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#000080">opSubMenu
     <b>SELECT CASE </b>opSubMenu
       <b>CASE </b></font><font color="#FF0000">1
</font>	 <font color="#000080">frmConsultas sreg</font><font color="#808080">, </font><font color="#000080">opPesquisar
       <b>CASE </b></font><font color="#FF0000">2
</font>	 <font color="#000080">frmConsultas sreg</font><font color="#808080">, </font><font color="#000080">opListarTodos
       <b>CASE </b></font><font color="#FF0000">3
</font>	 <font color="#000080">bSOp </font><font color="#808080">= </font><font color="#000080">false
       <b>CASE ELSE
</b></font>	 <font color="#000080"><b>PRINT </b>MSGERRO
     <b>END SELECT
    LOOP
 CASE </b></font><font color="#FF0000">14
    </font><font color="#000080"><b>DO WHILE </b>bSOp
     menu </font><font color="#808080">(</font><font color="#000080">nmenu</font><font color="#808080">)
     </font><font color="#000080"><b>INPUT </b></font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#000080">opCSubMenu
     <b>IF </b></font><font color="#808080">(</font><font color="#000080">opCSubMenu </font><font color="#808080">= </font><font color="#800000">&quot;S&quot;</font><font color="#808080">) </font><font color="#000080"><b>OR </b></font><font color="#808080">(</font><font color="#000080">opCSubMenu </font><font color="#808080">= </font><font color="#800000">&quot;s&quot;</font><font color="#808080">) </font><font color="#000080"><b>THEN
</b></font>	<font color="#000080">btnAcao sreg</font><font color="#808080">, </font><font color="#000080">opSalvarInclusao
</font>	<font color="#000080">bSOp </font><font color="#808080">= </font><font color="#000080">false
</font>	<font color="#000080">gSalvarInclusao </font><font color="#808080">= </font><font color="#000080">true
     <b>ELSEIF </b></font><font color="#808080">(</font><font color="#000080">opCSubMenu </font><font color="#808080">= </font><font color="#800000">&quot;N&quot;</font><font color="#808080">) </font><font color="#000080"><b>OR </b></font><font color="#808080">(</font><font color="#000080">opCSubMenu </font><font color="#808080">= </font><font color="#800000">&quot;n&quot;</font><font color="#808080">) </font><font color="#000080"><b>THEN
</b></font>	<font color="#000080">bSOp </font><font color="#808080">= </font><font color="#000080">false
     <b>ELSE
</b></font>	<font color="#000080"><b>PRINT </b>MSGERRO
     <b>END IF
    LOOP
END SELECT

END SUB

</b></font><font color="#808080"><i>'------------------------------------------------------------------------------
'Calcula o tamanho do arquivo.
'sArq - o arquivo
'retorna - o tamanho do arquivo
'------------------------------------------------------------------------------
</i></font><font color="#000080"><b>FUNCTION </b>tamArq! </font><font color="#808080">(</font><font color="#000080">sArq <b>AS INTEGER</b></font><font color="#808080">)
</font><font color="#000080">tamArq </font><font color="#808080">= </font><font color="#000080"><b>LOF</b></font><font color="#808080">(</font><font color="#000080">sArq</font><font color="#808080">)
</font><font color="#000080"><b>END FUNCTION

</b></font><font color="#808080"><i>'------------------------------------------------------------------------------
'Retorna o tamanho do registro no arquivo de acordo com o tipo de arquivo.
'sreg - o tipo de arquivo
'retorna - o tamanho do registro
'------------------------------------------------------------------------------
</i></font><font color="#000080"><b>FUNCTION </b>tamReg! </font><font color="#808080">(</font><font color="#000080">sreg <b>AS INTEGER</b></font><font color="#808080">)
</font><font color="#000080"><b>DIM </b>nret <b>AS INTEGER

</b>nret </font><font color="#808080">= </font><font color="#FF0000">0
</font><font color="#000080"><b>IF </b>sreg </font><font color="#808080">= </font><font color="#000080">opAssunto <b>THEN
  </b>nret </font><font color="#808080">= </font><font color="#000080">TAMASSUNTO
<b>ELSEIF </b>sreg </font><font color="#808080">= </font><font color="#000080">opAutor <b>THEN
  </b>nret </font><font color="#808080">= </font><font color="#000080">TAMAUTOR
<b>ELSEIF </b>sreg </font><font color="#808080">= </font><font color="#000080">opEditora <b>THEN
  </b>nret </font><font color="#808080">= </font><font color="#000080">TAMEDITORA
<b>ELSEIF </b>sreg </font><font color="#808080">= </font><font color="#000080">opEndereco <b>THEN
  </b>nret </font><font color="#808080">= </font><font color="#000080">TAMENDERECO
<b>ELSEIF </b>sreg </font><font color="#808080">= </font><font color="#000080">opIdioma <b>THEN
  </b>nret </font><font color="#808080">= </font><font color="#000080">TAMIDIOMA
<b>ELSEIF </b>sreg </font><font color="#808080">= </font><font color="#000080">opPais <b>THEN
  </b>nret </font><font color="#808080">= </font><font color="#000080">TAMPAIS
<b>ELSEIF </b>sreg </font><font color="#808080">= </font><font color="#000080">opProfissao <b>THEN
  </b>nret </font><font color="#808080">= </font><font color="#000080">TAMPROFISSAO
<b>ELSEIF </b>sreg </font><font color="#808080">= </font><font color="#000080">opUsuario <b>THEN
  </b>nret </font><font color="#808080">= </font><font color="#000080">TAMUSUARIO
<b>ELSEIF </b>sreg </font><font color="#808080">= </font><font color="#000080">opLivro <b>THEN
  </b>nret </font><font color="#808080">= </font><font color="#000080">TAMLIVRO
<b>ELSEIF </b>sreg </font><font color="#808080">= </font><font color="#000080">opLivroAss <b>THEN
  </b>nret </font><font color="#808080">= </font><font color="#000080">TAMLIVASS
<b>ELSEIF </b>sreg </font><font color="#808080">= </font><font color="#000080">opLivroAut <b>THEN
  </b>nret </font><font color="#808080">= </font><font color="#000080">TAMLIVAUT
<b>ELSEIF </b>sreg </font><font color="#808080">= </font><font color="#000080">opCliente <b>THEN
  </b>nret </font><font color="#808080">= </font><font color="#000080">TAMCLIENTE
<b>ELSEIF </b>sreg </font><font color="#808080">= </font><font color="#000080">opVenda <b>THEN
  </b>nret </font><font color="#808080">= </font><font color="#000080">TAMVENDA
<b>END IF
</b>tamReg </font><font color="#808080">= </font><font color="#000080">nret
<b>END FUNCTION

</b></font><font color="#808080"><i>'------------------------------------------------------------------------------
'Retira os espa‡os em branco antes ou depois do texto.
'sTexto - o texto a ser retirado os espa‡os em branco
'retorna - o texto sem os espa‡os em branco
'------------------------------------------------------------------------------
</i></font><font color="#000080"><b>FUNCTION Trim</b>$ </font><font color="#808080">(</font><font color="#000080">sTexto <b>AS STRING</b></font><font color="#808080">)
</font><font color="#000080"><b>DIM </b>slocal <b>AS STRING
  </b>slocal </font><font color="#808080">= </font><font color="#000080"><b>LTRIM</b>$</font><font color="#808080">(</font><font color="#000080">sTexto</font><font color="#808080">)
  </font><font color="#000080">slocal </font><font color="#808080">= </font><font color="#000080"><b>RTRIM</b>$</font><font color="#808080">(</font><font color="#000080">slocal</font><font color="#808080">)
  </font><font color="#000080"><b>Trim</b>$ </font><font color="#808080">= </font><font color="#000080">slocal
<b>END FUNCTION

</b></font><font color="#808080"><i>'------------------------------------------------------------------------------
'Seleciona o submenu e/ou a tela certa de acordo com n&pound;mero do menu.
'nmenu - o n&pound;mero do menu
'------------------------------------------------------------------------------
</i></font><font color="#000080"><b>SUB </b>usaMenu </font><font color="#808080">(</font><font color="#000080">num <b>AS INTEGER</b></font><font color="#808080">)
</font><font color="#000080"><b>DIM </b>opSubMenu <b>AS INTEGER
DIM </b>bSOp <b>AS INTEGER
DIM </b>opSair <b>AS STRING

 </b>bSOp </font><font color="#808080">= </font><font color="#000080">true
 <b>IF </b>num </font><font color="#808080">= </font><font color="#FF0000">1 </font><font color="#000080"><b>THEN  </b></font><font color="#808080"><i>' Cadastros
   </i></font><font color="#000080"><b>DO WHILE </b>bSOp
     menu </font><font color="#808080">(</font><font color="#FF0000">2</font><font color="#808080">)
     </font><font color="#000080"><b>INPUT </b></font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#000080">opSubMenu
     <b>SELECT CASE </b>opSubMenu
       <b>CASE </b></font><font color="#FF0000">1
</font>	 <font color="#000080">subMenu </font><font color="#FF0000">6</font><font color="#808080">, </font><font color="#000080">opAssunto
       <b>CASE </b></font><font color="#FF0000">2
</font>	 <font color="#000080">subMenu </font><font color="#FF0000">6</font><font color="#808080">, </font><font color="#000080">opAutor
       <b>CASE </b></font><font color="#FF0000">3
</font>	 <font color="#000080">subMenu </font><font color="#FF0000">6</font><font color="#808080">, </font><font color="#000080">opEditora
       <b>CASE </b></font><font color="#FF0000">4
</font>	 <font color="#000080">subMenu </font><font color="#FF0000">6</font><font color="#808080">, </font><font color="#000080">opEndereco
       <b>CASE </b></font><font color="#FF0000">5
</font>	 <font color="#000080">subMenu </font><font color="#FF0000">6</font><font color="#808080">, </font><font color="#000080">opIdioma
       <b>CASE </b></font><font color="#FF0000">6
</font>	 <font color="#000080">subMenu </font><font color="#FF0000">6</font><font color="#808080">, </font><font color="#000080">opPais
       <b>CASE </b></font><font color="#FF0000">7
</font>	 <font color="#000080">subMenu </font><font color="#FF0000">6</font><font color="#808080">, </font><font color="#000080">opProfissao
       <b>CASE </b></font><font color="#FF0000">8
</font>	 <font color="#000080">subMenu </font><font color="#FF0000">6</font><font color="#808080">, </font><font color="#000080">opCliente
       <b>CASE </b></font><font color="#FF0000">9
</font>	 <font color="#000080">subMenu </font><font color="#FF0000">6</font><font color="#808080">, </font><font color="#000080">opLivro
       <b>CASE </b></font><font color="#FF0000">10
</font>	 <font color="#000080">bSOp </font><font color="#808080">= </font><font color="#000080">false
       <b>CASE ELSE
</b></font>	 <font color="#000080"><b>PRINT </b>MSGERRO
     <b>END SELECT
   LOOP
 ELSEIF </b>num </font><font color="#808080">= </font><font color="#FF0000">2 </font><font color="#000080"><b>THEN  </b></font><font color="#808080"><i>' Pesquisas
   </i></font><font color="#000080"><b>DO WHILE </b>bSOp
     menu </font><font color="#808080">(</font><font color="#FF0000">3</font><font color="#808080">)
     </font><font color="#000080"><b>INPUT </b></font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#000080">opSubMenu
     <b>SELECT CASE </b>opSubMenu
       <b>CASE </b></font><font color="#FF0000">1
</font>	 <font color="#000080">subMenu </font><font color="#FF0000">12</font><font color="#808080">, </font><font color="#000080">opAssunto
       <b>CASE </b></font><font color="#FF0000">2
</font>	 <font color="#000080">subMenu </font><font color="#FF0000">12</font><font color="#808080">, </font><font color="#000080">opAutor
       <b>CASE </b></font><font color="#FF0000">3
</font>	 <font color="#000080">subMenu </font><font color="#FF0000">12</font><font color="#808080">, </font><font color="#000080">opEditora
       <b>CASE </b></font><font color="#FF0000">4
</font>	 <font color="#000080">subMenu </font><font color="#FF0000">12</font><font color="#808080">, </font><font color="#000080">opEndereco
       <b>CASE </b></font><font color="#FF0000">5
</font>	 <font color="#000080">subMenu </font><font color="#FF0000">12</font><font color="#808080">, </font><font color="#000080">opIdioma
       <b>CASE </b></font><font color="#FF0000">6
</font>	 <font color="#000080">subMenu </font><font color="#FF0000">12</font><font color="#808080">, </font><font color="#000080">opPais
       <b>CASE </b></font><font color="#FF0000">7
</font>	 <font color="#000080">subMenu </font><font color="#FF0000">12</font><font color="#808080">, </font><font color="#000080">opProfissao
       <b>CASE </b></font><font color="#FF0000">8
</font>	 <font color="#000080">subMenu </font><font color="#FF0000">12</font><font color="#808080">, </font><font color="#000080">opCliente
       <b>CASE </b></font><font color="#FF0000">9
</font>	 <font color="#000080">subMenu </font><font color="#FF0000">12</font><font color="#808080">, </font><font color="#000080">opLivro
       <b>CASE </b></font><font color="#FF0000">10
</font>	 <font color="#000080">bSOp </font><font color="#808080">= </font><font color="#000080">false
       <b>CASE ELSE
</b></font>	 <font color="#000080"><b>PRINT </b>MSGERRO
     <b>END SELECT
   LOOP
 ELSEIF </b>num </font><font color="#808080">= </font><font color="#FF0000">3 </font><font color="#000080"><b>THEN  </b></font><font color="#808080"><i>' Vendas
   </i></font><font color="#000080"><b>DO WHILE </b>bSOp
     menu </font><font color="#808080">(</font><font color="#FF0000">4</font><font color="#808080">)
     </font><font color="#000080"><b>INPUT </b></font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#000080">opSubMenu
     <b>SELECT CASE </b>opSubMenu
       <b>CASE </b></font><font color="#FF0000">1
</font>	 <font color="#000080">subMenu </font><font color="#FF0000">6</font><font color="#808080">, </font><font color="#000080">opVenda
       <b>CASE </b></font><font color="#FF0000">2
</font>	 <font color="#000080">subMenu </font><font color="#FF0000">12</font><font color="#808080">, </font><font color="#000080">opVenda
       <b>CASE </b></font><font color="#FF0000">3
</font>	 <font color="#000080">bSOp </font><font color="#808080">= </font><font color="#000080">false
       <b>CASE ELSE
</b></font>	 <font color="#000080"><b>PRINT </b>MSGERRO
     <b>END SELECT
   LOOP
 ELSEIF </b>num </font><font color="#808080">= </font><font color="#FF0000">4 </font><font color="#000080"><b>THEN  </b></font><font color="#808080"><i>' Opcoes
   </i></font><font color="#000080"><b>DO WHILE </b>bSOp
     menu </font><font color="#808080">(</font><font color="#FF0000">5</font><font color="#808080">)
     </font><font color="#000080"><b>INPUT </b></font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#000080">opSubMenu
     <b>SELECT CASE </b>opSubMenu
       <b>CASE </b></font><font color="#FF0000">1
</font>	 <font color="#000080">frmAlterarSenha
       <b>CASE </b></font><font color="#FF0000">2
</font>	 <font color="#000080">frmSobre
       <b>CASE </b></font><font color="#FF0000">3
</font>	   <font color="#000080">menu </font><font color="#808080">(</font><font color="#FF0000">11</font><font color="#808080">)
</font>	   <font color="#000080"><b>INPUT </b></font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#000080">opSair
</font>	   <font color="#000080"><b>IF </b></font><font color="#808080">(</font><font color="#000080">opSair </font><font color="#808080">= </font><font color="#800000">&quot;S&quot;</font><font color="#808080">) </font><font color="#000080"><b>OR </b></font><font color="#808080">(</font><font color="#000080">opSair </font><font color="#808080">= </font><font color="#800000">&quot;s&quot;</font><font color="#808080">) </font><font color="#000080"><b>THEN
</b></font>	      <font color="#000080">fechaArqs
</font>	      <font color="#000080"><b>END
</b></font>	   <font color="#000080"><b>END IF
       CASE </b></font><font color="#FF0000">4
</font>	 <font color="#000080">bSOp </font><font color="#808080">= </font><font color="#000080">false
       <b>CASE ELSE
</b></font>	 <font color="#000080"><b>PRINT </b>MSGERRO
     <b>END SELECT
   LOOP
 END IF
END SUB

</b></font><font color="#808080"><i>'------------------------------------------------------------------------------
'Valida‡&AElig;o de um n&pound;mero de CPF qualquer.
'cpf - a string com o n&pound;mero do CPF
'retorna - se ‚ valido ou n&AElig;o
'------------------------------------------------------------------------------
</i></font><font color="#000080"><b>FUNCTION </b>validaCPF! </font><font color="#808080">(</font><font color="#000080">cpf <b>AS STRING</b></font><font color="#808080">)
</font><font color="#000080"><b>DIM </b>scpf <b>AS STRING</b></font><font color="#808080">, </font><font color="#000080">sres <b>AS STRING
DIM </b>nvalor1</font><font color="#808080">, </font><font color="#000080">nvalor2 <b>AS INTEGER

IF </b></font><font color="#808080">(</font><font color="#000080"><b>LEN</b></font><font color="#808080">(</font><font color="#000080">cpf</font><font color="#808080">) = </font><font color="#FF0000">14</font><font color="#808080">) </font><font color="#000080"><b>THEN
  </b>scpf </font><font color="#808080">= </font><font color="#000080"><b>MID</b>$</font><font color="#808080">(</font><font color="#000080">cpf</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">) + </font><font color="#000080"><b>MID</b>$</font><font color="#808080">(</font><font color="#000080">cpf</font><font color="#808080">, </font><font color="#FF0000">5</font><font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">) + </font><font color="#000080"><b>MID</b>$</font><font color="#808080">(</font><font color="#000080">cpf</font><font color="#808080">, </font><font color="#FF0000">9</font><font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">) + </font><font color="#000080"><b>MID</b>$</font><font color="#808080">(</font><font color="#000080">cpf</font><font color="#808080">, </font><font color="#FF0000">13</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">)
  </font><font color="#000080">sres </font><font color="#808080">= </font><font color="#000080"><b>MID</b>$</font><font color="#808080">(</font><font color="#000080">cpf</font><font color="#808080">, </font><font color="#FF0000">13</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">)
  </font><font color="#000080">nvalor1 </font><font color="#808080">= </font><font color="#000080"><b>VAL</b></font><font color="#808080">(</font><font color="#000080">sres</font><font color="#808080">)
  </font><font color="#000080">sres </font><font color="#808080">= </font><font color="#000080"><b>MID</b>$</font><font color="#808080">(</font><font color="#000080">cpf</font><font color="#808080">, </font><font color="#FF0000">14</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">)
  </font><font color="#000080">nvalor2 </font><font color="#808080">= </font><font color="#000080"><b>VAL</b></font><font color="#808080">(</font><font color="#000080">sres</font><font color="#808080">)
  </font><font color="#000080"><b>IF </b></font><font color="#808080">((</font><font color="#000080">modulo11</font><font color="#808080">(</font><font color="#000080">scpf</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">) = </font><font color="#000080">nvalor1</font><font color="#808080">) </font><font color="#000080"><b>AND </b></font><font color="#808080">(</font><font color="#000080">modulo11</font><font color="#808080">(</font><font color="#000080">scpf</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">) = </font><font color="#000080">nvalor2</font><font color="#808080">)) </font><font color="#000080"><b>THEN
    </b>validaCPF </font><font color="#808080">= </font><font color="#000080">true
  <b>ELSE
    </b>validaCPF </font><font color="#808080">= </font><font color="#000080">false
  <b>END IF
ELSE
  </b>validaCPF </font><font color="#808080">= </font><font color="#000080">false
<b>END IF
END FUNCTION

</b></font><font color="#808080"><i>'------------------------------------------------------------------------------
'Valida‡&AElig;o de uma data ou data/hora qualquer.
'sRotulo - o texto antes de se digitar a data/hora
'sDataHora - a string com o valor da data/hora
'bSoData - indica se vai validar somente uma data sem a hora
'retorna - a sDataHora
'------------------------------------------------------------------------------
</i></font><font color="#000080"><b>FUNCTION </b>validaDataHora$ </font><font color="#808080">(</font><font color="#000080">sRotulo <b>AS STRING</b></font><font color="#808080">, </font><font color="#000080">sDataHora <b>AS STRING</b></font><font color="#808080">, </font><font color="#000080">bSoData <b>AS INTEGER</b></font><font color="#808080">)
</font><font color="#000080"><b>DIM </b>bvalida <b>AS INTEGER</b></font><font color="#808080">, </font><font color="#000080">bdatavalida  <b>AS INTEGER</b></font><font color="#808080">, </font><font color="#000080">bhoravalida <b>AS INTEGER
DIM </b>sdia <b>AS STRING</b></font><font color="#808080">, </font><font color="#000080">smes <b>AS STRING</b></font><font color="#808080">, </font><font color="#000080">sano <b>AS STRING
DIM </b>shora <b>AS STRING</b></font><font color="#808080">, </font><font color="#000080">smin <b>AS STRING</b></font><font color="#808080">, </font><font color="#000080">slseg <b>AS STRING
DIM </b>ndia <b>AS INTEGER</b></font><font color="#808080">, </font><font color="#000080">nmes <b>AS INTEGER</b></font><font color="#808080">, </font><font color="#000080">nano <b>AS INTEGER
DIM </b>nhora <b>AS INTEGER</b></font><font color="#808080">, </font><font color="#000080">nmin <b>AS INTEGER</b></font><font color="#808080">, </font><font color="#000080">nseg <b>AS INTEGER</b></font><font color="#808080">, </font><font color="#000080">nudiames <b>AS INTEGER
DIM </b>ntam <b>AS INTEGER

</b>bvalida </font><font color="#808080">= </font><font color="#000080">false
bdatavalida </font><font color="#808080">= </font><font color="#000080">false
bhoravalida </font><font color="#808080">= </font><font color="#000080">false
nudiames </font><font color="#808080">= </font><font color="#FF0000">0

</font><font color="#000080"><b>IF </b>bSoData </font><font color="#808080">= </font><font color="#000080">true <b>THEN
  </b>ntam </font><font color="#808080">= </font><font color="#FF0000">10
</font><font color="#000080"><b>ELSE
  </b>ntam </font><font color="#808080">= </font><font color="#FF0000">19
</font><font color="#000080"><b>END IF
DO WHILE </b></font><font color="#808080">(</font><font color="#000080">bvalida </font><font color="#808080">= </font><font color="#000080">false</font><font color="#808080">)
  </font><font color="#000080"><b>PRINT </b>sRotulo</font><font color="#808080">;
  </font><font color="#000080"><b>INPUT </b></font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#000080">sDataHora
  <b>IF LEN</b></font><font color="#808080">(</font><font color="#000080">sDataHora</font><font color="#808080">) = </font><font color="#000080">ntam <b>THEN
    </b>sdia </font><font color="#808080">= </font><font color="#000080"><b>MID</b>$</font><font color="#808080">(</font><font color="#000080">sDataHora</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">)
    </font><font color="#000080">ndia </font><font color="#808080">= </font><font color="#000080"><b>VAL</b></font><font color="#808080">(</font><font color="#000080">sdia</font><font color="#808080">)
    </font><font color="#000080">smes </font><font color="#808080">= </font><font color="#000080"><b>MID</b>$</font><font color="#808080">(</font><font color="#000080">sDataHora</font><font color="#808080">, </font><font color="#FF0000">4</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">)
    </font><font color="#000080">nmes </font><font color="#808080">= </font><font color="#000080"><b>VAL</b></font><font color="#808080">(</font><font color="#000080">smes</font><font color="#808080">)
    </font><font color="#000080">sano </font><font color="#808080">= </font><font color="#000080"><b>MID</b>$</font><font color="#808080">(</font><font color="#000080">sDataHora</font><font color="#808080">, </font><font color="#FF0000">7</font><font color="#808080">, </font><font color="#FF0000">4</font><font color="#808080">)
    </font><font color="#000080">nano </font><font color="#808080">= </font><font color="#000080"><b>VAL</b></font><font color="#808080">(</font><font color="#000080">sano</font><font color="#808080">)
  
    </font><font color="#000080"><b>IF </b></font><font color="#808080">(</font><font color="#000080">nano </font><font color="#808080">&gt;= </font><font color="#FF0000">1</font><font color="#808080">) </font><font color="#000080"><b>AND </b></font><font color="#808080">(</font><font color="#000080">nano </font><font color="#808080">&lt;= </font><font color="#FF0000">9999</font><font color="#808080">) </font><font color="#000080"><b>THEN
      IF </b></font><font color="#808080">(</font><font color="#000080">nmes </font><font color="#808080">&gt;= </font><font color="#FF0000">1</font><font color="#808080">) </font><font color="#000080"><b>AND </b></font><font color="#808080">(</font><font color="#000080">nmes </font><font color="#808080">&lt;= </font><font color="#FF0000">31</font><font color="#808080">) </font><font color="#000080"><b>THEN
</b></font>	  <font color="#000080"><b>SELECT CASE </b>nmes
</font>	     <font color="#000080"><b>CASE </b></font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">, </font><font color="#FF0000">5</font><font color="#808080">, </font><font color="#FF0000">7</font><font color="#808080">, </font><font color="#FF0000">8</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">, </font><font color="#FF0000">12
</font>	       <font color="#000080">nudiames </font><font color="#808080">= </font><font color="#FF0000">31
</font>	     <font color="#000080"><b>CASE </b></font><font color="#FF0000">2
</font>		 <font color="#808080"><i>' ano bissexto
</i></font>		 <font color="#000080"><b>IF </b></font><font color="#808080">(</font><font color="#000080">nano <b>MOD </b></font><font color="#FF0000">4</font><font color="#808080">) = </font><font color="#FF0000">0 </font><font color="#000080"><b>THEN
</b></font>		   <font color="#000080">nudiames </font><font color="#808080">= </font><font color="#FF0000">29
</font>		 <font color="#000080"><b>ELSE
</b></font>		   <font color="#000080">nudiames </font><font color="#808080">= </font><font color="#FF0000">28
</font>		 <font color="#000080"><b>END IF
</b></font>	     <font color="#000080"><b>CASE </b></font><font color="#FF0000">4</font><font color="#808080">, </font><font color="#FF0000">6</font><font color="#808080">, </font><font color="#FF0000">9</font><font color="#808080">, </font><font color="#FF0000">11
</font>		 <font color="#000080">nudiames </font><font color="#808080">= </font><font color="#FF0000">30
</font>	  <font color="#000080"><b>END SELECT
</b></font>	  <font color="#000080"><b>IF </b></font><font color="#808080">(</font><font color="#000080">ndia </font><font color="#808080">&gt;= </font><font color="#FF0000">1</font><font color="#808080">) </font><font color="#000080"><b>AND </b></font><font color="#808080">(</font><font color="#000080">ndia </font><font color="#808080">&lt;= </font><font color="#000080">nudiames</font><font color="#808080">) </font><font color="#000080"><b>THEN
</b></font>	     <font color="#000080">bdatavalida </font><font color="#808080">= </font><font color="#000080">true
</font>	  <font color="#000080"><b>END IF
      END IF
    END IF
  
    IF </b>bSoData <b>THEN
       IF </b>bdatavalida <b>THEN
</b></font>	  <font color="#000080">bvalida </font><font color="#808080">= </font><font color="#000080">true
       <b>ELSE
</b></font>	  <font color="#000080"><b>PRINT </b>MSGDATAINV
       <b>END IF
    ELSE
      IF </b>bdatavalida <b>THEN
</b></font>	  <font color="#000080">shora </font><font color="#808080">= </font><font color="#000080"><b>MID</b>$</font><font color="#808080">(</font><font color="#000080">sDataHora</font><font color="#808080">, </font><font color="#FF0000">12</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">)
</font>	  <font color="#000080">nhora </font><font color="#808080">= </font><font color="#000080"><b>VAL</b></font><font color="#808080">(</font><font color="#000080">shora</font><font color="#808080">)
</font>	  <font color="#000080">smin </font><font color="#808080">= </font><font color="#000080"><b>MID</b>$</font><font color="#808080">(</font><font color="#000080">sDataHora</font><font color="#808080">, </font><font color="#FF0000">15</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">)
</font>	  <font color="#000080">nmin </font><font color="#808080">= </font><font color="#000080"><b>VAL</b></font><font color="#808080">(</font><font color="#000080">smin</font><font color="#808080">)
</font>	  <font color="#000080">slseg </font><font color="#808080">= </font><font color="#000080"><b>MID</b>$</font><font color="#808080">(</font><font color="#000080">sDataHora</font><font color="#808080">, </font><font color="#FF0000">18</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">)
</font>	  <font color="#000080">nseg </font><font color="#808080">= </font><font color="#000080"><b>VAL</b></font><font color="#808080">(</font><font color="#000080">slseg</font><font color="#808080">)
  
</font>	  <font color="#000080"><b>IF </b></font><font color="#808080">(</font><font color="#000080">nhora </font><font color="#808080">&gt;= </font><font color="#FF0000">0</font><font color="#808080">) </font><font color="#000080"><b>AND </b></font><font color="#808080">(</font><font color="#000080">nhora </font><font color="#808080">&lt;= </font><font color="#FF0000">23</font><font color="#808080">) </font><font color="#000080"><b>THEN
</b></font>	    <font color="#000080"><b>IF </b></font><font color="#808080">(</font><font color="#000080">nmin </font><font color="#808080">&gt;= </font><font color="#FF0000">0</font><font color="#808080">) </font><font color="#000080"><b>AND </b></font><font color="#808080">(</font><font color="#000080">nmin </font><font color="#808080">&lt;= </font><font color="#FF0000">59</font><font color="#808080">) </font><font color="#000080"><b>THEN
</b></font>	      <font color="#000080"><b>IF </b></font><font color="#808080">(</font><font color="#000080">nseg </font><font color="#808080">&gt;= </font><font color="#FF0000">0</font><font color="#808080">) </font><font color="#000080"><b>AND </b></font><font color="#808080">(</font><font color="#000080">nseg </font><font color="#808080">&lt;= </font><font color="#FF0000">59</font><font color="#808080">) </font><font color="#000080"><b>THEN
</b></font>		 <font color="#000080">bhoravalida </font><font color="#808080">= </font><font color="#000080">true
</font>	      <font color="#000080"><b>END IF
</b></font>	    <font color="#000080"><b>END IF
</b></font>	  <font color="#000080"><b>END IF
  
</b></font>	  <font color="#000080"><b>IF </b>bhoravalida <b>THEN
</b></font>	    <font color="#000080">bvalida </font><font color="#808080">= </font><font color="#000080">true
</font>	  <font color="#000080"><b>ELSE
</b></font>	    <font color="#000080"><b>PRINT </b>MSGDTHRINV
</font>	  <font color="#000080"><b>END IF
      ELSE
</b></font>	<font color="#000080"><b>PRINT </b>MSGDTHRINV
      <b>END IF
    END IF
  ELSE
    IF </b>bSoData </font><font color="#808080">= </font><font color="#000080">true <b>THEN
      PRINT </b>MSGDATAINV
    <b>ELSE
      PRINT </b>MSGDTHRINV
    <b>END IF
  END IF
LOOP
</b>validaDataHora </font><font color="#808080">= </font><font color="#000080">sDataHora

<b>END FUNCTION

</b></font><font color="#808080"><i>'------------------------------------------------------------------------------
'Valida a entrada de registros de acordo com a pesquisa feita.
'sArq - o arquivo
'sreg - o tipo de arquivo
'nTexto - o numero do r&cent;tulo da entrada
'sEntrada - a chave a ser pesquisada e validada
'nTentativas - o n&pound;mero m ximo de tentativas
'bPesqRelativa - indica se vai realizar uma pesquisa relativa
'bTipoEntrada - indica o tipo de entrada
'retorna - o registro pesquisado e validado
'------------------------------------------------------------------------------
</i></font><font color="#000080"><b>FUNCTION </b>validaEntrada$ </font><font color="#808080">(</font><font color="#000080">sArq <b>AS INTEGER</b></font><font color="#808080">, </font><font color="#000080">sreg <b>AS INTEGER</b></font><font color="#808080">, </font><font color="#000080">nTexto <b>AS INTEGER</b></font><font color="#808080">, </font><font color="#000080">sEntrada <b>AS STRING</b></font><font color="#808080">, </font><font color="#000080">nTentativas <b>AS INTEGER</b></font><font color="#808080">, </font><font color="#000080">bPesqRelativa <b>AS INTEGER</b></font><font color="#808080">, </font><font color="#000080">bTipoEntrada <b>AS INTEGER</b></font><font color="#808080">)
</font><font color="#000080"><b>DIM </b>bQuebra <b>AS INTEGER
DIM </b>sres <b>AS STRING</b></font><font color="#808080">, </font><font color="#000080">sTexto <b>AS STRING</b></font><font color="#808080">, </font><font color="#000080">sMsgErro <b>AS STRING
DIM </b>nCont <b>AS INTEGER</b></font><font color="#808080">, </font><font color="#000080">nPosChave <b>AS INTEGER
DIM </b>nTamChave <b>AS INTEGER</b></font><font color="#808080">, </font><font color="#000080">nTamLinha <b>AS INTEGER

</b>nTamLinha </font><font color="#808080">= </font><font color="#000080">tamReg</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">)
</font><font color="#000080">sMsgErro </font><font color="#808080">= </font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">)
</font><font color="#000080">sTexto </font><font color="#808080">= </font><font color="#000080">rotulo</font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#000080">nTexto</font><font color="#808080">)
</font><font color="#000080">nPosChave </font><font color="#808080">= </font><font color="#000080">gnPosChave
nTamChave </font><font color="#808080">= </font><font color="#000080">gnTamChave

nCont </font><font color="#808080">= </font><font color="#FF0000">1
</font><font color="#000080">bQuebra </font><font color="#808080">= </font><font color="#000080">false
  <b>DO WHILE </b></font><font color="#808080">(</font><font color="#000080">bQuebra </font><font color="#808080">= </font><font color="#000080">false</font><font color="#808080">) </font><font color="#000080"><b>AND </b></font><font color="#808080">(</font><font color="#000080">nCont </font><font color="#808080">&lt;= </font><font color="#000080">nTentativas</font><font color="#808080">)
    </font><font color="#000080"><b>IF </b>bTipoEntrada </font><font color="#808080">= </font><font color="#000080">opTexto <b>THEN
      PRINT </b>sTexto</font><font color="#808080">;
      </font><font color="#000080"><b>INPUT </b></font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#000080">sEntrada
    <b>ELSEIF </b>bTipoEntrada </font><font color="#808080">= </font><font color="#000080">opNumero <b>THEN
       </b>sEntrada </font><font color="#808080">= </font><font color="#000080">validaNumero</font><font color="#808080">(</font><font color="#000080">sTexto</font><font color="#808080">, </font><font color="#000080">sEntrada</font><font color="#808080">)
    </font><font color="#000080"><b>ELSEIF </b>bTipoEntrada </font><font color="#808080">= </font><font color="#000080">opData <b>THEN
       </b>sEntrada </font><font color="#808080">= </font><font color="#000080">validaDataHora</font><font color="#808080">(</font><font color="#000080">sTexto</font><font color="#808080">, </font><font color="#000080">sEntrada</font><font color="#808080">, </font><font color="#000080">true</font><font color="#808080">)
    </font><font color="#000080"><b>ELSEIF </b>bTipoEntrada </font><font color="#808080">= </font><font color="#000080">opDataHora <b>THEN
       </b>sEntrada </font><font color="#808080">= </font><font color="#000080">validaDataHora</font><font color="#808080">(</font><font color="#000080">sTexto</font><font color="#808080">, </font><font color="#000080">sEntrada</font><font color="#808080">, </font><font color="#000080">false</font><font color="#808080">)
    </font><font color="#000080"><b>ELSEIF </b>bTipoEntrada </font><font color="#808080">= </font><font color="#000080">opSenha <b>THEN
       </b>sEntrada </font><font color="#808080">= </font><font color="#000080">digitaSenha</font><font color="#808080">(</font><font color="#000080">sTexto</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">)
    </font><font color="#000080"><b>END IF

    IF </b>bPesqRelativa <b>THEN
       IF </b>ListarTodos</font><font color="#808080">(</font><font color="#000080">sArq</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#000080">sEntrada</font><font color="#808080">, </font><font color="#000080">nPosChave</font><font color="#808080">, </font><font color="#000080">nTamChave</font><font color="#808080">, </font><font color="#000080">nTamLinha</font><font color="#808080">, </font><font color="#000080">QTDMAXLINHA</font><font color="#808080">, </font><font color="#000080">true</font><font color="#808080">) </font><font color="#000080"><b>THEN
</b></font>	  <font color="#000080">sres </font><font color="#808080">= </font><font color="#800000">&quot; &quot;
       </font><font color="#000080"><b>END IF
    ELSE
</b></font>	<font color="#000080">sres </font><font color="#808080">= </font><font color="#000080">pesqArq</font><font color="#808080">(</font><font color="#000080">sArq</font><font color="#808080">, </font><font color="#000080">sEntrada</font><font color="#808080">, </font><font color="#000080">nPosChave</font><font color="#808080">, </font><font color="#000080">nTamChave</font><font color="#808080">, </font><font color="#000080">nTamLinha</font><font color="#808080">)
    </font><font color="#000080"><b>END IF

    IF </b>sres </font><font color="#808080">= </font><font color="#800000">&quot;&quot; </font><font color="#000080"><b>THEN
       PRINT </b>sMsgErro
    <b>ELSE
       </b>bQuebra </font><font color="#808080">= </font><font color="#000080">true
    <b>END IF

    </b>nCont </font><font color="#808080">= </font><font color="#000080">nCont </font><font color="#808080">+ </font><font color="#FF0000">1
  </font><font color="#000080"><b>LOOP
</b>validaEntrada </font><font color="#808080">= </font><font color="#000080">sres
<b>END FUNCTION

</b></font><font color="#808080"><i>'------------------------------------------------------------------------------
'Valida‡&AElig;o de um n&pound;mero ISBN qualquer.
'isbn - a string com o n&pound;mero do ISBN
'retorna - se ‚ valido ou n&AElig;o
'------------------------------------------------------------------------------
</i></font><font color="#000080"><b>FUNCTION </b>validaISBN! </font><font color="#808080">(</font><font color="#000080">isbn <b>AS STRING</b></font><font color="#808080">)
</font><font color="#000080"><b>Dim </b>snum  <b>As String</b></font><font color="#808080">, </font><font color="#000080">sdigito <b>As String</b></font><font color="#808080">, </font><font color="#000080">sisbn <b>As String
Dim </b>nvalor <b>As Integer</b></font><font color="#808080">, </font><font color="#000080">nsoma <b>As Integer</b></font><font color="#808080">, </font><font color="#000080">ncont <b>As Integer

If len</b></font><font color="#808080">(</font><font color="#000080">isbn</font><font color="#808080">) = </font><font color="#FF0000">13 </font><font color="#000080"><b>Then
  </b>sdigito </font><font color="#808080">= </font><font color="#000080"><b>mid</b>$</font><font color="#808080">(</font><font color="#000080">isbn</font><font color="#808080">,</font><font color="#000080"><b>len</b></font><font color="#808080">(</font><font color="#000080">isbn</font><font color="#808080">), </font><font color="#FF0000">1</font><font color="#808080">)
  </font><font color="#000080">sisbn</font><font color="#808080">=</font><font color="#800000">&quot;&quot;
  </font><font color="#000080"><b>for </b>ncont</font><font color="#808080">=</font><font color="#FF0000">1 </font><font color="#000080"><b>to len</b></font><font color="#808080">(</font><font color="#000080">isbn</font><font color="#808080">)-</font><font color="#FF0000">1
    </font><font color="#000080"><b>if mid</b>$</font><font color="#808080">(</font><font color="#000080">isbn</font><font color="#808080">, </font><font color="#000080">ncont</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">)&lt;&gt;</font><font color="#800000">&quot;-&quot; </font><font color="#000080"><b>then
      </b>sisbn</font><font color="#808080">=</font><font color="#000080">sisbn </font><font color="#808080">+ </font><font color="#000080"><b>mid</b>$</font><font color="#808080">(</font><font color="#000080">isbn</font><font color="#808080">, </font><font color="#000080">ncont</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">)
    </font><font color="#000080"><b>end if
  next </b>ncont
  <b>if </b>sdigito </font><font color="#808080">= </font><font color="#800000">&quot;X&quot; </font><font color="#000080"><b>then
    </b>nsoma </font><font color="#808080">= </font><font color="#FF0000">10
  </font><font color="#000080"><b>else
    </b>nvalor </font><font color="#808080">= </font><font color="#000080"><b>val</b></font><font color="#808080">(</font><font color="#000080">sdigito</font><font color="#808080">)
    </font><font color="#000080">nsoma </font><font color="#808080">= </font><font color="#000080">nvalor
  <b>end if
  for </b>ncont </font><font color="#808080">= </font><font color="#FF0000">1 </font><font color="#000080"><b>to </b></font><font color="#FF0000">9
    </font><font color="#000080">snum </font><font color="#808080">= </font><font color="#000080"><b>mid</b>$</font><font color="#808080">(</font><font color="#000080">sisbn</font><font color="#808080">, </font><font color="#000080">ncont</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">)
    </font><font color="#000080">nvalor </font><font color="#808080">= </font><font color="#000080"><b>val</b></font><font color="#808080">(</font><font color="#000080">snum</font><font color="#808080">)
    </font><font color="#000080">nsoma </font><font color="#808080">= </font><font color="#000080">nsoma </font><font color="#808080">+ (</font><font color="#000080">nvalor </font><font color="#808080">* (</font><font color="#FF0000">11 </font><font color="#808080">- </font><font color="#000080">ncont</font><font color="#808080">))
  </font><font color="#000080"><b>next </b>ncont
  <b>If </b></font><font color="#808080">(</font><font color="#000080">nsoma <b>mod </b></font><font color="#FF0000">11</font><font color="#808080">) = </font><font color="#FF0000">0 </font><font color="#000080"><b>Then
    </b>validaISBN </font><font color="#808080">= </font><font color="#000080">true
  <b>else
    </b>validaISBN </font><font color="#808080">= </font><font color="#000080">false
  <b>end if
Else
 </b>ValidaISBN </font><font color="#808080">= </font><font color="#000080">False
<b>End If
END FUNCTION

</b></font><font color="#808080"><i>'------------------------------------------------------------------------------
'Valida‡&AElig;o de um n&pound;mero qualquer.
'sRotulo - o texto antes de se digitar o n&pound;mero
'sNumero - a string com o valor do n&pound;mero
'retorna - o sNumero
'------------------------------------------------------------------------------
</i></font><font color="#000080"><b>FUNCTION </b>validaNumero$ </font><font color="#808080">(</font><font color="#000080">sRotulo <b>AS STRING</b></font><font color="#808080">, </font><font color="#000080">sNumero <b>AS STRING</b></font><font color="#808080">)
</font><font color="#000080"><b>DIM </b>nNum <b>AS DOUBLE
DIM </b>nStatus <b>AS INTEGER

</b>nStatus </font><font color="#808080">= -</font><font color="#FF0000">1
</font><font color="#000080"><b>DO WHILE </b></font><font color="#808080">(</font><font color="#000080">nStatus </font><font color="#808080">&lt;&gt; </font><font color="#FF0000">0</font><font color="#808080">)
  </font><font color="#000080"><b>PRINT </b>sRotulo</font><font color="#808080">;
  </font><font color="#000080"><b>INPUT </b></font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#000080">sNumero
  nNum </font><font color="#808080">= </font><font color="#000080"><b>VAL</b></font><font color="#808080">(</font><font color="#000080">sNumero</font><font color="#808080">)
  </font><font color="#000080"><b>IF </b>nNum </font><font color="#808080">&lt; </font><font color="#FF0000">1 </font><font color="#000080"><b>THEN
     PRINT </b>MSGNUMINV
  <b>ELSE
     </b>nStatus </font><font color="#808080">= </font><font color="#FF0000">0
  </font><font color="#000080"><b>END IF
LOOP
</b>validaNumero </font><font color="#808080">= </font><font color="#000080">sNumero
<b>END FUNCTION

</b></font><font color="#808080"><i>'------------------------------------------------------------------------------
'Escreve zeros na frente de um texto.
'stexto - o texto para receber zeros a frente
'ntam - o tamanho da string
'retorna - o texto com o zeros antes
'------------------------------------------------------------------------------
</i></font><font color="#000080"><b>FUNCTION </b>zeros$ </font><font color="#808080">(</font><font color="#000080">sTexto <b>AS STRING</b></font><font color="#808080">, </font><font color="#000080">ntam <b>AS INTEGER</b></font><font color="#808080">)
</font><font color="#000080"><b>DIM </b>nCont <b>AS INTEGER
DIM </b>saux <b>AS STRING

  </b>saux </font><font color="#808080">= </font><font color="#800000">&quot;&quot;
  </font><font color="#000080"><b>IF </b>ntam </font><font color="#808080">&lt;&gt; </font><font color="#000080"><b>LEN</b></font><font color="#808080">(</font><font color="#000080">sTexto</font><font color="#808080">) </font><font color="#000080"><b>THEN
      FOR </b>nCont </font><font color="#808080">= </font><font color="#FF0000">1 </font><font color="#000080"><b>TO </b>ntam </font><font color="#808080">- </font><font color="#000080"><b>LEN</b></font><font color="#808080">(</font><font color="#000080">sTexto</font><font color="#808080">)
</font>	<font color="#000080">saux </font><font color="#808080">= </font><font color="#000080">saux </font><font color="#808080">+ </font><font color="#800000">&quot;0&quot;
      </font><font color="#000080"><b>NEXT </b>nCont
  <b>END IF
  </b>zeros </font><font color="#808080">= </font><font color="#000080">saux </font><font color="#808080">+ </font><font color="#000080">sTexto
<b>END FUNCTION

</b></font></font>
</code></pre>
</body>
</html>