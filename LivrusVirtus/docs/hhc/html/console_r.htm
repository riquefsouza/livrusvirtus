<html>
<head>
<title>Livrus Virtus - Console - R</title>
</head>
<!-- Generated by ConTEXT HTML exporter -->
<body text="#000000" bgcolor="#FFFFFF">
<pre>
<code><font  face="Courier New"><font color="#008000">#------------------------------------------------------------------------------
# Sistema integrante do projeto Livrus Virtus.
# Todos os direitos reservados para Henrique F. de Souza.
# Vers&atilde;o programada na linguagem R.
#------------------------------------------------------------------------------
# programa Livrus

</font>tAssunto <font color="#808080">&lt;</font><font color="#808000">- </font><font color="#0000FF">list</font><font color="#808080">(</font>codigo=<font color="#800000">&quot;&quot;</font>, assunto=<font color="#800000">&quot;&quot;</font><font color="#808080">)
</font>tAutor <font color="#808080">&lt;</font><font color="#808000">- </font><font color="#0000FF">list</font><font color="#808080">(</font>codigo=<font color="#800000">&quot;&quot;</font>, autor=<font color="#800000">&quot;&quot;</font><font color="#808080">)
</font>tEditora <font color="#808080">&lt;</font><font color="#808000">- </font><font color="#0000FF">list</font><font color="#808080">(</font>codigo=<font color="#800000">&quot;&quot;</font>, editora=<font color="#800000">&quot;&quot;</font><font color="#808080">)
</font>tIdioma <font color="#808080">&lt;</font><font color="#808000">- </font><font color="#0000FF">list</font><font color="#808080">(</font>codigo=<font color="#800000">&quot;&quot;</font>, idioma=<font color="#800000">&quot;&quot;</font><font color="#808080">)
</font>tUsuario <font color="#808080">&lt;</font><font color="#808000">- </font><font color="#0000FF">list</font><font color="#808080">(</font>login=<font color="#800000">&quot;&quot;</font>, senha=<font color="#800000">&quot;&quot;</font><font color="#808080">)
</font>tPais <font color="#808080">&lt;</font><font color="#808000">- </font><font color="#0000FF">list</font><font color="#808080">(</font>codigo=<font color="#800000">&quot;&quot;</font>, pais=<font color="#800000">&quot;&quot;</font><font color="#808080">)
</font>tProfissao <font color="#808080">&lt;</font><font color="#808000">- </font><font color="#0000FF">list</font><font color="#808080">(</font>codigo=<font color="#800000">&quot;&quot;</font>, profissao=<font color="#800000">&quot;&quot;</font><font color="#808080">)
</font>tLivro <font color="#808080">&lt;</font><font color="#808000">- </font><font color="#0000FF">list</font><font color="#808080">(</font>isbn=<font color="#800000">&quot;&quot;</font>, titulo=<font color="#800000">&quot;&quot;</font>, edicao=<font color="#800000">&quot;&quot;</font>, anopubli=<font color="#800000">&quot;&quot;</font>, codeditora=<font color="#800000">&quot;&quot;</font>,
   volume=<font color="#800000">&quot;&quot;</font>, codidioma=<font color="#800000">&quot;&quot;</font>, npaginas=<font color="#800000">&quot;&quot;</font>, preco=<font color="#800000">&quot;&quot;</font>, qtdestoque=<font color="#800000">&quot;&quot;</font><font color="#808080">)
</font>tLivroAss <font color="#808080">&lt;</font><font color="#808000">- </font><font color="#0000FF">list</font><font color="#808080">(</font>isbn=<font color="#800000">&quot;&quot;</font>, codassunto=<font color="#800000">&quot;&quot;</font><font color="#808080">)
</font>tLivroAut <font color="#808080">&lt;</font><font color="#808000">- </font><font color="#0000FF">list</font><font color="#808080">(</font>isbn=<font color="#800000">&quot;&quot;</font>, codautor=<font color="#800000">&quot;&quot;</font><font color="#808080">)
</font>tCliente <font color="#808080">&lt;</font><font color="#808000">- </font><font color="#0000FF">list</font><font color="#808080">(</font>cpf=<font color="#800000">&quot;&quot;</font>, nome=<font color="#800000">&quot;&quot;</font>, email=<font color="#800000">&quot;&quot;</font>, identidade=<font color="#800000">&quot;&quot;</font>, sexo=<font color="#800000">&quot;&quot;</font>,
   telefone=<font color="#800000">&quot;&quot;</font>, dtnascimento=<font color="#800000">&quot;&quot;</font>, codendereco=<font color="#800000">&quot;&quot;</font>, codpais=<font color="#800000">&quot;&quot;</font>, codprofissao=<font color="#800000">&quot;&quot;</font><font color="#808080">)
</font>tEndereco <font color="#808080">&lt;</font><font color="#808000">- </font><font color="#0000FF">list</font><font color="#808080">(</font>codigo=<font color="#800000">&quot;&quot;</font>, logradouro=<font color="#800000">&quot;&quot;</font>, bairro=<font color="#800000">&quot;&quot;</font>, cep=<font color="#800000">&quot;&quot;</font>,
   cidade=<font color="#800000">&quot;&quot;</font>, estado=<font color="#800000">&quot;&quot;</font><font color="#808080">)
</font>tVenda <font color="#808080">&lt;</font><font color="#808000">- </font><font color="#0000FF">list</font><font color="#808080">(</font>dthrvenda=<font color="#800000">&quot;&quot;</font>,   <font color="#008000"># data/hora da venda dd/mm/yyyy hh:mm:ss
   </font>cpf=<font color="#800000">&quot;&quot;</font>, isbn=<font color="#800000">&quot;&quot;</font>, precovenda=<font color="#800000">&quot;&quot;</font><font color="#808080">)

</font><font color="#008000"># ctTipo 
</font>opTexto = 1; opNumero = 2; opData = 3; opDataHora = 4; opSenha = 5
<font color="#008000"># ctArqs 
</font>opAssunto = 1; opAutor = 2; opEditora = 3; opEndereco = 4; opIdioma = 5; 
opPais = 6; opProfissao = 7; opCliente = 8; opLivro = 9; opLivroAss = 10; 
opLivroAut = 11; opUsuario = 12; opVenda = 13 
<font color="#008000"># ctAcao
</font>opNovo = 1; opAlterar = 2; opPesquisar = 3; opSalvarInclusao = 4; 
opSalvarAlteracao = 5; opExcluir = 6; opConfirmaExclusao = 7; opListarTodos = 8

<font color="#008000"># Constantes
</font>CRLF = <font color="#800000">&quot;\n&quot; </font><font color="#008000"># windows
</font>TAM_CRLF = 2
<font color="#008000"># CRLF = &quot;\n&quot;
# TAM_CRLF = 1 # unix 
# CRLF = &quot;\n&quot;
# TAM_CRLF = 1 # macintosh 

</font>ARQ_ABRE = <font color="#800000">&quot;r+&quot;
</font>ARQ_CRIA = <font color="#800000">&quot;w+&quot;

</font>QTD_MAX_LINHA = 18

MSG_ARQERRO = <font color="#800000">&quot;Erro: O arquivo n&atilde;o pode ser aberto.\n&quot;
</font>MSG_ARQCERRO = <font color="#800000">&quot;Erro: O arquivo n&atilde;o pode ser criado.\n&quot;
</font>MSG_ERRO = <font color="#800000">&quot;Erro: op&ccedil;&atilde;o inv&aacute;lida digite de novo\n&quot;
</font>MSG_OPCAO = <font color="#800000">&quot;Escolha uma op&ccedil;&atilde;o: &quot;
</font>MSG_PRESS = <font color="#800000">&quot;pressione para continuar...&quot;

</font>MSG_REGINC = <font color="#800000">&quot;registro incluido!\n&quot;
</font>MSG_REGNINC = <font color="#800000">&quot;registro n&atilde;o incluido!\n&quot;
</font>MSG_REGALT = <font color="#800000">&quot;registro alterado!\n&quot;
</font>MSG_REGNALT = <font color="#800000">&quot;registro n&atilde;o alterado!\n&quot;
</font>MSG_REGEXC = <font color="#800000">&quot;registro excluido!\n&quot;
</font>MSG_REGNEXC = <font color="#800000">&quot;registro n&atilde;o excluido!\n&quot;
</font>MSG_REGEXST = <font color="#800000">&quot;registro j&aacute; existe!\n&quot;

</font>MSG_NUMINV = <font color="#800000">&quot;N&uacute;mero inv&aacute;lido ou menor do que 1!\n&quot;
</font>MSG_DATAINV = <font color="#800000">&quot;Data inv&aacute;lida!, formato correto (dd/mm/yyyy)\n&quot;
</font>MSG_DTHRINV = <font color="#800000">&quot;Data/hora inv&aacute;lida!, formato correto (dd/mm/yyyy hh:mm:ss)\n&quot;
</font>MSG_ISBNINV = <font color="#800000">&quot;ISBN inv&aacute;lido!\n&quot;
</font>MSG_CPFINV = <font color="#800000">&quot;CPF inv&aacute;lido!\n&quot;
</font>MSG_SENCONFERE = <font color="#800000">&quot;senha n&atilde;o confere com a senha atual!\n&quot;
</font>MSG_SENCONFIRM = <font color="#800000">&quot;nova senha n&atilde;o confere com a senha confirmada!\n&quot;
</font>MSG_LOGINENCON = <font color="#800000">&quot;login n&atilde;o encontrado!\n&quot;
</font>MSG_SEMESTOQUE = <font color="#800000">&quot;livro n&atilde;o existe no estoque!\n&quot;

</font>ARQ_ASSUNTO = <font color="#800000">&quot;c:\\temp\\assunto.dat&quot;
</font>ARQ_AUTOR = <font color="#800000">&quot;c:\\temp\\autor.dat&quot;
</font>ARQ_EDITORA = <font color="#800000">&quot;c:\\temp\\editora.dat&quot;
</font>ARQ_IDIOMA = <font color="#800000">&quot;c:\\temp\\idioma.dat&quot;
</font>ARQ_USUARIO = <font color="#800000">&quot;c:\\temp\\usuario.dat&quot;
</font>ARQ_PAIS = <font color="#800000">&quot;c:\\temp\\pais.dat&quot;
</font>ARQ_PROFISSAO = <font color="#800000">&quot;c:\\temp\\profissao.dat&quot;
</font>ARQ_LIVRO = <font color="#800000">&quot;c:\\temp\\livro.dat&quot;
</font>ARQ_LIVASS = <font color="#800000">&quot;c:\\temp\\livroass.dat&quot;
</font>ARQ_LIVAUT = <font color="#800000">&quot;c:\\temp\\livroaut.dat&quot;
</font>ARQ_CLIENTE = <font color="#800000">&quot;c:\\temp\\cliente.dat&quot;
</font>ARQ_ENDERECO = <font color="#800000">&quot;c:\\temp\\endereco.dat&quot;
</font>ARQ_VENDA = <font color="#800000">&quot;c:\\temp\\venda.dat&quot;

</font>TAM_ASSUNTO = 40
TAM_AUTOR = 40
TAM_EDITORA = 60
TAM_IDIOMA = 30
TAM_USUARIO = 20
TAM_PAIS = 53
TAM_PROFISSAO = 60
TAM_LIVRO = 143
TAM_LIVASS = 23
TAM_LIVAUT = 23
TAM_CLIENTE = 135
TAM_ENDERECO = 123
TAM_VENDA = 56

<font color="#008000"># variaveis
</font>bopcao = <font color="#0000FF">FALSE
</font>opmenu = <font color="#800000">&quot;&quot;
</font>g_nPosChave = 0; g_nTamChave = 0; g_nPosicao = 0
g_nPreco = 0.0
g_SalvarInclusao = <font color="#0000FF">FALSE

</font>tfAssunto = <font color="#0000FF">file</font><font color="#808080">(</font>ARQ_ASSUNTO<font color="#808080">)
</font>tfAutor = <font color="#0000FF">file</font><font color="#808080">(</font>ARQ_AUTOR<font color="#808080">)
</font>tfEditora = <font color="#0000FF">file</font><font color="#808080">(</font>ARQ_EDITORA<font color="#808080">)
</font>tfIdioma = <font color="#0000FF">file</font><font color="#808080">(</font>ARQ_IDIOMA<font color="#808080">)
</font>tfEndereco = <font color="#0000FF">file</font><font color="#808080">(</font>ARQ_ENDERECO<font color="#808080">)
</font>tfPais = <font color="#0000FF">file</font><font color="#808080">(</font>ARQ_PAIS<font color="#808080">)
</font>tfProfissao = <font color="#0000FF">file</font><font color="#808080">(</font>ARQ_PROFISSAO<font color="#808080">)
</font>tfLivro = <font color="#0000FF">file</font><font color="#808080">(</font>ARQ_LIVRO<font color="#808080">)
</font>tfLivroAss = <font color="#0000FF">file</font><font color="#808080">(</font>ARQ_LIVASS<font color="#808080">)
</font>tfLivroAut = <font color="#0000FF">file</font><font color="#808080">(</font>ARQ_LIVAUT<font color="#808080">)
</font>tfCliente = <font color="#0000FF">file</font><font color="#808080">(</font>ARQ_CLIENTE<font color="#808080">)
</font>tfUsuario = <font color="#0000FF">file</font><font color="#808080">(</font>ARQ_USUARIO<font color="#808080">)
</font>tfVenda = <font color="#0000FF">file</font><font color="#808080">(</font>ARQ_VENDA<font color="#808080">)

</font><font color="#008000">#------------------------------------------------------------------------------
# Atribui uma variavel ao ambiente global.
# variavel - a variavel a ser atribuida
# valor - o valor da variavel global
#------------------------------------------------------------------------------
</font>ag <font color="#808080">&lt;</font><font color="#808000">- </font><font color="#0000FF">function</font><font color="#808080">(</font>variavel,valor<font color="#808080">) {
  </font><font color="#0000FF">assign</font><font color="#808080">(</font>variavel, valor, env=globalenv<font color="#808080">())
}
</font><font color="#008000">#------------------------------------------------------------------------------
# pega o valor de uma variavel do ambiente global.
# variavel - a variavel a ser pego o valor
# retorna - o valor da variavel global
#------------------------------------------------------------------------------
</font>gg <font color="#808080">&lt;</font><font color="#808000">- </font><font color="#0000FF">function</font><font color="#808080">(</font>variavel<font color="#808080">) {
 </font>gg = <font color="#0000FF">get</font><font color="#808080">(</font>variavel, env=globalenv<font color="#808080">())
}
</font><font color="#008000">#------------------------------------------------------------------------------
# Retira os espa&ccedil;os em branco antes ou depois do texto.
# sTexto - o texto a ser retirado os espa&ccedil;os em branco
# retorna - o texto sem os espa&ccedil;os em branco
#------------------------------------------------------------------------------
</font>trim <font color="#808080">&lt;</font><font color="#808000">- </font><font color="#0000FF">function</font><font color="#808080">(</font>sTexto<font color="#808080">) {
</font>trim = <font color="#0000FF">sub</font><font color="#808080">(</font><font color="#800000">' +$'</font>, <font color="#800000">''</font>, sTexto<font color="#808080">)
}

</font><font color="#008000">#------------------------------------------------------------------------------
# Repete um texto um n&uacute;mero determinado de vezes.
# sTexto - o texto a ser repetido
# nQtd - a quantidade de vezes
# retorna - o texto repetido
#------------------------------------------------------------------------------
</font>repete <font color="#808080">&lt;</font><font color="#808000">- </font><font color="#0000FF">function</font><font color="#808080">(</font>sTexto, nQtd<font color="#808080">) {
</font>ncont = 0
sret=<font color="#800000">&quot;&quot;
</font><font color="#0000FF">for </font><font color="#808080">(</font>ncont <font color="#0000FF">in </font>1<font color="#808080">:</font>nQtd<font color="#808080">) {
  </font>sret=paste<font color="#808080">(</font>sret,sTexto, sep = <font color="#800000">&quot;&quot;</font><font color="#808080">)
}
</font>repete = sret
<font color="#808080">}
</font><font color="#008000">#------------------------------------------------------------------------------
# Coloca espa&ccedil;os em branco a mais de acordo com o tamanho m&aacute;ximo do texto.
# sTexto - o texto
# nTam - tamanho m&aacute;ximo do texto
# retorna - o texto com espa&ccedil;os em branco a mais
#------------------------------------------------------------------------------
</font>esp <font color="#808080">&lt;</font><font color="#808000">- </font><font color="#0000FF">function</font><font color="#808080">(</font>sTexto, nTam<font color="#808080">) {
 </font>esp = <font color="#0000FF">paste</font><font color="#808080">(</font>sTexto,repete<font color="#808080">(</font><font color="#800000">&quot; &quot;</font>,nTam-nchar<font color="#808080">(</font>sTexto<font color="#808080">))</font>, sep=<font color="#800000">&quot;&quot;</font><font color="#808080">)
}
</font><font color="#008000">#------------------------------------------------------------------------------
# Faz uma pesquisa relativa de um texto atrav&eacute;s de um valor chave.
# sTexto - o texto
# sChave - a chave a ser pesquisada
# retorna - se achou ou n&atilde;o a chave dentro do texto
#------------------------------------------------------------------------------
</font>strRelativa <font color="#808080">&lt;</font><font color="#808000">- </font><font color="#0000FF">function</font><font color="#808080">(</font>sTexto, sChave<font color="#808080">) {
  </font><font color="#0000FF">if </font><font color="#808080">(</font><font color="#0000FF">length</font><font color="#808080">(</font><font color="#0000FF">grep</font><font color="#808080">(</font>sChave, sTexto, ignore.case = <font color="#0000FF">TRUE</font><font color="#808080">)) &gt; </font>0<font color="#808080">)
    </font>strRelativa = <font color="#0000FF">TRUE
  else 
    </font>strRelativa = <font color="#0000FF">FALSE
</font><font color="#808080">}
</font><font color="#008000">#------------------------------------------------------------------------------
# Fun&ccedil;&atilde;o que retorna um peda&ccedil;o de uma string.
# str - indica a string
# nini - indica a posicao inicial do pedaco
# ntam - indica o tamanho do pedaco
# retorna - o peda&ccedil;o da string
#------------------------------------------------------------------------------
</font>copy <font color="#808080">&lt;</font><font color="#808000">- </font><font color="#0000FF">function</font><font color="#808080">(</font><font color="#0000FF">str</font>, nini, ntam<font color="#808080">) {
  </font>copy = <font color="#0000FF">substr</font><font color="#808080">(</font><font color="#0000FF">str</font>,nini,ntam+nini-1<font color="#808080">) 
}
</font><font color="#008000">#------------------------------------------------------------------------------
# Calcula o modulo11 de um valor qualquer.
# svalor - a mstring com o n&uacute;mero a ser calculado
# ndig - d&iacute;gito do valor a ser calculado
# retorna - o d&iacute;gito correto
#------------------------------------------------------------------------------
</font>modulo11 <font color="#808080">&lt;</font><font color="#808000">- </font><font color="#0000FF">function</font><font color="#808080">(</font>svalor, ndig<font color="#808080">) {
 </font>ncont = 1
 slocal = <font color="#800000">&quot;&quot;
 </font><font color="#0000FF">while </font><font color="#808080">(</font>ncont <font color="#808080">&lt;</font>= 11<font color="#808080">) {
   </font>slocal = <font color="#0000FF">paste</font><font color="#808080">(</font>copy<font color="#808080">(</font>svalor,ncont,1<font color="#808080">)</font>, slocal, sep=<font color="#800000">&quot;&quot;</font><font color="#808080">)
   </font>ncont = ncont <font color="#808000">+ </font>1
 <font color="#808080">}
 </font>nsoma=0
 <font color="#0000FF">if </font><font color="#808080">(</font>ndig == 1<font color="#808080">)
   </font>ncont = 3
 <font color="#0000FF">else
   </font>ncont = 2
 npos = 2
 <font color="#0000FF">while </font><font color="#808080">(</font>ncont <font color="#808080">&lt;</font>= 11<font color="#808080">) {
   </font>sres=copy<font color="#808080">(</font>slocal,ncont,1<font color="#808080">)
   </font>nvalor = <font color="#0000FF">as.integer</font><font color="#808080">(</font>sres<font color="#808080">)
   </font>nsoma=nsoma <font color="#808000">+ </font><font color="#808080">(</font>nvalor <font color="#808080">* </font>npos<font color="#808080">)
   </font>ncont=ncont+1
   npos=npos+1
 <font color="#808080">}
 </font>nsoma=<font color="#808080">(</font>11 <font color="#808000">- </font><font color="#808080">(</font>nsoma %% 11<font color="#808080">))

</font><font color="#0000FF">if </font><font color="#808080">(</font>nsoma <font color="#808080">&gt; </font>9<font color="#808080">)
  </font>modulo11 = 0
<font color="#0000FF">else
  </font>modulo11 = nsoma
<font color="#808080">}
</font><font color="#008000">#------------------------------------------------------------------------------
# Valida&ccedil;&atilde;o de um n&uacute;mero de CPF qualquer.
# cpf - a mstring com o n&uacute;mero do CPF
# retorna - se &eacute; valido ou n&atilde;o
#------------------------------------------------------------------------------
</font>validaCPF <font color="#808080">&lt;</font><font color="#808000">- </font><font color="#0000FF">function</font><font color="#808080">(</font>cpf<font color="#808080">) {
  </font><font color="#0000FF">if </font><font color="#808080">(</font><font color="#0000FF">nchar</font><font color="#808080">(</font>cpf<font color="#808080">)</font>==14<font color="#808080">) {
    </font>scpf=paste<font color="#808080">(</font>copy<font color="#808080">(</font>cpf,1,3<font color="#808080">)</font>,copy<font color="#808080">(</font>cpf,5,3<font color="#808080">)</font>,copy<font color="#808080">(</font>cpf,9,3<font color="#808080">)</font>,
               copy<font color="#808080">(</font>cpf,13,2<font color="#808080">)</font>, sep=<font color="#800000">&quot;&quot;</font><font color="#808080">)
    </font>sres=copy<font color="#808080">(</font>cpf,13,1<font color="#808080">)
    </font>nvalor1 = <font color="#0000FF">as.integer</font><font color="#808080">(</font>sres<font color="#808080">)
    </font>sres=copy<font color="#808080">(</font>cpf,14,1<font color="#808080">)
    </font>nvalor2 = <font color="#0000FF">as.integer</font><font color="#808080">(</font>sres<font color="#808080">)
    </font><font color="#0000FF">if </font><font color="#808080">((</font>modulo11<font color="#808080">(</font>scpf,1<font color="#808080">)</font>==nvalor1<font color="#808080">) </font><font color="#808000">&amp;&amp; </font><font color="#808080">(</font>modulo11<font color="#808080">(</font>scpf,2<font color="#808080">)</font>==nvalor2<font color="#808080">)) 
      </font>validaCPF = <font color="#0000FF">TRUE
    else
      </font>validaCPF = <font color="#0000FF">FALSE
  </font><font color="#808080">} </font><font color="#0000FF">else
    </font>validaCPF = <font color="#0000FF">FALSE
</font><font color="#808080">}
</font><font color="#008000">#------------------------------------------------------------------------------
# Valida&ccedil;&atilde;o de um n&uacute;mero ISBN qualquer.
# isbn - a mstring com o n&uacute;mero do ISBN
# retorna - se &eacute; valido ou n&atilde;o
#------------------------------------------------------------------------------
</font>validaISBN <font color="#808080">&lt;</font><font color="#808000">- </font><font color="#0000FF">function</font><font color="#808080">(</font>isbn<font color="#808080">) {
  </font><font color="#0000FF">if </font><font color="#808080">(</font><font color="#0000FF">nchar</font><font color="#808080">(</font>isbn<font color="#808080">)</font>==13<font color="#808080">) {
    </font>sdigito = copy<font color="#808080">(</font>isbn, <font color="#0000FF">nchar</font><font color="#808080">(</font>isbn<font color="#808080">)</font>, 1<font color="#808080">)
    </font>sisbn = <font color="#800000">&quot;&quot;
    </font><font color="#0000FF">for </font><font color="#808080">(</font>ncont <font color="#0000FF">in </font>1<font color="#808080">:(</font><font color="#0000FF">nchar</font><font color="#808080">(</font>isbn<font color="#808080">)</font>-1<font color="#808080">)) {
      </font><font color="#0000FF">if </font><font color="#808080">(</font>copy<font color="#808080">(</font>isbn,ncont,1<font color="#808080">)</font><font color="#808000">!=</font><font color="#800000">&quot;-&quot;</font><font color="#808080">)
        </font>sisbn = <font color="#0000FF">paste</font><font color="#808080">(</font>sisbn, copy<font color="#808080">(</font>isbn,ncont,1<font color="#808080">)</font>, sep=<font color="#800000">&quot;&quot;</font><font color="#808080">)
    }
    </font><font color="#0000FF">if </font><font color="#808080">(</font>sdigito == <font color="#800000">&quot;X&quot;</font><font color="#808080">)
      </font>nsoma = 10
    <font color="#0000FF">else </font><font color="#808080">{
      </font>nvalor = <font color="#0000FF">as.integer</font><font color="#808080">(</font>sdigito<font color="#808080">)
      </font>nsoma = nvalor
    <font color="#808080">}
    </font><font color="#0000FF">for</font><font color="#808080">(</font>ncont <font color="#0000FF">in </font>1<font color="#808080">:</font>9<font color="#808080">) {
      </font>snum=copy<font color="#808080">(</font>sisbn, ncont, 1<font color="#808080">)
      </font>nvalor = <font color="#0000FF">as.integer</font><font color="#808080">(</font>snum<font color="#808080">)
      </font>nsoma=nsoma <font color="#808000">+ </font><font color="#808080">(</font>nvalor <font color="#808080">* (</font>11 <font color="#808000">- </font>ncont<font color="#808080">))
    }
    </font><font color="#0000FF">if </font><font color="#808080">((</font>nsoma %% 11<font color="#808080">) </font>== 0<font color="#808080">)
      </font>validaISBN=TRUE
    <font color="#0000FF">else
      </font>validaISBN=FALSE
  <font color="#808080">} </font><font color="#0000FF">else
    </font>validaISBN=FALSE
<font color="#808080">}
</font><font color="#008000">#------------------------------------------------------------------------------
# Esconde a digita&ccedil;&atilde;o da senha
# retorna - a senha digitada
#------------------------------------------------------------------------------
</font>digitaSenha <font color="#808080">&lt;</font><font color="#808000">- </font><font color="#0000FF">function</font><font color="#808080">(</font>sRotulo, nTamSenha<font color="#808080">) {
  </font>sSenha = <font color="#0000FF">readline</font><font color="#808080">(</font>sRotulo<font color="#808080">)
  </font><font color="#008000">#  ncont = 0
  #  sSenha=&quot;&quot;
  #  sLetra='\0'
  #  while ((sLetra!='\r') &amp;&amp; (ncont &lt; nTamSenha)) {
  #    sLetra=readkey
  #    sSenha= paste(sSenha, sLetra, sep=&quot;&quot;)
  #    ncont=ncont+1
  #  }
  </font>digitaSenha = sSenha
<font color="#808080">}
</font><font color="#008000">#------------------------------------------------------------------------------
# Valida&ccedil;&atilde;o de um n&uacute;mero qualquer.
# sRotulo - o texto antes de se digitar o n&uacute;mero
# sNumero - a mstring com o valor do n&uacute;mero
# retorna - o sNumero
#------------------------------------------------------------------------------
</font>validaNumero <font color="#808080">&lt;</font><font color="#808000">- </font><font color="#0000FF">function</font><font color="#808080">(</font>sRotulo, sNumero<font color="#808080">) {
  </font>nStatus=-1
  <font color="#0000FF">while </font><font color="#808080">(</font>nStatus!=0<font color="#808080">) {
    </font>sNumero = <font color="#0000FF">readline</font><font color="#808080">(</font>sRotulo<font color="#808080">)
    </font>nnum = <font color="#0000FF">as.real</font><font color="#808080">(</font>sNumero<font color="#808080">)
    </font><font color="#0000FF">if </font><font color="#808080">(</font>!is.na<font color="#808080">(</font>nnum<font color="#808080">)) {
      </font><font color="#0000FF">if </font><font color="#808080">(</font>nnum <font color="#808080">&lt; </font>0.01<font color="#808080">) 
        </font><font color="#0000FF">cat</font><font color="#808080">(</font>MSG_NUMINV<font color="#808080">)
      </font><font color="#0000FF">else
        </font>nStatus = 0
    <font color="#808080">} </font><font color="#0000FF">else
        cat</font><font color="#808080">(</font>MSG_NUMINV<font color="#808080">)
  }
  </font>validaNumero = sNumero
<font color="#808080">}
</font><font color="#008000">#------------------------------------------------------------------------------
# Valida&ccedil;&atilde;o de uma data ou data/hora qualquer.
# sRotulo - o texto antes de se digitar a data/hora
# sDataHora - a mstring com o valor da data/hora
# bSoData - indica se vai validar somente uma data sem a hora
# retorna - a sDataHora
#------------------------------------------------------------------------------
</font>validaDataHora <font color="#808080">&lt;</font><font color="#808000">- </font><font color="#0000FF">function</font><font color="#808080">(</font>sRotulo, sDataHora, bSoData<font color="#808080">) {

</font>bvalida = <font color="#0000FF">FALSE
</font>bdatavalida = <font color="#0000FF">FALSE
</font>bhoravalida = <font color="#0000FF">FALSE
</font>nudiames = 0
<font color="#0000FF">if </font><font color="#808080">(</font>bSoData==TRUE<font color="#808080">) </font>ntam=10
<font color="#0000FF">else </font>ntam=19
<font color="#0000FF">while </font><font color="#808080">(</font>bvalida==FALSE<font color="#808080">) {
  </font>sDataHora = <font color="#0000FF">readline</font><font color="#808080">(</font>sRotulo<font color="#808080">)
  </font><font color="#0000FF">if </font><font color="#808080">(</font><font color="#0000FF">nchar</font><font color="#808080">(</font>sDataHora<font color="#808080">)</font>==ntam<font color="#808080">) {
    </font>sdia = copy<font color="#808080">(</font>sDataHora,1,2<font color="#808080">)
    </font>ndia = <font color="#0000FF">as.integer</font><font color="#808080">(</font>sdia<font color="#808080">)
    </font>smes = copy<font color="#808080">(</font>sDataHora,4,2<font color="#808080">)
    </font>nmes = <font color="#0000FF">as.integer</font><font color="#808080">(</font>smes<font color="#808080">)
    </font>sano = copy<font color="#808080">(</font>sDataHora,7,4<font color="#808080">)
    </font>nano = <font color="#0000FF">as.integer</font><font color="#808080">(</font>sano<font color="#808080">)
  
    </font><font color="#0000FF">if </font><font color="#808080">((</font>nano <font color="#808080">&gt;</font>= 1<font color="#808080">) </font><font color="#808000">&amp;&amp; </font><font color="#808080">(</font>nano <font color="#808080">&lt;</font>= 9999<font color="#808080">)) {
      </font><font color="#0000FF">if </font><font color="#808080">((</font>nmes <font color="#808080">&gt;</font>= 1<font color="#808080">) </font><font color="#808000">&amp;&amp; </font><font color="#808080">(</font>nmes <font color="#808080">&lt;</font>= 31<font color="#808080">)) {
          </font><font color="#0000FF">if </font><font color="#808080">(</font>nmes == 1 || nmes == 3 || nmes == 5 || nmes == 7 || 
              nmes == 8 || nmes == 10 || nmes == 12<font color="#808080">) 
             </font>nudiames = 31
          <font color="#0000FF">else if </font><font color="#808080">(</font>nmes == 2<font color="#808080">) {
               </font><font color="#008000"># ano bissexto 
               </font><font color="#0000FF">if </font><font color="#808080">((</font>nano %% 4<font color="#808080">)</font>==0<font color="#808080">) </font>nudiames = 29
               <font color="#0000FF">else </font>nudiames = 28
          <font color="#808080">} </font><font color="#0000FF">else if </font><font color="#808080">(</font>nmes == 4 || nmes == 6 || nmes == 9 || nmes == 11<font color="#808080">)
             </font>nudiames = 30

          <font color="#0000FF">if </font><font color="#808080">((</font>ndia <font color="#808080">&gt;</font>=1<font color="#808080">) </font><font color="#808000">&amp;&amp; </font><font color="#808080">(</font>ndia <font color="#808080">&lt;</font>=nudiames<font color="#808080">))
             </font>bdatavalida = <font color="#0000FF">TRUE
      </font><font color="#808080">}
    }
  
    </font><font color="#0000FF">if </font><font color="#808080">(</font>bSoData<font color="#808080">) {
       </font><font color="#0000FF">if </font><font color="#808080">(</font>bdatavalida<font color="#808080">) 
         </font>bvalida = <font color="#0000FF">TRUE
       else 
</font>  		   <font color="#0000FF">cat</font><font color="#808080">(</font>MSG_DATAINV<font color="#808080">)
    } </font><font color="#0000FF">else </font><font color="#808080">{
      </font><font color="#0000FF">if </font><font color="#808080">(</font>bdatavalida<font color="#808080">) {
          </font>shora = copy<font color="#808080">(</font>sDataHora,12,2<font color="#808080">)
          </font>nhora = <font color="#0000FF">as.integer</font><font color="#808080">(</font>shora<font color="#808080">)
          </font>smin = copy<font color="#808080">(</font>sDataHora,15,2<font color="#808080">)
          </font>nmin = <font color="#0000FF">as.integer</font><font color="#808080">(</font>smin<font color="#808080">)
          </font>sseg = copy<font color="#808080">(</font>sDataHora,18,2<font color="#808080">)
          </font>nseg = <font color="#0000FF">as.integer</font><font color="#808080">(</font>sseg<font color="#808080">)
  
          </font><font color="#0000FF">if </font><font color="#808080">((</font>nhora <font color="#808080">&gt;</font>= 0<font color="#808080">) </font><font color="#808000">&amp;&amp; </font><font color="#808080">(</font>nhora <font color="#808080">&lt;</font>= 23<font color="#808080">)) {
            </font><font color="#0000FF">if </font><font color="#808080">((</font>nmin <font color="#808080">&gt;</font>= 0<font color="#808080">) </font><font color="#808000">&amp;&amp; </font><font color="#808080">(</font>nmin <font color="#808080">&lt;</font>= 59<font color="#808080">)) {
              </font><font color="#0000FF">if </font><font color="#808080">((</font>nseg <font color="#808080">&gt;</font>= 0<font color="#808080">) </font><font color="#808000">&amp;&amp; </font><font color="#808080">(</font>nseg <font color="#808080">&lt;</font>= 59<font color="#808080">))
                 </font>bhoravalida = <font color="#0000FF">TRUE
            </font><font color="#808080">}
          }
          
          </font><font color="#0000FF">if </font><font color="#808080">(</font>bhoravalida<font color="#808080">) 
</font>  		      bvalida = <font color="#0000FF">TRUE
          else 
            cat</font><font color="#808080">(</font>MSG_DTHRINV<font color="#808080">)
      } </font><font color="#0000FF">else
        cat</font><font color="#808080">(</font>MSG_DTHRINV<font color="#808080">)
    }
  } </font><font color="#0000FF">else </font><font color="#808080">{
    </font><font color="#0000FF">if </font><font color="#808080">(</font>bSoData==TRUE<font color="#808080">) </font><font color="#0000FF">cat</font><font color="#808080">(</font>MSG_DATAINV<font color="#808080">)
    </font><font color="#0000FF">else cat</font><font color="#808080">(</font>MSG_DTHRINV<font color="#808080">)
  }
}
</font>validaDataHora = sDataHora
<font color="#808080">}
</font><font color="#008000">#------------------------------------------------------------------------------
# Retorna a Data e a hora do sistema.
# retorna - a data e a hora
#------------------------------------------------------------------------------
</font>retDataHora <font color="#808080">&lt;</font><font color="#808000">- </font><font color="#0000FF">function</font><font color="#808080">() {
  </font>retDataHora = <font color="#0000FF">format</font><font color="#808080">(</font><font color="#0000FF">Sys.time</font><font color="#808080">()</font>, <font color="#800000">&quot;%d/%m/%Y %H:%M:%S&quot;</font><font color="#808080">)
}
</font><font color="#008000">#------------------------------------------------------------------------------
# Calcula o tamanho do arquivo.
# sArq - o arquivo
# retorna - o tamanho do arquivo
#------------------------------------------------------------------------------
</font>tamArq <font color="#808080">&lt;</font><font color="#808000">- </font><font color="#0000FF">function</font><font color="#808080">(</font>sArq<font color="#808080">) {
  </font>tamArq = <font color="#0000FF">file.info</font><font color="#808080">(</font>ARQ_ASSUNTO<font color="#808080">)[[</font>1<font color="#808080">]]
}

</font>existeArqs <font color="#808080">&lt;</font><font color="#808000">- </font><font color="#0000FF">function</font><font color="#808080">() {
  </font><font color="#0000FF">if </font><font color="#808080">(</font><font color="#0000FF">file.exists</font><font color="#808080">(</font>ARQ_ASSUNTO<font color="#808080">)</font>==FALSE<font color="#808080">) </font><font color="#0000FF">file.create</font><font color="#808080">(</font>ARQ_ASSUNTO<font color="#808080">)
  </font><font color="#0000FF">if </font><font color="#808080">(</font><font color="#0000FF">file.exists</font><font color="#808080">(</font>ARQ_AUTOR<font color="#808080">)</font>==FALSE<font color="#808080">) </font><font color="#0000FF">file.create</font><font color="#808080">(</font>ARQ_AUTOR<font color="#808080">)
  </font><font color="#0000FF">if </font><font color="#808080">(</font><font color="#0000FF">file.exists</font><font color="#808080">(</font>ARQ_EDITORA<font color="#808080">)</font>==FALSE<font color="#808080">) </font><font color="#0000FF">file.create</font><font color="#808080">(</font>ARQ_EDITORA<font color="#808080">)
  </font><font color="#0000FF">if </font><font color="#808080">(</font><font color="#0000FF">file.exists</font><font color="#808080">(</font>ARQ_IDIOMA<font color="#808080">)</font>==FALSE<font color="#808080">) </font><font color="#0000FF">file.create</font><font color="#808080">(</font>ARQ_IDIOMA<font color="#808080">)
  </font><font color="#0000FF">if </font><font color="#808080">(</font><font color="#0000FF">file.exists</font><font color="#808080">(</font>ARQ_ENDERECO<font color="#808080">)</font>==FALSE<font color="#808080">) </font><font color="#0000FF">file.create</font><font color="#808080">(</font>ARQ_ENDERECO<font color="#808080">)
  </font><font color="#0000FF">if </font><font color="#808080">(</font><font color="#0000FF">file.exists</font><font color="#808080">(</font>ARQ_PAIS<font color="#808080">)</font>==FALSE<font color="#808080">) </font><font color="#0000FF">file.create</font><font color="#808080">(</font>ARQ_PAIS<font color="#808080">)
  </font><font color="#0000FF">if </font><font color="#808080">(</font><font color="#0000FF">file.exists</font><font color="#808080">(</font>ARQ_PROFISSAO<font color="#808080">)</font>==FALSE<font color="#808080">) </font><font color="#0000FF">file.create</font><font color="#808080">(</font>ARQ_PROFISSAO<font color="#808080">)
  </font><font color="#0000FF">if </font><font color="#808080">(</font><font color="#0000FF">file.exists</font><font color="#808080">(</font>ARQ_LIVRO<font color="#808080">)</font>==FALSE<font color="#808080">) </font><font color="#0000FF">file.create</font><font color="#808080">(</font>ARQ_LIVRO<font color="#808080">)
  </font><font color="#0000FF">if </font><font color="#808080">(</font><font color="#0000FF">file.exists</font><font color="#808080">(</font>ARQ_LIVASS<font color="#808080">)</font>==FALSE<font color="#808080">) </font><font color="#0000FF">file.create</font><font color="#808080">(</font>ARQ_LIVASS<font color="#808080">)
  </font><font color="#0000FF">if </font><font color="#808080">(</font><font color="#0000FF">file.exists</font><font color="#808080">(</font>ARQ_LIVAUT<font color="#808080">)</font>==FALSE<font color="#808080">) </font><font color="#0000FF">file.create</font><font color="#808080">(</font>ARQ_LIVAUT<font color="#808080">)
  </font><font color="#0000FF">if </font><font color="#808080">(</font><font color="#0000FF">file.exists</font><font color="#808080">(</font>ARQ_CLIENTE<font color="#808080">)</font>==FALSE<font color="#808080">) </font><font color="#0000FF">file.create</font><font color="#808080">(</font>ARQ_CLIENTE<font color="#808080">)
  </font><font color="#0000FF">if </font><font color="#808080">(</font><font color="#0000FF">file.exists</font><font color="#808080">(</font>ARQ_USUARIO<font color="#808080">)</font>==FALSE<font color="#808080">) </font><font color="#0000FF">file.create</font><font color="#808080">(</font>ARQ_USUARIO<font color="#808080">)
  </font><font color="#0000FF">if </font><font color="#808080">(</font><font color="#0000FF">file.exists</font><font color="#808080">(</font>ARQ_VENDA<font color="#808080">)</font>==FALSE<font color="#808080">) </font><font color="#0000FF">file.create</font><font color="#808080">(</font>ARQ_VENDA<font color="#808080">)

}

</font><font color="#008000">#------------------------------------------------------------------------------
# Abre ou cria os arquivos do sistema.
# bAbre - condi&ccedil;&atilde;o para abrir ou criar os arquivos do sistema
#------------------------------------------------------------------------------
</font>abrecriaArqs <font color="#808080">&lt;</font><font color="#808000">- </font><font color="#0000FF">function</font><font color="#808080">(</font>bAbre<font color="#808080">) {
</font><font color="#0000FF">if </font><font color="#808080">(</font>bAbre<font color="#808080">) {
  </font><font color="#0000FF">open</font><font color="#808080">(</font>tfAssunto, ARQ_ABRE<font color="#808080">)
  </font><font color="#0000FF">if </font><font color="#808080">(</font><font color="#0000FF">isOpen</font><font color="#808080">(</font>tfAssunto<font color="#808080">)</font>==FALSE<font color="#808080">) {
    </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#0000FF">sprintf</font><font color="#808080">(</font><font color="#800000">&quot;%s --&gt; %s\n&quot;</font>,MSG_ARQERRO,ARQ_ASSUNTO<font color="#808080">))
    </font><font color="#0000FF">quit</font><font color="#808080">() 
  }
  </font><font color="#0000FF">open</font><font color="#808080">(</font>tfAutor, ARQ_ABRE<font color="#808080">)
  </font><font color="#0000FF">if </font><font color="#808080">(</font><font color="#0000FF">isOpen</font><font color="#808080">(</font>tfAutor<font color="#808080">)</font>==FALSE<font color="#808080">) {
    </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#0000FF">sprintf</font><font color="#808080">(</font><font color="#800000">&quot;%s --&gt; %s\n&quot;</font>,MSG_ARQERRO,ARQ_AUTOR<font color="#808080">))
    </font><font color="#0000FF">quit</font><font color="#808080">() 
  }
  </font><font color="#0000FF">open</font><font color="#808080">(</font>tfEditora, ARQ_ABRE<font color="#808080">)
  </font><font color="#0000FF">if </font><font color="#808080">(</font><font color="#0000FF">isOpen</font><font color="#808080">(</font>tfEditora<font color="#808080">)</font>==FALSE<font color="#808080">) {
    </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#0000FF">sprintf</font><font color="#808080">(</font><font color="#800000">&quot;%s --&gt; %s\n&quot;</font>,MSG_ARQERRO,ARQ_EDITORA<font color="#808080">))
    </font><font color="#0000FF">quit</font><font color="#808080">() 
  }
  </font><font color="#0000FF">open</font><font color="#808080">(</font>tfIdioma, ARQ_ABRE<font color="#808080">)
  </font><font color="#0000FF">if </font><font color="#808080">(</font><font color="#0000FF">isOpen</font><font color="#808080">(</font>tfIdioma<font color="#808080">)</font>==FALSE<font color="#808080">) {
    </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#0000FF">sprintf</font><font color="#808080">(</font><font color="#800000">&quot;%s --&gt; %s\n&quot;</font>,MSG_ARQERRO,ARQ_IDIOMA<font color="#808080">))
    </font><font color="#0000FF">quit</font><font color="#808080">() 
  }
  </font><font color="#0000FF">open</font><font color="#808080">(</font>tfEndereco, ARQ_ABRE<font color="#808080">)
  </font><font color="#0000FF">if </font><font color="#808080">(</font><font color="#0000FF">isOpen</font><font color="#808080">(</font>tfEndereco<font color="#808080">)</font>==FALSE<font color="#808080">) {
    </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#0000FF">sprintf</font><font color="#808080">(</font><font color="#800000">&quot;%s --&gt; %s\n&quot;</font>,MSG_ARQERRO,ARQ_ENDERECO<font color="#808080">))
    </font><font color="#0000FF">quit</font><font color="#808080">() 
  }
  </font><font color="#0000FF">open</font><font color="#808080">(</font>tfPais, ARQ_ABRE<font color="#808080">)
  </font><font color="#0000FF">if </font><font color="#808080">(</font><font color="#0000FF">isOpen</font><font color="#808080">(</font>tfPais<font color="#808080">)</font>==FALSE<font color="#808080">) {
    </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#0000FF">sprintf</font><font color="#808080">(</font><font color="#800000">&quot;%s --&gt; %s\n&quot;</font>,MSG_ARQERRO,ARQ_PAIS<font color="#808080">))
    </font><font color="#0000FF">quit</font><font color="#808080">() 
  }
  </font><font color="#0000FF">open</font><font color="#808080">(</font>tfProfissao, ARQ_ABRE<font color="#808080">)
  </font><font color="#0000FF">if </font><font color="#808080">(</font><font color="#0000FF">isOpen</font><font color="#808080">(</font>tfProfissao<font color="#808080">)</font>==FALSE<font color="#808080">) {
    </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#0000FF">sprintf</font><font color="#808080">(</font><font color="#800000">&quot;%s --&gt; %s\n&quot;</font>,MSG_ARQERRO,ARQ_PROFISSAO<font color="#808080">))
    </font><font color="#0000FF">quit</font><font color="#808080">() 
  }
  </font><font color="#0000FF">open</font><font color="#808080">(</font>tfLivro, ARQ_ABRE<font color="#808080">)
  </font><font color="#0000FF">if </font><font color="#808080">(</font><font color="#0000FF">isOpen</font><font color="#808080">(</font>tfLivro<font color="#808080">)</font>==FALSE<font color="#808080">) {
    </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#0000FF">sprintf</font><font color="#808080">(</font><font color="#800000">&quot;%s --&gt; %s\n&quot;</font>,MSG_ARQERRO,ARQ_LIVRO<font color="#808080">))
    </font><font color="#0000FF">quit</font><font color="#808080">() 
  }
  </font><font color="#0000FF">open</font><font color="#808080">(</font>tfLivroAss, ARQ_ABRE<font color="#808080">)
  </font><font color="#0000FF">if </font><font color="#808080">(</font><font color="#0000FF">isOpen</font><font color="#808080">(</font>tfLivroAss<font color="#808080">)</font>==FALSE<font color="#808080">) {
    </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#0000FF">sprintf</font><font color="#808080">(</font><font color="#800000">&quot;%s --&gt; %s\n&quot;</font>,MSG_ARQERRO,ARQ_LIVASS<font color="#808080">))
    </font><font color="#0000FF">quit</font><font color="#808080">() 
  }
  </font><font color="#0000FF">open</font><font color="#808080">(</font>tfLivroAut, ARQ_ABRE<font color="#808080">)
  </font><font color="#0000FF">if </font><font color="#808080">(</font><font color="#0000FF">isOpen</font><font color="#808080">(</font>tfLivroAut<font color="#808080">)</font>==FALSE<font color="#808080">) {
    </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#0000FF">sprintf</font><font color="#808080">(</font><font color="#800000">&quot;%s --&gt; %s\n&quot;</font>,MSG_ARQERRO,ARQ_LIVAUT<font color="#808080">))
    </font><font color="#0000FF">quit</font><font color="#808080">() 
  }
  </font><font color="#0000FF">open</font><font color="#808080">(</font>tfCliente, ARQ_ABRE<font color="#808080">)
  </font><font color="#0000FF">if </font><font color="#808080">(</font><font color="#0000FF">isOpen</font><font color="#808080">(</font>tfCliente<font color="#808080">)</font>==FALSE<font color="#808080">) {
    </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#0000FF">sprintf</font><font color="#808080">(</font><font color="#800000">&quot;%s --&gt; %s\n&quot;</font>,MSG_ARQERRO,ARQ_CLIENTE<font color="#808080">))
    </font><font color="#0000FF">quit</font><font color="#808080">() 
  }
  </font><font color="#0000FF">open</font><font color="#808080">(</font>tfUsuario, ARQ_ABRE<font color="#808080">)
  </font><font color="#0000FF">if </font><font color="#808080">(</font><font color="#0000FF">isOpen</font><font color="#808080">(</font>tfUsuario<font color="#808080">)</font>==FALSE<font color="#808080">) {
    </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#0000FF">sprintf</font><font color="#808080">(</font><font color="#800000">&quot;%s --&gt; %s\n&quot;</font>,MSG_ARQERRO,ARQ_USUARIO<font color="#808080">))
    </font><font color="#0000FF">quit</font><font color="#808080">() 
  }
  </font><font color="#0000FF">open</font><font color="#808080">(</font>tfVenda, ARQ_ABRE<font color="#808080">)
  </font><font color="#0000FF">if </font><font color="#808080">(</font><font color="#0000FF">isOpen</font><font color="#808080">(</font>tfVenda<font color="#808080">)</font>==FALSE<font color="#808080">) {
    </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#0000FF">sprintf</font><font color="#808080">(</font><font color="#800000">&quot;%s --&gt; %s\n&quot;</font>,MSG_ARQERRO,ARQ_VENDA<font color="#808080">))
    </font><font color="#0000FF">quit</font><font color="#808080">() 
  }
} </font><font color="#0000FF">else </font><font color="#808080">{
  </font>existeArqs<font color="#808080">()
}
}
</font><font color="#008000">#------------------------------------------------------------------------------
# Fecha todos os arquivos abertos.
#------------------------------------------------------------------------------
</font>fechaArqs <font color="#808080">&lt;</font><font color="#808000">- </font><font color="#0000FF">function</font><font color="#808080">() {
  </font><font color="#0000FF">close</font><font color="#808080">(</font>tfAssunto<font color="#808080">)
  </font><font color="#0000FF">close</font><font color="#808080">(</font>tfAutor<font color="#808080">)
  </font><font color="#0000FF">close</font><font color="#808080">(</font>tfEditora<font color="#808080">)
  </font><font color="#0000FF">close</font><font color="#808080">(</font>tfIdioma<font color="#808080">)
  </font><font color="#0000FF">close</font><font color="#808080">(</font>tfEndereco<font color="#808080">)
  </font><font color="#0000FF">close</font><font color="#808080">(</font>tfPais<font color="#808080">)
  </font><font color="#0000FF">close</font><font color="#808080">(</font>tfProfissao<font color="#808080">)
  </font><font color="#0000FF">close</font><font color="#808080">(</font>tfLivro<font color="#808080">)
  </font><font color="#0000FF">close</font><font color="#808080">(</font>tfLivroAss<font color="#808080">)
  </font><font color="#0000FF">close</font><font color="#808080">(</font>tfLivroAut<font color="#808080">)
  </font><font color="#0000FF">close</font><font color="#808080">(</font>tfCliente<font color="#808080">)
  </font><font color="#0000FF">close</font><font color="#808080">(</font>tfUsuario<font color="#808080">)
  </font><font color="#0000FF">close</font><font color="#808080">(</font>tfVenda<font color="#808080">)
}

</font><font color="#008000">#------------------------------------------------------------------------------
# Pesquisa um registro atrav&eacute;s de um valor chave num arquivo.
# sArq - o arquivo
# sChave - a chave a ser pesquisada
# nPosChave - a posicao inicial da chave dentro do registro
# nTamChave - o tamanho da chave dentro do registro
# nTamLinha - o tamanho do registro
# retorna - o registro pesquisado
#------------------------------------------------------------------------------
</font>pesqArq <font color="#808080">&lt;</font><font color="#808000">- </font><font color="#0000FF">function</font><font color="#808080">(</font>sArq, sChave, nPosChave, nTamChave, nTamLinha<font color="#808080">) {
  </font>bQuebra = <font color="#0000FF">FALSE
  </font>sres = <font color="#800000">&quot;&quot;
  </font>stemp = <font color="#800000">&quot;&quot;
  </font>slinha = <font color="#800000">&quot;&quot;
  </font>nPosicao = -1
  <font color="#0000FF">seek</font><font color="#808080">(</font>sArq, 0, <font color="#800000">&quot;start&quot;</font>, <font color="#800000">&quot;read&quot;</font><font color="#808080">)
  </font><font color="#0000FF">while </font><font color="#808080">((</font><font color="#0000FF">length</font><font color="#808080">(</font>slinha<font color="#808080">)</font>!=0<font color="#808080">) </font><font color="#808000">&amp;&amp; </font><font color="#808080">(</font>bQuebra==FALSE<font color="#808080">)) {
    </font>slinha = <font color="#0000FF">readLines</font><font color="#808080">(</font>sArq, 1<font color="#808080">)
    </font><font color="#0000FF">if </font><font color="#808080">(</font><font color="#0000FF">length</font><font color="#808080">(</font>slinha<font color="#808080">)</font>!=0<font color="#808080">) {
      </font>nPosicao = nPosicao <font color="#808000">+ </font>1
      stemp = slinha
      sres = trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha,nPosChave,nTamChave<font color="#808080">))
      </font><font color="#0000FF">if </font><font color="#808080">(</font>sres == sChave<font color="#808080">)
         </font>bQuebra = <font color="#0000FF">TRUE
    </font><font color="#808080">}
  }
  </font>nPosicao = nPosicao <font color="#808080">* (</font>nTamLinha <font color="#808000">+ </font>TAM_CRLF<font color="#808080">)
  </font>ag<font color="#808080">(</font><font color="#800000">&quot;g_nPosicao&quot;</font>, nPosicao<font color="#808080">)

  </font><font color="#0000FF">if </font><font color="#808080">(</font>nPosicao <font color="#808080">&gt; </font>0<font color="#808080">)
     </font><font color="#0000FF">seek</font><font color="#808080">(</font>sArq, nPosicao, <font color="#800000">&quot;start&quot;</font>, <font color="#800000">&quot;read&quot;</font><font color="#808080">)
  </font><font color="#0000FF">else
     seek</font><font color="#808080">(</font>sArq, 0, <font color="#800000">&quot;start&quot;</font>, <font color="#800000">&quot;read&quot;</font><font color="#808080">)

  </font><font color="#0000FF">if </font><font color="#808080">(</font>sres <font color="#808000">!= </font>sChave<font color="#808080">) 
     </font>pesqArq = <font color="#800000">&quot;&quot;
  </font><font color="#0000FF">else 
     </font>pesqArq = copy<font color="#808080">(</font>stemp,1,nTamLinha<font color="#808080">)
}
</font><font color="#008000">#------------------------------------------------------------------------------
# Pesquisa se tem linha exclu&iacute;da sen&atilde;o vai para a &uacute;ltima linha do arquivo.
# sArq - o arquivo
# nTamLinha - o tamanho do registro
#------------------------------------------------------------------------------
</font>pesqLinhaExcluida <font color="#808080">&lt;</font><font color="#808000">- </font><font color="#0000FF">function</font><font color="#808080">(</font>sArq, nTamLinha<font color="#808080">) {
  </font>sExcluido = pesqArq<font color="#808080">(</font>sArq, <font color="#800000">&quot;*&quot;</font>, 1, 1, nTamLinha<font color="#808080">)
  </font><font color="#0000FF">if </font><font color="#808080">(</font><font color="#0000FF">nchar</font><font color="#808080">(</font>sExcluido<font color="#808080">)</font>==0<font color="#808080">) {
    </font>nPosicao = <font color="#0000FF">seek</font><font color="#808080">(</font>sArq, 0, <font color="#800000">&quot;end&quot;</font><font color="#808080">)
    </font>nPosicao = nPosicao <font color="#808000">+ </font><font color="#808080">(</font>nTamLinha <font color="#808000">+ </font>TAM_CRLF<font color="#808080">)
    </font>ag<font color="#808080">(</font><font color="#800000">&quot;g_nPosicao&quot;</font>, nPosicao<font color="#808080">)
  }
}
</font><font color="#008000">#------------------------------------------------------------------------------
# Pesquisa o maior c&oacute;digo num arquivo.
# sArq - o arquivo
# nPosChave - a posicao inicial da chave dentro do registro
# nTamChave - o tamanho da chave dentro do registro
# nTamLinha - o tamanho do registro
# retorna - o maior c&oacute;digo
#------------------------------------------------------------------------------
</font>pesqMaxCod <font color="#808080">&lt;</font><font color="#808000">- </font><font color="#0000FF">function</font><font color="#808080">(</font>sArq, nPosChave, nTamChave, nTamLinha<font color="#808080">) {
</font>slinha = <font color="#800000">&quot;&quot;
</font>bQuebra = <font color="#0000FF">FALSE
</font>nMaior = 0
<font color="#0000FF">seek</font><font color="#808080">(</font>sArq, 0, <font color="#800000">&quot;start&quot;</font>, <font color="#800000">&quot;read&quot;</font><font color="#808080">)
</font><font color="#0000FF">while </font><font color="#808080">((</font><font color="#0000FF">length</font><font color="#808080">(</font>slinha<font color="#808080">)</font>!=0<font color="#808080">) </font><font color="#808000">&amp;&amp; </font><font color="#808080">(</font>bQuebra==FALSE<font color="#808080">)) {
  </font>slinha = <font color="#0000FF">readLines</font><font color="#808080">(</font>sArq, 1<font color="#808080">)
  </font><font color="#0000FF">if </font><font color="#808080">(</font><font color="#0000FF">length</font><font color="#808080">(</font>slinha<font color="#808080">)</font>!=0<font color="#808080">) {
    </font>sres = trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha,nPosChave,nTamChave<font color="#808080">))
    </font>nCod=as.integer<font color="#808080">(</font>sres<font color="#808080">)
    </font><font color="#0000FF">if </font><font color="#808080">(</font>nCod <font color="#808080">&gt; </font>nMaior<font color="#808080">)
       </font>nMaior = nCod
  <font color="#808080">}
}
</font>pesqLinhaExcluida<font color="#808080">(</font>sArq, nTamLinha<font color="#808080">)
</font>sres = <font color="#0000FF">as.character</font><font color="#808080">(</font>nMaior+1<font color="#808080">)

</font>pesqMaxCod = sres
<font color="#808080">}
</font><font color="#008000">#------------------------------------------------------------------------------
# Grava os registros num determinado arquivo.
# sArq - o arquivo
# sTexto - o registro a ser gravado
# sMsgAcerto - a mensagem caso o registro foi gravado
# sMsgErro - a mensagem caso o registro n&atilde;o foi gravado
#------------------------------------------------------------------------------
</font>escreveArq <font color="#808080">&lt;</font><font color="#808000">- </font><font color="#0000FF">function</font><font color="#808080">(</font>sArq, sTexto, sMsgAcerto, sMsgErro<font color="#808080">) {

</font><font color="#0000FF">seek</font><font color="#808080">(</font>sArq, gg<font color="#808080">(</font><font color="#800000">&quot;g_nPosicao&quot;</font><font color="#808080">)</font>, <font color="#800000">&quot;start&quot;</font>, <font color="#800000">&quot;write&quot;</font><font color="#808080">)
</font><font color="#0000FF">writeLines</font><font color="#808080">(</font>sTexto, sArq<font color="#808080">)
</font><font color="#008000">#cat(sTexto,file=sArq)
</font><font color="#0000FF">cat</font><font color="#808080">(</font>sMsgAcerto<font color="#808080">)

</font><font color="#008000">#cat(sMsgErro)
</font><font color="#808080">}
</font><font color="#008000">#------------------------------------------------------------------------------
# Monta o tamanho do registro no arquivo de acordo com o tipo de arquivo.
# sreg - o tipo de arquivo
# retorna - o registro montado
#------------------------------------------------------------------------------
</font>LinhaReg <font color="#808080">&lt;</font><font color="#808000">- </font><font color="#0000FF">function</font><font color="#808080">(</font>sreg<font color="#808080">) {
</font>slinha = <font color="#800000">&quot;&quot;

</font><font color="#0000FF">if </font><font color="#808080">(</font>sreg==opAssunto<font color="#808080">) 
   </font>slinha = <font color="#0000FF">paste</font><font color="#808080">(</font>esp<font color="#808080">(</font>gg<font color="#808080">(</font><font color="#800000">&quot;tAssunto$codigo&quot;</font><font color="#808080">)</font>,10<font color="#808080">)</font>,esp<font color="#808080">(</font>gg<font color="#808080">(</font><font color="#800000">&quot;tAssunto$assunto&quot;</font><font color="#808080">)</font>,30<font color="#808080">)</font>, sep=<font color="#800000">&quot;&quot;</font><font color="#808080">)
</font><font color="#0000FF">else if </font><font color="#808080">(</font>sreg==opAutor<font color="#808080">)
   </font>slinha = <font color="#0000FF">paste</font><font color="#808080">(</font>esp<font color="#808080">(</font>gg<font color="#808080">(</font><font color="#800000">&quot;tAutor$codigo&quot;</font><font color="#808080">)</font>,10<font color="#808080">)</font>,esp<font color="#808080">(</font>gg<font color="#808080">(</font><font color="#800000">&quot;tAutor$autor&quot;</font><font color="#808080">)</font>,30<font color="#808080">)</font>, sep=<font color="#800000">&quot;&quot;</font><font color="#808080">)
</font><font color="#0000FF">else if </font><font color="#808080">(</font>sreg==opEditora<font color="#808080">)
   </font>slinha = <font color="#0000FF">paste</font><font color="#808080">(</font>esp<font color="#808080">(</font>gg<font color="#808080">(</font><font color="#800000">&quot;tEditora$codigo&quot;</font><font color="#808080">)</font>,10<font color="#808080">)</font>,esp<font color="#808080">(</font>gg<font color="#808080">(</font><font color="#800000">&quot;tEditora$editora&quot;</font><font color="#808080">)</font>,50<font color="#808080">)</font>, sep=<font color="#800000">&quot;&quot;</font><font color="#808080">)
</font><font color="#0000FF">else if </font><font color="#808080">(</font>sreg==opEndereco<font color="#808080">)
   </font>slinha = <font color="#0000FF">paste</font><font color="#808080">(</font>esp<font color="#808080">(</font>gg<font color="#808080">(</font><font color="#800000">&quot;tEndereco$codigo&quot;</font><font color="#808080">)</font>,10<font color="#808080">)</font>,esp<font color="#808080">(</font>gg<font color="#808080">(</font><font color="#800000">&quot;tEndereco$logradouro&quot;</font><font color="#808080">)</font>,40<font color="#808080">)</font>,
   esp<font color="#808080">(</font>gg<font color="#808080">(</font><font color="#800000">&quot;tEndereco$bairro&quot;</font><font color="#808080">)</font>,15<font color="#808080">)</font>,esp<font color="#808080">(</font>gg<font color="#808080">(</font><font color="#800000">&quot;tEndereco$cep&quot;</font><font color="#808080">)</font>,8<font color="#808080">)</font>,esp<font color="#808080">(</font>gg<font color="#808080">(</font><font color="#800000">&quot;tEndereco$cidade&quot;</font><font color="#808080">)</font>,30<font color="#808080">)</font>,
   esp<font color="#808080">(</font>gg<font color="#808080">(</font><font color="#800000">&quot;tEndereco$estado&quot;</font><font color="#808080">)</font>,20<font color="#808080">)</font>, sep=<font color="#800000">&quot;&quot;</font><font color="#808080">)
</font><font color="#0000FF">else if </font><font color="#808080">(</font>sreg==opIdioma<font color="#808080">)
   </font>slinha = <font color="#0000FF">paste</font><font color="#808080">(</font>esp<font color="#808080">(</font>gg<font color="#808080">(</font><font color="#800000">&quot;tIdioma$codigo&quot;</font><font color="#808080">)</font>,10<font color="#808080">)</font>,esp<font color="#808080">(</font>gg<font color="#808080">(</font><font color="#800000">&quot;tIdioma$idioma&quot;</font><font color="#808080">)</font>,20<font color="#808080">)</font>, sep=<font color="#800000">&quot;&quot;</font><font color="#808080">)
</font><font color="#0000FF">else if </font><font color="#808080">(</font>sreg==opPais<font color="#808080">)
   </font>slinha = <font color="#0000FF">paste</font><font color="#808080">(</font>esp<font color="#808080">(</font>gg<font color="#808080">(</font><font color="#800000">&quot;tPais$codigo&quot;</font><font color="#808080">)</font>,3<font color="#808080">)</font>,esp<font color="#808080">(</font>gg<font color="#808080">(</font><font color="#800000">&quot;tPais$pais&quot;</font><font color="#808080">)</font>,50<font color="#808080">)</font>, sep=<font color="#800000">&quot;&quot;</font><font color="#808080">)
</font><font color="#0000FF">else if </font><font color="#808080">(</font>sreg==opProfissao<font color="#808080">)
   </font>slinha = <font color="#0000FF">paste</font><font color="#808080">(</font>esp<font color="#808080">(</font>gg<font color="#808080">(</font><font color="#800000">&quot;tProfissao$codigo&quot;</font><font color="#808080">)</font>,10<font color="#808080">)</font>,esp<font color="#808080">(</font>gg<font color="#808080">(</font><font color="#800000">&quot;tProfissao$profissao&quot;</font><font color="#808080">)</font>,50<font color="#808080">)</font>, sep=<font color="#800000">&quot;&quot;</font><font color="#808080">)
</font><font color="#0000FF">else if </font><font color="#808080">(</font>sreg==opUsuario<font color="#808080">)
   </font>slinha = <font color="#0000FF">paste</font><font color="#808080">(</font>esp<font color="#808080">(</font>gg<font color="#808080">(</font><font color="#800000">&quot;tUsuario$login&quot;</font><font color="#808080">)</font>,10<font color="#808080">)</font>,esp<font color="#808080">(</font>gg<font color="#808080">(</font><font color="#800000">&quot;tUsuario$senha&quot;</font><font color="#808080">)</font>,10<font color="#808080">)</font>, sep=<font color="#800000">&quot;&quot;</font><font color="#808080">)
</font><font color="#0000FF">else if </font><font color="#808080">(</font>sreg==opLivro<font color="#808080">)
   </font>slinha = <font color="#0000FF">paste</font><font color="#808080">(</font>esp<font color="#808080">(</font>gg<font color="#808080">(</font><font color="#800000">&quot;tLivro$isbn&quot;</font><font color="#808080">)</font>,13<font color="#808080">)</font>,esp<font color="#808080">(</font>gg<font color="#808080">(</font><font color="#800000">&quot;tLivro$titulo&quot;</font><font color="#808080">)</font>,50<font color="#808080">)</font>,
   esp<font color="#808080">(</font>gg<font color="#808080">(</font><font color="#800000">&quot;tLivro$edicao&quot;</font><font color="#808080">)</font>,10<font color="#808080">)</font>,esp<font color="#808080">(</font>gg<font color="#808080">(</font><font color="#800000">&quot;tLivro$anopubli&quot;</font><font color="#808080">)</font>,10<font color="#808080">)</font>,esp<font color="#808080">(</font>gg<font color="#808080">(</font><font color="#800000">&quot;tLivro$codeditora&quot;</font><font color="#808080">)</font>,10<font color="#808080">)</font>,
   esp<font color="#808080">(</font>gg<font color="#808080">(</font><font color="#800000">&quot;tLivro$volume&quot;</font><font color="#808080">)</font>,10<font color="#808080">)</font>,esp<font color="#808080">(</font>gg<font color="#808080">(</font><font color="#800000">&quot;tLivro$codidioma&quot;</font><font color="#808080">)</font>,10<font color="#808080">)</font>,esp<font color="#808080">(</font>gg<font color="#808080">(</font><font color="#800000">&quot;tLivro$npaginas&quot;</font><font color="#808080">)</font>,10<font color="#808080">)</font>,
   esp<font color="#808080">(</font>gg<font color="#808080">(</font><font color="#800000">&quot;tLivro$preco&quot;</font><font color="#808080">)</font>,10<font color="#808080">)</font>,esp<font color="#808080">(</font>gg<font color="#808080">(</font><font color="#800000">&quot;tLivro$qtdestoque&quot;</font><font color="#808080">)</font>,10<font color="#808080">)</font>, sep=<font color="#800000">&quot;&quot;</font><font color="#808080">)
</font><font color="#0000FF">else if </font><font color="#808080">(</font>sreg==opLivroAss<font color="#808080">)
   </font>slinha = <font color="#0000FF">paste</font><font color="#808080">(</font>esp<font color="#808080">(</font>gg<font color="#808080">(</font><font color="#800000">&quot;tLivroAss$isbn&quot;</font><font color="#808080">)</font>,13<font color="#808080">)</font>,esp<font color="#808080">(</font>gg<font color="#808080">(</font><font color="#800000">&quot;tLivroAss$codassunto&quot;</font><font color="#808080">)</font>,10<font color="#808080">)</font>, sep=<font color="#800000">&quot;&quot;</font><font color="#808080">)
</font><font color="#0000FF">else if </font><font color="#808080">(</font>sreg==opLivroAut<font color="#808080">)
   </font>slinha = <font color="#0000FF">paste</font><font color="#808080">(</font>esp<font color="#808080">(</font>gg<font color="#808080">(</font><font color="#800000">&quot;tLivroAut$isbn&quot;</font><font color="#808080">)</font>,13<font color="#808080">)</font>,esp<font color="#808080">(</font>gg<font color="#808080">(</font><font color="#800000">&quot;tLivroAut$codautor&quot;</font><font color="#808080">)</font>,10<font color="#808080">)</font>, sep=<font color="#800000">&quot;&quot;</font><font color="#808080">)
</font><font color="#0000FF">else if </font><font color="#808080">(</font>sreg==opCliente<font color="#808080">)
   </font>slinha = <font color="#0000FF">paste</font><font color="#808080">(</font>esp<font color="#808080">(</font>gg<font color="#808080">(</font><font color="#800000">&quot;tCliente$cpf&quot;</font><font color="#808080">)</font>,14<font color="#808080">)</font>,esp<font color="#808080">(</font>gg<font color="#808080">(</font><font color="#800000">&quot;tCliente$nome&quot;</font><font color="#808080">)</font>,30<font color="#808080">)</font>,
   esp<font color="#808080">(</font>gg<font color="#808080">(</font><font color="#800000">&quot;tCliente$email&quot;</font><font color="#808080">)</font>,30<font color="#808080">)</font>,esp<font color="#808080">(</font>gg<font color="#808080">(</font><font color="#800000">&quot;tCliente$identidade&quot;</font><font color="#808080">)</font>,10<font color="#808080">)</font>,esp<font color="#808080">(</font>gg<font color="#808080">(</font><font color="#800000">&quot;tCliente$sexo&quot;</font><font color="#808080">)</font>,1<font color="#808080">)</font>,
   esp<font color="#808080">(</font>gg<font color="#808080">(</font><font color="#800000">&quot;tCliente$telefone&quot;</font><font color="#808080">)</font>,17<font color="#808080">)</font>,esp<font color="#808080">(</font>gg<font color="#808080">(</font><font color="#800000">&quot;tCliente$dtnascimento&quot;</font><font color="#808080">)</font>,10<font color="#808080">)</font>,
   esp<font color="#808080">(</font>gg<font color="#808080">(</font><font color="#800000">&quot;tCliente$codendereco&quot;</font><font color="#808080">)</font>,10<font color="#808080">)</font>,esp<font color="#808080">(</font>gg<font color="#808080">(</font><font color="#800000">&quot;tCliente$codpais&quot;</font><font color="#808080">)</font>,3<font color="#808080">)</font>,
   esp<font color="#808080">(</font>gg<font color="#808080">(</font><font color="#800000">&quot;tCliente$codprofissao&quot;</font><font color="#808080">)</font>,10<font color="#808080">)</font>, sep=<font color="#800000">&quot;&quot;</font><font color="#808080">)
</font><font color="#0000FF">else if </font><font color="#808080">(</font>sreg==opVenda<font color="#808080">)
   </font>slinha = <font color="#0000FF">paste</font><font color="#808080">(</font>esp<font color="#808080">(</font>gg<font color="#808080">(</font><font color="#800000">&quot;tVenda$dthrvenda&quot;</font><font color="#808080">)</font>,19<font color="#808080">)</font>,esp<font color="#808080">(</font>gg<font color="#808080">(</font><font color="#800000">&quot;tVenda$cpf&quot;</font><font color="#808080">)</font>,14<font color="#808080">)</font>,
   esp<font color="#808080">(</font>gg<font color="#808080">(</font><font color="#800000">&quot;tVenda$isbn&quot;</font><font color="#808080">)</font>,13<font color="#808080">)</font>,esp<font color="#808080">(</font>gg<font color="#808080">(</font><font color="#800000">&quot;tVenda$precovenda&quot;</font><font color="#808080">)</font>,10<font color="#808080">)</font>, sep=<font color="#800000">&quot;&quot;</font><font color="#808080">)

</font>LinhaReg = slinha
<font color="#808080">}
</font><font color="#008000">#------------------------------------------------------------------------------
# Retorna o tamanho do registro no arquivo de acordo com o tipo de arquivo.
# sreg - o tipo de arquivo
# retorna - o tamanho do registro
#------------------------------------------------------------------------------
</font>tamReg <font color="#808080">&lt;</font><font color="#808000">- </font><font color="#0000FF">function</font><font color="#808080">(</font>sreg<font color="#808080">) {
</font>nret = 0

<font color="#0000FF">if </font><font color="#808080">(</font>sreg==opAssunto<font color="#808080">) </font>nret = TAM_ASSUNTO
<font color="#0000FF">else if </font><font color="#808080">(</font>sreg==opAutor<font color="#808080">) </font>nret = TAM_AUTOR
<font color="#0000FF">else if </font><font color="#808080">(</font>sreg==opEditora<font color="#808080">) </font>nret = TAM_EDITORA
<font color="#0000FF">else if </font><font color="#808080">(</font>sreg==opEndereco<font color="#808080">) </font>nret = TAM_ENDERECO
<font color="#0000FF">else if </font><font color="#808080">(</font>sreg==opIdioma<font color="#808080">) </font>nret = TAM_IDIOMA
<font color="#0000FF">else if </font><font color="#808080">(</font>sreg==opPais<font color="#808080">) </font>nret = TAM_PAIS
<font color="#0000FF">else if </font><font color="#808080">(</font>sreg==opProfissao<font color="#808080">) </font>nret = TAM_PROFISSAO
<font color="#0000FF">else if </font><font color="#808080">(</font>sreg==opUsuario<font color="#808080">) </font>nret = TAM_USUARIO
<font color="#0000FF">else if </font><font color="#808080">(</font>sreg==opLivro<font color="#808080">) </font>nret = TAM_LIVRO
<font color="#0000FF">else if </font><font color="#808080">(</font>sreg==opLivroAss<font color="#808080">) </font>nret = TAM_LIVASS
<font color="#0000FF">else if </font><font color="#808080">(</font>sreg==opLivroAut<font color="#808080">) </font>nret = TAM_LIVAUT
<font color="#0000FF">else if </font><font color="#808080">(</font>sreg==opCliente<font color="#808080">) </font>nret = TAM_CLIENTE
<font color="#0000FF">else if </font><font color="#808080">(</font>sreg==opVenda<font color="#808080">) </font>nret = TAM_VENDA

tamReg = nret
<font color="#808080">}
</font><font color="#008000">#------------------------------------------------------------------------------
# Seleciona o rotulo de cada campo de acordo com o tipo de arquivo.
# sreg - o tipo de arquivo
# nNum - indica qual rotulo ser&aacute; retornado
# retorna - o rotulo
#------------------------------------------------------------------------------
</font>rotulo <font color="#808080">&lt;</font><font color="#808000">- </font><font color="#0000FF">function</font><font color="#808080">(</font>sreg, nNum<font color="#808080">) {
</font>sret = <font color="#800000">&quot;&quot;

</font><font color="#0000FF">if </font><font color="#808080">(</font>sreg==opAssunto<font color="#808080">) {   
   </font><font color="#0000FF">if </font><font color="#808080">(</font>nNum == 0<font color="#808080">) </font>sret = <font color="#800000">&quot;Assunto(s) n&atilde;o encontrado(s)!\n&quot;
   </font><font color="#0000FF">else if </font><font color="#808080">(</font>nNum == 1<font color="#808080">) {
      </font>sret = <font color="#800000">&quot;C&oacute;digo do assunto: &quot;
      </font>ag<font color="#808080">(</font><font color="#800000">&quot;g_nPosChave&quot;</font>, 1<font color="#808080">)
      </font>ag<font color="#808080">(</font><font color="#800000">&quot;g_nTamChave&quot;</font>, 10<font color="#808080">)
   }
   </font><font color="#0000FF">else if </font><font color="#808080">(</font>nNum == 2<font color="#808080">) {
      </font>sret = <font color="#800000">&quot;Assunto: &quot;
      </font>ag<font color="#808080">(</font><font color="#800000">&quot;g_nPosChave&quot;</font>, 11<font color="#808080">)
      </font>ag<font color="#808080">(</font><font color="#800000">&quot;g_nTamChave&quot;</font>, 30<font color="#808080">)
   }
} </font><font color="#0000FF">else if </font><font color="#808080">(</font>sreg==opAutor<font color="#808080">) {
   </font><font color="#0000FF">if </font><font color="#808080">(</font>nNum == 0<font color="#808080">) </font>sret = <font color="#800000">&quot;Autor(es) n&atilde;o encontrado(s)!\n&quot;
   </font><font color="#0000FF">else if </font><font color="#808080">(</font>nNum == 1<font color="#808080">) {
      </font>sret = <font color="#800000">&quot;C&oacute;digo do autor: &quot;
      </font>ag<font color="#808080">(</font><font color="#800000">&quot;g_nPosChave&quot;</font>, 1<font color="#808080">)
      </font>ag<font color="#808080">(</font><font color="#800000">&quot;g_nTamChave&quot;</font>, 10<font color="#808080">)
   } 
   </font><font color="#0000FF">else if </font><font color="#808080">(</font>nNum == 2<font color="#808080">) {
      </font>sret = <font color="#800000">&quot;Autor: &quot;
      </font>ag<font color="#808080">(</font><font color="#800000">&quot;g_nPosChave&quot;</font>, 11<font color="#808080">)
      </font>ag<font color="#808080">(</font><font color="#800000">&quot;g_nTamChave&quot;</font>, 30<font color="#808080">)
   }
} </font><font color="#0000FF">else if </font><font color="#808080">(</font>sreg==opEditora<font color="#808080">) {
   </font><font color="#0000FF">if </font><font color="#808080">(</font>nNum == 0<font color="#808080">) </font>sret = <font color="#800000">&quot;Editora(s) n&atilde;o encontrada(s)!\n&quot;
   </font><font color="#0000FF">else if </font><font color="#808080">(</font>nNum == 1<font color="#808080">) {
      </font>sret = <font color="#800000">&quot;C&oacute;digo da editora: &quot;
      </font>ag<font color="#808080">(</font><font color="#800000">&quot;g_nPosChave&quot;</font>, 1<font color="#808080">)
      </font>ag<font color="#808080">(</font><font color="#800000">&quot;g_nTamChave&quot;</font>, 10<font color="#808080">)
   }
   </font><font color="#0000FF">else if </font><font color="#808080">(</font>nNum == 2<font color="#808080">) {
      </font>sret = <font color="#800000">&quot;Editora: &quot;
      </font>ag<font color="#808080">(</font><font color="#800000">&quot;g_nPosChave&quot;</font>, 11<font color="#808080">)
      </font>ag<font color="#808080">(</font><font color="#800000">&quot;g_nTamChave&quot;</font>, 50<font color="#808080">)
   }
} </font><font color="#0000FF">else if </font><font color="#808080">(</font>sreg==opEndereco<font color="#808080">) {
   </font><font color="#0000FF">if </font><font color="#808080">(</font>nNum == 0<font color="#808080">) </font>sret = <font color="#800000">&quot;Endere&ccedil;o(s) n&atilde;o encontrado(s)!\n&quot;
   </font><font color="#0000FF">else if </font><font color="#808080">(</font>nNum == 1<font color="#808080">) {
      </font>sret = <font color="#800000">&quot;C&oacute;digo do endere&ccedil;o: &quot;
      </font>ag<font color="#808080">(</font><font color="#800000">&quot;g_nPosChave&quot;</font>, 1<font color="#808080">)
      </font>ag<font color="#808080">(</font><font color="#800000">&quot;g_nTamChave&quot;</font>, 10<font color="#808080">)
   }
   </font><font color="#0000FF">else if </font><font color="#808080">(</font>nNum == 2<font color="#808080">) {
      </font>sret = <font color="#800000">&quot;Logradouro: &quot;
      </font>ag<font color="#808080">(</font><font color="#800000">&quot;g_nPosChave&quot;</font>, 11<font color="#808080">)
      </font>ag<font color="#808080">(</font><font color="#800000">&quot;g_nTamChave&quot;</font>, 40<font color="#808080">)
   }
   </font><font color="#0000FF">else if </font><font color="#808080">(</font>nNum == 3<font color="#808080">) {
      </font>sret = <font color="#800000">&quot;Bairro: &quot;
      </font>ag<font color="#808080">(</font><font color="#800000">&quot;g_nPosChave&quot;</font>, 51<font color="#808080">)
      </font>ag<font color="#808080">(</font><font color="#800000">&quot;g_nTamChave&quot;</font>, 15<font color="#808080">)
   }
   </font><font color="#0000FF">else if </font><font color="#808080">(</font>nNum == 4<font color="#808080">) {
      </font>sret = <font color="#800000">&quot;CEP: &quot;
      </font>ag<font color="#808080">(</font><font color="#800000">&quot;g_nPosChave&quot;</font>, 66<font color="#808080">)
      </font>ag<font color="#808080">(</font><font color="#800000">&quot;g_nTamChave&quot;</font>, 8<font color="#808080">)
   }
   </font><font color="#0000FF">else if </font><font color="#808080">(</font>nNum == 5<font color="#808080">) {
      </font>sret = <font color="#800000">&quot;Cidade: &quot;
      </font>ag<font color="#808080">(</font><font color="#800000">&quot;g_nPosChave&quot;</font>, 74<font color="#808080">)
      </font>ag<font color="#808080">(</font><font color="#800000">&quot;g_nTamChave&quot;</font>, 30<font color="#808080">)
   }
   </font><font color="#0000FF">else if </font><font color="#808080">(</font>nNum == 6<font color="#808080">) {
      </font>sret = <font color="#800000">&quot;Estado: &quot;
      </font>ag<font color="#808080">(</font><font color="#800000">&quot;g_nPosChave&quot;</font>, 104<font color="#808080">)
      </font>ag<font color="#808080">(</font><font color="#800000">&quot;g_nTamChave&quot;</font>, 20<font color="#808080">)
   }
} </font><font color="#0000FF">else if </font><font color="#808080">(</font>sreg==opIdioma<font color="#808080">) {
   </font><font color="#0000FF">if </font><font color="#808080">(</font>nNum == 0<font color="#808080">) </font>sret = <font color="#800000">&quot;Idioma(s) n&atilde;o encontrado(s)!\n&quot;
   </font><font color="#0000FF">else if </font><font color="#808080">(</font>nNum == 1<font color="#808080">) {
      </font>sret = <font color="#800000">&quot;C&oacute;digo do idioma: &quot;
      </font>ag<font color="#808080">(</font><font color="#800000">&quot;g_nPosChave&quot;</font>, 1<font color="#808080">)
      </font>ag<font color="#808080">(</font><font color="#800000">&quot;g_nTamChave&quot;</font>, 10<font color="#808080">)
   }
   </font><font color="#0000FF">else if </font><font color="#808080">(</font>nNum == 2<font color="#808080">) {
      </font>sret = <font color="#800000">&quot;Idioma: &quot;
      </font>ag<font color="#808080">(</font><font color="#800000">&quot;g_nPosChave&quot;</font>, 11<font color="#808080">)
      </font>ag<font color="#808080">(</font><font color="#800000">&quot;g_nTamChave&quot;</font>, 20<font color="#808080">)
   }
} </font><font color="#0000FF">else if </font><font color="#808080">(</font>sreg==opPais<font color="#808080">) {
   </font><font color="#0000FF">if </font><font color="#808080">(</font>nNum == 0<font color="#808080">) </font>sret = <font color="#800000">&quot;Pa&iacute;s(es) n&atilde;o encontrado(s)!\n&quot;
   </font><font color="#0000FF">else if </font><font color="#808080">(</font>nNum == 1<font color="#808080">) {
      </font>sret = <font color="#800000">&quot;C&oacute;digo do pa&iacute;s: &quot;
      </font>ag<font color="#808080">(</font><font color="#800000">&quot;g_nPosChave&quot;</font>, 1<font color="#808080">)
      </font>ag<font color="#808080">(</font><font color="#800000">&quot;g_nTamChave&quot;</font>, 3<font color="#808080">)
   }
   </font><font color="#0000FF">else if </font><font color="#808080">(</font>nNum == 2<font color="#808080">) {
      </font>sret = <font color="#800000">&quot;Pa&iacute;s: &quot;
      </font>ag<font color="#808080">(</font><font color="#800000">&quot;g_nPosChave&quot;</font>, 4<font color="#808080">)
      </font>ag<font color="#808080">(</font><font color="#800000">&quot;g_nTamChave&quot;</font>, 50<font color="#808080">)
   }
} </font><font color="#0000FF">else if </font><font color="#808080">(</font>sreg==opProfissao<font color="#808080">) {
   </font><font color="#0000FF">if </font><font color="#808080">(</font>nNum == 0<font color="#808080">) </font>sret = <font color="#800000">&quot;Profiss&atilde;o(es) n&atilde;o encontrada(s)!\n&quot;
   </font><font color="#0000FF">else if </font><font color="#808080">(</font>nNum == 1<font color="#808080">) {
      </font>sret = <font color="#800000">&quot;C&oacute;digo da profiss&atilde;o: &quot;
      </font>ag<font color="#808080">(</font><font color="#800000">&quot;g_nPosChave&quot;</font>, 1<font color="#808080">)
      </font>ag<font color="#808080">(</font><font color="#800000">&quot;g_nTamChave&quot;</font>, 10<font color="#808080">)
   }
   </font><font color="#0000FF">else if </font><font color="#808080">(</font>nNum == 2<font color="#808080">) {
      </font>sret = <font color="#800000">&quot;Profiss&atilde;o: &quot;
      </font>ag<font color="#808080">(</font><font color="#800000">&quot;g_nPosChave&quot;</font>, 11<font color="#808080">)
      </font>ag<font color="#808080">(</font><font color="#800000">&quot;g_nTamChave&quot;</font>, 50<font color="#808080">)
   }
} </font><font color="#0000FF">else if </font><font color="#808080">(</font>sreg==opUsuario<font color="#808080">) {
   </font><font color="#0000FF">if </font><font color="#808080">(</font>nNum == 0<font color="#808080">) </font>sret = <font color="#800000">&quot;login ou senha incorreta, tente de novo!\n&quot;
   </font><font color="#0000FF">else if </font><font color="#808080">(</font>nNum == 1<font color="#808080">) {
      </font>sret = <font color="#800000">&quot;Login: &quot;
      </font>ag<font color="#808080">(</font><font color="#800000">&quot;g_nPosChave&quot;</font>, 1<font color="#808080">)
      </font>ag<font color="#808080">(</font><font color="#800000">&quot;g_nTamChave&quot;</font>, 10<font color="#808080">)
   }
   </font><font color="#0000FF">else if </font><font color="#808080">(</font>nNum == 2<font color="#808080">) {
      </font>sret = <font color="#800000">&quot;Senha: &quot;
      </font>ag<font color="#808080">(</font><font color="#800000">&quot;g_nPosChave&quot;</font>, 11<font color="#808080">)
      </font>ag<font color="#808080">(</font><font color="#800000">&quot;g_nTamChave&quot;</font>, 10<font color="#808080">)
   }
} </font><font color="#0000FF">else if </font><font color="#808080">(</font>sreg==opLivro<font color="#808080">) {
   </font><font color="#0000FF">if </font><font color="#808080">(</font>nNum == 0<font color="#808080">) </font>sret = <font color="#800000">&quot;Livro(s) n&atilde;o encontrado(s)!\n&quot;
   </font><font color="#0000FF">else if </font><font color="#808080">(</font>nNum == 1<font color="#808080">) {
      </font>sret = <font color="#800000">&quot;ISBN: &quot;
      </font>ag<font color="#808080">(</font><font color="#800000">&quot;g_nPosChave&quot;</font>, 1<font color="#808080">)
      </font>ag<font color="#808080">(</font><font color="#800000">&quot;g_nTamChave&quot;</font>, 13<font color="#808080">)
   }
   </font><font color="#0000FF">else if </font><font color="#808080">(</font>nNum == 2<font color="#808080">) {
      </font>sret = <font color="#800000">&quot;T&iacute;tulo: &quot;
      </font>ag<font color="#808080">(</font><font color="#800000">&quot;g_nPosChave&quot;</font>, 14<font color="#808080">)
      </font>ag<font color="#808080">(</font><font color="#800000">&quot;g_nTamChave&quot;</font>, 50<font color="#808080">)
   }
   </font><font color="#0000FF">else if </font><font color="#808080">(</font>nNum == 3<font color="#808080">) {
      </font>sret = <font color="#800000">&quot;Edi&ccedil;&atilde;o: &quot;
      </font>ag<font color="#808080">(</font><font color="#800000">&quot;g_nPosChave&quot;</font>, 64<font color="#808080">)
      </font>ag<font color="#808080">(</font><font color="#800000">&quot;g_nTamChave&quot;</font>, 10<font color="#808080">)
   }
   </font><font color="#0000FF">else if </font><font color="#808080">(</font>nNum == 4<font color="#808080">) {
      </font>sret = <font color="#800000">&quot;Ano de Publica&ccedil;&atilde;o: &quot;
      </font>ag<font color="#808080">(</font><font color="#800000">&quot;g_nPosChave&quot;</font>, 74<font color="#808080">)
      </font>ag<font color="#808080">(</font><font color="#800000">&quot;g_nTamChave&quot;</font>, 10<font color="#808080">)
   }
   </font><font color="#0000FF">else if </font><font color="#808080">(</font>nNum == 5<font color="#808080">) {
      </font>sret = <font color="#800000">&quot;C&oacute;digo da editora: &quot;
      </font>ag<font color="#808080">(</font><font color="#800000">&quot;g_nPosChave&quot;</font>, 84<font color="#808080">)
      </font>ag<font color="#808080">(</font><font color="#800000">&quot;g_nTamChave&quot;</font>, 10<font color="#808080">)
   }
   </font><font color="#0000FF">else if </font><font color="#808080">(</font>nNum == 6<font color="#808080">) {
      </font>sret = <font color="#800000">&quot;Volume: &quot;
      </font>ag<font color="#808080">(</font><font color="#800000">&quot;g_nPosChave&quot;</font>, 94<font color="#808080">)
      </font>ag<font color="#808080">(</font><font color="#800000">&quot;g_nTamChave&quot;</font>, 10<font color="#808080">)
   }
   </font><font color="#0000FF">else if </font><font color="#808080">(</font>nNum == 7<font color="#808080">) {
      </font>sret = <font color="#800000">&quot;C&oacute;digo do idioma: &quot;
      </font>ag<font color="#808080">(</font><font color="#800000">&quot;g_nPosChave&quot;</font>, 104<font color="#808080">)
      </font>ag<font color="#808080">(</font><font color="#800000">&quot;g_nTamChave&quot;</font>, 10<font color="#808080">)
   }
   </font><font color="#0000FF">else if </font><font color="#808080">(</font>nNum == 8<font color="#808080">) {
      </font>sret = <font color="#800000">&quot;N&uacute;mero de p&aacute;ginas: &quot;
      </font>ag<font color="#808080">(</font><font color="#800000">&quot;g_nPosChave&quot;</font>, 114<font color="#808080">)
      </font>ag<font color="#808080">(</font><font color="#800000">&quot;g_nTamChave&quot;</font>, 10<font color="#808080">)
   }
   </font><font color="#0000FF">else if </font><font color="#808080">(</font>nNum == 9<font color="#808080">) {
      </font>sret = <font color="#800000">&quot;Pre&ccedil;o: &quot;
      </font>ag<font color="#808080">(</font><font color="#800000">&quot;g_nPosChave&quot;</font>, 124<font color="#808080">)
      </font>ag<font color="#808080">(</font><font color="#800000">&quot;g_nTamChave&quot;</font>, 10<font color="#808080">)
   }
   </font><font color="#0000FF">else if </font><font color="#808080">(</font>nNum == 10<font color="#808080">) {
      </font>sret = <font color="#800000">&quot;Qtd. Estoque: &quot;
      </font>ag<font color="#808080">(</font><font color="#800000">&quot;g_nPosChave&quot;</font>, 134<font color="#808080">)
      </font>ag<font color="#808080">(</font><font color="#800000">&quot;g_nTamChave&quot;</font>, 10<font color="#808080">)
   }
} </font><font color="#0000FF">else if </font><font color="#808080">(</font>sreg==opLivroAss<font color="#808080">) {
   </font><font color="#0000FF">if </font><font color="#808080">(</font>nNum == 0<font color="#808080">) </font>sret = <font color="#800000">&quot;Assunto(s) n&atilde;o encontrado(s)!\n&quot;
   </font><font color="#0000FF">else if </font><font color="#808080">(</font>nNum == 1<font color="#808080">) {
      </font>sret = <font color="#800000">&quot;ISBN: &quot;
      </font>ag<font color="#808080">(</font><font color="#800000">&quot;g_nPosChave&quot;</font>, 1<font color="#808080">)
      </font>ag<font color="#808080">(</font><font color="#800000">&quot;g_nTamChave&quot;</font>, 13<font color="#808080">)
   }
   </font><font color="#0000FF">else if </font><font color="#808080">(</font>nNum == 2<font color="#808080">) {
      </font>sret = <font color="#800000">&quot;C&oacute;digo do assunto: &quot;
      </font>ag<font color="#808080">(</font><font color="#800000">&quot;g_nPosChave&quot;</font>, 14<font color="#808080">)
      </font>ag<font color="#808080">(</font><font color="#800000">&quot;g_nTamChave&quot;</font>, 10<font color="#808080">)
   }
} </font><font color="#0000FF">else if </font><font color="#808080">(</font>sreg==opLivroAut<font color="#808080">) {
   </font><font color="#0000FF">if </font><font color="#808080">(</font>nNum == 0<font color="#808080">) </font>sret = <font color="#800000">&quot;Autor(s) n&atilde;o encontrado(s)!\n&quot;
   </font><font color="#0000FF">else if </font><font color="#808080">(</font>nNum == 1<font color="#808080">) {
      </font>sret = <font color="#800000">&quot;ISBN: &quot;
      </font>ag<font color="#808080">(</font><font color="#800000">&quot;g_nPosChave&quot;</font>, 1<font color="#808080">)
      </font>ag<font color="#808080">(</font><font color="#800000">&quot;g_nTamChave&quot;</font>, 13<font color="#808080">)
   }
   </font><font color="#0000FF">else if </font><font color="#808080">(</font>nNum == 2<font color="#808080">) {
      </font>sret = <font color="#800000">&quot;C&oacute;digo do autor: &quot;
      </font>ag<font color="#808080">(</font><font color="#800000">&quot;g_nPosChave&quot;</font>, 14<font color="#808080">)
      </font>ag<font color="#808080">(</font><font color="#800000">&quot;g_nTamChave&quot;</font>, 10<font color="#808080">)
   }
} </font><font color="#0000FF">else if </font><font color="#808080">(</font>sreg==opCliente<font color="#808080">) {
   </font><font color="#0000FF">if </font><font color="#808080">(</font>nNum == 0<font color="#808080">) </font>sret = <font color="#800000">&quot;Cliente(s) n&atilde;o encontrado(s)!\n&quot;
   </font><font color="#0000FF">else if </font><font color="#808080">(</font>nNum == 1<font color="#808080">) {
      </font>sret = <font color="#800000">&quot;CPF: &quot;
      </font>ag<font color="#808080">(</font><font color="#800000">&quot;g_nPosChave&quot;</font>, 1<font color="#808080">)
      </font>ag<font color="#808080">(</font><font color="#800000">&quot;g_nTamChave&quot;</font>, 14<font color="#808080">)
   }
   </font><font color="#0000FF">else if </font><font color="#808080">(</font>nNum == 2<font color="#808080">) {
      </font>sret = <font color="#800000">&quot;Nome: &quot;
      </font>ag<font color="#808080">(</font><font color="#800000">&quot;g_nPosChave&quot;</font>, 15<font color="#808080">)
      </font>ag<font color="#808080">(</font><font color="#800000">&quot;g_nTamChave&quot;</font>, 30<font color="#808080">)
   }
   </font><font color="#0000FF">else if </font><font color="#808080">(</font>nNum == 3<font color="#808080">) {
      </font>sret = <font color="#800000">&quot;E-mail: &quot;
      </font>ag<font color="#808080">(</font><font color="#800000">&quot;g_nPosChave&quot;</font>, 45<font color="#808080">)
      </font>ag<font color="#808080">(</font><font color="#800000">&quot;g_nTamChave&quot;</font>, 30<font color="#808080">)
   }
   </font><font color="#0000FF">else if </font><font color="#808080">(</font>nNum == 4<font color="#808080">) {
      </font>sret = <font color="#800000">&quot;Identidade: &quot;
      </font>ag<font color="#808080">(</font><font color="#800000">&quot;g_nPosChave&quot;</font>, 75<font color="#808080">)
      </font>ag<font color="#808080">(</font><font color="#800000">&quot;g_nTamChave&quot;</font>, 10<font color="#808080">)
   }
   </font><font color="#0000FF">else if </font><font color="#808080">(</font>nNum == 5<font color="#808080">) {
      </font>sret = <font color="#800000">&quot;Sexo: &quot;
      </font>ag<font color="#808080">(</font><font color="#800000">&quot;g_nPosChave&quot;</font>, 85<font color="#808080">)
      </font>ag<font color="#808080">(</font><font color="#800000">&quot;g_nTamChave&quot;</font>, 1<font color="#808080">)
   }
   </font><font color="#0000FF">else if </font><font color="#808080">(</font>nNum == 6<font color="#808080">) {
      </font>sret = <font color="#800000">&quot;Telefone: &quot;
      </font>ag<font color="#808080">(</font><font color="#800000">&quot;g_nPosChave&quot;</font>, 86<font color="#808080">)
      </font>ag<font color="#808080">(</font><font color="#800000">&quot;g_nTamChave&quot;</font>, 17<font color="#808080">)
   }
   </font><font color="#0000FF">else if </font><font color="#808080">(</font>nNum == 7<font color="#808080">) {
      </font>sret = <font color="#800000">&quot;Dt. Nascimento: &quot;
      </font>ag<font color="#808080">(</font><font color="#800000">&quot;g_nPosChave&quot;</font>, 103<font color="#808080">)
      </font>ag<font color="#808080">(</font><font color="#800000">&quot;g_nTamChave&quot;</font>, 10<font color="#808080">)
   }
   </font><font color="#0000FF">else if </font><font color="#808080">(</font>nNum == 8<font color="#808080">) {
      </font>sret = <font color="#800000">&quot;C&oacute;digo do endere&ccedil;o: &quot;
      </font>ag<font color="#808080">(</font><font color="#800000">&quot;g_nPosChave&quot;</font>, 113<font color="#808080">)
      </font>ag<font color="#808080">(</font><font color="#800000">&quot;g_nTamChave&quot;</font>, 10<font color="#808080">)
   }
   </font><font color="#0000FF">else if </font><font color="#808080">(</font>nNum == 9<font color="#808080">) {
      </font>sret = <font color="#800000">&quot;C&oacute;digo do pa&iacute;s: &quot;
      </font>ag<font color="#808080">(</font><font color="#800000">&quot;g_nPosChave&quot;</font>, 123<font color="#808080">)
      </font>ag<font color="#808080">(</font><font color="#800000">&quot;g_nTamChave&quot;</font>, 3<font color="#808080">)
   }
   </font><font color="#0000FF">else if </font><font color="#808080">(</font>nNum == 10<font color="#808080">) {
      </font>sret = <font color="#800000">&quot;C&oacute;digo da Profiss&atilde;o: &quot;
      </font>ag<font color="#808080">(</font><font color="#800000">&quot;g_nPosChave&quot;</font>, 126<font color="#808080">)
      </font>ag<font color="#808080">(</font><font color="#800000">&quot;g_nTamChave&quot;</font>, 10<font color="#808080">)
   }
} </font><font color="#0000FF">else if </font><font color="#808080">(</font>sreg==opVenda<font color="#808080">) {
   </font><font color="#0000FF">if </font><font color="#808080">(</font>nNum == 0<font color="#808080">) </font>sret = <font color="#800000">&quot;Venda(s) n&atilde;o encontrada(s)!\n&quot;
   </font><font color="#0000FF">else if </font><font color="#808080">(</font>nNum == 1<font color="#808080">) {
      </font>sret = <font color="#800000">&quot;Data/Hora venda: &quot;
      </font>ag<font color="#808080">(</font><font color="#800000">&quot;g_nPosChave&quot;</font>, 1<font color="#808080">)
      </font>ag<font color="#808080">(</font><font color="#800000">&quot;g_nTamChave&quot;</font>, 19<font color="#808080">)
   }
   </font><font color="#0000FF">else if </font><font color="#808080">(</font>nNum == 2<font color="#808080">) {
      </font>sret = <font color="#800000">&quot;CPF: &quot;
      </font>ag<font color="#808080">(</font><font color="#800000">&quot;g_nPosChave&quot;</font>, 20<font color="#808080">)
      </font>ag<font color="#808080">(</font><font color="#800000">&quot;g_nTamChave&quot;</font>, 14<font color="#808080">)
   }
   </font><font color="#0000FF">else if </font><font color="#808080">(</font>nNum == 3<font color="#808080">) {
      </font>sret = <font color="#800000">&quot;ISBN: &quot;
      </font>ag<font color="#808080">(</font><font color="#800000">&quot;g_nPosChave&quot;</font>, 34<font color="#808080">)
      </font>ag<font color="#808080">(</font><font color="#800000">&quot;g_nTamChave&quot;</font>, 13<font color="#808080">)
   }
   </font><font color="#0000FF">else if </font><font color="#808080">(</font>nNum == 4<font color="#808080">) {
      </font>sret = <font color="#800000">&quot;Pre&ccedil;o de venda: &quot;
      </font>ag<font color="#808080">(</font><font color="#800000">&quot;g_nPosChave&quot;</font>, 47<font color="#808080">)
      </font>ag<font color="#808080">(</font><font color="#800000">&quot;g_nTamChave&quot;</font>, 10<font color="#808080">)
   }
}
</font>rotulo = sret
<font color="#808080">}
</font><font color="#008000">#------------------------------------------------------------------------------
# Indica se continua ou n&atilde;o mostrando um n&uacute;mero m&aacute;ximo de linhas.
# nlinha - a linha a ser continuada
# nQtdLinha - a quantidade de linhas a serem mostradas
# retorna - se continua ou n&atilde;o
#------------------------------------------------------------------------------
</font>ContinuaSN <font color="#808080">&lt;</font><font color="#808000">- </font><font color="#0000FF">function</font><font color="#808080">(</font>nlinha, nQtdLinha<font color="#808080">) {
</font>bret = <font color="#0000FF">FALSE
if </font><font color="#808080">(</font>nlinha <font color="#808080">&gt; </font>0<font color="#808080">) {
  </font><font color="#0000FF">if </font><font color="#808080">((</font>nlinha %% nQtdLinha<font color="#808080">) </font>== 0<font color="#808080">) {
      </font>bSOp = <font color="#0000FF">TRUE
      while</font><font color="#808080">(</font>bSOp<font color="#808080">) {
       </font><font color="#0000FF">menu</font><font color="#808080">(</font>13<font color="#808080">)       
       </font>opCSubMenu = <font color="#0000FF">readline</font><font color="#808080">()
       </font><font color="#0000FF">if </font><font color="#808080">((</font>opCSubMenu==<font color="#800000">&quot;S&quot;</font><font color="#808080">) </font>|| <font color="#808080">(</font>opCSubMenu==<font color="#800000">&quot;s&quot;</font><font color="#808080">)) </font>bSOp = <font color="#0000FF">FALSE
       else if </font><font color="#808080">((</font>opCSubMenu==<font color="#800000">&quot;N&quot;</font><font color="#808080">) </font>|| <font color="#808080">(</font>opCSubMenu==<font color="#800000">&quot;n&quot;</font><font color="#808080">)) {
          </font>bret = <font color="#0000FF">TRUE
          </font>bSOp = <font color="#0000FF">FALSE
       </font><font color="#808080">} </font><font color="#0000FF">else cat</font><font color="#808080">(</font>MSG_ERRO<font color="#808080">)
      }
  }
}
</font>ContinuaSN = bret
<font color="#808080">}
</font><font color="#008000">#------------------------------------------------------------------------------
# Lista v&aacute;rios registros de acordo com a pesquisa feita.
# sArq - o arquivo
# sreg - o tipo de arquivo
# sChave - a chave a ser pesquisada
# nPosChave - a posicao inicial da chave dentro do registro
# nTamChave - o tamanho da chave dentro do registro
# nTamLinha - o tamanho do registro
# nQtdLinha - a quantidade de linhas a serem mostradas
# retorna - se encontrou algum registro
#------------------------------------------------------------------------------
</font>ListarTodos <font color="#808080">&lt;</font><font color="#808000">- </font><font color="#0000FF">function</font><font color="#808080">(</font>sArq, sreg, sChave, 
    nPosChave, nTamChave, nTamLinha, nQtdLinha, bPesqRelativa<font color="#808080">) {
</font>slinha = <font color="#800000">&quot;&quot;
</font>bRet = <font color="#0000FF">FALSE
</font>bQuebra = <font color="#0000FF">FALSE
</font>nCont = 0
mostrarDados<font color="#808080">(</font>sreg, <font color="#800000">&quot;&quot;</font>, 2<font color="#808080">)
</font><font color="#0000FF">seek</font><font color="#808080">(</font>sArq, 0, <font color="#800000">&quot;start&quot;</font>, <font color="#800000">&quot;read&quot;</font><font color="#808080">)
</font><font color="#0000FF">while </font><font color="#808080">((</font><font color="#0000FF">length</font><font color="#808080">(</font>slinha<font color="#808080">)</font>!=0<font color="#808080">) </font><font color="#808000">&amp;&amp; </font><font color="#808080">(</font>bQuebra==FALSE<font color="#808080">)) {
  </font>slinha = <font color="#0000FF">readLines</font><font color="#808080">(</font>sArq, 1<font color="#808080">)
  </font><font color="#0000FF">if </font><font color="#808080">(</font><font color="#0000FF">length</font><font color="#808080">(</font>slinha<font color="#808080">)</font>!=0<font color="#808080">) {
    </font><font color="#0000FF">if </font><font color="#808080">(</font>bPesqRelativa<font color="#808080">) {
      </font>sres = trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha,nPosChave,nTamChave<font color="#808080">))
      </font><font color="#0000FF">if </font><font color="#808080">(</font>strRelativa<font color="#808080">(</font>sres,sChave<font color="#808080">)</font>==TRUE<font color="#808080">) {
         </font>bAchou = <font color="#0000FF">TRUE
         </font>bRet = <font color="#0000FF">TRUE
      </font><font color="#808080">} </font><font color="#0000FF">else </font><font color="#808080">{
         </font>bAchou = <font color="#0000FF">FALSE
      </font><font color="#808080">}   
    } </font><font color="#0000FF">else </font><font color="#808080">{
      </font>bAchou = <font color="#0000FF">TRUE
      </font>bRet = <font color="#0000FF">TRUE
    </font><font color="#808080">}
  
    </font><font color="#0000FF">if </font><font color="#808080">(</font>bAchou <font color="#808000">&amp;&amp; </font><font color="#808080">(</font><font color="#0000FF">length</font><font color="#808080">(</font>slinha<font color="#808080">)</font>!=0<font color="#808080">)) {
      </font>mostrarDados<font color="#808080">(</font>sreg, copy<font color="#808080">(</font>slinha,1,nTamLinha<font color="#808080">)</font>, 3<font color="#808080">)
      </font>nCont = nCont <font color="#808000">+ </font>1
    <font color="#808080">}

    </font>bQuebra = ContinuaSN<font color="#808080">(</font>nCont, nQtdLinha<font color="#808080">)
  }
}

</font>ListarTodos = bRet
<font color="#808080">}
</font><font color="#008000">#------------------------------------------------------------------------------
# Lista v&aacute;rios registros entre arquivos de acordo com a pesquisa feita.
# sArq1 - o arquivo de liga&ccedil;&atilde;o
# sreg1 - o tipo de arquivo de liga&ccedil;&atilde;o
# nPosChave1 - a posicao inicial da primeira chave no arquivo de liga&ccedil;&atilde;o
# nTamChave1 - o tamanho da primeira chave no arquivo de liga&ccedil;&atilde;o
# nPosChave2 - a posicao inicial da segunda chave do arquivo de liga&ccedil;&atilde;o
# nTamChave2 - o tamanho da segunda chave do arquivo de liga&ccedil;&atilde;o
# sChave - a chave a ser pesquisada no arquivo de liga&ccedil;&atilde;o
# sArq2 - o arquivo a ser pesquisado
# sreg2 - o tipo de arquivo a ser pesquisado
# nPosChave3 - a posicao inicial da chave do arquivo pesquisado
# nQtdLinha - a quantidade de linhas a serem mostradas
#------------------------------------------------------------------------------
</font>ListarRegLigados <font color="#808080">&lt;</font><font color="#808000">- </font><font color="#0000FF">function</font><font color="#808080">(</font>sArq1, sreg1, nPosChave1, nTamChave1, 
nPosChave2, nTamChave2, sChave, sArq2, sreg2, nPosChave3, nQtdLinha<font color="#808080">) {

</font>slinha1 = <font color="#800000">&quot;&quot;
</font>bRet = <font color="#0000FF">FALSE
</font>nCont = 0
bQuebra = <font color="#0000FF">FALSE
</font>mostrarDados<font color="#808080">(</font>sreg2, <font color="#800000">&quot;&quot;</font>, 2<font color="#808080">)
</font><font color="#0000FF">seek</font><font color="#808080">(</font>sArq1, 0, <font color="#800000">&quot;start&quot;</font>, <font color="#800000">&quot;read&quot;</font><font color="#808080">)
</font><font color="#0000FF">while </font><font color="#808080">((</font><font color="#0000FF">length</font><font color="#808080">(</font>slinha1<font color="#808080">)</font>!=0<font color="#808080">) </font><font color="#808000">&amp;&amp; </font><font color="#808080">(</font>bQuebra==FALSE<font color="#808080">)) {
  </font>slinha1 = <font color="#0000FF">readLines</font><font color="#808080">(</font>sArq1, 1<font color="#808080">)
  </font><font color="#0000FF">if </font><font color="#808080">(</font><font color="#0000FF">length</font><font color="#808080">(</font>slinha1<font color="#808080">)</font>!=0<font color="#808080">) {
    </font>sCodigo1 = trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha1,nPosChave1,nTamChave1<font color="#808080">))
    </font><font color="#0000FF">if </font><font color="#808080">(</font>sCodigo1 == sChave<font color="#808080">) {
      </font>sCodigo2 = trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha1,nPosChave2,nTamChave2<font color="#808080">))
      </font>slinha2 = pesqArq<font color="#808080">(</font>sArq2, sCodigo2, nPosChave3, nTamChave2, tamReg<font color="#808080">(</font>sreg2<font color="#808080">))
      </font>mostrarDados<font color="#808080">(</font>sreg2, copy<font color="#808080">(</font>slinha2, 1, tamReg<font color="#808080">(</font>sreg2<font color="#808080">))</font>, 3<font color="#808080">)
      </font>bRet = <font color="#0000FF">TRUE
      </font>nCont = nCont <font color="#808000">+ </font>1
    <font color="#808080">}
    </font>bQuebra = ContinuaSN<font color="#808080">(</font>nCont, nQtdLinha<font color="#808080">)
  }
}
</font><font color="#0000FF">if </font><font color="#808080">(</font>bRet==FALSE<font color="#808080">)
   </font><font color="#0000FF">cat</font><font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg2,0<font color="#808080">))
}
</font><font color="#008000">#------------------------------------------------------------------------------
# Valida a entrada de registros de acordo com a pesquisa feita.
# sArq - o arquivo
# sreg - o tipo de arquivo
# nTexto - o numero do r&oacute;tulo da entrada
# sEntrada - a chave a ser pesquisada e validada
# nTentativas - o n&uacute;mero m&aacute;ximo de tentativas
# bPesqRelativa - indica se vai realizar uma pesquisa relativa
# bTipoEntrada - indica o tipo de entrada
# retorna - o registro pesquisado e validado
#------------------------------------------------------------------------------
</font>validaEntrada <font color="#808080">&lt;</font><font color="#808000">- </font><font color="#0000FF">function</font><font color="#808080">(</font>sArq, sreg, nTexto, sEntrada, nTentativas,
       bPesqRelativa, bTipoEntrada<font color="#808080">) {

</font>nTamLinha = tamReg<font color="#808080">(</font>sreg<font color="#808080">)
</font>sMsgErro = rotulo<font color="#808080">(</font>sreg,0<font color="#808080">)
</font>sTexto = rotulo<font color="#808080">(</font>sreg,nTexto<font color="#808080">)
</font>nPosChave = gg<font color="#808080">(</font><font color="#800000">&quot;g_nPosChave&quot;</font><font color="#808080">)
</font>nTamChave = gg<font color="#808080">(</font><font color="#800000">&quot;g_nTamChave&quot;</font><font color="#808080">)

</font>ncont = 1
bQuebra = <font color="#0000FF">FALSE
  while </font><font color="#808080">((</font>bQuebra==FALSE<font color="#808080">) </font><font color="#808000">&amp;&amp; </font><font color="#808080">(</font>ncont <font color="#808080">&lt;</font>= nTentativas <font color="#808080">)) {
    </font><font color="#0000FF">if </font><font color="#808080">(</font>bTipoEntrada==opTexto<font color="#808080">) 
      </font>sEntrada = <font color="#0000FF">readline</font><font color="#808080">(</font>sTexto<font color="#808080">)
    </font><font color="#0000FF">else if </font><font color="#808080">(</font>bTipoEntrada==opNumero<font color="#808080">)
       </font>sEntrada = validaNumero<font color="#808080">(</font>sTexto,sEntrada<font color="#808080">)
    </font><font color="#0000FF">else if </font><font color="#808080">(</font>bTipoEntrada==opData<font color="#808080">)
       </font>sEntrada = validaDataHora<font color="#808080">(</font>sTexto,sEntrada,TRUE<font color="#808080">)
    </font><font color="#0000FF">else if </font><font color="#808080">(</font>bTipoEntrada==opDataHora<font color="#808080">)
       </font>sEntrada = validaDataHora<font color="#808080">(</font>sTexto,sEntrada,FALSE<font color="#808080">)
    </font><font color="#0000FF">else if </font><font color="#808080">(</font>bTipoEntrada==opSenha<font color="#808080">) 
       </font>sEntrada = digitaSenha<font color="#808080">(</font>sTexto, 10<font color="#808080">)

    </font><font color="#0000FF">if </font><font color="#808080">(</font>bPesqRelativa<font color="#808080">) {
       </font><font color="#0000FF">if </font><font color="#808080">(</font>ListarTodos<font color="#808080">(</font>sArq, sreg, sEntrada, nPosChave, nTamChave, nTamLinha,
           QTD_MAX_LINHA, <font color="#0000FF">TRUE</font><font color="#808080">))
         </font>sres = <font color="#800000">&quot; &quot;
    </font><font color="#808080">} </font><font color="#0000FF">else
       </font>sres = pesqArq<font color="#808080">(</font>sArq, sEntrada, nPosChave, nTamChave, nTamLinha<font color="#808080">)

    </font><font color="#0000FF">if </font><font color="#808080">(</font><font color="#0000FF">nchar</font><font color="#808080">(</font>sres<font color="#808080">)</font>==0<font color="#808080">)
       </font><font color="#0000FF">cat</font><font color="#808080">(</font>sMsgErro<font color="#808080">)
    </font><font color="#0000FF">else
       </font>bQuebra = <font color="#0000FF">TRUE

    </font>ncont = ncont <font color="#808000">+ </font>1
  <font color="#808080">}
</font>validaEntrada = sres
<font color="#808080">}
</font><font color="#008000">#------------------------------------------------------------------------------
# Mostra a tela de splash do sistema.
#------------------------------------------------------------------------------
</font>frmSplash <font color="#808080">&lt;</font><font color="#808000">- </font><font color="#0000FF">function</font><font color="#808080">() {
 </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#800000">&quot;*---------------------------------------&quot;</font><font color="#808080">)
 </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#800000">&quot;-------------------------------------*\n&quot;</font><font color="#808080">)
 </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#800000">&quot;| LL    II VV   VV RRRRR  UU  UU   SSSS &quot;</font><font color="#808080">)
 </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#800000">&quot;VV   VV II RRRRR  TTTT UU  UU   SSSS |\n&quot;</font><font color="#808080">)
 </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#800000">&quot;| LL    II  VV VV  RR   R UU  UU  SS    &quot;</font><font color="#808080">)
 </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#800000">&quot; VV VV  II RR   R  TT  UU  UU  SS    |\n&quot;</font><font color="#808080">)
 </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#800000">&quot;| LL    II   VVV   RRRRR  UU  UU    SS  &quot;</font><font color="#808080">)
 </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#800000">&quot;  VVV   II RRRRR   TT  UU  UU    SS  |\n&quot;</font><font color="#808080">)
 </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#800000">&quot;| LLLLL II    V    RR   R  UUUU  SSSS   &quot;</font><font color="#808080">)
 </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#800000">&quot;   V    II RR   R  TT   UUUU  SSSS   |\n&quot;</font><font color="#808080">)
 </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#800000">&quot;*---------------------------------------&quot;</font><font color="#808080">)
 </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#800000">&quot;-------------------------------------*\n&quot;</font><font color="#808080">)
 </font><font color="#0000FF">for </font><font color="#808080">(</font>cont <font color="#0000FF">in </font>1<font color="#808080">:</font>18<font color="#808080">) </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#800000">&quot;\n&quot;</font><font color="#808080">)
 </font><font color="#0000FF">cat</font><font color="#808080">(</font>MSG_PRESS<font color="#808080">)
 </font><font color="#0000FF">readline</font><font color="#808080">()
}
</font><font color="#008000">#------------------------------------------------------------------------------
# Mostra a tela de sobre do sistema.
#------------------------------------------------------------------------------
</font>frmSobre <font color="#808080">&lt;</font><font color="#808000">- </font><font color="#0000FF">function</font><font color="#808080">() {
 </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#800000">&quot;*------------------------------------------------------------*\n&quot;</font><font color="#808080">)
 </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#800000">&quot;|  LL        II  VV       VV  RRRRRRR   UU    UU   SSSSSSS   |\n&quot;</font><font color="#808080">)
 </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#800000">&quot;|  LL        II   VV     VV   RR     R  UU    UU  SS         |\n&quot;</font><font color="#808080">)
 </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#800000">&quot;|  LL        II    VV   VV    RR     R  UU    UU   SSSS      |\n&quot;</font><font color="#808080">)
 </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#800000">&quot;|  LL        II     VV VV     RRRRRRR   UU    UU     SSSS    |\n&quot;</font><font color="#808080">)
 </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#800000">&quot;|  LLLL      II      VVV      RR RR     UU    UU        SS   |\n&quot;</font><font color="#808080">)
 </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#800000">&quot;|  LLLLLLLL  II       V       RR   RR    UUUUUU   SSSSSSSS   |\n&quot;</font><font color="#808080">)
 </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#800000">&quot;|                                                            |\n&quot;</font><font color="#808080">)
 </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#800000">&quot;|  VV       VV  II  RRRRRRR   TTTTTTTT  UU    UU   SSSSSSS   |\n&quot;</font><font color="#808080">)
 </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#800000">&quot;|   VV     VV   II  RR     R     TT     UU    UU  SS         |\n&quot;</font><font color="#808080">)
 </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#800000">&quot;|    VV   VV    II  RR     R     TT     UU    UU   SSSS      |\n&quot;</font><font color="#808080">)
 </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#800000">&quot;|     VV VV     II  RRRRRRR      TT     UU    UU     SSSS    |\n&quot;</font><font color="#808080">)
 </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#800000">&quot;|      VVV      II  RR RR        TT     UU    UU        SS   |\n&quot;</font><font color="#808080">)
 </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#800000">&quot;|       V       II  RR   RR      TT      UUUUUU   SSSSSSSS   |\n&quot;</font><font color="#808080">)
 </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#800000">&quot;|                                                            |\n&quot;</font><font color="#808080">)
 </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#800000">&quot;|                                               Versao 1.0.0 |\n&quot;</font><font color="#808080">)
 </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#800000">&quot;| Sistema integrante do projeto Livrus Virtus.               |\n&quot;</font><font color="#808080">)
 </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#800000">&quot;| Todos os direitos reservados para Henrique F. de Souza.    |\n&quot;</font><font color="#808080">)
 </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#800000">&quot;| Versao programada na linguagem R.                          |\n&quot;</font><font color="#808080">)
 </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#800000">&quot;*------------------------------------------------------------*\n&quot;</font><font color="#808080">)
 </font><font color="#0000FF">for </font><font color="#808080">(</font>cont <font color="#0000FF">in </font>1<font color="#808080">:</font>4<font color="#808080">) </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#800000">&quot;\n&quot;</font><font color="#808080">)
 </font><font color="#0000FF">cat</font><font color="#808080">(</font>MSG_PRESS<font color="#808080">)
 </font><font color="#0000FF">readline</font><font color="#808080">()
}
</font><font color="#008000">#------------------------------------------------------------------------------
# Mostra a tela de login do sistema.
# retorna - se o login foi validado corretamente
#------------------------------------------------------------------------------
</font>frmLogin <font color="#808080">&lt;</font><font color="#808000">- </font><font color="#0000FF">function</font><font color="#808080">() {
  </font>bret = <font color="#0000FF">FALSE
  cat</font><font color="#808080">(</font><font color="#800000">&quot;*--------------------------------------------------------------*\n&quot;</font><font color="#808080">)
  </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#800000">&quot;| Login do sistema                                             |\n&quot;</font><font color="#808080">)
  </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#800000">&quot;*--------------------------------------------------------------*\n&quot;</font><font color="#808080">)
  </font>slinha = validaEntrada<font color="#808080">(</font>tfUsuario, opUsuario, 1, tUsuario<font color="#808080">$</font>login, 3,
        <font color="#0000FF">FALSE</font>, opTexto<font color="#808080">)
  </font><font color="#0000FF">if </font><font color="#808080">(</font><font color="#0000FF">nchar</font><font color="#808080">(</font>slinha<font color="#808080">) &gt; </font>0<font color="#808080">) {
     </font>slinha = validaEntrada<font color="#808080">(</font>tfUsuario, opUsuario, 2, tUsuario<font color="#808080">$</font>senha, 3,
        <font color="#0000FF">FALSE</font>, opSenha<font color="#808080">)
     </font><font color="#0000FF">if </font><font color="#808080">(</font><font color="#0000FF">nchar</font><font color="#808080">(</font>slinha<font color="#808080">) &gt; </font>0<font color="#808080">) {
        </font>ag<font color="#808080">(</font><font color="#800000">&quot;tUsuario$login&quot;</font>, trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha, 1, 10<font color="#808080">)))
        </font>ag<font color="#808080">(</font><font color="#800000">&quot;tUsuario$senha&quot;</font>, trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha, 11, 10<font color="#808080">)))
        </font>bret = <font color="#0000FF">TRUE
     </font><font color="#808080">}
  }
  </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#800000">&quot;\n&quot;</font><font color="#808080">)
  </font>frmLogin = bret
<font color="#808080">}
</font><font color="#008000">#------------------------------------------------------------------------------
# Mostra os menus do sistema.
# num - o n&uacute;mero do menu
#------------------------------------------------------------------------------
</font><font color="#0000FF">menu </font><font color="#808080">&lt;</font><font color="#808000">- </font><font color="#0000FF">function</font><font color="#808080">(</font>num<font color="#808080">)
{
 </font><font color="#0000FF">if </font><font color="#808080">(</font>num==1<font color="#808080">) {
  </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#800000">&quot;*--------------------------------------------------------------*\n&quot;</font><font color="#808080">)
  </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#800000">&quot;| (C)adastros        (P)esquisas     (V)endas        (O)p&ccedil;&otilde;es  |\n&quot;</font><font color="#808080">)
  </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#800000">&quot;*--------------------------------------------------------------*\n&quot;</font><font color="#808080">)
 } </font><font color="#0000FF">else if </font><font color="#808080">(</font>num==2<font color="#808080">) {
   </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#800000">&quot;*---------------------------------*\n&quot;</font><font color="#808080">)
   </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#800000">&quot;| 01. Cadastro de Assuntos        |\n&quot;</font><font color="#808080">)
   </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#800000">&quot;| 02. Cadastro de Autores         |\n&quot;</font><font color="#808080">)
   </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#800000">&quot;| 03. Cadastro de Editoras        |\n&quot;</font><font color="#808080">)
   </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#800000">&quot;| 04. Cadastro de Endere&ccedil;os       |\n&quot;</font><font color="#808080">)
   </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#800000">&quot;| 05. Cadastro de Idiomas         |\n&quot;</font><font color="#808080">)
   </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#800000">&quot;| 06. Cadastro de Pa&iacute;ses          |\n&quot;</font><font color="#808080">)
   </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#800000">&quot;| 07. Cadastro de Profiss&otilde;es      |\n&quot;</font><font color="#808080">)
   </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#800000">&quot;| 08. Cadastro de Clientes        |\n&quot;</font><font color="#808080">)
   </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#800000">&quot;| 09. Cadastro de Livros          |\n&quot;</font><font color="#808080">)
   </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#800000">&quot;| 10. Voltar ao menu              |\n&quot;</font><font color="#808080">)
   </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#800000">&quot;*---------------------------------*\n&quot;</font><font color="#808080">)
 } </font><font color="#0000FF">else if </font><font color="#808080">(</font>num==3<font color="#808080">) {
   </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#800000">&quot;*---------------------------------*\n&quot;</font><font color="#808080">)
   </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#800000">&quot;| 01. Consulta de Assuntos        |\n&quot;</font><font color="#808080">)
   </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#800000">&quot;| 02. Consulta de Autores         |\n&quot;</font><font color="#808080">)
   </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#800000">&quot;| 03. Consulta de Editoras        |\n&quot;</font><font color="#808080">)
   </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#800000">&quot;| 04. Consulta de Endere&ccedil;os       |\n&quot;</font><font color="#808080">)
   </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#800000">&quot;| 05. Consulta de Idiomas         |\n&quot;</font><font color="#808080">)
   </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#800000">&quot;| 06. Consulta de Pa&iacute;ses          |\n&quot;</font><font color="#808080">)
   </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#800000">&quot;| 07. Consulta de Profiss&otilde;es      |\n&quot;</font><font color="#808080">)
   </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#800000">&quot;| 08. Consulta de Clientes        |\n&quot;</font><font color="#808080">)
   </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#800000">&quot;| 09. Consulta de Livros          |\n&quot;</font><font color="#808080">)
   </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#800000">&quot;| 10. Voltar ao menu              |\n&quot;</font><font color="#808080">)
   </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#800000">&quot;*---------------------------------*\n&quot;</font><font color="#808080">)
 } </font><font color="#0000FF">else if </font><font color="#808080">(</font>num==4<font color="#808080">) {
   </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#800000">&quot;*---------------------------------*\n&quot;</font><font color="#808080">)
   </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#800000">&quot;| 01. Vender Livros               |\n&quot;</font><font color="#808080">)
   </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#800000">&quot;| 02. Vendas Realizadas           |\n&quot;</font><font color="#808080">)
   </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#800000">&quot;| 03. Voltar ao menu              |\n&quot;</font><font color="#808080">)
   </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#800000">&quot;*---------------------------------*\n&quot;</font><font color="#808080">)
 } </font><font color="#0000FF">else if </font><font color="#808080">(</font>num==5<font color="#808080">) {
   </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#800000">&quot;*---------------------------------*\n&quot;</font><font color="#808080">)
   </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#800000">&quot;| 01. Alterar senha               |\n&quot;</font><font color="#808080">)
   </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#800000">&quot;| 02. Sobre o sistema             |\n&quot;</font><font color="#808080">)
   </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#800000">&quot;| 03. Sair do sistema             |\n&quot;</font><font color="#808080">)
   </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#800000">&quot;| 04. Voltar ao menu              |\n&quot;</font><font color="#808080">)
   </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#800000">&quot;*---------------------------------*\n&quot;</font><font color="#808080">)
 } </font><font color="#0000FF">else if </font><font color="#808080">(</font>num==6<font color="#808080">) {
   </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#800000">&quot;*--------------------------------------------------------------*\n&quot;</font><font color="#808080">)
   </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#800000">&quot;| (1) Novo  (2) Pesquisar   (3) Voltar ao menu                 |\n&quot;</font><font color="#808080">)
   </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#800000">&quot;*--------------------------------------------------------------*\n&quot;</font><font color="#808080">)
 } </font><font color="#0000FF">else if </font><font color="#808080">(</font>num==7<font color="#808080">) {
   </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#800000">&quot;*--------------------------------------------------------------*\n&quot;</font><font color="#808080">)
   </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#800000">&quot;| (1) Salvar inclus&atilde;o       (2) Voltar ao menu                 |\n&quot;</font><font color="#808080">)
   </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#800000">&quot;*--------------------------------------------------------------*\n&quot;</font><font color="#808080">)
 } </font><font color="#0000FF">else if </font><font color="#808080">(</font>num==8<font color="#808080">) {
   </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#800000">&quot;*--------------------------------------------------------------*\n&quot;</font><font color="#808080">)
   </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#800000">&quot;| (1) Alterar       (2) Excluir     (3) Voltar ao menu         |\n&quot;</font><font color="#808080">)
   </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#800000">&quot;*--------------------------------------------------------------*\n&quot;</font><font color="#808080">)
 } </font><font color="#0000FF">else if </font><font color="#808080">(</font>num==9<font color="#808080">) {
   </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#800000">&quot;*--------------------------------------------------------------*\n&quot;</font><font color="#808080">)
   </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#800000">&quot;| (1) Salvar altera&ccedil;&atilde;o      (2) Voltar ao menu                 |\n&quot;</font><font color="#808080">)
   </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#800000">&quot;*--------------------------------------------------------------*\n&quot;</font><font color="#808080">)
 } </font><font color="#0000FF">else if </font><font color="#808080">(</font>num==10<font color="#808080">) {
   </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#800000">&quot;*--------------------------------------------------------------*\n&quot;</font><font color="#808080">)
   </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#800000">&quot;| Certeza de excluir? (S/N)                                    |\n&quot;</font><font color="#808080">)
   </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#800000">&quot;*--------------------------------------------------------------*\n&quot;</font><font color="#808080">)
 } </font><font color="#0000FF">else if </font><font color="#808080">(</font>num==11<font color="#808080">) {
   </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#800000">&quot;*--------------------------------------------------------------*\n&quot;</font><font color="#808080">)
   </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#800000">&quot;| Deseja sair do sistema? (S/N)                                |\n&quot;</font><font color="#808080">)
   </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#800000">&quot;*--------------------------------------------------------------*\n&quot;</font><font color="#808080">)
 } </font><font color="#0000FF">else if </font><font color="#808080">(</font>num==12<font color="#808080">) {
   </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#800000">&quot;*--------------------------------------------------------------*\n&quot;</font><font color="#808080">)
   </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#800000">&quot;| (1) Pesquisar  (2) Listar todos   (3) Voltar ao menu         |\n&quot;</font><font color="#808080">)
   </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#800000">&quot;*--------------------------------------------------------------*\n&quot;</font><font color="#808080">)
 } </font><font color="#0000FF">else if </font><font color="#808080">(</font>num==13<font color="#808080">) {
   </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#800000">&quot;*--------------------------------------------------------------*\n&quot;</font><font color="#808080">)
   </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#800000">&quot;| Deseja continuar? (S/N)                                      |\n&quot;</font><font color="#808080">)
   </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#800000">&quot;*--------------------------------------------------------------*\n&quot;</font><font color="#808080">)
 } </font><font color="#0000FF">else if </font><font color="#808080">(</font>num==14<font color="#808080">) {
   </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#800000">&quot;*--------------------------------------------------------------*\n&quot;</font><font color="#808080">)
   </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#800000">&quot;| Salvar inclus&atilde;o (S/N)                                        |\n&quot;</font><font color="#808080">)
   </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#800000">&quot;*--------------------------------------------------------------*\n&quot;</font><font color="#808080">)
 }
 </font><font color="#0000FF">cat</font><font color="#808080">(</font>MSG_OPCAO<font color="#808080">)
}
</font><font color="#008000">#------------------------------------------------------------------------------
# Realiza os cadastros de acordo com o tipo de arquivo.
# sreg - o tipo de arquivo
# sacao - a a&ccedil;&atilde;o a ser realizada
#------------------------------------------------------------------------------
</font>frmCadastros <font color="#808080">&lt;</font><font color="#808000">- </font><font color="#0000FF">function</font><font color="#808080">(</font>sreg, sacao<font color="#808080">) {
</font>slinha = <font color="#800000">&quot;&quot;

</font><font color="#0000FF">if </font><font color="#808080">(</font>sreg==opAssunto<font color="#808080">) {
   </font><font color="#0000FF">if </font><font color="#808080">(</font>sacao==opNovo<font color="#808080">) {
      </font>ag<font color="#808080">(</font><font color="#800000">&quot;tAssunto$codigo&quot;</font>, pesqMaxCod<font color="#808080">(</font>tfAssunto, 1, 10, tamReg<font color="#808080">(</font>sreg<font color="#808080">)))
      </font>mostrarDados<font color="#808080">(</font>sreg, <font color="#800000">&quot;&quot;</font>, 1<font color="#808080">)
      </font>subMenu<font color="#808080">(</font>7, sreg<font color="#808080">)
   } </font><font color="#0000FF">else if </font><font color="#808080">(</font>sacao==opPesquisar<font color="#808080">) {
     </font>slinha = validaEntrada<font color="#808080">(</font>tfAssunto,sreg,1,tAssunto<font color="#808080">$</font>codigo,1,FALSE,opNumero<font color="#808080">)
      </font><font color="#0000FF">if </font><font color="#808080">(</font><font color="#0000FF">nchar</font><font color="#808080">(</font>slinha<font color="#808080">) &gt; </font>0<font color="#808080">) {
        </font>mostrarDados<font color="#808080">(</font>sreg, <font color="#800000">&quot;&quot;</font>, 2<font color="#808080">)
        </font>mostrarDados<font color="#808080">(</font>sreg, slinha, 3<font color="#808080">)
        </font>subMenu<font color="#808080">(</font>8, sreg<font color="#808080">)
      }
   } </font><font color="#0000FF">else if </font><font color="#808080">(</font>sacao==opAlterar<font color="#808080">) {
      </font>mostrarDados<font color="#808080">(</font>sreg, <font color="#800000">&quot;&quot;</font>, 1<font color="#808080">)
      </font>subMenu<font color="#808080">(</font>9, sreg<font color="#808080">)
   } </font><font color="#0000FF">else if </font><font color="#808080">(</font>sacao==opExcluir<font color="#808080">) {
      </font>subMenu<font color="#808080">(</font>10, sreg<font color="#808080">)
   }
} </font><font color="#0000FF">else if </font><font color="#808080">(</font>sreg==opAutor<font color="#808080">) {
   </font><font color="#0000FF">if </font><font color="#808080">(</font>sacao==opNovo<font color="#808080">) {
      </font>ag<font color="#808080">(</font><font color="#800000">&quot;tAutor$codigo&quot;</font>, pesqMaxCod<font color="#808080">(</font>tfAutor, 1, 10, tamReg<font color="#808080">(</font>sreg<font color="#808080">)))
      </font>mostrarDados<font color="#808080">(</font>sreg, <font color="#800000">&quot;&quot;</font>, 1<font color="#808080">)
      </font>subMenu<font color="#808080">(</font>7, sreg<font color="#808080">)
   } </font><font color="#0000FF">else if </font><font color="#808080">(</font>sacao==opPesquisar<font color="#808080">) {
      </font>slinha = validaEntrada<font color="#808080">(</font>tfAutor, sreg, 1, tAutor<font color="#808080">$</font>codigo,1,FALSE,opNumero<font color="#808080">)
      </font><font color="#0000FF">if </font><font color="#808080">(</font><font color="#0000FF">nchar</font><font color="#808080">(</font>slinha<font color="#808080">) &gt; </font>0<font color="#808080">) {
        </font>mostrarDados<font color="#808080">(</font>sreg, <font color="#800000">&quot;&quot;</font>, 2<font color="#808080">)
        </font>mostrarDados<font color="#808080">(</font>sreg, slinha, 3<font color="#808080">)
        </font>subMenu<font color="#808080">(</font>8, sreg<font color="#808080">)
      }
   } </font><font color="#0000FF">else if </font><font color="#808080">(</font>sacao==opAlterar<font color="#808080">) {
      </font>mostrarDados<font color="#808080">(</font>sreg, <font color="#800000">&quot;&quot;</font>, 1<font color="#808080">)
      </font>subMenu<font color="#808080">(</font>9, sreg<font color="#808080">)
   } </font><font color="#0000FF">else if </font><font color="#808080">(</font>sacao==opExcluir<font color="#808080">) {
      </font>subMenu<font color="#808080">(</font>10, sreg<font color="#808080">)
   }
} </font><font color="#0000FF">else if </font><font color="#808080">(</font>sreg==opEditora<font color="#808080">) {
   </font><font color="#0000FF">if </font><font color="#808080">(</font>sacao==opNovo<font color="#808080">) {
      </font>ag<font color="#808080">(</font><font color="#800000">&quot;tEditora$codigo&quot;</font>, pesqMaxCod<font color="#808080">(</font>tfEditora, 1, 10, tamReg<font color="#808080">(</font>sreg<font color="#808080">)))
      </font>mostrarDados<font color="#808080">(</font>sreg, <font color="#800000">&quot;&quot;</font>, 1<font color="#808080">)
      </font>subMenu<font color="#808080">(</font>7, sreg<font color="#808080">)
   } </font><font color="#0000FF">else if </font><font color="#808080">(</font>sacao==opPesquisar<font color="#808080">) {
      </font>slinha = validaEntrada<font color="#808080">(</font>tfEditora,sreg,1,tEditora<font color="#808080">$</font>codigo,1,FALSE,opNumero<font color="#808080">)
      </font><font color="#0000FF">if </font><font color="#808080">(</font><font color="#0000FF">nchar</font><font color="#808080">(</font>slinha<font color="#808080">) &gt; </font>0<font color="#808080">) {
        </font>mostrarDados<font color="#808080">(</font>sreg, <font color="#800000">&quot;&quot;</font>, 2<font color="#808080">)
        </font>mostrarDados<font color="#808080">(</font>sreg, slinha, 3<font color="#808080">)
        </font>subMenu<font color="#808080">(</font>8, sreg<font color="#808080">)
      }
   } </font><font color="#0000FF">else if </font><font color="#808080">(</font>sacao==opAlterar<font color="#808080">) {
      </font>mostrarDados<font color="#808080">(</font>sreg, <font color="#800000">&quot;&quot;</font>, 1<font color="#808080">)
      </font>subMenu<font color="#808080">(</font>9, sreg<font color="#808080">)
   } </font><font color="#0000FF">else if </font><font color="#808080">(</font>sacao==opExcluir<font color="#808080">) {
      </font>subMenu<font color="#808080">(</font>10, sreg<font color="#808080">)
   }
} </font><font color="#0000FF">else if </font><font color="#808080">(</font>sreg==opEndereco<font color="#808080">) {
   </font><font color="#0000FF">if </font><font color="#808080">(</font>sacao==opNovo<font color="#808080">) {
      </font>ag<font color="#808080">(</font><font color="#800000">&quot;tEndereco$codigo&quot;</font>, pesqMaxCod<font color="#808080">(</font>tfEndereco, 1, 10, tamReg<font color="#808080">(</font>sreg<font color="#808080">)))
      </font>mostrarDados<font color="#808080">(</font>sreg, <font color="#800000">&quot;&quot;</font>, 1<font color="#808080">)
      </font>subMenu<font color="#808080">(</font>7, sreg<font color="#808080">)
   } </font><font color="#0000FF">else if </font><font color="#808080">(</font>sacao==opPesquisar<font color="#808080">) {
      </font>slinha = validaEntrada<font color="#808080">(</font>tfEndereco,sreg,1,tEndereco<font color="#808080">$</font>codigo,1,
              <font color="#0000FF">FALSE</font>,opNumero<font color="#808080">)
      </font><font color="#0000FF">if </font><font color="#808080">(</font><font color="#0000FF">nchar</font><font color="#808080">(</font>slinha<font color="#808080">) &gt; </font>0<font color="#808080">) {
        </font>mostrarDados<font color="#808080">(</font>sreg, <font color="#800000">&quot;&quot;</font>, 2<font color="#808080">)
        </font>mostrarDados<font color="#808080">(</font>sreg, slinha, 3<font color="#808080">)
        </font>subMenu<font color="#808080">(</font>8, sreg<font color="#808080">)
      }
   } </font><font color="#0000FF">else if </font><font color="#808080">(</font>sacao==opAlterar<font color="#808080">) {
      </font>mostrarDados<font color="#808080">(</font>sreg, <font color="#800000">&quot;&quot;</font>, 1<font color="#808080">)
      </font>subMenu<font color="#808080">(</font>9, sreg<font color="#808080">)
   } </font><font color="#0000FF">else if </font><font color="#808080">(</font>sacao==opExcluir<font color="#808080">) {
      </font>subMenu<font color="#808080">(</font>10, sreg<font color="#808080">)
   }
} </font><font color="#0000FF">else if </font><font color="#808080">(</font>sreg==opIdioma<font color="#808080">) {
   </font><font color="#0000FF">if </font><font color="#808080">(</font>sacao==opNovo<font color="#808080">) {
      </font>ag<font color="#808080">(</font><font color="#800000">&quot;tIdioma$codigo&quot;</font>, pesqMaxCod<font color="#808080">(</font>tfIdioma, 1, 10, tamReg<font color="#808080">(</font>sreg<font color="#808080">)))
      </font>mostrarDados<font color="#808080">(</font>sreg, <font color="#800000">&quot;&quot;</font>, 1<font color="#808080">)
      </font>subMenu<font color="#808080">(</font>7, sreg<font color="#808080">)
   } </font><font color="#0000FF">else if </font><font color="#808080">(</font>sacao==opPesquisar<font color="#808080">) {
      </font>slinha = validaEntrada<font color="#808080">(</font>tfIdioma,sreg,1,tIdioma<font color="#808080">$</font>codigo,1,FALSE,opNumero<font color="#808080">)
      </font><font color="#0000FF">if </font><font color="#808080">(</font><font color="#0000FF">nchar</font><font color="#808080">(</font>slinha<font color="#808080">) &gt; </font>0<font color="#808080">) {
        </font>mostrarDados<font color="#808080">(</font>sreg, <font color="#800000">&quot;&quot;</font>, 2<font color="#808080">)
        </font>mostrarDados<font color="#808080">(</font>sreg, slinha, 3<font color="#808080">)
        </font>subMenu<font color="#808080">(</font>8, sreg<font color="#808080">)
      }
   } </font><font color="#0000FF">else if </font><font color="#808080">(</font>sacao==opAlterar<font color="#808080">) {
      </font>mostrarDados<font color="#808080">(</font>sreg, <font color="#800000">&quot;&quot;</font>, 1<font color="#808080">)
      </font>subMenu<font color="#808080">(</font>9, sreg<font color="#808080">)
   } </font><font color="#0000FF">else if </font><font color="#808080">(</font>sacao==opExcluir<font color="#808080">) {
      </font>subMenu<font color="#808080">(</font>10, sreg<font color="#808080">)
   }
} </font><font color="#0000FF">else if </font><font color="#808080">(</font>sreg==opPais<font color="#808080">) {
   </font><font color="#0000FF">if </font><font color="#808080">(</font>sacao==opNovo<font color="#808080">) {
      </font>ag<font color="#808080">(</font><font color="#800000">&quot;tPais$codigo&quot;</font>, <font color="#0000FF">readline</font><font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg, 1<font color="#808080">)))
      </font>slinha = pesqArq<font color="#808080">(</font>tfPais, gg<font color="#808080">(</font><font color="#800000">&quot;tPais$codigo&quot;</font><font color="#808080">)</font>, 1, 3, tamReg<font color="#808080">(</font>sreg<font color="#808080">))
      </font><font color="#0000FF">if </font><font color="#808080">(</font><font color="#0000FF">nchar</font><font color="#808080">(</font>slinha<font color="#808080">)</font>==0<font color="#808080">) {
         </font>pesqLinhaExcluida<font color="#808080">(</font>tfPais, tamReg<font color="#808080">(</font>sreg<font color="#808080">))
         </font>mostrarDados<font color="#808080">(</font>sreg, <font color="#800000">&quot;&quot;</font>, 1<font color="#808080">)
         </font>subMenu<font color="#808080">(</font>7, sreg<font color="#808080">)
      } </font><font color="#0000FF">else cat</font><font color="#808080">(</font>MSG_REGEXST<font color="#808080">)
   } </font><font color="#0000FF">else if </font><font color="#808080">(</font>sacao==opPesquisar<font color="#808080">) {
      </font>slinha = validaEntrada<font color="#808080">(</font>tfPais, sreg, 1, tPais<font color="#808080">$</font>codigo, 1, <font color="#0000FF">FALSE</font>, opTexto<font color="#808080">)
      </font><font color="#0000FF">if </font><font color="#808080">(</font><font color="#0000FF">nchar</font><font color="#808080">(</font>slinha<font color="#808080">) &gt; </font>0<font color="#808080">) {
        </font>mostrarDados<font color="#808080">(</font>sreg, <font color="#800000">&quot;&quot;</font>, 2<font color="#808080">)
        </font>mostrarDados<font color="#808080">(</font>sreg, slinha, 3<font color="#808080">)
        </font>subMenu<font color="#808080">(</font>8, sreg<font color="#808080">)
      }
   } </font><font color="#0000FF">else if </font><font color="#808080">(</font>sacao==opAlterar<font color="#808080">) {
      </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#0000FF">sprintf</font><font color="#808080">(</font><font color="#800000">&quot;%s%s\n&quot;</font>, rotulo<font color="#808080">(</font>sreg, 1<font color="#808080">)</font>, gg<font color="#808080">(</font><font color="#800000">&quot;tPais$codigo&quot;</font><font color="#808080">)))
      </font>mostrarDados<font color="#808080">(</font>sreg, <font color="#800000">&quot;&quot;</font>, 1<font color="#808080">)
      </font>subMenu<font color="#808080">(</font>9, sreg<font color="#808080">)
   } </font><font color="#0000FF">else if </font><font color="#808080">(</font>sacao==opExcluir<font color="#808080">) {
      </font>subMenu<font color="#808080">(</font>10, sreg<font color="#808080">)
   }
} </font><font color="#0000FF">else if </font><font color="#808080">(</font>sreg==opProfissao<font color="#808080">) {
   </font><font color="#0000FF">if </font><font color="#808080">(</font>sacao==opNovo<font color="#808080">) {
      </font>ag<font color="#808080">(</font><font color="#800000">&quot;tProfissao$codigo&quot;</font>, pesqMaxCod<font color="#808080">(</font>tfProfissao, 1, 10, tamReg<font color="#808080">(</font>sreg<font color="#808080">)))
      </font>mostrarDados<font color="#808080">(</font>sreg, <font color="#800000">&quot;&quot;</font>, 1<font color="#808080">)
      </font>subMenu<font color="#808080">(</font>7, sreg<font color="#808080">)
   } </font><font color="#0000FF">else if </font><font color="#808080">(</font>sacao==opPesquisar<font color="#808080">) {
      </font>slinha = validaEntrada<font color="#808080">(</font>tfProfissao,sreg,1,tProfissao<font color="#808080">$</font>codigo,1,
              <font color="#0000FF">FALSE</font>,opNumero<font color="#808080">)
      </font><font color="#0000FF">if </font><font color="#808080">(</font><font color="#0000FF">nchar</font><font color="#808080">(</font>slinha<font color="#808080">) &gt; </font>0<font color="#808080">) {
        </font>mostrarDados<font color="#808080">(</font>sreg, <font color="#800000">&quot;&quot;</font>, 2<font color="#808080">)
        </font>mostrarDados<font color="#808080">(</font>sreg, slinha, 3<font color="#808080">)
        </font>subMenu<font color="#808080">(</font>8, sreg<font color="#808080">)
      }
   } </font><font color="#0000FF">else if </font><font color="#808080">(</font>sacao==opAlterar<font color="#808080">) {
      </font>mostrarDados<font color="#808080">(</font>sreg, <font color="#800000">&quot;&quot;</font>, 1<font color="#808080">)
      </font>subMenu<font color="#808080">(</font>9, sreg<font color="#808080">)
   } </font><font color="#0000FF">else if </font><font color="#808080">(</font>sacao==opExcluir<font color="#808080">) {
      </font>subMenu<font color="#808080">(</font>10, sreg<font color="#808080">)
   }
} </font><font color="#0000FF">else if </font><font color="#808080">(</font>sreg==opLivro<font color="#808080">) {
   </font><font color="#0000FF">if </font><font color="#808080">(</font>sacao==opNovo<font color="#808080">) {
      </font>ag<font color="#808080">(</font><font color="#800000">&quot;tLivro$isbn&quot;</font>, <font color="#0000FF">readline</font><font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg, 1<font color="#808080">)))
      </font><font color="#0000FF">if </font><font color="#808080">(</font>validaISBN<font color="#808080">(</font>gg<font color="#808080">(</font><font color="#800000">&quot;tLivro$isbn&quot;</font><font color="#808080">))) {
          </font>slinha = pesqArq<font color="#808080">(</font>tfLivro, gg<font color="#808080">(</font><font color="#800000">&quot;tLivro$isbn&quot;</font><font color="#808080">)</font>, 1, 13, tamReg<font color="#808080">(</font>sreg<font color="#808080">))
          </font><font color="#0000FF">if </font><font color="#808080">(</font><font color="#0000FF">nchar</font><font color="#808080">(</font>slinha<font color="#808080">)</font>==0<font color="#808080">) {
             </font>pesqLinhaExcluida<font color="#808080">(</font>tfLivro, tamReg<font color="#808080">(</font>sreg<font color="#808080">))
             </font>mostrarDados<font color="#808080">(</font>sreg, <font color="#800000">&quot;&quot;</font>, 1<font color="#808080">)
             </font>subMenu<font color="#808080">(</font>7, sreg<font color="#808080">)
             </font>frmCadLigados<font color="#808080">(</font>opLivroAss, opNovo, gg<font color="#808080">(</font><font color="#800000">&quot;tLivro$isbn&quot;</font><font color="#808080">))
             </font>frmCadLigados<font color="#808080">(</font>opLivroAut, opNovo, gg<font color="#808080">(</font><font color="#800000">&quot;tLivro$isbn&quot;</font><font color="#808080">))
          } </font><font color="#0000FF">else cat</font><font color="#808080">(</font>MSG_REGEXST<font color="#808080">)
      } </font><font color="#0000FF">else cat</font><font color="#808080">(</font>MSG_ISBNINV<font color="#808080">)
   } </font><font color="#0000FF">else if </font><font color="#808080">(</font>sacao==opPesquisar<font color="#808080">) {
      </font>slinha = validaEntrada<font color="#808080">(</font>tfLivro, sreg, 1, tLivro<font color="#808080">$</font>isbn, 1,FALSE,opTexto<font color="#808080">)
      </font><font color="#0000FF">if </font><font color="#808080">(</font><font color="#0000FF">nchar</font><font color="#808080">(</font>slinha<font color="#808080">) &gt; </font>0<font color="#808080">) {
         </font>mostrarDados<font color="#808080">(</font>sreg, <font color="#800000">&quot;&quot;</font>, 2<font color="#808080">)
         </font>mostrarDados<font color="#808080">(</font>sreg, slinha, 3<font color="#808080">)
         </font>subMenu<font color="#808080">(</font>8, sreg<font color="#808080">)
      }
   } </font><font color="#0000FF">else if </font><font color="#808080">(</font>sacao==opAlterar<font color="#808080">) {
      </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#0000FF">sprintf</font><font color="#808080">(</font><font color="#800000">&quot;%s%s\n&quot;</font>,rotulo<font color="#808080">(</font>sreg, 1<font color="#808080">)</font>, gg<font color="#808080">(</font><font color="#800000">&quot;tLivro$isbn&quot;</font><font color="#808080">)))
      </font>mostrarDados<font color="#808080">(</font>sreg, <font color="#800000">&quot;&quot;</font>, 1<font color="#808080">)
      </font>subMenu<font color="#808080">(</font>9, sreg<font color="#808080">)
      </font>frmCadLigados<font color="#808080">(</font>opLivroAss, opExcluir, gg<font color="#808080">(</font><font color="#800000">&quot;tLivro$isbn&quot;</font><font color="#808080">))
      </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#800000">&quot;Assuntos dos livros exclu&iacute;dos, inclua novos!\n&quot;</font><font color="#808080">)
      </font>frmCadLigados<font color="#808080">(</font>opLivroAss, opNovo, gg<font color="#808080">(</font><font color="#800000">&quot;tLivro$isbn&quot;</font><font color="#808080">))
      </font>frmCadLigados<font color="#808080">(</font>opLivroAut, opExcluir, gg<font color="#808080">(</font><font color="#800000">&quot;tLivro$isbn&quot;</font><font color="#808080">))
      </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#800000">&quot;Autores dos livros exclu&iacute;dos, inclua novos!\n&quot;</font><font color="#808080">)
      </font>frmCadLigados<font color="#808080">(</font>opLivroAut, opNovo, gg<font color="#808080">(</font><font color="#800000">&quot;tLivro$isbn&quot;</font><font color="#808080">))
   } </font><font color="#0000FF">else if </font><font color="#808080">(</font>sacao==opExcluir<font color="#808080">) {
      </font>subMenu<font color="#808080">(</font>10, sreg<font color="#808080">)
      </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#800000">&quot;Assuntos dos livros sendo exclu&iacute;dos!\n&quot;</font><font color="#808080">)
      </font>frmCadLigados<font color="#808080">(</font>opLivroAss, opExcluir, gg<font color="#808080">(</font><font color="#800000">&quot;tLivro$isbn&quot;</font><font color="#808080">))
      </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#800000">&quot;Autores dos livros sendo exclu&iacute;dos!\n&quot;</font><font color="#808080">)
      </font>frmCadLigados<font color="#808080">(</font>opLivroAut, opExcluir, gg<font color="#808080">(</font><font color="#800000">&quot;tLivro$isbn&quot;</font><font color="#808080">))
   }
} </font><font color="#0000FF">else if </font><font color="#808080">(</font>sreg==opCliente<font color="#808080">) {
   </font><font color="#0000FF">if </font><font color="#808080">(</font>sacao==opNovo<font color="#808080">) {
      </font>ag<font color="#808080">(</font><font color="#800000">&quot;tCliente$cpf&quot;</font>, <font color="#0000FF">readline</font><font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg, 1<font color="#808080">)))
      </font><font color="#0000FF">if </font><font color="#808080">(</font>validaCPF<font color="#808080">(</font>gg<font color="#808080">(</font><font color="#800000">&quot;tCliente$cpf&quot;</font><font color="#808080">))) {
          </font>slinha = pesqArq<font color="#808080">(</font>tfCliente, gg<font color="#808080">(</font><font color="#800000">&quot;tCliente$cpf&quot;</font><font color="#808080">)</font>, 1, 14, tamReg<font color="#808080">(</font>sreg<font color="#808080">))
          </font><font color="#0000FF">if </font><font color="#808080">(</font><font color="#0000FF">nchar</font><font color="#808080">(</font>slinha<font color="#808080">)</font>==0<font color="#808080">) {
             </font>pesqLinhaExcluida<font color="#808080">(</font>tfCliente, tamReg<font color="#808080">(</font>sreg<font color="#808080">))
             </font>mostrarDados<font color="#808080">(</font>sreg, <font color="#800000">&quot;&quot;</font>, 1<font color="#808080">)
             </font>subMenu<font color="#808080">(</font>7, sreg<font color="#808080">)
          } </font><font color="#0000FF">else cat</font><font color="#808080">(</font>MSG_REGEXST<font color="#808080">)
      } </font><font color="#0000FF">else cat</font><font color="#808080">(</font>MSG_CPFINV<font color="#808080">)
   } </font><font color="#0000FF">else if </font><font color="#808080">(</font>sacao==opPesquisar<font color="#808080">) {
      </font>slinha = validaEntrada<font color="#808080">(</font>tfCliente, sreg, 1, tCliente<font color="#808080">$</font>cpf,1,FALSE,opTexto<font color="#808080">)
      </font><font color="#0000FF">if </font><font color="#808080">(</font><font color="#0000FF">nchar</font><font color="#808080">(</font>slinha<font color="#808080">) &gt; </font>0<font color="#808080">) {
         </font>mostrarDados<font color="#808080">(</font>sreg, <font color="#800000">&quot;&quot;</font>, 2<font color="#808080">)
         </font>mostrarDados<font color="#808080">(</font>sreg, slinha, 3<font color="#808080">)
         </font>subMenu<font color="#808080">(</font>8, sreg<font color="#808080">)
      }
   } </font><font color="#0000FF">else if </font><font color="#808080">(</font>sacao==opAlterar<font color="#808080">) {
      </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#0000FF">sprintf</font><font color="#808080">(</font><font color="#800000">&quot;%s%s\n&quot;</font>,rotulo<font color="#808080">(</font>sreg, 1<font color="#808080">)</font>, gg<font color="#808080">(</font><font color="#800000">&quot;tCliente$cpf&quot;</font><font color="#808080">)))
      </font>mostrarDados<font color="#808080">(</font>sreg, <font color="#800000">&quot;&quot;</font>, 1<font color="#808080">)
      </font>subMenu<font color="#808080">(</font>9, sreg<font color="#808080">)
   } </font><font color="#0000FF">else if </font><font color="#808080">(</font>sacao==opExcluir<font color="#808080">) {
      </font>subMenu<font color="#808080">(</font>10, sreg<font color="#808080">)
   }
} </font><font color="#0000FF">else if </font><font color="#808080">(</font>sreg==opVenda<font color="#808080">) {
   </font><font color="#0000FF">if </font><font color="#808080">(</font>sacao==opNovo<font color="#808080">) {
      </font>ag<font color="#808080">(</font><font color="#800000">&quot;tVenda$dthrvenda&quot;</font>, retDataHora<font color="#808080">())
      </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#0000FF">sprintf</font><font color="#808080">(</font><font color="#800000">&quot;%s%s\n&quot;</font>,rotulo<font color="#808080">(</font>sreg, 1<font color="#808080">)</font>, gg<font color="#808080">(</font><font color="#800000">&quot;tVenda$dthrvenda&quot;</font><font color="#808080">)))
      </font>slinha = pesqArq<font color="#808080">(</font>tfVenda, gg<font color="#808080">(</font><font color="#800000">&quot;tVenda$dthrvenda&quot;</font><font color="#808080">)</font>, 1, 19, tamReg<font color="#808080">(</font>sreg<font color="#808080">))
      </font><font color="#0000FF">if </font><font color="#808080">(</font><font color="#0000FF">nchar</font><font color="#808080">(</font>slinha<font color="#808080">)</font>==0<font color="#808080">) {
         </font>slinha = validaEntrada<font color="#808080">(</font>tfCliente,opCliente,1,tVenda<font color="#808080">$</font>cpf,3,
                 <font color="#0000FF">FALSE</font>,opTexto<font color="#808080">)
         </font><font color="#0000FF">if </font><font color="#808080">(</font><font color="#0000FF">nchar</font><font color="#808080">(</font>slinha<font color="#808080">) &gt; </font>0<font color="#808080">) {
            </font>ag<font color="#808080">(</font><font color="#800000">&quot;tVenda$cpf&quot;</font>, trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha,1,14<font color="#808080">)))
            </font><font color="#0000FF">if </font><font color="#808080">(</font>validaCPF<font color="#808080">(</font>gg<font color="#808080">(</font><font color="#800000">&quot;tVenda$cpf&quot;</font><font color="#808080">))) {
               </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#0000FF">sprintf</font><font color="#808080">(</font><font color="#800000">&quot; %s&quot;</font>,rotulo<font color="#808080">(</font>opCliente, 2<font color="#808080">))) </font><font color="#008000"># Nome
               </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#0000FF">sprintf</font><font color="#808080">(</font><font color="#800000">&quot;%s\n&quot;</font>, copy<font color="#808080">(</font>slinha, gg<font color="#808080">(</font><font color="#800000">&quot;g_nPosChave&quot;</font><font color="#808080">)</font>, gg<font color="#808080">(</font><font color="#800000">&quot;g_nTamChave&quot;</font><font color="#808080">))))
               </font>frmCadLigados<font color="#808080">(</font>opVenda, opNovo, gg<font color="#808080">(</font><font color="#800000">&quot;tVenda$cpf&quot;</font><font color="#808080">))
            } </font><font color="#0000FF">else cat</font><font color="#808080">(</font>MSG_CPFINV<font color="#808080">)
         }
      } </font><font color="#0000FF">else cat</font><font color="#808080">(</font>MSG_REGEXST<font color="#808080">)
   } </font><font color="#0000FF">else if </font><font color="#808080">(</font>sacao==opPesquisar<font color="#808080">) {
      </font>slinha = validaEntrada<font color="#808080">(</font>tfVenda, sreg, 1, tVenda<font color="#808080">$</font>dthrvenda,1,
              <font color="#0000FF">FALSE</font>,opDataHora<font color="#808080">)
      </font><font color="#0000FF">if </font><font color="#808080">(</font><font color="#0000FF">nchar</font><font color="#808080">(</font>slinha<font color="#808080">) &gt; </font>0<font color="#808080">) {
        </font>mostrarDados<font color="#808080">(</font>sreg, <font color="#800000">&quot;&quot;</font>, 2<font color="#808080">)
        </font>mostrarDados<font color="#808080">(</font>sreg, slinha, 3<font color="#808080">)
        </font>subMenu<font color="#808080">(</font>8, sreg<font color="#808080">)
      }
   }
}

}
</font><font color="#008000">#------------------------------------------------------------------------------
# Realiza as consultas de acordo com o tipo de arquivo.
# sreg - o tipo de arquivo
# sacao - a a&ccedil;&atilde;o a ser realizada
#------------------------------------------------------------------------------
</font>frmConsultas <font color="#808080">&lt;</font><font color="#808000">- </font><font color="#0000FF">function</font><font color="#808080">(</font>sreg, sacao<font color="#808080">) {
</font>slinha = <font color="#800000">&quot;&quot;

</font><font color="#0000FF">if </font><font color="#808080">(</font>sreg==opAssunto<font color="#808080">) {
   </font><font color="#0000FF">if </font><font color="#808080">(</font>sacao==opPesquisar<font color="#808080">)
      </font>slinha = validaEntrada<font color="#808080">(</font>tfAssunto,sreg,2,tAssunto.assunto,1,TRUE,opTexto<font color="#808080">)
   </font><font color="#0000FF">else if </font><font color="#808080">(</font>sacao==opListarTodos<font color="#808080">) {
      </font><font color="#0000FF">if </font><font color="#808080">(</font>ListarTodos<font color="#808080">(</font>tfAssunto, sreg, <font color="#800000">&quot;&quot;</font>, 0, 0, tamReg<font color="#808080">(</font>sreg<font color="#808080">)</font>,
        QTD_MAX_LINHA, <font color="#0000FF">FALSE</font><font color="#808080">) </font>== <font color="#0000FF">FALSE</font><font color="#808080">)
        </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#0000FF">sprintf</font><font color="#808080">(</font><font color="#800000">&quot;%s\n&quot;</font>,rotulo<font color="#808080">(</font>sreg, 0<font color="#808080">)))
   }
} </font><font color="#0000FF">else if </font><font color="#808080">(</font>sreg==opAutor<font color="#808080">) {
   </font><font color="#0000FF">if </font><font color="#808080">(</font>sacao==opPesquisar<font color="#808080">)
      </font>slinha = validaEntrada<font color="#808080">(</font>tfAutor,sreg, 2, tAutor.autor, 1, <font color="#0000FF">TRUE</font>,opTexto<font color="#808080">)
   </font><font color="#0000FF">else if </font><font color="#808080">(</font>sacao==opListarTodos<font color="#808080">) {
      </font><font color="#0000FF">if </font><font color="#808080">(</font>ListarTodos<font color="#808080">(</font>tfAutor, sreg, <font color="#800000">&quot;&quot;</font>, 0, 0, tamReg<font color="#808080">(</font>sreg<font color="#808080">)</font>,
        QTD_MAX_LINHA, <font color="#0000FF">FALSE</font><font color="#808080">) </font>== <font color="#0000FF">FALSE</font><font color="#808080">)
        </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#0000FF">sprintf</font><font color="#808080">(</font><font color="#800000">&quot;%s\n&quot;</font>,rotulo<font color="#808080">(</font>sreg, 0<font color="#808080">)))
   }
} </font><font color="#0000FF">else if </font><font color="#808080">(</font>sreg==opEditora<font color="#808080">) {
   </font><font color="#0000FF">if </font><font color="#808080">(</font>sacao==opPesquisar<font color="#808080">)
      </font>slinha = validaEntrada<font color="#808080">(</font>tfEditora,sreg,2,tEditora.editora,1,TRUE,opTexto<font color="#808080">)
   </font><font color="#0000FF">else if </font><font color="#808080">(</font>sacao==opListarTodos<font color="#808080">) {
      </font><font color="#0000FF">if </font><font color="#808080">(</font>ListarTodos<font color="#808080">(</font>tfEditora, sreg, <font color="#800000">&quot;&quot;</font>, 0, 0, tamReg<font color="#808080">(</font>sreg<font color="#808080">)</font>,
        QTD_MAX_LINHA, <font color="#0000FF">FALSE</font><font color="#808080">) </font>== <font color="#0000FF">FALSE</font><font color="#808080">)
        </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#0000FF">sprintf</font><font color="#808080">(</font><font color="#800000">&quot;%s\n&quot;</font>,rotulo<font color="#808080">(</font>sreg, 0<font color="#808080">)))
   }
} </font><font color="#0000FF">else if </font><font color="#808080">(</font>sreg==opEndereco<font color="#808080">) {
   </font><font color="#0000FF">if </font><font color="#808080">(</font>sacao==opPesquisar<font color="#808080">)
      </font>slinha = validaEntrada<font color="#808080">(</font>tfEndereco,sreg,2,tEndereco.logradouro,1,
              <font color="#0000FF">TRUE</font>,opTexto<font color="#808080">)
   </font><font color="#0000FF">else if </font><font color="#808080">(</font>sacao==opListarTodos<font color="#808080">) {
      </font><font color="#0000FF">if </font><font color="#808080">(</font>ListarTodos<font color="#808080">(</font>tfEndereco, sreg, <font color="#800000">&quot;&quot;</font>, 0, 0, tamReg<font color="#808080">(</font>sreg<font color="#808080">)</font>,
         3, <font color="#0000FF">FALSE</font><font color="#808080">) </font>== <font color="#0000FF">FALSE</font><font color="#808080">)
        </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#0000FF">sprintf</font><font color="#808080">(</font><font color="#800000">&quot;%s\n&quot;</font>,rotulo<font color="#808080">(</font>sreg, 0<font color="#808080">)))
   }
} </font><font color="#0000FF">else if </font><font color="#808080">(</font>sreg==opIdioma<font color="#808080">) {
   </font><font color="#0000FF">if </font><font color="#808080">(</font>sacao==opPesquisar<font color="#808080">)
      </font>slinha = validaEntrada<font color="#808080">(</font>tfIdioma, sreg, 2, tIdioma.idioma,1,TRUE,opTexto<font color="#808080">)
   </font><font color="#0000FF">else if </font><font color="#808080">(</font>sacao==opListarTodos<font color="#808080">) {
      </font><font color="#0000FF">if </font><font color="#808080">(</font>ListarTodos<font color="#808080">(</font>tfIdioma, sreg, <font color="#800000">&quot;&quot;</font>, 0, 0, tamReg<font color="#808080">(</font>sreg<font color="#808080">)</font>,
        QTD_MAX_LINHA, <font color="#0000FF">FALSE</font><font color="#808080">) </font>== <font color="#0000FF">FALSE</font><font color="#808080">)
        </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#0000FF">sprintf</font><font color="#808080">(</font><font color="#800000">&quot;%s\n&quot;</font>,rotulo<font color="#808080">(</font>sreg, 0<font color="#808080">)))
   }
} </font><font color="#0000FF">else if </font><font color="#808080">(</font>sreg==opPais<font color="#808080">) {
   </font><font color="#0000FF">if </font><font color="#808080">(</font>sacao==opPesquisar<font color="#808080">)
      </font>slinha = validaEntrada<font color="#808080">(</font>tfPais, sreg, 2, tPais.pais, 1, <font color="#0000FF">TRUE</font>,opTexto<font color="#808080">)
   </font><font color="#0000FF">else if </font><font color="#808080">(</font>sacao==opListarTodos<font color="#808080">) {
      </font><font color="#0000FF">if </font><font color="#808080">(</font>ListarTodos<font color="#808080">(</font>tfPais, sreg, <font color="#800000">&quot;&quot;</font>, 0, 0, tamReg<font color="#808080">(</font>sreg<font color="#808080">)</font>,
        QTD_MAX_LINHA, <font color="#0000FF">FALSE</font><font color="#808080">) </font>== <font color="#0000FF">FALSE</font><font color="#808080">)
        </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#0000FF">sprintf</font><font color="#808080">(</font><font color="#800000">&quot;%s\n&quot;</font>,rotulo<font color="#808080">(</font>sreg, 0<font color="#808080">)))
   }
} </font><font color="#0000FF">else if </font><font color="#808080">(</font>sreg==opProfissao<font color="#808080">) {
   </font><font color="#0000FF">if </font><font color="#808080">(</font>sacao==opPesquisar<font color="#808080">)
     </font>slinha = validaEntrada<font color="#808080">(</font>tfProfissao,sreg,2,tProfissao.profissao,1,
             <font color="#0000FF">TRUE</font>,opTexto<font color="#808080">)
   </font><font color="#0000FF">else if </font><font color="#808080">(</font>sacao==opListarTodos<font color="#808080">) {
      </font><font color="#0000FF">if </font><font color="#808080">(</font>ListarTodos<font color="#808080">(</font>tfProfissao, sreg, <font color="#800000">&quot;&quot;</font>, 0, 0, tamReg<font color="#808080">(</font>sreg<font color="#808080">)</font>,
        QTD_MAX_LINHA, <font color="#0000FF">FALSE</font><font color="#808080">) </font>== <font color="#0000FF">FALSE</font><font color="#808080">)
        </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#0000FF">sprintf</font><font color="#808080">(</font><font color="#800000">&quot;%s\n&quot;</font>,rotulo<font color="#808080">(</font>sreg, 0<font color="#808080">)))
   }
} </font><font color="#0000FF">else if </font><font color="#808080">(</font>sreg==opLivro<font color="#808080">) {
   </font><font color="#0000FF">if </font><font color="#808080">(</font>sacao==opPesquisar<font color="#808080">)
      </font>slinha = validaEntrada<font color="#808080">(</font>tfLivro, sreg, 2, tLivro.titulo, 1, <font color="#0000FF">TRUE</font>,opTexto<font color="#808080">)
   </font><font color="#0000FF">else if </font><font color="#808080">(</font>sacao==opListarTodos<font color="#808080">) {
      </font><font color="#0000FF">if </font><font color="#808080">(</font>ListarTodos<font color="#808080">(</font>tfLivro, sreg, <font color="#800000">&quot;&quot;</font>, 0, 0, tamReg<font color="#808080">(</font>sreg<font color="#808080">)</font>,
        1, <font color="#0000FF">FALSE</font><font color="#808080">) </font>== <font color="#0000FF">FALSE</font><font color="#808080">)
        </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#0000FF">sprintf</font><font color="#808080">(</font><font color="#800000">&quot;%s\n&quot;</font>,rotulo<font color="#808080">(</font>sreg, 0<font color="#808080">)))
   }
} </font><font color="#0000FF">else if </font><font color="#808080">(</font>sreg==opCliente<font color="#808080">) {
   </font><font color="#0000FF">if </font><font color="#808080">(</font>sacao==opPesquisar<font color="#808080">)
      </font>slinha = validaEntrada<font color="#808080">(</font>tfCliente, sreg, 2, tCliente.nome,1,TRUE,opTexto<font color="#808080">)
   </font><font color="#0000FF">else if </font><font color="#808080">(</font>sacao==opListarTodos<font color="#808080">) {
      </font><font color="#0000FF">if </font><font color="#808080">(</font>ListarTodos<font color="#808080">(</font>tfCliente, sreg, <font color="#800000">&quot;&quot;</font>, 0, 0, tamReg<font color="#808080">(</font>sreg<font color="#808080">)</font>,
        1, <font color="#0000FF">FALSE</font><font color="#808080">) </font>== <font color="#0000FF">FALSE</font><font color="#808080">)
        </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#0000FF">sprintf</font><font color="#808080">(</font><font color="#800000">&quot;%s\n&quot;</font>,rotulo<font color="#808080">(</font>sreg, 0<font color="#808080">)))
   }
} </font><font color="#0000FF">else if </font><font color="#808080">(</font>sreg==opVenda<font color="#808080">) {
   </font><font color="#0000FF">if </font><font color="#808080">(</font>sacao==opPesquisar<font color="#808080">)
      </font>slinha = validaEntrada<font color="#808080">(</font>tfVenda, sreg, 2, tVenda.cpf, 1, <font color="#0000FF">TRUE</font>,opTexto<font color="#808080">)
   </font><font color="#0000FF">else if </font><font color="#808080">(</font>sacao==opListarTodos<font color="#808080">) {
      </font><font color="#0000FF">if </font><font color="#808080">(</font>ListarTodos<font color="#808080">(</font>tfVenda, sreg, <font color="#800000">&quot;&quot;</font>, 0, 0, tamReg<font color="#808080">(</font>sreg<font color="#808080">)</font>,
        QTD_MAX_LINHA, <font color="#0000FF">FALSE</font><font color="#808080">) </font>== <font color="#0000FF">FALSE</font><font color="#808080">)
        </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#0000FF">sprintf</font><font color="#808080">(</font><font color="#800000">&quot;%s\n&quot;</font>,rotulo<font color="#808080">(</font>sreg, 0<font color="#808080">)))
   }
}
}
</font><font color="#008000">#------------------------------------------------------------------------------
# Mostra a tela de altera&ccedil;&atilde;o de senha do sistema e realiza a altera&ccedil;&atilde;o.
#------------------------------------------------------------------------------
</font>frmAlterarSenha <font color="#808080">&lt;</font><font color="#808000">- </font><font color="#0000FF">function</font><font color="#808080">() {

</font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#0000FF">sprintf</font><font color="#808080">(</font><font color="#800000">&quot;%s%s\n&quot;</font>,rotulo<font color="#808080">(</font>opUsuario, 1<font color="#808080">)</font>, gg<font color="#808080">(</font><font color="#800000">&quot;tUsuario$login&quot;</font><font color="#808080">)))
</font>nopcao = 1
bQuebra = <font color="#0000FF">FALSE
while </font><font color="#808080">(</font>bQuebra==FALSE<font color="#808080">) {
   </font><font color="#0000FF">if </font><font color="#808080">(</font>nopcao==1<font color="#808080">) {
       </font>sSenhaAtual = digitaSenha<font color="#808080">(</font><font color="#800000">&quot;Senha Atual: &quot;</font>, 10<font color="#808080">)
       </font><font color="#0000FF">if </font><font color="#808080">(</font>sSenhaAtual <font color="#808000">!= </font>gg<font color="#808080">(</font><font color="#800000">&quot;tUsuario$senha&quot;</font><font color="#808080">)) {
          </font><font color="#0000FF">cat</font><font color="#808080">(</font>MSG_SENCONFERE<font color="#808080">)
          </font>bQuebra = <font color="#0000FF">TRUE
       </font><font color="#808080">} </font><font color="#0000FF">else </font>nopcao = 2
   <font color="#808080">} 
   </font><font color="#0000FF">else if </font><font color="#808080">(</font>nopcao==2<font color="#808080">) {
       </font>sNovaSenha = digitaSenha<font color="#808080">(</font><font color="#800000">&quot;Nova Senha: &quot;</font>, 10<font color="#808080">)
       </font>sConfirmaSenha = digitaSenha<font color="#808080">(</font><font color="#800000">&quot;Confirma Senha: &quot;</font>, 10<font color="#808080">)
       </font><font color="#0000FF">if </font><font color="#808080">(</font>sNovaSenha <font color="#808000">!= </font>sConfirmaSenha<font color="#808080">) {
          </font><font color="#0000FF">cat</font><font color="#808080">(</font>MSG_SENCONFIRM<font color="#808080">)
          </font>bQuebra = <font color="#0000FF">TRUE
       </font><font color="#808080">} </font><font color="#0000FF">else </font>nopcao = 3
   <font color="#808080">} 
   </font><font color="#0000FF">else if </font><font color="#808080">(</font>nopcao==3<font color="#808080">) {
       </font>sres = pesqArq<font color="#808080">(</font>tfUsuario, gg<font color="#808080">(</font><font color="#800000">&quot;tUsuario$login&quot;</font><font color="#808080">)</font>, 1, 10, tamReg<font color="#808080">(</font>opUsuario<font color="#808080">))
       </font><font color="#0000FF">if </font><font color="#808080">(</font>sres == <font color="#800000">&quot;&quot;</font><font color="#808080">)
         </font><font color="#0000FF">cat</font><font color="#808080">(</font>MSG_LOGINENCON<font color="#808080">)
       </font><font color="#0000FF">else </font><font color="#808080">{
         </font>ag<font color="#808080">(</font><font color="#800000">&quot;tUsuario$senha&quot;</font>, sConfirmaSenha<font color="#808080">)
         </font>subMenu<font color="#808080">(</font>9,opUsuario<font color="#808080">)
         </font>bQuebra = <font color="#0000FF">TRUE
       </font><font color="#808080">}
   } 
}
}
</font><font color="#008000">#------------------------------------------------------------------------------
# Executa uma a&ccedil;&atilde;o de grava&ccedil;&atilde;o de acordo com o tipo de arquivo.
# sreg - o tipo de arquivo
# sacao - a a&ccedil;&atilde;o a ser realizada
#------------------------------------------------------------------------------
</font>btnAcao <font color="#808080">&lt;</font><font color="#808000">- </font><font color="#0000FF">function</font><font color="#808080">(</font>sreg, sacao<font color="#808080">)
{
</font><font color="#0000FF">if </font><font color="#808080">(</font>sreg==opAssunto<font color="#808080">) {
   </font><font color="#0000FF">if </font><font color="#808080">(</font>sacao==opSalvarInclusao<font color="#808080">)
      </font>escreveArq<font color="#808080">(</font>tfAssunto, LinhaReg<font color="#808080">(</font>sreg<font color="#808080">)</font>, MSG_REGINC, MSG_REGNINC<font color="#808080">)
   </font><font color="#0000FF">else if </font><font color="#808080">(</font>sacao==opSalvarAlteracao<font color="#808080">)
      </font>escreveArq<font color="#808080">(</font>tfAssunto, LinhaReg<font color="#808080">(</font>sreg<font color="#808080">)</font>, MSG_REGALT, MSG_REGNALT<font color="#808080">)
   </font><font color="#0000FF">else if </font><font color="#808080">(</font>sacao==opConfirmaExclusao<font color="#808080">)
      </font>escreveArq<font color="#808080">(</font>tfAssunto, repete<font color="#808080">(</font><font color="#800000">&quot;*&quot;</font>,tamReg<font color="#808080">(</font>sreg<font color="#808080">))</font>, MSG_REGEXC, MSG_REGNEXC<font color="#808080">)
} </font><font color="#0000FF">else if </font><font color="#808080">(</font>sreg==opAutor<font color="#808080">) {
   </font><font color="#0000FF">if </font><font color="#808080">(</font>sacao==opSalvarInclusao<font color="#808080">)
      </font>escreveArq<font color="#808080">(</font>tfAutor, LinhaReg<font color="#808080">(</font>sreg<font color="#808080">)</font>, MSG_REGINC, MSG_REGNINC<font color="#808080">)
   </font><font color="#0000FF">else if </font><font color="#808080">(</font>sacao==opSalvarAlteracao<font color="#808080">)
      </font>escreveArq<font color="#808080">(</font>tfAutor, LinhaReg<font color="#808080">(</font>sreg<font color="#808080">)</font>, MSG_REGALT, MSG_REGNALT<font color="#808080">)
   </font><font color="#0000FF">else if </font><font color="#808080">(</font>sacao==opConfirmaExclusao<font color="#808080">)
      </font>escreveArq<font color="#808080">(</font>tfAutor, repete<font color="#808080">(</font><font color="#800000">&quot;*&quot;</font>,tamReg<font color="#808080">(</font>sreg<font color="#808080">))</font>, MSG_REGEXC, MSG_REGNEXC<font color="#808080">)
} </font><font color="#0000FF">else if </font><font color="#808080">(</font>sreg==opEditora<font color="#808080">) {
   </font><font color="#0000FF">if </font><font color="#808080">(</font>sacao==opSalvarInclusao<font color="#808080">)
      </font>escreveArq<font color="#808080">(</font>tfEditora, LinhaReg<font color="#808080">(</font>sreg<font color="#808080">)</font>, MSG_REGINC, MSG_REGNINC<font color="#808080">)
   </font><font color="#0000FF">else if </font><font color="#808080">(</font>sacao==opSalvarAlteracao<font color="#808080">)
      </font>escreveArq<font color="#808080">(</font>tfEditora, LinhaReg<font color="#808080">(</font>sreg<font color="#808080">)</font>, MSG_REGALT, MSG_REGNALT<font color="#808080">)
   </font><font color="#0000FF">else if </font><font color="#808080">(</font>sacao==opConfirmaExclusao<font color="#808080">)
      </font>escreveArq<font color="#808080">(</font>tfEditora, repete<font color="#808080">(</font><font color="#800000">&quot;*&quot;</font>,tamReg<font color="#808080">(</font>sreg<font color="#808080">))</font>, MSG_REGEXC, MSG_REGNEXC<font color="#808080">)
} </font><font color="#0000FF">else if </font><font color="#808080">(</font>sreg==opEndereco<font color="#808080">) {
   </font><font color="#0000FF">if </font><font color="#808080">(</font>sacao==opSalvarInclusao<font color="#808080">)
      </font>escreveArq<font color="#808080">(</font>tfEndereco, LinhaReg<font color="#808080">(</font>sreg<font color="#808080">)</font>, MSG_REGINC, MSG_REGNINC<font color="#808080">)
   </font><font color="#0000FF">else if </font><font color="#808080">(</font>sacao==opSalvarAlteracao<font color="#808080">)
      </font>escreveArq<font color="#808080">(</font>tfEndereco, LinhaReg<font color="#808080">(</font>sreg<font color="#808080">)</font>, MSG_REGALT, MSG_REGNALT<font color="#808080">)
   </font><font color="#0000FF">else if </font><font color="#808080">(</font>sacao==opConfirmaExclusao<font color="#808080">)
      </font>escreveArq<font color="#808080">(</font>tfEndereco, repete<font color="#808080">(</font><font color="#800000">&quot;*&quot;</font>,tamReg<font color="#808080">(</font>sreg<font color="#808080">))</font>, MSG_REGEXC, MSG_REGNEXC<font color="#808080">)
} </font><font color="#0000FF">else if </font><font color="#808080">(</font>sreg==opIdioma<font color="#808080">) {
   </font><font color="#0000FF">if </font><font color="#808080">(</font>sacao==opSalvarInclusao<font color="#808080">)
      </font>escreveArq<font color="#808080">(</font>tfIdioma, LinhaReg<font color="#808080">(</font>sreg<font color="#808080">)</font>, MSG_REGINC, MSG_REGNINC<font color="#808080">)
   </font><font color="#0000FF">else if </font><font color="#808080">(</font>sacao==opSalvarAlteracao<font color="#808080">)
      </font>escreveArq<font color="#808080">(</font>tfIdioma, LinhaReg<font color="#808080">(</font>sreg<font color="#808080">)</font>, MSG_REGALT, MSG_REGNALT<font color="#808080">)
   </font><font color="#0000FF">else if </font><font color="#808080">(</font>sacao==opConfirmaExclusao<font color="#808080">)
      </font>escreveArq<font color="#808080">(</font>tfIdioma, repete<font color="#808080">(</font><font color="#800000">&quot;*&quot;</font>,tamReg<font color="#808080">(</font>sreg<font color="#808080">))</font>, MSG_REGEXC, MSG_REGNEXC<font color="#808080">)
} </font><font color="#0000FF">else if </font><font color="#808080">(</font>sreg==opPais<font color="#808080">) {
   </font><font color="#0000FF">if </font><font color="#808080">(</font>sacao==opSalvarInclusao<font color="#808080">)
      </font>escreveArq<font color="#808080">(</font>tfPais, LinhaReg<font color="#808080">(</font>sreg<font color="#808080">)</font>, MSG_REGINC, MSG_REGNINC<font color="#808080">)
   </font><font color="#0000FF">else if </font><font color="#808080">(</font>sacao==opSalvarAlteracao<font color="#808080">)
      </font>escreveArq<font color="#808080">(</font>tfPais, LinhaReg<font color="#808080">(</font>sreg<font color="#808080">)</font>, MSG_REGALT, MSG_REGNALT<font color="#808080">)
   </font><font color="#0000FF">else if </font><font color="#808080">(</font>sacao==opConfirmaExclusao<font color="#808080">)
      </font>escreveArq<font color="#808080">(</font>tfPais, repete<font color="#808080">(</font><font color="#800000">&quot;*&quot;</font>,tamReg<font color="#808080">(</font>sreg<font color="#808080">))</font>, MSG_REGEXC, MSG_REGNEXC<font color="#808080">)
} </font><font color="#0000FF">else if </font><font color="#808080">(</font>sreg==opProfissao<font color="#808080">) {
   </font><font color="#0000FF">if </font><font color="#808080">(</font>sacao==opSalvarInclusao<font color="#808080">)
      </font>escreveArq<font color="#808080">(</font>tfProfissao, LinhaReg<font color="#808080">(</font>sreg<font color="#808080">)</font>, MSG_REGINC, MSG_REGNINC<font color="#808080">)
   </font><font color="#0000FF">else if </font><font color="#808080">(</font>sacao==opSalvarAlteracao<font color="#808080">)
      </font>escreveArq<font color="#808080">(</font>tfProfissao, LinhaReg<font color="#808080">(</font>sreg<font color="#808080">)</font>, MSG_REGALT, MSG_REGNALT<font color="#808080">)
   </font><font color="#0000FF">else if </font><font color="#808080">(</font>sacao==opConfirmaExclusao<font color="#808080">)
     </font>escreveArq<font color="#808080">(</font>tfProfissao, repete<font color="#808080">(</font><font color="#800000">&quot;*&quot;</font>,tamReg<font color="#808080">(</font>sreg<font color="#808080">))</font>, MSG_REGEXC, MSG_REGNEXC<font color="#808080">)
} </font><font color="#0000FF">else if </font><font color="#808080">(</font>sreg==opLivro<font color="#808080">) {
   </font><font color="#0000FF">if </font><font color="#808080">(</font>sacao==opSalvarInclusao<font color="#808080">)
      </font>escreveArq<font color="#808080">(</font>tfLivro, LinhaReg<font color="#808080">(</font>sreg<font color="#808080">)</font>, MSG_REGINC, MSG_REGNINC<font color="#808080">)
   </font><font color="#0000FF">else if </font><font color="#808080">(</font>sacao==opSalvarAlteracao<font color="#808080">)
      </font>escreveArq<font color="#808080">(</font>tfLivro, LinhaReg<font color="#808080">(</font>sreg<font color="#808080">)</font>, MSG_REGALT, MSG_REGNALT<font color="#808080">)
   </font><font color="#0000FF">else if </font><font color="#808080">(</font>sacao==opConfirmaExclusao<font color="#808080">)
      </font>escreveArq<font color="#808080">(</font>tfLivro, repete<font color="#808080">(</font><font color="#800000">&quot;*&quot;</font>,tamReg<font color="#808080">(</font>sreg<font color="#808080">))</font>, MSG_REGEXC, MSG_REGNEXC<font color="#808080">)
} </font><font color="#0000FF">else if </font><font color="#808080">(</font>sreg==opLivroAss<font color="#808080">) {
   </font><font color="#0000FF">if </font><font color="#808080">(</font>sacao==opSalvarInclusao<font color="#808080">)
      </font>escreveArq<font color="#808080">(</font>tfLivroAss, LinhaReg<font color="#808080">(</font>sreg<font color="#808080">)</font>, MSG_REGINC, MSG_REGNINC<font color="#808080">)
   </font><font color="#0000FF">else if </font><font color="#808080">(</font>sacao==opSalvarAlteracao<font color="#808080">)
      </font>escreveArq<font color="#808080">(</font>tfLivroAss, LinhaReg<font color="#808080">(</font>sreg<font color="#808080">)</font>, MSG_REGALT, MSG_REGNALT<font color="#808080">)
   </font><font color="#0000FF">else if </font><font color="#808080">(</font>sacao==opConfirmaExclusao<font color="#808080">)
      </font>escreveArq<font color="#808080">(</font>tfLivroAss, repete<font color="#808080">(</font><font color="#800000">&quot;*&quot;</font>,tamReg<font color="#808080">(</font>sreg<font color="#808080">))</font>, MSG_REGEXC, MSG_REGNEXC<font color="#808080">)
} </font><font color="#0000FF">else if </font><font color="#808080">(</font>sreg==opLivroAut<font color="#808080">) {
   </font><font color="#0000FF">if </font><font color="#808080">(</font>sacao==opSalvarInclusao<font color="#808080">)
      </font>escreveArq<font color="#808080">(</font>tfLivroAut, LinhaReg<font color="#808080">(</font>sreg<font color="#808080">)</font>, MSG_REGINC, MSG_REGNINC<font color="#808080">)
   </font><font color="#0000FF">else if </font><font color="#808080">(</font>sacao==opSalvarAlteracao<font color="#808080">)
      </font>escreveArq<font color="#808080">(</font>tfLivroAut, LinhaReg<font color="#808080">(</font>sreg<font color="#808080">)</font>, MSG_REGALT, MSG_REGNALT<font color="#808080">)
   </font><font color="#0000FF">else if </font><font color="#808080">(</font>sacao==opConfirmaExclusao<font color="#808080">)
      </font>escreveArq<font color="#808080">(</font>tfLivroAut, repete<font color="#808080">(</font><font color="#800000">&quot;*&quot;</font>,tamReg<font color="#808080">(</font>sreg<font color="#808080">))</font>, MSG_REGEXC, MSG_REGNEXC<font color="#808080">)
} </font><font color="#0000FF">else if </font><font color="#808080">(</font>sreg==opCliente<font color="#808080">) {
   </font><font color="#0000FF">if </font><font color="#808080">(</font>sacao==opSalvarInclusao<font color="#808080">)
      </font>escreveArq<font color="#808080">(</font>tfCliente, LinhaReg<font color="#808080">(</font>sreg<font color="#808080">)</font>, MSG_REGINC, MSG_REGNINC<font color="#808080">)
   </font><font color="#0000FF">else if </font><font color="#808080">(</font>sacao==opSalvarAlteracao<font color="#808080">)
      </font>escreveArq<font color="#808080">(</font>tfCliente, LinhaReg<font color="#808080">(</font>sreg<font color="#808080">)</font>, MSG_REGALT, MSG_REGNALT<font color="#808080">)
   </font><font color="#0000FF">else if </font><font color="#808080">(</font>sacao==opConfirmaExclusao<font color="#808080">)
      </font>escreveArq<font color="#808080">(</font>tfCliente, repete<font color="#808080">(</font><font color="#800000">&quot;*&quot;</font>,tamReg<font color="#808080">(</font>sreg<font color="#808080">))</font>, MSG_REGEXC, MSG_REGNEXC<font color="#808080">)
} </font><font color="#0000FF">else if </font><font color="#808080">(</font>sreg==opVenda<font color="#808080">) {
   </font><font color="#0000FF">if </font><font color="#808080">(</font>sacao==opSalvarInclusao<font color="#808080">)
      </font>escreveArq<font color="#808080">(</font>tfVenda, LinhaReg<font color="#808080">(</font>sreg<font color="#808080">)</font>, MSG_REGINC, MSG_REGNINC<font color="#808080">)
   </font><font color="#0000FF">else if </font><font color="#808080">(</font>sacao==opSalvarAlteracao<font color="#808080">)
      </font>escreveArq<font color="#808080">(</font>tfVenda, LinhaReg<font color="#808080">(</font>sreg<font color="#808080">)</font>, MSG_REGALT, MSG_REGNALT<font color="#808080">)
   </font><font color="#0000FF">else if </font><font color="#808080">(</font>sacao==opConfirmaExclusao<font color="#808080">)
      </font>escreveArq<font color="#808080">(</font>tfVenda, repete<font color="#808080">(</font><font color="#800000">&quot;*&quot;</font>,tamReg<font color="#808080">(</font>sreg<font color="#808080">))</font>, MSG_REGEXC, MSG_REGNEXC<font color="#808080">)
} </font><font color="#0000FF">else if </font><font color="#808080">(</font>sreg==opUsuario<font color="#808080">) {
   </font><font color="#0000FF">if </font><font color="#808080">(</font>sacao==opSalvarAlteracao<font color="#808080">)
      </font>escreveArq<font color="#808080">(</font>tfUsuario, LinhaReg<font color="#808080">(</font>sreg<font color="#808080">)</font>, MSG_REGALT, MSG_REGNALT<font color="#808080">)
}
}
</font><font color="#008000">#------------------------------------------------------------------------------
# Seleciona o menu e/ou a tela certa de acordo com o tipo de arquivo.
# nmenu - o n&uacute;mero do menu
# sreg - o tipo de arquivo
#------------------------------------------------------------------------------
</font>subMenu <font color="#808080">&lt;</font><font color="#808000">- </font><font color="#0000FF">function</font><font color="#808080">(</font>nmenu, sreg<font color="#808080">) {

</font>bSOp = <font color="#0000FF">TRUE

 if </font><font color="#808080">(</font>nmenu == 6<font color="#808080">) {
   </font><font color="#0000FF">while</font><font color="#808080">(</font>bSOp<font color="#808080">) {
     </font><font color="#0000FF">menu</font><font color="#808080">(</font>nmenu<font color="#808080">)
     </font>opSubMenu = <font color="#0000FF">readline</font><font color="#808080">()
     </font><font color="#0000FF">if </font><font color="#808080">(</font>opSubMenu==<font color="#800000">&quot;1&quot;</font><font color="#808080">) </font>frmCadastros<font color="#808080">(</font>sreg, opNovo<font color="#808080">) 
     </font><font color="#0000FF">else if </font><font color="#808080">(</font>opSubMenu==<font color="#800000">&quot;2&quot;</font><font color="#808080">) </font>frmCadastros<font color="#808080">(</font>sreg, opPesquisar<font color="#808080">) 
     </font><font color="#0000FF">else if </font><font color="#808080">(</font>opSubMenu==<font color="#800000">&quot;3&quot;</font><font color="#808080">) </font>bSOp = <font color="#0000FF">FALSE 
</font>	   <font color="#0000FF">else cat</font><font color="#808080">(</font>MSG_ERRO<font color="#808080">)
   }
 } 
 </font><font color="#0000FF">else if </font><font color="#808080">(</font>nmenu == 7<font color="#808080">) {
   </font><font color="#0000FF">while</font><font color="#808080">(</font>bSOp<font color="#808080">) {
     </font><font color="#0000FF">menu</font><font color="#808080">(</font>nmenu<font color="#808080">)
     </font>opSubMenu = <font color="#0000FF">readline</font><font color="#808080">()
     </font><font color="#0000FF">if </font><font color="#808080">(</font>opSubMenu==<font color="#800000">&quot;1&quot;</font><font color="#808080">) { 
       </font>btnAcao<font color="#808080">(</font>sreg, opSalvarInclusao<font color="#808080">) 
       </font>bSOp = <font color="#0000FF">FALSE 
     </font><font color="#808080">} 
     </font><font color="#0000FF">else if </font><font color="#808080">(</font>opSubMenu==<font color="#800000">&quot;2&quot;</font><font color="#808080">) </font>bSOp = <font color="#0000FF">FALSE 
</font>	   <font color="#0000FF">else cat</font><font color="#808080">(</font>MSG_ERRO<font color="#808080">)
   }
 } 
 </font><font color="#0000FF">else if </font><font color="#808080">(</font>nmenu == 8<font color="#808080">) {
   </font><font color="#0000FF">while</font><font color="#808080">(</font>bSOp<font color="#808080">) {
     </font><font color="#0000FF">menu</font><font color="#808080">(</font>nmenu<font color="#808080">)
     </font>opSubMenu = <font color="#0000FF">readline</font><font color="#808080">()     
     </font><font color="#0000FF">if </font><font color="#808080">(</font>opSubMenu==<font color="#800000">&quot;1&quot;</font><font color="#808080">) { 
       </font>frmCadastros<font color="#808080">(</font>sreg, opAlterar<font color="#808080">) 
       </font>bSOp = <font color="#0000FF">FALSE 
     </font><font color="#808080">} 
     </font><font color="#0000FF">else if </font><font color="#808080">(</font>opSubMenu==<font color="#800000">&quot;2&quot;</font><font color="#808080">) { 
       </font>frmCadastros<font color="#808080">(</font>sreg, opExcluir<font color="#808080">) 
       </font>bSOp = <font color="#0000FF">FALSE 
     </font><font color="#808080">} 
     </font><font color="#0000FF">else if </font><font color="#808080">(</font>opSubMenu==<font color="#800000">&quot;3&quot;</font><font color="#808080">) </font>bSOp = <font color="#0000FF">FALSE 
     else cat</font><font color="#808080">(</font>MSG_ERRO<font color="#808080">)
   }
 } 
 </font><font color="#0000FF">else if </font><font color="#808080">(</font>nmenu == 9<font color="#808080">) {
   </font><font color="#0000FF">while</font><font color="#808080">(</font>bSOp<font color="#808080">) {
     </font><font color="#0000FF">menu</font><font color="#808080">(</font>nmenu<font color="#808080">)
     </font>opSubMenu = <font color="#0000FF">readline</font><font color="#808080">()     
     </font><font color="#0000FF">if </font><font color="#808080">(</font>opSubMenu==<font color="#800000">&quot;1&quot;</font><font color="#808080">) { 
       </font>btnAcao<font color="#808080">(</font>sreg, opSalvarAlteracao<font color="#808080">) 
       </font>bSOp = <font color="#0000FF">FALSE 
     </font><font color="#808080">} 
     </font><font color="#0000FF">else if </font><font color="#808080">(</font>opSubMenu==<font color="#800000">&quot;2&quot;</font><font color="#808080">) </font>bSOp = <font color="#0000FF">FALSE 
     else cat</font><font color="#808080">(</font>MSG_ERRO<font color="#808080">)
   }
 } 
 </font><font color="#0000FF">else if </font><font color="#808080">(</font>nmenu == 10<font color="#808080">) {
   </font><font color="#0000FF">while</font><font color="#808080">(</font>bSOp<font color="#808080">) {
     </font><font color="#0000FF">menu</font><font color="#808080">(</font>nmenu<font color="#808080">)
     </font>opCSubMenu = <font color="#0000FF">readline</font><font color="#808080">()     
     </font><font color="#0000FF">if </font><font color="#808080">((</font>opCSubMenu==<font color="#800000">&quot;S&quot;</font><font color="#808080">) </font>|| <font color="#808080">(</font>opCSubMenu==<font color="#800000">&quot;s&quot;</font><font color="#808080">)) {
        </font>btnAcao<font color="#808080">(</font>sreg, opConfirmaExclusao<font color="#808080">)
        </font>bSOp = <font color="#0000FF">FALSE
     </font><font color="#808080">} </font><font color="#0000FF">else if </font><font color="#808080">((</font>opCSubMenu==<font color="#800000">&quot;N&quot;</font><font color="#808080">) </font>|| <font color="#808080">(</font>opCSubMenu==<font color="#800000">&quot;n&quot;</font><font color="#808080">)) </font>bSOp = <font color="#0000FF">FALSE
     else cat</font><font color="#808080">(</font>MSG_ERRO<font color="#808080">)
   }
 } 
 </font><font color="#0000FF">else if </font><font color="#808080">(</font>nmenu == 12<font color="#808080">) {
   </font><font color="#0000FF">while</font><font color="#808080">(</font>bSOp<font color="#808080">) {
     </font><font color="#0000FF">menu</font><font color="#808080">(</font>nmenu<font color="#808080">)
     </font>opSubMenu = <font color="#0000FF">readline</font><font color="#808080">()     
     </font><font color="#0000FF">if </font><font color="#808080">(</font>opSubMenu==<font color="#800000">&quot;1&quot;</font><font color="#808080">) </font>frmConsultas<font color="#808080">(</font>sreg, opPesquisar<font color="#808080">) 
     </font><font color="#0000FF">else if </font><font color="#808080">(</font>opSubMenu==<font color="#800000">&quot;2&quot;</font><font color="#808080">) </font>frmConsultas<font color="#808080">(</font>sreg, opListarTodos<font color="#808080">) 
     </font><font color="#0000FF">else if </font><font color="#808080">(</font>opSubMenu==<font color="#800000">&quot;3&quot;</font><font color="#808080">) </font>bSOp = <font color="#0000FF">FALSE 
     else cat</font><font color="#808080">(</font>MSG_ERRO<font color="#808080">)
   }
 } 
 </font><font color="#0000FF">else if </font><font color="#808080">(</font>nmenu == 14<font color="#808080">) {
   </font><font color="#0000FF">while</font><font color="#808080">(</font>bSOp<font color="#808080">) {
     </font><font color="#0000FF">menu</font><font color="#808080">(</font>nmenu<font color="#808080">)
     </font>opCSubMenu = <font color="#0000FF">readline</font><font color="#808080">()     
     </font><font color="#0000FF">if </font><font color="#808080">((</font>opCSubMenu==<font color="#800000">&quot;S&quot;</font><font color="#808080">) </font>|| <font color="#808080">(</font>opCSubMenu==<font color="#800000">&quot;s&quot;</font><font color="#808080">)) {
        </font>btnAcao<font color="#808080">(</font>sreg, opSalvarInclusao<font color="#808080">)
        </font>bSOp = <font color="#0000FF">FALSE
        </font>ag<font color="#808080">(</font><font color="#800000">&quot;g_SalvarInclusao&quot;</font>, <font color="#0000FF">TRUE</font><font color="#808080">)
     } </font><font color="#0000FF">else if </font><font color="#808080">((</font>opCSubMenu==<font color="#800000">&quot;N&quot;</font><font color="#808080">) </font>|| <font color="#808080">(</font>opCSubMenu==<font color="#800000">&quot;n&quot;</font><font color="#808080">)) </font>bSOp = <font color="#0000FF">FALSE
     else cat</font><font color="#808080">(</font>MSG_ERRO<font color="#808080">)
   }
 } 
}
</font><font color="#008000">#------------------------------------------------------------------------------
# Seleciona o submenu e/ou a tela certa de acordo com n&uacute;mero do menu.
# nmenu - o n&uacute;mero do menu
#------------------------------------------------------------------------------
</font>usaMenu <font color="#808080">&lt;</font><font color="#808000">- </font><font color="#0000FF">function</font><font color="#808080">(</font>num<font color="#808080">) {
 </font>bSOp = <font color="#0000FF">TRUE
 if </font><font color="#808080">(</font>num == 1<font color="#808080">) { </font><font color="#008000"># Cadastros
   </font><font color="#0000FF">while</font><font color="#808080">(</font>bSOp<font color="#808080">) {
     </font><font color="#0000FF">menu</font><font color="#808080">(</font>2<font color="#808080">)
     </font>opSubMenu = <font color="#0000FF">readline</font><font color="#808080">()
     </font><font color="#0000FF">if </font><font color="#808080">(</font>opSubMenu==<font color="#800000">&quot;1&quot;</font><font color="#808080">) </font>subMenu<font color="#808080">(</font>6, opAssunto<font color="#808080">) 
     </font><font color="#0000FF">else if </font><font color="#808080">(</font>opSubMenu==<font color="#800000">&quot;2&quot;</font><font color="#808080">) </font>subMenu<font color="#808080">(</font>6, opAutor<font color="#808080">) 
     </font><font color="#0000FF">else if </font><font color="#808080">(</font>opSubMenu==<font color="#800000">&quot;3&quot;</font><font color="#808080">) </font>subMenu<font color="#808080">(</font>6, opEditora<font color="#808080">) 
     </font><font color="#0000FF">else if </font><font color="#808080">(</font>opSubMenu==<font color="#800000">&quot;4&quot;</font><font color="#808080">) </font>subMenu<font color="#808080">(</font>6, opEndereco<font color="#808080">) 
     </font><font color="#0000FF">else if </font><font color="#808080">(</font>opSubMenu==<font color="#800000">&quot;5&quot;</font><font color="#808080">) </font>subMenu<font color="#808080">(</font>6, opIdioma<font color="#808080">) 
     </font><font color="#0000FF">else if </font><font color="#808080">(</font>opSubMenu==<font color="#800000">&quot;6&quot;</font><font color="#808080">) </font>subMenu<font color="#808080">(</font>6, opPais<font color="#808080">) 
     </font><font color="#0000FF">else if </font><font color="#808080">(</font>opSubMenu==<font color="#800000">&quot;7&quot;</font><font color="#808080">) </font>subMenu<font color="#808080">(</font>6, opProfissao<font color="#808080">) 
     </font><font color="#0000FF">else if </font><font color="#808080">(</font>opSubMenu==<font color="#800000">&quot;8&quot;</font><font color="#808080">) </font>subMenu<font color="#808080">(</font>6, opCliente<font color="#808080">) 
     </font><font color="#0000FF">else if </font><font color="#808080">(</font>opSubMenu==<font color="#800000">&quot;9&quot;</font><font color="#808080">) </font>subMenu<font color="#808080">(</font>6, opLivro<font color="#808080">) 
     </font><font color="#0000FF">else if </font><font color="#808080">(</font>opSubMenu==<font color="#800000">&quot;10&quot;</font><font color="#808080">) </font>bSOp = <font color="#0000FF">FALSE 
     else cat</font><font color="#808080">(</font>MSG_ERRO<font color="#808080">)
   }
 } </font><font color="#0000FF">else if </font><font color="#808080">(</font>num == 2<font color="#808080">) { </font><font color="#008000"># Pesquisas 
   </font><font color="#0000FF">while</font><font color="#808080">(</font>bSOp<font color="#808080">) {
     </font><font color="#0000FF">menu</font><font color="#808080">(</font>3<font color="#808080">)
     </font>opSubMenu = <font color="#0000FF">readline</font><font color="#808080">()
     </font><font color="#0000FF">if </font><font color="#808080">(</font>opSubMenu==<font color="#800000">&quot;1&quot;</font><font color="#808080">) </font>subMenu<font color="#808080">(</font>12, opAssunto<font color="#808080">) 
     </font><font color="#0000FF">else if </font><font color="#808080">(</font>opSubMenu==<font color="#800000">&quot;2&quot;</font><font color="#808080">) </font>subMenu<font color="#808080">(</font>12, opAutor<font color="#808080">) 
     </font><font color="#0000FF">else if </font><font color="#808080">(</font>opSubMenu==<font color="#800000">&quot;3&quot;</font><font color="#808080">) </font>subMenu<font color="#808080">(</font>12, opEditora<font color="#808080">) 
     </font><font color="#0000FF">else if </font><font color="#808080">(</font>opSubMenu==<font color="#800000">&quot;4&quot;</font><font color="#808080">) </font>subMenu<font color="#808080">(</font>12, opEndereco<font color="#808080">) 
     </font><font color="#0000FF">else if </font><font color="#808080">(</font>opSubMenu==<font color="#800000">&quot;5&quot;</font><font color="#808080">) </font>subMenu<font color="#808080">(</font>12, opIdioma<font color="#808080">) 
     </font><font color="#0000FF">else if </font><font color="#808080">(</font>opSubMenu==<font color="#800000">&quot;6&quot;</font><font color="#808080">) </font>subMenu<font color="#808080">(</font>12, opPais<font color="#808080">) 
     </font><font color="#0000FF">else if </font><font color="#808080">(</font>opSubMenu==<font color="#800000">&quot;7&quot;</font><font color="#808080">) </font>subMenu<font color="#808080">(</font>12, opProfissao<font color="#808080">) 
     </font><font color="#0000FF">else if </font><font color="#808080">(</font>opSubMenu==<font color="#800000">&quot;8&quot;</font><font color="#808080">) </font>subMenu<font color="#808080">(</font>12, opCliente<font color="#808080">) 
     </font><font color="#0000FF">else if </font><font color="#808080">(</font>opSubMenu==<font color="#800000">&quot;9&quot;</font><font color="#808080">) </font>subMenu<font color="#808080">(</font>12, opLivro<font color="#808080">) 
     </font><font color="#0000FF">else if </font><font color="#808080">(</font>opSubMenu==<font color="#800000">&quot;10&quot;</font><font color="#808080">) </font>bSOp = <font color="#0000FF">FALSE 
     else cat</font><font color="#808080">(</font>MSG_ERRO<font color="#808080">)
   }
 } </font><font color="#0000FF">else if </font><font color="#808080">(</font>num == 3<font color="#808080">) { </font><font color="#008000"># Vendas
   </font><font color="#0000FF">while</font><font color="#808080">(</font>bSOp<font color="#808080">) {
     </font><font color="#0000FF">menu</font><font color="#808080">(</font>4<font color="#808080">)
     </font>opSubMenu = <font color="#0000FF">readline</font><font color="#808080">()
     </font><font color="#0000FF">if </font><font color="#808080">(</font>opSubMenu==<font color="#800000">&quot;1&quot;</font><font color="#808080">) </font>subMenu<font color="#808080">(</font>6, opVenda<font color="#808080">) 
     </font><font color="#0000FF">else if </font><font color="#808080">(</font>opSubMenu==<font color="#800000">&quot;2&quot;</font><font color="#808080">) </font>subMenu<font color="#808080">(</font>12, opVenda<font color="#808080">) 
     </font><font color="#0000FF">else if </font><font color="#808080">(</font>opSubMenu==<font color="#800000">&quot;3&quot;</font><font color="#808080">) </font>bSOp = <font color="#0000FF">FALSE 
     else cat</font><font color="#808080">(</font>MSG_ERRO<font color="#808080">)
   }
 } </font><font color="#0000FF">else if </font><font color="#808080">(</font>num == 4<font color="#808080">) { </font><font color="#008000"># Opcoes
   </font><font color="#0000FF">while</font><font color="#808080">(</font>bSOp<font color="#808080">) {
     </font><font color="#0000FF">menu</font><font color="#808080">(</font>5<font color="#808080">)
     </font>opSubMenu = <font color="#0000FF">readline</font><font color="#808080">()
     </font><font color="#0000FF">if </font><font color="#808080">(</font>opSubMenu==<font color="#800000">&quot;1&quot;</font><font color="#808080">) </font>frmAlterarSenha<font color="#808080">() 
     </font><font color="#0000FF">else if </font><font color="#808080">(</font>opSubMenu==<font color="#800000">&quot;2&quot;</font><font color="#808080">) </font>frmSobre<font color="#808080">() 
     </font><font color="#0000FF">else if </font><font color="#808080">(</font>opSubMenu==<font color="#800000">&quot;3&quot;</font><font color="#808080">) {
       </font><font color="#0000FF">menu</font><font color="#808080">(</font>11<font color="#808080">)
       </font>opSair = <font color="#0000FF">readline</font><font color="#808080">()
       </font><font color="#0000FF">if </font><font color="#808080">((</font>opSair==<font color="#800000">&quot;S&quot;</font><font color="#808080">) </font>|| <font color="#808080">(</font>opSair==<font color="#800000">&quot;s&quot;</font><font color="#808080">)) {
          </font>fechaArqs<font color="#808080">()
          </font><font color="#0000FF">quit</font><font color="#808080">()
       }
     } 
     </font><font color="#0000FF">else if </font><font color="#808080">(</font>opSubMenu==<font color="#800000">&quot;4&quot;</font><font color="#808080">) </font>bSOp = <font color="#0000FF">FALSE 
     else cat</font><font color="#808080">(</font>MSG_ERRO<font color="#808080">)
   }
 }
}
</font><font color="#008000">#------------------------------------------------------------------------------
# Mostra as entradas e as sa&iacute;das do sistema.
# sreg - o tipo de arquivo
# slinha - o registro com os dados
# nOpcao - indica qual op&ccedil;&atilde;o ser&aacute; mostrada
#------------------------------------------------------------------------------
</font>mostrarDados <font color="#808080">&lt;</font><font color="#808000">- </font><font color="#0000FF">function</font><font color="#808080">(</font>sreg, slinha, nOpcao<font color="#808080">)
{ 
</font><font color="#0000FF">if </font><font color="#808080">(</font>sreg==opAssunto<font color="#808080">) {
   </font><font color="#0000FF">if </font><font color="#808080">(</font>nOpcao==1<font color="#808080">) {
      </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#0000FF">sprintf</font><font color="#808080">(</font><font color="#800000">&quot;%s%s\n&quot;</font>,rotulo<font color="#808080">(</font>sreg, 1<font color="#808080">)</font>, gg<font color="#808080">(</font><font color="#800000">&quot;tAssunto$codigo&quot;</font><font color="#808080">)))
      </font>ag<font color="#808080">(</font><font color="#800000">&quot;tAssunto$assunto&quot;</font>, <font color="#0000FF">readline</font><font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg, 2<font color="#808080">)))
   } 
   </font><font color="#0000FF">else if </font><font color="#808080">(</font>nOpcao==2<font color="#808080">) {
      </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#800000">&quot;C&oacute;digo     Assunto\n&quot;</font><font color="#808080">)
      </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#800000">&quot;------     -------\n&quot;</font><font color="#808080">)
   } 
   </font><font color="#0000FF">else if </font><font color="#808080">(</font>nOpcao==3<font color="#808080">) {
      </font>ag<font color="#808080">(</font><font color="#800000">&quot;tAssunto$codigo&quot;</font>, trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha, 1, 10<font color="#808080">)))
      </font>ag<font color="#808080">(</font><font color="#800000">&quot;tAssunto$assunto&quot;</font>, trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha, 11, 30<font color="#808080">)))
      </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#0000FF">sprintf</font><font color="#808080">(</font><font color="#800000">&quot;%s %s\n&quot;</font>,esp<font color="#808080">(</font>gg<font color="#808080">(</font><font color="#800000">&quot;tAssunto$codigo&quot;</font><font color="#808080">)</font>,10<font color="#808080">)</font>,esp<font color="#808080">(</font>gg<font color="#808080">(</font><font color="#800000">&quot;tAssunto$assunto&quot;</font><font color="#808080">)</font>,30<font color="#808080">)))
   } 
} </font><font color="#0000FF">else if </font><font color="#808080">(</font>sreg==opAutor<font color="#808080">) {
   </font><font color="#0000FF">if </font><font color="#808080">(</font>nOpcao==1<font color="#808080">) {
      </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#0000FF">sprintf</font><font color="#808080">(</font><font color="#800000">&quot;%s%s\n&quot;</font>,rotulo<font color="#808080">(</font>sreg, 1<font color="#808080">)</font>, gg<font color="#808080">(</font><font color="#800000">&quot;tAutor$codigo&quot;</font><font color="#808080">)))
      </font>ag<font color="#808080">(</font><font color="#800000">&quot;tAutor$autor&quot;</font>, <font color="#0000FF">readline</font><font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg, 2<font color="#808080">)))
   } 
   </font><font color="#0000FF">else if </font><font color="#808080">(</font>nOpcao==2<font color="#808080">) {
      </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#800000">&quot;C&oacute;digo     Autor\n&quot;</font><font color="#808080">)
      </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#800000">&quot;------     -----\n&quot;</font><font color="#808080">)
   } 
   </font><font color="#0000FF">else if </font><font color="#808080">(</font>nOpcao==3<font color="#808080">) {
      </font>ag<font color="#808080">(</font><font color="#800000">&quot;tAutor$codigo&quot;</font>, trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha, 1, 10<font color="#808080">)))
      </font>ag<font color="#808080">(</font><font color="#800000">&quot;tAutor$autor&quot;</font>, trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha, 11, 30<font color="#808080">)))
      </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#0000FF">sprintf</font><font color="#808080">(</font><font color="#800000">&quot;%s %s\n&quot;</font>,esp<font color="#808080">(</font>gg<font color="#808080">(</font><font color="#800000">&quot;tAutor$codigo&quot;</font><font color="#808080">)</font>,10<font color="#808080">)</font>,esp<font color="#808080">(</font>gg<font color="#808080">(</font><font color="#800000">&quot;tAutor$autor&quot;</font><font color="#808080">)</font>,30<font color="#808080">)))
   } 
} </font><font color="#0000FF">else if </font><font color="#808080">(</font>sreg==opEditora<font color="#808080">) {
   </font><font color="#0000FF">if </font><font color="#808080">(</font>nOpcao==1<font color="#808080">) {
      </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#0000FF">sprintf</font><font color="#808080">(</font><font color="#800000">&quot;%s%s\n&quot;</font>,rotulo<font color="#808080">(</font>sreg, 1<font color="#808080">)</font>, gg<font color="#808080">(</font><font color="#800000">&quot;tEditora$codigo&quot;</font><font color="#808080">)))
      </font>ag<font color="#808080">(</font><font color="#800000">&quot;tEditora$editora&quot;</font>, <font color="#0000FF">readline</font><font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg, 2<font color="#808080">)))
   } 
   </font><font color="#0000FF">else if </font><font color="#808080">(</font>nOpcao==2<font color="#808080">) {
      </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#800000">&quot;C&oacute;digo     Editora\n&quot;</font><font color="#808080">)
      </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#800000">&quot;------     -------\n&quot;</font><font color="#808080">)
   } 
   </font><font color="#0000FF">else if </font><font color="#808080">(</font>nOpcao==3<font color="#808080">) {
      </font>ag<font color="#808080">(</font><font color="#800000">&quot;tEditora$codigo&quot;</font>, trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha, 1, 10<font color="#808080">)))
      </font>ag<font color="#808080">(</font><font color="#800000">&quot;tEditora$editora&quot;</font>, trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha, 11, 50<font color="#808080">)))
      </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#0000FF">sprintf</font><font color="#808080">(</font><font color="#800000">&quot;%s %s\n&quot;</font>,esp<font color="#808080">(</font>gg<font color="#808080">(</font><font color="#800000">&quot;tEditora$codigo&quot;</font><font color="#808080">)</font>,10<font color="#808080">)</font>,esp<font color="#808080">(</font>gg<font color="#808080">(</font><font color="#800000">&quot;tEditora$editora&quot;</font><font color="#808080">)</font>,50<font color="#808080">)))
   }
} </font><font color="#0000FF">else if </font><font color="#808080">(</font>sreg==opEndereco<font color="#808080">) {
   </font><font color="#0000FF">if </font><font color="#808080">(</font>nOpcao==1<font color="#808080">) {
      </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#0000FF">sprintf</font><font color="#808080">(</font><font color="#800000">&quot;%s%s&quot;</font>,rotulo<font color="#808080">(</font>sreg, 1<font color="#808080">)</font>, gg<font color="#808080">(</font><font color="#800000">&quot;tEndereco$codigo&quot;</font><font color="#808080">)))
      </font>ag<font color="#808080">(</font><font color="#800000">&quot;tEndereco$logradouro&quot;</font>, <font color="#0000FF">readline</font><font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg, 2<font color="#808080">)))
      </font>ag<font color="#808080">(</font><font color="#800000">&quot;tEndereco$bairro&quot;</font>, <font color="#0000FF">readline</font><font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg, 3<font color="#808080">)))
      </font>ag<font color="#808080">(</font><font color="#800000">&quot;tEndereco$cep&quot;</font>, <font color="#0000FF">readline</font><font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg, 4<font color="#808080">)))
      </font>ag<font color="#808080">(</font><font color="#800000">&quot;tEndereco$cidade&quot;</font>, <font color="#0000FF">readline</font><font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg, 5<font color="#808080">)))
      </font>ag<font color="#808080">(</font><font color="#800000">&quot;tEndereco$estado&quot;</font>, <font color="#0000FF">readline</font><font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg, 6<font color="#808080">)))
   } 
   </font><font color="#0000FF">else if </font><font color="#808080">(</font>nOpcao==3<font color="#808080">) {
      </font>ag<font color="#808080">(</font><font color="#800000">&quot;tEndereco$codigo&quot;</font>, trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha, 1, 10<font color="#808080">)))
      </font>ag<font color="#808080">(</font><font color="#800000">&quot;tEndereco$logradouro&quot;</font>, trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha, 11, 40<font color="#808080">)))
      </font>ag<font color="#808080">(</font><font color="#800000">&quot;tEndereco$bairro&quot;</font>, trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha, 51, 15<font color="#808080">)))
      </font>ag<font color="#808080">(</font><font color="#800000">&quot;tEndereco$cep&quot;</font>, trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha, 66, 8<font color="#808080">)))
      </font>ag<font color="#808080">(</font><font color="#800000">&quot;tEndereco$cidade&quot;</font>, trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha, 74, 30<font color="#808080">)))
      </font>ag<font color="#808080">(</font><font color="#800000">&quot;tEndereco$estado&quot;</font>, trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha, 104, 20<font color="#808080">)))
      </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#800000">&quot;--------------------\n&quot;</font><font color="#808080">)
      </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#0000FF">sprintf</font><font color="#808080">(</font><font color="#800000">&quot;%s%s\n&quot;</font>,rotulo<font color="#808080">(</font>sreg, 1<font color="#808080">)</font>, gg<font color="#808080">(</font><font color="#800000">&quot;tEndereco$codigo&quot;</font><font color="#808080">)))
      </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#0000FF">sprintf</font><font color="#808080">(</font><font color="#800000">&quot;%s%s\n&quot;</font>,rotulo<font color="#808080">(</font>sreg, 2<font color="#808080">)</font>, gg<font color="#808080">(</font><font color="#800000">&quot;tEndereco$logradouro&quot;</font><font color="#808080">)))
      </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#0000FF">sprintf</font><font color="#808080">(</font><font color="#800000">&quot;%s%s\n&quot;</font>,rotulo<font color="#808080">(</font>sreg, 3<font color="#808080">)</font>, gg<font color="#808080">(</font><font color="#800000">&quot;tEndereco$bairro&quot;</font><font color="#808080">)))
      </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#0000FF">sprintf</font><font color="#808080">(</font><font color="#800000">&quot;%s%s\n&quot;</font>,rotulo<font color="#808080">(</font>sreg, 4<font color="#808080">)</font>, gg<font color="#808080">(</font><font color="#800000">&quot;tEndereco$cep&quot;</font><font color="#808080">)))
      </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#0000FF">sprintf</font><font color="#808080">(</font><font color="#800000">&quot;%s%s\n&quot;</font>,rotulo<font color="#808080">(</font>sreg, 5<font color="#808080">)</font>, gg<font color="#808080">(</font><font color="#800000">&quot;tEndereco$cidade&quot;</font><font color="#808080">)))
      </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#0000FF">sprintf</font><font color="#808080">(</font><font color="#800000">&quot;%s%s\n&quot;</font>,rotulo<font color="#808080">(</font>sreg, 6<font color="#808080">)</font>, gg<font color="#808080">(</font><font color="#800000">&quot;tEndereco$estado&quot;</font><font color="#808080">)))
   }
} </font><font color="#0000FF">else if </font><font color="#808080">(</font>sreg==opIdioma<font color="#808080">) {
   </font><font color="#0000FF">if </font><font color="#808080">(</font>nOpcao==1<font color="#808080">) {
      </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#0000FF">sprintf</font><font color="#808080">(</font><font color="#800000">&quot;%s%s\n&quot;</font>,rotulo<font color="#808080">(</font>sreg, 1<font color="#808080">)</font>, gg<font color="#808080">(</font><font color="#800000">&quot;tIdioma$codigo&quot;</font><font color="#808080">)))
      </font>ag<font color="#808080">(</font><font color="#800000">&quot;tIdioma$idioma&quot;</font>, <font color="#0000FF">readline</font><font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg, 2<font color="#808080">)))
   }  
   </font><font color="#0000FF">else if </font><font color="#808080">(</font>nOpcao==2<font color="#808080">) {
      </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#800000">&quot;C&oacute;digo     Idioma\n&quot;</font><font color="#808080">)
      </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#800000">&quot;------     ------\n&quot;</font><font color="#808080">)
   } 
   </font><font color="#0000FF">else if </font><font color="#808080">(</font>nOpcao==3<font color="#808080">) {
      </font>ag<font color="#808080">(</font><font color="#800000">&quot;tIdioma$codigo&quot;</font>, trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha, 1, 10<font color="#808080">)))
      </font>ag<font color="#808080">(</font><font color="#800000">&quot;tIdioma$idioma&quot;</font>, trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha, 11, 20<font color="#808080">)))
      </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#0000FF">sprintf</font><font color="#808080">(</font><font color="#800000">&quot;%s %s\n&quot;</font>,esp<font color="#808080">(</font>gg<font color="#808080">(</font><font color="#800000">&quot;tIdioma$codigo&quot;</font><font color="#808080">)</font>,10<font color="#808080">)</font>,esp<font color="#808080">(</font>gg<font color="#808080">(</font><font color="#800000">&quot;tIdioma$idioma&quot;</font><font color="#808080">)</font>,20<font color="#808080">)))
   }
} </font><font color="#0000FF">else if </font><font color="#808080">(</font>sreg==opPais<font color="#808080">) {
   </font><font color="#0000FF">if </font><font color="#808080">(</font>nOpcao==1<font color="#808080">) {
      </font>ag<font color="#808080">(</font><font color="#800000">&quot;tPais$pais&quot;</font>, <font color="#0000FF">readline</font><font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg, 2<font color="#808080">)))
   } 
   </font><font color="#0000FF">else if </font><font color="#808080">(</font>nOpcao==2<font color="#808080">) {
      </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#800000">&quot;C&oacute;digo Pa&iacute;s\n&quot;</font><font color="#808080">)
      </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#800000">&quot;------ ----\n&quot;</font><font color="#808080">)
   } 
   </font><font color="#0000FF">else if </font><font color="#808080">(</font>nOpcao==3<font color="#808080">) {
      </font>ag<font color="#808080">(</font><font color="#800000">&quot;tPais$codigo&quot;</font>, trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha, 1, 3<font color="#808080">)))
      </font>ag<font color="#808080">(</font><font color="#800000">&quot;tPais$pais&quot;</font>, trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha, 4, 50<font color="#808080">)))
      </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#0000FF">sprintf</font><font color="#808080">(</font><font color="#800000">&quot;%s    %s\n&quot;</font>,esp<font color="#808080">(</font>gg<font color="#808080">(</font><font color="#800000">&quot;tPais$codigo&quot;</font><font color="#808080">)</font>,3<font color="#808080">)</font>,esp<font color="#808080">(</font>gg<font color="#808080">(</font><font color="#800000">&quot;tPais$pais&quot;</font><font color="#808080">)</font>,50<font color="#808080">)))
   }
} </font><font color="#0000FF">else if </font><font color="#808080">(</font>sreg==opProfissao<font color="#808080">) {
   </font><font color="#0000FF">if </font><font color="#808080">(</font>nOpcao==1<font color="#808080">) {
      </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#0000FF">sprintf</font><font color="#808080">(</font><font color="#800000">&quot;%s%s\n&quot;</font>,rotulo<font color="#808080">(</font>sreg, 1<font color="#808080">)</font>, gg<font color="#808080">(</font><font color="#800000">&quot;tProfissao$codigo&quot;</font><font color="#808080">)))
      </font>ag<font color="#808080">(</font><font color="#800000">&quot;tProfissao$profissao&quot;</font>, <font color="#0000FF">readline</font><font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg, 2<font color="#808080">)))
   } 
   </font><font color="#0000FF">else if </font><font color="#808080">(</font>nOpcao==2<font color="#808080">) {
      </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#800000">&quot;C&oacute;digo     Profiss&atilde;o\n&quot;</font><font color="#808080">)
      </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#800000">&quot;------     ---------\n&quot;</font><font color="#808080">)
   } 
   </font><font color="#0000FF">else if </font><font color="#808080">(</font>nOpcao==3<font color="#808080">) {
      </font>ag<font color="#808080">(</font><font color="#800000">&quot;tProfissao$codigo&quot;</font>, trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha, 1, 10<font color="#808080">)))
      </font>ag<font color="#808080">(</font><font color="#800000">&quot;tProfissao$profissao&quot;</font>, trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha, 11, 50<font color="#808080">)))
      </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#0000FF">sprintf</font><font color="#808080">(</font><font color="#800000">&quot;%s %s\n&quot;</font>,esp<font color="#808080">(</font>gg<font color="#808080">(</font><font color="#800000">&quot;tProfissao$codigo&quot;</font><font color="#808080">)</font>,10<font color="#808080">)</font>,
              esp<font color="#808080">(</font>gg<font color="#808080">(</font><font color="#800000">&quot;tProfissao$profissao&quot;</font><font color="#808080">)</font>,50<font color="#808080">)))
   }
} </font><font color="#0000FF">else if </font><font color="#808080">(</font>sreg==opLivro<font color="#808080">) {
   </font><font color="#0000FF">if </font><font color="#808080">(</font>nOpcao==1<font color="#808080">) {
      </font>ag<font color="#808080">(</font><font color="#800000">&quot;tLivro$titulo&quot;</font>, <font color="#0000FF">readline</font><font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg, 2<font color="#808080">)))
      </font>ag<font color="#808080">(</font><font color="#800000">&quot;tLivro$edicao&quot;</font>, validaNumero<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg, 3<font color="#808080">)</font>, tLivro<font color="#808080">$</font>edicao<font color="#808080">))
      </font>ag<font color="#808080">(</font><font color="#800000">&quot;tLivro$anopubli&quot;</font>, validaNumero<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg, 4<font color="#808080">)</font>, tLivro<font color="#808080">$</font>anopubli<font color="#808080">))
      </font>mostrarSubDados<font color="#808080">(</font>opLivro, opEditora, <font color="#0000FF">FALSE</font><font color="#808080">)
      </font>ag<font color="#808080">(</font><font color="#800000">&quot;tLivro$volume&quot;</font>, validaNumero<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg, 6<font color="#808080">)</font>, tLivro<font color="#808080">$</font>volume<font color="#808080">))
      </font>mostrarSubDados<font color="#808080">(</font>opLivro, opIdioma, <font color="#0000FF">FALSE</font><font color="#808080">)
      </font>ag<font color="#808080">(</font><font color="#800000">&quot;tLivro$npaginas&quot;</font>, validaNumero<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg, 8<font color="#808080">)</font>, tLivro<font color="#808080">$</font>npaginas<font color="#808080">))
      </font>ag<font color="#808080">(</font><font color="#800000">&quot;tLivro$preco&quot;</font>, validaNumero<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg, 9<font color="#808080">)</font>, tLivro<font color="#808080">$</font>preco<font color="#808080">))
      </font>ag<font color="#808080">(</font><font color="#800000">&quot;tLivro$qtdestoque&quot;</font>, validaNumero<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg, 10<font color="#808080">)</font>, tLivro<font color="#808080">$</font>qtdestoque<font color="#808080">))
   } 
   </font><font color="#0000FF">else if </font><font color="#808080">(</font>nOpcao==3<font color="#808080">) {
      </font>ag<font color="#808080">(</font><font color="#800000">&quot;tLivro$isbn&quot;</font>, trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha, 1, 13<font color="#808080">)))
      </font>ag<font color="#808080">(</font><font color="#800000">&quot;tLivro$titulo&quot;</font>, trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha, 14, 50<font color="#808080">)))
      </font>ag<font color="#808080">(</font><font color="#800000">&quot;tLivro$edicao&quot;</font>, trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha, 64, 10<font color="#808080">)))
      </font>ag<font color="#808080">(</font><font color="#800000">&quot;tLivro$anopubli&quot;</font>, trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha, 74, 10<font color="#808080">)))
      </font>ag<font color="#808080">(</font><font color="#800000">&quot;tLivro$codeditora&quot;</font>, trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha, 84, 10<font color="#808080">)))
      </font>ag<font color="#808080">(</font><font color="#800000">&quot;tLivro$volume&quot;</font>, trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha, 94, 10<font color="#808080">)))
      </font>ag<font color="#808080">(</font><font color="#800000">&quot;tLivro$codidioma&quot;</font>, trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha, 104, 10<font color="#808080">)))
      </font>ag<font color="#808080">(</font><font color="#800000">&quot;tLivro$npaginas&quot;</font>, trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha, 114, 10<font color="#808080">)))
      </font>ag<font color="#808080">(</font><font color="#800000">&quot;tLivro$preco&quot;</font>, trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha, 124, 10<font color="#808080">)))
      </font>ag<font color="#808080">(</font><font color="#800000">&quot;tLivro$qtdestoque&quot;</font>, trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha, 134, 10<font color="#808080">)))
      </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#800000">&quot;--------------------\n&quot;</font><font color="#808080">)
      </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#0000FF">sprintf</font><font color="#808080">(</font><font color="#800000">&quot;%s%s\n&quot;</font>,rotulo<font color="#808080">(</font>sreg, 1<font color="#808080">)</font>, gg<font color="#808080">(</font><font color="#800000">&quot;tLivro$isbn&quot;</font><font color="#808080">)))
      </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#0000FF">sprintf</font><font color="#808080">(</font><font color="#800000">&quot;%s%s\n&quot;</font>,rotulo<font color="#808080">(</font>sreg, 2<font color="#808080">)</font>, gg<font color="#808080">(</font><font color="#800000">&quot;tLivro$titulo&quot;</font><font color="#808080">)))
      </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#0000FF">sprintf</font><font color="#808080">(</font><font color="#800000">&quot;%s%s\n&quot;</font>,rotulo<font color="#808080">(</font>sreg, 3<font color="#808080">)</font>, gg<font color="#808080">(</font><font color="#800000">&quot;tLivro$edicao&quot;</font><font color="#808080">)))
      </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#0000FF">sprintf</font><font color="#808080">(</font><font color="#800000">&quot;%s%s\n&quot;</font>,rotulo<font color="#808080">(</font>sreg, 4<font color="#808080">)</font>, gg<font color="#808080">(</font><font color="#800000">&quot;tLivro$anopubli&quot;</font><font color="#808080">)))
      </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#0000FF">sprintf</font><font color="#808080">(</font><font color="#800000">&quot;%s%s\n&quot;</font>,rotulo<font color="#808080">(</font>sreg, 5<font color="#808080">)</font>, gg<font color="#808080">(</font><font color="#800000">&quot;tLivro$codeditora&quot;</font><font color="#808080">)))
      </font>mostrarSubDados<font color="#808080">(</font>opLivro, opEditora, <font color="#0000FF">TRUE</font><font color="#808080">)
      </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#0000FF">sprintf</font><font color="#808080">(</font><font color="#800000">&quot;%s%s\n&quot;</font>,rotulo<font color="#808080">(</font>sreg, 6<font color="#808080">)</font>, gg<font color="#808080">(</font><font color="#800000">&quot;tLivro$volume&quot;</font><font color="#808080">)))
      </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#0000FF">sprintf</font><font color="#808080">(</font><font color="#800000">&quot;%s%s\n&quot;</font>,rotulo<font color="#808080">(</font>sreg, 7<font color="#808080">)</font>, gg<font color="#808080">(</font><font color="#800000">&quot;tLivro$codidioma&quot;</font><font color="#808080">)))
      </font>mostrarSubDados<font color="#808080">(</font>opLivro, opIdioma, <font color="#0000FF">TRUE</font><font color="#808080">)
      </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#0000FF">sprintf</font><font color="#808080">(</font><font color="#800000">&quot;%s%s\n&quot;</font>,rotulo<font color="#808080">(</font>sreg, 8<font color="#808080">)</font>, gg<font color="#808080">(</font><font color="#800000">&quot;tLivro$npaginas&quot;</font><font color="#808080">)))
      </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#0000FF">sprintf</font><font color="#808080">(</font><font color="#800000">&quot;%s%s\n&quot;</font>,rotulo<font color="#808080">(</font>sreg, 9<font color="#808080">)</font>, gg<font color="#808080">(</font><font color="#800000">&quot;tLivro$preco&quot;</font><font color="#808080">)))
      </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#0000FF">sprintf</font><font color="#808080">(</font><font color="#800000">&quot;%s%s\n&quot;</font>,rotulo<font color="#808080">(</font>sreg, 10<font color="#808080">)</font>, gg<font color="#808080">(</font><font color="#800000">&quot;tLivro$qtdestoque&quot;</font><font color="#808080">)))
      </font>ListarRegLigados<font color="#808080">(</font>tfLivroAss, opLivroAss, 1, 13, 14, 10, gg<font color="#808080">(</font><font color="#800000">&quot;tLivro$isbn&quot;</font><font color="#808080">)</font>,
                       tfAssunto, opAssunto, 1, 4<font color="#808080">)
      </font>ListarRegLigados<font color="#808080">(</font>tfLivroAut, opLivroAut, 1, 13, 14, 10, gg<font color="#808080">(</font><font color="#800000">&quot;tLivro$isbn&quot;</font><font color="#808080">)</font>,
                       tfAutor, opAutor, 1, 4<font color="#808080">)
  }
} </font><font color="#0000FF">else if </font><font color="#808080">(</font>sreg==opCliente<font color="#808080">) {
   </font><font color="#0000FF">if </font><font color="#808080">(</font>nOpcao==1<font color="#808080">) {
      </font>ag<font color="#808080">(</font><font color="#800000">&quot;tCliente$nome&quot;</font>, <font color="#0000FF">readline</font><font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg, 2<font color="#808080">)))
      </font>ag<font color="#808080">(</font><font color="#800000">&quot;tCliente$email&quot;</font>, <font color="#0000FF">readline</font><font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg, 3<font color="#808080">)))
      </font>ag<font color="#808080">(</font><font color="#800000">&quot;tCliente$identidade&quot;</font>, <font color="#0000FF">readline</font><font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg, 4<font color="#808080">)))
      </font>ag<font color="#808080">(</font><font color="#800000">&quot;tCliente$sexo&quot;</font>, <font color="#0000FF">readline</font><font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg, 5<font color="#808080">)))
      </font>ag<font color="#808080">(</font><font color="#800000">&quot;tCliente$telefone&quot;</font>, <font color="#0000FF">readline</font><font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg, 6<font color="#808080">)))
      </font>ag<font color="#808080">(</font><font color="#800000">&quot;tCliente$dtnascimento&quot;</font>, 
          validaDataHora<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg, 7<font color="#808080">)</font>, tCliente<font color="#808080">$</font>dtnascimento, <font color="#0000FF">TRUE</font><font color="#808080">))
      </font>mostrarSubDados<font color="#808080">(</font>opCliente, opEndereco, <font color="#0000FF">FALSE</font><font color="#808080">)
      </font>mostrarSubDados<font color="#808080">(</font>opCliente, opPais, <font color="#0000FF">FALSE</font><font color="#808080">)
      </font>mostrarSubDados<font color="#808080">(</font>opCliente, opProfissao, <font color="#0000FF">FALSE</font><font color="#808080">)
   } 
   </font><font color="#0000FF">else if </font><font color="#808080">(</font>nOpcao==3<font color="#808080">) {
      </font>ag<font color="#808080">(</font><font color="#800000">&quot;tCliente$cpf&quot;</font>, trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha, 1, 14<font color="#808080">)))
      </font>ag<font color="#808080">(</font><font color="#800000">&quot;tCliente$nome&quot;</font>, trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha, 15, 30<font color="#808080">)))
      </font>ag<font color="#808080">(</font><font color="#800000">&quot;tCliente$email&quot;</font>, trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha, 45, 30<font color="#808080">)))
      </font>ag<font color="#808080">(</font><font color="#800000">&quot;tCliente$identidade&quot;</font>, trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha, 75, 10<font color="#808080">)))
      </font>ag<font color="#808080">(</font><font color="#800000">&quot;tCliente$sexo&quot;</font>, trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha, 85, 1<font color="#808080">)))
      </font>ag<font color="#808080">(</font><font color="#800000">&quot;tCliente$telefone&quot;</font>, trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha, 86, 17<font color="#808080">)))
      </font>ag<font color="#808080">(</font><font color="#800000">&quot;tCliente$dtnascimento&quot;</font>, trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha, 103, 10<font color="#808080">)))
      </font>ag<font color="#808080">(</font><font color="#800000">&quot;tCliente$codendereco&quot;</font>, trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha, 113, 10<font color="#808080">)))
      </font>ag<font color="#808080">(</font><font color="#800000">&quot;tCliente$codpais&quot;</font>, trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha, 123, 3<font color="#808080">)))
      </font>ag<font color="#808080">(</font><font color="#800000">&quot;tCliente$codprofissao&quot;</font>, trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha, 126, 10<font color="#808080">)))
      </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#800000">&quot;--------------------\n&quot;</font><font color="#808080">)
      </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#0000FF">sprintf</font><font color="#808080">(</font><font color="#800000">&quot;%s%s\n&quot;</font>,rotulo<font color="#808080">(</font>sreg, 1<font color="#808080">)</font>, gg<font color="#808080">(</font><font color="#800000">&quot;tCliente$cpf&quot;</font><font color="#808080">)))
      </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#0000FF">sprintf</font><font color="#808080">(</font><font color="#800000">&quot;%s%s\n&quot;</font>,rotulo<font color="#808080">(</font>sreg, 2<font color="#808080">)</font>, gg<font color="#808080">(</font><font color="#800000">&quot;tCliente$nome&quot;</font><font color="#808080">)))
      </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#0000FF">sprintf</font><font color="#808080">(</font><font color="#800000">&quot;%s%s\n&quot;</font>,rotulo<font color="#808080">(</font>sreg, 3<font color="#808080">)</font>, gg<font color="#808080">(</font><font color="#800000">&quot;tCliente$email&quot;</font><font color="#808080">)))
      </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#0000FF">sprintf</font><font color="#808080">(</font><font color="#800000">&quot;%s%s\n&quot;</font>,rotulo<font color="#808080">(</font>sreg, 4<font color="#808080">)</font>, gg<font color="#808080">(</font><font color="#800000">&quot;tCliente$identidade&quot;</font><font color="#808080">)))
      </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#0000FF">sprintf</font><font color="#808080">(</font><font color="#800000">&quot;%s%s\n&quot;</font>,rotulo<font color="#808080">(</font>sreg, 5<font color="#808080">)</font>, gg<font color="#808080">(</font><font color="#800000">&quot;tCliente$sexo&quot;</font><font color="#808080">)))
      </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#0000FF">sprintf</font><font color="#808080">(</font><font color="#800000">&quot;%s%s\n&quot;</font>,rotulo<font color="#808080">(</font>sreg, 6<font color="#808080">)</font>, gg<font color="#808080">(</font><font color="#800000">&quot;tCliente$telefone&quot;</font><font color="#808080">)))
      </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#0000FF">sprintf</font><font color="#808080">(</font><font color="#800000">&quot;%s%s\n&quot;</font>,rotulo<font color="#808080">(</font>sreg, 7<font color="#808080">)</font>, gg<font color="#808080">(</font><font color="#800000">&quot;tCliente$dtnascimento&quot;</font><font color="#808080">)))
      </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#0000FF">sprintf</font><font color="#808080">(</font><font color="#800000">&quot;%s%s\n&quot;</font>,rotulo<font color="#808080">(</font>sreg, 8<font color="#808080">)</font>, gg<font color="#808080">(</font><font color="#800000">&quot;tCliente$codendereco&quot;</font><font color="#808080">)))
      </font>mostrarSubDados<font color="#808080">(</font>opCliente, opEndereco, <font color="#0000FF">TRUE</font><font color="#808080">)
      </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#0000FF">sprintf</font><font color="#808080">(</font><font color="#800000">&quot;%s%s\n&quot;</font>,rotulo<font color="#808080">(</font>sreg, 9<font color="#808080">)</font>, gg<font color="#808080">(</font><font color="#800000">&quot;tCliente$codpais&quot;</font><font color="#808080">)))
      </font>mostrarSubDados<font color="#808080">(</font>opCliente, opPais, <font color="#0000FF">TRUE</font><font color="#808080">)
      </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#0000FF">sprintf</font><font color="#808080">(</font><font color="#800000">&quot;%s%s\n&quot;</font>,rotulo<font color="#808080">(</font>sreg, 10<font color="#808080">)</font>, gg<font color="#808080">(</font><font color="#800000">&quot;tCliente$codprofissao&quot;</font><font color="#808080">)))
      </font>mostrarSubDados<font color="#808080">(</font>opCliente, opProfissao, <font color="#0000FF">TRUE</font><font color="#808080">)
  }
} </font><font color="#0000FF">else if </font><font color="#808080">(</font>sreg==opVenda<font color="#808080">) {
   </font><font color="#0000FF">if </font><font color="#808080">(</font>nOpcao==1<font color="#808080">) </font>mostrarSubDados<font color="#808080">(</font>opVenda,opVenda, <font color="#0000FF">FALSE</font><font color="#808080">) 
   </font><font color="#0000FF">else if </font><font color="#808080">(</font>nOpcao==2<font color="#808080">) {
      </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#800000">&quot;DataHoraVenda       CPF            ISBN          Pre&ccedil;oVenda\n&quot;</font><font color="#808080">)
      </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#800000">&quot;-------------       ---            ----          ----------\n&quot;</font><font color="#808080">)
   } 
   </font><font color="#0000FF">else if </font><font color="#808080">(</font>nOpcao==3<font color="#808080">) {
      </font>ag<font color="#808080">(</font><font color="#800000">&quot;tVenda$dthrvenda&quot;</font>, trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha, 1, 19<font color="#808080">)))
      </font>ag<font color="#808080">(</font><font color="#800000">&quot;tVenda$cpf&quot;</font>, trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha, 20, 14<font color="#808080">)))
      </font>ag<font color="#808080">(</font><font color="#800000">&quot;tVenda$isbn&quot;</font>, trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha, 34, 13<font color="#808080">)))
      </font>ag<font color="#808080">(</font><font color="#800000">&quot;tVenda$precovenda&quot;</font>, trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha, 47, 10<font color="#808080">)))
      </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#0000FF">sprintf</font><font color="#808080">(</font><font color="#800000">&quot;%s %s %s %s\n&quot;</font>,esp<font color="#808080">(</font>gg<font color="#808080">(</font><font color="#800000">&quot;tVenda$dthrvenda&quot;</font><font color="#808080">)</font>,19<font color="#808080">)</font>,esp<font color="#808080">(</font>gg<font color="#808080">(</font><font color="#800000">&quot;tVenda$cpf&quot;</font><font color="#808080">)</font>,14<font color="#808080">)</font>,
      esp<font color="#808080">(</font>gg<font color="#808080">(</font><font color="#800000">&quot;tVenda$isbn&quot;</font><font color="#808080">)</font>,13<font color="#808080">)</font>,esp<font color="#808080">(</font>gg<font color="#808080">(</font><font color="#800000">&quot;tVenda$precovenda&quot;</font><font color="#808080">)</font>,10<font color="#808080">)))
   }
}
}
</font><font color="#008000">#------------------------------------------------------------------------------
# Mostra as sub inform&ccedil;&otilde;es de entrada e de sa&iacute;da.
# sreg - o tipo de arquivo
# ssubreg - o subtipo de arquivo
# bSoMostrar - se vai s&oacute; mostrar na sa&iacute;da
#------------------------------------------------------------------------------
</font>mostrarSubDados <font color="#808080">&lt;</font><font color="#808000">- </font><font color="#0000FF">function</font><font color="#808080">(</font>sreg, ssubreg, bSoMostrar<font color="#808080">) {

</font>nMaxTentativas = 3
<font color="#0000FF">if </font><font color="#808080">(</font>sreg==opLivro<font color="#808080">) {
  </font><font color="#0000FF">if </font><font color="#808080">(</font>ssubreg==opEditora<font color="#808080">) {
    </font><font color="#0000FF">if </font><font color="#808080">(</font>bSoMostrar<font color="#808080">)
       </font>sRegistro = pesqArq<font color="#808080">(</font>tfEditora,gg<font color="#808080">(</font><font color="#800000">&quot;tLivro$codeditora&quot;</font><font color="#808080">)</font>,1,10,tamReg<font color="#808080">(</font>opEditora<font color="#808080">))
    </font><font color="#0000FF">else
       </font>sRegistro = validaEntrada<font color="#808080">(</font>tfEditora,ssubreg,1,tLivro<font color="#808080">$</font>codeditora,
                  nMaxTentativas,FALSE,opNumero<font color="#808080">)
    </font><font color="#0000FF">if </font><font color="#808080">(</font><font color="#0000FF">nchar</font><font color="#808080">(</font>sRegistro<font color="#808080">) &gt; </font>0<font color="#808080">) {
      </font>ag<font color="#808080">(</font><font color="#800000">&quot;tLivro$codeditora&quot;</font>, trim<font color="#808080">(</font>copy<font color="#808080">(</font>sRegistro,1,10<font color="#808080">)))
      </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#0000FF">sprintf</font><font color="#808080">(</font><font color="#800000">&quot; %s&quot;</font>,rotulo<font color="#808080">(</font>opEditora, 2<font color="#808080">)))
      </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#0000FF">sprintf</font><font color="#808080">(</font><font color="#800000">&quot;%s\n&quot;</font>,copy<font color="#808080">(</font>sRegistro, gg<font color="#808080">(</font><font color="#800000">&quot;g_nPosChave&quot;</font><font color="#808080">)</font>, gg<font color="#808080">(</font><font color="#800000">&quot;g_nTamChave&quot;</font><font color="#808080">))))
    }
  } </font><font color="#0000FF">else if </font><font color="#808080">(</font>ssubreg==opIdioma<font color="#808080">) {
    </font><font color="#0000FF">if </font><font color="#808080">(</font>bSoMostrar<font color="#808080">)
       </font>sRegistro = pesqArq<font color="#808080">(</font>tfIdioma, gg<font color="#808080">(</font><font color="#800000">&quot;tLivro$codidioma&quot;</font><font color="#808080">)</font>, 1, 10,tamReg<font color="#808080">(</font>opIdioma<font color="#808080">))
    </font><font color="#0000FF">else
       </font>sRegistro = validaEntrada<font color="#808080">(</font>tfIdioma,ssubreg,1,tLivro<font color="#808080">$</font>codidioma,
                  nMaxTentativas,FALSE,opNumero<font color="#808080">)
    </font><font color="#0000FF">if </font><font color="#808080">(</font><font color="#0000FF">nchar</font><font color="#808080">(</font>sRegistro<font color="#808080">) &gt; </font>0<font color="#808080">) {
      </font>ag<font color="#808080">(</font><font color="#800000">&quot;tLivro$codidioma&quot;</font>, trim<font color="#808080">(</font>copy<font color="#808080">(</font>sRegistro,1,10<font color="#808080">)))
      </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#0000FF">sprintf</font><font color="#808080">(</font><font color="#800000">&quot; %s&quot;</font>,rotulo<font color="#808080">(</font>opIdioma, 2<font color="#808080">)))
      </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#0000FF">sprintf</font><font color="#808080">(</font><font color="#800000">&quot;%s\n&quot;</font>,copy<font color="#808080">(</font>sRegistro, gg<font color="#808080">(</font><font color="#800000">&quot;g_nPosChave&quot;</font><font color="#808080">)</font>, gg<font color="#808080">(</font><font color="#800000">&quot;g_nTamChave&quot;</font><font color="#808080">))))
    }
  }
} </font><font color="#0000FF">else if </font><font color="#808080">(</font>sreg==opCliente<font color="#808080">) {
  </font><font color="#0000FF">if </font><font color="#808080">(</font>ssubreg==opEndereco<font color="#808080">) {
    </font><font color="#0000FF">if </font><font color="#808080">(</font>bSoMostrar<font color="#808080">)
       </font>sRegistro = pesqArq<font color="#808080">(</font>tfEndereco, gg<font color="#808080">(</font><font color="#800000">&quot;tCliente$codendereco&quot;</font><font color="#808080">)</font>, 1, 10,
                  tamReg<font color="#808080">(</font>opEndereco<font color="#808080">))
    </font><font color="#0000FF">else
       </font>sRegistro = validaEntrada<font color="#808080">(</font>tfEndereco,ssubreg,1,tCliente<font color="#808080">$</font>codendereco,
                  nMaxTentativas,FALSE,opNumero<font color="#808080">)
    </font><font color="#0000FF">if </font><font color="#808080">(</font><font color="#0000FF">nchar</font><font color="#808080">(</font>sRegistro<font color="#808080">) &gt; </font>0<font color="#808080">) {
      </font>ag<font color="#808080">(</font><font color="#800000">&quot;tCliente$codendereco&quot;</font>, trim<font color="#808080">(</font>copy<font color="#808080">(</font>sRegistro,1,10<font color="#808080">)))
      </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#0000FF">sprintf</font><font color="#808080">(</font><font color="#800000">&quot; %s&quot;</font>,rotulo<font color="#808080">(</font>opEndereco, 2<font color="#808080">)))
      </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#0000FF">sprintf</font><font color="#808080">(</font><font color="#800000">&quot;%s\n&quot;</font>,copy<font color="#808080">(</font>sRegistro, gg<font color="#808080">(</font><font color="#800000">&quot;g_nPosChave&quot;</font><font color="#808080">)</font>, gg<font color="#808080">(</font><font color="#800000">&quot;g_nTamChave&quot;</font><font color="#808080">))))
      </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#0000FF">sprintf</font><font color="#808080">(</font><font color="#800000">&quot; %s&quot;</font>,rotulo<font color="#808080">(</font>opEndereco, 3<font color="#808080">)))
      </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#0000FF">sprintf</font><font color="#808080">(</font><font color="#800000">&quot;%s\n&quot;</font>,copy<font color="#808080">(</font>sRegistro, gg<font color="#808080">(</font><font color="#800000">&quot;g_nPosChave&quot;</font><font color="#808080">)</font>, gg<font color="#808080">(</font><font color="#800000">&quot;g_nTamChave&quot;</font><font color="#808080">))))
      </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#0000FF">sprintf</font><font color="#808080">(</font><font color="#800000">&quot; %s&quot;</font>,rotulo<font color="#808080">(</font>opEndereco, 4<font color="#808080">)))
      </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#0000FF">sprintf</font><font color="#808080">(</font><font color="#800000">&quot;%s\n&quot;</font>,copy<font color="#808080">(</font>sRegistro, gg<font color="#808080">(</font><font color="#800000">&quot;g_nPosChave&quot;</font><font color="#808080">)</font>, gg<font color="#808080">(</font><font color="#800000">&quot;g_nTamChave&quot;</font><font color="#808080">))))
      </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#0000FF">sprintf</font><font color="#808080">(</font><font color="#800000">&quot; %s&quot;</font>,rotulo<font color="#808080">(</font>opEndereco, 5<font color="#808080">)))
      </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#0000FF">sprintf</font><font color="#808080">(</font><font color="#800000">&quot;%s\n&quot;</font>,copy<font color="#808080">(</font>sRegistro, gg<font color="#808080">(</font><font color="#800000">&quot;g_nPosChave&quot;</font><font color="#808080">)</font>, gg<font color="#808080">(</font><font color="#800000">&quot;g_nTamChave&quot;</font><font color="#808080">))))
      </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#0000FF">sprintf</font><font color="#808080">(</font><font color="#800000">&quot; %s&quot;</font>,rotulo<font color="#808080">(</font>opEndereco, 6<font color="#808080">)))
      </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#0000FF">sprintf</font><font color="#808080">(</font><font color="#800000">&quot;%s\n&quot;</font>,copy<font color="#808080">(</font>sRegistro, gg<font color="#808080">(</font><font color="#800000">&quot;g_nPosChave&quot;</font><font color="#808080">)</font>, gg<font color="#808080">(</font><font color="#800000">&quot;g_nTamChave&quot;</font><font color="#808080">))))
    }
  } </font><font color="#0000FF">else if </font><font color="#808080">(</font>ssubreg==opPais<font color="#808080">) {
    </font><font color="#0000FF">if </font><font color="#808080">(</font>bSoMostrar<font color="#808080">)
       </font>sRegistro = pesqArq<font color="#808080">(</font>tfPais, gg<font color="#808080">(</font><font color="#800000">&quot;tCliente$codpais&quot;</font><font color="#808080">)</font>, 1, 3, tamReg<font color="#808080">(</font>opPais<font color="#808080">))
    </font><font color="#0000FF">else
       </font>sRegistro = validaEntrada<font color="#808080">(</font>tfPais,ssubreg,1,tCliente<font color="#808080">$</font>codpais,
                  nMaxTentativas,FALSE,opTexto<font color="#808080">)
    </font><font color="#0000FF">if </font><font color="#808080">(</font><font color="#0000FF">nchar</font><font color="#808080">(</font>sRegistro<font color="#808080">) &gt; </font>0<font color="#808080">) {
      </font>ag<font color="#808080">(</font><font color="#800000">&quot;tCliente$codpais&quot;</font>, trim<font color="#808080">(</font>copy<font color="#808080">(</font>sRegistro,1,3<font color="#808080">)))
      </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#0000FF">sprintf</font><font color="#808080">(</font><font color="#800000">&quot; %s&quot;</font>,rotulo<font color="#808080">(</font>opPais, 2<font color="#808080">)))
      </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#0000FF">sprintf</font><font color="#808080">(</font><font color="#800000">&quot;%s\n&quot;</font>,copy<font color="#808080">(</font>sRegistro, gg<font color="#808080">(</font><font color="#800000">&quot;g_nPosChave&quot;</font><font color="#808080">)</font>, gg<font color="#808080">(</font><font color="#800000">&quot;g_nTamChave&quot;</font><font color="#808080">))))
    }
  } </font><font color="#0000FF">else if </font><font color="#808080">(</font>ssubreg==opProfissao<font color="#808080">) {
    </font><font color="#0000FF">if </font><font color="#808080">(</font>bSoMostrar<font color="#808080">)
       </font>sRegistro = pesqArq<font color="#808080">(</font>tfProfissao, gg<font color="#808080">(</font><font color="#800000">&quot;tCliente$codprofissao&quot;</font><font color="#808080">)</font>, 1, 10,
                  tamReg<font color="#808080">(</font>opProfissao<font color="#808080">))
    </font><font color="#0000FF">else
       </font>sRegistro = validaEntrada<font color="#808080">(</font>tfProfissao,ssubreg,1,tCliente<font color="#808080">$</font>codprofissao,
                  nMaxTentativas,FALSE,opNumero<font color="#808080">)
    </font><font color="#0000FF">if </font><font color="#808080">(</font><font color="#0000FF">nchar</font><font color="#808080">(</font>sRegistro<font color="#808080">) &gt; </font>0<font color="#808080">) {
      </font>ag<font color="#808080">(</font><font color="#800000">&quot;tCliente$codprofissao&quot;</font>, trim<font color="#808080">(</font>copy<font color="#808080">(</font>sRegistro,1,10<font color="#808080">)))
      </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#0000FF">sprintf</font><font color="#808080">(</font><font color="#800000">&quot; %s&quot;</font>,rotulo<font color="#808080">(</font>opProfissao, 2<font color="#808080">)))
      </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#0000FF">sprintf</font><font color="#808080">(</font><font color="#800000">&quot;%s\n&quot;</font>,copy<font color="#808080">(</font>sRegistro, gg<font color="#808080">(</font><font color="#800000">&quot;g_nPosChave&quot;</font><font color="#808080">)</font>, gg<font color="#808080">(</font><font color="#800000">&quot;g_nTamChave&quot;</font><font color="#808080">))))
    }
  }
} </font><font color="#0000FF">else if </font><font color="#808080">(</font>sreg==opVenda<font color="#808080">) {
  </font>sRegistro = pesqArq<font color="#808080">(</font>tfLivro, gg<font color="#808080">(</font><font color="#800000">&quot;tVenda$isbn&quot;</font><font color="#808080">)</font>, 1, 13, tamReg<font color="#808080">(</font>opLivro<font color="#808080">))
  </font><font color="#0000FF">if </font><font color="#808080">(</font><font color="#0000FF">nchar</font><font color="#808080">(</font>sRegistro<font color="#808080">) &gt; </font>0<font color="#808080">) {
    </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#0000FF">sprintf</font><font color="#808080">(</font><font color="#800000">&quot; %s&quot;</font>,rotulo<font color="#808080">(</font>opLivro, 2<font color="#808080">))) </font><font color="#008000"># Titulo 
    </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#0000FF">sprintf</font><font color="#808080">(</font><font color="#800000">&quot;%s\n&quot;</font>,copy<font color="#808080">(</font>sRegistro, gg<font color="#808080">(</font><font color="#800000">&quot;g_nPosChave&quot;</font><font color="#808080">)</font>, gg<font color="#808080">(</font><font color="#800000">&quot;g_nTamChave&quot;</font><font color="#808080">))))
    </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#0000FF">sprintf</font><font color="#808080">(</font><font color="#800000">&quot; %s&quot;</font>,rotulo<font color="#808080">(</font>opLivro, 9<font color="#808080">))) </font><font color="#008000"># Preco 
    </font>sPreco = copy<font color="#808080">(</font>sRegistro, gg<font color="#808080">(</font><font color="#800000">&quot;g_nPosChave&quot;</font><font color="#808080">)</font>, gg<font color="#808080">(</font><font color="#800000">&quot;g_nTamChave&quot;</font><font color="#808080">))
    </font>ag<font color="#808080">(</font><font color="#800000">&quot;g_nPreco&quot;</font>, <font color="#0000FF">as.real</font><font color="#808080">(</font>sPreco<font color="#808080">))
    </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#0000FF">sprintf</font><font color="#808080">(</font><font color="#800000">&quot;%s\n&quot;</font>,sPreco<font color="#808080">))
  }
}
}
</font><font color="#008000">#------------------------------------------------------------------------------
# Realiza os cadastros dos arquivos que se ligam a outros arquivos.
# sreg - o tipo de arquivo
# sacao - a a&ccedil;&atilde;o a ser realizada
# sCodigo - um das chaves do arquivo de liga&ccedil;&atilde;o
#------------------------------------------------------------------------------
</font>frmCadLigados <font color="#808080">&lt;</font><font color="#808000">- </font><font color="#0000FF">function</font><font color="#808080">(</font>sreg, sacao, sCodigo<font color="#808080">) {

</font><font color="#0000FF">if </font><font color="#808080">(</font>sacao==opNovo<font color="#808080">) {
  </font>nCont = 1
  <font color="#0000FF">if </font><font color="#808080">(</font>sreg==opLivroAss<font color="#808080">) {
    </font>sQtd = validaNumero<font color="#808080">(</font><font color="#800000">&quot;Quantos assuntos quer cadastrar?: &quot;</font>,sQtd<font color="#808080">)
    </font>nQtd = <font color="#0000FF">as.integer</font><font color="#808080">(</font>sQtd<font color="#808080">)
    </font><font color="#0000FF">seek</font><font color="#808080">(</font>tfLivroAss, 0, <font color="#800000">&quot;start&quot;</font>, <font color="#800000">&quot;read&quot;</font><font color="#808080">)
    </font><font color="#0000FF">while </font><font color="#808080">(</font>nCont <font color="#808080">&lt;</font>= nQtd<font color="#808080">) {
      </font>ag<font color="#808080">(</font><font color="#800000">&quot;tLivroAss$isbn&quot;</font>, sCodigo<font color="#808080">)
      </font>ag<font color="#808080">(</font><font color="#800000">&quot;tLivroAss$codassunto&quot;</font>, <font color="#0000FF">readline</font><font color="#808080">(</font>rotulo<font color="#808080">(</font>opLivroAss, 2<font color="#808080">)))
      </font>slinha = pesqArq<font color="#808080">(</font>tfAssunto, gg<font color="#808080">(</font><font color="#800000">&quot;tLivroAss$codassunto&quot;</font><font color="#808080">)</font>,1,10,tamReg<font color="#808080">(</font>opAssunto<font color="#808080">))
      </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#0000FF">sprintf</font><font color="#808080">(</font><font color="#800000">&quot; %s&quot;</font>,rotulo<font color="#808080">(</font>opAssunto, 2<font color="#808080">)))
      </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#0000FF">sprintf</font><font color="#808080">(</font><font color="#800000">&quot;%s\n&quot;</font>,copy<font color="#808080">(</font>slinha, gg<font color="#808080">(</font><font color="#800000">&quot;g_nPosChave&quot;</font><font color="#808080">)</font>, gg<font color="#808080">(</font><font color="#800000">&quot;g_nTamChave&quot;</font><font color="#808080">))))
      </font>pesqLinhaExcluida<font color="#808080">(</font>tfLivroAss, tamReg<font color="#808080">(</font>sreg<font color="#808080">))
      </font>subMenu<font color="#808080">(</font>14, sreg<font color="#808080">)
      </font>nCont = nCont <font color="#808000">+ </font>1
    <font color="#808080">}
  } </font><font color="#0000FF">else if </font><font color="#808080">(</font>sreg==opLivroAut<font color="#808080">) {
    </font>sQtd = validaNumero<font color="#808080">(</font><font color="#800000">&quot;Quantos autores quer cadastrar?: &quot;</font>,sQtd<font color="#808080">)
    </font>nQtd = <font color="#0000FF">as.integer</font><font color="#808080">(</font>sQtd<font color="#808080">)
    </font><font color="#0000FF">seek</font><font color="#808080">(</font>tfLivroAut, 0, <font color="#800000">&quot;start&quot;</font>, <font color="#800000">&quot;read&quot;</font><font color="#808080">)
    </font><font color="#0000FF">while </font><font color="#808080">(</font>nCont <font color="#808080">&lt;</font>= nQtd<font color="#808080">) {
      </font>ag<font color="#808080">(</font><font color="#800000">&quot;tLivroAut$isbn&quot;</font>, sCodigo<font color="#808080">)
      </font>ag<font color="#808080">(</font><font color="#800000">&quot;tLivroAut$codautor&quot;</font>, <font color="#0000FF">readline</font><font color="#808080">(</font>rotulo<font color="#808080">(</font>opLivroAut, 2<font color="#808080">)))
      </font>slinha = pesqArq<font color="#808080">(</font>tfAutor, gg<font color="#808080">(</font><font color="#800000">&quot;tLivroAut$codautor&quot;</font><font color="#808080">)</font>,1,10,tamReg<font color="#808080">(</font>opAutor<font color="#808080">))
      </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#0000FF">sprintf</font><font color="#808080">(</font><font color="#800000">&quot; %s&quot;</font>,rotulo<font color="#808080">(</font>opAutor, 2<font color="#808080">)))
      </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#0000FF">sprintf</font><font color="#808080">(</font><font color="#800000">&quot;%s\n&quot;</font>,copy<font color="#808080">(</font>slinha, gg<font color="#808080">(</font><font color="#800000">&quot;g_nPosChave&quot;</font><font color="#808080">)</font>, gg<font color="#808080">(</font><font color="#800000">&quot;g_nTamChave&quot;</font><font color="#808080">))))
      </font>pesqLinhaExcluida<font color="#808080">(</font>tfLivroAut, tamReg<font color="#808080">(</font>sreg<font color="#808080">))
      </font>subMenu<font color="#808080">(</font>14, sreg<font color="#808080">)
      </font>nCont = nCont <font color="#808000">+ </font>1
    <font color="#808080">}
  } </font><font color="#0000FF">else if </font><font color="#808080">(</font>sreg==opVenda<font color="#808080">) {
    </font>sQtd = validaNumero<font color="#808080">(</font><font color="#800000">&quot;Quantos livros quer vender?: &quot;</font>,sQtd<font color="#808080">)
    </font>nQtd = <font color="#0000FF">as.integer</font><font color="#808080">(</font>sQtd<font color="#808080">)
    </font>nTotalPreco = 0
    <font color="#0000FF">while </font><font color="#808080">(</font>nCont <font color="#808080">&lt;</font>= nQtd<font color="#808080">) {
      </font>slinha = validaEntrada<font color="#808080">(</font>tfLivro,opLivro,1,tVenda.isbn,3,FALSE,opTexto<font color="#808080">)
      </font><font color="#0000FF">if </font><font color="#808080">(</font><font color="#0000FF">nchar</font><font color="#808080">(</font>slinha<font color="#808080">) &gt; </font>0<font color="#808080">) {
        </font>ag<font color="#808080">(</font><font color="#800000">&quot;tVenda$isbn&quot;</font>, trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha,1,13<font color="#808080">)))
        </font><font color="#0000FF">if </font><font color="#808080">(</font>validaISBN<font color="#808080">(</font>gg<font color="#808080">(</font><font color="#800000">&quot;tVenda$isbn&quot;</font><font color="#808080">))) {
          </font>mostrarDados<font color="#808080">(</font>sreg, <font color="#800000">&quot;&quot;</font>, 1<font color="#808080">)
          </font>ag<font color="#808080">(</font><font color="#800000">&quot;tLivro$qtdestoque&quot;</font>, trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha,134,10<font color="#808080">)))
          </font>nQtdEstoque = <font color="#0000FF">as.integer</font><font color="#808080">(</font>gg<font color="#808080">(</font><font color="#800000">&quot;tLivro$qtdestoque&quot;</font><font color="#808080">))
          </font><font color="#0000FF">if </font><font color="#808080">(</font>nQtdEstoque <font color="#808080">&gt; </font>0<font color="#808080">) {
             </font>nTotalPreco = nTotalPreco <font color="#808000">+ </font>gg<font color="#808080">(</font><font color="#800000">&quot;g_nPreco&quot;</font><font color="#808080">)
             </font>sPreco = <font color="#0000FF">as.character</font><font color="#808080">(</font>gg<font color="#808080">(</font><font color="#800000">&quot;g_nPreco&quot;</font><font color="#808080">))
             </font>ag<font color="#808080">(</font><font color="#800000">&quot;tVenda$precovenda&quot;</font>, sPreco<font color="#808080">)
             </font>ag<font color="#808080">(</font><font color="#800000">&quot;g_SalvarInclusao&quot;</font>, <font color="#0000FF">FALSE</font><font color="#808080">)
             </font>subMenu<font color="#808080">(</font>14, sreg<font color="#808080">)
             </font><font color="#0000FF">if </font><font color="#808080">(</font>gg<font color="#808080">(</font><font color="#800000">&quot;g_SalvarInclusao&quot;</font><font color="#808080">)</font>==TRUE<font color="#808080">) {
                </font>slinha = pesqArq<font color="#808080">(</font>tfLivro, gg<font color="#808080">(</font><font color="#800000">&quot;tVenda$isbn&quot;</font><font color="#808080">)</font>, 1, 13, tamReg<font color="#808080">(</font>opLivro<font color="#808080">))
                </font><font color="#0000FF">if </font><font color="#808080">(</font><font color="#0000FF">nchar</font><font color="#808080">(</font>slinha<font color="#808080">) &gt; </font>0<font color="#808080">) {
                   </font>nQtdEstoque = nQtdEstoque-1
                   ag<font color="#808080">(</font><font color="#800000">&quot;tLivro$qtdestoque&quot;</font>, <font color="#0000FF">as.character</font><font color="#808080">(</font>nQtdEstoque<font color="#808080">))
                   </font>slinha=paste<font color="#808080">(</font>copy<font color="#808080">(</font>slinha,1,133<font color="#808080">)</font>,esp<font color="#808080">(</font>gg<font color="#808080">(</font><font color="#800000">&quot;tLivro$qtdestoque&quot;</font><font color="#808080">)</font>,10<font color="#808080">)</font>,sep=<font color="#800000">&quot;&quot;</font><font color="#808080">)
                   </font>escreveArq<font color="#808080">(</font>tfLivro, slinha, <font color="#800000">&quot;&quot;</font>, <font color="#800000">&quot;&quot;</font><font color="#808080">)
                }
             }
             </font>nCont = nCont <font color="#808000">+ </font>1
          <font color="#808080">} </font><font color="#0000FF">else cat</font><font color="#808080">(</font>MSG_SEMESTOQUE<font color="#808080">)
        } </font><font color="#0000FF">else cat</font><font color="#808080">(</font>MSG_ISBNINV<font color="#808080">)
      }
    }
    </font>nTotalPreco = <font color="#0000FF">as.real</font><font color="#808080">(</font>sTotalPreco<font color="#808080">)
    </font><font color="#0000FF">cat</font><font color="#808080">(</font><font color="#0000FF">sprintf</font><font color="#808080">(</font><font color="#800000">&quot;Total de %s%f\n&quot;</font>,rotulo<font color="#808080">(</font>sreg,4<font color="#808080">)</font>,nTotalPreco<font color="#808080">))
  }
} </font><font color="#0000FF">else if </font><font color="#808080">(</font>sacao==opExcluir<font color="#808080">) {
  </font><font color="#0000FF">if </font><font color="#808080">(</font>sreg==opLivroAss<font color="#808080">) 
     </font>ExcluirRegLigados<font color="#808080">(</font>tfLivroAss, sreg, 1, 13, sCodigo<font color="#808080">)
  </font><font color="#0000FF">else if </font><font color="#808080">(</font>sreg==opLivroAut<font color="#808080">) 
     </font>ExcluirRegLigados<font color="#808080">(</font>tfLivroAut, sreg, 1, 13, sCodigo<font color="#808080">)
}
}
</font><font color="#008000">#------------------------------------------------------------------------------
# Realiza a exclus&atilde;o dos arquivos de liga&ccedil;&atilde;o.
# sArq - o arquivo de liga&ccedil;&atilde;o
# sreg - o tipo de arquivo de liga&ccedil;&atilde;o
# nPosChave - a posicao inicial da chave dentro do registro
# nTamChave - o tamanho da chave dentro do registro
# sChave - a chave a ser excluida
#------------------------------------------------------------------------------
</font>ExcluirRegLigados <font color="#808080">&lt;</font><font color="#808000">- </font><font color="#0000FF">function</font><font color="#808080">(</font>sArq, sreg, nPosChave, nTamChave, sChave<font color="#808080">) {
  </font>slinha = <font color="#800000">&quot;&quot; 
  </font><font color="#0000FF">seek</font><font color="#808080">(</font>sArq, 0, <font color="#800000">&quot;start&quot;</font>, <font color="#800000">&quot;read&quot;</font><font color="#808080">)
  </font><font color="#0000FF">while </font><font color="#808080">(</font><font color="#0000FF">length</font><font color="#808080">(</font>slinha<font color="#808080">)</font>!=0<font color="#808080">) {
    </font>slinha = <font color="#0000FF">readLines</font><font color="#808080">(</font>sArq, 1<font color="#808080">)
    </font><font color="#0000FF">if </font><font color="#808080">(</font><font color="#0000FF">length</font><font color="#808080">(</font>slinha<font color="#808080">)</font>!=0<font color="#808080">) {
      </font>sCodigo = trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha,nPosChave,nTamChave<font color="#808080">))
      </font><font color="#0000FF">if </font><font color="#808080">(</font>sCodigo==sChave<font color="#808080">)
         </font>btnAcao<font color="#808080">(</font>sreg,opConfirmaExclusao<font color="#808080">)
    }
  }
}
</font><font color="#008000">#------------------------------------------------------------------------------
# Parte inicial do c&oacute;digo
#------------------------------------------------------------------------------
</font>main <font color="#808080">&lt;</font><font color="#808000">- </font><font color="#0000FF">function</font><font color="#808080">()
{
</font><font color="#008000"># if ((argc &gt; 0) &amp;&amp; (strcmp(argv[0],&quot;-cria&quot;)==0))
#   abrecriaArqs(FALSE)
# else {
   </font>frmSplash<font color="#808080">()
   </font>abrecriaArqs<font color="#808080">(</font><font color="#0000FF">TRUE</font><font color="#808080">)
   </font><font color="#0000FF">if </font><font color="#808080">(</font>frmLogin<font color="#808080">()) {
     </font>bopcao = <font color="#0000FF">TRUE
     while</font><font color="#808080">(</font>bopcao<font color="#808080">) {
       </font><font color="#0000FF">menu</font><font color="#808080">(</font>1<font color="#808080">)
       </font>opmenu = <font color="#0000FF">readline</font><font color="#808080">()
       </font><font color="#0000FF">if </font><font color="#808080">((</font>opmenu==<font color="#800000">&quot;C&quot;</font><font color="#808080">) </font>|| <font color="#808080">(</font>opmenu==<font color="#800000">&quot;c&quot;</font><font color="#808080">)) </font>usaMenu<font color="#808080">(</font>1<font color="#808080">)
       </font><font color="#0000FF">else if </font><font color="#808080">((</font>opmenu==<font color="#800000">&quot;P&quot;</font><font color="#808080">) </font>|| <font color="#808080">(</font>opmenu==<font color="#800000">&quot;p&quot;</font><font color="#808080">)) </font>usaMenu<font color="#808080">(</font>2<font color="#808080">)
       </font><font color="#0000FF">else if </font><font color="#808080">((</font>opmenu==<font color="#800000">&quot;V&quot;</font><font color="#808080">) </font>|| <font color="#808080">(</font>opmenu==<font color="#800000">&quot;v&quot;</font><font color="#808080">)) </font>usaMenu<font color="#808080">(</font>3<font color="#808080">)
       </font><font color="#0000FF">else if </font><font color="#808080">((</font>opmenu==<font color="#800000">&quot;O&quot;</font><font color="#808080">) </font>|| <font color="#808080">(</font>opmenu==<font color="#800000">&quot;o&quot;</font><font color="#808080">)) </font>usaMenu<font color="#808080">(</font>4<font color="#808080">)
       </font><font color="#0000FF">else cat</font><font color="#808080">(</font>MSG_ERRO<font color="#808080">)
     }
   } </font><font color="#0000FF">else </font><font color="#808080">{
     </font>fechaArqs<font color="#808080">()
     </font><font color="#0000FF">quit</font><font color="#808080">()
   }
</font><font color="#008000"># }
</font><font color="#808080">}

</font>main<font color="#808080">()

</font></font>
</code></pre>
</body>
</html>