<html>
<head>
<title>Livrus Virtus - Console - Euphoria</title>
</head>
<!-- Generated by ConTEXT HTML exporter -->
<body text="#000000" bgcolor="#FFFFFF">
<pre>
<code><font  face="Courier New"><font color="#FF0000">#</font><font color="#800080">!/</font>home<font color="#800080">/</font>euphoria<font color="#800080">/</font>bin<font color="#800080">/</font>exu
<font color="#808080"><i>-- ----------------------------------------------------------------------------
-- Sistema integrante do projeto Livrus Virtus.
-- Todos os direitos reservados para Henrique F. de Souza.
-- Vers&atilde;o programada na linguagem euphoria.
-- ----------------------------------------------------------------------------
-- programa Livrus
</i></font><font color="#008000"><b>include </b></font><font color="#0000FF">get</font><font color="#FF0000">.e
</font><font color="#008000"><b>include </b></font>file<font color="#FF0000">.e

</font><font color="#008000"><b>constant </b></font>CODIGO <font color="#800080">= </font><font color="#FF0000">1</font><font color="#800080">, </font>ASSUNTO <font color="#800080">= </font><font color="#FF0000">2
</font><font color="#0000FF"><b>sequence </b></font>tAssunto
tAssunto <font color="#800080">= {{</font>CODIGO<font color="#800080">,</font><font color="#008000"><i>&quot;&quot;</i></font><font color="#800080">}, {</font>ASSUNTO<font color="#800080">,</font><font color="#008000"><i>&quot;&quot;</i></font><font color="#800080">}}

</font><font color="#008000"><b>constant </b></font>AUTOR <font color="#800080">= </font><font color="#FF0000">2
</font><font color="#0000FF"><b>sequence </b></font>tAutor
tAutor <font color="#800080">= {{</font>CODIGO<font color="#800080">,</font><font color="#008000"><i>&quot;&quot;</i></font><font color="#800080">}, {</font>AUTOR<font color="#800080">,</font><font color="#008000"><i>&quot;&quot;</i></font><font color="#800080">}}

</font><font color="#008000"><b>constant </b></font>EDITORA <font color="#800080">= </font><font color="#FF0000">2
</font><font color="#0000FF"><b>sequence </b></font>tEditora
tEditora <font color="#800080">= {{</font>CODIGO<font color="#800080">,</font><font color="#008000"><i>&quot;&quot;</i></font><font color="#800080">}, {</font>EDITORA<font color="#800080">,</font><font color="#008000"><i>&quot;&quot;</i></font><font color="#800080">}}

</font><font color="#008000"><b>constant </b></font>IDIOMA <font color="#800080">= </font><font color="#FF0000">2
</font><font color="#0000FF"><b>sequence </b></font>tIdioma
tIdioma <font color="#800080">= {{</font>CODIGO<font color="#800080">,</font><font color="#008000"><i>&quot;&quot;</i></font><font color="#800080">}, {</font>IDIOMA<font color="#800080">,</font><font color="#008000"><i>&quot;&quot;</i></font><font color="#800080">}}

</font><font color="#008000"><b>constant </b></font>LOGIN <font color="#800080">= </font><font color="#FF0000">1</font><font color="#800080">, </font>SENHA <font color="#800080">= </font><font color="#FF0000">2
</font><font color="#0000FF"><b>sequence </b></font>tUsuario
tUsuario <font color="#800080">= {{</font>LOGIN<font color="#800080">,</font><font color="#008000"><i>&quot;&quot;</i></font><font color="#800080">}, {</font>SENHA<font color="#800080">,</font><font color="#008000"><i>&quot;&quot;</i></font><font color="#800080">}}

</font><font color="#008000"><b>constant </b></font>PAIS <font color="#800080">= </font><font color="#FF0000">2
</font><font color="#0000FF"><b>sequence </b></font>tPais
tPais <font color="#800080">= {{</font>CODIGO<font color="#800080">,</font><font color="#008000"><i>&quot;&quot;</i></font><font color="#800080">}, {</font>PAIS<font color="#800080">,</font><font color="#008000"><i>&quot;&quot;</i></font><font color="#800080">}}

</font><font color="#008000"><b>constant </b></font>PROFISSAO <font color="#800080">= </font><font color="#FF0000">2
</font><font color="#0000FF"><b>sequence </b></font>tProfissao
tProfissao <font color="#800080">= {{</font>CODIGO<font color="#800080">,</font><font color="#008000"><i>&quot;&quot;</i></font><font color="#800080">}, {</font>PROFISSAO<font color="#800080">,</font><font color="#008000"><i>&quot;&quot;</i></font><font color="#800080">}}

</font><font color="#008000"><b>constant </b></font>ISBN <font color="#800080">= </font><font color="#FF0000">1</font><font color="#800080">, </font>TITULO <font color="#800080">= </font><font color="#FF0000">2</font><font color="#800080">, </font>EDICAO <font color="#800080">= </font><font color="#FF0000">3</font><font color="#800080">, </font>ANOPUBLI <font color="#800080">= </font><font color="#FF0000">4</font><font color="#800080">, </font>CODEDITORA <font color="#800080">= </font><font color="#FF0000">5</font><font color="#800080">,
         </font>VOLUME <font color="#800080">= </font><font color="#FF0000">6</font><font color="#800080">, </font>CODIDIOMA <font color="#800080">= </font><font color="#FF0000">7</font><font color="#800080">, </font>NPAGINAS <font color="#800080">= </font><font color="#FF0000">8</font><font color="#800080">, </font>PRECO <font color="#800080">= </font><font color="#FF0000">9</font><font color="#800080">, </font>QTDESTOQUE <font color="#800080">= </font><font color="#FF0000">10
</font><font color="#0000FF"><b>sequence </b></font>tLivro
tLivro <font color="#800080">= {{</font>ISBN<font color="#800080">,</font><font color="#008000"><i>&quot;&quot;</i></font><font color="#800080">}, {</font>TITULO<font color="#800080">,</font><font color="#008000"><i>&quot;&quot;</i></font><font color="#800080">}, {</font>EDICAO<font color="#800080">,</font><font color="#008000"><i>&quot;&quot;</i></font><font color="#800080">}, {</font>ANOPUBLI<font color="#800080">,</font><font color="#008000"><i>&quot;&quot;</i></font><font color="#800080">}, {</font>CODEDITORA<font color="#800080">,</font><font color="#008000"><i>&quot;&quot;</i></font><font color="#800080">}, 
       {</font>VOLUME<font color="#800080">,</font><font color="#008000"><i>&quot;&quot;</i></font><font color="#800080">}, {</font>CODIDIOMA<font color="#800080">,</font><font color="#008000"><i>&quot;&quot;</i></font><font color="#800080">}, {</font>NPAGINAS<font color="#800080">,</font><font color="#008000"><i>&quot;&quot;</i></font><font color="#800080">}, {</font>PRECO<font color="#800080">,</font><font color="#008000"><i>&quot;&quot;</i></font><font color="#800080">}, {</font>QTDESTOQUE<font color="#800080">,</font><font color="#008000"><i>&quot;&quot;</i></font><font color="#800080">}}

</font><font color="#008000"><b>constant </b></font>CODASSUNTO <font color="#800080">= </font><font color="#FF0000">2
</font><font color="#0000FF"><b>sequence </b></font>tLivroAss
tLivroAss <font color="#800080">= {{</font>ISBN<font color="#800080">,</font><font color="#008000"><i>&quot;&quot;</i></font><font color="#800080">}, {</font>CODASSUNTO<font color="#800080">,</font><font color="#008000"><i>&quot;&quot;</i></font><font color="#800080">}}

</font><font color="#008000"><b>constant </b></font>CODAUTOR <font color="#800080">= </font><font color="#FF0000">2
</font><font color="#0000FF"><b>sequence </b></font>tLivroAut
tLivroAut <font color="#800080">= {{</font>ISBN<font color="#800080">,</font><font color="#008000"><i>&quot;&quot;</i></font><font color="#800080">}, {</font>CODAUTOR<font color="#800080">,</font><font color="#008000"><i>&quot;&quot;</i></font><font color="#800080">}}

</font><font color="#008000"><b>constant </b></font>CPF <font color="#800080">= </font><font color="#FF0000">1</font><font color="#800080">, </font>NOME <font color="#800080">= </font><font color="#FF0000">2</font><font color="#800080">, </font>EMAIL <font color="#800080">= </font><font color="#FF0000">3</font><font color="#800080">, </font>IDENTIDADE <font color="#800080">= </font><font color="#FF0000">4</font><font color="#800080">, </font>SEXO <font color="#800080">= </font><font color="#FF0000">5</font><font color="#800080">, </font>TELEFONE <font color="#800080">= </font><font color="#FF0000">6</font><font color="#800080">,
         </font>DTNASCIMENTO <font color="#800080">= </font><font color="#FF0000">7</font><font color="#800080">, </font>CODENDERECO <font color="#800080">= </font><font color="#FF0000">8</font><font color="#800080">, </font>CODPAIS <font color="#800080">= </font><font color="#FF0000">9</font><font color="#800080">, </font>CODPROFISSAO <font color="#800080">= </font><font color="#FF0000">10
</font><font color="#0000FF"><b>sequence </b></font>tCliente
tCliente <font color="#800080">= {{</font>CPF<font color="#800080">,</font><font color="#008000"><i>&quot;&quot;</i></font><font color="#800080">}, {</font>NOME<font color="#800080">,</font><font color="#008000"><i>&quot;&quot;</i></font><font color="#800080">}, {</font>EMAIL<font color="#800080">,</font><font color="#008000"><i>&quot;&quot;</i></font><font color="#800080">}, {</font>IDENTIDADE<font color="#800080">,</font><font color="#008000"><i>&quot;&quot;</i></font><font color="#800080">}, {</font>SEXO<font color="#800080">,</font><font color="#008000"><i>&quot;&quot;</i></font><font color="#800080">}, 
           {</font>TELEFONE<font color="#800080">,</font><font color="#008000"><i>&quot;&quot;</i></font><font color="#800080">}, {</font>DTNASCIMENTO<font color="#800080">,</font><font color="#008000"><i>&quot;&quot;</i></font><font color="#800080">}, {</font>CODENDERECO<font color="#800080">,</font><font color="#008000"><i>&quot;&quot;</i></font><font color="#800080">}, {</font>CODPAIS<font color="#800080">,</font><font color="#008000"><i>&quot;&quot;</i></font><font color="#800080">}, 
           {</font>CODPROFISSAO<font color="#800080">,</font><font color="#008000"><i>&quot;&quot;</i></font><font color="#800080">}}

</font><font color="#008000"><b>constant </b></font>LOGRADOURO <font color="#800080">= </font><font color="#FF0000">2</font><font color="#800080">, </font>BAIRRO <font color="#800080">= </font><font color="#FF0000">3</font><font color="#800080">, </font>CEP <font color="#800080">= </font><font color="#FF0000">4</font><font color="#800080">, </font>CIDADE <font color="#800080">= </font><font color="#FF0000">5</font><font color="#800080">, </font>ESTADO <font color="#800080">= </font><font color="#FF0000">6
</font><font color="#0000FF"><b>sequence </b></font>tEndereco
tEndereco <font color="#800080">= {{</font>CODIGO<font color="#800080">,</font><font color="#008000"><i>&quot;&quot;</i></font><font color="#800080">}, {</font>LOGRADOURO<font color="#800080">,</font><font color="#008000"><i>&quot;&quot;</i></font><font color="#800080">}, {</font>BAIRRO<font color="#800080">,</font><font color="#008000"><i>&quot;&quot;</i></font><font color="#800080">}, {</font>CEP<font color="#800080">,</font><font color="#008000"><i>&quot;&quot;</i></font><font color="#800080">}, 
            {</font>CIDADE<font color="#800080">,</font><font color="#008000"><i>&quot;&quot;</i></font><font color="#800080">}, {</font>ESTADO<font color="#800080">,</font><font color="#008000"><i>&quot;&quot;</i></font><font color="#800080">}}

</font><font color="#008000"><b>constant </b></font>DTHRVENDA <font color="#800080">= </font><font color="#FF0000">1</font><font color="#800080">, </font>CPFVENDA <font color="#800080">= </font><font color="#FF0000">2</font><font color="#800080">, </font>ISBNVENDA <font color="#800080">= </font><font color="#FF0000">3</font><font color="#800080">, </font>PRECOVENDA <font color="#800080">= </font><font color="#FF0000">4
</font><font color="#0000FF"><b>sequence </b></font>tVenda
tVenda <font color="#800080">= {{</font>DTHRVENDA<font color="#800080">,</font><font color="#008000"><i>&quot;&quot;</i></font><font color="#800080">}, {</font>CPFVENDA<font color="#800080">,</font><font color="#008000"><i>&quot;&quot;</i></font><font color="#800080">}, {</font>ISBNVENDA<font color="#800080">,</font><font color="#008000"><i>&quot;&quot;</i></font><font color="#800080">}, {</font>PRECOVENDA<font color="#800080">,</font><font color="#008000"><i>&quot;&quot;</i></font><font color="#800080">}}

</font><font color="#808080"><i>-- ctTipo 
</i></font><font color="#008000"><b>constant </b></font>opTexto <font color="#800080">= </font><font color="#FF0000">1</font><font color="#800080">, </font>opNumero <font color="#800080">= </font><font color="#FF0000">2</font><font color="#800080">, </font>opData <font color="#800080">= </font><font color="#FF0000">3</font><font color="#800080">, </font>opDataHora <font color="#800080">= </font><font color="#FF0000">4</font><font color="#800080">, </font>opSenha <font color="#800080">= </font><font color="#FF0000">5
</font><font color="#008000"><b>type </b></font>ctTipo<font color="#800080">(</font><font color="#0000FF"><b>integer </b></font>x<font color="#800080">)
  </font><font color="#008000"><b>return </b></font>x<font color="#800080">=</font>opTexto <font color="#008000"><b>or </b></font>x<font color="#800080">=</font>opNumero <font color="#008000"><b>or </b></font>x<font color="#800080">=</font>opData <font color="#008000"><b>or </b></font>x<font color="#800080">=</font>opDataHora <font color="#008000"><b>or </b></font>x<font color="#800080">=</font>opSenha
<font color="#008000"><b>end type

</b></font><font color="#808080"><i>-- ctArqs 
</i></font><font color="#008000"><b>constant </b></font>opAssunto <font color="#800080">= </font><font color="#FF0000">1</font><font color="#800080">, </font>opAutor <font color="#800080">= </font><font color="#FF0000">2</font><font color="#800080">, </font>opEditora <font color="#800080">= </font><font color="#FF0000">3</font><font color="#800080">, </font>opEndereco <font color="#800080">= </font><font color="#FF0000">4</font><font color="#800080">, 
         </font>opIdioma <font color="#800080">= </font><font color="#FF0000">5</font><font color="#800080">, </font>opPais <font color="#800080">= </font><font color="#FF0000">6</font><font color="#800080">, </font>opProfissao <font color="#800080">= </font><font color="#FF0000">7</font><font color="#800080">, </font>opCliente <font color="#800080">= </font><font color="#FF0000">8</font><font color="#800080">, </font>opLivro <font color="#800080">= </font><font color="#FF0000">9</font><font color="#800080">, 
         </font>opLivroAss <font color="#800080">= </font><font color="#FF0000">10</font><font color="#800080">, </font>opLivroAut <font color="#800080">= </font><font color="#FF0000">11</font><font color="#800080">, </font>opUsuario <font color="#800080">= </font><font color="#FF0000">12</font><font color="#800080">, </font>opVenda <font color="#800080">= </font><font color="#FF0000">13
</font><font color="#008000"><b>type </b></font>ctArqs<font color="#800080">(</font><font color="#0000FF"><b>integer </b></font>x<font color="#800080">)
  </font><font color="#008000"><b>return </b></font>x<font color="#800080">=</font>opAssunto <font color="#008000"><b>or </b></font>x<font color="#800080">=</font>opAutor <font color="#008000"><b>or </b></font>x<font color="#800080">=</font>opEditora <font color="#008000"><b>or </b></font>x<font color="#800080">=</font>opEndereco <font color="#008000"><b>or
         </b></font>x<font color="#800080">=</font>opIdioma <font color="#008000"><b>or </b></font>x<font color="#800080">=</font>opPais <font color="#008000"><b>or </b></font>x<font color="#800080">=</font>opProfissao <font color="#008000"><b>or </b></font>x<font color="#800080">=</font>opCliente <font color="#008000"><b>or </b></font>x<font color="#800080">=</font>opLivro <font color="#008000"><b>or
         </b></font>x<font color="#800080">=</font>opLivroAss <font color="#008000"><b>or </b></font>x<font color="#800080">=</font>opLivroAut <font color="#008000"><b>or </b></font>x<font color="#800080">=</font>opUsuario <font color="#008000"><b>or </b></font>x<font color="#800080">=</font>opVenda
<font color="#008000"><b>end type

</b></font><font color="#808080"><i>-- ctAcao 
</i></font><font color="#008000"><b>constant </b></font>opNovo <font color="#800080">= </font><font color="#FF0000">1</font><font color="#800080">, </font>opAlterar <font color="#800080">= </font><font color="#FF0000">2</font><font color="#800080">, </font>opPesquisar <font color="#800080">= </font><font color="#FF0000">3</font><font color="#800080">, </font>opSalvarInclusao <font color="#800080">= </font><font color="#FF0000">4</font><font color="#800080">,
         </font>opSalvarAlteracao <font color="#800080">= </font><font color="#FF0000">5</font><font color="#800080">, </font>opExcluir <font color="#800080">= </font><font color="#FF0000">6</font><font color="#800080">, </font>opConfirmaExclusao <font color="#800080">= </font><font color="#FF0000">7</font><font color="#800080">, 
         </font>opListarTodos <font color="#800080">= </font><font color="#FF0000">8
</font><font color="#008000"><b>type </b></font>ctAcao<font color="#800080">(</font><font color="#0000FF"><b>integer </b></font>x<font color="#800080">)
  </font><font color="#008000"><b>return </b></font>x<font color="#800080">=</font>opNovo <font color="#008000"><b>or </b></font>x<font color="#800080">=</font>opAlterar <font color="#008000"><b>or </b></font>x<font color="#800080">=</font>opPesquisar <font color="#008000"><b>or </b></font>x<font color="#800080">=</font>opSalvarInclusao <font color="#008000"><b>or
         </b></font>x<font color="#800080">=</font>opSalvarAlteracao <font color="#008000"><b>or </b></font>x<font color="#800080">=</font>opExcluir <font color="#008000"><b>or </b></font>x<font color="#800080">=</font>opConfirmaExclusao <font color="#008000"><b>or
         </b></font>x<font color="#800080">=</font>opListarTodos
<font color="#008000"><b>end type

constant </b></font>STDIN <font color="#800080">= </font><font color="#FF0000">0</font><font color="#800080">, </font>STDOUT <font color="#800080">= </font><font color="#FF0000">1</font><font color="#800080">, </font>STDERR <font color="#800080">= </font><font color="#FF0000">2
</font><font color="#008000"><b>constant </b></font>FALSE <font color="#800080">= </font><font color="#FF0000">0</font><font color="#800080">, </font>TRUE <font color="#800080">= </font><font color="#FF0000">1

</font><font color="#008000"><b>constant </b></font>CRLF <font color="#800080">= </font><font color="#008000"><i>&quot;\n&quot; </i></font><font color="#808080"><i>-- windows
</i></font><font color="#008000"><b>constant </b></font>TAM_CRLF <font color="#800080">= </font><font color="#FF0000">1
</font><font color="#808080"><i>-- constant CRLF = &quot;\n&quot;
-- constant TAM_CRLF = 1 -- unix
-- constant CRLF = &quot;\r&quot;
-- constant TAM_CRLF = 1 -- macintosh

</i></font><font color="#008000"><b>constant </b></font>ARQ_ABRE <font color="#800080">= </font><font color="#008000"><i>&quot;u&quot;
</i><b>constant </b></font>ARQ_CRIA <font color="#800080">= </font><font color="#008000"><i>&quot;w&quot;

</i><b>constant </b></font>QTD_MAX_LINHA <font color="#800080">= </font><font color="#FF0000">18

</font><font color="#008000"><b>constant </b></font>MSG_PRESS <font color="#800080">= </font><font color="#008000"><i>&quot;pressione para continuar...&quot;
</i><b>constant </b></font>MSG_OPCAO <font color="#800080">= </font><font color="#008000"><i>&quot;Escolha uma op&ccedil;&atilde;o: &quot;
</i><b>constant </b></font>MSG_ISBNINV <font color="#800080">= </font><font color="#008000"><i>&quot;ISBN inv&aacute;lido!\n&quot;
</i><b>constant </b></font>MSG_CPFINV <font color="#800080">= </font><font color="#008000"><i>&quot;CPF inv&aacute;lido!\n&quot;
</i><b>constant </b></font>MSG_SENCONFERE <font color="#800080">= </font><font color="#008000"><i>&quot;senha n&atilde;o confere com a senha atual!\n&quot;
</i><b>constant </b></font>MSG_SENCONFIRM <font color="#800080">= </font><font color="#008000"><i>&quot;nova senha n&atilde;o confere com a senha confirmada!\n&quot;
</i><b>constant </b></font>MSG_LOGINENCON <font color="#800080">= </font><font color="#008000"><i>&quot;login n&atilde;o encontrado!\n&quot;
</i><b>constant </b></font>MSG_SEMESTOQUE <font color="#800080">= </font><font color="#008000"><i>&quot;livro n&atilde;o existe no estoque!\n&quot;
</i><b>constant </b></font>MSG_NUMINV <font color="#800080">= </font><font color="#008000"><i>&quot;N&uacute;mero inv&aacute;lido ou menor do que 0.01!\n&quot;
</i><b>constant </b></font>MSG_DATAINV <font color="#800080">= </font><font color="#008000"><i>&quot;Data inv&aacute;lida!, formato correto (dd/mm/yyyy)\n&quot;
</i><b>constant </b></font>MSG_DTHRINV <font color="#800080">= 
                </font><font color="#008000"><i>&quot;Data/hora inv&aacute;lida!, formato correto (dd/mm/yyyy hh:mm:ss)\n&quot;
</i><b>constant </b></font>MSG_ARQERRO <font color="#800080">= </font><font color="#008000"><i>&quot;Erro: O arquivo n&atilde;o pode ser aberto.&quot;
</i><b>constant </b></font>MSG_ERRO <font color="#800080">= </font><font color="#008000"><i>&quot;Erro: op&ccedil;&atilde;o inv&aacute;lida digite de novo.\n&quot;

</i><b>constant </b></font>MSG_REGINC <font color="#800080">= </font><font color="#008000"><i>&quot;registro incluido!\n&quot;
</i><b>constant </b></font>MSG_REGNINC <font color="#800080">= </font><font color="#008000"><i>&quot;registro n&atilde;o incluido!\n&quot;
</i><b>constant </b></font>MSG_REGALT <font color="#800080">= </font><font color="#008000"><i>&quot;registro alterado!\n&quot;
</i><b>constant </b></font>MSG_REGNALT <font color="#800080">= </font><font color="#008000"><i>&quot;registro n&atilde;o alterado!\n&quot;
</i><b>constant </b></font>MSG_REGEXC <font color="#800080">= </font><font color="#008000"><i>&quot;registro excluido!\n&quot;
</i><b>constant </b></font>MSG_REGNEXC <font color="#800080">= </font><font color="#008000"><i>&quot;registro n&atilde;o excluido!\n&quot;
</i><b>constant </b></font>MSG_REGEXST <font color="#800080">= </font><font color="#008000"><i>&quot;registro j&aacute; existe!\n&quot;

</i><b>constant </b></font>ARQ_ASSUNTO <font color="#800080">= </font><font color="#008000"><i>&quot;assunto.dat&quot;
</i><b>constant </b></font>ARQ_AUTOR <font color="#800080">= </font><font color="#008000"><i>&quot;autor.dat&quot;
</i><b>constant </b></font>ARQ_EDITORA <font color="#800080">= </font><font color="#008000"><i>&quot;editora.dat&quot;
</i><b>constant </b></font>ARQ_IDIOMA <font color="#800080">= </font><font color="#008000"><i>&quot;idioma.dat&quot;
</i><b>constant </b></font>ARQ_USUARIO <font color="#800080">= </font><font color="#008000"><i>&quot;usuario.dat&quot;
</i><b>constant </b></font>ARQ_PAIS <font color="#800080">= </font><font color="#008000"><i>&quot;pais.dat&quot;
</i><b>constant </b></font>ARQ_PROFISSAO <font color="#800080">= </font><font color="#008000"><i>&quot;profissao.dat&quot;
</i><b>constant </b></font>ARQ_LIVRO <font color="#800080">= </font><font color="#008000"><i>&quot;livro.dat&quot;
</i><b>constant </b></font>ARQ_LIVASS <font color="#800080">= </font><font color="#008000"><i>&quot;livroass.dat&quot;
</i><b>constant </b></font>ARQ_LIVAUT <font color="#800080">= </font><font color="#008000"><i>&quot;livroaut.dat&quot;
</i><b>constant </b></font>ARQ_CLIENTE <font color="#800080">= </font><font color="#008000"><i>&quot;cliente.dat&quot;
</i><b>constant </b></font>ARQ_ENDERECO <font color="#800080">= </font><font color="#008000"><i>&quot;endereco.dat&quot;
</i><b>constant </b></font>ARQ_VENDA <font color="#800080">= </font><font color="#008000"><i>&quot;venda.dat&quot;

</i><b>constant </b></font>TAM_ASSUNTO <font color="#800080">= </font><font color="#FF0000">40
</font><font color="#008000"><b>constant </b></font>TAM_AUTOR <font color="#800080">= </font><font color="#FF0000">40
</font><font color="#008000"><b>constant </b></font>TAM_EDITORA <font color="#800080">= </font><font color="#FF0000">60
</font><font color="#008000"><b>constant </b></font>TAM_IDIOMA <font color="#800080">= </font><font color="#FF0000">30
</font><font color="#008000"><b>constant </b></font>TAM_USUARIO <font color="#800080">= </font><font color="#FF0000">20
</font><font color="#008000"><b>constant </b></font>TAM_PAIS <font color="#800080">= </font><font color="#FF0000">53
</font><font color="#008000"><b>constant </b></font>TAM_PROFISSAO <font color="#800080">= </font><font color="#FF0000">60
</font><font color="#008000"><b>constant </b></font>TAM_LIVRO <font color="#800080">= </font><font color="#FF0000">143
</font><font color="#008000"><b>constant </b></font>TAM_LIVASS <font color="#800080">= </font><font color="#FF0000">23
</font><font color="#008000"><b>constant </b></font>TAM_LIVAUT <font color="#800080">= </font><font color="#FF0000">23
</font><font color="#008000"><b>constant </b></font>TAM_CLIENTE <font color="#800080">= </font><font color="#FF0000">135
</font><font color="#008000"><b>constant </b></font>TAM_ENDERECO <font color="#800080">= </font><font color="#FF0000">123
</font><font color="#008000"><b>constant </b></font>TAM_VENDA <font color="#800080">= </font><font color="#FF0000">56

</font><font color="#008000"><b>type </b></font>tarquivo<font color="#800080">(</font><font color="#0000FF"><b>integer </b></font>x<font color="#800080">)
  </font><font color="#008000"><b>return </b></font>x <font color="#800080">&gt;= -</font><font color="#FF0000">1
</font><font color="#008000"><b>end type

type </b></font>boolean<font color="#800080">(</font><font color="#0000FF"><b>integer </b></font>x<font color="#800080">)
  </font><font color="#008000"><b>return </b></font>x <font color="#800080">= </font>FALSE <font color="#008000"><b>or </b></font>x <font color="#800080">= </font>TRUE
<font color="#008000"><b>end type

</b></font>tarquivo tfAssunto<font color="#800080">, </font>tfAutor<font color="#800080">, </font>tfEditora<font color="#800080">, </font>tfIdioma<font color="#800080">, </font>tfEndereco<font color="#800080">, </font>tfPais<font color="#800080">, 
    </font>tfProfissao<font color="#800080">, </font>tfLivro<font color="#800080">, </font>tfLivroAss<font color="#800080">, </font>tfLivroAut<font color="#800080">, </font>tfCliente<font color="#800080">, </font>tfUsuario<font color="#800080">, </font>tfVenda

<font color="#808080"><i>-- variaveis gerais

</i></font>boolean bopcao
<font color="#0000FF"><b>sequence </b></font>opmenu
<font color="#0000FF"><b>atom </b></font>g_nPreco
<font color="#0000FF"><b>integer </b></font>g_nPosChave<font color="#800080">, </font>g_nTamChave
<font color="#0000FF"><b>integer </b></font>g_SalvarInclusao

<font color="#808080"><i>-- --- Rotinas b&aacute;sicas --------------------------------------------------------

-- ----------------------------------------------------------------------------
-- Fun&ccedil;&atilde;o que retorna um peda&ccedil;o de uma string.
-- str - indica a string
-- ini - indica a posicao inicial do pedaco
-- tam - indica o tamanho do pedaco
-- retorna - o peda&ccedil;o da string
-- ----------------------------------------------------------------------------
</i></font><font color="#008000"><b>function </b></font>copy<font color="#800080">(</font><font color="#0000FF"><b>sequence </b></font>str<font color="#800080">, </font><font color="#0000FF"><b>integer </b></font>ini<font color="#800080">, </font><font color="#0000FF"><b>integer </b></font>tam<font color="#800080">)
  </font><font color="#008000"><b>return </b></font>str<font color="#800080">[</font>ini<font color="#FF0000">..</font><font color="#800080">(</font>ini<font color="#800080">+</font>tam<font color="#800080">-</font><font color="#FF0000">1</font><font color="#800080">)]
</font><font color="#008000"><b>end function
</b></font><font color="#808080"><i>-- ----------------------------------------------------------------------------
-- Retira os espa&ccedil;os em branco antes ou depois do texto.
-- sTexto - o texto a ser retirado os espa&ccedil;os em branco
-- retorna - o texto sem os espa&ccedil;os em branco
-- ----------------------------------------------------------------------------
</i></font><font color="#008000"><b>function </b></font>trim<font color="#800080">(</font><font color="#0000FF"><b>sequence </b></font>sTexto<font color="#800080">)
</font><font color="#0000FF"><b>integer </b></font>ncont<font color="#800080">, </font>nPosIni<font color="#800080">, </font>nPosFim
<font color="#0000FF"><b>sequence </b></font>sret
<font color="#0000FF"><b>integer </b></font>bQuebra

nPosIni<font color="#800080">=</font><font color="#FF0000">0
</font>nPosFim<font color="#800080">=</font><font color="#FF0000">0
</font>ncont<font color="#800080">=</font><font color="#FF0000">1
</font>bQuebra<font color="#800080">=</font>FALSE
<font color="#008000"><b>while </b></font><font color="#800080">(</font>ncont<font color="#800080">&lt;=</font><font color="#0000FF"><b>length</b></font><font color="#800080">(</font>sTexto<font color="#800080">)) </font><font color="#008000"><b>and </b></font><font color="#800080">(</font>bQuebra<font color="#800080">=</font>FALSE<font color="#800080">) </font><font color="#008000"><b>do
  if </b></font>sTexto<font color="#800080">[</font>ncont<font color="#800080">]!=' ' </font><font color="#008000"><b>then
     </b></font>nPosIni<font color="#800080">=</font>ncont
     bQuebra<font color="#800080">=</font>TRUE
  <font color="#008000"><b>end if
  </b></font>ncont<font color="#800080">=</font>ncont<font color="#800080">+</font><font color="#FF0000">1
</font><font color="#008000"><b>end while
</b></font>ncont<font color="#800080">=</font><font color="#0000FF"><b>length</b></font><font color="#800080">(</font>sTexto<font color="#800080">)
</font>bQuebra<font color="#800080">=</font>FALSE
<font color="#008000"><b>while </b></font><font color="#800080">(</font>ncont <font color="#800080">&gt;= </font><font color="#FF0000">1</font><font color="#800080">) </font><font color="#008000"><b>and </b></font><font color="#800080">(</font>bQuebra<font color="#800080">=</font>FALSE<font color="#800080">) </font><font color="#008000"><b>do
  if </b></font>sTexto<font color="#800080">[</font>ncont<font color="#800080">]!=' ' </font><font color="#008000"><b>then
     </b></font>nPosFim<font color="#800080">=</font>ncont
     bQuebra<font color="#800080">=</font>TRUE
  <font color="#008000"><b>end if
  </b></font>ncont<font color="#800080">=</font>ncont<font color="#800080">-</font><font color="#FF0000">1
</font><font color="#008000"><b>end while
</b></font>sret<font color="#800080">=</font>copy<font color="#800080">(</font>sTexto<font color="#800080">,</font>nPosIni<font color="#800080">,(</font>nPosFim<font color="#800080">-</font>nPosIni<font color="#800080">)+</font><font color="#FF0000">1</font><font color="#800080">)
</font><font color="#008000"><b>return </b></font>sret
<font color="#008000"><b>end function
</b></font><font color="#808080"><i>-- ----------------------------------------------------------------------------
-- convert uma string num numero somente positivo
-- nstr - a string
-- retorna - o numero
-- ----------------------------------------------------------------------------
-- function StrToNum(sequence str)
-- atom nret
-- object num
--   num = value(str)
--   if num[1] = GET_SUCCESS then
--     nret = num[2]
--     return nret
--   else
--     return -1
--   end if
-- end function

</i></font><font color="#008000"><b>function </b></font>StrToNum<font color="#800080">(</font><font color="#0000FF"><b>sequence </b></font>str<font color="#800080">)
</font><font color="#0000FF"><b>integer </b></font>nnum<font color="#800080">, </font>ndec<font color="#800080">, </font>bponto
<font color="#0000FF"><b>atom </b></font>nret

bponto <font color="#800080">= </font>FALSE
nret <font color="#800080">= </font><font color="#FF0000">0
</font>ndec <font color="#800080">= </font><font color="#0000FF"><b>length</b></font><font color="#800080">(</font>str<font color="#800080">)
  </font><font color="#008000"><b>for </b></font>ncont <font color="#800080">= </font><font color="#FF0000">1 </font><font color="#008000"><b>to </b></font><font color="#0000FF"><b>length</b></font><font color="#800080">(</font>str<font color="#800080">) </font><font color="#008000"><b>do
    if </b></font>str<font color="#800080">[</font>ncont<font color="#800080">] = </font><font color="#FF0000">48 </font><font color="#008000"><b>then </b></font>nnum <font color="#800080">= </font><font color="#FF0000">0
    </font><font color="#008000"><b>elsif </b></font>str<font color="#800080">[</font>ncont<font color="#800080">] = </font><font color="#FF0000">49 </font><font color="#008000"><b>then </b></font>nnum <font color="#800080">= </font><font color="#FF0000">1
    </font><font color="#008000"><b>elsif </b></font>str<font color="#800080">[</font>ncont<font color="#800080">] = </font><font color="#FF0000">50 </font><font color="#008000"><b>then </b></font>nnum <font color="#800080">= </font><font color="#FF0000">2
    </font><font color="#008000"><b>elsif </b></font>str<font color="#800080">[</font>ncont<font color="#800080">] = </font><font color="#FF0000">51 </font><font color="#008000"><b>then </b></font>nnum <font color="#800080">= </font><font color="#FF0000">3
    </font><font color="#008000"><b>elsif </b></font>str<font color="#800080">[</font>ncont<font color="#800080">] = </font><font color="#FF0000">52 </font><font color="#008000"><b>then </b></font>nnum <font color="#800080">= </font><font color="#FF0000">4
    </font><font color="#008000"><b>elsif </b></font>str<font color="#800080">[</font>ncont<font color="#800080">] = </font><font color="#FF0000">53 </font><font color="#008000"><b>then </b></font>nnum <font color="#800080">= </font><font color="#FF0000">5
    </font><font color="#008000"><b>elsif </b></font>str<font color="#800080">[</font>ncont<font color="#800080">] = </font><font color="#FF0000">54 </font><font color="#008000"><b>then </b></font>nnum <font color="#800080">= </font><font color="#FF0000">6
    </font><font color="#008000"><b>elsif </b></font>str<font color="#800080">[</font>ncont<font color="#800080">] = </font><font color="#FF0000">55 </font><font color="#008000"><b>then </b></font>nnum <font color="#800080">= </font><font color="#FF0000">7
    </font><font color="#008000"><b>elsif </b></font>str<font color="#800080">[</font>ncont<font color="#800080">] = </font><font color="#FF0000">56 </font><font color="#008000"><b>then </b></font>nnum <font color="#800080">= </font><font color="#FF0000">8
    </font><font color="#008000"><b>elsif </b></font>str<font color="#800080">[</font>ncont<font color="#800080">] = </font><font color="#FF0000">57 </font><font color="#008000"><b>then </b></font>nnum <font color="#800080">= </font><font color="#FF0000">9
    </font><font color="#008000"><b>elsif </b></font>str<font color="#800080">[</font>ncont<font color="#800080">] = </font><font color="#FF0000">46 </font><font color="#008000"><b>then 
      </b></font>nret <font color="#800080">= </font>nret <font color="#800080">/ </font><font color="#0000FF"><b>power</b></font><font color="#800080">(</font><font color="#FF0000">10</font><font color="#800080">, </font>ndec<font color="#800080">)
      </font>ndec <font color="#800080">= </font><font color="#FF0000">0 </font><font color="#808080"><i>-- ponto
    </i></font><font color="#008000"><b>else 
      </b></font>nret <font color="#800080">= -</font><font color="#FF0000">1
      </font><font color="#008000"><b>exit
    end if

    if </b></font>str<font color="#800080">[</font>ncont<font color="#800080">] != </font><font color="#FF0000">46 </font><font color="#008000"><b>then    
      </b></font>ndec <font color="#800080">= </font>ndec <font color="#800080">- </font><font color="#FF0000">1
      </font>nret <font color="#800080">= </font>nret <font color="#800080">+ (</font>nnum <font color="#800080">* </font><font color="#0000FF"><b>power</b></font><font color="#800080">(</font><font color="#FF0000">10</font><font color="#800080">, </font>ndec<font color="#800080">))
    </font><font color="#008000"><b>end if

  end for
return </b></font>nret
<font color="#008000"><b>end function
</b></font><font color="#808080"><i>-- ----------------------------------------------------------------------------
-- converte um numero numa string
-- nstr - o numero
-- retorna - a string
-- ----------------------------------------------------------------------------
</i></font><font color="#008000"><b>function </b></font>NumToStr<font color="#800080">(</font><font color="#0000FF"><b>atom </b></font>nstr<font color="#800080">)
</font><font color="#0000FF"><b>sequence </b></font>str<font color="#800080">, </font>sret
<font color="#0000FF"><b>atom </b></font>ndec<font color="#800080">, </font>nfloat<font color="#800080">, </font>ncont
<font color="#0000FF"><b>integer </b></font>nnum<font color="#800080">, </font>ncasas<font color="#800080">, </font>bnegativo

nfloat <font color="#800080">= </font>nstr
<font color="#008000"><b>if </b></font><font color="#0000FF"><b>floor</b></font><font color="#800080">(</font>nfloat<font color="#800080">) = </font>nstr <font color="#008000"><b>then
  </b></font>ncasas <font color="#800080">= </font><font color="#FF0000">0
</font><font color="#008000"><b>else
  </b></font>ncasas <font color="#800080">= </font><font color="#FF0000">1
  </font><font color="#008000"><b>while </b></font>TRUE <font color="#008000"><b>do
    </b></font>ncont <font color="#800080">= </font>nstr <font color="#800080">* </font><font color="#0000FF"><b>power</b></font><font color="#800080">(</font><font color="#FF0000">10</font><font color="#800080">,</font>ncasas<font color="#800080">)
    </font>nfloat <font color="#800080">= </font>nfloat <font color="#800080">* </font><font color="#FF0000">10
    </font><font color="#008000"><b>if </b></font>ncont <font color="#800080">= </font><font color="#0000FF"><b>floor</b></font><font color="#800080">(</font>nfloat<font color="#800080">) </font><font color="#008000"><b>then
      exit
    else
      </b></font>ncasas <font color="#800080">= </font>ncasas <font color="#800080">+ </font><font color="#FF0000">1 
    </font><font color="#008000"><b>end if
  end while
end if
if </b></font>nstr <font color="#800080">&lt; </font><font color="#FF0000">0 </font><font color="#008000"><b>then
  </b></font>nstr <font color="#800080">= </font>nstr <font color="#800080">* (-</font><font color="#FF0000">1</font><font color="#800080">)
  </font>bnegativo <font color="#800080">= </font>TRUE
<font color="#008000"><b>else
  </b></font>bnegativo <font color="#800080">= </font>FALSE
<font color="#008000"><b>end if
</b></font>ndec <font color="#800080">= </font>nstr <font color="#800080">* </font><font color="#0000FF"><b>power</b></font><font color="#800080">(</font><font color="#FF0000">10</font><font color="#800080">,</font>ncasas<font color="#800080">)
</font>str <font color="#800080">= {}
</font><font color="#008000"><b>if </b></font>nstr <font color="#800080">= </font><font color="#FF0000">0 </font><font color="#008000"><b>then
  </b></font>str <font color="#800080">= </font><font color="#0000FF"><b>append</b></font><font color="#800080">(</font>str<font color="#800080">, </font><font color="#FF0000">48</font><font color="#800080">)
</font><font color="#008000"><b>else
  while </b></font>ndec <font color="#800080">&gt;= </font><font color="#FF0000">1 </font><font color="#008000"><b>do
    </b></font>nnum <font color="#800080">= </font><font color="#0000FF"><b>remainder</b></font><font color="#800080">(</font>ndec<font color="#800080">, </font><font color="#FF0000">10</font><font color="#800080">)
    </font><font color="#008000"><b>if </b></font>nnum <font color="#800080">= </font><font color="#FF0000">0 </font><font color="#008000"><b>then </b></font>str <font color="#800080">= </font><font color="#0000FF"><b>prepend</b></font><font color="#800080">(</font>str<font color="#800080">, </font><font color="#FF0000">48</font><font color="#800080">)
    </font><font color="#008000"><b>elsif </b></font>nnum <font color="#800080">= </font><font color="#FF0000">1 </font><font color="#008000"><b>then </b></font>str <font color="#800080">= </font><font color="#0000FF"><b>prepend</b></font><font color="#800080">(</font>str<font color="#800080">, </font><font color="#FF0000">49</font><font color="#800080">)
    </font><font color="#008000"><b>elsif </b></font>nnum <font color="#800080">= </font><font color="#FF0000">2 </font><font color="#008000"><b>then </b></font>str <font color="#800080">= </font><font color="#0000FF"><b>prepend</b></font><font color="#800080">(</font>str<font color="#800080">, </font><font color="#FF0000">50</font><font color="#800080">)
    </font><font color="#008000"><b>elsif </b></font>nnum <font color="#800080">= </font><font color="#FF0000">3 </font><font color="#008000"><b>then </b></font>str <font color="#800080">= </font><font color="#0000FF"><b>prepend</b></font><font color="#800080">(</font>str<font color="#800080">, </font><font color="#FF0000">51</font><font color="#800080">)
    </font><font color="#008000"><b>elsif </b></font>nnum <font color="#800080">= </font><font color="#FF0000">4 </font><font color="#008000"><b>then </b></font>str <font color="#800080">= </font><font color="#0000FF"><b>prepend</b></font><font color="#800080">(</font>str<font color="#800080">, </font><font color="#FF0000">52</font><font color="#800080">)
    </font><font color="#008000"><b>elsif </b></font>nnum <font color="#800080">= </font><font color="#FF0000">5 </font><font color="#008000"><b>then </b></font>str <font color="#800080">= </font><font color="#0000FF"><b>prepend</b></font><font color="#800080">(</font>str<font color="#800080">, </font><font color="#FF0000">53</font><font color="#800080">)
    </font><font color="#008000"><b>elsif </b></font>nnum <font color="#800080">= </font><font color="#FF0000">6 </font><font color="#008000"><b>then </b></font>str <font color="#800080">= </font><font color="#0000FF"><b>prepend</b></font><font color="#800080">(</font>str<font color="#800080">, </font><font color="#FF0000">54</font><font color="#800080">)
    </font><font color="#008000"><b>elsif </b></font>nnum <font color="#800080">= </font><font color="#FF0000">7 </font><font color="#008000"><b>then </b></font>str <font color="#800080">= </font><font color="#0000FF"><b>prepend</b></font><font color="#800080">(</font>str<font color="#800080">, </font><font color="#FF0000">55</font><font color="#800080">)
    </font><font color="#008000"><b>elsif </b></font>nnum <font color="#800080">= </font><font color="#FF0000">8 </font><font color="#008000"><b>then </b></font>str <font color="#800080">= </font><font color="#0000FF"><b>prepend</b></font><font color="#800080">(</font>str<font color="#800080">, </font><font color="#FF0000">56</font><font color="#800080">)
    </font><font color="#008000"><b>elsif </b></font>nnum <font color="#800080">= </font><font color="#FF0000">9 </font><font color="#008000"><b>then </b></font>str <font color="#800080">= </font><font color="#0000FF"><b>prepend</b></font><font color="#800080">(</font>str<font color="#800080">, </font><font color="#FF0000">57</font><font color="#800080">)
    </font><font color="#008000"><b>end if
    </b></font>ndec <font color="#800080">= ((</font>ndec <font color="#800080">- </font>nnum<font color="#800080">) / </font><font color="#FF0000">10</font><font color="#800080">)
  </font><font color="#008000"><b>end while
end if
</b></font>sret <font color="#800080">= {}
</font><font color="#008000"><b>if </b></font>ncasas <font color="#800080">&gt; </font><font color="#FF0000">0 </font><font color="#008000"><b>then  
  </b></font>nnum <font color="#800080">= </font><font color="#0000FF"><b>length</b></font><font color="#800080">(</font>str<font color="#800080">)-</font>ncasas
  <font color="#008000"><b>if </b></font>nnum <font color="#800080">&gt; </font><font color="#FF0000">0 </font><font color="#008000"><b>then
    </b></font>sret <font color="#800080">= </font>copy<font color="#800080">(</font>str<font color="#800080">, </font><font color="#FF0000">1</font><font color="#800080">, </font>nnum<font color="#800080">) &amp; </font><font color="#008000"><i>&quot;.&quot; </i></font><font color="#800080">&amp; </font>copy<font color="#800080">(</font>str<font color="#800080">, </font>nnum<font color="#800080">+</font><font color="#FF0000">1</font><font color="#800080">, </font>ncasas<font color="#800080">)
  </font><font color="#008000"><b>else
    </b></font>sret <font color="#800080">= </font><font color="#008000"><i>&quot;0&quot; </i></font><font color="#800080">&amp; </font><font color="#008000"><i>&quot;.&quot; </i></font><font color="#800080">&amp; </font><font color="#0000FF"><b>repeat</b></font><font color="#800080">('</font><font color="#FF0000">0</font><font color="#800080">',</font>ncasas<font color="#800080">-</font><font color="#FF0000">1</font><font color="#800080">) &amp; </font>str
  <font color="#008000"><b>end if
else
  </b></font>sret <font color="#800080">= </font>str
<font color="#008000"><b>end if
if </b></font>bnegativo <font color="#800080">= </font>TRUE <font color="#008000"><b>then
  </b></font>sret <font color="#800080">= </font><font color="#008000"><i>&quot;-&quot; </i></font><font color="#800080">&amp; </font>sret
<font color="#008000"><b>end if
return </b></font>sret
<font color="#008000"><b>end function
</b></font><font color="#808080"><i>-- ----------------------------------------------------------------------------
-- Coloca espa&ccedil;os em branco a mais de acordo com o tamanho m&aacute;ximo do texto.
-- sTexto - o texto
-- nTam - tamanho m&aacute;ximo do texto
-- retorna - o texto com espa&ccedil;os em branco a mais
-- ----------------------------------------------------------------------------
</i></font><font color="#008000"><b>function </b></font>esp<font color="#800080">(</font><font color="#0000FF"><b>sequence </b></font>sTexto<font color="#800080">, </font><font color="#0000FF"><b>integer </b></font>nTam<font color="#800080">)
  </font><font color="#008000"><b>return </b></font>sTexto <font color="#800080">&amp; </font><font color="#0000FF"><b>repeat</b></font><font color="#800080">(' ',</font>nTam<font color="#800080">-</font><font color="#0000FF"><b>length</b></font><font color="#800080">(</font>sTexto<font color="#800080">))
</font><font color="#008000"><b>end function
</b></font><font color="#808080"><i>-- ----------------------------------------------------------------------------
-- Faz uma pesquisa relativa de um texto atrav&eacute;s de um valor chave.
-- sTexto - o texto
-- sChave - a chave a ser pesquisada
-- retorna - se achou ou n&atilde;o a chave dentro do texto
-- ----------------------------------------------------------------------------
</i></font><font color="#008000"><b>function </b></font>strRelativa<font color="#800080">(</font><font color="#0000FF"><b>sequence </b></font>sTexto<font color="#800080">, </font><font color="#0000FF"><b>sequence </b></font>sChave<font color="#800080">)
  </font><font color="#008000"><b>if </b></font><font color="#0000FF"><b>match</b></font><font color="#800080">(</font>sChave<font color="#800080">, </font>sTexto<font color="#800080">) != </font><font color="#FF0000">0 </font><font color="#008000"><b>then
    return </b></font>TRUE
  <font color="#008000"><b>else
    return </b></font>FALSE
  <font color="#008000"><b>end if
end function
</b></font><font color="#808080"><i>-- ----------------------------------------------------------------------------
-- Calcula o modulo11 de um valor qualquer.
-- svalor - a mstring com o n&uacute;mero a ser calculado
-- sdig - d&iacute;gito do valor a ser calculado
-- retorna - o d&iacute;gito correto
-- ----------------------------------------------------------------------------
</i></font><font color="#008000"><b>function </b></font>modulo11<font color="#800080">(</font><font color="#0000FF"><b>sequence </b></font>svalor<font color="#800080">, </font><font color="#0000FF"><b>integer </b></font>ndig<font color="#800080">)
</font><font color="#0000FF"><b>integer </b></font>ncont<font color="#800080">, </font>nsoma<font color="#800080">, </font>nvalor<font color="#800080">, </font>npos
<font color="#0000FF"><b>sequence </b></font>sres<font color="#800080">, </font>slocal

sres <font color="#800080">= </font><font color="#008000"><i>&quot;&quot;
</i></font>slocal <font color="#800080">= </font><font color="#008000"><i>&quot;&quot;
</i></font>ncont<font color="#800080">=</font><font color="#FF0000">1
</font><font color="#008000"><b>while </b></font>ncont <font color="#800080">&lt;= </font><font color="#FF0000">11 </font><font color="#008000"><b>do
  </b></font>slocal<font color="#800080">=</font>copy<font color="#800080">(</font>svalor<font color="#800080">,</font>ncont<font color="#800080">,</font><font color="#FF0000">1</font><font color="#800080">) &amp; </font>slocal
  ncont<font color="#800080">=</font>ncont<font color="#800080">+</font><font color="#FF0000">1
</font><font color="#008000"><b>end while
</b></font>nsoma<font color="#800080">=</font><font color="#FF0000">0
</font><font color="#008000"><b>if </b></font>ndig<font color="#800080">=</font><font color="#FF0000">1 </font><font color="#008000"><b>then
  </b></font>ncont<font color="#800080">=</font><font color="#FF0000">3
</font><font color="#008000"><b>else
  </b></font>ncont<font color="#800080">=</font><font color="#FF0000">2
</font><font color="#008000"><b>end if
</b></font>npos<font color="#800080">=</font><font color="#FF0000">2
</font><font color="#008000"><b>while </b></font>ncont <font color="#800080">&lt;= </font><font color="#FF0000">11 </font><font color="#008000"><b>do
  </b></font>sres<font color="#800080">=</font>copy<font color="#800080">(</font>slocal<font color="#800080">,</font>ncont<font color="#800080">,</font><font color="#FF0000">1</font><font color="#800080">)
  </font>nvalor <font color="#800080">= </font>StrToNum<font color="#800080">(</font>sres<font color="#800080">)
  </font>nsoma<font color="#800080">=</font>nsoma <font color="#800080">+ (</font>nvalor <font color="#800080">* </font>npos<font color="#800080">)
  </font>ncont<font color="#800080">=</font>ncont<font color="#800080">+</font><font color="#FF0000">1
  </font>npos<font color="#800080">=</font>npos<font color="#800080">+</font><font color="#FF0000">1
</font><font color="#008000"><b>end while
</b></font>nsoma<font color="#800080">=(</font><font color="#FF0000">11 </font><font color="#800080">- </font><font color="#0000FF"><b>remainder</b></font><font color="#800080">(</font>nsoma<font color="#800080">, </font><font color="#FF0000">11</font><font color="#800080">))

</font><font color="#008000"><b>if </b></font>nsoma <font color="#800080">&gt; </font><font color="#FF0000">9 </font><font color="#008000"><b>then
  return </b></font><font color="#FF0000">0
</font><font color="#008000"><b>else
  return </b></font>nsoma
<font color="#008000"><b>end if
end function
</b></font><font color="#808080"><i>-- ----------------------------------------------------------------------------
-- Valida&ccedil;&atilde;o de um n&uacute;mero de CPF qualquer.
-- cpf - a mstring com o n&uacute;mero do CPF
-- retorna - se &eacute; valido ou n&atilde;o
-- ----------------------------------------------------------------------------
</i></font><font color="#008000"><b>function </b></font>validaCPF<font color="#800080">(</font><font color="#0000FF"><b>sequence </b></font>cpf<font color="#800080">)
</font><font color="#0000FF"><b>sequence </b></font>scpf<font color="#800080">, </font>sres
<font color="#0000FF"><b>integer </b></font>nvalor1<font color="#800080">, </font>nvalor2

<font color="#008000"><b>if </b></font><font color="#800080">(</font><font color="#0000FF"><b>length</b></font><font color="#800080">(</font>cpf<font color="#800080">)=</font><font color="#FF0000">14</font><font color="#800080">) </font><font color="#008000"><b>then
  </b></font>scpf<font color="#800080">=</font>copy<font color="#800080">(</font>cpf<font color="#800080">,</font><font color="#FF0000">1</font><font color="#800080">,</font><font color="#FF0000">3</font><font color="#800080">) &amp; </font>copy<font color="#800080">(</font>cpf<font color="#800080">,</font><font color="#FF0000">5</font><font color="#800080">,</font><font color="#FF0000">3</font><font color="#800080">) &amp; </font>copy<font color="#800080">(</font>cpf<font color="#800080">,</font><font color="#FF0000">9</font><font color="#800080">,</font><font color="#FF0000">3</font><font color="#800080">) &amp; </font>copy<font color="#800080">(</font>cpf<font color="#800080">,</font><font color="#FF0000">13</font><font color="#800080">,</font><font color="#FF0000">2</font><font color="#800080">)
  </font>sres<font color="#800080">=</font>copy<font color="#800080">(</font>cpf<font color="#800080">,</font><font color="#FF0000">13</font><font color="#800080">,</font><font color="#FF0000">1</font><font color="#800080">)
  </font>nvalor1 <font color="#800080">= </font>StrToNum<font color="#800080">(</font>sres<font color="#800080">)
  </font>sres<font color="#800080">=</font>copy<font color="#800080">(</font>cpf<font color="#800080">,</font><font color="#FF0000">14</font><font color="#800080">,</font><font color="#FF0000">1</font><font color="#800080">)
  </font>nvalor2 <font color="#800080">= </font>StrToNum<font color="#800080">(</font>sres<font color="#800080">)
  </font><font color="#008000"><b>if </b></font><font color="#800080">((</font>modulo11<font color="#800080">(</font>scpf<font color="#800080">,</font><font color="#FF0000">1</font><font color="#800080">)=</font>nvalor1<font color="#800080">) </font><font color="#008000"><b>and </b></font><font color="#800080">(</font>modulo11<font color="#800080">(</font>scpf<font color="#800080">,</font><font color="#FF0000">2</font><font color="#800080">)=</font>nvalor2<font color="#800080">)) </font><font color="#008000"><b>then
    return </b></font>TRUE
  <font color="#008000"><b>else
    return </b></font>FALSE
  <font color="#008000"><b>end if
else
  return </b></font>FALSE
<font color="#008000"><b>end if
end function
</b></font><font color="#808080"><i>-- ----------------------------------------------------------------------------
-- Valida&ccedil;&atilde;o de um n&uacute;mero ISBN qualquer.
-- isbn - a mstring com o n&uacute;mero do ISBN
-- retorna - se &eacute; valido ou n&atilde;o
-- ----------------------------------------------------------------------------
</i></font><font color="#008000"><b>function </b></font>validaISBN<font color="#800080">(</font><font color="#0000FF"><b>sequence </b></font>isbn<font color="#800080">)
</font><font color="#0000FF"><b>sequence </b></font>snum<font color="#800080">, </font>sdigito<font color="#800080">, </font>sisbn
<font color="#0000FF"><b>integer </b></font>nvalor<font color="#800080">, </font>nsoma

<font color="#008000"><b>if </b></font><font color="#0000FF"><b>length</b></font><font color="#800080">(</font>isbn<font color="#800080">)=</font><font color="#FF0000">13 </font><font color="#008000"><b>then
  </b></font>sdigito <font color="#800080">= </font>copy<font color="#800080">(</font>isbn<font color="#800080">, </font><font color="#0000FF"><b>length</b></font><font color="#800080">(</font>isbn<font color="#800080">), </font><font color="#FF0000">1</font><font color="#800080">)
  </font>sisbn<font color="#800080">=</font><font color="#008000"><i>&quot;&quot;
  </i><b>for </b></font>ncont<font color="#800080">=</font><font color="#FF0000">1 </font><font color="#008000"><b>to </b></font><font color="#0000FF"><b>length</b></font><font color="#800080">(</font>isbn<font color="#800080">)-</font><font color="#FF0000">1 </font><font color="#008000"><b>do
    if </b></font><font color="#0000FF"><b>equal</b></font><font color="#800080">(</font>copy<font color="#800080">(</font>isbn<font color="#800080">,</font>ncont<font color="#800080">,</font><font color="#FF0000">1</font><font color="#800080">),</font><font color="#008000"><i>&quot;-&quot;</i></font><font color="#800080">)=</font>FALSE <font color="#008000"><b>then
      </b></font>sisbn<font color="#800080">=</font>sisbn <font color="#800080">&amp; </font>copy<font color="#800080">(</font>isbn<font color="#800080">,</font>ncont<font color="#800080">,</font><font color="#FF0000">1</font><font color="#800080">)
    </font><font color="#008000"><b>end if
  end for
  if </b></font><font color="#0000FF"><b>equal</b></font><font color="#800080">(</font>sdigito<font color="#800080">, </font><font color="#008000"><i>&quot;X&quot;</i></font><font color="#800080">) </font><font color="#008000"><b>then
    </b></font>nsoma <font color="#800080">= </font><font color="#FF0000">10
  </font><font color="#008000"><b>else
    </b></font>nvalor <font color="#800080">= </font>StrToNum<font color="#800080">(</font>sdigito<font color="#800080">)
    </font>nsoma <font color="#800080">= </font>nvalor
  <font color="#008000"><b>end if
  for </b></font>ncont<font color="#800080">=</font><font color="#FF0000">1 </font><font color="#008000"><b>to </b></font><font color="#FF0000">9 </font><font color="#008000"><b>do
    </b></font>snum <font color="#800080">= </font>copy<font color="#800080">(</font>sisbn<font color="#800080">, </font>ncont<font color="#800080">, </font><font color="#FF0000">1</font><font color="#800080">)
    </font>nvalor <font color="#800080">= </font>StrToNum<font color="#800080">(</font>snum<font color="#800080">)
    </font>nsoma<font color="#800080">=</font>nsoma <font color="#800080">+ (</font>nvalor <font color="#800080">* (</font><font color="#FF0000">11 </font><font color="#800080">- </font>ncont<font color="#800080">))
  </font><font color="#008000"><b>end for
  if </b></font><font color="#0000FF"><b>remainder</b></font><font color="#800080">(</font>nsoma<font color="#800080">, </font><font color="#FF0000">11</font><font color="#800080">) = </font><font color="#FF0000">0 </font><font color="#008000"><b>then
    return </b></font>TRUE
  <font color="#008000"><b>else
    return </b></font>FALSE
  <font color="#008000"><b>end if
else
  return </b></font>FALSE
<font color="#008000"><b>end if
end function
</b></font><font color="#808080"><i>------------------------------------------------------------------------------
-- digita um valor numerico ou uma string, necess&aacute;rio para retirar 
-- a nova linha das fun&ccedil;&otilde;es prompt_string e prompt_number
-- sRotulo - mostra o rotulo de entrada
-- bNum - se vai ser numero ou texto
-- retorna - o valor digitado
-- ----------------------------------------------------------------------------
</i></font><font color="#008000"><b>function </b></font>digita<font color="#800080">(</font><font color="#0000FF"><b>sequence </b></font>sRotulo<font color="#800080">, </font>boolean bNum<font color="#800080">)
</font><font color="#0000FF"><b>object </b></font>linha 
  <font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font>sRotulo<font color="#800080">)
  </font>linha <font color="#800080">= </font><font color="#0000FF"><b>gets</b></font><font color="#800080">(</font>STDIN<font color="#800080">)
  </font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font><font color="#008000"><i>&quot;\r&quot;</i></font><font color="#800080">) 
  </font>linha <font color="#800080">= </font>linha<font color="#800080">[</font><font color="#FF0000">1..</font><font color="#0000FF"><b>length</b></font><font color="#800080">(</font>linha<font color="#800080">)-</font><font color="#FF0000">1</font><font color="#800080">]
  </font><font color="#008000"><b>if </b></font>bNum <font color="#008000"><b>then
    </b></font>linha <font color="#800080">= </font><font color="#0000FF">value</font><font color="#800080">(</font>linha<font color="#800080">)
    </font><font color="#008000"><b>if </b></font>linha<font color="#800080">[</font><font color="#FF0000">1</font><font color="#800080">] = </font>GET_SUCCESS <font color="#008000"><b>then
      return </b></font>linha<font color="#800080">[</font><font color="#FF0000">2</font><font color="#800080">]
    </font><font color="#008000"><b>else
      return </b></font><font color="#800080">-</font><font color="#FF0000">1
    </font><font color="#008000"><b>end if
  else
    return </b></font>linha
  <font color="#008000"><b>end if
end function
</b></font><font color="#808080"><i>------------------------------------------------------------------------------
-- Esconde a digita&ccedil;&atilde;o da senha
-- retorna - a senha digitada
-- ----------------------------------------------------------------------------
</i></font><font color="#008000"><b>function </b></font>digitaSenha<font color="#800080">(</font><font color="#0000FF"><b>sequence </b></font>sRotulo<font color="#800080">, </font><font color="#0000FF"><b>integer </b></font>nTamSenha<font color="#800080">)
</font><font color="#0000FF"><b>sequence </b></font>sSenha
<font color="#0000FF"><b>integer </b></font>sLetra<font color="#800080">, </font>ncont

<font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font>sRotulo<font color="#800080">)
</font><font color="#808080"><i>-- sSenha = digita(sRotulo, FALSE)
  </i></font>ncont <font color="#800080">= </font><font color="#FF0000">0
  </font>sSenha<font color="#800080">={}
  </font>sLetra<font color="#800080">=</font><font color="#FF0000">0
  </font><font color="#008000"><b>while</b></font><font color="#800080">((</font>sLetra<font color="#800080">!='\</font>r<font color="#800080">') </font><font color="#008000"><b>and </b></font><font color="#800080">(</font>ncont <font color="#800080">&lt; </font>nTamSenha<font color="#800080">)) </font><font color="#008000"><b>do
    </b></font>sLetra<font color="#800080">=</font><font color="#0000FF">wait_key</font><font color="#800080">()
    </font><font color="#008000"><b>if </b></font>sLetra<font color="#800080">!='\</font>r<font color="#800080">' </font><font color="#008000"><b>then
      </b></font>sSenha<font color="#800080">= </font><font color="#0000FF"><b>append</b></font><font color="#800080">(</font>sSenha<font color="#800080">, </font>sLetra<font color="#800080">)
    </font><font color="#008000"><b>end if
    </b></font>ncont<font color="#800080">=</font>ncont<font color="#800080">+</font><font color="#FF0000">1
  </font><font color="#008000"><b>end while
return </b></font>sSenha
<font color="#008000"><b>end function
</b></font><font color="#808080"><i>-- ----------------------------------------------------------------------------
-- Valida&ccedil;&atilde;o de um n&uacute;mero qualquer.
-- sRotulo - o texto antes de se digitar o n&uacute;mero
-- sNumero - a mstring com o valor do n&uacute;mero
-- retorna - o sNumero
-- ----------------------------------------------------------------------------
</i></font><font color="#008000"><b>function </b></font>validaNumero<font color="#800080">(</font><font color="#0000FF"><b>sequence </b></font>sRotulo<font color="#800080">, </font><font color="#0000FF"><b>sequence </b></font>sNumero<font color="#800080">)
</font><font color="#0000FF"><b>atom </b></font>nnum
<font color="#0000FF"><b>integer </b></font>nStatus 

nStatus<font color="#800080">=-</font><font color="#FF0000">1
</font><font color="#008000"><b>while </b></font><font color="#800080">(</font>nStatus<font color="#800080">!=</font><font color="#FF0000">0</font><font color="#800080">) </font><font color="#008000"><b>do
  </b></font>nnum <font color="#800080">= </font>digita<font color="#800080">(</font>sRotulo<font color="#800080">, </font>TRUE<font color="#800080">)
  </font><font color="#008000"><b>if </b></font>nnum <font color="#800080">&lt; </font><font color="#FF0000">0.01 </font><font color="#008000"><b>then
    </b></font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDERR<font color="#800080">, </font>MSG_NUMINV<font color="#800080">)
  </font><font color="#008000"><b>else
    </b></font>nStatus <font color="#800080">= </font><font color="#FF0000">0
  </font><font color="#008000"><b>end if
end while
</b></font>sNumero <font color="#800080">= </font>NumToStr<font color="#800080">(</font>nnum<font color="#800080">)
</font><font color="#008000"><b>return </b></font>sNumero
<font color="#008000"><b>end function
</b></font><font color="#808080"><i>-- ----------------------------------------------------------------------------
-- Valida&ccedil;&atilde;o de uma data ou data/hora qualquer.
-- sRotulo - o texto antes de se digitar a data/hora
-- sDataHora - a mstring com o valor da data/hora
-- bSoData - indica se vai validar somente uma data sem a hora
-- retorna - a sDataHora
-- ----------------------------------------------------------------------------
</i></font><font color="#008000"><b>function </b></font>validaDataHora<font color="#800080">(</font><font color="#0000FF"><b>sequence </b></font>sRotulo<font color="#800080">, </font><font color="#0000FF"><b>sequence </b></font>sDataHora<font color="#800080">, 
</font>	boolean bSoData<font color="#800080">)
</font>boolean bvalida<font color="#800080">, </font>bdatavalida<font color="#800080">, </font>bhoravalida
<font color="#0000FF"><b>sequence </b></font>sdia<font color="#800080">, </font>smes<font color="#800080">, </font>sano<font color="#800080">, </font>shora<font color="#800080">, </font>smin<font color="#800080">, </font>sseg
<font color="#0000FF"><b>integer </b></font>ndia<font color="#800080">, </font>nmes<font color="#800080">, </font>nano<font color="#800080">, </font>nhora<font color="#800080">, </font>nmin<font color="#800080">, </font>nseg<font color="#800080">, </font>nudiames<font color="#800080">, </font>ntam

bvalida<font color="#800080">=</font>FALSE
bdatavalida<font color="#800080">=</font>FALSE
bhoravalida<font color="#800080">=</font>FALSE
nudiames<font color="#800080">=</font><font color="#FF0000">0

</font><font color="#008000"><b>if </b></font>bSoData<font color="#800080">=</font>TRUE <font color="#008000"><b>then </b></font>ntam<font color="#800080">=</font><font color="#FF0000">10
</font><font color="#008000"><b>else </b></font>ntam<font color="#800080">=</font><font color="#FF0000">19
</font><font color="#008000"><b>end if
while </b></font><font color="#800080">(</font>bvalida<font color="#800080">=</font>FALSE<font color="#800080">) </font><font color="#008000"><b>do
  </b></font>sDataHora <font color="#800080">= </font>digita<font color="#800080">(</font>sRotulo<font color="#800080">, </font>FALSE<font color="#800080">)
  </font><font color="#008000"><b>if </b></font><font color="#0000FF"><b>length</b></font><font color="#800080">(</font>sDataHora<font color="#800080">)=</font>ntam <font color="#008000"><b>then
    </b></font>sdia<font color="#800080">=</font>copy<font color="#800080">(</font>sDataHora<font color="#800080">,</font><font color="#FF0000">1</font><font color="#800080">,</font><font color="#FF0000">2</font><font color="#800080">)
    </font>ndia<font color="#800080">=</font>StrToNum<font color="#800080">(</font>sdia<font color="#800080">)
    </font>smes<font color="#800080">=</font>copy<font color="#800080">(</font>sDataHora<font color="#800080">,</font><font color="#FF0000">4</font><font color="#800080">,</font><font color="#FF0000">2</font><font color="#800080">)
    </font>nmes<font color="#800080">=</font>StrToNum<font color="#800080">(</font>smes<font color="#800080">)
    </font>sano<font color="#800080">=</font>copy<font color="#800080">(</font>sDataHora<font color="#800080">,</font><font color="#FF0000">7</font><font color="#800080">,</font><font color="#FF0000">4</font><font color="#800080">)
    </font>nano<font color="#800080">=</font>StrToNum<font color="#800080">(</font>sano<font color="#800080">)
  
    </font><font color="#008000"><b>if </b></font><font color="#800080">(</font>nano <font color="#800080">&gt;= </font><font color="#FF0000">1</font><font color="#800080">) </font><font color="#008000"><b>and </b></font><font color="#800080">(</font>nano <font color="#800080">&lt;= </font><font color="#FF0000">9999</font><font color="#800080">) </font><font color="#008000"><b>then
      if </b></font><font color="#800080">(</font>nmes <font color="#800080">&gt;= </font><font color="#FF0000">1</font><font color="#800080">) </font><font color="#008000"><b>and </b></font><font color="#800080">(</font>nmes <font color="#800080">&lt;= </font><font color="#FF0000">31</font><font color="#800080">) </font><font color="#008000"><b>then
          if </b></font>nmes<font color="#800080">=</font><font color="#FF0000">1 </font><font color="#008000"><b>or </b></font>nmes<font color="#800080">=</font><font color="#FF0000">3 </font><font color="#008000"><b>or </b></font>nmes<font color="#800080">=</font><font color="#FF0000">5 </font><font color="#008000"><b>or </b></font>nmes<font color="#800080">=</font><font color="#FF0000">7 </font><font color="#008000"><b>or 
</b></font>	     nmes<font color="#800080">=</font><font color="#FF0000">8 </font><font color="#008000"><b>or </b></font>nmes<font color="#800080">=</font><font color="#FF0000">10 </font><font color="#008000"><b>or </b></font>nmes<font color="#800080">=</font><font color="#FF0000">12 </font><font color="#008000"><b>then 
             </b></font>nudiames<font color="#800080">=</font><font color="#FF0000">31
          </font><font color="#008000"><b>elsif </b></font>nmes<font color="#800080">=</font><font color="#FF0000">2 </font><font color="#008000"><b>then
             </b></font><font color="#808080"><i>-- ano bisexto
             </i></font><font color="#008000"><b>if </b></font><font color="#0000FF"><b>remainder</b></font><font color="#800080">(</font>nano<font color="#800080">, </font><font color="#FF0000">4</font><font color="#800080">)=</font><font color="#FF0000">0 </font><font color="#008000"><b>then </b></font>nudiames<font color="#800080">=</font><font color="#FF0000">29
             </font><font color="#008000"><b>else </b></font>nudiames<font color="#800080">=</font><font color="#FF0000">28
             </font><font color="#008000"><b>end if
          elsif </b></font>nmes<font color="#800080">=</font><font color="#FF0000">4 </font><font color="#008000"><b>or </b></font>nmes<font color="#800080">=</font><font color="#FF0000">6 </font><font color="#008000"><b>or </b></font>nmes<font color="#800080">=</font><font color="#FF0000">9 </font><font color="#008000"><b>or </b></font>nmes<font color="#800080">=</font><font color="#FF0000">11 </font><font color="#008000"><b>then 
             </b></font>nudiames<font color="#800080">=</font><font color="#FF0000">30
          </font><font color="#008000"><b>end if
          if </b></font><font color="#800080">(</font>ndia <font color="#800080">&gt;=</font><font color="#FF0000">1</font><font color="#800080">) </font><font color="#008000"><b>and </b></font><font color="#800080">(</font>ndia <font color="#800080">&lt;=</font>nudiames<font color="#800080">) </font><font color="#008000"><b>then
             </b></font>bdatavalida<font color="#800080">=</font>TRUE
          <font color="#008000"><b>end if
      end if
    end if
  
    if </b></font>bSoData<font color="#800080">=</font>TRUE <font color="#008000"><b>then
       if </b></font>bdatavalida<font color="#800080">=</font>TRUE <font color="#008000"><b>then </b></font>bvalida<font color="#800080">=</font>TRUE
       <font color="#008000"><b>else </b></font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDERR<font color="#800080">, </font>MSG_DATAINV<font color="#800080">)
       </font><font color="#008000"><b>end if
    else
      if </b></font>bdatavalida<font color="#800080">=</font>TRUE <font color="#008000"><b>then
          </b></font>shora<font color="#800080">=</font>copy<font color="#800080">(</font>sDataHora<font color="#800080">,</font><font color="#FF0000">12</font><font color="#800080">,</font><font color="#FF0000">2</font><font color="#800080">)
          </font>nhora<font color="#800080">=</font>StrToNum<font color="#800080">(</font>shora<font color="#800080">)
          </font>smin<font color="#800080">=</font>copy<font color="#800080">(</font>sDataHora<font color="#800080">,</font><font color="#FF0000">15</font><font color="#800080">,</font><font color="#FF0000">2</font><font color="#800080">)
          </font>nmin<font color="#800080">=</font>StrToNum<font color="#800080">(</font>smin<font color="#800080">)
          </font>sseg<font color="#800080">=</font>copy<font color="#800080">(</font>sDataHora<font color="#800080">,</font><font color="#FF0000">18</font><font color="#800080">,</font><font color="#FF0000">2</font><font color="#800080">)
          </font>nseg<font color="#800080">=</font>StrToNum<font color="#800080">(</font>sseg<font color="#800080">)
  
          </font><font color="#008000"><b>if </b></font><font color="#800080">(</font>nhora <font color="#800080">&gt;= </font><font color="#FF0000">0</font><font color="#800080">) </font><font color="#008000"><b>and </b></font><font color="#800080">(</font>nhora <font color="#800080">&lt;= </font><font color="#FF0000">23</font><font color="#800080">) </font><font color="#008000"><b>then
            if </b></font><font color="#800080">(</font>nmin <font color="#800080">&gt;= </font><font color="#FF0000">0</font><font color="#800080">) </font><font color="#008000"><b>and </b></font><font color="#800080">(</font>nmin <font color="#800080">&lt;= </font><font color="#FF0000">59</font><font color="#800080">) </font><font color="#008000"><b>then
              if </b></font><font color="#800080">(</font>nseg <font color="#800080">&gt;= </font><font color="#FF0000">0</font><font color="#800080">) </font><font color="#008000"><b>and </b></font><font color="#800080">(</font>nseg <font color="#800080">&lt;= </font><font color="#FF0000">59</font><font color="#800080">) </font><font color="#008000"><b>then
                 </b></font>bhoravalida<font color="#800080">=</font>TRUE
              <font color="#008000"><b>end if
            end if
          end if
  
          if </b></font>bhoravalida<font color="#800080">=</font>TRUE <font color="#008000"><b>then </b></font>bvalida<font color="#800080">=</font>TRUE
          <font color="#008000"><b>else </b></font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDERR<font color="#800080">, </font>MSG_DTHRINV<font color="#800080">)
          </font><font color="#008000"><b>end if 
      else
        </b></font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDERR<font color="#800080">, </font>MSG_DTHRINV<font color="#800080">)
      </font><font color="#008000"><b>end if
    end if
  else
    if </b></font>bSoData<font color="#800080">=</font>TRUE <font color="#008000"><b>then </b></font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDERR<font color="#800080">, </font>MSG_DATAINV<font color="#800080">)
    </font><font color="#008000"><b>else </b></font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDERR<font color="#800080">, </font>MSG_DTHRINV<font color="#800080">)
    </font><font color="#008000"><b>end if
  end if
end while
return </b></font>sDataHora
<font color="#008000"><b>end function
</b></font><font color="#808080"><i>-- ----------------------------------------------------------------------------
-- Retorna a Data e a hora do sistema.
-- retorna - a data e a hora
-- ----------------------------------------------------------------------------
</i></font><font color="#008000"><b>function </b></font>retDataHora<font color="#800080">()
</font><font color="#0000FF"><b>integer </b></font>y<font color="#800080">, </font>m<font color="#800080">, </font>d<font color="#800080">, </font>h<font color="#800080">, </font>mn<font color="#800080">, </font>s
<font color="#0000FF"><b>sequence </b></font>dia<font color="#800080">, </font>mes<font color="#800080">, </font>ano<font color="#800080">, </font>hora<font color="#800080">, </font>min<font color="#800080">, </font>seg<font color="#800080">, </font>stempo<font color="#800080">, </font>sdatahora 

stempo <font color="#800080">= </font><font color="#0000FF"><b>date</b></font><font color="#800080">()
</font>y <font color="#800080">= </font>stempo<font color="#800080">[</font><font color="#FF0000">1</font><font color="#800080">]
</font>y <font color="#800080">= </font>y <font color="#800080">+ </font><font color="#FF0000">1900 
</font>ano <font color="#800080">= </font>NumToStr<font color="#800080">(</font>y<font color="#800080">)
</font>m <font color="#800080">= </font>stempo<font color="#800080">[</font><font color="#FF0000">2</font><font color="#800080">]
</font>mes <font color="#800080">= </font>NumToStr<font color="#800080">(</font>m<font color="#800080">)
</font><font color="#008000"><b>if </b></font><font color="#800080">(</font>m <font color="#800080">&lt; </font><font color="#FF0000">10</font><font color="#800080">) </font><font color="#008000"><b>then 
  </b></font>mes <font color="#800080">= </font><font color="#008000"><i>&quot;0&quot; </i></font><font color="#800080">&amp; </font>mes 
<font color="#008000"><b>end if
</b></font>d <font color="#800080">= </font>stempo<font color="#800080">[</font><font color="#FF0000">3</font><font color="#800080">]
</font>dia <font color="#800080">= </font>NumToStr<font color="#800080">(</font>d<font color="#800080">)
</font><font color="#008000"><b>if </b></font><font color="#800080">(</font>d <font color="#800080">&lt; </font><font color="#FF0000">10</font><font color="#800080">) </font><font color="#008000"><b>then 
  </b></font>dia <font color="#800080">= </font><font color="#008000"><i>&quot;0&quot; </i></font><font color="#800080">&amp; </font>dia 
<font color="#008000"><b>end if 
</b></font>h <font color="#800080">= </font>stempo<font color="#800080">[</font><font color="#FF0000">4</font><font color="#800080">]
</font>hora <font color="#800080">= </font>NumToStr<font color="#800080">(</font>h<font color="#800080">)
</font><font color="#008000"><b>if </b></font><font color="#800080">(</font>h <font color="#800080">&lt; </font><font color="#FF0000">10</font><font color="#800080">) </font><font color="#008000"><b>then 
  </b></font>hora <font color="#800080">= </font><font color="#008000"><i>&quot;0&quot; </i></font><font color="#800080">&amp; </font>hora
<font color="#008000"><b>end if 
</b></font>mn <font color="#800080">= </font>stempo<font color="#800080">[</font><font color="#FF0000">5</font><font color="#800080">]
</font>min <font color="#800080">= </font>NumToStr<font color="#800080">(</font>mn<font color="#800080">)
</font><font color="#008000"><b>if </b></font><font color="#800080">(</font>mn <font color="#800080">&lt; </font><font color="#FF0000">10</font><font color="#800080">) </font><font color="#008000"><b>then 
  </b></font>min <font color="#800080">= </font><font color="#008000"><i>&quot;0&quot; </i></font><font color="#800080">&amp; </font>min
<font color="#008000"><b>end if 
</b></font>s <font color="#800080">= </font>stempo<font color="#800080">[</font><font color="#FF0000">6</font><font color="#800080">]
</font>seg <font color="#800080">= </font>NumToStr<font color="#800080">(</font>s<font color="#800080">)
</font><font color="#008000"><b>if </b></font><font color="#800080">(</font>s <font color="#800080">&lt; </font><font color="#FF0000">10</font><font color="#800080">) </font><font color="#008000"><b>then 
  </b></font>seg <font color="#800080">= </font><font color="#008000"><i>&quot;0&quot; </i></font><font color="#800080">&amp; </font>seg 
<font color="#008000"><b>end if 
</b></font>sdatahora <font color="#800080">= </font>dia <font color="#800080">&amp; </font><font color="#008000"><i>&quot;/&quot; </i></font><font color="#800080">&amp; </font>mes <font color="#800080">&amp; </font><font color="#008000"><i>&quot;/&quot; </i></font><font color="#800080">&amp; </font>ano <font color="#800080">&amp; </font><font color="#008000"><i>&quot; &quot; </i></font><font color="#800080">&amp; </font>hora <font color="#800080">&amp; </font><font color="#008000"><i>&quot;:&quot; </i></font><font color="#800080">&amp; </font>min <font color="#800080">&amp; </font><font color="#008000"><i>&quot;:&quot; </i></font><font color="#800080">&amp; </font>seg
<font color="#008000"><b>return </b></font>sdatahora
<font color="#008000"><b>end function

</b></font><font color="#808080"><i>-- --- Rotinas de manipula&ccedil;&atilde;o de arquivos -------------------------------------

-- ----------------------------------------------------------------------------
-- Calcula o tamanho do arquivo.
-- sArq - o arquivo
-- retorna - o tamanho do arquivo
-- ----------------------------------------------------------------------------
</i></font><font color="#008000"><b>function </b></font>tamArq<font color="#800080">(</font>tarquivo sArq<font color="#800080">)
</font><font color="#0000FF"><b>integer </b></font>ntam<font color="#800080">, </font>nstatus

nstatus <font color="#800080">= </font><font color="#0000FF">seek</font><font color="#800080">(</font>sArq <font color="#800080">, -</font><font color="#FF0000">1</font><font color="#800080">)
</font>ntam <font color="#800080">= </font><font color="#0000FF">where</font><font color="#800080">(</font>sArq<font color="#800080">)
</font>nstatus <font color="#800080">= </font><font color="#0000FF">seek</font><font color="#800080">(</font>sArq <font color="#800080">, </font><font color="#FF0000">0</font><font color="#800080">)
</font><font color="#008000"><b>return </b></font>ntam
<font color="#008000"><b>end function
</b></font><font color="#808080"><i>-- ----------------------------------------------------------------------------
-- Abre ou cria os arquivos do sistema.
-- bAbre - condi&ccedil;&atilde;o para abrir ou criar os arquivos do sistema
-- ----------------------------------------------------------------------------
</i></font><font color="#008000"><b>procedure </b></font>abrecriaArqs<font color="#800080">(</font>boolean bAbre<font color="#800080">)

</font><font color="#008000"><b>if </b></font>bAbre <font color="#800080">= </font>TRUE <font color="#008000"><b>then
  </b></font>tfAssunto <font color="#800080">= </font><font color="#0000FF"><b>open</b></font><font color="#800080">(</font>ARQ_ASSUNTO<font color="#800080">,</font>ARQ_ABRE<font color="#800080">)
  </font><font color="#008000"><b>if </b></font>tfAssunto <font color="#800080">= -</font><font color="#FF0000">1 </font><font color="#008000"><b>then
    </b></font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDERR<font color="#800080">, </font>MSG_ARQERRO <font color="#800080">&amp; </font><font color="#008000"><i>&quot; --&gt; &quot; </i></font><font color="#800080">&amp; </font>ARQ_ASSUNTO <font color="#800080">&amp; </font><font color="#008000"><i>&quot;\n&quot;</i></font><font color="#800080">)
    </font><font color="#0000FF"><b>abort</b></font><font color="#800080">(</font><font color="#FF0000">1</font><font color="#800080">)
  </font><font color="#008000"><b>end if
  </b></font>tfAutor <font color="#800080">= </font><font color="#0000FF"><b>open</b></font><font color="#800080">(</font>ARQ_AUTOR<font color="#800080">,</font>ARQ_ABRE<font color="#800080">)
  </font><font color="#008000"><b>if </b></font>tfAutor <font color="#800080">= -</font><font color="#FF0000">1 </font><font color="#008000"><b>then
    </b></font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDERR<font color="#800080">, </font>MSG_ARQERRO <font color="#800080">&amp; </font><font color="#008000"><i>&quot; --&gt; &quot; </i></font><font color="#800080">&amp; </font>ARQ_AUTOR <font color="#800080">&amp; </font><font color="#008000"><i>&quot;\n&quot;</i></font><font color="#800080">)
    </font><font color="#0000FF"><b>abort</b></font><font color="#800080">(</font><font color="#FF0000">1</font><font color="#800080">)
  </font><font color="#008000"><b>end if
  </b></font>tfEditora <font color="#800080">= </font><font color="#0000FF"><b>open</b></font><font color="#800080">(</font>ARQ_EDITORA<font color="#800080">,</font>ARQ_ABRE<font color="#800080">)
  </font><font color="#008000"><b>if </b></font>tfEditora <font color="#800080">= -</font><font color="#FF0000">1 </font><font color="#008000"><b>then
    </b></font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDERR<font color="#800080">, </font>MSG_ARQERRO <font color="#800080">&amp; </font><font color="#008000"><i>&quot; --&gt; &quot; </i></font><font color="#800080">&amp; </font>ARQ_EDITORA <font color="#800080">&amp; </font><font color="#008000"><i>&quot;\n&quot;</i></font><font color="#800080">)
    </font><font color="#0000FF"><b>abort</b></font><font color="#800080">(</font><font color="#FF0000">1</font><font color="#800080">)
  </font><font color="#008000"><b>end if
  </b></font>tfIdioma <font color="#800080">= </font><font color="#0000FF"><b>open</b></font><font color="#800080">(</font>ARQ_IDIOMA<font color="#800080">,</font>ARQ_ABRE<font color="#800080">)
  </font><font color="#008000"><b>if </b></font>tfIdioma <font color="#800080">= -</font><font color="#FF0000">1 </font><font color="#008000"><b>then
    </b></font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDERR<font color="#800080">, </font>MSG_ARQERRO <font color="#800080">&amp; </font><font color="#008000"><i>&quot; --&gt; &quot; </i></font><font color="#800080">&amp; </font>ARQ_IDIOMA <font color="#800080">&amp; </font><font color="#008000"><i>&quot;\n&quot;</i></font><font color="#800080">)
    </font><font color="#0000FF"><b>abort</b></font><font color="#800080">(</font><font color="#FF0000">1</font><font color="#800080">)
  </font><font color="#008000"><b>end if
  </b></font>tfEndereco <font color="#800080">= </font><font color="#0000FF"><b>open</b></font><font color="#800080">(</font>ARQ_ENDERECO<font color="#800080">,</font>ARQ_ABRE<font color="#800080">)
  </font><font color="#008000"><b>if </b></font>tfEndereco <font color="#800080">= -</font><font color="#FF0000">1 </font><font color="#008000"><b>then
    </b></font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDERR<font color="#800080">, </font>MSG_ARQERRO <font color="#800080">&amp; </font><font color="#008000"><i>&quot; --&gt; &quot; </i></font><font color="#800080">&amp; </font>ARQ_ENDERECO <font color="#800080">&amp; </font><font color="#008000"><i>&quot;\n&quot;</i></font><font color="#800080">)
    </font><font color="#0000FF"><b>abort</b></font><font color="#800080">(</font><font color="#FF0000">1</font><font color="#800080">)
  </font><font color="#008000"><b>end if
  </b></font>tfPais <font color="#800080">= </font><font color="#0000FF"><b>open</b></font><font color="#800080">(</font>ARQ_PAIS<font color="#800080">,</font>ARQ_ABRE<font color="#800080">)
  </font><font color="#008000"><b>if </b></font>tfPais <font color="#800080">= -</font><font color="#FF0000">1 </font><font color="#008000"><b>then
    </b></font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDERR<font color="#800080">, </font>MSG_ARQERRO <font color="#800080">&amp; </font><font color="#008000"><i>&quot; --&gt; &quot; </i></font><font color="#800080">&amp; </font>ARQ_PAIS <font color="#800080">&amp; </font><font color="#008000"><i>&quot;\n&quot;</i></font><font color="#800080">)
    </font><font color="#0000FF"><b>abort</b></font><font color="#800080">(</font><font color="#FF0000">1</font><font color="#800080">)
  </font><font color="#008000"><b>end if
  </b></font>tfProfissao <font color="#800080">= </font><font color="#0000FF"><b>open</b></font><font color="#800080">(</font>ARQ_PROFISSAO<font color="#800080">,</font>ARQ_ABRE<font color="#800080">)
  </font><font color="#008000"><b>if </b></font>tfProfissao <font color="#800080">= -</font><font color="#FF0000">1 </font><font color="#008000"><b>then
    </b></font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDERR<font color="#800080">, </font>MSG_ARQERRO <font color="#800080">&amp; </font><font color="#008000"><i>&quot; --&gt; &quot; </i></font><font color="#800080">&amp; </font>ARQ_PROFISSAO <font color="#800080">&amp; </font><font color="#008000"><i>&quot;\n&quot;</i></font><font color="#800080">)
    </font><font color="#0000FF"><b>abort</b></font><font color="#800080">(</font><font color="#FF0000">1</font><font color="#800080">)
  </font><font color="#008000"><b>end if
  </b></font>tfLivro <font color="#800080">= </font><font color="#0000FF"><b>open</b></font><font color="#800080">(</font>ARQ_LIVRO<font color="#800080">,</font>ARQ_ABRE<font color="#800080">)
  </font><font color="#008000"><b>if </b></font>tfLivro <font color="#800080">= -</font><font color="#FF0000">1 </font><font color="#008000"><b>then
    </b></font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDERR<font color="#800080">, </font>MSG_ARQERRO <font color="#800080">&amp; </font><font color="#008000"><i>&quot; --&gt; &quot; </i></font><font color="#800080">&amp; </font>ARQ_LIVRO <font color="#800080">&amp; </font><font color="#008000"><i>&quot;\n&quot;</i></font><font color="#800080">)
    </font><font color="#0000FF"><b>abort</b></font><font color="#800080">(</font><font color="#FF0000">1</font><font color="#800080">)
  </font><font color="#008000"><b>end if
  </b></font>tfLivroAss <font color="#800080">= </font><font color="#0000FF"><b>open</b></font><font color="#800080">(</font>ARQ_LIVASS<font color="#800080">,</font>ARQ_ABRE<font color="#800080">)
  </font><font color="#008000"><b>if </b></font>tfLivroAss <font color="#800080">= -</font><font color="#FF0000">1 </font><font color="#008000"><b>then
    </b></font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDERR<font color="#800080">, </font>MSG_ARQERRO <font color="#800080">&amp; </font><font color="#008000"><i>&quot; --&gt; &quot; </i></font><font color="#800080">&amp; </font>ARQ_LIVASS <font color="#800080">&amp; </font><font color="#008000"><i>&quot;\n&quot;</i></font><font color="#800080">)
    </font><font color="#0000FF"><b>abort</b></font><font color="#800080">(</font><font color="#FF0000">1</font><font color="#800080">)
  </font><font color="#008000"><b>end if
  </b></font>tfLivroAut <font color="#800080">= </font><font color="#0000FF"><b>open</b></font><font color="#800080">(</font>ARQ_LIVAUT<font color="#800080">,</font>ARQ_ABRE<font color="#800080">)
  </font><font color="#008000"><b>if </b></font>tfLivroAut <font color="#800080">= -</font><font color="#FF0000">1 </font><font color="#008000"><b>then
    </b></font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDERR<font color="#800080">, </font>MSG_ARQERRO <font color="#800080">&amp; </font><font color="#008000"><i>&quot; --&gt; &quot; </i></font><font color="#800080">&amp; </font>ARQ_LIVAUT <font color="#800080">&amp; </font><font color="#008000"><i>&quot;\n&quot;</i></font><font color="#800080">)
    </font><font color="#0000FF"><b>abort</b></font><font color="#800080">(</font><font color="#FF0000">1</font><font color="#800080">)
  </font><font color="#008000"><b>end if
  </b></font>tfCliente <font color="#800080">= </font><font color="#0000FF"><b>open</b></font><font color="#800080">(</font>ARQ_CLIENTE<font color="#800080">,</font>ARQ_ABRE<font color="#800080">)
  </font><font color="#008000"><b>if </b></font>tfCliente <font color="#800080">= -</font><font color="#FF0000">1 </font><font color="#008000"><b>then
    </b></font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDERR<font color="#800080">, </font>MSG_ARQERRO <font color="#800080">&amp; </font><font color="#008000"><i>&quot; --&gt; &quot; </i></font><font color="#800080">&amp; </font>ARQ_CLIENTE <font color="#800080">&amp; </font><font color="#008000"><i>&quot;\n&quot;</i></font><font color="#800080">)
    </font><font color="#0000FF"><b>abort</b></font><font color="#800080">(</font><font color="#FF0000">1</font><font color="#800080">)
  </font><font color="#008000"><b>end if
  </b></font>tfUsuario <font color="#800080">= </font><font color="#0000FF"><b>open</b></font><font color="#800080">(</font>ARQ_USUARIO<font color="#800080">,</font>ARQ_ABRE<font color="#800080">)
  </font><font color="#008000"><b>if </b></font>tfUsuario <font color="#800080">= -</font><font color="#FF0000">1 </font><font color="#008000"><b>then
    </b></font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDERR<font color="#800080">, </font>MSG_ARQERRO <font color="#800080">&amp; </font><font color="#008000"><i>&quot; --&gt; &quot; </i></font><font color="#800080">&amp; </font>ARQ_USUARIO <font color="#800080">&amp; </font><font color="#008000"><i>&quot;\n&quot;</i></font><font color="#800080">)
    </font><font color="#0000FF"><b>abort</b></font><font color="#800080">(</font><font color="#FF0000">1</font><font color="#800080">)
  </font><font color="#008000"><b>end if
  </b></font>tfVenda <font color="#800080">= </font><font color="#0000FF"><b>open</b></font><font color="#800080">(</font>ARQ_VENDA<font color="#800080">,</font>ARQ_ABRE<font color="#800080">)
  </font><font color="#008000"><b>if </b></font>tfVenda <font color="#800080">= -</font><font color="#FF0000">1 </font><font color="#008000"><b>then
    </b></font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDERR<font color="#800080">, </font>MSG_ARQERRO <font color="#800080">&amp; </font><font color="#008000"><i>&quot; --&gt; &quot; </i></font><font color="#800080">&amp; </font>ARQ_VENDA <font color="#800080">&amp; </font><font color="#008000"><i>&quot;\n&quot;</i></font><font color="#800080">)
    </font><font color="#0000FF"><b>abort</b></font><font color="#800080">(</font><font color="#FF0000">1</font><font color="#800080">)
  </font><font color="#008000"><b>end if
else
  </b></font>tfAssunto <font color="#800080">= </font><font color="#0000FF"><b>open</b></font><font color="#800080">(</font>ARQ_ASSUNTO<font color="#800080">,</font>ARQ_CRIA<font color="#800080">)
  </font>tfAutor <font color="#800080">= </font><font color="#0000FF"><b>open</b></font><font color="#800080">(</font>ARQ_AUTOR<font color="#800080">,</font>ARQ_CRIA<font color="#800080">)
  </font>tfEditora <font color="#800080">= </font><font color="#0000FF"><b>open</b></font><font color="#800080">(</font>ARQ_EDITORA<font color="#800080">,</font>ARQ_CRIA<font color="#800080">)
  </font>tfIdioma <font color="#800080">= </font><font color="#0000FF"><b>open</b></font><font color="#800080">(</font>ARQ_IDIOMA<font color="#800080">,</font>ARQ_CRIA<font color="#800080">)
  </font>tfEndereco <font color="#800080">= </font><font color="#0000FF"><b>open</b></font><font color="#800080">(</font>ARQ_ENDERECO<font color="#800080">,</font>ARQ_CRIA<font color="#800080">)
  </font>tfPais <font color="#800080">= </font><font color="#0000FF"><b>open</b></font><font color="#800080">(</font>ARQ_PAIS<font color="#800080">,</font>ARQ_CRIA<font color="#800080">)
  </font>tfProfissao <font color="#800080">= </font><font color="#0000FF"><b>open</b></font><font color="#800080">(</font>ARQ_PROFISSAO<font color="#800080">,</font>ARQ_CRIA<font color="#800080">)
  </font>tfLivro <font color="#800080">= </font><font color="#0000FF"><b>open</b></font><font color="#800080">(</font>ARQ_LIVRO<font color="#800080">,</font>ARQ_CRIA<font color="#800080">)
  </font>tfLivroAss <font color="#800080">= </font><font color="#0000FF"><b>open</b></font><font color="#800080">(</font>ARQ_LIVASS<font color="#800080">,</font>ARQ_CRIA<font color="#800080">)
  </font>tfLivroAut <font color="#800080">= </font><font color="#0000FF"><b>open</b></font><font color="#800080">(</font>ARQ_LIVAUT<font color="#800080">,</font>ARQ_CRIA<font color="#800080">)
  </font>tfCliente <font color="#800080">= </font><font color="#0000FF"><b>open</b></font><font color="#800080">(</font>ARQ_CLIENTE<font color="#800080">,</font>ARQ_CRIA<font color="#800080">)
  </font>tfUsuario <font color="#800080">= </font><font color="#0000FF"><b>open</b></font><font color="#800080">(</font>ARQ_USUARIO<font color="#800080">,</font>ARQ_CRIA<font color="#800080">)
  </font>tfVenda <font color="#800080">= </font><font color="#0000FF"><b>open</b></font><font color="#800080">(</font>ARQ_VENDA<font color="#800080">,</font>ARQ_CRIA<font color="#800080">)
</font><font color="#008000"><b>end if
end procedure
</b></font><font color="#808080"><i>-- ----------------------------------------------------------------------------
-- Fecha todos os arquivos abertos.
-- ----------------------------------------------------------------------------
</i></font><font color="#008000"><b>procedure </b></font>fechaArqs<font color="#800080">()
  </font><font color="#0000FF"><b>close</b></font><font color="#800080">(</font>tfAssunto<font color="#800080">)
  </font><font color="#0000FF"><b>close</b></font><font color="#800080">(</font>tfAutor<font color="#800080">)
  </font><font color="#0000FF"><b>close</b></font><font color="#800080">(</font>tfEditora<font color="#800080">)
  </font><font color="#0000FF"><b>close</b></font><font color="#800080">(</font>tfIdioma<font color="#800080">)
  </font><font color="#0000FF"><b>close</b></font><font color="#800080">(</font>tfEndereco<font color="#800080">)
  </font><font color="#0000FF"><b>close</b></font><font color="#800080">(</font>tfPais<font color="#800080">)
  </font><font color="#0000FF"><b>close</b></font><font color="#800080">(</font>tfProfissao<font color="#800080">)
  </font><font color="#0000FF"><b>close</b></font><font color="#800080">(</font>tfLivro<font color="#800080">)
  </font><font color="#0000FF"><b>close</b></font><font color="#800080">(</font>tfLivroAss<font color="#800080">)
  </font><font color="#0000FF"><b>close</b></font><font color="#800080">(</font>tfLivroAut<font color="#800080">)
  </font><font color="#0000FF"><b>close</b></font><font color="#800080">(</font>tfCliente<font color="#800080">)
  </font><font color="#0000FF"><b>close</b></font><font color="#800080">(</font>tfUsuario<font color="#800080">)
  </font><font color="#0000FF"><b>close</b></font><font color="#800080">(</font>tfVenda<font color="#800080">)
</font><font color="#008000"><b>end procedure
</b></font><font color="#808080"><i>-- ----------------------------------------------------------------------------
-- Pesquisa um registro atrav&eacute;s de um valor chave num arquivo.
-- sArq - o arquivo
-- sChave - a chave a ser pesquisada
-- nPosChave - a posicao inicial da chave dentro do registro
-- nTamChave - o tamanho da chave dentro do registro
-- nTamLinha - o tamanho do registro
-- retorna - o registro pesquisado
-- ----------------------------------------------------------------------------
</i></font><font color="#008000"><b>function </b></font>pesqArq<font color="#800080">(</font>tarquivo sArq<font color="#800080">, </font><font color="#0000FF"><b>sequence </b></font>sChave<font color="#800080">, </font><font color="#0000FF"><b>integer </b></font>nPosChave<font color="#800080">,
        </font><font color="#0000FF"><b>integer </b></font>nTamChave<font color="#800080">, </font><font color="#0000FF"><b>integer </b></font>nTamLinha<font color="#800080">)
</font><font color="#0000FF"><b>object </b></font>slinha
<font color="#0000FF"><b>sequence </b></font>sres<font color="#800080">, </font>slocal
boolean bQuebra
<font color="#0000FF"><b>integer </b></font>nPosicao<font color="#800080">, </font>nstatus

sres <font color="#800080">= </font><font color="#008000"><i>&quot;&quot;
</i></font>bQuebra <font color="#800080">= </font>FALSE
nstatus <font color="#800080">= </font><font color="#0000FF">seek</font><font color="#800080">(</font>sArq<font color="#800080">, </font><font color="#FF0000">0</font><font color="#800080">)
</font><font color="#008000"><b>while </b></font>bQuebra<font color="#800080">=</font>FALSE <font color="#008000"><b>do
  </b></font>slinha <font color="#800080">= </font><font color="#0000FF"><b>gets</b></font><font color="#800080">(</font>sArq<font color="#800080">)
  </font><font color="#008000"><b>if </b></font><font color="#0000FF"><b>atom</b></font><font color="#800080">(</font>slinha<font color="#800080">) </font><font color="#008000"><b>then
    exit 
  end if
  if </b></font><font color="#0000FF"><b>length</b></font><font color="#800080">(</font>slinha<font color="#800080">) &gt; </font><font color="#FF0000">0 </font><font color="#008000"><b>then
    </b></font>slocal <font color="#800080">= </font>slinha
    sres <font color="#800080">= </font>trim<font color="#800080">(</font>copy<font color="#800080">(</font>slocal<font color="#800080">,</font>nPosChave<font color="#800080">,</font>nTamChave<font color="#800080">))
    </font><font color="#008000"><b>if </b></font><font color="#0000FF"><b>equal</b></font><font color="#800080">(</font>sres<font color="#800080">, </font>sChave<font color="#800080">) </font><font color="#008000"><b>then
       </b></font>bQuebra <font color="#800080">= </font>TRUE
    <font color="#008000"><b>end if
  end if
end while
</b></font>nPosicao <font color="#800080">= </font><font color="#0000FF">where</font><font color="#800080">(</font>sArq<font color="#800080">)-(</font>nTamLinha <font color="#800080">+ </font>TAM_CRLF<font color="#800080">)
</font><font color="#008000"><b>if </b></font>nPosicao <font color="#800080">&gt; </font><font color="#FF0000">0 </font><font color="#008000"><b>then
  </b></font>nstatus <font color="#800080">= </font><font color="#0000FF">seek</font><font color="#800080">(</font>sArq<font color="#800080">, </font>nPosicao<font color="#800080">)
</font><font color="#008000"><b>else
  </b></font>nstatus <font color="#800080">= </font><font color="#0000FF">seek</font><font color="#800080">(</font>sArq<font color="#800080">, </font><font color="#FF0000">0</font><font color="#800080">)
</font><font color="#008000"><b>end if
if </b></font><font color="#0000FF"><b>equal</b></font><font color="#800080">(</font>sres<font color="#800080">, </font>sChave<font color="#800080">)=</font>FALSE <font color="#008000"><b>then
   return </b><i>&quot;&quot;
</i><b>else
   return </b></font>copy<font color="#800080">(</font>slocal<font color="#800080">,</font><font color="#FF0000">1</font><font color="#800080">,</font>nTamLinha<font color="#800080">)
</font><font color="#008000"><b>end if
end function
</b></font><font color="#808080"><i>-- ----------------------------------------------------------------------------
-- Pesquisa se tem linha exclu&iacute;da sen&atilde;o vai para a &uacute;ltima linha do arquivo.
-- sArq - o arquivo
-- nTamLinha - o tamanho do registro
-- ----------------------------------------------------------------------------
</i></font><font color="#008000"><b>procedure </b></font>pesqLinhaExcluida<font color="#800080">(</font>tarquivo sArq<font color="#800080">, </font><font color="#0000FF"><b>integer </b></font>nTamLinha<font color="#800080">)
</font><font color="#0000FF"><b>sequence </b></font>sExcluido
<font color="#0000FF"><b>integer </b></font>nstatus

sExcluido <font color="#800080">= </font>pesqArq<font color="#800080">(</font>sArq<font color="#800080">, </font><font color="#008000"><i>&quot;*&quot;</i></font><font color="#800080">, </font><font color="#FF0000">1</font><font color="#800080">, </font><font color="#FF0000">1</font><font color="#800080">, </font>nTamLinha<font color="#800080">)
</font><font color="#008000"><b>if </b></font><font color="#0000FF"><b>equal</b></font><font color="#800080">(</font>sExcluido<font color="#800080">,</font><font color="#008000"><i>&quot;&quot;</i></font><font color="#800080">) </font><font color="#008000"><b>then
   </b></font>nstatus <font color="#800080">= </font><font color="#0000FF">seek</font><font color="#800080">(</font>sArq<font color="#800080">, </font>tamArq<font color="#800080">(</font>sArq<font color="#800080">))
</font><font color="#008000"><b>end if
end procedure
</b></font><font color="#808080"><i>-- ----------------------------------------------------------------------------
-- Pesquisa o maior c&oacute;digo num arquivo.
-- sArq - o arquivo
-- nPosChave - a posicao inicial da chave dentro do registro
-- nTamChave - o tamanho da chave dentro do registro
-- nTamLinha - o tamanho do registro
-- retorna - o maior c&oacute;digo
-- ----------------------------------------------------------------------------
</i></font><font color="#008000"><b>function </b></font>pesqMaxCod<font color="#800080">(</font>tarquivo sArq<font color="#800080">, </font><font color="#0000FF"><b>integer </b></font>nPosChave<font color="#800080">, 
</font>	<font color="#0000FF"><b>integer </b></font>nTamChave<font color="#800080">, </font><font color="#0000FF"><b>integer </b></font>nTamLinha<font color="#800080">)
</font><font color="#0000FF"><b>object </b></font>slinha
<font color="#0000FF"><b>sequence </b></font>sres<font color="#800080">, </font>slocal
boolean bQuebra 
<font color="#0000FF"><b>integer </b></font>nstatus<font color="#800080">, </font>nMaior<font color="#800080">, </font>nCod 

bQuebra<font color="#800080">=</font>FALSE
nMaior<font color="#800080">=</font><font color="#FF0000">0
</font>nstatus <font color="#800080">= </font><font color="#0000FF">seek</font><font color="#800080">(</font>sArq<font color="#800080">, </font><font color="#FF0000">0</font><font color="#800080">)
</font><font color="#008000"><b>while </b></font>bQuebra<font color="#800080">=</font>FALSE <font color="#008000"><b>do
  </b></font>slinha <font color="#800080">= </font><font color="#0000FF"><b>gets</b></font><font color="#800080">(</font>sArq<font color="#800080">)
  </font><font color="#008000"><b>if </b></font><font color="#0000FF"><b>atom</b></font><font color="#800080">(</font>slinha<font color="#800080">) </font><font color="#008000"><b>then
    exit 
  end if
  if </b></font><font color="#0000FF"><b>length</b></font><font color="#800080">(</font>slinha<font color="#800080">) &gt; </font><font color="#FF0000">0 </font><font color="#008000"><b>then
    </b></font>slocal <font color="#800080">= </font>slinha
    sres<font color="#800080">=</font>trim<font color="#800080">(</font>copy<font color="#800080">(</font>slocal<font color="#800080">,</font>nPosChave<font color="#800080">,</font>nTamChave<font color="#800080">))
    </font>nCod <font color="#800080">= </font>StrToNum<font color="#800080">(</font>sres<font color="#800080">)
    </font><font color="#008000"><b>if </b></font>nCod <font color="#800080">&gt; </font>nMaior <font color="#008000"><b>then
       </b></font>nMaior<font color="#800080">=</font>nCod
    <font color="#008000"><b>end if
  end if
end while
</b></font>pesqLinhaExcluida<font color="#800080">(</font>sArq<font color="#800080">, </font>nTamLinha<font color="#800080">)
</font>sres <font color="#800080">= </font>NumToStr<font color="#800080">(</font>nMaior<font color="#800080">+</font><font color="#FF0000">1</font><font color="#800080">)
</font><font color="#008000"><b>return </b></font>sres
<font color="#008000"><b>end function
</b></font><font color="#808080"><i>-- ----------------------------------------------------------------------------
-- Grava os registros num determinado arquivo.
-- sArq - o arquivo
-- sTexto - o registro a ser gravado
-- sMsgAcerto - a mensagem caso o registro foi gravado
-- sMsgErro - a mensagem caso o registro n&atilde;o foi gravado
-- ----------------------------------------------------------------------------
</i></font><font color="#008000"><b>procedure </b></font>escreveArq<font color="#800080">(</font>tarquivo sArq<font color="#800080">, </font><font color="#0000FF"><b>sequence </b></font>sTexto<font color="#800080">, </font><font color="#0000FF"><b>sequence </b></font>sMsgAcerto<font color="#800080">,
</font>	  <font color="#0000FF"><b>sequence </b></font>sMsgErro<font color="#800080">)

</font>sTexto<font color="#800080">=</font>sTexto <font color="#800080">&amp; </font>CRLF
<font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>sArq<font color="#800080">, </font>sTexto<font color="#800080">)
</font><font color="#008000"><b>if </b></font><font color="#0000FF"><b>length</b></font><font color="#800080">(</font>sTexto<font color="#800080">) &gt; </font><font color="#FF0000">0 </font><font color="#008000"><b>then
  </b></font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">,</font>sMsgAcerto<font color="#800080">)
</font><font color="#008000"><b>else
  </b></font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDERR<font color="#800080">, </font>sMsgErro<font color="#800080">)
</font><font color="#008000"><b>end if
end procedure

</b></font><font color="#808080"><i>-- ----------------------------------------------------------------------------
-- Monta o tamanho do registro no arquivo de acordo com o tipo de arquivo.
-- sreg - o tipo de arquivo
-- retorna - o registro montado
-- ----------------------------------------------------------------------------
</i></font><font color="#008000"><b>function </b></font>LinhaReg<font color="#800080">(</font>ctArqs sreg<font color="#800080">)
</font><font color="#0000FF"><b>sequence </b></font>slinha

slinha <font color="#800080">= {}
</font><font color="#008000"><b>if </b></font>sreg<font color="#800080">=</font>opAssunto <font color="#008000"><b>then
   </b></font>slinha<font color="#800080">=</font>esp<font color="#800080">(</font>tAssunto<font color="#800080">[</font>CODIGO<font color="#800080">],</font><font color="#FF0000">10</font><font color="#800080">) &amp; </font>esp<font color="#800080">(</font>tAssunto<font color="#800080">[</font>ASSUNTO<font color="#800080">],</font><font color="#FF0000">30</font><font color="#800080">)
</font><font color="#008000"><b>elsif </b></font>sreg<font color="#800080">=</font>opAutor <font color="#008000"><b>then
   </b></font>slinha<font color="#800080">=</font>esp<font color="#800080">(</font>tAutor<font color="#800080">[</font>CODIGO<font color="#800080">],</font><font color="#FF0000">10</font><font color="#800080">) &amp; </font>esp<font color="#800080">(</font>tAutor<font color="#800080">[</font>AUTOR<font color="#800080">],</font><font color="#FF0000">30</font><font color="#800080">)
</font><font color="#008000"><b>elsif </b></font>sreg<font color="#800080">=</font>opEditora <font color="#008000"><b>then
   </b></font>slinha<font color="#800080">=</font>esp<font color="#800080">(</font>tEditora<font color="#800080">[</font>CODIGO<font color="#800080">],</font><font color="#FF0000">10</font><font color="#800080">) &amp; </font>esp<font color="#800080">(</font>tEditora<font color="#800080">[</font>EDITORA<font color="#800080">],</font><font color="#FF0000">50</font><font color="#800080">)
</font><font color="#008000"><b>elsif </b></font>sreg<font color="#800080">=</font>opEndereco <font color="#008000"><b>then
   </b></font>slinha<font color="#800080">=</font>esp<font color="#800080">(</font>tEndereco<font color="#800080">[</font>CODIGO<font color="#800080">],</font><font color="#FF0000">10</font><font color="#800080">) &amp; </font>esp<font color="#800080">(</font>tEndereco<font color="#800080">[</font>LOGRADOURO<font color="#800080">],</font><font color="#FF0000">40</font><font color="#800080">) &amp; 
   </font>esp<font color="#800080">(</font>tEndereco<font color="#800080">[</font>BAIRRO<font color="#800080">],</font><font color="#FF0000">15</font><font color="#800080">) &amp; </font>esp<font color="#800080">(</font>tEndereco<font color="#800080">[</font>CEP<font color="#800080">],</font><font color="#FF0000">8</font><font color="#800080">) &amp; 
   </font>esp<font color="#800080">(</font>tEndereco<font color="#800080">[</font>CIDADE<font color="#800080">],</font><font color="#FF0000">30</font><font color="#800080">) &amp; </font>esp<font color="#800080">(</font>tEndereco<font color="#800080">[</font>ESTADO<font color="#800080">],</font><font color="#FF0000">20</font><font color="#800080">)
</font><font color="#008000"><b>elsif </b></font>sreg<font color="#800080">=</font>opIdioma <font color="#008000"><b>then
   </b></font>slinha<font color="#800080">=</font>esp<font color="#800080">(</font>tIdioma<font color="#800080">[</font>CODIGO<font color="#800080">],</font><font color="#FF0000">10</font><font color="#800080">) &amp; </font>esp<font color="#800080">(</font>tIdioma<font color="#800080">[</font>IDIOMA<font color="#800080">],</font><font color="#FF0000">20</font><font color="#800080">)
</font><font color="#008000"><b>elsif </b></font>sreg<font color="#800080">=</font>opPais <font color="#008000"><b>then
   </b></font>slinha<font color="#800080">=</font>esp<font color="#800080">(</font>tPais<font color="#800080">[</font>CODIGO<font color="#800080">],</font><font color="#FF0000">3</font><font color="#800080">) &amp; </font>esp<font color="#800080">(</font>tPais<font color="#800080">[</font>PAIS<font color="#800080">],</font><font color="#FF0000">50</font><font color="#800080">)
</font><font color="#008000"><b>elsif </b></font>sreg<font color="#800080">=</font>opProfissao <font color="#008000"><b>then
   </b></font>slinha<font color="#800080">=</font>esp<font color="#800080">(</font>tProfissao<font color="#800080">[</font>CODIGO<font color="#800080">],</font><font color="#FF0000">10</font><font color="#800080">) &amp; </font>esp<font color="#800080">(</font>tProfissao<font color="#800080">[</font>PROFISSAO<font color="#800080">],</font><font color="#FF0000">50</font><font color="#800080">)
</font><font color="#008000"><b>elsif </b></font>sreg<font color="#800080">=</font>opUsuario <font color="#008000"><b>then
   </b></font>slinha<font color="#800080">=</font>esp<font color="#800080">(</font>tUsuario<font color="#800080">[</font>LOGIN<font color="#800080">],</font><font color="#FF0000">10</font><font color="#800080">) &amp; </font>esp<font color="#800080">(</font>tUsuario<font color="#800080">[</font>SENHA<font color="#800080">],</font><font color="#FF0000">10</font><font color="#800080">)
</font><font color="#008000"><b>elsif </b></font>sreg<font color="#800080">=</font>opLivro <font color="#008000"><b>then
   </b></font>slinha<font color="#800080">=</font>esp<font color="#800080">(</font>tLivro<font color="#800080">[</font>ISBN<font color="#800080">],</font><font color="#FF0000">13</font><font color="#800080">) &amp; </font>esp<font color="#800080">(</font>tLivro<font color="#800080">[</font>TITULO<font color="#800080">],</font><font color="#FF0000">50</font><font color="#800080">) &amp; </font>esp<font color="#800080">(</font>tLivro<font color="#800080">[</font>EDICAO<font color="#800080">],</font><font color="#FF0000">10</font><font color="#800080">) &amp; 
   </font>esp<font color="#800080">(</font>tLivro<font color="#800080">[</font>ANOPUBLI<font color="#800080">],</font><font color="#FF0000">10</font><font color="#800080">) &amp; </font>esp<font color="#800080">(</font>tLivro<font color="#800080">[</font>CODEDITORA<font color="#800080">],</font><font color="#FF0000">10</font><font color="#800080">) &amp; </font>esp<font color="#800080">(</font>tLivro<font color="#800080">[</font>VOLUME<font color="#800080">],</font><font color="#FF0000">10</font><font color="#800080">) &amp; 
   </font>esp<font color="#800080">(</font>tLivro<font color="#800080">[</font>CODIDIOMA<font color="#800080">],</font><font color="#FF0000">10</font><font color="#800080">) &amp; </font>esp<font color="#800080">(</font>tLivro<font color="#800080">[</font>NPAGINAS<font color="#800080">],</font><font color="#FF0000">10</font><font color="#800080">) &amp; </font>esp<font color="#800080">(</font>tLivro<font color="#800080">[</font>PRECO<font color="#800080">],</font><font color="#FF0000">10</font><font color="#800080">) &amp; 
   </font>esp<font color="#800080">(</font>tLivro<font color="#800080">[</font>QTDESTOQUE<font color="#800080">],</font><font color="#FF0000">10</font><font color="#800080">)
</font><font color="#008000"><b>elsif </b></font>sreg<font color="#800080">=</font>opLivroAss <font color="#008000"><b>then
   </b></font>slinha<font color="#800080">=</font>esp<font color="#800080">(</font>tLivroAss<font color="#800080">[</font>ISBN<font color="#800080">],</font><font color="#FF0000">13</font><font color="#800080">) &amp; </font>esp<font color="#800080">(</font>tLivroAss<font color="#800080">[</font>CODASSUNTO<font color="#800080">],</font><font color="#FF0000">10</font><font color="#800080">)
</font><font color="#008000"><b>elsif </b></font>sreg<font color="#800080">=</font>opLivroAut <font color="#008000"><b>then
   </b></font>slinha<font color="#800080">=</font>esp<font color="#800080">(</font>tLivroAut<font color="#800080">[</font>ISBN<font color="#800080">],</font><font color="#FF0000">13</font><font color="#800080">) &amp; </font>esp<font color="#800080">(</font>tLivroAut<font color="#800080">[</font>CODAUTOR<font color="#800080">],</font><font color="#FF0000">10</font><font color="#800080">)
</font><font color="#008000"><b>elsif </b></font>sreg<font color="#800080">=</font>opCliente <font color="#008000"><b>then
   </b></font>slinha<font color="#800080">=</font>esp<font color="#800080">(</font>tCliente<font color="#800080">[</font>CPF<font color="#800080">],</font><font color="#FF0000">14</font><font color="#800080">) &amp; </font>esp<font color="#800080">(</font>tCliente<font color="#800080">[</font>NOME<font color="#800080">],</font><font color="#FF0000">30</font><font color="#800080">) &amp; </font>esp<font color="#800080">(</font>tCliente<font color="#800080">[</font>EMAIL<font color="#800080">],</font><font color="#FF0000">30</font><font color="#800080">) &amp; 
   </font>esp<font color="#800080">(</font>tCliente<font color="#800080">[</font>IDENTIDADE<font color="#800080">],</font><font color="#FF0000">10</font><font color="#800080">) &amp; </font>esp<font color="#800080">(</font>tCliente<font color="#800080">[</font>SEXO<font color="#800080">],</font><font color="#FF0000">1</font><font color="#800080">) &amp; </font>esp<font color="#800080">(</font>tCliente<font color="#800080">[</font>TELEFONE<font color="#800080">],</font><font color="#FF0000">17</font><font color="#800080">) &amp; 
   </font>esp<font color="#800080">(</font>tCliente<font color="#800080">[</font>DTNASCIMENTO<font color="#800080">],</font><font color="#FF0000">10</font><font color="#800080">) &amp; </font>esp<font color="#800080">(</font>tCliente<font color="#800080">[</font>CODENDERECO<font color="#800080">],</font><font color="#FF0000">10</font><font color="#800080">) &amp; 
   </font>esp<font color="#800080">(</font>tCliente<font color="#800080">[</font>CODPAIS<font color="#800080">],</font><font color="#FF0000">3</font><font color="#800080">) &amp; </font>esp<font color="#800080">(</font>tCliente<font color="#800080">[</font>CODPROFISSAO<font color="#800080">],</font><font color="#FF0000">10</font><font color="#800080">)
</font><font color="#008000"><b>elsif </b></font>sreg<font color="#800080">=</font>opVenda <font color="#008000"><b>then
   </b></font>slinha<font color="#800080">=</font>esp<font color="#800080">(</font>tVenda<font color="#800080">[</font>DTHRVENDA<font color="#800080">],</font><font color="#FF0000">19</font><font color="#800080">) &amp; </font>esp<font color="#800080">(</font>tVenda<font color="#800080">[</font>CPFVENDA<font color="#800080">],</font><font color="#FF0000">14</font><font color="#800080">) &amp; </font>esp<font color="#800080">(</font>tVenda<font color="#800080">[</font>ISBNVENDA<font color="#800080">],</font><font color="#FF0000">13</font><font color="#800080">) &amp; 
   </font>esp<font color="#800080">(</font>tVenda<font color="#800080">[</font>PRECOVENDA<font color="#800080">],</font><font color="#FF0000">10</font><font color="#800080">)
</font><font color="#008000"><b>end if
return </b></font>slinha
<font color="#008000"><b>end function
</b></font><font color="#808080"><i>-- ----------------------------------------------------------------------------
-- Retorna o tamanho do registro no arquivo de acordo com o tipo de arquivo.
-- sreg - o tipo de arquivo
-- retorna - o tamanho do registro
-- ----------------------------------------------------------------------------
</i></font><font color="#008000"><b>function </b></font>tamReg<font color="#800080">(</font>ctArqs sreg<font color="#800080">)
</font><font color="#0000FF"><b>integer </b></font>nret

nret<font color="#800080">=</font><font color="#FF0000">0
</font><font color="#008000"><b>if </b></font>sreg<font color="#800080">=</font>opAssunto <font color="#008000"><b>then </b></font>nret<font color="#800080">=</font>TAM_ASSUNTO
<font color="#008000"><b>elsif </b></font>sreg<font color="#800080">=</font>opAutor <font color="#008000"><b>then </b></font>nret<font color="#800080">=</font>TAM_AUTOR
<font color="#008000"><b>elsif </b></font>sreg<font color="#800080">=</font>opEditora <font color="#008000"><b>then </b></font>nret<font color="#800080">=</font>TAM_EDITORA
<font color="#008000"><b>elsif </b></font>sreg<font color="#800080">=</font>opEndereco <font color="#008000"><b>then </b></font>nret<font color="#800080">=</font>TAM_ENDERECO
<font color="#008000"><b>elsif </b></font>sreg<font color="#800080">=</font>opIdioma <font color="#008000"><b>then </b></font>nret<font color="#800080">=</font>TAM_IDIOMA
<font color="#008000"><b>elsif </b></font>sreg<font color="#800080">=</font>opPais <font color="#008000"><b>then </b></font>nret<font color="#800080">=</font>TAM_PAIS
<font color="#008000"><b>elsif </b></font>sreg<font color="#800080">=</font>opProfissao <font color="#008000"><b>then </b></font>nret<font color="#800080">=</font>TAM_PROFISSAO
<font color="#008000"><b>elsif </b></font>sreg<font color="#800080">=</font>opUsuario <font color="#008000"><b>then </b></font>nret<font color="#800080">=</font>TAM_USUARIO
<font color="#008000"><b>elsif </b></font>sreg<font color="#800080">=</font>opLivro <font color="#008000"><b>then </b></font>nret<font color="#800080">=</font>TAM_LIVRO
<font color="#008000"><b>elsif </b></font>sreg<font color="#800080">=</font>opLivroAss <font color="#008000"><b>then </b></font>nret<font color="#800080">=</font>TAM_LIVASS
<font color="#008000"><b>elsif </b></font>sreg<font color="#800080">=</font>opLivroAut <font color="#008000"><b>then </b></font>nret<font color="#800080">=</font>TAM_LIVAUT
<font color="#008000"><b>elsif </b></font>sreg<font color="#800080">=</font>opCliente <font color="#008000"><b>then </b></font>nret<font color="#800080">=</font>TAM_CLIENTE
<font color="#008000"><b>elsif </b></font>sreg<font color="#800080">=</font>opVenda <font color="#008000"><b>then </b></font>nret<font color="#800080">=</font>TAM_VENDA
<font color="#008000"><b>end if
return </b></font>nret
<font color="#008000"><b>end function

</b></font><font color="#808080"><i>-- --- Rotinas de implementa&ccedil;&atilde;o do sistema ------------------------------------

-- ----------------------------------------------------------------------------
-- Seleciona o rotulo de cada campo de acordo com o tipo de arquivo.
-- sreg - o tipo de arquivo
-- nNum - indica qual rotulo ser&aacute; retornado
-- retorna - o rotulo
-- ----------------------------------------------------------------------------
</i></font><font color="#008000"><b>function </b></font>rotulo<font color="#800080">(</font>ctArqs sreg<font color="#800080">, </font><font color="#0000FF"><b>integer </b></font>nNum<font color="#800080">)
</font><font color="#0000FF"><b>sequence </b></font>sret

<font color="#008000"><b>if </b></font>sreg<font color="#800080">=</font>opAssunto <font color="#008000"><b>then
   if </b></font>nNum <font color="#800080">= </font><font color="#FF0000">0 </font><font color="#008000"><b>then </b></font>sret<font color="#800080">=</font><font color="#008000"><i>&quot;Assunto(s) n&atilde;o encontrado(s)!\n&quot;
   </i><b>elsif </b></font>nNum <font color="#800080">= </font><font color="#FF0000">1 </font><font color="#008000"><b>then </b></font>sret<font color="#800080">=</font><font color="#008000"><i>&quot;C&oacute;digo do assunto: &quot;
          </i></font>g_nPosChave<font color="#800080">=</font><font color="#FF0000">1
          </font>g_nTamChave<font color="#800080">=</font><font color="#FF0000">10
   </font><font color="#008000"><b>elsif </b></font>nNum <font color="#800080">= </font><font color="#FF0000">2 </font><font color="#008000"><b>then </b></font>sret<font color="#800080">=</font><font color="#008000"><i>&quot;Assunto: &quot;
          </i></font>g_nPosChave<font color="#800080">=</font><font color="#FF0000">11
          </font>g_nTamChave<font color="#800080">=</font><font color="#FF0000">30
   </font><font color="#008000"><b>end if
elsif </b></font>sreg<font color="#800080">=</font>opAutor <font color="#008000"><b>then
   if </b></font>nNum <font color="#800080">= </font><font color="#FF0000">0 </font><font color="#008000"><b>then </b></font>sret<font color="#800080">=</font><font color="#008000"><i>&quot;Autor(es) n&atilde;o encontrado(s)!\n&quot;
   </i><b>elsif </b></font>nNum <font color="#800080">= </font><font color="#FF0000">1 </font><font color="#008000"><b>then </b></font>sret<font color="#800080">=</font><font color="#008000"><i>&quot;C&oacute;digo do autor: &quot;
          </i></font>g_nPosChave<font color="#800080">=</font><font color="#FF0000">1
          </font>g_nTamChave<font color="#800080">=</font><font color="#FF0000">10
   </font><font color="#008000"><b>elsif </b></font>nNum <font color="#800080">= </font><font color="#FF0000">2 </font><font color="#008000"><b>then </b></font>sret<font color="#800080">=</font><font color="#008000"><i>&quot;Autor: &quot;
          </i></font>g_nPosChave<font color="#800080">=</font><font color="#FF0000">11
          </font>g_nTamChave<font color="#800080">=</font><font color="#FF0000">30
   </font><font color="#008000"><b>end if
elsif </b></font>sreg<font color="#800080">=</font>opEditora <font color="#008000"><b>then
   if </b></font>nNum <font color="#800080">= </font><font color="#FF0000">0 </font><font color="#008000"><b>then </b></font>sret<font color="#800080">=</font><font color="#008000"><i>&quot;Editora(s) n&atilde;o encontrada(s)!\n&quot;
   </i><b>elsif </b></font>nNum <font color="#800080">= </font><font color="#FF0000">1 </font><font color="#008000"><b>then </b></font>sret<font color="#800080">=</font><font color="#008000"><i>&quot;C&oacute;digo da editora: &quot;
          </i></font>g_nPosChave<font color="#800080">=</font><font color="#FF0000">1
          </font>g_nTamChave<font color="#800080">=</font><font color="#FF0000">10
   </font><font color="#008000"><b>elsif </b></font>nNum <font color="#800080">= </font><font color="#FF0000">2 </font><font color="#008000"><b>then </b></font>sret<font color="#800080">=</font><font color="#008000"><i>&quot;Editora: &quot;
          </i></font>g_nPosChave<font color="#800080">=</font><font color="#FF0000">11
          </font>g_nTamChave<font color="#800080">=</font><font color="#FF0000">50
   </font><font color="#008000"><b>end if
elsif </b></font>sreg<font color="#800080">=</font>opEndereco <font color="#008000"><b>then
   if </b></font>nNum <font color="#800080">= </font><font color="#FF0000">0 </font><font color="#008000"><b>then </b></font>sret<font color="#800080">=</font><font color="#008000"><i>&quot;Endere&ccedil;o(s) n&atilde;o encontrado(s)!\n&quot;
   </i><b>elsif </b></font>nNum <font color="#800080">= </font><font color="#FF0000">1 </font><font color="#008000"><b>then </b></font>sret<font color="#800080">=</font><font color="#008000"><i>&quot;C&oacute;digo do endere&ccedil;o: &quot;
          </i></font>g_nPosChave<font color="#800080">=</font><font color="#FF0000">1
          </font>g_nTamChave<font color="#800080">=</font><font color="#FF0000">10
   </font><font color="#008000"><b>elsif </b></font>nNum <font color="#800080">= </font><font color="#FF0000">2 </font><font color="#008000"><b>then </b></font>sret<font color="#800080">=</font><font color="#008000"><i>&quot;Logradouro: &quot;
          </i></font>g_nPosChave<font color="#800080">=</font><font color="#FF0000">11
          </font>g_nTamChave<font color="#800080">=</font><font color="#FF0000">40
   </font><font color="#008000"><b>elsif </b></font>nNum <font color="#800080">= </font><font color="#FF0000">3 </font><font color="#008000"><b>then </b></font>sret<font color="#800080">=</font><font color="#008000"><i>&quot;Bairro: &quot;
          </i></font>g_nPosChave<font color="#800080">=</font><font color="#FF0000">51
          </font>g_nTamChave<font color="#800080">=</font><font color="#FF0000">15
   </font><font color="#008000"><b>elsif </b></font>nNum <font color="#800080">= </font><font color="#FF0000">4 </font><font color="#008000"><b>then </b></font>sret<font color="#800080">=</font><font color="#008000"><i>&quot;CEP: &quot;
          </i></font>g_nPosChave<font color="#800080">=</font><font color="#FF0000">66
          </font>g_nTamChave<font color="#800080">=</font><font color="#FF0000">8
   </font><font color="#008000"><b>elsif </b></font>nNum <font color="#800080">= </font><font color="#FF0000">5 </font><font color="#008000"><b>then </b></font>sret<font color="#800080">=</font><font color="#008000"><i>&quot;Cidade: &quot;
          </i></font>g_nPosChave<font color="#800080">=</font><font color="#FF0000">74
          </font>g_nTamChave<font color="#800080">=</font><font color="#FF0000">30
   </font><font color="#008000"><b>elsif </b></font>nNum <font color="#800080">= </font><font color="#FF0000">6 </font><font color="#008000"><b>then </b></font>sret<font color="#800080">=</font><font color="#008000"><i>&quot;Estado: &quot;
          </i></font>g_nPosChave<font color="#800080">=</font><font color="#FF0000">104
          </font>g_nTamChave<font color="#800080">=</font><font color="#FF0000">20
   </font><font color="#008000"><b>end if
elsif </b></font>sreg<font color="#800080">=</font>opIdioma <font color="#008000"><b>then
   if </b></font>nNum <font color="#800080">= </font><font color="#FF0000">0 </font><font color="#008000"><b>then </b></font>sret<font color="#800080">=</font><font color="#008000"><i>&quot;Idioma(s) n&atilde;o encontrado(s)!\n&quot;
   </i><b>elsif </b></font>nNum <font color="#800080">= </font><font color="#FF0000">1 </font><font color="#008000"><b>then </b></font>sret<font color="#800080">=</font><font color="#008000"><i>&quot;C&oacute;digo do idioma: &quot;
          </i></font>g_nPosChave<font color="#800080">=</font><font color="#FF0000">1
          </font>g_nTamChave<font color="#800080">=</font><font color="#FF0000">10
   </font><font color="#008000"><b>elsif </b></font>nNum <font color="#800080">= </font><font color="#FF0000">2 </font><font color="#008000"><b>then </b></font>sret<font color="#800080">=</font><font color="#008000"><i>&quot;Idioma: &quot;
          </i></font>g_nPosChave<font color="#800080">=</font><font color="#FF0000">11
          </font>g_nTamChave<font color="#800080">=</font><font color="#FF0000">20
   </font><font color="#008000"><b>end if
elsif </b></font>sreg<font color="#800080">=</font>opPais <font color="#008000"><b>then
   if </b></font>nNum <font color="#800080">= </font><font color="#FF0000">0 </font><font color="#008000"><b>then </b></font>sret<font color="#800080">=</font><font color="#008000"><i>&quot;Pa&iacute;s(es) n&atilde;o encontrado(s)!\n&quot;
   </i><b>elsif </b></font>nNum <font color="#800080">= </font><font color="#FF0000">1 </font><font color="#008000"><b>then </b></font>sret<font color="#800080">=</font><font color="#008000"><i>&quot;C&oacute;digo do pa&iacute;s: &quot;
          </i></font>g_nPosChave<font color="#800080">=</font><font color="#FF0000">1
          </font>g_nTamChave<font color="#800080">=</font><font color="#FF0000">3
   </font><font color="#008000"><b>elsif </b></font>nNum <font color="#800080">= </font><font color="#FF0000">2 </font><font color="#008000"><b>then </b></font>sret<font color="#800080">=</font><font color="#008000"><i>&quot;Pa&iacute;s: &quot;
          </i></font>g_nPosChave<font color="#800080">=</font><font color="#FF0000">4
          </font>g_nTamChave<font color="#800080">=</font><font color="#FF0000">50
   </font><font color="#008000"><b>end if
elsif </b></font>sreg<font color="#800080">=</font>opProfissao <font color="#008000"><b>then
   if </b></font>nNum <font color="#800080">= </font><font color="#FF0000">0 </font><font color="#008000"><b>then </b></font>sret<font color="#800080">=</font><font color="#008000"><i>&quot;Profiss&atilde;o(es) n&atilde;o encontrada(s)!\n&quot;
   </i><b>elsif </b></font>nNum <font color="#800080">= </font><font color="#FF0000">1 </font><font color="#008000"><b>then </b></font>sret<font color="#800080">=</font><font color="#008000"><i>&quot;C&oacute;digo da profiss&atilde;o: &quot;
          </i></font>g_nPosChave<font color="#800080">=</font><font color="#FF0000">1
          </font>g_nTamChave<font color="#800080">=</font><font color="#FF0000">10
   </font><font color="#008000"><b>elsif </b></font>nNum <font color="#800080">= </font><font color="#FF0000">2 </font><font color="#008000"><b>then </b></font>sret<font color="#800080">=</font><font color="#008000"><i>&quot;Profiss&atilde;o: &quot;
          </i></font>g_nPosChave<font color="#800080">=</font><font color="#FF0000">11
          </font>g_nTamChave<font color="#800080">=</font><font color="#FF0000">50
   </font><font color="#008000"><b>end if
elsif </b></font>sreg<font color="#800080">=</font>opUsuario <font color="#008000"><b>then
   if </b></font>nNum <font color="#800080">= </font><font color="#FF0000">0 </font><font color="#008000"><b>then </b></font>sret<font color="#800080">=</font><font color="#008000"><i>&quot;login ou senha incorreta, tente de novo!\n&quot;
   </i><b>elsif </b></font>nNum <font color="#800080">= </font><font color="#FF0000">1 </font><font color="#008000"><b>then </b></font>sret<font color="#800080">=</font><font color="#008000"><i>&quot;Login: &quot;
          </i></font>g_nPosChave<font color="#800080">=</font><font color="#FF0000">1
          </font>g_nTamChave<font color="#800080">=</font><font color="#FF0000">10
   </font><font color="#008000"><b>elsif </b></font>nNum <font color="#800080">= </font><font color="#FF0000">2 </font><font color="#008000"><b>then </b></font>sret<font color="#800080">=</font><font color="#008000"><i>&quot;Senha: &quot;
          </i></font>g_nPosChave<font color="#800080">=</font><font color="#FF0000">11
          </font>g_nTamChave<font color="#800080">=</font><font color="#FF0000">10
   </font><font color="#008000"><b>end if
elsif </b></font>sreg<font color="#800080">=</font>opLivro <font color="#008000"><b>then
   if </b></font>nNum <font color="#800080">= </font><font color="#FF0000">0 </font><font color="#008000"><b>then </b></font>sret<font color="#800080">=</font><font color="#008000"><i>&quot;Livro(s) n&atilde;o encontrado(s)!\n&quot;
   </i><b>elsif </b></font>nNum <font color="#800080">= </font><font color="#FF0000">1 </font><font color="#008000"><b>then </b></font>sret<font color="#800080">=</font><font color="#008000"><i>&quot;ISBN: &quot;
          </i></font>g_nPosChave<font color="#800080">=</font><font color="#FF0000">1
          </font>g_nTamChave<font color="#800080">=</font><font color="#FF0000">13
   </font><font color="#008000"><b>elsif </b></font>nNum <font color="#800080">= </font><font color="#FF0000">2 </font><font color="#008000"><b>then </b></font>sret<font color="#800080">=</font><font color="#008000"><i>&quot;T&iacute;tulo: &quot;
          </i></font>g_nPosChave<font color="#800080">=</font><font color="#FF0000">14
          </font>g_nTamChave<font color="#800080">=</font><font color="#FF0000">50
   </font><font color="#008000"><b>elsif </b></font>nNum <font color="#800080">= </font><font color="#FF0000">3 </font><font color="#008000"><b>then </b></font>sret<font color="#800080">=</font><font color="#008000"><i>&quot;Edi&ccedil;&atilde;o: &quot;
          </i></font>g_nPosChave<font color="#800080">=</font><font color="#FF0000">64
          </font>g_nTamChave<font color="#800080">=</font><font color="#FF0000">10
   </font><font color="#008000"><b>elsif </b></font>nNum <font color="#800080">= </font><font color="#FF0000">4 </font><font color="#008000"><b>then </b></font>sret<font color="#800080">=</font><font color="#008000"><i>&quot;Ano de Publica&ccedil;&atilde;o: &quot;
          </i></font>g_nPosChave<font color="#800080">=</font><font color="#FF0000">74
          </font>g_nTamChave<font color="#800080">=</font><font color="#FF0000">10
   </font><font color="#008000"><b>elsif </b></font>nNum <font color="#800080">= </font><font color="#FF0000">5 </font><font color="#008000"><b>then </b></font>sret<font color="#800080">=</font><font color="#008000"><i>&quot;C&oacute;digo da editora: &quot;
          </i></font>g_nPosChave<font color="#800080">=</font><font color="#FF0000">84
          </font>g_nTamChave<font color="#800080">=</font><font color="#FF0000">10
   </font><font color="#008000"><b>elsif </b></font>nNum <font color="#800080">= </font><font color="#FF0000">6 </font><font color="#008000"><b>then </b></font>sret<font color="#800080">=</font><font color="#008000"><i>&quot;Volume: &quot;
          </i></font>g_nPosChave<font color="#800080">=</font><font color="#FF0000">94
          </font>g_nTamChave<font color="#800080">=</font><font color="#FF0000">10
   </font><font color="#008000"><b>elsif </b></font>nNum <font color="#800080">= </font><font color="#FF0000">7 </font><font color="#008000"><b>then </b></font>sret<font color="#800080">=</font><font color="#008000"><i>&quot;C&oacute;digo do idioma: &quot;
          </i></font>g_nPosChave<font color="#800080">=</font><font color="#FF0000">104
          </font>g_nTamChave<font color="#800080">=</font><font color="#FF0000">10
   </font><font color="#008000"><b>elsif </b></font>nNum <font color="#800080">= </font><font color="#FF0000">8 </font><font color="#008000"><b>then </b></font>sret<font color="#800080">=</font><font color="#008000"><i>&quot;N&uacute;mero de p&aacute;ginas: &quot;
          </i></font>g_nPosChave<font color="#800080">=</font><font color="#FF0000">114
          </font>g_nTamChave<font color="#800080">=</font><font color="#FF0000">10
   </font><font color="#008000"><b>elsif </b></font>nNum <font color="#800080">= </font><font color="#FF0000">9 </font><font color="#008000"><b>then </b></font>sret<font color="#800080">=</font><font color="#008000"><i>&quot;Pre&ccedil;o: &quot;
          </i></font>g_nPosChave<font color="#800080">=</font><font color="#FF0000">124
          </font>g_nTamChave<font color="#800080">=</font><font color="#FF0000">10
   </font><font color="#008000"><b>elsif </b></font>nNum <font color="#800080">= </font><font color="#FF0000">10 </font><font color="#008000"><b>then </b></font>sret<font color="#800080">=</font><font color="#008000"><i>&quot;Qtd. Estoque: &quot;
           </i></font>g_nPosChave<font color="#800080">=</font><font color="#FF0000">134
           </font>g_nTamChave<font color="#800080">=</font><font color="#FF0000">10
   </font><font color="#008000"><b>end if
elsif </b></font>sreg<font color="#800080">=</font>opLivroAss <font color="#008000"><b>then
   if </b></font>nNum <font color="#800080">= </font><font color="#FF0000">0 </font><font color="#008000"><b>then </b></font>sret<font color="#800080">=</font><font color="#008000"><i>&quot;Assunto(s) n&atilde;o encontrado(s)!\n&quot;
   </i><b>elsif </b></font>nNum <font color="#800080">= </font><font color="#FF0000">1 </font><font color="#008000"><b>then </b></font>sret<font color="#800080">=</font><font color="#008000"><i>&quot;ISBN: &quot;
          </i></font>g_nPosChave<font color="#800080">=</font><font color="#FF0000">1
          </font>g_nTamChave<font color="#800080">=</font><font color="#FF0000">13
   </font><font color="#008000"><b>elsif </b></font>nNum <font color="#800080">= </font><font color="#FF0000">2 </font><font color="#008000"><b>then </b></font>sret<font color="#800080">=</font><font color="#008000"><i>&quot;C&oacute;digo do assunto: &quot;
          </i></font>g_nPosChave<font color="#800080">=</font><font color="#FF0000">14
          </font>g_nTamChave<font color="#800080">=</font><font color="#FF0000">10
   </font><font color="#008000"><b>end if
elsif </b></font>sreg<font color="#800080">=</font>opLivroAut <font color="#008000"><b>then
   if </b></font>nNum <font color="#800080">= </font><font color="#FF0000">0 </font><font color="#008000"><b>then </b></font>sret<font color="#800080">=</font><font color="#008000"><i>&quot;Autor(s) n&atilde;o encontrado(s)!\n&quot;
   </i><b>elsif </b></font>nNum <font color="#800080">= </font><font color="#FF0000">1 </font><font color="#008000"><b>then </b></font>sret<font color="#800080">=</font><font color="#008000"><i>&quot;ISBN: &quot;
          </i></font>g_nPosChave<font color="#800080">=</font><font color="#FF0000">1
          </font>g_nTamChave<font color="#800080">=</font><font color="#FF0000">13
   </font><font color="#008000"><b>elsif </b></font>nNum <font color="#800080">= </font><font color="#FF0000">2 </font><font color="#008000"><b>then </b></font>sret<font color="#800080">=</font><font color="#008000"><i>&quot;C&oacute;digo do autor: &quot;
          </i></font>g_nPosChave<font color="#800080">=</font><font color="#FF0000">14
          </font>g_nTamChave<font color="#800080">=</font><font color="#FF0000">10
   </font><font color="#008000"><b>end if
elsif </b></font>sreg<font color="#800080">=</font>opCliente <font color="#008000"><b>then
   if </b></font>nNum <font color="#800080">= </font><font color="#FF0000">0 </font><font color="#008000"><b>then </b></font>sret<font color="#800080">=</font><font color="#008000"><i>&quot;Cliente(s) n&atilde;o encontrado(s)!\n&quot;
   </i><b>elsif </b></font>nNum <font color="#800080">= </font><font color="#FF0000">1 </font><font color="#008000"><b>then </b></font>sret<font color="#800080">=</font><font color="#008000"><i>&quot;CPF: &quot;
          </i></font>g_nPosChave<font color="#800080">=</font><font color="#FF0000">1
          </font>g_nTamChave<font color="#800080">=</font><font color="#FF0000">14
   </font><font color="#008000"><b>elsif </b></font>nNum <font color="#800080">= </font><font color="#FF0000">2 </font><font color="#008000"><b>then </b></font>sret<font color="#800080">=</font><font color="#008000"><i>&quot;Nome: &quot;
          </i></font>g_nPosChave<font color="#800080">=</font><font color="#FF0000">15
          </font>g_nTamChave<font color="#800080">=</font><font color="#FF0000">30
   </font><font color="#008000"><b>elsif </b></font>nNum <font color="#800080">= </font><font color="#FF0000">3 </font><font color="#008000"><b>then </b></font>sret<font color="#800080">=</font><font color="#008000"><i>&quot;E-mail: &quot;
          </i></font>g_nPosChave<font color="#800080">=</font><font color="#FF0000">45
          </font>g_nTamChave<font color="#800080">=</font><font color="#FF0000">30
   </font><font color="#008000"><b>elsif </b></font>nNum <font color="#800080">= </font><font color="#FF0000">4 </font><font color="#008000"><b>then </b></font>sret<font color="#800080">=</font><font color="#008000"><i>&quot;Identidade: &quot;
          </i></font>g_nPosChave<font color="#800080">=</font><font color="#FF0000">75
          </font>g_nTamChave<font color="#800080">=</font><font color="#FF0000">10
   </font><font color="#008000"><b>elsif </b></font>nNum <font color="#800080">= </font><font color="#FF0000">5 </font><font color="#008000"><b>then </b></font>sret<font color="#800080">=</font><font color="#008000"><i>&quot;Sexo: &quot;
          </i></font>g_nPosChave<font color="#800080">=</font><font color="#FF0000">85
          </font>g_nTamChave<font color="#800080">=</font><font color="#FF0000">1
   </font><font color="#008000"><b>elsif </b></font>nNum <font color="#800080">= </font><font color="#FF0000">6 </font><font color="#008000"><b>then </b></font>sret<font color="#800080">=</font><font color="#008000"><i>&quot;Telefone: &quot;
          </i></font>g_nPosChave<font color="#800080">=</font><font color="#FF0000">86
          </font>g_nTamChave<font color="#800080">=</font><font color="#FF0000">17
   </font><font color="#008000"><b>elsif </b></font>nNum <font color="#800080">= </font><font color="#FF0000">7 </font><font color="#008000"><b>then </b></font>sret<font color="#800080">=</font><font color="#008000"><i>&quot;Dt. Nascimento: &quot;
          </i></font>g_nPosChave<font color="#800080">=</font><font color="#FF0000">103
          </font>g_nTamChave<font color="#800080">=</font><font color="#FF0000">10
   </font><font color="#008000"><b>elsif </b></font>nNum <font color="#800080">= </font><font color="#FF0000">8 </font><font color="#008000"><b>then </b></font>sret<font color="#800080">=</font><font color="#008000"><i>&quot;C&oacute;digo do endere&ccedil;o: &quot;
          </i></font>g_nPosChave<font color="#800080">=</font><font color="#FF0000">113
          </font>g_nTamChave<font color="#800080">=</font><font color="#FF0000">10
   </font><font color="#008000"><b>elsif </b></font>nNum <font color="#800080">= </font><font color="#FF0000">9 </font><font color="#008000"><b>then </b></font>sret<font color="#800080">=</font><font color="#008000"><i>&quot;C&oacute;digo do pa&iacute;s: &quot;
          </i></font>g_nPosChave<font color="#800080">=</font><font color="#FF0000">123
          </font>g_nTamChave<font color="#800080">=</font><font color="#FF0000">3
   </font><font color="#008000"><b>elsif </b></font>nNum <font color="#800080">= </font><font color="#FF0000">10 </font><font color="#008000"><b>then </b></font>sret<font color="#800080">=</font><font color="#008000"><i>&quot;C&oacute;digo da Profiss&atilde;o: &quot;
          </i></font>g_nPosChave<font color="#800080">=</font><font color="#FF0000">126
          </font>g_nTamChave<font color="#800080">=</font><font color="#FF0000">10
   </font><font color="#008000"><b>end if
elsif </b></font>sreg<font color="#800080">=</font>opVenda <font color="#008000"><b>then
   if </b></font>nNum <font color="#800080">= </font><font color="#FF0000">0 </font><font color="#008000"><b>then </b></font>sret<font color="#800080">=</font><font color="#008000"><i>&quot;Venda(s) n&atilde;o encontrada(s)!\n&quot;
   </i><b>elsif </b></font>nNum <font color="#800080">= </font><font color="#FF0000">1 </font><font color="#008000"><b>then </b></font>sret<font color="#800080">=</font><font color="#008000"><i>&quot;Data/Hora venda: &quot;
          </i></font>g_nPosChave<font color="#800080">=</font><font color="#FF0000">1
          </font>g_nTamChave<font color="#800080">=</font><font color="#FF0000">19
   </font><font color="#008000"><b>elsif </b></font>nNum <font color="#800080">= </font><font color="#FF0000">2 </font><font color="#008000"><b>then </b></font>sret<font color="#800080">=</font><font color="#008000"><i>&quot;CPF: &quot;
          </i></font>g_nPosChave<font color="#800080">=</font><font color="#FF0000">20
          </font>g_nTamChave<font color="#800080">=</font><font color="#FF0000">14
   </font><font color="#008000"><b>elsif </b></font>nNum <font color="#800080">= </font><font color="#FF0000">3 </font><font color="#008000"><b>then </b></font>sret<font color="#800080">=</font><font color="#008000"><i>&quot;ISBN: &quot;
          </i></font>g_nPosChave<font color="#800080">=</font><font color="#FF0000">34
          </font>g_nTamChave<font color="#800080">=</font><font color="#FF0000">13
   </font><font color="#008000"><b>elsif </b></font>nNum <font color="#800080">= </font><font color="#FF0000">4 </font><font color="#008000"><b>then </b></font>sret<font color="#800080">=</font><font color="#008000"><i>&quot;Pre&ccedil;o de venda: &quot;
          </i></font>g_nPosChave<font color="#800080">=</font><font color="#FF0000">47
          </font>g_nTamChave<font color="#800080">=</font><font color="#FF0000">10
   </font><font color="#008000"><b>end if
end if

return </b></font>sret
<font color="#008000"><b>end function
</b></font><font color="#808080"><i>-- ----------------------------------------------------------------------------
-- Mostra os menus do sistema.
-- num - o n&uacute;mero do menu
-- ----------------------------------------------------------------------------
</i></font><font color="#008000"><b>function </b></font>menu<font color="#800080">(</font><font color="#0000FF"><b>integer </b></font>num<font color="#800080">)

 </font><font color="#008000"><b>if </b></font><font color="#800080">(</font>num<font color="#800080">=</font><font color="#FF0000">1</font><font color="#800080">) </font><font color="#008000"><b>then
 </b></font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font><font color="#008000"><i>&quot;*--------------------------------------------------------------*\n&quot;</i></font><font color="#800080">)
 </font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font><font color="#008000"><i>&quot;| (C)adastros        (P)esquisas     (V)endas        (O)p&ccedil;&otilde;es  |\n&quot;</i></font><font color="#800080">)
 </font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font><font color="#008000"><i>&quot;*--------------------------------------------------------------*\n&quot;</i></font><font color="#800080">)
 </font><font color="#008000"><b>elsif </b></font><font color="#800080">(</font>num<font color="#800080">=</font><font color="#FF0000">2</font><font color="#800080">) </font><font color="#008000"><b>then
  </b></font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font><font color="#008000"><i>&quot;*---------------------------------*\n&quot;</i></font><font color="#800080">)
  </font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font><font color="#008000"><i>&quot;| 01. Cadastro de Assuntos        |\n&quot;</i></font><font color="#800080">)
  </font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font><font color="#008000"><i>&quot;| 02. Cadastro de Autores         |\n&quot;</i></font><font color="#800080">)
  </font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font><font color="#008000"><i>&quot;| 03. Cadastro de Editoras        |\n&quot;</i></font><font color="#800080">)
  </font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font><font color="#008000"><i>&quot;| 04. Cadastro de Endere&ccedil;os       |\n&quot;</i></font><font color="#800080">)
  </font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font><font color="#008000"><i>&quot;| 05. Cadastro de Idiomas         |\n&quot;</i></font><font color="#800080">)
  </font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font><font color="#008000"><i>&quot;| 06. Cadastro de Pa&iacute;ses          |\n&quot;</i></font><font color="#800080">)
  </font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font><font color="#008000"><i>&quot;| 07. Cadastro de Profiss&otilde;es      |\n&quot;</i></font><font color="#800080">)
  </font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font><font color="#008000"><i>&quot;| 08. Cadastro de Clientes        |\n&quot;</i></font><font color="#800080">)
  </font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font><font color="#008000"><i>&quot;| 09. Cadastro de Livros          |\n&quot;</i></font><font color="#800080">)
  </font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font><font color="#008000"><i>&quot;| 10. Voltar ao menu              |\n&quot;</i></font><font color="#800080">)
  </font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font><font color="#008000"><i>&quot;*---------------------------------*\n&quot;</i></font><font color="#800080">)
 </font><font color="#008000"><b>elsif </b></font><font color="#800080">(</font>num<font color="#800080">=</font><font color="#FF0000">3</font><font color="#800080">) </font><font color="#008000"><b>then
  </b></font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font><font color="#008000"><i>&quot;*---------------------------------*\n&quot;</i></font><font color="#800080">)
  </font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font><font color="#008000"><i>&quot;| 01. Consulta de Assuntos        |\n&quot;</i></font><font color="#800080">)
  </font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font><font color="#008000"><i>&quot;| 02. Consulta de Autores         |\n&quot;</i></font><font color="#800080">)
  </font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font><font color="#008000"><i>&quot;| 03. Consulta de Editoras        |\n&quot;</i></font><font color="#800080">)
  </font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font><font color="#008000"><i>&quot;| 04. Consulta de Endere&ccedil;os       |\n&quot;</i></font><font color="#800080">)
  </font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font><font color="#008000"><i>&quot;| 05. Consulta de Idiomas         |\n&quot;</i></font><font color="#800080">)
  </font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font><font color="#008000"><i>&quot;| 06. Consulta de Pa&iacute;ses          |\n&quot;</i></font><font color="#800080">)
  </font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font><font color="#008000"><i>&quot;| 07. Consulta de Profiss&otilde;es      |\n&quot;</i></font><font color="#800080">)
  </font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font><font color="#008000"><i>&quot;| 08. Consulta de Clientes        |\n&quot;</i></font><font color="#800080">)
  </font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font><font color="#008000"><i>&quot;| 09. Consulta de Livros          |\n&quot;</i></font><font color="#800080">)
  </font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font><font color="#008000"><i>&quot;| 10. Voltar ao menu              |\n&quot;</i></font><font color="#800080">)
  </font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font><font color="#008000"><i>&quot;*---------------------------------*\n&quot;</i></font><font color="#800080">)
 </font><font color="#008000"><b>elsif </b></font><font color="#800080">(</font>num<font color="#800080">=</font><font color="#FF0000">4</font><font color="#800080">) </font><font color="#008000"><b>then
  </b></font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font><font color="#008000"><i>&quot;*---------------------------------*\n&quot;</i></font><font color="#800080">)
  </font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font><font color="#008000"><i>&quot;| 01. Vender Livros               |\n&quot;</i></font><font color="#800080">)
  </font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font><font color="#008000"><i>&quot;| 02. Vendas Realizadas           |\n&quot;</i></font><font color="#800080">)
  </font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font><font color="#008000"><i>&quot;| 03. Voltar ao menu              |\n&quot;</i></font><font color="#800080">)
  </font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font><font color="#008000"><i>&quot;*---------------------------------*\n&quot;</i></font><font color="#800080">)
 </font><font color="#008000"><b>elsif </b></font><font color="#800080">(</font>num<font color="#800080">=</font><font color="#FF0000">5</font><font color="#800080">) </font><font color="#008000"><b>then
  </b></font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font><font color="#008000"><i>&quot;*---------------------------------*\n&quot;</i></font><font color="#800080">)
  </font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font><font color="#008000"><i>&quot;| 01. Alterar senha               |\n&quot;</i></font><font color="#800080">)
  </font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font><font color="#008000"><i>&quot;| 02. Sobre o sistema             |\n&quot;</i></font><font color="#800080">)
  </font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font><font color="#008000"><i>&quot;| 03. Sair do sistema             |\n&quot;</i></font><font color="#800080">)
  </font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font><font color="#008000"><i>&quot;| 04. Voltar ao menu              |\n&quot;</i></font><font color="#800080">)
  </font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font><font color="#008000"><i>&quot;*---------------------------------*\n&quot;</i></font><font color="#800080">)
 </font><font color="#008000"><b>elsif </b></font><font color="#800080">(</font>num<font color="#800080">=</font><font color="#FF0000">6</font><font color="#800080">) </font><font color="#008000"><b>then
  </b></font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font><font color="#008000"><i>&quot;*--------------------------------------------------------------*\n&quot;</i></font><font color="#800080">)
  </font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font><font color="#008000"><i>&quot;| (1) Novo  (2) Pesquisar   (3) Voltar ao menu                 |\n&quot;</i></font><font color="#800080">)
  </font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font><font color="#008000"><i>&quot;*--------------------------------------------------------------*\n&quot;</i></font><font color="#800080">)
 </font><font color="#008000"><b>elsif </b></font><font color="#800080">(</font>num<font color="#800080">=</font><font color="#FF0000">7</font><font color="#800080">) </font><font color="#008000"><b>then
  </b></font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font><font color="#008000"><i>&quot;*--------------------------------------------------------------*\n&quot;</i></font><font color="#800080">)
  </font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font><font color="#008000"><i>&quot;| (1) Salvar inclus&atilde;o       (2) Voltar ao menu                 |\n&quot;</i></font><font color="#800080">)
  </font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font><font color="#008000"><i>&quot;*--------------------------------------------------------------*\n&quot;</i></font><font color="#800080">)
 </font><font color="#008000"><b>elsif </b></font><font color="#800080">(</font>num<font color="#800080">=</font><font color="#FF0000">8</font><font color="#800080">) </font><font color="#008000"><b>then
  </b></font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font><font color="#008000"><i>&quot;*--------------------------------------------------------------*\n&quot;</i></font><font color="#800080">)
  </font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font><font color="#008000"><i>&quot;| (1) Alterar       (2) Excluir     (3) Voltar ao menu         |\n&quot;</i></font><font color="#800080">)
  </font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font><font color="#008000"><i>&quot;*--------------------------------------------------------------*\n&quot;</i></font><font color="#800080">)
 </font><font color="#008000"><b>elsif </b></font><font color="#800080">(</font>num<font color="#800080">=</font><font color="#FF0000">9</font><font color="#800080">) </font><font color="#008000"><b>then
  </b></font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font><font color="#008000"><i>&quot;*--------------------------------------------------------------*\n&quot;</i></font><font color="#800080">)
  </font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font><font color="#008000"><i>&quot;| (1) Salvar altera&ccedil;&atilde;o      (2) Voltar ao menu                 |\n&quot;</i></font><font color="#800080">)
  </font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font><font color="#008000"><i>&quot;*--------------------------------------------------------------*\n&quot;</i></font><font color="#800080">)
 </font><font color="#008000"><b>elsif </b></font><font color="#800080">(</font>num<font color="#800080">=</font><font color="#FF0000">10</font><font color="#800080">) </font><font color="#008000"><b>then
  </b></font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font><font color="#008000"><i>&quot;*--------------------------------------------------------------*\n&quot;</i></font><font color="#800080">)
  </font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font><font color="#008000"><i>&quot;| Certeza de excluir? (S/N)                                    |\n&quot;</i></font><font color="#800080">)
  </font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font><font color="#008000"><i>&quot;*--------------------------------------------------------------*\n&quot;</i></font><font color="#800080">)
 </font><font color="#008000"><b>elsif </b></font><font color="#800080">(</font>num<font color="#800080">=</font><font color="#FF0000">11</font><font color="#800080">) </font><font color="#008000"><b>then
  </b></font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font><font color="#008000"><i>&quot;*--------------------------------------------------------------*\n&quot;</i></font><font color="#800080">)
  </font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font><font color="#008000"><i>&quot;| Deseja sair do sistema? (S/N)                                |\n&quot;</i></font><font color="#800080">)
  </font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font><font color="#008000"><i>&quot;*--------------------------------------------------------------*\n&quot;</i></font><font color="#800080">)
 </font><font color="#008000"><b>elsif </b></font><font color="#800080">(</font>num<font color="#800080">=</font><font color="#FF0000">12</font><font color="#800080">) </font><font color="#008000"><b>then
  </b></font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font><font color="#008000"><i>&quot;*--------------------------------------------------------------*\n&quot;</i></font><font color="#800080">)
  </font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font><font color="#008000"><i>&quot;| (1) Pesquisar  (2) Listar todos   (3) Voltar ao menu         |\n&quot;</i></font><font color="#800080">)
  </font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font><font color="#008000"><i>&quot;*--------------------------------------------------------------*\n&quot;</i></font><font color="#800080">)
 </font><font color="#008000"><b>elsif </b></font><font color="#800080">(</font>num<font color="#800080">=</font><font color="#FF0000">13</font><font color="#800080">) </font><font color="#008000"><b>then
  </b></font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font><font color="#008000"><i>&quot;*--------------------------------------------------------------*\n&quot;</i></font><font color="#800080">)
  </font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font><font color="#008000"><i>&quot;| Deseja continuar? (S/N)                                      |\n&quot;</i></font><font color="#800080">)
  </font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font><font color="#008000"><i>&quot;*--------------------------------------------------------------*\n&quot;</i></font><font color="#800080">)
 </font><font color="#008000"><b>elsif </b></font><font color="#800080">(</font>num<font color="#800080">=</font><font color="#FF0000">14</font><font color="#800080">) </font><font color="#008000"><b>then
  </b></font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font><font color="#008000"><i>&quot;*--------------------------------------------------------------*\n&quot;</i></font><font color="#800080">)
  </font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font><font color="#008000"><i>&quot;| Salvar inclus&atilde;o (S/N)                                        |\n&quot;</i></font><font color="#800080">)
  </font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font><font color="#008000"><i>&quot;*--------------------------------------------------------------*\n&quot;</i></font><font color="#800080">)
 </font><font color="#008000"><b>end if
</b></font><font color="#808080"><i>-- puts(STDOUT, MSG_OPCAO)
 </i></font><font color="#008000"><b>return </b></font>MSG_OPCAO
<font color="#008000"><b>end function
</b></font><font color="#808080"><i>-- ----------------------------------------------------------------------------
-- Indica se continua ou n&atilde;o mostrando um n&uacute;mero m&aacute;ximo de linhas.
-- nlinha - a linha a ser continuada
-- nQtdLinha - a quantidade de linhas a serem mostradas
-- retorna - se continua ou n&atilde;o
-- ----------------------------------------------------------------------------
</i></font><font color="#008000"><b>function </b></font>ContinuaSN<font color="#800080">(</font><font color="#0000FF"><b>integer </b></font>nlinha<font color="#800080">, </font><font color="#0000FF"><b>integer </b></font>nQtdLinha<font color="#800080">)
</font>boolean bSOp<font color="#800080">, </font>bret 
<font color="#0000FF"><b>sequence </b></font>opCSubMenu

bret<font color="#800080">=</font>FALSE
<font color="#008000"><b>if </b></font>nlinha <font color="#800080">&gt; </font><font color="#FF0000">0 </font><font color="#008000"><b>then
  if </b></font><font color="#0000FF"><b>remainder</b></font><font color="#800080">(</font>nlinha<font color="#800080">, </font>nQtdLinha<font color="#800080">) = </font><font color="#FF0000">0 </font><font color="#008000"><b>then
      </b></font>bSOp<font color="#800080">=</font>TRUE
      <font color="#008000"><b>while </b></font>bSOp<font color="#800080">=</font>TRUE <font color="#008000"><b>do        
        </b></font>opCSubMenu <font color="#800080">= </font>digita<font color="#800080">(</font>menu<font color="#800080">(</font><font color="#FF0000">13</font><font color="#800080">), </font>FALSE<font color="#800080">)
        </font><font color="#008000"><b>if </b></font><font color="#0000FF"><b>equal</b></font><font color="#800080">(</font>opCSubMenu<font color="#800080">,</font><font color="#008000"><i>&quot;S&quot;</i></font><font color="#800080">) </font><font color="#008000"><b>or </b></font><font color="#0000FF"><b>equal</b></font><font color="#800080">(</font>opCSubMenu<font color="#800080">,</font><font color="#008000"><i>&quot;s&quot;</i></font><font color="#800080">) </font><font color="#008000"><b>then </b></font>bSOp<font color="#800080">=</font>FALSE
        <font color="#008000"><b>elsif </b></font><font color="#0000FF"><b>equal</b></font><font color="#800080">(</font>opCSubMenu<font color="#800080">,</font><font color="#008000"><i>&quot;N&quot;</i></font><font color="#800080">) </font><font color="#008000"><b>or </b></font><font color="#0000FF"><b>equal</b></font><font color="#800080">(</font>opCSubMenu<font color="#800080">,</font><font color="#008000"><i>&quot;n&quot;</i></font><font color="#800080">) </font><font color="#008000"><b>then
          </b></font>bret<font color="#800080">=</font>TRUE
          bSOp<font color="#800080">=</font>FALSE
        <font color="#008000"><b>else </b></font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDERR<font color="#800080">, </font>MSG_ERRO<font color="#800080">)
        </font><font color="#008000"><b>end if 
      end while
  end if
end if

return </b></font>bret
<font color="#008000"><b>end function
</b></font><font color="#808080"><i>-- ----------------------------------------------------------------------------
-- Necess&aacute;rio para retirar a refer&ecirc;ncia circular
-- Valida a entrada de registros de acordo com a pesquisa feita.
-- sArq - o arquivo
-- sreg - o tipo de arquivo
-- nTexto - o numero do r&oacute;tulo da entrada
-- sEntrada - a chave a ser pesquisada e validada
-- nTentativas - o n&uacute;mero m&aacute;ximo de tentativas
-- bTipoEntrada - indica o tipo de entrada
-- retorna - o registro pesquisado e validado
-- ----------------------------------------------------------------------------
</i></font><font color="#008000"><b>function </b></font>validaEntrada2<font color="#800080">(</font>tarquivo sArq<font color="#800080">, </font>ctArqs sreg<font color="#800080">, </font><font color="#0000FF"><b>integer </b></font>nTexto<font color="#800080">,
        </font><font color="#0000FF"><b>sequence </b></font>sEntrada<font color="#800080">, </font><font color="#0000FF"><b>integer </b></font>nTentativas<font color="#800080">, </font>ctTipo bTipoEntrada<font color="#800080">)
</font>boolean bQuebra
<font color="#0000FF"><b>sequence </b></font>sres<font color="#800080">, </font>sTexto<font color="#800080">, </font>sMsgErro
<font color="#0000FF"><b>integer </b></font>ncont<font color="#800080">, </font>nPosChave<font color="#800080">, </font>nTamChave<font color="#800080">, </font>nTamLinha

nTamLinha<font color="#800080">=</font>tamReg<font color="#800080">(</font>sreg<font color="#800080">)
</font>sMsgErro<font color="#800080">=</font>rotulo<font color="#800080">(</font>sreg<font color="#800080">,</font><font color="#FF0000">0</font><font color="#800080">)
</font>sTexto<font color="#800080">=</font>rotulo<font color="#800080">(</font>sreg<font color="#800080">,</font>nTexto<font color="#800080">)
</font>nPosChave<font color="#800080">=</font>g_nPosChave
nTamChave<font color="#800080">=</font>g_nTamChave

ncont<font color="#800080">=</font><font color="#FF0000">1
</font>bQuebra<font color="#800080">=</font>FALSE
  <font color="#008000"><b>while </b></font><font color="#800080">(</font>bQuebra<font color="#800080">=</font>FALSE<font color="#800080">) </font><font color="#008000"><b>and </b></font><font color="#800080">(</font>ncont <font color="#800080">&lt;= </font>nTentativas <font color="#800080">) </font><font color="#008000"><b>do
    if </b></font>bTipoEntrada<font color="#800080">=</font>opTexto <font color="#008000"><b>then
      </b></font>sEntrada <font color="#800080">= </font>digita<font color="#800080">(</font>sTexto<font color="#800080">, </font>FALSE<font color="#800080">)
    </font><font color="#008000"><b>elsif </b></font>bTipoEntrada<font color="#800080">=</font>opNumero <font color="#008000"><b>then
       </b></font>sEntrada<font color="#800080">=</font>validaNumero<font color="#800080">(</font>sTexto<font color="#800080">, </font>sEntrada<font color="#800080">)
    </font><font color="#008000"><b>elsif </b></font>bTipoEntrada<font color="#800080">=</font>opData <font color="#008000"><b>then
       </b></font>sEntrada<font color="#800080">=</font>validaDataHora<font color="#800080">(</font>sTexto<font color="#800080">, </font>sEntrada<font color="#800080">, </font>TRUE<font color="#800080">)
    </font><font color="#008000"><b>elsif </b></font>bTipoEntrada<font color="#800080">=</font>opDataHora <font color="#008000"><b>then
       </b></font>sEntrada<font color="#800080">=</font>validaDataHora<font color="#800080">(</font>sTexto<font color="#800080">, </font>sEntrada<font color="#800080">, </font>FALSE<font color="#800080">)
    </font><font color="#008000"><b>elsif </b></font>bTipoEntrada<font color="#800080">=</font>opSenha <font color="#008000"><b>then
       </b></font>sEntrada<font color="#800080">=</font>digitaSenha<font color="#800080">(</font>sTexto<font color="#800080">, </font><font color="#FF0000">10</font><font color="#800080">)
    </font><font color="#008000"><b>end if

    </b></font>sres<font color="#800080">=</font>pesqArq<font color="#800080">(</font>sArq<font color="#800080">, </font>sEntrada<font color="#800080">, </font>nPosChave<font color="#800080">, </font>nTamChave<font color="#800080">, </font>nTamLinha<font color="#800080">)

    </font><font color="#008000"><b>if </b></font><font color="#0000FF"><b>equal</b></font><font color="#800080">(</font>sres<font color="#800080">,</font><font color="#008000"><i>&quot;&quot;</i></font><font color="#800080">) </font><font color="#008000"><b>then
       </b></font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDERR<font color="#800080">, </font>sMsgErro<font color="#800080">)
    </font><font color="#008000"><b>else
       </b></font>bQuebra<font color="#800080">=</font>TRUE
    <font color="#008000"><b>end if

    </b></font>ncont<font color="#800080">=</font>ncont<font color="#800080">+</font><font color="#FF0000">1
  </font><font color="#008000"><b>end while
return </b></font>sres
<font color="#008000"><b>end function

</b></font><font color="#808080"><i>-- ----------------------------------------------------------------------------
-- Mostra as sub inform&ccedil;&otilde;es de entrada e de sa&iacute;da.
-- sreg - o tipo de arquivo
-- ssubreg - o subtipo de arquivo
-- bSoMostrar - se vai s&oacute; mostrar na sa&iacute;da 
-- ----------------------------------------------------------------------------
</i></font><font color="#008000"><b>procedure </b></font>mostrarSubDados<font color="#800080">(</font>ctArqs sreg<font color="#800080">, </font>ctArqs ssubreg<font color="#800080">, </font>boolean bSoMostrar<font color="#800080">)
</font><font color="#0000FF"><b>sequence </b></font>sRegistro<font color="#800080">, </font>sPreco
<font color="#0000FF"><b>integer </b></font>nMaxTentativas

nMaxTentativas<font color="#800080">=</font><font color="#FF0000">3
</font><font color="#008000"><b>if </b></font>sreg<font color="#800080">=</font>opLivro <font color="#008000"><b>then
  if </b></font>ssubreg<font color="#800080">=</font>opEditora <font color="#008000"><b>then
    if </b></font>bSoMostrar <font color="#008000"><b>then
       </b></font>sRegistro<font color="#800080">=</font>pesqArq<font color="#800080">(</font>tfEditora<font color="#800080">,</font>tLivro<font color="#800080">[</font>CODEDITORA<font color="#800080">],</font><font color="#FF0000">1</font><font color="#800080">,</font><font color="#FF0000">10</font><font color="#800080">,</font>tamReg<font color="#800080">(</font>opEditora<font color="#800080">))
    </font><font color="#008000"><b>else
       </b></font>sRegistro<font color="#800080">=</font>validaEntrada2<font color="#800080">(</font>tfEditora<font color="#800080">,</font>ssubreg<font color="#800080">,</font><font color="#FF0000">1</font><font color="#800080">,</font>tLivro<font color="#800080">[</font>CODEDITORA<font color="#800080">],
                  </font>nMaxTentativas<font color="#800080">,</font>opNumero<font color="#800080">)
    </font><font color="#008000"><b>end if
    if </b></font><font color="#0000FF"><b>equal</b></font><font color="#800080">(</font>sRegistro<font color="#800080">,</font><font color="#008000"><i>&quot;&quot;</i></font><font color="#800080">)=</font>FALSE <font color="#008000"><b>then
      </b></font>tLivro<font color="#800080">[</font>CODEDITORA<font color="#800080">]=</font>trim<font color="#800080">(</font>copy<font color="#800080">(</font>sRegistro<font color="#800080">,</font><font color="#FF0000">1</font><font color="#800080">,</font><font color="#FF0000">10</font><font color="#800080">))
      </font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font><font color="#008000"><i>&quot; &quot; </i></font><font color="#800080">&amp; </font>rotulo<font color="#800080">(</font>opEditora<font color="#800080">, </font><font color="#FF0000">2</font><font color="#800080">))
      </font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">,</font>copy<font color="#800080">(</font>sRegistro<font color="#800080">, </font>g_nPosChave<font color="#800080">, </font>g_nTamChave<font color="#800080">) &amp; </font><font color="#008000"><i>&quot;\n&quot;</i></font><font color="#800080">)
    </font><font color="#008000"><b>end if
  elsif </b></font>ssubreg<font color="#800080">=</font>opIdioma <font color="#008000"><b>then
    if </b></font>bSoMostrar <font color="#008000"><b>then
       </b></font>sRegistro<font color="#800080">=</font>pesqArq<font color="#800080">(</font>tfIdioma<font color="#800080">, </font>tLivro<font color="#800080">[</font>CODIDIOMA<font color="#800080">], </font><font color="#FF0000">1</font><font color="#800080">, </font><font color="#FF0000">10</font><font color="#800080">,</font>tamReg<font color="#800080">(</font>opIdioma<font color="#800080">))
    </font><font color="#008000"><b>else
       </b></font>sRegistro<font color="#800080">=</font>validaEntrada2<font color="#800080">(</font>tfIdioma<font color="#800080">,</font>ssubreg<font color="#800080">,</font><font color="#FF0000">1</font><font color="#800080">,</font>tLivro<font color="#800080">[</font>CODIDIOMA<font color="#800080">],
                  </font>nMaxTentativas<font color="#800080">,</font>opNumero<font color="#800080">)
    </font><font color="#008000"><b>end if
    if </b></font><font color="#0000FF"><b>equal</b></font><font color="#800080">(</font>sRegistro<font color="#800080">,</font><font color="#008000"><i>&quot;&quot;</i></font><font color="#800080">)=</font>FALSE <font color="#008000"><b>then
      </b></font>tLivro<font color="#800080">[</font>CODIDIOMA<font color="#800080">]=</font>trim<font color="#800080">(</font>copy<font color="#800080">(</font>sRegistro<font color="#800080">,</font><font color="#FF0000">1</font><font color="#800080">,</font><font color="#FF0000">10</font><font color="#800080">))
      </font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font><font color="#008000"><i>&quot; &quot; </i></font><font color="#800080">&amp; </font>rotulo<font color="#800080">(</font>opIdioma<font color="#800080">, </font><font color="#FF0000">2</font><font color="#800080">))
      </font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">,</font>copy<font color="#800080">(</font>sRegistro<font color="#800080">, </font>g_nPosChave<font color="#800080">, </font>g_nTamChave<font color="#800080">) &amp; </font><font color="#008000"><i>&quot;\n&quot;</i></font><font color="#800080">)
    </font><font color="#008000"><b>end if
  end if
elsif </b></font>sreg<font color="#800080">=</font>opCliente <font color="#008000"><b>then
  if </b></font>ssubreg<font color="#800080">=</font>opEndereco <font color="#008000"><b>then
    if </b></font>bSoMostrar <font color="#008000"><b>then
       </b></font>sRegistro<font color="#800080">=</font>pesqArq<font color="#800080">(</font>tfEndereco<font color="#800080">, </font>tCliente<font color="#800080">[</font>CODENDERECO<font color="#800080">], </font><font color="#FF0000">1</font><font color="#800080">, </font><font color="#FF0000">10</font><font color="#800080">,
                  </font>tamReg<font color="#800080">(</font>opEndereco<font color="#800080">))
    </font><font color="#008000"><b>else
       </b></font>sRegistro<font color="#800080">=</font>validaEntrada2<font color="#800080">(</font>tfEndereco<font color="#800080">,</font>ssubreg<font color="#800080">,</font><font color="#FF0000">1</font><font color="#800080">,</font>tCliente<font color="#800080">[</font>CODENDERECO<font color="#800080">],
                  </font>nMaxTentativas<font color="#800080">,</font>opNumero<font color="#800080">)
    </font><font color="#008000"><b>end if
    if </b></font><font color="#0000FF"><b>equal</b></font><font color="#800080">(</font>sRegistro<font color="#800080">,</font><font color="#008000"><i>&quot;&quot;</i></font><font color="#800080">)=</font>FALSE <font color="#008000"><b>then
      </b></font>tCliente<font color="#800080">[</font>CODENDERECO<font color="#800080">]=</font>trim<font color="#800080">(</font>copy<font color="#800080">(</font>sRegistro<font color="#800080">,</font><font color="#FF0000">1</font><font color="#800080">,</font><font color="#FF0000">10</font><font color="#800080">))
      </font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">,</font><font color="#008000"><i>&quot; &quot; </i></font><font color="#800080">&amp; </font>rotulo<font color="#800080">(</font>opEndereco<font color="#800080">, </font><font color="#FF0000">2</font><font color="#800080">))
      </font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">,</font>copy<font color="#800080">(</font>sRegistro<font color="#800080">, </font>g_nPosChave<font color="#800080">, </font>g_nTamChave<font color="#800080">) &amp; </font><font color="#008000"><i>&quot;\n&quot;</i></font><font color="#800080">)
      </font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">,</font><font color="#008000"><i>&quot; &quot; </i></font><font color="#800080">&amp; </font>rotulo<font color="#800080">(</font>opEndereco<font color="#800080">, </font><font color="#FF0000">3</font><font color="#800080">))
      </font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">,</font>copy<font color="#800080">(</font>sRegistro<font color="#800080">, </font>g_nPosChave<font color="#800080">, </font>g_nTamChave<font color="#800080">) &amp; </font><font color="#008000"><i>&quot;\n&quot;</i></font><font color="#800080">)
      </font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">,</font><font color="#008000"><i>&quot; &quot; </i></font><font color="#800080">&amp; </font>rotulo<font color="#800080">(</font>opEndereco<font color="#800080">, </font><font color="#FF0000">4</font><font color="#800080">))
      </font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">,</font>copy<font color="#800080">(</font>sRegistro<font color="#800080">, </font>g_nPosChave<font color="#800080">, </font>g_nTamChave<font color="#800080">) &amp; </font><font color="#008000"><i>&quot;\n&quot;</i></font><font color="#800080">)
      </font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">,</font><font color="#008000"><i>&quot; &quot; </i></font><font color="#800080">&amp; </font>rotulo<font color="#800080">(</font>opEndereco<font color="#800080">, </font><font color="#FF0000">5</font><font color="#800080">))
      </font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">,</font>copy<font color="#800080">(</font>sRegistro<font color="#800080">, </font>g_nPosChave<font color="#800080">, </font>g_nTamChave<font color="#800080">) &amp; </font><font color="#008000"><i>&quot;\n&quot;</i></font><font color="#800080">)
      </font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">,</font><font color="#008000"><i>&quot; &quot; </i></font><font color="#800080">&amp; </font>rotulo<font color="#800080">(</font>opEndereco<font color="#800080">, </font><font color="#FF0000">6</font><font color="#800080">))
      </font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">,</font>copy<font color="#800080">(</font>sRegistro<font color="#800080">, </font>g_nPosChave<font color="#800080">, </font>g_nTamChave<font color="#800080">) &amp; </font><font color="#008000"><i>&quot;\n&quot;</i></font><font color="#800080">)
    </font><font color="#008000"><b>end if
  elsif </b></font>ssubreg<font color="#800080">=</font>opPais <font color="#008000"><b>then
    if </b></font>bSoMostrar <font color="#008000"><b>then
       </b></font>sRegistro<font color="#800080">=</font>pesqArq<font color="#800080">(</font>tfPais<font color="#800080">, </font>tCliente<font color="#800080">[</font>CODPAIS<font color="#800080">], </font><font color="#FF0000">1</font><font color="#800080">, </font><font color="#FF0000">3</font><font color="#800080">, </font>tamReg<font color="#800080">(</font>opPais<font color="#800080">))
    </font><font color="#008000"><b>else
       </b></font>sRegistro<font color="#800080">=</font>validaEntrada2<font color="#800080">(</font>tfPais<font color="#800080">,</font>ssubreg<font color="#800080">,</font><font color="#FF0000">1</font><font color="#800080">,</font>tCliente<font color="#800080">[</font>CODPAIS<font color="#800080">],
                  </font>nMaxTentativas<font color="#800080">,</font>opTexto<font color="#800080">)
    </font><font color="#008000"><b>end if
    if </b></font><font color="#0000FF"><b>equal</b></font><font color="#800080">(</font>sRegistro<font color="#800080">,</font><font color="#008000"><i>&quot;&quot;</i></font><font color="#800080">)=</font>FALSE <font color="#008000"><b>then
      </b></font>tCliente<font color="#800080">[</font>CODPAIS<font color="#800080">]=</font>trim<font color="#800080">(</font>copy<font color="#800080">(</font>sRegistro<font color="#800080">,</font><font color="#FF0000">1</font><font color="#800080">,</font><font color="#FF0000">3</font><font color="#800080">))
      </font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">,</font><font color="#008000"><i>&quot; &quot; </i></font><font color="#800080">&amp; </font>rotulo<font color="#800080">(</font>opPais<font color="#800080">, </font><font color="#FF0000">2</font><font color="#800080">))
      </font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">,</font>copy<font color="#800080">(</font>sRegistro<font color="#800080">, </font>g_nPosChave<font color="#800080">, </font>g_nTamChave<font color="#800080">) &amp; </font><font color="#008000"><i>&quot;\n&quot;</i></font><font color="#800080">)
    </font><font color="#008000"><b>end if
  elsif </b></font>ssubreg<font color="#800080">=</font>opProfissao <font color="#008000"><b>then
    if </b></font>bSoMostrar <font color="#008000"><b>then
       </b></font>sRegistro<font color="#800080">=</font>pesqArq<font color="#800080">(</font>tfProfissao<font color="#800080">, </font>tCliente<font color="#800080">[</font>CODPROFISSAO<font color="#800080">], </font><font color="#FF0000">1</font><font color="#800080">, </font><font color="#FF0000">10</font><font color="#800080">,
                  </font>tamReg<font color="#800080">(</font>opProfissao<font color="#800080">))
    </font><font color="#008000"><b>else
       </b></font>sRegistro<font color="#800080">=</font>validaEntrada2<font color="#800080">(</font>tfProfissao<font color="#800080">,</font>ssubreg<font color="#800080">,</font><font color="#FF0000">1</font><font color="#800080">,</font>tCliente<font color="#800080">[</font>CODPROFISSAO<font color="#800080">],
                  </font>nMaxTentativas<font color="#800080">,</font>opNumero<font color="#800080">)
    </font><font color="#008000"><b>end if
    if </b></font><font color="#0000FF"><b>equal</b></font><font color="#800080">(</font>sRegistro<font color="#800080">,</font><font color="#008000"><i>&quot;&quot;</i></font><font color="#800080">)=</font>FALSE <font color="#008000"><b>then
      </b></font>tCliente<font color="#800080">[</font>CODPROFISSAO<font color="#800080">]=</font>trim<font color="#800080">(</font>copy<font color="#800080">(</font>sRegistro<font color="#800080">,</font><font color="#FF0000">1</font><font color="#800080">,</font><font color="#FF0000">10</font><font color="#800080">))
      </font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">,</font><font color="#008000"><i>&quot; &quot; </i></font><font color="#800080">&amp; </font>rotulo<font color="#800080">(</font>opProfissao<font color="#800080">, </font><font color="#FF0000">2</font><font color="#800080">))
      </font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">,</font>copy<font color="#800080">(</font>sRegistro<font color="#800080">, </font>g_nPosChave<font color="#800080">, </font>g_nTamChave<font color="#800080">) &amp; </font><font color="#008000"><i>&quot;\n&quot;</i></font><font color="#800080">)
    </font><font color="#008000"><b>end if
  end if
elsif </b></font>sreg<font color="#800080">=</font>opVenda <font color="#008000"><b>then
  </b></font>sRegistro<font color="#800080">=</font>pesqArq<font color="#800080">(</font>tfLivro<font color="#800080">, </font>tVenda<font color="#800080">[</font>ISBNVENDA<font color="#800080">], </font><font color="#FF0000">1</font><font color="#800080">, </font><font color="#FF0000">13</font><font color="#800080">, </font>tamReg<font color="#800080">(</font>opLivro<font color="#800080">))
  </font><font color="#008000"><b>if </b></font><font color="#0000FF"><b>equal</b></font><font color="#800080">(</font>sRegistro<font color="#800080">,</font><font color="#008000"><i>&quot;&quot;</i></font><font color="#800080">)=</font>FALSE <font color="#008000"><b>then
    </b></font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">,</font><font color="#008000"><i>&quot; &quot; </i></font><font color="#800080">&amp; </font>rotulo<font color="#800080">(</font>opLivro<font color="#800080">, </font><font color="#FF0000">2</font><font color="#800080">)) </font><font color="#808080"><i>-- Titulo -- 
    </i></font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">,</font>copy<font color="#800080">(</font>sRegistro<font color="#800080">, </font>g_nPosChave<font color="#800080">, </font>g_nTamChave<font color="#800080">) &amp; </font><font color="#008000"><i>&quot;\n&quot;</i></font><font color="#800080">)
    </font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">,</font><font color="#008000"><i>&quot; &quot; </i></font><font color="#800080">&amp; </font>rotulo<font color="#800080">(</font>opLivro<font color="#800080">, </font><font color="#FF0000">9</font><font color="#800080">)) </font><font color="#808080"><i>-- Preco --
    </i></font>sPreco<font color="#800080">=</font>trim<font color="#800080">(</font>copy<font color="#800080">(</font>sRegistro<font color="#800080">, </font>g_nPosChave<font color="#800080">, </font>g_nTamChave<font color="#800080">))
    </font>g_nPreco<font color="#800080">=</font>StrToNum<font color="#800080">(</font>sPreco<font color="#800080">)
    </font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font>sPreco <font color="#800080">&amp; </font><font color="#008000"><i>&quot;\n&quot;</i></font><font color="#800080">)
  </font><font color="#008000"><b>end if
end if
end procedure
</b></font><font color="#808080"><i>-- ----------------------------------------------------------------------------
-- Lista v&aacute;rios registros entre arquivos de acordo com a pesquisa feita.
-- sArq1 - o arquivo de liga&ccedil;&atilde;o
-- sreg1 - o tipo de arquivo de liga&ccedil;&atilde;o
-- nPosChave1 - a posicao inicial da primeira chave no arquivo de liga&ccedil;&atilde;o
-- nTamChave1 - o tamanho da primeira chave no arquivo de liga&ccedil;&atilde;o
-- nPosChave2 - a posicao inicial da segunda chave do arquivo de liga&ccedil;&atilde;o
-- nTamChave2 - o tamanho da segunda chave do arquivo de liga&ccedil;&atilde;o
-- sChave - a chave a ser pesquisada no arquivo de liga&ccedil;&atilde;o
-- sArq2 - o arquivo a ser pesquisado
-- sreg2 - o tipo de arquivo a ser pesquisado
-- nPosChave3 - a posicao inicial da chave do arquivo pesquisado
-- nQtdLinha - a quantidade de linhas a serem mostradas
-- ----------------------------------------------------------------------------
</i></font><font color="#008000"><b>procedure </b></font>ListarRegLigados<font color="#800080">(</font>tarquivo sArq1<font color="#800080">, </font><font color="#0000FF"><b>integer </b></font>nPosChave1<font color="#800080">,
</font><font color="#0000FF"><b>integer </b></font>nTamChave1<font color="#800080">, </font><font color="#0000FF"><b>integer </b></font>nPosChave2<font color="#800080">, </font><font color="#0000FF"><b>integer </b></font>nTamChave2<font color="#800080">, </font><font color="#0000FF"><b>sequence </b></font>sChave<font color="#800080">,
</font>tarquivo sArq2<font color="#800080">, </font>ctArqs sreg2<font color="#800080">, </font><font color="#0000FF"><b>integer </b></font>nPosChave3<font color="#800080">, </font><font color="#0000FF"><b>integer </b></font>nQtdLinha<font color="#800080">)
</font><font color="#0000FF"><b>object </b></font>slinha1
boolean bQuebra<font color="#800080">, </font>bRet 
<font color="#0000FF"><b>integer </b></font>nCont<font color="#800080">, </font>nstatus
<font color="#0000FF"><b>sequence </b></font>slocal1<font color="#800080">, </font>sCodigo1<font color="#800080">, </font>sCodigo2<font color="#800080">, </font>slinha2<font color="#800080">, </font>slinha

bRet<font color="#800080">=</font>FALSE
nCont<font color="#800080">=</font><font color="#FF0000">0
</font>bQuebra<font color="#800080">=</font>FALSE

<font color="#808080"><i>-- necess&aacute;rio para retirar a refer&ecirc;ncia circular
-- mostrarDados(sreg2, &quot;&quot;, 2)
</i></font><font color="#008000"><b>if </b></font>sreg2 <font color="#800080">= </font>opAssunto <font color="#008000"><b>then
  </b></font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font><font color="#008000"><i>&quot;C&oacute;digo     Assunto\n&quot;</i></font><font color="#800080">)
  </font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font><font color="#008000"><i>&quot;------     -------\n&quot;</i></font><font color="#800080">)
</font><font color="#008000"><b>elsif </b></font>sreg2 <font color="#800080">= </font>opAutor <font color="#008000"><b>then
  </b></font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font><font color="#008000"><i>&quot;C&oacute;digo     Autor\n&quot;</i></font><font color="#800080">)
  </font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font><font color="#008000"><i>&quot;------     -----\n&quot;</i></font><font color="#800080">)
</font><font color="#008000"><b>end if

</b></font>nstatus <font color="#800080">= </font><font color="#0000FF">seek</font><font color="#800080">(</font>sArq1<font color="#800080">, </font><font color="#FF0000">0</font><font color="#800080">)
</font><font color="#008000"><b>while </b></font>bQuebra<font color="#800080">=</font>FALSE <font color="#008000"><b>do
  </b></font>slinha1 <font color="#800080">= </font><font color="#0000FF"><b>gets</b></font><font color="#800080">(</font>sArq1<font color="#800080">)
  </font><font color="#008000"><b>if </b></font><font color="#0000FF"><b>atom</b></font><font color="#800080">(</font>slinha1<font color="#800080">) </font><font color="#008000"><b>then
    exit 
  end if
  if </b></font><font color="#0000FF"><b>length</b></font><font color="#800080">(</font>slinha1<font color="#800080">) &gt; </font><font color="#FF0000">0 </font><font color="#008000"><b>then
    </b></font>slocal1 <font color="#800080">= </font>slinha1
    sCodigo1<font color="#800080">=</font>trim<font color="#800080">(</font>copy<font color="#800080">(</font>slocal1<font color="#800080">,</font>nPosChave1<font color="#800080">,</font>nTamChave1<font color="#800080">))
    </font><font color="#008000"><b>if </b></font><font color="#0000FF"><b>equal</b></font><font color="#800080">(</font>sCodigo1<font color="#800080">,</font>sChave<font color="#800080">) </font><font color="#008000"><b>then
      </b></font>sCodigo2<font color="#800080">=</font>trim<font color="#800080">(</font>copy<font color="#800080">(</font>slocal1<font color="#800080">,</font>nPosChave2<font color="#800080">,</font>nTamChave2<font color="#800080">))
      </font>slinha2<font color="#800080">=</font>pesqArq<font color="#800080">(</font>sArq2<font color="#800080">, </font>sCodigo2<font color="#800080">, </font>nPosChave3<font color="#800080">, </font>nTamChave2<font color="#800080">, </font>tamReg<font color="#800080">(</font>sreg2<font color="#800080">))
  
  </font><font color="#808080"><i>--  necess&aacute;rio para retirar a refer&ecirc;ncia circular
  --  mostrarDados(sreg2, copy(slinha2, 1, tamReg(sreg2)), 3)
      </i></font>slinha <font color="#800080">= </font>copy<font color="#800080">(</font>slinha2<font color="#800080">, </font><font color="#FF0000">1</font><font color="#800080">, </font>tamReg<font color="#800080">(</font>sreg2<font color="#800080">))
      </font><font color="#008000"><b>if </b></font>sreg2 <font color="#800080">= </font>opAssunto <font color="#008000"><b>then
        </b></font>tAssunto<font color="#800080">[</font>CODIGO<font color="#800080">]=</font>copy<font color="#800080">(</font>slinha<font color="#800080">, </font><font color="#FF0000">1</font><font color="#800080">, </font><font color="#FF0000">10</font><font color="#800080">)
        </font>tAssunto<font color="#800080">[</font>ASSUNTO<font color="#800080">]=</font>copy<font color="#800080">(</font>slinha<font color="#800080">, </font><font color="#FF0000">11</font><font color="#800080">, </font><font color="#FF0000">30</font><font color="#800080">)
        </font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font>tAssunto<font color="#800080">[</font>CODIGO<font color="#800080">] &amp; </font><font color="#008000"><i>&quot; &quot; </i></font><font color="#800080">&amp; </font>tAssunto<font color="#800080">[</font>ASSUNTO<font color="#800080">] &amp; </font><font color="#008000"><i>&quot;\n&quot;</i></font><font color="#800080">)
      </font><font color="#008000"><b>elsif </b></font>sreg2 <font color="#800080">= </font>opAutor <font color="#008000"><b>then
        </b></font>tAutor<font color="#800080">[</font>CODIGO<font color="#800080">]=</font>copy<font color="#800080">(</font>slinha<font color="#800080">, </font><font color="#FF0000">1</font><font color="#800080">, </font><font color="#FF0000">10</font><font color="#800080">)
        </font>tAutor<font color="#800080">[</font>AUTOR<font color="#800080">]=</font>copy<font color="#800080">(</font>slinha<font color="#800080">, </font><font color="#FF0000">11</font><font color="#800080">, </font><font color="#FF0000">30</font><font color="#800080">)
        </font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font>tAutor<font color="#800080">[</font>CODIGO<font color="#800080">] &amp; </font><font color="#008000"><i>&quot; &quot; </i></font><font color="#800080">&amp; </font>tAutor<font color="#800080">[</font>AUTOR<font color="#800080">] &amp; </font><font color="#008000"><i>&quot;\n&quot;</i></font><font color="#800080">)
      </font><font color="#008000"><b>end if
  
      </b></font>bRet<font color="#800080">=</font>TRUE
      nCont<font color="#800080">=</font>nCont<font color="#800080">+</font><font color="#FF0000">1
    </font><font color="#008000"><b>end if
    </b></font>bQuebra<font color="#800080">=</font>ContinuaSN<font color="#800080">(</font>nCont<font color="#800080">, </font>nQtdLinha<font color="#800080">)
  </font><font color="#008000"><b>end if
end while
if </b></font>bRet<font color="#800080">=</font>FALSE <font color="#008000"><b>then
   </b></font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font>rotulo<font color="#800080">(</font>sreg2<font color="#800080">,</font><font color="#FF0000">0</font><font color="#800080">))
</font><font color="#008000"><b>end if
end procedure
</b></font><font color="#808080"><i>-- ----------------------------------------------------------------------------
-- Mostra as entradas e as sa&iacute;das do sistema.
-- sreg - o tipo de arquivo
-- slinha - o registro com os dados
-- nOpcao - indica qual op&ccedil;&atilde;o ser&aacute; mostrada
-- ----------------------------------------------------------------------------
</i></font><font color="#008000"><b>procedure </b></font>mostrarDados<font color="#800080">(</font>ctArqs sreg<font color="#800080">, </font><font color="#0000FF"><b>sequence </b></font>slinha<font color="#800080">, </font><font color="#0000FF"><b>integer </b></font>nOpcao<font color="#800080">)
</font><font color="#008000"><b>if </b></font>sreg<font color="#800080">=</font>opAssunto <font color="#008000"><b>then
   if </b></font>nOpcao <font color="#800080">= </font><font color="#FF0000">1 </font><font color="#008000"><b>then
        </b></font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font>rotulo<font color="#800080">(</font>sreg<font color="#800080">, </font><font color="#FF0000">1</font><font color="#800080">) &amp; </font>tAssunto<font color="#800080">[</font>CODIGO<font color="#800080">] &amp; </font><font color="#008000"><i>&quot;\n&quot;</i></font><font color="#800080">)
        </font>tAssunto<font color="#800080">[</font>ASSUNTO<font color="#800080">] = </font>digita<font color="#800080">(</font>rotulo<font color="#800080">(</font>sreg<font color="#800080">, </font><font color="#FF0000">2</font><font color="#800080">), </font>FALSE<font color="#800080">)
   </font><font color="#008000"><b>elsif </b></font>nOpcao <font color="#800080">= </font><font color="#FF0000">2 </font><font color="#008000"><b>then
        </b></font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font><font color="#008000"><i>&quot;C&oacute;digo     Assunto\n&quot;</i></font><font color="#800080">)
        </font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font><font color="#008000"><i>&quot;------     -------\n&quot;</i></font><font color="#800080">)
   </font><font color="#008000"><b>elsif </b></font>nOpcao <font color="#800080">= </font><font color="#FF0000">3 </font><font color="#008000"><b>then
        </b></font>tAssunto<font color="#800080">[</font>CODIGO<font color="#800080">]=</font>copy<font color="#800080">(</font>slinha<font color="#800080">, </font><font color="#FF0000">1</font><font color="#800080">, </font><font color="#FF0000">10</font><font color="#800080">)
        </font>tAssunto<font color="#800080">[</font>ASSUNTO<font color="#800080">]=</font>copy<font color="#800080">(</font>slinha<font color="#800080">, </font><font color="#FF0000">11</font><font color="#800080">, </font><font color="#FF0000">30</font><font color="#800080">)
        </font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font>tAssunto<font color="#800080">[</font>CODIGO<font color="#800080">] &amp; </font><font color="#008000"><i>&quot; &quot; </i></font><font color="#800080">&amp; </font>tAssunto<font color="#800080">[</font>ASSUNTO<font color="#800080">] &amp; </font><font color="#008000"><i>&quot;\n&quot;</i></font><font color="#800080">)
   </font><font color="#008000"><b>end if
elsif </b></font>sreg<font color="#800080">=</font>opAutor <font color="#008000"><b>then
   if </b></font>nOpcao <font color="#800080">= </font><font color="#FF0000">1 </font><font color="#008000"><b>then
        </b></font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font>rotulo<font color="#800080">(</font>sreg<font color="#800080">, </font><font color="#FF0000">1</font><font color="#800080">) &amp; </font>tAutor<font color="#800080">[</font>CODIGO<font color="#800080">] &amp; </font><font color="#008000"><i>&quot;\n&quot;</i></font><font color="#800080">)
        </font>tAutor<font color="#800080">[</font>AUTOR<font color="#800080">] = </font>digita<font color="#800080">(</font>rotulo<font color="#800080">(</font>sreg<font color="#800080">, </font><font color="#FF0000">2</font><font color="#800080">), </font>FALSE<font color="#800080">)
   </font><font color="#008000"><b>elsif </b></font>nOpcao <font color="#800080">= </font><font color="#FF0000">2 </font><font color="#008000"><b>then
        </b></font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font><font color="#008000"><i>&quot;C&oacute;digo     Autor\n&quot;</i></font><font color="#800080">)
        </font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font><font color="#008000"><i>&quot;------     -----\n&quot;</i></font><font color="#800080">)
   </font><font color="#008000"><b>elsif </b></font>nOpcao <font color="#800080">= </font><font color="#FF0000">3 </font><font color="#008000"><b>then
        </b></font>tAutor<font color="#800080">[</font>CODIGO<font color="#800080">]=</font>copy<font color="#800080">(</font>slinha<font color="#800080">, </font><font color="#FF0000">1</font><font color="#800080">, </font><font color="#FF0000">10</font><font color="#800080">)
        </font>tAutor<font color="#800080">[</font>AUTOR<font color="#800080">]=</font>copy<font color="#800080">(</font>slinha<font color="#800080">, </font><font color="#FF0000">11</font><font color="#800080">, </font><font color="#FF0000">30</font><font color="#800080">)
        </font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font>tAutor<font color="#800080">[</font>CODIGO<font color="#800080">] &amp; </font><font color="#008000"><i>&quot; &quot; </i></font><font color="#800080">&amp; </font>tAutor<font color="#800080">[</font>AUTOR<font color="#800080">] &amp; </font><font color="#008000"><i>&quot;\n&quot;</i></font><font color="#800080">)
   </font><font color="#008000"><b>end if
elsif </b></font>sreg<font color="#800080">=</font>opEditora <font color="#008000"><b>then
   if </b></font>nOpcao <font color="#800080">= </font><font color="#FF0000">1 </font><font color="#008000"><b>then
        </b></font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font>rotulo<font color="#800080">(</font>sreg<font color="#800080">, </font><font color="#FF0000">1</font><font color="#800080">) &amp; </font>tEditora<font color="#800080">[</font>CODIGO<font color="#800080">] &amp; </font><font color="#008000"><i>&quot;\n&quot;</i></font><font color="#800080">)
        </font>tEditora<font color="#800080">[</font>EDITORA<font color="#800080">] = </font>digita<font color="#800080">(</font>rotulo<font color="#800080">(</font>sreg<font color="#800080">, </font><font color="#FF0000">2</font><font color="#800080">), </font>FALSE<font color="#800080">)
   </font><font color="#008000"><b>elsif </b></font>nOpcao <font color="#800080">= </font><font color="#FF0000">2 </font><font color="#008000"><b>then
        </b></font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font><font color="#008000"><i>&quot;C&oacute;digo     Editora\n&quot;</i></font><font color="#800080">)
        </font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font><font color="#008000"><i>&quot;------     -------\n&quot;</i></font><font color="#800080">)
   </font><font color="#008000"><b>elsif </b></font>nOpcao <font color="#800080">= </font><font color="#FF0000">3 </font><font color="#008000"><b>then
        </b></font>tEditora<font color="#800080">[</font>CODIGO<font color="#800080">]=</font>copy<font color="#800080">(</font>slinha<font color="#800080">, </font><font color="#FF0000">1</font><font color="#800080">, </font><font color="#FF0000">10</font><font color="#800080">)
        </font>tEditora<font color="#800080">[</font>EDITORA<font color="#800080">]=</font>copy<font color="#800080">(</font>slinha<font color="#800080">, </font><font color="#FF0000">11</font><font color="#800080">, </font><font color="#FF0000">50</font><font color="#800080">)
        </font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font>tEditora<font color="#800080">[</font>CODIGO<font color="#800080">] &amp; </font><font color="#008000"><i>&quot; &quot; </i></font><font color="#800080">&amp; </font>tEditora<font color="#800080">[</font>EDITORA<font color="#800080">] &amp; </font><font color="#008000"><i>&quot;\n&quot;</i></font><font color="#800080">)
   </font><font color="#008000"><b>end if
elsif </b></font>sreg<font color="#800080">=</font>opEndereco <font color="#008000"><b>then
   if </b></font>nOpcao <font color="#800080">= </font><font color="#FF0000">1 </font><font color="#008000"><b>then
        </b></font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font>rotulo<font color="#800080">(</font>sreg<font color="#800080">, </font><font color="#FF0000">1</font><font color="#800080">) &amp; </font>tEndereco<font color="#800080">[</font>CODIGO<font color="#800080">] &amp; </font><font color="#008000"><i>&quot;\n&quot;</i></font><font color="#800080">)
        </font>tEndereco<font color="#800080">[</font>LOGRADOURO<font color="#800080">] = </font>digita<font color="#800080">(</font>rotulo<font color="#800080">(</font>sreg<font color="#800080">, </font><font color="#FF0000">2</font><font color="#800080">), </font>FALSE<font color="#800080">)
        </font>tEndereco<font color="#800080">[</font>BAIRRO<font color="#800080">] = </font>digita<font color="#800080">(</font>rotulo<font color="#800080">(</font>sreg<font color="#800080">, </font><font color="#FF0000">3</font><font color="#800080">), </font>FALSE<font color="#800080">)
        </font>tEndereco<font color="#800080">[</font>CEP<font color="#800080">] = </font>digita<font color="#800080">(</font>rotulo<font color="#800080">(</font>sreg<font color="#800080">, </font><font color="#FF0000">4</font><font color="#800080">), </font>FALSE<font color="#800080">)
        </font>tEndereco<font color="#800080">[</font>CIDADE<font color="#800080">] = </font>digita<font color="#800080">(</font>rotulo<font color="#800080">(</font>sreg<font color="#800080">, </font><font color="#FF0000">5</font><font color="#800080">), </font>FALSE<font color="#800080">)
        </font>tEndereco<font color="#800080">[</font>ESTADO<font color="#800080">] = </font>digita<font color="#800080">(</font>rotulo<font color="#800080">(</font>sreg<font color="#800080">, </font><font color="#FF0000">6</font><font color="#800080">), </font>FALSE<font color="#800080">)
   </font><font color="#008000"><b>elsif </b></font>nOpcao <font color="#800080">= </font><font color="#FF0000">3 </font><font color="#008000"><b>then
        </b></font>tEndereco<font color="#800080">[</font>CODIGO<font color="#800080">]=</font>trim<font color="#800080">(</font>copy<font color="#800080">(</font>slinha<font color="#800080">, </font><font color="#FF0000">1</font><font color="#800080">, </font><font color="#FF0000">10</font><font color="#800080">))
        </font>tEndereco<font color="#800080">[</font>LOGRADOURO<font color="#800080">]=</font>trim<font color="#800080">(</font>copy<font color="#800080">(</font>slinha<font color="#800080">, </font><font color="#FF0000">11</font><font color="#800080">, </font><font color="#FF0000">40</font><font color="#800080">))
        </font>tEndereco<font color="#800080">[</font>BAIRRO<font color="#800080">]=</font>trim<font color="#800080">(</font>copy<font color="#800080">(</font>slinha<font color="#800080">, </font><font color="#FF0000">51</font><font color="#800080">, </font><font color="#FF0000">15</font><font color="#800080">))
        </font>tEndereco<font color="#800080">[</font>CEP<font color="#800080">]=</font>trim<font color="#800080">(</font>copy<font color="#800080">(</font>slinha<font color="#800080">, </font><font color="#FF0000">66</font><font color="#800080">, </font><font color="#FF0000">8</font><font color="#800080">))
        </font>tEndereco<font color="#800080">[</font>CIDADE<font color="#800080">]=</font>trim<font color="#800080">(</font>copy<font color="#800080">(</font>slinha<font color="#800080">, </font><font color="#FF0000">74</font><font color="#800080">, </font><font color="#FF0000">30</font><font color="#800080">))
        </font>tEndereco<font color="#800080">[</font>ESTADO<font color="#800080">]=</font>trim<font color="#800080">(</font>copy<font color="#800080">(</font>slinha<font color="#800080">, </font><font color="#FF0000">104</font><font color="#800080">, </font><font color="#FF0000">20</font><font color="#800080">))
        </font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font><font color="#008000"><i>&quot;--------------------\n&quot;</i></font><font color="#800080">)
        </font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font>rotulo<font color="#800080">(</font>sreg<font color="#800080">, </font><font color="#FF0000">1</font><font color="#800080">) &amp; </font>tEndereco<font color="#800080">[</font>CODIGO<font color="#800080">] &amp; </font><font color="#008000"><i>&quot;\n&quot;</i></font><font color="#800080">)
        </font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font>rotulo<font color="#800080">(</font>sreg<font color="#800080">, </font><font color="#FF0000">2</font><font color="#800080">) &amp; </font>tEndereco<font color="#800080">[</font>LOGRADOURO<font color="#800080">] &amp; </font><font color="#008000"><i>&quot;\n&quot;</i></font><font color="#800080">)
        </font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font>rotulo<font color="#800080">(</font>sreg<font color="#800080">, </font><font color="#FF0000">3</font><font color="#800080">) &amp; </font>tEndereco<font color="#800080">[</font>BAIRRO<font color="#800080">] &amp; </font><font color="#008000"><i>&quot;\n&quot;</i></font><font color="#800080">)
        </font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font>rotulo<font color="#800080">(</font>sreg<font color="#800080">, </font><font color="#FF0000">4</font><font color="#800080">) &amp; </font>tEndereco<font color="#800080">[</font>CEP<font color="#800080">] &amp; </font><font color="#008000"><i>&quot;\n&quot;</i></font><font color="#800080">)
        </font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font>rotulo<font color="#800080">(</font>sreg<font color="#800080">, </font><font color="#FF0000">5</font><font color="#800080">) &amp; </font>tEndereco<font color="#800080">[</font>CIDADE<font color="#800080">] &amp; </font><font color="#008000"><i>&quot;\n&quot;</i></font><font color="#800080">)
        </font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font>rotulo<font color="#800080">(</font>sreg<font color="#800080">, </font><font color="#FF0000">6</font><font color="#800080">) &amp; </font>tEndereco<font color="#800080">[</font>ESTADO<font color="#800080">] &amp; </font><font color="#008000"><i>&quot;\n&quot;</i></font><font color="#800080">)
   </font><font color="#008000"><b>end if
elsif </b></font>sreg<font color="#800080">=</font>opIdioma <font color="#008000"><b>then
   if </b></font>nOpcao <font color="#800080">= </font><font color="#FF0000">1 </font><font color="#008000"><b>then
        </b></font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font>rotulo<font color="#800080">(</font>sreg<font color="#800080">, </font><font color="#FF0000">1</font><font color="#800080">) &amp; </font>tIdioma<font color="#800080">[</font>CODIGO<font color="#800080">] &amp; </font><font color="#008000"><i>&quot;\n&quot;</i></font><font color="#800080">)
        </font>tIdioma<font color="#800080">[</font>IDIOMA<font color="#800080">] = </font>digita<font color="#800080">(</font>rotulo<font color="#800080">(</font>sreg<font color="#800080">, </font><font color="#FF0000">2</font><font color="#800080">), </font>FALSE<font color="#800080">)
   </font><font color="#008000"><b>elsif </b></font>nOpcao <font color="#800080">= </font><font color="#FF0000">2 </font><font color="#008000"><b>then
        </b></font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font><font color="#008000"><i>&quot;C&oacute;digo     Idioma\n&quot;</i></font><font color="#800080">)
        </font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font><font color="#008000"><i>&quot;------     ------\n&quot;</i></font><font color="#800080">)
   </font><font color="#008000"><b>elsif </b></font>nOpcao <font color="#800080">= </font><font color="#FF0000">3 </font><font color="#008000"><b>then
        </b></font>tIdioma<font color="#800080">[</font>CODIGO<font color="#800080">]=</font>copy<font color="#800080">(</font>slinha<font color="#800080">, </font><font color="#FF0000">1</font><font color="#800080">, </font><font color="#FF0000">10</font><font color="#800080">)
        </font>tIdioma<font color="#800080">[</font>IDIOMA<font color="#800080">]=</font>copy<font color="#800080">(</font>slinha<font color="#800080">, </font><font color="#FF0000">11</font><font color="#800080">, </font><font color="#FF0000">20</font><font color="#800080">)
        </font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font>tIdioma<font color="#800080">[</font>CODIGO<font color="#800080">] &amp; </font><font color="#008000"><i>&quot; &quot; </i></font><font color="#800080">&amp; </font>tIdioma<font color="#800080">[</font>IDIOMA<font color="#800080">] &amp; </font><font color="#008000"><i>&quot;\n&quot;</i></font><font color="#800080">)
   </font><font color="#008000"><b>end if
elsif </b></font>sreg<font color="#800080">=</font>opPais <font color="#008000"><b>then
   if </b></font>nOpcao <font color="#800080">= </font><font color="#FF0000">1 </font><font color="#008000"><b>then
        </b></font>tPais<font color="#800080">[</font>PAIS<font color="#800080">] = </font>digita<font color="#800080">(</font>rotulo<font color="#800080">(</font>sreg<font color="#800080">, </font><font color="#FF0000">2</font><font color="#800080">), </font>FALSE<font color="#800080">)
   </font><font color="#008000"><b>elsif </b></font>nOpcao <font color="#800080">= </font><font color="#FF0000">2 </font><font color="#008000"><b>then
        </b></font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font><font color="#008000"><i>&quot;C&oacute;digo Pa&iacute;s\n&quot;</i></font><font color="#800080">)
        </font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font><font color="#008000"><i>&quot;------ ----\n&quot;</i></font><font color="#800080">)
   </font><font color="#008000"><b>elsif </b></font>nOpcao <font color="#800080">= </font><font color="#FF0000">3 </font><font color="#008000"><b>then
        </b></font>tPais<font color="#800080">[</font>CODIGO<font color="#800080">]=</font>copy<font color="#800080">(</font>slinha<font color="#800080">, </font><font color="#FF0000">1</font><font color="#800080">, </font><font color="#FF0000">3</font><font color="#800080">)
        </font>tPais<font color="#800080">[</font>PAIS<font color="#800080">]=</font>copy<font color="#800080">(</font>slinha<font color="#800080">, </font><font color="#FF0000">4</font><font color="#800080">, </font><font color="#FF0000">50</font><font color="#800080">)
        </font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font>tPais<font color="#800080">[</font>CODIGO<font color="#800080">] &amp; </font><font color="#008000"><i>&quot;    &quot; </i></font><font color="#800080">&amp; </font>tPais<font color="#800080">[</font>PAIS<font color="#800080">] &amp; </font><font color="#008000"><i>&quot;\n&quot;</i></font><font color="#800080">)
   </font><font color="#008000"><b>end if
elsif </b></font>sreg<font color="#800080">=</font>opProfissao <font color="#008000"><b>then
   if </b></font>nOpcao <font color="#800080">= </font><font color="#FF0000">1 </font><font color="#008000"><b>then
        </b></font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font>rotulo<font color="#800080">(</font>sreg<font color="#800080">, </font><font color="#FF0000">1</font><font color="#800080">) &amp; </font>tProfissao<font color="#800080">[</font>CODIGO<font color="#800080">] &amp; </font><font color="#008000"><i>&quot;\n&quot;</i></font><font color="#800080">)
        </font>tProfissao<font color="#800080">[</font>PROFISSAO<font color="#800080">] = </font>digita<font color="#800080">(</font>rotulo<font color="#800080">(</font>sreg<font color="#800080">, </font><font color="#FF0000">2</font><font color="#800080">), </font>FALSE<font color="#800080">)
   </font><font color="#008000"><b>elsif </b></font>nOpcao <font color="#800080">= </font><font color="#FF0000">2 </font><font color="#008000"><b>then
        </b></font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font><font color="#008000"><i>&quot;C&oacute;digo     Profiss&atilde;o\n&quot;</i></font><font color="#800080">)
        </font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font><font color="#008000"><i>&quot;------     ---------\n&quot;</i></font><font color="#800080">)
   </font><font color="#008000"><b>elsif </b></font>nOpcao <font color="#800080">= </font><font color="#FF0000">3 </font><font color="#008000"><b>then
        </b></font>tProfissao<font color="#800080">[</font>CODIGO<font color="#800080">]=</font>copy<font color="#800080">(</font>slinha<font color="#800080">, </font><font color="#FF0000">1</font><font color="#800080">, </font><font color="#FF0000">10</font><font color="#800080">)
        </font>tProfissao<font color="#800080">[</font>PROFISSAO<font color="#800080">]=</font>copy<font color="#800080">(</font>slinha<font color="#800080">, </font><font color="#FF0000">11</font><font color="#800080">, </font><font color="#FF0000">50</font><font color="#800080">)
        </font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font>tProfissao<font color="#800080">[</font>CODIGO<font color="#800080">] &amp; </font><font color="#008000"><i>&quot; &quot; </i></font><font color="#800080">&amp; </font>tProfissao<font color="#800080">[</font>PROFISSAO<font color="#800080">] &amp; </font><font color="#008000"><i>&quot;\n&quot;</i></font><font color="#800080">)
   </font><font color="#008000"><b>end if
elsif </b></font>sreg<font color="#800080">=</font>opLivro <font color="#008000"><b>then
   if </b></font>nOpcao <font color="#800080">= </font><font color="#FF0000">1 </font><font color="#008000"><b>then
        </b></font>tLivro<font color="#800080">[</font>TITULO<font color="#800080">] = </font>digita<font color="#800080">(</font>rotulo<font color="#800080">(</font>sreg<font color="#800080">, </font><font color="#FF0000">2</font><font color="#800080">), </font>FALSE<font color="#800080">)
        </font>tLivro<font color="#800080">[</font>EDICAO<font color="#800080">]=</font>validaNumero<font color="#800080">(</font>rotulo<font color="#800080">(</font>sreg<font color="#800080">, </font><font color="#FF0000">3</font><font color="#800080">), </font>tLivro<font color="#800080">[</font>EDICAO<font color="#800080">])
        </font>tLivro<font color="#800080">[</font>ANOPUBLI<font color="#800080">]=</font>validaNumero<font color="#800080">(</font>rotulo<font color="#800080">(</font>sreg<font color="#800080">, </font><font color="#FF0000">4</font><font color="#800080">), </font>tLivro<font color="#800080">[</font>ANOPUBLI<font color="#800080">])
        </font>mostrarSubDados<font color="#800080">(</font>opLivro<font color="#800080">, </font>opEditora<font color="#800080">, </font>FALSE<font color="#800080">)
        </font>tLivro<font color="#800080">[</font>VOLUME<font color="#800080">]=</font>validaNumero<font color="#800080">(</font>rotulo<font color="#800080">(</font>sreg<font color="#800080">, </font><font color="#FF0000">6</font><font color="#800080">), </font>tLivro<font color="#800080">[</font>VOLUME<font color="#800080">])
        </font>mostrarSubDados<font color="#800080">(</font>opLivro<font color="#800080">, </font>opIdioma<font color="#800080">, </font>FALSE<font color="#800080">)
        </font>tLivro<font color="#800080">[</font>NPAGINAS<font color="#800080">]=</font>validaNumero<font color="#800080">(</font>rotulo<font color="#800080">(</font>sreg<font color="#800080">, </font><font color="#FF0000">8</font><font color="#800080">), </font>tLivro<font color="#800080">[</font>NPAGINAS<font color="#800080">])
        </font>tLivro<font color="#800080">[</font>PRECO<font color="#800080">]=</font>validaNumero<font color="#800080">(</font>rotulo<font color="#800080">(</font>sreg<font color="#800080">, </font><font color="#FF0000">9</font><font color="#800080">), </font>tLivro<font color="#800080">[</font>PRECO<font color="#800080">])
        </font>tLivro<font color="#800080">[</font>QTDESTOQUE<font color="#800080">]=</font>validaNumero<font color="#800080">(</font>rotulo<font color="#800080">(</font>sreg<font color="#800080">, </font><font color="#FF0000">10</font><font color="#800080">), </font>tLivro<font color="#800080">[</font>QTDESTOQUE<font color="#800080">])
   </font><font color="#008000"><b>elsif </b></font>nOpcao <font color="#800080">= </font><font color="#FF0000">3 </font><font color="#008000"><b>then
        </b></font>tLivro<font color="#800080">[</font>ISBN<font color="#800080">]=</font>trim<font color="#800080">(</font>copy<font color="#800080">(</font>slinha<font color="#800080">, </font><font color="#FF0000">1</font><font color="#800080">, </font><font color="#FF0000">13</font><font color="#800080">))
        </font>tLivro<font color="#800080">[</font>TITULO<font color="#800080">]=</font>trim<font color="#800080">(</font>copy<font color="#800080">(</font>slinha<font color="#800080">, </font><font color="#FF0000">14</font><font color="#800080">, </font><font color="#FF0000">50</font><font color="#800080">))
        </font>tLivro<font color="#800080">[</font>EDICAO<font color="#800080">]=</font>trim<font color="#800080">(</font>copy<font color="#800080">(</font>slinha<font color="#800080">, </font><font color="#FF0000">64</font><font color="#800080">, </font><font color="#FF0000">10</font><font color="#800080">))
        </font>tLivro<font color="#800080">[</font>ANOPUBLI<font color="#800080">]=</font>trim<font color="#800080">(</font>copy<font color="#800080">(</font>slinha<font color="#800080">, </font><font color="#FF0000">74</font><font color="#800080">, </font><font color="#FF0000">10</font><font color="#800080">))
        </font>tLivro<font color="#800080">[</font>CODEDITORA<font color="#800080">]=</font>trim<font color="#800080">(</font>copy<font color="#800080">(</font>slinha<font color="#800080">, </font><font color="#FF0000">84</font><font color="#800080">, </font><font color="#FF0000">10</font><font color="#800080">))
        </font>tLivro<font color="#800080">[</font>VOLUME<font color="#800080">]=</font>trim<font color="#800080">(</font>copy<font color="#800080">(</font>slinha<font color="#800080">, </font><font color="#FF0000">94</font><font color="#800080">, </font><font color="#FF0000">10</font><font color="#800080">))
        </font>tLivro<font color="#800080">[</font>CODIDIOMA<font color="#800080">]=</font>trim<font color="#800080">(</font>copy<font color="#800080">(</font>slinha<font color="#800080">, </font><font color="#FF0000">104</font><font color="#800080">, </font><font color="#FF0000">10</font><font color="#800080">))
        </font>tLivro<font color="#800080">[</font>NPAGINAS<font color="#800080">]=</font>trim<font color="#800080">(</font>copy<font color="#800080">(</font>slinha<font color="#800080">, </font><font color="#FF0000">114</font><font color="#800080">, </font><font color="#FF0000">10</font><font color="#800080">))
        </font>tLivro<font color="#800080">[</font>PRECO<font color="#800080">]=</font>trim<font color="#800080">(</font>copy<font color="#800080">(</font>slinha<font color="#800080">, </font><font color="#FF0000">124</font><font color="#800080">, </font><font color="#FF0000">10</font><font color="#800080">))
        </font>tLivro<font color="#800080">[</font>QTDESTOQUE<font color="#800080">]=</font>trim<font color="#800080">(</font>copy<font color="#800080">(</font>slinha<font color="#800080">, </font><font color="#FF0000">134</font><font color="#800080">, </font><font color="#FF0000">10</font><font color="#800080">))
        </font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font><font color="#008000"><i>&quot;--------------------\n&quot;</i></font><font color="#800080">)
        </font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font>rotulo<font color="#800080">(</font>sreg<font color="#800080">, </font><font color="#FF0000">1</font><font color="#800080">) &amp; </font>tLivro<font color="#800080">[</font>ISBN<font color="#800080">] &amp; </font><font color="#008000"><i>&quot;\n&quot;</i></font><font color="#800080">)
        </font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font>rotulo<font color="#800080">(</font>sreg<font color="#800080">, </font><font color="#FF0000">2</font><font color="#800080">) &amp; </font>tLivro<font color="#800080">[</font>TITULO<font color="#800080">] &amp; </font><font color="#008000"><i>&quot;\n&quot;</i></font><font color="#800080">)
        </font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font>rotulo<font color="#800080">(</font>sreg<font color="#800080">, </font><font color="#FF0000">3</font><font color="#800080">) &amp; </font>tLivro<font color="#800080">[</font>EDICAO<font color="#800080">] &amp; </font><font color="#008000"><i>&quot;\n&quot;</i></font><font color="#800080">)
        </font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font>rotulo<font color="#800080">(</font>sreg<font color="#800080">, </font><font color="#FF0000">4</font><font color="#800080">) &amp; </font>tLivro<font color="#800080">[</font>ANOPUBLI<font color="#800080">] &amp; </font><font color="#008000"><i>&quot;\n&quot;</i></font><font color="#800080">)
        </font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font>rotulo<font color="#800080">(</font>sreg<font color="#800080">, </font><font color="#FF0000">5</font><font color="#800080">) &amp; </font>tLivro<font color="#800080">[</font>CODEDITORA<font color="#800080">] &amp; </font><font color="#008000"><i>&quot;\n&quot;</i></font><font color="#800080">)
        </font>mostrarSubDados<font color="#800080">(</font>opLivro<font color="#800080">, </font>opEditora<font color="#800080">, </font>TRUE<font color="#800080">)
        </font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font>rotulo<font color="#800080">(</font>sreg<font color="#800080">, </font><font color="#FF0000">6</font><font color="#800080">) &amp; </font>tLivro<font color="#800080">[</font>VOLUME<font color="#800080">] &amp; </font><font color="#008000"><i>&quot;\n&quot;</i></font><font color="#800080">)
        </font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font>rotulo<font color="#800080">(</font>sreg<font color="#800080">, </font><font color="#FF0000">7</font><font color="#800080">) &amp; </font>tLivro<font color="#800080">[</font>CODIDIOMA<font color="#800080">] &amp; </font><font color="#008000"><i>&quot;\n&quot;</i></font><font color="#800080">)
        </font>mostrarSubDados<font color="#800080">(</font>opLivro<font color="#800080">, </font>opIdioma<font color="#800080">, </font>TRUE<font color="#800080">)
        </font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font>rotulo<font color="#800080">(</font>sreg<font color="#800080">, </font><font color="#FF0000">8</font><font color="#800080">) &amp; </font>tLivro<font color="#800080">[</font>NPAGINAS<font color="#800080">] &amp; </font><font color="#008000"><i>&quot;\n&quot;</i></font><font color="#800080">)
        </font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font>rotulo<font color="#800080">(</font>sreg<font color="#800080">, </font><font color="#FF0000">9</font><font color="#800080">) &amp; </font>tLivro<font color="#800080">[</font>PRECO<font color="#800080">] &amp; </font><font color="#008000"><i>&quot;\n&quot;</i></font><font color="#800080">)
        </font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font>rotulo<font color="#800080">(</font>sreg<font color="#800080">, </font><font color="#FF0000">10</font><font color="#800080">) &amp; </font>tLivro<font color="#800080">[</font>QTDESTOQUE<font color="#800080">] &amp; </font><font color="#008000"><i>&quot;\n&quot;</i></font><font color="#800080">)
        </font>ListarRegLigados<font color="#800080">(</font>tfLivroAss<font color="#800080">, </font><font color="#FF0000">1</font><font color="#800080">, </font><font color="#FF0000">13</font><font color="#800080">, </font><font color="#FF0000">14</font><font color="#800080">, </font><font color="#FF0000">10</font><font color="#800080">, </font>tLivro<font color="#800080">[</font>ISBN<font color="#800080">],
                         </font>tfAssunto<font color="#800080">, </font>opAssunto<font color="#800080">, </font><font color="#FF0000">1</font><font color="#800080">, </font><font color="#FF0000">4</font><font color="#800080">)
        </font>ListarRegLigados<font color="#800080">(</font>tfLivroAut<font color="#800080">, </font><font color="#FF0000">1</font><font color="#800080">, </font><font color="#FF0000">13</font><font color="#800080">, </font><font color="#FF0000">14</font><font color="#800080">, </font><font color="#FF0000">10</font><font color="#800080">, </font>tLivro<font color="#800080">[</font>ISBN<font color="#800080">],
                         </font>tfAutor<font color="#800080">, </font>opAutor<font color="#800080">, </font><font color="#FF0000">1</font><font color="#800080">, </font><font color="#FF0000">4</font><font color="#800080">)
   </font><font color="#008000"><b>end if
elsif </b></font>sreg<font color="#800080">=</font>opCliente <font color="#008000"><b>then
   if </b></font>nOpcao <font color="#800080">= </font><font color="#FF0000">1 </font><font color="#008000"><b>then
        </b></font>tCliente<font color="#800080">[</font>NOME<font color="#800080">] = </font>digita<font color="#800080">(</font>rotulo<font color="#800080">(</font>sreg<font color="#800080">, </font><font color="#FF0000">2</font><font color="#800080">), </font>FALSE<font color="#800080">)
        </font>tCliente<font color="#800080">[</font>EMAIL<font color="#800080">] = </font>digita<font color="#800080">(</font>rotulo<font color="#800080">(</font>sreg<font color="#800080">, </font><font color="#FF0000">3</font><font color="#800080">), </font>FALSE<font color="#800080">)
        </font>tCliente<font color="#800080">[</font>IDENTIDADE<font color="#800080">] = </font>digita<font color="#800080">(</font>rotulo<font color="#800080">(</font>sreg<font color="#800080">, </font><font color="#FF0000">4</font><font color="#800080">), </font>FALSE<font color="#800080">)
        </font>tCliente<font color="#800080">[</font>SEXO<font color="#800080">] = </font>digita<font color="#800080">(</font>rotulo<font color="#800080">(</font>sreg<font color="#800080">, </font><font color="#FF0000">5</font><font color="#800080">), </font>FALSE<font color="#800080">)
        </font>tCliente<font color="#800080">[</font>TELEFONE<font color="#800080">] = </font>digita<font color="#800080">(</font>rotulo<font color="#800080">(</font>sreg<font color="#800080">, </font><font color="#FF0000">6</font><font color="#800080">), </font>FALSE<font color="#800080">)
        </font>tCliente<font color="#800080">[</font>DTNASCIMENTO<font color="#800080">]=
                </font>validaDataHora<font color="#800080">(</font>rotulo<font color="#800080">(</font>sreg<font color="#800080">, </font><font color="#FF0000">7</font><font color="#800080">), </font>tCliente<font color="#800080">[</font>DTNASCIMENTO<font color="#800080">], </font>TRUE<font color="#800080">)
        </font>mostrarSubDados<font color="#800080">(</font>opCliente<font color="#800080">, </font>opEndereco<font color="#800080">, </font>FALSE<font color="#800080">)
        </font>mostrarSubDados<font color="#800080">(</font>opCliente<font color="#800080">, </font>opPais<font color="#800080">, </font>FALSE<font color="#800080">)
        </font>mostrarSubDados<font color="#800080">(</font>opCliente<font color="#800080">, </font>opProfissao<font color="#800080">, </font>FALSE<font color="#800080">)
   </font><font color="#008000"><b>elsif </b></font>nOpcao <font color="#800080">= </font><font color="#FF0000">3 </font><font color="#008000"><b>then
        </b></font>tCliente<font color="#800080">[</font>CPF<font color="#800080">]=</font>trim<font color="#800080">(</font>copy<font color="#800080">(</font>slinha<font color="#800080">, </font><font color="#FF0000">1</font><font color="#800080">, </font><font color="#FF0000">14</font><font color="#800080">))
        </font>tCliente<font color="#800080">[</font>NOME<font color="#800080">]=</font>trim<font color="#800080">(</font>copy<font color="#800080">(</font>slinha<font color="#800080">, </font><font color="#FF0000">15</font><font color="#800080">, </font><font color="#FF0000">30</font><font color="#800080">))
        </font>tCliente<font color="#800080">[</font>EMAIL<font color="#800080">]=</font>trim<font color="#800080">(</font>copy<font color="#800080">(</font>slinha<font color="#800080">, </font><font color="#FF0000">45</font><font color="#800080">, </font><font color="#FF0000">30</font><font color="#800080">))
        </font>tCliente<font color="#800080">[</font>IDENTIDADE<font color="#800080">]=</font>trim<font color="#800080">(</font>copy<font color="#800080">(</font>slinha<font color="#800080">, </font><font color="#FF0000">75</font><font color="#800080">, </font><font color="#FF0000">10</font><font color="#800080">))
        </font>tCliente<font color="#800080">[</font>SEXO<font color="#800080">]=</font>trim<font color="#800080">(</font>copy<font color="#800080">(</font>slinha<font color="#800080">, </font><font color="#FF0000">85</font><font color="#800080">, </font><font color="#FF0000">1</font><font color="#800080">))
        </font>tCliente<font color="#800080">[</font>TELEFONE<font color="#800080">]=</font>trim<font color="#800080">(</font>copy<font color="#800080">(</font>slinha<font color="#800080">, </font><font color="#FF0000">86</font><font color="#800080">, </font><font color="#FF0000">17</font><font color="#800080">))
        </font>tCliente<font color="#800080">[</font>DTNASCIMENTO<font color="#800080">]=</font>trim<font color="#800080">(</font>copy<font color="#800080">(</font>slinha<font color="#800080">, </font><font color="#FF0000">103</font><font color="#800080">, </font><font color="#FF0000">10</font><font color="#800080">))
        </font>tCliente<font color="#800080">[</font>CODENDERECO<font color="#800080">]=</font>trim<font color="#800080">(</font>copy<font color="#800080">(</font>slinha<font color="#800080">, </font><font color="#FF0000">113</font><font color="#800080">, </font><font color="#FF0000">10</font><font color="#800080">))
        </font>tCliente<font color="#800080">[</font>CODPAIS<font color="#800080">]=</font>trim<font color="#800080">(</font>copy<font color="#800080">(</font>slinha<font color="#800080">, </font><font color="#FF0000">123</font><font color="#800080">, </font><font color="#FF0000">3</font><font color="#800080">))
        </font>tCliente<font color="#800080">[</font>CODPROFISSAO<font color="#800080">]=</font>trim<font color="#800080">(</font>copy<font color="#800080">(</font>slinha<font color="#800080">, </font><font color="#FF0000">126</font><font color="#800080">, </font><font color="#FF0000">10</font><font color="#800080">))
        </font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font><font color="#008000"><i>&quot;--------------------\n&quot;</i></font><font color="#800080">)
        </font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font>rotulo<font color="#800080">(</font>sreg<font color="#800080">, </font><font color="#FF0000">1</font><font color="#800080">) &amp; </font>tCliente<font color="#800080">[</font>CPF<font color="#800080">] &amp; </font><font color="#008000"><i>&quot;\n&quot;</i></font><font color="#800080">)
        </font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font>rotulo<font color="#800080">(</font>sreg<font color="#800080">, </font><font color="#FF0000">2</font><font color="#800080">) &amp; </font>tCliente<font color="#800080">[</font>NOME<font color="#800080">] &amp; </font><font color="#008000"><i>&quot;\n&quot;</i></font><font color="#800080">)
        </font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font>rotulo<font color="#800080">(</font>sreg<font color="#800080">, </font><font color="#FF0000">3</font><font color="#800080">) &amp; </font>tCliente<font color="#800080">[</font>EMAIL<font color="#800080">] &amp; </font><font color="#008000"><i>&quot;\n&quot;</i></font><font color="#800080">)
        </font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font>rotulo<font color="#800080">(</font>sreg<font color="#800080">, </font><font color="#FF0000">4</font><font color="#800080">) &amp; </font>tCliente<font color="#800080">[</font>IDENTIDADE<font color="#800080">] &amp; </font><font color="#008000"><i>&quot;\n&quot;</i></font><font color="#800080">)
        </font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font>rotulo<font color="#800080">(</font>sreg<font color="#800080">, </font><font color="#FF0000">5</font><font color="#800080">) &amp; </font>tCliente<font color="#800080">[</font>SEXO<font color="#800080">] &amp; </font><font color="#008000"><i>&quot;\n&quot;</i></font><font color="#800080">)
        </font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font>rotulo<font color="#800080">(</font>sreg<font color="#800080">, </font><font color="#FF0000">6</font><font color="#800080">) &amp; </font>tCliente<font color="#800080">[</font>TELEFONE<font color="#800080">] &amp; </font><font color="#008000"><i>&quot;\n&quot;</i></font><font color="#800080">)
        </font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font>rotulo<font color="#800080">(</font>sreg<font color="#800080">, </font><font color="#FF0000">7</font><font color="#800080">) &amp; </font>tCliente<font color="#800080">[</font>DTNASCIMENTO<font color="#800080">] &amp; </font><font color="#008000"><i>&quot;\n&quot;</i></font><font color="#800080">)
        </font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font>rotulo<font color="#800080">(</font>sreg<font color="#800080">, </font><font color="#FF0000">8</font><font color="#800080">) &amp; </font>tCliente<font color="#800080">[</font>CODENDERECO<font color="#800080">] &amp; </font><font color="#008000"><i>&quot;\n&quot;</i></font><font color="#800080">)
        </font>mostrarSubDados<font color="#800080">(</font>opCliente<font color="#800080">, </font>opEndereco<font color="#800080">, </font>TRUE<font color="#800080">)
        </font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font>rotulo<font color="#800080">(</font>sreg<font color="#800080">, </font><font color="#FF0000">9</font><font color="#800080">) &amp; </font>tCliente<font color="#800080">[</font>CODPAIS<font color="#800080">] &amp; </font><font color="#008000"><i>&quot;\n&quot;</i></font><font color="#800080">)
        </font>mostrarSubDados<font color="#800080">(</font>opCliente<font color="#800080">, </font>opPais<font color="#800080">, </font>TRUE<font color="#800080">)
        </font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font>rotulo<font color="#800080">(</font>sreg<font color="#800080">, </font><font color="#FF0000">10</font><font color="#800080">) &amp; </font>tCliente<font color="#800080">[</font>CODPROFISSAO<font color="#800080">] &amp; </font><font color="#008000"><i>&quot;\n&quot;</i></font><font color="#800080">)
        </font>mostrarSubDados<font color="#800080">(</font>opCliente<font color="#800080">, </font>opProfissao<font color="#800080">, </font>TRUE<font color="#800080">)
   </font><font color="#008000"><b>end if
elsif </b></font>sreg<font color="#800080">=</font>opVenda <font color="#008000"><b>then
   if </b></font>nOpcao <font color="#800080">= </font><font color="#FF0000">1 </font><font color="#008000"><b>then </b></font>mostrarSubDados<font color="#800080">(</font>opVenda<font color="#800080">,</font>opVenda<font color="#800080">, </font>FALSE<font color="#800080">)
   </font><font color="#008000"><b>elsif </b></font>nOpcao <font color="#800080">= </font><font color="#FF0000">2 </font><font color="#008000"><b>then
        </b></font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font><font color="#008000"><i>&quot;DataHoraVenda       CPF            ISBN          &quot; </i></font><font color="#800080">&amp;
        </font><font color="#008000"><i>&quot;Pre&ccedil;oVenda\n&quot;</i></font><font color="#800080">)
        </font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font><font color="#008000"><i>&quot;-------------       ---            ----          &quot; </i></font><font color="#800080">&amp;
        </font><font color="#008000"><i>&quot;----------\n&quot;</i></font><font color="#800080">)
   </font><font color="#008000"><b>elsif </b></font>nOpcao <font color="#800080">= </font><font color="#FF0000">3 </font><font color="#008000"><b>then
        </b></font>tVenda<font color="#800080">[</font>DTHRVENDA<font color="#800080">]=</font>copy<font color="#800080">(</font>slinha<font color="#800080">, </font><font color="#FF0000">1</font><font color="#800080">, </font><font color="#FF0000">19</font><font color="#800080">)
        </font>tVenda<font color="#800080">[</font>CPFVENDA<font color="#800080">]=</font>copy<font color="#800080">(</font>slinha<font color="#800080">, </font><font color="#FF0000">20</font><font color="#800080">, </font><font color="#FF0000">14</font><font color="#800080">)
        </font>tVenda<font color="#800080">[</font>ISBNVENDA<font color="#800080">]=</font>copy<font color="#800080">(</font>slinha<font color="#800080">, </font><font color="#FF0000">34</font><font color="#800080">, </font><font color="#FF0000">13</font><font color="#800080">)
        </font>tVenda<font color="#800080">[</font>PRECOVENDA<font color="#800080">]=</font>copy<font color="#800080">(</font>slinha<font color="#800080">, </font><font color="#FF0000">47</font><font color="#800080">, </font><font color="#FF0000">10</font><font color="#800080">)
        </font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font>tVenda<font color="#800080">[</font>DTHRVENDA<font color="#800080">] &amp; </font><font color="#008000"><i>&quot; &quot; </i></font><font color="#800080">&amp; </font>tVenda<font color="#800080">[</font>CPFVENDA<font color="#800080">] &amp; </font><font color="#008000"><i>&quot; &quot; </i></font><font color="#800080">&amp; 
        </font>tVenda<font color="#800080">[</font>ISBNVENDA<font color="#800080">] &amp; </font><font color="#008000"><i>&quot; &quot; </i></font><font color="#800080">&amp; </font>tVenda<font color="#800080">[</font>PRECOVENDA<font color="#800080">] &amp; </font><font color="#008000"><i>&quot;\n&quot;</i></font><font color="#800080">)
   </font><font color="#008000"><b>end if
end if
end procedure
</b></font><font color="#808080"><i>-- ----------------------------------------------------------------------------
-- Lista v&aacute;rios registros de acordo com a pesquisa feita.
-- sArq - o arquivo
-- sreg - o tipo de arquivo
-- sChave - a chave a ser pesquisada
-- nPosChave - a posicao inicial da chave dentro do registro
-- nTamChave - o tamanho da chave dentro do registro
-- nTamLinha - o tamanho do registro
-- nQtdLinha - a quantidade de linhas a serem mostradas
-- retorna - se encontrou algum registro
-- ----------------------------------------------------------------------------
</i></font><font color="#008000"><b>function </b></font>ListarTodos<font color="#800080">(</font>tarquivo sArq<font color="#800080">, </font>ctArqs sreg<font color="#800080">, </font><font color="#0000FF"><b>sequence </b></font>sChave<font color="#800080">,
   </font><font color="#0000FF"><b>integer </b></font>nPosChave<font color="#800080">, </font><font color="#0000FF"><b>integer </b></font>nTamChave<font color="#800080">, </font><font color="#0000FF"><b>integer </b></font>nTamLinha<font color="#800080">, </font><font color="#0000FF"><b>integer </b></font>nQtdLinha<font color="#800080">,
   </font>boolean bPesqRelativa<font color="#800080">)
</font><font color="#0000FF"><b>object </b></font>slinha
boolean bQuebra<font color="#800080">, </font>bAchou<font color="#800080">, </font>bRet 
<font color="#0000FF"><b>integer </b></font>nCont<font color="#800080">, </font>nstatus
<font color="#0000FF"><b>sequence </b></font>sres<font color="#800080">, </font>slocal

bRet<font color="#800080">=</font>FALSE
bQuebra<font color="#800080">=</font>FALSE
nCont<font color="#800080">=</font><font color="#FF0000">0
</font>mostrarDados<font color="#800080">(</font>sreg<font color="#800080">, </font><font color="#008000"><i>&quot;&quot;</i></font><font color="#800080">, </font><font color="#FF0000">2</font><font color="#800080">)
</font>nstatus <font color="#800080">= </font><font color="#0000FF">seek</font><font color="#800080">(</font>sArq<font color="#800080">, </font><font color="#FF0000">0</font><font color="#800080">)
</font><font color="#008000"><b>while </b></font>bQuebra<font color="#800080">=</font>FALSE <font color="#008000"><b>do
  </b></font>slinha <font color="#800080">= </font><font color="#0000FF"><b>gets</b></font><font color="#800080">(</font>sArq<font color="#800080">)
  </font><font color="#008000"><b>if </b></font><font color="#0000FF"><b>atom</b></font><font color="#800080">(</font>slinha<font color="#800080">) </font><font color="#008000"><b>then
    exit 
  end if
  if </b></font><font color="#0000FF"><b>length</b></font><font color="#800080">(</font>slinha<font color="#800080">) &gt; </font><font color="#FF0000">0 </font><font color="#008000"><b>then
    </b></font>slocal <font color="#800080">= </font>slinha
    <font color="#008000"><b>if </b></font>bPesqRelativa<font color="#800080">=</font>TRUE <font color="#008000"><b>then
      </b></font>sres<font color="#800080">=</font>trim<font color="#800080">(</font>copy<font color="#800080">(</font>slocal<font color="#800080">,</font>nPosChave<font color="#800080">,</font>nTamChave<font color="#800080">))
      </font><font color="#008000"><b>if </b></font>strRelativa<font color="#800080">(</font>sres<font color="#800080">,</font>sChave<font color="#800080">)=</font>TRUE <font color="#008000"><b>then 
         </b></font>bAchou<font color="#800080">=</font>TRUE
         bRet<font color="#800080">=</font>TRUE
      <font color="#008000"><b>else
         </b></font>bAchou<font color="#800080">=</font>FALSE
      <font color="#008000"><b>end if
    else
      </b></font>bAchou<font color="#800080">=</font>TRUE
      bRet<font color="#800080">=</font>TRUE
    <font color="#008000"><b>end if
  
    if </b></font>bAchou<font color="#800080">=</font>TRUE <font color="#008000"><b>then
      </b></font>mostrarDados<font color="#800080">(</font>sreg<font color="#800080">, </font>copy<font color="#800080">(</font>slocal<font color="#800080">,</font><font color="#FF0000">1</font><font color="#800080">,</font>nTamLinha<font color="#800080">), </font><font color="#FF0000">3</font><font color="#800080">)
      </font>nCont<font color="#800080">=</font>nCont<font color="#800080">+</font><font color="#FF0000">1
    </font><font color="#008000"><b>end if
  
    </b></font>bQuebra<font color="#800080">=</font>ContinuaSN<font color="#800080">(</font>nCont<font color="#800080">, </font>nQtdLinha<font color="#800080">)
  </font><font color="#008000"><b>end if
end while
return </b></font>bRet
<font color="#008000"><b>end function
</b></font><font color="#808080"><i>-- ----------------------------------------------------------------------------
-- Valida a entrada de registros de acordo com a pesquisa feita.
-- sArq - o arquivo
-- sreg - o tipo de arquivo
-- nTexto - o numero do r&oacute;tulo da entrada
-- sEntrada - a chave a ser pesquisada e validada
-- nTentativas - o n&uacute;mero m&aacute;ximo de tentativas
-- bPesqRelativa - indica se vai realizar uma pesquisa relativa
-- bTipoEntrada - indica o tipo de entrada
-- retorna - o registro pesquisado e validado
-- ----------------------------------------------------------------------------
</i></font><font color="#008000"><b>function </b></font>validaEntrada<font color="#800080">(</font>tarquivo sArq<font color="#800080">, </font>ctArqs sreg<font color="#800080">, </font><font color="#0000FF"><b>integer </b></font>nTexto<font color="#800080">,
        </font><font color="#0000FF"><b>sequence </b></font>sEntrada<font color="#800080">, </font><font color="#0000FF"><b>integer </b></font>nTentativas<font color="#800080">,
        </font>boolean bPesqRelativa<font color="#800080">, </font>ctTipo bTipoEntrada<font color="#800080">)
</font>boolean bQuebra
<font color="#0000FF"><b>sequence </b></font>sres<font color="#800080">, </font>sTexto<font color="#800080">, </font>sMsgErro
<font color="#0000FF"><b>integer </b></font>ncont<font color="#800080">, </font>nPosChave<font color="#800080">, </font>nTamChave<font color="#800080">, </font>nTamLinha

nTamLinha<font color="#800080">=</font>tamReg<font color="#800080">(</font>sreg<font color="#800080">)
</font>sMsgErro<font color="#800080">=</font>rotulo<font color="#800080">(</font>sreg<font color="#800080">,</font><font color="#FF0000">0</font><font color="#800080">)
</font>sTexto<font color="#800080">=</font>rotulo<font color="#800080">(</font>sreg<font color="#800080">,</font>nTexto<font color="#800080">)
</font>nPosChave<font color="#800080">=</font>g_nPosChave
nTamChave<font color="#800080">=</font>g_nTamChave

ncont<font color="#800080">=</font><font color="#FF0000">1
</font>bQuebra<font color="#800080">=</font>FALSE
  <font color="#008000"><b>while </b></font><font color="#800080">(</font>bQuebra<font color="#800080">=</font>FALSE<font color="#800080">) </font><font color="#008000"><b>and </b></font><font color="#800080">(</font>ncont <font color="#800080">&lt;= </font>nTentativas <font color="#800080">) </font><font color="#008000"><b>do
    if </b></font>bTipoEntrada<font color="#800080">=</font>opTexto <font color="#008000"><b>then
      </b></font>sEntrada <font color="#800080">= </font>digita<font color="#800080">(</font>sTexto<font color="#800080">, </font>FALSE<font color="#800080">)
    </font><font color="#008000"><b>elsif </b></font>bTipoEntrada<font color="#800080">=</font>opNumero <font color="#008000"><b>then
       </b></font>sEntrada<font color="#800080">=</font>validaNumero<font color="#800080">(</font>sTexto<font color="#800080">, </font>sEntrada<font color="#800080">)
    </font><font color="#008000"><b>elsif </b></font>bTipoEntrada<font color="#800080">=</font>opData <font color="#008000"><b>then
       </b></font>sEntrada<font color="#800080">=</font>validaDataHora<font color="#800080">(</font>sTexto<font color="#800080">, </font>sEntrada<font color="#800080">, </font>TRUE<font color="#800080">)
    </font><font color="#008000"><b>elsif </b></font>bTipoEntrada<font color="#800080">=</font>opDataHora <font color="#008000"><b>then
       </b></font>sEntrada<font color="#800080">=</font>validaDataHora<font color="#800080">(</font>sTexto<font color="#800080">, </font>sEntrada<font color="#800080">, </font>FALSE<font color="#800080">)
    </font><font color="#008000"><b>elsif </b></font>bTipoEntrada<font color="#800080">=</font>opSenha <font color="#008000"><b>then
       </b></font>sEntrada<font color="#800080">=</font>digitaSenha<font color="#800080">(</font>sTexto<font color="#800080">, </font><font color="#FF0000">10</font><font color="#800080">)
    </font><font color="#008000"><b>end if

    if </b></font>bPesqRelativa<font color="#800080">=</font>TRUE <font color="#008000"><b>then
       if </b></font>ListarTodos<font color="#800080">(</font>sArq<font color="#800080">, </font>sreg<font color="#800080">, </font>sEntrada<font color="#800080">, </font>nPosChave<font color="#800080">, </font>nTamChave<font color="#800080">, </font>nTamLinha<font color="#800080">,
          </font>QTD_MAX_LINHA<font color="#800080">, </font>TRUE<font color="#800080">) = </font>TRUE <font color="#008000"><b>then
          </b></font>sres<font color="#800080">=</font><font color="#008000"><i>&quot; &quot;
       </i><b>end if
    else
       </b></font>sres<font color="#800080">=</font>pesqArq<font color="#800080">(</font>sArq<font color="#800080">, </font>sEntrada<font color="#800080">, </font>nPosChave<font color="#800080">, </font>nTamChave<font color="#800080">, </font>nTamLinha<font color="#800080">)
    </font><font color="#008000"><b>end if

    if </b></font><font color="#0000FF"><b>equal</b></font><font color="#800080">(</font>sres<font color="#800080">,</font><font color="#008000"><i>&quot;&quot;</i></font><font color="#800080">) </font><font color="#008000"><b>then
       </b></font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDERR<font color="#800080">, </font>sMsgErro<font color="#800080">)
    </font><font color="#008000"><b>else
       </b></font>bQuebra<font color="#800080">=</font>TRUE
    <font color="#008000"><b>end if

    </b></font>ncont<font color="#800080">=</font>ncont<font color="#800080">+</font><font color="#FF0000">1
  </font><font color="#008000"><b>end while
return </b></font>sres
<font color="#008000"><b>end function

</b></font><font color="#808080"><i>-- ----------------------------------------------------------------------------
-- Executa uma a&ccedil;&atilde;o de grava&ccedil;&atilde;o de acordo com o tipo de arquivo.
-- sreg - o tipo de arquivo
-- sacao - a a&ccedil;&atilde;o a ser realizada
-- ----------------------------------------------------------------------------
</i></font><font color="#008000"><b>procedure </b></font>btnAcao<font color="#800080">(</font>ctArqs sreg<font color="#800080">, </font>ctAcao sacao<font color="#800080">)
</font><font color="#008000"><b>if </b></font>sreg<font color="#800080">=</font>opAssunto <font color="#008000"><b>then
   if </b></font>sacao<font color="#800080">=</font>opSalvarInclusao <font color="#008000"><b>then
      </b></font>escreveArq<font color="#800080">(</font>tfAssunto<font color="#800080">, </font>LinhaReg<font color="#800080">(</font>sreg<font color="#800080">), </font>MSG_REGINC<font color="#800080">, </font>MSG_REGNINC<font color="#800080">)
   </font><font color="#008000"><b>elsif </b></font>sacao<font color="#800080">=</font>opSalvarAlteracao <font color="#008000"><b>then
      </b></font>escreveArq<font color="#800080">(</font>tfAssunto<font color="#800080">, </font>LinhaReg<font color="#800080">(</font>sreg<font color="#800080">), </font>MSG_REGALT<font color="#800080">, </font>MSG_REGNALT<font color="#800080">)
   </font><font color="#008000"><b>elsif </b></font>sacao<font color="#800080">=</font>opConfirmaExclusao <font color="#008000"><b>then
      </b></font>escreveArq<font color="#800080">(</font>tfAssunto<font color="#800080">, </font><font color="#0000FF"><b>repeat</b></font><font color="#800080">(</font><font color="#008000"><i>&quot;*&quot;</i></font><font color="#800080">,</font>tamReg<font color="#800080">(</font>sreg<font color="#800080">)), </font>MSG_REGEXC<font color="#800080">, </font>MSG_REGNEXC<font color="#800080">)
   </font><font color="#008000"><b>end if
elsif </b></font>sreg<font color="#800080">=</font>opAutor <font color="#008000"><b>then
   if </b></font>sacao<font color="#800080">=</font>opSalvarInclusao <font color="#008000"><b>then
      </b></font>escreveArq<font color="#800080">(</font>tfAutor<font color="#800080">, </font>LinhaReg<font color="#800080">(</font>sreg<font color="#800080">), </font>MSG_REGINC<font color="#800080">, </font>MSG_REGNINC<font color="#800080">)
   </font><font color="#008000"><b>elsif </b></font>sacao<font color="#800080">=</font>opSalvarAlteracao <font color="#008000"><b>then
      </b></font>escreveArq<font color="#800080">(</font>tfAutor<font color="#800080">, </font>LinhaReg<font color="#800080">(</font>sreg<font color="#800080">), </font>MSG_REGALT<font color="#800080">, </font>MSG_REGNALT<font color="#800080">)
   </font><font color="#008000"><b>elsif </b></font>sacao<font color="#800080">=</font>opConfirmaExclusao <font color="#008000"><b>then
      </b></font>escreveArq<font color="#800080">(</font>tfAutor<font color="#800080">, </font><font color="#0000FF"><b>repeat</b></font><font color="#800080">(</font><font color="#008000"><i>&quot;*&quot;</i></font><font color="#800080">,</font>tamReg<font color="#800080">(</font>sreg<font color="#800080">)), </font>MSG_REGEXC<font color="#800080">, </font>MSG_REGNEXC<font color="#800080">)
   </font><font color="#008000"><b>end if
elsif </b></font>sreg<font color="#800080">=</font>opEditora <font color="#008000"><b>then
   if </b></font>sacao<font color="#800080">=</font>opSalvarInclusao <font color="#008000"><b>then
      </b></font>escreveArq<font color="#800080">(</font>tfEditora<font color="#800080">, </font>LinhaReg<font color="#800080">(</font>sreg<font color="#800080">), </font>MSG_REGINC<font color="#800080">, </font>MSG_REGNINC<font color="#800080">)
   </font><font color="#008000"><b>elsif </b></font>sacao<font color="#800080">=</font>opSalvarAlteracao <font color="#008000"><b>then
      </b></font>escreveArq<font color="#800080">(</font>tfEditora<font color="#800080">, </font>LinhaReg<font color="#800080">(</font>sreg<font color="#800080">), </font>MSG_REGALT<font color="#800080">, </font>MSG_REGNALT<font color="#800080">)
   </font><font color="#008000"><b>elsif </b></font>sacao<font color="#800080">=</font>opConfirmaExclusao <font color="#008000"><b>then
      </b></font>escreveArq<font color="#800080">(</font>tfEditora<font color="#800080">, </font><font color="#0000FF"><b>repeat</b></font><font color="#800080">(</font><font color="#008000"><i>&quot;*&quot;</i></font><font color="#800080">,</font>tamReg<font color="#800080">(</font>sreg<font color="#800080">)), </font>MSG_REGEXC<font color="#800080">, </font>MSG_REGNEXC<font color="#800080">)
   </font><font color="#008000"><b>end if
elsif </b></font>sreg<font color="#800080">=</font>opEndereco <font color="#008000"><b>then
   if </b></font>sacao<font color="#800080">=</font>opSalvarInclusao <font color="#008000"><b>then
      </b></font>escreveArq<font color="#800080">(</font>tfEndereco<font color="#800080">, </font>LinhaReg<font color="#800080">(</font>sreg<font color="#800080">), </font>MSG_REGINC<font color="#800080">, </font>MSG_REGNINC<font color="#800080">)
   </font><font color="#008000"><b>elsif </b></font>sacao<font color="#800080">=</font>opSalvarAlteracao <font color="#008000"><b>then
      </b></font>escreveArq<font color="#800080">(</font>tfEndereco<font color="#800080">, </font>LinhaReg<font color="#800080">(</font>sreg<font color="#800080">), </font>MSG_REGALT<font color="#800080">, </font>MSG_REGNALT<font color="#800080">)
   </font><font color="#008000"><b>elsif </b></font>sacao<font color="#800080">=</font>opConfirmaExclusao <font color="#008000"><b>then
      </b></font>escreveArq<font color="#800080">(</font>tfEndereco<font color="#800080">, </font><font color="#0000FF"><b>repeat</b></font><font color="#800080">(</font><font color="#008000"><i>&quot;*&quot;</i></font><font color="#800080">,</font>tamReg<font color="#800080">(</font>sreg<font color="#800080">)), </font>MSG_REGEXC<font color="#800080">, </font>MSG_REGNEXC<font color="#800080">)
   </font><font color="#008000"><b>end if
elsif </b></font>sreg<font color="#800080">=</font>opIdioma <font color="#008000"><b>then
   if </b></font>sacao<font color="#800080">=</font>opSalvarInclusao <font color="#008000"><b>then
      </b></font>escreveArq<font color="#800080">(</font>tfIdioma<font color="#800080">, </font>LinhaReg<font color="#800080">(</font>sreg<font color="#800080">), </font>MSG_REGINC<font color="#800080">, </font>MSG_REGNINC<font color="#800080">)
   </font><font color="#008000"><b>elsif </b></font>sacao<font color="#800080">=</font>opSalvarAlteracao <font color="#008000"><b>then
      </b></font>escreveArq<font color="#800080">(</font>tfIdioma<font color="#800080">, </font>LinhaReg<font color="#800080">(</font>sreg<font color="#800080">), </font>MSG_REGALT<font color="#800080">, </font>MSG_REGNALT<font color="#800080">)
   </font><font color="#008000"><b>elsif </b></font>sacao<font color="#800080">=</font>opConfirmaExclusao <font color="#008000"><b>then
      </b></font>escreveArq<font color="#800080">(</font>tfIdioma<font color="#800080">, </font><font color="#0000FF"><b>repeat</b></font><font color="#800080">(</font><font color="#008000"><i>&quot;*&quot;</i></font><font color="#800080">,</font>tamReg<font color="#800080">(</font>sreg<font color="#800080">)), </font>MSG_REGEXC<font color="#800080">, </font>MSG_REGNEXC<font color="#800080">)
   </font><font color="#008000"><b>end if
elsif </b></font>sreg<font color="#800080">=</font>opPais <font color="#008000"><b>then
   if </b></font>sacao<font color="#800080">=</font>opSalvarInclusao <font color="#008000"><b>then
      </b></font>escreveArq<font color="#800080">(</font>tfPais<font color="#800080">, </font>LinhaReg<font color="#800080">(</font>sreg<font color="#800080">), </font>MSG_REGINC<font color="#800080">, </font>MSG_REGNINC<font color="#800080">)
   </font><font color="#008000"><b>elsif </b></font>sacao<font color="#800080">=</font>opSalvarAlteracao <font color="#008000"><b>then
      </b></font>escreveArq<font color="#800080">(</font>tfPais<font color="#800080">, </font>LinhaReg<font color="#800080">(</font>sreg<font color="#800080">), </font>MSG_REGALT<font color="#800080">, </font>MSG_REGNALT<font color="#800080">)
   </font><font color="#008000"><b>elsif </b></font>sacao<font color="#800080">=</font>opConfirmaExclusao <font color="#008000"><b>then
      </b></font>escreveArq<font color="#800080">(</font>tfPais<font color="#800080">, </font><font color="#0000FF"><b>repeat</b></font><font color="#800080">(</font><font color="#008000"><i>&quot;*&quot;</i></font><font color="#800080">,</font>tamReg<font color="#800080">(</font>sreg<font color="#800080">)), </font>MSG_REGEXC<font color="#800080">, </font>MSG_REGNEXC<font color="#800080">)
   </font><font color="#008000"><b>end if
elsif </b></font>sreg<font color="#800080">=</font>opProfissao <font color="#008000"><b>then
   if </b></font>sacao<font color="#800080">=</font>opSalvarInclusao <font color="#008000"><b>then
      </b></font>escreveArq<font color="#800080">(</font>tfProfissao<font color="#800080">, </font>LinhaReg<font color="#800080">(</font>sreg<font color="#800080">), </font>MSG_REGINC<font color="#800080">, </font>MSG_REGNINC<font color="#800080">)
   </font><font color="#008000"><b>elsif </b></font>sacao<font color="#800080">=</font>opSalvarAlteracao <font color="#008000"><b>then
      </b></font>escreveArq<font color="#800080">(</font>tfProfissao<font color="#800080">, </font>LinhaReg<font color="#800080">(</font>sreg<font color="#800080">), </font>MSG_REGALT<font color="#800080">, </font>MSG_REGNALT<font color="#800080">)
   </font><font color="#008000"><b>elsif </b></font>sacao<font color="#800080">=</font>opConfirmaExclusao <font color="#008000"><b>then
      </b></font>escreveArq<font color="#800080">(</font>tfProfissao<font color="#800080">, </font><font color="#0000FF"><b>repeat</b></font><font color="#800080">(</font><font color="#008000"><i>&quot;*&quot;</i></font><font color="#800080">,</font>tamReg<font color="#800080">(</font>sreg<font color="#800080">)), </font>MSG_REGEXC<font color="#800080">, </font>MSG_REGNEXC<font color="#800080">)
   </font><font color="#008000"><b>end if
elsif </b></font>sreg<font color="#800080">=</font>opLivro <font color="#008000"><b>then
   if </b></font>sacao<font color="#800080">=</font>opSalvarInclusao <font color="#008000"><b>then
      </b></font>escreveArq<font color="#800080">(</font>tfLivro<font color="#800080">, </font>LinhaReg<font color="#800080">(</font>sreg<font color="#800080">), </font>MSG_REGINC<font color="#800080">, </font>MSG_REGNINC<font color="#800080">)
   </font><font color="#008000"><b>elsif </b></font>sacao<font color="#800080">=</font>opSalvarAlteracao <font color="#008000"><b>then
      </b></font>escreveArq<font color="#800080">(</font>tfLivro<font color="#800080">, </font>LinhaReg<font color="#800080">(</font>sreg<font color="#800080">), </font>MSG_REGALT<font color="#800080">, </font>MSG_REGNALT<font color="#800080">)
   </font><font color="#008000"><b>elsif </b></font>sacao<font color="#800080">=</font>opConfirmaExclusao <font color="#008000"><b>then
      </b></font>escreveArq<font color="#800080">(</font>tfLivro<font color="#800080">, </font><font color="#0000FF"><b>repeat</b></font><font color="#800080">(</font><font color="#008000"><i>&quot;*&quot;</i></font><font color="#800080">,</font>tamReg<font color="#800080">(</font>sreg<font color="#800080">)), </font>MSG_REGEXC<font color="#800080">, </font>MSG_REGNEXC<font color="#800080">)
   </font><font color="#008000"><b>end if
elsif </b></font>sreg<font color="#800080">=</font>opLivroAss <font color="#008000"><b>then
   if </b></font>sacao<font color="#800080">=</font>opSalvarInclusao <font color="#008000"><b>then
      </b></font>escreveArq<font color="#800080">(</font>tfLivroAss<font color="#800080">, </font>LinhaReg<font color="#800080">(</font>sreg<font color="#800080">), </font>MSG_REGINC<font color="#800080">, </font>MSG_REGNINC<font color="#800080">)
   </font><font color="#008000"><b>elsif </b></font>sacao<font color="#800080">=</font>opSalvarAlteracao <font color="#008000"><b>then
      </b></font>escreveArq<font color="#800080">(</font>tfLivroAss<font color="#800080">, </font>LinhaReg<font color="#800080">(</font>sreg<font color="#800080">), </font>MSG_REGALT<font color="#800080">, </font>MSG_REGNALT<font color="#800080">)
   </font><font color="#008000"><b>elsif </b></font>sacao<font color="#800080">=</font>opConfirmaExclusao <font color="#008000"><b>then
      </b></font>escreveArq<font color="#800080">(</font>tfLivroAss<font color="#800080">, </font><font color="#0000FF"><b>repeat</b></font><font color="#800080">(</font><font color="#008000"><i>&quot;*&quot;</i></font><font color="#800080">,</font>tamReg<font color="#800080">(</font>sreg<font color="#800080">)), </font>MSG_REGEXC<font color="#800080">, </font>MSG_REGNEXC<font color="#800080">)
   </font><font color="#008000"><b>end if
elsif </b></font>sreg<font color="#800080">=</font>opLivroAut <font color="#008000"><b>then
   if </b></font>sacao<font color="#800080">=</font>opSalvarInclusao <font color="#008000"><b>then
      </b></font>escreveArq<font color="#800080">(</font>tfLivroAut<font color="#800080">, </font>LinhaReg<font color="#800080">(</font>sreg<font color="#800080">), </font>MSG_REGINC<font color="#800080">, </font>MSG_REGNINC<font color="#800080">)
   </font><font color="#008000"><b>elsif </b></font>sacao<font color="#800080">=</font>opSalvarAlteracao <font color="#008000"><b>then
      </b></font>escreveArq<font color="#800080">(</font>tfLivroAut<font color="#800080">, </font>LinhaReg<font color="#800080">(</font>sreg<font color="#800080">), </font>MSG_REGALT<font color="#800080">, </font>MSG_REGNALT<font color="#800080">)
   </font><font color="#008000"><b>elsif </b></font>sacao<font color="#800080">=</font>opConfirmaExclusao <font color="#008000"><b>then
      </b></font>escreveArq<font color="#800080">(</font>tfLivroAut<font color="#800080">, </font><font color="#0000FF"><b>repeat</b></font><font color="#800080">(</font><font color="#008000"><i>&quot;*&quot;</i></font><font color="#800080">,</font>tamReg<font color="#800080">(</font>sreg<font color="#800080">)), </font>MSG_REGEXC<font color="#800080">, </font>MSG_REGNEXC<font color="#800080">)
   </font><font color="#008000"><b>end if
elsif </b></font>sreg<font color="#800080">=</font>opCliente <font color="#008000"><b>then
   if </b></font>sacao<font color="#800080">=</font>opSalvarInclusao <font color="#008000"><b>then
      </b></font>escreveArq<font color="#800080">(</font>tfCliente<font color="#800080">, </font>LinhaReg<font color="#800080">(</font>sreg<font color="#800080">), </font>MSG_REGINC<font color="#800080">, </font>MSG_REGNINC<font color="#800080">)
   </font><font color="#008000"><b>elsif </b></font>sacao<font color="#800080">=</font>opSalvarAlteracao <font color="#008000"><b>then
      </b></font>escreveArq<font color="#800080">(</font>tfCliente<font color="#800080">, </font>LinhaReg<font color="#800080">(</font>sreg<font color="#800080">), </font>MSG_REGALT<font color="#800080">, </font>MSG_REGNALT<font color="#800080">)
   </font><font color="#008000"><b>elsif </b></font>sacao<font color="#800080">=</font>opConfirmaExclusao <font color="#008000"><b>then
      </b></font>escreveArq<font color="#800080">(</font>tfCliente<font color="#800080">, </font><font color="#0000FF"><b>repeat</b></font><font color="#800080">(</font><font color="#008000"><i>&quot;*&quot;</i></font><font color="#800080">,</font>tamReg<font color="#800080">(</font>sreg<font color="#800080">)), </font>MSG_REGEXC<font color="#800080">, </font>MSG_REGNEXC<font color="#800080">)
   </font><font color="#008000"><b>end if
elsif </b></font>sreg<font color="#800080">=</font>opVenda <font color="#008000"><b>then
   if </b></font>sacao<font color="#800080">=</font>opSalvarInclusao <font color="#008000"><b>then
      </b></font>escreveArq<font color="#800080">(</font>tfVenda<font color="#800080">, </font>LinhaReg<font color="#800080">(</font>sreg<font color="#800080">), </font>MSG_REGINC<font color="#800080">, </font>MSG_REGNINC<font color="#800080">)
   </font><font color="#008000"><b>elsif </b></font>sacao<font color="#800080">=</font>opSalvarAlteracao <font color="#008000"><b>then
      </b></font>escreveArq<font color="#800080">(</font>tfVenda<font color="#800080">, </font>LinhaReg<font color="#800080">(</font>sreg<font color="#800080">), </font>MSG_REGALT<font color="#800080">, </font>MSG_REGNALT<font color="#800080">)
   </font><font color="#008000"><b>elsif </b></font>sacao<font color="#800080">=</font>opConfirmaExclusao <font color="#008000"><b>then
      </b></font>escreveArq<font color="#800080">(</font>tfVenda<font color="#800080">, </font><font color="#0000FF"><b>repeat</b></font><font color="#800080">(</font><font color="#008000"><i>&quot;*&quot;</i></font><font color="#800080">,</font>tamReg<font color="#800080">(</font>sreg<font color="#800080">)), </font>MSG_REGEXC<font color="#800080">, </font>MSG_REGNEXC<font color="#800080">)
   </font><font color="#008000"><b>end if
elsif </b></font>sreg<font color="#800080">=</font>opUsuario <font color="#008000"><b>then
   if </b></font>sacao<font color="#800080">=</font>opSalvarAlteracao <font color="#008000"><b>then
      </b></font>escreveArq<font color="#800080">(</font>tfUsuario<font color="#800080">, </font>LinhaReg<font color="#800080">(</font>sreg<font color="#800080">), </font>MSG_REGALT<font color="#800080">, </font>MSG_REGNALT<font color="#800080">)
   </font><font color="#008000"><b>end if
end if
end procedure
</b></font><font color="#808080"><i>-- ----------------------------------------------------------------------------
-- Realiza a exclus&atilde;o dos arquivos de liga&ccedil;&atilde;o.
-- sArq - o arquivo de liga&ccedil;&atilde;o
-- sreg - o tipo de arquivo de liga&ccedil;&atilde;o
-- nPosChave - a posicao inicial da chave dentro do registro
-- nTamChave - o tamanho da chave dentro do registro
-- sChave - a chave a ser excluida
-- ----------------------------------------------------------------------------
</i></font><font color="#008000"><b>procedure </b></font>ExcluirRegLigados<font color="#800080">(</font>tarquivo sArq<font color="#800080">, </font>ctArqs sreg<font color="#800080">, </font><font color="#0000FF"><b>integer </b></font>nPosChave<font color="#800080">,
</font>	  <font color="#0000FF"><b>integer </b></font>nTamChave<font color="#800080">, </font><font color="#0000FF"><b>sequence </b></font>sChave<font color="#800080">)
</font><font color="#0000FF"><b>object </b></font>slinha
<font color="#0000FF"><b>sequence </b></font>sCodigo<font color="#800080">, </font>slocal
<font color="#0000FF"><b>integer </b></font>nstatus

nstatus <font color="#800080">= </font><font color="#0000FF">seek</font><font color="#800080">(</font>sArq<font color="#800080">, </font><font color="#FF0000">0</font><font color="#800080">)
</font><font color="#008000"><b>while </b></font>TRUE <font color="#008000"><b>do
  </b></font>slinha <font color="#800080">= </font><font color="#0000FF"><b>gets</b></font><font color="#800080">(</font>sArq<font color="#800080">)
  </font><font color="#008000"><b>if </b></font><font color="#0000FF"><b>atom</b></font><font color="#800080">(</font>slinha<font color="#800080">) </font><font color="#008000"><b>then
    exit 
  end if
  if </b></font><font color="#0000FF"><b>length</b></font><font color="#800080">(</font>slinha<font color="#800080">) &gt; </font><font color="#FF0000">0 </font><font color="#008000"><b>then
    </b></font>slocal <font color="#800080">= </font>slinha
    sCodigo<font color="#800080">=</font>trim<font color="#800080">(</font>copy<font color="#800080">(</font>slocal<font color="#800080">,</font>nPosChave<font color="#800080">,</font>nTamChave<font color="#800080">))
    </font><font color="#008000"><b>if </b></font><font color="#0000FF"><b>equal</b></font><font color="#800080">(</font>sCodigo<font color="#800080">, </font>sChave<font color="#800080">) </font><font color="#008000"><b>then
       </b></font>btnAcao<font color="#800080">(</font>sreg<font color="#800080">, </font>opConfirmaExclusao<font color="#800080">)
    </font><font color="#008000"><b>end if
  end if
end while
end procedure

</b></font><font color="#808080"><i>-- --- Rotinas de implementa&ccedil;&atilde;o da interface ----------------------------------

-- ----------------------------------------------------------------------------
-- Mostra a tela de splash do sistema.
-- ----------------------------------------------------------------------------
</i></font><font color="#008000"><b>procedure </b></font>frmSplash<font color="#800080">()
</font><font color="#0000FF"><b>integer </b></font>cont

<font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font><font color="#008000"><i>&quot;*---------------------------------------&quot; </i></font><font color="#800080">&amp;
 </font><font color="#008000"><i>&quot;-------------------------------------*\n&quot;</i></font><font color="#800080">)
</font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font><font color="#008000"><i>&quot;| LL    II VV   VV RRRRR  UU  UU   SSSS &quot; </i></font><font color="#800080">&amp;
 </font><font color="#008000"><i>&quot;VV   VV II RRRRR  TTTT UU  UU   SSSS |\n&quot;</i></font><font color="#800080">)
</font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font><font color="#008000"><i>&quot;| LL    II  VV VV  RR   R UU  UU  SS    &quot; </i></font><font color="#800080">&amp;
 </font><font color="#008000"><i>&quot; VV VV  II RR   R  TT  UU  UU  SS    |\n&quot;</i></font><font color="#800080">)
</font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font><font color="#008000"><i>&quot;| LL    II   VVV   RRRRR  UU  UU    SS  &quot; </i></font><font color="#800080">&amp;
 </font><font color="#008000"><i>&quot;  VVV   II RRRRR   TT  UU  UU    SS  |\n&quot;</i></font><font color="#800080">)
</font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font><font color="#008000"><i>&quot;| LLLLL II    V    RR   R  UUUU  SSSS   &quot; </i></font><font color="#800080">&amp;
 </font><font color="#008000"><i>&quot;   V    II RR   R  TT   UUUU  SSSS   |\n&quot;</i></font><font color="#800080">)
</font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font><font color="#008000"><i>&quot;*---------------------------------------&quot; </i></font><font color="#800080">&amp;
 </font><font color="#008000"><i>&quot;-------------------------------------*\n&quot;</i></font><font color="#800080">)
 </font><font color="#008000"><b>for </b></font>ncont <font color="#800080">= </font><font color="#FF0000">1 </font><font color="#008000"><b>to </b></font><font color="#FF0000">18 </font><font color="#008000"><b>do
   </b></font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">,</font><font color="#008000"><i>&quot;\n&quot;</i></font><font color="#800080">)
 </font><font color="#008000"><b>end for
 </b></font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font>MSG_PRESS<font color="#800080">)
 </font>cont <font color="#800080">= </font><font color="#0000FF">wait_key</font><font color="#800080">()
 </font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">,</font><font color="#008000"><i>&quot;\n&quot;</i></font><font color="#800080">)
</font><font color="#008000"><b>end procedure
</b></font><font color="#808080"><i>-- ----------------------------------------------------------------------------
-- Mostra a tela de sobre do sistema.
-- ----------------------------------------------------------------------------
</i></font><font color="#008000"><b>procedure </b></font>frmSobre<font color="#800080">()
</font><font color="#0000FF"><b>integer </b></font>cont

<font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font><font color="#008000"><i>&quot;*------------------------------------------------------------*\n&quot;</i></font><font color="#800080">)
</font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font><font color="#008000"><i>&quot;|  LL        II  VV       VV  RRRRRRR   UU    UU   SSSSSSS   |\n&quot;</i></font><font color="#800080">)
</font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font><font color="#008000"><i>&quot;|  LL        II   VV     VV   RR     R  UU    UU  SS         |\n&quot;</i></font><font color="#800080">)
</font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font><font color="#008000"><i>&quot;|  LL        II    VV   VV    RR     R  UU    UU   SSSS      |\n&quot;</i></font><font color="#800080">)
</font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font><font color="#008000"><i>&quot;|  LL        II     VV VV     RRRRRRR   UU    UU     SSSS    |\n&quot;</i></font><font color="#800080">)
</font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font><font color="#008000"><i>&quot;|  LLLL      II      VVV      RR RR     UU    UU        SS   |\n&quot;</i></font><font color="#800080">)
</font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font><font color="#008000"><i>&quot;|  LLLLLLLL  II       V       RR   RR    UUUUUU   SSSSSSSS   |\n&quot;</i></font><font color="#800080">)
</font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font><font color="#008000"><i>&quot;|                                                            |\n&quot;</i></font><font color="#800080">)
</font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font><font color="#008000"><i>&quot;|  VV       VV  II  RRRRRRR   TTTTTTTT  UU    UU   SSSSSSS   |\n&quot;</i></font><font color="#800080">)
</font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font><font color="#008000"><i>&quot;|   VV     VV   II  RR     R     TT     UU    UU  SS         |\n&quot;</i></font><font color="#800080">)
</font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font><font color="#008000"><i>&quot;|    VV   VV    II  RR     R     TT     UU    UU   SSSS      |\n&quot;</i></font><font color="#800080">)
</font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font><font color="#008000"><i>&quot;|     VV VV     II  RRRRRRR      TT     UU    UU     SSSS    |\n&quot;</i></font><font color="#800080">)
</font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font><font color="#008000"><i>&quot;|      VVV      II  RR RR        TT     UU    UU        SS   |\n&quot;</i></font><font color="#800080">)
</font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font><font color="#008000"><i>&quot;|       V       II  RR   RR      TT      UUUUUU   SSSSSSSS   |\n&quot;</i></font><font color="#800080">)
</font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font><font color="#008000"><i>&quot;|                                                            |\n&quot;</i></font><font color="#800080">)
</font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font><font color="#008000"><i>&quot;|                                               Versao 1.0.0 |\n&quot;</i></font><font color="#800080">)
</font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font><font color="#008000"><i>&quot;| Sistema integrante do projeto Livrus Virtus.               |\n&quot;</i></font><font color="#800080">)
</font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font><font color="#008000"><i>&quot;| Todos os direitos reservados para Henrique F. de Souza.    |\n&quot;</i></font><font color="#800080">)
</font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font><font color="#008000"><i>&quot;| Versao programada na linguagem euphoria.                   |\n&quot;</i></font><font color="#800080">)
</font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font><font color="#008000"><i>&quot;*------------------------------------------------------------*\n&quot;</i></font><font color="#800080">)
 </font><font color="#008000"><b>for </b></font>ncont <font color="#800080">= </font><font color="#FF0000">1 </font><font color="#008000"><b>to </b></font><font color="#FF0000">4 </font><font color="#008000"><b>do
  </b></font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font><font color="#008000"><i>&quot;\n&quot;</i></font><font color="#800080">)
 </font><font color="#008000"><b>end for
 </b></font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font>MSG_PRESS<font color="#800080">)
 </font>cont <font color="#800080">= </font><font color="#0000FF">wait_key</font><font color="#800080">()
 </font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">,</font><font color="#008000"><i>&quot;\n&quot;</i></font><font color="#800080">)
</font><font color="#008000"><b>end procedure
</b></font><font color="#808080"><i>-- ----------------------------------------------------------------------------
-- Mostra a tela de login do sistema.
-- retorna - se o login foi validado corretamente
-- ----------------------------------------------------------------------------
</i></font><font color="#008000"><b>function </b></font>frmLogin<font color="#800080">()
</font>boolean bret
<font color="#0000FF"><b>sequence </b></font>slinha

 bret<font color="#800080">=</font>FALSE
 <font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font><font color="#008000"><i>&quot;*--------------------------------------------------------------*\n&quot;</i></font><font color="#800080">)
 </font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font><font color="#008000"><i>&quot;| Login do sistema                                             |\n&quot;</i></font><font color="#800080">)
 </font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font><font color="#008000"><i>&quot;*--------------------------------------------------------------*\n&quot;</i></font><font color="#800080">)
  </font>slinha<font color="#800080">=</font>validaEntrada<font color="#800080">(</font>tfUsuario<font color="#800080">, </font>opUsuario<font color="#800080">, </font><font color="#FF0000">1</font><font color="#800080">, </font>tUsuario<font color="#800080">[</font>LOGIN<font color="#800080">], </font><font color="#FF0000">3</font><font color="#800080">,
        </font>FALSE<font color="#800080">, </font>opTexto<font color="#800080">)
  </font><font color="#008000"><b>if </b></font><font color="#0000FF"><b>equal</b></font><font color="#800080">(</font>slinha<font color="#800080">, </font><font color="#008000"><i>&quot;&quot;</i></font><font color="#800080">)=</font>FALSE <font color="#008000"><b>then
     </b></font>slinha<font color="#800080">=</font>validaEntrada<font color="#800080">(</font>tfUsuario<font color="#800080">, </font>opUsuario<font color="#800080">, </font><font color="#FF0000">2</font><font color="#800080">, </font>tUsuario<font color="#800080">[</font>SENHA<font color="#800080">], </font><font color="#FF0000">3</font><font color="#800080">,
        </font>FALSE<font color="#800080">, </font>opSenha<font color="#800080">)
     </font><font color="#008000"><b>if </b></font><font color="#0000FF"><b>equal</b></font><font color="#800080">(</font>slinha<font color="#800080">, </font><font color="#008000"><i>&quot;&quot;</i></font><font color="#800080">)=</font>FALSE <font color="#008000"><b>then
        </b></font>tUsuario<font color="#800080">[</font>LOGIN<font color="#800080">]=</font>trim<font color="#800080">(</font>copy<font color="#800080">(</font>slinha<font color="#800080">, </font><font color="#FF0000">1</font><font color="#800080">, </font><font color="#FF0000">10</font><font color="#800080">))
        </font>tUsuario<font color="#800080">[</font>SENHA<font color="#800080">]=</font>trim<font color="#800080">(</font>copy<font color="#800080">(</font>slinha<font color="#800080">, </font><font color="#FF0000">11</font><font color="#800080">, </font><font color="#FF0000">10</font><font color="#800080">))
        </font>bret<font color="#800080">=</font>TRUE
     <font color="#008000"><b>end if
  end if
 </b></font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font><font color="#008000"><i>&quot;\n&quot;</i></font><font color="#800080">)
</font><font color="#008000"><b>return </b></font>bret
<font color="#008000"><b>end function

</b></font><font color="#808080"><i>-- ----------------------------------------------------------------------------
-- Seleciona o menu e/ou a tela certa de acordo com o tipo de arquivo.
-- nmenu - o n&uacute;mero do menu
-- sreg - o tipo de arquivo
-- ----------------------------------------------------------------------------
</i></font><font color="#008000"><b>procedure </b></font>subMenu3<font color="#800080">(</font><font color="#0000FF"><b>integer </b></font>nmenu<font color="#800080">, </font>ctArqs sreg<font color="#800080">)
</font><font color="#0000FF"><b>integer </b></font>opSubMenu
<font color="#0000FF"><b>sequence </b></font>opCSubMenu
boolean bSOp

bSOp<font color="#800080">=</font>TRUE
<font color="#008000"><b>if </b></font>nmenu <font color="#800080">= </font><font color="#FF0000">9 </font><font color="#008000"><b>then
    while </b></font>bSOp <font color="#008000"><b>do      
      </b></font>opSubMenu <font color="#800080">= </font>digita<font color="#800080">(</font>menu<font color="#800080">(</font>nmenu<font color="#800080">), </font>TRUE<font color="#800080">)
      </font><font color="#008000"><b>if </b></font>opSubMenu <font color="#800080">= </font><font color="#FF0000">1 </font><font color="#008000"><b>then 
        </b></font>btnAcao<font color="#800080">(</font>sreg<font color="#800080">, </font>opSalvarAlteracao<font color="#800080">) 
        </font>bSOp<font color="#800080">=</font>FALSE
      <font color="#008000"><b>elsif </b></font>opSubMenu <font color="#800080">= </font><font color="#FF0000">2 </font><font color="#008000"><b>then </b></font>bSOp<font color="#800080">=</font>FALSE
      <font color="#008000"><b>else </b></font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font>MSG_ERRO<font color="#800080">)
      </font><font color="#008000"><b>end if
    end while
elsif </b></font>nmenu <font color="#800080">= </font><font color="#FF0000">10 </font><font color="#008000"><b>then
    while </b></font>bSOp <font color="#008000"><b>do      
      </b></font>opCSubMenu <font color="#800080">= </font>digita<font color="#800080">(</font>menu<font color="#800080">(</font>nmenu<font color="#800080">), </font>FALSE<font color="#800080">)
      </font><font color="#008000"><b>if </b></font><font color="#0000FF"><b>equal</b></font><font color="#800080">(</font>opCSubMenu<font color="#800080">,</font><font color="#008000"><i>&quot;S&quot;</i></font><font color="#800080">) </font><font color="#008000"><b>or </b></font><font color="#0000FF"><b>equal</b></font><font color="#800080">(</font>opCSubMenu<font color="#800080">,</font><font color="#008000"><i>&quot;s&quot;</i></font><font color="#800080">) </font><font color="#008000"><b>then
         </b></font>btnAcao<font color="#800080">(</font>sreg<font color="#800080">, </font>opConfirmaExclusao<font color="#800080">)
         </font>bSOp<font color="#800080">=</font>FALSE
      <font color="#008000"><b>elsif </b></font><font color="#0000FF"><b>equal</b></font><font color="#800080">(</font>opCSubMenu<font color="#800080">,</font><font color="#008000"><i>&quot;N&quot;</i></font><font color="#800080">) </font><font color="#008000"><b>or </b></font><font color="#0000FF"><b>equal</b></font><font color="#800080">(</font>opCSubMenu<font color="#800080">,</font><font color="#008000"><i>&quot;n&quot;</i></font><font color="#800080">) </font><font color="#008000"><b>then </b></font>bSOp<font color="#800080">=</font>FALSE
      <font color="#008000"><b>else </b></font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font>MSG_ERRO<font color="#800080">)
      </font><font color="#008000"><b>end if
    end while
end if
end procedure
</b></font><font color="#808080"><i>-- ----------------------------------------------------------------------------
-- Seleciona o menu e/ou a tela certa de acordo com o tipo de arquivo.
-- nmenu - o n&uacute;mero do menu
-- sreg - o tipo de arquivo
-- ----------------------------------------------------------------------------
</i></font><font color="#008000"><b>procedure </b></font>subMenu4<font color="#800080">(</font><font color="#0000FF"><b>integer </b></font>nmenu<font color="#800080">, </font>ctArqs sreg<font color="#800080">)
</font><font color="#0000FF"><b>sequence </b></font>opCSubMenu
boolean bSOp

bSOp<font color="#800080">=</font>TRUE
<font color="#008000"><b>if </b></font>nmenu <font color="#800080">= </font><font color="#FF0000">14 </font><font color="#008000"><b>then
    while </b></font>bSOp <font color="#008000"><b>do      
      </b></font>opCSubMenu <font color="#800080">= </font>digita<font color="#800080">(</font>menu<font color="#800080">(</font>nmenu<font color="#800080">), </font>FALSE<font color="#800080">)
      </font><font color="#008000"><b>if </b></font><font color="#0000FF"><b>equal</b></font><font color="#800080">(</font>opCSubMenu<font color="#800080">,</font><font color="#008000"><i>&quot;S&quot;</i></font><font color="#800080">) </font><font color="#008000"><b>or </b></font><font color="#0000FF"><b>equal</b></font><font color="#800080">(</font>opCSubMenu<font color="#800080">,</font><font color="#008000"><i>&quot;s&quot;</i></font><font color="#800080">) </font><font color="#008000"><b>then
         </b></font>btnAcao<font color="#800080">(</font>sreg<font color="#800080">, </font>opSalvarInclusao<font color="#800080">)
         </font>bSOp<font color="#800080">=</font>FALSE
         g_SalvarInclusao<font color="#800080">=</font>TRUE
      <font color="#008000"><b>elsif </b></font><font color="#0000FF"><b>equal</b></font><font color="#800080">(</font>opCSubMenu<font color="#800080">,</font><font color="#008000"><i>&quot;N&quot;</i></font><font color="#800080">) </font><font color="#008000"><b>or </b></font><font color="#0000FF"><b>equal</b></font><font color="#800080">(</font>opCSubMenu<font color="#800080">,</font><font color="#008000"><i>&quot;n&quot;</i></font><font color="#800080">) </font><font color="#008000"><b>then </b></font>bSOp<font color="#800080">=</font>FALSE
      <font color="#008000"><b>else </b></font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font>MSG_ERRO<font color="#800080">)
      </font><font color="#008000"><b>end if
    end while
end if
end procedure
</b></font><font color="#808080"><i>-- ----------------------------------------------------------------------------
-- Realiza os cadastros dos arquivos que se ligam a outros arquivos.
-- sreg - o tipo de arquivo
-- sacao - a a&ccedil;&atilde;o a ser realizada
-- sCodigo - um das chaves do arquivo de liga&ccedil;&atilde;o
-- ----------------------------------------------------------------------------
</i></font><font color="#008000"><b>procedure </b></font>frmCadLigados<font color="#800080">(</font>ctArqs sreg<font color="#800080">, </font>ctAcao sacao<font color="#800080">, </font><font color="#0000FF"><b>sequence </b></font>sCodigo<font color="#800080">)
</font><font color="#0000FF"><b>integer </b></font>nQtd<font color="#800080">, </font>nCont<font color="#800080">, </font>nQtdEstoque<font color="#800080">, </font>nstatus 
<font color="#0000FF"><b>atom </b></font>nTotalPreco
<font color="#0000FF"><b>sequence </b></font>slinha<font color="#800080">, </font>sTotalPreco<font color="#800080">, </font>sPreco<font color="#800080">, </font>sQtd

sQtd <font color="#800080">= </font><font color="#008000"><i>&quot;&quot;
</i><b>if </b></font>sacao<font color="#800080">=</font>opNovo <font color="#008000"><b>then
  </b></font>nCont<font color="#800080">=</font><font color="#FF0000">1
  </font><font color="#008000"><b>if </b></font>sreg<font color="#800080">=</font>opLivroAss <font color="#008000"><b>then
    </b></font>sQtd<font color="#800080">=</font>validaNumero<font color="#800080">(</font><font color="#008000"><i>&quot;Quantos assuntos quer cadastrar?: &quot;</i></font><font color="#800080">, </font>sQtd<font color="#800080">)
    </font>nQtd<font color="#800080">=</font>StrToNum<font color="#800080">(</font>sQtd<font color="#800080">)
    </font>nstatus <font color="#800080">= </font><font color="#0000FF">seek</font><font color="#800080">(</font>tfLivroAss<font color="#800080">, </font><font color="#FF0000">0</font><font color="#800080">)
    </font><font color="#008000"><b>while </b></font>nCont <font color="#800080">&lt;= </font>nQtd <font color="#008000"><b>do
      </b></font>tLivroAss<font color="#800080">[</font>ISBN<font color="#800080">]=</font>sCodigo
      tLivroAss<font color="#800080">[</font>CODASSUNTO<font color="#800080">] = </font>digita<font color="#800080">(</font>rotulo<font color="#800080">(</font>opLivroAss<font color="#800080">, </font><font color="#FF0000">2</font><font color="#800080">), </font>FALSE<font color="#800080">)
      </font>slinha<font color="#800080">=</font>pesqArq<font color="#800080">(</font>tfAssunto<font color="#800080">, </font>tLivroAss<font color="#800080">[</font>CODASSUNTO<font color="#800080">],</font><font color="#FF0000">1</font><font color="#800080">,</font><font color="#FF0000">10</font><font color="#800080">,</font>tamReg<font color="#800080">(</font>opAssunto<font color="#800080">))
      </font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font><font color="#008000"><i>&quot; &quot; </i></font><font color="#800080">&amp; </font>rotulo<font color="#800080">(</font>opAssunto<font color="#800080">, </font><font color="#FF0000">2</font><font color="#800080">))
      </font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">,</font>copy<font color="#800080">(</font>slinha<font color="#800080">, </font>g_nPosChave<font color="#800080">, </font>g_nTamChave<font color="#800080">) &amp; </font><font color="#008000"><i>&quot;\n&quot;</i></font><font color="#800080">)
      </font>pesqLinhaExcluida<font color="#800080">(</font>tfLivroAss<font color="#800080">, </font>tamReg<font color="#800080">(</font>sreg<font color="#800080">))
      </font>subMenu4<font color="#800080">(</font><font color="#FF0000">14</font><font color="#800080">, </font>sreg<font color="#800080">)
      </font>nCont<font color="#800080">=</font>nCont<font color="#800080">+</font><font color="#FF0000">1
    </font><font color="#008000"><b>end while
  elsif </b></font>sreg<font color="#800080">=</font>opLivroAut <font color="#008000"><b>then
    </b></font>sQtd<font color="#800080">=</font>validaNumero<font color="#800080">(</font><font color="#008000"><i>&quot;Quantos autores quer cadastrar?: &quot;</i></font><font color="#800080">,</font>sQtd<font color="#800080">)
    </font>nQtd<font color="#800080">=</font>StrToNum<font color="#800080">(</font>sQtd<font color="#800080">)
    </font>nstatus <font color="#800080">= </font><font color="#0000FF">seek</font><font color="#800080">(</font>tfLivroAut<font color="#800080">, </font><font color="#FF0000">0</font><font color="#800080">)
    </font><font color="#008000"><b>while </b></font>nCont <font color="#800080">&lt;= </font>nQtd <font color="#008000"><b>do
      </b></font>tLivroAut<font color="#800080">[</font>ISBN<font color="#800080">]=</font>sCodigo
      tLivroAut<font color="#800080">[</font>CODAUTOR<font color="#800080">] = </font>digita<font color="#800080">(</font>rotulo<font color="#800080">(</font>opLivroAut<font color="#800080">, </font><font color="#FF0000">2</font><font color="#800080">), </font>FALSE<font color="#800080">)
      </font>slinha<font color="#800080">=</font>pesqArq<font color="#800080">(</font>tfAutor<font color="#800080">, </font>tLivroAut<font color="#800080">[</font>CODAUTOR<font color="#800080">],</font><font color="#FF0000">1</font><font color="#800080">,</font><font color="#FF0000">10</font><font color="#800080">,</font>tamReg<font color="#800080">(</font>opAutor<font color="#800080">))
      </font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">,</font><font color="#008000"><i>&quot; &quot; </i></font><font color="#800080">&amp; </font>rotulo<font color="#800080">(</font>opAutor<font color="#800080">, </font><font color="#FF0000">2</font><font color="#800080">))
      </font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">,</font>copy<font color="#800080">(</font>slinha<font color="#800080">, </font>g_nPosChave<font color="#800080">, </font>g_nTamChave<font color="#800080">) &amp; </font><font color="#008000"><i>&quot;\n&quot;</i></font><font color="#800080">)
      </font>pesqLinhaExcluida<font color="#800080">(</font>tfLivroAut<font color="#800080">, </font>tamReg<font color="#800080">(</font>sreg<font color="#800080">))
      </font>subMenu4<font color="#800080">(</font><font color="#FF0000">14</font><font color="#800080">, </font>sreg<font color="#800080">)
      </font>nCont<font color="#800080">=</font>nCont<font color="#800080">+</font><font color="#FF0000">1
    </font><font color="#008000"><b>end while
  elsif </b></font>sreg<font color="#800080">=</font>opVenda <font color="#008000"><b>then
    </b></font>sQtd<font color="#800080">=</font>validaNumero<font color="#800080">(</font><font color="#008000"><i>&quot;Quantos livros quer vender?: &quot;</i></font><font color="#800080">,</font>sQtd<font color="#800080">)
    </font>nQtd<font color="#800080">=</font>StrToNum<font color="#800080">(</font>sQtd<font color="#800080">)
    </font>nTotalPreco<font color="#800080">=</font><font color="#FF0000">0.0
    </font><font color="#008000"><b>while </b></font>nCont <font color="#800080">&lt;= </font>nQtd <font color="#008000"><b>do
      </b></font>slinha<font color="#800080">=</font>validaEntrada<font color="#800080">(</font>tfLivro<font color="#800080">,</font>opLivro<font color="#800080">,</font><font color="#FF0000">1</font><font color="#800080">,</font>tVenda<font color="#800080">[</font>ISBNVENDA<font color="#800080">],</font><font color="#FF0000">3</font><font color="#800080">,</font>FALSE<font color="#800080">,</font>opTexto<font color="#800080">)
      </font><font color="#008000"><b>if </b></font><font color="#0000FF"><b>equal</b></font><font color="#800080">(</font>slinha<font color="#800080">, </font><font color="#008000"><i>&quot;&quot;</i></font><font color="#800080">)=</font>FALSE <font color="#008000"><b>then
        </b></font>tVenda<font color="#800080">[</font>ISBNVENDA<font color="#800080">]=</font>trim<font color="#800080">(</font>copy<font color="#800080">(</font>slinha<font color="#800080">,</font><font color="#FF0000">1</font><font color="#800080">,</font><font color="#FF0000">13</font><font color="#800080">))
        </font><font color="#008000"><b>if </b></font>validaISBN<font color="#800080">(</font>tVenda<font color="#800080">[</font>ISBNVENDA<font color="#800080">]) </font><font color="#008000"><b>then
          </b></font>mostrarDados<font color="#800080">(</font>sreg<font color="#800080">, </font><font color="#008000"><i>&quot;&quot;</i></font><font color="#800080">, </font><font color="#FF0000">1</font><font color="#800080">)
          </font>tLivro<font color="#800080">[</font>QTDESTOQUE<font color="#800080">]=</font>trim<font color="#800080">(</font>copy<font color="#800080">(</font>slinha<font color="#800080">,</font><font color="#FF0000">134</font><font color="#800080">,</font><font color="#FF0000">10</font><font color="#800080">))
          </font>nQtdEstoque<font color="#800080">=</font>StrToNum<font color="#800080">(</font>tLivro<font color="#800080">[</font>QTDESTOQUE<font color="#800080">])
          </font><font color="#008000"><b>if </b></font>nQtdEstoque <font color="#800080">&gt; </font><font color="#FF0000">0 </font><font color="#008000"><b>then
             </b></font>nTotalPreco<font color="#800080">=</font>nTotalPreco <font color="#800080">+ </font>g_nPreco
             sPreco<font color="#800080">=</font>NumToStr<font color="#800080">(</font>g_nPreco<font color="#800080">)
             </font>tVenda<font color="#800080">[</font>PRECOVENDA<font color="#800080">]=</font>sPreco
             g_SalvarInclusao<font color="#800080">=</font>FALSE
             subMenu4<font color="#800080">(</font><font color="#FF0000">14</font><font color="#800080">, </font>sreg<font color="#800080">)
             </font><font color="#008000"><b>if </b></font>g_SalvarInclusao <font color="#008000"><b>then
                </b></font>slinha<font color="#800080">=</font>pesqArq<font color="#800080">(</font>tfLivro<font color="#800080">, </font>tVenda<font color="#800080">[</font>ISBNVENDA<font color="#800080">], </font><font color="#FF0000">1</font><font color="#800080">, </font><font color="#FF0000">13</font><font color="#800080">, </font>tamReg<font color="#800080">(</font>opLivro<font color="#800080">))
                </font><font color="#008000"><b>if </b></font><font color="#0000FF"><b>equal</b></font><font color="#800080">(</font>slinha<font color="#800080">, </font><font color="#008000"><i>&quot;&quot;</i></font><font color="#800080">)=</font>FALSE <font color="#008000"><b>then
                   </b></font>nQtdEstoque<font color="#800080">=</font>nQtdEstoque<font color="#800080">-</font><font color="#FF0000">1
                   </font>tLivro<font color="#800080">[</font>QTDESTOQUE<font color="#800080">] = </font>NumToStr<font color="#800080">(</font>nQtdEstoque<font color="#800080">)
                   </font>slinha<font color="#800080">=</font>copy<font color="#800080">(</font>slinha<font color="#800080">,</font><font color="#FF0000">1</font><font color="#800080">,</font><font color="#FF0000">133</font><font color="#800080">) &amp; </font>esp<font color="#800080">(</font>tLivro<font color="#800080">[</font>QTDESTOQUE<font color="#800080">],</font><font color="#FF0000">10</font><font color="#800080">)
                   </font>escreveArq<font color="#800080">(</font>tfLivro<font color="#800080">, </font>slinha<font color="#800080">, </font><font color="#008000"><i>&quot;&quot;</i></font><font color="#800080">, </font><font color="#008000"><i>&quot;&quot;</i></font><font color="#800080">)
                </font><font color="#008000"><b>end if
             end if
             </b></font>nCont<font color="#800080">=</font>nCont<font color="#800080">+</font><font color="#FF0000">1
          </font><font color="#008000"><b>else </b></font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font>MSG_SEMESTOQUE<font color="#800080">)
          </font><font color="#008000"><b>end if
        else </b></font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font>MSG_ISBNINV<font color="#800080">)
        </font><font color="#008000"><b>end if
      end if
    end while
    </b></font>sTotalPreco<font color="#800080">=</font>NumToStr<font color="#800080">(</font>nTotalPreco<font color="#800080">)
    </font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font><font color="#008000"><i>&quot;Total de &quot; </i></font><font color="#800080">&amp; </font>rotulo<font color="#800080">(</font>sreg<font color="#800080">,</font><font color="#FF0000">4</font><font color="#800080">) &amp; </font>sTotalPreco <font color="#800080">&amp; </font><font color="#008000"><i>&quot;\n&quot;</i></font><font color="#800080">)
  </font><font color="#008000"><b>end if
elsif </b></font>sacao<font color="#800080">=</font>opExcluir <font color="#008000"><b>then
  if </b></font>sreg<font color="#800080">=</font>opLivroAss <font color="#008000"><b>then
     </b></font>ExcluirRegLigados<font color="#800080">(</font>tfLivroAss<font color="#800080">, </font>sreg<font color="#800080">, </font><font color="#FF0000">1</font><font color="#800080">, </font><font color="#FF0000">13</font><font color="#800080">, </font>sCodigo<font color="#800080">)
  </font><font color="#008000"><b>elsif </b></font>sreg<font color="#800080">=</font>opLivroAut <font color="#008000"><b>then
     </b></font>ExcluirRegLigados<font color="#800080">(</font>tfLivroAut<font color="#800080">, </font>sreg<font color="#800080">, </font><font color="#FF0000">1</font><font color="#800080">, </font><font color="#FF0000">13</font><font color="#800080">, </font>sCodigo<font color="#800080">)
  </font><font color="#008000"><b>end if
end if

end procedure
</b></font><font color="#808080"><i>-- ----------------------------------------------------------------------------
-- Realiza os cadastros de acordo com o tipo de arquivo.
-- sreg - o tipo de arquivo
-- sacao - a a&ccedil;&atilde;o a ser realizada
-- ----------------------------------------------------------------------------
</i></font><font color="#008000"><b>procedure </b></font>frmCadastros2<font color="#800080">(</font>ctArqs sreg<font color="#800080">, </font>ctAcao sacao<font color="#800080">)
</font><font color="#008000"><b>if </b></font>sreg<font color="#800080">=</font>opAssunto <font color="#008000"><b>then
   if </b></font>sacao<font color="#800080">=</font>opAlterar <font color="#008000"><b>then
      </b></font>mostrarDados<font color="#800080">(</font>sreg<font color="#800080">, </font><font color="#008000"><i>&quot;&quot;</i></font><font color="#800080">, </font><font color="#FF0000">1</font><font color="#800080">)
      </font>subMenu3<font color="#800080">(</font><font color="#FF0000">9</font><font color="#800080">, </font>sreg<font color="#800080">)
   </font><font color="#008000"><b>elsif </b></font>sacao<font color="#800080">=</font>opExcluir <font color="#008000"><b>then
      </b></font>subMenu3<font color="#800080">(</font><font color="#FF0000">10</font><font color="#800080">, </font>sreg<font color="#800080">)
   </font><font color="#008000"><b>end if
elsif </b></font>sreg<font color="#800080">=</font>opAutor <font color="#008000"><b>then
   if </b></font>sacao<font color="#800080">=</font>opAlterar <font color="#008000"><b>then
      </b></font>mostrarDados<font color="#800080">(</font>sreg<font color="#800080">, </font><font color="#008000"><i>&quot;&quot;</i></font><font color="#800080">, </font><font color="#FF0000">1</font><font color="#800080">)
      </font>subMenu3<font color="#800080">(</font><font color="#FF0000">9</font><font color="#800080">, </font>sreg<font color="#800080">)
   </font><font color="#008000"><b>elsif </b></font>sacao<font color="#800080">=</font>opExcluir <font color="#008000"><b>then
      </b></font>subMenu3<font color="#800080">(</font><font color="#FF0000">10</font><font color="#800080">, </font>sreg<font color="#800080">)
   </font><font color="#008000"><b>end if
elsif </b></font>sreg<font color="#800080">=</font>opEditora <font color="#008000"><b>then
   if </b></font>sacao<font color="#800080">=</font>opAlterar <font color="#008000"><b>then
      </b></font>mostrarDados<font color="#800080">(</font>sreg<font color="#800080">, </font><font color="#008000"><i>&quot;&quot;</i></font><font color="#800080">, </font><font color="#FF0000">1</font><font color="#800080">)
      </font>subMenu3<font color="#800080">(</font><font color="#FF0000">9</font><font color="#800080">, </font>sreg<font color="#800080">)
   </font><font color="#008000"><b>elsif </b></font>sacao<font color="#800080">=</font>opExcluir <font color="#008000"><b>then
      </b></font>subMenu3<font color="#800080">(</font><font color="#FF0000">10</font><font color="#800080">, </font>sreg<font color="#800080">)
   </font><font color="#008000"><b>end if
elsif </b></font>sreg<font color="#800080">=</font>opEndereco <font color="#008000"><b>then
   if </b></font>sacao<font color="#800080">=</font>opAlterar <font color="#008000"><b>then
      </b></font>mostrarDados<font color="#800080">(</font>sreg<font color="#800080">, </font><font color="#008000"><i>&quot;&quot;</i></font><font color="#800080">, </font><font color="#FF0000">1</font><font color="#800080">)
      </font>subMenu3<font color="#800080">(</font><font color="#FF0000">9</font><font color="#800080">, </font>sreg<font color="#800080">)
   </font><font color="#008000"><b>elsif </b></font>sacao<font color="#800080">=</font>opExcluir <font color="#008000"><b>then
      </b></font>subMenu3<font color="#800080">(</font><font color="#FF0000">10</font><font color="#800080">, </font>sreg<font color="#800080">)
   </font><font color="#008000"><b>end if
elsif </b></font>sreg<font color="#800080">=</font>opIdioma <font color="#008000"><b>then
   if </b></font>sacao<font color="#800080">=</font>opAlterar <font color="#008000"><b>then
      </b></font>mostrarDados<font color="#800080">(</font>sreg<font color="#800080">, </font><font color="#008000"><i>&quot;&quot;</i></font><font color="#800080">, </font><font color="#FF0000">1</font><font color="#800080">)
      </font>subMenu3<font color="#800080">(</font><font color="#FF0000">9</font><font color="#800080">, </font>sreg<font color="#800080">)
   </font><font color="#008000"><b>elsif </b></font>sacao<font color="#800080">=</font>opExcluir <font color="#008000"><b>then
      </b></font>subMenu3<font color="#800080">(</font><font color="#FF0000">10</font><font color="#800080">, </font>sreg<font color="#800080">)
   </font><font color="#008000"><b>end if
elsif </b></font>sreg<font color="#800080">=</font>opPais <font color="#008000"><b>then
   if </b></font>sacao<font color="#800080">=</font>opAlterar <font color="#008000"><b>then
      </b></font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font>rotulo<font color="#800080">(</font>sreg<font color="#800080">, </font><font color="#FF0000">1</font><font color="#800080">) &amp; </font>tPais<font color="#800080">[</font>CODIGO<font color="#800080">])
      </font>mostrarDados<font color="#800080">(</font>sreg<font color="#800080">, </font><font color="#008000"><i>&quot;&quot;</i></font><font color="#800080">, </font><font color="#FF0000">1</font><font color="#800080">)
      </font>subMenu3<font color="#800080">(</font><font color="#FF0000">9</font><font color="#800080">, </font>sreg<font color="#800080">)
   </font><font color="#008000"><b>elsif </b></font>sacao<font color="#800080">=</font>opExcluir <font color="#008000"><b>then
      </b></font>subMenu3<font color="#800080">(</font><font color="#FF0000">10</font><font color="#800080">, </font>sreg<font color="#800080">)
   </font><font color="#008000"><b>end if
elsif </b></font>sreg<font color="#800080">=</font>opProfissao <font color="#008000"><b>then
   if </b></font>sacao<font color="#800080">=</font>opAlterar <font color="#008000"><b>then
      </b></font>mostrarDados<font color="#800080">(</font>sreg<font color="#800080">, </font><font color="#008000"><i>&quot;&quot;</i></font><font color="#800080">, </font><font color="#FF0000">1</font><font color="#800080">)
      </font>subMenu3<font color="#800080">(</font><font color="#FF0000">9</font><font color="#800080">, </font>sreg<font color="#800080">)
   </font><font color="#008000"><b>elsif </b></font>sacao<font color="#800080">=</font>opExcluir <font color="#008000"><b>then
      </b></font>subMenu3<font color="#800080">(</font><font color="#FF0000">10</font><font color="#800080">, </font>sreg<font color="#800080">)
   </font><font color="#008000"><b>end if
elsif </b></font>sreg<font color="#800080">=</font>opLivro <font color="#008000"><b>then
   if </b></font>sacao<font color="#800080">=</font>opAlterar <font color="#008000"><b>then
      </b></font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font>rotulo<font color="#800080">(</font>sreg<font color="#800080">, </font><font color="#FF0000">1</font><font color="#800080">) &amp; </font>tLivro<font color="#800080">[</font>ISBN<font color="#800080">])
      </font>mostrarDados<font color="#800080">(</font>sreg<font color="#800080">, </font><font color="#008000"><i>&quot;&quot;</i></font><font color="#800080">, </font><font color="#FF0000">1</font><font color="#800080">)
      </font>subMenu3<font color="#800080">(</font><font color="#FF0000">9</font><font color="#800080">, </font>sreg<font color="#800080">)
      </font>frmCadLigados<font color="#800080">(</font>opLivroAss<font color="#800080">, </font>opExcluir<font color="#800080">, </font>tLivro<font color="#800080">[</font>ISBN<font color="#800080">])
      </font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font><font color="#008000"><i>&quot;Assuntos dos livros exclu&iacute;dos, inclua novos!\n&quot;</i></font><font color="#800080">)
      </font>frmCadLigados<font color="#800080">(</font>opLivroAss<font color="#800080">, </font>opNovo<font color="#800080">, </font>tLivro<font color="#800080">[</font>ISBN<font color="#800080">])
      </font>frmCadLigados<font color="#800080">(</font>opLivroAut<font color="#800080">, </font>opExcluir<font color="#800080">, </font>tLivro<font color="#800080">[</font>ISBN<font color="#800080">])
      </font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font><font color="#008000"><i>&quot;Autores dos livros exclu&iacute;dos, inclua novos!\n&quot;</i></font><font color="#800080">)
      </font>frmCadLigados<font color="#800080">(</font>opLivroAut<font color="#800080">, </font>opNovo<font color="#800080">, </font>tLivro<font color="#800080">[</font>ISBN<font color="#800080">])
   </font><font color="#008000"><b>elsif </b></font>sacao<font color="#800080">=</font>opExcluir <font color="#008000"><b>then
      </b></font>subMenu3<font color="#800080">(</font><font color="#FF0000">10</font><font color="#800080">, </font>sreg<font color="#800080">)
      </font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font><font color="#008000"><i>&quot;Assuntos dos livros sendo exclu&iacute;dos!\n&quot;</i></font><font color="#800080">)
      </font>frmCadLigados<font color="#800080">(</font>opLivroAss<font color="#800080">, </font>opExcluir<font color="#800080">, </font>tLivro<font color="#800080">[</font>ISBN<font color="#800080">])
      </font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font><font color="#008000"><i>&quot;Autores dos livros sendo exclu&iacute;dos!\n&quot;</i></font><font color="#800080">)
      </font>frmCadLigados<font color="#800080">(</font>opLivroAut<font color="#800080">, </font>opExcluir<font color="#800080">, </font>tLivro<font color="#800080">[</font>ISBN<font color="#800080">])
   </font><font color="#008000"><b>end if
elsif </b></font>sreg<font color="#800080">=</font>opCliente <font color="#008000"><b>then
   if </b></font>sacao<font color="#800080">=</font>opAlterar <font color="#008000"><b>then
      </b></font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font>rotulo<font color="#800080">(</font>sreg<font color="#800080">, </font><font color="#FF0000">1</font><font color="#800080">) &amp; </font>tCliente<font color="#800080">[</font>CPF<font color="#800080">])
      </font>mostrarDados<font color="#800080">(</font>sreg<font color="#800080">, </font><font color="#008000"><i>&quot;&quot;</i></font><font color="#800080">, </font><font color="#FF0000">1</font><font color="#800080">)
      </font>subMenu3<font color="#800080">(</font><font color="#FF0000">9</font><font color="#800080">, </font>sreg<font color="#800080">)
   </font><font color="#008000"><b>elsif </b></font>sacao<font color="#800080">=</font>opExcluir <font color="#008000"><b>then
      </b></font>subMenu3<font color="#800080">(</font><font color="#FF0000">10</font><font color="#800080">, </font>sreg<font color="#800080">)
   </font><font color="#008000"><b>end if
end if
end procedure
</b></font><font color="#808080"><i>-- ----------------------------------------------------------------------------
-- Seleciona o menu e/ou a tela certa de acordo com o tipo de arquivo.
-- nmenu - o n&uacute;mero do menu
-- sreg - o tipo de arquivo
-- ----------------------------------------------------------------------------
</i></font><font color="#008000"><b>procedure </b></font>subMenu2<font color="#800080">(</font><font color="#0000FF"><b>integer </b></font>nmenu<font color="#800080">, </font>ctArqs sreg<font color="#800080">)
</font><font color="#0000FF"><b>integer </b></font>opSubMenu
boolean bSOp

bSOp<font color="#800080">=</font>TRUE
<font color="#008000"><b>if </b></font>nmenu <font color="#800080">= </font><font color="#FF0000">7 </font><font color="#008000"><b>then
    while </b></font>bSOp <font color="#008000"><b>do       
       </b></font>opSubMenu <font color="#800080">= </font>digita<font color="#800080">(</font>menu<font color="#800080">(</font>nmenu<font color="#800080">), </font>TRUE<font color="#800080">)
       </font><font color="#008000"><b>if </b></font>opSubMenu <font color="#800080">= </font><font color="#FF0000">1 </font><font color="#008000"><b>then 
         </b></font>btnAcao<font color="#800080">(</font>sreg<font color="#800080">, </font>opSalvarInclusao<font color="#800080">) 
         </font>bSOp<font color="#800080">=</font>FALSE
       <font color="#008000"><b>elsif </b></font>opSubMenu <font color="#800080">= </font><font color="#FF0000">2 </font><font color="#008000"><b>then </b></font>bSOp<font color="#800080">=</font>FALSE
       <font color="#008000"><b>else </b></font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font>MSG_ERRO<font color="#800080">)
       </font><font color="#008000"><b>end if
    end while
elsif </b></font>nmenu <font color="#800080">= </font><font color="#FF0000">8 </font><font color="#008000"><b>then
    while </b></font>bSOp <font color="#008000"><b>do      
      </b></font>opSubMenu <font color="#800080">= </font>digita<font color="#800080">(</font>menu<font color="#800080">(</font>nmenu<font color="#800080">), </font>TRUE<font color="#800080">)
      </font><font color="#008000"><b>if </b></font>opSubMenu <font color="#800080">= </font><font color="#FF0000">1 </font><font color="#008000"><b>then 
        </b></font>frmCadastros2<font color="#800080">(</font>sreg<font color="#800080">, </font>opAlterar<font color="#800080">)
        </font>bSOp<font color="#800080">=</font>FALSE
      <font color="#008000"><b>elsif </b></font>opSubMenu <font color="#800080">= </font><font color="#FF0000">2 </font><font color="#008000"><b>then 
        </b></font>frmCadastros2<font color="#800080">(</font>sreg<font color="#800080">, </font>opExcluir<font color="#800080">) 
        </font>bSOp<font color="#800080">=</font>FALSE
      <font color="#008000"><b>elsif </b></font>opSubMenu <font color="#800080">= </font><font color="#FF0000">3 </font><font color="#008000"><b>then </b></font>bSOp<font color="#800080">=</font>FALSE
      <font color="#008000"><b>else </b></font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font>MSG_ERRO<font color="#800080">)
      </font><font color="#008000"><b>end if
    end while
end if
end procedure

</b></font><font color="#808080"><i>-- ----------------------------------------------------------------------------
-- Realiza os cadastros de acordo com o tipo de arquivo.
-- sreg - o tipo de arquivo
-- sacao - a a&ccedil;&atilde;o a ser realizada
-- ----------------------------------------------------------------------------
</i></font><font color="#008000"><b>procedure </b></font>frmCadastros<font color="#800080">(</font>ctArqs sreg<font color="#800080">, </font>ctAcao sacao<font color="#800080">)
</font><font color="#0000FF"><b>sequence </b></font>slinha

<font color="#008000"><b>if </b></font>sreg<font color="#800080">=</font>opAssunto <font color="#008000"><b>then
   if </b></font>sacao<font color="#800080">=</font>opNovo <font color="#008000"><b>then
      </b></font>tAssunto<font color="#800080">[</font>CODIGO<font color="#800080">]=</font>pesqMaxCod<font color="#800080">(</font>tfAssunto<font color="#800080">, </font><font color="#FF0000">1</font><font color="#800080">, </font><font color="#FF0000">10</font><font color="#800080">, </font>tamReg<font color="#800080">(</font>sreg<font color="#800080">))
      </font>mostrarDados<font color="#800080">(</font>sreg<font color="#800080">, </font><font color="#008000"><i>&quot;&quot;</i></font><font color="#800080">, </font><font color="#FF0000">1</font><font color="#800080">)
      </font>subMenu2<font color="#800080">(</font><font color="#FF0000">7</font><font color="#800080">, </font>sreg<font color="#800080">)
   </font><font color="#008000"><b>elsif </b></font>sacao<font color="#800080">=</font>opPesquisar <font color="#008000"><b>then
     </b></font>slinha<font color="#800080">=</font>validaEntrada<font color="#800080">(</font>tfAssunto<font color="#800080">,</font>sreg<font color="#800080">,</font><font color="#FF0000">1</font><font color="#800080">,</font>tAssunto<font color="#800080">[</font>CODIGO<font color="#800080">],</font><font color="#FF0000">1</font><font color="#800080">,</font>FALSE<font color="#800080">,</font>opNumero<font color="#800080">)
      </font><font color="#008000"><b>if </b></font><font color="#0000FF"><b>equal</b></font><font color="#800080">(</font>slinha<font color="#800080">,</font><font color="#008000"><i>&quot;&quot;</i></font><font color="#800080">)=</font>FALSE <font color="#008000"><b>then
        </b></font>mostrarDados<font color="#800080">(</font>sreg<font color="#800080">, </font><font color="#008000"><i>&quot;&quot;</i></font><font color="#800080">, </font><font color="#FF0000">2</font><font color="#800080">)
        </font>mostrarDados<font color="#800080">(</font>sreg<font color="#800080">, </font>slinha<font color="#800080">, </font><font color="#FF0000">3</font><font color="#800080">)
        </font>subMenu2<font color="#800080">(</font><font color="#FF0000">8</font><font color="#800080">, </font>sreg<font color="#800080">)
      </font><font color="#008000"><b>end if
   end if
elsif </b></font>sreg<font color="#800080">=</font>opAutor <font color="#008000"><b>then
   if </b></font>sacao<font color="#800080">=</font>opNovo <font color="#008000"><b>then
      </b></font>tAutor<font color="#800080">[</font>CODIGO<font color="#800080">]=</font>pesqMaxCod<font color="#800080">(</font>tfAutor<font color="#800080">, </font><font color="#FF0000">1</font><font color="#800080">, </font><font color="#FF0000">10</font><font color="#800080">, </font>tamReg<font color="#800080">(</font>sreg<font color="#800080">))
      </font>mostrarDados<font color="#800080">(</font>sreg<font color="#800080">, </font><font color="#008000"><i>&quot;&quot;</i></font><font color="#800080">, </font><font color="#FF0000">1</font><font color="#800080">)
      </font>subMenu2<font color="#800080">(</font><font color="#FF0000">7</font><font color="#800080">, </font>sreg<font color="#800080">)
   </font><font color="#008000"><b>elsif </b></font>sacao<font color="#800080">=</font>opPesquisar <font color="#008000"><b>then
      </b></font>slinha<font color="#800080">=</font>validaEntrada<font color="#800080">(</font>tfAutor<font color="#800080">, </font>sreg<font color="#800080">, </font><font color="#FF0000">1</font><font color="#800080">, </font>tAutor<font color="#800080">[</font>CODIGO<font color="#800080">],</font><font color="#FF0000">1</font><font color="#800080">,</font>FALSE<font color="#800080">,</font>opNumero<font color="#800080">)
      </font><font color="#008000"><b>if </b></font><font color="#0000FF"><b>equal</b></font><font color="#800080">(</font>slinha<font color="#800080">,</font><font color="#008000"><i>&quot;&quot;</i></font><font color="#800080">)=</font>FALSE <font color="#008000"><b>then
        </b></font>mostrarDados<font color="#800080">(</font>sreg<font color="#800080">, </font><font color="#008000"><i>&quot;&quot;</i></font><font color="#800080">, </font><font color="#FF0000">2</font><font color="#800080">)
        </font>mostrarDados<font color="#800080">(</font>sreg<font color="#800080">, </font>slinha<font color="#800080">, </font><font color="#FF0000">3</font><font color="#800080">)
        </font>subMenu2<font color="#800080">(</font><font color="#FF0000">8</font><font color="#800080">, </font>sreg<font color="#800080">)
      </font><font color="#008000"><b>end if
   end if
elsif </b></font>sreg<font color="#800080">=</font>opEditora <font color="#008000"><b>then
   if </b></font>sacao<font color="#800080">=</font>opNovo <font color="#008000"><b>then
      </b></font>tEditora<font color="#800080">[</font>CODIGO<font color="#800080">]=</font>pesqMaxCod<font color="#800080">(</font>tfEditora<font color="#800080">, </font><font color="#FF0000">1</font><font color="#800080">, </font><font color="#FF0000">10</font><font color="#800080">, </font>tamReg<font color="#800080">(</font>sreg<font color="#800080">))
      </font>mostrarDados<font color="#800080">(</font>sreg<font color="#800080">, </font><font color="#008000"><i>&quot;&quot;</i></font><font color="#800080">, </font><font color="#FF0000">1</font><font color="#800080">)
      </font>subMenu2<font color="#800080">(</font><font color="#FF0000">7</font><font color="#800080">, </font>sreg<font color="#800080">)
   </font><font color="#008000"><b>elsif </b></font>sacao<font color="#800080">=</font>opPesquisar <font color="#008000"><b>then
     </b></font>slinha<font color="#800080">=</font>validaEntrada<font color="#800080">(</font>tfEditora<font color="#800080">,</font>sreg<font color="#800080">,</font><font color="#FF0000">1</font><font color="#800080">,</font>tEditora<font color="#800080">[</font>CODIGO<font color="#800080">],</font><font color="#FF0000">1</font><font color="#800080">,</font>FALSE<font color="#800080">,</font>opNumero<font color="#800080">)
      </font><font color="#008000"><b>if </b></font><font color="#0000FF"><b>equal</b></font><font color="#800080">(</font>slinha<font color="#800080">,</font><font color="#008000"><i>&quot;&quot;</i></font><font color="#800080">)=</font>FALSE <font color="#008000"><b>then
        </b></font>mostrarDados<font color="#800080">(</font>sreg<font color="#800080">, </font><font color="#008000"><i>&quot;&quot;</i></font><font color="#800080">, </font><font color="#FF0000">2</font><font color="#800080">)
        </font>mostrarDados<font color="#800080">(</font>sreg<font color="#800080">, </font>slinha<font color="#800080">, </font><font color="#FF0000">3</font><font color="#800080">)
        </font>subMenu2<font color="#800080">(</font><font color="#FF0000">8</font><font color="#800080">, </font>sreg<font color="#800080">)
      </font><font color="#008000"><b>end if
   end if
elsif </b></font>sreg<font color="#800080">=</font>opEndereco <font color="#008000"><b>then
   if </b></font>sacao<font color="#800080">=</font>opNovo <font color="#008000"><b>then
      </b></font>tEndereco<font color="#800080">[</font>CODIGO<font color="#800080">]=</font>pesqMaxCod<font color="#800080">(</font>tfEndereco<font color="#800080">, </font><font color="#FF0000">1</font><font color="#800080">, </font><font color="#FF0000">10</font><font color="#800080">, </font>tamReg<font color="#800080">(</font>sreg<font color="#800080">))
      </font>mostrarDados<font color="#800080">(</font>sreg<font color="#800080">, </font><font color="#008000"><i>&quot;&quot;</i></font><font color="#800080">, </font><font color="#FF0000">1</font><font color="#800080">)
      </font>subMenu2<font color="#800080">(</font><font color="#FF0000">7</font><font color="#800080">, </font>sreg<font color="#800080">)
   </font><font color="#008000"><b>elsif </b></font>sacao<font color="#800080">=</font>opPesquisar <font color="#008000"><b>then
      </b></font>slinha<font color="#800080">=</font>validaEntrada<font color="#800080">(</font>tfEndereco<font color="#800080">,</font>sreg<font color="#800080">,</font><font color="#FF0000">1</font><font color="#800080">,</font>tEndereco<font color="#800080">[</font>CODIGO<font color="#800080">],</font><font color="#FF0000">1</font><font color="#800080">,
              </font>FALSE<font color="#800080">,</font>opNumero<font color="#800080">)
      </font><font color="#008000"><b>if </b></font><font color="#0000FF"><b>equal</b></font><font color="#800080">(</font>slinha<font color="#800080">,</font><font color="#008000"><i>&quot;&quot;</i></font><font color="#800080">)=</font>FALSE <font color="#008000"><b>then
        </b></font>mostrarDados<font color="#800080">(</font>sreg<font color="#800080">, </font><font color="#008000"><i>&quot;&quot;</i></font><font color="#800080">, </font><font color="#FF0000">2</font><font color="#800080">)
        </font>mostrarDados<font color="#800080">(</font>sreg<font color="#800080">, </font>slinha<font color="#800080">, </font><font color="#FF0000">3</font><font color="#800080">)
        </font>subMenu2<font color="#800080">(</font><font color="#FF0000">8</font><font color="#800080">, </font>sreg<font color="#800080">)
      </font><font color="#008000"><b>end if
   end if
elsif </b></font>sreg<font color="#800080">=</font>opIdioma <font color="#008000"><b>then
   if </b></font>sacao<font color="#800080">=</font>opNovo <font color="#008000"><b>then
      </b></font>tIdioma<font color="#800080">[</font>CODIGO<font color="#800080">]=</font>pesqMaxCod<font color="#800080">(</font>tfIdioma<font color="#800080">, </font><font color="#FF0000">1</font><font color="#800080">, </font><font color="#FF0000">10</font><font color="#800080">, </font>tamReg<font color="#800080">(</font>sreg<font color="#800080">))
      </font>mostrarDados<font color="#800080">(</font>sreg<font color="#800080">, </font><font color="#008000"><i>&quot;&quot;</i></font><font color="#800080">, </font><font color="#FF0000">1</font><font color="#800080">)
      </font>subMenu2<font color="#800080">(</font><font color="#FF0000">7</font><font color="#800080">, </font>sreg<font color="#800080">)
   </font><font color="#008000"><b>elsif </b></font>sacao<font color="#800080">=</font>opPesquisar <font color="#008000"><b>then
      </b></font>slinha<font color="#800080">=</font>validaEntrada<font color="#800080">(</font>tfIdioma<font color="#800080">,</font>sreg<font color="#800080">,</font><font color="#FF0000">1</font><font color="#800080">,</font>tIdioma<font color="#800080">[</font>CODIGO<font color="#800080">],</font><font color="#FF0000">1</font><font color="#800080">,</font>FALSE<font color="#800080">,</font>opNumero<font color="#800080">)
      </font><font color="#008000"><b>if </b></font><font color="#0000FF"><b>equal</b></font><font color="#800080">(</font>slinha<font color="#800080">,</font><font color="#008000"><i>&quot;&quot;</i></font><font color="#800080">)=</font>FALSE <font color="#008000"><b>then
        </b></font>mostrarDados<font color="#800080">(</font>sreg<font color="#800080">, </font><font color="#008000"><i>&quot;&quot;</i></font><font color="#800080">, </font><font color="#FF0000">2</font><font color="#800080">)
        </font>mostrarDados<font color="#800080">(</font>sreg<font color="#800080">, </font>slinha<font color="#800080">, </font><font color="#FF0000">3</font><font color="#800080">)
        </font>subMenu2<font color="#800080">(</font><font color="#FF0000">8</font><font color="#800080">, </font>sreg<font color="#800080">)
      </font><font color="#008000"><b>end if
   end if
elsif </b></font>sreg<font color="#800080">=</font>opPais <font color="#008000"><b>then
   if </b></font>sacao<font color="#800080">=</font>opNovo <font color="#008000"><b>then
      </b></font>tPais<font color="#800080">[</font>CODIGO<font color="#800080">] = </font>digita<font color="#800080">(</font>rotulo<font color="#800080">(</font>sreg<font color="#800080">, </font><font color="#FF0000">1</font><font color="#800080">), </font>FALSE<font color="#800080">)
      </font>slinha<font color="#800080">=</font>pesqArq<font color="#800080">(</font>tfPais<font color="#800080">, </font>tPais<font color="#800080">[</font>CODIGO<font color="#800080">], </font><font color="#FF0000">1</font><font color="#800080">, </font><font color="#FF0000">3</font><font color="#800080">, </font>tamReg<font color="#800080">(</font>sreg<font color="#800080">))
      </font><font color="#008000"><b>if </b></font>slinha<font color="#800080">=</font><font color="#008000"><i>&quot;&quot; </i><b>then
         </b></font>pesqLinhaExcluida<font color="#800080">(</font>tfPais<font color="#800080">, </font>tamReg<font color="#800080">(</font>sreg<font color="#800080">))
         </font>mostrarDados<font color="#800080">(</font>sreg<font color="#800080">, </font><font color="#008000"><i>&quot;&quot;</i></font><font color="#800080">, </font><font color="#FF0000">1</font><font color="#800080">)
         </font>subMenu2<font color="#800080">(</font><font color="#FF0000">7</font><font color="#800080">, </font>sreg<font color="#800080">)
      </font><font color="#008000"><b>else </b></font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font>MSG_REGEXST<font color="#800080">)
      </font><font color="#008000"><b>end if
   elsif </b></font>sacao<font color="#800080">=</font>opPesquisar <font color="#008000"><b>then
      </b></font>slinha<font color="#800080">=</font>validaEntrada<font color="#800080">(</font>tfPais<font color="#800080">, </font>sreg<font color="#800080">, </font><font color="#FF0000">1</font><font color="#800080">, </font>tPais<font color="#800080">[</font>CODIGO<font color="#800080">], </font><font color="#FF0000">1</font><font color="#800080">, </font>FALSE<font color="#800080">, </font>opTexto<font color="#800080">)
      </font><font color="#008000"><b>if </b></font><font color="#0000FF"><b>equal</b></font><font color="#800080">(</font>slinha<font color="#800080">,</font><font color="#008000"><i>&quot;&quot;</i></font><font color="#800080">)=</font>FALSE <font color="#008000"><b>then
        </b></font>mostrarDados<font color="#800080">(</font>sreg<font color="#800080">, </font><font color="#008000"><i>&quot;&quot;</i></font><font color="#800080">, </font><font color="#FF0000">2</font><font color="#800080">)
        </font>mostrarDados<font color="#800080">(</font>sreg<font color="#800080">, </font>slinha<font color="#800080">, </font><font color="#FF0000">3</font><font color="#800080">)
        </font>subMenu2<font color="#800080">(</font><font color="#FF0000">8</font><font color="#800080">, </font>sreg<font color="#800080">)
      </font><font color="#008000"><b>end if
   end if
elsif </b></font>sreg<font color="#800080">=</font>opProfissao <font color="#008000"><b>then
   if </b></font>sacao<font color="#800080">=</font>opNovo <font color="#008000"><b>then
      </b></font>tProfissao<font color="#800080">[</font>CODIGO<font color="#800080">]=</font>pesqMaxCod<font color="#800080">(</font>tfProfissao<font color="#800080">, </font><font color="#FF0000">1</font><font color="#800080">, </font><font color="#FF0000">10</font><font color="#800080">, </font>tamReg<font color="#800080">(</font>sreg<font color="#800080">))
      </font>mostrarDados<font color="#800080">(</font>sreg<font color="#800080">, </font><font color="#008000"><i>&quot;&quot;</i></font><font color="#800080">, </font><font color="#FF0000">1</font><font color="#800080">)
      </font>subMenu2<font color="#800080">(</font><font color="#FF0000">7</font><font color="#800080">, </font>sreg<font color="#800080">)
   </font><font color="#008000"><b>elsif </b></font>sacao<font color="#800080">=</font>opPesquisar <font color="#008000"><b>then
      </b></font>slinha<font color="#800080">=</font>validaEntrada<font color="#800080">(</font>tfProfissao<font color="#800080">,</font>sreg<font color="#800080">,</font><font color="#FF0000">1</font><font color="#800080">,</font>tProfissao<font color="#800080">[</font>CODIGO<font color="#800080">],</font><font color="#FF0000">1</font><font color="#800080">,
              </font>FALSE<font color="#800080">,</font>opNumero<font color="#800080">)
      </font><font color="#008000"><b>if </b></font><font color="#0000FF"><b>equal</b></font><font color="#800080">(</font>slinha<font color="#800080">,</font><font color="#008000"><i>&quot;&quot;</i></font><font color="#800080">)=</font>FALSE <font color="#008000"><b>then
        </b></font>mostrarDados<font color="#800080">(</font>sreg<font color="#800080">, </font><font color="#008000"><i>&quot;&quot;</i></font><font color="#800080">, </font><font color="#FF0000">2</font><font color="#800080">)
        </font>mostrarDados<font color="#800080">(</font>sreg<font color="#800080">, </font>slinha<font color="#800080">, </font><font color="#FF0000">3</font><font color="#800080">)
        </font>subMenu2<font color="#800080">(</font><font color="#FF0000">8</font><font color="#800080">, </font>sreg<font color="#800080">)
      </font><font color="#008000"><b>end if
   end if
elsif </b></font>sreg<font color="#800080">=</font>opLivro <font color="#008000"><b>then
   if </b></font>sacao<font color="#800080">=</font>opNovo <font color="#008000"><b>then
      </b></font>tLivro<font color="#800080">[</font>ISBN<font color="#800080">] = </font>digita<font color="#800080">(</font>rotulo<font color="#800080">(</font>sreg<font color="#800080">, </font><font color="#FF0000">1</font><font color="#800080">), </font>FALSE<font color="#800080">)
      </font><font color="#008000"><b>if </b></font>validaISBN<font color="#800080">(</font>tLivro<font color="#800080">[</font>ISBN<font color="#800080">]) </font><font color="#008000"><b>then
          </b></font>slinha<font color="#800080">=</font>pesqArq<font color="#800080">(</font>tfLivro<font color="#800080">, </font>tLivro<font color="#800080">[</font>ISBN<font color="#800080">], </font><font color="#FF0000">1</font><font color="#800080">, </font><font color="#FF0000">13</font><font color="#800080">, </font>tamReg<font color="#800080">(</font>sreg<font color="#800080">))
          </font><font color="#008000"><b>if </b></font>slinha<font color="#800080">=</font><font color="#008000"><i>&quot;&quot; </i><b>then
             </b></font>pesqLinhaExcluida<font color="#800080">(</font>tfLivro<font color="#800080">, </font>tamReg<font color="#800080">(</font>sreg<font color="#800080">))
             </font>mostrarDados<font color="#800080">(</font>sreg<font color="#800080">, </font><font color="#008000"><i>&quot;&quot;</i></font><font color="#800080">, </font><font color="#FF0000">1</font><font color="#800080">)
             </font>subMenu2<font color="#800080">(</font><font color="#FF0000">7</font><font color="#800080">, </font>sreg<font color="#800080">)
             </font>frmCadLigados<font color="#800080">(</font>opLivroAss<font color="#800080">, </font>opNovo<font color="#800080">, </font>tLivro<font color="#800080">[</font>ISBN<font color="#800080">])
             </font>frmCadLigados<font color="#800080">(</font>opLivroAut<font color="#800080">, </font>opNovo<font color="#800080">, </font>tLivro<font color="#800080">[</font>ISBN<font color="#800080">])
          </font><font color="#008000"><b>else </b></font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font>MSG_REGEXST<font color="#800080">)
          </font><font color="#008000"><b>end if
      else </b></font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font>MSG_ISBNINV<font color="#800080">)
      </font><font color="#008000"><b>end if 
   elsif </b></font>sacao<font color="#800080">=</font>opPesquisar <font color="#008000"><b>then
      </b></font>slinha<font color="#800080">=</font>validaEntrada<font color="#800080">(</font>tfLivro<font color="#800080">, </font>sreg<font color="#800080">, </font><font color="#FF0000">1</font><font color="#800080">, </font>tLivro<font color="#800080">[</font>ISBN<font color="#800080">], </font><font color="#FF0000">1</font><font color="#800080">,</font>FALSE<font color="#800080">,</font>opTexto<font color="#800080">)
      </font><font color="#008000"><b>if </b></font><font color="#0000FF"><b>equal</b></font><font color="#800080">(</font>slinha<font color="#800080">,</font><font color="#008000"><i>&quot;&quot;</i></font><font color="#800080">)=</font>FALSE <font color="#008000"><b>then
         </b></font>mostrarDados<font color="#800080">(</font>sreg<font color="#800080">, </font><font color="#008000"><i>&quot;&quot;</i></font><font color="#800080">, </font><font color="#FF0000">2</font><font color="#800080">)
         </font>mostrarDados<font color="#800080">(</font>sreg<font color="#800080">, </font>slinha<font color="#800080">, </font><font color="#FF0000">3</font><font color="#800080">)
         </font>subMenu2<font color="#800080">(</font><font color="#FF0000">8</font><font color="#800080">, </font>sreg<font color="#800080">)
      </font><font color="#008000"><b>end if
   end if
elsif </b></font>sreg<font color="#800080">=</font>opCliente <font color="#008000"><b>then
   if </b></font>sacao<font color="#800080">=</font>opNovo <font color="#008000"><b>then
      </b></font>tCliente<font color="#800080">[</font>CPF<font color="#800080">] = </font>digita<font color="#800080">(</font>rotulo<font color="#800080">(</font>sreg<font color="#800080">, </font><font color="#FF0000">1</font><font color="#800080">), </font>FALSE<font color="#800080">)
      </font><font color="#008000"><b>if </b></font>validaCPF<font color="#800080">(</font>tCliente<font color="#800080">[</font>CPF<font color="#800080">]) </font><font color="#008000"><b>then
          </b></font>slinha<font color="#800080">=</font>pesqArq<font color="#800080">(</font>tfCliente<font color="#800080">, </font>tCliente<font color="#800080">[</font>CPF<font color="#800080">], </font><font color="#FF0000">1</font><font color="#800080">, </font><font color="#FF0000">14</font><font color="#800080">, </font>tamReg<font color="#800080">(</font>sreg<font color="#800080">))
          </font><font color="#008000"><b>if </b></font><font color="#0000FF"><b>equal</b></font><font color="#800080">(</font>slinha<font color="#800080">,</font><font color="#008000"><i>&quot;&quot;</i></font><font color="#800080">) </font><font color="#008000"><b>then
             </b></font>pesqLinhaExcluida<font color="#800080">(</font>tfCliente<font color="#800080">, </font>tamReg<font color="#800080">(</font>sreg<font color="#800080">))
             </font>mostrarDados<font color="#800080">(</font>sreg<font color="#800080">, </font><font color="#008000"><i>&quot;&quot;</i></font><font color="#800080">, </font><font color="#FF0000">1</font><font color="#800080">)
             </font>subMenu2<font color="#800080">(</font><font color="#FF0000">7</font><font color="#800080">, </font>sreg<font color="#800080">)
          </font><font color="#008000"><b>else </b></font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font>MSG_REGEXST<font color="#800080">)
          </font><font color="#008000"><b>end if 
      else </b></font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font>MSG_CPFINV<font color="#800080">)
      </font><font color="#008000"><b>end if
   elsif </b></font>sacao<font color="#800080">=</font>opPesquisar <font color="#008000"><b>then
      </b></font>slinha<font color="#800080">=</font>validaEntrada<font color="#800080">(</font>tfCliente<font color="#800080">, </font>sreg<font color="#800080">, </font><font color="#FF0000">1</font><font color="#800080">, </font>tCliente<font color="#800080">[</font>CPF<font color="#800080">],</font><font color="#FF0000">1</font><font color="#800080">,</font>FALSE<font color="#800080">,</font>opTexto<font color="#800080">)
      </font><font color="#008000"><b>if </b></font><font color="#0000FF"><b>equal</b></font><font color="#800080">(</font>slinha<font color="#800080">,</font><font color="#008000"><i>&quot;&quot;</i></font><font color="#800080">)=</font>FALSE <font color="#008000"><b>then
         </b></font>mostrarDados<font color="#800080">(</font>sreg<font color="#800080">, </font><font color="#008000"><i>&quot;&quot;</i></font><font color="#800080">, </font><font color="#FF0000">2</font><font color="#800080">)
         </font>mostrarDados<font color="#800080">(</font>sreg<font color="#800080">, </font>slinha<font color="#800080">, </font><font color="#FF0000">3</font><font color="#800080">)
         </font>subMenu2<font color="#800080">(</font><font color="#FF0000">8</font><font color="#800080">, </font>sreg<font color="#800080">)
      </font><font color="#008000"><b>end if
   end if
elsif </b></font>sreg<font color="#800080">=</font>opVenda <font color="#008000"><b>then
   if </b></font>sacao<font color="#800080">=</font>opNovo <font color="#008000"><b>then
      </b></font>tVenda<font color="#800080">[</font>DTHRVENDA<font color="#800080">]=</font>retDataHora<font color="#800080">()
      </font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font>rotulo<font color="#800080">(</font>sreg<font color="#800080">, </font><font color="#FF0000">1</font><font color="#800080">) &amp; </font>tVenda<font color="#800080">[</font>DTHRVENDA<font color="#800080">] &amp; </font><font color="#008000"><i>&quot;\n&quot;</i></font><font color="#800080">)
      </font>slinha<font color="#800080">=</font>pesqArq<font color="#800080">(</font>tfVenda<font color="#800080">, </font>tVenda<font color="#800080">[</font>DTHRVENDA<font color="#800080">], </font><font color="#FF0000">1</font><font color="#800080">, </font><font color="#FF0000">19</font><font color="#800080">, </font>tamReg<font color="#800080">(</font>sreg<font color="#800080">))
      </font><font color="#008000"><b>if </b></font><font color="#0000FF"><b>equal</b></font><font color="#800080">(</font>slinha<font color="#800080">,</font><font color="#008000"><i>&quot;&quot;</i></font><font color="#800080">) </font><font color="#008000"><b>then
         </b></font>slinha<font color="#800080">=</font>validaEntrada<font color="#800080">(</font>tfCliente<font color="#800080">,</font>opCliente<font color="#800080">,</font><font color="#FF0000">1</font><font color="#800080">,</font>tVenda<font color="#800080">[</font>CPFVENDA<font color="#800080">],</font><font color="#FF0000">3</font><font color="#800080">,
                 </font>FALSE<font color="#800080">,</font>opTexto<font color="#800080">)
         </font><font color="#008000"><b>if </b></font><font color="#0000FF"><b>equal</b></font><font color="#800080">(</font>slinha<font color="#800080">,</font><font color="#008000"><i>&quot;&quot;</i></font><font color="#800080">)=</font>FALSE <font color="#008000"><b>then
            </b></font>tVenda<font color="#800080">[</font>CPFVENDA<font color="#800080">]=</font>trim<font color="#800080">(</font>copy<font color="#800080">(</font>slinha<font color="#800080">,</font><font color="#FF0000">1</font><font color="#800080">,</font><font color="#FF0000">14</font><font color="#800080">))
            </font><font color="#008000"><b>if </b></font>validaCPF<font color="#800080">(</font>tVenda<font color="#800080">[</font>CPFVENDA<font color="#800080">]) </font><font color="#008000"><b>then
               </b></font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font><font color="#008000"><i>&quot; &quot; </i></font><font color="#800080">&amp; </font>rotulo<font color="#800080">(</font>opCliente<font color="#800080">, </font><font color="#FF0000">2</font><font color="#800080">)) </font><font color="#808080"><i>-- Nome --
               </i></font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font>copy<font color="#800080">(</font>slinha<font color="#800080">, </font>g_nPosChave<font color="#800080">, </font>g_nTamChave<font color="#800080">) &amp; </font><font color="#008000"><i>&quot;\n&quot;</i></font><font color="#800080">)
               </font>frmCadLigados<font color="#800080">(</font>opVenda<font color="#800080">, </font>opNovo<font color="#800080">, </font>tVenda<font color="#800080">[</font>CPFVENDA<font color="#800080">])
            </font><font color="#008000"><b>else </b></font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font>MSG_CPFINV<font color="#800080">)
            </font><font color="#008000"><b>end if
         end if
      else </b></font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font>MSG_REGEXST<font color="#800080">)
      </font><font color="#008000"><b>end if
   elsif </b></font>sacao<font color="#800080">=</font>opPesquisar <font color="#008000"><b>then
      </b></font>slinha<font color="#800080">=</font>validaEntrada<font color="#800080">(</font>tfVenda<font color="#800080">, </font>sreg<font color="#800080">, </font><font color="#FF0000">1</font><font color="#800080">, </font>tVenda<font color="#800080">[</font>DTHRVENDA<font color="#800080">],</font><font color="#FF0000">1</font><font color="#800080">,
              </font>FALSE<font color="#800080">,</font>opDataHora<font color="#800080">)
      </font><font color="#008000"><b>if </b></font><font color="#0000FF"><b>equal</b></font><font color="#800080">(</font>slinha<font color="#800080">,</font><font color="#008000"><i>&quot;&quot;</i></font><font color="#800080">)=</font>FALSE <font color="#008000"><b>then
        </b></font>mostrarDados<font color="#800080">(</font>sreg<font color="#800080">, </font><font color="#008000"><i>&quot;&quot;</i></font><font color="#800080">, </font><font color="#FF0000">2</font><font color="#800080">)
        </font>mostrarDados<font color="#800080">(</font>sreg<font color="#800080">, </font>slinha<font color="#800080">, </font><font color="#FF0000">3</font><font color="#800080">)
        </font>subMenu2<font color="#800080">(</font><font color="#FF0000">8</font><font color="#800080">, </font>sreg<font color="#800080">)
      </font><font color="#008000"><b>end if
   end if
end if
end procedure

</b></font><font color="#808080"><i>-- ----------------------------------------------------------------------------
-- Realiza as consultas de acordo com o tipo de arquivo.
-- sreg - o tipo de arquivo
-- sacao - a a&ccedil;&atilde;o a ser realizada
-- ----------------------------------------------------------------------------
</i></font><font color="#008000"><b>procedure </b></font>frmConsultas<font color="#800080">(</font>ctArqs sreg<font color="#800080">, </font>ctAcao sacao<font color="#800080">)
</font><font color="#0000FF"><b>sequence </b></font>slinha
slinha <font color="#800080">= </font><font color="#008000"><i>&quot;&quot;
</i><b>if </b></font>sreg<font color="#800080">=</font>opAssunto <font color="#008000"><b>then
   if </b></font>sacao<font color="#800080">=</font>opPesquisar <font color="#008000"><b>then
      </b></font>slinha<font color="#800080">=</font>validaEntrada<font color="#800080">(</font>tfAssunto<font color="#800080">,</font>sreg<font color="#800080">,</font><font color="#FF0000">2</font><font color="#800080">,</font>tAssunto<font color="#800080">[</font>ASSUNTO<font color="#800080">],</font><font color="#FF0000">1</font><font color="#800080">,</font>TRUE<font color="#800080">,</font>opTexto<font color="#800080">)
   </font><font color="#008000"><b>elsif </b></font>sacao<font color="#800080">=</font>opListarTodos <font color="#008000"><b>then
      if </b></font>ListarTodos<font color="#800080">(</font>tfAssunto<font color="#800080">, </font>sreg<font color="#800080">, </font><font color="#008000"><i>&quot;&quot;</i></font><font color="#800080">, </font><font color="#FF0000">0</font><font color="#800080">, </font><font color="#FF0000">0</font><font color="#800080">, </font>tamReg<font color="#800080">(</font>sreg<font color="#800080">),
        </font>QTD_MAX_LINHA<font color="#800080">, </font>FALSE<font color="#800080">) = </font>FALSE <font color="#008000"><b>then
        </b></font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font>rotulo<font color="#800080">(</font>sreg<font color="#800080">, </font><font color="#FF0000">0</font><font color="#800080">))
      </font><font color="#008000"><b>end if
   end if
elsif </b></font>sreg<font color="#800080">=</font>opAutor <font color="#008000"><b>then
   if </b></font>sacao<font color="#800080">=</font>opPesquisar <font color="#008000"><b>then
      </b></font>slinha<font color="#800080">=</font>validaEntrada<font color="#800080">(</font>tfAutor<font color="#800080">,</font>sreg<font color="#800080">, </font><font color="#FF0000">2</font><font color="#800080">, </font>tAutor<font color="#800080">[</font>AUTOR<font color="#800080">], </font><font color="#FF0000">1</font><font color="#800080">, </font>TRUE<font color="#800080">,</font>opTexto<font color="#800080">)
   </font><font color="#008000"><b>elsif </b></font>sacao<font color="#800080">=</font>opListarTodos <font color="#008000"><b>then
      if </b></font>ListarTodos<font color="#800080">(</font>tfAutor<font color="#800080">, </font>sreg<font color="#800080">, </font><font color="#008000"><i>&quot;&quot;</i></font><font color="#800080">, </font><font color="#FF0000">0</font><font color="#800080">, </font><font color="#FF0000">0</font><font color="#800080">, </font>tamReg<font color="#800080">(</font>sreg<font color="#800080">),
        </font>QTD_MAX_LINHA<font color="#800080">, </font>FALSE<font color="#800080">) = </font>FALSE <font color="#008000"><b>then
        </b></font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font>rotulo<font color="#800080">(</font>sreg<font color="#800080">, </font><font color="#FF0000">0</font><font color="#800080">))
      </font><font color="#008000"><b>end if
   end if
elsif </b></font>sreg<font color="#800080">=</font>opEditora <font color="#008000"><b>then
   if </b></font>sacao<font color="#800080">=</font>opPesquisar <font color="#008000"><b>then
      </b></font>slinha<font color="#800080">=</font>validaEntrada<font color="#800080">(</font>tfEditora<font color="#800080">,</font>sreg<font color="#800080">,</font><font color="#FF0000">2</font><font color="#800080">,</font>tEditora<font color="#800080">[</font>EDITORA<font color="#800080">],</font><font color="#FF0000">1</font><font color="#800080">,</font>TRUE<font color="#800080">,</font>opTexto<font color="#800080">)
   </font><font color="#008000"><b>elsif </b></font>sacao<font color="#800080">=</font>opListarTodos <font color="#008000"><b>then
      if </b></font>ListarTodos<font color="#800080">(</font>tfEditora<font color="#800080">, </font>sreg<font color="#800080">, </font><font color="#008000"><i>&quot;&quot;</i></font><font color="#800080">, </font><font color="#FF0000">0</font><font color="#800080">, </font><font color="#FF0000">0</font><font color="#800080">, </font>tamReg<font color="#800080">(</font>sreg<font color="#800080">),
        </font>QTD_MAX_LINHA<font color="#800080">, </font>FALSE<font color="#800080">) = </font>FALSE <font color="#008000"><b>then
        </b></font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font>rotulo<font color="#800080">(</font>sreg<font color="#800080">, </font><font color="#FF0000">0</font><font color="#800080">))
      </font><font color="#008000"><b>end if
   end if
elsif </b></font>sreg<font color="#800080">=</font>opEndereco <font color="#008000"><b>then
   if </b></font>sacao<font color="#800080">=</font>opPesquisar <font color="#008000"><b>then
      </b></font>slinha<font color="#800080">=</font>validaEntrada<font color="#800080">(</font>tfEndereco<font color="#800080">,</font>sreg<font color="#800080">,</font><font color="#FF0000">2</font><font color="#800080">,</font>tEndereco<font color="#800080">[</font>LOGRADOURO<font color="#800080">],</font><font color="#FF0000">1</font><font color="#800080">,
              </font>TRUE<font color="#800080">,</font>opTexto<font color="#800080">)
   </font><font color="#008000"><b>elsif </b></font>sacao<font color="#800080">=</font>opListarTodos <font color="#008000"><b>then
      if </b></font>ListarTodos<font color="#800080">(</font>tfEndereco<font color="#800080">, </font>sreg<font color="#800080">, </font><font color="#008000"><i>&quot;&quot;</i></font><font color="#800080">, </font><font color="#FF0000">0</font><font color="#800080">, </font><font color="#FF0000">0</font><font color="#800080">, </font>tamReg<font color="#800080">(</font>sreg<font color="#800080">),
         </font><font color="#FF0000">3</font><font color="#800080">, </font>FALSE<font color="#800080">) = </font>FALSE <font color="#008000"><b>then
        </b></font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font>rotulo<font color="#800080">(</font>sreg<font color="#800080">, </font><font color="#FF0000">0</font><font color="#800080">))
      </font><font color="#008000"><b>end if
   end if
elsif </b></font>sreg<font color="#800080">=</font>opIdioma <font color="#008000"><b>then
   if </b></font>sacao<font color="#800080">=</font>opPesquisar <font color="#008000"><b>then
      </b></font>slinha<font color="#800080">=</font>validaEntrada<font color="#800080">(</font>tfIdioma<font color="#800080">, </font>sreg<font color="#800080">, </font><font color="#FF0000">2</font><font color="#800080">, </font>tIdioma<font color="#800080">[</font>IDIOMA<font color="#800080">],</font><font color="#FF0000">1</font><font color="#800080">,</font>TRUE<font color="#800080">,</font>opTexto<font color="#800080">)
   </font><font color="#008000"><b>elsif </b></font>sacao<font color="#800080">=</font>opListarTodos <font color="#008000"><b>then
      if </b></font>ListarTodos<font color="#800080">(</font>tfIdioma<font color="#800080">, </font>sreg<font color="#800080">, </font><font color="#008000"><i>&quot;&quot;</i></font><font color="#800080">, </font><font color="#FF0000">0</font><font color="#800080">, </font><font color="#FF0000">0</font><font color="#800080">, </font>tamReg<font color="#800080">(</font>sreg<font color="#800080">),
        </font>QTD_MAX_LINHA<font color="#800080">, </font>FALSE<font color="#800080">) = </font>FALSE <font color="#008000"><b>then
        </b></font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font>rotulo<font color="#800080">(</font>sreg<font color="#800080">, </font><font color="#FF0000">0</font><font color="#800080">))
      </font><font color="#008000"><b>end if
   end if
elsif </b></font>sreg<font color="#800080">=</font>opPais <font color="#008000"><b>then
   if </b></font>sacao<font color="#800080">=</font>opPesquisar <font color="#008000"><b>then
      </b></font>slinha<font color="#800080">=</font>validaEntrada<font color="#800080">(</font>tfPais<font color="#800080">, </font>sreg<font color="#800080">, </font><font color="#FF0000">2</font><font color="#800080">, </font>tPais<font color="#800080">[</font>PAIS<font color="#800080">], </font><font color="#FF0000">1</font><font color="#800080">, </font>TRUE<font color="#800080">,</font>opTexto<font color="#800080">)
   </font><font color="#008000"><b>elsif </b></font>sacao<font color="#800080">=</font>opListarTodos <font color="#008000"><b>then
      if </b></font>ListarTodos<font color="#800080">(</font>tfPais<font color="#800080">, </font>sreg<font color="#800080">, </font><font color="#008000"><i>&quot;&quot;</i></font><font color="#800080">, </font><font color="#FF0000">0</font><font color="#800080">, </font><font color="#FF0000">0</font><font color="#800080">, </font>tamReg<font color="#800080">(</font>sreg<font color="#800080">),
        </font>QTD_MAX_LINHA<font color="#800080">, </font>FALSE<font color="#800080">) = </font>FALSE <font color="#008000"><b>then
        </b></font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font>rotulo<font color="#800080">(</font>sreg<font color="#800080">, </font><font color="#FF0000">0</font><font color="#800080">))
      </font><font color="#008000"><b>end if
   end if
elsif </b></font>sreg<font color="#800080">=</font>opProfissao <font color="#008000"><b>then
   if </b></font>sacao<font color="#800080">=</font>opPesquisar <font color="#008000"><b>then
     </b></font>slinha<font color="#800080">=</font>validaEntrada<font color="#800080">(</font>tfProfissao<font color="#800080">,</font>sreg<font color="#800080">,</font><font color="#FF0000">2</font><font color="#800080">,</font>tProfissao<font color="#800080">[</font>PROFISSAO<font color="#800080">],</font><font color="#FF0000">1</font><font color="#800080">,
             </font>TRUE<font color="#800080">,</font>opTexto<font color="#800080">)
   </font><font color="#008000"><b>elsif </b></font>sacao<font color="#800080">=</font>opListarTodos <font color="#008000"><b>then
      if </b></font>ListarTodos<font color="#800080">(</font>tfProfissao<font color="#800080">, </font>sreg<font color="#800080">, </font><font color="#008000"><i>&quot;&quot;</i></font><font color="#800080">, </font><font color="#FF0000">0</font><font color="#800080">, </font><font color="#FF0000">0</font><font color="#800080">, </font>tamReg<font color="#800080">(</font>sreg<font color="#800080">),
        </font>QTD_MAX_LINHA<font color="#800080">, </font>FALSE<font color="#800080">) = </font>FALSE <font color="#008000"><b>then
        </b></font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font>rotulo<font color="#800080">(</font>sreg<font color="#800080">, </font><font color="#FF0000">0</font><font color="#800080">))
      </font><font color="#008000"><b>end if
   end if
elsif </b></font>sreg<font color="#800080">=</font>opLivro <font color="#008000"><b>then
   if </b></font>sacao<font color="#800080">=</font>opPesquisar <font color="#008000"><b>then
      </b></font>slinha<font color="#800080">=</font>validaEntrada<font color="#800080">(</font>tfLivro<font color="#800080">, </font>sreg<font color="#800080">, </font><font color="#FF0000">2</font><font color="#800080">, </font>tLivro<font color="#800080">[</font>TITULO<font color="#800080">], </font><font color="#FF0000">1</font><font color="#800080">, </font>TRUE<font color="#800080">,</font>opTexto<font color="#800080">)
   </font><font color="#008000"><b>elsif </b></font>sacao<font color="#800080">=</font>opListarTodos <font color="#008000"><b>then
      if </b></font>ListarTodos<font color="#800080">(</font>tfLivro<font color="#800080">, </font>sreg<font color="#800080">, </font><font color="#008000"><i>&quot;&quot;</i></font><font color="#800080">, </font><font color="#FF0000">0</font><font color="#800080">, </font><font color="#FF0000">0</font><font color="#800080">, </font>tamReg<font color="#800080">(</font>sreg<font color="#800080">),
        </font><font color="#FF0000">1</font><font color="#800080">, </font>FALSE<font color="#800080">) = </font>FALSE <font color="#008000"><b>then
        </b></font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font>rotulo<font color="#800080">(</font>sreg<font color="#800080">, </font><font color="#FF0000">0</font><font color="#800080">))
      </font><font color="#008000"><b>end if
   end if
elsif </b></font>sreg<font color="#800080">=</font>opCliente <font color="#008000"><b>then
   if </b></font>sacao<font color="#800080">=</font>opPesquisar <font color="#008000"><b>then
      </b></font>slinha<font color="#800080">=</font>validaEntrada<font color="#800080">(</font>tfCliente<font color="#800080">, </font>sreg<font color="#800080">, </font><font color="#FF0000">2</font><font color="#800080">, </font>tCliente<font color="#800080">[</font>NOME<font color="#800080">],</font><font color="#FF0000">1</font><font color="#800080">,</font>TRUE<font color="#800080">,</font>opTexto<font color="#800080">)
   </font><font color="#008000"><b>elsif </b></font>sacao<font color="#800080">=</font>opListarTodos <font color="#008000"><b>then
      if </b></font>ListarTodos<font color="#800080">(</font>tfCliente<font color="#800080">, </font>sreg<font color="#800080">, </font><font color="#008000"><i>&quot;&quot;</i></font><font color="#800080">, </font><font color="#FF0000">0</font><font color="#800080">, </font><font color="#FF0000">0</font><font color="#800080">, </font>tamReg<font color="#800080">(</font>sreg<font color="#800080">),
        </font><font color="#FF0000">1</font><font color="#800080">, </font>FALSE<font color="#800080">) = </font>FALSE <font color="#008000"><b>then
        </b></font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font>rotulo<font color="#800080">(</font>sreg<font color="#800080">, </font><font color="#FF0000">0</font><font color="#800080">))
      </font><font color="#008000"><b>end if
   end if
elsif </b></font>sreg<font color="#800080">=</font>opVenda <font color="#008000"><b>then
   if </b></font>sacao<font color="#800080">=</font>opPesquisar <font color="#008000"><b>then
      </b></font>slinha<font color="#800080">=</font>validaEntrada<font color="#800080">(</font>tfVenda<font color="#800080">, </font>sreg<font color="#800080">, </font><font color="#FF0000">2</font><font color="#800080">, </font>tVenda<font color="#800080">[</font>CPFVENDA<font color="#800080">], </font><font color="#FF0000">1</font><font color="#800080">, </font>TRUE<font color="#800080">,</font>opTexto<font color="#800080">)
   </font><font color="#008000"><b>elsif </b></font>sacao<font color="#800080">=</font>opListarTodos <font color="#008000"><b>then
      if </b></font>ListarTodos<font color="#800080">(</font>tfVenda<font color="#800080">, </font>sreg<font color="#800080">, </font><font color="#008000"><i>&quot;&quot;</i></font><font color="#800080">, </font><font color="#FF0000">0</font><font color="#800080">, </font><font color="#FF0000">0</font><font color="#800080">, </font>tamReg<font color="#800080">(</font>sreg<font color="#800080">),
        </font>QTD_MAX_LINHA<font color="#800080">, </font>FALSE<font color="#800080">) = </font>FALSE <font color="#008000"><b>then
        </b></font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font>rotulo<font color="#800080">(</font>sreg<font color="#800080">, </font><font color="#FF0000">0</font><font color="#800080">))
      </font><font color="#008000"><b>end if 
   end if
end if
if </b></font><font color="#0000FF"><b>equal</b></font><font color="#800080">(</font>slinha<font color="#800080">,</font><font color="#008000"><i>&quot;&quot;</i></font><font color="#800080">) </font><font color="#008000"><b>then
   </b></font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font><font color="#008000"><i>&quot;&quot;</i></font><font color="#800080">)
</font><font color="#008000"><b>end if
end procedure
</b></font><font color="#808080"><i>-- ----------------------------------------------------------------------------
-- Mostra a tela de altera&ccedil;&atilde;o de senha do sistema e realiza a altera&ccedil;&atilde;o.
-- ----------------------------------------------------------------------------
</i></font><font color="#008000"><b>procedure </b></font>frmAlterarSenha<font color="#800080">()
</font>boolean bQuebra
<font color="#0000FF"><b>sequence </b></font>sres<font color="#800080">, </font>sSenhaAtual<font color="#800080">, </font>sNovaSenha<font color="#800080">, </font>sConfirmaSenha
<font color="#0000FF"><b>integer </b></font>nopcao

<font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font>rotulo<font color="#800080">(</font>opUsuario<font color="#800080">, </font><font color="#FF0000">1</font><font color="#800080">) &amp; </font>tUsuario<font color="#800080">[</font>LOGIN<font color="#800080">])
</font>nopcao<font color="#800080">=</font><font color="#FF0000">1
</font>bQuebra<font color="#800080">=</font>FALSE
<font color="#008000"><b>while </b></font><font color="#800080">(</font>bQuebra<font color="#800080">=</font>FALSE<font color="#800080">) </font><font color="#008000"><b>do
  if </b></font>nopcao <font color="#800080">= </font><font color="#FF0000">1 </font><font color="#008000"><b>then
       </b></font>sSenhaAtual<font color="#800080">=</font>digitaSenha<font color="#800080">(</font><font color="#008000"><i>&quot;Senha Atual: &quot;</i></font><font color="#800080">,</font><font color="#FF0000">10</font><font color="#800080">)
       </font><font color="#008000"><b>if </b></font><font color="#0000FF"><b>equal</b></font><font color="#800080">(</font>sSenhaAtual<font color="#800080">, </font>tUsuario<font color="#800080">[</font>SENHA<font color="#800080">])=</font>FALSE <font color="#008000"><b>then
          </b></font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font>MSG_SENCONFERE<font color="#800080">)
          </font>bQuebra<font color="#800080">=</font>TRUE
       <font color="#008000"><b>else </b></font>nopcao<font color="#800080">=</font><font color="#FF0000">2
       </font><font color="#008000"><b>end if
  elsif </b></font>nopcao <font color="#800080">= </font><font color="#FF0000">2 </font><font color="#008000"><b>then
       </b></font>sNovaSenha<font color="#800080">=</font>digitaSenha<font color="#800080">(</font><font color="#008000"><i>&quot;Nova Senha: &quot;</i></font><font color="#800080">,</font><font color="#FF0000">10</font><font color="#800080">)
       </font>sConfirmaSenha<font color="#800080">=</font>digitaSenha<font color="#800080">(</font><font color="#008000"><i>&quot;Confirma Senha: &quot;</i></font><font color="#800080">,</font><font color="#FF0000">10</font><font color="#800080">)
       </font><font color="#008000"><b>if </b></font><font color="#0000FF"><b>equal</b></font><font color="#800080">(</font>sNovaSenha<font color="#800080">, </font>sConfirmaSenha<font color="#800080">)=</font>FALSE <font color="#008000"><b>then
          </b></font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font>MSG_SENCONFIRM<font color="#800080">)
          </font>bQuebra<font color="#800080">=</font>TRUE
       <font color="#008000"><b>else </b></font>nopcao<font color="#800080">=</font><font color="#FF0000">3
       </font><font color="#008000"><b>end if
  elsif </b></font>nopcao <font color="#800080">= </font><font color="#FF0000">3 </font><font color="#008000"><b>then
       </b></font>sres<font color="#800080">=</font>pesqArq<font color="#800080">(</font>tfUsuario<font color="#800080">, </font>tUsuario<font color="#800080">[</font>LOGIN<font color="#800080">], </font><font color="#FF0000">1</font><font color="#800080">, </font><font color="#FF0000">10</font><font color="#800080">, </font>tamReg<font color="#800080">(</font>opUsuario<font color="#800080">))
       </font><font color="#008000"><b>if </b></font><font color="#0000FF"><b>equal</b></font><font color="#800080">(</font>sres<font color="#800080">,</font><font color="#008000"><i>&quot;&quot;</i></font><font color="#800080">) </font><font color="#008000"><b>then
         </b></font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font>MSG_LOGINENCON<font color="#800080">)
       </font><font color="#008000"><b>else
         </b></font>tUsuario<font color="#800080">[</font>SENHA<font color="#800080">]=</font>sConfirmaSenha
         subMenu3<font color="#800080">(</font><font color="#FF0000">9</font><font color="#800080">,</font>opUsuario<font color="#800080">)
         </font>bQuebra<font color="#800080">=</font>TRUE
       <font color="#008000"><b>end if
  end if
end while
end procedure
</b></font><font color="#808080"><i>-- ----------------------------------------------------------------------------
-- Seleciona o menu e/ou a tela certa de acordo com o tipo de arquivo.
-- nmenu - o n&uacute;mero do menu
-- sreg - o tipo de arquivo
-- ----------------------------------------------------------------------------
</i></font><font color="#008000"><b>procedure </b></font>subMenu<font color="#800080">(</font><font color="#0000FF"><b>integer </b></font>nmenu<font color="#800080">, </font>ctArqs sreg<font color="#800080">)
</font><font color="#0000FF"><b>integer </b></font>opSubMenu
<font color="#0000FF"><b>sequence </b></font>opCSubMenu
boolean bSOp

bSOp<font color="#800080">=</font>TRUE
<font color="#008000"><b>if </b></font>nmenu <font color="#800080">= </font><font color="#FF0000">6 </font><font color="#008000"><b>then
    while </b></font>bSOp <font color="#008000"><b>do       
       </b></font>opSubMenu <font color="#800080">= </font>digita<font color="#800080">(</font>menu<font color="#800080">(</font>nmenu<font color="#800080">), </font>TRUE<font color="#800080">)
       </font><font color="#008000"><b>if </b></font>opSubMenu <font color="#800080">= </font><font color="#FF0000">1 </font><font color="#008000"><b>then </b></font>frmCadastros<font color="#800080">(</font>sreg<font color="#800080">, </font>opNovo<font color="#800080">)
       </font><font color="#008000"><b>elsif </b></font>opSubMenu <font color="#800080">= </font><font color="#FF0000">2 </font><font color="#008000"><b>then </b></font>frmCadastros<font color="#800080">(</font>sreg<font color="#800080">, </font>opPesquisar<font color="#800080">)
       </font><font color="#008000"><b>elsif </b></font>opSubMenu <font color="#800080">= </font><font color="#FF0000">3 </font><font color="#008000"><b>then </b></font>bSOp<font color="#800080">=</font>FALSE
       <font color="#008000"><b>else </b></font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font>MSG_ERRO<font color="#800080">)
       </font><font color="#008000"><b>end if
    end while
elsif </b></font>nmenu <font color="#800080">= </font><font color="#FF0000">12 </font><font color="#008000"><b>then
    while </b></font>bSOp <font color="#008000"><b>do      
      </b></font>opSubMenu <font color="#800080">= </font>digita<font color="#800080">(</font>menu<font color="#800080">(</font>nmenu<font color="#800080">), </font>TRUE<font color="#800080">)
      </font><font color="#008000"><b>if </b></font>opSubMenu <font color="#800080">= </font><font color="#FF0000">1 </font><font color="#008000"><b>then </b></font>frmConsultas<font color="#800080">(</font>sreg<font color="#800080">, </font>opPesquisar<font color="#800080">)
      </font><font color="#008000"><b>elsif </b></font>opSubMenu <font color="#800080">= </font><font color="#FF0000">2 </font><font color="#008000"><b>then </b></font>frmConsultas<font color="#800080">(</font>sreg<font color="#800080">, </font>opListarTodos<font color="#800080">)
      </font><font color="#008000"><b>elsif </b></font>opSubMenu <font color="#800080">= </font><font color="#FF0000">3 </font><font color="#008000"><b>then </b></font>bSOp<font color="#800080">=</font>FALSE
      <font color="#008000"><b>else </b></font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font>MSG_ERRO<font color="#800080">)
      </font><font color="#008000"><b>end if
    end while
elsif </b></font>nmenu <font color="#800080">= </font><font color="#FF0000">14 </font><font color="#008000"><b>then
    while </b></font>bSOp <font color="#008000"><b>do      
      </b></font>opCSubMenu <font color="#800080">= </font>digita<font color="#800080">(</font>menu<font color="#800080">(</font>nmenu<font color="#800080">), </font>FALSE<font color="#800080">)
      </font><font color="#008000"><b>if </b></font><font color="#0000FF"><b>equal</b></font><font color="#800080">(</font>opCSubMenu<font color="#800080">,</font><font color="#008000"><i>&quot;S&quot;</i></font><font color="#800080">) </font><font color="#008000"><b>or </b></font><font color="#0000FF"><b>equal</b></font><font color="#800080">(</font>opCSubMenu<font color="#800080">,</font><font color="#008000"><i>&quot;s&quot;</i></font><font color="#800080">) </font><font color="#008000"><b>then
         </b></font>btnAcao<font color="#800080">(</font>sreg<font color="#800080">, </font>opSalvarInclusao<font color="#800080">)
         </font>bSOp<font color="#800080">=</font>FALSE
         g_SalvarInclusao<font color="#800080">=</font>TRUE
      <font color="#008000"><b>elsif </b></font><font color="#0000FF"><b>equal</b></font><font color="#800080">(</font>opCSubMenu<font color="#800080">,</font><font color="#008000"><i>&quot;N&quot;</i></font><font color="#800080">) </font><font color="#008000"><b>or </b></font><font color="#0000FF"><b>equal</b></font><font color="#800080">(</font>opCSubMenu<font color="#800080">,</font><font color="#008000"><i>&quot;n&quot;</i></font><font color="#800080">) </font><font color="#008000"><b>then </b></font>bSOp<font color="#800080">=</font>FALSE
      <font color="#008000"><b>else </b></font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font>MSG_ERRO<font color="#800080">)
      </font><font color="#008000"><b>end if
    end while
end if
end procedure
</b></font><font color="#808080"><i>-- ----------------------------------------------------------------------------
-- Seleciona o submenu e/ou a tela certa de acordo com n&uacute;mero do menu.
-- nmenu - o n&uacute;mero do menu
-- ----------------------------------------------------------------------------
</i></font><font color="#008000"><b>procedure </b></font>usaMenu<font color="#800080">(</font><font color="#0000FF"><b>integer </b></font>num<font color="#800080">)
</font><font color="#0000FF"><b>integer </b></font>opSubMenu
boolean bSOp
<font color="#0000FF"><b>sequence </b></font>opSair

 bSOp<font color="#800080">=</font>TRUE
 <font color="#008000"><b>if </b></font>num <font color="#800080">= </font><font color="#FF0000">1 </font><font color="#008000"><b>then </b></font><font color="#808080"><i>-- Cadastros --
   </i></font><font color="#008000"><b>while </b></font>bSOp <font color="#008000"><b>do     
     </b></font>opSubMenu <font color="#800080">= </font>digita<font color="#800080">(</font>menu<font color="#800080">(</font><font color="#FF0000">2</font><font color="#800080">), </font>TRUE<font color="#800080">)
     </font><font color="#008000"><b>if </b></font>opSubMenu <font color="#800080">= </font><font color="#FF0000">1 </font><font color="#008000"><b>then </b></font>subMenu<font color="#800080">(</font><font color="#FF0000">6</font><font color="#800080">, </font>opAssunto<font color="#800080">)
     </font><font color="#008000"><b>elsif </b></font>opSubMenu <font color="#800080">= </font><font color="#FF0000">2 </font><font color="#008000"><b>then </b></font>subMenu<font color="#800080">(</font><font color="#FF0000">6</font><font color="#800080">, </font>opAutor<font color="#800080">)
     </font><font color="#008000"><b>elsif </b></font>opSubMenu <font color="#800080">= </font><font color="#FF0000">3 </font><font color="#008000"><b>then </b></font>subMenu<font color="#800080">(</font><font color="#FF0000">6</font><font color="#800080">, </font>opEditora<font color="#800080">)
     </font><font color="#008000"><b>elsif </b></font>opSubMenu <font color="#800080">= </font><font color="#FF0000">4 </font><font color="#008000"><b>then </b></font>subMenu<font color="#800080">(</font><font color="#FF0000">6</font><font color="#800080">, </font>opEndereco<font color="#800080">)
     </font><font color="#008000"><b>elsif </b></font>opSubMenu <font color="#800080">= </font><font color="#FF0000">5 </font><font color="#008000"><b>then </b></font>subMenu<font color="#800080">(</font><font color="#FF0000">6</font><font color="#800080">, </font>opIdioma<font color="#800080">)
     </font><font color="#008000"><b>elsif </b></font>opSubMenu <font color="#800080">= </font><font color="#FF0000">6 </font><font color="#008000"><b>then </b></font>subMenu<font color="#800080">(</font><font color="#FF0000">6</font><font color="#800080">, </font>opPais<font color="#800080">)
     </font><font color="#008000"><b>elsif </b></font>opSubMenu <font color="#800080">= </font><font color="#FF0000">7 </font><font color="#008000"><b>then </b></font>subMenu<font color="#800080">(</font><font color="#FF0000">6</font><font color="#800080">, </font>opProfissao<font color="#800080">)
     </font><font color="#008000"><b>elsif </b></font>opSubMenu <font color="#800080">= </font><font color="#FF0000">8 </font><font color="#008000"><b>then </b></font>subMenu<font color="#800080">(</font><font color="#FF0000">6</font><font color="#800080">, </font>opCliente<font color="#800080">)
     </font><font color="#008000"><b>elsif </b></font>opSubMenu <font color="#800080">= </font><font color="#FF0000">9 </font><font color="#008000"><b>then </b></font>subMenu<font color="#800080">(</font><font color="#FF0000">6</font><font color="#800080">, </font>opLivro<font color="#800080">)
     </font><font color="#008000"><b>elsif </b></font>opSubMenu <font color="#800080">= </font><font color="#FF0000">10 </font><font color="#008000"><b>then </b></font>bSOp<font color="#800080">=</font>FALSE
     <font color="#008000"><b>else </b></font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font>MSG_ERRO<font color="#800080">)
     </font><font color="#008000"><b>end if
   end while
 elsif </b></font>num <font color="#800080">= </font><font color="#FF0000">2 </font><font color="#008000"><b>then </b></font><font color="#808080"><i>--  Pesquisas --
   </i></font><font color="#008000"><b>while </b></font>bSOp <font color="#008000"><b>do     
     </b></font>opSubMenu <font color="#800080">= </font>digita<font color="#800080">(</font>menu<font color="#800080">(</font><font color="#FF0000">3</font><font color="#800080">), </font>TRUE<font color="#800080">)
     </font><font color="#008000"><b>if </b></font>opSubMenu <font color="#800080">= </font><font color="#FF0000">1 </font><font color="#008000"><b>then </b></font>subMenu<font color="#800080">(</font><font color="#FF0000">12</font><font color="#800080">, </font>opAssunto<font color="#800080">)
     </font><font color="#008000"><b>elsif </b></font>opSubMenu <font color="#800080">= </font><font color="#FF0000">2 </font><font color="#008000"><b>then </b></font>subMenu<font color="#800080">(</font><font color="#FF0000">12</font><font color="#800080">, </font>opAutor<font color="#800080">)
     </font><font color="#008000"><b>elsif </b></font>opSubMenu <font color="#800080">= </font><font color="#FF0000">3 </font><font color="#008000"><b>then </b></font>subMenu<font color="#800080">(</font><font color="#FF0000">12</font><font color="#800080">, </font>opEditora<font color="#800080">)
     </font><font color="#008000"><b>elsif </b></font>opSubMenu <font color="#800080">= </font><font color="#FF0000">4 </font><font color="#008000"><b>then </b></font>subMenu<font color="#800080">(</font><font color="#FF0000">12</font><font color="#800080">, </font>opEndereco<font color="#800080">)
     </font><font color="#008000"><b>elsif </b></font>opSubMenu <font color="#800080">= </font><font color="#FF0000">5 </font><font color="#008000"><b>then </b></font>subMenu<font color="#800080">(</font><font color="#FF0000">12</font><font color="#800080">, </font>opIdioma<font color="#800080">)
     </font><font color="#008000"><b>elsif </b></font>opSubMenu <font color="#800080">= </font><font color="#FF0000">6 </font><font color="#008000"><b>then </b></font>subMenu<font color="#800080">(</font><font color="#FF0000">12</font><font color="#800080">, </font>opPais<font color="#800080">)
     </font><font color="#008000"><b>elsif </b></font>opSubMenu <font color="#800080">= </font><font color="#FF0000">7 </font><font color="#008000"><b>then </b></font>subMenu<font color="#800080">(</font><font color="#FF0000">12</font><font color="#800080">, </font>opProfissao<font color="#800080">)
     </font><font color="#008000"><b>elsif </b></font>opSubMenu <font color="#800080">= </font><font color="#FF0000">8 </font><font color="#008000"><b>then </b></font>subMenu<font color="#800080">(</font><font color="#FF0000">12</font><font color="#800080">, </font>opCliente<font color="#800080">)
     </font><font color="#008000"><b>elsif </b></font>opSubMenu <font color="#800080">= </font><font color="#FF0000">9 </font><font color="#008000"><b>then </b></font>subMenu<font color="#800080">(</font><font color="#FF0000">12</font><font color="#800080">, </font>opLivro<font color="#800080">)
     </font><font color="#008000"><b>elsif </b></font>opSubMenu <font color="#800080">= </font><font color="#FF0000">10 </font><font color="#008000"><b>then </b></font>bSOp<font color="#800080">=</font>FALSE
     <font color="#008000"><b>else </b></font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font>MSG_ERRO<font color="#800080">)
     </font><font color="#008000"><b>end if
   end while
 elsif </b></font>num <font color="#800080">= </font><font color="#FF0000">3 </font><font color="#008000"><b>then </b></font><font color="#808080"><i>--  Vendas --
   </i></font><font color="#008000"><b>while </b></font>bSOp <font color="#008000"><b>do     
     </b></font>opSubMenu <font color="#800080">= </font>digita<font color="#800080">(</font>menu<font color="#800080">(</font><font color="#FF0000">4</font><font color="#800080">), </font>TRUE<font color="#800080">)
     </font><font color="#008000"><b>if </b></font>opSubMenu <font color="#800080">= </font><font color="#FF0000">1 </font><font color="#008000"><b>then </b></font>subMenu<font color="#800080">(</font><font color="#FF0000">6</font><font color="#800080">, </font>opVenda<font color="#800080">)
     </font><font color="#008000"><b>elsif </b></font>opSubMenu <font color="#800080">= </font><font color="#FF0000">2 </font><font color="#008000"><b>then </b></font>subMenu<font color="#800080">(</font><font color="#FF0000">12</font><font color="#800080">, </font>opVenda<font color="#800080">)
     </font><font color="#008000"><b>elsif </b></font>opSubMenu <font color="#800080">= </font><font color="#FF0000">3 </font><font color="#008000"><b>then </b></font>bSOp<font color="#800080">=</font>FALSE
     <font color="#008000"><b>else </b></font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font>MSG_ERRO<font color="#800080">)
     </font><font color="#008000"><b>end if
   end while
 elsif </b></font>num <font color="#800080">= </font><font color="#FF0000">4 </font><font color="#008000"><b>then </b></font><font color="#808080"><i>--  Opcoes --
   </i></font><font color="#008000"><b>while </b></font>bSOp <font color="#008000"><b>do     
     </b></font>opSubMenu <font color="#800080">= </font>digita<font color="#800080">(</font>menu<font color="#800080">(</font><font color="#FF0000">5</font><font color="#800080">), </font>TRUE<font color="#800080">)
     </font><font color="#008000"><b>if </b></font>opSubMenu <font color="#800080">= </font><font color="#FF0000">1 </font><font color="#008000"><b>then </b></font>frmAlterarSenha<font color="#800080">()
     </font><font color="#008000"><b>elsif </b></font>opSubMenu <font color="#800080">= </font><font color="#FF0000">2 </font><font color="#008000"><b>then </b></font>frmSobre<font color="#800080">()
     </font><font color="#008000"><b>elsif </b></font>opSubMenu <font color="#800080">= </font><font color="#FF0000">3 </font><font color="#008000"><b>then         
         </b></font>opSair <font color="#800080">= </font>digita<font color="#800080">(</font>menu<font color="#800080">(</font><font color="#FF0000">11</font><font color="#800080">), </font>FALSE<font color="#800080">)
         </font><font color="#008000"><b>if </b></font><font color="#0000FF"><b>equal</b></font><font color="#800080">(</font>opSair<font color="#800080">,</font><font color="#008000"><i>&quot;S&quot;</i></font><font color="#800080">) </font><font color="#008000"><b>or </b></font><font color="#0000FF"><b>equal</b></font><font color="#800080">(</font>opSair<font color="#800080">,</font><font color="#008000"><i>&quot;s&quot;</i></font><font color="#800080">) </font><font color="#008000"><b>then
            </b></font>fechaArqs<font color="#800080">()
            </font><font color="#0000FF"><b>abort</b></font><font color="#800080">(</font><font color="#FF0000">0</font><font color="#800080">)
         </font><font color="#008000"><b>end if
     elsif </b></font>opSubMenu <font color="#800080">= </font><font color="#FF0000">4 </font><font color="#008000"><b>then </b></font>bSOp<font color="#800080">=</font>FALSE
     <font color="#008000"><b>else </b></font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDOUT<font color="#800080">, </font>MSG_ERRO<font color="#800080">)
     </font><font color="#008000"><b>end if
   end while
 end if
end procedure

</b></font><font color="#808080"><i>-- ----------------------------------------------------------------------------
-- Parte inicial do c&oacute;digo
-- ----------------------------------------------------------------------------
</i></font><font color="#008000"><b>procedure </b></font>main<font color="#800080">()
</font><font color="#808080"><i>--  if (Argument_Count &gt; 0) then
--     if (Argument(1)=&quot;-cria&quot;) then
--       abrecriaArqs(FALSE)
--     end if
--  else
   </i></font>frmSplash<font color="#800080">()
   </font>abrecriaArqs<font color="#800080">(</font>TRUE<font color="#800080">)
   </font><font color="#008000"><b>if </b></font>frmLogin<font color="#800080">() </font><font color="#008000"><b>then
     </b></font>bopcao<font color="#800080">=</font>TRUE
     <font color="#008000"><b>while </b></font>bopcao <font color="#008000"><b>do       
       </b></font>opmenu <font color="#800080">= </font>digita<font color="#800080">(</font>menu<font color="#800080">(</font><font color="#FF0000">1</font><font color="#800080">), </font>FALSE<font color="#800080">)
       </font><font color="#008000"><b>if </b></font><font color="#0000FF"><b>equal</b></font><font color="#800080">(</font>opmenu<font color="#800080">,</font><font color="#008000"><i>&quot;C&quot;</i></font><font color="#800080">) </font><font color="#008000"><b>or </b></font><font color="#0000FF"><b>equal</b></font><font color="#800080">(</font>opmenu<font color="#800080">,</font><font color="#008000"><i>&quot;c&quot;</i></font><font color="#800080">) </font><font color="#008000"><b>then </b></font>usaMenu<font color="#800080">(</font><font color="#FF0000">1</font><font color="#800080">)
       </font><font color="#008000"><b>elsif </b></font><font color="#0000FF"><b>equal</b></font><font color="#800080">(</font>opmenu<font color="#800080">,</font><font color="#008000"><i>&quot;P&quot;</i></font><font color="#800080">) </font><font color="#008000"><b>or </b></font><font color="#0000FF"><b>equal</b></font><font color="#800080">(</font>opmenu<font color="#800080">,</font><font color="#008000"><i>&quot;p&quot;</i></font><font color="#800080">) </font><font color="#008000"><b>then </b></font>usaMenu<font color="#800080">(</font><font color="#FF0000">2</font><font color="#800080">)
       </font><font color="#008000"><b>elsif </b></font><font color="#0000FF"><b>equal</b></font><font color="#800080">(</font>opmenu<font color="#800080">,</font><font color="#008000"><i>&quot;V&quot;</i></font><font color="#800080">) </font><font color="#008000"><b>or </b></font><font color="#0000FF"><b>equal</b></font><font color="#800080">(</font>opmenu<font color="#800080">,</font><font color="#008000"><i>&quot;v&quot;</i></font><font color="#800080">) </font><font color="#008000"><b>then </b></font>usaMenu<font color="#800080">(</font><font color="#FF0000">3</font><font color="#800080">)
       </font><font color="#008000"><b>elsif </b></font><font color="#0000FF"><b>equal</b></font><font color="#800080">(</font>opmenu<font color="#800080">,</font><font color="#008000"><i>&quot;O&quot;</i></font><font color="#800080">) </font><font color="#008000"><b>or </b></font><font color="#0000FF"><b>equal</b></font><font color="#800080">(</font>opmenu<font color="#800080">,</font><font color="#008000"><i>&quot;o&quot;</i></font><font color="#800080">) </font><font color="#008000"><b>then </b></font>usaMenu<font color="#800080">(</font><font color="#FF0000">4</font><font color="#800080">)
       </font><font color="#008000"><b>else </b></font><font color="#0000FF"><b>puts</b></font><font color="#800080">(</font>STDERR<font color="#800080">, </font>MSG_ERRO<font color="#800080">)
       </font><font color="#008000"><b>end if
     end while
   else
     </b></font>fechaArqs<font color="#800080">()
     </font><font color="#0000FF"><b>abort</b></font><font color="#800080">(</font><font color="#FF0000">0</font><font color="#800080">)
   </font><font color="#008000"><b>end if
</b></font><font color="#808080"><i>--  end if
</i></font><font color="#008000"><b>end procedure

</b></font>main<font color="#800080">()
</font></font>
</code></pre>
</body>
</html>