<html>
<head>
<title>Livrus Virtus - Console - Modula-2 - Implementação - GPM - Livrus</title>
</head>
<!-- Generated by ConTEXT HTML exporter -->
<body text="#000000" bgcolor="#FFFFFF">
<pre>
<code><font  face="Courier New"><font color="#808080">(*------------------------------------------------------------------------------
 Sistema integrante do projeto Livrus Virtus.
 Todos os direitos reservados para Henrique F. de Souza.
 Vers&atilde;o programada na linguagem modula 2.
------------------------------------------------------------------------------*)
</font><font color="#0000FF">MODULE </font>livrus<font color="#808080">;

</font><font color="#0000FF">FROM </font>Rotinas <font color="#0000FF">IMPORT </font>String<font color="#808080">, </font>WriteLinha<font color="#808080">;
</font><font color="#0000FF">FROM </font>Arquivos <font color="#0000FF">IMPORT </font>abrecriaArqs<font color="#808080">, </font>fechaArqs<font color="#808080">;
</font><font color="#0000FF">FROM </font>Sistema <font color="#0000FF">IMPORT </font>MSG_ERRO<font color="#808080">, </font>menu<font color="#808080">;
</font><font color="#0000FF">FROM </font>Telas <font color="#0000FF">IMPORT </font>frmSplash<font color="#808080">, </font>frmLogin<font color="#808080">, </font>usaMenu<font color="#808080">;
</font><font color="#0000FF">FROM </font>ProgArgs <font color="#0000FF">IMPORT </font>ArgNumber<font color="#808080">, </font>GetArg<font color="#808080">;
</font><font color="#0000FF">FROM </font>Strings <font color="#0000FF">IMPORT </font>Compare<font color="#808080">, </font>CompareResults<font color="#808080">;
</font><font color="#0000FF">FROM </font>InOut <font color="#0000FF">IMPORT </font>Read<font color="#808080">;

</font><font color="#0000FF">VAR
 </font>bopcao<font color="#808080">: </font><font color="#0000FF">BOOLEAN</font><font color="#808080">;
 </font>opmenu<font color="#808080">: </font><font color="#0000FF">CHAR</font><font color="#808080">;
 </font>sparam<font color="#808080">: </font>String<font color="#808080">;

(*------------------------------------------------------------------------------
</font>Parte inicial do c<font color="#808080">&oacute;</font>digo
<font color="#808080">------------------------------------------------------------------------------*)
</font><font color="#0000FF">BEGIN
 IF </font>ArgNumber<font color="#808080">() &gt; </font><font color="#FF0000">1 </font><font color="#0000FF">THEN
    </font>GetArg<font color="#808080">(</font><font color="#FF0000">1</font><font color="#808080">,</font>sparam<font color="#808080">);
    </font><font color="#0000FF">IF </font>Compare<font color="#808080">(</font>sparam<font color="#808080">,</font><font color="#800000">'-cria'</font><font color="#808080">)=</font>equal <font color="#0000FF">THEN
       </font>abrecriaArqs<font color="#808080">(</font>FALSE<font color="#808080">)
    </font><font color="#0000FF">END</font><font color="#808080">;
 </font><font color="#0000FF">ELSE 
   </font>frmSplash<font color="#808080">();
   </font>abrecriaArqs<font color="#808080">(</font>TRUE<font color="#808080">);
   </font><font color="#0000FF">IF </font>frmLogin<font color="#808080">() </font><font color="#0000FF">THEN 
     </font>bopcao<font color="#808080">:=</font>TRUE<font color="#808080">;
     </font><font color="#0000FF">WHILE</font><font color="#808080">(</font>bopcao<font color="#808080">) </font><font color="#0000FF">DO 
       </font>menu<font color="#808080">(</font><font color="#FF0000">1</font><font color="#808080">);
       </font>Read<font color="#808080">(</font>opmenu<font color="#808080">);
       </font><font color="#0000FF">IF </font><font color="#808080">(</font>opmenu<font color="#808080">=</font><font color="#800000">'C'</font><font color="#808080">) </font><font color="#0000FF">OR </font><font color="#808080">(</font>opmenu<font color="#808080">=</font><font color="#800000">'c'</font><font color="#808080">) </font><font color="#0000FF">THEN </font>usaMenu<font color="#808080">(</font><font color="#FF0000">1</font><font color="#808080">);
       </font><font color="#0000FF">ELSIF </font><font color="#808080">(</font>opmenu<font color="#808080">=</font><font color="#800000">'P'</font><font color="#808080">) </font><font color="#0000FF">OR </font><font color="#808080">(</font>opmenu<font color="#808080">=</font><font color="#800000">'p'</font><font color="#808080">) </font><font color="#0000FF">THEN </font>usaMenu<font color="#808080">(</font><font color="#FF0000">2</font><font color="#808080">);
       </font><font color="#0000FF">ELSIF </font><font color="#808080">(</font>opmenu<font color="#808080">=</font><font color="#800000">'V'</font><font color="#808080">) </font><font color="#0000FF">OR </font><font color="#808080">(</font>opmenu<font color="#808080">=</font><font color="#800000">'v'</font><font color="#808080">) </font><font color="#0000FF">THEN </font>usaMenu<font color="#808080">(</font><font color="#FF0000">3</font><font color="#808080">);
       </font><font color="#0000FF">ELSIF </font><font color="#808080">(</font>opmenu<font color="#808080">=</font><font color="#800000">'O'</font><font color="#808080">) </font><font color="#0000FF">OR </font><font color="#808080">(</font>opmenu<font color="#808080">=</font><font color="#800000">'o'</font><font color="#808080">) </font><font color="#0000FF">THEN </font>usaMenu<font color="#808080">(</font><font color="#FF0000">4</font><font color="#808080">);
       </font><font color="#0000FF">ELSE </font>WriteLinha<font color="#808080">(</font>MSG_ERRO<font color="#808080">);
       </font><font color="#0000FF">END</font><font color="#808080">;
     </font><font color="#0000FF">END</font><font color="#808080">;  
   </font><font color="#0000FF">ELSE 
     </font>fechaArqs<font color="#808080">();
     </font>HALT<font color="#808080">;
   </font><font color="#0000FF">END</font><font color="#808080">;
 </font><font color="#0000FF">END</font><font color="#808080">;

</font><font color="#0000FF">END </font>livrus.
</font>
</code></pre>
</body>
</html>