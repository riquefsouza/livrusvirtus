<html>
<head>
<title>Livrus Virtus - Scripts SQL - Sybase Stored Procedures</title>
</head>
<!-- Generated by ConTEXT HTML exporter -->
<body text="#000000" bgcolor="#FFFFFF">
<pre>
<code><font  face="Courier New"><font color="#000080"><b>create procedure </b>Assunto_NS
</font><font color="#808080">(</font>@Tipo	 <font color="#000080">char</font><font color="#808080">(</font><font color="#FF0000">1</font><font color="#808080">),
</font>@Codigo	 <font color="#000080">smallint </font><font color="#808080">= </font><font color="#000080"><b>Null</b></font><font color="#808080">,
</font>@Assunto <font color="#000080"><b>varchar</b></font><font color="#808080">(</font><font color="#FF0000">30</font><font color="#808080">) = </font><font color="#000080"><b>Null</b></font><font color="#808080">)
</font><font color="#000080"><b>as
if </b>sTipo</font><font color="#808080">=</font><font color="#800000">'N' 
  </font><font color="#000080"><b>select </b></font><font color="#808080">(</font><font color="#000080">max</font><font color="#808080">(</font><font color="#000080">codassunto</font><font color="#808080">)+</font><font color="#FF0000">1</font><font color="#808080">) </font><font color="#000080"><b>as </b>Codigo <b>from </b>Assunto
<b>else if </b>sTipo</font><font color="#808080">=</font><font color="#800000">'S'
  </font><font color="#000080"><b>select </b>a</font><font color="#808080">.</font><font color="#000080">codassunto <b>as </b>Codigo</font><font color="#808080">, </font><font color="#000080">a</font><font color="#808080">.</font><font color="#000080">assunto <b>as </b>Assunto <b>from </b>Assunto a
  <b>where </b></font><font color="#808080">(</font><font color="#000080">a</font><font color="#808080">.</font><font color="#000080">codassunto </font><font color="#808080">= </font>@Codigo <font color="#000080"><b>or </b></font>@Codigo <font color="#000080"><b>is null</b></font><font color="#808080">)
  </font><font color="#000080"><b>and </b></font><font color="#808080">(</font><font color="#000080">a</font><font color="#808080">.</font><font color="#000080">assunto <b>like </b></font><font color="#800000">'%'</font><font color="#808080">+</font>@Assunto<font color="#808080">+</font><font color="#800000">'%' </font><font color="#000080"><b>or </b></font>@Assunto <font color="#000080"><b>is null</b></font><font color="#808080">) 

</font><font color="#000080"><b>return

</b></font><font color="#808080">//<i>----------------------------

</i></font><font color="#000080"><b>create procedure </b>Assunto_IUD
</font><font color="#808080">(</font>@Tipo	 <font color="#000080">char</font><font color="#808080">(</font><font color="#FF0000">1</font><font color="#808080">),
</font>@Codigo	 <font color="#000080">smallint</font><font color="#808080">,
</font>@Assunto <font color="#000080"><b>varchar</b></font><font color="#808080">(</font><font color="#FF0000">30</font><font color="#808080">))
</font><font color="#000080"><b>as
if </b>sTipo</font><font color="#808080">=</font><font color="#800000">'I'
  </font><font color="#000080"><b>insert into </b>Assunto</font><font color="#808080">(</font><font color="#000080">codassunto</font><font color="#808080">, </font><font color="#000080">assunto</font><font color="#808080">) </font><font color="#000080">values</font><font color="#808080">(</font>@Codigo<font color="#808080">,</font>@Assunto<font color="#808080">)
</font><font color="#000080"><b>else if </b>sTipo</font><font color="#808080">=</font><font color="#800000">'U'
  </font><font color="#000080"><b>update </b>Assunto <b>set </b>assunto</font><font color="#808080">=</font>@Assunto <font color="#000080"><b>where </b>codassunto</font><font color="#808080">=</font>@Codigo
<font color="#000080"><b>else if </b>sTipo</font><font color="#808080">=</font><font color="#800000">'D'
  </font><font color="#000080"><b>delete from </b>Assunto <b>where </b>codassunto</font><font color="#808080">=</font>@Codigo

<font color="#000080"><b>return

</b></font><font color="#808080">//<i>----------------------------

</i></font><font color="#000080"><b>create procedure </b>Autor_NS
</font><font color="#808080">(</font>@Tipo	 <font color="#000080">char</font><font color="#808080">(</font><font color="#FF0000">1</font><font color="#808080">),
</font>@Codigo	 <font color="#000080">smallint </font><font color="#808080">= </font><font color="#000080"><b>Null</b></font><font color="#808080">,
</font>@Autor <font color="#000080"><b>varchar</b></font><font color="#808080">(</font><font color="#FF0000">30</font><font color="#808080">) = </font><font color="#000080"><b>Null</b></font><font color="#808080">)
</font><font color="#000080"><b>as
if </b>sTipo</font><font color="#808080">=</font><font color="#800000">'N' 
  </font><font color="#000080"><b>select </b></font><font color="#808080">(</font><font color="#000080">max</font><font color="#808080">(</font><font color="#000080">codautor</font><font color="#808080">)+</font><font color="#FF0000">1</font><font color="#808080">) </font><font color="#000080"><b>as </b>Codigo <b>from </b>Autor
<b>else if </b>sTipo</font><font color="#808080">=</font><font color="#800000">'S'
  </font><font color="#000080"><b>select </b>a</font><font color="#808080">.</font><font color="#000080">codautor <b>as </b>Codigo</font><font color="#808080">, </font><font color="#000080">a</font><font color="#808080">.</font><font color="#000080">autor <b>as </b>Autor <b>from </b>Autor a
  <b>where </b></font><font color="#808080">(</font><font color="#000080">a</font><font color="#808080">.</font><font color="#000080">codautor </font><font color="#808080">= </font>@Codigo <font color="#000080"><b>or </b></font>@Codigo <font color="#000080"><b>is null</b></font><font color="#808080">)
  </font><font color="#000080"><b>and </b></font><font color="#808080">(</font><font color="#000080">a</font><font color="#808080">.</font><font color="#000080">autor <b>like </b></font><font color="#800000">'%'</font><font color="#808080">+</font>@Autor<font color="#808080">+</font><font color="#800000">'%' </font><font color="#000080"><b>or </b></font>@Autor <font color="#000080"><b>is null</b></font><font color="#808080">) 

</font><font color="#000080"><b>return

</b></font><font color="#808080">//<i>----------------------------

</i></font><font color="#000080"><b>create procedure </b>Autor_IUD
</font><font color="#808080">(</font>@Tipo	 <font color="#000080">char</font><font color="#808080">(</font><font color="#FF0000">1</font><font color="#808080">),
</font>@Codigo	 <font color="#000080">smallint</font><font color="#808080">,
</font>@Autor <font color="#000080"><b>varchar</b></font><font color="#808080">(</font><font color="#FF0000">30</font><font color="#808080">))
</font><font color="#000080"><b>as
if </b>sTipo</font><font color="#808080">=</font><font color="#800000">'I'
  </font><font color="#000080"><b>insert into </b>Autor</font><font color="#808080">(</font><font color="#000080">codautor</font><font color="#808080">, </font><font color="#000080">autor</font><font color="#808080">) </font><font color="#000080">values</font><font color="#808080">(</font>@Codigo<font color="#808080">,</font>@Autor<font color="#808080">)
</font><font color="#000080"><b>else if </b>sTipo</font><font color="#808080">=</font><font color="#800000">'U'
  </font><font color="#000080"><b>update </b>Autor <b>set </b>autor</font><font color="#808080">=</font>@Autor <font color="#000080"><b>where </b>codautor</font><font color="#808080">=</font>@Codigo
<font color="#000080"><b>else if </b>sTipo</font><font color="#808080">=</font><font color="#800000">'D'
  </font><font color="#000080"><b>delete from </b>Autor <b>where </b>codautor</font><font color="#808080">=</font>@Codigo

<font color="#000080"><b>return

</b></font><font color="#808080">//<i>----------------------------

</i></font><font color="#000080"><b>create procedure </b>Editora_NS
</font><font color="#808080">(</font>@Tipo	 <font color="#000080">char</font><font color="#808080">(</font><font color="#FF0000">1</font><font color="#808080">),
</font>@Codigo	 <font color="#000080">smallint </font><font color="#808080">= </font><font color="#000080"><b>Null</b></font><font color="#808080">,
</font>@Editora <font color="#000080"><b>varchar</b></font><font color="#808080">(</font><font color="#FF0000">50</font><font color="#808080">) = </font><font color="#000080"><b>Null</b></font><font color="#808080">)
</font><font color="#000080"><b>as
if </b>sTipo</font><font color="#808080">=</font><font color="#800000">'N' 
  </font><font color="#000080"><b>select </b></font><font color="#808080">(</font><font color="#000080">max</font><font color="#808080">(</font><font color="#000080">codeditora</font><font color="#808080">)+</font><font color="#FF0000">1</font><font color="#808080">) </font><font color="#000080"><b>as </b>Codigo <b>from </b>Editora
<b>else if </b>sTipo</font><font color="#808080">=</font><font color="#800000">'S'
  </font><font color="#000080"><b>select </b>e</font><font color="#808080">.</font><font color="#000080">codeditora <b>as </b>Codigo</font><font color="#808080">, </font><font color="#000080">e</font><font color="#808080">.</font><font color="#000080">editora <b>as </b>Editora <b>from </b>Editora e
  <b>where </b></font><font color="#808080">(</font><font color="#000080">e</font><font color="#808080">.</font><font color="#000080">codeditora </font><font color="#808080">= </font>@Codigo <font color="#000080"><b>or </b></font>@Codigo <font color="#000080"><b>is null</b></font><font color="#808080">)
  </font><font color="#000080"><b>and </b></font><font color="#808080">(</font><font color="#000080">e</font><font color="#808080">.</font><font color="#000080">editora <b>like </b></font><font color="#800000">'%'</font><font color="#808080">+</font>@Editora<font color="#808080">+</font><font color="#800000">'%' </font><font color="#000080"><b>or </b></font>@Editora <font color="#000080"><b>is null</b></font><font color="#808080">) 

</font><font color="#000080"><b>return

</b></font><font color="#808080">//<i>----------------------------

</i></font><font color="#000080"><b>create procedure </b>Editora_IUD
</font><font color="#808080">(</font>@Tipo	 <font color="#000080">char</font><font color="#808080">(</font><font color="#FF0000">1</font><font color="#808080">),
</font>@Codigo	 <font color="#000080">smallint</font><font color="#808080">,
</font>@Editora <font color="#000080"><b>varchar</b></font><font color="#808080">(</font><font color="#FF0000">50</font><font color="#808080">))
</font><font color="#000080"><b>as
if </b>sTipo</font><font color="#808080">=</font><font color="#800000">'I'
  </font><font color="#000080"><b>insert into </b>Editora</font><font color="#808080">(</font><font color="#000080">codeditora</font><font color="#808080">, </font><font color="#000080">editora</font><font color="#808080">) </font><font color="#000080">values</font><font color="#808080">(</font>@Codigo<font color="#808080">,</font>@Editora<font color="#808080">)
</font><font color="#000080"><b>else if </b>sTipo</font><font color="#808080">=</font><font color="#800000">'U'
  </font><font color="#000080"><b>update </b>Editora <b>set </b>editora</font><font color="#808080">=</font>@Editora <font color="#000080"><b>where </b>codeditora</font><font color="#808080">=</font>@Codigo
<font color="#000080"><b>else if </b>sTipo</font><font color="#808080">=</font><font color="#800000">'D'
  </font><font color="#000080"><b>delete from </b>Editora <b>where </b>codeditora</font><font color="#808080">=</font>@Codigo

<font color="#000080"><b>return

</b></font><font color="#808080">//<i>----------------------------

</i></font><font color="#000080"><b>create procedure </b>Idioma_NS
</font><font color="#808080">(</font>@Tipo	 <font color="#000080">char</font><font color="#808080">(</font><font color="#FF0000">1</font><font color="#808080">),
</font>@Codigo	 <font color="#000080">smallint </font><font color="#808080">= </font><font color="#000080"><b>Null</b></font><font color="#808080">,
</font>@Idioma <font color="#000080"><b>varchar</b></font><font color="#808080">(</font><font color="#FF0000">20</font><font color="#808080">) = </font><font color="#000080"><b>Null</b></font><font color="#808080">)
</font><font color="#000080"><b>as
if </b>sTipo</font><font color="#808080">=</font><font color="#800000">'N' 
  </font><font color="#000080"><b>select </b></font><font color="#808080">(</font><font color="#000080">max</font><font color="#808080">(</font><font color="#000080">codidioma</font><font color="#808080">)+</font><font color="#FF0000">1</font><font color="#808080">) </font><font color="#000080"><b>as </b>Codigo <b>from </b>Idioma
<b>else if </b>sTipo</font><font color="#808080">=</font><font color="#800000">'S'
  </font><font color="#000080"><b>select </b>i</font><font color="#808080">.</font><font color="#000080">codidioma <b>as </b>Codigo</font><font color="#808080">, </font><font color="#000080">i</font><font color="#808080">.</font><font color="#000080">idioma <b>as </b>Idioma <b>from </b>Idioma i
  <b>where </b></font><font color="#808080">(</font><font color="#000080">i</font><font color="#808080">.</font><font color="#000080">codidioma </font><font color="#808080">= </font>@Codigo <font color="#000080"><b>or </b></font>@Codigo <font color="#000080"><b>is null</b></font><font color="#808080">)
  </font><font color="#000080"><b>and </b></font><font color="#808080">(</font><font color="#000080">i</font><font color="#808080">.</font><font color="#000080">idioma <b>like </b></font><font color="#800000">'%'</font><font color="#808080">+</font>@Idioma<font color="#808080">+</font><font color="#800000">'%' </font><font color="#000080"><b>or </b></font>@Idioma <font color="#000080"><b>is null</b></font><font color="#808080">) 

</font><font color="#000080"><b>return

</b></font><font color="#808080">//<i>----------------------------

</i></font><font color="#000080"><b>create procedure </b>Idioma_IUD
</font><font color="#808080">(</font>@Tipo	 <font color="#000080">char</font><font color="#808080">(</font><font color="#FF0000">1</font><font color="#808080">),
</font>@Codigo	 <font color="#000080">smallint</font><font color="#808080">,
</font>@Idioma <font color="#000080"><b>varchar</b></font><font color="#808080">(</font><font color="#FF0000">20</font><font color="#808080">))
</font><font color="#000080"><b>as
if </b>sTipo</font><font color="#808080">=</font><font color="#800000">'I'
  </font><font color="#000080"><b>insert into </b>Idioma</font><font color="#808080">(</font><font color="#000080">codidioma</font><font color="#808080">, </font><font color="#000080">idioma</font><font color="#808080">) </font><font color="#000080">values</font><font color="#808080">(</font>@Codigo<font color="#808080">,</font>@Idioma<font color="#808080">)
</font><font color="#000080"><b>else if </b>sTipo</font><font color="#808080">=</font><font color="#800000">'U'
  </font><font color="#000080"><b>update </b>Idioma <b>set </b>idioma</font><font color="#808080">=</font>@Idioma <font color="#000080"><b>where </b>codidioma</font><font color="#808080">=</font>@Codigo
<font color="#000080"><b>else if </b>sTipo</font><font color="#808080">=</font><font color="#800000">'D'
  </font><font color="#000080"><b>delete from </b>Idioma <b>where </b>codidioma</font><font color="#808080">=</font>@Codigo

<font color="#000080"><b>return

</b></font><font color="#808080">//<i>----------------------------

</i></font><font color="#000080"><b>create procedure </b>Usuario_S
</font><font color="#808080">(</font>@Login	<font color="#000080"><b>varchar</b></font><font color="#808080">(</font><font color="#FF0000">10</font><font color="#808080">),
</font>@Senha <font color="#000080"><b>varchar</b></font><font color="#808080">(</font><font color="#FF0000">10</font><font color="#808080">))
</font><font color="#000080"><b>as
 select </b></font><font color="#808080">* </font><font color="#000080"><b>from </b>Usuario u <b>where </b>u</font><font color="#808080">.</font><font color="#000080">ulogin</font><font color="#808080">=</font>@Login <font color="#000080"><b>and </b>u</font><font color="#808080">.</font><font color="#000080">senha</font><font color="#808080">=</font>@Senha
<font color="#000080"><b>return

</b></font><font color="#808080">//<i>----------------------------

</i></font><font color="#000080"><b>create procedure </b>Usuario_U
</font><font color="#808080">(</font>@Login	<font color="#000080"><b>varchar</b></font><font color="#808080">(</font><font color="#FF0000">10</font><font color="#808080">),
</font>@Senha <font color="#000080"><b>varchar</b></font><font color="#808080">(</font><font color="#FF0000">10</font><font color="#808080">))
</font><font color="#000080"><b>as
 update </b>Usuario <b>set </b>senha</font><font color="#808080">=</font>@Senha <font color="#000080"><b>where </b>ulogin</font><font color="#808080">=</font>@sLogin
<font color="#000080"><b>return

</b></font><font color="#808080">//<i>----------------------------

</i></font><font color="#000080"><b>create procedure </b>Livro_SQ
</font><font color="#808080">(</font>@Tipo	<font color="#000080">char</font><font color="#808080">(</font><font color="#FF0000">1</font><font color="#808080">),
</font>@ISBN 	<font color="#000080"><b>varchar</b></font><font color="#808080">(</font><font color="#FF0000">13</font><font color="#808080">) = </font><font color="#000080"><b>Null</b></font><font color="#808080">,
</font>@Titulo <font color="#000080"><b>varchar</b></font><font color="#808080">(</font><font color="#FF0000">50</font><font color="#808080">) = </font><font color="#000080"><b>Null</b></font><font color="#808080">)
</font><font color="#000080"><b>as
if </b>sTipo</font><font color="#808080">=</font><font color="#800000">'S' 
 </font><font color="#000080"><b>select </b>l</font><font color="#808080">.</font><font color="#000080">isbn <b>as </b>ISBN</font><font color="#808080">, </font><font color="#000080">l</font><font color="#808080">.</font><font color="#000080">titulo <b>as </b>Titulo</font><font color="#808080">, </font><font color="#000080">l</font><font color="#808080">.</font><font color="#000080">edicao <b>as </b>Edicao</font><font color="#808080">,
 </font><font color="#000080">l</font><font color="#808080">.</font><font color="#000080">anopubli <b>as </b>AnoPublicacao</font><font color="#808080">,</font><font color="#000080">l</font><font color="#808080">.</font><font color="#000080">volume <b>as </b>Volume</font><font color="#808080">,</font><font color="#000080">l</font><font color="#808080">.</font><font color="#000080">codeditora <b>as </b>CodEditora</font><font color="#808080">,
 </font><font color="#000080">e</font><font color="#808080">.</font><font color="#000080">editora <b>as </b>Editora</font><font color="#808080">, </font><font color="#000080">l</font><font color="#808080">.</font><font color="#000080">codidioma <b>as </b>CodIdioma</font><font color="#808080">, </font><font color="#000080">i</font><font color="#808080">.</font><font color="#000080">idioma <b>as </b>Idioma</font><font color="#808080">,
 </font><font color="#000080">l</font><font color="#808080">.</font><font color="#000080">npaginas <b>as </b>NumPaginas</font><font color="#808080">, </font><font color="#000080">l</font><font color="#808080">.</font><font color="#000080">preco <b>as </b>Preco</font><font color="#808080">, </font><font color="#000080">l</font><font color="#808080">.</font><font color="#000080">qtdestoque <b>as </b>Estoque
 <b>from </b>Livro l</font><font color="#808080">, </font><font color="#000080">editora e</font><font color="#808080">, </font><font color="#000080">idioma i
 <b>where </b>l</font><font color="#808080">.</font><font color="#000080">codeditora</font><font color="#808080">=</font><font color="#000080">e</font><font color="#808080">.</font><font color="#000080">codeditora
 <b>and </b>l</font><font color="#808080">.</font><font color="#000080">codidioma</font><font color="#808080">=</font><font color="#000080">i</font><font color="#808080">.</font><font color="#000080">codidioma
 <b>and </b></font><font color="#808080">(</font><font color="#000080">l</font><font color="#808080">.</font><font color="#000080">isbn</font><font color="#808080">=</font>@ISBN <font color="#000080"><b>or </b></font>@ISBN <font color="#000080"><b>is null</b></font><font color="#808080">)
 </font><font color="#000080"><b>and </b></font><font color="#808080">(</font><font color="#000080">l</font><font color="#808080">.</font><font color="#000080">titulo <b>like </b></font><font color="#800000">'%'</font><font color="#808080">+</font>@Titulo<font color="#808080">+</font><font color="#800000">'%' </font><font color="#000080"><b>or </b></font>@Titulo <font color="#000080"><b>is null</b></font><font color="#808080">) 
</font><font color="#000080"><b>else if </b>sTipo</font><font color="#808080">=</font><font color="#800000">'Q'
 </font><font color="#000080"><b>select </b>l</font><font color="#808080">.</font><font color="#000080">isbn <b>as </b>ISBN</font><font color="#808080">, </font><font color="#000080">l</font><font color="#808080">.</font><font color="#000080">titulo <b>as </b>T&iacute;tulo</font><font color="#808080">, </font><font color="#000080">l</font><font color="#808080">.</font><font color="#000080">preco <b>as </b>Preco</font><font color="#808080">,
 </font><font color="#000080">l</font><font color="#808080">.</font><font color="#000080">qtdestoque <b>as </b>Estoque
 <b>from </b>Livro l
 <b>where </b></font><font color="#808080">(</font><font color="#000080">l</font><font color="#808080">.</font><font color="#000080">isbn</font><font color="#808080">=</font>@ISBN <font color="#000080"><b>or </b></font>@ISBN <font color="#000080"><b>is null</b></font><font color="#808080">)
 </font><font color="#000080"><b>and </b></font><font color="#808080">(</font><font color="#000080">l</font><font color="#808080">.</font><font color="#000080">titulo <b>like </b></font><font color="#800000">'%'</font><font color="#808080">+</font>@Titulo<font color="#808080">+</font><font color="#800000">'%' </font><font color="#000080"><b>or </b></font>@Titulo <font color="#000080"><b>is null</b></font><font color="#808080">) 

</font><font color="#000080"><b>return

</b></font><font color="#808080">//<i>----------------------------

</i></font><font color="#000080"><b>create procedure </b>Livro_IUD
</font><font color="#808080">(</font>@Tipo	<font color="#000080">char</font><font color="#808080">(</font><font color="#FF0000">1</font><font color="#808080">),
</font>@ISBN 	<font color="#000080"><b>varchar</b></font><font color="#808080">(</font><font color="#FF0000">13</font><font color="#808080">),
</font>@Titulo <font color="#000080"><b>varchar</b></font><font color="#808080">(</font><font color="#FF0000">50</font><font color="#808080">) = </font><font color="#000080"><b>Null</b></font><font color="#808080">,
</font>@Edicao <font color="#000080">smallint </font><font color="#808080">= </font><font color="#000080"><b>Null</b></font><font color="#808080">,
</font>@AnoPubli <font color="#000080">smallint </font><font color="#808080">= </font><font color="#000080"><b>Null</b></font><font color="#808080">,
</font>@CodEditora <font color="#000080">smallint </font><font color="#808080">= </font><font color="#000080"><b>Null</b></font><font color="#808080">,
</font>@Volume <font color="#000080">smallint </font><font color="#808080">= </font><font color="#000080"><b>Null</b></font><font color="#808080">,
</font>@CodIdioma <font color="#000080">smallint </font><font color="#808080">= </font><font color="#000080"><b>Null</b></font><font color="#808080">,
</font>@NPaginas <font color="#000080">smallint </font><font color="#808080">= </font><font color="#000080"><b>Null</b></font><font color="#808080">,
</font>@Preco <font color="#000080">smallint </font><font color="#808080">= </font><font color="#000080"><b>Null</b></font><font color="#808080">,
</font>@QtdEstoque <font color="#000080">smallint </font><font color="#808080">= </font><font color="#000080"><b>Null</b></font><font color="#808080">)
</font><font color="#000080"><b>as
if </b>sTipo</font><font color="#808080">=</font><font color="#800000">'I' 
  </font><font color="#000080"><b>insert into </b>Livro</font><font color="#808080">(</font><font color="#000080">isbn</font><font color="#808080">, </font><font color="#000080">titulo</font><font color="#808080">, </font><font color="#000080">edicao</font><font color="#808080">, </font><font color="#000080">anopubli</font><font color="#808080">, </font><font color="#000080">codeditora</font><font color="#808080">,
  </font><font color="#000080">volume</font><font color="#808080">, </font><font color="#000080">codidioma</font><font color="#808080">,</font><font color="#000080">npaginas</font><font color="#808080">, </font><font color="#000080">preco</font><font color="#808080">, </font><font color="#000080">qtdestoque</font><font color="#808080">) 
  </font><font color="#000080">values</font><font color="#808080">(</font>@ISBN<font color="#808080">,</font>@Titulo<font color="#808080">,</font>@Edicao<font color="#808080">,</font>@AnoPubli<font color="#808080">,</font>@CodEditora<font color="#808080">,
  </font>@Volume<font color="#808080">,</font>@CodIdioma<font color="#808080">,</font>@NPaginas<font color="#808080">,</font>@Preco<font color="#808080">,</font>@QtdEstoque<font color="#808080">)
</font><font color="#000080"><b>else if </b>sTipo</font><font color="#808080">=</font><font color="#800000">'U' 
  </font><font color="#000080"><b>update </b>Livro <b>set </b>titulo</font><font color="#808080">=</font>@Titulo<font color="#808080">,</font><font color="#000080">edicao</font><font color="#808080">=</font>@Edicao<font color="#808080">,</font><font color="#000080">anopubli</font><font color="#808080">=</font>@AnoPubli<font color="#808080">,
  </font><font color="#000080">volume</font><font color="#808080">=</font>@Volume<font color="#808080">,</font><font color="#000080">codeditora</font><font color="#808080">=</font>@CodEditora<font color="#808080">,</font><font color="#000080">codidioma</font><font color="#808080">=</font>@CodIdioma<font color="#808080">,
  </font><font color="#000080">npaginas</font><font color="#808080">=</font>@NPaginas<font color="#808080">,</font><font color="#000080">preco</font><font color="#808080">=</font>@Preco<font color="#808080">,</font><font color="#000080">qtdestoque</font><font color="#808080">=</font>@QtdEstoque
  <font color="#000080"><b>where </b>isbn</font><font color="#808080">=</font>@ISBN
<font color="#000080"><b>else if </b>sTipo</font><font color="#808080">=</font><font color="#800000">'D' 
  </font><font color="#000080"><b>delete from </b>Livro <b>where </b>isbn</font><font color="#808080">=</font>@ISBN

<font color="#000080"><b>return

</b></font><font color="#808080">//<i>----------------------------

</i></font><font color="#000080"><b>create procedure </b>Cliente_S
</font><font color="#808080">(</font>@CPF 	<font color="#000080"><b>varchar</b></font><font color="#808080">(</font><font color="#FF0000">14</font><font color="#808080">) = </font><font color="#000080"><b>Null</b></font><font color="#808080">,
</font>@Nome	<font color="#000080"><b>varchar</b></font><font color="#808080">(</font><font color="#FF0000">30</font><font color="#808080">) = </font><font color="#000080"><b>Null</b></font><font color="#808080">)
</font><font color="#000080"><b>as
 select </b>c</font><font color="#808080">.</font><font color="#000080">cpf <b>as </b>CPF</font><font color="#808080">, </font><font color="#000080">c</font><font color="#808080">.</font><font color="#000080">nome <b>as </b>Nome</font><font color="#808080">, </font><font color="#000080">c</font><font color="#808080">.</font><font color="#000080">email <b>as </b>Email</font><font color="#808080">,
 </font><font color="#000080">c</font><font color="#808080">.</font><font color="#000080">identidade <b>as </b>Identidade</font><font color="#808080">, </font><font color="#000080">c</font><font color="#808080">.</font><font color="#000080">sexo <b>as </b>Sexo</font><font color="#808080">, </font><font color="#000080">c</font><font color="#808080">.</font><font color="#000080">telefone <b>as </b>Telefone</font><font color="#808080">,
 </font><font color="#000080">c</font><font color="#808080">.</font><font color="#000080">datanasc <b>as </b>DtNascimento</font><font color="#808080">, </font><font color="#000080">c</font><font color="#808080">.</font><font color="#000080">codendereco <b>as </b>CodEndereco</font><font color="#808080">,
 </font><font color="#000080">e</font><font color="#808080">.</font><font color="#000080">logradouro <b>as </b>Logradouro</font><font color="#808080">,</font><font color="#000080">e</font><font color="#808080">.</font><font color="#000080">bairro <b>as </b>Bairro</font><font color="#808080">,</font><font color="#000080">e</font><font color="#808080">.</font><font color="#000080">cep <b>as </b>CEP</font><font color="#808080">,
 </font><font color="#000080">e</font><font color="#808080">.</font><font color="#000080">cidade <b>as </b>Cidade</font><font color="#808080">,</font><font color="#000080">e</font><font color="#808080">.</font><font color="#000080">estado <b>as </b>Estado</font><font color="#808080">,</font><font color="#000080">c</font><font color="#808080">.</font><font color="#000080">codpais <b>as </b>CodPa&iacute;s</font><font color="#808080">,
 </font><font color="#000080">p</font><font color="#808080">.</font><font color="#000080">pais <b>as </b>Pa&iacute;s</font><font color="#808080">, </font><font color="#000080">c</font><font color="#808080">.</font><font color="#000080">codprofissao <b>as </b>CodProfissao</font><font color="#808080">,</font><font color="#000080">r</font><font color="#808080">.</font><font color="#000080">profissao <b>as </b>Profiss&atilde;o
 <b>from </b>Cliente c</font><font color="#808080">, </font><font color="#000080">endereco e</font><font color="#808080">, </font><font color="#000080">pais p</font><font color="#808080">, </font><font color="#000080">profissao r
 <b>where </b>c</font><font color="#808080">.</font><font color="#000080">codendereco</font><font color="#808080">=</font><font color="#000080">e</font><font color="#808080">.</font><font color="#000080">codendereco
 <b>and </b>c</font><font color="#808080">.</font><font color="#000080">codpais</font><font color="#808080">=</font><font color="#000080">p</font><font color="#808080">.</font><font color="#000080">codpais
 <b>and </b>c</font><font color="#808080">.</font><font color="#000080">codprofissao</font><font color="#808080">=</font><font color="#000080">r</font><font color="#808080">.</font><font color="#000080">codprofissao
 <b>and </b></font><font color="#808080">(</font><font color="#000080">c</font><font color="#808080">.</font><font color="#000080">cpf</font><font color="#808080">=</font>@CPF <font color="#000080"><b>or </b></font>@CPF <font color="#000080"><b>is null</b></font><font color="#808080">)
 </font><font color="#000080"><b>and </b></font><font color="#808080">(</font><font color="#000080">c</font><font color="#808080">.</font><font color="#000080">nome <b>like </b></font><font color="#800000">'%'</font><font color="#808080">+</font>@Nome<font color="#808080">+</font><font color="#800000">'%' </font><font color="#000080"><b>or </b></font>@Nome <font color="#000080"><b>is null</b></font><font color="#808080">)

</font><font color="#000080"><b>return

</b></font><font color="#808080">//<i>----------------------------

</i></font><font color="#000080"><b>create procedure </b>Cliente_IUD
</font><font color="#808080">(</font>@Tipo		<font color="#000080">char</font><font color="#808080">(</font><font color="#FF0000">1</font><font color="#808080">),
</font>@CPF 		<font color="#000080"><b>varchar</b></font><font color="#808080">(</font><font color="#FF0000">14</font><font color="#808080">),
</font>@Nome		<font color="#000080"><b>varchar</b></font><font color="#808080">(</font><font color="#FF0000">30</font><font color="#808080">) = </font><font color="#000080"><b>Null</b></font><font color="#808080">,
</font>@Email		<font color="#000080"><b>varchar</b></font><font color="#808080">(</font><font color="#FF0000">30</font><font color="#808080">) = </font><font color="#000080"><b>Null</b></font><font color="#808080">,
</font>@Identidade	<font color="#000080"><b>varchar</b></font><font color="#808080">(</font><font color="#FF0000">10</font><font color="#808080">) = </font><font color="#000080"><b>Null</b></font><font color="#808080">,
</font>@Sexo		<font color="#000080">char</font><font color="#808080">(</font><font color="#FF0000">1</font><font color="#808080">) = </font><font color="#000080"><b>Null</b></font><font color="#808080">,
</font>@Telefone	<font color="#000080"><b>varchar</b></font><font color="#808080">(</font><font color="#FF0000">17</font><font color="#808080">) = </font><font color="#000080"><b>Null</b></font><font color="#808080">,
</font>@DtNascimento	<font color="#000080">smalldatetime </font><font color="#808080">= </font><font color="#000080"><b>Null</b></font><font color="#808080">,
</font>@CodEndereco	<font color="#000080">smallint </font><font color="#808080">= </font><font color="#000080"><b>Null</b></font><font color="#808080">,
</font>@CodPais	<font color="#000080">char</font><font color="#808080">(</font><font color="#FF0000">3</font><font color="#808080">) = </font><font color="#000080"><b>Null</b></font><font color="#808080">,
</font>@CodProfissao	<font color="#000080">smallint </font><font color="#808080">= </font><font color="#000080"><b>Null</b></font><font color="#808080">)
</font><font color="#000080"><b>as
if </b>sTipo</font><font color="#808080">=</font><font color="#800000">'I'
  </font><font color="#000080"><b>insert into </b>Cliente</font><font color="#808080">(</font><font color="#000080">cpf</font><font color="#808080">, </font><font color="#000080">nome</font><font color="#808080">, </font><font color="#000080">email</font><font color="#808080">, </font><font color="#000080">identidade</font><font color="#808080">, </font><font color="#000080">sexo</font><font color="#808080">,
  </font><font color="#000080">telefone</font><font color="#808080">, </font><font color="#000080">datanasc</font><font color="#808080">, </font><font color="#000080">codendereco</font><font color="#808080">, </font><font color="#000080">codpais</font><font color="#808080">, </font><font color="#000080">codprofissao</font><font color="#808080">) 
  </font><font color="#000080">values</font><font color="#808080">(</font>@CPF<font color="#808080">,</font>@Nome<font color="#808080">,</font>@Email<font color="#808080">,</font>@Identidade<font color="#808080">,</font>@Sexo<font color="#808080">,</font>@Telefone<font color="#808080">,
  </font>@DtNascimento<font color="#808080">,</font>@CodEndereco<font color="#808080">,</font>@CodPais<font color="#808080">,</font>@CodProfissao<font color="#808080">)
</font><font color="#000080"><b>else if </b>sTipo</font><font color="#808080">=</font><font color="#800000">'U'
  </font><font color="#000080"><b>update </b>Cliente <b>set </b>nome</font><font color="#808080">=</font>@Nome<font color="#808080">,</font><font color="#000080">email</font><font color="#808080">=</font>@Email<font color="#808080">,
  </font><font color="#000080">identidade</font><font color="#808080">=</font>@Identidade<font color="#808080">,</font><font color="#000080">sexo</font><font color="#808080">=</font>@Sexo<font color="#808080">,</font><font color="#000080">telefone</font><font color="#808080">=</font>@Telefone<font color="#808080">,
  </font><font color="#000080">datanasc</font><font color="#808080">=</font>@DtNascimento<font color="#808080">,</font><font color="#000080">codendereco</font><font color="#808080">=</font>@CodEndereco<font color="#808080">,
  </font><font color="#000080">copais</font><font color="#808080">=</font>@CodPais<font color="#808080">,</font><font color="#000080">codprofissao</font><font color="#808080">=</font>@CodProfissao
  <font color="#000080"><b>where </b>cpf</font><font color="#808080">=</font>@CPF
<font color="#000080"><b>else if </b>sTipo</font><font color="#808080">=</font><font color="#800000">'D' 
  </font><font color="#000080"><b>delete from </b>Cliente <b>where </b>cpf</font><font color="#808080">=</font>@CPF

<font color="#000080"><b>return

</b></font><font color="#808080">//<i>----------------------------

</i></font><font color="#000080"><b>create procedure </b>Endereco_NS
</font><font color="#808080">(</font>@Tipo	    <font color="#000080">char</font><font color="#808080">(</font><font color="#FF0000">1</font><font color="#808080">),
</font>@Codigo	    <font color="#000080">smallint </font><font color="#808080">= </font><font color="#000080"><b>Null</b></font><font color="#808080">,
</font>@Logradouro <font color="#000080"><b>varchar</b></font><font color="#808080">(</font><font color="#FF0000">40</font><font color="#808080">) = </font><font color="#000080"><b>Null</b></font><font color="#808080">)
</font><font color="#000080"><b>as
if </b>sTipo</font><font color="#808080">=</font><font color="#800000">'N' 
  </font><font color="#000080"><b>select </b></font><font color="#808080">(</font><font color="#000080">max</font><font color="#808080">(</font><font color="#000080">codendereco</font><font color="#808080">)+</font><font color="#FF0000">1</font><font color="#808080">) </font><font color="#000080"><b>as </b>Codigo <b>from </b>Endereco
<b>else if </b>sTipo</font><font color="#808080">=</font><font color="#800000">'S'
  </font><font color="#000080"><b>select </b>e</font><font color="#808080">.</font><font color="#000080">codendereco <b>as </b>C&oacute;digo</font><font color="#808080">, </font><font color="#000080">e</font><font color="#808080">.</font><font color="#000080">logradouro <b>as </b>Logradouro</font><font color="#808080">,
  </font><font color="#000080">e</font><font color="#808080">.</font><font color="#000080">bairro <b>as </b>Bairro</font><font color="#808080">,</font><font color="#000080">e</font><font color="#808080">.</font><font color="#000080">cep <b>as </b>CEP</font><font color="#808080">,</font><font color="#000080">e</font><font color="#808080">.</font><font color="#000080">cidade <b>as </b>Cidade</font><font color="#808080">,</font><font color="#000080">e</font><font color="#808080">.</font><font color="#000080">estado <b>as </b>Estado
  <b>from </b>Endereco e
  <b>where </b></font><font color="#808080">(</font><font color="#000080">e</font><font color="#808080">.</font><font color="#000080">codendereco</font><font color="#808080">=</font>@Codigo <font color="#000080"><b>or </b></font>@Codigo <font color="#000080"><b>is null</b></font><font color="#808080">)
  </font><font color="#000080"><b>and </b></font><font color="#808080">(</font><font color="#000080">e</font><font color="#808080">.</font><font color="#000080">logradouro <b>like </b></font><font color="#800000">'%'</font><font color="#808080">+</font>@Logradouro<font color="#808080">+</font><font color="#800000">'%' </font><font color="#000080"><b>or </b></font>@Logradouro <font color="#000080"><b>is null</b></font><font color="#808080">)

</font><font color="#000080"><b>return

</b></font><font color="#808080">//<i>----------------------------

</i></font><font color="#000080"><b>create procedure </b>Endereco_IUD
</font><font color="#808080">(</font>@Tipo	    <font color="#000080">char</font><font color="#808080">(</font><font color="#FF0000">1</font><font color="#808080">),
</font>@Codigo	    <font color="#000080">smallint</font><font color="#808080">,
</font>@Logradouro <font color="#000080"><b>varchar</b></font><font color="#808080">(</font><font color="#FF0000">40</font><font color="#808080">) = </font><font color="#000080"><b>Null</b></font><font color="#808080">,
</font>@Bairro	    <font color="#000080"><b>varchar</b></font><font color="#808080">(</font><font color="#FF0000">15</font><font color="#808080">) = </font><font color="#000080"><b>Null</b></font><font color="#808080">,
</font>@CEP        <font color="#000080"><b>varchar</b></font><font color="#808080">(</font><font color="#FF0000">8</font><font color="#808080">) = </font><font color="#000080"><b>Null</b></font><font color="#808080">,
</font>@Cidade     <font color="#000080"><b>varchar</b></font><font color="#808080">(</font><font color="#FF0000">30</font><font color="#808080">) = </font><font color="#000080"><b>Null</b></font><font color="#808080">,
</font>@Estado    <font color="#000080"><b>varchar</b></font><font color="#808080">(</font><font color="#FF0000">20</font><font color="#808080">) = </font><font color="#000080"><b>Null</b></font><font color="#808080">)
</font><font color="#000080"><b>as
if </b>sTipo</font><font color="#808080">=</font><font color="#800000">'I' 
  </font><font color="#000080"><b>insert into </b>Endereco</font><font color="#808080">(</font><font color="#000080">codendereco</font><font color="#808080">, </font><font color="#000080">logradouro</font><font color="#808080">, </font><font color="#000080">bairro</font><font color="#808080">, </font><font color="#000080">cep</font><font color="#808080">,
  </font><font color="#000080">cidade</font><font color="#808080">, </font><font color="#000080">estado</font><font color="#808080">) 
  </font><font color="#000080">values</font><font color="#808080">(</font>@Codigo<font color="#808080">,</font>@Logradouro<font color="#808080">,</font>@Bairro<font color="#808080">,</font>@CEP<font color="#808080">,</font>@Cidade<font color="#808080">,</font>@Estado<font color="#808080">)
</font><font color="#000080"><b>else if </b>sTipo</font><font color="#808080">=</font><font color="#800000">'U'
  </font><font color="#000080"><b>update </b>Endereco <b>set </b>logradouro</font><font color="#808080">=</font>@Logradouro<font color="#808080">,</font><font color="#000080">bairro</font><font color="#808080">=</font>@Bairro<font color="#808080">,
  </font><font color="#000080">cep</font><font color="#808080">=</font>@CEP<font color="#808080">,</font><font color="#000080">cidade</font><font color="#808080">=</font>@Cidade<font color="#808080">,</font><font color="#000080">estado</font><font color="#808080">=</font>@Estado
  <font color="#000080"><b>where </b>codendereco</font><font color="#808080">=</font>@Codigo
<font color="#000080"><b>else if </b>sTipo</font><font color="#808080">=</font><font color="#800000">'D'
  </font><font color="#000080"><b>delete from </b>Endereco <b>where </b>codendereco</font><font color="#808080">=</font>@Codigo

<font color="#000080"><b>return

</b></font><font color="#808080">//<i>----------------------------

</i></font><font color="#000080"><b>create procedure </b>Pais_S
</font><font color="#808080">(</font>@Codigo <font color="#000080">char</font><font color="#808080">(</font><font color="#FF0000">3</font><font color="#808080">) = </font><font color="#000080"><b>Null</b></font><font color="#808080">,
</font>@Pais 	 <font color="#000080"><b>varchar</b></font><font color="#808080">(</font><font color="#FF0000">50</font><font color="#808080">) = </font><font color="#000080"><b>Null</b></font><font color="#808080">)
</font><font color="#000080"><b>as
  select </b>p</font><font color="#808080">.</font><font color="#000080">codpais <b>as </b>C&oacute;digo</font><font color="#808080">, </font><font color="#000080">p</font><font color="#808080">.</font><font color="#000080">pais <b>as </b>Pa&iacute;s <b>from </b>Pais p
  <b>where </b></font><font color="#808080">(</font><font color="#000080">p</font><font color="#808080">.</font><font color="#000080">codpais</font><font color="#808080">=</font>@Codigo <font color="#000080"><b>or </b></font>@Codigo <font color="#000080"><b>is null</b></font><font color="#808080">)
  </font><font color="#000080"><b>and </b></font><font color="#808080">(</font><font color="#000080">p</font><font color="#808080">.</font><font color="#000080">pais <b>like </b></font><font color="#800000">'%'</font><font color="#808080">+</font>@Pais<font color="#808080">+</font><font color="#800000">'%' </font><font color="#000080"><b>or </b></font>@Pais <font color="#000080"><b>is null</b></font><font color="#808080">)

</font><font color="#000080"><b>return

</b></font><font color="#808080">//<i>----------------------------

</i></font><font color="#000080"><b>create procedure </b>Pais_IUD
</font><font color="#808080">(</font>@Tipo	 <font color="#000080">char</font><font color="#808080">(</font><font color="#FF0000">1</font><font color="#808080">),
</font>@Codigo	 <font color="#000080">char</font><font color="#808080">(</font><font color="#FF0000">3</font><font color="#808080">) = </font><font color="#000080"><b>Null</b></font><font color="#808080">,
</font>@Pais 	 <font color="#000080"><b>varchar</b></font><font color="#808080">(</font><font color="#FF0000">50</font><font color="#808080">) = </font><font color="#000080"><b>Null</b></font><font color="#808080">)
</font><font color="#000080"><b>as
if </b>sTipo</font><font color="#808080">=</font><font color="#800000">'I'
  </font><font color="#000080"><b>insert into </b>Pais</font><font color="#808080">(</font><font color="#000080">codpais</font><font color="#808080">, </font><font color="#000080">pais</font><font color="#808080">) </font><font color="#000080">values</font><font color="#808080">(</font>@Codigo<font color="#808080">,</font>@Pais<font color="#808080">)
</font><font color="#000080"><b>else if </b>sTipo</font><font color="#808080">=</font><font color="#800000">'U'
  </font><font color="#000080"><b>update </b>Pais <b>set </b>pais</font><font color="#808080">=</font>@Pais <font color="#000080"><b>where </b>codpais</font><font color="#808080">=</font>@Codigo
<font color="#000080"><b>else if </b>sTipo</font><font color="#808080">=</font><font color="#800000">'D'
  </font><font color="#000080"><b>delete from </b>Pais <b>where </b>codpais</font><font color="#808080">=</font>@Codigo

<font color="#000080"><b>return

</b></font><font color="#808080">//<i>----------------------------

</i></font><font color="#000080"><b>create procedure </b>Profissao_NS
</font><font color="#808080">(</font>@Tipo	 <font color="#000080">char</font><font color="#808080">(</font><font color="#FF0000">1</font><font color="#808080">),
</font>@Codigo	 <font color="#000080">smallint </font><font color="#808080">= </font><font color="#000080"><b>Null</b></font><font color="#808080">,
</font>@Profissao <font color="#000080"><b>varchar</b></font><font color="#808080">(</font><font color="#FF0000">50</font><font color="#808080">) = </font><font color="#000080"><b>Null</b></font><font color="#808080">)
</font><font color="#000080"><b>as
if </b>sTipo</font><font color="#808080">=</font><font color="#800000">'N' 
  </font><font color="#000080"><b>select </b></font><font color="#808080">(</font><font color="#000080">max</font><font color="#808080">(</font><font color="#000080">codprofissao</font><font color="#808080">)+</font><font color="#FF0000">1</font><font color="#808080">) </font><font color="#000080"><b>as </b>Codigo <b>from </b>Profissao
<b>else if </b>sTipo</font><font color="#808080">=</font><font color="#800000">'S'
  </font><font color="#000080"><b>select </b>p</font><font color="#808080">.</font><font color="#000080">codprofissao <b>as </b>Codigo</font><font color="#808080">, </font><font color="#000080">p</font><font color="#808080">.</font><font color="#000080">profissao <b>as </b>Profissao <b>from </b>Profissao p
  <b>where </b></font><font color="#808080">(</font><font color="#000080">p</font><font color="#808080">.</font><font color="#000080">codprofissao </font><font color="#808080">= </font>@Codigo <font color="#000080"><b>or </b></font>@Codigo <font color="#000080"><b>is null</b></font><font color="#808080">)
  </font><font color="#000080"><b>and </b></font><font color="#808080">(</font><font color="#000080">p</font><font color="#808080">.</font><font color="#000080">profissao <b>like </b></font><font color="#800000">'%'</font><font color="#808080">+</font>@Profissao<font color="#808080">+</font><font color="#800000">'%' </font><font color="#000080"><b>or </b></font>@Profissao <font color="#000080"><b>is null</b></font><font color="#808080">) 

</font><font color="#000080"><b>return

</b></font><font color="#808080">//<i>----------------------------

</i></font><font color="#000080"><b>create procedure </b>Profissao_IUD
</font><font color="#808080">(</font>@Tipo	 <font color="#000080">char</font><font color="#808080">(</font><font color="#FF0000">1</font><font color="#808080">),
</font>@Codigo	 <font color="#000080">smallint</font><font color="#808080">,
</font>@Profissao <font color="#000080"><b>varchar</b></font><font color="#808080">(</font><font color="#FF0000">50</font><font color="#808080">))
</font><font color="#000080"><b>as
if </b>sTipo</font><font color="#808080">=</font><font color="#800000">'I'
  </font><font color="#000080"><b>insert into </b>Profissao</font><font color="#808080">(</font><font color="#000080">codprofissao</font><font color="#808080">, </font><font color="#000080">profissao</font><font color="#808080">) </font><font color="#000080">values</font><font color="#808080">(</font>@Codigo<font color="#808080">,</font>@Profissao<font color="#808080">)
</font><font color="#000080"><b>else if </b>sTipo</font><font color="#808080">=</font><font color="#800000">'U'
  </font><font color="#000080"><b>update </b>Profissao <b>set </b>profissao</font><font color="#808080">=</font>@Profissao <font color="#000080"><b>where </b>codprofissao</font><font color="#808080">=</font>@Codigo
<font color="#000080"><b>else if </b>sTipo</font><font color="#808080">=</font><font color="#800000">'D'
  </font><font color="#000080"><b>delete from </b>Profissao <b>where </b>codprofissao</font><font color="#808080">=</font>@Codigo

<font color="#000080"><b>return

</b></font><font color="#808080">//<i>----------------------------

</i></font><font color="#000080"><b>create procedure </b>LivroAss_S
</font><font color="#808080">(</font>@ISBN <font color="#000080"><b>varchar</b></font><font color="#808080">(</font><font color="#FF0000">13</font><font color="#808080">))
</font><font color="#000080"><b>as
  select </b>la</font><font color="#808080">.</font><font color="#000080">codassunto</font><font color="#808080">, </font><font color="#000080">a</font><font color="#808080">.</font><font color="#000080">assunto <b>from </b>LivroAss la</font><font color="#808080">, </font><font color="#000080">Assunto a
  <b>where </b>la</font><font color="#808080">.</font><font color="#000080">codassunto</font><font color="#808080">=</font><font color="#000080">a</font><font color="#808080">.</font><font color="#000080">codassunto
  <b>and </b>la</font><font color="#808080">.</font><font color="#000080">isbn</font><font color="#808080">=</font>@ISBN

<font color="#000080"><b>return

</b></font><font color="#808080">//<i>----------------------------

</i></font><font color="#000080"><b>create procedure </b>LivroAss_IUD
</font><font color="#808080">(</font>@Tipo	    <font color="#000080">char</font><font color="#808080">(</font><font color="#FF0000">1</font><font color="#808080">),
</font>@ISBN 	    <font color="#000080"><b>varchar</b></font><font color="#808080">(</font><font color="#FF0000">13</font><font color="#808080">),
</font>@CodAssunto <font color="#000080">smallint</font><font color="#808080">)
</font><font color="#000080"><b>as
if </b>sTipo</font><font color="#808080">=</font><font color="#800000">'I'
  </font><font color="#000080"><b>insert into </b>LivroAss</font><font color="#808080">(</font><font color="#000080">isbn</font><font color="#808080">, </font><font color="#000080">codassunto</font><font color="#808080">) </font><font color="#000080">values</font><font color="#808080">(</font>@ISBN<font color="#808080">,</font>@CodAssunto<font color="#808080">)
</font><font color="#000080"><b>else if </b>sTipo</font><font color="#808080">=</font><font color="#800000">'D'
  </font><font color="#000080"><b>delete from </b>LivroAss <b>where </b>isbn</font><font color="#808080">=</font>@ISBN

<font color="#000080"><b>return

</b></font><font color="#808080">//<i>----------------------------

</i></font><font color="#000080"><b>create procedure </b>LivroAut_S
</font><font color="#808080">(</font>@ISBN <font color="#000080"><b>varchar</b></font><font color="#808080">(</font><font color="#FF0000">13</font><font color="#808080">))
</font><font color="#000080"><b>as
  select </b>la</font><font color="#808080">.</font><font color="#000080">codautor</font><font color="#808080">, </font><font color="#000080">a</font><font color="#808080">.</font><font color="#000080">autor <b>from </b>LivroAut la</font><font color="#808080">, </font><font color="#000080">Autor a
  <b>where </b>la</font><font color="#808080">.</font><font color="#000080">codautor</font><font color="#808080">=</font><font color="#000080">a</font><font color="#808080">.</font><font color="#000080">codautor
  <b>and </b>la</font><font color="#808080">.</font><font color="#000080">isbn</font><font color="#808080">=</font>@ISBN

<font color="#000080"><b>return

</b></font><font color="#808080">//<i>----------------------------

</i></font><font color="#000080"><b>create procedure </b>LivroAut_IUD
</font><font color="#808080">(</font>@Tipo	  <font color="#000080">char</font><font color="#808080">(</font><font color="#FF0000">1</font><font color="#808080">),
</font>@ISBN 	  <font color="#000080"><b>varchar</b></font><font color="#808080">(</font><font color="#FF0000">13</font><font color="#808080">),
</font>@CodAutor <font color="#000080">smallint</font><font color="#808080">)
</font><font color="#000080"><b>as
if </b>sTipo</font><font color="#808080">=</font><font color="#800000">'I'
  </font><font color="#000080"><b>insert into </b>LivroAut</font><font color="#808080">(</font><font color="#000080">isbn</font><font color="#808080">, </font><font color="#000080">codautor</font><font color="#808080">) </font><font color="#000080">values</font><font color="#808080">(</font>@ISBN<font color="#808080">,</font>@CodAutor<font color="#808080">)
</font><font color="#000080"><b>else if </b>sTipo</font><font color="#808080">=</font><font color="#800000">'D'
  </font><font color="#000080"><b>delete from </b>LivroAut <b>where </b>isbn</font><font color="#808080">=</font>@ISBN

<font color="#000080"><b>return

</b></font><font color="#808080">//<i>----------------------------

</i></font><font color="#000080"><b>create procedure </b>Venda_SP
</font><font color="#808080">(</font>@Tipo	<font color="#000080">char</font><font color="#808080">(</font><font color="#FF0000">1</font><font color="#808080">),
</font>@ISBN 	<font color="#000080"><b>varchar</b></font><font color="#808080">(</font><font color="#FF0000">13</font><font color="#808080">) = </font><font color="#000080"><b>Null</b></font><font color="#808080">,
</font>@CPF	<font color="#000080"><b>varchar</b></font><font color="#808080">(</font><font color="#FF0000">14</font><font color="#808080">) = </font><font color="#000080"><b>Null</b></font><font color="#808080">,
</font>@DataVenda <font color="#000080">smalldatetime </font><font color="#808080">= </font><font color="#000080"><b>Null</b></font><font color="#808080">)
</font><font color="#000080"><b>as
if </b>sTipo</font><font color="#808080">=</font><font color="#800000">'S'
  </font><font color="#000080"><b>select </b>v</font><font color="#808080">.</font><font color="#000080">datavenda <b>as </b>DataVenda</font><font color="#808080">, </font><font color="#000080">v</font><font color="#808080">.</font><font color="#000080">cpf <b>as </b>CPF</font><font color="#808080">, </font><font color="#000080">c</font><font color="#808080">.</font><font color="#000080">nome <b>as </b>Cliente</font><font color="#808080">,
  </font><font color="#000080">v</font><font color="#808080">.</font><font color="#000080">isbn <b>as </b>ISBN</font><font color="#808080">,</font><font color="#000080">l</font><font color="#808080">.</font><font color="#000080">Titulo <b>as </b>Livro</font><font color="#808080">, </font><font color="#000080">l</font><font color="#808080">.</font><font color="#000080">preco <b>as </b>Preco
  <b>from </b>Venda v</font><font color="#808080">, </font><font color="#000080">Livro l</font><font color="#808080">, </font><font color="#000080">Cliente c
  <b>where </b>v</font><font color="#808080">.</font><font color="#000080">isbn</font><font color="#808080">=</font><font color="#000080">l</font><font color="#808080">.</font><font color="#000080">isbn <b>and </b>v</font><font color="#808080">.</font><font color="#000080">cpf</font><font color="#808080">=</font><font color="#000080">c</font><font color="#808080">.</font><font color="#000080">cpf
  <b>and </b></font><font color="#808080">(</font><font color="#000080">v</font><font color="#808080">.</font><font color="#000080">isbn</font><font color="#808080">=</font>@ISBN <font color="#000080"><b>or </b></font>@ISBN <font color="#000080"><b>is null</b></font><font color="#808080">)
  </font><font color="#000080"><b>and </b></font><font color="#808080">(</font><font color="#000080">v</font><font color="#808080">.</font><font color="#000080">cpf</font><font color="#808080">=</font>@CPF <font color="#000080"><b>or </b></font>@CPF <font color="#000080"><b>is null</b></font><font color="#808080">)
  </font><font color="#000080"><b>and </b></font><font color="#808080">(</font><font color="#000080">v</font><font color="#808080">.</font><font color="#000080">datavenda</font><font color="#808080">=</font>@DataVenda <font color="#000080"><b>or </b></font>@DataVenda <font color="#000080"><b>is null</b></font><font color="#808080">)
</font><font color="#000080"><b>else if </b>sTipo</font><font color="#808080">=</font><font color="#800000">'P'
  </font><font color="#000080"><b>select </b>v</font><font color="#808080">.</font><font color="#000080">precovenda <b>as </b>PrecoTotal
  <b>from </b>Venda v</font><font color="#808080">, </font><font color="#000080">Livro l</font><font color="#808080">, </font><font color="#000080">Cliente c
  <b>where </b>v</font><font color="#808080">.</font><font color="#000080">isbn</font><font color="#808080">=</font><font color="#000080">l</font><font color="#808080">.</font><font color="#000080">isbn <b>and </b>v</font><font color="#808080">.</font><font color="#000080">cpf</font><font color="#808080">=</font><font color="#000080">c</font><font color="#808080">.</font><font color="#000080">cpf
  <b>and </b></font><font color="#808080">(</font><font color="#000080">v</font><font color="#808080">.</font><font color="#000080">isbn</font><font color="#808080">=</font>@ISBN <font color="#000080"><b>or </b></font>@ISBN <font color="#000080"><b>is null</b></font><font color="#808080">)
  </font><font color="#000080"><b>and </b></font><font color="#808080">(</font><font color="#000080">v</font><font color="#808080">.</font><font color="#000080">cpf</font><font color="#808080">=</font>@CPF <font color="#000080"><b>or </b></font>@CPF <font color="#000080"><b>is null</b></font><font color="#808080">)
  </font><font color="#000080"><b>and </b></font><font color="#808080">(</font><font color="#000080">v</font><font color="#808080">.</font><font color="#000080">datavenda</font><font color="#808080">=</font>@DataVenda <font color="#000080"><b>or </b></font>@DataVenda <font color="#000080"><b>is null</b></font><font color="#808080">)

</font><font color="#000080"><b>return

</b></font><font color="#808080">//<i>----------------------------

</i></font><font color="#000080"><b>create procedure </b>Venda_IUD
</font><font color="#808080">(</font>@Tipo	<font color="#000080">char</font><font color="#808080">(</font><font color="#FF0000">1</font><font color="#808080">),
</font>@ISBN 	<font color="#000080"><b>varchar</b></font><font color="#808080">(</font><font color="#FF0000">13</font><font color="#808080">),
</font>@CPF	<font color="#000080"><b>varchar</b></font><font color="#808080">(</font><font color="#FF0000">14</font><font color="#808080">),
</font>@DataVenda <font color="#000080">smalldatetime</font><font color="#808080">,
</font>@PrecoVenda <font color="#000080">real </font><font color="#808080">= </font><font color="#000080"><b>Null</b></font><font color="#808080">,
</font>@QtdEstoque <font color="#000080">smallint </font><font color="#808080">= </font><font color="#000080"><b>Null</b></font><font color="#808080">)
</font><font color="#000080"><b>as
if </b>sTipo</font><font color="#808080">=</font><font color="#800000">'I'
  </font><font color="#000080"><b>insert into </b>Venda</font><font color="#808080">(</font><font color="#000080">isbn</font><font color="#808080">, </font><font color="#000080">cpf</font><font color="#808080">, </font><font color="#000080">datavenda</font><font color="#808080">, </font><font color="#000080">precovenda</font><font color="#808080">) 
  </font><font color="#000080">values</font><font color="#808080">(</font>@ISBN<font color="#808080">,</font>@CPF<font color="#808080">,</font>@DataVenda<font color="#808080">,</font>@PrecoVenda<font color="#808080">)
</font><font color="#000080"><b>else if </b>sTipo</font><font color="#808080">=</font><font color="#800000">'U'
  </font><font color="#000080"><b>update </b>Livro <b>set </b>qtdestoque</font><font color="#808080">=</font>@QtdEstoque <font color="#000080"><b>where </b>isbn</font><font color="#808080">=</font>@ISBN
<font color="#000080"><b>else if </b>sTipo</font><font color="#808080">=</font><font color="#800000">'D'
  </font><font color="#000080"><b>delete from </b>Venda <b>where </b>isbn</font><font color="#808080">=</font>@ISBN 
  <font color="#000080"><b>and </b>cpf</font><font color="#808080">=</font>@CPF <font color="#000080"><b>and </b>datavenda</font><font color="#808080">=</font>@DataVenda

<font color="#000080"><b>return

</b></font><font color="#808080">//<i>----------------------------

</i></font></font>
</code></pre>
</body>
</html>