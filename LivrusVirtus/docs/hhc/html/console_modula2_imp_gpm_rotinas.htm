<html>
<head>
<title>Livrus Virtus - Console - Modula-2 - Implementação - GPM - Rotinas</title>
</head>
<!-- Generated by ConTEXT HTML exporter -->
<body text="#000000" bgcolor="#FFFFFF">
<pre>
<code><font  face="Courier New"><font color="#0000FF">IMPLEMENTATION MODULE </font>Rotinas<font color="#808080">;

</font><font color="#0000FF">FROM </font>WholeStr <font color="#0000FF">IMPORT </font>StrToCard<font color="#808080">, </font>StrToInt<font color="#808080">;
</font><font color="#0000FF">IMPORT </font>RealConv<font color="#808080">;
</font><font color="#0000FF">FROM </font>RealStr <font color="#0000FF">IMPORT </font>StrToReal<font color="#808080">, </font>ConvResults<font color="#808080">; 
</font><font color="#0000FF">FROM </font>Ascii <font color="#0000FF">IMPORT </font>lf<font color="#808080">, </font>cr<font color="#808080">, </font>nul<font color="#808080">;
</font><font color="#0000FF">FROM </font>AsciiTime <font color="#0000FF">IMPORT </font>StructTimeToAscii<font color="#808080">; 
</font><font color="#0000FF">FROM </font>Strings <font color="#0000FF">IMPORT </font>Length<font color="#808080">, </font>Append<font color="#808080">, 
</font>Extract<font color="#808080">, </font>Compare<font color="#808080">, </font>CompareResults<font color="#808080">;
</font><font color="#0000FF">FROM </font>Terminal <font color="#0000FF">IMPORT </font>WriteString<font color="#808080">, </font>GetKeyStroke<font color="#808080">;
</font><font color="#0000FF">FROM </font>SysClock <font color="#0000FF">IMPORT </font>GetClock<font color="#808080">, </font>DateTime<font color="#808080">;
</font><font color="#0000FF">FROM </font>InOut <font color="#0000FF">IMPORT </font>Read<font color="#808080">, </font>WriteLn<font color="#808080">;

(*------------------------------------------------------------------------------
Escreve uma linha na tela com retorno de carro.
sTexto - o texto a ser escrito
------------------------------------------------------------------------------*)
</font><font color="#0000FF">PROCEDURE </font>WriteLinha<font color="#808080">(</font>sTexto<font color="#808080">: </font><font color="#0000FF">ARRAY OF CHAR</font><font color="#808080">);
</font><font color="#0000FF">BEGIN
</font>WriteString<font color="#808080">(</font>sTexto<font color="#808080">); 
</font>WriteLn<font color="#808080">;
</font><font color="#0000FF">END </font>WriteLinha<font color="#808080">;

(*------------------------------------------------------------------------------
Le uma linha do prompt, foi necess&aacute;rio para pegar strings com espa&ccedil;o em branco.
sTexto - o texto a ser lido
------------------------------------------------------------------------------*)
</font><font color="#0000FF">PROCEDURE </font>ReadLinha<font color="#808080">(</font><font color="#0000FF">VAR </font>sTexto<font color="#808080">: </font><font color="#0000FF">ARRAY OF CHAR</font><font color="#808080">);
</font><font color="#0000FF">VAR </font>sLetra<font color="#808080">: </font><font color="#0000FF">CHAR</font><font color="#808080">;
    </font>ncont<font color="#808080">: </font><font color="#0000FF">CARDINAL</font><font color="#808080">;
</font><font color="#0000FF">BEGIN
  </font>ncont<font color="#808080">:=</font><font color="#FF0000">0</font><font color="#808080">;
  </font>sLetra<font color="#808080">:=</font>nul<font color="#808080">;
  </font><font color="#0000FF">WHILE </font><font color="#808080">(</font>sLetra<font color="#808080">&lt;&gt;</font>lf<font color="#808080">) </font><font color="#0000FF">DO 
    </font>Read<font color="#808080">(</font>sLetra<font color="#808080">);
    </font><font color="#0000FF">IF </font><font color="#808080">(</font>sLetra<font color="#808080">&lt;&gt;</font>lf<font color="#808080">) </font><font color="#0000FF">OR </font><font color="#808080">(</font>sLetra<font color="#808080">&lt;&gt;</font>cr<font color="#808080">) </font><font color="#0000FF">THEN
       </font>sTexto<font color="#808080">[</font>ncont<font color="#808080">]:=</font>sLetra<font color="#808080">;
       </font>ncont<font color="#808080">:=</font>ncont<font color="#808080">+</font><font color="#FF0000">1</font><font color="#808080">;
    </font><font color="#0000FF">END</font><font color="#808080">;
  </font><font color="#0000FF">END</font><font color="#808080">;
  </font>sTexto<font color="#808080">[</font>ncont<font color="#808080">-</font><font color="#FF0000">1</font><font color="#808080">]:=</font>nul<font color="#808080">;
</font><font color="#0000FF">END </font>ReadLinha<font color="#808080">;

(*------------------------------------------------------------------------------
fun&ccedil;&atilde;o que concatena strings e retorna o resultado
str1 - indica a string1
str2 - indica a string2
retorna - as strings concatenadas
------------------------------------------------------------------------------*)
</font><font color="#0000FF">PROCEDURE </font>Ss<font color="#808080">(</font>str1<font color="#808080">,</font>str2<font color="#808080">:</font><font color="#0000FF">ARRAY OF CHAR</font><font color="#808080">):</font>String<font color="#808080">;
</font><font color="#0000FF">VAR </font>str3<font color="#808080">:</font>String<font color="#808080">;
</font><font color="#0000FF">BEGIN
 </font>str3<font color="#808080">[</font><font color="#FF0000">0</font><font color="#808080">]:=</font>nul<font color="#808080">;
 </font>Append<font color="#808080">(</font>str1<font color="#808080">,</font>str3<font color="#808080">);
 </font>Append<font color="#808080">(</font>str2<font color="#808080">,</font>str3<font color="#808080">);
 </font><font color="#0000FF">RETURN</font><font color="#808080">(</font>str3<font color="#808080">);
</font><font color="#0000FF">END </font>Ss<font color="#808080">;

(*------------------------------------------------------------------------------
Fun&ccedil;&atilde;o que soma determinado n&uacute;mero de strings.
num - indica o n&uacute;mero de strings
strs - as strings a serem somadas
retorna - as strings somadas
------------------------------------------------------------------------------*)
</font><font color="#0000FF">PROCEDURE </font>SomaStr<font color="#808080">(</font>num<font color="#808080">: </font><font color="#0000FF">CARDINAL</font><font color="#808080">; </font>strs<font color="#808080">: </font><font color="#0000FF">ARRAY OF </font>String<font color="#808080">): </font>String<font color="#808080">;
</font><font color="#0000FF">VAR </font>str1<font color="#808080">: </font>String<font color="#808080">; 
    </font>cont<font color="#808080">: </font><font color="#0000FF">CARDINAL</font><font color="#808080">;
</font><font color="#0000FF">BEGIN
 </font>str1<font color="#808080">[</font><font color="#FF0000">0</font><font color="#808080">]:=</font>nul<font color="#808080">;
 </font><font color="#0000FF">FOR </font>cont<font color="#808080">:=</font><font color="#FF0000">0 </font><font color="#0000FF">TO </font>num<font color="#808080">-</font><font color="#FF0000">1 </font><font color="#0000FF">DO  
   </font>Append<font color="#808080">(</font>strs<font color="#808080">[</font>cont<font color="#808080">],</font>str1<font color="#808080">);
 </font><font color="#0000FF">END</font><font color="#808080">;  
 </font><font color="#0000FF">RETURN</font><font color="#808080">(</font>str1<font color="#808080">);
</font><font color="#0000FF">END </font>SomaStr<font color="#808080">;

(*------------------------------------------------------------------------------
Fun&ccedil;&atilde;o que retorna um peda&ccedil;o de uma string.
str - indica a string
ini - indica a posicao inicial do pedaco
tam - indica o tamanho do pedaco
retorna - o peda&ccedil;o da string
------------------------------------------------------------------------------*)
</font><font color="#0000FF">PROCEDURE </font>copy<font color="#808080">(</font>str<font color="#808080">: </font>String<font color="#808080">; </font>ini<font color="#808080">,</font>tam<font color="#808080">: </font><font color="#0000FF">CARDINAL</font><font color="#808080">): </font>String<font color="#808080">;
</font><font color="#0000FF">VAR </font>str1<font color="#808080">: </font>String<font color="#808080">;
</font><font color="#0000FF">BEGIN
</font>ini<font color="#808080">:=</font>ini<font color="#808080">-</font><font color="#FF0000">1</font><font color="#808080">;
</font>Extract<font color="#808080">(</font>str<font color="#808080">,</font>ini<font color="#808080">,</font>tam<font color="#808080">,</font>str1<font color="#808080">);
</font><font color="#0000FF">RETURN </font>str1<font color="#808080">;
</font><font color="#0000FF">END </font>copy<font color="#808080">;

(*------------------------------------------------------------------------------
Retira os espa&ccedil;os em branco antes ou depois do texto.
sTexto - o texto a ser retirado os espa&ccedil;os em branco
retorna - o texto sem os espa&ccedil;os em branco
------------------------------------------------------------------------------*)
</font><font color="#0000FF">PROCEDURE </font>trim<font color="#808080">(</font>sTexto<font color="#808080">: </font>String<font color="#808080">): </font>String<font color="#808080">;
</font><font color="#0000FF">VAR </font>ncont<font color="#808080">, </font>nPosIni<font color="#808080">, </font>nPosFim<font color="#808080">: </font><font color="#0000FF">CARDINAL</font><font color="#808080">;
    </font>sret<font color="#808080">: </font>String<font color="#808080">;
    </font>bQuebra<font color="#808080">: </font><font color="#0000FF">BOOLEAN</font><font color="#808080">;
</font><font color="#0000FF">BEGIN
IF </font>Length<font color="#808080">(</font>sTexto<font color="#808080">) &gt; </font><font color="#FF0000">1 </font><font color="#0000FF">THEN
  </font>nPosIni<font color="#808080">:=</font><font color="#FF0000">0</font><font color="#808080">;
  </font>nPosFim<font color="#808080">:=</font><font color="#FF0000">0</font><font color="#808080">;
  </font>ncont<font color="#808080">:=</font><font color="#FF0000">0</font><font color="#808080">;
  </font>bQuebra<font color="#808080">:=</font>FALSE<font color="#808080">;
  </font><font color="#0000FF">WHILE </font><font color="#808080">(</font>ncont<font color="#808080">&lt;=(</font>Length<font color="#808080">(</font>sTexto<font color="#808080">)-</font><font color="#FF0000">1</font><font color="#808080">)) </font><font color="#0000FF">AND </font><font color="#808080">(</font>bQuebra<font color="#808080">=</font>FALSE<font color="#808080">) </font><font color="#0000FF">DO
    IF </font>sTexto<font color="#808080">[</font>ncont<font color="#808080">]&lt;&gt;</font><font color="#800000">' ' </font><font color="#0000FF">THEN
       </font>nPosIni<font color="#808080">:=</font>ncont<font color="#808080">;
       </font>bQuebra<font color="#808080">:=</font>TRUE<font color="#808080">;
    </font><font color="#0000FF">END</font><font color="#808080">;
    </font>ncont<font color="#808080">:=</font>ncont<font color="#808080">+</font><font color="#FF0000">1</font><font color="#808080">;
  </font><font color="#0000FF">END</font><font color="#808080">;
  </font>ncont<font color="#808080">:=</font>Length<font color="#808080">(</font>sTexto<font color="#808080">)-</font><font color="#FF0000">1</font><font color="#808080">;
  </font>bQuebra<font color="#808080">:=</font>FALSE<font color="#808080">;
  </font><font color="#0000FF">WHILE </font><font color="#808080">(</font>ncont <font color="#808080">&gt; </font><font color="#FF0000">0</font><font color="#808080">) </font><font color="#0000FF">AND </font><font color="#808080">(</font>bQuebra<font color="#808080">=</font>FALSE<font color="#808080">) </font><font color="#0000FF">DO 
    IF </font>sTexto<font color="#808080">[</font>ncont<font color="#808080">]&lt;&gt;</font><font color="#800000">' ' </font><font color="#0000FF">THEN 
       </font>nPosFim<font color="#808080">:=</font>ncont<font color="#808080">;
       </font>bQuebra<font color="#808080">:=</font>TRUE<font color="#808080">;
    </font><font color="#0000FF">END</font><font color="#808080">;  
    </font>ncont<font color="#808080">:=</font>ncont<font color="#808080">-</font><font color="#FF0000">1</font><font color="#808080">;
  </font><font color="#0000FF">END</font><font color="#808080">;
  </font>sret<font color="#808080">:=</font>copy<font color="#808080">(</font>sTexto<font color="#808080">,</font>nPosIni<font color="#808080">+</font><font color="#FF0000">1</font><font color="#808080">,(</font>nPosFim<font color="#808080">-</font>nPosIni<font color="#808080">)+</font><font color="#FF0000">1</font><font color="#808080">);
</font><font color="#0000FF">ELSE
 IF </font>Compare<font color="#808080">(</font>sTexto<font color="#808080">,</font><font color="#800000">' '</font><font color="#808080">)=</font>equal <font color="#0000FF">THEN
    </font>sret<font color="#808080">:=</font><font color="#800000">''</font><font color="#808080">;
 </font><font color="#0000FF">ELSE
    </font>sret<font color="#808080">:=</font>sTexto<font color="#808080">;
 </font><font color="#0000FF">END</font><font color="#808080">;
</font><font color="#0000FF">END</font><font color="#808080">;
</font><font color="#0000FF">RETURN </font>sret<font color="#808080">;
</font><font color="#0000FF">END </font>trim<font color="#808080">;

(*------------------------------------------------------------------------------
Repete um texto um n&uacute;mero determinado de vezes.
sTexto - o texto a ser repetido
nQtd - a quantidade de vezes
retorna - o texto repetido
------------------------------------------------------------------------------*)
</font><font color="#0000FF">PROCEDURE </font>repete<font color="#808080">(</font>sTexto<font color="#808080">: </font>String<font color="#808080">; </font>nQtd<font color="#808080">: </font><font color="#0000FF">INTEGER</font><font color="#808080">): </font>String<font color="#808080">;
</font><font color="#0000FF">VAR </font>ncont<font color="#808080">: </font><font color="#0000FF">INTEGER</font><font color="#808080">;
    </font>sret<font color="#808080">: </font>String<font color="#808080">;
</font><font color="#0000FF">BEGIN
</font>sret<font color="#808080">:=</font><font color="#800000">''</font><font color="#808080">;
</font><font color="#0000FF">FOR </font>ncont<font color="#808080">:=</font><font color="#FF0000">1 </font><font color="#0000FF">TO </font>nQtd <font color="#0000FF">DO 
    </font>Append<font color="#808080">(</font>sTexto<font color="#808080">, </font>sret<font color="#808080">);
</font><font color="#0000FF">END</font><font color="#808080">;
</font><font color="#0000FF">RETURN </font>sret<font color="#808080">;
</font><font color="#0000FF">END </font>repete<font color="#808080">;
(*------------------------------------------------------------------------------
Coloca espa&ccedil;os em branco a mais de acordo com o tamanho m&aacute;ximo do texto.
sTexto - o texto
nTam - tamanho m&aacute;ximo do texto
retorna - o texto com espa&ccedil;os em branco a mais
------------------------------------------------------------------------------*)
</font><font color="#0000FF">PROCEDURE </font>esp<font color="#808080">(</font>sTexto<font color="#808080">: </font>String<font color="#808080">; </font>nTam<font color="#808080">: </font><font color="#0000FF">CARDINAL</font><font color="#808080">):</font>String<font color="#808080">;
</font><font color="#0000FF">VAR </font>sret<font color="#808080">: </font>String<font color="#808080">;
</font><font color="#0000FF">BEGIN
</font>sret<font color="#808080">:=</font>repete<font color="#808080">(</font><font color="#800000">' '</font><font color="#808080">,</font>nTam<font color="#808080">-</font>Length<font color="#808080">(</font>sTexto<font color="#808080">));
</font>Append<font color="#808080">(</font>sret<font color="#808080">, </font>sTexto<font color="#808080">);
</font><font color="#0000FF">RETURN </font>sTexto<font color="#808080">;
</font><font color="#0000FF">END </font>esp<font color="#808080">;
(*------------------------------------------------------------------------------
Escreve zeros na frente de um texto.
stexto - o texto para receber zeros a frente
ntam - o tamanho da string
retorna - o texto com o zeros antes
------------------------------------------------------------------------------*)
</font><font color="#0000FF">PROCEDURE </font>zeros<font color="#808080">(</font>stexto<font color="#808080">:</font>String<font color="#808080">; </font>ntam<font color="#808080">: </font><font color="#0000FF">CARDINAL</font><font color="#808080">): </font>String<font color="#808080">;
</font><font color="#0000FF">VAR </font>saux<font color="#808080">: </font>String<font color="#808080">;
</font><font color="#0000FF">BEGIN  
  </font>saux<font color="#808080">[</font><font color="#FF0000">0</font><font color="#808080">]:=</font>nul<font color="#808080">;
  </font><font color="#0000FF">IF </font>ntam <font color="#808080">&gt; </font>Length<font color="#808080">(</font>stexto<font color="#808080">) </font><font color="#0000FF">THEN
     </font>Append<font color="#808080">(</font>repete<font color="#808080">(</font><font color="#800000">'0'</font><font color="#808080">,</font>ntam <font color="#808080">- </font>Length<font color="#808080">(</font>stexto<font color="#808080">)), </font>saux<font color="#808080">);
     </font>Append<font color="#808080">(</font>stexto<font color="#808080">, </font>saux<font color="#808080">);
  </font><font color="#0000FF">ELSE
     </font>saux<font color="#808080">:=</font>stexto<font color="#808080">;
  </font><font color="#0000FF">END</font><font color="#808080">;
  </font><font color="#0000FF">RETURN </font>saux<font color="#808080">;
</font><font color="#0000FF">END </font>zeros<font color="#808080">;
(*------------------------------------------------------------------------------
Faz uma pesquisa relativa de um texto atrav&eacute;s de um valor chave.
sTexto - o texto
sChave - a chave a ser pesquisada
retorna - se achou ou n&atilde;o a chave dentro do texto
------------------------------------------------------------------------------*)
</font><font color="#0000FF">PROCEDURE </font>strRelativa<font color="#808080">(</font>sTexto<font color="#808080">, </font>sChave<font color="#808080">: </font>String<font color="#808080">):</font><font color="#0000FF">BOOLEAN</font><font color="#808080">;
</font><font color="#0000FF">VAR </font>nCont<font color="#808080">, </font>nTamChave<font color="#808080">, </font>nTamTexto<font color="#808080">: </font><font color="#0000FF">INTEGER</font><font color="#808080">;
    </font>bret<font color="#808080">: </font><font color="#0000FF">BOOLEAN</font><font color="#808080">;
    </font>sPedaco<font color="#808080">: </font>String<font color="#808080">;
</font><font color="#0000FF">BEGIN
</font>bret<font color="#808080">:=</font>FALSE<font color="#808080">;
</font>nCont<font color="#808080">:=</font><font color="#FF0000">1</font><font color="#808080">;
</font>nTamChave<font color="#808080">:=</font>Length<font color="#808080">(</font>sChave<font color="#808080">);
</font>nTamTexto<font color="#808080">:=</font>Length<font color="#808080">(</font>sTexto<font color="#808080">);
</font><font color="#0000FF">IF </font>nTamChave <font color="#808080">&lt;= </font>nTamTexto <font color="#0000FF">THEN 
  WHILE </font>nCont <font color="#808080">&lt;= (</font>nTamTexto<font color="#808080">-</font>nTamChave<font color="#808080">+</font><font color="#FF0000">1</font><font color="#808080">) </font><font color="#0000FF">DO 
     </font>sPedaco<font color="#808080">:=</font>copy<font color="#808080">(</font>sTexto<font color="#808080">,</font>nCont<font color="#808080">,</font>nTamChave<font color="#808080">);
     </font><font color="#0000FF">IF </font>Compare<font color="#808080">(</font>sPedaco<font color="#808080">,</font>sChave<font color="#808080">)=</font>equal <font color="#0000FF">THEN
        </font>bret<font color="#808080">:=</font>TRUE<font color="#808080">;
     </font><font color="#0000FF">END</font><font color="#808080">;
     </font>nCont<font color="#808080">:=</font>nCont<font color="#808080">+</font><font color="#FF0000">1</font><font color="#808080">;
  </font><font color="#0000FF">END</font><font color="#808080">;
</font><font color="#0000FF">END</font><font color="#808080">;
</font><font color="#0000FF">RETURN </font>bret<font color="#808080">;
</font><font color="#0000FF">END </font>strRelativa<font color="#808080">;
(*------------------------------------------------------------------------------
Calcula o modulo11 de um valor qualquer.
svalor - a String com o n&uacute;mero a ser calculado
ndig - d&iacute;gito do valor a ser calculado
retorna - o d&iacute;gito correto
------------------------------------------------------------------------------*)
</font><font color="#0000FF">PROCEDURE </font>modulo11<font color="#808080">(</font>svalor<font color="#808080">: </font>String<font color="#808080">; </font>ndig<font color="#808080">: </font><font color="#0000FF">INTEGER</font><font color="#808080">): </font><font color="#0000FF">INTEGER</font><font color="#808080">;
</font><font color="#0000FF">VAR </font>nsoma<font color="#808080">, </font>nvalor<font color="#808080">, </font>npos<font color="#808080">: </font><font color="#0000FF">INTEGER</font><font color="#808080">;
    </font>ncont<font color="#808080">: </font><font color="#0000FF">CARDINAL</font><font color="#808080">; 
    </font>sres<font color="#808080">, </font>slocal<font color="#808080">: </font>String<font color="#808080">;
    </font>nStatus<font color="#808080">: </font>ConvResults<font color="#808080">;
</font><font color="#0000FF">BEGIN
 </font>ncont<font color="#808080">:=</font><font color="#FF0000">1</font><font color="#808080">;
 </font><font color="#0000FF">WHILE </font>ncont <font color="#808080">&lt;= </font><font color="#FF0000">11 </font><font color="#0000FF">DO
   </font>slocal<font color="#808080">:=</font>Ss<font color="#808080">(</font>copy<font color="#808080">(</font>svalor<font color="#808080">,</font>ncont<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">), </font>slocal<font color="#808080">);
   </font>ncont<font color="#808080">:=</font>ncont<font color="#808080">+</font><font color="#FF0000">1</font><font color="#808080">;
 </font><font color="#0000FF">END</font><font color="#808080">;
 </font>nsoma<font color="#808080">:=</font><font color="#FF0000">0</font><font color="#808080">;
 </font><font color="#0000FF">IF </font>ndig<font color="#808080">=</font><font color="#FF0000">1 </font><font color="#0000FF">THEN
   </font>ncont<font color="#808080">:=</font><font color="#FF0000">3
 </font><font color="#0000FF">ELSE
   </font>ncont<font color="#808080">:=</font><font color="#FF0000">2</font><font color="#808080">;
 </font><font color="#0000FF">END</font><font color="#808080">;
 </font>npos<font color="#808080">:=</font><font color="#FF0000">2</font><font color="#808080">;
 </font><font color="#0000FF">WHILE </font>ncont <font color="#808080">&lt;= </font><font color="#FF0000">11 </font><font color="#0000FF">DO
   </font>sres<font color="#808080">:=</font>copy<font color="#808080">(</font>slocal<font color="#808080">,</font>ncont<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">);
   </font>StrToInt<font color="#808080">(</font>sres<font color="#808080">, </font>nvalor<font color="#808080">, </font>nStatus<font color="#808080">);
   </font>nsoma<font color="#808080">:=</font>nsoma <font color="#808080">+ (</font>nvalor <font color="#808080">* </font>npos<font color="#808080">);
   </font>ncont<font color="#808080">:=</font>ncont<font color="#808080">+</font><font color="#FF0000">1</font><font color="#808080">;
   </font>npos<font color="#808080">:=</font>npos<font color="#808080">+</font><font color="#FF0000">1</font><font color="#808080">;
 </font><font color="#0000FF">END</font><font color="#808080">;
 </font>nsoma<font color="#808080">:=(</font><font color="#FF0000">11 </font><font color="#808080">- (</font>nsoma <font color="#0000FF">MOD </font><font color="#FF0000">11</font><font color="#808080">));

 </font><font color="#0000FF">IF </font>nsoma <font color="#808080">&gt; </font><font color="#FF0000">9 </font><font color="#0000FF">THEN
   RETURN </font><font color="#FF0000">0
 </font><font color="#0000FF">ELSE
   RETURN </font>nsoma<font color="#808080">;
 </font><font color="#0000FF">END</font><font color="#808080">;
</font><font color="#0000FF">END </font>modulo11<font color="#808080">;
(*------------------------------------------------------------------------------
Valida&ccedil;&atilde;o de um n&uacute;mero de CPF qualquer.
cpf - a String com o n&uacute;mero do CPF
retorna - se &eacute; valido ou n&atilde;o
------------------------------------------------------------------------------*)
</font><font color="#0000FF">PROCEDURE </font>validaCPF<font color="#808080">(</font>cpf<font color="#808080">: </font>String<font color="#808080">): </font><font color="#0000FF">BOOLEAN</font><font color="#808080">;
</font><font color="#0000FF">VAR </font>scpf<font color="#808080">, </font>sres<font color="#808080">: </font>String<font color="#808080">;
    </font>nvalor1<font color="#808080">, </font>nvalor2<font color="#808080">: </font><font color="#0000FF">INTEGER</font><font color="#808080">;
    </font>nStatus<font color="#808080">: </font>ConvResults<font color="#808080">;
</font><font color="#0000FF">BEGIN
IF </font><font color="#808080">(</font>Length<font color="#808080">(</font>cpf<font color="#808080">)=</font><font color="#FF0000">14</font><font color="#808080">) </font><font color="#0000FF">THEN   
  </font>scpf<font color="#808080">:=</font>Ss<font color="#808080">(</font>Ss<font color="#808080">(</font>Ss<font color="#808080">(</font>copy<font color="#808080">(</font>cpf<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#FF0000">3</font><font color="#808080">),</font>copy<font color="#808080">(</font>cpf<font color="#808080">,</font><font color="#FF0000">5</font><font color="#808080">,</font><font color="#FF0000">3</font><font color="#808080">)),</font>copy<font color="#808080">(</font>cpf<font color="#808080">,</font><font color="#FF0000">9</font><font color="#808080">,</font><font color="#FF0000">3</font><font color="#808080">)),</font>copy<font color="#808080">(</font>cpf<font color="#808080">,</font><font color="#FF0000">13</font><font color="#808080">,</font><font color="#FF0000">2</font><font color="#808080">));
  </font>sres<font color="#808080">:=</font>copy<font color="#808080">(</font>cpf<font color="#808080">,</font><font color="#FF0000">13</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">);
  </font>StrToInt<font color="#808080">(</font>sres<font color="#808080">, </font>nvalor1<font color="#808080">, </font>nStatus<font color="#808080">);
  </font>sres<font color="#808080">:=</font>copy<font color="#808080">(</font>cpf<font color="#808080">,</font><font color="#FF0000">14</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">);
  </font>StrToInt<font color="#808080">(</font>sres<font color="#808080">, </font>nvalor2<font color="#808080">, </font>nStatus<font color="#808080">);
  </font><font color="#0000FF">IF </font><font color="#808080">((</font>modulo11<font color="#808080">(</font>scpf<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">)=</font>nvalor1<font color="#808080">) </font><font color="#0000FF">AND </font><font color="#808080">(</font>modulo11<font color="#808080">(</font>scpf<font color="#808080">,</font><font color="#FF0000">2</font><font color="#808080">)=</font>nvalor2<font color="#808080">)) </font><font color="#0000FF">THEN
    RETURN </font>TRUE<font color="#808080">;
  </font><font color="#0000FF">ELSE
    RETURN </font>FALSE<font color="#808080">;
  </font><font color="#0000FF">END</font><font color="#808080">;
</font><font color="#0000FF">ELSE
  RETURN </font>FALSE<font color="#808080">;
</font><font color="#0000FF">END</font><font color="#808080">;
</font><font color="#0000FF">END </font>validaCPF<font color="#808080">;
(*------------------------------------------------------------------------------
Valida&ccedil;&atilde;o de um n&uacute;mero ISBN qualquer.
isbn - a String com o n&uacute;mero do ISBN
retorna - se &eacute; valido ou n&atilde;o
------------------------------------------------------------------------------*)
</font><font color="#0000FF">PROCEDURE </font>validaISBN<font color="#808080">(</font>isbn<font color="#808080">: </font>String<font color="#808080">): </font><font color="#0000FF">BOOLEAN</font><font color="#808080">;
</font><font color="#0000FF">VAR </font>sisbn<font color="#808080">, </font>snum<font color="#808080">, </font>sdigito<font color="#808080">: </font>String<font color="#808080">;
    </font>ncont<font color="#808080">, </font>nvalor<font color="#808080">, </font>nsoma<font color="#808080">: </font><font color="#0000FF">CARDINAL</font><font color="#808080">;
    </font>nStatus<font color="#808080">: </font>ConvResults<font color="#808080">;
</font><font color="#0000FF">BEGIN
IF </font><font color="#808080">(</font>Length<font color="#808080">(</font>isbn<font color="#808080">)=</font><font color="#FF0000">13</font><font color="#808080">) </font><font color="#0000FF">THEN
  </font>sdigito <font color="#808080">:= </font>copy<font color="#808080">(</font>isbn<font color="#808080">, </font>Length<font color="#808080">(</font>isbn<font color="#808080">), </font><font color="#FF0000">1</font><font color="#808080">);
  </font>sisbn<font color="#808080">:=</font><font color="#800000">''</font><font color="#808080">;
  </font><font color="#0000FF">FOR </font>ncont<font color="#808080">:=</font><font color="#FF0000">1 </font><font color="#0000FF">TO </font>Length<font color="#808080">(</font>isbn<font color="#808080">)-</font><font color="#FF0000">1 </font><font color="#0000FF">DO
    IF </font><font color="#808080">(</font>Compare<font color="#808080">(</font>copy<font color="#808080">(</font>isbn<font color="#808080">,</font>ncont<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">),</font><font color="#800000">'-'</font><font color="#808080">)&lt;&gt;</font>equal<font color="#808080">) </font><font color="#0000FF">THEN
      </font>Append<font color="#808080">(</font>copy<font color="#808080">(</font>isbn<font color="#808080">,</font>ncont<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">), </font>sisbn<font color="#808080">);
    </font><font color="#0000FF">END</font><font color="#808080">;
  </font><font color="#0000FF">END</font><font color="#808080">;
  </font><font color="#0000FF">IF </font>Compare<font color="#808080">(</font>sdigito<font color="#808080">, </font><font color="#800000">'X'</font><font color="#808080">)=</font>equal <font color="#0000FF">THEN
    </font>nsoma <font color="#808080">:= </font><font color="#FF0000">10
  </font><font color="#0000FF">ELSE
    </font>StrToCard<font color="#808080">(</font>sdigito<font color="#808080">, </font>nvalor<font color="#808080">, </font>nStatus<font color="#808080">);
    </font>nsoma <font color="#808080">:= </font>nvalor<font color="#808080">;
  </font><font color="#0000FF">END</font><font color="#808080">;
  </font><font color="#0000FF">FOR </font>ncont<font color="#808080">:=</font><font color="#FF0000">1 </font><font color="#0000FF">TO </font><font color="#FF0000">9 </font><font color="#0000FF">DO
    </font>snum<font color="#808080">:=</font>copy<font color="#808080">(</font>sisbn<font color="#808080">, </font>ncont<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">);
    </font>StrToCard<font color="#808080">(</font>snum<font color="#808080">, </font>nvalor<font color="#808080">, </font>nStatus<font color="#808080">);
    </font>nsoma<font color="#808080">:=</font>nsoma <font color="#808080">+ (</font>nvalor <font color="#808080">* (</font><font color="#FF0000">11 </font><font color="#808080">- </font>ncont<font color="#808080">));
  </font><font color="#0000FF">END</font><font color="#808080">;
  </font><font color="#0000FF">IF </font><font color="#808080">(</font>nsoma <font color="#0000FF">MOD </font><font color="#FF0000">11</font><font color="#808080">) = </font><font color="#FF0000">0 </font><font color="#0000FF">THEN
    RETURN </font>TRUE<font color="#808080">;
  </font><font color="#0000FF">ELSE
    RETURN </font>FALSE<font color="#808080">;
  </font><font color="#0000FF">END</font><font color="#808080">;
</font><font color="#0000FF">ELSE
  RETURN </font>FALSE<font color="#808080">;
</font><font color="#0000FF">END</font><font color="#808080">;
</font><font color="#0000FF">END </font>validaISBN<font color="#808080">;
(*------------------------------------------------------------------------------
Esconde a digita&ccedil;&atilde;o da senha
retorna - a senha digitada
------------------------------------------------------------------------------*)
</font><font color="#0000FF">PROCEDURE </font>digitaSenha<font color="#808080">(</font>sRotulo<font color="#808080">: </font>String<font color="#808080">; </font>nTamSenha<font color="#808080">: </font><font color="#0000FF">INTEGER</font><font color="#808080">): </font>String<font color="#808080">;
</font><font color="#0000FF">VAR </font>sSenha<font color="#808080">: </font>String<font color="#808080">;
    </font>sLetra<font color="#808080">: </font><font color="#0000FF">CHAR</font><font color="#808080">;
    </font>ncont<font color="#808080">: </font><font color="#0000FF">INTEGER</font><font color="#808080">;
</font><font color="#0000FF">BEGIN
  </font>WriteString<font color="#808080">(</font>sRotulo<font color="#808080">);
  </font>ncont <font color="#808080">:= </font><font color="#FF0000">0</font><font color="#808080">;
  </font>sSenha<font color="#808080">:=</font><font color="#800000">''</font><font color="#808080">;
  </font>sLetra<font color="#808080">:=</font>nul<font color="#808080">;
  </font><font color="#0000FF">WHILE </font><font color="#808080">((</font>sLetra<font color="#808080">&lt;&gt;</font>lf<font color="#808080">) </font><font color="#0000FF">AND </font><font color="#808080">(</font>ncont <font color="#808080">&lt; </font>nTamSenha<font color="#808080">)) </font><font color="#0000FF">DO 
    </font>GetKeyStroke<font color="#808080">(</font>sLetra<font color="#808080">);
    </font><font color="#0000FF">IF </font>sLetra<font color="#808080">&lt;&gt;</font>lf <font color="#0000FF">THEN
       </font>sSenha<font color="#808080">[</font>ncont<font color="#808080">]:=</font>sLetra<font color="#808080">;
    </font><font color="#0000FF">END</font><font color="#808080">;
    </font>ncont<font color="#808080">:=</font>ncont<font color="#808080">+</font><font color="#FF0000">1</font><font color="#808080">;
  </font><font color="#0000FF">END</font><font color="#808080">;
  </font>sSenha<font color="#808080">[</font>ncont<font color="#808080">-</font><font color="#FF0000">1</font><font color="#808080">]:=</font>nul<font color="#808080">;
  </font>WriteLn<font color="#808080">;
  </font><font color="#0000FF">RETURN </font>sSenha<font color="#808080">;
</font><font color="#0000FF">END </font>digitaSenha<font color="#808080">;
(*------------------------------------------------------------------------------
Valida&ccedil;&atilde;o de um n&uacute;mero qualquer.
sRotulo - o texto antes de se digitar o n&uacute;mero
sNumero - a String com o valor do n&uacute;mero
retorna - o sNumero
------------------------------------------------------------------------------*)
</font><font color="#0000FF">PROCEDURE </font>validaNumero<font color="#808080">(</font>sRotulo<font color="#808080">, </font>sNumero<font color="#808080">: </font>String<font color="#808080">): </font>String<font color="#808080">;
</font><font color="#0000FF">VAR </font>nnum<font color="#808080">: </font><font color="#0000FF">REAL</font><font color="#808080">;
    </font>nStatus<font color="#808080">: </font>ConvResults<font color="#808080">;
    </font>bQuebra<font color="#808080">: </font><font color="#0000FF">BOOLEAN</font><font color="#808080">;
</font><font color="#0000FF">BEGIN
</font>bQuebra<font color="#808080">:=</font>FALSE<font color="#808080">;
</font><font color="#0000FF">WHILE </font><font color="#808080">(</font>bQuebra<font color="#808080">=</font>FALSE<font color="#808080">) </font><font color="#0000FF">DO 
  </font>WriteString<font color="#808080">(</font>sRotulo<font color="#808080">);
  </font>ReadLinha<font color="#808080">(</font>sNumero<font color="#808080">);
  </font>StrToReal<font color="#808080">(</font>sNumero<font color="#808080">,</font>nnum<font color="#808080">,</font>nStatus<font color="#808080">);
  </font><font color="#0000FF">IF </font>nStatus<font color="#808080">=</font>strAllRight <font color="#0000FF">THEN
    IF </font><font color="#808080">(</font>nnum <font color="#808080">&lt; </font><font color="#FF0000">0</font>.01<font color="#808080">) </font><font color="#0000FF">THEN
       </font>WriteLinha<font color="#808080">(</font>MSG_NUMINV<font color="#808080">);
    </font><font color="#0000FF">ELSE
       </font>bQuebra<font color="#808080">:=</font>TRUE<font color="#808080">;
    </font><font color="#0000FF">END</font><font color="#808080">;
  </font><font color="#0000FF">ELSE
    </font>WriteLinha<font color="#808080">(</font>MSG_NUMINV<font color="#808080">);
  </font><font color="#0000FF">END</font><font color="#808080">;
</font><font color="#0000FF">END</font><font color="#808080">;
</font><font color="#0000FF">RETURN </font>sNumero<font color="#808080">;
</font><font color="#0000FF">END </font>validaNumero<font color="#808080">;
(*------------------------------------------------------------------------------
Valida&ccedil;&atilde;o de uma data ou data/hora qualquer.
sRotulo - o texto antes de se digitar a data/hora
sDataHora - a String com o valor da data/hora
bSoData - indica se vai validar somente uma data sem a hora
retorna - a sDataHora
------------------------------------------------------------------------------*)
</font><font color="#0000FF">PROCEDURE </font>validaDataHora<font color="#808080">(</font>sRotulo<font color="#808080">, </font>sDataHora<font color="#808080">: </font>String<font color="#808080">; </font>bSoData<font color="#808080">: </font><font color="#0000FF">BOOLEAN</font><font color="#808080">): </font>String<font color="#808080">;
</font><font color="#0000FF">VAR </font>bvalida<font color="#808080">, </font>bdatavalida<font color="#808080">, </font>bhoravalida<font color="#808080">: </font><font color="#0000FF">BOOLEAN</font><font color="#808080">;
    </font>sdia<font color="#808080">, </font>smes<font color="#808080">, </font>sano<font color="#808080">, </font>shora<font color="#808080">, </font>smin<font color="#808080">, </font>sseg<font color="#808080">: </font>String<font color="#808080">;
    </font>ndia<font color="#808080">, </font>nmes<font color="#808080">, </font>nano<font color="#808080">, </font>nhora<font color="#808080">, </font>nmin<font color="#808080">, </font>nseg<font color="#808080">, </font>nudiames<font color="#808080">: </font><font color="#0000FF">INTEGER</font><font color="#808080">;
    </font>ntam<font color="#808080">: </font><font color="#0000FF">CARDINAL</font><font color="#808080">;
    </font>nStatus<font color="#808080">: </font>ConvResults<font color="#808080">;
</font><font color="#0000FF">BEGIN
</font>bvalida<font color="#808080">:=</font>FALSE<font color="#808080">;
</font>bdatavalida<font color="#808080">:=</font>FALSE<font color="#808080">;
</font>bhoravalida<font color="#808080">:=</font>FALSE<font color="#808080">;
</font>nudiames<font color="#808080">:=</font><font color="#FF0000">0</font><font color="#808080">;

</font><font color="#0000FF">IF </font>bSoData<font color="#808080">=</font>TRUE <font color="#0000FF">THEN </font>ntam<font color="#808080">:=</font><font color="#FF0000">10</font><font color="#808080">;
</font><font color="#0000FF">ELSE </font>ntam<font color="#808080">:=</font><font color="#FF0000">19</font><font color="#808080">;
</font><font color="#0000FF">END</font><font color="#808080">;
</font><font color="#0000FF">WHILE </font><font color="#808080">(</font>bvalida<font color="#808080">=</font>FALSE<font color="#808080">) </font><font color="#0000FF">DO 
  </font>WriteString<font color="#808080">(</font>sRotulo<font color="#808080">);
  </font>ReadLinha<font color="#808080">(</font>sDataHora<font color="#808080">);
  </font><font color="#0000FF">IF </font>Length<font color="#808080">(</font>sDataHora<font color="#808080">)=</font>ntam <font color="#0000FF">THEN 
    </font>sdia<font color="#808080">:=</font>copy<font color="#808080">(</font>sDataHora<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#FF0000">2</font><font color="#808080">);
    </font>StrToInt<font color="#808080">(</font>sdia<font color="#808080">, </font>ndia<font color="#808080">, </font>nStatus<font color="#808080">);
    </font>smes<font color="#808080">:=</font>copy<font color="#808080">(</font>sDataHora<font color="#808080">,</font><font color="#FF0000">4</font><font color="#808080">,</font><font color="#FF0000">2</font><font color="#808080">);
    </font>StrToInt<font color="#808080">(</font>smes<font color="#808080">, </font>nmes<font color="#808080">, </font>nStatus<font color="#808080">);
    </font>sano<font color="#808080">:=</font>copy<font color="#808080">(</font>sDataHora<font color="#808080">,</font><font color="#FF0000">7</font><font color="#808080">,</font><font color="#FF0000">4</font><font color="#808080">);
    </font>StrToInt<font color="#808080">(</font>sano<font color="#808080">, </font>nano<font color="#808080">, </font>nStatus<font color="#808080">);
  
    </font><font color="#0000FF">IF </font><font color="#808080">(</font>nano <font color="#808080">&gt;= </font><font color="#FF0000">1</font><font color="#808080">) </font><font color="#0000FF">AND </font><font color="#808080">(</font>nano <font color="#808080">&lt;= </font><font color="#FF0000">9999</font><font color="#808080">) </font><font color="#0000FF">THEN 
      IF </font><font color="#808080">(</font>nmes <font color="#808080">&gt;= </font><font color="#FF0000">1</font><font color="#808080">) </font><font color="#0000FF">AND </font><font color="#808080">(</font>nmes <font color="#808080">&lt;= </font><font color="#FF0000">31</font><font color="#808080">) </font><font color="#0000FF">THEN 
          CASE </font>nmes <font color="#0000FF">OF
          </font><font color="#808080">| </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">, </font><font color="#FF0000">5</font><font color="#808080">, </font><font color="#FF0000">7</font><font color="#808080">, </font><font color="#FF0000">8</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">, </font><font color="#FF0000">12</font><font color="#808080">: </font>nudiames<font color="#808080">:=</font><font color="#FF0000">31</font><font color="#808080">;
          | </font><font color="#FF0000">2</font><font color="#808080">: (* ano bissexto *)
               </font><font color="#0000FF">IF </font><font color="#808080">(</font>nano <font color="#0000FF">MOD </font><font color="#FF0000">4</font><font color="#808080">)=</font><font color="#FF0000">0 </font><font color="#0000FF">THEN </font>nudiames<font color="#808080">:=</font><font color="#FF0000">29</font><font color="#808080">;
               </font><font color="#0000FF">ELSE </font>nudiames<font color="#808080">:=</font><font color="#FF0000">28</font><font color="#808080">;
               </font><font color="#0000FF">END</font><font color="#808080">;
          | </font><font color="#FF0000">4</font><font color="#808080">, </font><font color="#FF0000">6</font><font color="#808080">, </font><font color="#FF0000">9</font><font color="#808080">, </font><font color="#FF0000">11</font><font color="#808080">: </font>nudiames<font color="#808080">:=</font><font color="#FF0000">30</font><font color="#808080">;
          </font><font color="#0000FF">END</font><font color="#808080">;
          </font><font color="#0000FF">IF </font><font color="#808080">(</font>ndia <font color="#808080">&gt;=</font><font color="#FF0000">1</font><font color="#808080">) </font><font color="#0000FF">AND </font><font color="#808080">(</font>ndia <font color="#808080">&lt;=</font>nudiames<font color="#808080">) </font><font color="#0000FF">THEN
             </font>bdatavalida<font color="#808080">:=</font>TRUE<font color="#808080">;
          </font><font color="#0000FF">END</font><font color="#808080">;
      </font><font color="#0000FF">END</font><font color="#808080">;
    </font><font color="#0000FF">END</font><font color="#808080">;
  
    </font><font color="#0000FF">IF </font>bSoData <font color="#0000FF">THEN 
       IF </font>bdatavalida <font color="#0000FF">THEN </font>bvalida<font color="#808080">:=</font>TRUE<font color="#808080">;
       </font><font color="#0000FF">ELSE </font>WriteLinha<font color="#808080">(</font>MSG_DATAINV<font color="#808080">);
       </font><font color="#0000FF">END</font><font color="#808080">;
    </font><font color="#0000FF">ELSE 
      IF </font>bdatavalida <font color="#0000FF">THEN 
          </font>shora<font color="#808080">:=</font>copy<font color="#808080">(</font>sDataHora<font color="#808080">,</font><font color="#FF0000">12</font><font color="#808080">,</font><font color="#FF0000">2</font><font color="#808080">);
          </font>StrToInt<font color="#808080">(</font>shora<font color="#808080">, </font>nhora<font color="#808080">, </font>nStatus<font color="#808080">);
          </font>smin<font color="#808080">:=</font>copy<font color="#808080">(</font>sDataHora<font color="#808080">,</font><font color="#FF0000">15</font><font color="#808080">,</font><font color="#FF0000">2</font><font color="#808080">);
          </font>StrToInt<font color="#808080">(</font>smin<font color="#808080">, </font>nmin<font color="#808080">, </font>nStatus<font color="#808080">);
          </font>sseg<font color="#808080">:=</font>copy<font color="#808080">(</font>sDataHora<font color="#808080">,</font><font color="#FF0000">18</font><font color="#808080">,</font><font color="#FF0000">2</font><font color="#808080">);
          </font>StrToInt<font color="#808080">(</font>sseg<font color="#808080">, </font>nseg<font color="#808080">, </font>nStatus<font color="#808080">);
  
          </font><font color="#0000FF">IF </font><font color="#808080">(</font>nhora <font color="#808080">&gt;= </font><font color="#FF0000">0</font><font color="#808080">) </font><font color="#0000FF">AND </font><font color="#808080">(</font>nhora <font color="#808080">&lt;= </font><font color="#FF0000">23</font><font color="#808080">) </font><font color="#0000FF">THEN 
            IF </font><font color="#808080">(</font>nmin <font color="#808080">&gt;= </font><font color="#FF0000">0</font><font color="#808080">) </font><font color="#0000FF">AND </font><font color="#808080">(</font>nmin <font color="#808080">&lt;= </font><font color="#FF0000">59</font><font color="#808080">) </font><font color="#0000FF">THEN 
              IF </font><font color="#808080">(</font>nseg <font color="#808080">&gt;= </font><font color="#FF0000">0</font><font color="#808080">) </font><font color="#0000FF">AND </font><font color="#808080">(</font>nseg <font color="#808080">&lt;= </font><font color="#FF0000">59</font><font color="#808080">) </font><font color="#0000FF">THEN
                 </font>bhoravalida<font color="#808080">:=</font>TRUE<font color="#808080">;
              </font><font color="#0000FF">END</font><font color="#808080">;
            </font><font color="#0000FF">END</font><font color="#808080">;
          </font><font color="#0000FF">END</font><font color="#808080">;
  
          </font><font color="#0000FF">IF </font>bhoravalida <font color="#0000FF">THEN </font>bvalida<font color="#808080">:=</font>TRUE<font color="#808080">;
          </font><font color="#0000FF">ELSE </font>WriteLinha<font color="#808080">(</font>MSG_DTHRINV<font color="#808080">);
          </font><font color="#0000FF">END</font><font color="#808080">;
      </font><font color="#0000FF">ELSE
        </font>WriteLinha<font color="#808080">(</font>MSG_DTHRINV<font color="#808080">);
      </font><font color="#0000FF">END</font><font color="#808080">;
    </font><font color="#0000FF">END</font><font color="#808080">;
  </font><font color="#0000FF">ELSE 
    IF </font>bSoData<font color="#808080">=</font>TRUE <font color="#0000FF">THEN </font>WriteLinha<font color="#808080">(</font>MSG_DATAINV<font color="#808080">);
    </font><font color="#0000FF">ELSE </font>WriteLinha<font color="#808080">(</font>MSG_DTHRINV<font color="#808080">);
    </font><font color="#0000FF">END</font><font color="#808080">; 
  </font><font color="#0000FF">END</font><font color="#808080">;
</font><font color="#0000FF">END</font><font color="#808080">;
</font><font color="#0000FF">RETURN </font>sDataHora<font color="#808080">;
</font><font color="#0000FF">END </font>validaDataHora<font color="#808080">;
(*------------------------------------------------------------------------------
Retorna a Data e a hora do sistema.
retorna - a data e a hora
------------------------------------------------------------------------------*)
</font><font color="#0000FF">PROCEDURE </font>retDataHora<font color="#808080">(): </font>String<font color="#808080">;
</font><font color="#0000FF">VAR </font>datahora<font color="#808080">: </font>DateTime<font color="#808080">;
    </font>dia<font color="#808080">,</font>mes<font color="#808080">,</font>ano<font color="#808080">,</font>hora<font color="#808080">,</font>strdh<font color="#808080">: </font>String<font color="#808080">; 
</font><font color="#0000FF">BEGIN
  </font>GetClock<font color="#808080">(</font>datahora<font color="#808080">);
  </font>StructTimeToAscii<font color="#808080">(</font>strdh<font color="#808080">,</font>datahora<font color="#808080">);
  </font>dia<font color="#808080">:=</font>copy<font color="#808080">(</font>strdh<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">,</font><font color="#FF0000">2</font><font color="#808080">);
  </font>mes<font color="#808080">:=</font>copy<font color="#808080">(</font>strdh<font color="#808080">,</font><font color="#FF0000">6</font><font color="#808080">,</font><font color="#FF0000">3</font><font color="#808080">);
  </font>ano<font color="#808080">:=</font>copy<font color="#808080">(</font>strdh<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#FF0000">4</font><font color="#808080">);
  </font>hora<font color="#808080">:=</font>copy<font color="#808080">(</font>strdh<font color="#808080">,</font><font color="#FF0000">13</font><font color="#808080">,</font><font color="#FF0000">8</font><font color="#808080">);
  
  </font><font color="#0000FF">IF </font>Compare<font color="#808080">(</font>mes<font color="#808080">,&quot;</font>Jan<font color="#808080">&quot;)=</font>equal <font color="#0000FF">THEN </font>mes<font color="#808080">:=&quot;</font><font color="#FF0000">01</font><font color="#808080">&quot;;
  </font><font color="#0000FF">ELSIF </font>Compare<font color="#808080">(</font>mes<font color="#808080">,&quot;</font>Feb<font color="#808080">&quot;)=</font>equal <font color="#0000FF">THEN </font>mes<font color="#808080">:=&quot;</font><font color="#FF0000">02</font><font color="#808080">&quot;;
  </font><font color="#0000FF">ELSIF </font>Compare<font color="#808080">(</font>mes<font color="#808080">,&quot;</font>Mar<font color="#808080">&quot;)=</font>equal <font color="#0000FF">THEN </font>mes<font color="#808080">:=&quot;</font><font color="#FF0000">03</font><font color="#808080">&quot;;
  </font><font color="#0000FF">ELSIF </font>Compare<font color="#808080">(</font>mes<font color="#808080">,&quot;</font>Apr<font color="#808080">&quot;)=</font>equal <font color="#0000FF">THEN </font>mes<font color="#808080">:=&quot;</font><font color="#FF0000">04</font><font color="#808080">&quot;;
  </font><font color="#0000FF">ELSIF </font>Compare<font color="#808080">(</font>mes<font color="#808080">,&quot;</font>May<font color="#808080">&quot;)=</font>equal <font color="#0000FF">THEN </font>mes<font color="#808080">:=&quot;</font><font color="#FF0000">05</font><font color="#808080">&quot;;
  </font><font color="#0000FF">ELSIF </font>Compare<font color="#808080">(</font>mes<font color="#808080">,&quot;</font>Jun<font color="#808080">&quot;)=</font>equal <font color="#0000FF">THEN </font>mes<font color="#808080">:=&quot;</font><font color="#FF0000">06</font><font color="#808080">&quot;;
  </font><font color="#0000FF">ELSIF </font>Compare<font color="#808080">(</font>mes<font color="#808080">,&quot;</font>Jul<font color="#808080">&quot;)=</font>equal <font color="#0000FF">THEN </font>mes<font color="#808080">:=&quot;</font><font color="#FF0000">07</font><font color="#808080">&quot;;
  </font><font color="#0000FF">ELSIF </font>Compare<font color="#808080">(</font>mes<font color="#808080">,&quot;</font>Aug<font color="#808080">&quot;)=</font>equal <font color="#0000FF">THEN </font>mes<font color="#808080">:=&quot;</font><font color="#FF0000">08</font><font color="#808080">&quot;;
  </font><font color="#0000FF">ELSIF </font>Compare<font color="#808080">(</font>mes<font color="#808080">,&quot;</font>Sep<font color="#808080">&quot;)=</font>equal <font color="#0000FF">THEN </font>mes<font color="#808080">:=&quot;</font><font color="#FF0000">09</font><font color="#808080">&quot;;
  </font><font color="#0000FF">ELSIF </font>Compare<font color="#808080">(</font>mes<font color="#808080">,&quot;</font>Oct<font color="#808080">&quot;)=</font>equal <font color="#0000FF">THEN </font>mes<font color="#808080">:=&quot;</font><font color="#FF0000">10</font><font color="#808080">&quot;;
  </font><font color="#0000FF">ELSIF </font>Compare<font color="#808080">(</font>mes<font color="#808080">,&quot;</font>Nov<font color="#808080">&quot;)=</font>equal <font color="#0000FF">THEN </font>mes<font color="#808080">:=&quot;</font><font color="#FF0000">11</font><font color="#808080">&quot;;
  </font><font color="#0000FF">ELSIF </font>Compare<font color="#808080">(</font>mes<font color="#808080">,&quot;</font>Dez<font color="#808080">&quot;)=</font>equal <font color="#0000FF">THEN </font>mes<font color="#808080">:=&quot;</font><font color="#FF0000">12</font><font color="#808080">&quot;;
  </font><font color="#0000FF">END</font><font color="#808080">;

  </font>stemp<font color="#808080">[</font><font color="#FF0000">0</font><font color="#808080">]:=</font>zeros<font color="#808080">(</font>trim<font color="#808080">(</font>dia<font color="#808080">),</font><font color="#FF0000">2</font><font color="#808080">);
  </font>stemp<font color="#808080">[</font><font color="#FF0000">1</font><font color="#808080">]:=</font><font color="#800000">'/'</font><font color="#808080">;
  </font>stemp<font color="#808080">[</font><font color="#FF0000">2</font><font color="#808080">]:=</font>zeros<font color="#808080">(</font>trim<font color="#808080">(</font>mes<font color="#808080">),</font><font color="#FF0000">2</font><font color="#808080">);
  </font>stemp<font color="#808080">[</font><font color="#FF0000">3</font><font color="#808080">]:=</font><font color="#800000">'/'</font><font color="#808080">;
  </font>stemp<font color="#808080">[</font><font color="#FF0000">4</font><font color="#808080">]:=</font>zeros<font color="#808080">(</font>trim<font color="#808080">(</font>ano<font color="#808080">),</font><font color="#FF0000">4</font><font color="#808080">);
  </font>stemp<font color="#808080">[</font><font color="#FF0000">5</font><font color="#808080">]:=</font><font color="#800000">' '</font><font color="#808080">;
  </font>stemp<font color="#808080">[</font><font color="#FF0000">6</font><font color="#808080">]:=</font>zeros<font color="#808080">(</font>trim<font color="#808080">(</font>hora<font color="#808080">),</font><font color="#FF0000">2</font><font color="#808080">);

  </font><font color="#0000FF">RETURN </font>SomaStr<font color="#808080">(</font><font color="#FF0000">7</font><font color="#808080">, </font>stemp<font color="#808080">); 
</font><font color="#0000FF">END </font>retDataHora<font color="#808080">;

</font><font color="#0000FF">END </font>Rotinas.
</font>
</code></pre>
</body>
</html>