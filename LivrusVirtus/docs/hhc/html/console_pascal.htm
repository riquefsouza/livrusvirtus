<html>
<head>
<title>Livrus Virtus - Console - Pascal</title>
</head>
<!-- Generated by ConTEXT HTML exporter -->
<body text="#000000" bgcolor="#FFFFFF">
<pre>
<code><font  face="Courier New"><font color="#808080"><i>{------------------------------------------------------------------------------
 Sistema integrante do projeto Livrus Virtus.
 Todos os direitos reservados para Henrique F. de Souza.
 Vers&atilde;o programada na linguagem pascal.
------------------------------------------------------------------------------}
</i></font><font color="#000080"><b>program </b></font>Livrus<font color="#808080">;

</font><font color="#000080"><b>uses </b></font>dos<font color="#808080">, </font>crt<font color="#808080">;

</font><font color="#000080"><b>type
  </b></font>regAssunto <font color="#808080">= </font><font color="#000080"><b>record
   </b></font>codigo<font color="#808080">: </font><font color="#000080"><b>string</b></font><font color="#808080">[</font><font color="#FF0000">10</font><font color="#808080">];
   </font>assunto<font color="#808080">: </font><font color="#000080"><b>string</b></font><font color="#808080">[</font><font color="#FF0000">30</font><font color="#808080">];
  </font><font color="#000080"><b>end</b></font><font color="#808080">;
  </font>regAutor <font color="#808080">= </font><font color="#000080"><b>record
   </b></font>codigo<font color="#808080">: </font><font color="#000080"><b>string</b></font><font color="#808080">[</font><font color="#FF0000">10</font><font color="#808080">];
   </font>autor<font color="#808080">: </font><font color="#000080"><b>string</b></font><font color="#808080">[</font><font color="#FF0000">30</font><font color="#808080">];
  </font><font color="#000080"><b>end</b></font><font color="#808080">;
  </font>regEditora <font color="#808080">= </font><font color="#000080"><b>record
   </b></font>codigo<font color="#808080">: </font><font color="#000080"><b>string</b></font><font color="#808080">[</font><font color="#FF0000">10</font><font color="#808080">];
   </font>editora<font color="#808080">: </font><font color="#000080"><b>string</b></font><font color="#808080">[</font><font color="#FF0000">50</font><font color="#808080">];
  </font><font color="#000080"><b>end</b></font><font color="#808080">;
  </font>regIdioma <font color="#808080">= </font><font color="#000080"><b>record
   </b></font>codigo<font color="#808080">: </font><font color="#000080"><b>string</b></font><font color="#808080">[</font><font color="#FF0000">10</font><font color="#808080">];
   </font>idioma<font color="#808080">: </font><font color="#000080"><b>string</b></font><font color="#808080">[</font><font color="#FF0000">20</font><font color="#808080">];
  </font><font color="#000080"><b>end</b></font><font color="#808080">;
  </font>regUsuario <font color="#808080">= </font><font color="#000080"><b>record
   </b></font>login<font color="#808080">: </font><font color="#000080"><b>string</b></font><font color="#808080">[</font><font color="#FF0000">10</font><font color="#808080">];
   </font>senha<font color="#808080">: </font><font color="#000080"><b>string</b></font><font color="#808080">[</font><font color="#FF0000">10</font><font color="#808080">];
  </font><font color="#000080"><b>end</b></font><font color="#808080">;
  </font>regPais <font color="#808080">= </font><font color="#000080"><b>record
   </b></font>codigo<font color="#808080">: </font><font color="#000080"><b>string</b></font><font color="#808080">[</font><font color="#FF0000">3</font><font color="#808080">];
   </font>pais<font color="#808080">: </font><font color="#000080"><b>string</b></font><font color="#808080">[</font><font color="#FF0000">50</font><font color="#808080">];
  </font><font color="#000080"><b>end</b></font><font color="#808080">;
  </font>regProfissao <font color="#808080">= </font><font color="#000080"><b>record
   </b></font>codigo<font color="#808080">: </font><font color="#000080"><b>string</b></font><font color="#808080">[</font><font color="#FF0000">10</font><font color="#808080">];
   </font>profissao<font color="#808080">: </font><font color="#000080"><b>string</b></font><font color="#808080">[</font><font color="#FF0000">50</font><font color="#808080">];
  </font><font color="#000080"><b>end</b></font><font color="#808080">;
  </font>regLivro <font color="#808080">= </font><font color="#000080"><b>record
   </b></font>isbn<font color="#808080">: </font><font color="#000080"><b>string</b></font><font color="#808080">[</font><font color="#FF0000">13</font><font color="#808080">];
   </font>titulo<font color="#808080">: </font><font color="#000080"><b>string</b></font><font color="#808080">[</font><font color="#FF0000">50</font><font color="#808080">];
   </font>edicao<font color="#808080">: </font><font color="#000080"><b>string</b></font><font color="#808080">[</font><font color="#FF0000">10</font><font color="#808080">];
   </font>anopubli<font color="#808080">: </font><font color="#000080"><b>string</b></font><font color="#808080">[</font><font color="#FF0000">10</font><font color="#808080">];
   </font>codeditora<font color="#808080">: </font><font color="#000080"><b>string</b></font><font color="#808080">[</font><font color="#FF0000">10</font><font color="#808080">];
   </font>volume<font color="#808080">: </font><font color="#000080"><b>string</b></font><font color="#808080">[</font><font color="#FF0000">10</font><font color="#808080">];
   </font>codidioma<font color="#808080">: </font><font color="#000080"><b>string</b></font><font color="#808080">[</font><font color="#FF0000">10</font><font color="#808080">];
   </font>npaginas<font color="#808080">: </font><font color="#000080"><b>string</b></font><font color="#808080">[</font><font color="#FF0000">10</font><font color="#808080">];
   </font>preco<font color="#808080">: </font><font color="#000080"><b>string</b></font><font color="#808080">[</font><font color="#FF0000">10</font><font color="#808080">];
   </font>qtdestoque<font color="#808080">: </font><font color="#000080"><b>string</b></font><font color="#808080">[</font><font color="#FF0000">10</font><font color="#808080">];
  </font><font color="#000080"><b>end</b></font><font color="#808080">;
  </font>regLivroAss <font color="#808080">= </font><font color="#000080"><b>record
   </b></font>isbn<font color="#808080">: </font><font color="#000080"><b>string</b></font><font color="#808080">[</font><font color="#FF0000">13</font><font color="#808080">];
   </font>codassunto<font color="#808080">: </font><font color="#000080"><b>string</b></font><font color="#808080">[</font><font color="#FF0000">10</font><font color="#808080">];
  </font><font color="#000080"><b>end</b></font><font color="#808080">;
  </font>regLivroAut <font color="#808080">= </font><font color="#000080"><b>record
   </b></font>isbn<font color="#808080">: </font><font color="#000080"><b>string</b></font><font color="#808080">[</font><font color="#FF0000">13</font><font color="#808080">];
   </font>codautor<font color="#808080">: </font><font color="#000080"><b>string</b></font><font color="#808080">[</font><font color="#FF0000">10</font><font color="#808080">];
  </font><font color="#000080"><b>end</b></font><font color="#808080">;
  </font>regCliente <font color="#808080">= </font><font color="#000080"><b>record
   </b></font>cpf<font color="#808080">: </font><font color="#000080"><b>string</b></font><font color="#808080">[</font><font color="#FF0000">14</font><font color="#808080">];
   </font>nome<font color="#808080">: </font><font color="#000080"><b>string</b></font><font color="#808080">[</font><font color="#FF0000">30</font><font color="#808080">];
   </font>email<font color="#808080">: </font><font color="#000080"><b>string</b></font><font color="#808080">[</font><font color="#FF0000">30</font><font color="#808080">];
   </font>identidade<font color="#808080">: </font><font color="#000080"><b>string</b></font><font color="#808080">[</font><font color="#FF0000">10</font><font color="#808080">];
   </font>sexo<font color="#808080">: </font><font color="#000080"><b>string</b></font><font color="#808080">[</font><font color="#FF0000">1</font><font color="#808080">];
   </font>telefone<font color="#808080">: </font><font color="#000080"><b>string</b></font><font color="#808080">[</font><font color="#FF0000">17</font><font color="#808080">];
   </font>dtnascimento<font color="#808080">: </font><font color="#000080"><b>string</b></font><font color="#808080">[</font><font color="#FF0000">10</font><font color="#808080">];
   </font>codendereco<font color="#808080">: </font><font color="#000080"><b>string</b></font><font color="#808080">[</font><font color="#FF0000">10</font><font color="#808080">];
   </font>codpais<font color="#808080">: </font><font color="#000080"><b>string</b></font><font color="#808080">[</font><font color="#FF0000">3</font><font color="#808080">];
   </font>codprofissao<font color="#808080">: </font><font color="#000080"><b>string</b></font><font color="#808080">[</font><font color="#FF0000">10</font><font color="#808080">];
  </font><font color="#000080"><b>end</b></font><font color="#808080">;
  </font>regEndereco <font color="#808080">= </font><font color="#000080"><b>record
   </b></font>codigo<font color="#808080">: </font><font color="#000080"><b>string</b></font><font color="#808080">[</font><font color="#FF0000">10</font><font color="#808080">];
   </font>logradouro<font color="#808080">: </font><font color="#000080"><b>string</b></font><font color="#808080">[</font><font color="#FF0000">40</font><font color="#808080">];
   </font>bairro<font color="#808080">: </font><font color="#000080"><b>string</b></font><font color="#808080">[</font><font color="#FF0000">15</font><font color="#808080">];
   </font>cep<font color="#808080">: </font><font color="#000080"><b>string</b></font><font color="#808080">[</font><font color="#FF0000">8</font><font color="#808080">];
   </font>cidade<font color="#808080">: </font><font color="#000080"><b>string</b></font><font color="#808080">[</font><font color="#FF0000">30</font><font color="#808080">];
   </font>estado<font color="#808080">: </font><font color="#000080"><b>string</b></font><font color="#808080">[</font><font color="#FF0000">20</font><font color="#808080">];
  </font><font color="#000080"><b>end</b></font><font color="#808080">;
  </font>regVenda <font color="#808080">= </font><font color="#000080"><b>record
   </b></font>dthrvenda<font color="#808080">: </font><font color="#000080"><b>string</b></font><font color="#808080">[</font><font color="#FF0000">19</font><font color="#808080">];  <i>{ data/hora da venda dd/mm/yyyy hh:mm:ss }
   </i></font>cpf<font color="#808080">: </font><font color="#000080"><b>string</b></font><font color="#808080">[</font><font color="#FF0000">14</font><font color="#808080">];
   </font>isbn<font color="#808080">: </font><font color="#000080"><b>string</b></font><font color="#808080">[</font><font color="#FF0000">13</font><font color="#808080">];
   </font>precovenda<font color="#808080">: </font><font color="#000080"><b>string</b></font><font color="#808080">[</font><font color="#FF0000">10</font><font color="#808080">];
  </font><font color="#000080"><b>end</b></font><font color="#808080">;

  </font>mstring <font color="#808080">= </font><font color="#000080"><b>string</b></font><font color="#808080">[</font><font color="#FF0000">255</font><font color="#808080">];
  </font>tregistro <font color="#808080">= </font><font color="#000080"><b>array</b></font><font color="#808080">[</font><font color="#FF0000">1</font><font color="#808080">..</font><font color="#FF0000">145</font><font color="#808080">] </font><font color="#000080"><b>of </b></font>Char<font color="#808080">;
  </font>ctTipo <font color="#808080">= </font><font color="#000080"><b>set of </b></font><font color="#808080">(</font>opTexto<font color="#808080">, </font>opNumero<font color="#808080">, </font>opData<font color="#808080">, </font>opDataHora<font color="#808080">, </font>opSenha<font color="#808080">);
  </font>ctArqs <font color="#808080">= </font><font color="#000080"><b>set of </b></font><font color="#808080">(</font>opAssunto<font color="#808080">, </font>opAutor<font color="#808080">, </font>opEditora<font color="#808080">, </font>opEndereco<font color="#808080">, </font>opIdioma<font color="#808080">, </font>opPais<font color="#808080">,
                </font>opProfissao<font color="#808080">, </font>opCliente<font color="#808080">, </font>opLivro<font color="#808080">, </font>opLivroAss<font color="#808080">, </font>opLivroAut<font color="#808080">,
                </font>opUsuario<font color="#808080">, </font>opVenda<font color="#808080">);
  </font>ctAcao <font color="#808080">= </font><font color="#000080"><b>set of </b></font><font color="#808080">(</font>opNovo<font color="#808080">, </font>opAlterar<font color="#808080">, </font>opPesquisar<font color="#808080">, </font>opSalvarInclusao<font color="#808080">,
              </font>opSalvarAlteracao<font color="#808080">, </font>opExcluir<font color="#808080">, </font>opConfirmaExclusao<font color="#808080">, </font>opListarTodos<font color="#808080">);
</font><font color="#000080"><b>const
  </b></font>CRLF <font color="#808080">= </font>#13#10<font color="#808080">; <i>{ windows }
  </i></font>TAM_CRLF <font color="#808080">= </font><font color="#FF0000">2</font><font color="#808080">;
<i>{  CRLF = #10;
   TAM_CRLF = 1; } { unix }
{  CRLF = #13;
   TAM_CRLF = 1; } { macintosh }

  </i></font>QTD_MAX_LINHA <font color="#808080">= </font><font color="#FF0000">18</font><font color="#808080">;

  </font>MSG_ERRO <font color="#808080">= </font><font color="#800000">'Erro: op&ccedil;&atilde;o inv&aacute;lida digite de novo'</font><font color="#808080">;
  </font>MSG_OPCAO <font color="#808080">= </font><font color="#800000">'Escolha uma op&ccedil;&atilde;o: '</font><font color="#808080">;
  </font>MSG_PRESS <font color="#808080">= </font><font color="#800000">'pressione para continuar...'</font><font color="#808080">;

  </font>MSG_REGINC <font color="#808080">= </font><font color="#800000">'registro incluido!'</font><font color="#808080">;
  </font>MSG_REGNINC <font color="#808080">= </font><font color="#800000">'registro n&atilde;o incluido!'</font><font color="#808080">;
  </font>MSG_REGALT <font color="#808080">= </font><font color="#800000">'registro alterado!'</font><font color="#808080">;
  </font>MSG_REGNALT <font color="#808080">= </font><font color="#800000">'registro n&atilde;o alterado!'</font><font color="#808080">;
  </font>MSG_REGEXC <font color="#808080">= </font><font color="#800000">'registro excluido!'</font><font color="#808080">;
  </font>MSG_REGNEXC <font color="#808080">= </font><font color="#800000">'registro n&atilde;o excluido!'</font><font color="#808080">;
  </font>MSG_REGEXST <font color="#808080">= </font><font color="#800000">'registro j&aacute; existe!'</font><font color="#808080">;

  </font>MSG_NUMINV <font color="#808080">= </font><font color="#800000">'N&uacute;mero inv&aacute;lido ou menor do que 1!'</font><font color="#808080">;
  </font>MSG_DATAINV <font color="#808080">= </font><font color="#800000">'Data inv&aacute;lida!, formato correto (dd/mm/yyyy)'</font><font color="#808080">;
  </font>MSG_DTHRINV <font color="#808080">= </font><font color="#800000">'Data/hora inv&aacute;lida!, formato correto (dd/mm/yyyy hh:mm:ss)'</font><font color="#808080">;
  </font>MSG_ISBNINV <font color="#808080">= </font><font color="#800000">'ISBN inv&aacute;lido!'</font><font color="#808080">;
  </font>MSG_CPFINV <font color="#808080">= </font><font color="#800000">'CPF inv&aacute;lido!'</font><font color="#808080">;
  </font>MSG_SENCONFERE <font color="#808080">= </font><font color="#800000">'senha n&atilde;o confere com a senha atual!'</font><font color="#808080">;
  </font>MSG_SENCONFIRM <font color="#808080">= </font><font color="#800000">'nova senha n&atilde;o confere com a senha confirmada!'</font><font color="#808080">;
  </font>MSG_LOGINENCON <font color="#808080">= </font><font color="#800000">'login n&atilde;o encontrado!'</font><font color="#808080">;
  </font>MSG_SEMESTOQUE <font color="#808080">= </font><font color="#800000">'livro n&atilde;o existe no estoque!'</font><font color="#808080">;

  </font>ARQ_ASSUNTO <font color="#808080">= </font><font color="#800000">'assunto.dat'</font><font color="#808080">;
  </font>ARQ_AUTOR <font color="#808080">= </font><font color="#800000">'autor.dat'</font><font color="#808080">;
  </font>ARQ_EDITORA <font color="#808080">= </font><font color="#800000">'editora.dat'</font><font color="#808080">;
  </font>ARQ_IDIOMA <font color="#808080">= </font><font color="#800000">'idioma.dat'</font><font color="#808080">;
  </font>ARQ_USUARIO <font color="#808080">= </font><font color="#800000">'usuario.dat'</font><font color="#808080">;
  </font>ARQ_PAIS <font color="#808080">= </font><font color="#800000">'pais.dat'</font><font color="#808080">;
  </font>ARQ_PROFISSAO <font color="#808080">= </font><font color="#800000">'profissao.dat'</font><font color="#808080">;
  </font>ARQ_LIVRO <font color="#808080">= </font><font color="#800000">'livro.dat'</font><font color="#808080">;
  </font>ARQ_LIVASS <font color="#808080">= </font><font color="#800000">'livroass.dat'</font><font color="#808080">;
  </font>ARQ_LIVAUT <font color="#808080">= </font><font color="#800000">'livroaut.dat'</font><font color="#808080">;
  </font>ARQ_CLIENTE <font color="#808080">= </font><font color="#800000">'cliente.dat'</font><font color="#808080">;
  </font>ARQ_ENDERECO <font color="#808080">= </font><font color="#800000">'endereco.dat'</font><font color="#808080">;
  </font>ARQ_VENDA <font color="#808080">= </font><font color="#800000">'venda.dat'</font><font color="#808080">;

  </font>TAM_ASSUNTO <font color="#808080">= </font><font color="#FF0000">40</font><font color="#808080">;
  </font>TAM_AUTOR <font color="#808080">= </font><font color="#FF0000">40</font><font color="#808080">;
  </font>TAM_EDITORA <font color="#808080">= </font><font color="#FF0000">60</font><font color="#808080">;
  </font>TAM_IDIOMA <font color="#808080">= </font><font color="#FF0000">30</font><font color="#808080">;
  </font>TAM_USUARIO <font color="#808080">= </font><font color="#FF0000">20</font><font color="#808080">;
  </font>TAM_PAIS <font color="#808080">= </font><font color="#FF0000">53</font><font color="#808080">;
  </font>TAM_PROFISSAO <font color="#808080">= </font><font color="#FF0000">60</font><font color="#808080">;
  </font>TAM_LIVRO <font color="#808080">= </font><font color="#FF0000">143</font><font color="#808080">;
  </font>TAM_LIVASS <font color="#808080">= </font><font color="#FF0000">23</font><font color="#808080">;
  </font>TAM_LIVAUT <font color="#808080">= </font><font color="#FF0000">23</font><font color="#808080">;
  </font>TAM_CLIENTE <font color="#808080">= </font><font color="#FF0000">135</font><font color="#808080">;
  </font>TAM_ENDERECO <font color="#808080">= </font><font color="#FF0000">123</font><font color="#808080">;
  </font>TAM_VENDA <font color="#808080">= </font><font color="#FF0000">56</font><font color="#808080">;

</font><font color="#000080"><b>var
 </b></font>bopcao<font color="#808080">: </font>boolean<font color="#808080">;
 </font>opmenu<font color="#808080">: </font>char<font color="#808080">;
 </font>g_nPosChave<font color="#808080">, </font>g_nTamChave<font color="#808080">: </font>integer<font color="#808080">;
 </font>g_nPreco<font color="#808080">: </font>double<font color="#808080">;
 </font>g_SalvarInclusao<font color="#808080">: </font>boolean<font color="#808080">;

 </font>tAssunto<font color="#808080">: </font>regAssunto<font color="#808080">;
 </font>tAutor<font color="#808080">: </font>regAutor<font color="#808080">;
 </font>tEditora<font color="#808080">: </font>regEditora<font color="#808080">;
 </font>tIdioma<font color="#808080">: </font>regIdioma<font color="#808080">;
 </font>tEndereco<font color="#808080">: </font>regEndereco<font color="#808080">;
 </font>tPais<font color="#808080">: </font>regPais<font color="#808080">;
 </font>tProfissao<font color="#808080">: </font>regProfissao<font color="#808080">;
 </font>tLivro<font color="#808080">: </font>regLivro<font color="#808080">;
 </font>tLivroAss<font color="#808080">: </font>regLivroAss<font color="#808080">;
 </font>tLivroAut<font color="#808080">: </font>regLivroAut<font color="#808080">;
 </font>tCliente<font color="#808080">: </font>regCliente<font color="#808080">;
 </font>tUsuario<font color="#808080">: </font>regUsuario<font color="#808080">;
 </font>tVenda<font color="#808080">: </font>regVenda<font color="#808080">;

 </font>tfAssunto<font color="#808080">, </font>tfAutor<font color="#808080">, </font>tfEditora<font color="#808080">, </font>tfIdioma<font color="#808080">, </font>tfEndereco<font color="#808080">, </font>tfPais<font color="#808080">, </font>tfProfissao<font color="#808080">,
 </font>tfLivro<font color="#808080">, </font>tfLivroAss<font color="#808080">, </font>tfLivroAut<font color="#808080">, </font>tfCliente<font color="#808080">, </font>tfUsuario<font color="#808080">, </font>tfVenda<font color="#808080">: </font><font color="#000080"><b>File</b></font><font color="#808080">;

<i>{--- Rotinas b&aacute;sicas ---------------------------------------------------------}
</i></font><font color="#000080"><b>function </b></font>trim<font color="#808080">(</font>sTexto<font color="#808080">: </font>mstring<font color="#808080">): </font>mstring<font color="#808080">; </font><font color="#000080"><b>forward</b></font><font color="#808080">;
</font><font color="#000080"><b>function </b></font>repete<font color="#808080">(</font>sTexto<font color="#808080">: </font>mstring<font color="#808080">; </font>nQtd<font color="#808080">: </font>integer<font color="#808080">): </font>mstring<font color="#808080">; </font><font color="#000080"><b>forward</b></font><font color="#808080">;
</font><font color="#000080"><b>function </b></font>esp<font color="#808080">(</font>sTexto<font color="#808080">: </font>mstring<font color="#808080">; </font>nTam<font color="#808080">: </font>integer<font color="#808080">):</font>mstring<font color="#808080">; </font><font color="#000080"><b>forward</b></font><font color="#808080">;
</font><font color="#000080"><b>function </b></font>zeros<font color="#808080">(</font>stexto<font color="#808080">:</font>mstring<font color="#808080">; </font>ntam<font color="#808080">:</font>integer<font color="#808080">): </font>mstring<font color="#808080">; </font><font color="#000080"><b>forward</b></font><font color="#808080">;
</font><font color="#000080"><b>function </b></font>strRelativa<font color="#808080">(</font>sTexto<font color="#808080">, </font>sChave<font color="#808080">: </font>mstring<font color="#808080">):</font>boolean<font color="#808080">; </font><font color="#000080"><b>forward</b></font><font color="#808080">;
</font><font color="#000080"><b>function </b></font>modulo11<font color="#808080">(</font>svalor<font color="#808080">: </font>mstring<font color="#808080">; </font>ndig<font color="#808080">: </font>integer<font color="#808080">):</font>integer<font color="#808080">; </font><font color="#000080"><b>forward</b></font><font color="#808080">;
</font><font color="#000080"><b>function </b></font>validaCPF<font color="#808080">(</font>cpf<font color="#808080">: </font>mstring<font color="#808080">): </font>boolean<font color="#808080">; </font><font color="#000080"><b>forward</b></font><font color="#808080">;
</font><font color="#000080"><b>function </b></font>validaISBN<font color="#808080">(</font>isbn<font color="#808080">: </font>mstring<font color="#808080">): </font>boolean<font color="#808080">; </font><font color="#000080"><b>forward</b></font><font color="#808080">;
</font><font color="#000080"><b>function </b></font>digitaSenha<font color="#808080">(</font>sRotulo<font color="#808080">: </font>mstring<font color="#808080">; </font>nTamSenha<font color="#808080">: </font>integer<font color="#808080">): </font>mstring<font color="#808080">; </font><font color="#000080"><b>forward</b></font><font color="#808080">;
</font><font color="#000080"><b>function </b></font>validaNumero<font color="#808080">(</font>sRotulo<font color="#808080">, </font>sNumero<font color="#808080">: </font>mstring<font color="#808080">): </font>mstring<font color="#808080">; </font><font color="#000080"><b>forward</b></font><font color="#808080">;
</font><font color="#000080"><b>function </b></font>validaDataHora<font color="#808080">(</font>sRotulo<font color="#808080">, </font>sDataHora<font color="#808080">: </font>mstring<font color="#808080">;
         </font>bSoData<font color="#808080">: </font>boolean<font color="#808080">): </font>mstring<font color="#808080">; </font><font color="#000080"><b>forward</b></font><font color="#808080">;
</font><font color="#000080"><b>function </b></font>retDataHora<font color="#808080">: </font>mstring<font color="#808080">; </font><font color="#000080"><b>forward</b></font><font color="#808080">;

<i>{--- Rotinas de manipula&ccedil;&atilde;o de arquivos --------------------------------------}
</i></font><font color="#000080"><b>function </b></font>tamArq<font color="#808080">(</font><font color="#000080"><b>var </b></font>sArq<font color="#808080">: </font><font color="#000080"><b>File</b></font><font color="#808080">): </font>integer<font color="#808080">; </font><font color="#000080"><b>forward</b></font><font color="#808080">;
</font><font color="#000080"><b>procedure </b></font>abrecriaArqs<font color="#808080">(</font>bAbre<font color="#808080">: </font>boolean<font color="#808080">); </font><font color="#000080"><b>forward</b></font><font color="#808080">;
</font><font color="#000080"><b>procedure </b></font>fechaArqs<font color="#808080">; </font><font color="#000080"><b>forward</b></font><font color="#808080">;
</font><font color="#000080"><b>function </b></font>pesqArq<font color="#808080">(</font><font color="#000080"><b>var </b></font>sArq<font color="#808080">: </font><font color="#000080"><b>File</b></font><font color="#808080">; </font>sChave<font color="#808080">: </font>mstring<font color="#808080">; </font>nPosChave<font color="#808080">,
         </font>nTamChave<font color="#808080">, </font>nTamLinha<font color="#808080">: </font>integer<font color="#808080">): </font>mstring<font color="#808080">; </font><font color="#000080"><b>forward</b></font><font color="#808080">;
</font><font color="#000080"><b>procedure </b></font>pesqLinhaExcluida<font color="#808080">(</font><font color="#000080"><b>var </b></font>sArq<font color="#808080">: </font><font color="#000080"><b>File</b></font><font color="#808080">; </font>nTamLinha<font color="#808080">: </font>integer<font color="#808080">); </font><font color="#000080"><b>forward</b></font><font color="#808080">;
</font><font color="#000080"><b>function </b></font>pesqMaxCod<font color="#808080">(</font><font color="#000080"><b>var </b></font>sArq<font color="#808080">: </font><font color="#000080"><b>File</b></font><font color="#808080">; </font>nPosChave<font color="#808080">,
        </font>nTamChave<font color="#808080">, </font>nTamLinha<font color="#808080">: </font>integer<font color="#808080">): </font>mstring<font color="#808080">; </font><font color="#000080"><b>forward</b></font><font color="#808080">;
</font><font color="#000080"><b>procedure </b></font>escreveArq<font color="#808080">(</font><font color="#000080"><b>var </b></font>sArq<font color="#808080">: </font><font color="#000080"><b>File</b></font><font color="#808080">; </font>sTexto<font color="#808080">,
</font>	sMsgAcerto<font color="#808080">, </font>sMsgErro<font color="#808080">: </font>mstring<font color="#808080">); </font><font color="#000080"><b>forward</b></font><font color="#808080">;

<i>{--- Rotinas de implementa&ccedil;&atilde;o do sistema e de interface ----------------------}
</i></font><font color="#000080"><b>function </b></font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">: </font>ctArqs<font color="#808080">): </font>mstring<font color="#808080">; </font><font color="#000080"><b>forward</b></font><font color="#808080">;
</font><font color="#000080"><b>function </b></font>tamReg<font color="#808080">(</font>sreg<font color="#808080">: </font>ctArqs<font color="#808080">): </font>integer<font color="#808080">; </font><font color="#000080"><b>forward</b></font><font color="#808080">;
</font><font color="#000080"><b>function </b></font>rotulo<font color="#808080">(</font>sreg<font color="#808080">: </font>ctArqs<font color="#808080">; </font>nNum<font color="#808080">: </font>integer<font color="#808080">): </font>mstring<font color="#808080">; </font><font color="#000080"><b>forward</b></font><font color="#808080">;
</font><font color="#000080"><b>function </b></font>ContinuaSN<font color="#808080">(</font>nlinha<font color="#808080">, </font>nQtdLinha<font color="#808080">: </font>integer<font color="#808080">): </font>boolean<font color="#808080">; </font><font color="#000080"><b>forward</b></font><font color="#808080">;
</font><font color="#000080"><b>function </b></font>ListarTodos<font color="#808080">(</font><font color="#000080"><b>var </b></font>sArq<font color="#808080">: </font><font color="#000080"><b>File</b></font><font color="#808080">; </font>sreg<font color="#808080">: </font>ctArqs<font color="#808080">; </font>sChave<font color="#808080">: </font>mstring<font color="#808080">;
          </font>nPosChave<font color="#808080">, </font>nTamChave<font color="#808080">, </font>nTamLinha<font color="#808080">, </font>nQtdLinha<font color="#808080">: </font>integer<font color="#808080">;
          </font>bPesqRelativa<font color="#808080">: </font>boolean<font color="#808080">): </font>boolean<font color="#808080">; </font><font color="#000080"><b>forward</b></font><font color="#808080">;
</font><font color="#000080"><b>procedure </b></font>ListarRegLigados<font color="#808080">(</font><font color="#000080"><b>var </b></font>sArq1<font color="#808080">: </font><font color="#000080"><b>File</b></font><font color="#808080">; </font>sreg1<font color="#808080">: </font>ctArqs<font color="#808080">; </font>nPosChave1<font color="#808080">,
          </font>nTamChave1<font color="#808080">, </font>nPosChave2<font color="#808080">, </font>nTamChave2<font color="#808080">: </font>integer<font color="#808080">; </font>sChave<font color="#808080">: </font>mstring<font color="#808080">;
      </font><font color="#000080"><b>var </b></font>sArq2<font color="#808080">: </font><font color="#000080"><b>File</b></font><font color="#808080">; </font>sreg2<font color="#808080">: </font>ctArqs<font color="#808080">; </font>nPosChave3<font color="#808080">, </font>nQtdLinha<font color="#808080">: </font>integer<font color="#808080">); </font><font color="#000080"><b>forward</b></font><font color="#808080">;
</font><font color="#000080"><b>function </b></font>validaEntrada<font color="#808080">(</font><font color="#000080"><b>var </b></font>sArq<font color="#808080">: </font><font color="#000080"><b>File</b></font><font color="#808080">; </font>sreg<font color="#808080">: </font>ctArqs<font color="#808080">; </font>nTexto<font color="#808080">: </font>integer<font color="#808080">;
        </font>sEntrada<font color="#808080">: </font>mstring<font color="#808080">; </font>nTentativas<font color="#808080">: </font>integer<font color="#808080">;
        </font>bPesqRelativa<font color="#808080">: </font>boolean<font color="#808080">; </font>bTipoEntrada<font color="#808080">: </font>ctTipo<font color="#808080">): </font>mstring<font color="#808080">; </font><font color="#000080"><b>forward</b></font><font color="#808080">;
</font><font color="#000080"><b>procedure </b></font>frmSplash<font color="#808080">; </font><font color="#000080"><b>forward</b></font><font color="#808080">;
</font><font color="#000080"><b>procedure </b></font>frmSobre<font color="#808080">; </font><font color="#000080"><b>forward</b></font><font color="#808080">;
</font><font color="#000080"><b>function </b></font>frmLogin<font color="#808080">: </font>boolean<font color="#808080">; </font><font color="#000080"><b>forward</b></font><font color="#808080">;
</font><font color="#000080"><b>procedure </b></font>menu<font color="#808080">(</font>num<font color="#808080">: </font>integer<font color="#808080">); </font><font color="#000080"><b>forward</b></font><font color="#808080">;
</font><font color="#000080"><b>procedure </b></font>frmCadastros<font color="#808080">(</font>sreg<font color="#808080">: </font>ctArqs<font color="#808080">; </font>sacao<font color="#808080">: </font>ctAcao<font color="#808080">); </font><font color="#000080"><b>forward</b></font><font color="#808080">;
</font><font color="#000080"><b>procedure </b></font>frmConsultas<font color="#808080">(</font>sreg<font color="#808080">: </font>ctArqs<font color="#808080">; </font>sacao<font color="#808080">: </font>ctAcao<font color="#808080">); </font><font color="#000080"><b>forward</b></font><font color="#808080">;
</font><font color="#000080"><b>procedure </b></font>frmAlterarSenha<font color="#808080">; </font><font color="#000080"><b>forward</b></font><font color="#808080">;
</font><font color="#000080"><b>procedure </b></font>btnAcao<font color="#808080">(</font>sreg<font color="#808080">: </font>ctArqs<font color="#808080">; </font>sacao<font color="#808080">: </font>ctAcao<font color="#808080">); </font><font color="#000080"><b>forward</b></font><font color="#808080">;
</font><font color="#000080"><b>procedure </b></font>subMenu<font color="#808080">(</font>nmenu<font color="#808080">: </font>integer<font color="#808080">; </font>sreg<font color="#808080">: </font>ctArqs<font color="#808080">); </font><font color="#000080"><b>forward</b></font><font color="#808080">;
</font><font color="#000080"><b>procedure </b></font>usaMenu<font color="#808080">(</font>num<font color="#808080">: </font>integer<font color="#808080">); </font><font color="#000080"><b>forward</b></font><font color="#808080">;
</font><font color="#000080"><b>procedure </b></font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">: </font>ctArqs<font color="#808080">; </font>slinha<font color="#808080">: </font>mstring<font color="#808080">; </font>nOpcao<font color="#808080">: </font>integer<font color="#808080">); </font><font color="#000080"><b>forward</b></font><font color="#808080">;
</font><font color="#000080"><b>procedure </b></font>mostrarSubDados<font color="#808080">(</font>sreg<font color="#808080">, </font>ssubreg<font color="#808080">: </font>ctArqs<font color="#808080">; </font>bSoMostrar<font color="#808080">: </font>boolean<font color="#808080">); </font><font color="#000080"><b>forward</b></font><font color="#808080">;
</font><font color="#000080"><b>procedure </b></font>frmCadLigados<font color="#808080">(</font>sreg<font color="#808080">: </font>ctArqs<font color="#808080">; </font>sacao<font color="#808080">: </font>ctAcao<font color="#808080">; </font>sCodigo<font color="#808080">: </font>mstring<font color="#808080">); </font><font color="#000080"><b>forward</b></font><font color="#808080">;
</font><font color="#000080"><b>procedure </b></font>ExcluirRegLigados<font color="#808080">(</font><font color="#000080"><b>var </b></font>sArq<font color="#808080">: </font><font color="#000080"><b>File</b></font><font color="#808080">; </font>sreg<font color="#808080">: </font>ctArqs<font color="#808080">; </font>nPosChave<font color="#808080">,
          </font>nTamChave<font color="#808080">: </font>integer<font color="#808080">; </font>sChave<font color="#808080">: </font>mstring<font color="#808080">); </font><font color="#000080"><b>forward</b></font><font color="#808080">;

<i>{------------------------------------------------------------------------------
Retira os espa&ccedil;os em branco antes ou depois do texto.
sTexto - o texto a ser retirado os espa&ccedil;os em branco
retorna - o texto sem os espa&ccedil;os em branco
------------------------------------------------------------------------------}
</i></font><font color="#000080"><b>function </b></font>trim<font color="#808080">(</font>sTexto<font color="#808080">: </font>mstring<font color="#808080">): </font>mstring<font color="#808080">;
</font><font color="#000080"><b>var </b></font>ncont<font color="#808080">, </font>nPosIni<font color="#808080">, </font>nPosFim<font color="#808080">: </font>integer<font color="#808080">;
    </font>sret<font color="#808080">: </font>mstring<font color="#808080">;
    </font>bQuebra<font color="#808080">: </font>boolean<font color="#808080">;
</font><font color="#000080"><b>begin
</b></font>nPosIni<font color="#808080">:=</font><font color="#FF0000">0</font><font color="#808080">;
</font>nPosFim<font color="#808080">:=</font><font color="#FF0000">0</font><font color="#808080">;
</font>ncont<font color="#808080">:=</font><font color="#FF0000">1</font><font color="#808080">;
</font>bQuebra<font color="#808080">:=</font>false<font color="#808080">;
</font><font color="#000080"><b>while </b></font><font color="#808080">(</font>ncont<font color="#808080">&lt;=</font>length<font color="#808080">(</font>sTexto<font color="#808080">)) </font><font color="#000080"><b>and </b></font><font color="#808080">(</font>bQuebra<font color="#808080">=</font>false<font color="#808080">) </font><font color="#000080"><b>do begin
  if </b></font>sTexto<font color="#808080">[</font>ncont<font color="#808080">]&lt;&gt;</font><font color="#800000">' ' </font><font color="#000080"><b>then begin
     </b></font>nPosIni<font color="#808080">:=</font>ncont<font color="#808080">;
     </font>bQuebra<font color="#808080">:=</font>true<font color="#808080">;
  </font><font color="#000080"><b>end</b></font><font color="#808080">;
  </font>ncont<font color="#808080">:=</font>ncont<font color="#808080">+</font><font color="#FF0000">1</font><font color="#808080">;
</font><font color="#000080"><b>end</b></font><font color="#808080">;
</font>ncont<font color="#808080">:=</font>length<font color="#808080">(</font>sTexto<font color="#808080">);
</font>bQuebra<font color="#808080">:=</font>false<font color="#808080">;
</font><font color="#000080"><b>while </b></font><font color="#808080">(</font>ncont <font color="#808080">&gt;= </font><font color="#FF0000">1</font><font color="#808080">) </font><font color="#000080"><b>and </b></font><font color="#808080">(</font>bQuebra<font color="#808080">=</font>false<font color="#808080">) </font><font color="#000080"><b>do begin
  if </b></font>sTexto<font color="#808080">[</font>ncont<font color="#808080">]&lt;&gt;</font><font color="#800000">' ' </font><font color="#000080"><b>then begin
     </b></font>nPosFim<font color="#808080">:=</font>ncont<font color="#808080">;
     </font>bQuebra<font color="#808080">:=</font>true<font color="#808080">;
  </font><font color="#000080"><b>end</b></font><font color="#808080">;
  </font>ncont<font color="#808080">:=</font>ncont<font color="#808080">-</font><font color="#FF0000">1</font><font color="#808080">;
</font><font color="#000080"><b>end</b></font><font color="#808080">;
</font>sret<font color="#808080">:=</font>copy<font color="#808080">(</font>sTexto<font color="#808080">,</font>nPosIni<font color="#808080">,(</font>nPosFim<font color="#808080">-</font>nPosIni<font color="#808080">)+</font><font color="#FF0000">1</font><font color="#808080">);
</font>trim<font color="#808080">:=</font>sret<font color="#808080">;
</font><font color="#000080"><b>end</b></font><font color="#808080">;
<i>{------------------------------------------------------------------------------
Repete um texto um n&uacute;mero determinado de vezes.
sTexto - o texto a ser repetido
nQtd - a quantidade de vezes
retorna - o texto repetido
------------------------------------------------------------------------------}
</i></font><font color="#000080"><b>function </b></font>repete<font color="#808080">(</font>sTexto<font color="#808080">: </font>mstring<font color="#808080">; </font>nQtd<font color="#808080">: </font>integer<font color="#808080">): </font>mstring<font color="#808080">;
</font><font color="#000080"><b>var </b></font>ncont<font color="#808080">: </font>integer<font color="#808080">;
    </font>sret<font color="#808080">: </font>mstring<font color="#808080">;
</font><font color="#000080"><b>begin
</b></font>sret<font color="#808080">:=</font><font color="#800000">''</font><font color="#808080">;
</font><font color="#000080"><b>for </b></font>ncont<font color="#808080">:=</font><font color="#FF0000">1 </font><font color="#000080"><b>to </b></font>nQtd <font color="#000080"><b>do begin
    </b></font>sret<font color="#808080">:=</font>sret<font color="#808080">+</font>sTexto<font color="#808080">;
</font><font color="#000080"><b>end</b></font><font color="#808080">;
</font>repete<font color="#808080">:=</font>sret<font color="#808080">;
</font><font color="#000080"><b>end</b></font><font color="#808080">;
<i>{------------------------------------------------------------------------------
Coloca espa&ccedil;os em branco a mais de acordo com o tamanho m&aacute;ximo do texto.
sTexto - o texto
nTam - tamanho m&aacute;ximo do texto
retorna - o texto com espa&ccedil;os em branco a mais
------------------------------------------------------------------------------}
</i></font><font color="#000080"><b>function </b></font>esp<font color="#808080">(</font>sTexto<font color="#808080">: </font>mstring<font color="#808080">; </font>nTam<font color="#808080">: </font>integer<font color="#808080">):</font>mstring<font color="#808080">;
</font><font color="#000080"><b>begin
</b></font>esp<font color="#808080">:=</font>sTexto<font color="#808080">+</font>repete<font color="#808080">(</font><font color="#800000">' '</font><font color="#808080">,</font>nTam<font color="#808080">-</font>length<font color="#808080">(</font>sTexto<font color="#808080">));
</font><font color="#000080"><b>end</b></font><font color="#808080">;
<i>{------------------------------------------------------------------------------
Escreve zeros na frente de um texto.
stexto - o texto para receber zeros a frente
ntam - o tamanho da string
retorna - o texto com o zeros antes
------------------------------------------------------------------------------}
</i></font><font color="#000080"><b>function </b></font>zeros<font color="#808080">(</font>stexto<font color="#808080">:</font>mstring<font color="#808080">; </font>ntam<font color="#808080">:</font>integer<font color="#808080">): </font>mstring<font color="#808080">;
</font><font color="#000080"><b>var </b></font>ncont<font color="#808080">: </font>integer<font color="#808080">;
    </font>saux<font color="#808080">: </font>mstring<font color="#808080">;
</font><font color="#000080"><b>begin
  </b></font>saux<font color="#808080">:=</font><font color="#800000">''</font><font color="#808080">;
  </font><font color="#000080"><b>if </b></font>ntam<font color="#808080">&lt;&gt;</font>length<font color="#808080">(</font>stexto<font color="#808080">) </font><font color="#000080"><b>then begin
      for </b></font>ncont<font color="#808080">:=</font><font color="#FF0000">1 </font><font color="#000080"><b>to </b></font>ntam<font color="#808080">-</font>length<font color="#808080">(</font>stexto<font color="#808080">) </font><font color="#000080"><b>do
        </b></font>saux<font color="#808080">:=</font>saux <font color="#808080">+ </font><font color="#800000">'0'</font><font color="#808080">;
  </font><font color="#000080"><b>end</b></font><font color="#808080">;
  </font>zeros<font color="#808080">:=</font>saux<font color="#808080">+</font>stexto<font color="#808080">;
</font><font color="#000080"><b>end</b></font><font color="#808080">;
<i>{------------------------------------------------------------------------------
Faz uma pesquisa relativa de um texto atrav&eacute;s de um valor chave.
sTexto - o texto
sChave - a chave a ser pesquisada
retorna - se achou ou n&atilde;o a chave dentro do texto
------------------------------------------------------------------------------}
</i></font><font color="#000080"><b>function </b></font>strRelativa<font color="#808080">(</font>sTexto<font color="#808080">, </font>sChave<font color="#808080">: </font>mstring<font color="#808080">):</font>boolean<font color="#808080">;
</font><font color="#000080"><b>var </b></font>nCont<font color="#808080">, </font>nTamChave<font color="#808080">, </font>nTamTexto<font color="#808080">: </font>integer<font color="#808080">;
    </font>bret<font color="#808080">: </font>boolean<font color="#808080">;
    </font>sPedaco<font color="#808080">: </font>mstring<font color="#808080">;
</font><font color="#000080"><b>begin
</b></font>bret<font color="#808080">:=</font>false<font color="#808080">;
</font>nCont<font color="#808080">:=</font><font color="#FF0000">1</font><font color="#808080">;
</font>nTamChave<font color="#808080">:=</font>length<font color="#808080">(</font>sChave<font color="#808080">);
</font>nTamTexto<font color="#808080">:=</font>length<font color="#808080">(</font>sTexto<font color="#808080">);
</font><font color="#000080"><b>if </b></font>nTamChave <font color="#808080">&lt;= </font>nTamTexto <font color="#000080"><b>then begin
  while </b></font>nCont <font color="#808080">&lt;= (</font>nTamTexto<font color="#808080">-</font>nTamChave<font color="#808080">+</font><font color="#FF0000">1</font><font color="#808080">) </font><font color="#000080"><b>do begin
     </b></font>sPedaco<font color="#808080">:=</font>copy<font color="#808080">(</font>sTexto<font color="#808080">,</font>nCont<font color="#808080">,</font>nTamChave<font color="#808080">);
     </font><font color="#000080"><b>if </b></font>sPedaco<font color="#808080">=</font>sChave <font color="#000080"><b>then
        </b></font>bret<font color="#808080">:=</font>true<font color="#808080">;
     </font>nCont<font color="#808080">:=</font>nCont<font color="#808080">+</font><font color="#FF0000">1</font><font color="#808080">;
  </font><font color="#000080"><b>end</b></font><font color="#808080">;
</font><font color="#000080"><b>end</b></font><font color="#808080">;
</font>strRelativa<font color="#808080">:=</font>bret<font color="#808080">;
</font><font color="#000080"><b>end</b></font><font color="#808080">;
<i>{------------------------------------------------------------------------------
Calcula o modulo11 de um valor qualquer.
svalor - a mstring com o n&uacute;mero a ser calculado
ndig - d&iacute;gito do valor a ser calculado
retorna - o d&iacute;gito correto
------------------------------------------------------------------------------}
</i></font><font color="#000080"><b>function </b></font>modulo11<font color="#808080">(</font>svalor<font color="#808080">: </font>mstring<font color="#808080">; </font>ndig<font color="#808080">: </font>integer<font color="#808080">): </font>integer<font color="#808080">;
</font><font color="#000080"><b>var </b></font>ncont<font color="#808080">, </font>nsoma<font color="#808080">, </font>nstatus<font color="#808080">, </font>nvalor<font color="#808080">, </font>npos<font color="#808080">: </font>integer<font color="#808080">;
    </font>sres<font color="#808080">, </font>slocal<font color="#808080">: </font>mstring<font color="#808080">;
</font><font color="#000080"><b>begin
 </b></font>ncont<font color="#808080">:=</font><font color="#FF0000">1</font><font color="#808080">;
 </font><font color="#000080"><b>while </b></font>ncont <font color="#808080">&lt;= </font><font color="#FF0000">11 </font><font color="#000080"><b>do begin
   </b></font>slocal<font color="#808080">:=</font>copy<font color="#808080">(</font>svalor<font color="#808080">,</font>ncont<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">) + </font>slocal<font color="#808080">;
   </font>ncont<font color="#808080">:=</font>ncont<font color="#808080">+</font><font color="#FF0000">1</font><font color="#808080">;
 </font><font color="#000080"><b>end</b></font><font color="#808080">;
 </font>nsoma<font color="#808080">:=</font><font color="#FF0000">0</font><font color="#808080">;
 </font><font color="#000080"><b>if </b></font>ndig<font color="#808080">=</font><font color="#FF0000">1 </font><font color="#000080"><b>then
   </b></font>ncont<font color="#808080">:=</font><font color="#FF0000">3
 </font><font color="#000080"><b>else
   </b></font>ncont<font color="#808080">:=</font><font color="#FF0000">2</font><font color="#808080">;
 </font>npos<font color="#808080">:=</font><font color="#FF0000">2</font><font color="#808080">;
 </font><font color="#000080"><b>while </b></font>ncont <font color="#808080">&lt;= </font><font color="#FF0000">11 </font><font color="#000080"><b>do begin
   </b></font>sres<font color="#808080">:=</font>copy<font color="#808080">(</font>slocal<font color="#808080">,</font>ncont<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">);
   </font>Val<font color="#808080">(</font>sres<font color="#808080">,</font>nvalor<font color="#808080">,</font>nstatus<font color="#808080">);
   </font>nsoma<font color="#808080">:=</font>nsoma <font color="#808080">+ (</font>nvalor <font color="#808080">* </font>npos<font color="#808080">);
   </font>ncont<font color="#808080">:=</font>ncont<font color="#808080">+</font><font color="#FF0000">1</font><font color="#808080">;
   </font>npos<font color="#808080">:=</font>npos<font color="#808080">+</font><font color="#FF0000">1</font><font color="#808080">;
 </font><font color="#000080"><b>end</b></font><font color="#808080">;
 </font>nsoma<font color="#808080">:=(</font><font color="#FF0000">11 </font><font color="#808080">- (</font>nsoma <font color="#000080"><b>mod </b></font><font color="#FF0000">11</font><font color="#808080">));

</font><font color="#000080"><b>if </b></font>nsoma <font color="#808080">&gt; </font><font color="#FF0000">9 </font><font color="#000080"><b>then
  </b></font>modulo11<font color="#808080">:=</font><font color="#FF0000">0
</font><font color="#000080"><b>else
  </b></font>modulo11<font color="#808080">:=</font>nsoma<font color="#808080">;
</font><font color="#000080"><b>end</b></font><font color="#808080">;
<i>{------------------------------------------------------------------------------
Valida&ccedil;&atilde;o de um n&uacute;mero de CPF qualquer.
cpf - a mstring com o n&uacute;mero do CPF
retorna - se &eacute; valido ou n&atilde;o
------------------------------------------------------------------------------}
</i></font><font color="#000080"><b>function </b></font>validaCPF<font color="#808080">(</font>cpf<font color="#808080">: </font>mstring<font color="#808080">): </font>boolean<font color="#808080">;
</font><font color="#000080"><b>var </b></font>scpf<font color="#808080">, </font>sres<font color="#808080">: </font>mstring<font color="#808080">;
    </font>nstatus<font color="#808080">, </font>nvalor1<font color="#808080">, </font>nvalor2<font color="#808080">: </font>integer<font color="#808080">;
</font><font color="#000080"><b>begin
if </b></font><font color="#808080">(</font>length<font color="#808080">(</font>cpf<font color="#808080">)=</font><font color="#FF0000">14</font><font color="#808080">) </font><font color="#000080"><b>then begin
  </b></font>scpf<font color="#808080">:=</font>copy<font color="#808080">(</font>cpf<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#FF0000">3</font><font color="#808080">)+</font>copy<font color="#808080">(</font>cpf<font color="#808080">,</font><font color="#FF0000">5</font><font color="#808080">,</font><font color="#FF0000">3</font><font color="#808080">)+</font>copy<font color="#808080">(</font>cpf<font color="#808080">,</font><font color="#FF0000">9</font><font color="#808080">,</font><font color="#FF0000">3</font><font color="#808080">)+</font>copy<font color="#808080">(</font>cpf<font color="#808080">,</font><font color="#FF0000">13</font><font color="#808080">,</font><font color="#FF0000">2</font><font color="#808080">);
  </font>sres<font color="#808080">:=</font>copy<font color="#808080">(</font>cpf<font color="#808080">,</font><font color="#FF0000">13</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">);
  </font>Val<font color="#808080">(</font>sres<font color="#808080">,</font>nvalor1<font color="#808080">,</font>nstatus<font color="#808080">);
  </font>sres<font color="#808080">:=</font>copy<font color="#808080">(</font>cpf<font color="#808080">,</font><font color="#FF0000">14</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">);
  </font>Val<font color="#808080">(</font>sres<font color="#808080">,</font>nvalor2<font color="#808080">,</font>nstatus<font color="#808080">);
  </font><font color="#000080"><b>if </b></font><font color="#808080">((</font>modulo11<font color="#808080">(</font>scpf<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">)=</font>nvalor1<font color="#808080">) </font><font color="#000080"><b>and </b></font><font color="#808080">(</font>modulo11<font color="#808080">(</font>scpf<font color="#808080">,</font><font color="#FF0000">2</font><font color="#808080">)=</font>nvalor2<font color="#808080">)) </font><font color="#000080"><b>then
    </b></font>validaCPF<font color="#808080">:=</font>true
  <font color="#000080"><b>else
    </b></font>validaCPF<font color="#808080">:=</font>false<font color="#808080">;
</font><font color="#000080"><b>end else
  </b></font>validaCPF<font color="#808080">:=</font>false<font color="#808080">;
</font><font color="#000080"><b>end</b></font><font color="#808080">;
<i>{------------------------------------------------------------------------------
Valida&ccedil;&atilde;o de um n&uacute;mero ISBN qualquer.
isbn - a mstring com o n&uacute;mero do ISBN
retorna - se &eacute; valido ou n&atilde;o
------------------------------------------------------------------------------}
</i></font><font color="#000080"><b>function </b></font>validaISBN<font color="#808080">(</font>isbn<font color="#808080">: </font>mstring<font color="#808080">): </font>boolean<font color="#808080">;
</font><font color="#000080"><b>var </b></font>snum<font color="#808080">, </font>sdigito<font color="#808080">, </font>sisbn<font color="#808080">: </font>mstring<font color="#808080">;
 </font>nvalor<font color="#808080">, </font>nsoma<font color="#808080">, </font>nstatus<font color="#808080">, </font>ncont<font color="#808080">: </font>integer<font color="#808080">;
</font><font color="#000080"><b>begin
if </b></font><font color="#808080">(</font>length<font color="#808080">(</font>isbn<font color="#808080">)=</font><font color="#FF0000">13</font><font color="#808080">) </font><font color="#000080"><b>then begin
  </b></font>sdigito <font color="#808080">:= </font>copy<font color="#808080">(</font>isbn<font color="#808080">, </font>length<font color="#808080">(</font>isbn<font color="#808080">), </font><font color="#FF0000">1</font><font color="#808080">);
  </font>sisbn<font color="#808080">:=</font><font color="#800000">''</font><font color="#808080">;
  </font><font color="#000080"><b>for </b></font>ncont<font color="#808080">:=</font><font color="#FF0000">1 </font><font color="#000080"><b>to </b></font>length<font color="#808080">(</font>isbn<font color="#808080">)-</font><font color="#FF0000">1 </font><font color="#000080"><b>do begin
    if </b></font><font color="#808080">(</font>copy<font color="#808080">(</font>isbn<font color="#808080">,</font>ncont<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">)&lt;&gt;</font><font color="#800000">'-'</font><font color="#808080">) </font><font color="#000080"><b>then
      </b></font>sisbn<font color="#808080">:=</font>sisbn<font color="#808080">+</font>copy<font color="#808080">(</font>isbn<font color="#808080">,</font>ncont<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">);
  </font><font color="#000080"><b>end</b></font><font color="#808080">;
  </font><font color="#000080"><b>if </b></font>sdigito <font color="#808080">= </font><font color="#800000">'X' </font><font color="#000080"><b>then
    </b></font>nsoma <font color="#808080">:= </font><font color="#FF0000">10
  </font><font color="#000080"><b>else begin
    </b></font>Val<font color="#808080">(</font>sdigito<font color="#808080">,</font>nvalor<font color="#808080">,</font>nstatus<font color="#808080">);
    </font>nsoma <font color="#808080">:= </font>nvalor<font color="#808080">;
  </font><font color="#000080"><b>end</b></font><font color="#808080">;
  </font><font color="#000080"><b>for </b></font>ncont<font color="#808080">:=</font><font color="#FF0000">1 </font><font color="#000080"><b>to </b></font><font color="#FF0000">9 </font><font color="#000080"><b>do begin
    </b></font>snum<font color="#808080">:=</font>copy<font color="#808080">(</font>sisbn<font color="#808080">, </font>ncont<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">);
    </font>Val<font color="#808080">(</font>snum<font color="#808080">,</font>nvalor<font color="#808080">,</font>nstatus<font color="#808080">);
    </font>nsoma<font color="#808080">:=</font>nsoma <font color="#808080">+ (</font>nvalor <font color="#808080">* (</font><font color="#FF0000">11 </font><font color="#808080">- </font>ncont<font color="#808080">));
  </font><font color="#000080"><b>end</b></font><font color="#808080">;
  </font><font color="#000080"><b>If </b></font><font color="#808080">(</font>nsoma <font color="#000080"><b>mod </b></font><font color="#FF0000">11</font><font color="#808080">) = </font><font color="#FF0000">0 </font><font color="#000080"><b>Then
    </b></font>validaISBN<font color="#808080">:=</font>true
  <font color="#000080"><b>else
    </b></font>validaISBN<font color="#808080">:=</font>false<font color="#808080">;
</font><font color="#000080"><b>end else
  </b></font>validaISBN<font color="#808080">:=</font>false<font color="#808080">;
</font><font color="#000080"><b>end</b></font><font color="#808080">;
<i>{------------------------------------------------------------------------------
Esconde a digita&ccedil;&atilde;o da senha
retorna - a senha digitada
------------------------------------------------------------------------------}
</i></font><font color="#000080"><b>function </b></font>digitaSenha<font color="#808080">(</font>sRotulo<font color="#808080">: </font>mstring<font color="#808080">; </font>nTamSenha<font color="#808080">: </font>integer<font color="#808080">): </font>mstring<font color="#808080">;
</font><font color="#000080"><b>var </b></font>sSenha<font color="#808080">: </font>mstring<font color="#808080">;
<i>{    sLetra: char;
    ncont: integer;}
</i></font><font color="#000080"><b>begin
</b></font>write<font color="#808080">(</font>sRotulo<font color="#808080">);
</font>readln<font color="#808080">(</font>sSenha<font color="#808080">);
<i>{  ncont := 0;
  sSenha:='';
  sLetra:=#0;
  while((sLetra&lt;&gt;#13) and (ncont &lt; nTamSenha)) do begin
    sLetra:=readkey;
    write('*');
    sSenha:=sSenha+sLetra;
    ncont:=ncont+1;
  end;}
</i></font>digitaSenha<font color="#808080">:=</font>sSenha<font color="#808080">;
</font><font color="#000080"><b>end</b></font><font color="#808080">;
<i>{------------------------------------------------------------------------------
Valida&ccedil;&atilde;o de um n&uacute;mero qualquer.
sRotulo - o texto antes de se digitar o n&uacute;mero
sNumero - a mstring com o valor do n&uacute;mero
retorna - o sNumero
------------------------------------------------------------------------------}
</i></font><font color="#000080"><b>function </b></font>validaNumero<font color="#808080">(</font>sRotulo<font color="#808080">, </font>sNumero<font color="#808080">: </font>mstring<font color="#808080">): </font>mstring<font color="#808080">;
</font><font color="#000080"><b>var </b></font>nnum<font color="#808080">: </font>double<font color="#808080">;
    </font>nStatus<font color="#808080">: </font>integer<font color="#808080">;
</font><font color="#000080"><b>begin
</b></font>nStatus<font color="#808080">:=-</font><font color="#FF0000">1</font><font color="#808080">;
</font><font color="#000080"><b>while </b></font><font color="#808080">(</font>nStatus<font color="#808080">&lt;&gt;</font><font color="#FF0000">0</font><font color="#808080">) </font><font color="#000080"><b>do begin
  </b></font>write<font color="#808080">(</font>sRotulo<font color="#808080">);
  </font>readln<font color="#808080">(</font>sNumero<font color="#808080">);
  </font>Val<font color="#808080">(</font>sNumero<font color="#808080">,</font>nnum<font color="#808080">,</font>nStatus<font color="#808080">);
  </font><font color="#000080"><b>if </b></font><font color="#808080">(</font>nnum <font color="#808080">&lt; </font><font color="#FF0000">1</font><font color="#808080">) </font><font color="#000080"><b>or </b></font><font color="#808080">(</font>nStatus<font color="#808080">&lt;&gt;</font><font color="#FF0000">0</font><font color="#808080">) </font><font color="#000080"><b>then
     </b></font>writeln<font color="#808080">(</font>MSG_NUMINV<font color="#808080">);
</font><font color="#000080"><b>end</b></font><font color="#808080">;
</font>validaNumero<font color="#808080">:=</font>sNumero<font color="#808080">;
</font><font color="#000080"><b>end</b></font><font color="#808080">;
<i>{------------------------------------------------------------------------------
Valida&ccedil;&atilde;o de uma data ou data/hora qualquer.
sRotulo - o texto antes de se digitar a data/hora
sDataHora - a mstring com o valor da data/hora
bSoData - indica se vai validar somente uma data sem a hora
retorna - a sDataHora
------------------------------------------------------------------------------}
</i></font><font color="#000080"><b>function </b></font>validaDataHora<font color="#808080">(</font>sRotulo<font color="#808080">, </font>sDataHora<font color="#808080">: </font>mstring<font color="#808080">; </font>bSoData<font color="#808080">: </font>boolean<font color="#808080">): </font>mstring<font color="#808080">;
</font><font color="#000080"><b>var </b></font>bvalida<font color="#808080">, </font>bdatavalida<font color="#808080">, </font>bhoravalida<font color="#808080">: </font>boolean<font color="#808080">;
    </font>sdia<font color="#808080">, </font>smes<font color="#808080">, </font>sano<font color="#808080">, </font>shora<font color="#808080">, </font>smin<font color="#808080">, </font>sseg<font color="#808080">: </font>mstring<font color="#808080">;
    </font>ndia<font color="#808080">, </font>nmes<font color="#808080">, </font>nano<font color="#808080">, </font>nhora<font color="#808080">, </font>nmin<font color="#808080">, </font>nseg<font color="#808080">, </font>nudiames<font color="#808080">: </font>integer<font color="#808080">;
    </font>nStatus<font color="#808080">, </font>ntam<font color="#808080">: </font>integer<font color="#808080">;
</font><font color="#000080"><b>begin
</b></font>bvalida<font color="#808080">:=</font>false<font color="#808080">;
</font>bdatavalida<font color="#808080">:=</font>false<font color="#808080">;
</font>bhoravalida<font color="#808080">:=</font>false<font color="#808080">;
</font>nudiames<font color="#808080">:=</font><font color="#FF0000">0</font><font color="#808080">;

</font><font color="#000080"><b>if </b></font>bSoData<font color="#808080">=</font>true <font color="#000080"><b>then </b></font>ntam<font color="#808080">:=</font><font color="#FF0000">10
</font><font color="#000080"><b>else </b></font>ntam<font color="#808080">:=</font><font color="#FF0000">19</font><font color="#808080">;
</font><font color="#000080"><b>while </b></font><font color="#808080">(</font>bvalida<font color="#808080">=</font>false<font color="#808080">) </font><font color="#000080"><b>do begin
  </b></font>write<font color="#808080">(</font>sRotulo<font color="#808080">);
  </font>readln<font color="#808080">(</font>sDataHora<font color="#808080">);
  </font><font color="#000080"><b>if </b></font>length<font color="#808080">(</font>sDataHora<font color="#808080">)=</font>ntam <font color="#000080"><b>then begin
    </b></font>sdia<font color="#808080">:=</font>copy<font color="#808080">(</font>sDataHora<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#FF0000">2</font><font color="#808080">);
    </font>Val<font color="#808080">(</font>sdia<font color="#808080">,</font>ndia<font color="#808080">,</font>nStatus<font color="#808080">);
    </font>smes<font color="#808080">:=</font>copy<font color="#808080">(</font>sDataHora<font color="#808080">,</font><font color="#FF0000">4</font><font color="#808080">,</font><font color="#FF0000">2</font><font color="#808080">);
    </font>Val<font color="#808080">(</font>smes<font color="#808080">,</font>nmes<font color="#808080">,</font>nStatus<font color="#808080">);
    </font>sano<font color="#808080">:=</font>copy<font color="#808080">(</font>sDataHora<font color="#808080">,</font><font color="#FF0000">7</font><font color="#808080">,</font><font color="#FF0000">4</font><font color="#808080">);
    </font>Val<font color="#808080">(</font>sano<font color="#808080">,</font>nano<font color="#808080">,</font>nStatus<font color="#808080">);
  
    </font><font color="#000080"><b>if </b></font><font color="#808080">(</font>nano <font color="#808080">&gt;= </font><font color="#FF0000">1</font><font color="#808080">) </font><font color="#000080"><b>and </b></font><font color="#808080">(</font>nano <font color="#808080">&lt;= </font><font color="#FF0000">9999</font><font color="#808080">) </font><font color="#000080"><b>then begin
      if </b></font><font color="#808080">(</font>nmes <font color="#808080">&gt;= </font><font color="#FF0000">1</font><font color="#808080">) </font><font color="#000080"><b>and </b></font><font color="#808080">(</font>nmes <font color="#808080">&lt;= </font><font color="#FF0000">31</font><font color="#808080">) </font><font color="#000080"><b>then begin
          case </b></font>nmes <font color="#000080"><b>of
           </b></font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">, </font><font color="#FF0000">5</font><font color="#808080">, </font><font color="#FF0000">7</font><font color="#808080">, </font><font color="#FF0000">8</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">, </font><font color="#FF0000">12</font><font color="#808080">: </font>nudiames<font color="#808080">:=</font><font color="#FF0000">31</font><font color="#808080">;
           </font><font color="#FF0000">2</font><font color="#808080">: </font><font color="#000080"><b>begin
               </b></font><font color="#808080"><i>{ ano bissexto }
               </i></font><font color="#000080"><b>if </b></font><font color="#808080">(</font>nano <font color="#000080"><b>mod </b></font><font color="#FF0000">4</font><font color="#808080">)=</font><font color="#FF0000">0 </font><font color="#000080"><b>then </b></font>nudiames<font color="#808080">:=</font><font color="#FF0000">29
               </font><font color="#000080"><b>else </b></font>nudiames<font color="#808080">:=</font><font color="#FF0000">28</font><font color="#808080">;
              </font><font color="#000080"><b>end</b></font><font color="#808080">;
           </font><font color="#FF0000">4</font><font color="#808080">, </font><font color="#FF0000">6</font><font color="#808080">, </font><font color="#FF0000">9</font><font color="#808080">, </font><font color="#FF0000">11</font><font color="#808080">: </font>nudiames<font color="#808080">:=</font><font color="#FF0000">30</font><font color="#808080">;
          </font><font color="#000080"><b>end</b></font><font color="#808080">;
          </font><font color="#000080"><b>if </b></font><font color="#808080">(</font>ndia <font color="#808080">&gt;=</font><font color="#FF0000">1</font><font color="#808080">) </font><font color="#000080"><b>and </b></font><font color="#808080">(</font>ndia <font color="#808080">&lt;=</font>nudiames<font color="#808080">) </font><font color="#000080"><b>then
             </b></font>bdatavalida<font color="#808080">:=</font>true<font color="#808080">;
      </font><font color="#000080"><b>end</b></font><font color="#808080">;
    </font><font color="#000080"><b>end</b></font><font color="#808080">;
  
    </font><font color="#000080"><b>if </b></font>bSoData <font color="#000080"><b>then begin
       if </b></font>bdatavalida <font color="#000080"><b>then </b></font>bvalida<font color="#808080">:=</font>true
       <font color="#000080"><b>else </b></font>writeln<font color="#808080">(</font>MSG_DATAINV<font color="#808080">);
    </font><font color="#000080"><b>end else begin
      if </b></font>bdatavalida <font color="#000080"><b>then begin
          </b></font>shora<font color="#808080">:=</font>copy<font color="#808080">(</font>sDataHora<font color="#808080">,</font><font color="#FF0000">12</font><font color="#808080">,</font><font color="#FF0000">2</font><font color="#808080">);
          </font>Val<font color="#808080">(</font>shora<font color="#808080">,</font>nhora<font color="#808080">,</font>nStatus<font color="#808080">);
          </font>smin<font color="#808080">:=</font>copy<font color="#808080">(</font>sDataHora<font color="#808080">,</font><font color="#FF0000">15</font><font color="#808080">,</font><font color="#FF0000">2</font><font color="#808080">);
          </font>Val<font color="#808080">(</font>smin<font color="#808080">,</font>nmin<font color="#808080">,</font>nStatus<font color="#808080">);
          </font>sseg<font color="#808080">:=</font>copy<font color="#808080">(</font>sDataHora<font color="#808080">,</font><font color="#FF0000">18</font><font color="#808080">,</font><font color="#FF0000">2</font><font color="#808080">);
          </font>Val<font color="#808080">(</font>sseg<font color="#808080">,</font>nseg<font color="#808080">,</font>nStatus<font color="#808080">);
  
          </font><font color="#000080"><b>if </b></font><font color="#808080">(</font>nhora <font color="#808080">&gt;= </font><font color="#FF0000">0</font><font color="#808080">) </font><font color="#000080"><b>and </b></font><font color="#808080">(</font>nhora <font color="#808080">&lt;= </font><font color="#FF0000">23</font><font color="#808080">) </font><font color="#000080"><b>then begin
            if </b></font><font color="#808080">(</font>nmin <font color="#808080">&gt;= </font><font color="#FF0000">0</font><font color="#808080">) </font><font color="#000080"><b>and </b></font><font color="#808080">(</font>nmin <font color="#808080">&lt;= </font><font color="#FF0000">59</font><font color="#808080">) </font><font color="#000080"><b>then begin
              if </b></font><font color="#808080">(</font>nseg <font color="#808080">&gt;= </font><font color="#FF0000">0</font><font color="#808080">) </font><font color="#000080"><b>and </b></font><font color="#808080">(</font>nseg <font color="#808080">&lt;= </font><font color="#FF0000">59</font><font color="#808080">) </font><font color="#000080"><b>then
                 </b></font>bhoravalida<font color="#808080">:=</font>true<font color="#808080">;
            </font><font color="#000080"><b>end</b></font><font color="#808080">;
          </font><font color="#000080"><b>end</b></font><font color="#808080">;
  
          </font><font color="#000080"><b>if </b></font>bhoravalida <font color="#000080"><b>then </b></font>bvalida<font color="#808080">:=</font>true
          <font color="#000080"><b>else </b></font>writeln<font color="#808080">(</font>MSG_DTHRINV<font color="#808080">);
      </font><font color="#000080"><b>end else
        </b></font>writeln<font color="#808080">(</font>MSG_DTHRINV<font color="#808080">);
    </font><font color="#000080"><b>end</b></font><font color="#808080">;
  </font><font color="#000080"><b>end else begin
    if </b></font>bSoData<font color="#808080">=</font>true <font color="#000080"><b>then </b></font>writeln<font color="#808080">(</font>MSG_DATAINV<font color="#808080">)
    </font><font color="#000080"><b>else </b></font>writeln<font color="#808080">(</font>MSG_DTHRINV<font color="#808080">);
  </font><font color="#000080"><b>end</b></font><font color="#808080">;
</font><font color="#000080"><b>end</b></font><font color="#808080">;
</font>validaDataHora<font color="#808080">:=</font>sDataHora<font color="#808080">;
</font><font color="#000080"><b>end</b></font><font color="#808080">;
<i>{------------------------------------------------------------------------------
Retorna a Data e a hora do sistema.
retorna - a data e a hora
------------------------------------------------------------------------------}
</i></font><font color="#000080"><b>function </b></font>retDataHora<font color="#808080">: </font>mstring<font color="#808080">;
</font><font color="#000080"><b>var </b></font>y<font color="#808080">, </font>m<font color="#808080">, </font>d<font color="#808080">, </font>dow<font color="#808080">, </font>h<font color="#808080">, </font>mn<font color="#808080">, </font>s<font color="#808080">, </font>ms<font color="#808080">: </font>word<font color="#808080">;
    </font>dia<font color="#808080">,</font>mes<font color="#808080">,</font>ano<font color="#808080">,</font>hora<font color="#808080">,</font>min<font color="#808080">,</font>seg<font color="#808080">: </font>mstring<font color="#808080">;
</font><font color="#000080"><b>begin
  </b></font>GetDate<font color="#808080">(</font>y<font color="#808080">,</font>m<font color="#808080">,</font>d<font color="#808080">,</font>dow<font color="#808080">);
  </font>str<font color="#808080">(</font>d<font color="#808080">,</font>dia<font color="#808080">);
  </font>str<font color="#808080">(</font>m<font color="#808080">,</font>mes<font color="#808080">);
  </font>str<font color="#808080">(</font>y<font color="#808080">,</font>ano<font color="#808080">);
  </font>GetTime<font color="#808080">(</font>h<font color="#808080">,</font>mn<font color="#808080">,</font>s<font color="#808080">,</font>ms<font color="#808080">);
  </font>str<font color="#808080">(</font>h<font color="#808080">,</font>hora<font color="#808080">);
  </font>str<font color="#808080">(</font>mn<font color="#808080">,</font>min<font color="#808080">);
  </font>str<font color="#808080">(</font>s<font color="#808080">,</font>seg<font color="#808080">);
  </font>retDataHora<font color="#808080">:=</font>zeros<font color="#808080">(</font>dia<font color="#808080">,</font><font color="#FF0000">2</font><font color="#808080">) + </font><font color="#800000">'/'</font><font color="#808080">+  </font>zeros<font color="#808080">(</font>mes<font color="#808080">,</font><font color="#FF0000">2</font><font color="#808080">) + </font><font color="#800000">'/'</font><font color="#808080">+ </font>ano <font color="#808080">+ </font><font color="#800000">' '</font><font color="#808080">+
  </font>zeros<font color="#808080">(</font>hora<font color="#808080">,</font><font color="#FF0000">2</font><font color="#808080">)+</font><font color="#800000">':'</font><font color="#808080">+</font>zeros<font color="#808080">(</font>min<font color="#808080">,</font><font color="#FF0000">2</font><font color="#808080">)+</font><font color="#800000">':'</font><font color="#808080">+</font>zeros<font color="#808080">(</font>seg<font color="#808080">,</font><font color="#FF0000">2</font><font color="#808080">);
</font><font color="#000080"><b>end</b></font><font color="#808080">;
<i>{------------------------------------------------------------------------------
Calcula o tamanho do arquivo.
sArq - o arquivo
retorna - o tamanho do arquivo
------------------------------------------------------------------------------}
</i></font><font color="#000080"><b>function </b></font>tamArq<font color="#808080">(</font><font color="#000080"><b>var </b></font>sArq<font color="#808080">: </font><font color="#000080"><b>File</b></font><font color="#808080">): </font>integer<font color="#808080">;
</font><font color="#000080"><b>begin
</b></font>tamArq<font color="#808080">:=</font>FileSize<font color="#808080">(</font>sArq<font color="#808080">);
</font><font color="#000080"><b>end</b></font><font color="#808080">;
<i>{------------------------------------------------------------------------------
Abre ou cria os arquivos do sistema.
bAbre - condi&ccedil;&atilde;o para abrir ou criar os arquivos do sistema
------------------------------------------------------------------------------}
</i></font><font color="#000080"><b>procedure </b></font>abrecriaArqs<font color="#808080">(</font>bAbre<font color="#808080">: </font>boolean<font color="#808080">);
</font><font color="#000080"><b>begin
 </b></font>Assign<font color="#808080">(</font>tfAssunto<font color="#808080">, </font>ARQ_ASSUNTO<font color="#808080">);
 </font>Assign<font color="#808080">(</font>tfAutor<font color="#808080">, </font>ARQ_AUTOR<font color="#808080">);
 </font>Assign<font color="#808080">(</font>tfEditora<font color="#808080">, </font>ARQ_EDITORA<font color="#808080">);
 </font>Assign<font color="#808080">(</font>tfIdioma<font color="#808080">, </font>ARQ_IDIOMA<font color="#808080">);
 </font>Assign<font color="#808080">(</font>tfEndereco<font color="#808080">, </font>ARQ_ENDERECO<font color="#808080">);
 </font>Assign<font color="#808080">(</font>tfPais<font color="#808080">, </font>ARQ_PAIS<font color="#808080">);
 </font>Assign<font color="#808080">(</font>tfProfissao<font color="#808080">, </font>ARQ_PROFISSAO<font color="#808080">);
 </font>Assign<font color="#808080">(</font>tfLivro<font color="#808080">, </font>ARQ_LIVRO<font color="#808080">);
 </font>Assign<font color="#808080">(</font>tfLivroAss<font color="#808080">, </font>ARQ_LIVASS<font color="#808080">);
 </font>Assign<font color="#808080">(</font>tfLivroAut<font color="#808080">, </font>ARQ_LIVAUT<font color="#808080">);
 </font>Assign<font color="#808080">(</font>tfCliente<font color="#808080">, </font>ARQ_CLIENTE<font color="#808080">);
 </font>Assign<font color="#808080">(</font>tfUsuario<font color="#808080">, </font>ARQ_USUARIO<font color="#808080">);
 </font>Assign<font color="#808080">(</font>tfVenda<font color="#808080">, </font>ARQ_VENDA<font color="#808080">);
</font><font color="#000080"><b>if </b></font>bAbre <font color="#000080"><b>then begin
 </b></font>Reset<font color="#808080">(</font>tfAssunto<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">);
 </font>Reset<font color="#808080">(</font>tfAutor<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">);
 </font>Reset<font color="#808080">(</font>tfEditora<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">);
 </font>Reset<font color="#808080">(</font>tfIdioma<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">);
 </font>Reset<font color="#808080">(</font>tfEndereco<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">);
 </font>Reset<font color="#808080">(</font>tfPais<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">);
 </font>Reset<font color="#808080">(</font>tfProfissao<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">);
 </font>Reset<font color="#808080">(</font>tfLivro<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">);
 </font>Reset<font color="#808080">(</font>tfLivroAss<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">);
 </font>Reset<font color="#808080">(</font>tfLivroAut<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">);
 </font>Reset<font color="#808080">(</font>tfCliente<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">);
 </font>Reset<font color="#808080">(</font>tfUsuario<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">);
 </font>Reset<font color="#808080">(</font>tfVenda<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">);
</font><font color="#000080"><b>end else begin
 </b></font>rewrite<font color="#808080">(</font>tfAssunto<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">);
 </font>rewrite<font color="#808080">(</font>tfAutor<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">);
 </font>rewrite<font color="#808080">(</font>tfEditora<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">);
 </font>rewrite<font color="#808080">(</font>tfIdioma<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">);
 </font>rewrite<font color="#808080">(</font>tfEndereco<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">);
 </font>rewrite<font color="#808080">(</font>tfPais<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">);
 </font>rewrite<font color="#808080">(</font>tfProfissao<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">);
 </font>rewrite<font color="#808080">(</font>tfLivro<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">);
 </font>rewrite<font color="#808080">(</font>tfLivroAss<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">);
 </font>rewrite<font color="#808080">(</font>tfLivroAut<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">);
 </font>rewrite<font color="#808080">(</font>tfCliente<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">);
 </font>rewrite<font color="#808080">(</font>tfUsuario<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">);
 </font>rewrite<font color="#808080">(</font>tfVenda<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">);
</font><font color="#000080"><b>end</b></font><font color="#808080">;
</font><font color="#000080"><b>end</b></font><font color="#808080">;
<i>{------------------------------------------------------------------------------
Fecha todos os arquivos abertos.
------------------------------------------------------------------------------}
</i></font><font color="#000080"><b>procedure </b></font>fechaArqs<font color="#808080">;
</font><font color="#000080"><b>begin
 </b></font>close<font color="#808080">(</font>tfAssunto<font color="#808080">);
 </font>close<font color="#808080">(</font>tfAutor<font color="#808080">);
 </font>close<font color="#808080">(</font>tfEditora<font color="#808080">);
 </font>close<font color="#808080">(</font>tfIdioma<font color="#808080">);
 </font>close<font color="#808080">(</font>tfEndereco<font color="#808080">);
 </font>close<font color="#808080">(</font>tfPais<font color="#808080">);
 </font>close<font color="#808080">(</font>tfProfissao<font color="#808080">);
 </font>close<font color="#808080">(</font>tfLivro<font color="#808080">);
 </font>close<font color="#808080">(</font>tfLivroAss<font color="#808080">);
 </font>close<font color="#808080">(</font>tfLivroAut<font color="#808080">);
 </font>close<font color="#808080">(</font>tfCliente<font color="#808080">);
 </font>close<font color="#808080">(</font>tfUsuario<font color="#808080">);
 </font>close<font color="#808080">(</font>tfVenda<font color="#808080">);
</font><font color="#000080"><b>end</b></font><font color="#808080">;
<i>{------------------------------------------------------------------------------
Pesquisa um registro atrav&eacute;s de um valor chave num arquivo.
sArq - o arquivo
sChave - a chave a ser pesquisada
nPosChave - a posicao inicial da chave dentro do registro
nTamChave - o tamanho da chave dentro do registro
nTamLinha - o tamanho do registro
retorna - o registro pesquisado
------------------------------------------------------------------------------}
</i></font><font color="#000080"><b>function </b></font>pesqArq<font color="#808080">(</font><font color="#000080"><b>var </b></font>sArq<font color="#808080">: </font><font color="#000080"><b>File</b></font><font color="#808080">; </font>sChave<font color="#808080">: </font>mstring<font color="#808080">; </font>nPosChave<font color="#808080">,
        </font>nTamChave<font color="#808080">, </font>nTamLinha<font color="#808080">: </font>integer<font color="#808080">): </font>mstring<font color="#808080">;
</font><font color="#000080"><b>var </b></font>slinha<font color="#808080">: </font>tregistro<font color="#808080">;
    </font>sRes<font color="#808080">: </font>mstring<font color="#808080">;
    </font>bQuebra<font color="#808080">: </font>boolean<font color="#808080">;
    </font>nStatus<font color="#808080">, </font>nPosicao<font color="#808080">: </font>integer<font color="#808080">;
</font><font color="#000080"><b>begin
</b></font>bQuebra<font color="#808080">:=</font>false<font color="#808080">;
</font>seek<font color="#808080">(</font>sArq<font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">);
</font><font color="#000080"><b>while </b></font><font color="#808080">(</font><font color="#000080"><b>not </b></font>Eof<font color="#808080">(</font>sArq<font color="#808080">)) </font><font color="#000080"><b>and </b></font><font color="#808080">(</font>bQuebra<font color="#808080">=</font>false<font color="#808080">) </font><font color="#000080"><b>do begin
  </b></font>BlockRead<font color="#808080">(</font>sArq<font color="#808080">, </font>slinha<font color="#808080">, </font>nTamLinha <font color="#808080">+ </font>TAM_CRLF<font color="#808080">, </font>nStatus<font color="#808080">);
  </font>sres<font color="#808080">:=</font>trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha<font color="#808080">,</font>nPosChave<font color="#808080">,</font>nTamChave<font color="#808080">));
  </font><font color="#000080"><b>if </b></font>sres<font color="#808080">=</font>sChave <font color="#000080"><b>then
     </b></font>bQuebra<font color="#808080">:=</font>true<font color="#808080">;
</font><font color="#000080"><b>end</b></font><font color="#808080">;
</font>nPosicao<font color="#808080">:=</font>FilePos<font color="#808080">(</font>sArq<font color="#808080">)-(</font>nTamLinha <font color="#808080">+ </font>TAM_CRLF<font color="#808080">);
</font><font color="#000080"><b>if </b></font>nPosicao <font color="#808080">&gt; </font><font color="#FF0000">0 </font><font color="#000080"><b>then
   </b></font>seek<font color="#808080">(</font>sArq<font color="#808080">, </font>nPosicao<font color="#808080">)
</font><font color="#000080"><b>else
   </b></font>seek<font color="#808080">(</font>sArq<font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">);
</font><font color="#000080"><b>if </b></font>sRes<font color="#808080">&lt;&gt;</font>sChave <font color="#000080"><b>then
   </b></font>pesqArq<font color="#808080">:=</font><font color="#800000">''
</font><font color="#000080"><b>else
   </b></font>pesqArq<font color="#808080">:=</font>copy<font color="#808080">(</font>slinha<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font>nTamLinha<font color="#808080">);
</font><font color="#000080"><b>end</b></font><font color="#808080">;
<i>{------------------------------------------------------------------------------
Pesquisa se tem linha exclu&iacute;da sen&atilde;o vai para a &uacute;ltima linha do arquivo.
sArq - o arquivo
nTamLinha - o tamanho do registro
------------------------------------------------------------------------------}
</i></font><font color="#000080"><b>procedure </b></font>pesqLinhaExcluida<font color="#808080">(</font><font color="#000080"><b>var </b></font>sArq<font color="#808080">: </font><font color="#000080"><b>File</b></font><font color="#808080">; </font>nTamLinha<font color="#808080">: </font>integer<font color="#808080">);
</font><font color="#000080"><b>var </b></font>sExcluido<font color="#808080">: </font>mstring<font color="#808080">;
</font><font color="#000080"><b>begin
</b></font>sExcluido<font color="#808080">:=</font>pesqArq<font color="#808080">(</font>sArq<font color="#808080">, </font><font color="#800000">'*'</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font>nTamLinha<font color="#808080">);
</font><font color="#000080"><b>if </b></font>sExcluido<font color="#808080">=</font><font color="#800000">'' </font><font color="#000080"><b>then
   </b></font>seek<font color="#808080">(</font>sArq<font color="#808080">, </font>tamArq<font color="#808080">(</font>sArq<font color="#808080">));
</font><font color="#000080"><b>end</b></font><font color="#808080">;
<i>{------------------------------------------------------------------------------
Pesquisa o maior c&oacute;digo num arquivo.
sArq - o arquivo
nPosChave - a posicao inicial da chave dentro do registro
nTamChave - o tamanho da chave dentro do registro
nTamLinha - o tamanho do registro
retorna - o maior c&oacute;digo
------------------------------------------------------------------------------}
</i></font><font color="#000080"><b>function </b></font>pesqMaxCod<font color="#808080">(</font><font color="#000080"><b>var </b></font>sArq<font color="#808080">: </font><font color="#000080"><b>File</b></font><font color="#808080">; </font>nPosChave<font color="#808080">,
        </font>nTamChave<font color="#808080">, </font>nTamLinha<font color="#808080">: </font>integer<font color="#808080">): </font>mstring<font color="#808080">;
</font><font color="#000080"><b>var </b></font>slinha<font color="#808080">: </font>tregistro<font color="#808080">;
    </font>sRes<font color="#808080">: </font>mstring<font color="#808080">;
    </font>bQuebra<font color="#808080">: </font>boolean<font color="#808080">;
    </font>nStatus<font color="#808080">, </font>nMaior<font color="#808080">, </font>nCod<font color="#808080">: </font>integer<font color="#808080">;
</font><font color="#000080"><b>begin
</b></font>bQuebra<font color="#808080">:=</font>false<font color="#808080">;
</font>nMaior<font color="#808080">:=</font><font color="#FF0000">0</font><font color="#808080">;
</font>seek<font color="#808080">(</font>sArq<font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">);
</font><font color="#000080"><b>while </b></font><font color="#808080">(</font><font color="#000080"><b>not </b></font>Eof<font color="#808080">(</font>sArq<font color="#808080">)) </font><font color="#000080"><b>and </b></font><font color="#808080">(</font>bQuebra<font color="#808080">=</font>false<font color="#808080">) </font><font color="#000080"><b>do begin
  </b></font>BlockRead<font color="#808080">(</font>sArq<font color="#808080">, </font>slinha<font color="#808080">, </font>nTamLinha <font color="#808080">+ </font>TAM_CRLF<font color="#808080">, </font>nStatus<font color="#808080">);
  </font>sres<font color="#808080">:=</font>trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha<font color="#808080">,</font>nPosChave<font color="#808080">,</font>nTamChave<font color="#808080">));
  </font>Val<font color="#808080">(</font>sres<font color="#808080">,</font>ncod<font color="#808080">,</font>nStatus<font color="#808080">);
  </font><font color="#000080"><b>if </b></font>nCod <font color="#808080">&gt; </font>nMaior <font color="#000080"><b>then
     </b></font>nMaior<font color="#808080">:=</font>nCod<font color="#808080">;
</font><font color="#000080"><b>end</b></font><font color="#808080">;
</font>pesqLinhaExcluida<font color="#808080">(</font>sArq<font color="#808080">, </font>nTamLinha<font color="#808080">);
</font>str<font color="#808080">((</font>nMaior<font color="#808080">+</font><font color="#FF0000">1</font><font color="#808080">),</font>sres<font color="#808080">);
</font>pesqMaxCod<font color="#808080">:=</font>sres<font color="#808080">;
</font><font color="#000080"><b>end</b></font><font color="#808080">;
<i>{------------------------------------------------------------------------------
Grava os registros num determinado arquivo.
sArq - o arquivo
sTexto - o registro a ser gravado
sMsgAcerto - a mensagem caso o registro foi gravado
sMsgErro - a mensagem caso o registro n&atilde;o foi gravado
------------------------------------------------------------------------------}
</i></font><font color="#000080"><b>procedure </b></font>escreveArq<font color="#808080">(</font><font color="#000080"><b>var </b></font>sArq<font color="#808080">: </font><font color="#000080"><b>File</b></font><font color="#808080">; </font>sTexto<font color="#808080">, </font>sMsgAcerto<font color="#808080">,
</font>	sMsgErro<font color="#808080">: </font>mstring<font color="#808080">);
</font><font color="#000080"><b>var </b></font>nStatus<font color="#808080">, </font>ncont<font color="#808080">: </font>integer<font color="#808080">;
    </font>slinha<font color="#808080">: </font>tregistro<font color="#808080">;
</font><font color="#000080"><b>begin
</b></font>sTexto<font color="#808080">:=</font>sTexto<font color="#808080">+</font>CRLF<font color="#808080">;
</font><font color="#000080"><b>for </b></font>ncont<font color="#808080">:=</font><font color="#FF0000">1 </font><font color="#000080"><b>to </b></font>length<font color="#808080">(</font>sTexto<font color="#808080">) </font><font color="#000080"><b>do begin
    </b></font>slinha<font color="#808080">[</font>ncont<font color="#808080">]:=</font>sTexto<font color="#808080">[</font>ncont<font color="#808080">];
</font><font color="#000080"><b>end</b></font><font color="#808080">;
</font>BlockWrite<font color="#808080">(</font>sArq<font color="#808080">, </font>slinha<font color="#808080">, </font>length<font color="#808080">(</font>sTexto<font color="#808080">), </font>nStatus<font color="#808080">);
</font><font color="#000080"><b>if </b></font>nStatus <font color="#808080">&gt; </font><font color="#FF0000">0 </font><font color="#000080"><b>then begin
   </b></font>writeln<font color="#808080">(</font>sMsgAcerto<font color="#808080">);
</font><font color="#000080"><b>end else begin
   </b></font>writeln<font color="#808080">(</font>sMsgErro<font color="#808080">);
</font><font color="#000080"><b>end</b></font><font color="#808080">;
</font><font color="#000080"><b>end</b></font><font color="#808080">;
<i>{------------------------------------------------------------------------------
Monta o tamanho do registro no arquivo de acordo com o tipo de arquivo.
sreg - o tipo de arquivo
retorna - o registro montado
------------------------------------------------------------------------------}
</i></font><font color="#000080"><b>function </b></font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">: </font>ctArqs<font color="#808080">): </font>mstring<font color="#808080">;
</font><font color="#000080"><b>var </b></font>slinha<font color="#808080">: </font>mstring<font color="#808080">;
</font><font color="#000080"><b>begin
</b></font>slinha<font color="#808080">:=</font><font color="#800000">''</font><font color="#808080">;
</font><font color="#000080"><b>if </b></font>opAssunto <font color="#000080"><b>in </b></font>sreg <font color="#000080"><b>then
   </b></font>slinha<font color="#808080">:=</font>esp<font color="#808080">(</font>tAssunto<font color="#808080">.</font>codigo<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">)+</font>esp<font color="#808080">(</font>tAssunto<font color="#808080">.</font>assunto<font color="#808080">,</font><font color="#FF0000">30</font><font color="#808080">)
</font><font color="#000080"><b>else if </b></font>opAutor <font color="#000080"><b>in </b></font>sreg <font color="#000080"><b>then
   </b></font>slinha<font color="#808080">:=</font>esp<font color="#808080">(</font>tAutor<font color="#808080">.</font>codigo<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">)+</font>esp<font color="#808080">(</font>tAutor<font color="#808080">.</font>autor<font color="#808080">,</font><font color="#FF0000">30</font><font color="#808080">)
</font><font color="#000080"><b>else if </b></font>opEditora <font color="#000080"><b>in </b></font>sreg <font color="#000080"><b>then
   </b></font>slinha<font color="#808080">:=</font>esp<font color="#808080">(</font>tEditora<font color="#808080">.</font>codigo<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">)+</font>esp<font color="#808080">(</font>tEditora<font color="#808080">.</font>editora<font color="#808080">,</font><font color="#FF0000">50</font><font color="#808080">)
</font><font color="#000080"><b>else if </b></font>opEndereco <font color="#000080"><b>in </b></font>sreg <font color="#000080"><b>then
   </b></font>slinha<font color="#808080">:=</font>esp<font color="#808080">(</font>tEndereco<font color="#808080">.</font>codigo<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">)+</font>esp<font color="#808080">(</font>tEndereco<font color="#808080">.</font>logradouro<font color="#808080">,</font><font color="#FF0000">40</font><font color="#808080">)+
   </font>esp<font color="#808080">(</font>tEndereco<font color="#808080">.</font>bairro<font color="#808080">,</font><font color="#FF0000">15</font><font color="#808080">)+</font>esp<font color="#808080">(</font>tEndereco<font color="#808080">.</font>cep<font color="#808080">,</font><font color="#FF0000">8</font><font color="#808080">)+</font>esp<font color="#808080">(</font>tEndereco<font color="#808080">.</font>cidade<font color="#808080">,</font><font color="#FF0000">30</font><font color="#808080">)+
   </font>esp<font color="#808080">(</font>tEndereco<font color="#808080">.</font>estado<font color="#808080">,</font><font color="#FF0000">20</font><font color="#808080">)
</font><font color="#000080"><b>else if </b></font>opIdioma <font color="#000080"><b>in </b></font>sreg <font color="#000080"><b>then
   </b></font>slinha<font color="#808080">:=</font>esp<font color="#808080">(</font>tIdioma<font color="#808080">.</font>codigo<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">)+</font>esp<font color="#808080">(</font>tIdioma<font color="#808080">.</font>idioma<font color="#808080">,</font><font color="#FF0000">20</font><font color="#808080">)
</font><font color="#000080"><b>else if </b></font>opPais <font color="#000080"><b>in </b></font>sreg <font color="#000080"><b>then
   </b></font>slinha<font color="#808080">:=</font>esp<font color="#808080">(</font>tPais<font color="#808080">.</font>codigo<font color="#808080">,</font><font color="#FF0000">3</font><font color="#808080">)+</font>esp<font color="#808080">(</font>tPais<font color="#808080">.</font>pais<font color="#808080">,</font><font color="#FF0000">50</font><font color="#808080">)
</font><font color="#000080"><b>else if </b></font>opProfissao <font color="#000080"><b>in </b></font>sreg <font color="#000080"><b>then
   </b></font>slinha<font color="#808080">:=</font>esp<font color="#808080">(</font>tProfissao<font color="#808080">.</font>codigo<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">)+</font>esp<font color="#808080">(</font>tProfissao<font color="#808080">.</font>profissao<font color="#808080">,</font><font color="#FF0000">50</font><font color="#808080">)
</font><font color="#000080"><b>else if </b></font>opUsuario <font color="#000080"><b>in </b></font>sreg <font color="#000080"><b>then
   </b></font>slinha<font color="#808080">:=</font>esp<font color="#808080">(</font>tUsuario<font color="#808080">.</font>login<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">)+</font>esp<font color="#808080">(</font>tUsuario<font color="#808080">.</font>senha<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">)
</font><font color="#000080"><b>else if </b></font>opLivro <font color="#000080"><b>in </b></font>sreg <font color="#000080"><b>then
   </b></font>slinha<font color="#808080">:=</font>esp<font color="#808080">(</font>tLivro<font color="#808080">.</font>isbn<font color="#808080">,</font><font color="#FF0000">13</font><font color="#808080">)+</font>esp<font color="#808080">(</font>tLivro<font color="#808080">.</font>titulo<font color="#808080">,</font><font color="#FF0000">50</font><font color="#808080">)+</font>esp<font color="#808080">(</font>tLivro<font color="#808080">.</font>edicao<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">)+
   </font>esp<font color="#808080">(</font>tLivro<font color="#808080">.</font>anopubli<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">)+</font>esp<font color="#808080">(</font>tLivro<font color="#808080">.</font>codeditora<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">)+</font>esp<font color="#808080">(</font>tLivro<font color="#808080">.</font>volume<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">)+
   </font>esp<font color="#808080">(</font>tLivro<font color="#808080">.</font>codidioma<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">)+</font>esp<font color="#808080">(</font>tLivro<font color="#808080">.</font>npaginas<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">)+</font>esp<font color="#808080">(</font>tLivro<font color="#808080">.</font>preco<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">)+
   </font>esp<font color="#808080">(</font>tLivro<font color="#808080">.</font>qtdestoque<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">)
</font><font color="#000080"><b>else if </b></font>opLivroAss <font color="#000080"><b>in </b></font>sreg <font color="#000080"><b>then
   </b></font>slinha<font color="#808080">:=</font>esp<font color="#808080">(</font>tLivroAss<font color="#808080">.</font>isbn<font color="#808080">,</font><font color="#FF0000">13</font><font color="#808080">)+</font>esp<font color="#808080">(</font>tlivroAss<font color="#808080">.</font>codassunto<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">)
</font><font color="#000080"><b>else if </b></font>opLivroAut <font color="#000080"><b>in </b></font>sreg <font color="#000080"><b>then
   </b></font>slinha<font color="#808080">:=</font>esp<font color="#808080">(</font>tLivroAut<font color="#808080">.</font>isbn<font color="#808080">,</font><font color="#FF0000">13</font><font color="#808080">)+</font>esp<font color="#808080">(</font>tlivroAut<font color="#808080">.</font>codautor<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">)
</font><font color="#000080"><b>else if </b></font>opCliente <font color="#000080"><b>in </b></font>sreg <font color="#000080"><b>then
   </b></font>slinha<font color="#808080">:=</font>esp<font color="#808080">(</font>tCliente<font color="#808080">.</font>cpf<font color="#808080">,</font><font color="#FF0000">14</font><font color="#808080">)+</font>esp<font color="#808080">(</font>tCliente<font color="#808080">.</font>nome<font color="#808080">,</font><font color="#FF0000">30</font><font color="#808080">)+</font>esp<font color="#808080">(</font>tCliente<font color="#808080">.</font>email<font color="#808080">,</font><font color="#FF0000">30</font><font color="#808080">)+
   </font>esp<font color="#808080">(</font>tCliente<font color="#808080">.</font>identidade<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">)+</font>esp<font color="#808080">(</font>tCliente<font color="#808080">.</font>sexo<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">)+</font>esp<font color="#808080">(</font>tCliente<font color="#808080">.</font>telefone<font color="#808080">,</font><font color="#FF0000">17</font><font color="#808080">)+
   </font>esp<font color="#808080">(</font>tCliente<font color="#808080">.</font>dtnascimento<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">)+</font>esp<font color="#808080">(</font>tCliente<font color="#808080">.</font>codendereco<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">)+
   </font>esp<font color="#808080">(</font>tCliente<font color="#808080">.</font>codpais<font color="#808080">,</font><font color="#FF0000">3</font><font color="#808080">)+</font>esp<font color="#808080">(</font>tCliente<font color="#808080">.</font>codprofissao<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">)
</font><font color="#000080"><b>else if </b></font>opVenda <font color="#000080"><b>in </b></font>sreg <font color="#000080"><b>then
   </b></font>slinha<font color="#808080">:=</font>esp<font color="#808080">(</font>tVenda<font color="#808080">.</font>dthrvenda<font color="#808080">,</font><font color="#FF0000">19</font><font color="#808080">)+</font>esp<font color="#808080">(</font>tVenda<font color="#808080">.</font>cpf<font color="#808080">,</font><font color="#FF0000">14</font><font color="#808080">)+</font>esp<font color="#808080">(</font>tVenda<font color="#808080">.</font>isbn<font color="#808080">,</font><font color="#FF0000">13</font><font color="#808080">)+
   </font>esp<font color="#808080">(</font>tVenda<font color="#808080">.</font>precovenda<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">);

</font>LinhaReg<font color="#808080">:=</font>slinha<font color="#808080">;
</font><font color="#000080"><b>end</b></font><font color="#808080">;
<i>{------------------------------------------------------------------------------
Retorna o tamanho do registro no arquivo de acordo com o tipo de arquivo.
sreg - o tipo de arquivo
retorna - o tamanho do registro
------------------------------------------------------------------------------}
</i></font><font color="#000080"><b>function </b></font>tamReg<font color="#808080">(</font>sreg<font color="#808080">: </font>ctArqs<font color="#808080">): </font>integer<font color="#808080">;
</font><font color="#000080"><b>var </b></font>nret<font color="#808080">: </font>integer<font color="#808080">;
</font><font color="#000080"><b>begin
</b></font>nret<font color="#808080">:=</font><font color="#FF0000">0</font><font color="#808080">;
</font><font color="#000080"><b>if </b></font>opAssunto <font color="#000080"><b>in </b></font>sreg <font color="#000080"><b>then </b></font>nret<font color="#808080">:=</font>TAM_ASSUNTO
<font color="#000080"><b>else if </b></font>opAutor <font color="#000080"><b>in </b></font>sreg <font color="#000080"><b>then </b></font>nret<font color="#808080">:=</font>TAM_AUTOR
<font color="#000080"><b>else if </b></font>opEditora <font color="#000080"><b>in </b></font>sreg <font color="#000080"><b>then </b></font>nret<font color="#808080">:=</font>TAM_EDITORA
<font color="#000080"><b>else if </b></font>opEndereco <font color="#000080"><b>in </b></font>sreg <font color="#000080"><b>then </b></font>nret<font color="#808080">:=</font>TAM_ENDERECO
<font color="#000080"><b>else if </b></font>opIdioma <font color="#000080"><b>in </b></font>sreg <font color="#000080"><b>then </b></font>nret<font color="#808080">:=</font>TAM_IDIOMA
<font color="#000080"><b>else if </b></font>opPais <font color="#000080"><b>in </b></font>sreg <font color="#000080"><b>then </b></font>nret<font color="#808080">:=</font>TAM_PAIS
<font color="#000080"><b>else if </b></font>opProfissao <font color="#000080"><b>in </b></font>sreg <font color="#000080"><b>then </b></font>nret<font color="#808080">:=</font>TAM_PROFISSAO
<font color="#000080"><b>else if </b></font>opUsuario <font color="#000080"><b>in </b></font>sreg <font color="#000080"><b>then </b></font>nret<font color="#808080">:=</font>TAM_USUARIO
<font color="#000080"><b>else if </b></font>opLivro <font color="#000080"><b>in </b></font>sreg <font color="#000080"><b>then </b></font>nret<font color="#808080">:=</font>TAM_LIVRO
<font color="#000080"><b>else if </b></font>opLivroAss <font color="#000080"><b>in </b></font>sreg <font color="#000080"><b>then </b></font>nret<font color="#808080">:=</font>TAM_LIVASS
<font color="#000080"><b>else if </b></font>opLivroAut <font color="#000080"><b>in </b></font>sreg <font color="#000080"><b>then </b></font>nret<font color="#808080">:=</font>TAM_LIVAUT
<font color="#000080"><b>else if </b></font>opCliente <font color="#000080"><b>in </b></font>sreg <font color="#000080"><b>then </b></font>nret<font color="#808080">:=</font>TAM_CLIENTE
<font color="#000080"><b>else if </b></font>opVenda <font color="#000080"><b>in </b></font>sreg <font color="#000080"><b>then </b></font>nret<font color="#808080">:=</font>TAM_VENDA<font color="#808080">;

</font>tamReg<font color="#808080">:=</font>nret<font color="#808080">;
</font><font color="#000080"><b>end</b></font><font color="#808080">;
<i>{------------------------------------------------------------------------------
Seleciona o rotulo de cada campo de acordo com o tipo de arquivo.
sreg - o tipo de arquivo
nNum - indica qual rotulo ser&aacute; retornado
retorna - o rotulo
------------------------------------------------------------------------------}
</i></font><font color="#000080"><b>function </b></font>rotulo<font color="#808080">(</font>sreg<font color="#808080">: </font>ctArqs<font color="#808080">; </font>nNum<font color="#808080">: </font>integer<font color="#808080">): </font>mstring<font color="#808080">;
</font><font color="#000080"><b>var </b></font>sret<font color="#808080">: </font>mstring<font color="#808080">;
</font><font color="#000080"><b>begin
</b></font>sret<font color="#808080">:=</font><font color="#800000">''</font><font color="#808080">;
</font><font color="#000080"><b>if </b></font>opAssunto <font color="#000080"><b>in </b></font>sreg <font color="#000080"><b>then begin
   case </b></font>nNum <font color="#000080"><b>of
     </b></font><font color="#FF0000">0</font><font color="#808080">: </font>sret<font color="#808080">:=</font><font color="#800000">'Assunto(s) n&atilde;o encontrado(s)!'</font><font color="#808080">;
     </font><font color="#FF0000">1</font><font color="#808080">: </font><font color="#000080"><b>begin
         </b></font>sret<font color="#808080">:=</font><font color="#800000">'C&oacute;digo do assunto: '</font><font color="#808080">;
         </font>g_nPosChave<font color="#808080">:=</font><font color="#FF0000">1</font><font color="#808080">;
         </font>g_nTamChave<font color="#808080">:=</font><font color="#FF0000">10</font><font color="#808080">;
        </font><font color="#000080"><b>end</b></font><font color="#808080">;
     </font><font color="#FF0000">2</font><font color="#808080">: </font><font color="#000080"><b>begin
         </b></font>sret<font color="#808080">:=</font><font color="#800000">'Assunto: '</font><font color="#808080">;
         </font>g_nPosChave<font color="#808080">:=</font><font color="#FF0000">11</font><font color="#808080">;
         </font>g_nTamChave<font color="#808080">:=</font><font color="#FF0000">30</font><font color="#808080">;
        </font><font color="#000080"><b>end</b></font><font color="#808080">;
   </font><font color="#000080"><b>end</b></font><font color="#808080">;
</font><font color="#000080"><b>end else if </b></font>opAutor <font color="#000080"><b>in </b></font>sreg <font color="#000080"><b>then begin
   case </b></font>nNum <font color="#000080"><b>of
     </b></font><font color="#FF0000">0</font><font color="#808080">: </font>sret<font color="#808080">:=</font><font color="#800000">'Autor(es) n&atilde;o encontrado(s)!'</font><font color="#808080">;
     </font><font color="#FF0000">1</font><font color="#808080">: </font><font color="#000080"><b>begin
         </b></font>sret<font color="#808080">:=</font><font color="#800000">'C&oacute;digo do autor: '</font><font color="#808080">;
         </font>g_nPosChave<font color="#808080">:=</font><font color="#FF0000">1</font><font color="#808080">;
         </font>g_nTamChave<font color="#808080">:=</font><font color="#FF0000">10</font><font color="#808080">;
        </font><font color="#000080"><b>end</b></font><font color="#808080">;
     </font><font color="#FF0000">2</font><font color="#808080">: </font><font color="#000080"><b>begin
         </b></font>sret<font color="#808080">:=</font><font color="#800000">'Autor: '</font><font color="#808080">;
         </font>g_nPosChave<font color="#808080">:=</font><font color="#FF0000">11</font><font color="#808080">;
         </font>g_nTamChave<font color="#808080">:=</font><font color="#FF0000">30</font><font color="#808080">;
        </font><font color="#000080"><b>end</b></font><font color="#808080">;
   </font><font color="#000080"><b>end</b></font><font color="#808080">;
</font><font color="#000080"><b>end else if </b></font>opEditora <font color="#000080"><b>in </b></font>sreg <font color="#000080"><b>then begin
   case </b></font>nNum <font color="#000080"><b>of
     </b></font><font color="#FF0000">0</font><font color="#808080">: </font>sret<font color="#808080">:=</font><font color="#800000">'Editora(s) n&atilde;o encontrada(s)!'</font><font color="#808080">;
     </font><font color="#FF0000">1</font><font color="#808080">: </font><font color="#000080"><b>begin
         </b></font>sret<font color="#808080">:=</font><font color="#800000">'C&oacute;digo da editora: '</font><font color="#808080">;
         </font>g_nPosChave<font color="#808080">:=</font><font color="#FF0000">1</font><font color="#808080">;
         </font>g_nTamChave<font color="#808080">:=</font><font color="#FF0000">10</font><font color="#808080">;
        </font><font color="#000080"><b>end</b></font><font color="#808080">;
     </font><font color="#FF0000">2</font><font color="#808080">: </font><font color="#000080"><b>begin
         </b></font>sret<font color="#808080">:=</font><font color="#800000">'Editora: '</font><font color="#808080">;
         </font>g_nPosChave<font color="#808080">:=</font><font color="#FF0000">11</font><font color="#808080">;
         </font>g_nTamChave<font color="#808080">:=</font><font color="#FF0000">50</font><font color="#808080">;
        </font><font color="#000080"><b>end</b></font><font color="#808080">;
   </font><font color="#000080"><b>end</b></font><font color="#808080">;
</font><font color="#000080"><b>end else if </b></font>opEndereco <font color="#000080"><b>in </b></font>sreg <font color="#000080"><b>then begin
   case </b></font>nNum <font color="#000080"><b>of
     </b></font><font color="#FF0000">0</font><font color="#808080">: </font>sret<font color="#808080">:=</font><font color="#800000">'Endere&ccedil;o(s) n&atilde;o encontrado(s)!'</font><font color="#808080">;
     </font><font color="#FF0000">1</font><font color="#808080">: </font><font color="#000080"><b>begin
         </b></font>sret<font color="#808080">:=</font><font color="#800000">'C&oacute;digo do endere&ccedil;o: '</font><font color="#808080">;
         </font>g_nPosChave<font color="#808080">:=</font><font color="#FF0000">1</font><font color="#808080">;
         </font>g_nTamChave<font color="#808080">:=</font><font color="#FF0000">10</font><font color="#808080">;
        </font><font color="#000080"><b>end</b></font><font color="#808080">;
     </font><font color="#FF0000">2</font><font color="#808080">: </font><font color="#000080"><b>begin
         </b></font>sret<font color="#808080">:=</font><font color="#800000">'Logradouro: '</font><font color="#808080">;
         </font>g_nPosChave<font color="#808080">:=</font><font color="#FF0000">11</font><font color="#808080">;
         </font>g_nTamChave<font color="#808080">:=</font><font color="#FF0000">40</font><font color="#808080">;
        </font><font color="#000080"><b>end</b></font><font color="#808080">;
     </font><font color="#FF0000">3</font><font color="#808080">: </font><font color="#000080"><b>begin
         </b></font>sret<font color="#808080">:=</font><font color="#800000">'Bairro: '</font><font color="#808080">;
         </font>g_nPosChave<font color="#808080">:=</font><font color="#FF0000">51</font><font color="#808080">;
         </font>g_nTamChave<font color="#808080">:=</font><font color="#FF0000">15</font><font color="#808080">;
        </font><font color="#000080"><b>end</b></font><font color="#808080">;
     </font><font color="#FF0000">4</font><font color="#808080">: </font><font color="#000080"><b>begin
         </b></font>sret<font color="#808080">:=</font><font color="#800000">'CEP: '</font><font color="#808080">;
         </font>g_nPosChave<font color="#808080">:=</font><font color="#FF0000">66</font><font color="#808080">;
         </font>g_nTamChave<font color="#808080">:=</font><font color="#FF0000">8</font><font color="#808080">;
        </font><font color="#000080"><b>end</b></font><font color="#808080">;
     </font><font color="#FF0000">5</font><font color="#808080">: </font><font color="#000080"><b>begin
         </b></font>sret<font color="#808080">:=</font><font color="#800000">'Cidade: '</font><font color="#808080">;
         </font>g_nPosChave<font color="#808080">:=</font><font color="#FF0000">74</font><font color="#808080">;
         </font>g_nTamChave<font color="#808080">:=</font><font color="#FF0000">30</font><font color="#808080">;
        </font><font color="#000080"><b>end</b></font><font color="#808080">;
     </font><font color="#FF0000">6</font><font color="#808080">: </font><font color="#000080"><b>begin
         </b></font>sret<font color="#808080">:=</font><font color="#800000">'Estado: '</font><font color="#808080">;
         </font>g_nPosChave<font color="#808080">:=</font><font color="#FF0000">104</font><font color="#808080">;
         </font>g_nTamChave<font color="#808080">:=</font><font color="#FF0000">20</font><font color="#808080">;
        </font><font color="#000080"><b>end</b></font><font color="#808080">;
   </font><font color="#000080"><b>end</b></font><font color="#808080">;
</font><font color="#000080"><b>end else if </b></font>opIdioma <font color="#000080"><b>in </b></font>sreg <font color="#000080"><b>then begin
   case </b></font>nNum <font color="#000080"><b>of
     </b></font><font color="#FF0000">0</font><font color="#808080">: </font>sret<font color="#808080">:=</font><font color="#800000">'Idioma(s) n&atilde;o encontrado(s)!'</font><font color="#808080">;
     </font><font color="#FF0000">1</font><font color="#808080">: </font><font color="#000080"><b>begin
         </b></font>sret<font color="#808080">:=</font><font color="#800000">'C&oacute;digo do idioma: '</font><font color="#808080">;
         </font>g_nPosChave<font color="#808080">:=</font><font color="#FF0000">1</font><font color="#808080">;
         </font>g_nTamChave<font color="#808080">:=</font><font color="#FF0000">10</font><font color="#808080">;
        </font><font color="#000080"><b>end</b></font><font color="#808080">;
     </font><font color="#FF0000">2</font><font color="#808080">: </font><font color="#000080"><b>begin
         </b></font>sret<font color="#808080">:=</font><font color="#800000">'Idioma: '</font><font color="#808080">;
         </font>g_nPosChave<font color="#808080">:=</font><font color="#FF0000">11</font><font color="#808080">;
         </font>g_nTamChave<font color="#808080">:=</font><font color="#FF0000">20</font><font color="#808080">;
        </font><font color="#000080"><b>end</b></font><font color="#808080">;
   </font><font color="#000080"><b>end</b></font><font color="#808080">;
</font><font color="#000080"><b>end else if </b></font>opPais <font color="#000080"><b>in </b></font>sreg <font color="#000080"><b>then begin
   case </b></font>nNum <font color="#000080"><b>of
     </b></font><font color="#FF0000">0</font><font color="#808080">: </font>sret<font color="#808080">:=</font><font color="#800000">'Pa&iacute;s(es) n&atilde;o encontrado(s)!'</font><font color="#808080">;
     </font><font color="#FF0000">1</font><font color="#808080">: </font><font color="#000080"><b>begin
         </b></font>sret<font color="#808080">:=</font><font color="#800000">'C&oacute;digo do pa&iacute;s: '</font><font color="#808080">;
         </font>g_nPosChave<font color="#808080">:=</font><font color="#FF0000">1</font><font color="#808080">;
         </font>g_nTamChave<font color="#808080">:=</font><font color="#FF0000">3</font><font color="#808080">;
        </font><font color="#000080"><b>end</b></font><font color="#808080">;
     </font><font color="#FF0000">2</font><font color="#808080">: </font><font color="#000080"><b>begin
         </b></font>sret<font color="#808080">:=</font><font color="#800000">'Pa&iacute;s: '</font><font color="#808080">;
         </font>g_nPosChave<font color="#808080">:=</font><font color="#FF0000">4</font><font color="#808080">;
         </font>g_nTamChave<font color="#808080">:=</font><font color="#FF0000">50</font><font color="#808080">;
        </font><font color="#000080"><b>end</b></font><font color="#808080">;
   </font><font color="#000080"><b>end</b></font><font color="#808080">;
</font><font color="#000080"><b>end else if </b></font>opProfissao <font color="#000080"><b>in </b></font>sreg <font color="#000080"><b>then begin
   case </b></font>nNum <font color="#000080"><b>of
     </b></font><font color="#FF0000">0</font><font color="#808080">: </font>sret<font color="#808080">:=</font><font color="#800000">'Profiss&atilde;o(es) n&atilde;o encontrada(s)!'</font><font color="#808080">;
     </font><font color="#FF0000">1</font><font color="#808080">: </font><font color="#000080"><b>begin
         </b></font>sret<font color="#808080">:=</font><font color="#800000">'C&oacute;digo da profiss&atilde;o: '</font><font color="#808080">;
         </font>g_nPosChave<font color="#808080">:=</font><font color="#FF0000">1</font><font color="#808080">;
         </font>g_nTamChave<font color="#808080">:=</font><font color="#FF0000">10</font><font color="#808080">;
        </font><font color="#000080"><b>end</b></font><font color="#808080">;
     </font><font color="#FF0000">2</font><font color="#808080">: </font><font color="#000080"><b>begin
         </b></font>sret<font color="#808080">:=</font><font color="#800000">'Profiss&atilde;o: '</font><font color="#808080">;
         </font>g_nPosChave<font color="#808080">:=</font><font color="#FF0000">11</font><font color="#808080">;
         </font>g_nTamChave<font color="#808080">:=</font><font color="#FF0000">50</font><font color="#808080">;
        </font><font color="#000080"><b>end</b></font><font color="#808080">;
   </font><font color="#000080"><b>end</b></font><font color="#808080">;
</font><font color="#000080"><b>end else if </b></font>opUsuario <font color="#000080"><b>in </b></font>sreg <font color="#000080"><b>then begin
   case </b></font>nNum <font color="#000080"><b>of
     </b></font><font color="#FF0000">0</font><font color="#808080">: </font>sret<font color="#808080">:=</font><font color="#800000">'login ou senha incorreta, tente de novo!'</font><font color="#808080">;
     </font><font color="#FF0000">1</font><font color="#808080">: </font><font color="#000080"><b>begin
         </b></font>sret<font color="#808080">:=</font><font color="#800000">'Login: '</font><font color="#808080">;
         </font>g_nPosChave<font color="#808080">:=</font><font color="#FF0000">1</font><font color="#808080">;
         </font>g_nTamChave<font color="#808080">:=</font><font color="#FF0000">10</font><font color="#808080">;
        </font><font color="#000080"><b>end</b></font><font color="#808080">;
     </font><font color="#FF0000">2</font><font color="#808080">: </font><font color="#000080"><b>begin
         </b></font>sret<font color="#808080">:=</font><font color="#800000">'Senha: '</font><font color="#808080">;
         </font>g_nPosChave<font color="#808080">:=</font><font color="#FF0000">11</font><font color="#808080">;
         </font>g_nTamChave<font color="#808080">:=</font><font color="#FF0000">10</font><font color="#808080">;
        </font><font color="#000080"><b>end</b></font><font color="#808080">;
   </font><font color="#000080"><b>end</b></font><font color="#808080">;
</font><font color="#000080"><b>end else if </b></font>opLivro <font color="#000080"><b>in </b></font>sreg <font color="#000080"><b>then begin
   case </b></font>nNum <font color="#000080"><b>of
     </b></font><font color="#FF0000">0</font><font color="#808080">: </font>sret<font color="#808080">:=</font><font color="#800000">'Livro(s) n&atilde;o encontrado(s)!'</font><font color="#808080">;
     </font><font color="#FF0000">1</font><font color="#808080">: </font><font color="#000080"><b>begin
         </b></font>sret<font color="#808080">:=</font><font color="#800000">'ISBN: '</font><font color="#808080">;
         </font>g_nPosChave<font color="#808080">:=</font><font color="#FF0000">1</font><font color="#808080">;
         </font>g_nTamChave<font color="#808080">:=</font><font color="#FF0000">13</font><font color="#808080">;
        </font><font color="#000080"><b>end</b></font><font color="#808080">;
     </font><font color="#FF0000">2</font><font color="#808080">: </font><font color="#000080"><b>begin
         </b></font>sret<font color="#808080">:=</font><font color="#800000">'T&iacute;tulo: '</font><font color="#808080">;
         </font>g_nPosChave<font color="#808080">:=</font><font color="#FF0000">14</font><font color="#808080">;
         </font>g_nTamChave<font color="#808080">:=</font><font color="#FF0000">50</font><font color="#808080">;
        </font><font color="#000080"><b>end</b></font><font color="#808080">;
     </font><font color="#FF0000">3</font><font color="#808080">: </font><font color="#000080"><b>begin
         </b></font>sret<font color="#808080">:=</font><font color="#800000">'Edi&ccedil;&atilde;o: '</font><font color="#808080">;
         </font>g_nPosChave<font color="#808080">:=</font><font color="#FF0000">64</font><font color="#808080">;
         </font>g_nTamChave<font color="#808080">:=</font><font color="#FF0000">10</font><font color="#808080">;
        </font><font color="#000080"><b>end</b></font><font color="#808080">;
     </font><font color="#FF0000">4</font><font color="#808080">: </font><font color="#000080"><b>begin
         </b></font>sret<font color="#808080">:=</font><font color="#800000">'Ano de Publica&ccedil;&atilde;o: '</font><font color="#808080">;
         </font>g_nPosChave<font color="#808080">:=</font><font color="#FF0000">74</font><font color="#808080">;
         </font>g_nTamChave<font color="#808080">:=</font><font color="#FF0000">10</font><font color="#808080">;
        </font><font color="#000080"><b>end</b></font><font color="#808080">;
     </font><font color="#FF0000">5</font><font color="#808080">: </font><font color="#000080"><b>begin
         </b></font>sret<font color="#808080">:=</font><font color="#800000">'C&oacute;digo da editora: '</font><font color="#808080">;
         </font>g_nPosChave<font color="#808080">:=</font><font color="#FF0000">84</font><font color="#808080">;
         </font>g_nTamChave<font color="#808080">:=</font><font color="#FF0000">10</font><font color="#808080">;
        </font><font color="#000080"><b>end</b></font><font color="#808080">;
     </font><font color="#FF0000">6</font><font color="#808080">: </font><font color="#000080"><b>begin
         </b></font>sret<font color="#808080">:=</font><font color="#800000">'Volume: '</font><font color="#808080">;
         </font>g_nPosChave<font color="#808080">:=</font><font color="#FF0000">94</font><font color="#808080">;
         </font>g_nTamChave<font color="#808080">:=</font><font color="#FF0000">10</font><font color="#808080">;
        </font><font color="#000080"><b>end</b></font><font color="#808080">;
     </font><font color="#FF0000">7</font><font color="#808080">: </font><font color="#000080"><b>begin
         </b></font>sret<font color="#808080">:=</font><font color="#800000">'C&oacute;digo do idioma: '</font><font color="#808080">;
         </font>g_nPosChave<font color="#808080">:=</font><font color="#FF0000">104</font><font color="#808080">;
         </font>g_nTamChave<font color="#808080">:=</font><font color="#FF0000">10</font><font color="#808080">;
        </font><font color="#000080"><b>end</b></font><font color="#808080">;
     </font><font color="#FF0000">8</font><font color="#808080">: </font><font color="#000080"><b>begin
         </b></font>sret<font color="#808080">:=</font><font color="#800000">'N&uacute;mero de p&aacute;ginas: '</font><font color="#808080">;
         </font>g_nPosChave<font color="#808080">:=</font><font color="#FF0000">114</font><font color="#808080">;
         </font>g_nTamChave<font color="#808080">:=</font><font color="#FF0000">10</font><font color="#808080">;
        </font><font color="#000080"><b>end</b></font><font color="#808080">;
     </font><font color="#FF0000">9</font><font color="#808080">: </font><font color="#000080"><b>begin
         </b></font>sret<font color="#808080">:=</font><font color="#800000">'Pre&ccedil;o: '</font><font color="#808080">;
         </font>g_nPosChave<font color="#808080">:=</font><font color="#FF0000">124</font><font color="#808080">;
         </font>g_nTamChave<font color="#808080">:=</font><font color="#FF0000">10</font><font color="#808080">;
        </font><font color="#000080"><b>end</b></font><font color="#808080">;
     </font><font color="#FF0000">10</font><font color="#808080">: </font><font color="#000080"><b>begin
          </b></font>sret<font color="#808080">:=</font><font color="#800000">'Qtd. Estoque: '</font><font color="#808080">;
          </font>g_nPosChave<font color="#808080">:=</font><font color="#FF0000">134</font><font color="#808080">;
          </font>g_nTamChave<font color="#808080">:=</font><font color="#FF0000">10</font><font color="#808080">;
         </font><font color="#000080"><b>end</b></font><font color="#808080">;
   </font><font color="#000080"><b>end</b></font><font color="#808080">;
</font><font color="#000080"><b>end else if </b></font>opLivroAss <font color="#000080"><b>in </b></font>sreg <font color="#000080"><b>then begin
   case </b></font>nNum <font color="#000080"><b>of
     </b></font><font color="#FF0000">0</font><font color="#808080">: </font>sret<font color="#808080">:=</font><font color="#800000">'Assunto(s) n&atilde;o encontrado(s)!'</font><font color="#808080">;
     </font><font color="#FF0000">1</font><font color="#808080">: </font><font color="#000080"><b>begin
         </b></font>sret<font color="#808080">:=</font><font color="#800000">'ISBN: '</font><font color="#808080">;
         </font>g_nPosChave<font color="#808080">:=</font><font color="#FF0000">1</font><font color="#808080">;
         </font>g_nTamChave<font color="#808080">:=</font><font color="#FF0000">13</font><font color="#808080">;
        </font><font color="#000080"><b>end</b></font><font color="#808080">;
     </font><font color="#FF0000">2</font><font color="#808080">: </font><font color="#000080"><b>begin
         </b></font>sret<font color="#808080">:=</font><font color="#800000">'C&oacute;digo do assunto: '</font><font color="#808080">;
         </font>g_nPosChave<font color="#808080">:=</font><font color="#FF0000">14</font><font color="#808080">;
         </font>g_nTamChave<font color="#808080">:=</font><font color="#FF0000">10</font><font color="#808080">;
        </font><font color="#000080"><b>end</b></font><font color="#808080">;
   </font><font color="#000080"><b>end</b></font><font color="#808080">;
</font><font color="#000080"><b>end else if </b></font>opLivroAut <font color="#000080"><b>in </b></font>sreg <font color="#000080"><b>then begin
   case </b></font>nNum <font color="#000080"><b>of
     </b></font><font color="#FF0000">0</font><font color="#808080">: </font>sret<font color="#808080">:=</font><font color="#800000">'Autor(s) n&atilde;o encontrado(s)!'</font><font color="#808080">;
     </font><font color="#FF0000">1</font><font color="#808080">: </font><font color="#000080"><b>begin
         </b></font>sret<font color="#808080">:=</font><font color="#800000">'ISBN: '</font><font color="#808080">;
         </font>g_nPosChave<font color="#808080">:=</font><font color="#FF0000">1</font><font color="#808080">;
         </font>g_nTamChave<font color="#808080">:=</font><font color="#FF0000">13</font><font color="#808080">;
        </font><font color="#000080"><b>end</b></font><font color="#808080">;
     </font><font color="#FF0000">2</font><font color="#808080">: </font><font color="#000080"><b>begin
         </b></font>sret<font color="#808080">:=</font><font color="#800000">'C&oacute;digo do autor: '</font><font color="#808080">;
         </font>g_nPosChave<font color="#808080">:=</font><font color="#FF0000">14</font><font color="#808080">;
         </font>g_nTamChave<font color="#808080">:=</font><font color="#FF0000">10</font><font color="#808080">;
        </font><font color="#000080"><b>end</b></font><font color="#808080">;
   </font><font color="#000080"><b>end</b></font><font color="#808080">;
</font><font color="#000080"><b>end else if </b></font>opCliente <font color="#000080"><b>in </b></font>sreg <font color="#000080"><b>then begin
   case </b></font>nNum <font color="#000080"><b>of
     </b></font><font color="#FF0000">0</font><font color="#808080">: </font>sret<font color="#808080">:=</font><font color="#800000">'Cliente(s) n&atilde;o encontrado(s)!'</font><font color="#808080">;
     </font><font color="#FF0000">1</font><font color="#808080">: </font><font color="#000080"><b>begin
         </b></font>sret<font color="#808080">:=</font><font color="#800000">'CPF: '</font><font color="#808080">;
         </font>g_nPosChave<font color="#808080">:=</font><font color="#FF0000">1</font><font color="#808080">;
         </font>g_nTamChave<font color="#808080">:=</font><font color="#FF0000">14</font><font color="#808080">;
        </font><font color="#000080"><b>end</b></font><font color="#808080">;
     </font><font color="#FF0000">2</font><font color="#808080">: </font><font color="#000080"><b>begin
         </b></font>sret<font color="#808080">:=</font><font color="#800000">'Nome: '</font><font color="#808080">;
         </font>g_nPosChave<font color="#808080">:=</font><font color="#FF0000">15</font><font color="#808080">;
         </font>g_nTamChave<font color="#808080">:=</font><font color="#FF0000">30</font><font color="#808080">;
        </font><font color="#000080"><b>end</b></font><font color="#808080">;
     </font><font color="#FF0000">3</font><font color="#808080">: </font><font color="#000080"><b>begin
         </b></font>sret<font color="#808080">:=</font><font color="#800000">'E-mail: '</font><font color="#808080">;
         </font>g_nPosChave<font color="#808080">:=</font><font color="#FF0000">45</font><font color="#808080">;
         </font>g_nTamChave<font color="#808080">:=</font><font color="#FF0000">30</font><font color="#808080">;
        </font><font color="#000080"><b>end</b></font><font color="#808080">;
     </font><font color="#FF0000">4</font><font color="#808080">: </font><font color="#000080"><b>begin
         </b></font>sret<font color="#808080">:=</font><font color="#800000">'Identidade: '</font><font color="#808080">;
         </font>g_nPosChave<font color="#808080">:=</font><font color="#FF0000">75</font><font color="#808080">;
         </font>g_nTamChave<font color="#808080">:=</font><font color="#FF0000">10</font><font color="#808080">;
        </font><font color="#000080"><b>end</b></font><font color="#808080">;
     </font><font color="#FF0000">5</font><font color="#808080">: </font><font color="#000080"><b>begin
         </b></font>sret<font color="#808080">:=</font><font color="#800000">'Sexo: '</font><font color="#808080">;
         </font>g_nPosChave<font color="#808080">:=</font><font color="#FF0000">85</font><font color="#808080">;
         </font>g_nTamChave<font color="#808080">:=</font><font color="#FF0000">1</font><font color="#808080">;
        </font><font color="#000080"><b>end</b></font><font color="#808080">;
     </font><font color="#FF0000">6</font><font color="#808080">: </font><font color="#000080"><b>begin
         </b></font>sret<font color="#808080">:=</font><font color="#800000">'Telefone: '</font><font color="#808080">;
         </font>g_nPosChave<font color="#808080">:=</font><font color="#FF0000">86</font><font color="#808080">;
         </font>g_nTamChave<font color="#808080">:=</font><font color="#FF0000">17</font><font color="#808080">;
        </font><font color="#000080"><b>end</b></font><font color="#808080">;
     </font><font color="#FF0000">7</font><font color="#808080">: </font><font color="#000080"><b>begin
         </b></font>sret<font color="#808080">:=</font><font color="#800000">'Dt. Nascimento: '</font><font color="#808080">;
         </font>g_nPosChave<font color="#808080">:=</font><font color="#FF0000">103</font><font color="#808080">;
         </font>g_nTamChave<font color="#808080">:=</font><font color="#FF0000">10</font><font color="#808080">;
        </font><font color="#000080"><b>end</b></font><font color="#808080">;
     </font><font color="#FF0000">8</font><font color="#808080">: </font><font color="#000080"><b>begin
         </b></font>sret<font color="#808080">:=</font><font color="#800000">'C&oacute;digo do endere&ccedil;o: '</font><font color="#808080">;
         </font>g_nPosChave<font color="#808080">:=</font><font color="#FF0000">113</font><font color="#808080">;
         </font>g_nTamChave<font color="#808080">:=</font><font color="#FF0000">10</font><font color="#808080">;
        </font><font color="#000080"><b>end</b></font><font color="#808080">;
     </font><font color="#FF0000">9</font><font color="#808080">: </font><font color="#000080"><b>begin
         </b></font>sret<font color="#808080">:=</font><font color="#800000">'C&oacute;digo do pa&iacute;s: '</font><font color="#808080">;
         </font>g_nPosChave<font color="#808080">:=</font><font color="#FF0000">123</font><font color="#808080">;
         </font>g_nTamChave<font color="#808080">:=</font><font color="#FF0000">3</font><font color="#808080">;
        </font><font color="#000080"><b>end</b></font><font color="#808080">;
     </font><font color="#FF0000">10</font><font color="#808080">: </font><font color="#000080"><b>begin
          </b></font>sret<font color="#808080">:=</font><font color="#800000">'C&oacute;digo da Profiss&atilde;o: '</font><font color="#808080">;
          </font>g_nPosChave<font color="#808080">:=</font><font color="#FF0000">126</font><font color="#808080">;
          </font>g_nTamChave<font color="#808080">:=</font><font color="#FF0000">10</font><font color="#808080">;
        </font><font color="#000080"><b>end</b></font><font color="#808080">;
   </font><font color="#000080"><b>end</b></font><font color="#808080">;
</font><font color="#000080"><b>end else if </b></font>opVenda <font color="#000080"><b>in </b></font>sreg <font color="#000080"><b>then begin
   case </b></font>nNum <font color="#000080"><b>of
     </b></font><font color="#FF0000">0</font><font color="#808080">: </font>sret<font color="#808080">:=</font><font color="#800000">'Venda(s) n&atilde;o encontrada(s)!'</font><font color="#808080">;
     </font><font color="#FF0000">1</font><font color="#808080">: </font><font color="#000080"><b>begin
         </b></font>sret<font color="#808080">:=</font><font color="#800000">'Data/Hora venda: '</font><font color="#808080">;
         </font>g_nPosChave<font color="#808080">:=</font><font color="#FF0000">1</font><font color="#808080">;
         </font>g_nTamChave<font color="#808080">:=</font><font color="#FF0000">19</font><font color="#808080">;
        </font><font color="#000080"><b>end</b></font><font color="#808080">;
     </font><font color="#FF0000">2</font><font color="#808080">: </font><font color="#000080"><b>begin
         </b></font>sret<font color="#808080">:=</font><font color="#800000">'CPF: '</font><font color="#808080">;
         </font>g_nPosChave<font color="#808080">:=</font><font color="#FF0000">20</font><font color="#808080">;
         </font>g_nTamChave<font color="#808080">:=</font><font color="#FF0000">14</font><font color="#808080">;
        </font><font color="#000080"><b>end</b></font><font color="#808080">;
     </font><font color="#FF0000">3</font><font color="#808080">: </font><font color="#000080"><b>begin
         </b></font>sret<font color="#808080">:=</font><font color="#800000">'ISBN: '</font><font color="#808080">;
         </font>g_nPosChave<font color="#808080">:=</font><font color="#FF0000">34</font><font color="#808080">;
         </font>g_nTamChave<font color="#808080">:=</font><font color="#FF0000">13</font><font color="#808080">;
        </font><font color="#000080"><b>end</b></font><font color="#808080">;
     </font><font color="#FF0000">4</font><font color="#808080">: </font><font color="#000080"><b>begin
         </b></font>sret<font color="#808080">:=</font><font color="#800000">'Pre+o de venda: '</font><font color="#808080">;
         </font>g_nPosChave<font color="#808080">:=</font><font color="#FF0000">47</font><font color="#808080">;
         </font>g_nTamChave<font color="#808080">:=</font><font color="#FF0000">10</font><font color="#808080">;
        </font><font color="#000080"><b>end</b></font><font color="#808080">;
   </font><font color="#000080"><b>end</b></font><font color="#808080">;
</font><font color="#000080"><b>end</b></font><font color="#808080">;

</font>rotulo<font color="#808080">:=</font>sret<font color="#808080">;
</font><font color="#000080"><b>end</b></font><font color="#808080">;
<i>{------------------------------------------------------------------------------
Indica se continua ou n&atilde;o mostrando um n&uacute;mero m&aacute;ximo de linhas.
nlinha - a linha a ser continuada
nQtdLinha - a quantidade de linhas a serem mostradas
retorna - se continua ou n&atilde;o
------------------------------------------------------------------------------}
</i></font><font color="#000080"><b>function </b></font>ContinuaSN<font color="#808080">(</font>nlinha<font color="#808080">, </font>nQtdLinha<font color="#808080">: </font>integer<font color="#808080">): </font>boolean<font color="#808080">;
</font><font color="#000080"><b>var </b></font>bSOp<font color="#808080">, </font>bret <font color="#808080">: </font>boolean<font color="#808080">;
    </font>opCSubMenu<font color="#808080">: </font>char<font color="#808080">;
</font><font color="#000080"><b>begin
</b></font>bret<font color="#808080">:=</font>false<font color="#808080">;
</font><font color="#000080"><b>if </b></font>nlinha <font color="#808080">&gt; </font><font color="#FF0000">0 </font><font color="#000080"><b>then begin
  if </b></font><font color="#808080">(</font>nlinha <font color="#000080"><b>mod </b></font>nQtdLinha<font color="#808080">) = </font><font color="#FF0000">0 </font><font color="#000080"><b>then begin
      </b></font>bSOp<font color="#808080">:=</font>true<font color="#808080">;
      </font><font color="#000080"><b>while</b></font><font color="#808080">(</font>bSOp<font color="#808080">) </font><font color="#000080"><b>do begin
       </b></font>menu<font color="#808080">(</font><font color="#FF0000">13</font><font color="#808080">);
       </font>readln<font color="#808080">(</font>opCSubMenu<font color="#808080">);
       </font><font color="#000080"><b>if </b></font><font color="#808080">(</font>opCSubMenu<font color="#808080">=</font><font color="#800000">'S'</font><font color="#808080">) </font><font color="#000080"><b>or </b></font><font color="#808080">(</font>opCSubMenu<font color="#808080">=</font><font color="#800000">'s'</font><font color="#808080">) </font><font color="#000080"><b>then </b></font>bSOp<font color="#808080">:=</font>false
       <font color="#000080"><b>else if </b></font><font color="#808080">(</font>opCSubMenu<font color="#808080">=</font><font color="#800000">'N'</font><font color="#808080">) </font><font color="#000080"><b>or </b></font><font color="#808080">(</font>opCSubMenu<font color="#808080">=</font><font color="#800000">'n'</font><font color="#808080">) </font><font color="#000080"><b>then begin
          </b></font>bret<font color="#808080">:=</font>true<font color="#808080">;
          </font>bSOp<font color="#808080">:=</font>false<font color="#808080">;
       </font><font color="#000080"><b>end else </b></font>writeln<font color="#808080">(</font>MSG_ERRO<font color="#808080">);
      </font><font color="#000080"><b>end</b></font><font color="#808080">;
  </font><font color="#000080"><b>end</b></font><font color="#808080">;
</font><font color="#000080"><b>end</b></font><font color="#808080">;

</font>ContinuaSN<font color="#808080">:=</font>bret<font color="#808080">;
</font><font color="#000080"><b>end</b></font><font color="#808080">;
<i>{------------------------------------------------------------------------------
Lista v&aacute;rios registros de acordo com a pesquisa feita.
sArq - o arquivo
sreg - o tipo de arquivo
sChave - a chave a ser pesquisada
nPosChave - a posicao inicial da chave dentro do registro
nTamChave - o tamanho da chave dentro do registro
nTamLinha - o tamanho do registro
nQtdLinha - a quantidade de linhas a serem mostradas
retorna - se encontrou algum registro
------------------------------------------------------------------------------}
</i></font><font color="#000080"><b>function </b></font>ListarTodos<font color="#808080">(</font><font color="#000080"><b>var </b></font>sArq<font color="#808080">: </font><font color="#000080"><b>File</b></font><font color="#808080">; </font>sreg<font color="#808080">: </font>ctArqs<font color="#808080">; </font>sChave<font color="#808080">: </font>mstring<font color="#808080">;
   </font>nPosChave<font color="#808080">, </font>nTamChave<font color="#808080">, </font>nTamLinha<font color="#808080">, </font>nQtdLinha<font color="#808080">: </font>integer<font color="#808080">;
   </font>bPesqRelativa<font color="#808080">: </font>boolean<font color="#808080">): </font>boolean<font color="#808080">;
</font><font color="#000080"><b>var </b></font>slinha<font color="#808080">: </font>tregistro<font color="#808080">;
    </font>bQuebra<font color="#808080">, </font>bAchou<font color="#808080">, </font>bRet<font color="#808080">: </font>boolean<font color="#808080">;
    </font>nStatus<font color="#808080">, </font>nCont<font color="#808080">: </font>integer<font color="#808080">;
    </font>sres<font color="#808080">: </font>mstring<font color="#808080">;
</font><font color="#000080"><b>begin
</b></font>bRet<font color="#808080">:=</font>false<font color="#808080">;
</font>bQuebra<font color="#808080">:=</font>false<font color="#808080">;
</font>nCont<font color="#808080">:=</font><font color="#FF0000">0</font><font color="#808080">;
</font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#800000">''</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">);
</font>seek<font color="#808080">(</font>sArq<font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">);
</font><font color="#000080"><b>while </b></font><font color="#808080">(</font><font color="#000080"><b>not </b></font>Eof<font color="#808080">(</font>sArq<font color="#808080">)) </font><font color="#000080"><b>and </b></font><font color="#808080">(</font>bQuebra<font color="#808080">=</font>false<font color="#808080">) </font><font color="#000080"><b>do begin
  </b></font>BlockRead<font color="#808080">(</font>sArq<font color="#808080">, </font>slinha<font color="#808080">, </font>nTamLinha <font color="#808080">+ </font>TAM_CRLF<font color="#808080">, </font>nStatus<font color="#808080">);

  </font><font color="#000080"><b>if </b></font>bPesqRelativa <font color="#000080"><b>then begin
    </b></font>sres<font color="#808080">:=</font>trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha<font color="#808080">,</font>nPosChave<font color="#808080">,</font>nTamChave<font color="#808080">));
    </font><font color="#000080"><b>if </b></font>strRelativa<font color="#808080">(</font>sres<font color="#808080">,</font>sChave<font color="#808080">) </font><font color="#000080"><b>then begin
       </b></font>bAchou<font color="#808080">:=</font>true<font color="#808080">;
       </font>bRet<font color="#808080">:=</font>true<font color="#808080">;
    </font><font color="#000080"><b>end else
       </b></font>bAchou<font color="#808080">:=</font>false<font color="#808080">;
  </font><font color="#000080"><b>end else begin
    </b></font>bAchou<font color="#808080">:=</font>true<font color="#808080">;
    </font>bRet<font color="#808080">:=</font>true<font color="#808080">;
  </font><font color="#000080"><b>end</b></font><font color="#808080">;

  </font><font color="#000080"><b>if </b></font>bAchou <font color="#000080"><b>then begin
    </b></font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font>copy<font color="#808080">(</font>slinha<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font>nTamLinha<font color="#808080">), </font><font color="#FF0000">3</font><font color="#808080">);
    </font>nCont<font color="#808080">:=</font>nCont<font color="#808080">+</font><font color="#FF0000">1</font><font color="#808080">;
  </font><font color="#000080"><b>end</b></font><font color="#808080">;

  </font>bQuebra<font color="#808080">:=</font>ContinuaSN<font color="#808080">(</font>nCont<font color="#808080">, </font>nQtdLinha<font color="#808080">);
</font><font color="#000080"><b>end</b></font><font color="#808080">;
</font>ListarTodos<font color="#808080">:=</font>bret<font color="#808080">;
</font><font color="#000080"><b>end</b></font><font color="#808080">;
<i>{------------------------------------------------------------------------------
Lista v&aacute;rios registros entre arquivos de acordo com a pesquisa feita.
sArq1 - o arquivo de liga&ccedil;&atilde;o
sreg1 - o tipo de arquivo de liga&ccedil;&atilde;o
nPosChave1 - a posicao inicial da primeira chave no arquivo de liga&ccedil;&atilde;o
nTamChave1 - o tamanho da primeira chave no arquivo de liga&ccedil;&atilde;o
nPosChave2 - a posicao inicial da segunda chave do arquivo de liga&ccedil;&atilde;o
nTamChave2 - o tamanho da segunda chave do arquivo de liga&ccedil;&atilde;o
sChave - a chave a ser pesquisada no arquivo de liga&ccedil;&atilde;o
sArq2 - o arquivo a ser pesquisado
sreg2 - o tipo de arquivo a ser pesquisado
nPosChave3 - a posicao inicial da chave do arquivo pesquisado
nQtdLinha - a quantidade de linhas a serem mostradas
------------------------------------------------------------------------------}
</i></font><font color="#000080"><b>procedure </b></font>ListarRegLigados<font color="#808080">(</font><font color="#000080"><b>var </b></font>sArq1<font color="#808080">: </font><font color="#000080"><b>File</b></font><font color="#808080">; </font>sreg1<font color="#808080">: </font>ctArqs<font color="#808080">; </font>nPosChave1<font color="#808080">,
</font>nTamChave1<font color="#808080">, </font>nPosChave2<font color="#808080">, </font>nTamChave2<font color="#808080">: </font>integer<font color="#808080">; </font>sChave<font color="#808080">: </font>mstring<font color="#808080">;
</font><font color="#000080"><b>var </b></font>sArq2<font color="#808080">: </font><font color="#000080"><b>File</b></font><font color="#808080">; </font>sreg2<font color="#808080">: </font>ctArqs<font color="#808080">; </font>nPosChave3<font color="#808080">, </font>nQtdLinha<font color="#808080">: </font>integer<font color="#808080">);
</font><font color="#000080"><b>var </b></font>slinha1<font color="#808080">: </font>tregistro<font color="#808080">;
    </font>bQuebra<font color="#808080">, </font>bRet<font color="#808080">: </font>boolean<font color="#808080">;
    </font>nStatus<font color="#808080">, </font>nCont<font color="#808080">: </font>integer<font color="#808080">;
    </font>sCodigo1<font color="#808080">, </font>sCodigo2<font color="#808080">, </font>slinha2<font color="#808080">: </font>mstring<font color="#808080">;
</font><font color="#000080"><b>begin
</b></font>bRet<font color="#808080">:=</font>false<font color="#808080">;
</font>nCont<font color="#808080">:=</font><font color="#FF0000">0</font><font color="#808080">;
</font>bQuebra<font color="#808080">:=</font>false<font color="#808080">;
</font>mostrarDados<font color="#808080">(</font>sreg2<font color="#808080">, </font><font color="#800000">''</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">);
</font>seek<font color="#808080">(</font>sArq1<font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">);
</font><font color="#000080"><b>while </b></font><font color="#808080">(</font><font color="#000080"><b>not </b></font>Eof<font color="#808080">(</font>sArq1<font color="#808080">)) </font><font color="#000080"><b>and </b></font><font color="#808080">(</font>bQuebra<font color="#808080">=</font>false<font color="#808080">) </font><font color="#000080"><b>do begin
  </b></font>BlockRead<font color="#808080">(</font>sArq1<font color="#808080">, </font>slinha1<font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg1<font color="#808080">) + </font>TAM_CRLF<font color="#808080">, </font>nStatus<font color="#808080">);
  </font>sCodigo1<font color="#808080">:=</font>trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha1<font color="#808080">,</font>nPosChave1<font color="#808080">,</font>nTamChave1<font color="#808080">));
  </font><font color="#000080"><b>if </b></font>sCodigo1<font color="#808080">=</font>sChave <font color="#000080"><b>then begin
    </b></font>sCodigo2<font color="#808080">:=</font>trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha1<font color="#808080">,</font>nPosChave2<font color="#808080">,</font>nTamChave2<font color="#808080">));
    </font>slinha2<font color="#808080">:=</font>pesqArq<font color="#808080">(</font>sArq2<font color="#808080">, </font>sCodigo2<font color="#808080">, </font>nPosChave3<font color="#808080">, </font>nTamChave2<font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg2<font color="#808080">));
    </font>mostrarDados<font color="#808080">(</font>sreg2<font color="#808080">, </font>copy<font color="#808080">(</font>slinha2<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg2<font color="#808080">)), </font><font color="#FF0000">3</font><font color="#808080">);
    </font>bRet<font color="#808080">:=</font>true<font color="#808080">;
    </font>nCont<font color="#808080">:=</font>nCont<font color="#808080">+</font><font color="#FF0000">1</font><font color="#808080">;
  </font><font color="#000080"><b>end</b></font><font color="#808080">;
  </font>bQuebra<font color="#808080">:=</font>ContinuaSN<font color="#808080">(</font>nCont<font color="#808080">, </font>nQtdLinha<font color="#808080">);
</font><font color="#000080"><b>end</b></font><font color="#808080">;
</font><font color="#000080"><b>if </b></font>bRet<font color="#808080">=</font>false <font color="#000080"><b>then
   </b></font>writeln<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg2<font color="#808080">,</font><font color="#FF0000">0</font><font color="#808080">));
</font><font color="#000080"><b>end</b></font><font color="#808080">;
<i>{------------------------------------------------------------------------------
Valida a entrada de registros de acordo com a pesquisa feita.
sArq - o arquivo
sreg - o tipo de arquivo
nTexto - o numero do r&oacute;tulo da entrada
sEntrada - a chave a ser pesquisada e validada
nTentativas - o n&uacute;mero m&aacute;ximo de tentativas
bPesqRelativa - indica se vai realizar uma pesquisa relativa
bTipoEntrada - indica o tipo de entrada
retorna - o registro pesquisado e validado
------------------------------------------------------------------------------}
</i></font><font color="#000080"><b>function </b></font>validaEntrada<font color="#808080">(</font><font color="#000080"><b>var </b></font>sArq<font color="#808080">: </font><font color="#000080"><b>File</b></font><font color="#808080">; </font>sreg<font color="#808080">: </font>ctArqs<font color="#808080">; </font>nTexto<font color="#808080">: </font>integer<font color="#808080">;
        </font>sEntrada<font color="#808080">: </font>mstring<font color="#808080">; </font>nTentativas<font color="#808080">: </font>integer<font color="#808080">;
        </font>bPesqRelativa<font color="#808080">: </font>boolean<font color="#808080">; </font>bTipoEntrada<font color="#808080">: </font>ctTipo<font color="#808080">): </font>mstring<font color="#808080">;
</font><font color="#000080"><b>var </b></font>bQuebra<font color="#808080">: </font>boolean<font color="#808080">;
    </font>sres<font color="#808080">, </font>sTexto<font color="#808080">, </font>sMsgErro<font color="#808080">: </font>mstring<font color="#808080">;
    </font>ncont<font color="#808080">, </font>nPosChave<font color="#808080">, </font>nTamChave<font color="#808080">, </font>nTamLinha<font color="#808080">: </font>integer<font color="#808080">;
</font><font color="#000080"><b>begin
</b></font>nTamLinha<font color="#808080">:=</font>tamReg<font color="#808080">(</font>sreg<font color="#808080">);
</font>sMsgErro<font color="#808080">:=</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">,</font><font color="#FF0000">0</font><font color="#808080">);
</font>sTexto<font color="#808080">:=</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">,</font>nTexto<font color="#808080">);
</font>nPosChave<font color="#808080">:=</font>g_nPosChave<font color="#808080">;
</font>nTamChave<font color="#808080">:=</font>g_nTamChave<font color="#808080">;

</font>ncont<font color="#808080">:=</font><font color="#FF0000">1</font><font color="#808080">;
</font>bQuebra<font color="#808080">:=</font>false<font color="#808080">;
  </font><font color="#000080"><b>while </b></font><font color="#808080">(</font>bQuebra<font color="#808080">=</font>false<font color="#808080">) </font><font color="#000080"><b>and </b></font><font color="#808080">(</font>ncont <font color="#808080">&lt;= </font>nTentativas <font color="#808080">) </font><font color="#000080"><b>do begin
    if </b></font>opTexto <font color="#000080"><b>in </b></font>bTipoEntrada <font color="#000080"><b>then begin
      </b></font>write<font color="#808080">(</font>sTexto<font color="#808080">);
      </font>readln<font color="#808080">(</font>sEntrada<font color="#808080">);
    </font><font color="#000080"><b>end else if </b></font>opNumero <font color="#000080"><b>in </b></font>bTipoEntrada <font color="#000080"><b>then
       </b></font>sEntrada<font color="#808080">:=</font>validaNumero<font color="#808080">(</font>sTexto<font color="#808080">,</font>sEntrada<font color="#808080">)
    </font><font color="#000080"><b>else if </b></font>opData <font color="#000080"><b>in </b></font>bTipoEntrada <font color="#000080"><b>then
       </b></font>sEntrada<font color="#808080">:=</font>validaDataHora<font color="#808080">(</font>sTexto<font color="#808080">,</font>sEntrada<font color="#808080">,</font>true<font color="#808080">)
    </font><font color="#000080"><b>else if </b></font>opDataHora <font color="#000080"><b>in </b></font>bTipoEntrada <font color="#000080"><b>then
       </b></font>sEntrada<font color="#808080">:=</font>validaDataHora<font color="#808080">(</font>sTexto<font color="#808080">,</font>sEntrada<font color="#808080">,</font>false<font color="#808080">)
    </font><font color="#000080"><b>else if </b></font>opSenha <font color="#000080"><b>in </b></font>bTipoEntrada <font color="#000080"><b>then begin
       </b></font>sEntrada<font color="#808080">:=</font>digitaSenha<font color="#808080">(</font>sTexto<font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">);
    </font><font color="#000080"><b>end</b></font><font color="#808080">;

    </font><font color="#000080"><b>if </b></font>bPesqRelativa <font color="#000080"><b>then begin
       if </b></font>ListarTodos<font color="#808080">(</font>sArq<font color="#808080">, </font>sreg<font color="#808080">, </font>sEntrada<font color="#808080">, </font>nPosChave<font color="#808080">, </font>nTamChave<font color="#808080">, </font>nTamLinha<font color="#808080">,
       </font>QTD_MAX_LINHA<font color="#808080">, </font>true<font color="#808080">) </font><font color="#000080"><b>then
        </b></font>sres<font color="#808080">:=</font><font color="#800000">' '</font><font color="#808080">;
    </font><font color="#000080"><b>end else
       </b></font>sres<font color="#808080">:=</font>pesqArq<font color="#808080">(</font>sArq<font color="#808080">, </font>sEntrada<font color="#808080">, </font>nPosChave<font color="#808080">, </font>nTamChave<font color="#808080">, </font>nTamLinha<font color="#808080">);

    </font><font color="#000080"><b>if </b></font>sres<font color="#808080">=</font><font color="#800000">'' </font><font color="#000080"><b>then
       </b></font>writeln<font color="#808080">(</font>sMsgErro<font color="#808080">)
    </font><font color="#000080"><b>else
       </b></font>bQuebra<font color="#808080">:=</font>true<font color="#808080">;

    </font>ncont<font color="#808080">:=</font>ncont<font color="#808080">+</font><font color="#FF0000">1</font><font color="#808080">;
  </font><font color="#000080"><b>end</b></font><font color="#808080">;
</font>validaEntrada<font color="#808080">:=</font>sres<font color="#808080">;
</font><font color="#000080"><b>end</b></font><font color="#808080">;
<i>{------------------------------------------------------------------------------
Mostra a tela de splash do sistema.
------------------------------------------------------------------------------}
</i></font><font color="#000080"><b>procedure </b></font>frmSplash<font color="#808080">;
</font><font color="#000080"><b>var </b></font>cont<font color="#808080">: </font>integer<font color="#808080">;
</font><font color="#000080"><b>begin
 </b></font>writeln<font color="#808080">(</font><font color="#800000">'*---------------------------------------'</font><font color="#808080">+
 </font><font color="#800000">'-------------------------------------*'</font><font color="#808080">);
 </font>writeln<font color="#808080">(</font><font color="#800000">'| LL    II VV   VV RRRRR  UU  UU   SSSS '</font><font color="#808080">+
 </font><font color="#800000">'VV   VV II RRRRR  TTTT UU  UU   SSSS |'</font><font color="#808080">);
 </font>writeln<font color="#808080">(</font><font color="#800000">'| LL    II  VV VV  RR   R UU  UU  SS    '</font><font color="#808080">+
 </font><font color="#800000">' VV VV  II RR   R  TT  UU  UU  SS    |'</font><font color="#808080">);
 </font>writeln<font color="#808080">(</font><font color="#800000">'| LL    II   VVV   RRRRR  UU  UU    SS  '</font><font color="#808080">+
 </font><font color="#800000">'  VVV   II RRRRR   TT  UU  UU    SS  |'</font><font color="#808080">);
 </font>writeln<font color="#808080">(</font><font color="#800000">'| LLLLL II    V    RR   R  UUUU  SSSS   '</font><font color="#808080">+
 </font><font color="#800000">'   V    II RR   R  TT   UUUU  SSSS   |'</font><font color="#808080">);
 </font>writeln<font color="#808080">(</font><font color="#800000">'*---------------------------------------'</font><font color="#808080">+
 </font><font color="#800000">'-------------------------------------*'</font><font color="#808080">);
 </font><font color="#000080"><b>for </b></font>cont<font color="#808080">:=</font><font color="#FF0000">1 </font><font color="#000080"><b>to </b></font><font color="#FF0000">18 </font><font color="#000080"><b>do </b></font>writeln<font color="#808080">;
 </font>write<font color="#808080">(</font>MSG_PRESS<font color="#808080">);
 </font>readln<font color="#808080">;
</font><font color="#000080"><b>end</b></font><font color="#808080">;
<i>{------------------------------------------------------------------------------
Mostra a tela de sobre do sistema.
------------------------------------------------------------------------------}
</i></font><font color="#000080"><b>procedure </b></font>frmSobre<font color="#808080">;
</font><font color="#000080"><b>var </b></font>cont<font color="#808080">: </font>integer<font color="#808080">;
</font><font color="#000080"><b>begin
 </b></font>writeln<font color="#808080">(</font><font color="#800000">'*------------------------------------------------------------*'</font><font color="#808080">);
 </font>writeln<font color="#808080">(</font><font color="#800000">'|  LL        II  VV       VV  RRRRRRR   UU    UU   SSSSSSS   |'</font><font color="#808080">);
 </font>writeln<font color="#808080">(</font><font color="#800000">'|  LL        II   VV     VV   RR     R  UU    UU  SS         |'</font><font color="#808080">);
 </font>writeln<font color="#808080">(</font><font color="#800000">'|  LL        II    VV   VV    RR     R  UU    UU   SSSS      |'</font><font color="#808080">);
 </font>writeln<font color="#808080">(</font><font color="#800000">'|  LL        II     VV VV     RRRRRRR   UU    UU     SSSS    |'</font><font color="#808080">);
 </font>writeln<font color="#808080">(</font><font color="#800000">'|  LLLL      II      VVV      RR RR     UU    UU        SS   |'</font><font color="#808080">);
 </font>writeln<font color="#808080">(</font><font color="#800000">'|  LLLLLLLL  II       V       RR   RR    UUUUUU   SSSSSSSS   |'</font><font color="#808080">);
 </font>writeln<font color="#808080">(</font><font color="#800000">'|                                                            |'</font><font color="#808080">);
 </font>writeln<font color="#808080">(</font><font color="#800000">'|  VV       VV  II  RRRRRRR   TTTTTTTT  UU    UU   SSSSSSS   |'</font><font color="#808080">);
 </font>writeln<font color="#808080">(</font><font color="#800000">'|   VV     VV   II  RR     R     TT     UU    UU  SS         |'</font><font color="#808080">);
 </font>writeln<font color="#808080">(</font><font color="#800000">'|    VV   VV    II  RR     R     TT     UU    UU   SSSS      |'</font><font color="#808080">);
 </font>writeln<font color="#808080">(</font><font color="#800000">'|     VV VV     II  RRRRRRR      TT     UU    UU     SSSS    |'</font><font color="#808080">);
 </font>writeln<font color="#808080">(</font><font color="#800000">'|      VVV      II  RR RR        TT     UU    UU        SS   |'</font><font color="#808080">);
 </font>writeln<font color="#808080">(</font><font color="#800000">'|       V       II  RR   RR      TT      UUUUUU   SSSSSSSS   |'</font><font color="#808080">);
 </font>writeln<font color="#808080">(</font><font color="#800000">'|                                                            |'</font><font color="#808080">);
 </font>writeln<font color="#808080">(</font><font color="#800000">'|                                               Versao 1.0.0 |'</font><font color="#808080">);
 </font>writeln<font color="#808080">(</font><font color="#800000">'| Sistema integrante do projeto Livrus Virtus.               |'</font><font color="#808080">);
 </font>writeln<font color="#808080">(</font><font color="#800000">'| Todos os direitos reservados para Henrique F. de Souza.    |'</font><font color="#808080">);
 </font>writeln<font color="#808080">(</font><font color="#800000">'| Versao programada na linguagem pascal.                     |'</font><font color="#808080">);
 </font>writeln<font color="#808080">(</font><font color="#800000">'*------------------------------------------------------------*'</font><font color="#808080">);
 </font><font color="#000080"><b>for </b></font>cont<font color="#808080">:=</font><font color="#FF0000">1 </font><font color="#000080"><b>to </b></font><font color="#FF0000">4 </font><font color="#000080"><b>do </b></font>writeln<font color="#808080">;
 </font>write<font color="#808080">(</font>MSG_PRESS<font color="#808080">);
 </font>readln<font color="#808080">;
</font><font color="#000080"><b>end</b></font><font color="#808080">;
<i>{------------------------------------------------------------------------------
Mostra a tela de login do sistema.
retorna - se o login foi validado corretamente
------------------------------------------------------------------------------}
</i></font><font color="#000080"><b>function </b></font>frmLogin<font color="#808080">: </font>boolean<font color="#808080">;
</font><font color="#000080"><b>var </b></font>bret<font color="#808080">: </font>boolean<font color="#808080">;
    </font>slinha<font color="#808080">: </font>mstring<font color="#808080">;
</font><font color="#000080"><b>begin
  </b></font>bret<font color="#808080">:=</font>false<font color="#808080">;
  </font>writeln<font color="#808080">(</font><font color="#800000">'*--------------------------------------------------------------*'</font><font color="#808080">);
  </font>writeln<font color="#808080">(</font><font color="#800000">'| Login do sistema                                             |'</font><font color="#808080">);
  </font>writeln<font color="#808080">(</font><font color="#800000">'*--------------------------------------------------------------*'</font><font color="#808080">);
  </font>slinha<font color="#808080">:=</font>validaEntrada<font color="#808080">(</font>tfUsuario<font color="#808080">, [</font>opUsuario<font color="#808080">], </font><font color="#FF0000">1</font><font color="#808080">, </font>tUsuario<font color="#808080">.</font>login<font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">,
        </font>false<font color="#808080">, [</font>opTexto<font color="#808080">]);
  </font><font color="#000080"><b>if </b></font>slinha<font color="#808080">&lt;&gt;</font><font color="#800000">'' </font><font color="#000080"><b>then begin
     </b></font>slinha<font color="#808080">:=</font>validaEntrada<font color="#808080">(</font>tfUsuario<font color="#808080">, [</font>opUsuario<font color="#808080">], </font><font color="#FF0000">2</font><font color="#808080">, </font>tUsuario<font color="#808080">.</font>senha<font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">,
        </font>false<font color="#808080">, [</font>opSenha<font color="#808080">]);
     </font><font color="#000080"><b>if </b></font>slinha<font color="#808080">&lt;&gt;</font><font color="#800000">'' </font><font color="#000080"><b>then begin
        </b></font>tUsuario<font color="#808080">.</font>login<font color="#808080">:=</font>trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">));
        </font>tUsuario<font color="#808080">.</font>senha<font color="#808080">:=</font>trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">11</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">));
        </font>bret<font color="#808080">:=</font>true<font color="#808080">;
     </font><font color="#000080"><b>end</b></font><font color="#808080">;
  </font><font color="#000080"><b>end</b></font><font color="#808080">;
  </font>writeln<font color="#808080">;
  </font>frmLogin<font color="#808080">:=</font>bret<font color="#808080">;
</font><font color="#000080"><b>end</b></font><font color="#808080">;
<i>{------------------------------------------------------------------------------
Mostra os menus do sistema.
num - o n&uacute;mero do menu
------------------------------------------------------------------------------}
</i></font><font color="#000080"><b>procedure </b></font>menu<font color="#808080">(</font>num<font color="#808080">: </font>integer<font color="#808080">);
</font><font color="#000080"><b>begin
 if </b></font><font color="#808080">(</font>num<font color="#808080">=</font><font color="#FF0000">1</font><font color="#808080">) </font><font color="#000080"><b>then begin
  </b></font>writeln<font color="#808080">(</font><font color="#800000">'*--------------------------------------------------------------*'</font><font color="#808080">);
  </font>writeln<font color="#808080">(</font><font color="#800000">'| (C)adastros        (P)esquisas     (V)endas        (O)p&ccedil;&otilde;es  |'</font><font color="#808080">);
  </font>writeln<font color="#808080">(</font><font color="#800000">'*--------------------------------------------------------------*'</font><font color="#808080">);
 </font><font color="#000080"><b>end else if </b></font><font color="#808080">(</font>num<font color="#808080">=</font><font color="#FF0000">2</font><font color="#808080">) </font><font color="#000080"><b>then begin
   </b></font>writeln<font color="#808080">(</font><font color="#800000">'*---------------------------------*'</font><font color="#808080">);
   </font>writeln<font color="#808080">(</font><font color="#800000">'| 01. Cadastro de Assuntos        |'</font><font color="#808080">);
   </font>writeln<font color="#808080">(</font><font color="#800000">'| 02. Cadastro de Autores         |'</font><font color="#808080">);
   </font>writeln<font color="#808080">(</font><font color="#800000">'| 03. Cadastro de Editoras        |'</font><font color="#808080">);
   </font>writeln<font color="#808080">(</font><font color="#800000">'| 04. Cadastro de Endere&ccedil;os       |'</font><font color="#808080">);
   </font>writeln<font color="#808080">(</font><font color="#800000">'| 05. Cadastro de Idiomas         |'</font><font color="#808080">);
   </font>writeln<font color="#808080">(</font><font color="#800000">'| 06. Cadastro de Pa&iacute;ses          |'</font><font color="#808080">);
   </font>writeln<font color="#808080">(</font><font color="#800000">'| 07. Cadastro de Profiss&otilde;es      |'</font><font color="#808080">);
   </font>writeln<font color="#808080">(</font><font color="#800000">'| 08. Cadastro de Clientes        |'</font><font color="#808080">);
   </font>writeln<font color="#808080">(</font><font color="#800000">'| 09. Cadastro de Livros          |'</font><font color="#808080">);
   </font>writeln<font color="#808080">(</font><font color="#800000">'| 10. Voltar ao menu              |'</font><font color="#808080">);
   </font>writeln<font color="#808080">(</font><font color="#800000">'*---------------------------------*'</font><font color="#808080">);
 </font><font color="#000080"><b>end else if </b></font><font color="#808080">(</font>num<font color="#808080">=</font><font color="#FF0000">3</font><font color="#808080">) </font><font color="#000080"><b>then begin
   </b></font>writeln<font color="#808080">(</font><font color="#800000">'*---------------------------------*'</font><font color="#808080">);
   </font>writeln<font color="#808080">(</font><font color="#800000">'| 01. Consulta de Assuntos        |'</font><font color="#808080">);
   </font>writeln<font color="#808080">(</font><font color="#800000">'| 02. Consulta de Autores         |'</font><font color="#808080">);
   </font>writeln<font color="#808080">(</font><font color="#800000">'| 03. Consulta de Editoras        |'</font><font color="#808080">);
   </font>writeln<font color="#808080">(</font><font color="#800000">'| 04. Consulta de Endere&ccedil;os       |'</font><font color="#808080">);
   </font>writeln<font color="#808080">(</font><font color="#800000">'| 05. Consulta de Idiomas         |'</font><font color="#808080">);
   </font>writeln<font color="#808080">(</font><font color="#800000">'| 06. Consulta de Pa&iacute;ses          |'</font><font color="#808080">);
   </font>writeln<font color="#808080">(</font><font color="#800000">'| 07. Consulta de Profiss&otilde;es      |'</font><font color="#808080">);
   </font>writeln<font color="#808080">(</font><font color="#800000">'| 08. Consulta de Clientes        |'</font><font color="#808080">);
   </font>writeln<font color="#808080">(</font><font color="#800000">'| 09. Consulta de Livros          |'</font><font color="#808080">);
   </font>writeln<font color="#808080">(</font><font color="#800000">'| 10. Voltar ao menu              |'</font><font color="#808080">);
   </font>writeln<font color="#808080">(</font><font color="#800000">'*---------------------------------*'</font><font color="#808080">);
 </font><font color="#000080"><b>end else if </b></font><font color="#808080">(</font>num<font color="#808080">=</font><font color="#FF0000">4</font><font color="#808080">) </font><font color="#000080"><b>then begin
   </b></font>writeln<font color="#808080">(</font><font color="#800000">'*---------------------------------*'</font><font color="#808080">);
   </font>writeln<font color="#808080">(</font><font color="#800000">'| 01. Vender Livros               |'</font><font color="#808080">);
   </font>writeln<font color="#808080">(</font><font color="#800000">'| 02. Vendas Realizadas           |'</font><font color="#808080">);
   </font>writeln<font color="#808080">(</font><font color="#800000">'| 03. Voltar ao menu              |'</font><font color="#808080">);
   </font>writeln<font color="#808080">(</font><font color="#800000">'*---------------------------------*'</font><font color="#808080">);
 </font><font color="#000080"><b>end else if </b></font><font color="#808080">(</font>num<font color="#808080">=</font><font color="#FF0000">5</font><font color="#808080">) </font><font color="#000080"><b>then begin
   </b></font>writeln<font color="#808080">(</font><font color="#800000">'*---------------------------------*'</font><font color="#808080">);
   </font>writeln<font color="#808080">(</font><font color="#800000">'| 01. Alterar senha               |'</font><font color="#808080">);
   </font>writeln<font color="#808080">(</font><font color="#800000">'| 02. Sobre o sistema             |'</font><font color="#808080">);
   </font>writeln<font color="#808080">(</font><font color="#800000">'| 03. Sair do sistema             |'</font><font color="#808080">);
   </font>writeln<font color="#808080">(</font><font color="#800000">'| 04. Voltar ao menu              |'</font><font color="#808080">);
   </font>writeln<font color="#808080">(</font><font color="#800000">'*---------------------------------*'</font><font color="#808080">);
 </font><font color="#000080"><b>end else if </b></font><font color="#808080">(</font>num<font color="#808080">=</font><font color="#FF0000">6</font><font color="#808080">) </font><font color="#000080"><b>then begin
   </b></font>writeln<font color="#808080">(</font><font color="#800000">'*--------------------------------------------------------------*'</font><font color="#808080">);
   </font>writeln<font color="#808080">(</font><font color="#800000">'| (1) Novo  (2) Pesquisar   (3) Voltar ao menu                 |'</font><font color="#808080">);
   </font>writeln<font color="#808080">(</font><font color="#800000">'*--------------------------------------------------------------*'</font><font color="#808080">);
 </font><font color="#000080"><b>end else if </b></font><font color="#808080">(</font>num<font color="#808080">=</font><font color="#FF0000">7</font><font color="#808080">) </font><font color="#000080"><b>then begin
   </b></font>writeln<font color="#808080">(</font><font color="#800000">'*--------------------------------------------------------------*'</font><font color="#808080">);
   </font>writeln<font color="#808080">(</font><font color="#800000">'| (1) Salvar inclus&atilde;o       (2) Voltar ao menu                 |'</font><font color="#808080">);
   </font>writeln<font color="#808080">(</font><font color="#800000">'*--------------------------------------------------------------*'</font><font color="#808080">);
 </font><font color="#000080"><b>end else if </b></font><font color="#808080">(</font>num<font color="#808080">=</font><font color="#FF0000">8</font><font color="#808080">) </font><font color="#000080"><b>then begin
   </b></font>writeln<font color="#808080">(</font><font color="#800000">'*--------------------------------------------------------------*'</font><font color="#808080">);
   </font>writeln<font color="#808080">(</font><font color="#800000">'| (1) Alterar       (2) Excluir     (3) Voltar ao menu         |'</font><font color="#808080">);
   </font>writeln<font color="#808080">(</font><font color="#800000">'*--------------------------------------------------------------*'</font><font color="#808080">);
 </font><font color="#000080"><b>end else if </b></font><font color="#808080">(</font>num<font color="#808080">=</font><font color="#FF0000">9</font><font color="#808080">) </font><font color="#000080"><b>then begin
   </b></font>writeln<font color="#808080">(</font><font color="#800000">'*--------------------------------------------------------------*'</font><font color="#808080">);
   </font>writeln<font color="#808080">(</font><font color="#800000">'| (1) Salvar altera&ccedil;&atilde;o      (2) Voltar ao menu                 |'</font><font color="#808080">);
   </font>writeln<font color="#808080">(</font><font color="#800000">'*--------------------------------------------------------------*'</font><font color="#808080">);
 </font><font color="#000080"><b>end else if </b></font><font color="#808080">(</font>num<font color="#808080">=</font><font color="#FF0000">10</font><font color="#808080">) </font><font color="#000080"><b>then begin
   </b></font>writeln<font color="#808080">(</font><font color="#800000">'*--------------------------------------------------------------*'</font><font color="#808080">);
   </font>writeln<font color="#808080">(</font><font color="#800000">'| Certeza de excluir? (S/N)                                    |'</font><font color="#808080">);
   </font>writeln<font color="#808080">(</font><font color="#800000">'*--------------------------------------------------------------*'</font><font color="#808080">);
 </font><font color="#000080"><b>end else if </b></font><font color="#808080">(</font>num<font color="#808080">=</font><font color="#FF0000">11</font><font color="#808080">) </font><font color="#000080"><b>then begin
   </b></font>writeln<font color="#808080">(</font><font color="#800000">'*--------------------------------------------------------------*'</font><font color="#808080">);
   </font>writeln<font color="#808080">(</font><font color="#800000">'| Deseja sair do sistema? (S/N)                                |'</font><font color="#808080">);
   </font>writeln<font color="#808080">(</font><font color="#800000">'*--------------------------------------------------------------*'</font><font color="#808080">);
 </font><font color="#000080"><b>end else if </b></font><font color="#808080">(</font>num<font color="#808080">=</font><font color="#FF0000">12</font><font color="#808080">) </font><font color="#000080"><b>then begin
   </b></font>writeln<font color="#808080">(</font><font color="#800000">'*--------------------------------------------------------------*'</font><font color="#808080">);
   </font>writeln<font color="#808080">(</font><font color="#800000">'| (1) Pesquisar  (2) Listar todos   (3) Voltar ao menu         |'</font><font color="#808080">);
   </font>writeln<font color="#808080">(</font><font color="#800000">'*--------------------------------------------------------------*'</font><font color="#808080">);
 </font><font color="#000080"><b>end else if </b></font><font color="#808080">(</font>num<font color="#808080">=</font><font color="#FF0000">13</font><font color="#808080">) </font><font color="#000080"><b>then begin
   </b></font>writeln<font color="#808080">(</font><font color="#800000">'*--------------------------------------------------------------*'</font><font color="#808080">);
   </font>writeln<font color="#808080">(</font><font color="#800000">'| Deseja continuar? (S/N)                                      |'</font><font color="#808080">);
   </font>writeln<font color="#808080">(</font><font color="#800000">'*--------------------------------------------------------------*'</font><font color="#808080">);
 </font><font color="#000080"><b>end else if </b></font><font color="#808080">(</font>num<font color="#808080">=</font><font color="#FF0000">14</font><font color="#808080">) </font><font color="#000080"><b>then begin
   </b></font>writeln<font color="#808080">(</font><font color="#800000">'*--------------------------------------------------------------*'</font><font color="#808080">);
   </font>writeln<font color="#808080">(</font><font color="#800000">'| Salvar inclus&atilde;o (S/N)                                        |'</font><font color="#808080">);
   </font>writeln<font color="#808080">(</font><font color="#800000">'*--------------------------------------------------------------*'</font><font color="#808080">);
 </font><font color="#000080"><b>end</b></font><font color="#808080">;
 </font>write<font color="#808080">(</font>MSG_OPCAO<font color="#808080">);
</font><font color="#000080"><b>end</b></font><font color="#808080">;
<i>{------------------------------------------------------------------------------
Realiza os cadastros de acordo com o tipo de arquivo.
sreg - o tipo de arquivo
sacao - a a&ccedil;&atilde;o a ser realizada
------------------------------------------------------------------------------}
</i></font><font color="#000080"><b>procedure </b></font>frmCadastros<font color="#808080">(</font>sreg<font color="#808080">: </font>ctArqs<font color="#808080">; </font>sacao<font color="#808080">: </font>ctAcao<font color="#808080">);
</font><font color="#000080"><b>var </b></font>slinha<font color="#808080">: </font>mstring<font color="#808080">;
</font><font color="#000080"><b>begin
if </b></font>opAssunto <font color="#000080"><b>in </b></font>sreg <font color="#000080"><b>then begin
   if </b></font>opNovo <font color="#000080"><b>in </b></font>sacao <font color="#000080"><b>then begin
      </b></font>tAssunto<font color="#808080">.</font>codigo<font color="#808080">:=</font>pesqMaxCod<font color="#808080">(</font>tfAssunto<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">));
      </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#800000">''</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">);
      </font>subMenu<font color="#808080">(</font><font color="#FF0000">7</font><font color="#808080">, </font>sreg<font color="#808080">);
   </font><font color="#000080"><b>end else if </b></font>opPesquisar <font color="#000080"><b>in </b></font>sacao <font color="#000080"><b>then begin
     </b></font>slinha<font color="#808080">:=</font>validaEntrada<font color="#808080">(</font>tfAssunto<font color="#808080">,</font>sreg<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font>tAssunto<font color="#808080">.</font>codigo<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font>false<font color="#808080">,[</font>opNumero<font color="#808080">]);
      </font><font color="#000080"><b>if </b></font>slinha<font color="#808080">&lt;&gt;</font><font color="#800000">'' </font><font color="#000080"><b>then begin
        </b></font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#800000">''</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">);
        </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font>slinha<font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">);
        </font>subMenu<font color="#808080">(</font><font color="#FF0000">8</font><font color="#808080">, </font>sreg<font color="#808080">);
      </font><font color="#000080"><b>end</b></font><font color="#808080">;
   </font><font color="#000080"><b>end else if </b></font>opAlterar <font color="#000080"><b>in </b></font>sacao <font color="#000080"><b>then begin
      </b></font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#800000">''</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">);
      </font>subMenu<font color="#808080">(</font><font color="#FF0000">9</font><font color="#808080">, </font>sreg<font color="#808080">);
   </font><font color="#000080"><b>end else if </b></font>opExcluir <font color="#000080"><b>in </b></font>sacao <font color="#000080"><b>then begin
      </b></font>subMenu<font color="#808080">(</font><font color="#FF0000">10</font><font color="#808080">, </font>sreg<font color="#808080">);
   </font><font color="#000080"><b>end</b></font><font color="#808080">;
</font><font color="#000080"><b>end else if </b></font>opAutor <font color="#000080"><b>in </b></font>sreg <font color="#000080"><b>then begin
   if </b></font>opNovo <font color="#000080"><b>in </b></font>sacao <font color="#000080"><b>then begin
      </b></font>tAutor<font color="#808080">.</font>codigo<font color="#808080">:=</font>pesqMaxCod<font color="#808080">(</font>tfAutor<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">));
      </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#800000">''</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">);
      </font>subMenu<font color="#808080">(</font><font color="#FF0000">7</font><font color="#808080">, </font>sreg<font color="#808080">);
   </font><font color="#000080"><b>end else if </b></font>opPesquisar <font color="#000080"><b>in </b></font>sacao <font color="#000080"><b>then begin
      </b></font>slinha<font color="#808080">:=</font>validaEntrada<font color="#808080">(</font>tfAutor<font color="#808080">, </font>sreg<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font>tAutor<font color="#808080">.</font>codigo<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font>false<font color="#808080">,[</font>opNumero<font color="#808080">]);
      </font><font color="#000080"><b>if </b></font>slinha<font color="#808080">&lt;&gt;</font><font color="#800000">'' </font><font color="#000080"><b>then begin
        </b></font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#800000">''</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">);
        </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font>slinha<font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">);
        </font>subMenu<font color="#808080">(</font><font color="#FF0000">8</font><font color="#808080">, </font>sreg<font color="#808080">);
      </font><font color="#000080"><b>end</b></font><font color="#808080">;
   </font><font color="#000080"><b>end else if </b></font>opAlterar <font color="#000080"><b>in </b></font>sacao <font color="#000080"><b>then begin
      </b></font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#800000">''</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">);
      </font>subMenu<font color="#808080">(</font><font color="#FF0000">9</font><font color="#808080">, </font>sreg<font color="#808080">);
   </font><font color="#000080"><b>end else if </b></font>opExcluir <font color="#000080"><b>in </b></font>sacao <font color="#000080"><b>then begin
      </b></font>subMenu<font color="#808080">(</font><font color="#FF0000">10</font><font color="#808080">, </font>sreg<font color="#808080">);
   </font><font color="#000080"><b>end</b></font><font color="#808080">;
</font><font color="#000080"><b>end else if </b></font>opEditora <font color="#000080"><b>in </b></font>sreg <font color="#000080"><b>then begin
   if </b></font>opNovo <font color="#000080"><b>in </b></font>sacao <font color="#000080"><b>then begin
      </b></font>tEditora<font color="#808080">.</font>codigo<font color="#808080">:=</font>pesqMaxCod<font color="#808080">(</font>tfEditora<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">));
      </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#800000">''</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">);
      </font>subMenu<font color="#808080">(</font><font color="#FF0000">7</font><font color="#808080">, </font>sreg<font color="#808080">);
   </font><font color="#000080"><b>end else if </b></font>opPesquisar <font color="#000080"><b>in </b></font>sacao <font color="#000080"><b>then begin
     </b></font>slinha<font color="#808080">:=</font>validaEntrada<font color="#808080">(</font>tfEditora<font color="#808080">,</font>sreg<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font>tEditora<font color="#808080">.</font>codigo<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font>false<font color="#808080">,[</font>opNumero<font color="#808080">]);
      </font><font color="#000080"><b>if </b></font>slinha<font color="#808080">&lt;&gt;</font><font color="#800000">'' </font><font color="#000080"><b>then begin
        </b></font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#800000">''</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">);
        </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font>slinha<font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">);
        </font>subMenu<font color="#808080">(</font><font color="#FF0000">8</font><font color="#808080">, </font>sreg<font color="#808080">);
      </font><font color="#000080"><b>end</b></font><font color="#808080">;
   </font><font color="#000080"><b>end else if </b></font>opAlterar <font color="#000080"><b>in </b></font>sacao <font color="#000080"><b>then begin
      </b></font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#800000">''</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">);
      </font>subMenu<font color="#808080">(</font><font color="#FF0000">9</font><font color="#808080">, </font>sreg<font color="#808080">);
   </font><font color="#000080"><b>end else if </b></font>opExcluir <font color="#000080"><b>in </b></font>sacao <font color="#000080"><b>then begin
      </b></font>subMenu<font color="#808080">(</font><font color="#FF0000">10</font><font color="#808080">, </font>sreg<font color="#808080">);
   </font><font color="#000080"><b>end</b></font><font color="#808080">;
</font><font color="#000080"><b>end else if </b></font>opEndereco <font color="#000080"><b>in </b></font>sreg <font color="#000080"><b>then begin
   if </b></font>opNovo <font color="#000080"><b>in </b></font>sacao <font color="#000080"><b>then begin
      </b></font>tEndereco<font color="#808080">.</font>codigo<font color="#808080">:=</font>pesqMaxCod<font color="#808080">(</font>tfEndereco<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">));
      </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#800000">''</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">);
      </font>subMenu<font color="#808080">(</font><font color="#FF0000">7</font><font color="#808080">, </font>sreg<font color="#808080">);
   </font><font color="#000080"><b>end else if </b></font>opPesquisar <font color="#000080"><b>in </b></font>sacao <font color="#000080"><b>then begin
      </b></font>slinha<font color="#808080">:=</font>validaEntrada<font color="#808080">(</font>tfEndereco<font color="#808080">,</font>sreg<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font>tEndereco<font color="#808080">.</font>codigo<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,
              </font>false<font color="#808080">,[</font>opNumero<font color="#808080">]);
      </font><font color="#000080"><b>if </b></font>slinha<font color="#808080">&lt;&gt;</font><font color="#800000">'' </font><font color="#000080"><b>then begin
        </b></font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#800000">''</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">);
        </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font>slinha<font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">);
        </font>subMenu<font color="#808080">(</font><font color="#FF0000">8</font><font color="#808080">, </font>sreg<font color="#808080">);
      </font><font color="#000080"><b>end</b></font><font color="#808080">;
   </font><font color="#000080"><b>end else if </b></font>opAlterar <font color="#000080"><b>in </b></font>sacao <font color="#000080"><b>then begin
      </b></font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#800000">''</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">);
      </font>subMenu<font color="#808080">(</font><font color="#FF0000">9</font><font color="#808080">, </font>sreg<font color="#808080">);
   </font><font color="#000080"><b>end else if </b></font>opExcluir <font color="#000080"><b>in </b></font>sacao <font color="#000080"><b>then begin
      </b></font>subMenu<font color="#808080">(</font><font color="#FF0000">10</font><font color="#808080">, </font>sreg<font color="#808080">);
   </font><font color="#000080"><b>end</b></font><font color="#808080">;
</font><font color="#000080"><b>end else if </b></font>opIdioma <font color="#000080"><b>in </b></font>sreg <font color="#000080"><b>then begin
   if </b></font>opNovo <font color="#000080"><b>in </b></font>sacao <font color="#000080"><b>then begin
      </b></font>tIdioma<font color="#808080">.</font>codigo<font color="#808080">:=</font>pesqMaxCod<font color="#808080">(</font>tfIdioma<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">));
      </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#800000">''</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">);
      </font>subMenu<font color="#808080">(</font><font color="#FF0000">7</font><font color="#808080">, </font>sreg<font color="#808080">);
   </font><font color="#000080"><b>end else if </b></font>opPesquisar <font color="#000080"><b>in </b></font>sacao <font color="#000080"><b>then begin
      </b></font>slinha<font color="#808080">:=</font>validaEntrada<font color="#808080">(</font>tfIdioma<font color="#808080">,</font>sreg<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font>tIdioma<font color="#808080">.</font>codigo<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font>false<font color="#808080">,[</font>opNumero<font color="#808080">]);
      </font><font color="#000080"><b>if </b></font>slinha<font color="#808080">&lt;&gt;</font><font color="#800000">'' </font><font color="#000080"><b>then begin
        </b></font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#800000">''</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">);
        </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font>slinha<font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">);
        </font>subMenu<font color="#808080">(</font><font color="#FF0000">8</font><font color="#808080">, </font>sreg<font color="#808080">);
      </font><font color="#000080"><b>end</b></font><font color="#808080">;
   </font><font color="#000080"><b>end else if </b></font>opAlterar <font color="#000080"><b>in </b></font>sacao <font color="#000080"><b>then begin
      </b></font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#800000">''</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">);
      </font>subMenu<font color="#808080">(</font><font color="#FF0000">9</font><font color="#808080">, </font>sreg<font color="#808080">);
   </font><font color="#000080"><b>end else if </b></font>opExcluir <font color="#000080"><b>in </b></font>sacao <font color="#000080"><b>then begin
      </b></font>subMenu<font color="#808080">(</font><font color="#FF0000">10</font><font color="#808080">, </font>sreg<font color="#808080">);
   </font><font color="#000080"><b>end</b></font><font color="#808080">;
</font><font color="#000080"><b>end else if </b></font>opPais <font color="#000080"><b>in </b></font>sreg <font color="#000080"><b>then begin
   if </b></font>opNovo <font color="#000080"><b>in </b></font>sacao <font color="#000080"><b>then begin
      </b></font>write<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">));
      </font>readln<font color="#808080">(</font>tPais<font color="#808080">.</font>codigo<font color="#808080">);
      </font>slinha<font color="#808080">:=</font>pesqArq<font color="#808080">(</font>tfPais<font color="#808080">, </font>tPais<font color="#808080">.</font>codigo<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">));
      </font><font color="#000080"><b>if </b></font>slinha<font color="#808080">=</font><font color="#800000">'' </font><font color="#000080"><b>then begin
         </b></font>pesqLinhaExcluida<font color="#808080">(</font>tfPais<font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">));
         </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#800000">''</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">);
         </font>subMenu<font color="#808080">(</font><font color="#FF0000">7</font><font color="#808080">, </font>sreg<font color="#808080">);
      </font><font color="#000080"><b>end else </b></font>writeln<font color="#808080">(</font>MSG_REGEXST<font color="#808080">);
   </font><font color="#000080"><b>end else if </b></font>opPesquisar <font color="#000080"><b>in </b></font>sacao <font color="#000080"><b>then begin
      </b></font>slinha<font color="#808080">:=</font>validaEntrada<font color="#808080">(</font>tfPais<font color="#808080">, </font>sreg<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font>tPais<font color="#808080">.</font>codigo<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font>false<font color="#808080">, [</font>opTexto<font color="#808080">]);
      </font><font color="#000080"><b>if </b></font>slinha<font color="#808080">&lt;&gt;</font><font color="#800000">'' </font><font color="#000080"><b>then begin
        </b></font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#800000">''</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">);
        </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font>slinha<font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">);
        </font>subMenu<font color="#808080">(</font><font color="#FF0000">8</font><font color="#808080">, </font>sreg<font color="#808080">);
      </font><font color="#000080"><b>end</b></font><font color="#808080">;
   </font><font color="#000080"><b>end else if </b></font>opAlterar <font color="#000080"><b>in </b></font>sacao <font color="#000080"><b>then begin
      </b></font>writeln<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">), </font>tPais<font color="#808080">.</font>codigo<font color="#808080">);
      </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#800000">''</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">);
      </font>subMenu<font color="#808080">(</font><font color="#FF0000">9</font><font color="#808080">, </font>sreg<font color="#808080">);
   </font><font color="#000080"><b>end else if </b></font>opExcluir <font color="#000080"><b>in </b></font>sacao <font color="#000080"><b>then begin
      </b></font>subMenu<font color="#808080">(</font><font color="#FF0000">10</font><font color="#808080">, </font>sreg<font color="#808080">);
   </font><font color="#000080"><b>end</b></font><font color="#808080">;
</font><font color="#000080"><b>end else if </b></font>opProfissao <font color="#000080"><b>in </b></font>sreg <font color="#000080"><b>then begin
   if </b></font>opNovo <font color="#000080"><b>in </b></font>sacao <font color="#000080"><b>then begin
      </b></font>tProfissao<font color="#808080">.</font>codigo<font color="#808080">:=</font>pesqMaxCod<font color="#808080">(</font>tfProfissao<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">));
      </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#800000">''</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">);
      </font>subMenu<font color="#808080">(</font><font color="#FF0000">7</font><font color="#808080">, </font>sreg<font color="#808080">);
   </font><font color="#000080"><b>end else if </b></font>opPesquisar <font color="#000080"><b>in </b></font>sacao <font color="#000080"><b>then begin
      </b></font>slinha<font color="#808080">:=</font>validaEntrada<font color="#808080">(</font>tfProfissao<font color="#808080">,</font>sreg<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font>tProfissao<font color="#808080">.</font>codigo<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,
              </font>false<font color="#808080">,[</font>opNumero<font color="#808080">]);
      </font><font color="#000080"><b>if </b></font>slinha<font color="#808080">&lt;&gt;</font><font color="#800000">'' </font><font color="#000080"><b>then begin
        </b></font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#800000">''</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">);
        </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font>slinha<font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">);
        </font>subMenu<font color="#808080">(</font><font color="#FF0000">8</font><font color="#808080">, </font>sreg<font color="#808080">);
      </font><font color="#000080"><b>end</b></font><font color="#808080">;
   </font><font color="#000080"><b>end else if </b></font>opAlterar <font color="#000080"><b>in </b></font>sacao <font color="#000080"><b>then begin
      </b></font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#800000">''</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">);
      </font>subMenu<font color="#808080">(</font><font color="#FF0000">9</font><font color="#808080">, </font>sreg<font color="#808080">);
   </font><font color="#000080"><b>end else if </b></font>opExcluir <font color="#000080"><b>in </b></font>sacao <font color="#000080"><b>then begin
      </b></font>subMenu<font color="#808080">(</font><font color="#FF0000">10</font><font color="#808080">, </font>sreg<font color="#808080">);
   </font><font color="#000080"><b>end</b></font><font color="#808080">;
</font><font color="#000080"><b>end else if </b></font>opLivro <font color="#000080"><b>in </b></font>sreg <font color="#000080"><b>then begin
   if </b></font>opNovo <font color="#000080"><b>in </b></font>sacao <font color="#000080"><b>then begin
      </b></font>write<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">));
      </font>readln<font color="#808080">(</font>tLivro<font color="#808080">.</font>isbn<font color="#808080">);
      </font><font color="#000080"><b>if </b></font>validaISBN<font color="#808080">(</font>tLivro<font color="#808080">.</font>isbn<font color="#808080">) </font><font color="#000080"><b>then begin
          </b></font>slinha<font color="#808080">:=</font>pesqArq<font color="#808080">(</font>tfLivro<font color="#808080">, </font>tLivro<font color="#808080">.</font>isbn<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">13</font><font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">));
          </font><font color="#000080"><b>if </b></font>slinha<font color="#808080">=</font><font color="#800000">'' </font><font color="#000080"><b>then begin
             </b></font>pesqLinhaExcluida<font color="#808080">(</font>tfLivro<font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">));
             </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#800000">''</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">);
             </font>subMenu<font color="#808080">(</font><font color="#FF0000">7</font><font color="#808080">, </font>sreg<font color="#808080">);
             </font>frmCadLigados<font color="#808080">([</font>opLivroAss<font color="#808080">], [</font>opNovo<font color="#808080">], </font>tLivro<font color="#808080">.</font>isbn<font color="#808080">);
             </font>frmCadLigados<font color="#808080">([</font>opLivroAut<font color="#808080">], [</font>opNovo<font color="#808080">], </font>tLivro<font color="#808080">.</font>isbn<font color="#808080">);
          </font><font color="#000080"><b>end else </b></font>writeln<font color="#808080">(</font>MSG_REGEXST<font color="#808080">);
      </font><font color="#000080"><b>end else </b></font>writeln<font color="#808080">(</font>MSG_ISBNINV<font color="#808080">);
   </font><font color="#000080"><b>end else if </b></font>opPesquisar <font color="#000080"><b>in </b></font>sacao <font color="#000080"><b>then begin
      </b></font>slinha<font color="#808080">:=</font>validaEntrada<font color="#808080">(</font>tfLivro<font color="#808080">, </font>sreg<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font>tLivro<font color="#808080">.</font>isbn<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">,</font>false<font color="#808080">,[</font>opTexto<font color="#808080">]);
      </font><font color="#000080"><b>if </b></font>slinha<font color="#808080">&lt;&gt;</font><font color="#800000">'' </font><font color="#000080"><b>then begin
         </b></font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#800000">''</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">);
         </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font>slinha<font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">);
         </font>subMenu<font color="#808080">(</font><font color="#FF0000">8</font><font color="#808080">, </font>sreg<font color="#808080">);
      </font><font color="#000080"><b>end</b></font><font color="#808080">;
   </font><font color="#000080"><b>end else if </b></font>opAlterar <font color="#000080"><b>in </b></font>sacao <font color="#000080"><b>then begin
      </b></font>writeln<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">), </font>tLivro<font color="#808080">.</font>isbn<font color="#808080">);
      </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#800000">''</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">);
      </font>subMenu<font color="#808080">(</font><font color="#FF0000">9</font><font color="#808080">, </font>sreg<font color="#808080">);
      </font>frmCadLigados<font color="#808080">([</font>opLivroAss<font color="#808080">], [</font>opExcluir<font color="#808080">], </font>tLivro<font color="#808080">.</font>isbn<font color="#808080">);
      </font>writeln<font color="#808080">(</font><font color="#800000">'Assuntos dos livros exclu&iacute;dos, inclua novos!'</font><font color="#808080">);
      </font>frmCadLigados<font color="#808080">([</font>opLivroAss<font color="#808080">], [</font>opNovo<font color="#808080">], </font>tLivro<font color="#808080">.</font>isbn<font color="#808080">);
      </font>frmCadLigados<font color="#808080">([</font>opLivroAut<font color="#808080">], [</font>opExcluir<font color="#808080">], </font>tLivro<font color="#808080">.</font>isbn<font color="#808080">);
      </font>writeln<font color="#808080">(</font><font color="#800000">'Autores dos livros exclu&iacute;dos, inclua novos!'</font><font color="#808080">);
      </font>frmCadLigados<font color="#808080">([</font>opLivroAut<font color="#808080">], [</font>opNovo<font color="#808080">], </font>tLivro<font color="#808080">.</font>isbn<font color="#808080">);
   </font><font color="#000080"><b>end else if </b></font>opExcluir <font color="#000080"><b>in </b></font>sacao <font color="#000080"><b>then begin
      </b></font>subMenu<font color="#808080">(</font><font color="#FF0000">10</font><font color="#808080">, </font>sreg<font color="#808080">);
      </font>writeln<font color="#808080">(</font><font color="#800000">'Assuntos dos livros sendo exclu&iacute;dos!'</font><font color="#808080">);
      </font>frmCadLigados<font color="#808080">([</font>opLivroAss<font color="#808080">], [</font>opExcluir<font color="#808080">], </font>tLivro<font color="#808080">.</font>isbn<font color="#808080">);
      </font>writeln<font color="#808080">(</font><font color="#800000">'Autores dos livros sendo exclu&iacute;dos!'</font><font color="#808080">);
      </font>frmCadLigados<font color="#808080">([</font>opLivroAut<font color="#808080">], [</font>opExcluir<font color="#808080">], </font>tLivro<font color="#808080">.</font>isbn<font color="#808080">);
   </font><font color="#000080"><b>end</b></font><font color="#808080">;
</font><font color="#000080"><b>end else if </b></font>opCliente <font color="#000080"><b>in </b></font>sreg <font color="#000080"><b>then begin
   if </b></font>opNovo <font color="#000080"><b>in </b></font>sacao <font color="#000080"><b>then begin
      </b></font>write<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">));
      </font>readln<font color="#808080">(</font>tCliente<font color="#808080">.</font>cpf<font color="#808080">);
      </font><font color="#000080"><b>if </b></font>validaCPF<font color="#808080">(</font>tCliente<font color="#808080">.</font>cpf<font color="#808080">) </font><font color="#000080"><b>then begin
          </b></font>slinha<font color="#808080">:=</font>pesqArq<font color="#808080">(</font>tfCliente<font color="#808080">, </font>tCliente<font color="#808080">.</font>cpf<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">14</font><font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">));
          </font><font color="#000080"><b>if </b></font>slinha<font color="#808080">=</font><font color="#800000">'' </font><font color="#000080"><b>then begin
             </b></font>pesqLinhaExcluida<font color="#808080">(</font>tfCliente<font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">));
             </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#800000">''</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">);
             </font>subMenu<font color="#808080">(</font><font color="#FF0000">7</font><font color="#808080">, </font>sreg<font color="#808080">);
          </font><font color="#000080"><b>end else </b></font>writeln<font color="#808080">(</font>MSG_REGEXST<font color="#808080">);
      </font><font color="#000080"><b>end else </b></font>writeln<font color="#808080">(</font>MSG_CPFINV<font color="#808080">);
   </font><font color="#000080"><b>end else if </b></font>opPesquisar <font color="#000080"><b>in </b></font>sacao <font color="#000080"><b>then begin
      </b></font>slinha<font color="#808080">:=</font>validaEntrada<font color="#808080">(</font>tfCliente<font color="#808080">, </font>sreg<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font>tCliente<font color="#808080">.</font>cpf<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font>false<font color="#808080">,[</font>opTexto<font color="#808080">]);
      </font><font color="#000080"><b>if </b></font>slinha<font color="#808080">&lt;&gt;</font><font color="#800000">'' </font><font color="#000080"><b>then begin
         </b></font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#800000">''</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">);
         </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font>slinha<font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">);
         </font>subMenu<font color="#808080">(</font><font color="#FF0000">8</font><font color="#808080">, </font>sreg<font color="#808080">);
      </font><font color="#000080"><b>end</b></font><font color="#808080">;
   </font><font color="#000080"><b>end else if </b></font>opAlterar <font color="#000080"><b>in </b></font>sacao <font color="#000080"><b>then begin
      </b></font>writeln<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">), </font>tCliente<font color="#808080">.</font>cpf<font color="#808080">);
      </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#800000">''</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">);
      </font>subMenu<font color="#808080">(</font><font color="#FF0000">9</font><font color="#808080">, </font>sreg<font color="#808080">);
   </font><font color="#000080"><b>end else if </b></font>opExcluir <font color="#000080"><b>in </b></font>sacao <font color="#000080"><b>then begin
      </b></font>subMenu<font color="#808080">(</font><font color="#FF0000">10</font><font color="#808080">, </font>sreg<font color="#808080">);
   </font><font color="#000080"><b>end</b></font><font color="#808080">;
</font><font color="#000080"><b>end else if </b></font>opVenda <font color="#000080"><b>in </b></font>sreg <font color="#000080"><b>then begin
   if </b></font>opNovo <font color="#000080"><b>in </b></font>sacao <font color="#000080"><b>then begin
      </b></font>tVenda<font color="#808080">.</font>dthrvenda<font color="#808080">:=</font>retDataHora<font color="#808080">;
      </font>writeln<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">), </font>tVenda<font color="#808080">.</font>dthrvenda<font color="#808080">);
      </font>slinha<font color="#808080">:=</font>pesqArq<font color="#808080">(</font>tfVenda<font color="#808080">, </font>tVenda<font color="#808080">.</font>dthrvenda<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">19</font><font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">));
      </font><font color="#000080"><b>if </b></font>slinha<font color="#808080">=</font><font color="#800000">'' </font><font color="#000080"><b>then begin
         </b></font>slinha<font color="#808080">:=</font>validaEntrada<font color="#808080">(</font>tfCliente<font color="#808080">,[</font>opCliente<font color="#808080">],</font><font color="#FF0000">1</font><font color="#808080">,</font>tVenda<font color="#808080">.</font>cpf<font color="#808080">,</font><font color="#FF0000">3</font><font color="#808080">,
                 </font>false<font color="#808080">,[</font>opTexto<font color="#808080">]);
         </font><font color="#000080"><b>if </b></font>slinha<font color="#808080">&lt;&gt;</font><font color="#800000">'' </font><font color="#000080"><b>then begin
            </b></font>tVenda<font color="#808080">.</font>cpf<font color="#808080">:=</font>trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#FF0000">14</font><font color="#808080">));
            </font><font color="#000080"><b>if </b></font>validaCPF<font color="#808080">(</font>tVenda<font color="#808080">.</font>cpf<font color="#808080">) </font><font color="#000080"><b>then begin
               </b></font>write<font color="#808080">(</font><font color="#800000">' '</font><font color="#808080">,</font>rotulo<font color="#808080">([</font>opCliente<font color="#808080">], </font><font color="#FF0000">2</font><font color="#808080">)); <i>{ Nome }
               </i></font>writeln<font color="#808080">(</font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font>g_nPosChave<font color="#808080">, </font>g_nTamChave<font color="#808080">));
               </font>frmCadLigados<font color="#808080">([</font>opVenda<font color="#808080">], [</font>opNovo<font color="#808080">], </font>tVenda<font color="#808080">.</font>cpf<font color="#808080">);
            </font><font color="#000080"><b>end else </b></font>writeln<font color="#808080">(</font>MSG_CPFINV<font color="#808080">);
         </font><font color="#000080"><b>end</b></font><font color="#808080">;
      </font><font color="#000080"><b>end else </b></font>writeln<font color="#808080">(</font>MSG_REGEXST<font color="#808080">);
   </font><font color="#000080"><b>end else if </b></font>opPesquisar <font color="#000080"><b>in </b></font>sacao <font color="#000080"><b>then begin
      </b></font>slinha<font color="#808080">:=</font>validaEntrada<font color="#808080">(</font>tfVenda<font color="#808080">, </font>sreg<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font>tVenda<font color="#808080">.</font>dthrvenda<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,
              </font>false<font color="#808080">,[</font>opDataHora<font color="#808080">]);
      </font><font color="#000080"><b>if </b></font>slinha<font color="#808080">&lt;&gt;</font><font color="#800000">'' </font><font color="#000080"><b>then begin
        </b></font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#800000">''</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">);
        </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font>slinha<font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">);
        </font>subMenu<font color="#808080">(</font><font color="#FF0000">8</font><font color="#808080">, </font>sreg<font color="#808080">);
      </font><font color="#000080"><b>end</b></font><font color="#808080">;
   </font><font color="#000080"><b>end</b></font><font color="#808080">;
</font><font color="#000080"><b>end</b></font><font color="#808080">;

</font><font color="#000080"><b>end</b></font><font color="#808080">;
<i>{------------------------------------------------------------------------------
Realiza as consultas de acordo com o tipo de arquivo.
sreg - o tipo de arquivo
sacao - a a&ccedil;&atilde;o a ser realizada
------------------------------------------------------------------------------}
</i></font><font color="#000080"><b>procedure </b></font>frmConsultas<font color="#808080">(</font>sreg<font color="#808080">: </font>ctArqs<font color="#808080">; </font>sacao<font color="#808080">: </font>ctAcao<font color="#808080">);
</font><font color="#000080"><b>var </b></font>slinha<font color="#808080">: </font>mstring<font color="#808080">;
</font><font color="#000080"><b>begin
if </b></font>opAssunto <font color="#000080"><b>in </b></font>sreg <font color="#000080"><b>then begin
   if </b></font>opPesquisar <font color="#000080"><b>in </b></font>sacao <font color="#000080"><b>then
      </b></font>slinha<font color="#808080">:=</font>validaEntrada<font color="#808080">(</font>tfAssunto<font color="#808080">,</font>sreg<font color="#808080">,</font><font color="#FF0000">2</font><font color="#808080">,</font>tAssunto<font color="#808080">.</font>assunto<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font>true<font color="#808080">,[</font>opTexto<font color="#808080">])
   </font><font color="#000080"><b>else if </b></font>opListarTodos <font color="#000080"><b>in </b></font>sacao <font color="#000080"><b>then begin
      if </b></font>ListarTodos<font color="#808080">(</font>tfAssunto<font color="#808080">, </font>sreg<font color="#808080">, </font><font color="#800000">''</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">),
        </font>QTD_MAX_LINHA<font color="#808080">, </font>false<font color="#808080">) = </font>false <font color="#000080"><b>then
        </b></font>writeln<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">));
   </font><font color="#000080"><b>end</b></font><font color="#808080">;
</font><font color="#000080"><b>end else if </b></font>opAutor <font color="#000080"><b>in </b></font>sreg <font color="#000080"><b>then begin
   if </b></font>opPesquisar <font color="#000080"><b>in </b></font>sacao <font color="#000080"><b>then
      </b></font>slinha<font color="#808080">:=</font>validaEntrada<font color="#808080">(</font>tfAutor<font color="#808080">,</font>sreg<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">, </font>tAutor<font color="#808080">.</font>autor<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font>true<font color="#808080">,[</font>opTexto<font color="#808080">])
   </font><font color="#000080"><b>else if </b></font>opListarTodos <font color="#000080"><b>in </b></font>sacao <font color="#000080"><b>then begin
      if </b></font>ListarTodos<font color="#808080">(</font>tfAutor<font color="#808080">, </font>sreg<font color="#808080">, </font><font color="#800000">''</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">),
        </font>QTD_MAX_LINHA<font color="#808080">, </font>false<font color="#808080">) = </font>false <font color="#000080"><b>then
        </b></font>writeln<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">));
   </font><font color="#000080"><b>end</b></font><font color="#808080">;
</font><font color="#000080"><b>end else if </b></font>opEditora <font color="#000080"><b>in </b></font>sreg <font color="#000080"><b>then begin
   if </b></font>opPesquisar <font color="#000080"><b>in </b></font>sacao <font color="#000080"><b>then
      </b></font>slinha<font color="#808080">:=</font>validaEntrada<font color="#808080">(</font>tfEditora<font color="#808080">,</font>sreg<font color="#808080">,</font><font color="#FF0000">2</font><font color="#808080">,</font>tEditora<font color="#808080">.</font>editora<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font>true<font color="#808080">,[</font>opTexto<font color="#808080">])
   </font><font color="#000080"><b>else if </b></font>opListarTodos <font color="#000080"><b>in </b></font>sacao <font color="#000080"><b>then begin
      if </b></font>ListarTodos<font color="#808080">(</font>tfEditora<font color="#808080">, </font>sreg<font color="#808080">, </font><font color="#800000">''</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">),
        </font>QTD_MAX_LINHA<font color="#808080">, </font>false<font color="#808080">) = </font>false <font color="#000080"><b>then
        </b></font>writeln<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">));
   </font><font color="#000080"><b>end</b></font><font color="#808080">;
</font><font color="#000080"><b>end else if </b></font>opEndereco <font color="#000080"><b>in </b></font>sreg <font color="#000080"><b>then begin
   if </b></font>opPesquisar <font color="#000080"><b>in </b></font>sacao <font color="#000080"><b>then
      </b></font>slinha<font color="#808080">:=</font>validaEntrada<font color="#808080">(</font>tfEndereco<font color="#808080">,</font>sreg<font color="#808080">,</font><font color="#FF0000">2</font><font color="#808080">,</font>tEndereco<font color="#808080">.</font>Logradouro<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,
              </font>true<font color="#808080">,[</font>opTexto<font color="#808080">])
   </font><font color="#000080"><b>else if </b></font>opListarTodos <font color="#000080"><b>in </b></font>sacao <font color="#000080"><b>then begin
      if </b></font>ListarTodos<font color="#808080">(</font>tfEndereco<font color="#808080">, </font>sreg<font color="#808080">, </font><font color="#800000">''</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">),
         </font><font color="#FF0000">3</font><font color="#808080">, </font>false<font color="#808080">) = </font>false <font color="#000080"><b>then
        </b></font>writeln<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">));
   </font><font color="#000080"><b>end</b></font><font color="#808080">;
</font><font color="#000080"><b>end else if </b></font>opIdioma <font color="#000080"><b>in </b></font>sreg <font color="#000080"><b>then begin
   if </b></font>opPesquisar <font color="#000080"><b>in </b></font>sacao <font color="#000080"><b>then
      </b></font>slinha<font color="#808080">:=</font>validaEntrada<font color="#808080">(</font>tfIdioma<font color="#808080">, </font>sreg<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">, </font>tIdioma<font color="#808080">.</font>idioma<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font>true<font color="#808080">,[</font>opTexto<font color="#808080">])
   </font><font color="#000080"><b>else if </b></font>opListarTodos <font color="#000080"><b>in </b></font>sacao <font color="#000080"><b>then begin
      if </b></font>ListarTodos<font color="#808080">(</font>tfIdioma<font color="#808080">, </font>sreg<font color="#808080">, </font><font color="#800000">''</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">),
        </font>QTD_MAX_LINHA<font color="#808080">, </font>false<font color="#808080">) = </font>false <font color="#000080"><b>then
        </b></font>writeln<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">));
   </font><font color="#000080"><b>end</b></font><font color="#808080">;
</font><font color="#000080"><b>end else if </b></font>opPais <font color="#000080"><b>in </b></font>sreg <font color="#000080"><b>then begin
   if </b></font>opPesquisar <font color="#000080"><b>in </b></font>sacao <font color="#000080"><b>then
      </b></font>slinha<font color="#808080">:=</font>validaEntrada<font color="#808080">(</font>tfPais<font color="#808080">, </font>sreg<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">, </font>tPais<font color="#808080">.</font>pais<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font>true<font color="#808080">,[</font>opTexto<font color="#808080">])
   </font><font color="#000080"><b>else if </b></font>opListarTodos <font color="#000080"><b>in </b></font>sacao <font color="#000080"><b>then begin
      if </b></font>ListarTodos<font color="#808080">(</font>tfPais<font color="#808080">, </font>sreg<font color="#808080">, </font><font color="#800000">''</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">),
        </font>QTD_MAX_LINHA<font color="#808080">, </font>false<font color="#808080">) = </font>false <font color="#000080"><b>then
        </b></font>writeln<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">));
   </font><font color="#000080"><b>end</b></font><font color="#808080">;
</font><font color="#000080"><b>end else if </b></font>opProfissao <font color="#000080"><b>in </b></font>sreg <font color="#000080"><b>then begin
   if </b></font>opPesquisar <font color="#000080"><b>in </b></font>sacao <font color="#000080"><b>then
     </b></font>slinha<font color="#808080">:=</font>validaEntrada<font color="#808080">(</font>tfProfissao<font color="#808080">,</font>sreg<font color="#808080">,</font><font color="#FF0000">2</font><font color="#808080">,</font>tProfissao<font color="#808080">.</font>profissao<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,
             </font>true<font color="#808080">,[</font>opTexto<font color="#808080">])
   </font><font color="#000080"><b>else if </b></font>opListarTodos <font color="#000080"><b>in </b></font>sacao <font color="#000080"><b>then begin
      if </b></font>ListarTodos<font color="#808080">(</font>tfProfissao<font color="#808080">, </font>sreg<font color="#808080">, </font><font color="#800000">''</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">),
        </font>QTD_MAX_LINHA<font color="#808080">, </font>false<font color="#808080">) = </font>false <font color="#000080"><b>then
        </b></font>writeln<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">));
   </font><font color="#000080"><b>end</b></font><font color="#808080">;
</font><font color="#000080"><b>end else if </b></font>opLivro <font color="#000080"><b>in </b></font>sreg <font color="#000080"><b>then begin
   if </b></font>opPesquisar <font color="#000080"><b>in </b></font>sacao <font color="#000080"><b>then
      </b></font>slinha<font color="#808080">:=</font>validaEntrada<font color="#808080">(</font>tfLivro<font color="#808080">, </font>sreg<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">, </font>tLivro<font color="#808080">.</font>titulo<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font>true<font color="#808080">,[</font>opTexto<font color="#808080">])
   </font><font color="#000080"><b>else if </b></font>opListarTodos <font color="#000080"><b>in </b></font>sacao <font color="#000080"><b>then begin
      if </b></font>ListarTodos<font color="#808080">(</font>tfLivro<font color="#808080">, </font>sreg<font color="#808080">, </font><font color="#800000">''</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">),
        </font><font color="#FF0000">1</font><font color="#808080">, </font>false<font color="#808080">) = </font>false <font color="#000080"><b>then
        </b></font>writeln<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">));
   </font><font color="#000080"><b>end</b></font><font color="#808080">;
</font><font color="#000080"><b>end else if </b></font>opCliente <font color="#000080"><b>in </b></font>sreg <font color="#000080"><b>then begin
   if </b></font>opPesquisar <font color="#000080"><b>in </b></font>sacao <font color="#000080"><b>then
      </b></font>slinha<font color="#808080">:=</font>validaEntrada<font color="#808080">(</font>tfCliente<font color="#808080">, </font>sreg<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">, </font>tCliente<font color="#808080">.</font>nome<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font>true<font color="#808080">,[</font>opTexto<font color="#808080">])
   </font><font color="#000080"><b>else if </b></font>opListarTodos <font color="#000080"><b>in </b></font>sacao <font color="#000080"><b>then begin
      if </b></font>ListarTodos<font color="#808080">(</font>tfCliente<font color="#808080">, </font>sreg<font color="#808080">, </font><font color="#800000">''</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">),
        </font><font color="#FF0000">1</font><font color="#808080">, </font>false<font color="#808080">) = </font>false <font color="#000080"><b>then
        </b></font>writeln<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">));
   </font><font color="#000080"><b>end</b></font><font color="#808080">;
</font><font color="#000080"><b>end else if </b></font>opVenda <font color="#000080"><b>in </b></font>sreg <font color="#000080"><b>then begin
   if </b></font>opPesquisar <font color="#000080"><b>in </b></font>sacao <font color="#000080"><b>then
      </b></font>slinha<font color="#808080">:=</font>validaEntrada<font color="#808080">(</font>tfVenda<font color="#808080">, </font>sreg<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">, </font>tVenda<font color="#808080">.</font>cpf<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font>true<font color="#808080">,[</font>opTexto<font color="#808080">])
   </font><font color="#000080"><b>else if </b></font>opListarTodos <font color="#000080"><b>in </b></font>sacao <font color="#000080"><b>then begin
      if </b></font>ListarTodos<font color="#808080">(</font>tfVenda<font color="#808080">, </font>sreg<font color="#808080">, </font><font color="#800000">''</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">),
        </font>QTD_MAX_LINHA<font color="#808080">, </font>false<font color="#808080">) = </font>false <font color="#000080"><b>then
        </b></font>writeln<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">));
   </font><font color="#000080"><b>end</b></font><font color="#808080">;
</font><font color="#000080"><b>end</b></font><font color="#808080">;
</font><font color="#000080"><b>if </b></font>slinha<font color="#808080">=</font><font color="#800000">'' </font><font color="#000080"><b>then
   </b></font>write<font color="#808080">(</font><font color="#800000">''</font><font color="#808080">);
</font><font color="#000080"><b>end</b></font><font color="#808080">;
<i>{------------------------------------------------------------------------------
Mostra a tela de altera&ccedil;&atilde;o de senha do sistema e realiza a altera&ccedil;&atilde;o.
------------------------------------------------------------------------------}
</i></font><font color="#000080"><b>procedure </b></font>frmAlterarSenha<font color="#808080">;
</font><font color="#000080"><b>var </b></font>bQuebra<font color="#808080">: </font>boolean<font color="#808080">;
    </font>sres<font color="#808080">, </font>sSenhaAtual<font color="#808080">, </font>sNovaSenha<font color="#808080">, </font>sConfirmaSenha<font color="#808080">: </font>mstring<font color="#808080">;
    </font>nopcao<font color="#808080">: </font>integer<font color="#808080">;
</font><font color="#000080"><b>begin
</b></font>writeln<font color="#808080">(</font>rotulo<font color="#808080">([</font>opUsuario<font color="#808080">], </font><font color="#FF0000">1</font><font color="#808080">), </font>tUsuario<font color="#808080">.</font>login<font color="#808080">);
</font>nopcao<font color="#808080">:=</font><font color="#FF0000">1</font><font color="#808080">;
</font>bQuebra<font color="#808080">:=</font>false<font color="#808080">;
</font><font color="#000080"><b>while </b></font><font color="#808080">(</font>bQuebra<font color="#808080">=</font>false<font color="#808080">) </font><font color="#000080"><b>do begin
  case </b></font>nopcao <font color="#000080"><b>of
   </b></font><font color="#FF0000">1</font><font color="#808080">: </font><font color="#000080"><b>begin
       </b></font>sSenhaAtual<font color="#808080">:=</font>digitaSenha<font color="#808080">(</font><font color="#800000">'Senha Atual: '</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">);
       </font><font color="#000080"><b>if </b></font>sSenhaAtual<font color="#808080">&lt;&gt;</font>tUsuario<font color="#808080">.</font>senha <font color="#000080"><b>then begin
          </b></font>writeln<font color="#808080">(</font>MSG_SENCONFERE<font color="#808080">);
          </font>bQuebra<font color="#808080">:=</font>true<font color="#808080">;
       </font><font color="#000080"><b>end else </b></font>nopcao<font color="#808080">:=</font><font color="#FF0000">2</font><font color="#808080">;
      </font><font color="#000080"><b>end</b></font><font color="#808080">;
   </font><font color="#FF0000">2</font><font color="#808080">: </font><font color="#000080"><b>begin
       </b></font>sNovaSenha<font color="#808080">:=</font>digitaSenha<font color="#808080">(</font><font color="#800000">'Nova Senha: '</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">);
       </font>sConfirmaSenha<font color="#808080">:=</font>digitaSenha<font color="#808080">(</font><font color="#800000">'Confirma Senha: '</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">);
       </font><font color="#000080"><b>if </b></font>sNovaSenha<font color="#808080">&lt;&gt;</font>sConfirmaSenha <font color="#000080"><b>then begin
          </b></font>writeln<font color="#808080">(</font>MSG_SENCONFIRM<font color="#808080">);
          </font>bQuebra<font color="#808080">:=</font>true<font color="#808080">;
       </font><font color="#000080"><b>end else </b></font>nopcao<font color="#808080">:=</font><font color="#FF0000">3</font><font color="#808080">;
      </font><font color="#000080"><b>end</b></font><font color="#808080">;
   </font><font color="#FF0000">3</font><font color="#808080">: </font><font color="#000080"><b>begin
       </b></font>sres<font color="#808080">:=</font>pesqArq<font color="#808080">(</font>tfUsuario<font color="#808080">, </font>tUsuario<font color="#808080">.</font>login<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">, </font>tamReg<font color="#808080">([</font>opUsuario<font color="#808080">]));
       </font><font color="#000080"><b>if </b></font>sres<font color="#808080">=</font><font color="#800000">'' </font><font color="#000080"><b>then
         </b></font>writeln<font color="#808080">(</font>MSG_LOGINENCON<font color="#808080">)
       </font><font color="#000080"><b>else begin
         </b></font>tUsuario<font color="#808080">.</font>senha<font color="#808080">:=</font>sConfirmaSenha<font color="#808080">;
         </font>subMenu<font color="#808080">(</font><font color="#FF0000">9</font><font color="#808080">,[</font>opUsuario<font color="#808080">]);
         </font>bQuebra<font color="#808080">:=</font>true<font color="#808080">;
       </font><font color="#000080"><b>end</b></font><font color="#808080">;
      </font><font color="#000080"><b>end</b></font><font color="#808080">;
  </font><font color="#000080"><b>end</b></font><font color="#808080">;
</font><font color="#000080"><b>end</b></font><font color="#808080">;

</font><font color="#000080"><b>end</b></font><font color="#808080">;
<i>{------------------------------------------------------------------------------
Executa uma a&ccedil;&atilde;o de grava&ccedil;&atilde;o de acordo com o tipo de arquivo.
sreg - o tipo de arquivo
sacao - a a&ccedil;&atilde;o a ser realizada
------------------------------------------------------------------------------}
</i></font><font color="#000080"><b>procedure </b></font>btnAcao<font color="#808080">(</font>sreg<font color="#808080">: </font>ctArqs<font color="#808080">; </font>sacao<font color="#808080">: </font>ctAcao<font color="#808080">);
</font><font color="#000080"><b>begin
if </b></font>opAssunto <font color="#000080"><b>in </b></font>sreg <font color="#000080"><b>then begin
   if </b></font>opSalvarInclusao <font color="#000080"><b>in </b></font>sacao <font color="#000080"><b>then
      </b></font>escreveArq<font color="#808080">(</font>tfAssunto<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGINC<font color="#808080">, </font>MSG_REGNINC<font color="#808080">)
   </font><font color="#000080"><b>else if </b></font>opSalvarAlteracao <font color="#000080"><b>in </b></font>sacao <font color="#000080"><b>then
      </b></font>escreveArq<font color="#808080">(</font>tfAssunto<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGALT<font color="#808080">, </font>MSG_REGNALT<font color="#808080">)
   </font><font color="#000080"><b>else if </b></font>opConfirmaExclusao <font color="#000080"><b>in </b></font>sacao <font color="#000080"><b>then
      </b></font>escreveArq<font color="#808080">(</font>tfAssunto<font color="#808080">, </font>repete<font color="#808080">(</font><font color="#800000">'*'</font><font color="#808080">,</font>tamReg<font color="#808080">(</font>sreg<font color="#808080">)), </font>MSG_REGEXC<font color="#808080">, </font>MSG_REGNEXC<font color="#808080">);
</font><font color="#000080"><b>end else if </b></font>opAutor <font color="#000080"><b>in </b></font>sreg <font color="#000080"><b>then begin
   if </b></font>opSalvarInclusao <font color="#000080"><b>in </b></font>sacao <font color="#000080"><b>then
      </b></font>escreveArq<font color="#808080">(</font>tfAutor<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGINC<font color="#808080">, </font>MSG_REGNINC<font color="#808080">)
   </font><font color="#000080"><b>else if </b></font>opSalvarAlteracao <font color="#000080"><b>in </b></font>sacao <font color="#000080"><b>then
      </b></font>escreveArq<font color="#808080">(</font>tfAutor<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGALT<font color="#808080">, </font>MSG_REGNALT<font color="#808080">)
   </font><font color="#000080"><b>else if </b></font>opConfirmaExclusao <font color="#000080"><b>in </b></font>sacao <font color="#000080"><b>then
      </b></font>escreveArq<font color="#808080">(</font>tfAutor<font color="#808080">, </font>repete<font color="#808080">(</font><font color="#800000">'*'</font><font color="#808080">,</font>tamReg<font color="#808080">(</font>sreg<font color="#808080">)), </font>MSG_REGEXC<font color="#808080">, </font>MSG_REGNEXC<font color="#808080">);
</font><font color="#000080"><b>end else if </b></font>opEditora <font color="#000080"><b>in </b></font>sreg <font color="#000080"><b>then begin
   if </b></font>opSalvarInclusao <font color="#000080"><b>in </b></font>sacao <font color="#000080"><b>then
      </b></font>escreveArq<font color="#808080">(</font>tfEditora<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGINC<font color="#808080">, </font>MSG_REGNINC<font color="#808080">)
   </font><font color="#000080"><b>else if </b></font>opSalvarAlteracao <font color="#000080"><b>in </b></font>sacao <font color="#000080"><b>then
      </b></font>escreveArq<font color="#808080">(</font>tfEditora<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGALT<font color="#808080">, </font>MSG_REGNALT<font color="#808080">)
   </font><font color="#000080"><b>else if </b></font>opConfirmaExclusao <font color="#000080"><b>in </b></font>sacao <font color="#000080"><b>then
      </b></font>escreveArq<font color="#808080">(</font>tfEditora<font color="#808080">, </font>repete<font color="#808080">(</font><font color="#800000">'*'</font><font color="#808080">,</font>tamReg<font color="#808080">(</font>sreg<font color="#808080">)), </font>MSG_REGEXC<font color="#808080">, </font>MSG_REGNEXC<font color="#808080">);
</font><font color="#000080"><b>end else if </b></font>opEndereco <font color="#000080"><b>in </b></font>sreg <font color="#000080"><b>then begin
   if </b></font>opSalvarInclusao <font color="#000080"><b>in </b></font>sacao <font color="#000080"><b>then
      </b></font>escreveArq<font color="#808080">(</font>tfEndereco<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGINC<font color="#808080">, </font>MSG_REGNINC<font color="#808080">)
   </font><font color="#000080"><b>else if </b></font>opSalvarAlteracao <font color="#000080"><b>in </b></font>sacao <font color="#000080"><b>then
      </b></font>escreveArq<font color="#808080">(</font>tfEndereco<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGALT<font color="#808080">, </font>MSG_REGNALT<font color="#808080">)
   </font><font color="#000080"><b>else if </b></font>opConfirmaExclusao <font color="#000080"><b>in </b></font>sacao <font color="#000080"><b>then
      </b></font>escreveArq<font color="#808080">(</font>tfEndereco<font color="#808080">, </font>repete<font color="#808080">(</font><font color="#800000">'*'</font><font color="#808080">,</font>tamReg<font color="#808080">(</font>sreg<font color="#808080">)), </font>MSG_REGEXC<font color="#808080">, </font>MSG_REGNEXC<font color="#808080">);
</font><font color="#000080"><b>end else if </b></font>opIdioma <font color="#000080"><b>in </b></font>sreg <font color="#000080"><b>then begin
   if </b></font>opSalvarInclusao <font color="#000080"><b>in </b></font>sacao <font color="#000080"><b>then
      </b></font>escreveArq<font color="#808080">(</font>tfIdioma<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGINC<font color="#808080">, </font>MSG_REGNINC<font color="#808080">)
   </font><font color="#000080"><b>else if </b></font>opSalvarAlteracao <font color="#000080"><b>in </b></font>sacao <font color="#000080"><b>then
      </b></font>escreveArq<font color="#808080">(</font>tfIdioma<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGALT<font color="#808080">, </font>MSG_REGNALT<font color="#808080">)
   </font><font color="#000080"><b>else if </b></font>opConfirmaExclusao <font color="#000080"><b>in </b></font>sacao <font color="#000080"><b>then
      </b></font>escreveArq<font color="#808080">(</font>tfIdioma<font color="#808080">, </font>repete<font color="#808080">(</font><font color="#800000">'*'</font><font color="#808080">,</font>tamReg<font color="#808080">(</font>sreg<font color="#808080">)), </font>MSG_REGEXC<font color="#808080">, </font>MSG_REGNEXC<font color="#808080">);
</font><font color="#000080"><b>end else if </b></font>opPais <font color="#000080"><b>in </b></font>sreg <font color="#000080"><b>then begin
   if </b></font>opSalvarInclusao <font color="#000080"><b>in </b></font>sacao <font color="#000080"><b>then
      </b></font>escreveArq<font color="#808080">(</font>tfPais<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGINC<font color="#808080">, </font>MSG_REGNINC<font color="#808080">)
   </font><font color="#000080"><b>else if </b></font>opSalvarAlteracao <font color="#000080"><b>in </b></font>sacao <font color="#000080"><b>then
      </b></font>escreveArq<font color="#808080">(</font>tfPais<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGALT<font color="#808080">, </font>MSG_REGNALT<font color="#808080">)
   </font><font color="#000080"><b>else if </b></font>opConfirmaExclusao <font color="#000080"><b>in </b></font>sacao <font color="#000080"><b>then
      </b></font>escreveArq<font color="#808080">(</font>tfPais<font color="#808080">, </font>repete<font color="#808080">(</font><font color="#800000">'*'</font><font color="#808080">,</font>tamReg<font color="#808080">(</font>sreg<font color="#808080">)), </font>MSG_REGEXC<font color="#808080">, </font>MSG_REGNEXC<font color="#808080">);
</font><font color="#000080"><b>end else if </b></font>opProfissao <font color="#000080"><b>in </b></font>sreg <font color="#000080"><b>then begin
   if </b></font>opSalvarInclusao <font color="#000080"><b>in </b></font>sacao <font color="#000080"><b>then
      </b></font>escreveArq<font color="#808080">(</font>tfProfissao<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGINC<font color="#808080">, </font>MSG_REGNINC<font color="#808080">)
   </font><font color="#000080"><b>else if </b></font>opSalvarAlteracao <font color="#000080"><b>in </b></font>sacao <font color="#000080"><b>then
      </b></font>escreveArq<font color="#808080">(</font>tfProfissao<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGALT<font color="#808080">, </font>MSG_REGNALT<font color="#808080">)
   </font><font color="#000080"><b>else if </b></font>opConfirmaExclusao <font color="#000080"><b>in </b></font>sacao <font color="#000080"><b>then
      </b></font>escreveArq<font color="#808080">(</font>tfProfissao<font color="#808080">, </font>repete<font color="#808080">(</font><font color="#800000">'*'</font><font color="#808080">,</font>tamReg<font color="#808080">(</font>sreg<font color="#808080">)), </font>MSG_REGEXC<font color="#808080">, </font>MSG_REGNEXC<font color="#808080">);
</font><font color="#000080"><b>end else if </b></font>opLivro <font color="#000080"><b>in </b></font>sreg <font color="#000080"><b>then begin
   if </b></font>opSalvarInclusao <font color="#000080"><b>in </b></font>sacao <font color="#000080"><b>then
      </b></font>escreveArq<font color="#808080">(</font>tfLivro<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGINC<font color="#808080">, </font>MSG_REGNINC<font color="#808080">)
   </font><font color="#000080"><b>else if </b></font>opSalvarAlteracao <font color="#000080"><b>in </b></font>sacao <font color="#000080"><b>then
      </b></font>escreveArq<font color="#808080">(</font>tfLivro<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGALT<font color="#808080">, </font>MSG_REGNALT<font color="#808080">)
   </font><font color="#000080"><b>else if </b></font>opConfirmaExclusao <font color="#000080"><b>in </b></font>sacao <font color="#000080"><b>then
      </b></font>escreveArq<font color="#808080">(</font>tfLivro<font color="#808080">, </font>repete<font color="#808080">(</font><font color="#800000">'*'</font><font color="#808080">,</font>tamReg<font color="#808080">(</font>sreg<font color="#808080">)), </font>MSG_REGEXC<font color="#808080">, </font>MSG_REGNEXC<font color="#808080">);
</font><font color="#000080"><b>end else if </b></font>opLivroAss <font color="#000080"><b>in </b></font>sreg <font color="#000080"><b>then begin
   if </b></font>opSalvarInclusao <font color="#000080"><b>in </b></font>sacao <font color="#000080"><b>then
      </b></font>escreveArq<font color="#808080">(</font>tfLivroAss<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGINC<font color="#808080">, </font>MSG_REGNINC<font color="#808080">)
   </font><font color="#000080"><b>else if </b></font>opSalvarAlteracao <font color="#000080"><b>in </b></font>sacao <font color="#000080"><b>then
      </b></font>escreveArq<font color="#808080">(</font>tfLivroAss<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGALT<font color="#808080">, </font>MSG_REGNALT<font color="#808080">)
   </font><font color="#000080"><b>else if </b></font>opConfirmaExclusao <font color="#000080"><b>in </b></font>sacao <font color="#000080"><b>then
      </b></font>escreveArq<font color="#808080">(</font>tfLivroAss<font color="#808080">, </font>repete<font color="#808080">(</font><font color="#800000">'*'</font><font color="#808080">,</font>tamReg<font color="#808080">(</font>sreg<font color="#808080">)), </font>MSG_REGEXC<font color="#808080">, </font>MSG_REGNEXC<font color="#808080">);
</font><font color="#000080"><b>end else if </b></font>opLivroAut <font color="#000080"><b>in </b></font>sreg <font color="#000080"><b>then begin
   if </b></font>opSalvarInclusao <font color="#000080"><b>in </b></font>sacao <font color="#000080"><b>then
      </b></font>escreveArq<font color="#808080">(</font>tfLivroAut<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGINC<font color="#808080">, </font>MSG_REGNINC<font color="#808080">)
   </font><font color="#000080"><b>else if </b></font>opSalvarAlteracao <font color="#000080"><b>in </b></font>sacao <font color="#000080"><b>then
      </b></font>escreveArq<font color="#808080">(</font>tfLivroAut<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGALT<font color="#808080">, </font>MSG_REGNALT<font color="#808080">)
   </font><font color="#000080"><b>else if </b></font>opConfirmaExclusao <font color="#000080"><b>in </b></font>sacao <font color="#000080"><b>then
      </b></font>escreveArq<font color="#808080">(</font>tfLivroAut<font color="#808080">, </font>repete<font color="#808080">(</font><font color="#800000">'*'</font><font color="#808080">,</font>tamReg<font color="#808080">(</font>sreg<font color="#808080">)), </font>MSG_REGEXC<font color="#808080">, </font>MSG_REGNEXC<font color="#808080">);
</font><font color="#000080"><b>end else if </b></font>opCliente <font color="#000080"><b>in </b></font>sreg <font color="#000080"><b>then begin
   if </b></font>opSalvarInclusao <font color="#000080"><b>in </b></font>sacao <font color="#000080"><b>then
      </b></font>escreveArq<font color="#808080">(</font>tfCliente<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGINC<font color="#808080">, </font>MSG_REGNINC<font color="#808080">)
   </font><font color="#000080"><b>else if </b></font>opSalvarAlteracao <font color="#000080"><b>in </b></font>sacao <font color="#000080"><b>then
      </b></font>escreveArq<font color="#808080">(</font>tfCliente<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGALT<font color="#808080">, </font>MSG_REGNALT<font color="#808080">)
   </font><font color="#000080"><b>else if </b></font>opConfirmaExclusao <font color="#000080"><b>in </b></font>sacao <font color="#000080"><b>then
      </b></font>escreveArq<font color="#808080">(</font>tfCliente<font color="#808080">, </font>repete<font color="#808080">(</font><font color="#800000">'*'</font><font color="#808080">,</font>tamReg<font color="#808080">(</font>sreg<font color="#808080">)), </font>MSG_REGEXC<font color="#808080">, </font>MSG_REGNEXC<font color="#808080">);
</font><font color="#000080"><b>end else if </b></font>opVenda <font color="#000080"><b>in </b></font>sreg <font color="#000080"><b>then begin
   if </b></font>opSalvarInclusao <font color="#000080"><b>in </b></font>sacao <font color="#000080"><b>then
      </b></font>escreveArq<font color="#808080">(</font>tfVenda<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGINC<font color="#808080">, </font>MSG_REGNINC<font color="#808080">)
   </font><font color="#000080"><b>else if </b></font>opSalvarAlteracao <font color="#000080"><b>in </b></font>sacao <font color="#000080"><b>then
      </b></font>escreveArq<font color="#808080">(</font>tfVenda<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGALT<font color="#808080">, </font>MSG_REGNALT<font color="#808080">)
   </font><font color="#000080"><b>else if </b></font>opConfirmaExclusao <font color="#000080"><b>in </b></font>sacao <font color="#000080"><b>then
      </b></font>escreveArq<font color="#808080">(</font>tfVenda<font color="#808080">, </font>repete<font color="#808080">(</font><font color="#800000">'*'</font><font color="#808080">,</font>tamReg<font color="#808080">(</font>sreg<font color="#808080">)), </font>MSG_REGEXC<font color="#808080">, </font>MSG_REGNEXC<font color="#808080">);
</font><font color="#000080"><b>end else if </b></font>opUsuario <font color="#000080"><b>in </b></font>sreg <font color="#000080"><b>then begin
   if </b></font>opSalvarAlteracao <font color="#000080"><b>in </b></font>sacao <font color="#000080"><b>then
      </b></font>escreveArq<font color="#808080">(</font>tfUsuario<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGALT<font color="#808080">, </font>MSG_REGNALT<font color="#808080">);
</font><font color="#000080"><b>end</b></font><font color="#808080">;
</font><font color="#000080"><b>end</b></font><font color="#808080">;
<i>{------------------------------------------------------------------------------
Seleciona o menu e/ou a tela certa de acordo com o tipo de arquivo.
nmenu - o n&uacute;mero do menu
sreg - o tipo de arquivo
------------------------------------------------------------------------------}
</i></font><font color="#000080"><b>procedure </b></font>subMenu<font color="#808080">(</font>nmenu<font color="#808080">: </font>integer<font color="#808080">; </font>sreg<font color="#808080">: </font>ctArqs<font color="#808080">);
</font><font color="#000080"><b>var </b></font>opSubMenu<font color="#808080">: </font>integer<font color="#808080">;
    </font>opCSubMenu<font color="#808080">: </font>char<font color="#808080">;
    </font>bSOp<font color="#808080">: </font>boolean<font color="#808080">;
</font><font color="#000080"><b>begin
</b></font>bSOp<font color="#808080">:=</font>true<font color="#808080">;
</font><font color="#000080"><b>case </b></font>nmenu <font color="#000080"><b>of
 </b></font><font color="#FF0000">6</font><font color="#808080">:</font><font color="#000080"><b>begin
    while</b></font><font color="#808080">(</font>bSOp<font color="#808080">) </font><font color="#000080"><b>do begin
     </b></font>menu<font color="#808080">(</font>nmenu<font color="#808080">);
     </font>readln<font color="#808080">(</font>opSubMenu<font color="#808080">);
     </font><font color="#000080"><b>case</b></font><font color="#808080">(</font>opSubMenu<font color="#808080">) </font><font color="#000080"><b>of
      </b></font><font color="#FF0000">1</font><font color="#808080">: </font>frmCadastros<font color="#808080">(</font>sreg<font color="#808080">, [</font>opNovo<font color="#808080">]);
      </font><font color="#FF0000">2</font><font color="#808080">: </font>frmCadastros<font color="#808080">(</font>sreg<font color="#808080">, [</font>opPesquisar<font color="#808080">]);
      </font><font color="#FF0000">3</font><font color="#808080">: </font>bSOp<font color="#808080">:=</font>false<font color="#808080">;
      </font><font color="#000080"><b>else </b></font>writeln<font color="#808080">(</font>MSG_ERRO<font color="#808080">);
     </font><font color="#000080"><b>end</b></font><font color="#808080">;
    </font><font color="#000080"><b>end</b></font><font color="#808080">;
   </font><font color="#000080"><b>end</b></font><font color="#808080">;
 </font><font color="#FF0000">7</font><font color="#808080">:</font><font color="#000080"><b>begin
    while</b></font><font color="#808080">(</font>bSOp<font color="#808080">) </font><font color="#000080"><b>do begin
     </b></font>menu<font color="#808080">(</font>nmenu<font color="#808080">);
     </font>readln<font color="#808080">(</font>opSubMenu<font color="#808080">);
     </font><font color="#000080"><b>case</b></font><font color="#808080">(</font>opSubMenu<font color="#808080">) </font><font color="#000080"><b>of
      </b></font><font color="#FF0000">1</font><font color="#808080">: </font><font color="#000080"><b>begin </b></font>btnAcao<font color="#808080">(</font>sreg<font color="#808080">, [</font>opSalvarInclusao<font color="#808080">]); </font>bSOp<font color="#808080">:=</font>false<font color="#808080">; </font><font color="#000080"><b>end</b></font><font color="#808080">;
      </font><font color="#FF0000">2</font><font color="#808080">: </font>bSOp<font color="#808080">:=</font>false<font color="#808080">;
      </font><font color="#000080"><b>else </b></font>writeln<font color="#808080">(</font>MSG_ERRO<font color="#808080">);
     </font><font color="#000080"><b>end</b></font><font color="#808080">;
    </font><font color="#000080"><b>end</b></font><font color="#808080">;
   </font><font color="#000080"><b>end</b></font><font color="#808080">;
 </font><font color="#FF0000">8</font><font color="#808080">:</font><font color="#000080"><b>begin
    while</b></font><font color="#808080">(</font>bSOp<font color="#808080">) </font><font color="#000080"><b>do begin
     </b></font>menu<font color="#808080">(</font>nmenu<font color="#808080">);
     </font>readln<font color="#808080">(</font>opSubMenu<font color="#808080">);
     </font><font color="#000080"><b>case</b></font><font color="#808080">(</font>opSubMenu<font color="#808080">) </font><font color="#000080"><b>of
      </b></font><font color="#FF0000">1</font><font color="#808080">: </font><font color="#000080"><b>begin </b></font>frmCadastros<font color="#808080">(</font>sreg<font color="#808080">, [</font>opAlterar<font color="#808080">]); </font>bSOp<font color="#808080">:=</font>false<font color="#808080">; </font><font color="#000080"><b>end</b></font><font color="#808080">;
      </font><font color="#FF0000">2</font><font color="#808080">: </font><font color="#000080"><b>begin </b></font>frmCadastros<font color="#808080">(</font>sreg<font color="#808080">, [</font>opExcluir<font color="#808080">]); </font>bSOp<font color="#808080">:=</font>false<font color="#808080">; </font><font color="#000080"><b>end</b></font><font color="#808080">;
      </font><font color="#FF0000">3</font><font color="#808080">: </font>bSOp<font color="#808080">:=</font>false<font color="#808080">;
      </font><font color="#000080"><b>else </b></font>writeln<font color="#808080">(</font>MSG_ERRO<font color="#808080">);
     </font><font color="#000080"><b>end</b></font><font color="#808080">;
    </font><font color="#000080"><b>end</b></font><font color="#808080">;
   </font><font color="#000080"><b>end</b></font><font color="#808080">;
 </font><font color="#FF0000">9</font><font color="#808080">:</font><font color="#000080"><b>begin
    while</b></font><font color="#808080">(</font>bSOp<font color="#808080">) </font><font color="#000080"><b>do begin
     </b></font>menu<font color="#808080">(</font>nmenu<font color="#808080">);
     </font>readln<font color="#808080">(</font>opSubMenu<font color="#808080">);
     </font><font color="#000080"><b>case</b></font><font color="#808080">(</font>opSubMenu<font color="#808080">) </font><font color="#000080"><b>of
      </b></font><font color="#FF0000">1</font><font color="#808080">: </font><font color="#000080"><b>begin </b></font>btnAcao<font color="#808080">(</font>sreg<font color="#808080">, [</font>opSalvarAlteracao<font color="#808080">]); </font>bSOp<font color="#808080">:=</font>false<font color="#808080">; </font><font color="#000080"><b>end</b></font><font color="#808080">;
      </font><font color="#FF0000">2</font><font color="#808080">: </font>bSOp<font color="#808080">:=</font>false<font color="#808080">;
      </font><font color="#000080"><b>else </b></font>writeln<font color="#808080">(</font>MSG_ERRO<font color="#808080">);
     </font><font color="#000080"><b>end</b></font><font color="#808080">;
    </font><font color="#000080"><b>end</b></font><font color="#808080">;
   </font><font color="#000080"><b>end</b></font><font color="#808080">;
 </font><font color="#FF0000">10</font><font color="#808080">:</font><font color="#000080"><b>begin
    while</b></font><font color="#808080">(</font>bSOp<font color="#808080">) </font><font color="#000080"><b>do begin
     </b></font>menu<font color="#808080">(</font>nmenu<font color="#808080">);
     </font>readln<font color="#808080">(</font>opCSubMenu<font color="#808080">);
     </font><font color="#000080"><b>if </b></font><font color="#808080">(</font>opCSubMenu<font color="#808080">=</font><font color="#800000">'S'</font><font color="#808080">) </font><font color="#000080"><b>or </b></font><font color="#808080">(</font>opCSubMenu<font color="#808080">=</font><font color="#800000">'s'</font><font color="#808080">) </font><font color="#000080"><b>then begin
        </b></font>btnAcao<font color="#808080">(</font>sreg<font color="#808080">, [</font>opConfirmaExclusao<font color="#808080">]);
        </font>bSOp<font color="#808080">:=</font>false<font color="#808080">;
     </font><font color="#000080"><b>end else if </b></font><font color="#808080">(</font>opCSubMenu<font color="#808080">=</font><font color="#800000">'N'</font><font color="#808080">) </font><font color="#000080"><b>or </b></font><font color="#808080">(</font>opCSubMenu<font color="#808080">=</font><font color="#800000">'n'</font><font color="#808080">) </font><font color="#000080"><b>then </b></font>bSOp<font color="#808080">:=</font>false
     <font color="#000080"><b>else </b></font>writeln<font color="#808080">(</font>MSG_ERRO<font color="#808080">);
    </font><font color="#000080"><b>end</b></font><font color="#808080">;
   </font><font color="#000080"><b>end</b></font><font color="#808080">;
 </font><font color="#FF0000">12</font><font color="#808080">:</font><font color="#000080"><b>begin
    while</b></font><font color="#808080">(</font>bSOp<font color="#808080">) </font><font color="#000080"><b>do begin
     </b></font>menu<font color="#808080">(</font>nmenu<font color="#808080">);
     </font>readln<font color="#808080">(</font>opSubMenu<font color="#808080">);
     </font><font color="#000080"><b>case</b></font><font color="#808080">(</font>opSubMenu<font color="#808080">) </font><font color="#000080"><b>of
      </b></font><font color="#FF0000">1</font><font color="#808080">: </font>frmConsultas<font color="#808080">(</font>sreg<font color="#808080">, [</font>opPesquisar<font color="#808080">]);
      </font><font color="#FF0000">2</font><font color="#808080">: </font>frmConsultas<font color="#808080">(</font>sreg<font color="#808080">, [</font>opListarTodos<font color="#808080">]);
      </font><font color="#FF0000">3</font><font color="#808080">: </font>bSOp<font color="#808080">:=</font>false<font color="#808080">;
      </font><font color="#000080"><b>else </b></font>writeln<font color="#808080">(</font>MSG_ERRO<font color="#808080">);
     </font><font color="#000080"><b>end</b></font><font color="#808080">;
    </font><font color="#000080"><b>end</b></font><font color="#808080">;
   </font><font color="#000080"><b>end</b></font><font color="#808080">;
 </font><font color="#FF0000">14</font><font color="#808080">:</font><font color="#000080"><b>begin
    while</b></font><font color="#808080">(</font>bSOp<font color="#808080">) </font><font color="#000080"><b>do begin
     </b></font>menu<font color="#808080">(</font>nmenu<font color="#808080">);
     </font>readln<font color="#808080">(</font>opCSubMenu<font color="#808080">);
     </font><font color="#000080"><b>if </b></font><font color="#808080">(</font>opCSubMenu<font color="#808080">=</font><font color="#800000">'S'</font><font color="#808080">) </font><font color="#000080"><b>or </b></font><font color="#808080">(</font>opCSubMenu<font color="#808080">=</font><font color="#800000">'s'</font><font color="#808080">) </font><font color="#000080"><b>then begin
        </b></font>btnAcao<font color="#808080">(</font>sreg<font color="#808080">, [</font>opSalvarInclusao<font color="#808080">]);
        </font>bSOp<font color="#808080">:=</font>false<font color="#808080">;
        </font>g_SalvarInclusao<font color="#808080">:=</font>true<font color="#808080">;
     </font><font color="#000080"><b>end else if </b></font><font color="#808080">(</font>opCSubMenu<font color="#808080">=</font><font color="#800000">'N'</font><font color="#808080">) </font><font color="#000080"><b>or </b></font><font color="#808080">(</font>opCSubMenu<font color="#808080">=</font><font color="#800000">'n'</font><font color="#808080">) </font><font color="#000080"><b>then </b></font>bSOp<font color="#808080">:=</font>false
     <font color="#000080"><b>else </b></font>writeln<font color="#808080">(</font>MSG_ERRO<font color="#808080">);
    </font><font color="#000080"><b>end</b></font><font color="#808080">;
   </font><font color="#000080"><b>end</b></font><font color="#808080">;
</font><font color="#000080"><b>end</b></font><font color="#808080">;

</font><font color="#000080"><b>end</b></font><font color="#808080">;
<i>{------------------------------------------------------------------------------
Seleciona o submenu e/ou a tela certa de acordo com n&uacute;mero do menu.
nmenu - o n&uacute;mero do menu
------------------------------------------------------------------------------}
</i></font><font color="#000080"><b>procedure </b></font>usaMenu<font color="#808080">(</font>num<font color="#808080">: </font>integer<font color="#808080">);
</font><font color="#000080"><b>var </b></font>opSubMenu<font color="#808080">: </font>integer<font color="#808080">;
    </font>bSOp<font color="#808080">: </font>boolean<font color="#808080">;
    </font>opSair<font color="#808080">: </font>char<font color="#808080">;
</font><font color="#000080"><b>begin
 </b></font>bSOp<font color="#808080">:=</font>true<font color="#808080">;
 </font><font color="#000080"><b>if </b></font>num <font color="#808080">= </font><font color="#FF0000">1 </font><font color="#000080"><b>then begin </b></font><font color="#808080"><i>{ Cadastros }
   </i></font><font color="#000080"><b>while</b></font><font color="#808080">(</font>bSOp<font color="#808080">) </font><font color="#000080"><b>do begin
     </b></font>menu<font color="#808080">(</font><font color="#FF0000">2</font><font color="#808080">);
     </font>readln<font color="#808080">(</font>opSubMenu<font color="#808080">);
     </font><font color="#000080"><b>case</b></font><font color="#808080">(</font>opSubMenu<font color="#808080">) </font><font color="#000080"><b>of
      </b></font><font color="#FF0000">1</font><font color="#808080">: </font>subMenu<font color="#808080">(</font><font color="#FF0000">6</font><font color="#808080">, [</font>opAssunto<font color="#808080">]);
      </font><font color="#FF0000">2</font><font color="#808080">: </font>subMenu<font color="#808080">(</font><font color="#FF0000">6</font><font color="#808080">, [</font>opAutor<font color="#808080">]);
      </font><font color="#FF0000">3</font><font color="#808080">: </font>subMenu<font color="#808080">(</font><font color="#FF0000">6</font><font color="#808080">, [</font>opEditora<font color="#808080">]);
      </font><font color="#FF0000">4</font><font color="#808080">: </font>subMenu<font color="#808080">(</font><font color="#FF0000">6</font><font color="#808080">, [</font>opEndereco<font color="#808080">]);
      </font><font color="#FF0000">5</font><font color="#808080">: </font>subMenu<font color="#808080">(</font><font color="#FF0000">6</font><font color="#808080">, [</font>opIdioma<font color="#808080">]);
      </font><font color="#FF0000">6</font><font color="#808080">: </font>subMenu<font color="#808080">(</font><font color="#FF0000">6</font><font color="#808080">, [</font>opPais<font color="#808080">]);
      </font><font color="#FF0000">7</font><font color="#808080">: </font>subMenu<font color="#808080">(</font><font color="#FF0000">6</font><font color="#808080">, [</font>opProfissao<font color="#808080">]);
      </font><font color="#FF0000">8</font><font color="#808080">: </font>subMenu<font color="#808080">(</font><font color="#FF0000">6</font><font color="#808080">, [</font>opCliente<font color="#808080">]);
      </font><font color="#FF0000">9</font><font color="#808080">: </font>subMenu<font color="#808080">(</font><font color="#FF0000">6</font><font color="#808080">, [</font>opLivro<font color="#808080">]);
      </font><font color="#FF0000">10</font><font color="#808080">: </font>bSOp<font color="#808080">:=</font>false<font color="#808080">;
      </font><font color="#000080"><b>else </b></font>writeln<font color="#808080">(</font>MSG_ERRO<font color="#808080">);
     </font><font color="#000080"><b>end</b></font><font color="#808080">;
   </font><font color="#000080"><b>end</b></font><font color="#808080">;
 </font><font color="#000080"><b>end else if </b></font>num <font color="#808080">= </font><font color="#FF0000">2 </font><font color="#000080"><b>then begin </b></font><font color="#808080"><i>{ Pesquisas }
   </i></font><font color="#000080"><b>while</b></font><font color="#808080">(</font>bSOp<font color="#808080">) </font><font color="#000080"><b>do begin
     </b></font>menu<font color="#808080">(</font><font color="#FF0000">3</font><font color="#808080">);
     </font>readln<font color="#808080">(</font>opSubMenu<font color="#808080">);
     </font><font color="#000080"><b>case</b></font><font color="#808080">(</font>opSubMenu<font color="#808080">) </font><font color="#000080"><b>of
      </b></font><font color="#FF0000">1</font><font color="#808080">: </font>subMenu<font color="#808080">(</font><font color="#FF0000">12</font><font color="#808080">, [</font>opAssunto<font color="#808080">]);
      </font><font color="#FF0000">2</font><font color="#808080">: </font>subMenu<font color="#808080">(</font><font color="#FF0000">12</font><font color="#808080">, [</font>opAutor<font color="#808080">]);
      </font><font color="#FF0000">3</font><font color="#808080">: </font>subMenu<font color="#808080">(</font><font color="#FF0000">12</font><font color="#808080">, [</font>opEditora<font color="#808080">]);
      </font><font color="#FF0000">4</font><font color="#808080">: </font>subMenu<font color="#808080">(</font><font color="#FF0000">12</font><font color="#808080">, [</font>opEndereco<font color="#808080">]);
      </font><font color="#FF0000">5</font><font color="#808080">: </font>subMenu<font color="#808080">(</font><font color="#FF0000">12</font><font color="#808080">, [</font>opIdioma<font color="#808080">]);
      </font><font color="#FF0000">6</font><font color="#808080">: </font>subMenu<font color="#808080">(</font><font color="#FF0000">12</font><font color="#808080">, [</font>opPais<font color="#808080">]);
      </font><font color="#FF0000">7</font><font color="#808080">: </font>subMenu<font color="#808080">(</font><font color="#FF0000">12</font><font color="#808080">, [</font>opProfissao<font color="#808080">]);
      </font><font color="#FF0000">8</font><font color="#808080">: </font>subMenu<font color="#808080">(</font><font color="#FF0000">12</font><font color="#808080">, [</font>opCliente<font color="#808080">]);
      </font><font color="#FF0000">9</font><font color="#808080">: </font>subMenu<font color="#808080">(</font><font color="#FF0000">12</font><font color="#808080">, [</font>opLivro<font color="#808080">]);
      </font><font color="#FF0000">10</font><font color="#808080">: </font>bSOp<font color="#808080">:=</font>false<font color="#808080">;
      </font><font color="#000080"><b>else </b></font>writeln<font color="#808080">(</font>MSG_ERRO<font color="#808080">);
     </font><font color="#000080"><b>end</b></font><font color="#808080">;
   </font><font color="#000080"><b>end</b></font><font color="#808080">;
 </font><font color="#000080"><b>end else if </b></font>num <font color="#808080">= </font><font color="#FF0000">3 </font><font color="#000080"><b>then begin </b></font><font color="#808080"><i>{ Vendas }
   </i></font><font color="#000080"><b>while</b></font><font color="#808080">(</font>bSOp<font color="#808080">) </font><font color="#000080"><b>do begin
     </b></font>menu<font color="#808080">(</font><font color="#FF0000">4</font><font color="#808080">);
     </font>readln<font color="#808080">(</font>opSubMenu<font color="#808080">);
     </font><font color="#000080"><b>case</b></font><font color="#808080">(</font>opSubMenu<font color="#808080">) </font><font color="#000080"><b>of
      </b></font><font color="#FF0000">1</font><font color="#808080">: </font>subMenu<font color="#808080">(</font><font color="#FF0000">6</font><font color="#808080">, [</font>opVenda<font color="#808080">]);
      </font><font color="#FF0000">2</font><font color="#808080">: </font>subMenu<font color="#808080">(</font><font color="#FF0000">12</font><font color="#808080">, [</font>opVenda<font color="#808080">]);
      </font><font color="#FF0000">3</font><font color="#808080">: </font>bSOp<font color="#808080">:=</font>false<font color="#808080">;
      </font><font color="#000080"><b>else </b></font>writeln<font color="#808080">(</font>MSG_ERRO<font color="#808080">);
     </font><font color="#000080"><b>end</b></font><font color="#808080">;
   </font><font color="#000080"><b>end</b></font><font color="#808080">;
 </font><font color="#000080"><b>end else if </b></font>num <font color="#808080">= </font><font color="#FF0000">4 </font><font color="#000080"><b>then begin </b></font><font color="#808080"><i>{ Opcoes }
   </i></font><font color="#000080"><b>while</b></font><font color="#808080">(</font>bSOp<font color="#808080">) </font><font color="#000080"><b>do begin
     </b></font>menu<font color="#808080">(</font><font color="#FF0000">5</font><font color="#808080">);
     </font>readln<font color="#808080">(</font>opSubMenu<font color="#808080">);
     </font><font color="#000080"><b>case</b></font><font color="#808080">(</font>opSubMenu<font color="#808080">) </font><font color="#000080"><b>of
      </b></font><font color="#FF0000">1</font><font color="#808080">: </font>frmAlterarSenha<font color="#808080">;
      </font><font color="#FF0000">2</font><font color="#808080">: </font>frmSobre<font color="#808080">;
      </font><font color="#FF0000">3</font><font color="#808080">: </font><font color="#000080"><b>begin
           </b></font>menu<font color="#808080">(</font><font color="#FF0000">11</font><font color="#808080">);
           </font>read<font color="#808080">(</font>opSair<font color="#808080">);
           </font><font color="#000080"><b>if </b></font><font color="#808080">(</font>opSair<font color="#808080">=</font><font color="#800000">'S'</font><font color="#808080">) </font><font color="#000080"><b>or </b></font><font color="#808080">(</font>opSair<font color="#808080">=</font><font color="#800000">'s'</font><font color="#808080">) </font><font color="#000080"><b>then begin
              </b></font>fechaArqs<font color="#808080">;
              </font>halt<font color="#808080">;
           </font><font color="#000080"><b>end</b></font><font color="#808080">;
         </font><font color="#000080"><b>end</b></font><font color="#808080">;
      </font><font color="#FF0000">4</font><font color="#808080">: </font>bSOp<font color="#808080">:=</font>false<font color="#808080">;
      </font><font color="#000080"><b>else </b></font>writeln<font color="#808080">(</font>MSG_ERRO<font color="#808080">);
     </font><font color="#000080"><b>end</b></font><font color="#808080">;
   </font><font color="#000080"><b>end</b></font><font color="#808080">;
 </font><font color="#000080"><b>end</b></font><font color="#808080">;
</font><font color="#000080"><b>end</b></font><font color="#808080">;
<i>{------------------------------------------------------------------------------
Mostra as entradas e as sa&iacute;das do sistema.
sreg - o tipo de arquivo
slinha - o registro com os dados
nOpcao - indica qual op&ccedil;&atilde;o ser&aacute; mostrada
------------------------------------------------------------------------------}
</i></font><font color="#000080"><b>procedure </b></font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">: </font>ctArqs<font color="#808080">; </font>slinha<font color="#808080">: </font>mstring<font color="#808080">; </font>nOpcao<font color="#808080">: </font>integer<font color="#808080">);
</font><font color="#000080"><b>begin
if </b></font>opAssunto <font color="#000080"><b>in </b></font>sreg <font color="#000080"><b>then begin
   case </b></font>nOpcao <font color="#000080"><b>of
    </b></font><font color="#FF0000">1</font><font color="#808080">: </font><font color="#000080"><b>begin
        </b></font>writeln<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">), </font>tAssunto<font color="#808080">.</font>codigo<font color="#808080">);
        </font>write<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">));
        </font>readln<font color="#808080">(</font>tAssunto<font color="#808080">.</font>assunto<font color="#808080">);
       </font><font color="#000080"><b>end</b></font><font color="#808080">;
    </font><font color="#FF0000">2</font><font color="#808080">: </font><font color="#000080"><b>begin
        </b></font>writeln<font color="#808080">(</font><font color="#800000">'C&oacute;digo     Assunto'</font><font color="#808080">);
        </font>writeln<font color="#808080">(</font><font color="#800000">'------     -------'</font><font color="#808080">);
       </font><font color="#000080"><b>end</b></font><font color="#808080">;
    </font><font color="#FF0000">3</font><font color="#808080">: </font><font color="#000080"><b>begin
        </b></font>tAssunto<font color="#808080">.</font>codigo<font color="#808080">:=</font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">);
        </font>tAssunto<font color="#808080">.</font>assunto<font color="#808080">:=</font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">11</font><font color="#808080">, </font><font color="#FF0000">30</font><font color="#808080">);
        </font>writeln<font color="#808080">(</font>tAssunto<font color="#808080">.</font>codigo<font color="#808080">,</font><font color="#800000">' '</font><font color="#808080">,</font>tAssunto<font color="#808080">.</font>assunto<font color="#808080">);
       </font><font color="#000080"><b>end</b></font><font color="#808080">;
   </font><font color="#000080"><b>end</b></font><font color="#808080">;
</font><font color="#000080"><b>end else if </b></font>opAutor <font color="#000080"><b>in </b></font>sreg <font color="#000080"><b>then begin
   case </b></font>nOpcao <font color="#000080"><b>of
    </b></font><font color="#FF0000">1</font><font color="#808080">: </font><font color="#000080"><b>begin
        </b></font>writeln<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">), </font>tAutor<font color="#808080">.</font>codigo<font color="#808080">);
        </font>write<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">));
        </font>readln<font color="#808080">(</font>tAutor<font color="#808080">.</font>autor<font color="#808080">);
       </font><font color="#000080"><b>end</b></font><font color="#808080">;
    </font><font color="#FF0000">2</font><font color="#808080">: </font><font color="#000080"><b>begin
        </b></font>writeln<font color="#808080">(</font><font color="#800000">'C&oacute;digo     Autor'</font><font color="#808080">);
        </font>writeln<font color="#808080">(</font><font color="#800000">'------     -----'</font><font color="#808080">);
       </font><font color="#000080"><b>end</b></font><font color="#808080">;
    </font><font color="#FF0000">3</font><font color="#808080">: </font><font color="#000080"><b>begin
        </b></font>tAutor<font color="#808080">.</font>codigo<font color="#808080">:=</font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">);
        </font>tAutor<font color="#808080">.</font>autor<font color="#808080">:=</font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">11</font><font color="#808080">, </font><font color="#FF0000">30</font><font color="#808080">);
        </font>writeln<font color="#808080">(</font>tAutor<font color="#808080">.</font>codigo<font color="#808080">,</font><font color="#800000">' '</font><font color="#808080">,</font>tAutor<font color="#808080">.</font>autor<font color="#808080">);
       </font><font color="#000080"><b>end</b></font><font color="#808080">;
   </font><font color="#000080"><b>end</b></font><font color="#808080">;
</font><font color="#000080"><b>end else if </b></font>opEditora <font color="#000080"><b>in </b></font>sreg <font color="#000080"><b>then begin
   case </b></font>nOpcao <font color="#000080"><b>of
    </b></font><font color="#FF0000">1</font><font color="#808080">: </font><font color="#000080"><b>begin
        </b></font>writeln<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">), </font>tEditora<font color="#808080">.</font>codigo<font color="#808080">);
        </font>write<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">));
        </font>readln<font color="#808080">(</font>tEditora<font color="#808080">.</font>editora<font color="#808080">);
       </font><font color="#000080"><b>end</b></font><font color="#808080">;
    </font><font color="#FF0000">2</font><font color="#808080">: </font><font color="#000080"><b>begin
        </b></font>writeln<font color="#808080">(</font><font color="#800000">'C&oacute;digo     Editora'</font><font color="#808080">);
        </font>writeln<font color="#808080">(</font><font color="#800000">'------     -------'</font><font color="#808080">);
       </font><font color="#000080"><b>end</b></font><font color="#808080">;
    </font><font color="#FF0000">3</font><font color="#808080">: </font><font color="#000080"><b>begin
        </b></font>tEditora<font color="#808080">.</font>codigo<font color="#808080">:=</font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">);
        </font>tEditora<font color="#808080">.</font>editora<font color="#808080">:=</font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">11</font><font color="#808080">, </font><font color="#FF0000">50</font><font color="#808080">);
        </font>writeln<font color="#808080">(</font>tEditora<font color="#808080">.</font>codigo<font color="#808080">,</font><font color="#800000">' '</font><font color="#808080">,</font>tEditora<font color="#808080">.</font>editora<font color="#808080">);
       </font><font color="#000080"><b>end</b></font><font color="#808080">;
   </font><font color="#000080"><b>end</b></font><font color="#808080">;
</font><font color="#000080"><b>end else if </b></font>opEndereco <font color="#000080"><b>in </b></font>sreg <font color="#000080"><b>then begin
   case </b></font>nOpcao <font color="#000080"><b>of
    </b></font><font color="#FF0000">1</font><font color="#808080">: </font><font color="#000080"><b>begin
        </b></font>writeln<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">), </font>tEndereco<font color="#808080">.</font>codigo<font color="#808080">);
        </font>write<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">));
        </font>readln<font color="#808080">(</font>tEndereco<font color="#808080">.</font>Logradouro<font color="#808080">);
        </font>write<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">));
        </font>readln<font color="#808080">(</font>tEndereco<font color="#808080">.</font>bairro<font color="#808080">);
        </font>write<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">4</font><font color="#808080">));
        </font>readln<font color="#808080">(</font>tEndereco<font color="#808080">.</font>cep<font color="#808080">);
        </font>write<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">5</font><font color="#808080">));
        </font>readln<font color="#808080">(</font>tEndereco<font color="#808080">.</font>cidade<font color="#808080">);
        </font>write<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">6</font><font color="#808080">));
        </font>readln<font color="#808080">(</font>tEndereco<font color="#808080">.</font>estado<font color="#808080">);
       </font><font color="#000080"><b>end</b></font><font color="#808080">;
    </font><font color="#FF0000">3</font><font color="#808080">: </font><font color="#000080"><b>begin
        </b></font>tEndereco<font color="#808080">.</font>codigo<font color="#808080">:=</font>trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">));
        </font>tEndereco<font color="#808080">.</font>logradouro<font color="#808080">:=</font>trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">11</font><font color="#808080">, </font><font color="#FF0000">40</font><font color="#808080">));
        </font>tEndereco<font color="#808080">.</font>bairro<font color="#808080">:=</font>trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">51</font><font color="#808080">, </font><font color="#FF0000">15</font><font color="#808080">));
        </font>tEndereco<font color="#808080">.</font>cep<font color="#808080">:=</font>trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">66</font><font color="#808080">, </font><font color="#FF0000">8</font><font color="#808080">));
        </font>tEndereco<font color="#808080">.</font>cidade<font color="#808080">:=</font>trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">74</font><font color="#808080">, </font><font color="#FF0000">30</font><font color="#808080">));
        </font>tEndereco<font color="#808080">.</font>estado<font color="#808080">:=</font>trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">104</font><font color="#808080">, </font><font color="#FF0000">20</font><font color="#808080">));
        </font>writeln<font color="#808080">(</font><font color="#800000">'--------------------'</font><font color="#808080">);
        </font>writeln<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">), </font>tEndereco<font color="#808080">.</font>codigo<font color="#808080">);
        </font>writeln<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">), </font>tEndereco<font color="#808080">.</font>Logradouro<font color="#808080">);
        </font>writeln<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">), </font>tEndereco<font color="#808080">.</font>bairro<font color="#808080">);
        </font>writeln<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">4</font><font color="#808080">), </font>tEndereco<font color="#808080">.</font>cep<font color="#808080">);
        </font>writeln<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">5</font><font color="#808080">), </font>tEndereco<font color="#808080">.</font>cidade<font color="#808080">);
        </font>writeln<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">6</font><font color="#808080">), </font>tEndereco<font color="#808080">.</font>estado<font color="#808080">);
       </font><font color="#000080"><b>end</b></font><font color="#808080">;
   </font><font color="#000080"><b>end</b></font><font color="#808080">;
</font><font color="#000080"><b>end else if </b></font>opIdioma <font color="#000080"><b>in </b></font>sreg <font color="#000080"><b>then begin
   case </b></font>nOpcao <font color="#000080"><b>of
    </b></font><font color="#FF0000">1</font><font color="#808080">: </font><font color="#000080"><b>begin
        </b></font>writeln<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">), </font>tIdioma<font color="#808080">.</font>codigo<font color="#808080">);
        </font>write<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">));
        </font>readln<font color="#808080">(</font>tIdioma<font color="#808080">.</font>idioma<font color="#808080">);
       </font><font color="#000080"><b>end</b></font><font color="#808080">;
    </font><font color="#FF0000">2</font><font color="#808080">: </font><font color="#000080"><b>begin
        </b></font>writeln<font color="#808080">(</font><font color="#800000">'C&oacute;digo     Idioma'</font><font color="#808080">);
        </font>writeln<font color="#808080">(</font><font color="#800000">'------     ------'</font><font color="#808080">);
       </font><font color="#000080"><b>end</b></font><font color="#808080">;
    </font><font color="#FF0000">3</font><font color="#808080">: </font><font color="#000080"><b>begin
        </b></font>tIdioma<font color="#808080">.</font>codigo<font color="#808080">:=</font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">);
        </font>tIdioma<font color="#808080">.</font>idioma<font color="#808080">:=</font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">11</font><font color="#808080">, </font><font color="#FF0000">20</font><font color="#808080">);
        </font>writeln<font color="#808080">(</font>tIdioma<font color="#808080">.</font>codigo<font color="#808080">,</font><font color="#800000">' '</font><font color="#808080">,</font>tIdioma<font color="#808080">.</font>idioma<font color="#808080">);
       </font><font color="#000080"><b>end</b></font><font color="#808080">;
   </font><font color="#000080"><b>end</b></font><font color="#808080">;
</font><font color="#000080"><b>end else if </b></font>opPais <font color="#000080"><b>in </b></font>sreg <font color="#000080"><b>then begin
   case </b></font>nOpcao <font color="#000080"><b>of
    </b></font><font color="#FF0000">1</font><font color="#808080">: </font><font color="#000080"><b>begin
        </b></font>write<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">));
        </font>readln<font color="#808080">(</font>tPais<font color="#808080">.</font>pais<font color="#808080">);
       </font><font color="#000080"><b>end</b></font><font color="#808080">;
    </font><font color="#FF0000">2</font><font color="#808080">: </font><font color="#000080"><b>begin
        </b></font>writeln<font color="#808080">(</font><font color="#800000">'C&oacute;digo Pa&iacute;s'</font><font color="#808080">);
        </font>writeln<font color="#808080">(</font><font color="#800000">'------ ----'</font><font color="#808080">);
       </font><font color="#000080"><b>end</b></font><font color="#808080">;
    </font><font color="#FF0000">3</font><font color="#808080">: </font><font color="#000080"><b>begin
        </b></font>tPais<font color="#808080">.</font>codigo<font color="#808080">:=</font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">);
        </font>tPais<font color="#808080">.</font>pais<font color="#808080">:=</font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">4</font><font color="#808080">, </font><font color="#FF0000">50</font><font color="#808080">);
        </font>writeln<font color="#808080">(</font>tPais<font color="#808080">.</font>codigo<font color="#808080">,</font><font color="#800000">'    '</font><font color="#808080">,</font>tPais<font color="#808080">.</font>pais<font color="#808080">);
       </font><font color="#000080"><b>end</b></font><font color="#808080">;
   </font><font color="#000080"><b>end</b></font><font color="#808080">;
</font><font color="#000080"><b>end else if </b></font>opProfissao <font color="#000080"><b>in </b></font>sreg <font color="#000080"><b>then begin
   case </b></font>nOpcao <font color="#000080"><b>of
    </b></font><font color="#FF0000">1</font><font color="#808080">: </font><font color="#000080"><b>begin
        </b></font>writeln<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">), </font>tProfissao<font color="#808080">.</font>codigo<font color="#808080">);
        </font>write<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">));
        </font>readln<font color="#808080">(</font>tProfissao<font color="#808080">.</font>profissao<font color="#808080">);
       </font><font color="#000080"><b>end</b></font><font color="#808080">;
    </font><font color="#FF0000">2</font><font color="#808080">: </font><font color="#000080"><b>begin
        </b></font>writeln<font color="#808080">(</font><font color="#800000">'C&oacute;digo     Profiss&atilde;o'</font><font color="#808080">);
        </font>writeln<font color="#808080">(</font><font color="#800000">'------     ---------'</font><font color="#808080">);
       </font><font color="#000080"><b>end</b></font><font color="#808080">;
    </font><font color="#FF0000">3</font><font color="#808080">: </font><font color="#000080"><b>begin
        </b></font>tProfissao<font color="#808080">.</font>codigo<font color="#808080">:=</font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">);
        </font>tProfissao<font color="#808080">.</font>profissao<font color="#808080">:=</font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">11</font><font color="#808080">, </font><font color="#FF0000">50</font><font color="#808080">);
        </font>writeln<font color="#808080">(</font>tProfissao<font color="#808080">.</font>codigo<font color="#808080">,</font><font color="#800000">' '</font><font color="#808080">,</font>tProfissao<font color="#808080">.</font>profissao<font color="#808080">);
       </font><font color="#000080"><b>end</b></font><font color="#808080">;
   </font><font color="#000080"><b>end</b></font><font color="#808080">;
</font><font color="#000080"><b>end else if </b></font>opLivro <font color="#000080"><b>in </b></font>sreg <font color="#000080"><b>then begin
   case </b></font>nOpcao <font color="#000080"><b>of
    </b></font><font color="#FF0000">1</font><font color="#808080">: </font><font color="#000080"><b>begin
        </b></font>write<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">));
        </font>readln<font color="#808080">(</font>tLivro<font color="#808080">.</font>titulo<font color="#808080">);
        </font>tLivro<font color="#808080">.</font>edicao<font color="#808080">:=</font>validaNumero<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">), </font>tLivro<font color="#808080">.</font>edicao<font color="#808080">);
        </font>tLivro<font color="#808080">.</font>anopubli<font color="#808080">:=</font>validaNumero<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">4</font><font color="#808080">), </font>tLivro<font color="#808080">.</font>anopubli<font color="#808080">);
        </font>mostrarSubDados<font color="#808080">([</font>opLivro<font color="#808080">], [</font>opEditora<font color="#808080">], </font>false<font color="#808080">);
        </font>tLivro<font color="#808080">.</font>volume<font color="#808080">:=</font>validaNumero<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">6</font><font color="#808080">), </font>tLivro<font color="#808080">.</font>volume<font color="#808080">);
        </font>mostrarSubDados<font color="#808080">([</font>opLivro<font color="#808080">], [</font>opIdioma<font color="#808080">], </font>false<font color="#808080">);
        </font>tLivro<font color="#808080">.</font>npaginas<font color="#808080">:=</font>validaNumero<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">8</font><font color="#808080">), </font>tLivro<font color="#808080">.</font>npaginas<font color="#808080">);
        </font>tLivro<font color="#808080">.</font>preco<font color="#808080">:=</font>validaNumero<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">9</font><font color="#808080">), </font>tLivro<font color="#808080">.</font>preco<font color="#808080">);
        </font>tLivro<font color="#808080">.</font>qtdestoque<font color="#808080">:=</font>validaNumero<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">), </font>tLivro<font color="#808080">.</font>qtdestoque<font color="#808080">);
       </font><font color="#000080"><b>end</b></font><font color="#808080">;
    </font><font color="#FF0000">3</font><font color="#808080">: </font><font color="#000080"><b>begin
        </b></font>tLivro<font color="#808080">.</font>isbn<font color="#808080">:=</font>trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">13</font><font color="#808080">));
        </font>tLivro<font color="#808080">.</font>titulo<font color="#808080">:=</font>trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">14</font><font color="#808080">, </font><font color="#FF0000">50</font><font color="#808080">));
        </font>tLivro<font color="#808080">.</font>edicao<font color="#808080">:=</font>trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">64</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">));
        </font>tLivro<font color="#808080">.</font>anopubli<font color="#808080">:=</font>trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">74</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">));
        </font>tLivro<font color="#808080">.</font>codeditora<font color="#808080">:=</font>trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">84</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">));
        </font>tLivro<font color="#808080">.</font>volume<font color="#808080">:=</font>trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">94</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">));
        </font>tLivro<font color="#808080">.</font>codidioma<font color="#808080">:=</font>trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">104</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">));
        </font>tLivro<font color="#808080">.</font>npaginas<font color="#808080">:=</font>trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">114</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">));
        </font>tLivro<font color="#808080">.</font>preco<font color="#808080">:=</font>trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">124</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">));
        </font>tLivro<font color="#808080">.</font>qtdestoque<font color="#808080">:=</font>trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">134</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">));
        </font>writeln<font color="#808080">(</font><font color="#800000">'--------------------'</font><font color="#808080">);
        </font>writeln<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">), </font>tLivro<font color="#808080">.</font>isbn<font color="#808080">);
        </font>writeln<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">), </font>tLivro<font color="#808080">.</font>titulo<font color="#808080">);
        </font>writeln<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">), </font>tLivro<font color="#808080">.</font>edicao<font color="#808080">);
        </font>writeln<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">4</font><font color="#808080">), </font>tLivro<font color="#808080">.</font>anopubli<font color="#808080">);
        </font>writeln<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">5</font><font color="#808080">), </font>tLivro<font color="#808080">.</font>codeditora<font color="#808080">);
        </font>mostrarSubDados<font color="#808080">([</font>opLivro<font color="#808080">], [</font>opEditora<font color="#808080">], </font>true<font color="#808080">);
        </font>writeln<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">6</font><font color="#808080">), </font>tLivro<font color="#808080">.</font>volume<font color="#808080">);
        </font>writeln<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">7</font><font color="#808080">), </font>tLivro<font color="#808080">.</font>codidioma<font color="#808080">);
        </font>mostrarSubDados<font color="#808080">([</font>opLivro<font color="#808080">], [</font>opIdioma<font color="#808080">], </font>true<font color="#808080">);
        </font>writeln<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">8</font><font color="#808080">), </font>tLivro<font color="#808080">.</font>npaginas<font color="#808080">);
        </font>writeln<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">9</font><font color="#808080">), </font>tLivro<font color="#808080">.</font>preco<font color="#808080">);
        </font>writeln<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">), </font>tLivro<font color="#808080">.</font>qtdestoque<font color="#808080">);
        </font>ListarRegLigados<font color="#808080">(</font>tfLivroAss<font color="#808080">, [</font>opLivroAss<font color="#808080">], </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">13</font><font color="#808080">, </font><font color="#FF0000">14</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">, </font>tLivro<font color="#808080">.</font>isbn<font color="#808080">,
                         </font>tfAssunto<font color="#808080">, [</font>opAssunto<font color="#808080">], </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">4</font><font color="#808080">);
        </font>ListarRegLigados<font color="#808080">(</font>tfLivroAut<font color="#808080">, [</font>opLivroAut<font color="#808080">], </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">13</font><font color="#808080">, </font><font color="#FF0000">14</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">, </font>tLivro<font color="#808080">.</font>isbn<font color="#808080">,
                         </font>tfAutor<font color="#808080">, [</font>opAutor<font color="#808080">], </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">4</font><font color="#808080">);
       </font><font color="#000080"><b>end</b></font><font color="#808080">;
   </font><font color="#000080"><b>end</b></font><font color="#808080">;
</font><font color="#000080"><b>end else if </b></font>opCliente <font color="#000080"><b>in </b></font>sreg <font color="#000080"><b>then begin
   case </b></font>nOpcao <font color="#000080"><b>of
    </b></font><font color="#FF0000">1</font><font color="#808080">: </font><font color="#000080"><b>begin
        </b></font>write<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">));
        </font>readln<font color="#808080">(</font>tCliente<font color="#808080">.</font>nome<font color="#808080">);
        </font>write<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">));
        </font>readln<font color="#808080">(</font>tCliente<font color="#808080">.</font>email<font color="#808080">);
        </font>write<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">4</font><font color="#808080">));
        </font>readln<font color="#808080">(</font>tCliente<font color="#808080">.</font>identidade<font color="#808080">);
        </font>write<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">5</font><font color="#808080">));
        </font>readln<font color="#808080">(</font>tCliente<font color="#808080">.</font>sexo<font color="#808080">);
        </font>write<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">6</font><font color="#808080">));
        </font>readln<font color="#808080">(</font>tCliente<font color="#808080">.</font>telefone<font color="#808080">);
        </font>tCliente<font color="#808080">.</font>dtnascimento<font color="#808080">:=
                </font>validaDataHora<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">7</font><font color="#808080">), </font>tCliente<font color="#808080">.</font>dtnascimento<font color="#808080">, </font>true<font color="#808080">);
        </font>mostrarSubDados<font color="#808080">([</font>opCliente<font color="#808080">], [</font>opEndereco<font color="#808080">], </font>false<font color="#808080">);
        </font>mostrarSubDados<font color="#808080">([</font>opCliente<font color="#808080">], [</font>opPais<font color="#808080">], </font>false<font color="#808080">);
        </font>mostrarSubDados<font color="#808080">([</font>opCliente<font color="#808080">], [</font>opProfissao<font color="#808080">], </font>false<font color="#808080">);
       </font><font color="#000080"><b>end</b></font><font color="#808080">;
    </font><font color="#FF0000">3</font><font color="#808080">: </font><font color="#000080"><b>begin
        </b></font>tCliente<font color="#808080">.</font>cpf<font color="#808080">:=</font>trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">14</font><font color="#808080">));
        </font>tCliente<font color="#808080">.</font>nome<font color="#808080">:=</font>trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">15</font><font color="#808080">, </font><font color="#FF0000">30</font><font color="#808080">));
        </font>tCliente<font color="#808080">.</font>email<font color="#808080">:=</font>trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">45</font><font color="#808080">, </font><font color="#FF0000">30</font><font color="#808080">));
        </font>tCliente<font color="#808080">.</font>identidade<font color="#808080">:=</font>trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">75</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">));
        </font>tCliente<font color="#808080">.</font>sexo<font color="#808080">:=</font>trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">85</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">));
        </font>tCliente<font color="#808080">.</font>telefone<font color="#808080">:=</font>trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">86</font><font color="#808080">, </font><font color="#FF0000">17</font><font color="#808080">));
        </font>tCliente<font color="#808080">.</font>dtnascimento<font color="#808080">:=</font>trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">103</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">));
        </font>tCliente<font color="#808080">.</font>codendereco<font color="#808080">:=</font>trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">113</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">));
        </font>tCliente<font color="#808080">.</font>codpais<font color="#808080">:=</font>trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">123</font><font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">));
        </font>tCliente<font color="#808080">.</font>codprofissao<font color="#808080">:=</font>trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">126</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">));
        </font>writeln<font color="#808080">(</font><font color="#800000">'--------------------'</font><font color="#808080">);
        </font>writeln<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">), </font>tCliente<font color="#808080">.</font>cpf<font color="#808080">);
        </font>writeln<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">), </font>tCliente<font color="#808080">.</font>nome<font color="#808080">);
        </font>writeln<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">), </font>tCliente<font color="#808080">.</font>email<font color="#808080">);
        </font>writeln<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">4</font><font color="#808080">), </font>tCliente<font color="#808080">.</font>identidade<font color="#808080">);
        </font>writeln<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">5</font><font color="#808080">), </font>tCliente<font color="#808080">.</font>sexo<font color="#808080">);
        </font>writeln<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">6</font><font color="#808080">), </font>tCliente<font color="#808080">.</font>telefone<font color="#808080">);
        </font>writeln<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">7</font><font color="#808080">), </font>tCliente<font color="#808080">.</font>dtnascimento<font color="#808080">);
        </font>writeln<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">8</font><font color="#808080">), </font>tCliente<font color="#808080">.</font>codendereco<font color="#808080">);
        </font>mostrarSubDados<font color="#808080">([</font>opCliente<font color="#808080">], [</font>opEndereco<font color="#808080">], </font>true<font color="#808080">);
        </font>writeln<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">9</font><font color="#808080">), </font>tCliente<font color="#808080">.</font>codpais<font color="#808080">);
        </font>mostrarSubDados<font color="#808080">([</font>opCliente<font color="#808080">], [</font>opPais<font color="#808080">], </font>true<font color="#808080">);
        </font>writeln<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">), </font>tCliente<font color="#808080">.</font>codprofissao<font color="#808080">);
        </font>mostrarSubDados<font color="#808080">([</font>opCliente<font color="#808080">], [</font>opProfissao<font color="#808080">], </font>true<font color="#808080">);
       </font><font color="#000080"><b>end</b></font><font color="#808080">;
   </font><font color="#000080"><b>end</b></font><font color="#808080">;
</font><font color="#000080"><b>end else if </b></font>opVenda <font color="#000080"><b>in </b></font>sreg <font color="#000080"><b>then begin
   case </b></font>nOpcao <font color="#000080"><b>of
    </b></font><font color="#FF0000">1</font><font color="#808080">: </font>mostrarSubDados<font color="#808080">([</font>opVenda<font color="#808080">],[</font>opVenda<font color="#808080">], </font>false<font color="#808080">);
    </font><font color="#FF0000">2</font><font color="#808080">: </font><font color="#000080"><b>begin
        </b></font>writeln<font color="#808080">(</font><font color="#800000">'DataHoraVenda       CPF            ISBN          '</font><font color="#808080">+
        </font><font color="#800000">'Pre&ccedil;oVenda'</font><font color="#808080">);
        </font>writeln<font color="#808080">(</font><font color="#800000">'-------------       ---            ----          '</font><font color="#808080">+
        </font><font color="#800000">'----------'</font><font color="#808080">);
       </font><font color="#000080"><b>end</b></font><font color="#808080">;
    </font><font color="#FF0000">3</font><font color="#808080">: </font><font color="#000080"><b>begin
        </b></font>tVenda<font color="#808080">.</font>dthrvenda<font color="#808080">:=</font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">19</font><font color="#808080">);
        </font>tVenda<font color="#808080">.</font>cpf<font color="#808080">:=</font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">20</font><font color="#808080">, </font><font color="#FF0000">14</font><font color="#808080">);
        </font>tVenda<font color="#808080">.</font>isbn<font color="#808080">:=</font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">34</font><font color="#808080">, </font><font color="#FF0000">13</font><font color="#808080">);
        </font>tVenda<font color="#808080">.</font>precovenda<font color="#808080">:=</font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">47</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">);
        </font>writeln<font color="#808080">(</font>tVenda<font color="#808080">.</font>dthrvenda<font color="#808080">,</font><font color="#800000">' '</font><font color="#808080">,</font>tVenda<font color="#808080">.</font>cpf<font color="#808080">,</font><font color="#800000">' '</font><font color="#808080">,</font>tVenda<font color="#808080">.</font>isbn<font color="#808080">,</font><font color="#800000">' '</font><font color="#808080">,
        </font>tVenda<font color="#808080">.</font>precovenda<font color="#808080">);
       </font><font color="#000080"><b>end</b></font><font color="#808080">;
   </font><font color="#000080"><b>end</b></font><font color="#808080">;
</font><font color="#000080"><b>end</b></font><font color="#808080">;

</font><font color="#000080"><b>end</b></font><font color="#808080">;
<i>{------------------------------------------------------------------------------
Mostra as sub inform&ccedil;&otilde;es de entrada e de sa&iacute;da.
sreg - o tipo de arquivo
ssubreg - o subtipo de arquivo
bSoMostrar - se vai s&oacute; mostrar na sa&iacute;da 
------------------------------------------------------------------------------}
</i></font><font color="#000080"><b>procedure </b></font>mostrarSubDados<font color="#808080">(</font>sreg<font color="#808080">, </font>ssubreg<font color="#808080">: </font>ctArqs<font color="#808080">; </font>bSoMostrar<font color="#808080">: </font>boolean<font color="#808080">);
</font><font color="#000080"><b>var </b></font>sRegistro<font color="#808080">, </font>sPreco<font color="#808080">: </font>mstring<font color="#808080">;
    </font>nStatus<font color="#808080">, </font>nMaxTentativas<font color="#808080">: </font>integer<font color="#808080">;
</font><font color="#000080"><b>begin
</b></font>nMaxTentativas<font color="#808080">:=</font><font color="#FF0000">3</font><font color="#808080">;
</font><font color="#000080"><b>if </b></font>opLivro <font color="#000080"><b>in </b></font>sreg <font color="#000080"><b>then begin
  if </b></font>opEditora <font color="#000080"><b>in </b></font>ssubreg <font color="#000080"><b>then begin
    if </b></font>bSoMostrar <font color="#000080"><b>then
       </b></font>sRegistro<font color="#808080">:=</font>pesqArq<font color="#808080">(</font>tfEditora<font color="#808080">,</font>tLivro<font color="#808080">.</font>codeditora<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">,</font>tamReg<font color="#808080">([</font>opEditora<font color="#808080">]))
    </font><font color="#000080"><b>else
       </b></font>sRegistro<font color="#808080">:=</font>validaEntrada<font color="#808080">(</font>tfEditora<font color="#808080">,</font>ssubreg<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font>tLivro<font color="#808080">.</font>codeditora<font color="#808080">,
                  </font>nMaxTentativas<font color="#808080">,</font>false<font color="#808080">,[</font>opNumero<font color="#808080">]);
    </font><font color="#000080"><b>if </b></font>sRegistro<font color="#808080">&lt;&gt;</font><font color="#800000">'' </font><font color="#000080"><b>then begin
      </b></font>tLivro<font color="#808080">.</font>codeditora<font color="#808080">:=</font>trim<font color="#808080">(</font>copy<font color="#808080">(</font>sRegistro<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">));
      </font>write<font color="#808080">(</font><font color="#800000">' '</font><font color="#808080">,</font>rotulo<font color="#808080">([</font>opEditora<font color="#808080">], </font><font color="#FF0000">2</font><font color="#808080">));
      </font>writeln<font color="#808080">(</font>copy<font color="#808080">(</font>sRegistro<font color="#808080">, </font>g_nPosChave<font color="#808080">, </font>g_nTamChave<font color="#808080">));
    </font><font color="#000080"><b>end</b></font><font color="#808080">;
  </font><font color="#000080"><b>end else if </b></font>opIdioma <font color="#000080"><b>in </b></font>ssubreg <font color="#000080"><b>then begin
    if </b></font>bSoMostrar <font color="#000080"><b>then
       </b></font>sRegistro<font color="#808080">:=</font>pesqArq<font color="#808080">(</font>tfIdioma<font color="#808080">, </font>tLivro<font color="#808080">.</font>codidioma<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">,</font>tamReg<font color="#808080">([</font>opIdioma<font color="#808080">]))
    </font><font color="#000080"><b>else
       </b></font>sRegistro<font color="#808080">:=</font>validaEntrada<font color="#808080">(</font>tfIdioma<font color="#808080">,</font>ssubreg<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font>tLivro<font color="#808080">.</font>codidioma<font color="#808080">,
                  </font>nMaxTentativas<font color="#808080">,</font>false<font color="#808080">,[</font>opNumero<font color="#808080">]);
    </font><font color="#000080"><b>if </b></font>sRegistro<font color="#808080">&lt;&gt;</font><font color="#800000">'' </font><font color="#000080"><b>then begin
      </b></font>tLivro<font color="#808080">.</font>codidioma<font color="#808080">:=</font>trim<font color="#808080">(</font>copy<font color="#808080">(</font>sRegistro<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">));
      </font>write<font color="#808080">(</font><font color="#800000">' '</font><font color="#808080">,</font>rotulo<font color="#808080">([</font>opIdioma<font color="#808080">], </font><font color="#FF0000">2</font><font color="#808080">));
      </font>writeln<font color="#808080">(</font>copy<font color="#808080">(</font>sRegistro<font color="#808080">, </font>g_nPosChave<font color="#808080">, </font>g_nTamChave<font color="#808080">));
    </font><font color="#000080"><b>end</b></font><font color="#808080">;
  </font><font color="#000080"><b>end</b></font><font color="#808080">;
</font><font color="#000080"><b>end else if </b></font>opCliente <font color="#000080"><b>in </b></font>sreg <font color="#000080"><b>then begin
  if </b></font>opEndereco <font color="#000080"><b>in </b></font>ssubreg <font color="#000080"><b>then begin
    if </b></font>bSoMostrar <font color="#000080"><b>then
       </b></font>sRegistro<font color="#808080">:=</font>pesqArq<font color="#808080">(</font>tfEndereco<font color="#808080">, </font>tCliente<font color="#808080">.</font>codendereco<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">,
                  </font>tamReg<font color="#808080">([</font>opEndereco<font color="#808080">]))
    </font><font color="#000080"><b>else
       </b></font>sRegistro<font color="#808080">:=</font>validaEntrada<font color="#808080">(</font>tfEndereco<font color="#808080">,</font>ssubreg<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font>tCliente<font color="#808080">.</font>codendereco<font color="#808080">,
                  </font>nMaxTentativas<font color="#808080">,</font>false<font color="#808080">,[</font>opNumero<font color="#808080">]);
    </font><font color="#000080"><b>if </b></font>sRegistro<font color="#808080">&lt;&gt;</font><font color="#800000">'' </font><font color="#000080"><b>then begin
      </b></font>tCliente<font color="#808080">.</font>codendereco<font color="#808080">:=</font>trim<font color="#808080">(</font>copy<font color="#808080">(</font>sRegistro<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">));
      </font>write<font color="#808080">(</font><font color="#800000">' '</font><font color="#808080">,</font>rotulo<font color="#808080">([</font>opEndereco<font color="#808080">], </font><font color="#FF0000">2</font><font color="#808080">));
      </font>writeln<font color="#808080">(</font>copy<font color="#808080">(</font>sRegistro<font color="#808080">, </font>g_nPosChave<font color="#808080">, </font>g_nTamChave<font color="#808080">));
      </font>write<font color="#808080">(</font><font color="#800000">' '</font><font color="#808080">,</font>rotulo<font color="#808080">([</font>opEndereco<font color="#808080">], </font><font color="#FF0000">3</font><font color="#808080">));
      </font>writeln<font color="#808080">(</font>copy<font color="#808080">(</font>sRegistro<font color="#808080">, </font>g_nPosChave<font color="#808080">, </font>g_nTamChave<font color="#808080">));
      </font>write<font color="#808080">(</font><font color="#800000">' '</font><font color="#808080">,</font>rotulo<font color="#808080">([</font>opEndereco<font color="#808080">], </font><font color="#FF0000">4</font><font color="#808080">));
      </font>writeln<font color="#808080">(</font>copy<font color="#808080">(</font>sRegistro<font color="#808080">, </font>g_nPosChave<font color="#808080">, </font>g_nTamChave<font color="#808080">));
      </font>write<font color="#808080">(</font><font color="#800000">' '</font><font color="#808080">,</font>rotulo<font color="#808080">([</font>opEndereco<font color="#808080">], </font><font color="#FF0000">5</font><font color="#808080">));
      </font>writeln<font color="#808080">(</font>copy<font color="#808080">(</font>sRegistro<font color="#808080">, </font>g_nPosChave<font color="#808080">, </font>g_nTamChave<font color="#808080">));
      </font>write<font color="#808080">(</font><font color="#800000">' '</font><font color="#808080">,</font>rotulo<font color="#808080">([</font>opEndereco<font color="#808080">], </font><font color="#FF0000">6</font><font color="#808080">));
      </font>writeln<font color="#808080">(</font>copy<font color="#808080">(</font>sRegistro<font color="#808080">, </font>g_nPosChave<font color="#808080">, </font>g_nTamChave<font color="#808080">));
    </font><font color="#000080"><b>end</b></font><font color="#808080">;
  </font><font color="#000080"><b>end else if </b></font>opPais <font color="#000080"><b>in </b></font>ssubreg <font color="#000080"><b>then begin
    if </b></font>bSoMostrar <font color="#000080"><b>then
       </b></font>sRegistro<font color="#808080">:=</font>pesqArq<font color="#808080">(</font>tfPais<font color="#808080">, </font>tCliente<font color="#808080">.</font>codpais<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">, </font>tamReg<font color="#808080">([</font>opPais<font color="#808080">]))
    </font><font color="#000080"><b>else
       </b></font>sRegistro<font color="#808080">:=</font>validaEntrada<font color="#808080">(</font>tfPais<font color="#808080">,</font>ssubreg<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font>tCliente<font color="#808080">.</font>codpais<font color="#808080">,
                  </font>nMaxTentativas<font color="#808080">,</font>false<font color="#808080">,[</font>opTexto<font color="#808080">]);
    </font><font color="#000080"><b>if </b></font>sRegistro<font color="#808080">&lt;&gt;</font><font color="#800000">'' </font><font color="#000080"><b>then begin
      </b></font>tCliente<font color="#808080">.</font>codpais<font color="#808080">:=</font>trim<font color="#808080">(</font>copy<font color="#808080">(</font>sRegistro<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#FF0000">3</font><font color="#808080">));
      </font>write<font color="#808080">(</font><font color="#800000">' '</font><font color="#808080">,</font>rotulo<font color="#808080">([</font>opPais<font color="#808080">], </font><font color="#FF0000">2</font><font color="#808080">));
      </font>writeln<font color="#808080">(</font>copy<font color="#808080">(</font>sRegistro<font color="#808080">, </font>g_nPosChave<font color="#808080">, </font>g_nTamChave<font color="#808080">));
    </font><font color="#000080"><b>end</b></font><font color="#808080">;
  </font><font color="#000080"><b>end else if </b></font>opProfissao <font color="#000080"><b>in </b></font>ssubreg <font color="#000080"><b>then begin
    if </b></font>bSoMostrar <font color="#000080"><b>then
       </b></font>sRegistro<font color="#808080">:=</font>pesqArq<font color="#808080">(</font>tfProfissao<font color="#808080">, </font>tCliente<font color="#808080">.</font>codprofissao<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">,
                  </font>tamReg<font color="#808080">([</font>opProfissao<font color="#808080">]))
    </font><font color="#000080"><b>else
       </b></font>sRegistro<font color="#808080">:=</font>validaEntrada<font color="#808080">(</font>tfProfissao<font color="#808080">,</font>ssubreg<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font>tCliente<font color="#808080">.</font>codprofissao<font color="#808080">,
                  </font>nMaxTentativas<font color="#808080">,</font>false<font color="#808080">,[</font>opNumero<font color="#808080">]);
    </font><font color="#000080"><b>if </b></font>sRegistro<font color="#808080">&lt;&gt;</font><font color="#800000">'' </font><font color="#000080"><b>then begin
      </b></font>tCliente<font color="#808080">.</font>codprofissao<font color="#808080">:=</font>trim<font color="#808080">(</font>copy<font color="#808080">(</font>sRegistro<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">));
      </font>write<font color="#808080">(</font><font color="#800000">' '</font><font color="#808080">,</font>rotulo<font color="#808080">([</font>opProfissao<font color="#808080">], </font><font color="#FF0000">2</font><font color="#808080">));
      </font>writeln<font color="#808080">(</font>copy<font color="#808080">(</font>sRegistro<font color="#808080">, </font>g_nPosChave<font color="#808080">, </font>g_nTamChave<font color="#808080">));
    </font><font color="#000080"><b>end</b></font><font color="#808080">;
  </font><font color="#000080"><b>end</b></font><font color="#808080">;
</font><font color="#000080"><b>end else if </b></font>opVenda <font color="#000080"><b>in </b></font>sreg <font color="#000080"><b>then begin
  </b></font>sRegistro<font color="#808080">:=</font>pesqArq<font color="#808080">(</font>tfLivro<font color="#808080">, </font>tVenda<font color="#808080">.</font>isbn<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">13</font><font color="#808080">, </font>tamReg<font color="#808080">([</font>opLivro<font color="#808080">]));
  </font><font color="#000080"><b>if </b></font>sRegistro<font color="#808080">&lt;&gt;</font><font color="#800000">'' </font><font color="#000080"><b>then begin
    </b></font>write<font color="#808080">(</font><font color="#800000">' '</font><font color="#808080">,</font>rotulo<font color="#808080">([</font>opLivro<font color="#808080">], </font><font color="#FF0000">2</font><font color="#808080">)); <i>{ Titulo }
    </i></font>writeln<font color="#808080">(</font>copy<font color="#808080">(</font>sRegistro<font color="#808080">, </font>g_nPosChave<font color="#808080">, </font>g_nTamChave<font color="#808080">));
    </font>write<font color="#808080">(</font><font color="#800000">' '</font><font color="#808080">,</font>rotulo<font color="#808080">([</font>opLivro<font color="#808080">], </font><font color="#FF0000">9</font><font color="#808080">)); <i>{ Preco }
    </i></font>sPreco<font color="#808080">:=</font>copy<font color="#808080">(</font>sRegistro<font color="#808080">, </font>g_nPosChave<font color="#808080">, </font>g_nTamChave<font color="#808080">);
    </font>val<font color="#808080">(</font>sPreco<font color="#808080">,</font>g_nPreco<font color="#808080">,</font>nStatus<font color="#808080">);
    </font>writeln<font color="#808080">(</font>sPreco<font color="#808080">);
  </font><font color="#000080"><b>end</b></font><font color="#808080">;
</font><font color="#000080"><b>end</b></font><font color="#808080">;
</font><font color="#000080"><b>end</b></font><font color="#808080">;
<i>{------------------------------------------------------------------------------
Realiza os cadastros dos arquivos que se ligam a outros arquivos.
sreg - o tipo de arquivo
sacao - a a&ccedil;&atilde;o a ser realizada
sCodigo - um das chaves do arquivo de liga&ccedil;&atilde;o
------------------------------------------------------------------------------}
</i></font><font color="#000080"><b>procedure </b></font>frmCadLigados<font color="#808080">(</font>sreg<font color="#808080">: </font>ctArqs<font color="#808080">; </font>sacao<font color="#808080">: </font>ctAcao<font color="#808080">; </font>sCodigo<font color="#808080">: </font>mstring<font color="#808080">);
</font><font color="#000080"><b>var </b></font>nQtd<font color="#808080">, </font>nCont<font color="#808080">, </font>nQtdEstoque<font color="#808080">, </font>nStatus<font color="#808080">: </font>integer<font color="#808080">;
    </font>nTotalPreco<font color="#808080">: </font>double<font color="#808080">;
    </font>slinha<font color="#808080">, </font>sTotalPreco<font color="#808080">, </font>sPreco<font color="#808080">, </font>sQtd<font color="#808080">: </font>mstring<font color="#808080">;
</font><font color="#000080"><b>begin
if </b></font>opNovo <font color="#000080"><b>in </b></font>sacao <font color="#000080"><b>then begin
  </b></font>nCont<font color="#808080">:=</font><font color="#FF0000">1</font><font color="#808080">;
  </font><font color="#000080"><b>if </b></font>opLivroAss <font color="#000080"><b>in </b></font>sreg <font color="#000080"><b>then begin
    </b></font>sQtd<font color="#808080">:=</font>validaNumero<font color="#808080">(</font><font color="#800000">'Quantos assuntos quer cadastrar?: '</font><font color="#808080">, </font>sQtd<font color="#808080">);
    </font>Val<font color="#808080">(</font>sQtd<font color="#808080">,</font>nQtd<font color="#808080">,</font>nStatus<font color="#808080">);
    </font>seek<font color="#808080">(</font>tfLivroAss<font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">);
    </font><font color="#000080"><b>while </b></font>nCont <font color="#808080">&lt;= </font>nQtd <font color="#000080"><b>do begin
      </b></font>tLivroAss<font color="#808080">.</font>isbn<font color="#808080">:=</font>sCodigo<font color="#808080">;
      </font>write<font color="#808080">(</font>rotulo<font color="#808080">([</font>opLivroAss<font color="#808080">], </font><font color="#FF0000">2</font><font color="#808080">));
      </font>readln<font color="#808080">(</font>tLivroAss<font color="#808080">.</font>codassunto<font color="#808080">);
      </font>slinha<font color="#808080">:=</font>pesqArq<font color="#808080">(</font>tfAssunto<font color="#808080">, </font>tLivroAss<font color="#808080">.</font>codassunto<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">,</font>tamReg<font color="#808080">([</font>opAssunto<font color="#808080">]));
      </font>write<font color="#808080">(</font><font color="#800000">' '</font><font color="#808080">,</font>rotulo<font color="#808080">([</font>opAssunto<font color="#808080">], </font><font color="#FF0000">2</font><font color="#808080">));
      </font>writeln<font color="#808080">(</font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font>g_nPosChave<font color="#808080">, </font>g_nTamChave<font color="#808080">));
      </font>pesqLinhaExcluida<font color="#808080">(</font>tfLivroAss<font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">));
      </font>subMenu<font color="#808080">(</font><font color="#FF0000">14</font><font color="#808080">, </font>sreg<font color="#808080">);
      </font>nCont<font color="#808080">:=</font>nCont<font color="#808080">+</font><font color="#FF0000">1</font><font color="#808080">;
    </font><font color="#000080"><b>end</b></font><font color="#808080">;
  </font><font color="#000080"><b>end else if </b></font>opLivroAut <font color="#000080"><b>in </b></font>sreg <font color="#000080"><b>then begin
    </b></font>sQtd<font color="#808080">:=</font>validaNumero<font color="#808080">(</font><font color="#800000">'Quantos autores quer cadastrar?: '</font><font color="#808080">,</font>sQtd<font color="#808080">);
    </font>Val<font color="#808080">(</font>sQtd<font color="#808080">,</font>nQtd<font color="#808080">,</font>nStatus<font color="#808080">);
    </font>seek<font color="#808080">(</font>tfLivroAut<font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">);
    </font><font color="#000080"><b>while </b></font>nCont <font color="#808080">&lt;= </font>nQtd <font color="#000080"><b>do begin
      </b></font>tLivroAut<font color="#808080">.</font>isbn<font color="#808080">:=</font>sCodigo<font color="#808080">;
      </font>write<font color="#808080">(</font>rotulo<font color="#808080">([</font>opLivroAut<font color="#808080">], </font><font color="#FF0000">2</font><font color="#808080">));
      </font>readln<font color="#808080">(</font>tLivroAut<font color="#808080">.</font>codautor<font color="#808080">);
      </font>slinha<font color="#808080">:=</font>pesqArq<font color="#808080">(</font>tfAutor<font color="#808080">, </font>tLivroAut<font color="#808080">.</font>codautor<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">,</font>tamReg<font color="#808080">([</font>opAutor<font color="#808080">]));
      </font>write<font color="#808080">(</font><font color="#800000">' '</font><font color="#808080">,</font>rotulo<font color="#808080">([</font>opAutor<font color="#808080">], </font><font color="#FF0000">2</font><font color="#808080">));
      </font>writeln<font color="#808080">(</font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font>g_nPosChave<font color="#808080">, </font>g_nTamChave<font color="#808080">));
      </font>pesqLinhaExcluida<font color="#808080">(</font>tfLivroAut<font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">));
      </font>subMenu<font color="#808080">(</font><font color="#FF0000">14</font><font color="#808080">, </font>sreg<font color="#808080">);
      </font>nCont<font color="#808080">:=</font>nCont<font color="#808080">+</font><font color="#FF0000">1</font><font color="#808080">;
    </font><font color="#000080"><b>end</b></font><font color="#808080">;
  </font><font color="#000080"><b>end else if </b></font>opVenda <font color="#000080"><b>in </b></font>sreg <font color="#000080"><b>then begin
    </b></font>sQtd<font color="#808080">:=</font>validaNumero<font color="#808080">(</font><font color="#800000">'Quantos livros quer vender?: '</font><font color="#808080">,</font>sQtd<font color="#808080">);
    </font>Val<font color="#808080">(</font>sQtd<font color="#808080">,</font>nQtd<font color="#808080">,</font>nStatus<font color="#808080">);
    </font>nTotalPreco<font color="#808080">:=</font><font color="#FF0000">0</font><font color="#808080">;
    </font><font color="#000080"><b>while </b></font>nCont <font color="#808080">&lt;= </font>nQtd <font color="#000080"><b>do begin
      </b></font>slinha<font color="#808080">:=</font>validaEntrada<font color="#808080">(</font>tfLivro<font color="#808080">,[</font>opLivro<font color="#808080">],</font><font color="#FF0000">1</font><font color="#808080">,</font>tVenda<font color="#808080">.</font>isbn<font color="#808080">,</font><font color="#FF0000">3</font><font color="#808080">,</font>false<font color="#808080">,[</font>opTexto<font color="#808080">]);
      </font><font color="#000080"><b>if </b></font>slinha<font color="#808080">&lt;&gt;</font><font color="#800000">'' </font><font color="#000080"><b>then begin
        </b></font>tVenda<font color="#808080">.</font>isbn<font color="#808080">:=</font>trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#FF0000">13</font><font color="#808080">));
        </font><font color="#000080"><b>if </b></font>validaISBN<font color="#808080">(</font>tVenda<font color="#808080">.</font>isbn<font color="#808080">) </font><font color="#000080"><b>then begin
          </b></font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#800000">''</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">);
          </font>tLivro<font color="#808080">.</font>qtdestoque<font color="#808080">:=</font>trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha<font color="#808080">,</font><font color="#FF0000">134</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">));
          </font>val<font color="#808080">(</font>tLivro<font color="#808080">.</font>qtdestoque<font color="#808080">,</font>nQtdEstoque<font color="#808080">,</font>nStatus<font color="#808080">);
          </font><font color="#000080"><b>if </b></font>nQtdEstoque <font color="#808080">&gt; </font><font color="#FF0000">0 </font><font color="#000080"><b>then begin
             </b></font>nTotalPreco<font color="#808080">:=</font>nTotalPreco <font color="#808080">+ </font>g_nPreco<font color="#808080">;
             </font>str<font color="#808080">(</font>g_nPreco<font color="#808080">:</font><font color="#FF0000">7</font><font color="#808080">:</font><font color="#FF0000">2</font><font color="#808080">,</font>sPreco<font color="#808080">);
             </font>tVenda<font color="#808080">.</font>precovenda<font color="#808080">:=</font>sPreco<font color="#808080">;
             </font>g_SalvarInclusao<font color="#808080">:=</font>false<font color="#808080">;
             </font>subMenu<font color="#808080">(</font><font color="#FF0000">14</font><font color="#808080">, </font>sreg<font color="#808080">);
             </font><font color="#000080"><b>if </b></font>g_SalvarInclusao <font color="#000080"><b>then begin
                </b></font>slinha<font color="#808080">:=</font>pesqArq<font color="#808080">(</font>tfLivro<font color="#808080">, </font>tVenda<font color="#808080">.</font>isbn<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">13</font><font color="#808080">, </font>tamReg<font color="#808080">([</font>opLivro<font color="#808080">]));
                </font><font color="#000080"><b>if </b></font>slinha<font color="#808080">&lt;&gt;</font><font color="#800000">'' </font><font color="#000080"><b>then begin
                   </b></font>nQtdEstoque<font color="#808080">:=</font>nQtdEstoque<font color="#808080">-</font><font color="#FF0000">1</font><font color="#808080">;
                   </font>str<font color="#808080">(</font>nQtdEstoque<font color="#808080">,</font>tLivro<font color="#808080">.</font>qtdestoque<font color="#808080">);
                   </font>slinha<font color="#808080">:=</font>copy<font color="#808080">(</font>slinha<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#FF0000">133</font><font color="#808080">)+</font>esp<font color="#808080">(</font>tLivro<font color="#808080">.</font>qtdestoque<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">);
                   </font>escreveArq<font color="#808080">(</font>tfLivro<font color="#808080">, </font>slinha<font color="#808080">, </font><font color="#800000">''</font><font color="#808080">, </font><font color="#800000">''</font><font color="#808080">);
                </font><font color="#000080"><b>end</b></font><font color="#808080">;
             </font><font color="#000080"><b>end</b></font><font color="#808080">;
             </font>nCont<font color="#808080">:=</font>nCont<font color="#808080">+</font><font color="#FF0000">1</font><font color="#808080">;
          </font><font color="#000080"><b>end else </b></font>writeln<font color="#808080">(</font>MSG_SEMESTOQUE<font color="#808080">);
        </font><font color="#000080"><b>end else </b></font>writeln<font color="#808080">(</font>MSG_ISBNINV<font color="#808080">);
      </font><font color="#000080"><b>end</b></font><font color="#808080">;
    </font><font color="#000080"><b>end</b></font><font color="#808080">;
    </font>str<font color="#808080">(</font>nTotalPreco<font color="#808080">:</font><font color="#FF0000">7</font><font color="#808080">:</font><font color="#FF0000">2</font><font color="#808080">, </font>sTotalPreco<font color="#808080">);
    </font>writeln<font color="#808080">(</font><font color="#800000">'Total de '</font><font color="#808080">,</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">,</font><font color="#FF0000">4</font><font color="#808080">),</font>sTotalPreco<font color="#808080">);
  </font><font color="#000080"><b>end</b></font><font color="#808080">;
</font><font color="#000080"><b>end else if </b></font>opExcluir <font color="#000080"><b>in </b></font>sacao <font color="#000080"><b>then begin
  if </b></font>opLivroAss <font color="#000080"><b>in </b></font>sreg <font color="#000080"><b>then begin
     </b></font>ExcluirRegLigados<font color="#808080">(</font>tfLivroAss<font color="#808080">, </font>sreg<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">13</font><font color="#808080">, </font>sCodigo<font color="#808080">);
  </font><font color="#000080"><b>end else if </b></font>opLivroAut <font color="#000080"><b>in </b></font>sreg <font color="#000080"><b>then begin
     </b></font>ExcluirRegLigados<font color="#808080">(</font>tfLivroAut<font color="#808080">, </font>sreg<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">13</font><font color="#808080">, </font>sCodigo<font color="#808080">);
  </font><font color="#000080"><b>end</b></font><font color="#808080">;
</font><font color="#000080"><b>end</b></font><font color="#808080">;

</font><font color="#000080"><b>end</b></font><font color="#808080">;
<i>{------------------------------------------------------------------------------
Realiza a exclus&atilde;o dos arquivos de liga&ccedil;&atilde;o.
sArq - o arquivo de liga&ccedil;&atilde;o
sreg - o tipo de arquivo de liga&ccedil;&atilde;o
nPosChave - a posicao inicial da chave dentro do registro
nTamChave - o tamanho da chave dentro do registro
sChave - a chave a ser excluida
------------------------------------------------------------------------------}
</i></font><font color="#000080"><b>procedure </b></font>ExcluirRegLigados<font color="#808080">(</font><font color="#000080"><b>var </b></font>sArq<font color="#808080">: </font><font color="#000080"><b>File</b></font><font color="#808080">; </font>sreg<font color="#808080">: </font>ctArqs<font color="#808080">; </font>nPosChave<font color="#808080">,
</font>nTamChave<font color="#808080">: </font>integer<font color="#808080">; </font>sChave<font color="#808080">: </font>mstring<font color="#808080">);
</font><font color="#000080"><b>var </b></font>slinha<font color="#808080">: </font>tregistro<font color="#808080">;
    </font>sCodigo<font color="#808080">: </font>mstring<font color="#808080">;
    </font>nStatus<font color="#808080">: </font>integer<font color="#808080">;
</font><font color="#000080"><b>begin
  </b></font>seek<font color="#808080">(</font>sArq<font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">);
  </font><font color="#000080"><b>while </b></font><font color="#808080">(</font><font color="#000080"><b>not </b></font>Eof<font color="#808080">(</font>sArq<font color="#808080">)) </font><font color="#000080"><b>do begin
    </b></font>BlockRead<font color="#808080">(</font>sArq<font color="#808080">, </font>slinha<font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">) + </font>TAM_CRLF<font color="#808080">, </font>nStatus<font color="#808080">);
    </font>sCodigo<font color="#808080">:=</font>trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha<font color="#808080">,</font>nPosChave<font color="#808080">,</font>nTamChave<font color="#808080">));
    </font><font color="#000080"><b>if </b></font>sCodigo<font color="#808080">=</font>sChave <font color="#000080"><b>then
       </b></font>btnAcao<font color="#808080">(</font>sreg<font color="#808080">,[</font>opConfirmaExclusao<font color="#808080">]);
  </font><font color="#000080"><b>end</b></font><font color="#808080">;
</font><font color="#000080"><b>end</b></font><font color="#808080">;
<i>{------------------------------------------------------------------------------
Parte inicial do c&oacute;digo
------------------------------------------------------------------------------}
</i></font><font color="#000080"><b>begin
 if </b></font>ParamStr<font color="#808080">(</font><font color="#FF0000">1</font><font color="#808080">)=</font><font color="#800000">'-cria' </font><font color="#000080"><b>then
     </b></font>abrecriaArqs<font color="#808080">(</font>false<font color="#808080">)
 </font><font color="#000080"><b>else begin
   </b></font>frmSplash<font color="#808080">;
   </font>abrecriaArqs<font color="#808080">(</font>true<font color="#808080">);
   </font><font color="#000080"><b>if </b></font>frmLogin <font color="#000080"><b>then begin
     </b></font>bopcao<font color="#808080">:=</font>true<font color="#808080">;
     </font><font color="#000080"><b>while</b></font><font color="#808080">(</font>bopcao<font color="#808080">) </font><font color="#000080"><b>do begin
       </b></font>menu<font color="#808080">(</font><font color="#FF0000">1</font><font color="#808080">);
       </font>readln<font color="#808080">(</font>opmenu<font color="#808080">);
       </font><font color="#000080"><b>if </b></font><font color="#808080">(</font>opmenu<font color="#808080">=</font><font color="#800000">'C'</font><font color="#808080">) </font><font color="#000080"><b>or </b></font><font color="#808080">(</font>opmenu<font color="#808080">=</font><font color="#800000">'c'</font><font color="#808080">) </font><font color="#000080"><b>then </b></font>usaMenu<font color="#808080">(</font><font color="#FF0000">1</font><font color="#808080">)
       </font><font color="#000080"><b>else if </b></font><font color="#808080">(</font>opmenu<font color="#808080">=</font><font color="#800000">'P'</font><font color="#808080">) </font><font color="#000080"><b>or </b></font><font color="#808080">(</font>opmenu<font color="#808080">=</font><font color="#800000">'p'</font><font color="#808080">) </font><font color="#000080"><b>then </b></font>usaMenu<font color="#808080">(</font><font color="#FF0000">2</font><font color="#808080">)
       </font><font color="#000080"><b>else if </b></font><font color="#808080">(</font>opmenu<font color="#808080">=</font><font color="#800000">'V'</font><font color="#808080">) </font><font color="#000080"><b>or </b></font><font color="#808080">(</font>opmenu<font color="#808080">=</font><font color="#800000">'v'</font><font color="#808080">) </font><font color="#000080"><b>then </b></font>usaMenu<font color="#808080">(</font><font color="#FF0000">3</font><font color="#808080">)
       </font><font color="#000080"><b>else if </b></font><font color="#808080">(</font>opmenu<font color="#808080">=</font><font color="#800000">'O'</font><font color="#808080">) </font><font color="#000080"><b>or </b></font><font color="#808080">(</font>opmenu<font color="#808080">=</font><font color="#800000">'o'</font><font color="#808080">) </font><font color="#000080"><b>then </b></font>usaMenu<font color="#808080">(</font><font color="#FF0000">4</font><font color="#808080">)
       </font><font color="#000080"><b>else </b></font>writeln<font color="#808080">(</font>MSG_ERRO<font color="#808080">);
     </font><font color="#000080"><b>end</b></font><font color="#808080">;
   </font><font color="#000080"><b>end else begin
     </b></font>fechaArqs<font color="#808080">;
     </font>halt<font color="#808080">;
   </font><font color="#000080"><b>end</b></font><font color="#808080">;
 </font><font color="#000080"><b>end</b></font><font color="#808080">;
</font><font color="#000080"><b>end</b></font><font color="#808080">.
</font></font>
</code></pre>
</body>
</html>