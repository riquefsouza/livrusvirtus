<html>
<head>
<title>Livrus Virtus - Console - Modula-2 - Implementação - GPM - Sistema</title>
</head>
<!-- Generated by ConTEXT HTML exporter -->
<body text="#000000" bgcolor="#FFFFFF">
<pre>
<code><font  face="Courier New"><font color="#0000FF">IMPLEMENTATION MODULE </font>Sistema<font color="#808080">;

</font><font color="#0000FF">FROM </font>Rotinas <font color="#0000FF">IMPORT </font>String<font color="#808080">, </font>stemp<font color="#808080">, </font>WriteLinha<font color="#808080">, </font>ReadLinha<font color="#808080">, </font>Ss<font color="#808080">,
</font>SomaStr<font color="#808080">, </font>copy<font color="#808080">, </font>trim<font color="#808080">, </font>repete<font color="#808080">, </font>strRelativa<font color="#808080">, 
</font>digitaSenha<font color="#808080">, </font>validaNumero<font color="#808080">, </font>validaDataHora<font color="#808080">;
</font><font color="#0000FF">FROM </font>Arquivos <font color="#0000FF">IMPORT </font>TAM_CRLF<font color="#808080">, </font>tfAssunto<font color="#808080">, </font>tfAutor<font color="#808080">, </font>tfEditora<font color="#808080">, 
</font>tfIdioma<font color="#808080">, </font>tfEndereco<font color="#808080">, </font>tfPais<font color="#808080">, </font>tfProfissao<font color="#808080">, </font>tfLivro<font color="#808080">, </font>tfLivroAss<font color="#808080">, 
</font>tfLivroAut<font color="#808080">, </font>tfCliente<font color="#808080">, </font>tfUsuario<font color="#808080">, </font>tfVenda<font color="#808080">,
</font>tAssunto<font color="#808080">, </font>tAutor<font color="#808080">, </font>tEditora<font color="#808080">, </font>tIdioma<font color="#808080">, </font>tEndereco<font color="#808080">, </font>tPais<font color="#808080">, 
</font>tProfissao<font color="#808080">, </font>tLivro<font color="#808080">, </font>tLivroAss<font color="#808080">, </font>tLivroAut<font color="#808080">, </font>tCliente<font color="#808080">, </font>tUsuario<font color="#808080">, </font>tVenda<font color="#808080">,
</font>fimArq<font color="#808080">, </font>lerArq<font color="#808080">, </font>pesqArq<font color="#808080">, </font>escreveArq<font color="#808080">, </font>tamReg<font color="#808080">,
</font>ctArqs<font color="#808080">, </font>ctAcao<font color="#808080">, </font>ctTipo<font color="#808080">, </font>LinhaReg<font color="#808080">;
</font><font color="#0000FF">FROM </font>RealStr <font color="#0000FF">IMPORT </font>RealToStr<font color="#808080">; 
</font><font color="#0000FF">FROM </font>Strings <font color="#0000FF">IMPORT </font>Compare<font color="#808080">, </font>CompareResults<font color="#808080">; 
</font><font color="#0000FF">FROM </font>Terminal <font color="#0000FF">IMPORT </font>WriteString<font color="#808080">;
</font><font color="#0000FF">FROM </font>RndFile <font color="#0000FF">IMPORT </font>ChanId<font color="#808080">, </font>SetPos<font color="#808080">;
</font><font color="#0000FF">FROM </font>InOut <font color="#0000FF">IMPORT </font>Read<font color="#808080">, </font>CloseInput<font color="#808080">;

(*------------------------------------------------------------------------------
</font>Seleciona o rotulo de cada campo de acordo com o tipo de arquivo.
sreg <font color="#808080">- </font>o tipo de arquivo
nNum <font color="#808080">- </font>indica qual rotulo ser<font color="#808080">&aacute; </font>retornado
retorna <font color="#808080">- </font>o rotulo
<font color="#808080">------------------------------------------------------------------------------*)
</font><font color="#0000FF">PROCEDURE </font>rotulo<font color="#808080">(</font>sreg<font color="#808080">: </font>ctArqs<font color="#808080">; </font>nNum<font color="#808080">: </font><font color="#0000FF">CARDINAL</font><font color="#808080">): </font>String<font color="#808080">;
</font><font color="#0000FF">VAR </font>sret<font color="#808080">: </font>String<font color="#808080">;
</font><font color="#0000FF">BEGIN
</font>sret<font color="#808080">:=</font><font color="#800000">''</font><font color="#808080">;
</font><font color="#0000FF">IF </font>sreg<font color="#808080">=</font>opAssunto <font color="#0000FF">THEN 
   CASE </font>nNum <font color="#0000FF">OF
   </font><font color="#808080">| </font><font color="#FF0000">0</font><font color="#808080">: </font>sret<font color="#808080">:=</font><font color="#800000">'Assunto(s) n&atilde;o encontrado(s)!'</font><font color="#808080">;
   | </font><font color="#FF0000">1</font><font color="#808080">: </font>sret<font color="#808080">:=</font><font color="#800000">'C&oacute;digo do assunto: '</font><font color="#808080">;
        </font>g_nPosChave<font color="#808080">:=</font><font color="#FF0000">1</font><font color="#808080">;
        </font>g_nTamChave<font color="#808080">:=</font><font color="#FF0000">10</font><font color="#808080">;
   | </font><font color="#FF0000">2</font><font color="#808080">: </font>sret<font color="#808080">:=</font><font color="#800000">'Assunto: '</font><font color="#808080">;
        </font>g_nPosChave<font color="#808080">:=</font><font color="#FF0000">11</font><font color="#808080">;
        </font>g_nTamChave<font color="#808080">:=</font><font color="#FF0000">30</font><font color="#808080">;
   </font><font color="#0000FF">END</font><font color="#808080">;
</font><font color="#0000FF">ELSIF </font>sreg<font color="#808080">=</font>opAutor <font color="#0000FF">THEN 
   CASE </font>nNum <font color="#0000FF">OF
   </font><font color="#808080">| </font><font color="#FF0000">0</font><font color="#808080">: </font>sret<font color="#808080">:=</font><font color="#800000">'Autor(es) n&atilde;o encontrado(s)!'</font><font color="#808080">;
   | </font><font color="#FF0000">1</font><font color="#808080">: </font>sret<font color="#808080">:=</font><font color="#800000">'C&oacute;digo do autor: '</font><font color="#808080">;
        </font>g_nPosChave<font color="#808080">:=</font><font color="#FF0000">1</font><font color="#808080">;
        </font>g_nTamChave<font color="#808080">:=</font><font color="#FF0000">10</font><font color="#808080">;
   | </font><font color="#FF0000">2</font><font color="#808080">: </font>sret<font color="#808080">:=</font><font color="#800000">'Autor: '</font><font color="#808080">;
        </font>g_nPosChave<font color="#808080">:=</font><font color="#FF0000">11</font><font color="#808080">;
        </font>g_nTamChave<font color="#808080">:=</font><font color="#FF0000">30</font><font color="#808080">;
   </font><font color="#0000FF">END</font><font color="#808080">;
</font><font color="#0000FF">ELSIF </font>sreg<font color="#808080">=</font>opEditora <font color="#0000FF">THEN 
   CASE </font>nNum <font color="#0000FF">OF
   </font><font color="#808080">| </font><font color="#FF0000">0</font><font color="#808080">: </font>sret<font color="#808080">:=</font><font color="#800000">'Editora(s) n&atilde;o encontrada(s)!'</font><font color="#808080">;
   | </font><font color="#FF0000">1</font><font color="#808080">: </font>sret<font color="#808080">:=</font><font color="#800000">'C&oacute;digo da editora: '</font><font color="#808080">;
        </font>g_nPosChave<font color="#808080">:=</font><font color="#FF0000">1</font><font color="#808080">;
        </font>g_nTamChave<font color="#808080">:=</font><font color="#FF0000">10</font><font color="#808080">;
   | </font><font color="#FF0000">2</font><font color="#808080">: </font>sret<font color="#808080">:=</font><font color="#800000">'Editora: '</font><font color="#808080">;
        </font>g_nPosChave<font color="#808080">:=</font><font color="#FF0000">11</font><font color="#808080">;
        </font>g_nTamChave<font color="#808080">:=</font><font color="#FF0000">50</font><font color="#808080">;
   </font><font color="#0000FF">END</font><font color="#808080">;
</font><font color="#0000FF">ELSIF </font>sreg<font color="#808080">=</font>opEndereco <font color="#0000FF">THEN 
   CASE </font>nNum <font color="#0000FF">OF
   </font><font color="#808080">| </font><font color="#FF0000">0</font><font color="#808080">: </font>sret<font color="#808080">:=</font><font color="#800000">'Endere&ccedil;o(s) n&atilde;o encontrado(s)!'</font><font color="#808080">;
   | </font><font color="#FF0000">1</font><font color="#808080">: </font>sret<font color="#808080">:=</font><font color="#800000">'C&oacute;digo do endere&ccedil;o: '</font><font color="#808080">;
        </font>g_nPosChave<font color="#808080">:=</font><font color="#FF0000">1</font><font color="#808080">;
        </font>g_nTamChave<font color="#808080">:=</font><font color="#FF0000">10</font><font color="#808080">;
   | </font><font color="#FF0000">2</font><font color="#808080">: </font>sret<font color="#808080">:=</font><font color="#800000">'Logradouro: '</font><font color="#808080">;
        </font>g_nPosChave<font color="#808080">:=</font><font color="#FF0000">11</font><font color="#808080">;
        </font>g_nTamChave<font color="#808080">:=</font><font color="#FF0000">40</font><font color="#808080">;
   | </font><font color="#FF0000">3</font><font color="#808080">: </font>sret<font color="#808080">:=</font><font color="#800000">'Bairro: '</font><font color="#808080">;
        </font>g_nPosChave<font color="#808080">:=</font><font color="#FF0000">51</font><font color="#808080">;
        </font>g_nTamChave<font color="#808080">:=</font><font color="#FF0000">15</font><font color="#808080">;
   | </font><font color="#FF0000">4</font><font color="#808080">: </font>sret<font color="#808080">:=</font><font color="#800000">'CEP: '</font><font color="#808080">;
        </font>g_nPosChave<font color="#808080">:=</font><font color="#FF0000">66</font><font color="#808080">;
        </font>g_nTamChave<font color="#808080">:=</font><font color="#FF0000">8</font><font color="#808080">;
   | </font><font color="#FF0000">5</font><font color="#808080">: </font>sret<font color="#808080">:=</font><font color="#800000">'Cidade: '</font><font color="#808080">;
        </font>g_nPosChave<font color="#808080">:=</font><font color="#FF0000">74</font><font color="#808080">;
        </font>g_nTamChave<font color="#808080">:=</font><font color="#FF0000">30</font><font color="#808080">;
   | </font><font color="#FF0000">6</font><font color="#808080">: </font>sret<font color="#808080">:=</font><font color="#800000">'Estado: '</font><font color="#808080">;
        </font>g_nPosChave<font color="#808080">:=</font><font color="#FF0000">104</font><font color="#808080">;
        </font>g_nTamChave<font color="#808080">:=</font><font color="#FF0000">20</font><font color="#808080">;
   </font><font color="#0000FF">END</font><font color="#808080">;
</font><font color="#0000FF">ELSIF </font>sreg<font color="#808080">=</font>opIdioma <font color="#0000FF">THEN 
   CASE </font>nNum <font color="#0000FF">OF
   </font><font color="#808080">| </font><font color="#FF0000">0</font><font color="#808080">: </font>sret<font color="#808080">:=</font><font color="#800000">'Idioma(s) n&atilde;o encontrado(s)!'</font><font color="#808080">;
   | </font><font color="#FF0000">1</font><font color="#808080">: </font>sret<font color="#808080">:=</font><font color="#800000">'C&oacute;digo do idioma: '</font><font color="#808080">;
        </font>g_nPosChave<font color="#808080">:=</font><font color="#FF0000">1</font><font color="#808080">;
        </font>g_nTamChave<font color="#808080">:=</font><font color="#FF0000">10</font><font color="#808080">;
   | </font><font color="#FF0000">2</font><font color="#808080">: </font>sret<font color="#808080">:=</font><font color="#800000">'Idioma: '</font><font color="#808080">;
        </font>g_nPosChave<font color="#808080">:=</font><font color="#FF0000">11</font><font color="#808080">;
        </font>g_nTamChave<font color="#808080">:=</font><font color="#FF0000">20</font><font color="#808080">;
   </font><font color="#0000FF">END</font><font color="#808080">;
</font><font color="#0000FF">ELSIF </font>sreg<font color="#808080">=</font>opPais <font color="#0000FF">THEN 
   CASE </font>nNum <font color="#0000FF">OF
   </font><font color="#808080">| </font><font color="#FF0000">0</font><font color="#808080">: </font>sret<font color="#808080">:=</font><font color="#800000">'Pa&iacute;s(es) n&atilde;o encontrado(s)!'</font><font color="#808080">;
   | </font><font color="#FF0000">1</font><font color="#808080">: </font>sret<font color="#808080">:=</font><font color="#800000">'C&oacute;digo do pa&iacute;s: '</font><font color="#808080">;
        </font>g_nPosChave<font color="#808080">:=</font><font color="#FF0000">1</font><font color="#808080">;
        </font>g_nTamChave<font color="#808080">:=</font><font color="#FF0000">3</font><font color="#808080">;
   | </font><font color="#FF0000">2</font><font color="#808080">: </font>sret<font color="#808080">:=</font><font color="#800000">'Pa&iacute;s: '</font><font color="#808080">;
        </font>g_nPosChave<font color="#808080">:=</font><font color="#FF0000">4</font><font color="#808080">;
        </font>g_nTamChave<font color="#808080">:=</font><font color="#FF0000">50</font><font color="#808080">;
   </font><font color="#0000FF">END</font><font color="#808080">;
</font><font color="#0000FF">ELSIF </font>sreg<font color="#808080">=</font>opProfissao <font color="#0000FF">THEN 
   CASE </font>nNum <font color="#0000FF">OF
   </font><font color="#808080">| </font><font color="#FF0000">0</font><font color="#808080">: </font>sret<font color="#808080">:=</font><font color="#800000">'Profiss&atilde;o(es) n&atilde;o encontrada(s)!'</font><font color="#808080">;
   | </font><font color="#FF0000">1</font><font color="#808080">: </font>sret<font color="#808080">:=</font><font color="#800000">'C&oacute;digo da profiss&atilde;o: '</font><font color="#808080">;
        </font>g_nPosChave<font color="#808080">:=</font><font color="#FF0000">1</font><font color="#808080">;
        </font>g_nTamChave<font color="#808080">:=</font><font color="#FF0000">10</font><font color="#808080">;
   | </font><font color="#FF0000">2</font><font color="#808080">: </font>sret<font color="#808080">:=</font><font color="#800000">'Profiss&atilde;o: '</font><font color="#808080">;
        </font>g_nPosChave<font color="#808080">:=</font><font color="#FF0000">11</font><font color="#808080">;
        </font>g_nTamChave<font color="#808080">:=</font><font color="#FF0000">50</font><font color="#808080">;
   </font><font color="#0000FF">END</font><font color="#808080">;
</font><font color="#0000FF">ELSIF </font>sreg<font color="#808080">=</font>opUsuario <font color="#0000FF">THEN 
   CASE </font>nNum <font color="#0000FF">OF
   </font><font color="#808080">| </font><font color="#FF0000">0</font><font color="#808080">: </font>sret<font color="#808080">:=</font><font color="#800000">'login ou senha incorreta, tente de novo!'</font><font color="#808080">;
   | </font><font color="#FF0000">1</font><font color="#808080">: </font>sret<font color="#808080">:=</font><font color="#800000">'Login: '</font><font color="#808080">;
        </font>g_nPosChave<font color="#808080">:=</font><font color="#FF0000">1</font><font color="#808080">;
        </font>g_nTamChave<font color="#808080">:=</font><font color="#FF0000">10</font><font color="#808080">;
   | </font><font color="#FF0000">2</font><font color="#808080">: </font>sret<font color="#808080">:=</font><font color="#800000">'Senha: '</font><font color="#808080">;
        </font>g_nPosChave<font color="#808080">:=</font><font color="#FF0000">11</font><font color="#808080">;
        </font>g_nTamChave<font color="#808080">:=</font><font color="#FF0000">10</font><font color="#808080">;
   </font><font color="#0000FF">END</font><font color="#808080">;
</font><font color="#0000FF">ELSIF </font>sreg<font color="#808080">=</font>opLivro <font color="#0000FF">THEN 
   CASE </font>nNum <font color="#0000FF">OF
   </font><font color="#808080">| </font><font color="#FF0000">0</font><font color="#808080">: </font>sret<font color="#808080">:=</font><font color="#800000">'Livro(s) n&atilde;o encontrado(s)!'</font><font color="#808080">;
   | </font><font color="#FF0000">1</font><font color="#808080">: </font>sret<font color="#808080">:=</font><font color="#800000">'ISBN: '</font><font color="#808080">;
        </font>g_nPosChave<font color="#808080">:=</font><font color="#FF0000">1</font><font color="#808080">;
        </font>g_nTamChave<font color="#808080">:=</font><font color="#FF0000">13</font><font color="#808080">;
   | </font><font color="#FF0000">2</font><font color="#808080">: </font>sret<font color="#808080">:=</font><font color="#800000">'T&iacute;tulo: '</font><font color="#808080">;
        </font>g_nPosChave<font color="#808080">:=</font><font color="#FF0000">14</font><font color="#808080">;
        </font>g_nTamChave<font color="#808080">:=</font><font color="#FF0000">50</font><font color="#808080">;
   | </font><font color="#FF0000">3</font><font color="#808080">: </font>sret<font color="#808080">:=</font><font color="#800000">'Edi&ccedil;&atilde;o: '</font><font color="#808080">;
        </font>g_nPosChave<font color="#808080">:=</font><font color="#FF0000">64</font><font color="#808080">;
        </font>g_nTamChave<font color="#808080">:=</font><font color="#FF0000">10</font><font color="#808080">;
   | </font><font color="#FF0000">4</font><font color="#808080">: </font>sret<font color="#808080">:=</font><font color="#800000">'Ano de Publica&ccedil;&atilde;o: '</font><font color="#808080">;
        </font>g_nPosChave<font color="#808080">:=</font><font color="#FF0000">74</font><font color="#808080">;
        </font>g_nTamChave<font color="#808080">:=</font><font color="#FF0000">10</font><font color="#808080">;
   | </font><font color="#FF0000">5</font><font color="#808080">: </font>sret<font color="#808080">:=</font><font color="#800000">'C&oacute;digo da editora: '</font><font color="#808080">;
        </font>g_nPosChave<font color="#808080">:=</font><font color="#FF0000">84</font><font color="#808080">;
        </font>g_nTamChave<font color="#808080">:=</font><font color="#FF0000">10</font><font color="#808080">;
   | </font><font color="#FF0000">6</font><font color="#808080">: </font>sret<font color="#808080">:=</font><font color="#800000">'Volume: '</font><font color="#808080">;
        </font>g_nPosChave<font color="#808080">:=</font><font color="#FF0000">94</font><font color="#808080">;
        </font>g_nTamChave<font color="#808080">:=</font><font color="#FF0000">10</font><font color="#808080">;
   | </font><font color="#FF0000">7</font><font color="#808080">: </font>sret<font color="#808080">:=</font><font color="#800000">'C&oacute;digo do idioma: '</font><font color="#808080">;
        </font>g_nPosChave<font color="#808080">:=</font><font color="#FF0000">104</font><font color="#808080">;
        </font>g_nTamChave<font color="#808080">:=</font><font color="#FF0000">10</font><font color="#808080">;
   | </font><font color="#FF0000">8</font><font color="#808080">: </font>sret<font color="#808080">:=</font><font color="#800000">'N&uacute;mero de p&aacute;ginas: '</font><font color="#808080">;
        </font>g_nPosChave<font color="#808080">:=</font><font color="#FF0000">114</font><font color="#808080">;
        </font>g_nTamChave<font color="#808080">:=</font><font color="#FF0000">10</font><font color="#808080">;
   | </font><font color="#FF0000">9</font><font color="#808080">: </font>sret<font color="#808080">:=</font><font color="#800000">'Pre&ccedil;o: '</font><font color="#808080">;
        </font>g_nPosChave<font color="#808080">:=</font><font color="#FF0000">124</font><font color="#808080">;
        </font>g_nTamChave<font color="#808080">:=</font><font color="#FF0000">10</font><font color="#808080">;
   | </font><font color="#FF0000">10</font><font color="#808080">: </font>sret<font color="#808080">:=</font><font color="#800000">'Qtd. Estoque: '</font><font color="#808080">;
         </font>g_nPosChave<font color="#808080">:=</font><font color="#FF0000">134</font><font color="#808080">;
         </font>g_nTamChave<font color="#808080">:=</font><font color="#FF0000">10</font><font color="#808080">;
   </font><font color="#0000FF">END</font><font color="#808080">;
</font><font color="#0000FF">ELSIF </font>sreg<font color="#808080">=</font>opLivroAss <font color="#0000FF">THEN 
   CASE </font>nNum <font color="#0000FF">OF
   </font><font color="#808080">| </font><font color="#FF0000">0</font><font color="#808080">: </font>sret<font color="#808080">:=</font><font color="#800000">'Assunto(s) n&atilde;o encontrado(s)!'</font><font color="#808080">;
   | </font><font color="#FF0000">1</font><font color="#808080">: </font>sret<font color="#808080">:=</font><font color="#800000">'ISBN: '</font><font color="#808080">;
        </font>g_nPosChave<font color="#808080">:=</font><font color="#FF0000">1</font><font color="#808080">;
        </font>g_nTamChave<font color="#808080">:=</font><font color="#FF0000">13</font><font color="#808080">;
   | </font><font color="#FF0000">2</font><font color="#808080">: </font>sret<font color="#808080">:=</font><font color="#800000">'C&oacute;digo do assunto: '</font><font color="#808080">;
        </font>g_nPosChave<font color="#808080">:=</font><font color="#FF0000">14</font><font color="#808080">;
        </font>g_nTamChave<font color="#808080">:=</font><font color="#FF0000">10</font><font color="#808080">;
   </font><font color="#0000FF">END</font><font color="#808080">;
</font><font color="#0000FF">ELSIF </font>sreg<font color="#808080">=</font>opLivroAut <font color="#0000FF">THEN 
   CASE </font>nNum <font color="#0000FF">OF
   </font><font color="#808080">| </font><font color="#FF0000">0</font><font color="#808080">: </font>sret<font color="#808080">:=</font><font color="#800000">'Autor(s) n&atilde;o encontrado(s)!'</font><font color="#808080">;
   | </font><font color="#FF0000">1</font><font color="#808080">: </font>sret<font color="#808080">:=</font><font color="#800000">'ISBN: '</font><font color="#808080">;
        </font>g_nPosChave<font color="#808080">:=</font><font color="#FF0000">1</font><font color="#808080">;
        </font>g_nTamChave<font color="#808080">:=</font><font color="#FF0000">13</font><font color="#808080">;
   | </font><font color="#FF0000">2</font><font color="#808080">: </font>sret<font color="#808080">:=</font><font color="#800000">'C&oacute;digo do autor: '</font><font color="#808080">;
        </font>g_nPosChave<font color="#808080">:=</font><font color="#FF0000">14</font><font color="#808080">;
        </font>g_nTamChave<font color="#808080">:=</font><font color="#FF0000">10</font><font color="#808080">;
   </font><font color="#0000FF">END</font><font color="#808080">;
</font><font color="#0000FF">ELSIF </font>sreg<font color="#808080">=</font>opCliente <font color="#0000FF">THEN 
   CASE </font>nNum <font color="#0000FF">OF
   </font><font color="#808080">| </font><font color="#FF0000">0</font><font color="#808080">: </font>sret<font color="#808080">:=</font><font color="#800000">'Cliente(s) n&atilde;o encontrado(s)!'</font><font color="#808080">;
   | </font><font color="#FF0000">1</font><font color="#808080">: </font>sret<font color="#808080">:=</font><font color="#800000">'CPF: '</font><font color="#808080">;
        </font>g_nPosChave<font color="#808080">:=</font><font color="#FF0000">1</font><font color="#808080">;
        </font>g_nTamChave<font color="#808080">:=</font><font color="#FF0000">14</font><font color="#808080">;
   | </font><font color="#FF0000">2</font><font color="#808080">: </font>sret<font color="#808080">:=</font><font color="#800000">'Nome: '</font><font color="#808080">;
        </font>g_nPosChave<font color="#808080">:=</font><font color="#FF0000">15</font><font color="#808080">;
        </font>g_nTamChave<font color="#808080">:=</font><font color="#FF0000">30</font><font color="#808080">;
   | </font><font color="#FF0000">3</font><font color="#808080">: </font>sret<font color="#808080">:=</font><font color="#800000">'E-mail: '</font><font color="#808080">;
        </font>g_nPosChave<font color="#808080">:=</font><font color="#FF0000">45</font><font color="#808080">;
        </font>g_nTamChave<font color="#808080">:=</font><font color="#FF0000">30</font><font color="#808080">;
   | </font><font color="#FF0000">4</font><font color="#808080">: </font>sret<font color="#808080">:=</font><font color="#800000">'Identidade: '</font><font color="#808080">;
        </font>g_nPosChave<font color="#808080">:=</font><font color="#FF0000">75</font><font color="#808080">;
        </font>g_nTamChave<font color="#808080">:=</font><font color="#FF0000">10</font><font color="#808080">;
   | </font><font color="#FF0000">5</font><font color="#808080">: </font>sret<font color="#808080">:=</font><font color="#800000">'Sexo: '</font><font color="#808080">;
        </font>g_nPosChave<font color="#808080">:=</font><font color="#FF0000">85</font><font color="#808080">;
        </font>g_nTamChave<font color="#808080">:=</font><font color="#FF0000">1</font><font color="#808080">;
   | </font><font color="#FF0000">6</font><font color="#808080">: </font>sret<font color="#808080">:=</font><font color="#800000">'Telefone: '</font><font color="#808080">;
        </font>g_nPosChave<font color="#808080">:=</font><font color="#FF0000">86</font><font color="#808080">;
        </font>g_nTamChave<font color="#808080">:=</font><font color="#FF0000">17</font><font color="#808080">;
   | </font><font color="#FF0000">7</font><font color="#808080">: </font>sret<font color="#808080">:=</font><font color="#800000">'Dt. Nascimento: '</font><font color="#808080">;
        </font>g_nPosChave<font color="#808080">:=</font><font color="#FF0000">103</font><font color="#808080">;
        </font>g_nTamChave<font color="#808080">:=</font><font color="#FF0000">10</font><font color="#808080">;
   | </font><font color="#FF0000">8</font><font color="#808080">: </font>sret<font color="#808080">:=</font><font color="#800000">'C&oacute;digo do endere&ccedil;o: '</font><font color="#808080">;
        </font>g_nPosChave<font color="#808080">:=</font><font color="#FF0000">113</font><font color="#808080">;
        </font>g_nTamChave<font color="#808080">:=</font><font color="#FF0000">10</font><font color="#808080">;
   | </font><font color="#FF0000">9</font><font color="#808080">: </font>sret<font color="#808080">:=</font><font color="#800000">'C&oacute;digo do pa&iacute;s: '</font><font color="#808080">;
        </font>g_nPosChave<font color="#808080">:=</font><font color="#FF0000">123</font><font color="#808080">;
        </font>g_nTamChave<font color="#808080">:=</font><font color="#FF0000">3</font><font color="#808080">;
   | </font><font color="#FF0000">10</font><font color="#808080">: </font>sret<font color="#808080">:=</font><font color="#800000">'C&oacute;digo da Profiss&atilde;o: '</font><font color="#808080">;
         </font>g_nPosChave<font color="#808080">:=</font><font color="#FF0000">126</font><font color="#808080">;
         </font>g_nTamChave<font color="#808080">:=</font><font color="#FF0000">10</font><font color="#808080">;
   </font><font color="#0000FF">END</font><font color="#808080">;
</font><font color="#0000FF">ELSIF </font>sreg<font color="#808080">=</font>opVenda <font color="#0000FF">THEN 
   CASE </font>nNum <font color="#0000FF">OF
   </font><font color="#808080">| </font><font color="#FF0000">0</font><font color="#808080">: </font>sret<font color="#808080">:=</font><font color="#800000">'Venda(s) n&atilde;o encontrada(s)!'</font><font color="#808080">;
   | </font><font color="#FF0000">1</font><font color="#808080">: </font>sret<font color="#808080">:=</font><font color="#800000">'Data/Hora venda: '</font><font color="#808080">;
        </font>g_nPosChave<font color="#808080">:=</font><font color="#FF0000">1</font><font color="#808080">;
        </font>g_nTamChave<font color="#808080">:=</font><font color="#FF0000">19</font><font color="#808080">;
   | </font><font color="#FF0000">2</font><font color="#808080">: </font>sret<font color="#808080">:=</font><font color="#800000">'CPF: '</font><font color="#808080">;
        </font>g_nPosChave<font color="#808080">:=</font><font color="#FF0000">20</font><font color="#808080">;
        </font>g_nTamChave<font color="#808080">:=</font><font color="#FF0000">14</font><font color="#808080">;
   | </font><font color="#FF0000">3</font><font color="#808080">: </font>sret<font color="#808080">:=</font><font color="#800000">'ISBN: '</font><font color="#808080">;
        </font>g_nPosChave<font color="#808080">:=</font><font color="#FF0000">34</font><font color="#808080">;
        </font>g_nTamChave<font color="#808080">:=</font><font color="#FF0000">13</font><font color="#808080">;
   | </font><font color="#FF0000">4</font><font color="#808080">: </font>sret<font color="#808080">:=</font><font color="#800000">'Pre+o de venda: '</font><font color="#808080">;
        </font>g_nPosChave<font color="#808080">:=</font><font color="#FF0000">47</font><font color="#808080">;
        </font>g_nTamChave<font color="#808080">:=</font><font color="#FF0000">10</font><font color="#808080">;
   </font><font color="#0000FF">END</font><font color="#808080">;
</font><font color="#0000FF">END</font><font color="#808080">;

</font><font color="#0000FF">RETURN </font>sret<font color="#808080">;
</font><font color="#0000FF">END </font>rotulo<font color="#808080">;
(*------------------------------------------------------------------------------
</font>Mostra os menus do sistema.
num <font color="#808080">- </font>o n<font color="#808080">&uacute;</font>mero do menu
<font color="#808080">------------------------------------------------------------------------------*)
</font><font color="#0000FF">PROCEDURE </font>menu<font color="#808080">(</font>num<font color="#808080">: </font><font color="#0000FF">CARDINAL</font><font color="#808080">);
</font><font color="#0000FF">BEGIN
 IF </font><font color="#808080">(</font>num<font color="#808080">=</font><font color="#FF0000">1</font><font color="#808080">) </font><font color="#0000FF">THEN 
   </font>WriteLinha<font color="#808080">(</font><font color="#800000">'*--------------------------------------------------------------*'</font><font color="#808080">);
   </font>WriteLinha<font color="#808080">(</font><font color="#800000">'| (C)adastros        (P)esquisas     (V)endas        (O)p&ccedil;&otilde;es  |'</font><font color="#808080">);
   </font>WriteLinha<font color="#808080">(</font><font color="#800000">'*--------------------------------------------------------------*'</font><font color="#808080">);
 </font><font color="#0000FF">ELSIF </font><font color="#808080">(</font>num<font color="#808080">=</font><font color="#FF0000">2</font><font color="#808080">) </font><font color="#0000FF">THEN 
   </font>WriteLinha<font color="#808080">(</font><font color="#800000">'*---------------------------------*'</font><font color="#808080">);
   </font>WriteLinha<font color="#808080">(</font><font color="#800000">'| 01. Cadastro de Assuntos        |'</font><font color="#808080">);
   </font>WriteLinha<font color="#808080">(</font><font color="#800000">'| 02. Cadastro de Autores         |'</font><font color="#808080">);
   </font>WriteLinha<font color="#808080">(</font><font color="#800000">'| 03. Cadastro de Editoras        |'</font><font color="#808080">);
   </font>WriteLinha<font color="#808080">(</font><font color="#800000">'| 04. Cadastro de Endere&ccedil;os       |'</font><font color="#808080">);
   </font>WriteLinha<font color="#808080">(</font><font color="#800000">'| 05. Cadastro de Idiomas         |'</font><font color="#808080">);
   </font>WriteLinha<font color="#808080">(</font><font color="#800000">'| 06. Cadastro de Pa&iacute;ses          |'</font><font color="#808080">);
   </font>WriteLinha<font color="#808080">(</font><font color="#800000">'| 07. Cadastro de Profiss&otilde;es      |'</font><font color="#808080">);
   </font>WriteLinha<font color="#808080">(</font><font color="#800000">'| 08. Cadastro de Clientes        |'</font><font color="#808080">);
   </font>WriteLinha<font color="#808080">(</font><font color="#800000">'| 09. Cadastro de Livros          |'</font><font color="#808080">);
   </font>WriteLinha<font color="#808080">(</font><font color="#800000">'| 10. Voltar ao menu              |'</font><font color="#808080">);
   </font>WriteLinha<font color="#808080">(</font><font color="#800000">'*---------------------------------*'</font><font color="#808080">);
 </font><font color="#0000FF">ELSIF </font><font color="#808080">(</font>num<font color="#808080">=</font><font color="#FF0000">3</font><font color="#808080">) </font><font color="#0000FF">THEN 
   </font>WriteLinha<font color="#808080">(</font><font color="#800000">'*---------------------------------*'</font><font color="#808080">);
   </font>WriteLinha<font color="#808080">(</font><font color="#800000">'| 01. Consulta de Assuntos        |'</font><font color="#808080">);
   </font>WriteLinha<font color="#808080">(</font><font color="#800000">'| 02. Consulta de Autores         |'</font><font color="#808080">);
   </font>WriteLinha<font color="#808080">(</font><font color="#800000">'| 03. Consulta de Editoras        |'</font><font color="#808080">);
   </font>WriteLinha<font color="#808080">(</font><font color="#800000">'| 04. Consulta de Endere&ccedil;os       |'</font><font color="#808080">);
   </font>WriteLinha<font color="#808080">(</font><font color="#800000">'| 05. Consulta de Idiomas         |'</font><font color="#808080">);
   </font>WriteLinha<font color="#808080">(</font><font color="#800000">'| 06. Consulta de Pa&iacute;ses          |'</font><font color="#808080">);
   </font>WriteLinha<font color="#808080">(</font><font color="#800000">'| 07. Consulta de Profiss&otilde;es      |'</font><font color="#808080">);
   </font>WriteLinha<font color="#808080">(</font><font color="#800000">'| 08. Consulta de Clientes        |'</font><font color="#808080">);
   </font>WriteLinha<font color="#808080">(</font><font color="#800000">'| 09. Consulta de Livros          |'</font><font color="#808080">);
   </font>WriteLinha<font color="#808080">(</font><font color="#800000">'| 10. Voltar ao menu              |'</font><font color="#808080">);
   </font>WriteLinha<font color="#808080">(</font><font color="#800000">'*---------------------------------*'</font><font color="#808080">);
 </font><font color="#0000FF">ELSIF </font><font color="#808080">(</font>num<font color="#808080">=</font><font color="#FF0000">4</font><font color="#808080">) </font><font color="#0000FF">THEN 
   </font>WriteLinha<font color="#808080">(</font><font color="#800000">'*---------------------------------*'</font><font color="#808080">);
   </font>WriteLinha<font color="#808080">(</font><font color="#800000">'| 01. Vender Livros               |'</font><font color="#808080">);
   </font>WriteLinha<font color="#808080">(</font><font color="#800000">'| 02. Vendas Realizadas           |'</font><font color="#808080">);
   </font>WriteLinha<font color="#808080">(</font><font color="#800000">'| 03. Voltar ao menu              |'</font><font color="#808080">);
   </font>WriteLinha<font color="#808080">(</font><font color="#800000">'*---------------------------------*'</font><font color="#808080">);
 </font><font color="#0000FF">ELSIF </font><font color="#808080">(</font>num<font color="#808080">=</font><font color="#FF0000">5</font><font color="#808080">) </font><font color="#0000FF">THEN 
   </font>WriteLinha<font color="#808080">(</font><font color="#800000">'*---------------------------------*'</font><font color="#808080">);
   </font>WriteLinha<font color="#808080">(</font><font color="#800000">'| 01. Alterar senha               |'</font><font color="#808080">);
   </font>WriteLinha<font color="#808080">(</font><font color="#800000">'| 02. Sobre o sistema             |'</font><font color="#808080">);
   </font>WriteLinha<font color="#808080">(</font><font color="#800000">'| 03. Sair do sistema             |'</font><font color="#808080">);
   </font>WriteLinha<font color="#808080">(</font><font color="#800000">'| 04. Voltar ao menu              |'</font><font color="#808080">);
   </font>WriteLinha<font color="#808080">(</font><font color="#800000">'*---------------------------------*'</font><font color="#808080">);
 </font><font color="#0000FF">ELSIF </font><font color="#808080">(</font>num<font color="#808080">=</font><font color="#FF0000">6</font><font color="#808080">) </font><font color="#0000FF">THEN 
   </font>WriteLinha<font color="#808080">(</font><font color="#800000">'*--------------------------------------------------------------*'</font><font color="#808080">);
   </font>WriteLinha<font color="#808080">(</font><font color="#800000">'| (1) Novo  (2) Pesquisar   (3) Voltar ao menu                 |'</font><font color="#808080">);
   </font>WriteLinha<font color="#808080">(</font><font color="#800000">'*--------------------------------------------------------------*'</font><font color="#808080">);
 </font><font color="#0000FF">ELSIF </font><font color="#808080">(</font>num<font color="#808080">=</font><font color="#FF0000">7</font><font color="#808080">) </font><font color="#0000FF">THEN 
   </font>WriteLinha<font color="#808080">(</font><font color="#800000">'*--------------------------------------------------------------*'</font><font color="#808080">);
   </font>WriteLinha<font color="#808080">(</font><font color="#800000">'| (1) Salvar inclus&atilde;o       (2) Voltar ao menu                 |'</font><font color="#808080">);
   </font>WriteLinha<font color="#808080">(</font><font color="#800000">'*--------------------------------------------------------------*'</font><font color="#808080">);
 </font><font color="#0000FF">ELSIF </font><font color="#808080">(</font>num<font color="#808080">=</font><font color="#FF0000">8</font><font color="#808080">) </font><font color="#0000FF">THEN 
   </font>WriteLinha<font color="#808080">(</font><font color="#800000">'*--------------------------------------------------------------*'</font><font color="#808080">);
   </font>WriteLinha<font color="#808080">(</font><font color="#800000">'| (1) Alterar       (2) Excluir     (3) Voltar ao menu         |'</font><font color="#808080">);
   </font>WriteLinha<font color="#808080">(</font><font color="#800000">'*--------------------------------------------------------------*'</font><font color="#808080">);
 </font><font color="#0000FF">ELSIF </font><font color="#808080">(</font>num<font color="#808080">=</font><font color="#FF0000">9</font><font color="#808080">) </font><font color="#0000FF">THEN 
   </font>WriteLinha<font color="#808080">(</font><font color="#800000">'*--------------------------------------------------------------*'</font><font color="#808080">);
   </font>WriteLinha<font color="#808080">(</font><font color="#800000">'| (1) Salvar altera&ccedil;&atilde;o      (2) Voltar ao menu                 |'</font><font color="#808080">);
   </font>WriteLinha<font color="#808080">(</font><font color="#800000">'*--------------------------------------------------------------*'</font><font color="#808080">);
 </font><font color="#0000FF">ELSIF </font><font color="#808080">(</font>num<font color="#808080">=</font><font color="#FF0000">10</font><font color="#808080">) </font><font color="#0000FF">THEN 
   </font>WriteLinha<font color="#808080">(</font><font color="#800000">'*--------------------------------------------------------------*'</font><font color="#808080">);
   </font>WriteLinha<font color="#808080">(</font><font color="#800000">'| Certeza de excluir? (S/N)                                    |'</font><font color="#808080">);
   </font>WriteLinha<font color="#808080">(</font><font color="#800000">'*--------------------------------------------------------------*'</font><font color="#808080">);
 </font><font color="#0000FF">ELSIF </font><font color="#808080">(</font>num<font color="#808080">=</font><font color="#FF0000">11</font><font color="#808080">) </font><font color="#0000FF">THEN 
   </font>WriteLinha<font color="#808080">(</font><font color="#800000">'*--------------------------------------------------------------*'</font><font color="#808080">);
   </font>WriteLinha<font color="#808080">(</font><font color="#800000">'| Deseja sair do sistema? (S/N)                                |'</font><font color="#808080">);
   </font>WriteLinha<font color="#808080">(</font><font color="#800000">'*--------------------------------------------------------------*'</font><font color="#808080">);
 </font><font color="#0000FF">ELSIF </font><font color="#808080">(</font>num<font color="#808080">=</font><font color="#FF0000">12</font><font color="#808080">) </font><font color="#0000FF">THEN 
   </font>WriteLinha<font color="#808080">(</font><font color="#800000">'*--------------------------------------------------------------*'</font><font color="#808080">);
   </font>WriteLinha<font color="#808080">(</font><font color="#800000">'| (1) Pesquisar  (2) Listar todos   (3) Voltar ao menu         |'</font><font color="#808080">);
   </font>WriteLinha<font color="#808080">(</font><font color="#800000">'*--------------------------------------------------------------*'</font><font color="#808080">);
 </font><font color="#0000FF">ELSIF </font><font color="#808080">(</font>num<font color="#808080">=</font><font color="#FF0000">13</font><font color="#808080">) </font><font color="#0000FF">THEN 
   </font>WriteLinha<font color="#808080">(</font><font color="#800000">'*--------------------------------------------------------------*'</font><font color="#808080">);
   </font>WriteLinha<font color="#808080">(</font><font color="#800000">'| Deseja continuar? (S/N)                                      |'</font><font color="#808080">);
   </font>WriteLinha<font color="#808080">(</font><font color="#800000">'*--------------------------------------------------------------*'</font><font color="#808080">);
 </font><font color="#0000FF">ELSIF </font><font color="#808080">(</font>num<font color="#808080">=</font><font color="#FF0000">14</font><font color="#808080">) </font><font color="#0000FF">THEN 
   </font>WriteLinha<font color="#808080">(</font><font color="#800000">'*--------------------------------------------------------------*'</font><font color="#808080">);
   </font>WriteLinha<font color="#808080">(</font><font color="#800000">'| Salvar inclus&atilde;o (S/N)                                        |'</font><font color="#808080">);
   </font>WriteLinha<font color="#808080">(</font><font color="#800000">'*--------------------------------------------------------------*'</font><font color="#808080">);
 </font><font color="#0000FF">END</font><font color="#808080">;
 </font>WriteString<font color="#808080">(</font>MSG_OPCAO<font color="#808080">);
 </font>CloseInput<font color="#808080">();
</font><font color="#0000FF">END </font>menu<font color="#808080">;
(*------------------------------------------------------------------------------
</font>Indica se continua ou n<font color="#808080">&atilde;</font>o mostrando um n<font color="#808080">&uacute;</font>mero m<font color="#808080">&aacute;</font>ximo de linhas.
nlinha <font color="#808080">- </font>a linha a ser continuada
nQtdLinha <font color="#808080">- </font>a quantidade de linhas a serem mostradas
retorna <font color="#808080">- </font>se continua ou n<font color="#808080">&atilde;</font>o
<font color="#808080">------------------------------------------------------------------------------*)
</font><font color="#0000FF">PROCEDURE </font>ContinuaSN<font color="#808080">(</font>nlinha<font color="#808080">, </font>nQtdLinha<font color="#808080">: </font><font color="#0000FF">CARDINAL</font><font color="#808080">): </font><font color="#0000FF">BOOLEAN</font><font color="#808080">;
</font><font color="#0000FF">VAR </font>bSOp<font color="#808080">, </font>bret <font color="#808080">: </font><font color="#0000FF">BOOLEAN</font><font color="#808080">;
    </font>opCSubMenu<font color="#808080">: </font><font color="#0000FF">CHAR</font><font color="#808080">;
</font><font color="#0000FF">BEGIN
</font>bret<font color="#808080">:=</font>FALSE<font color="#808080">;
</font><font color="#0000FF">IF </font>nlinha <font color="#808080">&gt; </font><font color="#FF0000">0 </font><font color="#0000FF">THEN 
  IF </font><font color="#808080">(</font>nlinha <font color="#0000FF">MOD </font>nQtdLinha<font color="#808080">) = </font><font color="#FF0000">0 </font><font color="#0000FF">THEN 
    </font>bSOp<font color="#808080">:=</font>TRUE<font color="#808080">;
    </font><font color="#0000FF">WHILE</font><font color="#808080">(</font>bSOp<font color="#808080">) </font><font color="#0000FF">DO 
       </font>menu<font color="#808080">(</font><font color="#FF0000">13</font><font color="#808080">);
       </font>Read<font color="#808080">(</font>opCSubMenu<font color="#808080">);
       </font><font color="#0000FF">IF </font><font color="#808080">(</font>opCSubMenu<font color="#808080">=</font><font color="#800000">'S'</font><font color="#808080">) </font><font color="#0000FF">OR </font><font color="#808080">(</font>opCSubMenu<font color="#808080">=</font><font color="#800000">'s'</font><font color="#808080">) </font><font color="#0000FF">THEN </font>bSOp<font color="#808080">:=</font>FALSE<font color="#808080">;
       </font><font color="#0000FF">ELSIF </font><font color="#808080">(</font>opCSubMenu<font color="#808080">=</font><font color="#800000">'N'</font><font color="#808080">) </font><font color="#0000FF">OR </font><font color="#808080">(</font>opCSubMenu<font color="#808080">=</font><font color="#800000">'n'</font><font color="#808080">) </font><font color="#0000FF">THEN 
          </font>bret<font color="#808080">:=</font>TRUE<font color="#808080">;
          </font>bSOp<font color="#808080">:=</font>FALSE<font color="#808080">;
       </font><font color="#0000FF">ELSE </font>WriteLinha<font color="#808080">(</font>MSG_ERRO<font color="#808080">);
       </font><font color="#0000FF">END</font><font color="#808080">;  
    </font><font color="#0000FF">END</font><font color="#808080">;
  </font><font color="#0000FF">END</font><font color="#808080">;
</font><font color="#0000FF">END</font><font color="#808080">;

</font><font color="#0000FF">RETURN </font>bret<font color="#808080">;
</font><font color="#0000FF">END </font>ContinuaSN<font color="#808080">;
(*------------------------------------------------------------------------------
</font>Lista v<font color="#808080">&aacute;</font>rios registros de acordo com a pesquisa feita.
sArq <font color="#808080">- </font>o arquivo
sreg <font color="#808080">- </font>o tipo de arquivo
sChave <font color="#808080">- </font>a chave a ser pesquisada
nPosChave <font color="#808080">- </font>a posicao inicial da chave dentro do registro
nTamChave <font color="#808080">- </font>o tamanho da chave dentro do registro
nTamLinha <font color="#808080">- </font>o tamanho do registro
nQtdLinha <font color="#808080">- </font>a quantidade de linhas a serem mostradas
retorna <font color="#808080">- </font>se encontrou algum registro
<font color="#808080">------------------------------------------------------------------------------*)
</font><font color="#0000FF">PROCEDURE </font>ListarTodos<font color="#808080">(</font><font color="#0000FF">VAR </font>sArq<font color="#808080">: </font>ChanId<font color="#808080">; </font>sreg<font color="#808080">: </font>ctArqs<font color="#808080">; </font>sChave<font color="#808080">: </font>String<font color="#808080">;
   </font>nPosChave<font color="#808080">, </font>nTamChave<font color="#808080">, </font>nTamLinha<font color="#808080">, </font>nQtdLinha<font color="#808080">: </font><font color="#0000FF">CARDINAL</font><font color="#808080">;
   </font>bPesqRelativa<font color="#808080">: </font><font color="#0000FF">BOOLEAN</font><font color="#808080">): </font><font color="#0000FF">BOOLEAN</font><font color="#808080">;
</font><font color="#0000FF">VAR </font>slinha<font color="#808080">: </font>String<font color="#808080">;
    </font>bQuebra<font color="#808080">, </font>bAchou<font color="#808080">, </font>bRet<font color="#808080">: </font><font color="#0000FF">BOOLEAN</font><font color="#808080">;
    </font>nCont<font color="#808080">, </font>npos<font color="#808080">: </font><font color="#0000FF">CARDINAL</font><font color="#808080">;
    </font>sres<font color="#808080">: </font>String<font color="#808080">;
</font><font color="#0000FF">BEGIN
</font>bRet<font color="#808080">:=</font>FALSE<font color="#808080">;
</font>bQuebra<font color="#808080">:=</font>FALSE<font color="#808080">;
</font>nCont<font color="#808080">:=</font><font color="#FF0000">0</font><font color="#808080">;
</font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#800000">''</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">);
</font>npos<font color="#808080">:=</font><font color="#FF0000">0</font><font color="#808080">;
</font>SetPos<font color="#808080">(</font>sArq<font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">);
</font><font color="#0000FF">WHILE </font><font color="#808080">(</font><font color="#0000FF">NOT </font>fimArq<font color="#808080">(</font>sArq<font color="#808080">)) </font><font color="#0000FF">AND </font><font color="#808080">(</font>bQuebra<font color="#808080">=</font>FALSE<font color="#808080">) </font><font color="#0000FF">DO 
  </font>slinha<font color="#808080">:=</font>lerArq<font color="#808080">(</font>sArq<font color="#808080">, </font>nTamLinha<font color="#808080">, </font>TAM_CRLF<font color="#808080">, </font>npos<font color="#808080">);
  </font><font color="#0000FF">IF </font>bPesqRelativa <font color="#0000FF">THEN 
    </font>sres<font color="#808080">:=</font>trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha<font color="#808080">,</font>nPosChave<font color="#808080">,</font>nTamChave<font color="#808080">));
    </font><font color="#0000FF">IF </font>strRelativa<font color="#808080">(</font>sres<font color="#808080">,</font>sChave<font color="#808080">) </font><font color="#0000FF">THEN 
       </font>bAchou<font color="#808080">:=</font>TRUE<font color="#808080">;
       </font>bRet<font color="#808080">:=</font>TRUE<font color="#808080">;
    </font><font color="#0000FF">ELSE
       </font>bAchou<font color="#808080">:=</font>FALSE<font color="#808080">;
    </font><font color="#0000FF">END</font><font color="#808080">;
  </font><font color="#0000FF">ELSE 
    </font>bAchou<font color="#808080">:=</font>TRUE<font color="#808080">;
    </font>bRet<font color="#808080">:=</font>TRUE<font color="#808080">;
  </font><font color="#0000FF">END</font><font color="#808080">;

  </font><font color="#0000FF">IF </font>bAchou <font color="#0000FF">THEN 
    </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font>copy<font color="#808080">(</font>slinha<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font>nTamLinha<font color="#808080">), </font><font color="#FF0000">3</font><font color="#808080">);
    </font>nCont<font color="#808080">:=</font>nCont<font color="#808080">+</font><font color="#FF0000">1</font><font color="#808080">;
  </font><font color="#0000FF">END</font><font color="#808080">;

  </font>bQuebra<font color="#808080">:=</font>ContinuaSN<font color="#808080">(</font>nCont<font color="#808080">, </font>nQtdLinha<font color="#808080">);
</font><font color="#0000FF">END</font><font color="#808080">;
</font><font color="#0000FF">RETURN </font>bRet<font color="#808080">;
</font><font color="#0000FF">END </font>ListarTodos<font color="#808080">;
(*------------------------------------------------------------------------------
</font>Lista v<font color="#808080">&aacute;</font>rios registros entre arquivos de acordo com a pesquisa feita.
sArq1 <font color="#808080">- </font>o arquivo de liga<font color="#808080">&ccedil;&atilde;</font>o
sreg1 <font color="#808080">- </font>o tipo de arquivo de liga<font color="#808080">&ccedil;&atilde;</font>o
nPosChave1 <font color="#808080">- </font>a posicao inicial da primeira chave no arquivo de liga<font color="#808080">&ccedil;&atilde;</font>o
nTamChave1 <font color="#808080">- </font>o tamanho da primeira chave no arquivo de liga<font color="#808080">&ccedil;&atilde;</font>o
nPosChave2 <font color="#808080">- </font>a posicao inicial da segunda chave do arquivo de liga<font color="#808080">&ccedil;&atilde;</font>o
nTamChave2 <font color="#808080">- </font>o tamanho da segunda chave do arquivo de liga<font color="#808080">&ccedil;&atilde;</font>o
sChave <font color="#808080">- </font>a chave a ser pesquisada no arquivo de liga<font color="#808080">&ccedil;&atilde;</font>o
sArq2 <font color="#808080">- </font>o arquivo a ser pesquisado
sreg2 <font color="#808080">- </font>o tipo de arquivo a ser pesquisado
nPosChave3 <font color="#808080">- </font>a posicao inicial da chave do arquivo pesquisado
nQtdLinha <font color="#808080">- </font>a quantidade de linhas a serem mostradas
<font color="#808080">------------------------------------------------------------------------------*)
</font><font color="#0000FF">PROCEDURE </font>ListarRegLigados<font color="#808080">(</font><font color="#0000FF">VAR </font>sArq1<font color="#808080">: </font>ChanId<font color="#808080">; </font>sreg1<font color="#808080">: </font>ctArqs<font color="#808080">; </font>nPosChave1<font color="#808080">,
</font>nTamChave1<font color="#808080">, </font>nPosChave2<font color="#808080">, </font>nTamChave2<font color="#808080">: </font><font color="#0000FF">CARDINAL</font><font color="#808080">; </font>sChave<font color="#808080">: </font>String<font color="#808080">;
</font><font color="#0000FF">VAR </font>sArq2<font color="#808080">: </font>ChanId<font color="#808080">; </font>sreg2<font color="#808080">: </font>ctArqs<font color="#808080">; </font>nPosChave3<font color="#808080">, </font>nQtdLinha<font color="#808080">: </font><font color="#0000FF">CARDINAL</font><font color="#808080">);
</font><font color="#0000FF">VAR </font>slinha1<font color="#808080">: </font>String<font color="#808080">;
    </font>bQuebra<font color="#808080">, </font>bRet<font color="#808080">: </font><font color="#0000FF">BOOLEAN</font><font color="#808080">;
    </font>nCont<font color="#808080">, </font>npos<font color="#808080">: </font><font color="#0000FF">CARDINAL</font><font color="#808080">;
    </font>sCodigo1<font color="#808080">, </font>sCodigo2<font color="#808080">, </font>slinha2<font color="#808080">: </font>String<font color="#808080">;
</font><font color="#0000FF">BEGIN
</font>bRet<font color="#808080">:=</font>FALSE<font color="#808080">;
</font>nCont<font color="#808080">:=</font><font color="#FF0000">0</font><font color="#808080">;
</font>bQuebra<font color="#808080">:=</font>FALSE<font color="#808080">;
</font>mostrarDados<font color="#808080">(</font>sreg2<font color="#808080">, </font><font color="#800000">''</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">);
</font>npos<font color="#808080">:=</font><font color="#FF0000">0</font><font color="#808080">;
</font>SetPos<font color="#808080">(</font>sArq1<font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">);
</font><font color="#0000FF">WHILE </font><font color="#808080">(</font><font color="#0000FF">NOT </font>fimArq<font color="#808080">(</font>sArq1<font color="#808080">)) </font><font color="#0000FF">AND </font><font color="#808080">(</font>bQuebra<font color="#808080">=</font>FALSE<font color="#808080">) </font><font color="#0000FF">DO 
  </font>slinha1<font color="#808080">:=</font>lerArq<font color="#808080">(</font>sArq1<font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg1<font color="#808080">), </font>TAM_CRLF<font color="#808080">, </font>npos<font color="#808080">);
  </font>sCodigo1<font color="#808080">:=</font>trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha1<font color="#808080">,</font>nPosChave1<font color="#808080">,</font>nTamChave1<font color="#808080">));
  </font><font color="#0000FF">IF </font>Compare<font color="#808080">(</font>sCodigo1<font color="#808080">,</font>sChave<font color="#808080">)=</font>equal <font color="#0000FF">THEN 
    </font>sCodigo2<font color="#808080">:=</font>trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha1<font color="#808080">,</font>nPosChave2<font color="#808080">,</font>nTamChave2<font color="#808080">));
    </font>slinha2<font color="#808080">:=</font>pesqArq<font color="#808080">(</font>sArq2<font color="#808080">, </font>sCodigo2<font color="#808080">, </font>nPosChave3<font color="#808080">, </font>nTamChave2<font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg2<font color="#808080">));
    </font>mostrarDados<font color="#808080">(</font>sreg2<font color="#808080">, </font>copy<font color="#808080">(</font>slinha2<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg2<font color="#808080">)), </font><font color="#FF0000">3</font><font color="#808080">);
    </font>bRet<font color="#808080">:=</font>TRUE<font color="#808080">;
    </font>nCont<font color="#808080">:=</font>nCont<font color="#808080">+</font><font color="#FF0000">1</font><font color="#808080">;
  </font><font color="#0000FF">END</font><font color="#808080">;
  </font>bQuebra<font color="#808080">:=</font>ContinuaSN<font color="#808080">(</font>nCont<font color="#808080">, </font>nQtdLinha<font color="#808080">);
</font><font color="#0000FF">END</font><font color="#808080">;
</font><font color="#0000FF">IF </font>bRet<font color="#808080">=</font>FALSE <font color="#0000FF">THEN
   </font>WriteLinha<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg2<font color="#808080">,</font><font color="#FF0000">0</font><font color="#808080">));
</font><font color="#0000FF">END</font><font color="#808080">;
</font><font color="#0000FF">END </font>ListarRegLigados<font color="#808080">;
(*------------------------------------------------------------------------------
</font>Valida a entrada de registros de acordo com a pesquisa feita.
sArq <font color="#808080">- </font>o arquivo
sreg <font color="#808080">- </font>o tipo de arquivo
nTexto <font color="#808080">- </font>o numero do r<font color="#808080">&oacute;</font>tulo da entrada
sEntrada <font color="#808080">- </font>a chave a ser pesquisada e validada
nTentativas <font color="#808080">- </font>o n<font color="#808080">&uacute;</font>mero m<font color="#808080">&aacute;</font>ximo de tentativas
bPesqRelativa <font color="#808080">- </font>indica se vai realizar uma pesquisa relativa
bTipoEntrada <font color="#808080">- </font>indica o tipo de entrada
retorna <font color="#808080">- </font>o registro pesquisado e validado
<font color="#808080">------------------------------------------------------------------------------*)
</font><font color="#0000FF">PROCEDURE </font>validaEntrada<font color="#808080">(</font><font color="#0000FF">VAR </font>sArq<font color="#808080">: </font>ChanId<font color="#808080">; </font>sreg<font color="#808080">: </font>ctArqs<font color="#808080">; </font>nTexto<font color="#808080">: </font><font color="#0000FF">CARDINAL</font><font color="#808080">;
        </font>sEntrada<font color="#808080">: </font>String<font color="#808080">; </font>nTentativas<font color="#808080">: </font><font color="#0000FF">CARDINAL</font><font color="#808080">;
        </font>bPesqRelativa<font color="#808080">: </font><font color="#0000FF">BOOLEAN</font><font color="#808080">; </font>bTipoEntrada<font color="#808080">: </font>ctTipo<font color="#808080">): </font>String<font color="#808080">;
</font><font color="#0000FF">VAR </font>bQuebra<font color="#808080">: </font><font color="#0000FF">BOOLEAN</font><font color="#808080">;
    </font>sres<font color="#808080">, </font>sTexto<font color="#808080">, </font>sMsgErro<font color="#808080">: </font>String<font color="#808080">;
    </font>ncont<font color="#808080">, </font>nPosChave<font color="#808080">, </font>nTamChave<font color="#808080">, </font>nTamLinha<font color="#808080">: </font><font color="#0000FF">CARDINAL</font><font color="#808080">;
</font><font color="#0000FF">BEGIN
</font>nTamLinha<font color="#808080">:=</font>tamReg<font color="#808080">(</font>sreg<font color="#808080">);
</font>sMsgErro<font color="#808080">:=</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">,</font><font color="#FF0000">0</font><font color="#808080">);
</font>sTexto<font color="#808080">:=</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">,</font>nTexto<font color="#808080">);
</font>nPosChave<font color="#808080">:=</font>g_nPosChave<font color="#808080">;
</font>nTamChave<font color="#808080">:=</font>g_nTamChave<font color="#808080">;

</font>ncont<font color="#808080">:=</font><font color="#FF0000">1</font><font color="#808080">;
</font>bQuebra<font color="#808080">:=</font>FALSE<font color="#808080">;
  </font><font color="#0000FF">WHILE </font><font color="#808080">(</font>bQuebra<font color="#808080">=</font>FALSE<font color="#808080">) </font><font color="#0000FF">AND </font><font color="#808080">(</font>ncont <font color="#808080">&lt;= </font>nTentativas <font color="#808080">) </font><font color="#0000FF">DO 
    IF </font>bTipoEntrada<font color="#808080">=</font>opTexto <font color="#0000FF">THEN 
      </font>WriteString<font color="#808080">(</font>sTexto<font color="#808080">);
      </font>ReadLinha<font color="#808080">(</font>sEntrada<font color="#808080">);
    </font><font color="#0000FF">ELSIF </font>bTipoEntrada<font color="#808080">=</font>opNumero <font color="#0000FF">THEN
       </font>sEntrada<font color="#808080">:=</font>validaNumero<font color="#808080">(</font>sTexto<font color="#808080">,</font>sEntrada<font color="#808080">);
    </font><font color="#0000FF">ELSIF </font>bTipoEntrada<font color="#808080">=</font>opData <font color="#0000FF">THEN
       </font>sEntrada<font color="#808080">:=</font>validaDataHora<font color="#808080">(</font>sTexto<font color="#808080">,</font>sEntrada<font color="#808080">,</font>TRUE<font color="#808080">);
    </font><font color="#0000FF">ELSIF </font>bTipoEntrada<font color="#808080">=</font>opDataHora <font color="#0000FF">THEN
       </font>sEntrada<font color="#808080">:=</font>validaDataHora<font color="#808080">(</font>sTexto<font color="#808080">,</font>sEntrada<font color="#808080">,</font>FALSE<font color="#808080">);
    </font><font color="#0000FF">ELSIF </font>bTipoEntrada<font color="#808080">=</font>opSenha <font color="#0000FF">THEN 
       </font>sEntrada<font color="#808080">:=</font>digitaSenha<font color="#808080">(</font>sTexto<font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">);
    </font><font color="#0000FF">END</font><font color="#808080">;

    </font><font color="#0000FF">IF </font>bPesqRelativa <font color="#0000FF">THEN 
       IF </font>ListarTodos<font color="#808080">(</font>sArq<font color="#808080">, </font>sreg<font color="#808080">, </font>sEntrada<font color="#808080">, </font>nPosChave<font color="#808080">, </font>nTamChave<font color="#808080">, </font>nTamLinha<font color="#808080">,
          </font>QTD_MAX_LINHA<font color="#808080">, </font>TRUE<font color="#808080">) </font><font color="#0000FF">THEN
          </font>sres<font color="#808080">:=</font><font color="#800000">' '</font><font color="#808080">; 
       </font><font color="#0000FF">END</font><font color="#808080">;
    </font><font color="#0000FF">ELSE
       </font>sres<font color="#808080">:=</font>pesqArq<font color="#808080">(</font>sArq<font color="#808080">, </font>sEntrada<font color="#808080">, </font>nPosChave<font color="#808080">, </font>nTamChave<font color="#808080">, </font>nTamLinha<font color="#808080">);
    </font><font color="#0000FF">END</font><font color="#808080">;  

    </font><font color="#0000FF">IF </font>Compare<font color="#808080">(</font>sres<font color="#808080">,</font><font color="#800000">''</font><font color="#808080">)=</font>equal <font color="#0000FF">THEN
       </font>WriteLinha<font color="#808080">(</font>sMsgErro<font color="#808080">);
    </font><font color="#0000FF">ELSE
       </font>bQuebra<font color="#808080">:=</font>TRUE<font color="#808080">;
    </font><font color="#0000FF">END</font><font color="#808080">;
    </font>ncont<font color="#808080">:=</font>ncont<font color="#808080">+</font><font color="#FF0000">1</font><font color="#808080">;
  </font><font color="#0000FF">END</font><font color="#808080">;
</font><font color="#0000FF">RETURN </font>sres<font color="#808080">;
</font><font color="#0000FF">END </font>validaEntrada<font color="#808080">;
(*------------------------------------------------------------------------------
</font>Mostra as entradas e as sa<font color="#808080">&iacute;</font>das do sistema.
sreg <font color="#808080">- </font>o tipo de arquivo
slinha <font color="#808080">- </font>o registro com os dados
nOpcao <font color="#808080">- </font>indica qual op<font color="#808080">&ccedil;&atilde;</font>o ser<font color="#808080">&aacute; </font>mostrada
<font color="#808080">------------------------------------------------------------------------------*)
</font><font color="#0000FF">PROCEDURE </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">: </font>ctArqs<font color="#808080">; </font>slinha<font color="#808080">: </font>String<font color="#808080">; </font>nOpcao<font color="#808080">: </font><font color="#0000FF">INTEGER</font><font color="#808080">);
</font><font color="#0000FF">BEGIN
IF </font>sreg<font color="#808080">=</font>opAssunto <font color="#0000FF">THEN 
   CASE </font>nOpcao <font color="#0000FF">OF
   </font><font color="#808080">| </font><font color="#FF0000">1</font><font color="#808080">: </font>WriteLinha<font color="#808080">(</font>Ss<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">), </font>tAssunto.codigo<font color="#808080">));
        </font>WriteString<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">));
        </font>ReadLinha<font color="#808080">(</font>tAssunto.assunto<font color="#808080">);
   | </font><font color="#FF0000">2</font><font color="#808080">: </font>WriteLinha<font color="#808080">(</font><font color="#800000">'C&oacute;digo     Assunto'</font><font color="#808080">);
        </font>WriteLinha<font color="#808080">(</font><font color="#800000">'------     -------'</font><font color="#808080">);
   | </font><font color="#FF0000">3</font><font color="#808080">: </font>tAssunto.codigo<font color="#808080">:=</font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">);
        </font>tAssunto.assunto<font color="#808080">:=</font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">11</font><font color="#808080">, </font><font color="#FF0000">30</font><font color="#808080">);        
        </font>WriteLinha<font color="#808080">(</font>Ss<font color="#808080">(</font>Ss<font color="#808080">(</font>tAssunto.codigo<font color="#808080">,</font><font color="#800000">' '</font><font color="#808080">),</font>tAssunto.assunto<font color="#808080">));
   </font><font color="#0000FF">END</font><font color="#808080">;
</font><font color="#0000FF">ELSIF </font>sreg<font color="#808080">=</font>opAutor <font color="#0000FF">THEN 
   CASE </font>nOpcao <font color="#0000FF">OF
   </font><font color="#808080">| </font><font color="#FF0000">1</font><font color="#808080">: </font>WriteLinha<font color="#808080">(</font>Ss<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">), </font>tAutor.codigo<font color="#808080">));
        </font>WriteString<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">));
        </font>ReadLinha<font color="#808080">(</font>tAutor.autor<font color="#808080">);
   | </font><font color="#FF0000">2</font><font color="#808080">: </font>WriteLinha<font color="#808080">(</font><font color="#800000">'C&oacute;digo     Autor'</font><font color="#808080">);
        </font>WriteLinha<font color="#808080">(</font><font color="#800000">'------     -----'</font><font color="#808080">);
   | </font><font color="#FF0000">3</font><font color="#808080">: </font>tAutor.codigo<font color="#808080">:=</font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">);
        </font>tAutor.autor<font color="#808080">:=</font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">11</font><font color="#808080">, </font><font color="#FF0000">30</font><font color="#808080">);
        </font>WriteLinha<font color="#808080">(</font>Ss<font color="#808080">(</font>Ss<font color="#808080">(</font>tAutor.codigo<font color="#808080">,</font><font color="#800000">' '</font><font color="#808080">),</font>tAutor.autor<font color="#808080">));
   </font><font color="#0000FF">END</font><font color="#808080">;
</font><font color="#0000FF">ELSIF </font>sreg<font color="#808080">=</font>opEditora <font color="#0000FF">THEN 
   CASE </font>nOpcao <font color="#0000FF">OF
   </font><font color="#808080">| </font><font color="#FF0000">1</font><font color="#808080">: </font>WriteLinha<font color="#808080">(</font>Ss<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">), </font>tEditora.codigo<font color="#808080">));
        </font>WriteString<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">));
        </font>ReadLinha<font color="#808080">(</font>tEditora.editora<font color="#808080">);
   | </font><font color="#FF0000">2</font><font color="#808080">: </font>WriteLinha<font color="#808080">(</font><font color="#800000">'C&oacute;digo     Editora'</font><font color="#808080">);
        </font>WriteLinha<font color="#808080">(</font><font color="#800000">'------     -------'</font><font color="#808080">);
   | </font><font color="#FF0000">3</font><font color="#808080">: </font>tEditora.codigo<font color="#808080">:=</font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">);
        </font>tEditora.editora<font color="#808080">:=</font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">11</font><font color="#808080">, </font><font color="#FF0000">50</font><font color="#808080">);
        </font>WriteLinha<font color="#808080">(</font>Ss<font color="#808080">(</font>Ss<font color="#808080">(</font>tEditora.codigo<font color="#808080">,</font><font color="#800000">' '</font><font color="#808080">),</font>tEditora.editora<font color="#808080">));
   </font><font color="#0000FF">END</font><font color="#808080">;
</font><font color="#0000FF">ELSIF </font>sreg<font color="#808080">=</font>opEndereco <font color="#0000FF">THEN 
   CASE </font>nOpcao <font color="#0000FF">OF
   </font><font color="#808080">| </font><font color="#FF0000">1</font><font color="#808080">: </font>WriteLinha<font color="#808080">(</font>Ss<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">), </font>tEndereco.codigo<font color="#808080">));
        </font>WriteString<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">));
        </font>ReadLinha<font color="#808080">(</font>tEndereco.logradouro<font color="#808080">);
        </font>WriteString<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">));
        </font>ReadLinha<font color="#808080">(</font>tEndereco.bairro<font color="#808080">);
        </font>WriteString<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">4</font><font color="#808080">));
        </font>ReadLinha<font color="#808080">(</font>tEndereco.cep<font color="#808080">);
        </font>WriteString<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">5</font><font color="#808080">));
        </font>ReadLinha<font color="#808080">(</font>tEndereco.cidade<font color="#808080">);
        </font>WriteString<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">6</font><font color="#808080">));
        </font>ReadLinha<font color="#808080">(</font>tEndereco.estado<font color="#808080">);
   | </font><font color="#FF0000">3</font><font color="#808080">: </font>tEndereco.codigo<font color="#808080">:=</font>trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">));
        </font>tEndereco.logradouro<font color="#808080">:=</font>trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">11</font><font color="#808080">, </font><font color="#FF0000">40</font><font color="#808080">));
        </font>tEndereco.bairro<font color="#808080">:=</font>trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">51</font><font color="#808080">, </font><font color="#FF0000">15</font><font color="#808080">));
        </font>tEndereco.cep<font color="#808080">:=</font>trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">66</font><font color="#808080">, </font><font color="#FF0000">8</font><font color="#808080">));
        </font>tEndereco.cidade<font color="#808080">:=</font>trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">74</font><font color="#808080">, </font><font color="#FF0000">30</font><font color="#808080">));
        </font>tEndereco.estado<font color="#808080">:=</font>trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">104</font><font color="#808080">, </font><font color="#FF0000">20</font><font color="#808080">));
        </font>WriteLinha<font color="#808080">(</font><font color="#800000">'--------------------'</font><font color="#808080">);
        </font>WriteLinha<font color="#808080">(</font>Ss<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">), </font>tEndereco.codigo<font color="#808080">));
        </font>WriteLinha<font color="#808080">(</font>Ss<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">), </font>tEndereco.logradouro<font color="#808080">));
        </font>WriteLinha<font color="#808080">(</font>Ss<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">), </font>tEndereco.bairro<font color="#808080">));
        </font>WriteLinha<font color="#808080">(</font>Ss<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">4</font><font color="#808080">), </font>tEndereco.cep<font color="#808080">));
        </font>WriteLinha<font color="#808080">(</font>Ss<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">5</font><font color="#808080">), </font>tEndereco.cidade<font color="#808080">));
        </font>WriteLinha<font color="#808080">(</font>Ss<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">6</font><font color="#808080">), </font>tEndereco.estado<font color="#808080">));
   </font><font color="#0000FF">END</font><font color="#808080">;
</font><font color="#0000FF">ELSIF </font>sreg<font color="#808080">=</font>opIdioma <font color="#0000FF">THEN 
   CASE </font>nOpcao <font color="#0000FF">OF
   </font><font color="#808080">| </font><font color="#FF0000">1</font><font color="#808080">: </font>WriteLinha<font color="#808080">(</font>Ss<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">), </font>tIdioma.codigo<font color="#808080">));
        </font>WriteString<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">));
        </font>ReadLinha<font color="#808080">(</font>tIdioma.idioma<font color="#808080">);
   | </font><font color="#FF0000">2</font><font color="#808080">: </font>WriteLinha<font color="#808080">(</font><font color="#800000">'C&oacute;digo     Idioma'</font><font color="#808080">);
        </font>WriteLinha<font color="#808080">(</font><font color="#800000">'------     ------'</font><font color="#808080">);
   | </font><font color="#FF0000">3</font><font color="#808080">: </font>tIdioma.codigo<font color="#808080">:=</font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">);
        </font>tIdioma.idioma<font color="#808080">:=</font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">11</font><font color="#808080">, </font><font color="#FF0000">20</font><font color="#808080">);
        </font>WriteLinha<font color="#808080">(</font>Ss<font color="#808080">(</font>Ss<font color="#808080">(</font>tIdioma.codigo<font color="#808080">,</font><font color="#800000">' '</font><font color="#808080">),</font>tIdioma.idioma<font color="#808080">));
   </font><font color="#0000FF">END</font><font color="#808080">;
</font><font color="#0000FF">ELSIF </font>sreg<font color="#808080">=</font>opPais <font color="#0000FF">THEN 
   CASE </font>nOpcao <font color="#0000FF">OF
   </font><font color="#808080">| </font><font color="#FF0000">1</font><font color="#808080">: </font>WriteString<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">));
        </font>ReadLinha<font color="#808080">(</font>tPais.pais<font color="#808080">);
   | </font><font color="#FF0000">2</font><font color="#808080">: </font>WriteLinha<font color="#808080">(</font><font color="#800000">'C&oacute;digo Pa&iacute;s'</font><font color="#808080">);
        </font>WriteLinha<font color="#808080">(</font><font color="#800000">'------ ----'</font><font color="#808080">);
   | </font><font color="#FF0000">3</font><font color="#808080">: </font>tPais.codigo<font color="#808080">:=</font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">);
        </font>tPais.pais<font color="#808080">:=</font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">4</font><font color="#808080">, </font><font color="#FF0000">50</font><font color="#808080">);
        </font>WriteLinha<font color="#808080">(</font>Ss<font color="#808080">(</font>Ss<font color="#808080">(</font>tPais.codigo<font color="#808080">,</font><font color="#800000">'    '</font><font color="#808080">),</font>tPais.pais<font color="#808080">));
   </font><font color="#0000FF">END</font><font color="#808080">;
</font><font color="#0000FF">ELSIF </font>sreg<font color="#808080">=</font>opProfissao <font color="#0000FF">THEN 
   CASE </font>nOpcao <font color="#0000FF">OF
   </font><font color="#808080">| </font><font color="#FF0000">1</font><font color="#808080">: </font>WriteLinha<font color="#808080">(</font>Ss<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">), </font>tProfissao.codigo<font color="#808080">));
        </font>WriteString<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">));
        </font>ReadLinha<font color="#808080">(</font>tProfissao.profissao<font color="#808080">);
   | </font><font color="#FF0000">2</font><font color="#808080">: </font>WriteLinha<font color="#808080">(</font><font color="#800000">'C&oacute;digo     Profiss&atilde;o'</font><font color="#808080">);
        </font>WriteLinha<font color="#808080">(</font><font color="#800000">'------     ---------'</font><font color="#808080">);
   | </font><font color="#FF0000">3</font><font color="#808080">: </font>tProfissao.codigo<font color="#808080">:=</font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">);
        </font>tProfissao.profissao<font color="#808080">:=</font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">11</font><font color="#808080">, </font><font color="#FF0000">50</font><font color="#808080">);
        </font>WriteLinha<font color="#808080">(</font>Ss<font color="#808080">(</font>Ss<font color="#808080">(</font>tProfissao.codigo<font color="#808080">,</font><font color="#800000">' '</font><font color="#808080">),</font>tProfissao.profissao<font color="#808080">));
   </font><font color="#0000FF">END</font><font color="#808080">;
</font><font color="#0000FF">ELSIF </font>sreg<font color="#808080">=</font>opLivro <font color="#0000FF">THEN 
   CASE </font>nOpcao <font color="#0000FF">OF
   </font><font color="#808080">| </font><font color="#FF0000">1</font><font color="#808080">: </font>WriteString<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">));
        </font>ReadLinha<font color="#808080">(</font>tLivro.titulo<font color="#808080">);
        </font>tLivro.edicao<font color="#808080">:=</font>validaNumero<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">), </font>tLivro.edicao<font color="#808080">);
        </font>tLivro.anopubli<font color="#808080">:=</font>validaNumero<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">4</font><font color="#808080">), </font>tLivro.anopubli<font color="#808080">);
        </font>mostrarSubDados<font color="#808080">(</font>opLivro<font color="#808080">, </font>opEditora<font color="#808080">, </font>FALSE<font color="#808080">);
        </font>tLivro.volume<font color="#808080">:=</font>validaNumero<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">6</font><font color="#808080">), </font>tLivro.volume<font color="#808080">);
        </font>mostrarSubDados<font color="#808080">(</font>opLivro<font color="#808080">, </font>opIdioma<font color="#808080">, </font>FALSE<font color="#808080">);
        </font>tLivro.npaginas<font color="#808080">:=</font>validaNumero<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">8</font><font color="#808080">), </font>tLivro.npaginas<font color="#808080">);
        </font>tLivro.preco<font color="#808080">:=</font>validaNumero<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">9</font><font color="#808080">), </font>tLivro.preco<font color="#808080">);
        </font>tLivro.qtdestoque<font color="#808080">:=</font>validaNumero<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">), </font>tLivro.qtdestoque<font color="#808080">);
   | </font><font color="#FF0000">3</font><font color="#808080">: </font>tLivro.isbn<font color="#808080">:=</font>trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">13</font><font color="#808080">));
        </font>tLivro.titulo<font color="#808080">:=</font>trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">14</font><font color="#808080">, </font><font color="#FF0000">50</font><font color="#808080">));
        </font>tLivro.edicao<font color="#808080">:=</font>trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">64</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">));
        </font>tLivro.anopubli<font color="#808080">:=</font>trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">74</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">));
        </font>tLivro.codeditora<font color="#808080">:=</font>trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">84</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">));
        </font>tLivro.volume<font color="#808080">:=</font>trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">94</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">));
        </font>tLivro.codidioma<font color="#808080">:=</font>trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">104</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">));
        </font>tLivro.npaginas<font color="#808080">:=</font>trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">114</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">));
        </font>tLivro.preco<font color="#808080">:=</font>trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">124</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">));
        </font>tLivro.qtdestoque<font color="#808080">:=</font>trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">134</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">));
        </font>WriteLinha<font color="#808080">(</font><font color="#800000">'--------------------'</font><font color="#808080">);
        </font>WriteLinha<font color="#808080">(</font>Ss<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">), </font>tLivro.isbn<font color="#808080">));
        </font>WriteLinha<font color="#808080">(</font>Ss<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">), </font>tLivro.titulo<font color="#808080">));
        </font>WriteLinha<font color="#808080">(</font>Ss<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">), </font>tLivro.edicao<font color="#808080">));
        </font>WriteLinha<font color="#808080">(</font>Ss<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">4</font><font color="#808080">), </font>tLivro.anopubli<font color="#808080">));
        </font>WriteLinha<font color="#808080">(</font>Ss<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">5</font><font color="#808080">), </font>tLivro.codeditora<font color="#808080">));
        </font>mostrarSubDados<font color="#808080">(</font>opLivro<font color="#808080">, </font>opEditora<font color="#808080">, </font>TRUE<font color="#808080">);
        </font>WriteLinha<font color="#808080">(</font>Ss<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">6</font><font color="#808080">), </font>tLivro.volume<font color="#808080">));
        </font>WriteLinha<font color="#808080">(</font>Ss<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">7</font><font color="#808080">), </font>tLivro.codidioma<font color="#808080">));
        </font>mostrarSubDados<font color="#808080">(</font>opLivro<font color="#808080">, </font>opIdioma<font color="#808080">, </font>TRUE<font color="#808080">);
        </font>WriteLinha<font color="#808080">(</font>Ss<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">8</font><font color="#808080">), </font>tLivro.npaginas<font color="#808080">));
        </font>WriteLinha<font color="#808080">(</font>Ss<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">9</font><font color="#808080">), </font>tLivro.preco<font color="#808080">));
        </font>WriteLinha<font color="#808080">(</font>Ss<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">), </font>tLivro.qtdestoque<font color="#808080">));
        </font>ListarRegLigados<font color="#808080">(</font>tfLivroAss<font color="#808080">, </font>opLivroAss<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">13</font><font color="#808080">, </font><font color="#FF0000">14</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">, </font>tLivro.isbn<font color="#808080">,
                         </font>tfAssunto<font color="#808080">, </font>opAssunto<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">4</font><font color="#808080">);
        </font>ListarRegLigados<font color="#808080">(</font>tfLivroAut<font color="#808080">, </font>opLivroAut<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">13</font><font color="#808080">, </font><font color="#FF0000">14</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">, </font>tLivro.isbn<font color="#808080">,
                         </font>tfAutor<font color="#808080">, </font>opAutor<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">4</font><font color="#808080">);
   </font><font color="#0000FF">END</font><font color="#808080">;
</font><font color="#0000FF">ELSIF </font>sreg<font color="#808080">=</font>opCliente <font color="#0000FF">THEN 
   CASE </font>nOpcao <font color="#0000FF">OF
   </font><font color="#808080">| </font><font color="#FF0000">1</font><font color="#808080">: </font>WriteString<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">));
        </font>ReadLinha<font color="#808080">(</font>tCliente.nome<font color="#808080">);
        </font>WriteString<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">));
        </font>ReadLinha<font color="#808080">(</font>tCliente.email<font color="#808080">);
        </font>WriteString<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">4</font><font color="#808080">));
        </font>ReadLinha<font color="#808080">(</font>tCliente.identidade<font color="#808080">);
        </font>WriteString<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">5</font><font color="#808080">));
        </font>ReadLinha<font color="#808080">(</font>tCliente.sexo<font color="#808080">);
        </font>WriteString<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">6</font><font color="#808080">));
        </font>ReadLinha<font color="#808080">(</font>tCliente.telefone<font color="#808080">);
        </font>tCliente.dtnascimento<font color="#808080">:=
                </font>validaDataHora<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">7</font><font color="#808080">), </font>tCliente.dtnascimento<font color="#808080">, </font>TRUE<font color="#808080">);
        </font>mostrarSubDados<font color="#808080">(</font>opCliente<font color="#808080">, </font>opEndereco<font color="#808080">, </font>FALSE<font color="#808080">);
        </font>mostrarSubDados<font color="#808080">(</font>opCliente<font color="#808080">, </font>opPais<font color="#808080">, </font>FALSE<font color="#808080">);
        </font>mostrarSubDados<font color="#808080">(</font>opCliente<font color="#808080">, </font>opProfissao<font color="#808080">, </font>FALSE<font color="#808080">);
   | </font><font color="#FF0000">3</font><font color="#808080">: </font>tCliente.cpf<font color="#808080">:=</font>trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">14</font><font color="#808080">));
        </font>tCliente.nome<font color="#808080">:=</font>trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">15</font><font color="#808080">, </font><font color="#FF0000">30</font><font color="#808080">));
        </font>tCliente.email<font color="#808080">:=</font>trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">45</font><font color="#808080">, </font><font color="#FF0000">30</font><font color="#808080">));
        </font>tCliente.identidade<font color="#808080">:=</font>trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">75</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">));
        </font>tCliente.sexo<font color="#808080">:=</font>trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">85</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">));
        </font>tCliente.telefone<font color="#808080">:=</font>trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">86</font><font color="#808080">, </font><font color="#FF0000">17</font><font color="#808080">));
        </font>tCliente.dtnascimento<font color="#808080">:=</font>trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">103</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">));
        </font>tCliente.codendereco<font color="#808080">:=</font>trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">113</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">));
        </font>tCliente.codpais<font color="#808080">:=</font>trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">123</font><font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">));
        </font>tCliente.codprofissao<font color="#808080">:=</font>trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">126</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">));
        </font>WriteLinha<font color="#808080">(</font><font color="#800000">'--------------------'</font><font color="#808080">);
        </font>WriteLinha<font color="#808080">(</font>Ss<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">), </font>tCliente.cpf<font color="#808080">));
        </font>WriteLinha<font color="#808080">(</font>Ss<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">), </font>tCliente.nome<font color="#808080">));
        </font>WriteLinha<font color="#808080">(</font>Ss<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">), </font>tCliente.email<font color="#808080">));
        </font>WriteLinha<font color="#808080">(</font>Ss<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">4</font><font color="#808080">), </font>tCliente.identidade<font color="#808080">));
        </font>WriteLinha<font color="#808080">(</font>Ss<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">5</font><font color="#808080">), </font>tCliente.sexo<font color="#808080">));
        </font>WriteLinha<font color="#808080">(</font>Ss<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">6</font><font color="#808080">), </font>tCliente.telefone<font color="#808080">));
        </font>WriteLinha<font color="#808080">(</font>Ss<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">7</font><font color="#808080">), </font>tCliente.dtnascimento<font color="#808080">));
        </font>WriteLinha<font color="#808080">(</font>Ss<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">8</font><font color="#808080">), </font>tCliente.codendereco<font color="#808080">));
        </font>mostrarSubDados<font color="#808080">(</font>opCliente<font color="#808080">, </font>opEndereco<font color="#808080">, </font>TRUE<font color="#808080">);
        </font>WriteLinha<font color="#808080">(</font>Ss<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">9</font><font color="#808080">), </font>tCliente.codpais<font color="#808080">));
        </font>mostrarSubDados<font color="#808080">(</font>opCliente<font color="#808080">, </font>opPais<font color="#808080">, </font>TRUE<font color="#808080">);
        </font>WriteLinha<font color="#808080">(</font>Ss<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">), </font>tCliente.codprofissao<font color="#808080">));
        </font>mostrarSubDados<font color="#808080">(</font>opCliente<font color="#808080">, </font>opProfissao<font color="#808080">, </font>TRUE<font color="#808080">);
   </font><font color="#0000FF">END</font><font color="#808080">;
</font><font color="#0000FF">ELSIF </font>sreg<font color="#808080">=</font>opVenda <font color="#0000FF">THEN 
   CASE </font>nOpcao <font color="#0000FF">OF
   </font><font color="#808080">| </font><font color="#FF0000">1</font><font color="#808080">: </font>mostrarSubDados<font color="#808080">(</font>opVenda<font color="#808080">,</font>opVenda<font color="#808080">, </font>FALSE<font color="#808080">);
   | </font><font color="#FF0000">2</font><font color="#808080">: </font>WriteLinha<font color="#808080">(</font><font color="#800000">'DataHoraVenda       CPF            ISBN          '</font><font color="#808080">+
        </font><font color="#800000">'Pre&ccedil;oVenda'</font><font color="#808080">);
        </font>WriteLinha<font color="#808080">(</font><font color="#800000">'-------------       ---            ----          '</font><font color="#808080">+
        </font><font color="#800000">'----------'</font><font color="#808080">);
   | </font><font color="#FF0000">3</font><font color="#808080">: </font>tVenda.dthrvenda<font color="#808080">:=</font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">19</font><font color="#808080">);
        </font>tVenda.cpf<font color="#808080">:=</font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">20</font><font color="#808080">, </font><font color="#FF0000">14</font><font color="#808080">);
        </font>tVenda.isbn<font color="#808080">:=</font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">34</font><font color="#808080">, </font><font color="#FF0000">13</font><font color="#808080">);
        </font>tVenda.precovenda<font color="#808080">:=</font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">47</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">);
        </font>stemp<font color="#808080">[</font><font color="#FF0000">0</font><font color="#808080">]:=</font>tVenda.dthrvenda<font color="#808080">;
        </font>stemp<font color="#808080">[</font><font color="#FF0000">1</font><font color="#808080">]:=</font><font color="#800000">' '</font><font color="#808080">;
        </font>stemp<font color="#808080">[</font><font color="#FF0000">2</font><font color="#808080">]:=</font>tVenda.cpf<font color="#808080">;
        </font>stemp<font color="#808080">[</font><font color="#FF0000">3</font><font color="#808080">]:=</font><font color="#800000">' '</font><font color="#808080">;
        </font>stemp<font color="#808080">[</font><font color="#FF0000">4</font><font color="#808080">]:=</font>tVenda.isbn<font color="#808080">;
        </font>stemp<font color="#808080">[</font><font color="#FF0000">5</font><font color="#808080">]:=</font><font color="#800000">' '</font><font color="#808080">;
        </font>stemp<font color="#808080">[</font><font color="#FF0000">6</font><font color="#808080">]:=</font>tVenda.precovenda<font color="#808080">;
        </font>WriteLinha<font color="#808080">(</font>SomaStr<font color="#808080">(</font><font color="#FF0000">7</font><font color="#808080">,</font>stemp<font color="#808080">));
   </font><font color="#0000FF">END</font><font color="#808080">;
</font><font color="#0000FF">END</font><font color="#808080">;

</font><font color="#0000FF">END </font>mostrarDados<font color="#808080">;
(*------------------------------------------------------------------------------
</font>Mostra as sub inform<font color="#808080">&ccedil;&otilde;</font>es de entrada e de sa<font color="#808080">&iacute;</font>da.
sreg <font color="#808080">- </font>o tipo de arquivo
ssubreg <font color="#808080">- </font>o subtipo de arquivo
bSoMostrar <font color="#808080">- </font>se vai s<font color="#808080">&oacute; </font>mostrar na sa<font color="#808080">&iacute;</font>da 
<font color="#808080">------------------------------------------------------------------------------*)
</font><font color="#0000FF">PROCEDURE </font>mostrarSubDados<font color="#808080">(</font>sreg<font color="#808080">, </font>ssubreg<font color="#808080">: </font>ctArqs<font color="#808080">; </font>bSoMostrar<font color="#808080">: </font><font color="#0000FF">BOOLEAN</font><font color="#808080">);
</font><font color="#0000FF">VAR </font>sRegistro<font color="#808080">, </font>sPreco<font color="#808080">: </font>String<font color="#808080">;
    </font>nStatus<font color="#808080">, </font>nMaxTentativas<font color="#808080">: </font><font color="#0000FF">INTEGER</font><font color="#808080">;
</font><font color="#0000FF">BEGIN
</font>nMaxTentativas<font color="#808080">:=</font><font color="#FF0000">3</font><font color="#808080">;
</font><font color="#0000FF">IF </font>sreg<font color="#808080">=</font>opLivro <font color="#0000FF">THEN 
  IF </font>ssubreg<font color="#808080">=</font>opEditora <font color="#0000FF">THEN 
    IF </font>bSoMostrar <font color="#0000FF">THEN
       </font>sRegistro<font color="#808080">:=</font>pesqArq<font color="#808080">(</font>tfEditora<font color="#808080">,</font>tLivro.codeditora<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">,</font>tamReg<font color="#808080">(</font>opEditora<font color="#808080">));
    </font><font color="#0000FF">ELSE
       </font>sRegistro<font color="#808080">:=</font>validaEntrada<font color="#808080">(</font>tfEditora<font color="#808080">,</font>ssubreg<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font>tLivro.codeditora<font color="#808080">,
                  </font>nMaxTentativas<font color="#808080">,</font>FALSE<font color="#808080">,</font>opNumero<font color="#808080">);
    </font><font color="#0000FF">END</font><font color="#808080">;
    </font><font color="#0000FF">IF </font>Compare<font color="#808080">(</font>sRegistro<font color="#808080">,</font><font color="#800000">''</font><font color="#808080">)&lt;&gt;</font>equal <font color="#0000FF">THEN 
      </font>tLivro.codeditora<font color="#808080">:=</font>trim<font color="#808080">(</font>copy<font color="#808080">(</font>sRegistro<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">));
      </font>WriteString<font color="#808080">(</font>Ss<font color="#808080">(</font><font color="#800000">' '</font><font color="#808080">,</font>rotulo<font color="#808080">(</font>opEditora<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">)));
      </font>WriteLinha<font color="#808080">(</font>copy<font color="#808080">(</font>sRegistro<font color="#808080">, </font>g_nPosChave<font color="#808080">, </font>g_nTamChave<font color="#808080">));
    </font><font color="#0000FF">END</font><font color="#808080">;
  </font><font color="#0000FF">ELSIF </font>ssubreg<font color="#808080">=</font>opIdioma <font color="#0000FF">THEN
    IF </font>bSoMostrar <font color="#0000FF">THEN
       </font>sRegistro<font color="#808080">:=</font>pesqArq<font color="#808080">(</font>tfIdioma<font color="#808080">, </font>tLivro.codidioma<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">,</font>tamReg<font color="#808080">(</font>opIdioma<font color="#808080">));
    </font><font color="#0000FF">ELSE
       </font>sRegistro<font color="#808080">:=</font>validaEntrada<font color="#808080">(</font>tfIdioma<font color="#808080">,</font>ssubreg<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font>tLivro.codidioma<font color="#808080">,
                  </font>nMaxTentativas<font color="#808080">,</font>FALSE<font color="#808080">,</font>opNumero<font color="#808080">);
    </font><font color="#0000FF">END</font><font color="#808080">;
    </font><font color="#0000FF">IF </font>Compare<font color="#808080">(</font>sRegistro<font color="#808080">,</font><font color="#800000">''</font><font color="#808080">)&lt;&gt;</font>equal <font color="#0000FF">THEN 
      </font>tLivro.codidioma<font color="#808080">:=</font>trim<font color="#808080">(</font>copy<font color="#808080">(</font>sRegistro<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">));
      </font>WriteString<font color="#808080">(</font>Ss<font color="#808080">(</font><font color="#800000">' '</font><font color="#808080">,</font>rotulo<font color="#808080">(</font>opIdioma<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">)));
      </font>WriteLinha<font color="#808080">(</font>copy<font color="#808080">(</font>sRegistro<font color="#808080">, </font>g_nPosChave<font color="#808080">, </font>g_nTamChave<font color="#808080">));
    </font><font color="#0000FF">END</font><font color="#808080">;
  </font><font color="#0000FF">END</font><font color="#808080">;
</font><font color="#0000FF">ELSIF </font>sreg<font color="#808080">=</font>opCliente <font color="#0000FF">THEN 
  IF </font>ssubreg<font color="#808080">=</font>opEndereco <font color="#0000FF">THEN 
    IF </font>bSoMostrar <font color="#0000FF">THEN
       </font>sRegistro<font color="#808080">:=</font>pesqArq<font color="#808080">(</font>tfEndereco<font color="#808080">, </font>tCliente.codendereco<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">,
                  </font>tamReg<font color="#808080">(</font>opEndereco<font color="#808080">));
    </font><font color="#0000FF">ELSE
       </font>sRegistro<font color="#808080">:=</font>validaEntrada<font color="#808080">(</font>tfEndereco<font color="#808080">,</font>ssubreg<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font>tCliente.codendereco<font color="#808080">,
                  </font>nMaxTentativas<font color="#808080">,</font>FALSE<font color="#808080">,</font>opNumero<font color="#808080">);
    </font><font color="#0000FF">END</font><font color="#808080">;
    </font><font color="#0000FF">IF </font>Compare<font color="#808080">(</font>sRegistro<font color="#808080">,</font><font color="#800000">''</font><font color="#808080">)&lt;&gt;</font>equal <font color="#0000FF">THEN 
      </font>tCliente.codendereco<font color="#808080">:=</font>trim<font color="#808080">(</font>copy<font color="#808080">(</font>sRegistro<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">));
      </font>WriteString<font color="#808080">(</font>Ss<font color="#808080">(</font><font color="#800000">' '</font><font color="#808080">,</font>rotulo<font color="#808080">(</font>opEndereco<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">)));
      </font>WriteLinha<font color="#808080">(</font>copy<font color="#808080">(</font>sRegistro<font color="#808080">, </font>g_nPosChave<font color="#808080">, </font>g_nTamChave<font color="#808080">));
      </font>WriteString<font color="#808080">(</font>Ss<font color="#808080">(</font><font color="#800000">' '</font><font color="#808080">,</font>rotulo<font color="#808080">(</font>opEndereco<font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">)));
      </font>WriteLinha<font color="#808080">(</font>copy<font color="#808080">(</font>sRegistro<font color="#808080">, </font>g_nPosChave<font color="#808080">, </font>g_nTamChave<font color="#808080">));
      </font>WriteString<font color="#808080">(</font>Ss<font color="#808080">(</font><font color="#800000">' '</font><font color="#808080">,</font>rotulo<font color="#808080">(</font>opEndereco<font color="#808080">, </font><font color="#FF0000">4</font><font color="#808080">)));
      </font>WriteLinha<font color="#808080">(</font>copy<font color="#808080">(</font>sRegistro<font color="#808080">, </font>g_nPosChave<font color="#808080">, </font>g_nTamChave<font color="#808080">));
      </font>WriteString<font color="#808080">(</font>Ss<font color="#808080">(</font><font color="#800000">' '</font><font color="#808080">,</font>rotulo<font color="#808080">(</font>opEndereco<font color="#808080">, </font><font color="#FF0000">5</font><font color="#808080">)));
      </font>WriteLinha<font color="#808080">(</font>copy<font color="#808080">(</font>sRegistro<font color="#808080">, </font>g_nPosChave<font color="#808080">, </font>g_nTamChave<font color="#808080">));
      </font>WriteString<font color="#808080">(</font>Ss<font color="#808080">(</font><font color="#800000">' '</font><font color="#808080">,</font>rotulo<font color="#808080">(</font>opEndereco<font color="#808080">, </font><font color="#FF0000">6</font><font color="#808080">)));
      </font>WriteLinha<font color="#808080">(</font>copy<font color="#808080">(</font>sRegistro<font color="#808080">, </font>g_nPosChave<font color="#808080">, </font>g_nTamChave<font color="#808080">));
    </font><font color="#0000FF">END</font><font color="#808080">;
  </font><font color="#0000FF">ELSIF </font>ssubreg<font color="#808080">=</font>opPais <font color="#0000FF">THEN 
    IF </font>bSoMostrar <font color="#0000FF">THEN
       </font>sRegistro<font color="#808080">:=</font>pesqArq<font color="#808080">(</font>tfPais<font color="#808080">, </font>tCliente.codpais<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">, </font>tamReg<font color="#808080">(</font>opPais<font color="#808080">));
    </font><font color="#0000FF">ELSE
       </font>sRegistro<font color="#808080">:=</font>validaEntrada<font color="#808080">(</font>tfPais<font color="#808080">,</font>ssubreg<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font>tCliente.codpais<font color="#808080">,
                  </font>nMaxTentativas<font color="#808080">,</font>FALSE<font color="#808080">,</font>opTexto<font color="#808080">);
    </font><font color="#0000FF">END</font><font color="#808080">;
    </font><font color="#0000FF">IF </font>Compare<font color="#808080">(</font>sRegistro<font color="#808080">,</font><font color="#800000">''</font><font color="#808080">)&lt;&gt;</font>equal <font color="#0000FF">THEN 
      </font>tCliente.codpais<font color="#808080">:=</font>trim<font color="#808080">(</font>copy<font color="#808080">(</font>sRegistro<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#FF0000">3</font><font color="#808080">));
      </font>WriteString<font color="#808080">(</font>Ss<font color="#808080">(</font><font color="#800000">' '</font><font color="#808080">,</font>rotulo<font color="#808080">(</font>opPais<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">)));
      </font>WriteLinha<font color="#808080">(</font>copy<font color="#808080">(</font>sRegistro<font color="#808080">, </font>g_nPosChave<font color="#808080">, </font>g_nTamChave<font color="#808080">));
    </font><font color="#0000FF">END</font><font color="#808080">;
  </font><font color="#0000FF">ELSIF </font>ssubreg<font color="#808080">=</font>opProfissao <font color="#0000FF">THEN 
    IF </font>bSoMostrar <font color="#0000FF">THEN
       </font>sRegistro<font color="#808080">:=</font>pesqArq<font color="#808080">(</font>tfProfissao<font color="#808080">, </font>tCliente.codprofissao<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">,
                  </font>tamReg<font color="#808080">(</font>opProfissao<font color="#808080">));
    </font><font color="#0000FF">ELSE
       </font>sRegistro<font color="#808080">:=</font>validaEntrada<font color="#808080">(</font>tfProfissao<font color="#808080">,</font>ssubreg<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font>tCliente.codprofissao<font color="#808080">,
                  </font>nMaxTentativas<font color="#808080">,</font>FALSE<font color="#808080">,</font>opNumero<font color="#808080">);
    </font><font color="#0000FF">END</font><font color="#808080">;
    </font><font color="#0000FF">IF </font>Compare<font color="#808080">(</font>sRegistro<font color="#808080">,</font><font color="#800000">''</font><font color="#808080">)&lt;&gt;</font>equal <font color="#0000FF">THEN 
      </font>tCliente.codprofissao<font color="#808080">:=</font>trim<font color="#808080">(</font>copy<font color="#808080">(</font>sRegistro<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">));
      </font>WriteString<font color="#808080">(</font>Ss<font color="#808080">(</font><font color="#800000">' '</font><font color="#808080">,</font>rotulo<font color="#808080">(</font>opProfissao<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">)));
      </font>WriteLinha<font color="#808080">(</font>copy<font color="#808080">(</font>sRegistro<font color="#808080">, </font>g_nPosChave<font color="#808080">, </font>g_nTamChave<font color="#808080">));
    </font><font color="#0000FF">END</font><font color="#808080">;
  </font><font color="#0000FF">END</font><font color="#808080">;
</font><font color="#0000FF">ELSIF </font>sreg<font color="#808080">=</font>opVenda <font color="#0000FF">THEN 
  </font>sRegistro<font color="#808080">:=</font>pesqArq<font color="#808080">(</font>tfLivro<font color="#808080">, </font>tVenda.isbn<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">13</font><font color="#808080">, </font>tamReg<font color="#808080">(</font>opLivro<font color="#808080">));
  </font><font color="#0000FF">IF </font>Compare<font color="#808080">(</font>sRegistro<font color="#808080">,</font><font color="#800000">''</font><font color="#808080">)&lt;&gt;</font>equal <font color="#0000FF">THEN 
    </font>WriteString<font color="#808080">(</font>Ss<font color="#808080">(</font><font color="#800000">' '</font><font color="#808080">,</font>rotulo<font color="#808080">(</font>opLivro<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">))); (* Titulo *)
    </font>WriteLinha<font color="#808080">(</font>copy<font color="#808080">(</font>sRegistro<font color="#808080">, </font>g_nPosChave<font color="#808080">, </font>g_nTamChave<font color="#808080">));
    </font>WriteString<font color="#808080">(</font>Ss<font color="#808080">(</font><font color="#800000">' '</font><font color="#808080">,</font>rotulo<font color="#808080">(</font>opLivro<font color="#808080">, </font><font color="#FF0000">9</font><font color="#808080">))); (* Preco *)
    </font>sPreco<font color="#808080">:=</font>copy<font color="#808080">(</font>sRegistro<font color="#808080">, </font>g_nPosChave<font color="#808080">, </font>g_nTamChave<font color="#808080">);
    </font>RealToStr<font color="#808080">(</font>g_nPreco<font color="#808080">, </font>sPreco<font color="#808080">);
    </font>WriteLinha<font color="#808080">(</font>sPreco<font color="#808080">);
  </font><font color="#0000FF">END</font><font color="#808080">;
</font><font color="#0000FF">END</font><font color="#808080">;
</font><font color="#0000FF">END </font>mostrarSubDados<font color="#808080">;

(*------------------------------------------------------------------------------
</font>Executa uma a<font color="#808080">&ccedil;&atilde;</font>o de grava<font color="#808080">&ccedil;&atilde;</font>o de acordo com o tipo de arquivo.
sreg <font color="#808080">- </font>o tipo de arquivo
sacao <font color="#808080">- </font>a a<font color="#808080">&ccedil;&atilde;</font>o a ser realizada
<font color="#808080">------------------------------------------------------------------------------*)
</font><font color="#0000FF">PROCEDURE </font>btnAcao<font color="#808080">(</font>sreg<font color="#808080">: </font>ctArqs<font color="#808080">; </font>sacao<font color="#808080">: </font>ctAcao<font color="#808080">);
</font><font color="#0000FF">BEGIN
IF </font>sreg<font color="#808080">=</font>opAssunto <font color="#0000FF">THEN 
   IF </font>sacao<font color="#808080">=</font>opSalvarInclusao <font color="#0000FF">THEN
      </font>escreveArq<font color="#808080">(</font>tfAssunto<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGINC<font color="#808080">, </font>MSG_REGNINC<font color="#808080">);
   </font><font color="#0000FF">ELSIF </font>sacao<font color="#808080">=</font>opSalvarAlteracao <font color="#0000FF">THEN
      </font>escreveArq<font color="#808080">(</font>tfAssunto<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGALT<font color="#808080">, </font>MSG_REGNALT<font color="#808080">);
   </font><font color="#0000FF">ELSIF </font>sacao<font color="#808080">=</font>opConfirmaExclusao <font color="#0000FF">THEN
      </font>escreveArq<font color="#808080">(</font>tfAssunto<font color="#808080">, </font>repete<font color="#808080">(</font><font color="#800000">'*'</font><font color="#808080">,</font>tamReg<font color="#808080">(</font>sreg<font color="#808080">)), </font>MSG_REGEXC<font color="#808080">, </font>MSG_REGNEXC<font color="#808080">);
   </font><font color="#0000FF">END</font><font color="#808080">;
</font><font color="#0000FF">ELSIF </font>sreg<font color="#808080">=</font>opAutor <font color="#0000FF">THEN 
   IF </font>sacao<font color="#808080">=</font>opSalvarInclusao <font color="#0000FF">THEN
      </font>escreveArq<font color="#808080">(</font>tfAutor<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGINC<font color="#808080">, </font>MSG_REGNINC<font color="#808080">);
   </font><font color="#0000FF">ELSIF </font>sacao<font color="#808080">=</font>opSalvarAlteracao <font color="#0000FF">THEN
      </font>escreveArq<font color="#808080">(</font>tfAutor<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGALT<font color="#808080">, </font>MSG_REGNALT<font color="#808080">);
   </font><font color="#0000FF">ELSIF </font>sacao<font color="#808080">=</font>opConfirmaExclusao <font color="#0000FF">THEN
      </font>escreveArq<font color="#808080">(</font>tfAutor<font color="#808080">, </font>repete<font color="#808080">(</font><font color="#800000">'*'</font><font color="#808080">,</font>tamReg<font color="#808080">(</font>sreg<font color="#808080">)), </font>MSG_REGEXC<font color="#808080">, </font>MSG_REGNEXC<font color="#808080">);
   </font><font color="#0000FF">END</font><font color="#808080">;
</font><font color="#0000FF">ELSIF </font>sreg<font color="#808080">=</font>opEditora <font color="#0000FF">THEN 
   IF </font>sacao<font color="#808080">=</font>opSalvarInclusao <font color="#0000FF">THEN
      </font>escreveArq<font color="#808080">(</font>tfEditora<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGINC<font color="#808080">, </font>MSG_REGNINC<font color="#808080">);
   </font><font color="#0000FF">ELSIF </font>sacao<font color="#808080">=</font>opSalvarAlteracao <font color="#0000FF">THEN
      </font>escreveArq<font color="#808080">(</font>tfEditora<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGALT<font color="#808080">, </font>MSG_REGNALT<font color="#808080">);
   </font><font color="#0000FF">ELSIF </font>sacao<font color="#808080">=</font>opConfirmaExclusao <font color="#0000FF">THEN
      </font>escreveArq<font color="#808080">(</font>tfEditora<font color="#808080">, </font>repete<font color="#808080">(</font><font color="#800000">'*'</font><font color="#808080">,</font>tamReg<font color="#808080">(</font>sreg<font color="#808080">)), </font>MSG_REGEXC<font color="#808080">, </font>MSG_REGNEXC<font color="#808080">);
   </font><font color="#0000FF">END</font><font color="#808080">;
</font><font color="#0000FF">ELSIF </font>sreg<font color="#808080">=</font>opEndereco <font color="#0000FF">THEN 
   IF </font>sacao<font color="#808080">=</font>opSalvarInclusao <font color="#0000FF">THEN
      </font>escreveArq<font color="#808080">(</font>tfEndereco<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGINC<font color="#808080">, </font>MSG_REGNINC<font color="#808080">);
   </font><font color="#0000FF">ELSIF </font>sacao<font color="#808080">=</font>opSalvarAlteracao <font color="#0000FF">THEN
      </font>escreveArq<font color="#808080">(</font>tfEndereco<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGALT<font color="#808080">, </font>MSG_REGNALT<font color="#808080">);
   </font><font color="#0000FF">ELSIF </font>sacao<font color="#808080">=</font>opConfirmaExclusao <font color="#0000FF">THEN
      </font>escreveArq<font color="#808080">(</font>tfEndereco<font color="#808080">, </font>repete<font color="#808080">(</font><font color="#800000">'*'</font><font color="#808080">,</font>tamReg<font color="#808080">(</font>sreg<font color="#808080">)), </font>MSG_REGEXC<font color="#808080">, </font>MSG_REGNEXC<font color="#808080">);
   </font><font color="#0000FF">END</font><font color="#808080">;
</font><font color="#0000FF">ELSIF </font>sreg<font color="#808080">=</font>opIdioma <font color="#0000FF">THEN 
   IF </font>sacao<font color="#808080">=</font>opSalvarInclusao <font color="#0000FF">THEN
      </font>escreveArq<font color="#808080">(</font>tfIdioma<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGINC<font color="#808080">, </font>MSG_REGNINC<font color="#808080">);
   </font><font color="#0000FF">ELSIF </font>sacao<font color="#808080">=</font>opSalvarAlteracao <font color="#0000FF">THEN
      </font>escreveArq<font color="#808080">(</font>tfIdioma<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGALT<font color="#808080">, </font>MSG_REGNALT<font color="#808080">);
   </font><font color="#0000FF">ELSIF </font>sacao<font color="#808080">=</font>opConfirmaExclusao <font color="#0000FF">THEN
      </font>escreveArq<font color="#808080">(</font>tfIdioma<font color="#808080">, </font>repete<font color="#808080">(</font><font color="#800000">'*'</font><font color="#808080">,</font>tamReg<font color="#808080">(</font>sreg<font color="#808080">)), </font>MSG_REGEXC<font color="#808080">, </font>MSG_REGNEXC<font color="#808080">);
   </font><font color="#0000FF">END</font><font color="#808080">;
</font><font color="#0000FF">ELSIF </font>sreg<font color="#808080">=</font>opPais <font color="#0000FF">THEN 
   IF </font>sacao<font color="#808080">=</font>opSalvarInclusao <font color="#0000FF">THEN
      </font>escreveArq<font color="#808080">(</font>tfPais<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGINC<font color="#808080">, </font>MSG_REGNINC<font color="#808080">);
   </font><font color="#0000FF">ELSIF </font>sacao<font color="#808080">=</font>opSalvarAlteracao <font color="#0000FF">THEN
      </font>escreveArq<font color="#808080">(</font>tfPais<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGALT<font color="#808080">, </font>MSG_REGNALT<font color="#808080">);
   </font><font color="#0000FF">ELSIF </font>sacao<font color="#808080">=</font>opConfirmaExclusao <font color="#0000FF">THEN
      </font>escreveArq<font color="#808080">(</font>tfPais<font color="#808080">, </font>repete<font color="#808080">(</font><font color="#800000">'*'</font><font color="#808080">,</font>tamReg<font color="#808080">(</font>sreg<font color="#808080">)), </font>MSG_REGEXC<font color="#808080">, </font>MSG_REGNEXC<font color="#808080">);
   </font><font color="#0000FF">END</font><font color="#808080">;
</font><font color="#0000FF">ELSIF </font>sreg<font color="#808080">=</font>opProfissao <font color="#0000FF">THEN 
   IF </font>sacao<font color="#808080">=</font>opSalvarInclusao <font color="#0000FF">THEN
      </font>escreveArq<font color="#808080">(</font>tfProfissao<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGINC<font color="#808080">, </font>MSG_REGNINC<font color="#808080">);
   </font><font color="#0000FF">ELSIF </font>sacao<font color="#808080">=</font>opSalvarAlteracao <font color="#0000FF">THEN
      </font>escreveArq<font color="#808080">(</font>tfProfissao<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGALT<font color="#808080">, </font>MSG_REGNALT<font color="#808080">);
   </font><font color="#0000FF">ELSIF </font>sacao<font color="#808080">=</font>opConfirmaExclusao <font color="#0000FF">THEN
      </font>escreveArq<font color="#808080">(</font>tfProfissao<font color="#808080">, </font>repete<font color="#808080">(</font><font color="#800000">'*'</font><font color="#808080">,</font>tamReg<font color="#808080">(</font>sreg<font color="#808080">)), </font>MSG_REGEXC<font color="#808080">, </font>MSG_REGNEXC<font color="#808080">);
   </font><font color="#0000FF">END</font><font color="#808080">;
</font><font color="#0000FF">ELSIF </font>sreg<font color="#808080">=</font>opLivro <font color="#0000FF">THEN 
   IF </font>sacao<font color="#808080">=</font>opSalvarInclusao <font color="#0000FF">THEN
      </font>escreveArq<font color="#808080">(</font>tfLivro<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGINC<font color="#808080">, </font>MSG_REGNINC<font color="#808080">);
   </font><font color="#0000FF">ELSIF </font>sacao<font color="#808080">=</font>opSalvarAlteracao <font color="#0000FF">THEN
      </font>escreveArq<font color="#808080">(</font>tfLivro<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGALT<font color="#808080">, </font>MSG_REGNALT<font color="#808080">);
   </font><font color="#0000FF">ELSIF </font>sacao<font color="#808080">=</font>opConfirmaExclusao <font color="#0000FF">THEN
      </font>escreveArq<font color="#808080">(</font>tfLivro<font color="#808080">, </font>repete<font color="#808080">(</font><font color="#800000">'*'</font><font color="#808080">,</font>tamReg<font color="#808080">(</font>sreg<font color="#808080">)), </font>MSG_REGEXC<font color="#808080">, </font>MSG_REGNEXC<font color="#808080">);
   </font><font color="#0000FF">END</font><font color="#808080">;
</font><font color="#0000FF">ELSIF </font>sreg<font color="#808080">=</font>opLivroAss <font color="#0000FF">THEN 
   IF </font>sacao<font color="#808080">=</font>opSalvarInclusao <font color="#0000FF">THEN
      </font>escreveArq<font color="#808080">(</font>tfLivroAss<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGINC<font color="#808080">, </font>MSG_REGNINC<font color="#808080">);
   </font><font color="#0000FF">ELSIF </font>sacao<font color="#808080">=</font>opSalvarAlteracao <font color="#0000FF">THEN
      </font>escreveArq<font color="#808080">(</font>tfLivroAss<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGALT<font color="#808080">, </font>MSG_REGNALT<font color="#808080">);
   </font><font color="#0000FF">ELSIF </font>sacao<font color="#808080">=</font>opConfirmaExclusao <font color="#0000FF">THEN
      </font>escreveArq<font color="#808080">(</font>tfLivroAss<font color="#808080">, </font>repete<font color="#808080">(</font><font color="#800000">'*'</font><font color="#808080">,</font>tamReg<font color="#808080">(</font>sreg<font color="#808080">)), </font>MSG_REGEXC<font color="#808080">, </font>MSG_REGNEXC<font color="#808080">);
   </font><font color="#0000FF">END</font><font color="#808080">;
</font><font color="#0000FF">ELSIF </font>sreg<font color="#808080">=</font>opLivroAut <font color="#0000FF">THEN 
   IF </font>sacao<font color="#808080">=</font>opSalvarInclusao <font color="#0000FF">THEN
      </font>escreveArq<font color="#808080">(</font>tfLivroAut<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGINC<font color="#808080">, </font>MSG_REGNINC<font color="#808080">);
   </font><font color="#0000FF">ELSIF </font>sacao<font color="#808080">=</font>opSalvarAlteracao <font color="#0000FF">THEN
      </font>escreveArq<font color="#808080">(</font>tfLivroAut<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGALT<font color="#808080">, </font>MSG_REGNALT<font color="#808080">);
   </font><font color="#0000FF">ELSIF </font>sacao<font color="#808080">=</font>opConfirmaExclusao <font color="#0000FF">THEN
      </font>escreveArq<font color="#808080">(</font>tfLivroAut<font color="#808080">, </font>repete<font color="#808080">(</font><font color="#800000">'*'</font><font color="#808080">,</font>tamReg<font color="#808080">(</font>sreg<font color="#808080">)), </font>MSG_REGEXC<font color="#808080">, </font>MSG_REGNEXC<font color="#808080">);
   </font><font color="#0000FF">END</font><font color="#808080">;
</font><font color="#0000FF">ELSIF </font>sreg<font color="#808080">=</font>opCliente <font color="#0000FF">THEN 
   IF </font>sacao<font color="#808080">=</font>opSalvarInclusao <font color="#0000FF">THEN
      </font>escreveArq<font color="#808080">(</font>tfCliente<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGINC<font color="#808080">, </font>MSG_REGNINC<font color="#808080">);
   </font><font color="#0000FF">ELSIF </font>sacao<font color="#808080">=</font>opSalvarAlteracao <font color="#0000FF">THEN
      </font>escreveArq<font color="#808080">(</font>tfCliente<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGALT<font color="#808080">, </font>MSG_REGNALT<font color="#808080">);
   </font><font color="#0000FF">ELSIF </font>sacao<font color="#808080">=</font>opConfirmaExclusao <font color="#0000FF">THEN
      </font>escreveArq<font color="#808080">(</font>tfCliente<font color="#808080">, </font>repete<font color="#808080">(</font><font color="#800000">'*'</font><font color="#808080">,</font>tamReg<font color="#808080">(</font>sreg<font color="#808080">)), </font>MSG_REGEXC<font color="#808080">, </font>MSG_REGNEXC<font color="#808080">);
   </font><font color="#0000FF">END</font><font color="#808080">;
</font><font color="#0000FF">ELSIF </font>sreg<font color="#808080">=</font>opVenda <font color="#0000FF">THEN 
   IF </font>sacao<font color="#808080">=</font>opSalvarInclusao <font color="#0000FF">THEN
      </font>escreveArq<font color="#808080">(</font>tfVenda<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGINC<font color="#808080">, </font>MSG_REGNINC<font color="#808080">);
   </font><font color="#0000FF">ELSIF </font>sacao<font color="#808080">=</font>opSalvarAlteracao <font color="#0000FF">THEN
      </font>escreveArq<font color="#808080">(</font>tfVenda<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGALT<font color="#808080">, </font>MSG_REGNALT<font color="#808080">);
   </font><font color="#0000FF">ELSIF </font>sacao<font color="#808080">=</font>opConfirmaExclusao <font color="#0000FF">THEN
      </font>escreveArq<font color="#808080">(</font>tfVenda<font color="#808080">, </font>repete<font color="#808080">(</font><font color="#800000">'*'</font><font color="#808080">,</font>tamReg<font color="#808080">(</font>sreg<font color="#808080">)), </font>MSG_REGEXC<font color="#808080">, </font>MSG_REGNEXC<font color="#808080">);
   </font><font color="#0000FF">END</font><font color="#808080">;
</font><font color="#0000FF">ELSIF </font>sreg<font color="#808080">=</font>opUsuario <font color="#0000FF">THEN 
   IF </font>sacao<font color="#808080">=</font>opSalvarAlteracao <font color="#0000FF">THEN
      </font>escreveArq<font color="#808080">(</font>tfUsuario<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGALT<font color="#808080">, </font>MSG_REGNALT<font color="#808080">);
   </font><font color="#0000FF">END</font><font color="#808080">;
</font><font color="#0000FF">END</font><font color="#808080">;
</font><font color="#0000FF">END </font>btnAcao<font color="#808080">;

(*------------------------------------------------------------------------------
</font>Realiza a exclus<font color="#808080">&atilde;</font>o dos arquivos de liga<font color="#808080">&ccedil;&atilde;</font>o.
sArq <font color="#808080">- </font>o arquivo de liga<font color="#808080">&ccedil;&atilde;</font>o
sreg <font color="#808080">- </font>o tipo de arquivo de liga<font color="#808080">&ccedil;&atilde;</font>o
nPosChave <font color="#808080">- </font>a posicao inicial da chave dentro do registro
nTamChave <font color="#808080">- </font>o tamanho da chave dentro do registro
sChave <font color="#808080">- </font>a chave a ser excluida
<font color="#808080">------------------------------------------------------------------------------*)
</font><font color="#0000FF">PROCEDURE </font>ExcluirRegLigados<font color="#808080">(</font><font color="#0000FF">VAR </font>sArq<font color="#808080">: </font>ChanId<font color="#808080">; </font>sreg<font color="#808080">: </font>ctArqs<font color="#808080">; </font>nPosChave<font color="#808080">,
</font>nTamChave<font color="#808080">: </font><font color="#0000FF">INTEGER</font><font color="#808080">; </font>sChave<font color="#808080">: </font>String<font color="#808080">);
</font><font color="#0000FF">VAR </font>slinha<font color="#808080">, </font>sCodigo<font color="#808080">: </font>String<font color="#808080">;
    </font>npos<font color="#808080">: </font><font color="#0000FF">CARDINAL</font><font color="#808080">;    
</font><font color="#0000FF">BEGIN
  </font>npos<font color="#808080">:=</font><font color="#FF0000">0</font><font color="#808080">;
  </font>SetPos<font color="#808080">(</font>sArq<font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">);
  </font><font color="#0000FF">WHILE </font><font color="#808080">(</font><font color="#0000FF">NOT </font>fimArq<font color="#808080">(</font>sArq<font color="#808080">)) </font><font color="#0000FF">DO 
    </font>slinha<font color="#808080">:=</font>lerArq<font color="#808080">(</font>sArq<font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">), </font>TAM_CRLF<font color="#808080">, </font>npos<font color="#808080">);
    </font>sCodigo<font color="#808080">:=</font>trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha<font color="#808080">,</font>nPosChave<font color="#808080">,</font>nTamChave<font color="#808080">));
    </font><font color="#0000FF">IF </font>Compare<font color="#808080">(</font>sCodigo<font color="#808080">,</font>sChave<font color="#808080">)=</font>equal <font color="#0000FF">THEN
       </font>btnAcao<font color="#808080">(</font>sreg<font color="#808080">,</font>opConfirmaExclusao<font color="#808080">);
    </font><font color="#0000FF">END</font><font color="#808080">;
  </font><font color="#0000FF">END</font><font color="#808080">;
</font><font color="#0000FF">END </font>ExcluirRegLigados<font color="#808080">;

</font><font color="#0000FF">END </font>Sistema.
</font>
</code></pre>
</body>
</html>