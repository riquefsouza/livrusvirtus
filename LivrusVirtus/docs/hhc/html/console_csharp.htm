<html>
<head>
<title>Livrus Virtus - Console - C#</title>
</head>
<!-- Generated by ConTEXT HTML exporter -->
<body text="#000000" bgcolor="#FFFFFF">
<pre>
<code><font  face="Courier New"><font color="#808080"><i>/*------------------------------------------------------------------------------
 Sistema integrante do projeto Livrus Virtus.
 Todos os direitos reservados para Henrique F. de Souza.
 Vers&atilde;o programada na linguagem C #.
------------------------------------------------------------------------------*/
/* programa Livrus */

</i></font><font color="#000080"><b>using </b></font>System<font color="#808080">;
</font><font color="#000080"><b>using </b></font>System<font color="#808080">.</font>IO<font color="#808080">;
</font><font color="#000080"><b>using </b></font>System<font color="#808080">.</font>Text<font color="#808080">;

</font><font color="#0000FF"><b>namespace </b></font>Livrus <font color="#808080">{
</font><font color="#0000FF"><b>class </b></font>Livrus <font color="#808080">{
  <i>/* Declara&ccedil;&atilde;o de tipos */

  </i></font><font color="#0000FF"><b>public struct </b></font>regAssunto <font color="#808080">{
   </font><font color="#0000FF"><b>public string </b></font>codigo<font color="#808080">; <i>//10
   </i></font><font color="#0000FF"><b>public string </b></font>assunto<font color="#808080">; <i>//30
  </i>}
  </font><font color="#0000FF"><b>public struct </b></font>regAutor <font color="#808080">{
   </font><font color="#0000FF"><b>public string </b></font>codigo<font color="#808080">; <i>//10
   </i></font><font color="#0000FF"><b>public string </b></font>autor<font color="#808080">; <i>//30
  </i>}
  </font><font color="#0000FF"><b>public struct </b></font>regEditora <font color="#808080">{
   </font><font color="#0000FF"><b>public string </b></font>codigo<font color="#808080">; <i>//10
   </i></font><font color="#0000FF"><b>public string </b></font>editora<font color="#808080">; <i>//50
  </i>}
  </font><font color="#0000FF"><b>public struct </b></font>regIdioma <font color="#808080">{
   </font><font color="#0000FF"><b>public string </b></font>codigo<font color="#808080">; <i>//10
   </i></font><font color="#0000FF"><b>public string </b></font>idioma<font color="#808080">; <i>//20
  </i>}
  </font><font color="#0000FF"><b>public struct </b></font>regUsuario <font color="#808080">{
   </font><font color="#0000FF"><b>public string </b></font>login<font color="#808080">; <i>//10
   </i></font><font color="#0000FF"><b>public string </b></font>senha<font color="#808080">; <i>//10
  </i>}
  </font><font color="#0000FF"><b>public struct </b></font>regPais <font color="#808080">{
   </font><font color="#0000FF"><b>public string </b></font>codigo<font color="#808080">; <i>//3
   </i></font><font color="#0000FF"><b>public string </b></font>pais<font color="#808080">; <i>//50
  </i>}
  </font><font color="#0000FF"><b>public struct </b></font>regProfissao <font color="#808080">{
   </font><font color="#0000FF"><b>public string </b></font>codigo<font color="#808080">; <i>//10
   </i></font><font color="#0000FF"><b>public string </b></font>profissao<font color="#808080">; <i>//50
  </i>}
  </font><font color="#0000FF"><b>public struct </b></font>regLivro <font color="#808080">{
   </font><font color="#0000FF"><b>public string </b></font>isbn<font color="#808080">; <i>//13
   </i></font><font color="#0000FF"><b>public string </b></font>titulo<font color="#808080">; <i>//50
   </i></font><font color="#0000FF"><b>public string </b></font>edicao<font color="#808080">; <i>//10
   </i></font><font color="#0000FF"><b>public string </b></font>anopubli<font color="#808080">; <i>//10
   </i></font><font color="#0000FF"><b>public string </b></font>codeditora<font color="#808080">; <i>//10
   </i></font><font color="#0000FF"><b>public string </b></font>volume<font color="#808080">; <i>//10
   </i></font><font color="#0000FF"><b>public string </b></font>codidioma<font color="#808080">; <i>//10
   </i></font><font color="#0000FF"><b>public string </b></font>npaginas<font color="#808080">; <i>//10
   </i></font><font color="#0000FF"><b>public string </b></font>preco<font color="#808080">; <i>//10
   </i></font><font color="#0000FF"><b>public string </b></font>qtdestoque<font color="#808080">; <i>//10
  </i>}
  </font><font color="#0000FF"><b>public struct </b></font>regLivroAss <font color="#808080">{
   </font><font color="#0000FF"><b>public string </b></font>isbn<font color="#808080">; <i>//13
   </i></font><font color="#0000FF"><b>public string </b></font>codassunto<font color="#808080">; <i>//10
  </i>}
  </font><font color="#0000FF"><b>public struct </b></font>regLivroAut <font color="#808080">{
   </font><font color="#0000FF"><b>public string </b></font>isbn<font color="#808080">; <i>//13
   </i></font><font color="#0000FF"><b>public string </b></font>codautor<font color="#808080">; <i>//10
  </i>}
  </font><font color="#0000FF"><b>public struct </b></font>regCliente <font color="#808080">{
   </font><font color="#0000FF"><b>public string </b></font>cpf<font color="#808080">; <i>//14
   </i></font><font color="#0000FF"><b>public string </b></font>nome<font color="#808080">; <i>//30
   </i></font><font color="#0000FF"><b>public string </b></font>email<font color="#808080">; <i>//30
   </i></font><font color="#0000FF"><b>public string </b></font>identidade<font color="#808080">; <i>//10
   </i></font><font color="#0000FF"><b>public string </b></font>sexo<font color="#808080">; <i>//1
   </i></font><font color="#0000FF"><b>public string </b></font>telefone<font color="#808080">; <i>//17
   </i></font><font color="#0000FF"><b>public string </b></font>dtnascimento<font color="#808080">; <i>//10
   </i></font><font color="#0000FF"><b>public string </b></font>codendereco<font color="#808080">; <i>//10
   </i></font><font color="#0000FF"><b>public string </b></font>codpais<font color="#808080">; <i>//3
   </i></font><font color="#0000FF"><b>public string </b></font>codprofissao<font color="#808080">; <i>//10
  </i>}
  </font><font color="#0000FF"><b>public struct </b></font>regEndereco <font color="#808080">{
   </font><font color="#0000FF"><b>public string </b></font>codigo<font color="#808080">; <i>//10
   </i></font><font color="#0000FF"><b>public string </b></font>logradouro<font color="#808080">; <i>//40
   </i></font><font color="#0000FF"><b>public string </b></font>bairro<font color="#808080">; <i>//15
   </i></font><font color="#0000FF"><b>public string </b></font>cep<font color="#808080">; <i>//8
   </i></font><font color="#0000FF"><b>public string </b></font>cidade<font color="#808080">; <i>//30
   </i></font><font color="#0000FF"><b>public string </b></font>estado<font color="#808080">; <i>//20
  </i>}
  </font><font color="#0000FF"><b>public struct </b></font>regVenda <font color="#808080">{
   </font><font color="#0000FF"><b>public string </b></font>dthrvenda<font color="#808080">; <i>//19  /* data/hora da venda dd/mm/yyyy hh:mm:ss */
   </i></font><font color="#0000FF"><b>public string </b></font>cpf<font color="#808080">; <i>//14
   </i></font><font color="#0000FF"><b>public string </b></font>isbn<font color="#808080">; <i>//13
   </i></font><font color="#0000FF"><b>public string </b></font>precovenda<font color="#808080">; <i>//10
  </i>}

  </font><font color="#0000FF"><b>enum </b></font>ctTipo <font color="#808080">{ </font>opTexto<font color="#808080">, </font>opNumero<font color="#808080">, </font>opData<font color="#808080">, </font>opDataHora<font color="#808080">, </font>opSenha <font color="#808080">};
  </font><font color="#0000FF"><b>enum </b></font>ctArqs <font color="#808080">{ </font>opAssunto<font color="#808080">, </font>opAutor<font color="#808080">, </font>opEditora<font color="#808080">, </font>opEndereco<font color="#808080">, </font>opIdioma<font color="#808080">, </font>opPais<font color="#808080">,
</font>				opProfissao<font color="#808080">, </font>opCliente<font color="#808080">, </font>opLivro<font color="#808080">, </font>opLivroAss<font color="#808080">, </font>opLivroAut<font color="#808080">,
</font>				opUsuario<font color="#808080">, </font>opVenda <font color="#808080">};
  </font><font color="#0000FF"><b>enum </b></font>ctAcao <font color="#808080">{ </font>opNovo<font color="#808080">, </font>opAlterar<font color="#808080">, </font>opPesquisar<font color="#808080">, </font>opSalvarInclusao<font color="#808080">,
</font>			  opSalvarAlteracao<font color="#808080">, </font>opExcluir<font color="#808080">, </font>opConfirmaExclusao<font color="#808080">, </font>opListarTodos <font color="#808080">};

  </font><font color="#0000FF"><b>static string </b></font>CRLF <font color="#808080">= </font><font color="#800000">&quot;\r\n&quot;</font><font color="#808080">; <i>/* windows */
  </i></font><font color="#0000FF"><b>static int </b></font>TAM_CRLF <font color="#808080">= </font><font color="#FF0000">2</font><font color="#808080">;
  <i>/* static String CRLF = &quot;\n&quot;;
	 static int TAM_CRLF = 1; */ /* unix */
  /* static String CRLF = &quot;\r&quot;;
	 static int TAM_CRLF = 1; */ /* macintosh */

  </i></font><font color="#0000FF"><b>static int </b></font>QTD_MAX_LINHA <font color="#808080">= </font><font color="#FF0000">18</font><font color="#808080">;
  </font><font color="#0000FF"><b>static int </b></font>TAM_MAX_REG <font color="#808080">= </font><font color="#FF0000">145</font><font color="#808080">;

  </font><font color="#0000FF"><b>static string </b></font>MSG_ARQERRO <font color="#808080">= </font><font color="#800000">&quot;Erro: O arquivo n&atilde;o pode ser aberto.&quot;</font><font color="#808080">;
  </font><font color="#0000FF"><b>static string </b></font>MSG_ERRO <font color="#808080">= </font><font color="#800000">&quot;Erro: op&ccedil;&atilde;o inv&aacute;lida digite de novo.&quot;</font><font color="#808080">;
  </font><font color="#0000FF"><b>static string </b></font>MSG_OPCAO <font color="#808080">= </font><font color="#800000">&quot;Escolha uma op&ccedil;&atilde;o: &quot;</font><font color="#808080">;
  </font><font color="#0000FF"><b>static string </b></font>MSG_PRESS <font color="#808080">= </font><font color="#800000">&quot;pressione para continuar...&quot;</font><font color="#808080">;

  </font><font color="#0000FF"><b>static string </b></font>MSG_REGINC <font color="#808080">= </font><font color="#800000">&quot;registro incluido!&quot;</font><font color="#808080">;
  </font><font color="#0000FF"><b>static string </b></font>MSG_REGNINC <font color="#808080">= </font><font color="#800000">&quot;registro n&atilde;o incluido!&quot;</font><font color="#808080">;
  </font><font color="#0000FF"><b>static string </b></font>MSG_REGALT <font color="#808080">= </font><font color="#800000">&quot;registro alterado!&quot;</font><font color="#808080">;
  </font><font color="#0000FF"><b>static string </b></font>MSG_REGNALT <font color="#808080">= </font><font color="#800000">&quot;registro n&atilde;o alterado!&quot;</font><font color="#808080">;
  </font><font color="#0000FF"><b>static string </b></font>MSG_REGEXC <font color="#808080">= </font><font color="#800000">&quot;registro excluido!&quot;</font><font color="#808080">;
  </font><font color="#0000FF"><b>static string </b></font>MSG_REGNEXC <font color="#808080">= </font><font color="#800000">&quot;registro n&atilde;o excluido!&quot;</font><font color="#808080">;
  </font><font color="#0000FF"><b>static string </b></font>MSG_REGEXST <font color="#808080">= </font><font color="#800000">&quot;registro j&aacute; existe!&quot;</font><font color="#808080">;

  </font><font color="#0000FF"><b>static string </b></font>MSG_NUMINV <font color="#808080">= </font><font color="#800000">&quot;N&uacute;mero inv&aacute;lido ou menor do que 1!&quot;</font><font color="#808080">;
  </font><font color="#0000FF"><b>static string </b></font>MSG_DATAINV <font color="#808080">= </font><font color="#800000">&quot;Data inv&aacute;lida!, formato correto (dd/mm/yyyy)&quot;</font><font color="#808080">;
  </font><font color="#0000FF"><b>static string </b></font>MSG_DTHRINV <font color="#808080">=
</font>				  <font color="#800000">&quot;Data/hora inv&aacute;lida!, formato correto (dd/mm/yyyy hh:mm:ss)&quot;</font><font color="#808080">;
  </font><font color="#0000FF"><b>static string </b></font>MSG_ISBNINV <font color="#808080">= </font><font color="#800000">&quot;ISBN inv&aacute;lido!&quot;</font><font color="#808080">;
  </font><font color="#0000FF"><b>static string </b></font>MSG_CPFINV <font color="#808080">= </font><font color="#800000">&quot;CPF inv&aacute;lido!&quot;</font><font color="#808080">;
  </font><font color="#0000FF"><b>static string </b></font>MSG_SENCONFERE <font color="#808080">= </font><font color="#800000">&quot;senha n&atilde;o confere com a senha atual!&quot;</font><font color="#808080">;
  </font><font color="#0000FF"><b>static string </b></font>MSG_SENCONFIRM<font color="#808080">=</font><font color="#800000">&quot;nova senha n&atilde;o confere com a senha confirmada!&quot;</font><font color="#808080">;
  </font><font color="#0000FF"><b>static string </b></font>MSG_LOGINENCON <font color="#808080">= </font><font color="#800000">&quot;login n&atilde;o encontrado!&quot;</font><font color="#808080">;
  </font><font color="#0000FF"><b>static string </b></font>MSG_SEMESTOQUE <font color="#808080">= </font><font color="#800000">&quot;livro n&atilde;o existe no estoque!&quot;</font><font color="#808080">;

  </font><font color="#0000FF"><b>static string </b></font>ARQ_ASSUNTO <font color="#808080">= </font><font color="#800000">&quot;assunto.dat&quot;</font><font color="#808080">;
  </font><font color="#0000FF"><b>static string </b></font>ARQ_AUTOR <font color="#808080">= </font><font color="#800000">&quot;autor.dat&quot;</font><font color="#808080">;
  </font><font color="#0000FF"><b>static string </b></font>ARQ_EDITORA <font color="#808080">= </font><font color="#800000">&quot;editora.dat&quot;</font><font color="#808080">;
  </font><font color="#0000FF"><b>static string </b></font>ARQ_IDIOMA <font color="#808080">= </font><font color="#800000">&quot;idioma.dat&quot;</font><font color="#808080">;
  </font><font color="#0000FF"><b>static string </b></font>ARQ_USUARIO <font color="#808080">= </font><font color="#800000">&quot;usuario.dat&quot;</font><font color="#808080">;
  </font><font color="#0000FF"><b>static string </b></font>ARQ_PAIS <font color="#808080">= </font><font color="#800000">&quot;pais.dat&quot;</font><font color="#808080">;
  </font><font color="#0000FF"><b>static string </b></font>ARQ_PROFISSAO <font color="#808080">= </font><font color="#800000">&quot;profissao.dat&quot;</font><font color="#808080">;
  </font><font color="#0000FF"><b>static string </b></font>ARQ_LIVRO <font color="#808080">= </font><font color="#800000">&quot;livro.dat&quot;</font><font color="#808080">;
  </font><font color="#0000FF"><b>static string </b></font>ARQ_LIVASS <font color="#808080">= </font><font color="#800000">&quot;livroass.dat&quot;</font><font color="#808080">;
  </font><font color="#0000FF"><b>static string </b></font>ARQ_LIVAUT <font color="#808080">= </font><font color="#800000">&quot;livroaut.dat&quot;</font><font color="#808080">;
  </font><font color="#0000FF"><b>static string </b></font>ARQ_CLIENTE <font color="#808080">= </font><font color="#800000">&quot;cliente.dat&quot;</font><font color="#808080">;
  </font><font color="#0000FF"><b>static string </b></font>ARQ_ENDERECO <font color="#808080">= </font><font color="#800000">&quot;endereco.dat&quot;</font><font color="#808080">;
  </font><font color="#0000FF"><b>static string </b></font>ARQ_VENDA <font color="#808080">= </font><font color="#800000">&quot;venda.dat&quot;</font><font color="#808080">;

  </font><font color="#0000FF"><b>static int </b></font>TAM_ASSUNTO <font color="#808080">= </font><font color="#FF0000">40</font><font color="#808080">;
  </font><font color="#0000FF"><b>static int </b></font>TAM_AUTOR <font color="#808080">= </font><font color="#FF0000">40</font><font color="#808080">;
  </font><font color="#0000FF"><b>static int </b></font>TAM_EDITORA <font color="#808080">= </font><font color="#FF0000">60</font><font color="#808080">;
  </font><font color="#0000FF"><b>static int </b></font>TAM_IDIOMA <font color="#808080">= </font><font color="#FF0000">30</font><font color="#808080">;
  </font><font color="#0000FF"><b>static int </b></font>TAM_USUARIO <font color="#808080">= </font><font color="#FF0000">20</font><font color="#808080">;
  </font><font color="#0000FF"><b>static int </b></font>TAM_PAIS <font color="#808080">= </font><font color="#FF0000">53</font><font color="#808080">;
  </font><font color="#0000FF"><b>static int </b></font>TAM_PROFISSAO <font color="#808080">= </font><font color="#FF0000">60</font><font color="#808080">;
  </font><font color="#0000FF"><b>static int </b></font>TAM_LIVRO <font color="#808080">= </font><font color="#FF0000">143</font><font color="#808080">;
  </font><font color="#0000FF"><b>static int </b></font>TAM_LIVASS <font color="#808080">= </font><font color="#FF0000">23</font><font color="#808080">;
  </font><font color="#0000FF"><b>static int </b></font>TAM_LIVAUT <font color="#808080">= </font><font color="#FF0000">23</font><font color="#808080">;
  </font><font color="#0000FF"><b>static int </b></font>TAM_CLIENTE <font color="#808080">= </font><font color="#FF0000">135</font><font color="#808080">;
  </font><font color="#0000FF"><b>static int </b></font>TAM_ENDERECO <font color="#808080">= </font><font color="#FF0000">123</font><font color="#808080">;
  </font><font color="#0000FF"><b>static int </b></font>TAM_VENDA <font color="#808080">= </font><font color="#FF0000">56</font><font color="#808080">;

  <i>/* variaveis gerais */

  </i></font>Boolean bopcao<font color="#808080">;
  </font><font color="#0000FF"><b>char </b></font>opmenu<font color="#808080">;
  </font><font color="#0000FF"><b>int </b></font>g_nPosChave<font color="#808080">, </font>g_nTamChave<font color="#808080">;
  </font><font color="#0000FF"><b>double </b></font>g_nPreco<font color="#808080">;
  </font>Boolean g_SalvarInclusao<font color="#808080">;

  </font>regAssunto tAssunto<font color="#808080">;
  </font>regAutor tAutor<font color="#808080">;
  </font>regEditora tEditora<font color="#808080">;
  </font>regIdioma tIdioma<font color="#808080">;
  </font>regEndereco tEndereco<font color="#808080">;
  </font>regPais tPais<font color="#808080">;
  </font>regProfissao tProfissao<font color="#808080">;
  </font>regLivro tLivro<font color="#808080">;
  </font>regLivroAss tLivroAss<font color="#808080">;
  </font>regLivroAut tLivroAut<font color="#808080">;
  </font>regCliente tCliente<font color="#808080">;
  </font>regUsuario tUsuario<font color="#808080">;
  </font>regVenda tVenda<font color="#808080">;

  </font>FileStream tfAssunto<font color="#808080">, </font>tfAutor<font color="#808080">, </font>tfEditora<font color="#808080">, </font>tfIdioma<font color="#808080">, </font>tfEndereco<font color="#808080">,
</font>	  tfPais<font color="#808080">, </font>tfProfissao<font color="#808080">, </font>tfLivro<font color="#808080">, </font>tfLivroAss<font color="#808080">, </font>tfLivroAut<font color="#808080">, </font>tfCliente<font color="#808080">,
</font>	  tfUsuario<font color="#808080">, </font>tfVenda<font color="#808080">;

<i>/*--- Rotinas b&aacute;sicas --------------------------------------------------------*/

/*------------------------------------------------------------------------------
Fun&ccedil;&atilde;o que retorna um peda&ccedil;o de uma string.
str - indica a string
nini - indica a posicao inicial do pedaco
ntam - indica o tamanho do pedaco
retorna - o peda&ccedil;o da string
------------------------------------------------------------------------------*/
  </i></font><font color="#0000FF"><b>string </b></font>copy<font color="#808080">(</font><font color="#0000FF"><b>string </b></font>str<font color="#808080">,</font><font color="#0000FF"><b>int </b></font>nini<font color="#808080">,</font><font color="#0000FF"><b>int </b></font>ntam<font color="#808080">) {
</font>	<font color="#000080"><b>return </b></font>str<font color="#808080">.</font>Substring<font color="#808080">(</font>nini<font color="#808080">-</font><font color="#FF0000">1</font><font color="#808080">,</font>ntam<font color="#808080">);
  }

<i>/*------------------------------------------------------------------------------
Repete um texto um n&uacute;mero determinado de vezes.
sTexto - o texto a ser repetido
nQtd - a quantidade de vezes
retorna - o texto repetido
------------------------------------------------------------------------------*/
  </i></font><font color="#0000FF"><b>private </b></font>String repete<font color="#808080">(</font><font color="#0000FF"><b>string </b></font>sTexto<font color="#808080">, </font><font color="#0000FF"><b>int </b></font>nQtd<font color="#808080">)
  { </font><font color="#0000FF"><b>int </b></font>ncont<font color="#808080">;
</font>	<font color="#0000FF"><b>string </b></font>sret <font color="#808080">= </font><font color="#800000">&quot;&quot;</font><font color="#808080">;

    </font><font color="#000080"><b>for</b></font><font color="#808080">(</font>ncont <font color="#808080">= </font><font color="#FF0000">1</font><font color="#808080">; </font>ncont <font color="#808080">&lt;= </font>nQtd<font color="#808080">; </font>ncont<font color="#808080">++) {
</font>		sret <font color="#808080">= </font>sret <font color="#808080">+ </font>sTexto<font color="#808080">;
    }
    </font><font color="#000080"><b>return </b></font>sret<font color="#808080">;
  }
<i>/*------------------------------------------------------------------------------
Coloca espa&ccedil;os em branco a mais de acordo com o tamanho m&aacute;ximo do texto.
sTexto - o texto
nTam - tamanho m&aacute;ximo do texto
retorna - o texto com espa&ccedil;os em branco a mais
------------------------------------------------------------------------------*/
  </i></font><font color="#0000FF"><b>private string </b></font>esp<font color="#808080">(</font><font color="#0000FF"><b>string </b></font>sTexto<font color="#808080">, </font><font color="#0000FF"><b>int </b></font>nTam<font color="#808080">) {
   </font><font color="#0000FF"><b>string </b></font>sret<font color="#808080">;

</font>	sret <font color="#808080">= </font>sTexto <font color="#808080">+ </font>repete<font color="#808080">(</font><font color="#800000">&quot; &quot;</font><font color="#808080">,</font>nTam<font color="#808080">-</font>sTexto<font color="#808080">.</font>Length<font color="#808080">);
</font>	<font color="#000080"><b>return </b></font>sret<font color="#808080">;
  }
<i>/*------------------------------------------------------------------------------
Faz uma pesquisa relativa de um texto atrav&eacute;s de um valor chave.
sTexto - o texto
sChave - a chave a ser pesquisada
retorna - se achou ou n&atilde;o a chave dentro do texto
------------------------------------------------------------------------------*/
  </i></font><font color="#0000FF"><b>private </b></font>Boolean strRelativa<font color="#808080">(</font><font color="#0000FF"><b>string </b></font>sTexto<font color="#808080">, </font><font color="#0000FF"><b>string </b></font>sChave<font color="#808080">) {
</font>	<font color="#0000FF"><b>int </b></font>nCont<font color="#808080">, </font>nTamChave<font color="#808080">, </font>nTamTexto<font color="#808080">;
</font>	Boolean bret<font color="#808080">;
</font>	<font color="#0000FF"><b>string </b></font>sPedaco<font color="#808080">;

</font>	bret <font color="#808080">= </font><font color="#0000FF"><b>false</b></font><font color="#808080">;
</font>	nCont <font color="#808080">= </font><font color="#FF0000">1</font><font color="#808080">;
</font>	nTamChave <font color="#808080">= </font>sChave<font color="#808080">.</font>Length<font color="#808080">;
    </font>nTamTexto <font color="#808080">= </font>sTexto<font color="#808080">.</font>Length<font color="#808080">;
    </font><font color="#000080"><b>if </b></font><font color="#808080">(</font>nTamChave <font color="#808080">&lt;= </font>nTamTexto<font color="#808080">) {
      </font><font color="#000080"><b>while </b></font><font color="#808080">(</font>nCont <font color="#808080">&lt;= (</font>nTamTexto<font color="#808080">-</font>nTamChave<font color="#808080">+</font><font color="#FF0000">1</font><font color="#808080">)) {
         </font>sPedaco <font color="#808080">= </font>copy<font color="#808080">(</font>sTexto<font color="#808080">,</font>nCont<font color="#808080">,</font>nTamChave<font color="#808080">);
         </font><font color="#000080"><b>if </b></font><font color="#808080">(</font>sPedaco<font color="#808080">.</font>Equals<font color="#808080">(</font>sChave<font color="#808080">))
            </font>bret <font color="#808080">= </font><font color="#0000FF"><b>true</b></font><font color="#808080">;
         </font>nCont<font color="#808080">++;
      }
    }
    </font><font color="#000080"><b>return  </b></font>bret<font color="#808080">;
  }
<i>/*------------------------------------------------------------------------------
Calcula o modulo11 de um valor qualquer.
svalor - a string com o n&uacute;mero a ser calculado
ndig - d&iacute;gito do valor a ser calculado
retorna - o d&iacute;gito correto
------------------------------------------------------------------------------*/
</i></font><font color="#0000FF"><b>public int </b></font>modulo11<font color="#808080">(</font><font color="#0000FF"><b>string </b></font>svalor<font color="#808080">, </font><font color="#0000FF"><b>int </b></font>ndig<font color="#808080">) {
</font><font color="#0000FF"><b>int </b></font>ncont<font color="#808080">, </font>nsoma<font color="#808080">, </font>nvalor<font color="#808080">, </font>npos<font color="#808080">;
</font><font color="#0000FF"><b>string </b></font>slocal<font color="#808080">, </font>sres<font color="#808080">;

 </font>ncont<font color="#808080">=</font><font color="#FF0000">0</font><font color="#808080">;
 </font>slocal<font color="#808080">=</font><font color="#800000">&quot;&quot;</font><font color="#808080">;
 </font><font color="#000080"><b>while </b></font><font color="#808080">(</font>ncont <font color="#808080">&lt; </font><font color="#FF0000">11</font><font color="#808080">) {
   </font>slocal<font color="#808080">=</font>svalor<font color="#808080">.</font>Substring<font color="#808080">(</font>ncont<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">) + </font>slocal<font color="#808080">;
   </font>ncont<font color="#808080">++;
 }
 </font>nsoma<font color="#808080">=</font><font color="#FF0000">0</font><font color="#808080">;
 </font><font color="#000080"><b>if </b></font><font color="#808080">(</font>ndig <font color="#808080">== </font><font color="#FF0000">1</font><font color="#808080">)
   </font>ncont<font color="#808080">=</font><font color="#FF0000">2</font><font color="#808080">;
 </font><font color="#000080"><b>else
   </b></font>ncont<font color="#808080">=</font><font color="#FF0000">1</font><font color="#808080">;
 </font>npos<font color="#808080">=</font><font color="#FF0000">2</font><font color="#808080">;
 </font><font color="#000080"><b>while </b></font><font color="#808080">(</font>ncont <font color="#808080">&lt; </font><font color="#FF0000">11</font><font color="#808080">) {
   </font>sres <font color="#808080">= </font>slocal<font color="#808080">.</font>Substring<font color="#808080">(</font>ncont<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">);
   </font>nvalor <font color="#808080">= </font><font color="#0000FF"><b>int</b></font><font color="#808080">.</font>Parse<font color="#808080">(</font>sres<font color="#808080">);
   </font>nsoma<font color="#808080">=</font>nsoma <font color="#808080">+ (</font>nvalor <font color="#808080">* </font>npos<font color="#808080">);
   </font>ncont<font color="#808080">++;
   </font>npos<font color="#808080">++;
 }
 </font>nsoma<font color="#808080">=(</font><font color="#FF0000">11 </font><font color="#808080">- (</font>nsoma <font color="#808080">% </font><font color="#FF0000">11</font><font color="#808080">));

 </font><font color="#000080"><b>if </b></font><font color="#808080">(</font>nsoma <font color="#808080">&gt; </font><font color="#FF0000">9</font><font color="#808080">)
   </font><font color="#000080"><b>return </b></font><font color="#FF0000">0</font><font color="#808080">;
 </font><font color="#000080"><b>else
   return </b></font>nsoma<font color="#808080">;
}
<i>/*------------------------------------------------------------------------------
Valida&ccedil;&atilde;o de um n&uacute;mero de CPF qualquer.
cpf - a mstring com o n&uacute;mero do CPF
retorna - se &eacute; valido ou n&atilde;o
------------------------------------------------------------------------------*/
  </i></font><font color="#0000FF"><b>public </b></font>Boolean ValidaCPF<font color="#808080">(</font><font color="#0000FF"><b>string </b></font>cpf<font color="#808080">) {
  </font><font color="#0000FF"><b>string </b></font>scpf<font color="#808080">;

  </font><font color="#000080"><b>if </b></font><font color="#808080">(</font>cpf<font color="#808080">.</font>Length<font color="#808080">==</font><font color="#FF0000">14</font><font color="#808080">) {
    </font>scpf<font color="#808080">=</font>cpf<font color="#808080">.</font>Substring<font color="#808080">(</font><font color="#FF0000">0</font><font color="#808080">,</font><font color="#FF0000">3</font><font color="#808080">)+</font>cpf<font color="#808080">.</font>Substring<font color="#808080">(</font><font color="#FF0000">4</font><font color="#808080">,</font><font color="#FF0000">3</font><font color="#808080">)+</font>cpf<font color="#808080">.</font>Substring<font color="#808080">(</font><font color="#FF0000">8</font><font color="#808080">,</font><font color="#FF0000">3</font><font color="#808080">)+
</font>	cpf<font color="#808080">.</font>Substring<font color="#808080">(</font><font color="#FF0000">12</font><font color="#808080">,</font><font color="#FF0000">2</font><font color="#808080">);
</font>	<font color="#000080"><b>if </b></font><font color="#808080">( (</font>modulo11<font color="#808080">(</font>scpf<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">)==</font><font color="#0000FF"><b>int</b></font><font color="#808080">.</font>Parse<font color="#808080">(</font>cpf<font color="#808080">.</font>Substring<font color="#808080">(</font><font color="#FF0000">12</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">))) &amp;&amp;
</font>	    <font color="#808080">(</font>modulo11<font color="#808080">(</font>scpf<font color="#808080">,</font><font color="#FF0000">2</font><font color="#808080">)==</font><font color="#0000FF"><b>int</b></font><font color="#808080">.</font>Parse<font color="#808080">(</font>cpf<font color="#808080">.</font>Substring<font color="#808080">(</font><font color="#FF0000">13</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">))) )
</font>  	<font color="#000080"><b>return </b></font><font color="#0000FF"><b>true</b></font><font color="#808080">;
</font>	<font color="#000080"><b>else
</b></font>  	<font color="#000080"><b>return </b></font><font color="#0000FF"><b>false</b></font><font color="#808080">;
  } </font><font color="#000080"><b>else
    return </b></font><font color="#0000FF"><b>false</b></font><font color="#808080">;
  }
<i>/*------------------------------------------------------------------------------
Valida&ccedil;&atilde;o de um n&uacute;mero ISBN qualquer.
isbn - a mstring com o n&uacute;mero do ISBN
retorna - se &eacute; valido ou n&atilde;o
------------------------------------------------------------------------------*/
</i></font><font color="#0000FF"><b>public </b></font>Boolean ValidaISBN<font color="#808080">(</font><font color="#0000FF"><b>string </b></font>isbn<font color="#808080">) {
 </font><font color="#0000FF"><b>string </b></font>sisbn<font color="#808080">, </font>sdigito<font color="#808080">, </font>snum<font color="#808080">;
 </font><font color="#0000FF"><b>int </b></font>nvalor<font color="#808080">, </font>nsoma<font color="#808080">, </font>ncont<font color="#808080">;

</font><font color="#000080"><b>if </b></font><font color="#808080">(</font>isbn<font color="#808080">.</font>Length<font color="#808080">==</font><font color="#FF0000">13</font><font color="#808080">) {
  </font>sdigito <font color="#808080">= </font>isbn<font color="#808080">.</font>Substring<font color="#808080">(</font>isbn<font color="#808080">.</font>Length<font color="#808080">-</font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">);
  </font>sisbn<font color="#808080">=</font><font color="#800000">&quot;&quot;</font><font color="#808080">;
  </font><font color="#000080"><b>for</b></font><font color="#808080">(</font>ncont <font color="#808080">= </font><font color="#FF0000">0</font><font color="#808080">; </font>ncont <font color="#808080">&lt; </font>isbn<font color="#808080">.</font>Length<font color="#808080">-</font><font color="#FF0000">1</font><font color="#808080">; </font>ncont<font color="#808080">++)  {
    </font><font color="#000080"><b>if </b></font><font color="#808080">(</font>isbn<font color="#808080">.</font>Substring<font color="#808080">(</font>ncont<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">)!=</font><font color="#800000">&quot;-&quot;</font><font color="#808080">)
      </font>sisbn <font color="#808080">= </font>sisbn <font color="#808080">+ </font>isbn<font color="#808080">.</font>Substring<font color="#808080">(</font>ncont<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">);
  }
  </font><font color="#000080"><b>if </b></font><font color="#808080">(</font>sdigito<font color="#808080">==</font><font color="#800000">&quot;X&quot;</font><font color="#808080">)
    </font>nsoma <font color="#808080">= </font><font color="#FF0000">10</font><font color="#808080">;
  </font><font color="#000080"><b>else </b></font><font color="#808080">{
    </font>nvalor <font color="#808080">= </font><font color="#0000FF"><b>int</b></font><font color="#808080">.</font>Parse<font color="#808080">(</font>sdigito<font color="#808080">);
    </font>nsoma <font color="#808080">= </font>nvalor<font color="#808080">;
  }
  </font><font color="#000080"><b>for</b></font><font color="#808080">(</font>ncont <font color="#808080">= </font><font color="#FF0000">1</font><font color="#808080">; </font>ncont <font color="#808080">&lt;= </font><font color="#FF0000">9</font><font color="#808080">; </font>ncont<font color="#808080">++)  {
    </font>snum <font color="#808080">= </font>sisbn<font color="#808080">.</font>Substring<font color="#808080">(</font>ncont<font color="#808080">-</font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">);
    </font>nvalor <font color="#808080">= </font><font color="#0000FF"><b>int</b></font><font color="#808080">.</font>Parse<font color="#808080">(</font>snum<font color="#808080">);
    </font>nsoma<font color="#808080">=</font>nsoma <font color="#808080">+ (</font>nvalor <font color="#808080">* (</font><font color="#FF0000">11 </font><font color="#808080">- </font>ncont<font color="#808080">));
  }
  </font><font color="#000080"><b>if </b></font><font color="#808080">((</font>nsoma <font color="#808080">% </font><font color="#FF0000">11</font><font color="#808080">) == </font><font color="#FF0000">0</font><font color="#808080">)
    </font><font color="#000080"><b>return </b></font><font color="#0000FF"><b>true</b></font><font color="#808080">;
  </font><font color="#000080"><b>else
    return </b></font><font color="#0000FF"><b>false</b></font><font color="#808080">;
} </font><font color="#000080"><b>else
  return </b></font><font color="#0000FF"><b>false</b></font><font color="#808080">;
}
<i>/*------------------------------------------------------------------------------
Esconde a digita&ccedil;&atilde;o da senha
retorna - a senha digitada
------------------------------------------------------------------------------*/
</i></font><font color="#0000FF"><b>string </b></font>digitaSenha<font color="#808080">(</font><font color="#0000FF"><b>string </b></font>sRotulo<font color="#808080">,</font><font color="#0000FF"><b>int </b></font>nTamSenha<font color="#808080">) {
 </font><font color="#0000FF"><b>string </b></font>sSenha <font color="#808080">= </font><font color="#800000">&quot;&quot;</font><font color="#808080">;
<i>// char sLetra;
// int ncont;

  </i></font>System<font color="#808080">.</font>Console<font color="#808080">.</font>Write<font color="#808080">(</font>sRotulo<font color="#808080">);
  </font>sSenha <font color="#808080">= </font>System<font color="#808080">.</font>Console<font color="#808080">.</font>In<font color="#808080">.</font>ReadLine<font color="#808080">();
<i>/*
  ncont  = 0;
  sLetra = '\0';
  while((sLetra!='\r') &amp;&amp; (ncont &lt; nTamSenha)) {
	sLetra = (char) System.Console.Read();
	if (sLetra!='\r') {
	   sSenha = sSenha + sLetra;
	}
	ncont++;
  }
System.Console.WriteLine();
*/
</i></font><font color="#000080"><b>return </b></font>sSenha<font color="#808080">;
}
<i>/*------------------------------------------------------------------------------
Valida&ccedil;&atilde;o de um n&uacute;mero qualquer.
sRotulo - o texto antes de se digitar o n&uacute;mero
sNumero - a String com o valor do n&uacute;mero
retorna - o sNumero
------------------------------------------------------------------------------*/
</i></font><font color="#0000FF"><b>string </b></font>validaNumero<font color="#808080">(</font><font color="#0000FF"><b>string </b></font>sRotulo<font color="#808080">, </font><font color="#0000FF"><b>string </b></font>sNumero<font color="#808080">)
{ </font><font color="#0000FF"><b>double </b></font>nnum<font color="#808080">;
  </font><font color="#0000FF"><b>int </b></font>nStatus<font color="#808080">;

</font>nStatus <font color="#808080">= -</font><font color="#FF0000">1</font><font color="#808080">;
 </font><font color="#000080"><b>while </b></font><font color="#808080">(</font>nStatus<font color="#808080">!=</font><font color="#FF0000">0</font><font color="#808080">) {
  </font>System<font color="#808080">.</font>Console<font color="#808080">.</font>Write<font color="#808080">(</font>sRotulo<font color="#808080">);
  </font>sNumero <font color="#808080">= </font>System<font color="#808080">.</font>Console<font color="#808080">.</font>In<font color="#808080">.</font>ReadLine<font color="#808080">();
  </font><font color="#000080"><b>try </b></font><font color="#808080">{
</font>	  nnum <font color="#808080">= </font><font color="#0000FF"><b>float</b></font><font color="#808080">.</font>Parse<font color="#808080">(</font>sNumero<font color="#808080">);
</font>	  <font color="#000080"><b>if </b></font><font color="#808080">(</font>nnum <font color="#808080">&lt; </font><font color="#FF0000">1</font><font color="#808080">)
</font>		 System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font>MSG_NUMINV<font color="#808080">);
</font>	  <font color="#000080"><b>else
</b></font>		 nStatus<font color="#808080">=</font><font color="#FF0000">0</font><font color="#808080">;
  } </font><font color="#000080"><b>catch </b></font><font color="#808080">{
</font>	System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font>MSG_NUMINV<font color="#808080">);
  }
}
</font><font color="#000080"><b>return</b></font><font color="#808080">(</font>sNumero<font color="#808080">);
}
<i>/*------------------------------------------------------------------------------
Valida&ccedil;&atilde;o de uma data ou data/hora qualquer.
sRotulo - o texto antes de se digitar a data/hora
sDataHora - a String com o valor da data/hora
bSoData - indica se vai validar somente uma data sem a hora
retorna - a sDataHora
------------------------------------------------------------------------------*/
</i></font><font color="#0000FF"><b>string </b></font>validaDataHora<font color="#808080">(</font><font color="#0000FF"><b>string </b></font>sRotulo<font color="#808080">, </font><font color="#0000FF"><b>string </b></font>sDataHora<font color="#808080">, </font>Boolean bSoData<font color="#808080">)
{ </font>Boolean bvalida<font color="#808080">, </font>bdatavalida<font color="#808080">, </font>bhoravalida<font color="#808080">;
  </font><font color="#0000FF"><b>string </b></font>sdia<font color="#808080">, </font>smes<font color="#808080">, </font>sano<font color="#808080">, </font>shora<font color="#808080">, </font>smin<font color="#808080">, </font>sseg<font color="#808080">;
  </font><font color="#0000FF"><b>int </b></font>ndia<font color="#808080">, </font>nmes<font color="#808080">, </font>nano<font color="#808080">, </font>nhora<font color="#808080">, </font>nmin<font color="#808080">, </font>nseg<font color="#808080">, </font>nudiames<font color="#808080">, </font>ntam<font color="#808080">;

</font>bvalida <font color="#808080">= </font><font color="#0000FF"><b>false</b></font><font color="#808080">;
</font>bdatavalida <font color="#808080">= </font><font color="#0000FF"><b>false</b></font><font color="#808080">;
</font>bhoravalida <font color="#808080">= </font><font color="#0000FF"><b>false</b></font><font color="#808080">;
</font>nudiames <font color="#808080">= </font><font color="#FF0000">0</font><font color="#808080">;
</font><font color="#000080"><b>if </b></font><font color="#808080">(</font>bSoData<font color="#808080">==</font><font color="#0000FF"><b>true</b></font><font color="#808080">) </font>ntam<font color="#808080">=</font><font color="#FF0000">10</font><font color="#808080">;
</font><font color="#000080"><b>else </b></font>ntam<font color="#808080">=</font><font color="#FF0000">19</font><font color="#808080">;
</font><font color="#000080"><b>while </b></font><font color="#808080">(</font>bvalida<font color="#808080">==</font><font color="#0000FF"><b>false</b></font><font color="#808080">) {
  </font>System<font color="#808080">.</font>Console<font color="#808080">.</font>Write<font color="#808080">(</font>sRotulo<font color="#808080">);
  </font>sDataHora <font color="#808080">= </font>System<font color="#808080">.</font>Console<font color="#808080">.</font>In<font color="#808080">.</font>ReadLine<font color="#808080">();
  </font><font color="#000080"><b>if </b></font><font color="#808080">(</font>sDataHora<font color="#808080">.</font>Length<font color="#808080">==</font>ntam<font color="#808080">) {
</font>	sdia <font color="#808080">= </font>copy<font color="#808080">(</font>sDataHora<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#FF0000">2</font><font color="#808080">);
</font>	ndia <font color="#808080">= </font><font color="#0000FF"><b>int</b></font><font color="#808080">.</font>Parse<font color="#808080">(</font>sdia<font color="#808080">);
</font>	smes <font color="#808080">= </font>copy<font color="#808080">(</font>sDataHora<font color="#808080">,</font><font color="#FF0000">4</font><font color="#808080">,</font><font color="#FF0000">2</font><font color="#808080">);
</font>	nmes <font color="#808080">= </font><font color="#0000FF"><b>int</b></font><font color="#808080">.</font>Parse<font color="#808080">(</font>smes<font color="#808080">);
</font>	sano <font color="#808080">= </font>copy<font color="#808080">(</font>sDataHora<font color="#808080">,</font><font color="#FF0000">7</font><font color="#808080">,</font><font color="#FF0000">4</font><font color="#808080">);
</font>	nano <font color="#808080">= </font><font color="#0000FF"><b>int</b></font><font color="#808080">.</font>Parse<font color="#808080">(</font>sano<font color="#808080">);

</font>	<font color="#000080"><b>if </b></font><font color="#808080">((</font>nano <font color="#808080">&gt;= </font><font color="#FF0000">1</font><font color="#808080">) &amp;&amp; (</font>nano <font color="#808080">&lt;= </font><font color="#FF0000">9999</font><font color="#808080">)) {
</font>	  <font color="#000080"><b>if </b></font><font color="#808080">((</font>nmes <font color="#808080">&gt;= </font><font color="#FF0000">1</font><font color="#808080">) &amp;&amp; (</font>nmes <font color="#808080">&lt;= </font><font color="#FF0000">31</font><font color="#808080">)) {
</font>		  <font color="#000080"><b>switch</b></font><font color="#808080">(</font>nmes<font color="#808080">) {
</font>		   <font color="#000080"><b>case </b></font><font color="#FF0000">1</font><font color="#808080">: </font><font color="#000080"><b>case </b></font><font color="#FF0000">3</font><font color="#808080">: </font><font color="#000080"><b>case </b></font><font color="#FF0000">5</font><font color="#808080">: </font><font color="#000080"><b>case </b></font><font color="#FF0000">7</font><font color="#808080">: </font><font color="#000080"><b>case </b></font><font color="#FF0000">8</font><font color="#808080">:
</font>		   <font color="#000080"><b>case </b></font><font color="#FF0000">10</font><font color="#808080">: </font><font color="#000080"><b>case </b></font><font color="#FF0000">12</font><font color="#808080">: </font>nudiames <font color="#808080">= </font><font color="#FF0000">31</font><font color="#808080">; </font><font color="#000080"><b>break</b></font><font color="#808080">;
</font>		   <font color="#000080"><b>case </b></font><font color="#FF0000">2</font><font color="#808080">: {
</font>			   <font color="#808080"><i>/* ano bissexto */
               </i></font><font color="#000080"><b>if </b></font><font color="#808080">((</font>nano <font color="#808080">% </font><font color="#FF0000">4</font><font color="#808080">)==</font><font color="#FF0000">0</font><font color="#808080">) </font>nudiames <font color="#808080">= </font><font color="#FF0000">29</font><font color="#808080">;
               </font><font color="#000080"><b>else </b></font>nudiames <font color="#808080">= </font><font color="#FF0000">28</font><font color="#808080">;
</font>			  <font color="#808080">} </font><font color="#000080"><b>break</b></font><font color="#808080">;
           </font><font color="#000080"><b>case </b></font><font color="#FF0000">4</font><font color="#808080">: </font><font color="#000080"><b>case </b></font><font color="#FF0000">6</font><font color="#808080">: </font><font color="#000080"><b>case </b></font><font color="#FF0000">9</font><font color="#808080">: </font><font color="#000080"><b>case </b></font><font color="#FF0000">11</font><font color="#808080">: </font>nudiames <font color="#808080">= </font><font color="#FF0000">30</font><font color="#808080">; </font><font color="#000080"><b>break</b></font><font color="#808080">;
          }
</font>		  <font color="#000080"><b>if </b></font><font color="#808080">((</font>ndia <font color="#808080">&gt;=</font><font color="#FF0000">1</font><font color="#808080">) &amp;&amp; (</font>ndia <font color="#808080">&lt;=</font>nudiames<font color="#808080">))
             </font>bdatavalida <font color="#808080">= </font><font color="#0000FF"><b>true</b></font><font color="#808080">;
      }
    }

    </font><font color="#000080"><b>if </b></font><font color="#808080">(</font>bSoData<font color="#808080">) {
</font>	   <font color="#000080"><b>if </b></font><font color="#808080">(</font>bdatavalida<font color="#808080">)
</font>		   bvalida <font color="#808080">= </font><font color="#0000FF"><b>true</b></font><font color="#808080">;
       </font><font color="#000080"><b>else
</b></font>	   System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font>MSG_DATAINV<font color="#808080">);
</font>	<font color="#808080">} </font><font color="#000080"><b>else </b></font><font color="#808080">{
</font>	  <font color="#000080"><b>if </b></font><font color="#808080">(</font>bdatavalida<font color="#808080">) {
</font>		  shora <font color="#808080">= </font>copy<font color="#808080">(</font>sDataHora<font color="#808080">,</font><font color="#FF0000">12</font><font color="#808080">,</font><font color="#FF0000">2</font><font color="#808080">);
</font>		  nhora <font color="#808080">= </font><font color="#0000FF"><b>int</b></font><font color="#808080">.</font>Parse<font color="#808080">(</font>shora<font color="#808080">);
</font>		  smin <font color="#808080">= </font>copy<font color="#808080">(</font>sDataHora<font color="#808080">,</font><font color="#FF0000">15</font><font color="#808080">,</font><font color="#FF0000">2</font><font color="#808080">);
</font>		  nmin <font color="#808080">= </font><font color="#0000FF"><b>int</b></font><font color="#808080">.</font>Parse<font color="#808080">(</font>smin<font color="#808080">);
</font>		  sseg <font color="#808080">= </font>copy<font color="#808080">(</font>sDataHora<font color="#808080">,</font><font color="#FF0000">18</font><font color="#808080">,</font><font color="#FF0000">2</font><font color="#808080">);
</font>		  nseg <font color="#808080">= </font><font color="#0000FF"><b>int</b></font><font color="#808080">.</font>Parse<font color="#808080">(</font>sseg<font color="#808080">);

</font>		  <font color="#000080"><b>if </b></font><font color="#808080">((</font>nhora <font color="#808080">&gt;= </font><font color="#FF0000">0</font><font color="#808080">) &amp;&amp; (</font>nhora <font color="#808080">&lt;= </font><font color="#FF0000">23</font><font color="#808080">)) {
</font>			<font color="#000080"><b>if </b></font><font color="#808080">((</font>nmin <font color="#808080">&gt;= </font><font color="#FF0000">0</font><font color="#808080">) &amp;&amp; (</font>nmin <font color="#808080">&lt;= </font><font color="#FF0000">59</font><font color="#808080">)) {
</font>			  <font color="#000080"><b>if </b></font><font color="#808080">((</font>nseg <font color="#808080">&gt;= </font><font color="#FF0000">0</font><font color="#808080">) &amp;&amp; (</font>nseg <font color="#808080">&lt;= </font><font color="#FF0000">59</font><font color="#808080">))
</font>				 bhoravalida <font color="#808080">= </font><font color="#0000FF"><b>true</b></font><font color="#808080">;
</font>			<font color="#808080">}
</font>		  <font color="#808080">}

</font>		  <font color="#000080"><b>if </b></font><font color="#808080">(</font>bhoravalida<font color="#808080">)
</font>		   bvalida <font color="#808080">= </font><font color="#0000FF"><b>true</b></font><font color="#808080">;
</font>		  <font color="#000080"><b>else
</b></font>		   System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font>MSG_DTHRINV<font color="#808080">);
</font>	  <font color="#808080">} </font><font color="#000080"><b>else
        </b></font>System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font>MSG_DTHRINV<font color="#808080">);
    }
  } </font><font color="#000080"><b>else </b></font><font color="#808080">{
</font>	<font color="#000080"><b>if </b></font><font color="#808080">(</font>bSoData<font color="#808080">==</font><font color="#0000FF"><b>true</b></font><font color="#808080">) </font>System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font>MSG_DATAINV<font color="#808080">);
</font>	<font color="#000080"><b>else </b></font>System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font>MSG_DTHRINV<font color="#808080">);
  }
}
</font><font color="#000080"><b>return </b></font>sDataHora<font color="#808080">;
}
<i>/*------------------------------------------------------------------------------
Retorna a Data e a hora do sistema.
retorna - a data e a hora
------------------------------------------------------------------------------*/
</i></font><font color="#0000FF"><b>private string </b></font>retDataHora<font color="#808080">() {
  </font><font color="#000080"><b>return </b></font>DateTime<font color="#808080">.</font>Now<font color="#808080">.</font>ToString<font color="#808080">(</font><font color="#800000">&quot;dd/MM/yyyy hh:mm:ss&quot;</font><font color="#808080">);
}
<i>/*------------------------------------------------------------------------------
Calcula o tamanho do arquivo.
sArq - o arquivo
retorna - o tamanho do arquivo
------------------------------------------------------------------------------*/
</i></font><font color="#0000FF"><b>long </b></font>tamArq<font color="#808080">(</font>FileStream sArq<font color="#808080">){
  </font><font color="#000080"><b>return </b></font>sArq<font color="#808080">.</font>Length<font color="#808080">;
}
<i>/*------------------------------------------------------------------------------
Verifica se chegou ao fim do arquivo.
sArq - o arquivo
ntam - o tamanho do arquivo
retorna - se chegou ao fim do arquivo
------------------------------------------------------------------------------*/
</i></font>Boolean fimArq<font color="#808080">(</font>FileStream sArq<font color="#808080">) {
 </font><font color="#000080"><b>if </b></font><font color="#808080">(</font>sArq<font color="#808080">.</font>Position <font color="#808080">== </font>sArq<font color="#808080">.</font>Length<font color="#808080">)
</font>	<font color="#000080"><b>return </b></font><font color="#0000FF"><b>true</b></font><font color="#808080">;
 </font><font color="#000080"><b>else
</b></font>	<font color="#000080"><b>return </b></font><font color="#0000FF"><b>false</b></font><font color="#808080">;
}
<i>/*------------------------------------------------------------------------------
L&ecirc; uma linha do arquivo.
sArq - o arquivo
nTamLinha - o tamanho da linha
nTamCRLF - o tamanho do retorno da linha
npos - posicao dentro do arquivo
retorna - o texto lido
------------------------------------------------------------------------------*/
</i></font><font color="#0000FF"><b>string </b></font>lerArq<font color="#808080">(</font>FileStream sArq<font color="#808080">, </font><font color="#0000FF"><b>int </b></font>nTamLinha<font color="#808080">, </font><font color="#0000FF"><b>int </b></font>nTamCRLF<font color="#808080">) {
</font><font color="#0000FF"><b>int </b></font>nLidos<font color="#808080">, </font>ncont<font color="#808080">;
</font><font color="#0000FF"><b>byte</b></font><font color="#808080">[] </font>slinha<font color="#808080">=</font><font color="#000080"><b>new </b></font><font color="#0000FF"><b>byte</b></font><font color="#808080">[</font>TAM_MAX_REG<font color="#808080">];
</font><font color="#0000FF"><b>char</b></font><font color="#808080">[] </font>slinha2<font color="#808080">=</font><font color="#000080"><b>new </b></font><font color="#0000FF"><b>char</b></font><font color="#808080">[</font>TAM_MAX_REG<font color="#808080">];
</font><font color="#0000FF"><b>string </b></font>sret <font color="#808080">= </font><font color="#800000">&quot;&quot;</font><font color="#808080">;

<i>//StreamReader sLer = new StreamReader(sArq);
//sret = sLer.ReadLine();

</i></font>nLidos <font color="#808080">= </font>sArq<font color="#808080">.</font>Read<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">,(</font>nTamLinha <font color="#808080">+ </font>nTamCRLF<font color="#808080">));

</font><font color="#000080"><b>if </b></font><font color="#808080">(</font>nLidos <font color="#808080">!= (</font>nTamLinha <font color="#808080">+ </font>nTamCRLF<font color="#808080">))
  </font>sret <font color="#808080">= </font><font color="#800000">&quot;&quot;</font><font color="#808080">;
</font><font color="#000080"><b>else </b></font><font color="#808080">{
  </font><font color="#000080"><b>for</b></font><font color="#808080">(</font>ncont<font color="#808080">=</font><font color="#FF0000">0</font><font color="#808080">; </font>ncont <font color="#808080">&lt; (</font>nLidos <font color="#808080">- </font>nTamCRLF<font color="#808080">); </font>ncont<font color="#808080">++)
</font>	slinha2<font color="#808080">[</font>ncont<font color="#808080">]=(</font><font color="#0000FF"><b>char</b></font><font color="#808080">)</font>slinha<font color="#808080">[</font>ncont<font color="#808080">];
  </font>sret <font color="#808080">= </font><font color="#000080"><b>new </b></font>String<font color="#808080">(</font>slinha2<font color="#808080">,</font><font color="#FF0000">0</font><font color="#808080">,(</font>nLidos <font color="#808080">- </font>nTamCRLF<font color="#808080">));
}

</font><font color="#000080"><b>return </b></font>sret<font color="#808080">;
}
<i>/*------------------------------------------------------------------------------
Abre ou cria os arquivos do sistema.
bAbre - condi&ccedil;&atilde;o para abrir ou criar os arquivos do sistema
------------------------------------------------------------------------------*/
</i></font><font color="#0000FF"><b>void </b></font>abrecriaArqs<font color="#808080">(</font>Boolean bAbre<font color="#808080">)
{
</font><font color="#000080"><b>if </b></font><font color="#808080">(</font>bAbre<font color="#808080">) {
  </font><font color="#000080"><b>if </b></font><font color="#808080">(</font>File<font color="#808080">.</font>Exists<font color="#808080">(</font>ARQ_ASSUNTO<font color="#808080">))
</font>	tfAssunto <font color="#808080">= </font><font color="#000080"><b>new </b></font>FileStream<font color="#808080">(</font>ARQ_ASSUNTO<font color="#808080">,</font>FileMode<font color="#808080">.</font>Open<font color="#808080">,</font>FileAccess<font color="#808080">.</font>ReadWrite<font color="#808080">);
  </font><font color="#000080"><b>else
</b></font>	System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font>MSG_ARQERRO<font color="#808080">+</font><font color="#800000">&quot; --&gt; &quot;</font><font color="#808080">+</font>ARQ_ASSUNTO<font color="#808080">);
  </font><font color="#000080"><b>if </b></font><font color="#808080">(</font>File<font color="#808080">.</font>Exists<font color="#808080">(</font>ARQ_AUTOR<font color="#808080">))
</font>	tfAutor <font color="#808080">= </font><font color="#000080"><b>new </b></font>FileStream<font color="#808080">(</font>ARQ_AUTOR<font color="#808080">, </font>FileMode<font color="#808080">.</font>Open<font color="#808080">, </font>FileAccess<font color="#808080">.</font>ReadWrite<font color="#808080">);
  </font><font color="#000080"><b>else
</b></font>	System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font>MSG_ARQERRO<font color="#808080">+</font><font color="#800000">&quot; --&gt; &quot;</font><font color="#808080">+</font>ARQ_AUTOR<font color="#808080">);
  </font><font color="#000080"><b>if </b></font><font color="#808080">(</font>File<font color="#808080">.</font>Exists<font color="#808080">(</font>ARQ_EDITORA<font color="#808080">))
</font>	tfEditora <font color="#808080">= </font><font color="#000080"><b>new </b></font>FileStream<font color="#808080">(</font>ARQ_EDITORA<font color="#808080">,</font>FileMode<font color="#808080">.</font>Open<font color="#808080">,</font>FileAccess<font color="#808080">.</font>ReadWrite<font color="#808080">);
  </font><font color="#000080"><b>else
</b></font>	System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font>MSG_ARQERRO<font color="#808080">+</font><font color="#800000">&quot; --&gt; &quot;</font><font color="#808080">+</font>ARQ_EDITORA<font color="#808080">);
  </font><font color="#000080"><b>if </b></font><font color="#808080">(</font>File<font color="#808080">.</font>Exists<font color="#808080">(</font>ARQ_IDIOMA<font color="#808080">))
</font>	tfIdioma <font color="#808080">= </font><font color="#000080"><b>new </b></font>FileStream<font color="#808080">(</font>ARQ_IDIOMA<font color="#808080">, </font>FileMode<font color="#808080">.</font>Open<font color="#808080">, </font>FileAccess<font color="#808080">.</font>ReadWrite<font color="#808080">);
  </font><font color="#000080"><b>else
</b></font>	System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font>MSG_ARQERRO<font color="#808080">+</font><font color="#800000">&quot; --&gt; &quot;</font><font color="#808080">+</font>ARQ_IDIOMA<font color="#808080">);
  </font><font color="#000080"><b>if </b></font><font color="#808080">(</font>File<font color="#808080">.</font>Exists<font color="#808080">(</font>ARQ_ENDERECO<font color="#808080">))
</font>	tfEndereco<font color="#808080">= </font><font color="#000080"><b>new </b></font>FileStream<font color="#808080">(</font>ARQ_ENDERECO<font color="#808080">,</font>FileMode<font color="#808080">.</font>Open<font color="#808080">,</font>FileAccess<font color="#808080">.</font>ReadWrite<font color="#808080">);
  </font><font color="#000080"><b>else
</b></font>	System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font>MSG_ARQERRO<font color="#808080">+</font><font color="#800000">&quot; --&gt; &quot;</font><font color="#808080">+</font>ARQ_ENDERECO<font color="#808080">);
  </font><font color="#000080"><b>if </b></font><font color="#808080">(</font>File<font color="#808080">.</font>Exists<font color="#808080">(</font>ARQ_PAIS<font color="#808080">))
</font>	tfPais <font color="#808080">= </font><font color="#000080"><b>new </b></font>FileStream<font color="#808080">(</font>ARQ_PAIS<font color="#808080">, </font>FileMode<font color="#808080">.</font>Open<font color="#808080">, </font>FileAccess<font color="#808080">.</font>ReadWrite<font color="#808080">);
  </font><font color="#000080"><b>else
</b></font>	System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font>MSG_ARQERRO<font color="#808080">+</font><font color="#800000">&quot; --&gt; &quot;</font><font color="#808080">+</font>ARQ_PAIS<font color="#808080">);
  </font><font color="#000080"><b>if </b></font><font color="#808080">(</font>File<font color="#808080">.</font>Exists<font color="#808080">(</font>ARQ_PROFISSAO<font color="#808080">))
   </font>tfProfissao<font color="#808080">=</font><font color="#000080"><b>new </b></font>FileStream<font color="#808080">(</font>ARQ_PROFISSAO<font color="#808080">,</font>FileMode<font color="#808080">.</font>Open<font color="#808080">,</font>FileAccess<font color="#808080">.</font>ReadWrite<font color="#808080">);
  </font><font color="#000080"><b>else
</b></font>	System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font>MSG_ARQERRO<font color="#808080">+</font><font color="#800000">&quot; --&gt; &quot;</font><font color="#808080">+</font>ARQ_PROFISSAO<font color="#808080">);
  </font><font color="#000080"><b>if </b></font><font color="#808080">(</font>File<font color="#808080">.</font>Exists<font color="#808080">(</font>ARQ_LIVRO<font color="#808080">))
</font>	tfLivro <font color="#808080">= </font><font color="#000080"><b>new </b></font>FileStream<font color="#808080">(</font>ARQ_LIVRO<font color="#808080">, </font>FileMode<font color="#808080">.</font>Open<font color="#808080">, </font>FileAccess<font color="#808080">.</font>ReadWrite<font color="#808080">);
  </font><font color="#000080"><b>else
</b></font>	System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font>MSG_ARQERRO<font color="#808080">+</font><font color="#800000">&quot; --&gt; &quot;</font><font color="#808080">+</font>ARQ_LIVRO<font color="#808080">);
  </font><font color="#000080"><b>if </b></font><font color="#808080">(</font>File<font color="#808080">.</font>Exists<font color="#808080">(</font>ARQ_LIVASS<font color="#808080">))
</font>	tfLivroAss <font color="#808080">= </font><font color="#000080"><b>new </b></font>FileStream<font color="#808080">(</font>ARQ_LIVASS<font color="#808080">, </font>FileMode<font color="#808080">.</font>Open<font color="#808080">,</font>FileAccess<font color="#808080">.</font>ReadWrite<font color="#808080">);
  </font><font color="#000080"><b>else
</b></font>	System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font>MSG_ARQERRO<font color="#808080">+</font><font color="#800000">&quot; --&gt; &quot;</font><font color="#808080">+</font>ARQ_LIVASS<font color="#808080">);
  </font><font color="#000080"><b>if </b></font><font color="#808080">(</font>File<font color="#808080">.</font>Exists<font color="#808080">(</font>ARQ_LIVAUT<font color="#808080">))
</font>	tfLivroAut <font color="#808080">= </font><font color="#000080"><b>new </b></font>FileStream<font color="#808080">(</font>ARQ_LIVAUT<font color="#808080">, </font>FileMode<font color="#808080">.</font>Open<font color="#808080">,</font>FileAccess<font color="#808080">.</font>ReadWrite<font color="#808080">);
  </font><font color="#000080"><b>else
</b></font>	System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font>MSG_ARQERRO<font color="#808080">+</font><font color="#800000">&quot; --&gt; &quot;</font><font color="#808080">+</font>ARQ_LIVAUT<font color="#808080">);
  </font><font color="#000080"><b>if </b></font><font color="#808080">(</font>File<font color="#808080">.</font>Exists<font color="#808080">(</font>ARQ_CLIENTE<font color="#808080">))
</font>	tfCliente <font color="#808080">= </font><font color="#000080"><b>new </b></font>FileStream<font color="#808080">(</font>ARQ_CLIENTE<font color="#808080">, </font>FileMode<font color="#808080">.</font>Open<font color="#808080">,</font>FileAccess<font color="#808080">.</font>ReadWrite<font color="#808080">);
  </font><font color="#000080"><b>else
</b></font>	System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font>MSG_ARQERRO<font color="#808080">+</font><font color="#800000">&quot; --&gt; &quot;</font><font color="#808080">+</font>ARQ_CLIENTE<font color="#808080">);
  </font><font color="#000080"><b>if </b></font><font color="#808080">(</font>File<font color="#808080">.</font>Exists<font color="#808080">(</font>ARQ_USUARIO<font color="#808080">))
</font>	tfUsuario <font color="#808080">= </font><font color="#000080"><b>new </b></font>FileStream<font color="#808080">(</font>ARQ_USUARIO<font color="#808080">, </font>FileMode<font color="#808080">.</font>Open<font color="#808080">,</font>FileAccess<font color="#808080">.</font>ReadWrite<font color="#808080">);
  </font><font color="#000080"><b>else
</b></font>	System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font>MSG_ARQERRO<font color="#808080">+</font><font color="#800000">&quot; --&gt; &quot;</font><font color="#808080">+</font>ARQ_USUARIO<font color="#808080">);
  </font><font color="#000080"><b>if </b></font><font color="#808080">(</font>File<font color="#808080">.</font>Exists<font color="#808080">(</font>ARQ_VENDA<font color="#808080">))
</font>	tfVenda <font color="#808080">= </font><font color="#000080"><b>new </b></font>FileStream<font color="#808080">(</font>ARQ_VENDA<font color="#808080">, </font>FileMode<font color="#808080">.</font>Open<font color="#808080">, </font>FileAccess<font color="#808080">.</font>ReadWrite<font color="#808080">);
  </font><font color="#000080"><b>else
</b></font>	System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font>MSG_ARQERRO<font color="#808080">+</font><font color="#800000">&quot; --&gt; &quot;</font><font color="#808080">+</font>ARQ_VENDA<font color="#808080">);
} </font><font color="#000080"><b>else </b></font><font color="#808080">{
  </font>tfAssunto <font color="#808080">= </font><font color="#000080"><b>new </b></font>FileStream<font color="#808080">(</font>ARQ_ASSUNTO<font color="#808080">,</font>FileMode<font color="#808080">.</font>Create<font color="#808080">,</font>FileAccess<font color="#808080">.</font>ReadWrite<font color="#808080">);
  </font>tfAutor <font color="#808080">= </font><font color="#000080"><b>new </b></font>FileStream<font color="#808080">(</font>ARQ_AUTOR<font color="#808080">,</font>FileMode<font color="#808080">.</font>Create<font color="#808080">,</font>FileAccess<font color="#808080">.</font>ReadWrite<font color="#808080">);
  </font>tfEditora <font color="#808080">= </font><font color="#000080"><b>new </b></font>FileStream<font color="#808080">(</font>ARQ_EDITORA<font color="#808080">,</font>FileMode<font color="#808080">.</font>Create<font color="#808080">,</font>FileAccess<font color="#808080">.</font>ReadWrite<font color="#808080">);
  </font>tfIdioma <font color="#808080">= </font><font color="#000080"><b>new </b></font>FileStream<font color="#808080">(</font>ARQ_IDIOMA<font color="#808080">,</font>FileMode<font color="#808080">.</font>Create<font color="#808080">,</font>FileAccess<font color="#808080">.</font>ReadWrite<font color="#808080">);
  </font>tfEndereco<font color="#808080">= </font><font color="#000080"><b>new </b></font>FileStream<font color="#808080">(</font>ARQ_ENDERECO<font color="#808080">,</font>FileMode<font color="#808080">.</font>Create<font color="#808080">,</font>FileAccess<font color="#808080">.</font>ReadWrite<font color="#808080">);
  </font>tfPais <font color="#808080">= </font><font color="#000080"><b>new </b></font>FileStream<font color="#808080">(</font>ARQ_PAIS<font color="#808080">,</font>FileMode<font color="#808080">.</font>Create<font color="#808080">,</font>FileAccess<font color="#808080">.</font>ReadWrite<font color="#808080">);
  </font>tfProfissao<font color="#808080">=</font><font color="#000080"><b>new </b></font>FileStream<font color="#808080">(</font>ARQ_PROFISSAO<font color="#808080">,</font>FileMode<font color="#808080">.</font>Create<font color="#808080">,</font>FileAccess<font color="#808080">.</font>ReadWrite<font color="#808080">);
  </font>tfLivro <font color="#808080">= </font><font color="#000080"><b>new </b></font>FileStream<font color="#808080">(</font>ARQ_LIVRO<font color="#808080">,</font>FileMode<font color="#808080">.</font>Create<font color="#808080">,</font>FileAccess<font color="#808080">.</font>ReadWrite<font color="#808080">);
  </font>tfLivroAss <font color="#808080">= </font><font color="#000080"><b>new </b></font>FileStream<font color="#808080">(</font>ARQ_LIVASS<font color="#808080">,</font>FileMode<font color="#808080">.</font>Create<font color="#808080">,</font>FileAccess<font color="#808080">.</font>ReadWrite<font color="#808080">);
  </font>tfLivroAut <font color="#808080">= </font><font color="#000080"><b>new </b></font>FileStream<font color="#808080">(</font>ARQ_LIVAUT<font color="#808080">,</font>FileMode<font color="#808080">.</font>Create<font color="#808080">,</font>FileAccess<font color="#808080">.</font>ReadWrite<font color="#808080">);
  </font>tfCliente <font color="#808080">= </font><font color="#000080"><b>new </b></font>FileStream<font color="#808080">(</font>ARQ_CLIENTE<font color="#808080">,</font>FileMode<font color="#808080">.</font>Create<font color="#808080">,</font>FileAccess<font color="#808080">.</font>ReadWrite<font color="#808080">);
  </font>tfUsuario <font color="#808080">= </font><font color="#000080"><b>new </b></font>FileStream<font color="#808080">(</font>ARQ_USUARIO<font color="#808080">,</font>FileMode<font color="#808080">.</font>Create<font color="#808080">,</font>FileAccess<font color="#808080">.</font>ReadWrite<font color="#808080">);
  </font>tfVenda <font color="#808080">= </font><font color="#000080"><b>new </b></font>FileStream<font color="#808080">(</font>ARQ_VENDA<font color="#808080">,</font>FileMode<font color="#808080">.</font>Create<font color="#808080">,</font>FileAccess<font color="#808080">.</font>ReadWrite<font color="#808080">);
}

}
<i>/*------------------------------------------------------------------------------
Fecha todos os arquivos abertos.
------------------------------------------------------------------------------*/
</i></font><font color="#0000FF"><b>void </b></font>fechaArqs<font color="#808080">()
{
   </font>tfAssunto<font color="#808080">.</font>Close<font color="#808080">();
   </font>tfAutor<font color="#808080">.</font>Close<font color="#808080">();
   </font>tfEditora<font color="#808080">.</font>Close<font color="#808080">();
   </font>tfIdioma<font color="#808080">.</font>Close<font color="#808080">();
   </font>tfEndereco<font color="#808080">.</font>Close<font color="#808080">();
   </font>tfPais<font color="#808080">.</font>Close<font color="#808080">();
   </font>tfProfissao<font color="#808080">.</font>Close<font color="#808080">();
   </font>tfLivro<font color="#808080">.</font>Close<font color="#808080">();
   </font>tfLivroAss<font color="#808080">.</font>Close<font color="#808080">();
   </font>tfLivroAut<font color="#808080">.</font>Close<font color="#808080">();
   </font>tfCliente<font color="#808080">.</font>Close<font color="#808080">();
   </font>tfUsuario<font color="#808080">.</font>Close<font color="#808080">();
   </font>tfVenda<font color="#808080">.</font>Close<font color="#808080">();
}
<i>/*------------------------------------------------------------------------------
Pesquisa um registro atrav&eacute;s de um valor chave num arquivo.
sArq - o arquivo
sChave - a chave a ser pesquisada
nPosChave - a posicao inicial da chave dentro do registro
nTamChave - o tamanho da chave dentro do registro
nTamLinha - o tamanho do registro
retorna - o registro pesquisado
------------------------------------------------------------------------------*/
</i></font><font color="#0000FF"><b>string </b></font>pesqArq<font color="#808080">(</font>FileStream sArq<font color="#808080">, </font><font color="#0000FF"><b>string </b></font>sChave<font color="#808080">, </font><font color="#0000FF"><b>int </b></font>nPosChave<font color="#808080">,
</font>		<font color="#0000FF"><b>int </b></font>nTamChave<font color="#808080">, </font><font color="#0000FF"><b>int </b></font>nTamLinha<font color="#808080">){
  </font><font color="#0000FF"><b>string </b></font>sres <font color="#808080">= </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font>slinha <font color="#808080">= </font><font color="#800000">&quot;&quot;</font><font color="#808080">;
  </font>Boolean bQuebra<font color="#808080">;
  </font><font color="#0000FF"><b>long </b></font>nPosicao<font color="#808080">;

</font>	bQuebra <font color="#808080">= </font><font color="#0000FF"><b>false</b></font><font color="#808080">;
</font>	sArq<font color="#808080">.</font>Seek<font color="#808080">(</font><font color="#FF0000">0</font><font color="#808080">,</font>SeekOrigin<font color="#808080">.</font>Begin<font color="#808080">);
</font>	<font color="#000080"><b>while </b></font><font color="#808080">(!</font>fimArq<font color="#808080">(</font>sArq<font color="#808080">) &amp;&amp; </font>bQuebra <font color="#808080">== </font><font color="#0000FF"><b>false</b></font><font color="#808080">) {
</font>	  slinha <font color="#808080">= </font>lerArq<font color="#808080">(</font>sArq<font color="#808080">, </font>nTamLinha<font color="#808080">, </font>TAM_CRLF<font color="#808080">);
</font>	  <font color="#000080"><b>if </b></font><font color="#808080">(</font>slinha<font color="#808080">.</font>Equals<font color="#808080">(</font><font color="#800000">&quot;&quot;</font><font color="#808080">)==</font><font color="#0000FF"><b>false</b></font><font color="#808080">)
</font>		sres <font color="#808080">= </font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font>nPosChave<font color="#808080">, </font>nTamChave<font color="#808080">).</font>Trim<font color="#808080">();
</font>	  <font color="#000080"><b>if </b></font><font color="#808080">(</font>sres<font color="#808080">.</font>Equals<font color="#808080">(</font>sChave<font color="#808080">))
</font>		bQuebra <font color="#808080">= </font><font color="#0000FF"><b>true</b></font><font color="#808080">;
</font>	<font color="#808080">}
</font>	nPosicao <font color="#808080">= </font>sArq<font color="#808080">.</font>Position <font color="#808080">- (</font>nTamLinha <font color="#808080">+ </font>TAM_CRLF<font color="#808080">);
</font>	<font color="#000080"><b>if </b></font><font color="#808080">(</font>nPosicao <font color="#808080">&gt; </font><font color="#FF0000">0</font><font color="#808080">)
</font>	  sArq<font color="#808080">.</font>Seek<font color="#808080">(</font>nPosicao<font color="#808080">, </font>SeekOrigin<font color="#808080">.</font>Current<font color="#808080">);
</font>	<font color="#000080"><b>else
</b></font>	  sArq<font color="#808080">.</font>Seek<font color="#808080">(</font><font color="#FF0000">0</font><font color="#808080">, </font>SeekOrigin<font color="#808080">.</font>Begin<font color="#808080">);
</font>	<font color="#000080"><b>if </b></font><font color="#808080">(</font>sres<font color="#808080">.</font>Equals<font color="#808080">(</font>sChave<font color="#808080">) == </font><font color="#0000FF"><b>false</b></font><font color="#808080">)
</font>	  <font color="#000080"><b>return </b></font><font color="#808080">(</font><font color="#800000">&quot;&quot;</font><font color="#808080">);
</font>	<font color="#000080"><b>else
</b></font>	  <font color="#000080"><b>return </b></font><font color="#808080">(</font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font>nTamLinha<font color="#808080">));

}
<i>/*------------------------------------------------------------------------------
Pesquisa se tem linha exclu&iacute;da sen&atilde;o vai para a &uacute;ltima linha do arquivo.
sArq - o arquivo
nTamLinha - o tamanho do registro
------------------------------------------------------------------------------*/
</i></font><font color="#0000FF"><b>void </b></font>pesqLinhaExcluida<font color="#808080">(</font>FileStream sArq<font color="#808080">, </font><font color="#0000FF"><b>int </b></font>nTamLinha<font color="#808080">){
</font><font color="#0000FF"><b>string </b></font>sExcluido<font color="#808080">;

  </font>sExcluido <font color="#808080">= </font>pesqArq<font color="#808080">(</font>sArq<font color="#808080">, </font><font color="#800000">&quot;*&quot;</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font>nTamLinha<font color="#808080">);
  </font><font color="#000080"><b>if </b></font><font color="#808080">(</font>sExcluido<font color="#808080">.</font>Equals<font color="#808080">(</font><font color="#800000">&quot;&quot;</font><font color="#808080">))
</font>	 sArq<font color="#808080">.</font>Seek<font color="#808080">(</font>tamArq<font color="#808080">(</font>sArq<font color="#808080">),</font>SeekOrigin<font color="#808080">.</font>Begin<font color="#808080">);
}
<i>/*------------------------------------------------------------------------------
Pesquisa o maior c&oacute;digo num arquivo.
sArq - o arquivo
nPosChave - a posicao inicial da chave dentro do registro
nTamChave - o tamanho da chave dentro do registro
nTamLinha - o tamanho do registro
retorna - o maior c&oacute;digo
------------------------------------------------------------------------------*/
</i></font><font color="#0000FF"><b>string </b></font>pesqMaxCod<font color="#808080">(</font>FileStream sArq<font color="#808080">, </font><font color="#0000FF"><b>int </b></font>nPosChave<font color="#808080">,
</font>		<font color="#0000FF"><b>int </b></font>nTamChave<font color="#808080">, </font><font color="#0000FF"><b>int </b></font>nTamLinha<font color="#808080">) {
  </font><font color="#0000FF"><b>string </b></font>sres <font color="#808080">= </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font>slinha <font color="#808080">= </font><font color="#800000">&quot;&quot;</font><font color="#808080">;
  </font>Boolean bQuebra<font color="#808080">;
  </font><font color="#0000FF"><b>int </b></font>nMaior<font color="#808080">, </font>nCod<font color="#808080">;

</font>	bQuebra <font color="#808080">= </font><font color="#0000FF"><b>false</b></font><font color="#808080">;
</font>	nMaior <font color="#808080">= </font><font color="#FF0000">0</font><font color="#808080">;
</font>	sArq<font color="#808080">.</font>Seek<font color="#808080">(</font><font color="#FF0000">0</font><font color="#808080">,</font>SeekOrigin<font color="#808080">.</font>Begin<font color="#808080">);
</font>	<font color="#000080"><b>while </b></font><font color="#808080">(!</font>fimArq<font color="#808080">(</font>sArq<font color="#808080">) &amp;&amp; </font>bQuebra <font color="#808080">== </font><font color="#0000FF"><b>false</b></font><font color="#808080">) {
</font>	  slinha <font color="#808080">= </font>lerArq<font color="#808080">(</font>sArq<font color="#808080">, </font>nTamLinha<font color="#808080">, </font>TAM_CRLF<font color="#808080">);
</font>	  <font color="#000080"><b>if </b></font><font color="#808080">(</font>slinha<font color="#808080">.</font>Equals<font color="#808080">(</font><font color="#800000">&quot;&quot;</font><font color="#808080">)==</font><font color="#0000FF"><b>false</b></font><font color="#808080">) {
</font>		sres <font color="#808080">= </font>copy<font color="#808080">(</font>slinha<font color="#808080">,</font>nPosChave<font color="#808080">,</font>nTamChave<font color="#808080">).</font>Trim<font color="#808080">();
</font>		nCod <font color="#808080">= </font><font color="#0000FF"><b>int</b></font><font color="#808080">.</font>Parse<font color="#808080">(</font>sres<font color="#808080">);
</font>		<font color="#000080"><b>if </b></font><font color="#808080">(</font>nCod <font color="#808080">&gt; </font>nMaior<font color="#808080">)
</font>		   nMaior <font color="#808080">= </font>nCod<font color="#808080">;
</font>	  <font color="#808080">}
</font>	<font color="#808080">}
</font>	pesqLinhaExcluida<font color="#808080">(</font>sArq<font color="#808080">, </font>nTamLinha<font color="#808080">);
</font>	nCod <font color="#808080">= (</font>nMaior<font color="#808080">+</font><font color="#FF0000">1</font><font color="#808080">);
</font>	sres <font color="#808080">= </font>nCod<font color="#808080">.</font>ToString<font color="#808080">();

</font><font color="#000080"><b>return</b></font><font color="#808080">(</font>sres<font color="#808080">);
}
<i>/*------------------------------------------------------------------------------
Grava os registros num determinado arquivo.
sArq - o arquivo
sTexto - o registro a ser gravado
sMsgAcerto - a mensagem caso o registro foi gravado
sMsgErro - a mensagem caso o registro n&atilde;o foi gravado
------------------------------------------------------------------------------*/
</i></font><font color="#0000FF"><b>void </b></font>escreveArq<font color="#808080">(</font>FileStream sArq<font color="#808080">, </font><font color="#0000FF"><b>string </b></font>sTexto<font color="#808080">, </font><font color="#0000FF"><b>string </b></font>sMsgAcerto<font color="#808080">,
</font>	<font color="#0000FF"><b>string </b></font>sMsgErro<font color="#808080">){
  </font><font color="#0000FF"><b>byte</b></font><font color="#808080">[] </font>slinha<font color="#808080">=</font><font color="#000080"><b>new </b></font><font color="#0000FF"><b>byte</b></font><font color="#808080">[</font>TAM_MAX_REG<font color="#808080">];
  </font><font color="#0000FF"><b>int </b></font>ntam<font color="#808080">, </font>ncont<font color="#808080">;
  </font><font color="#000080"><b>try </b></font><font color="#808080">{
<i>//	StreamWriter sGravar = new StreamWriter(sArq);
</i></font>	sTexto <font color="#808080">= </font>sTexto <font color="#808080">+ </font>CRLF<font color="#808080">;
</font>	ntam <font color="#808080">= </font>sTexto<font color="#808080">.</font>Length<font color="#808080">;
</font>	<font color="#000080"><b>for </b></font><font color="#808080">(</font>ncont<font color="#808080">=</font><font color="#FF0000">0</font><font color="#808080">; </font>ncont <font color="#808080">&lt; </font>ntam<font color="#808080">; </font>ncont<font color="#808080">++)
</font>		slinha<font color="#808080">[</font>ncont<font color="#808080">] = (</font><font color="#0000FF"><b>byte</b></font><font color="#808080">)</font>sTexto<font color="#808080">[</font>ncont<font color="#808080">];
</font>	sArq<font color="#808080">.</font>Write<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font>ntam<font color="#808080">);
<i>//	sGravar.WriteLine(sTexto);
</i></font>	System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font>sMsgAcerto<font color="#808080">);
  } </font><font color="#000080"><b>catch </b></font><font color="#808080">{
</font>	System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font>sMsgErro<font color="#808080">);
  }
}
<i>/*------------------------------------------------------------------------------
Monta o tamanho do registro no arquivo de acordo com o tipo de arquivo.
sreg - o tipo de arquivo
retorna - o registro montado
------------------------------------------------------------------------------*/
</i></font><font color="#0000FF"><b>string </b></font>LinhaReg<font color="#808080">(</font>ctArqs sreg<font color="#808080">) {
</font><font color="#0000FF"><b>string </b></font>slinha <font color="#808080">= </font><font color="#800000">&quot;&quot;</font><font color="#808080">;

</font><font color="#000080"><b>if </b></font><font color="#808080">(</font>sreg<font color="#808080">==</font>ctArqs<font color="#808080">.</font>opAssunto<font color="#808080">) {
   </font>slinha <font color="#808080">= </font>esp<font color="#808080">(</font>tAssunto<font color="#808080">.</font>codigo<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">)+</font>esp<font color="#808080">(</font>tAssunto<font color="#808080">.</font>assunto<font color="#808080">,</font><font color="#FF0000">30</font><font color="#808080">);
} </font><font color="#000080"><b>else if </b></font><font color="#808080">(</font>sreg<font color="#808080">==</font>ctArqs<font color="#808080">.</font>opAutor<font color="#808080">)
   </font>slinha <font color="#808080">= </font>esp<font color="#808080">(</font>tAutor<font color="#808080">.</font>codigo<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">)+</font>esp<font color="#808080">(</font>tAutor<font color="#808080">.</font>autor<font color="#808080">,</font><font color="#FF0000">30</font><font color="#808080">);
</font><font color="#000080"><b>else if </b></font><font color="#808080">(</font>sreg<font color="#808080">==</font>ctArqs<font color="#808080">.</font>opEditora<font color="#808080">)
   </font>slinha <font color="#808080">= </font>esp<font color="#808080">(</font>tEditora<font color="#808080">.</font>codigo<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">)+</font>esp<font color="#808080">(</font>tEditora<font color="#808080">.</font>editora<font color="#808080">,</font><font color="#FF0000">50</font><font color="#808080">);
</font><font color="#000080"><b>else if </b></font><font color="#808080">(</font>sreg<font color="#808080">==</font>ctArqs<font color="#808080">.</font>opEndereco<font color="#808080">)
   </font>slinha <font color="#808080">= </font>esp<font color="#808080">(</font>tEndereco<font color="#808080">.</font>codigo<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">)+</font>esp<font color="#808080">(</font>tEndereco<font color="#808080">.</font>logradouro<font color="#808080">,</font><font color="#FF0000">40</font><font color="#808080">)+
   </font>esp<font color="#808080">(</font>tEndereco<font color="#808080">.</font>bairro<font color="#808080">,</font><font color="#FF0000">15</font><font color="#808080">)+</font>esp<font color="#808080">(</font>tEndereco<font color="#808080">.</font>cep<font color="#808080">,</font><font color="#FF0000">8</font><font color="#808080">)+</font>esp<font color="#808080">(</font>tEndereco<font color="#808080">.</font>cidade<font color="#808080">,</font><font color="#FF0000">30</font><font color="#808080">)+
   </font>esp<font color="#808080">(</font>tEndereco<font color="#808080">.</font>estado<font color="#808080">,</font><font color="#FF0000">20</font><font color="#808080">);
</font><font color="#000080"><b>else if </b></font><font color="#808080">(</font>sreg<font color="#808080">==</font>ctArqs<font color="#808080">.</font>opIdioma<font color="#808080">)
   </font>slinha <font color="#808080">= </font>esp<font color="#808080">(</font>tIdioma<font color="#808080">.</font>codigo<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">)+</font>esp<font color="#808080">(</font>tIdioma<font color="#808080">.</font>idioma<font color="#808080">,</font><font color="#FF0000">20</font><font color="#808080">);
</font><font color="#000080"><b>else if </b></font><font color="#808080">(</font>sreg<font color="#808080">==</font>ctArqs<font color="#808080">.</font>opPais<font color="#808080">)
   </font>slinha <font color="#808080">= </font>esp<font color="#808080">(</font>tPais<font color="#808080">.</font>codigo<font color="#808080">,</font><font color="#FF0000">3</font><font color="#808080">)+</font>esp<font color="#808080">(</font>tPais<font color="#808080">.</font>pais<font color="#808080">,</font><font color="#FF0000">50</font><font color="#808080">);
</font><font color="#000080"><b>else if </b></font><font color="#808080">(</font>sreg<font color="#808080">==</font>ctArqs<font color="#808080">.</font>opProfissao<font color="#808080">)
   </font>slinha <font color="#808080">= </font>esp<font color="#808080">(</font>tProfissao<font color="#808080">.</font>codigo<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">)+</font>esp<font color="#808080">(</font>tProfissao<font color="#808080">.</font>profissao<font color="#808080">,</font><font color="#FF0000">50</font><font color="#808080">);
</font><font color="#000080"><b>else if </b></font><font color="#808080">(</font>sreg<font color="#808080">==</font>ctArqs<font color="#808080">.</font>opUsuario<font color="#808080">)
   </font>slinha <font color="#808080">= </font>esp<font color="#808080">(</font>tUsuario<font color="#808080">.</font>login<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">)+</font>esp<font color="#808080">(</font>tUsuario<font color="#808080">.</font>senha<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">);
</font><font color="#000080"><b>else if </b></font><font color="#808080">(</font>sreg<font color="#808080">==</font>ctArqs<font color="#808080">.</font>opLivro<font color="#808080">)
   </font>slinha <font color="#808080">= </font>esp<font color="#808080">(</font>tLivro<font color="#808080">.</font>isbn<font color="#808080">,</font><font color="#FF0000">13</font><font color="#808080">)+</font>esp<font color="#808080">(</font>tLivro<font color="#808080">.</font>titulo<font color="#808080">,</font><font color="#FF0000">50</font><font color="#808080">)+
   </font>esp<font color="#808080">(</font>tLivro<font color="#808080">.</font>edicao<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">)+</font>esp<font color="#808080">(</font>tLivro<font color="#808080">.</font>anopubli<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">)+</font>esp<font color="#808080">(</font>tLivro<font color="#808080">.</font>codeditora<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">)+
   </font>esp<font color="#808080">(</font>tLivro<font color="#808080">.</font>volume<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">)+</font>esp<font color="#808080">(</font>tLivro<font color="#808080">.</font>codidioma<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">)+</font>esp<font color="#808080">(</font>tLivro<font color="#808080">.</font>npaginas<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">)+
   </font>esp<font color="#808080">(</font>tLivro<font color="#808080">.</font>preco<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">)+</font>esp<font color="#808080">(</font>tLivro<font color="#808080">.</font>qtdestoque<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">);
</font><font color="#000080"><b>else if </b></font><font color="#808080">(</font>sreg<font color="#808080">==</font>ctArqs<font color="#808080">.</font>opLivroAss<font color="#808080">)
   </font>slinha <font color="#808080">= </font>esp<font color="#808080">(</font>tLivroAss<font color="#808080">.</font>isbn<font color="#808080">,</font><font color="#FF0000">13</font><font color="#808080">)+</font>esp<font color="#808080">(</font>tLivroAss<font color="#808080">.</font>codassunto<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">);
</font><font color="#000080"><b>else if </b></font><font color="#808080">(</font>sreg<font color="#808080">==</font>ctArqs<font color="#808080">.</font>opLivroAut<font color="#808080">)
   </font>slinha <font color="#808080">= </font>esp<font color="#808080">(</font>tLivroAut<font color="#808080">.</font>isbn<font color="#808080">,</font><font color="#FF0000">13</font><font color="#808080">)+</font>esp<font color="#808080">(</font>tLivroAut<font color="#808080">.</font>codautor<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">);
</font><font color="#000080"><b>else if </b></font><font color="#808080">(</font>sreg<font color="#808080">==</font>ctArqs<font color="#808080">.</font>opCliente<font color="#808080">)
   </font>slinha <font color="#808080">= </font>esp<font color="#808080">(</font>tCliente<font color="#808080">.</font>cpf<font color="#808080">,</font><font color="#FF0000">14</font><font color="#808080">)+</font>esp<font color="#808080">(</font>tCliente<font color="#808080">.</font>nome<font color="#808080">,</font><font color="#FF0000">30</font><font color="#808080">)+
   </font>esp<font color="#808080">(</font>tCliente<font color="#808080">.</font>email<font color="#808080">,</font><font color="#FF0000">30</font><font color="#808080">)+</font>esp<font color="#808080">(</font>tCliente<font color="#808080">.</font>identidade<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">)+</font>esp<font color="#808080">(</font>tCliente<font color="#808080">.</font>sexo<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">)+
   </font>esp<font color="#808080">(</font>tCliente<font color="#808080">.</font>telefone<font color="#808080">,</font><font color="#FF0000">17</font><font color="#808080">)+</font>esp<font color="#808080">(</font>tCliente<font color="#808080">.</font>dtnascimento<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">)+
   </font>esp<font color="#808080">(</font>tCliente<font color="#808080">.</font>codendereco<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">)+</font>esp<font color="#808080">(</font>tCliente<font color="#808080">.</font>codpais<font color="#808080">,</font><font color="#FF0000">3</font><font color="#808080">)+
   </font>esp<font color="#808080">(</font>tCliente<font color="#808080">.</font>codprofissao<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">);
</font><font color="#000080"><b>else if </b></font><font color="#808080">(</font>sreg<font color="#808080">==</font>ctArqs<font color="#808080">.</font>opVenda<font color="#808080">)
   </font>slinha <font color="#808080">= </font>esp<font color="#808080">(</font>tVenda<font color="#808080">.</font>dthrvenda<font color="#808080">,</font><font color="#FF0000">19</font><font color="#808080">)+</font>esp<font color="#808080">(</font>tVenda<font color="#808080">.</font>cpf<font color="#808080">,</font><font color="#FF0000">14</font><font color="#808080">)+
   </font>esp<font color="#808080">(</font>tVenda<font color="#808080">.</font>isbn<font color="#808080">,</font><font color="#FF0000">13</font><font color="#808080">)+</font>esp<font color="#808080">(</font>tVenda<font color="#808080">.</font>precovenda<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">);

</font><font color="#000080"><b>return</b></font><font color="#808080">(</font>slinha<font color="#808080">);
}
<i>/*------------------------------------------------------------------------------
Retorna o tamanho do registro no arquivo de acordo com o tipo de arquivo.
sreg - o tipo de arquivo
retorna - o tamanho do registro
------------------------------------------------------------------------------*/
</i></font><font color="#0000FF"><b>int </b></font>tamReg<font color="#808080">(</font>ctArqs sreg<font color="#808080">)
{ </font><font color="#0000FF"><b>int </b></font>nret <font color="#808080">= </font><font color="#FF0000">0</font><font color="#808080">;

</font><font color="#000080"><b>if </b></font><font color="#808080">(</font>sreg<font color="#808080">==</font>ctArqs<font color="#808080">.</font>opAssunto<font color="#808080">) </font>nret <font color="#808080">= </font>TAM_ASSUNTO<font color="#808080">;
</font><font color="#000080"><b>else if </b></font><font color="#808080">(</font>sreg<font color="#808080">==</font>ctArqs<font color="#808080">.</font>opAutor<font color="#808080">) </font>nret <font color="#808080">= </font>TAM_AUTOR<font color="#808080">;
</font><font color="#000080"><b>else if </b></font><font color="#808080">(</font>sreg<font color="#808080">==</font>ctArqs<font color="#808080">.</font>opEditora<font color="#808080">) </font>nret <font color="#808080">= </font>TAM_EDITORA<font color="#808080">;
</font><font color="#000080"><b>else if </b></font><font color="#808080">(</font>sreg<font color="#808080">==</font>ctArqs<font color="#808080">.</font>opEndereco<font color="#808080">) </font>nret <font color="#808080">= </font>TAM_ENDERECO<font color="#808080">;
</font><font color="#000080"><b>else if </b></font><font color="#808080">(</font>sreg<font color="#808080">==</font>ctArqs<font color="#808080">.</font>opIdioma<font color="#808080">) </font>nret <font color="#808080">= </font>TAM_IDIOMA<font color="#808080">;
</font><font color="#000080"><b>else if </b></font><font color="#808080">(</font>sreg<font color="#808080">==</font>ctArqs<font color="#808080">.</font>opPais<font color="#808080">) </font>nret <font color="#808080">= </font>TAM_PAIS<font color="#808080">;
</font><font color="#000080"><b>else if </b></font><font color="#808080">(</font>sreg<font color="#808080">==</font>ctArqs<font color="#808080">.</font>opProfissao<font color="#808080">) </font>nret <font color="#808080">= </font>TAM_PROFISSAO<font color="#808080">;
</font><font color="#000080"><b>else if </b></font><font color="#808080">(</font>sreg<font color="#808080">==</font>ctArqs<font color="#808080">.</font>opUsuario<font color="#808080">) </font>nret <font color="#808080">= </font>TAM_USUARIO<font color="#808080">;
</font><font color="#000080"><b>else if </b></font><font color="#808080">(</font>sreg<font color="#808080">==</font>ctArqs<font color="#808080">.</font>opLivro<font color="#808080">) </font>nret <font color="#808080">= </font>TAM_LIVRO<font color="#808080">;
</font><font color="#000080"><b>else if </b></font><font color="#808080">(</font>sreg<font color="#808080">==</font>ctArqs<font color="#808080">.</font>opLivroAss<font color="#808080">) </font>nret <font color="#808080">= </font>TAM_LIVASS<font color="#808080">;
</font><font color="#000080"><b>else if </b></font><font color="#808080">(</font>sreg<font color="#808080">==</font>ctArqs<font color="#808080">.</font>opLivroAut<font color="#808080">) </font>nret <font color="#808080">= </font>TAM_LIVAUT<font color="#808080">;
</font><font color="#000080"><b>else if </b></font><font color="#808080">(</font>sreg<font color="#808080">==</font>ctArqs<font color="#808080">.</font>opCliente<font color="#808080">) </font>nret <font color="#808080">= </font>TAM_CLIENTE<font color="#808080">;
</font><font color="#000080"><b>else if </b></font><font color="#808080">(</font>sreg<font color="#808080">==</font>ctArqs<font color="#808080">.</font>opVenda<font color="#808080">) </font>nret <font color="#808080">= </font>TAM_VENDA<font color="#808080">;

</font><font color="#000080"><b>return</b></font><font color="#808080">(</font>nret<font color="#808080">);
}
<i>/*------------------------------------------------------------------------------
Seleciona o rotulo de cada campo de acordo com o tipo de arquivo.
sreg - o tipo de arquivo
nNum - indica qual rotulo ser&aacute; retornado
retorna - o rotulo
------------------------------------------------------------------------------*/
</i></font><font color="#0000FF"><b>string </b></font>rotulo<font color="#808080">(</font>ctArqs sreg<font color="#808080">, </font><font color="#0000FF"><b>int </b></font>nNum<font color="#808080">)
{  </font><font color="#0000FF"><b>string </b></font>sret <font color="#808080">= </font><font color="#800000">&quot;&quot;</font><font color="#808080">;

</font><font color="#000080"><b>if </b></font><font color="#808080">(</font>sreg<font color="#808080">==</font>ctArqs<font color="#808080">.</font>opAssunto<font color="#808080">) {
   </font><font color="#000080"><b>switch</b></font><font color="#808080">(</font>nNum<font color="#808080">) {
</font>	 <font color="#000080"><b>case </b></font><font color="#FF0000">0</font><font color="#808080">: </font>sret <font color="#808080">= </font><font color="#800000">&quot;Assunto(s) n&atilde;o encontrado(s)!&quot;</font><font color="#808080">; </font><font color="#000080"><b>break</b></font><font color="#808080">;
</font>	 <font color="#000080"><b>case </b></font><font color="#FF0000">1</font><font color="#808080">: {
</font>		 sret <font color="#808080">= </font><font color="#800000">&quot;C&oacute;digo do assunto: &quot;</font><font color="#808080">;
</font>		 g_nPosChave <font color="#808080">= </font><font color="#FF0000">1</font><font color="#808080">;
</font>		 g_nTamChave <font color="#808080">= </font><font color="#FF0000">10</font><font color="#808080">;
</font>		<font color="#808080">} </font><font color="#000080"><b>break</b></font><font color="#808080">;
</font>	 <font color="#000080"><b>case </b></font><font color="#FF0000">2</font><font color="#808080">: {
</font>		 sret <font color="#808080">= </font><font color="#800000">&quot;Assunto: &quot;</font><font color="#808080">;
</font>		 g_nPosChave <font color="#808080">= </font><font color="#FF0000">11</font><font color="#808080">;
</font>		 g_nTamChave <font color="#808080">= </font><font color="#FF0000">30</font><font color="#808080">;
</font>		<font color="#808080">} </font><font color="#000080"><b>break</b></font><font color="#808080">;
   }
} </font><font color="#000080"><b>else if </b></font><font color="#808080">(</font>sreg<font color="#808080">==</font>ctArqs<font color="#808080">.</font>opAutor<font color="#808080">) {
   </font><font color="#000080"><b>switch</b></font><font color="#808080">(</font>nNum<font color="#808080">) {
</font>	 <font color="#000080"><b>case </b></font><font color="#FF0000">0</font><font color="#808080">: </font>sret <font color="#808080">= </font><font color="#800000">&quot;Autor(es) n&atilde;o encontrado(s)!&quot;</font><font color="#808080">; </font><font color="#000080"><b>break</b></font><font color="#808080">;
</font>	 <font color="#000080"><b>case </b></font><font color="#FF0000">1</font><font color="#808080">: {
</font>		 sret <font color="#808080">= </font><font color="#800000">&quot;C&oacute;digo do autor: &quot;</font><font color="#808080">;
</font>		 g_nPosChave <font color="#808080">= </font><font color="#FF0000">1</font><font color="#808080">;
</font>		 g_nTamChave <font color="#808080">= </font><font color="#FF0000">10</font><font color="#808080">;
</font>		<font color="#808080">} </font><font color="#000080"><b>break</b></font><font color="#808080">;
</font>	 <font color="#000080"><b>case </b></font><font color="#FF0000">2</font><font color="#808080">: {
</font>		 sret <font color="#808080">= </font><font color="#800000">&quot;Autor: &quot;</font><font color="#808080">;
</font>		 g_nPosChave <font color="#808080">= </font><font color="#FF0000">11</font><font color="#808080">;
</font>		 g_nTamChave <font color="#808080">= </font><font color="#FF0000">30</font><font color="#808080">;
</font>		<font color="#808080">} </font><font color="#000080"><b>break</b></font><font color="#808080">;
   }
} </font><font color="#000080"><b>else if </b></font><font color="#808080">(</font>sreg<font color="#808080">==</font>ctArqs<font color="#808080">.</font>opEditora<font color="#808080">) {
   </font><font color="#000080"><b>switch</b></font><font color="#808080">(</font>nNum<font color="#808080">) {
</font>	 <font color="#000080"><b>case </b></font><font color="#FF0000">0</font><font color="#808080">: </font>sret <font color="#808080">= </font><font color="#800000">&quot;Editora(s) n&atilde;o encontrada(s)!&quot;</font><font color="#808080">; </font><font color="#000080"><b>break</b></font><font color="#808080">;
</font>	 <font color="#000080"><b>case </b></font><font color="#FF0000">1</font><font color="#808080">: {
</font>		 sret <font color="#808080">= </font><font color="#800000">&quot;C&oacute;digo da editora: &quot;</font><font color="#808080">;
</font>		 g_nPosChave <font color="#808080">= </font><font color="#FF0000">1</font><font color="#808080">;
</font>		 g_nTamChave <font color="#808080">= </font><font color="#FF0000">10</font><font color="#808080">;
</font>		<font color="#808080">} </font><font color="#000080"><b>break</b></font><font color="#808080">;
</font>	 <font color="#000080"><b>case </b></font><font color="#FF0000">2</font><font color="#808080">: {
</font>		 sret <font color="#808080">= </font><font color="#800000">&quot;Editora: &quot;</font><font color="#808080">;
</font>		 g_nPosChave <font color="#808080">= </font><font color="#FF0000">11</font><font color="#808080">;
</font>		 g_nTamChave <font color="#808080">= </font><font color="#FF0000">50</font><font color="#808080">;
</font>		<font color="#808080">} </font><font color="#000080"><b>break</b></font><font color="#808080">;
   }
} </font><font color="#000080"><b>else if </b></font><font color="#808080">(</font>sreg<font color="#808080">==</font>ctArqs<font color="#808080">.</font>opEndereco<font color="#808080">) {
   </font><font color="#000080"><b>switch</b></font><font color="#808080">(</font>nNum<font color="#808080">) {
     </font><font color="#000080"><b>case </b></font><font color="#FF0000">0</font><font color="#808080">: </font>sret <font color="#808080">= </font><font color="#800000">&quot;Endere&ccedil;o(s) n&atilde;o encontrado(s)!&quot;</font><font color="#808080">; </font><font color="#000080"><b>break</b></font><font color="#808080">;
     </font><font color="#000080"><b>case </b></font><font color="#FF0000">1</font><font color="#808080">: {
         </font>sret <font color="#808080">= </font><font color="#800000">&quot;C&oacute;digo do endere&ccedil;o: &quot;</font><font color="#808080">;
         </font>g_nPosChave <font color="#808080">= </font><font color="#FF0000">1</font><font color="#808080">;
</font>		 g_nTamChave <font color="#808080">= </font><font color="#FF0000">10</font><font color="#808080">;
        } </font><font color="#000080"><b>break</b></font><font color="#808080">;
     </font><font color="#000080"><b>case </b></font><font color="#FF0000">2</font><font color="#808080">: {
         </font>sret <font color="#808080">= </font><font color="#800000">&quot;Logradouro: &quot;</font><font color="#808080">;
         </font>g_nPosChave <font color="#808080">= </font><font color="#FF0000">11</font><font color="#808080">;
</font>		 g_nTamChave <font color="#808080">= </font><font color="#FF0000">40</font><font color="#808080">;
        } </font><font color="#000080"><b>break</b></font><font color="#808080">;
     </font><font color="#000080"><b>case </b></font><font color="#FF0000">3</font><font color="#808080">: {
         </font>sret <font color="#808080">= </font><font color="#800000">&quot;Bairro: &quot;</font><font color="#808080">;
         </font>g_nPosChave <font color="#808080">= </font><font color="#FF0000">51</font><font color="#808080">;
</font>		 g_nTamChave <font color="#808080">= </font><font color="#FF0000">15</font><font color="#808080">;
</font>		<font color="#808080">} </font><font color="#000080"><b>break</b></font><font color="#808080">;
     </font><font color="#000080"><b>case </b></font><font color="#FF0000">4</font><font color="#808080">: {
         </font>sret <font color="#808080">= </font><font color="#800000">&quot;CEP: &quot;</font><font color="#808080">;
         </font>g_nPosChave <font color="#808080">= </font><font color="#FF0000">66</font><font color="#808080">;
         </font>g_nTamChave <font color="#808080">= </font><font color="#FF0000">8</font><font color="#808080">;
        } </font><font color="#000080"><b>break</b></font><font color="#808080">;
     </font><font color="#000080"><b>case </b></font><font color="#FF0000">5</font><font color="#808080">: {
         </font>sret <font color="#808080">= </font><font color="#800000">&quot;Cidade: &quot;</font><font color="#808080">;
         </font>g_nPosChave <font color="#808080">= </font><font color="#FF0000">74</font><font color="#808080">;
         </font>g_nTamChave <font color="#808080">= </font><font color="#FF0000">30</font><font color="#808080">;
</font>		<font color="#808080">} </font><font color="#000080"><b>break</b></font><font color="#808080">;
</font>	 <font color="#000080"><b>case </b></font><font color="#FF0000">6</font><font color="#808080">: {
         </font>sret <font color="#808080">= </font><font color="#800000">&quot;Estado: &quot;</font><font color="#808080">;
         </font>g_nPosChave <font color="#808080">= </font><font color="#FF0000">104</font><font color="#808080">;
         </font>g_nTamChave <font color="#808080">= </font><font color="#FF0000">20</font><font color="#808080">;
        } </font><font color="#000080"><b>break</b></font><font color="#808080">;
   }
} </font><font color="#000080"><b>else if </b></font><font color="#808080">(</font>sreg<font color="#808080">==</font>ctArqs<font color="#808080">.</font>opIdioma<font color="#808080">) {
   </font><font color="#000080"><b>switch</b></font><font color="#808080">(</font>nNum<font color="#808080">) {
</font>	 <font color="#000080"><b>case </b></font><font color="#FF0000">0</font><font color="#808080">: </font>sret <font color="#808080">= </font><font color="#800000">&quot;Idioma(s) n&atilde;o encontrado(s)!&quot;</font><font color="#808080">; </font><font color="#000080"><b>break</b></font><font color="#808080">;
</font>	 <font color="#000080"><b>case </b></font><font color="#FF0000">1</font><font color="#808080">: {
</font>		 sret <font color="#808080">= </font><font color="#800000">&quot;C&oacute;digo do idioma: &quot;</font><font color="#808080">;
</font>		 g_nPosChave <font color="#808080">= </font><font color="#FF0000">1</font><font color="#808080">;
</font>		 g_nTamChave <font color="#808080">= </font><font color="#FF0000">10</font><font color="#808080">;
</font>		<font color="#808080">} </font><font color="#000080"><b>break</b></font><font color="#808080">;
</font>	 <font color="#000080"><b>case </b></font><font color="#FF0000">2</font><font color="#808080">: {
</font>		 sret <font color="#808080">= </font><font color="#800000">&quot;Idioma: &quot;</font><font color="#808080">;
</font>		 g_nPosChave <font color="#808080">= </font><font color="#FF0000">11</font><font color="#808080">;
</font>		 g_nTamChave <font color="#808080">= </font><font color="#FF0000">20</font><font color="#808080">;
</font>		<font color="#808080">} </font><font color="#000080"><b>break</b></font><font color="#808080">;
   }
} </font><font color="#000080"><b>else if </b></font><font color="#808080">(</font>sreg<font color="#808080">==</font>ctArqs<font color="#808080">.</font>opPais<font color="#808080">) {
   </font><font color="#000080"><b>switch</b></font><font color="#808080">(</font>nNum<font color="#808080">) {
</font>	 <font color="#000080"><b>case </b></font><font color="#FF0000">0</font><font color="#808080">: </font>sret <font color="#808080">= </font><font color="#800000">&quot;Pa&iacute;s(es) n&atilde;o encontrado(s)!&quot;</font><font color="#808080">; </font><font color="#000080"><b>break</b></font><font color="#808080">;
</font>	 <font color="#000080"><b>case </b></font><font color="#FF0000">1</font><font color="#808080">: {
</font>		 sret <font color="#808080">= </font><font color="#800000">&quot;C&oacute;digo do pa&iacute;s: &quot;</font><font color="#808080">;
</font>		 g_nPosChave <font color="#808080">= </font><font color="#FF0000">1</font><font color="#808080">;
</font>		 g_nTamChave <font color="#808080">= </font><font color="#FF0000">3</font><font color="#808080">;
</font>		<font color="#808080">} </font><font color="#000080"><b>break</b></font><font color="#808080">;
</font>	 <font color="#000080"><b>case </b></font><font color="#FF0000">2</font><font color="#808080">: {
</font>		 sret <font color="#808080">= </font><font color="#800000">&quot;Pa&iacute;s: &quot;</font><font color="#808080">;
</font>		 g_nPosChave <font color="#808080">= </font><font color="#FF0000">4</font><font color="#808080">;
</font>		 g_nTamChave <font color="#808080">= </font><font color="#FF0000">50</font><font color="#808080">;
</font>		<font color="#808080">} </font><font color="#000080"><b>break</b></font><font color="#808080">;
   }
} </font><font color="#000080"><b>else if </b></font><font color="#808080">(</font>sreg<font color="#808080">==</font>ctArqs<font color="#808080">.</font>opProfissao<font color="#808080">) {
   </font><font color="#000080"><b>switch</b></font><font color="#808080">(</font>nNum<font color="#808080">) {
</font>	 <font color="#000080"><b>case </b></font><font color="#FF0000">0</font><font color="#808080">: </font>sret <font color="#808080">= </font><font color="#800000">&quot;Profiss&atilde;o(es) n&atilde;o encontrada(s)!&quot;</font><font color="#808080">; </font><font color="#000080"><b>break</b></font><font color="#808080">;
</font>	 <font color="#000080"><b>case </b></font><font color="#FF0000">1</font><font color="#808080">: {
</font>		 sret <font color="#808080">= </font><font color="#800000">&quot;C&oacute;digo da profiss&atilde;o: &quot;</font><font color="#808080">;
</font>		 g_nPosChave <font color="#808080">= </font><font color="#FF0000">1</font><font color="#808080">;
</font>		 g_nTamChave <font color="#808080">= </font><font color="#FF0000">10</font><font color="#808080">;
</font>		<font color="#808080">} </font><font color="#000080"><b>break</b></font><font color="#808080">;
</font>	 <font color="#000080"><b>case </b></font><font color="#FF0000">2</font><font color="#808080">: {
</font>		 sret <font color="#808080">= </font><font color="#800000">&quot;Profiss&atilde;o: &quot;</font><font color="#808080">;
</font>		 g_nPosChave <font color="#808080">= </font><font color="#FF0000">11</font><font color="#808080">;
</font>		 g_nTamChave <font color="#808080">= </font><font color="#FF0000">50</font><font color="#808080">;
</font>		<font color="#808080">} </font><font color="#000080"><b>break</b></font><font color="#808080">;
   }
} </font><font color="#000080"><b>else if </b></font><font color="#808080">(</font>sreg<font color="#808080">==</font>ctArqs<font color="#808080">.</font>opUsuario<font color="#808080">) {
   </font><font color="#000080"><b>switch</b></font><font color="#808080">(</font>nNum<font color="#808080">) {
</font>	 <font color="#000080"><b>case </b></font><font color="#FF0000">0</font><font color="#808080">: </font>sret <font color="#808080">= </font><font color="#800000">&quot;login ou senha incorreta, tente de novo!&quot;</font><font color="#808080">; </font><font color="#000080"><b>break</b></font><font color="#808080">;
</font>	 <font color="#000080"><b>case </b></font><font color="#FF0000">1</font><font color="#808080">: {
</font>		 sret <font color="#808080">= </font><font color="#800000">&quot;Login: &quot;</font><font color="#808080">;
</font>		 g_nPosChave <font color="#808080">= </font><font color="#FF0000">1</font><font color="#808080">;
</font>		 g_nTamChave <font color="#808080">= </font><font color="#FF0000">10</font><font color="#808080">;
</font>		<font color="#808080">} </font><font color="#000080"><b>break</b></font><font color="#808080">;
</font>	 <font color="#000080"><b>case </b></font><font color="#FF0000">2</font><font color="#808080">: {
</font>		 sret <font color="#808080">= </font><font color="#800000">&quot;Senha: &quot;</font><font color="#808080">;
</font>		 g_nPosChave <font color="#808080">= </font><font color="#FF0000">11</font><font color="#808080">;
</font>		 g_nTamChave <font color="#808080">= </font><font color="#FF0000">10</font><font color="#808080">;
</font>		<font color="#808080">} </font><font color="#000080"><b>break</b></font><font color="#808080">;
   }
} </font><font color="#000080"><b>else if </b></font><font color="#808080">(</font>sreg<font color="#808080">==</font>ctArqs<font color="#808080">.</font>opLivro<font color="#808080">) {
   </font><font color="#000080"><b>switch</b></font><font color="#808080">(</font>nNum<font color="#808080">) {
</font>	 <font color="#000080"><b>case </b></font><font color="#FF0000">0</font><font color="#808080">: </font>sret <font color="#808080">= </font><font color="#800000">&quot;Livro(s) n&atilde;o encontrado(s)!&quot;</font><font color="#808080">; </font><font color="#000080"><b>break</b></font><font color="#808080">;
</font>	 <font color="#000080"><b>case </b></font><font color="#FF0000">1</font><font color="#808080">: {
</font>		 sret <font color="#808080">= </font><font color="#800000">&quot;ISBN: &quot;</font><font color="#808080">;
</font>		 g_nPosChave <font color="#808080">= </font><font color="#FF0000">1</font><font color="#808080">;
</font>		 g_nTamChave <font color="#808080">= </font><font color="#FF0000">13</font><font color="#808080">;
</font>		<font color="#808080">} </font><font color="#000080"><b>break</b></font><font color="#808080">;
</font>	 <font color="#000080"><b>case </b></font><font color="#FF0000">2</font><font color="#808080">: {
</font>		 sret <font color="#808080">= </font><font color="#800000">&quot;T&iacute;tulo: &quot;</font><font color="#808080">;
</font>		 g_nPosChave <font color="#808080">= </font><font color="#FF0000">14</font><font color="#808080">;
</font>		 g_nTamChave <font color="#808080">= </font><font color="#FF0000">50</font><font color="#808080">;
</font>		<font color="#808080">} </font><font color="#000080"><b>break</b></font><font color="#808080">;
</font>	 <font color="#000080"><b>case </b></font><font color="#FF0000">3</font><font color="#808080">: {
</font>		 sret <font color="#808080">= </font><font color="#800000">&quot;Edi&ccedil;&atilde;o: &quot;</font><font color="#808080">;
</font>		 g_nPosChave <font color="#808080">= </font><font color="#FF0000">64</font><font color="#808080">;
</font>		 g_nTamChave <font color="#808080">= </font><font color="#FF0000">10</font><font color="#808080">;
</font>		<font color="#808080">} </font><font color="#000080"><b>break</b></font><font color="#808080">;
</font>	 <font color="#000080"><b>case </b></font><font color="#FF0000">4</font><font color="#808080">: {
</font>		 sret <font color="#808080">= </font><font color="#800000">&quot;Ano de Publica&ccedil;&atilde;o: &quot;</font><font color="#808080">;
</font>		 g_nPosChave <font color="#808080">= </font><font color="#FF0000">74</font><font color="#808080">;
</font>		 g_nTamChave <font color="#808080">= </font><font color="#FF0000">10</font><font color="#808080">;
</font>		<font color="#808080">} </font><font color="#000080"><b>break</b></font><font color="#808080">;
     </font><font color="#000080"><b>case </b></font><font color="#FF0000">5</font><font color="#808080">: {
         </font>sret <font color="#808080">= </font><font color="#800000">&quot;C&oacute;digo da editora: &quot;</font><font color="#808080">;
         </font>g_nPosChave <font color="#808080">= </font><font color="#FF0000">84</font><font color="#808080">;
         </font>g_nTamChave <font color="#808080">= </font><font color="#FF0000">10</font><font color="#808080">;
        } </font><font color="#000080"><b>break</b></font><font color="#808080">;
</font>	 <font color="#000080"><b>case </b></font><font color="#FF0000">6</font><font color="#808080">: {
         </font>sret <font color="#808080">= </font><font color="#800000">&quot;Volume: &quot;</font><font color="#808080">;
         </font>g_nPosChave <font color="#808080">= </font><font color="#FF0000">94</font><font color="#808080">;
         </font>g_nTamChave <font color="#808080">= </font><font color="#FF0000">10</font><font color="#808080">;
        } </font><font color="#000080"><b>break</b></font><font color="#808080">;
</font>	 <font color="#000080"><b>case </b></font><font color="#FF0000">7</font><font color="#808080">: {
         </font>sret <font color="#808080">= </font><font color="#800000">&quot;C&oacute;digo do idioma: &quot;</font><font color="#808080">;
         </font>g_nPosChave <font color="#808080">= </font><font color="#FF0000">104</font><font color="#808080">;
         </font>g_nTamChave <font color="#808080">= </font><font color="#FF0000">10</font><font color="#808080">;
        } </font><font color="#000080"><b>break</b></font><font color="#808080">;
</font>	 <font color="#000080"><b>case </b></font><font color="#FF0000">8</font><font color="#808080">: {
</font>		 sret <font color="#808080">= </font><font color="#800000">&quot;N&uacute;mero de p&aacute;ginas: &quot;</font><font color="#808080">;
         </font>g_nPosChave <font color="#808080">= </font><font color="#FF0000">114</font><font color="#808080">;
         </font>g_nTamChave <font color="#808080">= </font><font color="#FF0000">10</font><font color="#808080">;
        } </font><font color="#000080"><b>break</b></font><font color="#808080">;
     </font><font color="#000080"><b>case </b></font><font color="#FF0000">9</font><font color="#808080">: {
         </font>sret <font color="#808080">= </font><font color="#800000">&quot;Pre&ccedil;o: &quot;</font><font color="#808080">;
         </font>g_nPosChave <font color="#808080">= </font><font color="#FF0000">124</font><font color="#808080">;
         </font>g_nTamChave <font color="#808080">= </font><font color="#FF0000">10</font><font color="#808080">;
        } </font><font color="#000080"><b>break</b></font><font color="#808080">;
     </font><font color="#000080"><b>case </b></font><font color="#FF0000">10</font><font color="#808080">: {
          </font>sret <font color="#808080">= </font><font color="#800000">&quot;Qtd. Estoque: &quot;</font><font color="#808080">;
          </font>g_nPosChave <font color="#808080">= </font><font color="#FF0000">134</font><font color="#808080">;
          </font>g_nTamChave <font color="#808080">= </font><font color="#FF0000">10</font><font color="#808080">;
         } </font><font color="#000080"><b>break</b></font><font color="#808080">;
   }
} </font><font color="#000080"><b>else if </b></font><font color="#808080">(</font>sreg<font color="#808080">==</font>ctArqs<font color="#808080">.</font>opLivroAss<font color="#808080">) {
   </font><font color="#000080"><b>switch</b></font><font color="#808080">(</font>nNum<font color="#808080">) {
</font>	 <font color="#000080"><b>case </b></font><font color="#FF0000">0</font><font color="#808080">: </font>sret <font color="#808080">= </font><font color="#800000">&quot;Assunto(s) n&atilde;o encontrado(s)!&quot;</font><font color="#808080">; </font><font color="#000080"><b>break</b></font><font color="#808080">;
</font>	 <font color="#000080"><b>case </b></font><font color="#FF0000">1</font><font color="#808080">: {
</font>		 sret <font color="#808080">= </font><font color="#800000">&quot;ISBN: &quot;</font><font color="#808080">;
</font>		 g_nPosChave <font color="#808080">= </font><font color="#FF0000">1</font><font color="#808080">;
</font>		 g_nTamChave <font color="#808080">= </font><font color="#FF0000">13</font><font color="#808080">;
</font>		<font color="#808080">} </font><font color="#000080"><b>break</b></font><font color="#808080">;
</font>	 <font color="#000080"><b>case </b></font><font color="#FF0000">2</font><font color="#808080">: {
</font>		 sret <font color="#808080">= </font><font color="#800000">&quot;C&oacute;digo do assunto: &quot;</font><font color="#808080">;
</font>		 g_nPosChave <font color="#808080">= </font><font color="#FF0000">14</font><font color="#808080">;
</font>		 g_nTamChave <font color="#808080">= </font><font color="#FF0000">10</font><font color="#808080">;
</font>		<font color="#808080">} </font><font color="#000080"><b>break</b></font><font color="#808080">;
   }
} </font><font color="#000080"><b>else if </b></font><font color="#808080">(</font>sreg<font color="#808080">==</font>ctArqs<font color="#808080">.</font>opLivroAut<font color="#808080">) {
   </font><font color="#000080"><b>switch</b></font><font color="#808080">(</font>nNum<font color="#808080">) {
     </font><font color="#000080"><b>case </b></font><font color="#FF0000">0</font><font color="#808080">: </font>sret <font color="#808080">= </font><font color="#800000">&quot;Autor(s) n&atilde;o encontrado(s)!&quot;</font><font color="#808080">; </font><font color="#000080"><b>break</b></font><font color="#808080">;
     </font><font color="#000080"><b>case </b></font><font color="#FF0000">1</font><font color="#808080">: {
         </font>sret <font color="#808080">= </font><font color="#800000">&quot;ISBN: &quot;</font><font color="#808080">;
         </font>g_nPosChave <font color="#808080">= </font><font color="#FF0000">1</font><font color="#808080">;
         </font>g_nTamChave <font color="#808080">= </font><font color="#FF0000">13</font><font color="#808080">;
        } </font><font color="#000080"><b>break</b></font><font color="#808080">;
     </font><font color="#000080"><b>case </b></font><font color="#FF0000">2</font><font color="#808080">: {
         </font>sret <font color="#808080">= </font><font color="#800000">&quot;C&oacute;digo do autor: &quot;</font><font color="#808080">;
         </font>g_nPosChave <font color="#808080">= </font><font color="#FF0000">14</font><font color="#808080">;
         </font>g_nTamChave <font color="#808080">= </font><font color="#FF0000">10</font><font color="#808080">;
        } </font><font color="#000080"><b>break</b></font><font color="#808080">;
   }
} </font><font color="#000080"><b>else if </b></font><font color="#808080">(</font>sreg<font color="#808080">==</font>ctArqs<font color="#808080">.</font>opCliente<font color="#808080">) {
   </font><font color="#000080"><b>switch</b></font><font color="#808080">(</font>nNum<font color="#808080">) {
</font>	 <font color="#000080"><b>case </b></font><font color="#FF0000">0</font><font color="#808080">: </font>sret <font color="#808080">= </font><font color="#800000">&quot;Cliente(s) n&atilde;o encontrado(s)!&quot;</font><font color="#808080">; </font><font color="#000080"><b>break</b></font><font color="#808080">;
</font>	 <font color="#000080"><b>case </b></font><font color="#FF0000">1</font><font color="#808080">: {
</font>		 sret <font color="#808080">= </font><font color="#800000">&quot;CPF: &quot;</font><font color="#808080">;
</font>		 g_nPosChave <font color="#808080">= </font><font color="#FF0000">1</font><font color="#808080">;
</font>		 g_nTamChave <font color="#808080">= </font><font color="#FF0000">14</font><font color="#808080">;
</font>		<font color="#808080">} </font><font color="#000080"><b>break</b></font><font color="#808080">;
</font>	 <font color="#000080"><b>case </b></font><font color="#FF0000">2</font><font color="#808080">: {
</font>		 sret <font color="#808080">= </font><font color="#800000">&quot;Nome: &quot;</font><font color="#808080">;
</font>		 g_nPosChave <font color="#808080">= </font><font color="#FF0000">15</font><font color="#808080">;
</font>		 g_nTamChave <font color="#808080">= </font><font color="#FF0000">30</font><font color="#808080">;
</font>		<font color="#808080">} </font><font color="#000080"><b>break</b></font><font color="#808080">;
</font>	 <font color="#000080"><b>case </b></font><font color="#FF0000">3</font><font color="#808080">: {
</font>		 sret <font color="#808080">= </font><font color="#800000">&quot;E-mail: &quot;</font><font color="#808080">;
</font>		 g_nPosChave <font color="#808080">= </font><font color="#FF0000">45</font><font color="#808080">;
         </font>g_nTamChave <font color="#808080">= </font><font color="#FF0000">30</font><font color="#808080">;
        } </font><font color="#000080"><b>break</b></font><font color="#808080">;
     </font><font color="#000080"><b>case </b></font><font color="#FF0000">4</font><font color="#808080">: {
         </font>sret <font color="#808080">= </font><font color="#800000">&quot;Identidade: &quot;</font><font color="#808080">;
         </font>g_nPosChave <font color="#808080">= </font><font color="#FF0000">75</font><font color="#808080">;
         </font>g_nTamChave <font color="#808080">= </font><font color="#FF0000">10</font><font color="#808080">;
        } </font><font color="#000080"><b>break</b></font><font color="#808080">;
     </font><font color="#000080"><b>case </b></font><font color="#FF0000">5</font><font color="#808080">: {
         </font>sret <font color="#808080">= </font><font color="#800000">&quot;Sexo: &quot;</font><font color="#808080">;
         </font>g_nPosChave <font color="#808080">= </font><font color="#FF0000">85</font><font color="#808080">;
         </font>g_nTamChave <font color="#808080">= </font><font color="#FF0000">1</font><font color="#808080">;
        } </font><font color="#000080"><b>break</b></font><font color="#808080">;
</font>	 <font color="#000080"><b>case </b></font><font color="#FF0000">6</font><font color="#808080">: {
         </font>sret <font color="#808080">= </font><font color="#800000">&quot;Telefone: &quot;</font><font color="#808080">;
</font>		 g_nPosChave <font color="#808080">= </font><font color="#FF0000">86</font><font color="#808080">;
         </font>g_nTamChave <font color="#808080">= </font><font color="#FF0000">17</font><font color="#808080">;
        } </font><font color="#000080"><b>break</b></font><font color="#808080">;
     </font><font color="#000080"><b>case </b></font><font color="#FF0000">7</font><font color="#808080">: {
         </font>sret <font color="#808080">= </font><font color="#800000">&quot;Dt. Nascimento: &quot;</font><font color="#808080">;
</font>		 g_nPosChave <font color="#808080">= </font><font color="#FF0000">103</font><font color="#808080">;
         </font>g_nTamChave <font color="#808080">= </font><font color="#FF0000">10</font><font color="#808080">;
        } </font><font color="#000080"><b>break</b></font><font color="#808080">;
     </font><font color="#000080"><b>case </b></font><font color="#FF0000">8</font><font color="#808080">: {
         </font>sret <font color="#808080">= </font><font color="#800000">&quot;C&oacute;digo do endere&ccedil;o: &quot;</font><font color="#808080">;
</font>		 g_nPosChave <font color="#808080">= </font><font color="#FF0000">113</font><font color="#808080">;
</font>		 g_nTamChave <font color="#808080">= </font><font color="#FF0000">10</font><font color="#808080">;
        } </font><font color="#000080"><b>break</b></font><font color="#808080">;
     </font><font color="#000080"><b>case </b></font><font color="#FF0000">9</font><font color="#808080">: {
         </font>sret <font color="#808080">= </font><font color="#800000">&quot;C&oacute;digo do pa&iacute;s: &quot;</font><font color="#808080">;
         </font>g_nPosChave <font color="#808080">= </font><font color="#FF0000">123</font><font color="#808080">;
         </font>g_nTamChave <font color="#808080">= </font><font color="#FF0000">3</font><font color="#808080">;
        } </font><font color="#000080"><b>break</b></font><font color="#808080">;
     </font><font color="#000080"><b>case </b></font><font color="#FF0000">10</font><font color="#808080">: {
          </font>sret <font color="#808080">= </font><font color="#800000">&quot;C&oacute;digo da Profiss&atilde;o: &quot;</font><font color="#808080">;
          </font>g_nPosChave <font color="#808080">= </font><font color="#FF0000">126</font><font color="#808080">;
          </font>g_nTamChave <font color="#808080">= </font><font color="#FF0000">10</font><font color="#808080">;
        } </font><font color="#000080"><b>break</b></font><font color="#808080">;
   }
} </font><font color="#000080"><b>else if </b></font><font color="#808080">(</font>sreg<font color="#808080">==</font>ctArqs<font color="#808080">.</font>opVenda<font color="#808080">) {
   </font><font color="#000080"><b>switch</b></font><font color="#808080">(</font>nNum<font color="#808080">) {
</font>	 <font color="#000080"><b>case </b></font><font color="#FF0000">0</font><font color="#808080">: </font>sret <font color="#808080">= </font><font color="#800000">&quot;Venda(s) n&atilde;o encontrada(s)!&quot;</font><font color="#808080">; </font><font color="#000080"><b>break</b></font><font color="#808080">;
     </font><font color="#000080"><b>case </b></font><font color="#FF0000">1</font><font color="#808080">: {
</font>		 sret <font color="#808080">= </font><font color="#800000">&quot;Data/Hora venda: &quot;</font><font color="#808080">;
         </font>g_nPosChave <font color="#808080">= </font><font color="#FF0000">1</font><font color="#808080">;
         </font>g_nTamChave <font color="#808080">= </font><font color="#FF0000">19</font><font color="#808080">;
        } </font><font color="#000080"><b>break</b></font><font color="#808080">;
     </font><font color="#000080"><b>case </b></font><font color="#FF0000">2</font><font color="#808080">: {
</font>		 sret <font color="#808080">= </font><font color="#800000">&quot;CPF: &quot;</font><font color="#808080">;
         </font>g_nPosChave <font color="#808080">= </font><font color="#FF0000">20</font><font color="#808080">;
         </font>g_nTamChave <font color="#808080">= </font><font color="#FF0000">14</font><font color="#808080">;
        } </font><font color="#000080"><b>break</b></font><font color="#808080">;
     </font><font color="#000080"><b>case </b></font><font color="#FF0000">3</font><font color="#808080">: {
</font>		 sret <font color="#808080">= </font><font color="#800000">&quot;ISBN: &quot;</font><font color="#808080">;
</font>		 g_nPosChave <font color="#808080">= </font><font color="#FF0000">34</font><font color="#808080">;
         </font>g_nTamChave <font color="#808080">= </font><font color="#FF0000">13</font><font color="#808080">;
        } </font><font color="#000080"><b>break</b></font><font color="#808080">;
     </font><font color="#000080"><b>case </b></font><font color="#FF0000">4</font><font color="#808080">: {
         </font>sret <font color="#808080">= </font><font color="#800000">&quot;Pre&ccedil;o de venda: &quot;</font><font color="#808080">;
         </font>g_nPosChave <font color="#808080">= </font><font color="#FF0000">47</font><font color="#808080">;
         </font>g_nTamChave <font color="#808080">= </font><font color="#FF0000">10</font><font color="#808080">;
        } </font><font color="#000080"><b>break</b></font><font color="#808080">;
   }
}

</font><font color="#000080"><b>return</b></font><font color="#808080">(</font>sret<font color="#808080">);
}
<i>/*------------------------------------------------------------------------------
Indica se continua ou n&atilde;o mostrando um n&uacute;mero m&aacute;ximo de linhas.
nlinha - a linha a ser continuada
nQtdLinha - a quantidade de linhas a serem mostradas
retorna - se continua ou n&atilde;o
------------------------------------------------------------------------------*/
</i></font>Boolean ContinuaSN<font color="#808080">(</font><font color="#0000FF"><b>int </b></font>nlinha<font color="#808080">, </font><font color="#0000FF"><b>int </b></font>nQtdLinha<font color="#808080">)
{ </font>Boolean bSOp<font color="#808080">, </font>bret<font color="#808080">;
  </font><font color="#0000FF"><b>char </b></font>opCSubMenu<font color="#808080">;

</font>bret <font color="#808080">= </font><font color="#0000FF"><b>false</b></font><font color="#808080">;
</font><font color="#000080"><b>if </b></font><font color="#808080">(</font>nlinha <font color="#808080">&gt; </font><font color="#FF0000">0</font><font color="#808080">) {
  </font><font color="#000080"><b>if </b></font><font color="#808080">((</font>nlinha <font color="#808080">% </font>nQtdLinha<font color="#808080">) == </font><font color="#FF0000">0</font><font color="#808080">) {
</font>	  bSOp <font color="#808080">= </font><font color="#0000FF"><b>true</b></font><font color="#808080">;
</font>	  <font color="#000080"><b>while</b></font><font color="#808080">(</font>bSOp<font color="#808080">) {
</font>	   menu<font color="#808080">(</font><font color="#FF0000">13</font><font color="#808080">);
</font>	   opCSubMenu <font color="#808080">= </font>System<font color="#808080">.</font>Console<font color="#808080">.</font>In<font color="#808080">.</font>ReadLine<font color="#808080">()[</font><font color="#FF0000">0</font><font color="#808080">];
</font>	   <font color="#000080"><b>if </b></font><font color="#808080">((</font>opCSubMenu<font color="#808080">=='</font>S<font color="#808080">') || (</font>opCSubMenu<font color="#808080">=='</font>s<font color="#808080">')) </font>bSOp <font color="#808080">= </font><font color="#0000FF"><b>false</b></font><font color="#808080">;
</font>	   <font color="#000080"><b>else if </b></font><font color="#808080">((</font>opCSubMenu<font color="#808080">=='</font>N<font color="#808080">') || (</font>opCSubMenu<font color="#808080">=='</font>n<font color="#808080">')) {
</font>		  bret <font color="#808080">= </font><font color="#0000FF"><b>true</b></font><font color="#808080">;
</font>		  bSOp <font color="#808080">= </font><font color="#0000FF"><b>false</b></font><font color="#808080">;
</font>	   <font color="#808080">} </font><font color="#000080"><b>else </b></font>System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font>MSG_ERRO<font color="#808080">);
</font>	  <font color="#808080">}
  }
}

</font><font color="#000080"><b>return</b></font><font color="#808080">(</font>bret<font color="#808080">);
}
<i>/*------------------------------------------------------------------------------
Lista v&aacute;rios registros de acordo com a pesquisa feita.
sArq - o arquivo
sreg - o tipo de arquivo
sChave - a chave a ser pesquisada
nPosChave - a posicao inicial da chave dentro do registro
nTamChave - o tamanho da chave dentro do registro
nTamLinha - o tamanho do registro
nQtdLinha - a quantidade de linhas a serem mostradas
retorna - se encontrou algum registro
------------------------------------------------------------------------------*/
</i></font>Boolean ListarTodos<font color="#808080">(</font>FileStream sArq<font color="#808080">, </font>ctArqs sreg<font color="#808080">, </font><font color="#0000FF"><b>string </b></font>sChave<font color="#808080">,
   </font><font color="#0000FF"><b>int </b></font>nPosChave<font color="#808080">, </font><font color="#0000FF"><b>int </b></font>nTamChave<font color="#808080">, </font><font color="#0000FF"><b>int </b></font>nTamLinha<font color="#808080">, </font><font color="#0000FF"><b>int </b></font>nQtdLinha<font color="#808080">,
   </font>Boolean bPesqRelativa<font color="#808080">) {
  </font>Boolean bQuebra<font color="#808080">, </font>bAchou<font color="#808080">, </font>bRet<font color="#808080">;
  </font><font color="#0000FF"><b>int </b></font>nCont<font color="#808080">;
  </font><font color="#0000FF"><b>string </b></font>sres <font color="#808080">= </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font>slinha <font color="#808080">= </font><font color="#800000">&quot;&quot;</font><font color="#808080">;

  </font>bRet <font color="#808080">= </font><font color="#0000FF"><b>false</b></font><font color="#808080">;

</font>	bQuebra <font color="#808080">= </font><font color="#0000FF"><b>false</b></font><font color="#808080">;
</font>	nCont <font color="#808080">= </font><font color="#FF0000">0</font><font color="#808080">;
</font>	mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">);
</font>	sArq<font color="#808080">.</font>Seek<font color="#808080">(</font><font color="#FF0000">0</font><font color="#808080">,</font>SeekOrigin<font color="#808080">.</font>Begin<font color="#808080">);
</font>	<font color="#000080"><b>while </b></font><font color="#808080">(!</font>fimArq<font color="#808080">(</font>sArq<font color="#808080">) &amp;&amp; </font>bQuebra <font color="#808080">== </font><font color="#0000FF"><b>false</b></font><font color="#808080">) {
</font>	  slinha <font color="#808080">= </font>lerArq<font color="#808080">(</font>sArq<font color="#808080">, </font>nTamLinha<font color="#808080">, </font>TAM_CRLF<font color="#808080">);
</font>	  <font color="#000080"><b>if </b></font><font color="#808080">(</font>slinha<font color="#808080">.</font>Equals<font color="#808080">(</font><font color="#800000">&quot;&quot;</font><font color="#808080">)==</font><font color="#0000FF"><b>false</b></font><font color="#808080">) {
</font>		<font color="#000080"><b>if </b></font><font color="#808080">(</font>bPesqRelativa<font color="#808080">) {
</font>		  sres <font color="#808080">= </font>copy<font color="#808080">(</font>slinha<font color="#808080">,</font>nPosChave<font color="#808080">,</font>nTamChave<font color="#808080">).</font>Trim<font color="#808080">();
</font>		  <font color="#000080"><b>if </b></font><font color="#808080">(</font>strRelativa<font color="#808080">(</font>sres<font color="#808080">,</font>sChave<font color="#808080">)==</font><font color="#0000FF"><b>true</b></font><font color="#808080">) {
</font>			 bAchou <font color="#808080">= </font><font color="#0000FF"><b>true</b></font><font color="#808080">;
</font>			 bRet <font color="#808080">= </font><font color="#0000FF"><b>true</b></font><font color="#808080">;
</font>		  <font color="#808080">} </font><font color="#000080"><b>else </b></font><font color="#808080">{
</font>			 bAchou <font color="#808080">= </font><font color="#0000FF"><b>false</b></font><font color="#808080">;
</font>		  <font color="#808080">}
</font>		<font color="#808080">} </font><font color="#000080"><b>else </b></font><font color="#808080">{
</font>		  bAchou <font color="#808080">= </font><font color="#0000FF"><b>true</b></font><font color="#808080">;
</font>		  bRet <font color="#808080">= </font><font color="#0000FF"><b>true</b></font><font color="#808080">;
</font>		<font color="#808080">}

</font>		<font color="#000080"><b>if </b></font><font color="#808080">(</font>bAchou<font color="#808080">) {
</font>		  mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font>copy<font color="#808080">(</font>slinha<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font>nTamLinha<font color="#808080">), </font><font color="#FF0000">3</font><font color="#808080">);
</font>		  nCont<font color="#808080">++;
</font>		<font color="#808080">}
</font>	  <font color="#808080">}
</font>	  bQuebra <font color="#808080">= </font>ContinuaSN<font color="#808080">(</font>nCont<font color="#808080">, </font>nQtdLinha<font color="#808080">);
</font>	<font color="#808080">}

</font><font color="#000080"><b>return </b></font>bRet<font color="#808080">;
}
<i>/*------------------------------------------------------------------------------
Lista v&aacute;rios registros entre arquivos de acordo com a pesquisa feita.
sArq1 - o arquivo de liga&ccedil;&atilde;o
sreg1 - o tipo de arquivo de liga&ccedil;&atilde;o
nPosChave1 - a posicao inicial da primeira chave no arquivo de liga&ccedil;&atilde;o
nTamChave1 - o tamanho da primeira chave no arquivo de liga&ccedil;&atilde;o
nPosChave2 - a posicao inicial da segunda chave do arquivo de liga&ccedil;&atilde;o
nTamChave2 - o tamanho da segunda chave do arquivo de liga&ccedil;&atilde;o
sChave - a chave a ser pesquisada no arquivo de liga&ccedil;&atilde;o
sArq2 - o arquivo a ser pesquisado
sreg2 - o tipo de arquivo a ser pesquisado
nPosChave3 - a posicao inicial da chave do arquivo pesquisado
nQtdLinha - a quantidade de linhas a serem mostradas
------------------------------------------------------------------------------*/
</i></font><font color="#0000FF"><b>void </b></font>ListarRegLigados<font color="#808080">(</font>FileStream sArq1<font color="#808080">, </font>ctArqs sreg1<font color="#808080">, </font><font color="#0000FF"><b>int </b></font>nPosChave1<font color="#808080">,
</font><font color="#0000FF"><b>int </b></font>nTamChave1<font color="#808080">, </font><font color="#0000FF"><b>int </b></font>nPosChave2<font color="#808080">, </font><font color="#0000FF"><b>int </b></font>nTamChave2<font color="#808080">, </font><font color="#0000FF"><b>string </b></font>sChave<font color="#808080">,
</font>FileStream sArq2<font color="#808080">, </font>ctArqs sreg2<font color="#808080">, </font><font color="#0000FF"><b>int </b></font>nPosChave3<font color="#808080">, </font><font color="#0000FF"><b>int </b></font>nQtdLinha<font color="#808080">) {
  </font><font color="#0000FF"><b>string </b></font>slinha1 <font color="#808080">= </font><font color="#800000">&quot;&quot;</font><font color="#808080">;
  </font>Boolean bQuebra<font color="#808080">, </font>bRet<font color="#808080">;
  </font><font color="#0000FF"><b>int </b></font>nCont<font color="#808080">;
  </font><font color="#0000FF"><b>string </b></font>sCodigo1<font color="#808080">, </font>sCodigo2<font color="#808080">, </font>slinha2<font color="#808080">;

</font>	bRet <font color="#808080">= </font><font color="#0000FF"><b>false</b></font><font color="#808080">;
</font>	nCont <font color="#808080">= </font><font color="#FF0000">0</font><font color="#808080">;
</font>	bQuebra <font color="#808080">= </font><font color="#0000FF"><b>false</b></font><font color="#808080">;
</font>	mostrarDados<font color="#808080">(</font>sreg2<font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">);
</font>	sArq1<font color="#808080">.</font>Seek<font color="#808080">(</font><font color="#FF0000">0</font><font color="#808080">,</font>SeekOrigin<font color="#808080">.</font>Begin<font color="#808080">);
</font>	<font color="#000080"><b>while </b></font><font color="#808080">(!</font>fimArq<font color="#808080">(</font>sArq1<font color="#808080">) &amp;&amp; </font>bQuebra <font color="#808080">== </font><font color="#0000FF"><b>false</b></font><font color="#808080">) {
</font>	  slinha1 <font color="#808080">= </font>lerArq<font color="#808080">(</font>sArq1<font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg1<font color="#808080">), </font>TAM_CRLF<font color="#808080">);
</font>	  <font color="#000080"><b>if </b></font><font color="#808080">(</font>slinha1<font color="#808080">.</font>Equals<font color="#808080">(</font><font color="#800000">&quot;&quot;</font><font color="#808080">)==</font><font color="#0000FF"><b>false</b></font><font color="#808080">) {
</font>		sCodigo1 <font color="#808080">= </font>copy<font color="#808080">(</font>slinha1<font color="#808080">,</font>nPosChave1<font color="#808080">,</font>nTamChave1<font color="#808080">).</font>Trim<font color="#808080">();
</font>		<font color="#000080"><b>if </b></font><font color="#808080">(</font>sCodigo1<font color="#808080">.</font>Equals<font color="#808080">(</font>sChave<font color="#808080">)) {
</font>		  sCodigo2 <font color="#808080">= </font>copy<font color="#808080">(</font>slinha1<font color="#808080">,</font>nPosChave2<font color="#808080">,</font>nTamChave2<font color="#808080">).</font>Trim<font color="#808080">();
</font>		  slinha2 <font color="#808080">= </font>pesqArq<font color="#808080">(</font>sArq2<font color="#808080">, </font>sCodigo2<font color="#808080">, </font>nPosChave3<font color="#808080">, </font>nTamChave2<font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg2<font color="#808080">));
</font>		  mostrarDados<font color="#808080">(</font>sreg2<font color="#808080">, </font>copy<font color="#808080">(</font>slinha2<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg2<font color="#808080">)), </font><font color="#FF0000">3</font><font color="#808080">);
</font>		  bRet <font color="#808080">= </font><font color="#0000FF"><b>true</b></font><font color="#808080">;
</font>		  nCont<font color="#808080">++;
</font>		<font color="#808080">}
</font>	  <font color="#808080">}
</font>	  bQuebra <font color="#808080">= </font>ContinuaSN<font color="#808080">(</font>nCont<font color="#808080">, </font>nQtdLinha<font color="#808080">);
</font>	<font color="#808080">}
</font>	<font color="#000080"><b>if </b></font><font color="#808080">(</font>bRet<font color="#808080">==</font><font color="#0000FF"><b>false</b></font><font color="#808080">)
</font>	   System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg2<font color="#808080">,</font><font color="#FF0000">0</font><font color="#808080">));
}

<i>/*------------------------------------------------------------------------------
Valida a entrada de registros de acordo com a pesquisa feita.
sArq - o arquivo
sreg - o tipo de arquivo
nTexto - o numero do r&oacute;tulo da entrada
sEntrada - a chave a ser pesquisada e validada
nTentativas - o n&uacute;mero m&aacute;ximo de tentativas
bPesqRelativa - indica se vai realizar uma pesquisa relativa
bTipoEntrada - indica o tipo de entrada
retorna - o registro pesquisado e validado
------------------------------------------------------------------------------*/
</i></font><font color="#0000FF"><b>string </b></font>validaEntrada<font color="#808080">(</font>FileStream sArq<font color="#808080">, </font>ctArqs sreg<font color="#808080">, </font><font color="#0000FF"><b>int </b></font>nTexto<font color="#808080">,
</font>		<font color="#0000FF"><b>string </b></font>sEntrada<font color="#808080">, </font><font color="#0000FF"><b>int </b></font>nTentativas<font color="#808080">,
</font>		Boolean bPesqRelativa<font color="#808080">, </font>ctTipo bTipoEntrada<font color="#808080">) {
  </font>Boolean bQuebra<font color="#808080">;
  </font><font color="#0000FF"><b>string </b></font>sres<font color="#808080">, </font>sTexto<font color="#808080">, </font>sMsgErro<font color="#808080">, </font>sLocal<font color="#808080">;
  </font><font color="#0000FF"><b>int </b></font>ncont<font color="#808080">, </font>nPosChave<font color="#808080">, </font>nTamChave<font color="#808080">, </font>nTamLinha<font color="#808080">;

</font>sres <font color="#808080">= </font><font color="#800000">&quot;&quot;</font><font color="#808080">;
</font>sLocal <font color="#808080">= </font>sEntrada<font color="#808080">;

</font>nTamLinha <font color="#808080">= </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">);
</font>sMsgErro <font color="#808080">= </font>rotulo<font color="#808080">(</font>sreg<font color="#808080">,</font><font color="#FF0000">0</font><font color="#808080">);
</font>sTexto <font color="#808080">= </font>rotulo<font color="#808080">(</font>sreg<font color="#808080">,</font>nTexto<font color="#808080">);
</font>nPosChave <font color="#808080">= </font>g_nPosChave<font color="#808080">;
</font>nTamChave <font color="#808080">= </font>g_nTamChave<font color="#808080">;

</font>ncont <font color="#808080">= </font><font color="#FF0000">1</font><font color="#808080">;
</font>bQuebra <font color="#808080">= </font><font color="#0000FF"><b>false</b></font><font color="#808080">;
  </font><font color="#000080"><b>while </b></font><font color="#808080">((</font>bQuebra<font color="#808080">==</font><font color="#0000FF"><b>false</b></font><font color="#808080">) &amp;&amp; (</font>ncont <font color="#808080">&lt;= </font>nTentativas <font color="#808080">)) {
</font>	<font color="#000080"><b>if </b></font><font color="#808080">(</font>bTipoEntrada<font color="#808080">==</font>ctTipo<font color="#808080">.</font>opTexto<font color="#808080">) {
</font>	  System<font color="#808080">.</font>Console<font color="#808080">.</font>Write<font color="#808080">(</font>sTexto<font color="#808080">);
</font>	  sLocal <font color="#808080">= </font>System<font color="#808080">.</font>Console<font color="#808080">.</font>In<font color="#808080">.</font>ReadLine<font color="#808080">();
</font>	<font color="#808080">} </font><font color="#000080"><b>else if </b></font><font color="#808080">(</font>bTipoEntrada<font color="#808080">==</font>ctTipo<font color="#808080">.</font>opNumero<font color="#808080">)
</font>	   sLocal <font color="#808080">= </font>validaNumero<font color="#808080">(</font>sTexto<font color="#808080">,</font>sLocal<font color="#808080">);
</font>	<font color="#000080"><b>else if </b></font><font color="#808080">(</font>bTipoEntrada<font color="#808080">==</font>ctTipo<font color="#808080">.</font>opData<font color="#808080">)
</font>	   sLocal <font color="#808080">= </font>validaDataHora<font color="#808080">(</font>sTexto<font color="#808080">,</font>sLocal<font color="#808080">,</font><font color="#0000FF"><b>true</b></font><font color="#808080">);
</font>	<font color="#000080"><b>else if </b></font><font color="#808080">(</font>bTipoEntrada<font color="#808080">==</font>ctTipo<font color="#808080">.</font>opDataHora<font color="#808080">)
</font>	   sLocal <font color="#808080">= </font>validaDataHora<font color="#808080">(</font>sTexto<font color="#808080">,</font>sLocal<font color="#808080">,</font><font color="#0000FF"><b>false</b></font><font color="#808080">);
</font>	<font color="#000080"><b>else if </b></font><font color="#808080">(</font>bTipoEntrada<font color="#808080">==</font>ctTipo<font color="#808080">.</font>opSenha<font color="#808080">) {
</font>	   sLocal <font color="#808080">= </font>digitaSenha<font color="#808080">(</font>sTexto<font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">);
</font>	<font color="#808080">}

    </font><font color="#000080"><b>if </b></font><font color="#808080">(</font>bPesqRelativa<font color="#808080">) {
       </font><font color="#000080"><b>if </b></font><font color="#808080">(</font>ListarTodos<font color="#808080">(</font>sArq<font color="#808080">, </font>sreg<font color="#808080">, </font>sLocal<font color="#808080">, </font>nPosChave<font color="#808080">, </font>nTamChave<font color="#808080">, </font>nTamLinha<font color="#808080">,
       </font>QTD_MAX_LINHA<font color="#808080">, </font><font color="#0000FF"><b>true</b></font><font color="#808080">))
        </font>sres <font color="#808080">= </font><font color="#800000">&quot; &quot;</font><font color="#808080">;
    } </font><font color="#000080"><b>else
       </b></font>sres <font color="#808080">= </font>pesqArq<font color="#808080">(</font>sArq<font color="#808080">, </font>sLocal<font color="#808080">, </font>nPosChave<font color="#808080">, </font>nTamChave<font color="#808080">, </font>nTamLinha<font color="#808080">);

</font>	<font color="#000080"><b>if </b></font><font color="#808080">(</font>sres<font color="#808080">.</font>Equals<font color="#808080">(</font><font color="#800000">&quot;&quot;</font><font color="#808080">))
</font>	   System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font>sMsgErro<font color="#808080">);
</font>	<font color="#000080"><b>else
</b></font>	   bQuebra <font color="#808080">= </font><font color="#0000FF"><b>true</b></font><font color="#808080">;

    </font>ncont<font color="#808080">++;
  }
</font><font color="#000080"><b>return</b></font><font color="#808080">(</font>sres<font color="#808080">);
}
<i>/*------------------------------------------------------------------------------
Mostra a tela de splash do sistema.
------------------------------------------------------------------------------*/
</i></font><font color="#0000FF"><b>void </b></font>frmSplash<font color="#808080">()
{ </font><font color="#0000FF"><b>int </b></font>cont<font color="#808080">;

 </font>System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;*---------------------------------------&quot; </font><font color="#808080">+
 </font><font color="#800000">&quot;-------------------------------------*&quot;</font><font color="#808080">);
 </font>System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;| LL    II VV   VV RRRRR  UU  UU   SSSS &quot; </font><font color="#808080">+
 </font><font color="#800000">&quot;VV   VV II RRRRR  TTTT UU  UU   SSSS |&quot;</font><font color="#808080">);
 </font>System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;| LL    II  VV VV  RR   R UU  UU  SS    &quot; </font><font color="#808080">+
 </font><font color="#800000">&quot; VV VV  II RR   R  TT  UU  UU  SS    |&quot;</font><font color="#808080">);
 </font>System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;| LL    II   VVV   RRRRR  UU  UU    SS  &quot; </font><font color="#808080">+
 </font><font color="#800000">&quot;  VVV   II RRRRR   TT  UU  UU    SS  |&quot;</font><font color="#808080">);
 </font>System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;| LLLLL II    V    RR   R  UUUU  SSSS   &quot; </font><font color="#808080">+
 </font><font color="#800000">&quot;   V    II RR   R  TT   UUUU  SSSS   |&quot;</font><font color="#808080">);
 </font>System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;*---------------------------------------&quot; </font><font color="#808080">+
 </font><font color="#800000">&quot;-------------------------------------*&quot;</font><font color="#808080">);
 </font><font color="#000080"><b>for</b></font><font color="#808080">(</font>cont <font color="#808080">= </font><font color="#FF0000">1</font><font color="#808080">; </font>cont <font color="#808080">&lt;= </font><font color="#FF0000">18</font><font color="#808080">; </font>cont<font color="#808080">++) </font>System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">();
 </font>System<font color="#808080">.</font>Console<font color="#808080">.</font>Write<font color="#808080">(</font>MSG_PRESS<font color="#808080">);
 </font>System<font color="#808080">.</font>Console<font color="#808080">.</font>In<font color="#808080">.</font>ReadLine<font color="#808080">();
}
<i>/*------------------------------------------------------------------------------
Mostra a tela de sobre do sistema.
------------------------------------------------------------------------------*/
</i></font><font color="#0000FF"><b>void </b></font>frmSobre<font color="#808080">()
{ </font><font color="#0000FF"><b>int </b></font>cont<font color="#808080">;

 </font>System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;*------------------------------------------------------------*&quot;</font><font color="#808080">);
 </font>System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;|  LL        II  VV       VV  RRRRRRR   UU    UU   SSSSSSS   |&quot;</font><font color="#808080">);
 </font>System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;|  LL        II   VV     VV   RR     R  UU    UU  SS         |&quot;</font><font color="#808080">);
 </font>System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;|  LL        II    VV   VV    RR     R  UU    UU   SSSS      |&quot;</font><font color="#808080">);
 </font>System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;|  LL        II     VV VV     RRRRRRR   UU    UU     SSSS    |&quot;</font><font color="#808080">);
 </font>System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;|  LLLL      II      VVV      RR RR     UU    UU        SS   |&quot;</font><font color="#808080">);
 </font>System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;|  LLLLLLLL  II       V       RR   RR    UUUUUU   SSSSSSSS   |&quot;</font><font color="#808080">);
 </font>System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;|                                                            |&quot;</font><font color="#808080">);
 </font>System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;|  VV       VV  II  RRRRRRR   TTTTTTTT  UU    UU   SSSSSSS   |&quot;</font><font color="#808080">);
 </font>System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;|   VV     VV   II  RR     R     TT     UU    UU  SS         |&quot;</font><font color="#808080">);
 </font>System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;|    VV   VV    II  RR     R     TT     UU    UU   SSSS      |&quot;</font><font color="#808080">);
 </font>System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;|     VV VV     II  RRRRRRR      TT     UU    UU     SSSS    |&quot;</font><font color="#808080">);
 </font>System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;|      VVV      II  RR RR        TT     UU    UU        SS   |&quot;</font><font color="#808080">);
 </font>System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;|       V       II  RR   RR      TT      UUUUUU   SSSSSSSS   |&quot;</font><font color="#808080">);
 </font>System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;|                                                            |&quot;</font><font color="#808080">);
 </font>System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;|                                               Versao 1.0.0 |&quot;</font><font color="#808080">);
 </font>System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;| Sistema integrante do projeto Livrus Virtus.               |&quot;</font><font color="#808080">);
 </font>System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;| Todos os direitos reservados para Henrique F. de Souza.    |&quot;</font><font color="#808080">);
 </font>System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;| Versao programada na linguagem C #.                        |&quot;</font><font color="#808080">);
 </font>System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;*------------------------------------------------------------*&quot;</font><font color="#808080">);
 </font><font color="#000080"><b>for</b></font><font color="#808080">(</font>cont <font color="#808080">= </font><font color="#FF0000">1</font><font color="#808080">; </font>cont <font color="#808080">&lt;= </font><font color="#FF0000">4</font><font color="#808080">; </font>cont<font color="#808080">++) </font>System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">();
 </font>System<font color="#808080">.</font>Console<font color="#808080">.</font>Write<font color="#808080">(</font>MSG_PRESS<font color="#808080">);
 </font>System<font color="#808080">.</font>Console<font color="#808080">.</font>In<font color="#808080">.</font>ReadLine<font color="#808080">();
}
<i>/*------------------------------------------------------------------------------
Mostra a tela de login do sistema.
retorna - se o login foi validado corretamente
------------------------------------------------------------------------------*/
</i></font>Boolean frmLogin<font color="#808080">()
{ </font>Boolean bret<font color="#808080">;
  </font><font color="#0000FF"><b>string </b></font>slinha<font color="#808080">;

  </font>bret <font color="#808080">= </font><font color="#0000FF"><b>false</b></font><font color="#808080">;
  </font>System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;*--------------------------------------------------------------*&quot;</font><font color="#808080">);
  </font>System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;| Login do sistema                                             |&quot;</font><font color="#808080">);
  </font>System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;*--------------------------------------------------------------*&quot;</font><font color="#808080">);
  </font>slinha <font color="#808080">= </font>validaEntrada<font color="#808080">(</font>tfUsuario<font color="#808080">, </font>ctArqs<font color="#808080">.</font>opUsuario<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font>tUsuario<font color="#808080">.</font>login<font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">,
</font>		<font color="#0000FF"><b>false</b></font><font color="#808080">, </font>ctTipo<font color="#808080">.</font>opTexto<font color="#808080">);
  </font><font color="#000080"><b>if </b></font><font color="#808080">(</font>slinha<font color="#808080">.</font>Equals<font color="#808080">(</font><font color="#800000">&quot;&quot;</font><font color="#808080">)==</font><font color="#0000FF"><b>false</b></font><font color="#808080">) {
</font>	 slinha <font color="#808080">= </font>validaEntrada<font color="#808080">(</font>tfUsuario<font color="#808080">, </font>ctArqs<font color="#808080">.</font>opUsuario<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">, </font>tUsuario<font color="#808080">.</font>senha<font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">,
</font>		<font color="#0000FF"><b>false</b></font><font color="#808080">, </font>ctTipo<font color="#808080">.</font>opSenha<font color="#808080">);
</font>	 <font color="#000080"><b>if </b></font><font color="#808080">(</font>slinha<font color="#808080">.</font>Equals<font color="#808080">(</font><font color="#800000">&quot;&quot;</font><font color="#808080">)==</font><font color="#0000FF"><b>false</b></font><font color="#808080">) {
</font>		tUsuario<font color="#808080">.</font>login <font color="#808080">= </font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">).</font>Trim<font color="#808080">();
</font>		tUsuario<font color="#808080">.</font>senha <font color="#808080">= </font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">11</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">).</font>Trim<font color="#808080">();
        </font>bret <font color="#808080">= </font><font color="#0000FF"><b>true</b></font><font color="#808080">;
     }
  }
  </font>System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">();
  </font><font color="#000080"><b>return</b></font><font color="#808080">(</font>bret<font color="#808080">);
}
<i>/*------------------------------------------------------------------------------
Mostra os menus do sistema.
num - o n&uacute;mero do menu
------------------------------------------------------------------------------*/
</i></font><font color="#0000FF"><b>void </b></font>menu<font color="#808080">(</font><font color="#0000FF"><b>int </b></font>num<font color="#808080">)
{
 </font><font color="#000080"><b>if </b></font><font color="#808080">(</font>num<font color="#808080">==</font><font color="#FF0000">1</font><font color="#808080">) {
   </font>System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;*--------------------------------------------------------------*&quot;</font><font color="#808080">);
   </font>System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;| (C)adastros        (P)esquisas     (V)endas        (O)p&ccedil;&otilde;es  |&quot;</font><font color="#808080">);
   </font>System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;*--------------------------------------------------------------*&quot;</font><font color="#808080">);
 } </font><font color="#000080"><b>else if </b></font><font color="#808080">(</font>num<font color="#808080">==</font><font color="#FF0000">2</font><font color="#808080">) {
   </font>System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;*---------------------------------*&quot;</font><font color="#808080">);
   </font>System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;| 01. Cadastro de Assuntos        |&quot;</font><font color="#808080">);
   </font>System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;| 02. Cadastro de Autores         |&quot;</font><font color="#808080">);
   </font>System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;| 03. Cadastro de Editoras        |&quot;</font><font color="#808080">);
   </font>System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;| 04. Cadastro de Endere&ccedil;os       |&quot;</font><font color="#808080">);
   </font>System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;| 05. Cadastro de Idiomas         |&quot;</font><font color="#808080">);
   </font>System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;| 06. Cadastro de Pa&iacute;ses          |&quot;</font><font color="#808080">);
   </font>System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;| 07. Cadastro de Profiss&otilde;es      |&quot;</font><font color="#808080">);
   </font>System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;| 08. Cadastro de Clientes        |&quot;</font><font color="#808080">);
   </font>System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;| 09. Cadastro de Livros          |&quot;</font><font color="#808080">);
   </font>System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;| 10. Voltar ao menu              |&quot;</font><font color="#808080">);
   </font>System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;*---------------------------------*&quot;</font><font color="#808080">);
 } </font><font color="#000080"><b>else if </b></font><font color="#808080">(</font>num<font color="#808080">==</font><font color="#FF0000">3</font><font color="#808080">) {
   </font>System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;*---------------------------------*&quot;</font><font color="#808080">);
   </font>System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;| 01. Consulta de Assuntos        |&quot;</font><font color="#808080">);
   </font>System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;| 02. Consulta de Autores         |&quot;</font><font color="#808080">);
   </font>System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;| 03. Consulta de Editoras        |&quot;</font><font color="#808080">);
   </font>System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;| 04. Consulta de Endere&ccedil;os       |&quot;</font><font color="#808080">);
   </font>System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;| 05. Consulta de Idiomas         |&quot;</font><font color="#808080">);
   </font>System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;| 06. Consulta de Pa&iacute;ses          |&quot;</font><font color="#808080">);
   </font>System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;| 07. Consulta de Profiss&otilde;es      |&quot;</font><font color="#808080">);
   </font>System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;| 08. Consulta de Clientes        |&quot;</font><font color="#808080">);
   </font>System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;| 09. Consulta de Livros          |&quot;</font><font color="#808080">);
   </font>System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;| 10. Voltar ao menu              |&quot;</font><font color="#808080">);
   </font>System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;*---------------------------------*&quot;</font><font color="#808080">);
 } </font><font color="#000080"><b>else if </b></font><font color="#808080">(</font>num<font color="#808080">==</font><font color="#FF0000">4</font><font color="#808080">) {
   </font>System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;*---------------------------------*&quot;</font><font color="#808080">);
   </font>System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;| 01. Vender Livros               |&quot;</font><font color="#808080">);
   </font>System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;| 02. Vendas Realizadas           |&quot;</font><font color="#808080">);
   </font>System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;| 03. Voltar ao menu              |&quot;</font><font color="#808080">);
   </font>System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;*---------------------------------*&quot;</font><font color="#808080">);
 } </font><font color="#000080"><b>else if </b></font><font color="#808080">(</font>num<font color="#808080">==</font><font color="#FF0000">5</font><font color="#808080">) {
   </font>System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;*---------------------------------*&quot;</font><font color="#808080">);
   </font>System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;| 01. Alterar senha               |&quot;</font><font color="#808080">);
   </font>System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;| 02. Sobre o sistema             |&quot;</font><font color="#808080">);
   </font>System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;| 03. Sair do sistema             |&quot;</font><font color="#808080">);
   </font>System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;| 04. Voltar ao menu              |&quot;</font><font color="#808080">);
   </font>System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;*---------------------------------*&quot;</font><font color="#808080">);
 } </font><font color="#000080"><b>else if </b></font><font color="#808080">(</font>num<font color="#808080">==</font><font color="#FF0000">6</font><font color="#808080">) {
   </font>System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;*--------------------------------------------------------------*&quot;</font><font color="#808080">);
   </font>System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;| (1) Novo  (2) Pesquisar   (3) Voltar ao menu                 |&quot;</font><font color="#808080">);
   </font>System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;*--------------------------------------------------------------*&quot;</font><font color="#808080">);
 } </font><font color="#000080"><b>else if </b></font><font color="#808080">(</font>num<font color="#808080">==</font><font color="#FF0000">7</font><font color="#808080">) {
   </font>System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;*--------------------------------------------------------------*&quot;</font><font color="#808080">);
   </font>System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;| (1) Salvar inclus&atilde;o       (2) Voltar ao menu                 |&quot;</font><font color="#808080">);
   </font>System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;*--------------------------------------------------------------*&quot;</font><font color="#808080">);
 } </font><font color="#000080"><b>else if </b></font><font color="#808080">(</font>num<font color="#808080">==</font><font color="#FF0000">8</font><font color="#808080">) {
   </font>System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;*--------------------------------------------------------------*&quot;</font><font color="#808080">);
   </font>System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;| (1) Alterar       (2) Excluir     (3) Voltar ao menu         |&quot;</font><font color="#808080">);
   </font>System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;*--------------------------------------------------------------*&quot;</font><font color="#808080">);
 } </font><font color="#000080"><b>else if </b></font><font color="#808080">(</font>num<font color="#808080">==</font><font color="#FF0000">9</font><font color="#808080">) {
   </font>System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;*--------------------------------------------------------------*&quot;</font><font color="#808080">);
   </font>System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;| (1) Salvar altera&ccedil;&atilde;o      (2) Voltar ao menu                 |&quot;</font><font color="#808080">);
   </font>System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;*--------------------------------------------------------------*&quot;</font><font color="#808080">);
 } </font><font color="#000080"><b>else if </b></font><font color="#808080">(</font>num<font color="#808080">==</font><font color="#FF0000">10</font><font color="#808080">) {
   </font>System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;*--------------------------------------------------------------*&quot;</font><font color="#808080">);
   </font>System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;| Certeza de excluir? (S/N)                                    |&quot;</font><font color="#808080">);
   </font>System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;*--------------------------------------------------------------*&quot;</font><font color="#808080">);
 } </font><font color="#000080"><b>else if </b></font><font color="#808080">(</font>num<font color="#808080">==</font><font color="#FF0000">11</font><font color="#808080">) {
   </font>System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;*--------------------------------------------------------------*&quot;</font><font color="#808080">);
   </font>System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;| Deseja sair do sistema? (S/N)                                |&quot;</font><font color="#808080">);
   </font>System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;*--------------------------------------------------------------*&quot;</font><font color="#808080">);
 } </font><font color="#000080"><b>else if </b></font><font color="#808080">(</font>num<font color="#808080">==</font><font color="#FF0000">12</font><font color="#808080">) {
   </font>System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;*--------------------------------------------------------------*&quot;</font><font color="#808080">);
   </font>System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;| (1) Pesquisar  (2) Listar todos   (3) Voltar ao menu         |&quot;</font><font color="#808080">);
   </font>System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;*--------------------------------------------------------------*&quot;</font><font color="#808080">);
 } </font><font color="#000080"><b>else if </b></font><font color="#808080">(</font>num<font color="#808080">==</font><font color="#FF0000">13</font><font color="#808080">) {
   </font>System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;*--------------------------------------------------------------*&quot;</font><font color="#808080">);
   </font>System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;| Deseja continuar? (S/N)                                      |&quot;</font><font color="#808080">);
   </font>System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;*--------------------------------------------------------------*&quot;</font><font color="#808080">);
 } </font><font color="#000080"><b>else if </b></font><font color="#808080">(</font>num<font color="#808080">==</font><font color="#FF0000">14</font><font color="#808080">) {
   </font>System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;*--------------------------------------------------------------*&quot;</font><font color="#808080">);
   </font>System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;| Salvar inclus&atilde;o (S/N)                                        |&quot;</font><font color="#808080">);
   </font>System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;*--------------------------------------------------------------*&quot;</font><font color="#808080">);
 }
 </font>System<font color="#808080">.</font>Console<font color="#808080">.</font>Write<font color="#808080">(</font>MSG_OPCAO<font color="#808080">);
}
<i>/*------------------------------------------------------------------------------
Realiza os cadastros de acordo com o tipo de arquivo.
sreg - o tipo de arquivo
sacao - a a&ccedil;&atilde;o a ser realizada
------------------------------------------------------------------------------*/
</i></font><font color="#0000FF"><b>void </b></font>frmCadastros<font color="#808080">(</font>ctArqs sreg<font color="#808080">, </font>ctAcao sacao<font color="#808080">)
{ </font><font color="#0000FF"><b>string </b></font>slinha <font color="#808080">= </font><font color="#800000">&quot;&quot;</font><font color="#808080">;

</font><font color="#000080"><b>if </b></font><font color="#808080">(</font>sreg<font color="#808080">==</font>ctArqs<font color="#808080">.</font>opAssunto<font color="#808080">) {
   </font><font color="#000080"><b>if </b></font><font color="#808080">(</font>sacao<font color="#808080">==</font>ctAcao<font color="#808080">.</font>opNovo<font color="#808080">) {
</font>	  tAssunto<font color="#808080">.</font>codigo <font color="#808080">= </font>pesqMaxCod<font color="#808080">(</font>tfAssunto<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">));
</font>	  mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">);
</font>	  subMenu<font color="#808080">(</font><font color="#FF0000">7</font><font color="#808080">, </font>sreg<font color="#808080">);
   } </font><font color="#000080"><b>else if </b></font><font color="#808080">(</font>sacao<font color="#808080">==</font>ctAcao<font color="#808080">.</font>opPesquisar<font color="#808080">) {
</font>	 slinha <font color="#808080">= </font>validaEntrada<font color="#808080">(</font>tfAssunto<font color="#808080">,</font>sreg<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font>tAssunto<font color="#808080">.</font>codigo<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#0000FF"><b>false</b></font><font color="#808080">,</font>ctTipo<font color="#808080">.</font>opNumero<font color="#808080">);
</font>	  <font color="#000080"><b>if </b></font><font color="#808080">(</font>slinha<font color="#808080">.</font>Equals<font color="#808080">(</font><font color="#800000">&quot;&quot;</font><font color="#808080">)==</font><font color="#0000FF"><b>false</b></font><font color="#808080">) {
</font>		mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">);
</font>		mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font>slinha<font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">);
</font>		subMenu<font color="#808080">(</font><font color="#FF0000">8</font><font color="#808080">, </font>sreg<font color="#808080">);
</font>	  <font color="#808080">}
   } </font><font color="#000080"><b>else if </b></font><font color="#808080">(</font>sacao<font color="#808080">==</font>ctAcao<font color="#808080">.</font>opAlterar<font color="#808080">) {
</font>	  mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">);
</font>	  subMenu<font color="#808080">(</font><font color="#FF0000">9</font><font color="#808080">, </font>sreg<font color="#808080">);
   } </font><font color="#000080"><b>else if </b></font><font color="#808080">(</font>sacao<font color="#808080">==</font>ctAcao<font color="#808080">.</font>opExcluir<font color="#808080">) {
</font>	  subMenu<font color="#808080">(</font><font color="#FF0000">10</font><font color="#808080">, </font>sreg<font color="#808080">);
   }
} </font><font color="#000080"><b>else if </b></font><font color="#808080">(</font>sreg<font color="#808080">==</font>ctArqs<font color="#808080">.</font>opAutor<font color="#808080">) {
   </font><font color="#000080"><b>if </b></font><font color="#808080">(</font>sacao<font color="#808080">==</font>ctAcao<font color="#808080">.</font>opNovo<font color="#808080">) {
</font>	  tAutor<font color="#808080">.</font>codigo <font color="#808080">= </font>pesqMaxCod<font color="#808080">(</font>tfAutor<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">));
</font>	  mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">);
</font>	  subMenu<font color="#808080">(</font><font color="#FF0000">7</font><font color="#808080">, </font>sreg<font color="#808080">);
   } </font><font color="#000080"><b>else if </b></font><font color="#808080">(</font>sacao<font color="#808080">==</font>ctAcao<font color="#808080">.</font>opPesquisar<font color="#808080">) {
</font>	  slinha <font color="#808080">= </font>validaEntrada<font color="#808080">(</font>tfAutor<font color="#808080">, </font>sreg<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font>tAutor<font color="#808080">.</font>codigo<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#0000FF"><b>false</b></font><font color="#808080">,</font>ctTipo<font color="#808080">.</font>opNumero<font color="#808080">);
</font>	  <font color="#000080"><b>if </b></font><font color="#808080">(</font>slinha<font color="#808080">.</font>Equals<font color="#808080">(</font><font color="#800000">&quot;&quot;</font><font color="#808080">)==</font><font color="#0000FF"><b>false</b></font><font color="#808080">) {
</font>		mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">);
</font>		mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font>slinha<font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">);
</font>		subMenu<font color="#808080">(</font><font color="#FF0000">8</font><font color="#808080">, </font>sreg<font color="#808080">);
</font>	  <font color="#808080">}
   } </font><font color="#000080"><b>else if </b></font><font color="#808080">(</font>sacao<font color="#808080">==</font>ctAcao<font color="#808080">.</font>opAlterar<font color="#808080">) {
</font>	  mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">);
</font>	  subMenu<font color="#808080">(</font><font color="#FF0000">9</font><font color="#808080">, </font>sreg<font color="#808080">);
   } </font><font color="#000080"><b>else if </b></font><font color="#808080">(</font>sacao<font color="#808080">==</font>ctAcao<font color="#808080">.</font>opExcluir<font color="#808080">) {
</font>	  subMenu<font color="#808080">(</font><font color="#FF0000">10</font><font color="#808080">, </font>sreg<font color="#808080">);
   }
} </font><font color="#000080"><b>else if </b></font><font color="#808080">(</font>sreg<font color="#808080">==</font>ctArqs<font color="#808080">.</font>opEditora<font color="#808080">) {
   </font><font color="#000080"><b>if </b></font><font color="#808080">(</font>sacao<font color="#808080">==</font>ctAcao<font color="#808080">.</font>opNovo<font color="#808080">) {
</font>	  tEditora<font color="#808080">.</font>codigo <font color="#808080">= </font>pesqMaxCod<font color="#808080">(</font>tfEditora<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">));
</font>	  mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">);
</font>	  subMenu<font color="#808080">(</font><font color="#FF0000">7</font><font color="#808080">, </font>sreg<font color="#808080">);
   } </font><font color="#000080"><b>else if </b></font><font color="#808080">(</font>sacao<font color="#808080">==</font>ctAcao<font color="#808080">.</font>opPesquisar<font color="#808080">) {
</font>	  slinha <font color="#808080">= </font>validaEntrada<font color="#808080">(</font>tfEditora<font color="#808080">,</font>sreg<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font>tEditora<font color="#808080">.</font>codigo<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#0000FF"><b>false</b></font><font color="#808080">,</font>ctTipo<font color="#808080">.</font>opNumero<font color="#808080">);
</font>	  <font color="#000080"><b>if </b></font><font color="#808080">(</font>slinha<font color="#808080">.</font>Equals<font color="#808080">(</font><font color="#800000">&quot;&quot;</font><font color="#808080">)==</font><font color="#0000FF"><b>false</b></font><font color="#808080">) {
</font>		mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">);
</font>		mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font>slinha<font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">);
</font>		subMenu<font color="#808080">(</font><font color="#FF0000">8</font><font color="#808080">, </font>sreg<font color="#808080">);
</font>	  <font color="#808080">}
   } </font><font color="#000080"><b>else if </b></font><font color="#808080">(</font>sacao<font color="#808080">==</font>ctAcao<font color="#808080">.</font>opAlterar<font color="#808080">) {
</font>	  mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">);
</font>	  subMenu<font color="#808080">(</font><font color="#FF0000">9</font><font color="#808080">, </font>sreg<font color="#808080">);
   } </font><font color="#000080"><b>else if </b></font><font color="#808080">(</font>sacao<font color="#808080">==</font>ctAcao<font color="#808080">.</font>opExcluir<font color="#808080">) {
</font>	  subMenu<font color="#808080">(</font><font color="#FF0000">10</font><font color="#808080">, </font>sreg<font color="#808080">);
   }
} </font><font color="#000080"><b>else if </b></font><font color="#808080">(</font>sreg<font color="#808080">==</font>ctArqs<font color="#808080">.</font>opEndereco<font color="#808080">) {
   </font><font color="#000080"><b>if </b></font><font color="#808080">(</font>sacao<font color="#808080">==</font>ctAcao<font color="#808080">.</font>opNovo<font color="#808080">) {
</font>	  tEndereco<font color="#808080">.</font>codigo <font color="#808080">= </font>pesqMaxCod<font color="#808080">(</font>tfEndereco<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">));
</font>	  mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">);
</font>	  subMenu<font color="#808080">(</font><font color="#FF0000">7</font><font color="#808080">, </font>sreg<font color="#808080">);
   } </font><font color="#000080"><b>else if </b></font><font color="#808080">(</font>sacao<font color="#808080">==</font>ctAcao<font color="#808080">.</font>opPesquisar<font color="#808080">) {
</font>	  slinha <font color="#808080">= </font>validaEntrada<font color="#808080">(</font>tfEndereco<font color="#808080">,</font>sreg<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font>tEndereco<font color="#808080">.</font>codigo<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,
</font>			  <font color="#0000FF"><b>false</b></font><font color="#808080">,</font>ctTipo<font color="#808080">.</font>opNumero<font color="#808080">);
</font>	  <font color="#000080"><b>if </b></font><font color="#808080">(</font>slinha<font color="#808080">.</font>Equals<font color="#808080">(</font><font color="#800000">&quot;&quot;</font><font color="#808080">)==</font><font color="#0000FF"><b>false</b></font><font color="#808080">) {
</font>		mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">);
</font>		mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font>slinha<font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">);
</font>		subMenu<font color="#808080">(</font><font color="#FF0000">8</font><font color="#808080">, </font>sreg<font color="#808080">);
</font>	  <font color="#808080">}
   } </font><font color="#000080"><b>else if </b></font><font color="#808080">(</font>sacao<font color="#808080">==</font>ctAcao<font color="#808080">.</font>opAlterar<font color="#808080">) {
</font>	  mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">);
</font>	  subMenu<font color="#808080">(</font><font color="#FF0000">9</font><font color="#808080">, </font>sreg<font color="#808080">);
   } </font><font color="#000080"><b>else if </b></font><font color="#808080">(</font>sacao<font color="#808080">==</font>ctAcao<font color="#808080">.</font>opExcluir<font color="#808080">) {
</font>	  subMenu<font color="#808080">(</font><font color="#FF0000">10</font><font color="#808080">, </font>sreg<font color="#808080">);
   }
} </font><font color="#000080"><b>else if </b></font><font color="#808080">(</font>sreg<font color="#808080">==</font>ctArqs<font color="#808080">.</font>opIdioma<font color="#808080">) {
   </font><font color="#000080"><b>if </b></font><font color="#808080">(</font>sacao<font color="#808080">==</font>ctAcao<font color="#808080">.</font>opNovo<font color="#808080">) {
</font>	  tIdioma<font color="#808080">.</font>codigo <font color="#808080">= </font>pesqMaxCod<font color="#808080">(</font>tfIdioma<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">));
</font>	  mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">);
</font>	  subMenu<font color="#808080">(</font><font color="#FF0000">7</font><font color="#808080">, </font>sreg<font color="#808080">);
   } </font><font color="#000080"><b>else if </b></font><font color="#808080">(</font>sacao<font color="#808080">==</font>ctAcao<font color="#808080">.</font>opPesquisar<font color="#808080">) {
</font>	  slinha <font color="#808080">= </font>validaEntrada<font color="#808080">(</font>tfIdioma<font color="#808080">,</font>sreg<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font>tIdioma<font color="#808080">.</font>codigo<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#0000FF"><b>false</b></font><font color="#808080">,</font>ctTipo<font color="#808080">.</font>opNumero<font color="#808080">);
</font>	  <font color="#000080"><b>if </b></font><font color="#808080">(</font>slinha<font color="#808080">.</font>Equals<font color="#808080">(</font><font color="#800000">&quot;&quot;</font><font color="#808080">)==</font><font color="#0000FF"><b>false</b></font><font color="#808080">) {
</font>		mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">);
</font>		mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font>slinha<font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">);
</font>		subMenu<font color="#808080">(</font><font color="#FF0000">8</font><font color="#808080">, </font>sreg<font color="#808080">);
</font>	  <font color="#808080">}
   } </font><font color="#000080"><b>else if </b></font><font color="#808080">(</font>sacao<font color="#808080">==</font>ctAcao<font color="#808080">.</font>opAlterar<font color="#808080">) {
</font>	  mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">);
</font>	  subMenu<font color="#808080">(</font><font color="#FF0000">9</font><font color="#808080">, </font>sreg<font color="#808080">);
   } </font><font color="#000080"><b>else if </b></font><font color="#808080">(</font>sacao<font color="#808080">==</font>ctAcao<font color="#808080">.</font>opExcluir<font color="#808080">) {
</font>	  subMenu<font color="#808080">(</font><font color="#FF0000">10</font><font color="#808080">, </font>sreg<font color="#808080">);
   }
} </font><font color="#000080"><b>else if </b></font><font color="#808080">(</font>sreg<font color="#808080">==</font>ctArqs<font color="#808080">.</font>opPais<font color="#808080">) {
   </font><font color="#000080"><b>if </b></font><font color="#808080">(</font>sacao<font color="#808080">==</font>ctAcao<font color="#808080">.</font>opNovo<font color="#808080">) {
</font>	  System<font color="#808080">.</font>Console<font color="#808080">.</font>Write<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">));
</font>	  tPais<font color="#808080">.</font>codigo <font color="#808080">= </font>System<font color="#808080">.</font>Console<font color="#808080">.</font>In<font color="#808080">.</font>ReadLine<font color="#808080">();
</font>	  slinha <font color="#808080">= </font>pesqArq<font color="#808080">(</font>tfPais<font color="#808080">, </font>tPais<font color="#808080">.</font>codigo<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">));
</font>	  <font color="#000080"><b>if </b></font><font color="#808080">(</font>slinha<font color="#808080">.</font>Equals<font color="#808080">(</font><font color="#800000">&quot;&quot;</font><font color="#808080">)) {
</font>		 pesqLinhaExcluida<font color="#808080">(</font>tfPais<font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">));
</font>		 mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">);
</font>		 subMenu<font color="#808080">(</font><font color="#FF0000">7</font><font color="#808080">, </font>sreg<font color="#808080">);
</font>	  <font color="#808080">} </font><font color="#000080"><b>else </b></font>System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font>MSG_REGEXST<font color="#808080">);
   } </font><font color="#000080"><b>else if </b></font><font color="#808080">(</font>sacao<font color="#808080">==</font>ctAcao<font color="#808080">.</font>opPesquisar<font color="#808080">) {
</font>	  slinha <font color="#808080">= </font>validaEntrada<font color="#808080">(</font>tfPais<font color="#808080">, </font>sreg<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font>tPais<font color="#808080">.</font>codigo<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#0000FF"><b>false</b></font><font color="#808080">, </font>ctTipo<font color="#808080">.</font>opTexto<font color="#808080">);
</font>	  <font color="#000080"><b>if </b></font><font color="#808080">(</font>slinha<font color="#808080">.</font>Equals<font color="#808080">(</font><font color="#800000">&quot;&quot;</font><font color="#808080">)==</font><font color="#0000FF"><b>false</b></font><font color="#808080">) {
</font>		mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">);
</font>		mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font>slinha<font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">);
</font>		subMenu<font color="#808080">(</font><font color="#FF0000">8</font><font color="#808080">, </font>sreg<font color="#808080">);
</font>	  <font color="#808080">}
   } </font><font color="#000080"><b>else if </b></font><font color="#808080">(</font>sacao<font color="#808080">==</font>ctAcao<font color="#808080">.</font>opAlterar<font color="#808080">) {
</font>	  System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">) + </font>tPais<font color="#808080">.</font>codigo<font color="#808080">);
</font>	  mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">);
</font>	  subMenu<font color="#808080">(</font><font color="#FF0000">9</font><font color="#808080">, </font>sreg<font color="#808080">);
   } </font><font color="#000080"><b>else if </b></font><font color="#808080">(</font>sacao<font color="#808080">==</font>ctAcao<font color="#808080">.</font>opExcluir<font color="#808080">) {
</font>	  subMenu<font color="#808080">(</font><font color="#FF0000">10</font><font color="#808080">, </font>sreg<font color="#808080">);
   }
} </font><font color="#000080"><b>else if </b></font><font color="#808080">(</font>sreg<font color="#808080">==</font>ctArqs<font color="#808080">.</font>opProfissao<font color="#808080">) {
   </font><font color="#000080"><b>if </b></font><font color="#808080">(</font>sacao<font color="#808080">==</font>ctAcao<font color="#808080">.</font>opNovo<font color="#808080">) {
</font>	  tProfissao<font color="#808080">.</font>codigo <font color="#808080">= </font>pesqMaxCod<font color="#808080">(</font>tfProfissao<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">));
</font>	  mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">);
</font>	  subMenu<font color="#808080">(</font><font color="#FF0000">7</font><font color="#808080">, </font>sreg<font color="#808080">);
   } </font><font color="#000080"><b>else if </b></font><font color="#808080">(</font>sacao<font color="#808080">==</font>ctAcao<font color="#808080">.</font>opPesquisar<font color="#808080">) {
</font>	  slinha <font color="#808080">= </font>validaEntrada<font color="#808080">(</font>tfProfissao<font color="#808080">,</font>sreg<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font>tProfissao<font color="#808080">.</font>codigo<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,
</font>			  <font color="#0000FF"><b>false</b></font><font color="#808080">,</font>ctTipo<font color="#808080">.</font>opNumero<font color="#808080">);
</font>	  <font color="#000080"><b>if </b></font><font color="#808080">(</font>slinha<font color="#808080">.</font>Equals<font color="#808080">(</font><font color="#800000">&quot;&quot;</font><font color="#808080">)==</font><font color="#0000FF"><b>false</b></font><font color="#808080">) {
</font>		mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">);
</font>		mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font>slinha<font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">);
</font>		subMenu<font color="#808080">(</font><font color="#FF0000">8</font><font color="#808080">, </font>sreg<font color="#808080">);
</font>	  <font color="#808080">}
   } </font><font color="#000080"><b>else if </b></font><font color="#808080">(</font>sacao<font color="#808080">==</font>ctAcao<font color="#808080">.</font>opAlterar<font color="#808080">) {
</font>	  mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">);
</font>	  subMenu<font color="#808080">(</font><font color="#FF0000">9</font><font color="#808080">, </font>sreg<font color="#808080">);
   } </font><font color="#000080"><b>else if </b></font><font color="#808080">(</font>sacao<font color="#808080">==</font>ctAcao<font color="#808080">.</font>opExcluir<font color="#808080">) {
</font>	  subMenu<font color="#808080">(</font><font color="#FF0000">10</font><font color="#808080">, </font>sreg<font color="#808080">);
   }
} </font><font color="#000080"><b>else if </b></font><font color="#808080">(</font>sreg<font color="#808080">==</font>ctArqs<font color="#808080">.</font>opLivro<font color="#808080">) {
   </font><font color="#000080"><b>if </b></font><font color="#808080">(</font>sacao<font color="#808080">==</font>ctAcao<font color="#808080">.</font>opNovo<font color="#808080">) {
</font>	  System<font color="#808080">.</font>Console<font color="#808080">.</font>Write<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">));
</font>	  tLivro<font color="#808080">.</font>isbn <font color="#808080">= </font>System<font color="#808080">.</font>Console<font color="#808080">.</font>In<font color="#808080">.</font>ReadLine<font color="#808080">();
</font>	  <font color="#000080"><b>if </b></font><font color="#808080">(</font>ValidaISBN<font color="#808080">(</font>tLivro<font color="#808080">.</font>isbn<font color="#808080">)) {
</font>		  slinha <font color="#808080">= </font>pesqArq<font color="#808080">(</font>tfLivro<font color="#808080">, </font>tLivro<font color="#808080">.</font>isbn<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">13</font><font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">));
</font>		  <font color="#000080"><b>if </b></font><font color="#808080">(</font>slinha<font color="#808080">.</font>Equals<font color="#808080">(</font><font color="#800000">&quot;&quot;</font><font color="#808080">)) {
</font>			 pesqLinhaExcluida<font color="#808080">(</font>tfLivro<font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">));
</font>			 mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">);
</font>			 subMenu<font color="#808080">(</font><font color="#FF0000">7</font><font color="#808080">, </font>sreg<font color="#808080">);
</font>			 frmCadLigados<font color="#808080">(</font>ctArqs<font color="#808080">.</font>opLivroAss<font color="#808080">, </font>ctAcao<font color="#808080">.</font>opNovo<font color="#808080">, </font>tLivro<font color="#808080">.</font>isbn<font color="#808080">);
</font>			 frmCadLigados<font color="#808080">(</font>ctArqs<font color="#808080">.</font>opLivroAut<font color="#808080">, </font>ctAcao<font color="#808080">.</font>opNovo<font color="#808080">, </font>tLivro<font color="#808080">.</font>isbn<font color="#808080">);
</font>		  <font color="#808080">} </font><font color="#000080"><b>else </b></font>System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font>MSG_REGEXST<font color="#808080">);
</font>	  <font color="#808080">} </font><font color="#000080"><b>else </b></font>System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font>MSG_ISBNINV<font color="#808080">);
   } </font><font color="#000080"><b>else if </b></font><font color="#808080">(</font>sacao<font color="#808080">==</font>ctAcao<font color="#808080">.</font>opPesquisar<font color="#808080">) {
</font>	  slinha <font color="#808080">= </font>validaEntrada<font color="#808080">(</font>tfLivro<font color="#808080">, </font>sreg<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font>tLivro<font color="#808080">.</font>isbn<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#0000FF"><b>false</b></font><font color="#808080">,</font>ctTipo<font color="#808080">.</font>opTexto<font color="#808080">);
</font>	  <font color="#000080"><b>if </b></font><font color="#808080">(</font>slinha<font color="#808080">.</font>Equals<font color="#808080">(</font><font color="#800000">&quot;&quot;</font><font color="#808080">)==</font><font color="#0000FF"><b>false</b></font><font color="#808080">) {
</font>		 mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">);
</font>		 mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font>slinha<font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">);
</font>		 subMenu<font color="#808080">(</font><font color="#FF0000">8</font><font color="#808080">, </font>sreg<font color="#808080">);
</font>	  <font color="#808080">}
   } </font><font color="#000080"><b>else if </b></font><font color="#808080">(</font>sacao<font color="#808080">==</font>ctAcao<font color="#808080">.</font>opAlterar<font color="#808080">) {
</font>	  System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">) + </font>tLivro<font color="#808080">.</font>isbn<font color="#808080">);
</font>	  mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">);
</font>	  subMenu<font color="#808080">(</font><font color="#FF0000">9</font><font color="#808080">, </font>sreg<font color="#808080">);
</font>	  frmCadLigados<font color="#808080">(</font>ctArqs<font color="#808080">.</font>opLivroAss<font color="#808080">, </font>ctAcao<font color="#808080">.</font>opExcluir<font color="#808080">, </font>tLivro<font color="#808080">.</font>isbn<font color="#808080">);
</font>	  System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;Assuntos dos livros exclu&iacute;dos, inclua novos!&quot;</font><font color="#808080">);
</font>	  frmCadLigados<font color="#808080">(</font>ctArqs<font color="#808080">.</font>opLivroAss<font color="#808080">, </font>ctAcao<font color="#808080">.</font>opNovo<font color="#808080">, </font>tLivro<font color="#808080">.</font>isbn<font color="#808080">);
</font>	  frmCadLigados<font color="#808080">(</font>ctArqs<font color="#808080">.</font>opLivroAut<font color="#808080">, </font>ctAcao<font color="#808080">.</font>opExcluir<font color="#808080">, </font>tLivro<font color="#808080">.</font>isbn<font color="#808080">);
</font>	  System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;Autores dos livros exclu&iacute;dos, inclua novos!&quot;</font><font color="#808080">);
</font>	  frmCadLigados<font color="#808080">(</font>ctArqs<font color="#808080">.</font>opLivroAut<font color="#808080">, </font>ctAcao<font color="#808080">.</font>opNovo<font color="#808080">, </font>tLivro<font color="#808080">.</font>isbn<font color="#808080">);
   } </font><font color="#000080"><b>else if </b></font><font color="#808080">(</font>sacao<font color="#808080">==</font>ctAcao<font color="#808080">.</font>opExcluir<font color="#808080">) {
</font>	  subMenu<font color="#808080">(</font><font color="#FF0000">10</font><font color="#808080">, </font>sreg<font color="#808080">);
</font>	  System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;Assuntos dos livros sendo exclu&iacute;dos!&quot;</font><font color="#808080">);
</font>	  frmCadLigados<font color="#808080">(</font>ctArqs<font color="#808080">.</font>opLivroAss<font color="#808080">, </font>ctAcao<font color="#808080">.</font>opExcluir<font color="#808080">, </font>tLivro<font color="#808080">.</font>isbn<font color="#808080">);
</font>	  System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;Autores dos livros sendo exclu&iacute;dos!&quot;</font><font color="#808080">);
</font>	  frmCadLigados<font color="#808080">(</font>ctArqs<font color="#808080">.</font>opLivroAut<font color="#808080">, </font>ctAcao<font color="#808080">.</font>opExcluir<font color="#808080">, </font>tLivro<font color="#808080">.</font>isbn<font color="#808080">);
   }
} </font><font color="#000080"><b>else if </b></font><font color="#808080">(</font>sreg<font color="#808080">==</font>ctArqs<font color="#808080">.</font>opCliente<font color="#808080">) {
   </font><font color="#000080"><b>if </b></font><font color="#808080">(</font>sacao<font color="#808080">==</font>ctAcao<font color="#808080">.</font>opNovo<font color="#808080">) {
</font>	  System<font color="#808080">.</font>Console<font color="#808080">.</font>Write<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">));
</font>	  tCliente<font color="#808080">.</font>cpf <font color="#808080">= </font>System<font color="#808080">.</font>Console<font color="#808080">.</font>In<font color="#808080">.</font>ReadLine<font color="#808080">();
</font>	  <font color="#000080"><b>if </b></font><font color="#808080">(</font>ValidaCPF<font color="#808080">(</font>tCliente<font color="#808080">.</font>cpf<font color="#808080">)) {
</font>		  slinha <font color="#808080">= </font>pesqArq<font color="#808080">(</font>tfCliente<font color="#808080">, </font>tCliente<font color="#808080">.</font>cpf<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">14</font><font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">));
</font>		  <font color="#000080"><b>if </b></font><font color="#808080">(</font>slinha<font color="#808080">.</font>Equals<font color="#808080">(</font><font color="#800000">&quot;&quot;</font><font color="#808080">)) {
</font>			 pesqLinhaExcluida<font color="#808080">(</font>tfCliente<font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">));
</font>			 mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">);
</font>			 subMenu<font color="#808080">(</font><font color="#FF0000">7</font><font color="#808080">, </font>sreg<font color="#808080">);
</font>		  <font color="#808080">} </font><font color="#000080"><b>else </b></font>System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font>MSG_REGEXST<font color="#808080">);
</font>	  <font color="#808080">} </font><font color="#000080"><b>else </b></font>System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font>MSG_CPFINV<font color="#808080">);
   } </font><font color="#000080"><b>else if </b></font><font color="#808080">(</font>sacao<font color="#808080">==</font>ctAcao<font color="#808080">.</font>opPesquisar<font color="#808080">) {
</font>	  slinha <font color="#808080">= </font>validaEntrada<font color="#808080">(</font>tfCliente<font color="#808080">, </font>sreg<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font>tCliente<font color="#808080">.</font>cpf<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#0000FF"><b>false</b></font><font color="#808080">,</font>ctTipo<font color="#808080">.</font>opTexto<font color="#808080">);
</font>	  <font color="#000080"><b>if </b></font><font color="#808080">(</font>slinha<font color="#808080">.</font>Equals<font color="#808080">(</font><font color="#800000">&quot;&quot;</font><font color="#808080">)==</font><font color="#0000FF"><b>false</b></font><font color="#808080">) {
</font>		 mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">);
</font>		 mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font>slinha<font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">);
</font>		 subMenu<font color="#808080">(</font><font color="#FF0000">8</font><font color="#808080">, </font>sreg<font color="#808080">);
</font>	  <font color="#808080">}
   } </font><font color="#000080"><b>else if </b></font><font color="#808080">(</font>sacao<font color="#808080">==</font>ctAcao<font color="#808080">.</font>opAlterar<font color="#808080">) {
</font>	  System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">) + </font>tCliente<font color="#808080">.</font>cpf<font color="#808080">);
</font>	  mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">);
</font>	  subMenu<font color="#808080">(</font><font color="#FF0000">9</font><font color="#808080">, </font>sreg<font color="#808080">);
   } </font><font color="#000080"><b>else if </b></font><font color="#808080">(</font>sacao<font color="#808080">==</font>ctAcao<font color="#808080">.</font>opExcluir<font color="#808080">) {
</font>	  subMenu<font color="#808080">(</font><font color="#FF0000">10</font><font color="#808080">, </font>sreg<font color="#808080">);
   }
} </font><font color="#000080"><b>else if </b></font><font color="#808080">(</font>sreg<font color="#808080">==</font>ctArqs<font color="#808080">.</font>opVenda<font color="#808080">) {
   </font><font color="#000080"><b>if </b></font><font color="#808080">(</font>sacao<font color="#808080">==</font>ctAcao<font color="#808080">.</font>opNovo<font color="#808080">) {
</font>	  tVenda<font color="#808080">.</font>dthrvenda <font color="#808080">= </font>retDataHora<font color="#808080">();
</font>	  System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">) + </font>tVenda<font color="#808080">.</font>dthrvenda<font color="#808080">);
</font>	  slinha <font color="#808080">= </font>pesqArq<font color="#808080">(</font>tfVenda<font color="#808080">, </font>tVenda<font color="#808080">.</font>dthrvenda<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">19</font><font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">));
</font>	  <font color="#000080"><b>if </b></font><font color="#808080">(</font>slinha<font color="#808080">.</font>Equals<font color="#808080">(</font><font color="#800000">&quot;&quot;</font><font color="#808080">)) {
</font>		 slinha <font color="#808080">= </font>validaEntrada<font color="#808080">(</font>tfCliente<font color="#808080">,</font>ctArqs<font color="#808080">.</font>opCliente<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font>tVenda<font color="#808080">.</font>cpf<font color="#808080">,</font><font color="#FF0000">3</font><font color="#808080">,
</font>				 <font color="#0000FF"><b>false</b></font><font color="#808080">,</font>ctTipo<font color="#808080">.</font>opTexto<font color="#808080">);
</font>		 <font color="#000080"><b>if </b></font><font color="#808080">(</font>slinha<font color="#808080">.</font>Equals<font color="#808080">(</font><font color="#800000">&quot;&quot;</font><font color="#808080">)==</font><font color="#0000FF"><b>false</b></font><font color="#808080">) {
</font>			tVenda<font color="#808080">.</font>cpf <font color="#808080">= </font>copy<font color="#808080">(</font>slinha<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#FF0000">14</font><font color="#808080">).</font>Trim<font color="#808080">();
</font>			<font color="#000080"><b>if </b></font><font color="#808080">(</font>ValidaCPF<font color="#808080">(</font>tVenda<font color="#808080">.</font>cpf<font color="#808080">)) {
</font>			   System<font color="#808080">.</font>Console<font color="#808080">.</font>Write<font color="#808080">(</font><font color="#800000">&quot; &quot; </font><font color="#808080">+ </font>rotulo<font color="#808080">(</font>ctArqs<font color="#808080">.</font>opCliente<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">)); <i>/* Nome */
</i></font>			   System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font>g_nPosChave<font color="#808080">, </font>g_nTamChave<font color="#808080">));
</font>			   frmCadLigados<font color="#808080">(</font>ctArqs<font color="#808080">.</font>opVenda<font color="#808080">, </font>ctAcao<font color="#808080">.</font>opNovo<font color="#808080">, </font>tVenda<font color="#808080">.</font>cpf<font color="#808080">);
</font>			<font color="#808080">} </font><font color="#000080"><b>else </b></font>System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font>MSG_CPFINV<font color="#808080">);
</font>		 <font color="#808080">}
</font>	  <font color="#808080">} </font><font color="#000080"><b>else </b></font>System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font>MSG_REGEXST<font color="#808080">);
   } </font><font color="#000080"><b>else if </b></font><font color="#808080">(</font>sacao<font color="#808080">==</font>ctAcao<font color="#808080">.</font>opPesquisar<font color="#808080">) {
</font>	  slinha <font color="#808080">= </font>validaEntrada<font color="#808080">(</font>tfVenda<font color="#808080">, </font>sreg<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font>tVenda<font color="#808080">.</font>dthrvenda<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,
</font>			  <font color="#0000FF"><b>false</b></font><font color="#808080">,</font>ctTipo<font color="#808080">.</font>opDataHora<font color="#808080">);
</font>	  <font color="#000080"><b>if </b></font><font color="#808080">(</font>slinha<font color="#808080">.</font>Equals<font color="#808080">(</font><font color="#800000">&quot;&quot;</font><font color="#808080">)==</font><font color="#0000FF"><b>false</b></font><font color="#808080">) {
</font>		mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">);
</font>		mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font>slinha<font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">);
</font>		subMenu<font color="#808080">(</font><font color="#FF0000">8</font><font color="#808080">, </font>sreg<font color="#808080">);
</font>	  <font color="#808080">}
   }
}

}
<i>/*------------------------------------------------------------------------------
Realiza as consultas de acordo com o tipo de arquivo.
sreg - o tipo de arquivo
sacao - a a&ccedil;&atilde;o a ser realizada
------------------------------------------------------------------------------*/
</i></font><font color="#0000FF"><b>void </b></font>frmConsultas<font color="#808080">(</font>ctArqs sreg<font color="#808080">, </font>ctAcao sacao<font color="#808080">)
{ </font><font color="#0000FF"><b>string </b></font>slinha <font color="#808080">= </font><font color="#800000">&quot;&quot;</font><font color="#808080">;

</font><font color="#000080"><b>if </b></font><font color="#808080">(</font>sreg<font color="#808080">==</font>ctArqs<font color="#808080">.</font>opAssunto<font color="#808080">) {
   </font><font color="#000080"><b>if </b></font><font color="#808080">(</font>sacao<font color="#808080">==</font>ctAcao<font color="#808080">.</font>opPesquisar<font color="#808080">)
</font>	  slinha <font color="#808080">= </font>validaEntrada<font color="#808080">(</font>tfAssunto<font color="#808080">,</font>sreg<font color="#808080">,</font><font color="#FF0000">2</font><font color="#808080">,</font>tAssunto<font color="#808080">.</font>assunto<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#0000FF"><b>true</b></font><font color="#808080">,</font>ctTipo<font color="#808080">.</font>opTexto<font color="#808080">);
   </font><font color="#000080"><b>else if </b></font><font color="#808080">(</font>sacao<font color="#808080">==</font>ctAcao<font color="#808080">.</font>opListarTodos<font color="#808080">) {
</font>	  <font color="#000080"><b>if </b></font><font color="#808080">(</font>ListarTodos<font color="#808080">(</font>tfAssunto<font color="#808080">, </font>sreg<font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">),
</font>		QTD_MAX_LINHA<font color="#808080">, </font><font color="#0000FF"><b>false</b></font><font color="#808080">) == </font><font color="#0000FF"><b>false</b></font><font color="#808080">)
</font>		System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">));
   }
} </font><font color="#000080"><b>else if </b></font><font color="#808080">(</font>sreg<font color="#808080">==</font>ctArqs<font color="#808080">.</font>opAutor<font color="#808080">) {
   </font><font color="#000080"><b>if </b></font><font color="#808080">(</font>sacao<font color="#808080">==</font>ctAcao<font color="#808080">.</font>opPesquisar<font color="#808080">)
</font>	  slinha <font color="#808080">= </font>validaEntrada<font color="#808080">(</font>tfAutor<font color="#808080">,</font>sreg<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">, </font>tAutor<font color="#808080">.</font>autor<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#0000FF"><b>true</b></font><font color="#808080">,</font>ctTipo<font color="#808080">.</font>opTexto<font color="#808080">);
   </font><font color="#000080"><b>else if </b></font><font color="#808080">(</font>sacao<font color="#808080">==</font>ctAcao<font color="#808080">.</font>opListarTodos<font color="#808080">) {
</font>	  <font color="#000080"><b>if </b></font><font color="#808080">(</font>ListarTodos<font color="#808080">(</font>tfAutor<font color="#808080">, </font>sreg<font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">),
</font>		QTD_MAX_LINHA<font color="#808080">, </font><font color="#0000FF"><b>false</b></font><font color="#808080">) == </font><font color="#0000FF"><b>false</b></font><font color="#808080">)
</font>		System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">));
   }
} </font><font color="#000080"><b>else if </b></font><font color="#808080">(</font>sreg<font color="#808080">==</font>ctArqs<font color="#808080">.</font>opEditora<font color="#808080">) {
   </font><font color="#000080"><b>if </b></font><font color="#808080">(</font>sacao<font color="#808080">==</font>ctAcao<font color="#808080">.</font>opPesquisar<font color="#808080">)
</font>	  slinha <font color="#808080">= </font>validaEntrada<font color="#808080">(</font>tfEditora<font color="#808080">,</font>sreg<font color="#808080">,</font><font color="#FF0000">2</font><font color="#808080">,</font>tEditora<font color="#808080">.</font>editora<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#0000FF"><b>true</b></font><font color="#808080">,</font>ctTipo<font color="#808080">.</font>opTexto<font color="#808080">);
   </font><font color="#000080"><b>else if </b></font><font color="#808080">(</font>sacao<font color="#808080">==</font>ctAcao<font color="#808080">.</font>opListarTodos<font color="#808080">) {
</font>	  <font color="#000080"><b>if </b></font><font color="#808080">(</font>ListarTodos<font color="#808080">(</font>tfEditora<font color="#808080">, </font>sreg<font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">),
</font>		QTD_MAX_LINHA<font color="#808080">, </font><font color="#0000FF"><b>false</b></font><font color="#808080">) == </font><font color="#0000FF"><b>false</b></font><font color="#808080">)
</font>		System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">));
   }
} </font><font color="#000080"><b>else if </b></font><font color="#808080">(</font>sreg<font color="#808080">==</font>ctArqs<font color="#808080">.</font>opEndereco<font color="#808080">) {
   </font><font color="#000080"><b>if </b></font><font color="#808080">(</font>sacao<font color="#808080">==</font>ctAcao<font color="#808080">.</font>opPesquisar<font color="#808080">)
</font>	  slinha <font color="#808080">= </font>validaEntrada<font color="#808080">(</font>tfEndereco<font color="#808080">,</font>sreg<font color="#808080">,</font><font color="#FF0000">2</font><font color="#808080">,</font>tEndereco<font color="#808080">.</font>logradouro<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,
</font>			  <font color="#0000FF"><b>true</b></font><font color="#808080">,</font>ctTipo<font color="#808080">.</font>opTexto<font color="#808080">);
   </font><font color="#000080"><b>else if </b></font><font color="#808080">(</font>sacao<font color="#808080">==</font>ctAcao<font color="#808080">.</font>opListarTodos<font color="#808080">) {
</font>	  <font color="#000080"><b>if </b></font><font color="#808080">(</font>ListarTodos<font color="#808080">(</font>tfEndereco<font color="#808080">, </font>sreg<font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">),
</font>		 <font color="#FF0000">3</font><font color="#808080">, </font><font color="#0000FF"><b>false</b></font><font color="#808080">) == </font><font color="#0000FF"><b>false</b></font><font color="#808080">)
</font>		System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">));
   }
} </font><font color="#000080"><b>else if </b></font><font color="#808080">(</font>sreg<font color="#808080">==</font>ctArqs<font color="#808080">.</font>opIdioma<font color="#808080">) {
   </font><font color="#000080"><b>if </b></font><font color="#808080">(</font>sacao<font color="#808080">==</font>ctAcao<font color="#808080">.</font>opPesquisar<font color="#808080">)
</font>	  slinha <font color="#808080">= </font>validaEntrada<font color="#808080">(</font>tfIdioma<font color="#808080">, </font>sreg<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">, </font>tIdioma<font color="#808080">.</font>idioma<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#0000FF"><b>true</b></font><font color="#808080">,</font>ctTipo<font color="#808080">.</font>opTexto<font color="#808080">);
   </font><font color="#000080"><b>else if </b></font><font color="#808080">(</font>sacao<font color="#808080">==</font>ctAcao<font color="#808080">.</font>opListarTodos<font color="#808080">) {
</font>	  <font color="#000080"><b>if </b></font><font color="#808080">(</font>ListarTodos<font color="#808080">(</font>tfIdioma<font color="#808080">, </font>sreg<font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">),
</font>		QTD_MAX_LINHA<font color="#808080">, </font><font color="#0000FF"><b>false</b></font><font color="#808080">) == </font><font color="#0000FF"><b>false</b></font><font color="#808080">)
</font>		System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">));
   }
} </font><font color="#000080"><b>else if </b></font><font color="#808080">(</font>sreg<font color="#808080">==</font>ctArqs<font color="#808080">.</font>opPais<font color="#808080">) {
   </font><font color="#000080"><b>if </b></font><font color="#808080">(</font>sacao<font color="#808080">==</font>ctAcao<font color="#808080">.</font>opPesquisar<font color="#808080">)
</font>	  slinha <font color="#808080">= </font>validaEntrada<font color="#808080">(</font>tfPais<font color="#808080">, </font>sreg<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">, </font>tPais<font color="#808080">.</font>pais<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#0000FF"><b>true</b></font><font color="#808080">,</font>ctTipo<font color="#808080">.</font>opTexto<font color="#808080">);
   </font><font color="#000080"><b>else if </b></font><font color="#808080">(</font>sacao<font color="#808080">==</font>ctAcao<font color="#808080">.</font>opListarTodos<font color="#808080">) {
</font>	  <font color="#000080"><b>if </b></font><font color="#808080">(</font>ListarTodos<font color="#808080">(</font>tfPais<font color="#808080">, </font>sreg<font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">),
</font>		QTD_MAX_LINHA<font color="#808080">, </font><font color="#0000FF"><b>false</b></font><font color="#808080">) == </font><font color="#0000FF"><b>false</b></font><font color="#808080">)
</font>		System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">));
   }
} </font><font color="#000080"><b>else if </b></font><font color="#808080">(</font>sreg<font color="#808080">==</font>ctArqs<font color="#808080">.</font>opProfissao<font color="#808080">) {
   </font><font color="#000080"><b>if </b></font><font color="#808080">(</font>sacao<font color="#808080">==</font>ctAcao<font color="#808080">.</font>opPesquisar<font color="#808080">)
</font>	 slinha <font color="#808080">= </font>validaEntrada<font color="#808080">(</font>tfProfissao<font color="#808080">,</font>sreg<font color="#808080">,</font><font color="#FF0000">2</font><font color="#808080">,</font>tProfissao<font color="#808080">.</font>profissao<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,
</font>			 <font color="#0000FF"><b>true</b></font><font color="#808080">,</font>ctTipo<font color="#808080">.</font>opTexto<font color="#808080">);
   </font><font color="#000080"><b>else if </b></font><font color="#808080">(</font>sacao<font color="#808080">==</font>ctAcao<font color="#808080">.</font>opListarTodos<font color="#808080">) {
</font>	  <font color="#000080"><b>if </b></font><font color="#808080">(</font>ListarTodos<font color="#808080">(</font>tfProfissao<font color="#808080">, </font>sreg<font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">),
</font>		QTD_MAX_LINHA<font color="#808080">, </font><font color="#0000FF"><b>false</b></font><font color="#808080">) == </font><font color="#0000FF"><b>false</b></font><font color="#808080">)
</font>		System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">));
   }
} </font><font color="#000080"><b>else if </b></font><font color="#808080">(</font>sreg<font color="#808080">==</font>ctArqs<font color="#808080">.</font>opLivro<font color="#808080">) {
   </font><font color="#000080"><b>if </b></font><font color="#808080">(</font>sacao<font color="#808080">==</font>ctAcao<font color="#808080">.</font>opPesquisar<font color="#808080">)
</font>	  slinha <font color="#808080">= </font>validaEntrada<font color="#808080">(</font>tfLivro<font color="#808080">, </font>sreg<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">, </font>tLivro<font color="#808080">.</font>titulo<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#0000FF"><b>true</b></font><font color="#808080">,</font>ctTipo<font color="#808080">.</font>opTexto<font color="#808080">);
   </font><font color="#000080"><b>else if </b></font><font color="#808080">(</font>sacao<font color="#808080">==</font>ctAcao<font color="#808080">.</font>opListarTodos<font color="#808080">) {
</font>	  <font color="#000080"><b>if </b></font><font color="#808080">(</font>ListarTodos<font color="#808080">(</font>tfLivro<font color="#808080">, </font>sreg<font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">),
</font>		<font color="#FF0000">1</font><font color="#808080">, </font><font color="#0000FF"><b>false</b></font><font color="#808080">) == </font><font color="#0000FF"><b>false</b></font><font color="#808080">)
</font>		System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">));
   }
} </font><font color="#000080"><b>else if </b></font><font color="#808080">(</font>sreg<font color="#808080">==</font>ctArqs<font color="#808080">.</font>opCliente<font color="#808080">) {
   </font><font color="#000080"><b>if </b></font><font color="#808080">(</font>sacao<font color="#808080">==</font>ctAcao<font color="#808080">.</font>opPesquisar<font color="#808080">)
</font>	  slinha <font color="#808080">= </font>validaEntrada<font color="#808080">(</font>tfCliente<font color="#808080">, </font>sreg<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">, </font>tCliente<font color="#808080">.</font>nome<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#0000FF"><b>true</b></font><font color="#808080">,</font>ctTipo<font color="#808080">.</font>opTexto<font color="#808080">);
   </font><font color="#000080"><b>else if </b></font><font color="#808080">(</font>sacao<font color="#808080">==</font>ctAcao<font color="#808080">.</font>opListarTodos<font color="#808080">) {
</font>	  <font color="#000080"><b>if </b></font><font color="#808080">(</font>ListarTodos<font color="#808080">(</font>tfCliente<font color="#808080">, </font>sreg<font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">),
</font>		<font color="#FF0000">1</font><font color="#808080">, </font><font color="#0000FF"><b>false</b></font><font color="#808080">) == </font><font color="#0000FF"><b>false</b></font><font color="#808080">)
</font>		System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">));
   }
} </font><font color="#000080"><b>else if </b></font><font color="#808080">(</font>sreg<font color="#808080">==</font>ctArqs<font color="#808080">.</font>opVenda<font color="#808080">) {
   </font><font color="#000080"><b>if </b></font><font color="#808080">(</font>sacao<font color="#808080">==</font>ctAcao<font color="#808080">.</font>opPesquisar<font color="#808080">)
</font>	  slinha <font color="#808080">= </font>validaEntrada<font color="#808080">(</font>tfVenda<font color="#808080">, </font>sreg<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">, </font>tVenda<font color="#808080">.</font>cpf<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#0000FF"><b>true</b></font><font color="#808080">,</font>ctTipo<font color="#808080">.</font>opTexto<font color="#808080">);
   </font><font color="#000080"><b>else if </b></font><font color="#808080">(</font>sacao<font color="#808080">==</font>ctAcao<font color="#808080">.</font>opListarTodos<font color="#808080">) {
</font>	  <font color="#000080"><b>if </b></font><font color="#808080">(</font>ListarTodos<font color="#808080">(</font>tfVenda<font color="#808080">, </font>sreg<font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">),
</font>		QTD_MAX_LINHA<font color="#808080">, </font><font color="#0000FF"><b>false</b></font><font color="#808080">) == </font><font color="#0000FF"><b>false</b></font><font color="#808080">)
</font>		System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">));
   }
}
</font><font color="#000080"><b>if </b></font><font color="#808080">(</font>slinha<font color="#808080">.</font>Equals<font color="#808080">(</font><font color="#800000">&quot;&quot;</font><font color="#808080">))
   </font>System<font color="#808080">.</font>Console<font color="#808080">.</font>Write<font color="#808080">(</font><font color="#800000">&quot;&quot;</font><font color="#808080">);
}
<i>/*------------------------------------------------------------------------------
Mostra a tela de altera&ccedil;&atilde;o de senha do sistema e realiza a altera&ccedil;&atilde;o.
------------------------------------------------------------------------------*/
</i></font><font color="#0000FF"><b>void </b></font>frmAlterarSenha<font color="#808080">()
{ </font>Boolean bQuebra<font color="#808080">;
  </font><font color="#0000FF"><b>string </b></font>sres<font color="#808080">, </font>sSenhaAtual<font color="#808080">, </font>sNovaSenha<font color="#808080">, </font>sConfirmaSenha<font color="#808080">;
  </font><font color="#0000FF"><b>int </b></font>nopcao<font color="#808080">;

</font>sSenhaAtual <font color="#808080">= </font><font color="#800000">&quot;&quot;</font><font color="#808080">;
</font>sNovaSenha <font color="#808080">= </font><font color="#800000">&quot;&quot;</font><font color="#808080">;
</font>sConfirmaSenha <font color="#808080">= </font><font color="#800000">&quot;&quot;</font><font color="#808080">;

</font>System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font>rotulo<font color="#808080">(</font>ctArqs<font color="#808080">.</font>opUsuario<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">) + </font>tUsuario<font color="#808080">.</font>login<font color="#808080">);
</font>nopcao <font color="#808080">= </font><font color="#FF0000">1</font><font color="#808080">;
</font>bQuebra <font color="#808080">= </font><font color="#0000FF"><b>false</b></font><font color="#808080">;
</font><font color="#000080"><b>while </b></font><font color="#808080">(</font>bQuebra<font color="#808080">==</font><font color="#0000FF"><b>false</b></font><font color="#808080">) {
  </font><font color="#000080"><b>switch</b></font><font color="#808080">(</font>nopcao<font color="#808080">) {
   </font><font color="#000080"><b>case </b></font><font color="#FF0000">1</font><font color="#808080">: {
       </font>sSenhaAtual <font color="#808080">= </font>digitaSenha<font color="#808080">(</font><font color="#800000">&quot;Senha Atual: &quot;</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">);
</font>	   <font color="#000080"><b>if </b></font><font color="#808080">(</font>sSenhaAtual<font color="#808080">.</font>Equals<font color="#808080">(</font>tUsuario<font color="#808080">.</font>senha<font color="#808080">)==</font><font color="#0000FF"><b>false</b></font><font color="#808080">) {
</font>		  System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font>MSG_SENCONFERE<font color="#808080">);
</font>		  bQuebra <font color="#808080">= </font><font color="#0000FF"><b>true</b></font><font color="#808080">;
</font>	   <font color="#808080">} </font><font color="#000080"><b>else </b></font>nopcao <font color="#808080">= </font><font color="#FF0000">2</font><font color="#808080">;
</font>	  <font color="#808080">} </font><font color="#000080"><b>break</b></font><font color="#808080">;
   </font><font color="#000080"><b>case </b></font><font color="#FF0000">2</font><font color="#808080">: {
</font>	   sNovaSenha <font color="#808080">= </font>digitaSenha<font color="#808080">(</font><font color="#800000">&quot;Nova Senha: &quot;</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">);
</font>	   sConfirmaSenha <font color="#808080">= </font>digitaSenha<font color="#808080">(</font><font color="#800000">&quot;Confirma Senha: &quot;</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">);
</font>	   <font color="#000080"><b>if </b></font><font color="#808080">(</font>sNovaSenha<font color="#808080">.</font>Equals<font color="#808080">(</font>sConfirmaSenha<font color="#808080">)==</font><font color="#0000FF"><b>false</b></font><font color="#808080">) {
</font>		  System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font>MSG_SENCONFIRM<font color="#808080">);
</font>		  bQuebra <font color="#808080">= </font><font color="#0000FF"><b>true</b></font><font color="#808080">;
</font>	   <font color="#808080">} </font><font color="#000080"><b>else </b></font>nopcao <font color="#808080">= </font><font color="#FF0000">3</font><font color="#808080">;
</font>	  <font color="#808080">} </font><font color="#000080"><b>break</b></font><font color="#808080">;
   </font><font color="#000080"><b>case </b></font><font color="#FF0000">3</font><font color="#808080">: {
</font>	   sres <font color="#808080">= </font>pesqArq<font color="#808080">(</font>tfUsuario<font color="#808080">, </font>tUsuario<font color="#808080">.</font>login<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">, </font>tamReg<font color="#808080">(</font>ctArqs<font color="#808080">.</font>opUsuario<font color="#808080">));
</font>	   <font color="#000080"><b>if </b></font><font color="#808080">(</font>sres<font color="#808080">.</font>Equals<font color="#808080">(</font><font color="#800000">&quot;&quot;</font><font color="#808080">))
</font>		 System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font>MSG_LOGINENCON<font color="#808080">);
</font>	   <font color="#000080"><b>else </b></font><font color="#808080">{
</font>		 tUsuario<font color="#808080">.</font>senha <font color="#808080">= </font>sConfirmaSenha<font color="#808080">;
</font>		 subMenu<font color="#808080">(</font><font color="#FF0000">9</font><font color="#808080">,</font>ctArqs<font color="#808080">.</font>opUsuario<font color="#808080">);
</font>		 bQuebra <font color="#808080">= </font><font color="#0000FF"><b>true</b></font><font color="#808080">;
</font>	   <font color="#808080">}
</font>	  <font color="#808080">} </font><font color="#000080"><b>break</b></font><font color="#808080">;
  }
}
}
<i>/*------------------------------------------------------------------------------
Executa uma a&ccedil;&atilde;o de grava&ccedil;&atilde;o de acordo com o tipo de arquivo.
sreg - o tipo de arquivo
sacao - a a&ccedil;&atilde;o a ser realizada
------------------------------------------------------------------------------*/
</i></font><font color="#0000FF"><b>void </b></font>btnAcao<font color="#808080">(</font>ctArqs sreg<font color="#808080">, </font>ctAcao sacao<font color="#808080">)
{
</font><font color="#000080"><b>if </b></font><font color="#808080">(</font>sreg<font color="#808080">==</font>ctArqs<font color="#808080">.</font>opAssunto<font color="#808080">) {
   </font><font color="#000080"><b>if </b></font><font color="#808080">(</font>sacao<font color="#808080">==</font>ctAcao<font color="#808080">.</font>opSalvarInclusao<font color="#808080">)
</font>	  escreveArq<font color="#808080">(</font>tfAssunto<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGINC<font color="#808080">, </font>MSG_REGNINC<font color="#808080">);
   </font><font color="#000080"><b>else if </b></font><font color="#808080">(</font>sacao<font color="#808080">==</font>ctAcao<font color="#808080">.</font>opSalvarAlteracao<font color="#808080">)
</font>	  escreveArq<font color="#808080">(</font>tfAssunto<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGALT<font color="#808080">, </font>MSG_REGNALT<font color="#808080">);
   </font><font color="#000080"><b>else if </b></font><font color="#808080">(</font>sacao<font color="#808080">==</font>ctAcao<font color="#808080">.</font>opConfirmaExclusao<font color="#808080">)
</font>	  escreveArq<font color="#808080">(</font>tfAssunto<font color="#808080">, </font>repete<font color="#808080">(</font><font color="#800000">&quot;*&quot;</font><font color="#808080">,</font>tamReg<font color="#808080">(</font>sreg<font color="#808080">)), </font>MSG_REGEXC<font color="#808080">, </font>MSG_REGNEXC<font color="#808080">);
} </font><font color="#000080"><b>else if </b></font><font color="#808080">(</font>sreg<font color="#808080">==</font>ctArqs<font color="#808080">.</font>opAutor<font color="#808080">) {
   </font><font color="#000080"><b>if </b></font><font color="#808080">(</font>sacao<font color="#808080">==</font>ctAcao<font color="#808080">.</font>opSalvarInclusao<font color="#808080">)
</font>	  escreveArq<font color="#808080">(</font>tfAutor<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGINC<font color="#808080">, </font>MSG_REGNINC<font color="#808080">);
   </font><font color="#000080"><b>else if </b></font><font color="#808080">(</font>sacao<font color="#808080">==</font>ctAcao<font color="#808080">.</font>opSalvarAlteracao<font color="#808080">)
</font>	  escreveArq<font color="#808080">(</font>tfAutor<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGALT<font color="#808080">, </font>MSG_REGNALT<font color="#808080">);
   </font><font color="#000080"><b>else if </b></font><font color="#808080">(</font>sacao<font color="#808080">==</font>ctAcao<font color="#808080">.</font>opConfirmaExclusao<font color="#808080">)
</font>	  escreveArq<font color="#808080">(</font>tfAutor<font color="#808080">, </font>repete<font color="#808080">(</font><font color="#800000">&quot;*&quot;</font><font color="#808080">,</font>tamReg<font color="#808080">(</font>sreg<font color="#808080">)), </font>MSG_REGEXC<font color="#808080">, </font>MSG_REGNEXC<font color="#808080">);
} </font><font color="#000080"><b>else if </b></font><font color="#808080">(</font>sreg<font color="#808080">==</font>ctArqs<font color="#808080">.</font>opEditora<font color="#808080">) {
   </font><font color="#000080"><b>if </b></font><font color="#808080">(</font>sacao<font color="#808080">==</font>ctAcao<font color="#808080">.</font>opSalvarInclusao<font color="#808080">)
</font>	  escreveArq<font color="#808080">(</font>tfEditora<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGINC<font color="#808080">, </font>MSG_REGNINC<font color="#808080">);
   </font><font color="#000080"><b>else if </b></font><font color="#808080">(</font>sacao<font color="#808080">==</font>ctAcao<font color="#808080">.</font>opSalvarAlteracao<font color="#808080">)
</font>	  escreveArq<font color="#808080">(</font>tfEditora<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGALT<font color="#808080">, </font>MSG_REGNALT<font color="#808080">);
   </font><font color="#000080"><b>else if </b></font><font color="#808080">(</font>sacao<font color="#808080">==</font>ctAcao<font color="#808080">.</font>opConfirmaExclusao<font color="#808080">)
</font>	  escreveArq<font color="#808080">(</font>tfEditora<font color="#808080">, </font>repete<font color="#808080">(</font><font color="#800000">&quot;*&quot;</font><font color="#808080">,</font>tamReg<font color="#808080">(</font>sreg<font color="#808080">)), </font>MSG_REGEXC<font color="#808080">, </font>MSG_REGNEXC<font color="#808080">);
} </font><font color="#000080"><b>else if </b></font><font color="#808080">(</font>sreg<font color="#808080">==</font>ctArqs<font color="#808080">.</font>opEndereco<font color="#808080">) {
   </font><font color="#000080"><b>if </b></font><font color="#808080">(</font>sacao<font color="#808080">==</font>ctAcao<font color="#808080">.</font>opSalvarInclusao<font color="#808080">)
</font>	  escreveArq<font color="#808080">(</font>tfEndereco<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGINC<font color="#808080">, </font>MSG_REGNINC<font color="#808080">);
   </font><font color="#000080"><b>else if </b></font><font color="#808080">(</font>sacao<font color="#808080">==</font>ctAcao<font color="#808080">.</font>opSalvarAlteracao<font color="#808080">)
</font>	  escreveArq<font color="#808080">(</font>tfEndereco<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGALT<font color="#808080">, </font>MSG_REGNALT<font color="#808080">);
   </font><font color="#000080"><b>else if </b></font><font color="#808080">(</font>sacao<font color="#808080">==</font>ctAcao<font color="#808080">.</font>opConfirmaExclusao<font color="#808080">)
</font>	  escreveArq<font color="#808080">(</font>tfEndereco<font color="#808080">, </font>repete<font color="#808080">(</font><font color="#800000">&quot;*&quot;</font><font color="#808080">,</font>tamReg<font color="#808080">(</font>sreg<font color="#808080">)), </font>MSG_REGEXC<font color="#808080">, </font>MSG_REGNEXC<font color="#808080">);
} </font><font color="#000080"><b>else if </b></font><font color="#808080">(</font>sreg<font color="#808080">==</font>ctArqs<font color="#808080">.</font>opIdioma<font color="#808080">) {
   </font><font color="#000080"><b>if </b></font><font color="#808080">(</font>sacao<font color="#808080">==</font>ctAcao<font color="#808080">.</font>opSalvarInclusao<font color="#808080">)
</font>	  escreveArq<font color="#808080">(</font>tfIdioma<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGINC<font color="#808080">, </font>MSG_REGNINC<font color="#808080">);
   </font><font color="#000080"><b>else if </b></font><font color="#808080">(</font>sacao<font color="#808080">==</font>ctAcao<font color="#808080">.</font>opSalvarAlteracao<font color="#808080">)
</font>	  escreveArq<font color="#808080">(</font>tfIdioma<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGALT<font color="#808080">, </font>MSG_REGNALT<font color="#808080">);
   </font><font color="#000080"><b>else if </b></font><font color="#808080">(</font>sacao<font color="#808080">==</font>ctAcao<font color="#808080">.</font>opConfirmaExclusao<font color="#808080">)
</font>	  escreveArq<font color="#808080">(</font>tfIdioma<font color="#808080">, </font>repete<font color="#808080">(</font><font color="#800000">&quot;*&quot;</font><font color="#808080">,</font>tamReg<font color="#808080">(</font>sreg<font color="#808080">)), </font>MSG_REGEXC<font color="#808080">, </font>MSG_REGNEXC<font color="#808080">);
} </font><font color="#000080"><b>else if </b></font><font color="#808080">(</font>sreg<font color="#808080">==</font>ctArqs<font color="#808080">.</font>opPais<font color="#808080">) {
   </font><font color="#000080"><b>if </b></font><font color="#808080">(</font>sacao<font color="#808080">==</font>ctAcao<font color="#808080">.</font>opSalvarInclusao<font color="#808080">)
</font>	  escreveArq<font color="#808080">(</font>tfPais<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGINC<font color="#808080">, </font>MSG_REGNINC<font color="#808080">);
   </font><font color="#000080"><b>else if </b></font><font color="#808080">(</font>sacao<font color="#808080">==</font>ctAcao<font color="#808080">.</font>opSalvarAlteracao<font color="#808080">)
</font>	  escreveArq<font color="#808080">(</font>tfPais<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGALT<font color="#808080">, </font>MSG_REGNALT<font color="#808080">);
   </font><font color="#000080"><b>else if </b></font><font color="#808080">(</font>sacao<font color="#808080">==</font>ctAcao<font color="#808080">.</font>opConfirmaExclusao<font color="#808080">)
</font>	  escreveArq<font color="#808080">(</font>tfPais<font color="#808080">, </font>repete<font color="#808080">(</font><font color="#800000">&quot;*&quot;</font><font color="#808080">,</font>tamReg<font color="#808080">(</font>sreg<font color="#808080">)), </font>MSG_REGEXC<font color="#808080">, </font>MSG_REGNEXC<font color="#808080">);
} </font><font color="#000080"><b>else if </b></font><font color="#808080">(</font>sreg<font color="#808080">==</font>ctArqs<font color="#808080">.</font>opProfissao<font color="#808080">) {
   </font><font color="#000080"><b>if </b></font><font color="#808080">(</font>sacao<font color="#808080">==</font>ctAcao<font color="#808080">.</font>opSalvarInclusao<font color="#808080">)
</font>	  escreveArq<font color="#808080">(</font>tfProfissao<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGINC<font color="#808080">, </font>MSG_REGNINC<font color="#808080">);
   </font><font color="#000080"><b>else if </b></font><font color="#808080">(</font>sacao<font color="#808080">==</font>ctAcao<font color="#808080">.</font>opSalvarAlteracao<font color="#808080">)
</font>	  escreveArq<font color="#808080">(</font>tfProfissao<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGALT<font color="#808080">, </font>MSG_REGNALT<font color="#808080">);
   </font><font color="#000080"><b>else if </b></font><font color="#808080">(</font>sacao<font color="#808080">==</font>ctAcao<font color="#808080">.</font>opConfirmaExclusao<font color="#808080">)
</font>	 escreveArq<font color="#808080">(</font>tfProfissao<font color="#808080">, </font>repete<font color="#808080">(</font><font color="#800000">&quot;*&quot;</font><font color="#808080">,</font>tamReg<font color="#808080">(</font>sreg<font color="#808080">)), </font>MSG_REGEXC<font color="#808080">, </font>MSG_REGNEXC<font color="#808080">);
} </font><font color="#000080"><b>else if </b></font><font color="#808080">(</font>sreg<font color="#808080">==</font>ctArqs<font color="#808080">.</font>opLivro<font color="#808080">) {
   </font><font color="#000080"><b>if </b></font><font color="#808080">(</font>sacao<font color="#808080">==</font>ctAcao<font color="#808080">.</font>opSalvarInclusao<font color="#808080">)
</font>	  escreveArq<font color="#808080">(</font>tfLivro<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGINC<font color="#808080">, </font>MSG_REGNINC<font color="#808080">);
   </font><font color="#000080"><b>else if </b></font><font color="#808080">(</font>sacao<font color="#808080">==</font>ctAcao<font color="#808080">.</font>opSalvarAlteracao<font color="#808080">)
</font>	  escreveArq<font color="#808080">(</font>tfLivro<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGALT<font color="#808080">, </font>MSG_REGNALT<font color="#808080">);
   </font><font color="#000080"><b>else if </b></font><font color="#808080">(</font>sacao<font color="#808080">==</font>ctAcao<font color="#808080">.</font>opConfirmaExclusao<font color="#808080">)
</font>	  escreveArq<font color="#808080">(</font>tfLivro<font color="#808080">, </font>repete<font color="#808080">(</font><font color="#800000">&quot;*&quot;</font><font color="#808080">,</font>tamReg<font color="#808080">(</font>sreg<font color="#808080">)), </font>MSG_REGEXC<font color="#808080">, </font>MSG_REGNEXC<font color="#808080">);
} </font><font color="#000080"><b>else if </b></font><font color="#808080">(</font>sreg<font color="#808080">==</font>ctArqs<font color="#808080">.</font>opLivroAss<font color="#808080">) {
   </font><font color="#000080"><b>if </b></font><font color="#808080">(</font>sacao<font color="#808080">==</font>ctAcao<font color="#808080">.</font>opSalvarInclusao<font color="#808080">)
</font>	  escreveArq<font color="#808080">(</font>tfLivroAss<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGINC<font color="#808080">, </font>MSG_REGNINC<font color="#808080">);
   </font><font color="#000080"><b>else if </b></font><font color="#808080">(</font>sacao<font color="#808080">==</font>ctAcao<font color="#808080">.</font>opSalvarAlteracao<font color="#808080">)
</font>	  escreveArq<font color="#808080">(</font>tfLivroAss<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGALT<font color="#808080">, </font>MSG_REGNALT<font color="#808080">);
   </font><font color="#000080"><b>else if </b></font><font color="#808080">(</font>sacao<font color="#808080">==</font>ctAcao<font color="#808080">.</font>opConfirmaExclusao<font color="#808080">)
</font>	  escreveArq<font color="#808080">(</font>tfLivroAss<font color="#808080">, </font>repete<font color="#808080">(</font><font color="#800000">&quot;*&quot;</font><font color="#808080">,</font>tamReg<font color="#808080">(</font>sreg<font color="#808080">)), </font>MSG_REGEXC<font color="#808080">, </font>MSG_REGNEXC<font color="#808080">);
} </font><font color="#000080"><b>else if </b></font><font color="#808080">(</font>sreg<font color="#808080">==</font>ctArqs<font color="#808080">.</font>opLivroAut<font color="#808080">) {
   </font><font color="#000080"><b>if </b></font><font color="#808080">(</font>sacao<font color="#808080">==</font>ctAcao<font color="#808080">.</font>opSalvarInclusao<font color="#808080">)
</font>	  escreveArq<font color="#808080">(</font>tfLivroAut<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGINC<font color="#808080">, </font>MSG_REGNINC<font color="#808080">);
   </font><font color="#000080"><b>else if </b></font><font color="#808080">(</font>sacao<font color="#808080">==</font>ctAcao<font color="#808080">.</font>opSalvarAlteracao<font color="#808080">)
</font>	  escreveArq<font color="#808080">(</font>tfLivroAut<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGALT<font color="#808080">, </font>MSG_REGNALT<font color="#808080">);
   </font><font color="#000080"><b>else if </b></font><font color="#808080">(</font>sacao<font color="#808080">==</font>ctAcao<font color="#808080">.</font>opConfirmaExclusao<font color="#808080">)
</font>	  escreveArq<font color="#808080">(</font>tfLivroAut<font color="#808080">, </font>repete<font color="#808080">(</font><font color="#800000">&quot;*&quot;</font><font color="#808080">,</font>tamReg<font color="#808080">(</font>sreg<font color="#808080">)), </font>MSG_REGEXC<font color="#808080">, </font>MSG_REGNEXC<font color="#808080">);
} </font><font color="#000080"><b>else if </b></font><font color="#808080">(</font>sreg<font color="#808080">==</font>ctArqs<font color="#808080">.</font>opCliente<font color="#808080">) {
   </font><font color="#000080"><b>if </b></font><font color="#808080">(</font>sacao<font color="#808080">==</font>ctAcao<font color="#808080">.</font>opSalvarInclusao<font color="#808080">)
</font>	  escreveArq<font color="#808080">(</font>tfCliente<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGINC<font color="#808080">, </font>MSG_REGNINC<font color="#808080">);
   </font><font color="#000080"><b>else if </b></font><font color="#808080">(</font>sacao<font color="#808080">==</font>ctAcao<font color="#808080">.</font>opSalvarAlteracao<font color="#808080">)
</font>	  escreveArq<font color="#808080">(</font>tfCliente<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGALT<font color="#808080">, </font>MSG_REGNALT<font color="#808080">);
   </font><font color="#000080"><b>else if </b></font><font color="#808080">(</font>sacao<font color="#808080">==</font>ctAcao<font color="#808080">.</font>opConfirmaExclusao<font color="#808080">)
</font>	  escreveArq<font color="#808080">(</font>tfCliente<font color="#808080">, </font>repete<font color="#808080">(</font><font color="#800000">&quot;*&quot;</font><font color="#808080">,</font>tamReg<font color="#808080">(</font>sreg<font color="#808080">)), </font>MSG_REGEXC<font color="#808080">, </font>MSG_REGNEXC<font color="#808080">);
} </font><font color="#000080"><b>else if </b></font><font color="#808080">(</font>sreg<font color="#808080">==</font>ctArqs<font color="#808080">.</font>opVenda<font color="#808080">) {
   </font><font color="#000080"><b>if </b></font><font color="#808080">(</font>sacao<font color="#808080">==</font>ctAcao<font color="#808080">.</font>opSalvarInclusao<font color="#808080">)
</font>	  escreveArq<font color="#808080">(</font>tfVenda<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGINC<font color="#808080">, </font>MSG_REGNINC<font color="#808080">);
   </font><font color="#000080"><b>else if </b></font><font color="#808080">(</font>sacao<font color="#808080">==</font>ctAcao<font color="#808080">.</font>opSalvarAlteracao<font color="#808080">)
</font>	  escreveArq<font color="#808080">(</font>tfVenda<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGALT<font color="#808080">, </font>MSG_REGNALT<font color="#808080">);
   </font><font color="#000080"><b>else if </b></font><font color="#808080">(</font>sacao<font color="#808080">==</font>ctAcao<font color="#808080">.</font>opConfirmaExclusao<font color="#808080">)
</font>	  escreveArq<font color="#808080">(</font>tfVenda<font color="#808080">, </font>repete<font color="#808080">(</font><font color="#800000">&quot;*&quot;</font><font color="#808080">,</font>tamReg<font color="#808080">(</font>sreg<font color="#808080">)), </font>MSG_REGEXC<font color="#808080">, </font>MSG_REGNEXC<font color="#808080">);
} </font><font color="#000080"><b>else if </b></font><font color="#808080">(</font>sreg<font color="#808080">==</font>ctArqs<font color="#808080">.</font>opUsuario<font color="#808080">) {
   </font><font color="#000080"><b>if </b></font><font color="#808080">(</font>sacao<font color="#808080">==</font>ctAcao<font color="#808080">.</font>opSalvarAlteracao<font color="#808080">)
</font>	  escreveArq<font color="#808080">(</font>tfUsuario<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGALT<font color="#808080">, </font>MSG_REGNALT<font color="#808080">);
}
}
<i>/*------------------------------------------------------------------------------
Seleciona o menu e/ou a tela certa de acordo com o tipo de arquivo.
nmenu - o n&uacute;mero do menu
sreg - o tipo de arquivo
------------------------------------------------------------------------------*/
</i></font><font color="#0000FF"><b>void </b></font>subMenu<font color="#808080">(</font><font color="#0000FF"><b>int </b></font>nmenu<font color="#808080">, </font>ctArqs sreg<font color="#808080">)
{ </font><font color="#0000FF"><b>string </b></font>opSubMenu<font color="#808080">;
  </font><font color="#0000FF"><b>char </b></font>opCSubMenu<font color="#808080">;
  </font>Boolean bSOp<font color="#808080">;

</font>bSOp <font color="#808080">= </font><font color="#0000FF"><b>true</b></font><font color="#808080">;
</font><font color="#000080"><b>switch</b></font><font color="#808080">(</font>nmenu<font color="#808080">) {
 </font><font color="#000080"><b>case </b></font><font color="#FF0000">6</font><font color="#808080">:{
</font>	<font color="#000080"><b>while</b></font><font color="#808080">(</font>bSOp<font color="#808080">) {
</font>	 menu<font color="#808080">(</font>nmenu<font color="#808080">);
</font>	 opSubMenu <font color="#808080">= </font>System<font color="#808080">.</font>Console<font color="#808080">.</font>In<font color="#808080">.</font>ReadLine<font color="#808080">();
</font>	 <font color="#000080"><b>switch</b></font><font color="#808080">(</font>opSubMenu<font color="#808080">) {
</font>	  <font color="#000080"><b>case </b></font><font color="#800000">&quot;1&quot;</font><font color="#808080">: </font>frmCadastros<font color="#808080">(</font>sreg<font color="#808080">, </font>ctAcao<font color="#808080">.</font>opNovo<font color="#808080">); </font><font color="#000080"><b>break</b></font><font color="#808080">;
</font>	  <font color="#000080"><b>case </b></font><font color="#800000">&quot;2&quot;</font><font color="#808080">: </font>frmCadastros<font color="#808080">(</font>sreg<font color="#808080">, </font>ctAcao<font color="#808080">.</font>opPesquisar<font color="#808080">); </font><font color="#000080"><b>break</b></font><font color="#808080">;
</font>	  <font color="#000080"><b>case </b></font><font color="#800000">&quot;3&quot;</font><font color="#808080">: </font>bSOp <font color="#808080">= </font><font color="#0000FF"><b>false</b></font><font color="#808080">; </font><font color="#000080"><b>break</b></font><font color="#808080">;
</font>	  <font color="#000080"><b>default</b></font><font color="#808080">: </font>System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font>MSG_ERRO<font color="#808080">); </font><font color="#000080"><b>break</b></font><font color="#808080">;
</font>	 <font color="#808080">}
</font>	<font color="#808080">}
   } </font><font color="#000080"><b>break</b></font><font color="#808080">;
 </font><font color="#000080"><b>case </b></font><font color="#FF0000">7</font><font color="#808080">:{
</font>	<font color="#000080"><b>while</b></font><font color="#808080">(</font>bSOp<font color="#808080">) {
</font>	 menu<font color="#808080">(</font>nmenu<font color="#808080">);
</font>	 opSubMenu <font color="#808080">= </font>System<font color="#808080">.</font>Console<font color="#808080">.</font>In<font color="#808080">.</font>ReadLine<font color="#808080">();
</font>	 <font color="#000080"><b>switch</b></font><font color="#808080">(</font>opSubMenu<font color="#808080">) {
</font>	  <font color="#000080"><b>case </b></font><font color="#800000">&quot;1&quot;</font><font color="#808080">: { </font>btnAcao<font color="#808080">(</font>sreg<font color="#808080">, </font>ctAcao<font color="#808080">.</font>opSalvarInclusao<font color="#808080">); </font>bSOp <font color="#808080">= </font><font color="#0000FF"><b>false</b></font><font color="#808080">; } </font><font color="#000080"><b>break</b></font><font color="#808080">;
</font>	  <font color="#000080"><b>case </b></font><font color="#800000">&quot;2&quot;</font><font color="#808080">: </font>bSOp <font color="#808080">= </font><font color="#0000FF"><b>false</b></font><font color="#808080">; </font><font color="#000080"><b>break</b></font><font color="#808080">;
</font>	  <font color="#000080"><b>default</b></font><font color="#808080">: </font>System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font>MSG_ERRO<font color="#808080">); </font><font color="#000080"><b>break</b></font><font color="#808080">;
</font>	 <font color="#808080">}
</font>	<font color="#808080">}
   } </font><font color="#000080"><b>break</b></font><font color="#808080">;
 </font><font color="#000080"><b>case </b></font><font color="#FF0000">8</font><font color="#808080">:{
</font>	<font color="#000080"><b>while</b></font><font color="#808080">(</font>bSOp<font color="#808080">) {
</font>	 menu<font color="#808080">(</font>nmenu<font color="#808080">);
</font>	 opSubMenu <font color="#808080">= </font>System<font color="#808080">.</font>Console<font color="#808080">.</font>In<font color="#808080">.</font>ReadLine<font color="#808080">();
</font>	 <font color="#000080"><b>switch</b></font><font color="#808080">(</font>opSubMenu<font color="#808080">) {
</font>	  <font color="#000080"><b>case </b></font><font color="#800000">&quot;1&quot;</font><font color="#808080">: { </font>frmCadastros<font color="#808080">(</font>sreg<font color="#808080">, </font>ctAcao<font color="#808080">.</font>opAlterar<font color="#808080">); </font>bSOp <font color="#808080">= </font><font color="#0000FF"><b>false</b></font><font color="#808080">; } </font><font color="#000080"><b>break</b></font><font color="#808080">;
</font>	  <font color="#000080"><b>case </b></font><font color="#800000">&quot;2&quot;</font><font color="#808080">: { </font>frmCadastros<font color="#808080">(</font>sreg<font color="#808080">, </font>ctAcao<font color="#808080">.</font>opExcluir<font color="#808080">); </font>bSOp <font color="#808080">= </font><font color="#0000FF"><b>false</b></font><font color="#808080">; } </font><font color="#000080"><b>break</b></font><font color="#808080">;
</font>	  <font color="#000080"><b>case </b></font><font color="#800000">&quot;3&quot;</font><font color="#808080">: </font>bSOp <font color="#808080">= </font><font color="#0000FF"><b>false</b></font><font color="#808080">; </font><font color="#000080"><b>break</b></font><font color="#808080">;
</font>	  <font color="#000080"><b>default</b></font><font color="#808080">: </font>System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font>MSG_ERRO<font color="#808080">); </font><font color="#000080"><b>break</b></font><font color="#808080">;
</font>	 <font color="#808080">}
</font>	<font color="#808080">}
   } </font><font color="#000080"><b>break</b></font><font color="#808080">;
 </font><font color="#000080"><b>case </b></font><font color="#FF0000">9</font><font color="#808080">:{
</font>	<font color="#000080"><b>while</b></font><font color="#808080">(</font>bSOp<font color="#808080">) {
</font>	 menu<font color="#808080">(</font>nmenu<font color="#808080">);
</font>	 opSubMenu <font color="#808080">= </font>System<font color="#808080">.</font>Console<font color="#808080">.</font>In<font color="#808080">.</font>ReadLine<font color="#808080">();
</font>	 <font color="#000080"><b>switch</b></font><font color="#808080">(</font>opSubMenu<font color="#808080">) {
</font>	  <font color="#000080"><b>case </b></font><font color="#800000">&quot;1&quot;</font><font color="#808080">: { </font>btnAcao<font color="#808080">(</font>sreg<font color="#808080">, </font>ctAcao<font color="#808080">.</font>opSalvarAlteracao<font color="#808080">); </font>bSOp <font color="#808080">= </font><font color="#0000FF"><b>false</b></font><font color="#808080">; } </font><font color="#000080"><b>break</b></font><font color="#808080">;
</font>	  <font color="#000080"><b>case </b></font><font color="#800000">&quot;2&quot;</font><font color="#808080">: </font>bSOp <font color="#808080">= </font><font color="#0000FF"><b>false</b></font><font color="#808080">; </font><font color="#000080"><b>break</b></font><font color="#808080">;
</font>	  <font color="#000080"><b>default</b></font><font color="#808080">: </font>System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font>MSG_ERRO<font color="#808080">); </font><font color="#000080"><b>break</b></font><font color="#808080">;
</font>	 <font color="#808080">}
</font>	<font color="#808080">}
   } </font><font color="#000080"><b>break</b></font><font color="#808080">;
 </font><font color="#000080"><b>case </b></font><font color="#FF0000">10</font><font color="#808080">:{
</font>	<font color="#000080"><b>while</b></font><font color="#808080">(</font>bSOp<font color="#808080">) {
</font>	 menu<font color="#808080">(</font>nmenu<font color="#808080">);
</font>	 opCSubMenu <font color="#808080">= </font>System<font color="#808080">.</font>Console<font color="#808080">.</font>In<font color="#808080">.</font>ReadLine<font color="#808080">()[</font><font color="#FF0000">0</font><font color="#808080">];
</font>	 <font color="#000080"><b>if </b></font><font color="#808080">((</font>opCSubMenu<font color="#808080">=='</font>S<font color="#808080">') || (</font>opCSubMenu<font color="#808080">=='</font>s<font color="#808080">')) {
</font>		btnAcao<font color="#808080">(</font>sreg<font color="#808080">, </font>ctAcao<font color="#808080">.</font>opConfirmaExclusao<font color="#808080">);
</font>		bSOp <font color="#808080">= </font><font color="#0000FF"><b>false</b></font><font color="#808080">;
</font>	 <font color="#808080">} </font><font color="#000080"><b>else if </b></font><font color="#808080">((</font>opCSubMenu<font color="#808080">=='</font>N<font color="#808080">') || (</font>opCSubMenu<font color="#808080">=='</font>n<font color="#808080">')) </font>bSOp <font color="#808080">= </font><font color="#0000FF"><b>false</b></font><font color="#808080">;
</font>	 <font color="#000080"><b>else </b></font>System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font>MSG_ERRO<font color="#808080">);
</font>	<font color="#808080">}
   } </font><font color="#000080"><b>break</b></font><font color="#808080">;
 </font><font color="#000080"><b>case </b></font><font color="#FF0000">12</font><font color="#808080">:{
</font>	<font color="#000080"><b>while</b></font><font color="#808080">(</font>bSOp<font color="#808080">) {
</font>	 menu<font color="#808080">(</font>nmenu<font color="#808080">);
</font>	 opSubMenu <font color="#808080">= </font>System<font color="#808080">.</font>Console<font color="#808080">.</font>In<font color="#808080">.</font>ReadLine<font color="#808080">();
</font>	 <font color="#000080"><b>switch</b></font><font color="#808080">(</font>opSubMenu<font color="#808080">) {
</font>	  <font color="#000080"><b>case </b></font><font color="#800000">&quot;1&quot;</font><font color="#808080">: </font>frmConsultas<font color="#808080">(</font>sreg<font color="#808080">, </font>ctAcao<font color="#808080">.</font>opPesquisar<font color="#808080">); </font><font color="#000080"><b>break</b></font><font color="#808080">;
</font>	  <font color="#000080"><b>case </b></font><font color="#800000">&quot;2&quot;</font><font color="#808080">: </font>frmConsultas<font color="#808080">(</font>sreg<font color="#808080">, </font>ctAcao<font color="#808080">.</font>opListarTodos<font color="#808080">); </font><font color="#000080"><b>break</b></font><font color="#808080">;
</font>	  <font color="#000080"><b>case </b></font><font color="#800000">&quot;3&quot;</font><font color="#808080">: </font>bSOp <font color="#808080">= </font><font color="#0000FF"><b>false</b></font><font color="#808080">; </font><font color="#000080"><b>break</b></font><font color="#808080">;
</font>	  <font color="#000080"><b>default</b></font><font color="#808080">: </font>System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font>MSG_ERRO<font color="#808080">); </font><font color="#000080"><b>break</b></font><font color="#808080">;
</font>	 <font color="#808080">}
</font>	<font color="#808080">}
   } </font><font color="#000080"><b>break</b></font><font color="#808080">;
 </font><font color="#000080"><b>case </b></font><font color="#FF0000">14</font><font color="#808080">:{
</font>	<font color="#000080"><b>while</b></font><font color="#808080">(</font>bSOp<font color="#808080">) {
</font>	 menu<font color="#808080">(</font>nmenu<font color="#808080">);
</font>	 opCSubMenu <font color="#808080">= </font>System<font color="#808080">.</font>Console<font color="#808080">.</font>In<font color="#808080">.</font>ReadLine<font color="#808080">()[</font><font color="#FF0000">0</font><font color="#808080">];
</font>	 <font color="#000080"><b>if </b></font><font color="#808080">((</font>opCSubMenu<font color="#808080">=='</font>S<font color="#808080">') || (</font>opCSubMenu<font color="#808080">=='</font>s<font color="#808080">')) {
</font>		btnAcao<font color="#808080">(</font>sreg<font color="#808080">, </font>ctAcao<font color="#808080">.</font>opSalvarInclusao<font color="#808080">);
</font>		bSOp <font color="#808080">= </font><font color="#0000FF"><b>false</b></font><font color="#808080">;
</font>		g_SalvarInclusao <font color="#808080">= </font><font color="#0000FF"><b>true</b></font><font color="#808080">;
</font>	 <font color="#808080">} </font><font color="#000080"><b>else if </b></font><font color="#808080">((</font>opCSubMenu<font color="#808080">=='</font>N<font color="#808080">') || (</font>opCSubMenu<font color="#808080">=='</font>n<font color="#808080">')) </font>bSOp <font color="#808080">= </font><font color="#0000FF"><b>false</b></font><font color="#808080">;
</font>	 <font color="#000080"><b>else </b></font>System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font>MSG_ERRO<font color="#808080">);
</font>	<font color="#808080">}
   } </font><font color="#000080"><b>break</b></font><font color="#808080">;
}

}
<i>/*------------------------------------------------------------------------------
Seleciona o submenu e/ou a tela certa de acordo com n&uacute;mero do menu.
nmenu - o n&uacute;mero do menu
------------------------------------------------------------------------------*/
</i></font><font color="#0000FF"><b>void </b></font>usaMenu<font color="#808080">(</font><font color="#0000FF"><b>int </b></font>num<font color="#808080">)
{ </font><font color="#0000FF"><b>string </b></font>opSubMenu<font color="#808080">;
  </font>Boolean bSOp<font color="#808080">;
  </font><font color="#0000FF"><b>char </b></font>opSair<font color="#808080">;

 </font>bSOp <font color="#808080">= </font><font color="#0000FF"><b>true</b></font><font color="#808080">;
 </font><font color="#000080"><b>if </b></font><font color="#808080">(</font>num <font color="#808080">== </font><font color="#FF0000">1</font><font color="#808080">) { <i>/* Cadastros */
   </i></font><font color="#000080"><b>while</b></font><font color="#808080">(</font>bSOp<font color="#808080">) {
</font>	 menu<font color="#808080">(</font><font color="#FF0000">2</font><font color="#808080">);
</font>	 opSubMenu <font color="#808080">= </font>System<font color="#808080">.</font>Console<font color="#808080">.</font>In<font color="#808080">.</font>ReadLine<font color="#808080">();
</font>	 <font color="#000080"><b>switch</b></font><font color="#808080">(</font>opSubMenu<font color="#808080">) {
</font>	  <font color="#000080"><b>case </b></font><font color="#800000">&quot;1&quot;</font><font color="#808080">: </font>subMenu<font color="#808080">(</font><font color="#FF0000">6</font><font color="#808080">, </font>ctArqs<font color="#808080">.</font>opAssunto<font color="#808080">); </font><font color="#000080"><b>break</b></font><font color="#808080">;
</font>	  <font color="#000080"><b>case </b></font><font color="#800000">&quot;2&quot;</font><font color="#808080">: </font>subMenu<font color="#808080">(</font><font color="#FF0000">6</font><font color="#808080">, </font>ctArqs<font color="#808080">.</font>opAutor<font color="#808080">); </font><font color="#000080"><b>break</b></font><font color="#808080">;
</font>	  <font color="#000080"><b>case </b></font><font color="#800000">&quot;3&quot;</font><font color="#808080">: </font>subMenu<font color="#808080">(</font><font color="#FF0000">6</font><font color="#808080">, </font>ctArqs<font color="#808080">.</font>opEditora<font color="#808080">); </font><font color="#000080"><b>break</b></font><font color="#808080">;
</font>	  <font color="#000080"><b>case </b></font><font color="#800000">&quot;4&quot;</font><font color="#808080">: </font>subMenu<font color="#808080">(</font><font color="#FF0000">6</font><font color="#808080">, </font>ctArqs<font color="#808080">.</font>opEndereco<font color="#808080">); </font><font color="#000080"><b>break</b></font><font color="#808080">;
</font>	  <font color="#000080"><b>case </b></font><font color="#800000">&quot;5&quot;</font><font color="#808080">: </font>subMenu<font color="#808080">(</font><font color="#FF0000">6</font><font color="#808080">, </font>ctArqs<font color="#808080">.</font>opIdioma<font color="#808080">); </font><font color="#000080"><b>break</b></font><font color="#808080">;
</font>	  <font color="#000080"><b>case </b></font><font color="#800000">&quot;6&quot;</font><font color="#808080">: </font>subMenu<font color="#808080">(</font><font color="#FF0000">6</font><font color="#808080">, </font>ctArqs<font color="#808080">.</font>opPais<font color="#808080">); </font><font color="#000080"><b>break</b></font><font color="#808080">;
</font>	  <font color="#000080"><b>case </b></font><font color="#800000">&quot;7&quot;</font><font color="#808080">: </font>subMenu<font color="#808080">(</font><font color="#FF0000">6</font><font color="#808080">, </font>ctArqs<font color="#808080">.</font>opProfissao<font color="#808080">); </font><font color="#000080"><b>break</b></font><font color="#808080">;
</font>	  <font color="#000080"><b>case </b></font><font color="#800000">&quot;8&quot;</font><font color="#808080">: </font>subMenu<font color="#808080">(</font><font color="#FF0000">6</font><font color="#808080">, </font>ctArqs<font color="#808080">.</font>opCliente<font color="#808080">); </font><font color="#000080"><b>break</b></font><font color="#808080">;
</font>	  <font color="#000080"><b>case </b></font><font color="#800000">&quot;9&quot;</font><font color="#808080">: </font>subMenu<font color="#808080">(</font><font color="#FF0000">6</font><font color="#808080">, </font>ctArqs<font color="#808080">.</font>opLivro<font color="#808080">); </font><font color="#000080"><b>break</b></font><font color="#808080">;
</font>	  <font color="#000080"><b>case </b></font><font color="#800000">&quot;10&quot;</font><font color="#808080">: </font>bSOp <font color="#808080">= </font><font color="#0000FF"><b>false</b></font><font color="#808080">; </font><font color="#000080"><b>break</b></font><font color="#808080">;
</font>	  <font color="#000080"><b>default</b></font><font color="#808080">: </font>System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font>MSG_ERRO<font color="#808080">); </font><font color="#000080"><b>break</b></font><font color="#808080">;
</font>	 <font color="#808080">}
   }
 } </font><font color="#000080"><b>else if </b></font><font color="#808080">(</font>num <font color="#808080">== </font><font color="#FF0000">2</font><font color="#808080">) { <i>/* Pesquisas */
   </i></font><font color="#000080"><b>while</b></font><font color="#808080">(</font>bSOp<font color="#808080">) {
</font>	 menu<font color="#808080">(</font><font color="#FF0000">3</font><font color="#808080">);
</font>	 opSubMenu <font color="#808080">= </font>System<font color="#808080">.</font>Console<font color="#808080">.</font>In<font color="#808080">.</font>ReadLine<font color="#808080">();
</font>	 <font color="#000080"><b>switch</b></font><font color="#808080">(</font>opSubMenu<font color="#808080">) {
</font>	  <font color="#000080"><b>case </b></font><font color="#800000">&quot;1&quot;</font><font color="#808080">: </font>subMenu<font color="#808080">(</font><font color="#FF0000">12</font><font color="#808080">, </font>ctArqs<font color="#808080">.</font>opAssunto<font color="#808080">); </font><font color="#000080"><b>break</b></font><font color="#808080">;
</font>	  <font color="#000080"><b>case </b></font><font color="#800000">&quot;2&quot;</font><font color="#808080">: </font>subMenu<font color="#808080">(</font><font color="#FF0000">12</font><font color="#808080">, </font>ctArqs<font color="#808080">.</font>opAutor<font color="#808080">); </font><font color="#000080"><b>break</b></font><font color="#808080">;
</font>	  <font color="#000080"><b>case </b></font><font color="#800000">&quot;3&quot;</font><font color="#808080">: </font>subMenu<font color="#808080">(</font><font color="#FF0000">12</font><font color="#808080">, </font>ctArqs<font color="#808080">.</font>opEditora<font color="#808080">); </font><font color="#000080"><b>break</b></font><font color="#808080">;
</font>	  <font color="#000080"><b>case </b></font><font color="#800000">&quot;4&quot;</font><font color="#808080">: </font>subMenu<font color="#808080">(</font><font color="#FF0000">12</font><font color="#808080">, </font>ctArqs<font color="#808080">.</font>opEndereco<font color="#808080">); </font><font color="#000080"><b>break</b></font><font color="#808080">;
</font>	  <font color="#000080"><b>case </b></font><font color="#800000">&quot;5&quot;</font><font color="#808080">: </font>subMenu<font color="#808080">(</font><font color="#FF0000">12</font><font color="#808080">, </font>ctArqs<font color="#808080">.</font>opIdioma<font color="#808080">); </font><font color="#000080"><b>break</b></font><font color="#808080">;
</font>	  <font color="#000080"><b>case </b></font><font color="#800000">&quot;6&quot;</font><font color="#808080">: </font>subMenu<font color="#808080">(</font><font color="#FF0000">12</font><font color="#808080">, </font>ctArqs<font color="#808080">.</font>opPais<font color="#808080">); </font><font color="#000080"><b>break</b></font><font color="#808080">;
</font>	  <font color="#000080"><b>case </b></font><font color="#800000">&quot;7&quot;</font><font color="#808080">: </font>subMenu<font color="#808080">(</font><font color="#FF0000">12</font><font color="#808080">, </font>ctArqs<font color="#808080">.</font>opProfissao<font color="#808080">); </font><font color="#000080"><b>break</b></font><font color="#808080">;
</font>	  <font color="#000080"><b>case </b></font><font color="#800000">&quot;8&quot;</font><font color="#808080">: </font>subMenu<font color="#808080">(</font><font color="#FF0000">12</font><font color="#808080">, </font>ctArqs<font color="#808080">.</font>opCliente<font color="#808080">); </font><font color="#000080"><b>break</b></font><font color="#808080">;
</font>	  <font color="#000080"><b>case </b></font><font color="#800000">&quot;9&quot;</font><font color="#808080">: </font>subMenu<font color="#808080">(</font><font color="#FF0000">12</font><font color="#808080">, </font>ctArqs<font color="#808080">.</font>opLivro<font color="#808080">); </font><font color="#000080"><b>break</b></font><font color="#808080">;
</font>	  <font color="#000080"><b>case </b></font><font color="#800000">&quot;10&quot;</font><font color="#808080">: </font>bSOp <font color="#808080">= </font><font color="#0000FF"><b>false</b></font><font color="#808080">; </font><font color="#000080"><b>break</b></font><font color="#808080">;
</font>	  <font color="#000080"><b>default</b></font><font color="#808080">: </font>System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font>MSG_ERRO<font color="#808080">); </font><font color="#000080"><b>break</b></font><font color="#808080">;
</font>	 <font color="#808080">}
   }
 } </font><font color="#000080"><b>else if </b></font><font color="#808080">(</font>num <font color="#808080">== </font><font color="#FF0000">3</font><font color="#808080">) { <i>/* Vendas */
   </i></font><font color="#000080"><b>while</b></font><font color="#808080">(</font>bSOp<font color="#808080">) {
</font>	 menu<font color="#808080">(</font><font color="#FF0000">4</font><font color="#808080">);
</font>	 opSubMenu <font color="#808080">= </font>System<font color="#808080">.</font>Console<font color="#808080">.</font>In<font color="#808080">.</font>ReadLine<font color="#808080">();
</font>	 <font color="#000080"><b>switch</b></font><font color="#808080">(</font>opSubMenu<font color="#808080">) {
</font>	  <font color="#000080"><b>case </b></font><font color="#800000">&quot;1&quot;</font><font color="#808080">: </font>subMenu<font color="#808080">(</font><font color="#FF0000">6</font><font color="#808080">, </font>ctArqs<font color="#808080">.</font>opVenda<font color="#808080">); </font><font color="#000080"><b>break</b></font><font color="#808080">;
</font>	  <font color="#000080"><b>case </b></font><font color="#800000">&quot;2&quot;</font><font color="#808080">: </font>subMenu<font color="#808080">(</font><font color="#FF0000">12</font><font color="#808080">, </font>ctArqs<font color="#808080">.</font>opVenda<font color="#808080">); </font><font color="#000080"><b>break</b></font><font color="#808080">;
</font>	  <font color="#000080"><b>case </b></font><font color="#800000">&quot;3&quot;</font><font color="#808080">: </font>bSOp <font color="#808080">= </font><font color="#0000FF"><b>false</b></font><font color="#808080">; </font><font color="#000080"><b>break</b></font><font color="#808080">;
</font>	  <font color="#000080"><b>default</b></font><font color="#808080">: </font>System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font>MSG_ERRO<font color="#808080">); </font><font color="#000080"><b>break</b></font><font color="#808080">;
</font>	 <font color="#808080">}
   }
 } </font><font color="#000080"><b>else if </b></font><font color="#808080">(</font>num <font color="#808080">== </font><font color="#FF0000">4</font><font color="#808080">) { <i>/* Opcoes */
   </i></font><font color="#000080"><b>while</b></font><font color="#808080">(</font>bSOp<font color="#808080">) {
</font>	 menu<font color="#808080">(</font><font color="#FF0000">5</font><font color="#808080">);
</font>	 opSubMenu <font color="#808080">= </font>System<font color="#808080">.</font>Console<font color="#808080">.</font>In<font color="#808080">.</font>ReadLine<font color="#808080">();
</font>	 <font color="#000080"><b>switch</b></font><font color="#808080">(</font>opSubMenu<font color="#808080">) {
</font>	  <font color="#000080"><b>case </b></font><font color="#800000">&quot;1&quot;</font><font color="#808080">: </font>frmAlterarSenha<font color="#808080">(); </font><font color="#000080"><b>break</b></font><font color="#808080">;
</font>	  <font color="#000080"><b>case </b></font><font color="#800000">&quot;2&quot;</font><font color="#808080">: </font>frmSobre<font color="#808080">(); </font><font color="#000080"><b>break</b></font><font color="#808080">;
</font>	  <font color="#000080"><b>case </b></font><font color="#800000">&quot;3&quot;</font><font color="#808080">: {
</font>		   menu<font color="#808080">(</font><font color="#FF0000">11</font><font color="#808080">);
</font>		   opSair <font color="#808080">= </font>System<font color="#808080">.</font>Console<font color="#808080">.</font>In<font color="#808080">.</font>ReadLine<font color="#808080">()[</font><font color="#FF0000">0</font><font color="#808080">];
</font>		   <font color="#000080"><b>if </b></font><font color="#808080">((</font>opSair<font color="#808080">=='</font>S<font color="#808080">') || (</font>opSair<font color="#808080">=='</font>s<font color="#808080">')) {
</font>			  fechaArqs<font color="#808080">();
</font>			  System<font color="#808080">.</font>Environment<font color="#808080">.</font>Exit<font color="#808080">(</font><font color="#FF0000">0</font><font color="#808080">);
</font>		   <font color="#808080">}
</font>		 <font color="#808080">} </font><font color="#000080"><b>break</b></font><font color="#808080">;
</font>	  <font color="#000080"><b>case </b></font><font color="#800000">&quot;4&quot;</font><font color="#808080">: </font>bSOp <font color="#808080">= </font><font color="#0000FF"><b>false</b></font><font color="#808080">; </font><font color="#000080"><b>break</b></font><font color="#808080">;
</font>	  <font color="#000080"><b>default</b></font><font color="#808080">: </font>System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font>MSG_ERRO<font color="#808080">); </font><font color="#000080"><b>break</b></font><font color="#808080">;
</font>	 <font color="#808080">}
   }
 }
}
<i>/*------------------------------------------------------------------------------
Mostra as entradas e as sa&iacute;das do sistema.
sreg - o tipo de arquivo
slinha - o registro com os dados
nOpcao - indica qual op&ccedil;&atilde;o ser&aacute; mostrada
------------------------------------------------------------------------------*/
</i></font><font color="#0000FF"><b>void </b></font>mostrarDados<font color="#808080">(</font>ctArqs sreg<font color="#808080">, </font><font color="#0000FF"><b>string </b></font>slinha<font color="#808080">, </font><font color="#0000FF"><b>int </b></font>nOpcao<font color="#808080">)
{
</font><font color="#000080"><b>if </b></font><font color="#808080">(</font>sreg<font color="#808080">==</font>ctArqs<font color="#808080">.</font>opAssunto<font color="#808080">) {
   </font><font color="#000080"><b>switch</b></font><font color="#808080">(</font>nOpcao<font color="#808080">) {
</font>	<font color="#000080"><b>case </b></font><font color="#FF0000">1</font><font color="#808080">: {
</font>		System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">) + </font>tAssunto<font color="#808080">.</font>codigo<font color="#808080">);
</font>		System<font color="#808080">.</font>Console<font color="#808080">.</font>Write<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">));
</font>		tAssunto<font color="#808080">.</font>assunto <font color="#808080">= </font>System<font color="#808080">.</font>Console<font color="#808080">.</font>In<font color="#808080">.</font>ReadLine<font color="#808080">();
</font>	   <font color="#808080">} </font><font color="#000080"><b>break</b></font><font color="#808080">;
</font>	<font color="#000080"><b>case </b></font><font color="#FF0000">2</font><font color="#808080">: {
</font>		System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;C&oacute;digo     Assunto&quot;</font><font color="#808080">);
</font>		System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;------     -------&quot;</font><font color="#808080">);
</font>	   <font color="#808080">} </font><font color="#000080"><b>break</b></font><font color="#808080">;
</font>	<font color="#000080"><b>case </b></font><font color="#FF0000">3</font><font color="#808080">: {
</font>		tAssunto<font color="#808080">.</font>codigo <font color="#808080">= </font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">).</font>Trim<font color="#808080">();
</font>		tAssunto<font color="#808080">.</font>assunto <font color="#808080">= </font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">11</font><font color="#808080">, </font><font color="#FF0000">30</font><font color="#808080">).</font>Trim<font color="#808080">();
</font>		System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font>esp<font color="#808080">(</font>tAssunto<font color="#808080">.</font>codigo<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">) + </font><font color="#800000">&quot; &quot; </font><font color="#808080">+
</font>						   esp<font color="#808080">(</font>tAssunto<font color="#808080">.</font>assunto<font color="#808080">,</font><font color="#FF0000">30</font><font color="#808080">));
</font>	   <font color="#808080">} </font><font color="#000080"><b>break</b></font><font color="#808080">;
   }
} </font><font color="#000080"><b>else if </b></font><font color="#808080">(</font>sreg<font color="#808080">==</font>ctArqs<font color="#808080">.</font>opAutor<font color="#808080">) {
   </font><font color="#000080"><b>switch</b></font><font color="#808080">(</font>nOpcao<font color="#808080">) {
</font>	<font color="#000080"><b>case </b></font><font color="#FF0000">1</font><font color="#808080">: {
</font>		System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">) + </font>tAutor<font color="#808080">.</font>codigo<font color="#808080">);
</font>		System<font color="#808080">.</font>Console<font color="#808080">.</font>Write<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">));
</font>		tAutor<font color="#808080">.</font>autor <font color="#808080">= </font>System<font color="#808080">.</font>Console<font color="#808080">.</font>In<font color="#808080">.</font>ReadLine<font color="#808080">();
</font>	   <font color="#808080">} </font><font color="#000080"><b>break</b></font><font color="#808080">;
</font>	<font color="#000080"><b>case </b></font><font color="#FF0000">2</font><font color="#808080">: {
</font>		System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;C&oacute;digo     Autor&quot;</font><font color="#808080">);
</font>		System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;------     -----&quot;</font><font color="#808080">);
</font>	   <font color="#808080">} </font><font color="#000080"><b>break</b></font><font color="#808080">;
</font>	<font color="#000080"><b>case </b></font><font color="#FF0000">3</font><font color="#808080">: {
</font>		tAutor<font color="#808080">.</font>codigo <font color="#808080">= </font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">).</font>Trim<font color="#808080">();
</font>		tAutor<font color="#808080">.</font>autor <font color="#808080">= </font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">11</font><font color="#808080">, </font><font color="#FF0000">30</font><font color="#808080">).</font>Trim<font color="#808080">();
</font>		System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font>esp<font color="#808080">(</font>tAutor<font color="#808080">.</font>codigo<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">)+</font><font color="#800000">&quot; &quot;</font><font color="#808080">+</font>esp<font color="#808080">(</font>tAutor<font color="#808080">.</font>autor<font color="#808080">,</font><font color="#FF0000">30</font><font color="#808080">));
</font>	   <font color="#808080">} </font><font color="#000080"><b>break</b></font><font color="#808080">;
   }
} </font><font color="#000080"><b>else if </b></font><font color="#808080">(</font>sreg<font color="#808080">==</font>ctArqs<font color="#808080">.</font>opEditora<font color="#808080">) {
   </font><font color="#000080"><b>switch</b></font><font color="#808080">(</font>nOpcao<font color="#808080">) {
</font>	<font color="#000080"><b>case </b></font><font color="#FF0000">1</font><font color="#808080">: {
</font>		System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">) + </font>tEditora<font color="#808080">.</font>codigo<font color="#808080">);
</font>		System<font color="#808080">.</font>Console<font color="#808080">.</font>Write<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">));
</font>		tEditora<font color="#808080">.</font>editora <font color="#808080">= </font>System<font color="#808080">.</font>Console<font color="#808080">.</font>In<font color="#808080">.</font>ReadLine<font color="#808080">();
</font>	   <font color="#808080">} </font><font color="#000080"><b>break</b></font><font color="#808080">;
</font>	<font color="#000080"><b>case </b></font><font color="#FF0000">2</font><font color="#808080">: {
</font>		System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;C&oacute;digo     Editora&quot;</font><font color="#808080">);
</font>		System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;------     -------&quot;</font><font color="#808080">);
</font>	   <font color="#808080">} </font><font color="#000080"><b>break</b></font><font color="#808080">;
</font>	<font color="#000080"><b>case </b></font><font color="#FF0000">3</font><font color="#808080">: {
</font>		tEditora<font color="#808080">.</font>codigo <font color="#808080">= </font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">).</font>Trim<font color="#808080">();
</font>		tEditora<font color="#808080">.</font>editora <font color="#808080">= </font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">11</font><font color="#808080">, </font><font color="#FF0000">50</font><font color="#808080">).</font>Trim<font color="#808080">();
</font>		System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font>esp<font color="#808080">(</font>tEditora<font color="#808080">.</font>codigo<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">)+</font><font color="#800000">&quot; &quot;</font><font color="#808080">+
</font>						   esp<font color="#808080">(</font>tEditora<font color="#808080">.</font>editora<font color="#808080">,</font><font color="#FF0000">50</font><font color="#808080">));
       } </font><font color="#000080"><b>break</b></font><font color="#808080">;
   }
} </font><font color="#000080"><b>else if </b></font><font color="#808080">(</font>sreg<font color="#808080">==</font>ctArqs<font color="#808080">.</font>opEndereco<font color="#808080">) {
   </font><font color="#000080"><b>switch</b></font><font color="#808080">(</font>nOpcao<font color="#808080">) {
</font>	<font color="#000080"><b>case </b></font><font color="#FF0000">1</font><font color="#808080">: {
</font>		System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">) + </font>tEndereco<font color="#808080">.</font>codigo<font color="#808080">);
</font>		System<font color="#808080">.</font>Console<font color="#808080">.</font>Write<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">));
</font>		tEndereco<font color="#808080">.</font>logradouro <font color="#808080">= </font>System<font color="#808080">.</font>Console<font color="#808080">.</font>In<font color="#808080">.</font>ReadLine<font color="#808080">();
</font>		System<font color="#808080">.</font>Console<font color="#808080">.</font>Write<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">));
</font>		tEndereco<font color="#808080">.</font>bairro <font color="#808080">= </font>System<font color="#808080">.</font>Console<font color="#808080">.</font>In<font color="#808080">.</font>ReadLine<font color="#808080">();
</font>		System<font color="#808080">.</font>Console<font color="#808080">.</font>Write<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">4</font><font color="#808080">));
</font>		tEndereco<font color="#808080">.</font>cep <font color="#808080">= </font>System<font color="#808080">.</font>Console<font color="#808080">.</font>In<font color="#808080">.</font>ReadLine<font color="#808080">();
</font>		System<font color="#808080">.</font>Console<font color="#808080">.</font>Write<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">5</font><font color="#808080">));
</font>		tEndereco<font color="#808080">.</font>cidade <font color="#808080">= </font>System<font color="#808080">.</font>Console<font color="#808080">.</font>In<font color="#808080">.</font>ReadLine<font color="#808080">();
</font>		System<font color="#808080">.</font>Console<font color="#808080">.</font>Write<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">6</font><font color="#808080">));
</font>		tEndereco<font color="#808080">.</font>estado <font color="#808080">= </font>System<font color="#808080">.</font>Console<font color="#808080">.</font>In<font color="#808080">.</font>ReadLine<font color="#808080">();
</font>	   <font color="#808080">} </font><font color="#000080"><b>break</b></font><font color="#808080">;
</font>	<font color="#000080"><b>case </b></font><font color="#FF0000">3</font><font color="#808080">: {
</font>		tEndereco<font color="#808080">.</font>codigo <font color="#808080">= </font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">).</font>Trim<font color="#808080">();
</font>		tEndereco<font color="#808080">.</font>logradouro <font color="#808080">= </font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">11</font><font color="#808080">, </font><font color="#FF0000">40</font><font color="#808080">).</font>Trim<font color="#808080">();
</font>		tEndereco<font color="#808080">.</font>bairro <font color="#808080">= </font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">51</font><font color="#808080">, </font><font color="#FF0000">15</font><font color="#808080">).</font>Trim<font color="#808080">();
</font>		tEndereco<font color="#808080">.</font>cep <font color="#808080">= </font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">66</font><font color="#808080">, </font><font color="#FF0000">8</font><font color="#808080">).</font>Trim<font color="#808080">();
</font>		tEndereco<font color="#808080">.</font>cidade <font color="#808080">= </font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">74</font><font color="#808080">, </font><font color="#FF0000">30</font><font color="#808080">).</font>Trim<font color="#808080">();
</font>		tEndereco<font color="#808080">.</font>estado <font color="#808080">= </font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">104</font><font color="#808080">, </font><font color="#FF0000">20</font><font color="#808080">).</font>Trim<font color="#808080">();
</font>		System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;--------------------&quot;</font><font color="#808080">);
</font>		System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">) + </font>tEndereco<font color="#808080">.</font>codigo<font color="#808080">);
</font>		System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">) + </font>tEndereco<font color="#808080">.</font>logradouro<font color="#808080">);
</font>		System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">) + </font>tEndereco<font color="#808080">.</font>bairro<font color="#808080">);
</font>		System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">4</font><font color="#808080">) + </font>tEndereco<font color="#808080">.</font>cep<font color="#808080">);
</font>		System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">5</font><font color="#808080">) + </font>tEndereco<font color="#808080">.</font>cidade<font color="#808080">);
</font>		System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">6</font><font color="#808080">) + </font>tEndereco<font color="#808080">.</font>estado<font color="#808080">);
</font>	   <font color="#808080">} </font><font color="#000080"><b>break</b></font><font color="#808080">;
   }
} </font><font color="#000080"><b>else if </b></font><font color="#808080">(</font>sreg<font color="#808080">==</font>ctArqs<font color="#808080">.</font>opIdioma<font color="#808080">) {
   </font><font color="#000080"><b>switch</b></font><font color="#808080">(</font>nOpcao<font color="#808080">) {
</font>	<font color="#000080"><b>case </b></font><font color="#FF0000">1</font><font color="#808080">: {
</font>		System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">) + </font>tIdioma<font color="#808080">.</font>codigo<font color="#808080">);
</font>		System<font color="#808080">.</font>Console<font color="#808080">.</font>Write<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">));
</font>		tIdioma<font color="#808080">.</font>idioma <font color="#808080">= </font>System<font color="#808080">.</font>Console<font color="#808080">.</font>In<font color="#808080">.</font>ReadLine<font color="#808080">();
</font>	   <font color="#808080">} </font><font color="#000080"><b>break</b></font><font color="#808080">;
</font>	<font color="#000080"><b>case </b></font><font color="#FF0000">2</font><font color="#808080">: {
</font>		System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;C&oacute;digo     Idioma&quot;</font><font color="#808080">);
</font>		System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;------     ------&quot;</font><font color="#808080">);
</font>	   <font color="#808080">} </font><font color="#000080"><b>break</b></font><font color="#808080">;
</font>	<font color="#000080"><b>case </b></font><font color="#FF0000">3</font><font color="#808080">: {
</font>		tIdioma<font color="#808080">.</font>codigo <font color="#808080">= </font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">).</font>Trim<font color="#808080">();
</font>		tIdioma<font color="#808080">.</font>idioma <font color="#808080">= </font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">11</font><font color="#808080">, </font><font color="#FF0000">20</font><font color="#808080">).</font>Trim<font color="#808080">();
</font>		System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font>esp<font color="#808080">(</font>tIdioma<font color="#808080">.</font>codigo<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">) + </font><font color="#800000">&quot; &quot; </font><font color="#808080">+
</font>						   esp<font color="#808080">(</font>tIdioma<font color="#808080">.</font>idioma<font color="#808080">,</font><font color="#FF0000">20</font><font color="#808080">));
</font>	   <font color="#808080">} </font><font color="#000080"><b>break</b></font><font color="#808080">;
   }
} </font><font color="#000080"><b>else if </b></font><font color="#808080">(</font>sreg<font color="#808080">==</font>ctArqs<font color="#808080">.</font>opPais<font color="#808080">) {
   </font><font color="#000080"><b>switch</b></font><font color="#808080">(</font>nOpcao<font color="#808080">) {
</font>	<font color="#000080"><b>case </b></font><font color="#FF0000">1</font><font color="#808080">: {
</font>		System<font color="#808080">.</font>Console<font color="#808080">.</font>Write<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">));
</font>		tPais<font color="#808080">.</font>pais <font color="#808080">= </font>System<font color="#808080">.</font>Console<font color="#808080">.</font>In<font color="#808080">.</font>ReadLine<font color="#808080">();
</font>	   <font color="#808080">} </font><font color="#000080"><b>break</b></font><font color="#808080">;
</font>	<font color="#000080"><b>case </b></font><font color="#FF0000">2</font><font color="#808080">: {
</font>		System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;C&oacute;digo Pa&iacute;s&quot;</font><font color="#808080">);
</font>		System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;------ ----&quot;</font><font color="#808080">);
</font>	   <font color="#808080">} </font><font color="#000080"><b>break</b></font><font color="#808080">;
</font>	<font color="#000080"><b>case </b></font><font color="#FF0000">3</font><font color="#808080">: {
</font>		tPais<font color="#808080">.</font>codigo <font color="#808080">= </font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">).</font>Trim<font color="#808080">();
</font>		tPais<font color="#808080">.</font>pais <font color="#808080">= </font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">4</font><font color="#808080">, </font><font color="#FF0000">50</font><font color="#808080">).</font>Trim<font color="#808080">();
</font>		System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font>esp<font color="#808080">(</font>tPais<font color="#808080">.</font>codigo<font color="#808080">,</font><font color="#FF0000">3</font><font color="#808080">)+</font><font color="#800000">&quot;    &quot;</font><font color="#808080">+</font>esp<font color="#808080">(</font>tPais<font color="#808080">.</font>pais<font color="#808080">,</font><font color="#FF0000">50</font><font color="#808080">));
</font>	   <font color="#808080">} </font><font color="#000080"><b>break</b></font><font color="#808080">;
   }
} </font><font color="#000080"><b>else if </b></font><font color="#808080">(</font>sreg<font color="#808080">==</font>ctArqs<font color="#808080">.</font>opProfissao<font color="#808080">) {
   </font><font color="#000080"><b>switch</b></font><font color="#808080">(</font>nOpcao<font color="#808080">) {
</font>	<font color="#000080"><b>case </b></font><font color="#FF0000">1</font><font color="#808080">: {
</font>		System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">) + </font>tProfissao<font color="#808080">.</font>codigo<font color="#808080">);
</font>		System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">));
</font>		tProfissao<font color="#808080">.</font>profissao <font color="#808080">= </font>System<font color="#808080">.</font>Console<font color="#808080">.</font>In<font color="#808080">.</font>ReadLine<font color="#808080">();
</font>	   <font color="#808080">} </font><font color="#000080"><b>break</b></font><font color="#808080">;
</font>	<font color="#000080"><b>case </b></font><font color="#FF0000">2</font><font color="#808080">: {
</font>		System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;C&oacute;digo     Profiss&atilde;o&quot;</font><font color="#808080">);
</font>		System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;------     ---------&quot;</font><font color="#808080">);
</font>	   <font color="#808080">} </font><font color="#000080"><b>break</b></font><font color="#808080">;
</font>	<font color="#000080"><b>case </b></font><font color="#FF0000">3</font><font color="#808080">: {
</font>		tProfissao<font color="#808080">.</font>codigo <font color="#808080">= </font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">).</font>Trim<font color="#808080">();
</font>		tProfissao<font color="#808080">.</font>profissao <font color="#808080">= </font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">11</font><font color="#808080">, </font><font color="#FF0000">50</font><font color="#808080">).</font>Trim<font color="#808080">();
</font>		System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font>esp<font color="#808080">(</font>tProfissao<font color="#808080">.</font>codigo<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">)+</font><font color="#800000">&quot; &quot;</font><font color="#808080">+
</font>				esp<font color="#808080">(</font>tProfissao<font color="#808080">.</font>profissao<font color="#808080">,</font><font color="#FF0000">50</font><font color="#808080">));
</font>	   <font color="#808080">} </font><font color="#000080"><b>break</b></font><font color="#808080">;
   }
} </font><font color="#000080"><b>else if </b></font><font color="#808080">(</font>sreg<font color="#808080">==</font>ctArqs<font color="#808080">.</font>opLivro<font color="#808080">) {
   </font><font color="#000080"><b>switch</b></font><font color="#808080">(</font>nOpcao<font color="#808080">) {
</font>	<font color="#000080"><b>case </b></font><font color="#FF0000">1</font><font color="#808080">: {
</font>		System<font color="#808080">.</font>Console<font color="#808080">.</font>Write<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">));
</font>		tLivro<font color="#808080">.</font>titulo <font color="#808080">= </font>System<font color="#808080">.</font>Console<font color="#808080">.</font>In<font color="#808080">.</font>ReadLine<font color="#808080">();
</font>		tLivro<font color="#808080">.</font>edicao <font color="#808080">= </font>validaNumero<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">), </font>tLivro<font color="#808080">.</font>edicao<font color="#808080">);
</font>		tLivro<font color="#808080">.</font>anopubli <font color="#808080">= </font>validaNumero<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">4</font><font color="#808080">), </font>tLivro<font color="#808080">.</font>anopubli<font color="#808080">);
</font>		mostrarSubDados<font color="#808080">(</font>ctArqs<font color="#808080">.</font>opLivro<font color="#808080">, </font>ctArqs<font color="#808080">.</font>opEditora<font color="#808080">, </font><font color="#0000FF"><b>false</b></font><font color="#808080">);
</font>		tLivro<font color="#808080">.</font>volume <font color="#808080">= </font>validaNumero<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">6</font><font color="#808080">), </font>tLivro<font color="#808080">.</font>volume<font color="#808080">);
</font>		mostrarSubDados<font color="#808080">(</font>ctArqs<font color="#808080">.</font>opLivro<font color="#808080">, </font>ctArqs<font color="#808080">.</font>opIdioma<font color="#808080">, </font><font color="#0000FF"><b>false</b></font><font color="#808080">);
</font>		tLivro<font color="#808080">.</font>npaginas <font color="#808080">= </font>validaNumero<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">8</font><font color="#808080">), </font>tLivro<font color="#808080">.</font>npaginas<font color="#808080">);
</font>		tLivro<font color="#808080">.</font>preco <font color="#808080">= </font>validaNumero<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">9</font><font color="#808080">), </font>tLivro<font color="#808080">.</font>preco<font color="#808080">);
</font>		tLivro<font color="#808080">.</font>qtdestoque <font color="#808080">= </font>validaNumero<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">),
</font>		tLivro<font color="#808080">.</font>qtdestoque<font color="#808080">);
</font>	   <font color="#808080">} </font><font color="#000080"><b>break</b></font><font color="#808080">;
</font>	<font color="#000080"><b>case </b></font><font color="#FF0000">3</font><font color="#808080">: {
</font>		tLivro<font color="#808080">.</font>isbn <font color="#808080">= </font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">13</font><font color="#808080">).</font>Trim<font color="#808080">();
</font>		tLivro<font color="#808080">.</font>titulo <font color="#808080">= </font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">14</font><font color="#808080">, </font><font color="#FF0000">50</font><font color="#808080">).</font>Trim<font color="#808080">();
</font>		tLivro<font color="#808080">.</font>edicao <font color="#808080">= </font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">64</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">).</font>Trim<font color="#808080">();
</font>		tLivro<font color="#808080">.</font>anopubli <font color="#808080">= </font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">74</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">).</font>Trim<font color="#808080">();
</font>		tLivro<font color="#808080">.</font>codeditora <font color="#808080">= </font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">84</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">).</font>Trim<font color="#808080">();
</font>		tLivro<font color="#808080">.</font>volume <font color="#808080">= </font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">94</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">).</font>Trim<font color="#808080">();
</font>		tLivro<font color="#808080">.</font>codidioma <font color="#808080">= </font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">104</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">).</font>Trim<font color="#808080">();
</font>		tLivro<font color="#808080">.</font>npaginas <font color="#808080">= </font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">114</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">).</font>Trim<font color="#808080">();
</font>		tLivro<font color="#808080">.</font>preco <font color="#808080">= </font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">124</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">).</font>Trim<font color="#808080">();
</font>		tLivro<font color="#808080">.</font>qtdestoque <font color="#808080">= </font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">134</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">).</font>Trim<font color="#808080">();
</font>		System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;--------------------&quot;</font><font color="#808080">);
</font>		System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">) + </font>tLivro<font color="#808080">.</font>isbn<font color="#808080">);
</font>		System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">) + </font>tLivro<font color="#808080">.</font>titulo<font color="#808080">);
</font>		System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">) + </font>tLivro<font color="#808080">.</font>edicao<font color="#808080">);
</font>		System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">4</font><font color="#808080">) + </font>tLivro<font color="#808080">.</font>anopubli<font color="#808080">);
</font>		System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">5</font><font color="#808080">) + </font>tLivro<font color="#808080">.</font>codeditora<font color="#808080">);
</font>		mostrarSubDados<font color="#808080">(</font>ctArqs<font color="#808080">.</font>opLivro<font color="#808080">, </font>ctArqs<font color="#808080">.</font>opEditora<font color="#808080">, </font><font color="#0000FF"><b>true</b></font><font color="#808080">);
</font>		System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">6</font><font color="#808080">) + </font>tLivro<font color="#808080">.</font>volume<font color="#808080">);
</font>		System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">7</font><font color="#808080">) + </font>tLivro<font color="#808080">.</font>codidioma<font color="#808080">);
</font>		mostrarSubDados<font color="#808080">(</font>ctArqs<font color="#808080">.</font>opLivro<font color="#808080">, </font>ctArqs<font color="#808080">.</font>opIdioma<font color="#808080">, </font><font color="#0000FF"><b>true</b></font><font color="#808080">);
</font>		System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">8</font><font color="#808080">) + </font>tLivro<font color="#808080">.</font>npaginas<font color="#808080">);
</font>		System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">9</font><font color="#808080">) + </font>tLivro<font color="#808080">.</font>preco<font color="#808080">);
</font>		System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">) + </font>tLivro<font color="#808080">.</font>qtdestoque<font color="#808080">);
</font>		ListarRegLigados<font color="#808080">(</font>tfLivroAss<font color="#808080">, </font>ctArqs<font color="#808080">.</font>opLivroAss<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">13</font><font color="#808080">, </font><font color="#FF0000">14</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">, </font>tLivro<font color="#808080">.</font>isbn<font color="#808080">,
</font>						 tfAssunto<font color="#808080">, </font>ctArqs<font color="#808080">.</font>opAssunto<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">4</font><font color="#808080">);
</font>		ListarRegLigados<font color="#808080">(</font>tfLivroAut<font color="#808080">, </font>ctArqs<font color="#808080">.</font>opLivroAut<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">13</font><font color="#808080">, </font><font color="#FF0000">14</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">, </font>tLivro<font color="#808080">.</font>isbn<font color="#808080">,
</font>						 tfAutor<font color="#808080">, </font>ctArqs<font color="#808080">.</font>opAutor<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">4</font><font color="#808080">);
</font>	   <font color="#808080">} </font><font color="#000080"><b>break</b></font><font color="#808080">;
   }
} </font><font color="#000080"><b>else if </b></font><font color="#808080">(</font>sreg<font color="#808080">==</font>ctArqs<font color="#808080">.</font>opCliente<font color="#808080">) {
   </font><font color="#000080"><b>switch</b></font><font color="#808080">(</font>nOpcao<font color="#808080">) {
</font>	<font color="#000080"><b>case </b></font><font color="#FF0000">1</font><font color="#808080">: {
</font>		System<font color="#808080">.</font>Console<font color="#808080">.</font>Write<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">));
</font>		tCliente<font color="#808080">.</font>nome <font color="#808080">= </font>System<font color="#808080">.</font>Console<font color="#808080">.</font>In<font color="#808080">.</font>ReadLine<font color="#808080">();
</font>		System<font color="#808080">.</font>Console<font color="#808080">.</font>Write<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">));
</font>		tCliente<font color="#808080">.</font>email <font color="#808080">= </font>System<font color="#808080">.</font>Console<font color="#808080">.</font>In<font color="#808080">.</font>ReadLine<font color="#808080">();
</font>		System<font color="#808080">.</font>Console<font color="#808080">.</font>Write<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">4</font><font color="#808080">));
</font>		tCliente<font color="#808080">.</font>identidade <font color="#808080">= </font>System<font color="#808080">.</font>Console<font color="#808080">.</font>In<font color="#808080">.</font>ReadLine<font color="#808080">();
</font>		System<font color="#808080">.</font>Console<font color="#808080">.</font>Write<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">5</font><font color="#808080">));
</font>		tCliente<font color="#808080">.</font>sexo <font color="#808080">= </font>System<font color="#808080">.</font>Console<font color="#808080">.</font>In<font color="#808080">.</font>ReadLine<font color="#808080">();
</font>		System<font color="#808080">.</font>Console<font color="#808080">.</font>Write<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">6</font><font color="#808080">));
</font>		tCliente<font color="#808080">.</font>telefone <font color="#808080">= </font>System<font color="#808080">.</font>Console<font color="#808080">.</font>In<font color="#808080">.</font>ReadLine<font color="#808080">();
</font>		tCliente<font color="#808080">.</font>dtnascimento <font color="#808080">=
</font>				validaDataHora<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">7</font><font color="#808080">), </font>tCliente<font color="#808080">.</font>dtnascimento<font color="#808080">, </font><font color="#0000FF"><b>true</b></font><font color="#808080">);
</font>		mostrarSubDados<font color="#808080">(</font>ctArqs<font color="#808080">.</font>opCliente<font color="#808080">, </font>ctArqs<font color="#808080">.</font>opEndereco<font color="#808080">, </font><font color="#0000FF"><b>false</b></font><font color="#808080">);
</font>		mostrarSubDados<font color="#808080">(</font>ctArqs<font color="#808080">.</font>opCliente<font color="#808080">, </font>ctArqs<font color="#808080">.</font>opPais<font color="#808080">, </font><font color="#0000FF"><b>false</b></font><font color="#808080">);
</font>		mostrarSubDados<font color="#808080">(</font>ctArqs<font color="#808080">.</font>opCliente<font color="#808080">, </font>ctArqs<font color="#808080">.</font>opProfissao<font color="#808080">, </font><font color="#0000FF"><b>false</b></font><font color="#808080">);
</font>	   <font color="#808080">} </font><font color="#000080"><b>break</b></font><font color="#808080">;
</font>	<font color="#000080"><b>case </b></font><font color="#FF0000">3</font><font color="#808080">: {
</font>		tCliente<font color="#808080">.</font>cpf <font color="#808080">= </font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">14</font><font color="#808080">).</font>Trim<font color="#808080">();
</font>		tCliente<font color="#808080">.</font>nome <font color="#808080">= </font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">15</font><font color="#808080">, </font><font color="#FF0000">30</font><font color="#808080">).</font>Trim<font color="#808080">();
</font>		tCliente<font color="#808080">.</font>email <font color="#808080">= </font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">45</font><font color="#808080">, </font><font color="#FF0000">30</font><font color="#808080">).</font>Trim<font color="#808080">();
</font>		tCliente<font color="#808080">.</font>identidade <font color="#808080">= </font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">75</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">).</font>Trim<font color="#808080">();
</font>		tCliente<font color="#808080">.</font>sexo <font color="#808080">= </font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">85</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">).</font>Trim<font color="#808080">();
</font>		tCliente<font color="#808080">.</font>telefone <font color="#808080">= </font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">86</font><font color="#808080">, </font><font color="#FF0000">17</font><font color="#808080">).</font>Trim<font color="#808080">();
</font>		tCliente<font color="#808080">.</font>dtnascimento <font color="#808080">= </font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">103</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">).</font>Trim<font color="#808080">();
</font>		tCliente<font color="#808080">.</font>codendereco <font color="#808080">= </font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">113</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">).</font>Trim<font color="#808080">();
</font>		tCliente<font color="#808080">.</font>codpais <font color="#808080">= </font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">123</font><font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">).</font>Trim<font color="#808080">();
</font>		tCliente<font color="#808080">.</font>codprofissao <font color="#808080">= </font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">126</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">).</font>Trim<font color="#808080">();
</font>		System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;--------------------&quot;</font><font color="#808080">);
</font>		System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">) + </font>tCliente<font color="#808080">.</font>cpf<font color="#808080">);
</font>		System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">) + </font>tCliente<font color="#808080">.</font>nome<font color="#808080">);
</font>		System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">) + </font>tCliente<font color="#808080">.</font>email<font color="#808080">);
</font>		System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">4</font><font color="#808080">) + </font>tCliente<font color="#808080">.</font>identidade<font color="#808080">);
</font>		System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">5</font><font color="#808080">) + </font>tCliente<font color="#808080">.</font>sexo<font color="#808080">);
</font>		System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">6</font><font color="#808080">) + </font>tCliente<font color="#808080">.</font>telefone<font color="#808080">);
</font>		System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">7</font><font color="#808080">) + </font>tCliente<font color="#808080">.</font>dtnascimento<font color="#808080">);
</font>		System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">8</font><font color="#808080">) + </font>tCliente<font color="#808080">.</font>codendereco<font color="#808080">);
</font>		mostrarSubDados<font color="#808080">(</font>ctArqs<font color="#808080">.</font>opCliente<font color="#808080">, </font>ctArqs<font color="#808080">.</font>opEndereco<font color="#808080">, </font><font color="#0000FF"><b>true</b></font><font color="#808080">);
</font>		System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">9</font><font color="#808080">) + </font>tCliente<font color="#808080">.</font>codpais<font color="#808080">);
</font>		mostrarSubDados<font color="#808080">(</font>ctArqs<font color="#808080">.</font>opCliente<font color="#808080">, </font>ctArqs<font color="#808080">.</font>opPais<font color="#808080">, </font><font color="#0000FF"><b>true</b></font><font color="#808080">);
</font>		System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">) + </font>tCliente<font color="#808080">.</font>codprofissao<font color="#808080">);
</font>		mostrarSubDados<font color="#808080">(</font>ctArqs<font color="#808080">.</font>opCliente<font color="#808080">, </font>ctArqs<font color="#808080">.</font>opProfissao<font color="#808080">, </font><font color="#0000FF"><b>true</b></font><font color="#808080">);
</font>	   <font color="#808080">} </font><font color="#000080"><b>break</b></font><font color="#808080">;
   }
} </font><font color="#000080"><b>else if </b></font><font color="#808080">(</font>sreg<font color="#808080">==</font>ctArqs<font color="#808080">.</font>opVenda<font color="#808080">) {
   </font><font color="#000080"><b>switch</b></font><font color="#808080">(</font>nOpcao<font color="#808080">) {
    </font><font color="#000080"><b>case </b></font><font color="#FF0000">1</font><font color="#808080">: </font>mostrarSubDados<font color="#808080">(</font>ctArqs<font color="#808080">.</font>opVenda<font color="#808080">,</font>ctArqs<font color="#808080">.</font>opVenda<font color="#808080">, </font><font color="#0000FF"><b>false</b></font><font color="#808080">); </font><font color="#000080"><b>break</b></font><font color="#808080">;
    </font><font color="#000080"><b>case </b></font><font color="#FF0000">2</font><font color="#808080">: {
</font>		System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;DataHoraVenda       CPF            ISBN          &quot; </font><font color="#808080">+
</font>		<font color="#800000">&quot;Pre&ccedil;oVenda&quot;</font><font color="#808080">);
</font>		System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;-------------       ---            ----          &quot; </font><font color="#808080">+
</font>		<font color="#800000">&quot;----------&quot;</font><font color="#808080">);
</font>	   <font color="#808080">} </font><font color="#000080"><b>break</b></font><font color="#808080">;
</font>	<font color="#000080"><b>case </b></font><font color="#FF0000">3</font><font color="#808080">: {
</font>		tVenda<font color="#808080">.</font>dthrvenda <font color="#808080">= </font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">19</font><font color="#808080">).</font>Trim<font color="#808080">();
</font>		tVenda<font color="#808080">.</font>cpf <font color="#808080">= </font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">20</font><font color="#808080">, </font><font color="#FF0000">14</font><font color="#808080">).</font>Trim<font color="#808080">();
</font>		tVenda<font color="#808080">.</font>isbn <font color="#808080">= </font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">34</font><font color="#808080">, </font><font color="#FF0000">13</font><font color="#808080">).</font>Trim<font color="#808080">();
</font>		tVenda<font color="#808080">.</font>precovenda <font color="#808080">= </font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF0000">47</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">).</font>Trim<font color="#808080">();
</font>		System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font>esp<font color="#808080">(</font>tVenda<font color="#808080">.</font>dthrvenda<font color="#808080">,</font><font color="#FF0000">19</font><font color="#808080">)+</font><font color="#800000">&quot; &quot;</font><font color="#808080">+</font>esp<font color="#808080">(</font>tVenda<font color="#808080">.</font>cpf<font color="#808080">,</font><font color="#FF0000">14</font><font color="#808080">)+</font><font color="#800000">&quot; &quot;</font><font color="#808080">+
</font>		esp<font color="#808080">(</font>tVenda<font color="#808080">.</font>isbn<font color="#808080">,</font><font color="#FF0000">13</font><font color="#808080">)+</font><font color="#800000">&quot; &quot;</font><font color="#808080">+</font>esp<font color="#808080">(</font>tVenda<font color="#808080">.</font>precovenda<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">));
</font>	   <font color="#808080">} </font><font color="#000080"><b>break</b></font><font color="#808080">;
   }
}

}
<i>/*------------------------------------------------------------------------------
Mostra as sub inform&ccedil;&otilde;es de entrada e de sa&iacute;da.
sreg - o tipo de arquivo
ssubreg - o subtipo de arquivo
bSoMostrar - se vai s&oacute; mostrar na sa&iacute;da
------------------------------------------------------------------------------*/
</i></font><font color="#0000FF"><b>void </b></font>mostrarSubDados<font color="#808080">(</font>ctArqs sreg<font color="#808080">, </font>ctArqs ssubreg<font color="#808080">, </font>Boolean bSoMostrar<font color="#808080">) {
</font><font color="#0000FF"><b>string </b></font>sRegistro<font color="#808080">, </font>sPreco<font color="#808080">;
</font><font color="#0000FF"><b>int </b></font>nMaxTentativas<font color="#808080">;

</font>nMaxTentativas <font color="#808080">= </font><font color="#FF0000">3</font><font color="#808080">;
</font><font color="#000080"><b>if </b></font><font color="#808080">(</font>sreg<font color="#808080">==</font>ctArqs<font color="#808080">.</font>opLivro<font color="#808080">) {
  </font><font color="#000080"><b>if </b></font><font color="#808080">(</font>ssubreg<font color="#808080">==</font>ctArqs<font color="#808080">.</font>opEditora<font color="#808080">) {
</font>	<font color="#000080"><b>if </b></font><font color="#808080">(</font>bSoMostrar<font color="#808080">)
</font>	   sRegistro <font color="#808080">= </font>pesqArq<font color="#808080">(</font>tfEditora<font color="#808080">,</font>tLivro<font color="#808080">.</font>codeditora<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">,</font>tamReg<font color="#808080">(</font>ctArqs<font color="#808080">.</font>opEditora<font color="#808080">));
</font>	<font color="#000080"><b>else
</b></font>	   sRegistro <font color="#808080">= </font>validaEntrada<font color="#808080">(</font>tfEditora<font color="#808080">,</font>ssubreg<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font>tLivro<font color="#808080">.</font>codeditora<font color="#808080">,
</font>				  nMaxTentativas<font color="#808080">,</font><font color="#0000FF"><b>false</b></font><font color="#808080">,</font>ctTipo<font color="#808080">.</font>opNumero<font color="#808080">);
</font>	<font color="#000080"><b>if </b></font><font color="#808080">(</font>sRegistro<font color="#808080">.</font>Equals<font color="#808080">(</font><font color="#800000">&quot;&quot;</font><font color="#808080">)==</font><font color="#0000FF"><b>false</b></font><font color="#808080">) {
</font>	  tLivro<font color="#808080">.</font>codeditora <font color="#808080">= </font>copy<font color="#808080">(</font>sRegistro<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">).</font>Trim<font color="#808080">();
</font>	  System<font color="#808080">.</font>Console<font color="#808080">.</font>Write<font color="#808080">(</font><font color="#800000">&quot; &quot;</font><font color="#808080">+</font>rotulo<font color="#808080">(</font>ctArqs<font color="#808080">.</font>opEditora<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">));
</font>	  System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font>copy<font color="#808080">(</font>sRegistro<font color="#808080">, </font>g_nPosChave<font color="#808080">, </font>g_nTamChave<font color="#808080">));
</font>	<font color="#808080">}
  } </font><font color="#000080"><b>else if </b></font><font color="#808080">(</font>ssubreg<font color="#808080">==</font>ctArqs<font color="#808080">.</font>opIdioma<font color="#808080">) {
</font>	<font color="#000080"><b>if </b></font><font color="#808080">(</font>bSoMostrar<font color="#808080">)
</font>	   sRegistro <font color="#808080">= </font>pesqArq<font color="#808080">(</font>tfIdioma<font color="#808080">, </font>tLivro<font color="#808080">.</font>codidioma<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">,</font>tamReg<font color="#808080">(</font>ctArqs<font color="#808080">.</font>opIdioma<font color="#808080">));
</font>	<font color="#000080"><b>else
</b></font>	   sRegistro <font color="#808080">= </font>validaEntrada<font color="#808080">(</font>tfIdioma<font color="#808080">,</font>ssubreg<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font>tLivro<font color="#808080">.</font>codidioma<font color="#808080">,
</font>				  nMaxTentativas<font color="#808080">,</font><font color="#0000FF"><b>false</b></font><font color="#808080">,</font>ctTipo<font color="#808080">.</font>opNumero<font color="#808080">);
</font>	<font color="#000080"><b>if </b></font><font color="#808080">(</font>sRegistro<font color="#808080">.</font>Equals<font color="#808080">(</font><font color="#800000">&quot;&quot;</font><font color="#808080">)==</font><font color="#0000FF"><b>false</b></font><font color="#808080">) {
</font>	  tLivro<font color="#808080">.</font>codidioma <font color="#808080">= </font>copy<font color="#808080">(</font>sRegistro<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">).</font>Trim<font color="#808080">();
</font>	  System<font color="#808080">.</font>Console<font color="#808080">.</font>Write<font color="#808080">(</font><font color="#800000">&quot; &quot;</font><font color="#808080">+</font>rotulo<font color="#808080">(</font>ctArqs<font color="#808080">.</font>opIdioma<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">));
</font>	  System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font>copy<font color="#808080">(</font>sRegistro<font color="#808080">, </font>g_nPosChave<font color="#808080">, </font>g_nTamChave<font color="#808080">));
</font>	<font color="#808080">}
  }
} </font><font color="#000080"><b>else if </b></font><font color="#808080">(</font>sreg<font color="#808080">==</font>ctArqs<font color="#808080">.</font>opCliente<font color="#808080">) {
  </font><font color="#000080"><b>if </b></font><font color="#808080">(</font>ssubreg<font color="#808080">==</font>ctArqs<font color="#808080">.</font>opEndereco<font color="#808080">) {
</font>	<font color="#000080"><b>if </b></font><font color="#808080">(</font>bSoMostrar<font color="#808080">)
</font>	   sRegistro <font color="#808080">= </font>pesqArq<font color="#808080">(</font>tfEndereco<font color="#808080">, </font>tCliente<font color="#808080">.</font>codendereco<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">,
</font>				  tamReg<font color="#808080">(</font>ctArqs<font color="#808080">.</font>opEndereco<font color="#808080">));
</font>	<font color="#000080"><b>else
</b></font>	   sRegistro <font color="#808080">= </font>validaEntrada<font color="#808080">(</font>tfEndereco<font color="#808080">,</font>ssubreg<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font>tCliente<font color="#808080">.</font>codendereco<font color="#808080">,
</font>				  nMaxTentativas<font color="#808080">,</font><font color="#0000FF"><b>false</b></font><font color="#808080">,</font>ctTipo<font color="#808080">.</font>opNumero<font color="#808080">);
</font>	<font color="#000080"><b>if </b></font><font color="#808080">(</font>sRegistro<font color="#808080">.</font>Equals<font color="#808080">(</font><font color="#800000">&quot;&quot;</font><font color="#808080">)==</font><font color="#0000FF"><b>false</b></font><font color="#808080">) {
</font>	  tCliente<font color="#808080">.</font>codendereco <font color="#808080">= </font>copy<font color="#808080">(</font>sRegistro<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">).</font>Trim<font color="#808080">();
</font>	  System<font color="#808080">.</font>Console<font color="#808080">.</font>Write<font color="#808080">(</font><font color="#800000">&quot; &quot;</font><font color="#808080">+</font>rotulo<font color="#808080">(</font>ctArqs<font color="#808080">.</font>opEndereco<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">));
</font>	  System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font>copy<font color="#808080">(</font>sRegistro<font color="#808080">, </font>g_nPosChave<font color="#808080">, </font>g_nTamChave<font color="#808080">));
</font>	  System<font color="#808080">.</font>Console<font color="#808080">.</font>Write<font color="#808080">(</font><font color="#800000">&quot; &quot;</font><font color="#808080">+</font>rotulo<font color="#808080">(</font>ctArqs<font color="#808080">.</font>opEndereco<font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">));
</font>	  System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font>copy<font color="#808080">(</font>sRegistro<font color="#808080">, </font>g_nPosChave<font color="#808080">, </font>g_nTamChave<font color="#808080">));
</font>	  System<font color="#808080">.</font>Console<font color="#808080">.</font>Write<font color="#808080">(</font><font color="#800000">&quot; &quot;</font><font color="#808080">+</font>rotulo<font color="#808080">(</font>ctArqs<font color="#808080">.</font>opEndereco<font color="#808080">, </font><font color="#FF0000">4</font><font color="#808080">));
</font>	  System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font>copy<font color="#808080">(</font>sRegistro<font color="#808080">, </font>g_nPosChave<font color="#808080">, </font>g_nTamChave<font color="#808080">));
</font>	  System<font color="#808080">.</font>Console<font color="#808080">.</font>Write<font color="#808080">(</font><font color="#800000">&quot; &quot;</font><font color="#808080">+</font>rotulo<font color="#808080">(</font>ctArqs<font color="#808080">.</font>opEndereco<font color="#808080">, </font><font color="#FF0000">5</font><font color="#808080">));
</font>	  System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font>copy<font color="#808080">(</font>sRegistro<font color="#808080">, </font>g_nPosChave<font color="#808080">, </font>g_nTamChave<font color="#808080">));
</font>	  System<font color="#808080">.</font>Console<font color="#808080">.</font>Write<font color="#808080">(</font><font color="#800000">&quot; &quot;</font><font color="#808080">+</font>rotulo<font color="#808080">(</font>ctArqs<font color="#808080">.</font>opEndereco<font color="#808080">, </font><font color="#FF0000">6</font><font color="#808080">));
</font>	  System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font>copy<font color="#808080">(</font>sRegistro<font color="#808080">, </font>g_nPosChave<font color="#808080">, </font>g_nTamChave<font color="#808080">));
</font>	<font color="#808080">}
  } </font><font color="#000080"><b>else if </b></font><font color="#808080">(</font>ssubreg<font color="#808080">==</font>ctArqs<font color="#808080">.</font>opPais<font color="#808080">) {
</font>	<font color="#000080"><b>if </b></font><font color="#808080">(</font>bSoMostrar<font color="#808080">)
</font>	   sRegistro <font color="#808080">= </font>pesqArq<font color="#808080">(</font>tfPais<font color="#808080">, </font>tCliente<font color="#808080">.</font>codpais<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">, </font>tamReg<font color="#808080">(</font>ctArqs<font color="#808080">.</font>opPais<font color="#808080">));
</font>	<font color="#000080"><b>else
</b></font>	   sRegistro <font color="#808080">= </font>validaEntrada<font color="#808080">(</font>tfPais<font color="#808080">,</font>ssubreg<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font>tCliente<font color="#808080">.</font>codpais<font color="#808080">,
</font>				  nMaxTentativas<font color="#808080">,</font><font color="#0000FF"><b>false</b></font><font color="#808080">,</font>ctTipo<font color="#808080">.</font>opTexto<font color="#808080">);
</font>	<font color="#000080"><b>if </b></font><font color="#808080">(</font>sRegistro<font color="#808080">.</font>Equals<font color="#808080">(</font><font color="#800000">&quot;&quot;</font><font color="#808080">)==</font><font color="#0000FF"><b>false</b></font><font color="#808080">) {
</font>	  tCliente<font color="#808080">.</font>codpais <font color="#808080">= </font>copy<font color="#808080">(</font>sRegistro<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#FF0000">3</font><font color="#808080">).</font>Trim<font color="#808080">();
</font>	  System<font color="#808080">.</font>Console<font color="#808080">.</font>Write<font color="#808080">(</font><font color="#800000">&quot; &quot;</font><font color="#808080">+</font>rotulo<font color="#808080">(</font>ctArqs<font color="#808080">.</font>opPais<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">));
</font>	  System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font>copy<font color="#808080">(</font>sRegistro<font color="#808080">, </font>g_nPosChave<font color="#808080">, </font>g_nTamChave<font color="#808080">));
</font>	<font color="#808080">}
  } </font><font color="#000080"><b>else if </b></font><font color="#808080">(</font>ssubreg<font color="#808080">==</font>ctArqs<font color="#808080">.</font>opProfissao<font color="#808080">) {
</font>	<font color="#000080"><b>if </b></font><font color="#808080">(</font>bSoMostrar<font color="#808080">)
</font>	   sRegistro <font color="#808080">= </font>pesqArq<font color="#808080">(</font>tfProfissao<font color="#808080">, </font>tCliente<font color="#808080">.</font>codprofissao<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">,
</font>				  tamReg<font color="#808080">(</font>ctArqs<font color="#808080">.</font>opProfissao<font color="#808080">));
</font>	<font color="#000080"><b>else
</b></font>	   sRegistro <font color="#808080">= </font>validaEntrada<font color="#808080">(</font>tfProfissao<font color="#808080">,</font>ssubreg<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font>tCliente<font color="#808080">.</font>codprofissao<font color="#808080">,
</font>				  nMaxTentativas<font color="#808080">,</font><font color="#0000FF"><b>false</b></font><font color="#808080">,</font>ctTipo<font color="#808080">.</font>opNumero<font color="#808080">);
</font>	<font color="#000080"><b>if </b></font><font color="#808080">(</font>sRegistro<font color="#808080">.</font>Equals<font color="#808080">(</font><font color="#800000">&quot;&quot;</font><font color="#808080">)==</font><font color="#0000FF"><b>false</b></font><font color="#808080">) {
</font>	  tCliente<font color="#808080">.</font>codprofissao <font color="#808080">= </font>copy<font color="#808080">(</font>sRegistro<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">).</font>Trim<font color="#808080">();
</font>	  System<font color="#808080">.</font>Console<font color="#808080">.</font>Write<font color="#808080">(</font><font color="#800000">&quot; &quot;</font><font color="#808080">+</font>rotulo<font color="#808080">(</font>ctArqs<font color="#808080">.</font>opProfissao<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">));
</font>	  System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font>copy<font color="#808080">(</font>sRegistro<font color="#808080">, </font>g_nPosChave<font color="#808080">, </font>g_nTamChave<font color="#808080">));
</font>	<font color="#808080">}
  }
} </font><font color="#000080"><b>else if </b></font><font color="#808080">(</font>sreg<font color="#808080">==</font>ctArqs<font color="#808080">.</font>opVenda<font color="#808080">) {
  </font>sRegistro <font color="#808080">= </font>pesqArq<font color="#808080">(</font>tfLivro<font color="#808080">, </font>tVenda<font color="#808080">.</font>isbn<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">13</font><font color="#808080">, </font>tamReg<font color="#808080">(</font>ctArqs<font color="#808080">.</font>opLivro<font color="#808080">));
  </font><font color="#000080"><b>if </b></font><font color="#808080">(</font>sRegistro<font color="#808080">.</font>Equals<font color="#808080">(</font><font color="#800000">&quot;&quot;</font><font color="#808080">)==</font><font color="#0000FF"><b>false</b></font><font color="#808080">) {
</font>	System<font color="#808080">.</font>Console<font color="#808080">.</font>Write<font color="#808080">(</font><font color="#800000">&quot; &quot;</font><font color="#808080">+</font>rotulo<font color="#808080">(</font>ctArqs<font color="#808080">.</font>opLivro<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">)); <i>/* Titulo */
</i></font>	System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font>copy<font color="#808080">(</font>sRegistro<font color="#808080">, </font>g_nPosChave<font color="#808080">, </font>g_nTamChave<font color="#808080">));
</font>	System<font color="#808080">.</font>Console<font color="#808080">.</font>Write<font color="#808080">(</font><font color="#800000">&quot; &quot;</font><font color="#808080">+</font>rotulo<font color="#808080">(</font>ctArqs<font color="#808080">.</font>opLivro<font color="#808080">, </font><font color="#FF0000">9</font><font color="#808080">)); <i>/* Preco */
</i></font>	sPreco <font color="#808080">= </font>copy<font color="#808080">(</font>sRegistro<font color="#808080">, </font>g_nPosChave<font color="#808080">, </font>g_nTamChave<font color="#808080">);
</font>	g_nPreco <font color="#808080">= </font><font color="#0000FF"><b>double</b></font><font color="#808080">.</font>Parse<font color="#808080">(</font>sPreco<font color="#808080">);
</font>	System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font>sPreco<font color="#808080">);
  }
}
}
<i>/*------------------------------------------------------------------------------
Realiza os cadastros dos arquivos que se ligam a outros arquivos.
sreg - o tipo de arquivo
sacao - a a&ccedil;&atilde;o a ser realizada
sCodigo - um das chaves do arquivo de liga&ccedil;&atilde;o
------------------------------------------------------------------------------*/
</i></font><font color="#0000FF"><b>void </b></font>frmCadLigados<font color="#808080">(</font>ctArqs sreg<font color="#808080">, </font>ctAcao sacao<font color="#808080">, </font>String sCodigo<font color="#808080">)
{ </font><font color="#0000FF"><b>int </b></font>nQtd<font color="#808080">, </font>nCont<font color="#808080">, </font>nQtdEstoque<font color="#808080">;
  </font><font color="#0000FF"><b>double </b></font>nTotalPreco<font color="#808080">;
  </font><font color="#0000FF"><b>string </b></font>slinha<font color="#808080">, </font>sTotalPreco<font color="#808080">, </font>sPreco<font color="#808080">;
  </font><font color="#0000FF"><b>string </b></font>sQtd <font color="#808080">= </font><font color="#800000">&quot;&quot;</font><font color="#808080">;

</font><font color="#000080"><b>if </b></font><font color="#808080">(</font>sacao<font color="#808080">==</font>ctAcao<font color="#808080">.</font>opNovo<font color="#808080">) {
  </font>nCont <font color="#808080">= </font><font color="#FF0000">1</font><font color="#808080">;
  </font><font color="#000080"><b>if </b></font><font color="#808080">(</font>sreg<font color="#808080">==</font>ctArqs<font color="#808080">.</font>opLivroAss<font color="#808080">) {
</font>	sQtd <font color="#808080">= </font>validaNumero<font color="#808080">(</font><font color="#800000">&quot;Quantos assuntos quer cadastrar?: &quot;</font><font color="#808080">,</font>sQtd<font color="#808080">);
</font>	nQtd <font color="#808080">= </font><font color="#0000FF"><b>int</b></font><font color="#808080">.</font>Parse<font color="#808080">(</font>sQtd<font color="#808080">);
</font>	tfLivroAss<font color="#808080">.</font>Seek<font color="#808080">(</font><font color="#FF0000">0</font><font color="#808080">, </font>SeekOrigin<font color="#808080">.</font>Begin<font color="#808080">);
</font>	<font color="#000080"><b>while </b></font><font color="#808080">(</font>nCont <font color="#808080">&lt;= </font>nQtd<font color="#808080">) {
</font>	  tLivroAss<font color="#808080">.</font>isbn <font color="#808080">= </font>sCodigo<font color="#808080">;
</font>	  System<font color="#808080">.</font>Console<font color="#808080">.</font>Write<font color="#808080">(</font>rotulo<font color="#808080">(</font>ctArqs<font color="#808080">.</font>opLivroAss<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">));
</font>	  tLivroAss<font color="#808080">.</font>codassunto <font color="#808080">= </font>System<font color="#808080">.</font>Console<font color="#808080">.</font>In<font color="#808080">.</font>ReadLine<font color="#808080">();
</font>	  slinha <font color="#808080">= </font>pesqArq<font color="#808080">(</font>tfAssunto<font color="#808080">, </font>tLivroAss<font color="#808080">.</font>codassunto<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">,</font>tamReg<font color="#808080">(</font>ctArqs<font color="#808080">.</font>opAssunto<font color="#808080">));
</font>	  System<font color="#808080">.</font>Console<font color="#808080">.</font>Write<font color="#808080">(</font><font color="#800000">&quot; &quot;</font><font color="#808080">+</font>rotulo<font color="#808080">(</font>ctArqs<font color="#808080">.</font>opAssunto<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">));
</font>	  System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font>g_nPosChave<font color="#808080">, </font>g_nTamChave<font color="#808080">));
</font>	  pesqLinhaExcluida<font color="#808080">(</font>tfLivroAss<font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">));
</font>	  subMenu<font color="#808080">(</font><font color="#FF0000">14</font><font color="#808080">, </font>sreg<font color="#808080">);
</font>	  nCont<font color="#808080">++;
</font>	<font color="#808080">}
  } </font><font color="#000080"><b>else if </b></font><font color="#808080">(</font>sreg<font color="#808080">==</font>ctArqs<font color="#808080">.</font>opLivroAut<font color="#808080">) {
</font>	sQtd <font color="#808080">= </font>validaNumero<font color="#808080">(</font><font color="#800000">&quot;Quantos autores quer cadastrar?: &quot;</font><font color="#808080">,</font>sQtd<font color="#808080">);
</font>	nQtd <font color="#808080">= </font><font color="#0000FF"><b>int</b></font><font color="#808080">.</font>Parse<font color="#808080">(</font>sQtd<font color="#808080">);
</font>	tfLivroAut<font color="#808080">.</font>Seek<font color="#808080">(</font><font color="#FF0000">0</font><font color="#808080">, </font>SeekOrigin<font color="#808080">.</font>Begin<font color="#808080">);
</font>	<font color="#000080"><b>while </b></font><font color="#808080">(</font>nCont <font color="#808080">&lt;= </font>nQtd<font color="#808080">) {
</font>	  tLivroAut<font color="#808080">.</font>isbn <font color="#808080">= </font>sCodigo<font color="#808080">;
</font>	  System<font color="#808080">.</font>Console<font color="#808080">.</font>Write<font color="#808080">(</font>rotulo<font color="#808080">(</font>ctArqs<font color="#808080">.</font>opLivroAut<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">));
</font>	  tLivroAut<font color="#808080">.</font>codautor <font color="#808080">= </font>System<font color="#808080">.</font>Console<font color="#808080">.</font>In<font color="#808080">.</font>ReadLine<font color="#808080">();
</font>	  slinha <font color="#808080">= </font>pesqArq<font color="#808080">(</font>tfAutor<font color="#808080">, </font>tLivroAut<font color="#808080">.</font>codautor<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">,</font>tamReg<font color="#808080">(</font>ctArqs<font color="#808080">.</font>opAutor<font color="#808080">));
</font>	  System<font color="#808080">.</font>Console<font color="#808080">.</font>Write<font color="#808080">(</font><font color="#800000">&quot; &quot;</font><font color="#808080">+</font>rotulo<font color="#808080">(</font>ctArqs<font color="#808080">.</font>opAutor<font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">));
</font>	  System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font>g_nPosChave<font color="#808080">, </font>g_nTamChave<font color="#808080">));
</font>	  pesqLinhaExcluida<font color="#808080">(</font>tfLivroAut<font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">));
</font>	  subMenu<font color="#808080">(</font><font color="#FF0000">14</font><font color="#808080">, </font>sreg<font color="#808080">);
</font>	  nCont<font color="#808080">++;
</font>	<font color="#808080">}
  } </font><font color="#000080"><b>else if </b></font><font color="#808080">(</font>sreg<font color="#808080">==</font>ctArqs<font color="#808080">.</font>opVenda<font color="#808080">) {
</font>	sPreco <font color="#808080">= </font><font color="#800000">&quot;&quot;</font><font color="#808080">;
</font>	sTotalPreco <font color="#808080">= </font><font color="#800000">&quot;&quot;</font><font color="#808080">;
</font>	sQtd <font color="#808080">= </font>validaNumero<font color="#808080">(</font><font color="#800000">&quot;Quantos livros quer vender?: &quot;</font><font color="#808080">,</font>sQtd<font color="#808080">);
</font>	nQtd <font color="#808080">= </font><font color="#0000FF"><b>int</b></font><font color="#808080">.</font>Parse<font color="#808080">(</font>sQtd<font color="#808080">);
</font>	nTotalPreco <font color="#808080">= </font><font color="#FF0000">0</font><font color="#808080">;
</font>	<font color="#000080"><b>while </b></font><font color="#808080">(</font>nCont <font color="#808080">&lt;= </font>nQtd<font color="#808080">) {
</font>	  slinha <font color="#808080">= </font>validaEntrada<font color="#808080">(</font>tfLivro<font color="#808080">,</font>ctArqs<font color="#808080">.</font>opLivro<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font>tVenda<font color="#808080">.</font>isbn<font color="#808080">,</font><font color="#FF0000">3</font><font color="#808080">,</font><font color="#0000FF"><b>false</b></font><font color="#808080">,</font>ctTipo<font color="#808080">.</font>opTexto<font color="#808080">);
</font>	  <font color="#000080"><b>if </b></font><font color="#808080">(</font>slinha<font color="#808080">.</font>Equals<font color="#808080">(</font><font color="#800000">&quot;&quot;</font><font color="#808080">)==</font><font color="#0000FF"><b>false</b></font><font color="#808080">) {
</font>		tVenda<font color="#808080">.</font>isbn <font color="#808080">= </font>copy<font color="#808080">(</font>slinha<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#FF0000">13</font><font color="#808080">).</font>Trim<font color="#808080">();
</font>		<font color="#000080"><b>if </b></font><font color="#808080">(</font>ValidaISBN<font color="#808080">(</font>tVenda<font color="#808080">.</font>isbn<font color="#808080">)) {
</font>		  mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">);
</font>		  tLivro<font color="#808080">.</font>qtdestoque <font color="#808080">= </font>copy<font color="#808080">(</font>slinha<font color="#808080">,</font><font color="#FF0000">134</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">).</font>Trim<font color="#808080">();
</font>		  nQtdEstoque <font color="#808080">= </font><font color="#0000FF"><b>int</b></font><font color="#808080">.</font>Parse<font color="#808080">(</font>tLivro<font color="#808080">.</font>qtdestoque<font color="#808080">);
</font>		  <font color="#000080"><b>if </b></font><font color="#808080">(</font>nQtdEstoque <font color="#808080">&gt; </font><font color="#FF0000">0</font><font color="#808080">) {
</font>			 nTotalPreco <font color="#808080">= </font>nTotalPreco <font color="#808080">+ </font>g_nPreco<font color="#808080">;
</font>			 sPreco <font color="#808080">= </font>g_nPreco<font color="#808080">.</font>ToString<font color="#808080">();
</font>			 tVenda<font color="#808080">.</font>precovenda <font color="#808080">= </font>sPreco<font color="#808080">;
</font>			 g_SalvarInclusao <font color="#808080">= </font><font color="#0000FF"><b>false</b></font><font color="#808080">;
</font>			 subMenu<font color="#808080">(</font><font color="#FF0000">14</font><font color="#808080">, </font>sreg<font color="#808080">);
</font>			 <font color="#000080"><b>if </b></font><font color="#808080">(</font>g_SalvarInclusao<font color="#808080">) {
</font>				slinha <font color="#808080">= </font>pesqArq<font color="#808080">(</font>tfLivro<font color="#808080">, </font>tVenda<font color="#808080">.</font>isbn<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">13</font><font color="#808080">, </font>tamReg<font color="#808080">(</font>ctArqs<font color="#808080">.</font>opLivro<font color="#808080">));
</font>				<font color="#000080"><b>if </b></font><font color="#808080">(</font>slinha<font color="#808080">.</font>Equals<font color="#808080">(</font><font color="#800000">&quot;&quot;</font><font color="#808080">)==</font><font color="#0000FF"><b>false</b></font><font color="#808080">) {
</font>				   nQtdEstoque <font color="#808080">= </font>nQtdEstoque<font color="#808080">-</font><font color="#FF0000">1</font><font color="#808080">;
</font>				   tLivro<font color="#808080">.</font>qtdestoque <font color="#808080">= </font>nQtdEstoque<font color="#808080">.</font>ToString<font color="#808080">();
</font>				   slinha<font color="#808080">=</font>copy<font color="#808080">(</font>slinha<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#FF0000">133</font><font color="#808080">) + </font>esp<font color="#808080">(</font>tLivro<font color="#808080">.</font>qtdestoque<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">);
</font>				   escreveArq<font color="#808080">(</font>tfLivro<font color="#808080">, </font>slinha<font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">);
</font>				<font color="#808080">}
</font>			 <font color="#808080">}
</font>			 nCont<font color="#808080">++;
</font>		  <font color="#808080">} </font><font color="#000080"><b>else </b></font>System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font>MSG_SEMESTOQUE<font color="#808080">);
</font>		<font color="#808080">} </font><font color="#000080"><b>else </b></font>System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font>MSG_ISBNINV<font color="#808080">);
</font>	  <font color="#808080">}
</font>	<font color="#808080">}
</font>	sTotalPreco <font color="#808080">= </font>nTotalPreco<font color="#808080">.</font>ToString<font color="#808080">();
</font>	System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font><font color="#800000">&quot;Total de &quot;</font><font color="#808080">+</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">,</font><font color="#FF0000">4</font><font color="#808080">)+</font>sTotalPreco<font color="#808080">);
  }
} </font><font color="#000080"><b>else if </b></font><font color="#808080">(</font>sacao<font color="#808080">==</font>ctAcao<font color="#808080">.</font>opExcluir<font color="#808080">) {
  </font><font color="#000080"><b>if </b></font><font color="#808080">(</font>sreg<font color="#808080">==</font>ctArqs<font color="#808080">.</font>opLivroAss<font color="#808080">) {
</font>	 ExcluirRegLigados<font color="#808080">(</font>tfLivroAss<font color="#808080">, </font>sreg<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">13</font><font color="#808080">, </font>sCodigo<font color="#808080">);
  } </font><font color="#000080"><b>else if </b></font><font color="#808080">(</font>sreg<font color="#808080">==</font>ctArqs<font color="#808080">.</font>opLivroAut<font color="#808080">) {
</font>	 ExcluirRegLigados<font color="#808080">(</font>tfLivroAut<font color="#808080">, </font>sreg<font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">13</font><font color="#808080">, </font>sCodigo<font color="#808080">);
  }
}

}
<i>/*------------------------------------------------------------------------------
Realiza a exclus&atilde;o dos arquivos de liga&ccedil;&atilde;o.
sArq - o arquivo de liga&ccedil;&atilde;o
sreg - o tipo de arquivo de liga&ccedil;&atilde;o
nPosChave - a posicao inicial da chave dentro do registro
nTamChave - o tamanho da chave dentro do registro
sChave - a chave a ser excluida
------------------------------------------------------------------------------*/
</i></font><font color="#0000FF"><b>void </b></font>ExcluirRegLigados<font color="#808080">(</font>FileStream sArq<font color="#808080">, </font>ctArqs sreg<font color="#808080">, </font><font color="#0000FF"><b>int </b></font>nPosChave<font color="#808080">,
</font><font color="#0000FF"><b>int </b></font>nTamChave<font color="#808080">, </font><font color="#0000FF"><b>string </b></font>sChave<font color="#808080">) {
  </font><font color="#0000FF"><b>string </b></font>slinha <font color="#808080">= </font><font color="#800000">&quot;&quot;</font><font color="#808080">;
  </font><font color="#0000FF"><b>string </b></font>sCodigo<font color="#808080">;

</font>	sArq<font color="#808080">.</font>Seek<font color="#808080">(</font><font color="#FF0000">0</font><font color="#808080">, </font>SeekOrigin<font color="#808080">.</font>Begin<font color="#808080">);
</font>	<font color="#000080"><b>while </b></font><font color="#808080">(!</font>fimArq<font color="#808080">(</font>sArq<font color="#808080">)) {
</font>	  slinha <font color="#808080">= </font>lerArq<font color="#808080">(</font>sArq<font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">), </font>TAM_CRLF<font color="#808080">);
</font>	  <font color="#000080"><b>if </b></font><font color="#808080">(</font>slinha<font color="#808080">.</font>Equals<font color="#808080">(</font><font color="#800000">&quot;&quot;</font><font color="#808080">)==</font><font color="#0000FF"><b>false</b></font><font color="#808080">) {
</font>		sCodigo <font color="#808080">= </font>copy<font color="#808080">(</font>slinha<font color="#808080">,</font>nPosChave<font color="#808080">,</font>nTamChave<font color="#808080">).</font>Trim<font color="#808080">();
</font>		<font color="#000080"><b>if </b></font><font color="#808080">(</font>sCodigo<font color="#808080">.</font>Equals<font color="#808080">(</font>sChave<font color="#808080">))
</font>		   btnAcao<font color="#808080">(</font>sreg<font color="#808080">,</font>ctAcao<font color="#808080">.</font>opConfirmaExclusao<font color="#808080">);
</font>	  <font color="#808080">}
</font>	<font color="#808080">}

}

<i>/*------------------------------------------------------------------------------
Parte inicial do c&oacute;digo
------------------------------------------------------------------------------*/
  </i></font><font color="#0000FF"><b>static </b></font>Livrus cl <font color="#808080">= </font><font color="#000080"><b>new </b></font>Livrus<font color="#808080">();

  [</font>STAThread<font color="#808080">]
  </font><font color="#0000FF"><b>static void </b></font>Main<font color="#808080">(</font><font color="#0000FF"><b>string</b></font><font color="#808080">[] </font>args<font color="#808080">)
  {
    </font><font color="#000080"><b>if </b></font><font color="#808080">((</font>args<font color="#808080">.</font>Length <font color="#808080">&gt; </font><font color="#FF0000">0</font><font color="#808080">) &amp;&amp; (</font>args<font color="#808080">[</font><font color="#FF0000">0</font><font color="#808080">].</font>Equals<font color="#808080">(</font><font color="#800000">&quot;-cria&quot;</font><font color="#808080">)))
      </font>cl<font color="#808080">.</font>abrecriaArqs<font color="#808080">(</font><font color="#0000FF"><b>false</b></font><font color="#808080">);
    </font><font color="#000080"><b>else </b></font><font color="#808080">{
      </font>cl<font color="#808080">.</font>frmSplash<font color="#808080">();
      </font>cl<font color="#808080">.</font>abrecriaArqs<font color="#808080">(</font><font color="#0000FF"><b>true</b></font><font color="#808080">);
      </font><font color="#000080"><b>if </b></font><font color="#808080">(</font>cl<font color="#808080">.</font>frmLogin<font color="#808080">()) {
</font>    	cl<font color="#808080">.</font>bopcao <font color="#808080">= </font><font color="#0000FF"><b>true</b></font><font color="#808080">;
</font>    	<font color="#000080"><b>while</b></font><font color="#808080">(</font>cl<font color="#808080">.</font>bopcao<font color="#808080">) {
</font>    	  cl<font color="#808080">.</font>menu<font color="#808080">(</font><font color="#FF0000">1</font><font color="#808080">);
</font>    	  cl<font color="#808080">.</font>opmenu <font color="#808080">= </font>System<font color="#808080">.</font>Console<font color="#808080">.</font>In<font color="#808080">.</font>ReadLine<font color="#808080">()[</font><font color="#FF0000">0</font><font color="#808080">];
</font>    	  <font color="#000080"><b>if </b></font><font color="#808080">((</font>cl<font color="#808080">.</font>opmenu<font color="#808080">=='</font>C<font color="#808080">') || (</font>cl<font color="#808080">.</font>opmenu<font color="#808080">=='</font>c<font color="#808080">')) </font>cl<font color="#808080">.</font>usaMenu<font color="#808080">(</font><font color="#FF0000">1</font><font color="#808080">);
</font>    	  <font color="#000080"><b>else if </b></font><font color="#808080">((</font>cl<font color="#808080">.</font>opmenu<font color="#808080">=='</font>P<font color="#808080">') || (</font>cl<font color="#808080">.</font>opmenu<font color="#808080">=='</font>p<font color="#808080">')) </font>cl<font color="#808080">.</font>usaMenu<font color="#808080">(</font><font color="#FF0000">2</font><font color="#808080">);
</font>    	  <font color="#000080"><b>else if </b></font><font color="#808080">((</font>cl<font color="#808080">.</font>opmenu<font color="#808080">=='</font>V<font color="#808080">') || (</font>cl<font color="#808080">.</font>opmenu<font color="#808080">=='</font>v<font color="#808080">')) </font>cl<font color="#808080">.</font>usaMenu<font color="#808080">(</font><font color="#FF0000">3</font><font color="#808080">);
</font>    	  <font color="#000080"><b>else if </b></font><font color="#808080">((</font>cl<font color="#808080">.</font>opmenu<font color="#808080">=='</font>O<font color="#808080">') || (</font>cl<font color="#808080">.</font>opmenu<font color="#808080">=='</font>o<font color="#808080">')) </font>cl<font color="#808080">.</font>usaMenu<font color="#808080">(</font><font color="#FF0000">4</font><font color="#808080">);
</font>    	  <font color="#000080"><b>else </b></font>System<font color="#808080">.</font>Console<font color="#808080">.</font>WriteLine<font color="#808080">(</font>MSG_ERRO<font color="#808080">);
</font>    	<font color="#808080">}
      } </font><font color="#000080"><b>else </b></font><font color="#808080">{
</font>    	cl<font color="#808080">.</font>fechaArqs<font color="#808080">();
</font>    	System<font color="#808080">.</font>Environment<font color="#808080">.</font>Exit<font color="#808080">(</font><font color="#FF0000">0</font><font color="#808080">);
      }
    }
    </font>System<font color="#808080">.</font>Environment<font color="#808080">.</font>Exit<font color="#808080">(</font><font color="#FF0000">0</font><font color="#808080">);
  }
 }
}
</font></font>
</code></pre>
</body>
</html>