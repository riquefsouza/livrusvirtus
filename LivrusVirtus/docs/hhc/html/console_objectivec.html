<html>
<head>
<title>Livrus Virtus - Console - ObjectiveC</title>
</head>
<!-- Generated by ConTEXT HTML exporter -->
<body text="#000000" bgcolor="#FFFFFF">
<pre>
<code><font  face="Courier New"><font color="#808080"><i>/*------------------------------------------------------------------------------
 Sistema integrante do projeto Livrus Virtus.
 Todos os direitos reservados para Henrique F. de Souza.
 Vers&atilde;o programada na linguagem Objective-C.
------------------------------------------------------------------------------*/
// programa Livrus

</i></font><font color="#008080">#include &lt;stdlib.h&gt;
#include &lt;stdarg.h&gt;
#include &lt;time.h&gt;
#include &quot;objc/Object.h&quot;

</font><font color="#FF00FF">@</font><font color="#000080">interface Livrus </font><font color="#808080">: </font><font color="#000080">Object
</font><font color="#808080">{
 </font><font color="#FF00FF">@</font><font color="#0000FF"><b>private 
  struct </b></font><font color="#000080">regAssunto </font><font color="#808080">{
   </font><font color="#0000FF"><b>char </b></font><font color="#000080">codigo</font><font color="#808080">[</font><font color="#FF0000">10</font><font color="#808080">];
   </font><font color="#0000FF"><b>char </b></font><font color="#000080">assunto</font><font color="#808080">[</font><font color="#FF0000">30</font><font color="#808080">];
  };
  </font><font color="#0000FF"><b>struct </b></font><font color="#000080">regAutor </font><font color="#808080">{
   </font><font color="#0000FF"><b>char </b></font><font color="#000080">codigo</font><font color="#808080">[</font><font color="#FF0000">10</font><font color="#808080">];
   </font><font color="#0000FF"><b>char </b></font><font color="#000080">autor</font><font color="#808080">[</font><font color="#FF0000">30</font><font color="#808080">];
  };
  </font><font color="#0000FF"><b>struct </b></font><font color="#000080">regEditora </font><font color="#808080">{
   </font><font color="#0000FF"><b>char </b></font><font color="#000080">codigo</font><font color="#808080">[</font><font color="#FF0000">10</font><font color="#808080">];
   </font><font color="#0000FF"><b>char </b></font><font color="#000080">editora</font><font color="#808080">[</font><font color="#FF0000">50</font><font color="#808080">];
  };
  </font><font color="#0000FF"><b>struct </b></font><font color="#000080">regIdioma </font><font color="#808080">{
   </font><font color="#0000FF"><b>char </b></font><font color="#000080">codigo</font><font color="#808080">[</font><font color="#FF0000">10</font><font color="#808080">];
   </font><font color="#0000FF"><b>char </b></font><font color="#000080">idioma</font><font color="#808080">[</font><font color="#FF0000">20</font><font color="#808080">];
  };
  </font><font color="#0000FF"><b>struct </b></font><font color="#000080">regUsuario </font><font color="#808080">{
   </font><font color="#0000FF"><b>char </b></font><font color="#000080">login</font><font color="#808080">[</font><font color="#FF0000">10</font><font color="#808080">];
   </font><font color="#0000FF"><b>char </b></font><font color="#000080">senha</font><font color="#808080">[</font><font color="#FF0000">10</font><font color="#808080">];
  };
  </font><font color="#0000FF"><b>struct </b></font><font color="#000080">regPais </font><font color="#808080">{
   </font><font color="#0000FF"><b>char </b></font><font color="#000080">codigo</font><font color="#808080">[</font><font color="#FF0000">3</font><font color="#808080">];
   </font><font color="#0000FF"><b>char </b></font><font color="#000080">pais</font><font color="#808080">[</font><font color="#FF0000">50</font><font color="#808080">];
  };
  </font><font color="#0000FF"><b>struct </b></font><font color="#000080">regProfissao </font><font color="#808080">{
   </font><font color="#0000FF"><b>char </b></font><font color="#000080">codigo</font><font color="#808080">[</font><font color="#FF0000">10</font><font color="#808080">];
   </font><font color="#0000FF"><b>char </b></font><font color="#000080">profissao</font><font color="#808080">[</font><font color="#FF0000">50</font><font color="#808080">];
  };
  </font><font color="#0000FF"><b>struct </b></font><font color="#000080">regLivro </font><font color="#808080">{
   </font><font color="#0000FF"><b>char </b></font><font color="#000080">isbn</font><font color="#808080">[</font><font color="#FF0000">13</font><font color="#808080">];
   </font><font color="#0000FF"><b>char </b></font><font color="#000080">titulo</font><font color="#808080">[</font><font color="#FF0000">50</font><font color="#808080">];
   </font><font color="#0000FF"><b>char </b></font><font color="#000080">edicao</font><font color="#808080">[</font><font color="#FF0000">10</font><font color="#808080">];
   </font><font color="#0000FF"><b>char </b></font><font color="#000080">anopubli</font><font color="#808080">[</font><font color="#FF0000">10</font><font color="#808080">];
   </font><font color="#0000FF"><b>char </b></font><font color="#000080">codeditora</font><font color="#808080">[</font><font color="#FF0000">10</font><font color="#808080">];
   </font><font color="#0000FF"><b>char </b></font><font color="#000080">volume</font><font color="#808080">[</font><font color="#FF0000">10</font><font color="#808080">];
   </font><font color="#0000FF"><b>char </b></font><font color="#000080">codidioma</font><font color="#808080">[</font><font color="#FF0000">10</font><font color="#808080">];
   </font><font color="#0000FF"><b>char </b></font><font color="#000080">npaginas</font><font color="#808080">[</font><font color="#FF0000">10</font><font color="#808080">];
   </font><font color="#0000FF"><b>char </b></font><font color="#000080">preco</font><font color="#808080">[</font><font color="#FF0000">10</font><font color="#808080">];
   </font><font color="#0000FF"><b>char </b></font><font color="#000080">qtdestoque</font><font color="#808080">[</font><font color="#FF0000">10</font><font color="#808080">];
  };
  </font><font color="#0000FF"><b>struct </b></font><font color="#000080">regLivroAss </font><font color="#808080">{
   </font><font color="#0000FF"><b>char </b></font><font color="#000080">isbn</font><font color="#808080">[</font><font color="#FF0000">13</font><font color="#808080">];
   </font><font color="#0000FF"><b>char </b></font><font color="#000080">codassunto</font><font color="#808080">[</font><font color="#FF0000">10</font><font color="#808080">];
  };
  </font><font color="#0000FF"><b>struct </b></font><font color="#000080">regLivroAut </font><font color="#808080">{
   </font><font color="#0000FF"><b>char </b></font><font color="#000080">isbn</font><font color="#808080">[</font><font color="#FF0000">13</font><font color="#808080">];
   </font><font color="#0000FF"><b>char </b></font><font color="#000080">codautor</font><font color="#808080">[</font><font color="#FF0000">10</font><font color="#808080">];
  };
  </font><font color="#0000FF"><b>struct </b></font><font color="#000080">regCliente </font><font color="#808080">{
   </font><font color="#0000FF"><b>char </b></font><font color="#000080">cpf</font><font color="#808080">[</font><font color="#FF0000">14</font><font color="#808080">];
   </font><font color="#0000FF"><b>char </b></font><font color="#000080">nome</font><font color="#808080">[</font><font color="#FF0000">30</font><font color="#808080">];
   </font><font color="#0000FF"><b>char </b></font><font color="#000080">email</font><font color="#808080">[</font><font color="#FF0000">30</font><font color="#808080">];
   </font><font color="#0000FF"><b>char </b></font><font color="#000080">identidade</font><font color="#808080">[</font><font color="#FF0000">10</font><font color="#808080">];
   </font><font color="#0000FF"><b>char </b></font><font color="#000080">sexo</font><font color="#808080">[</font><font color="#FF0000">1</font><font color="#808080">];
   </font><font color="#0000FF"><b>char </b></font><font color="#000080">telefone</font><font color="#808080">[</font><font color="#FF0000">17</font><font color="#808080">];
   </font><font color="#0000FF"><b>char </b></font><font color="#000080">dtnascimento</font><font color="#808080">[</font><font color="#FF0000">10</font><font color="#808080">];
   </font><font color="#0000FF"><b>char </b></font><font color="#000080">codendereco</font><font color="#808080">[</font><font color="#FF0000">10</font><font color="#808080">];
   </font><font color="#0000FF"><b>char </b></font><font color="#000080">codpais</font><font color="#808080">[</font><font color="#FF0000">3</font><font color="#808080">];
   </font><font color="#0000FF"><b>char </b></font><font color="#000080">codprofissao</font><font color="#808080">[</font><font color="#FF0000">10</font><font color="#808080">];
  };
  </font><font color="#0000FF"><b>struct </b></font><font color="#000080">regEndereco </font><font color="#808080">{
   </font><font color="#0000FF"><b>char </b></font><font color="#000080">codigo</font><font color="#808080">[</font><font color="#FF0000">10</font><font color="#808080">];
   </font><font color="#0000FF"><b>char </b></font><font color="#000080">logradouro</font><font color="#808080">[</font><font color="#FF0000">40</font><font color="#808080">];
   </font><font color="#0000FF"><b>char </b></font><font color="#000080">bairro</font><font color="#808080">[</font><font color="#FF0000">15</font><font color="#808080">];
   </font><font color="#0000FF"><b>char </b></font><font color="#000080">cep</font><font color="#808080">[</font><font color="#FF0000">8</font><font color="#808080">];
   </font><font color="#0000FF"><b>char </b></font><font color="#000080">cidade</font><font color="#808080">[</font><font color="#FF0000">30</font><font color="#808080">];
   </font><font color="#0000FF"><b>char </b></font><font color="#000080">estado</font><font color="#808080">[</font><font color="#FF0000">20</font><font color="#808080">];
  };
  </font><font color="#0000FF"><b>struct </b></font><font color="#000080">regVenda </font><font color="#808080">{
   </font><font color="#0000FF"><b>char </b></font><font color="#000080">dthrvenda</font><font color="#808080">[</font><font color="#FF0000">19</font><font color="#808080">];  <i>/* data/hora da venda dd/mm/yyyy hh:mm:ss */
   </i></font><font color="#0000FF"><b>char </b></font><font color="#000080">cpf</font><font color="#808080">[</font><font color="#FF0000">14</font><font color="#808080">];
   </font><font color="#0000FF"><b>char </b></font><font color="#000080">isbn</font><font color="#808080">[</font><font color="#FF0000">13</font><font color="#808080">];
   </font><font color="#0000FF"><b>char </b></font><font color="#000080">precovenda</font><font color="#808080">[</font><font color="#FF0000">10</font><font color="#808080">];
  };

  </font><font color="#0000FF"><b>enum </b></font><font color="#000080">ctTipo </font><font color="#808080">{ </font><font color="#000080">opTexto</font><font color="#808080">, </font><font color="#000080">opNumero</font><font color="#808080">, </font><font color="#000080">opData</font><font color="#808080">, </font><font color="#000080">opDataHora</font><font color="#808080">, </font><font color="#000080">opSenha </font><font color="#808080">};
  </font><font color="#0000FF"><b>enum </b></font><font color="#000080">ctArqs </font><font color="#808080">{ </font><font color="#000080">opAssunto</font><font color="#808080">, </font><font color="#000080">opAutor</font><font color="#808080">, </font><font color="#000080">opEditora</font><font color="#808080">, </font><font color="#000080">opEndereco</font><font color="#808080">, </font><font color="#000080">opIdioma</font><font color="#808080">, </font><font color="#000080">opPais</font><font color="#808080">,
                </font><font color="#000080">opProfissao</font><font color="#808080">, </font><font color="#000080">opCliente</font><font color="#808080">, </font><font color="#000080">opLivro</font><font color="#808080">, </font><font color="#000080">opLivroAss</font><font color="#808080">, </font><font color="#000080">opLivroAut</font><font color="#808080">,
                </font><font color="#000080">opUsuario</font><font color="#808080">, </font><font color="#000080">opVenda </font><font color="#808080">};
  </font><font color="#0000FF"><b>enum </b></font><font color="#000080">ctAcao </font><font color="#808080">{ </font><font color="#000080">opNovo</font><font color="#808080">, </font><font color="#000080">opAlterar</font><font color="#808080">, </font><font color="#000080">opPesquisar</font><font color="#808080">, </font><font color="#000080">opSalvarInclusao</font><font color="#808080">,
              </font><font color="#000080">opSalvarAlteracao</font><font color="#808080">, </font><font color="#000080">opExcluir</font><font color="#808080">, </font><font color="#000080">opConfirmaExclusao</font><font color="#808080">, </font><font color="#000080">opListarTodos </font><font color="#808080">};

  </font><font color="#000080">STR CRLF</font><font color="#808080">;
  </font><font color="#0000FF"><b>int </b></font><font color="#000080">TAM_CRLF</font><font color="#808080">;

  </font><font color="#000080">STR ARQ_ABRE</font><font color="#808080">;
  </font><font color="#000080">STR ARQ_CRIA</font><font color="#808080">;

  </font><font color="#0000FF"><b>int </b></font><font color="#000080">QTD_MAX_LINHA</font><font color="#808080">;
  </font><font color="#0000FF"><b>int </b></font><font color="#000080">TAM_MAX_STR</font><font color="#808080">;
  </font><font color="#0000FF"><b>int </b></font><font color="#000080">TAM_MAX_REG</font><font color="#808080">;

  </font><font color="#000080">STR MSG_ARQERRO</font><font color="#808080">;
  </font><font color="#000080">STR MSG_ARQCERRO</font><font color="#808080">;
  </font><font color="#000080">STR MSG_OPCAO</font><font color="#808080">;
  </font><font color="#000080">STR MSG_PRESS</font><font color="#808080">;

  </font><font color="#000080">STR MSG_REGINC</font><font color="#808080">;
  </font><font color="#000080">STR MSG_REGNINC</font><font color="#808080">;
  </font><font color="#000080">STR MSG_REGALT</font><font color="#808080">;
  </font><font color="#000080">STR MSG_REGNALT</font><font color="#808080">;
  </font><font color="#000080">STR MSG_REGEXC</font><font color="#808080">;
  </font><font color="#000080">STR MSG_REGNEXC</font><font color="#808080">;
  </font><font color="#000080">STR MSG_REGEXST</font><font color="#808080">;

  </font><font color="#000080">STR MSG_NUMINV</font><font color="#808080">;
  </font><font color="#000080">STR MSG_DATAINV</font><font color="#808080">;
  </font><font color="#000080">STR MSG_DTHRINV</font><font color="#808080">;
  </font><font color="#000080">STR MSG_ISBNINV</font><font color="#808080">;
  </font><font color="#000080">STR MSG_CPFINV</font><font color="#808080">;
  </font><font color="#000080">STR MSG_SENCONFERE</font><font color="#808080">;
  </font><font color="#000080">STR MSG_SENCONFIRM</font><font color="#808080">;
  </font><font color="#000080">STR MSG_LOGINENCON</font><font color="#808080">;
  </font><font color="#000080">STR MSG_SEMESTOQUE</font><font color="#808080">;

  </font><font color="#000080">STR ARQ_ASSUNTO</font><font color="#808080">;
  </font><font color="#000080">STR ARQ_AUTOR</font><font color="#808080">;
  </font><font color="#000080">STR ARQ_EDITORA</font><font color="#808080">;
  </font><font color="#000080">STR ARQ_IDIOMA</font><font color="#808080">;
  </font><font color="#000080">STR ARQ_USUARIO</font><font color="#808080">;
  </font><font color="#000080">STR ARQ_PAIS</font><font color="#808080">;
  </font><font color="#000080">STR ARQ_PROFISSAO</font><font color="#808080">;
  </font><font color="#000080">STR ARQ_LIVRO</font><font color="#808080">;
  </font><font color="#000080">STR ARQ_LIVASS</font><font color="#808080">;
  </font><font color="#000080">STR ARQ_LIVAUT</font><font color="#808080">;
  </font><font color="#000080">STR ARQ_CLIENTE</font><font color="#808080">;
  </font><font color="#000080">STR ARQ_ENDERECO</font><font color="#808080">;
  </font><font color="#000080">STR ARQ_VENDA</font><font color="#808080">;

  </font><font color="#0000FF"><b>int </b></font><font color="#000080">TAM_ASSUNTO</font><font color="#808080">;
  </font><font color="#0000FF"><b>int </b></font><font color="#000080">TAM_AUTOR</font><font color="#808080">;
  </font><font color="#0000FF"><b>int </b></font><font color="#000080">TAM_EDITORA</font><font color="#808080">;
  </font><font color="#0000FF"><b>int </b></font><font color="#000080">TAM_IDIOMA</font><font color="#808080">;
  </font><font color="#0000FF"><b>int </b></font><font color="#000080">TAM_USUARIO</font><font color="#808080">;
  </font><font color="#0000FF"><b>int </b></font><font color="#000080">TAM_PAIS</font><font color="#808080">;
  </font><font color="#0000FF"><b>int </b></font><font color="#000080">TAM_PROFISSAO</font><font color="#808080">;
  </font><font color="#0000FF"><b>int </b></font><font color="#000080">TAM_LIVRO</font><font color="#808080">;
  </font><font color="#0000FF"><b>int </b></font><font color="#000080">TAM_LIVASS</font><font color="#808080">;
  </font><font color="#0000FF"><b>int </b></font><font color="#000080">TAM_LIVAUT</font><font color="#808080">;
  </font><font color="#0000FF"><b>int </b></font><font color="#000080">TAM_CLIENTE</font><font color="#808080">;
  </font><font color="#0000FF"><b>int </b></font><font color="#000080">TAM_ENDERECO</font><font color="#808080">;
  </font><font color="#0000FF"><b>int </b></font><font color="#000080">TAM_VENDA</font><font color="#808080">;

  </font><font color="#0000FF"><b>int </b></font><font color="#000080">g_nPosChave</font><font color="#808080">, </font><font color="#000080">g_nTamChave</font><font color="#808080">;
  </font><font color="#0000FF"><b>double </b></font><font color="#000080">g_nPreco</font><font color="#808080">;
  </font><font color="#000080">BOOL g_SalvarInclusao</font><font color="#808080">;

  </font><font color="#0000FF"><b>struct </b></font><font color="#000080">regAssunto tAssunto</font><font color="#808080">;
  </font><font color="#0000FF"><b>struct </b></font><font color="#000080">regAutor tAutor</font><font color="#808080">;
  </font><font color="#0000FF"><b>struct </b></font><font color="#000080">regEditora tEditora</font><font color="#808080">;
  </font><font color="#0000FF"><b>struct </b></font><font color="#000080">regIdioma tIdioma</font><font color="#808080">;
  </font><font color="#0000FF"><b>struct </b></font><font color="#000080">regEndereco tEndereco</font><font color="#808080">;
  </font><font color="#0000FF"><b>struct </b></font><font color="#000080">regPais tPais</font><font color="#808080">;
  </font><font color="#0000FF"><b>struct </b></font><font color="#000080">regProfissao tProfissao</font><font color="#808080">;
  </font><font color="#0000FF"><b>struct </b></font><font color="#000080">regLivro tLivro</font><font color="#808080">;
  </font><font color="#0000FF"><b>struct </b></font><font color="#000080">regLivroAss tLivroAss</font><font color="#808080">;
  </font><font color="#0000FF"><b>struct </b></font><font color="#000080">regLivroAut tLivroAut</font><font color="#808080">;
  </font><font color="#0000FF"><b>struct </b></font><font color="#000080">regCliente tCliente</font><font color="#808080">;
  </font><font color="#0000FF"><b>struct </b></font><font color="#000080">regUsuario tUsuario</font><font color="#808080">;
  </font><font color="#0000FF"><b>struct </b></font><font color="#000080">regVenda tVenda</font><font color="#808080">;

  </font><font color="#000080">FILE </font><font color="#808080">*</font><font color="#000080">tfAssunto</font><font color="#808080">, *</font><font color="#000080">tfAutor</font><font color="#808080">, *</font><font color="#000080">tfEditora</font><font color="#808080">, *</font><font color="#000080">tfIdioma</font><font color="#808080">, *</font><font color="#000080">tfEndereco</font><font color="#808080">, *</font><font color="#000080">tfPais</font><font color="#808080">, 
  *</font><font color="#000080">tfProfissao</font><font color="#808080">, *</font><font color="#000080">tfLivro</font><font color="#808080">, *</font><font color="#000080">tfLivroAss</font><font color="#808080">, *</font><font color="#000080">tfLivroAut</font><font color="#808080">, 
  *</font><font color="#000080">tfCliente</font><font color="#808080">, *</font><font color="#000080">tfUsuario</font><font color="#808080">, *</font><font color="#000080">tfVenda</font><font color="#808080">;

 </font><font color="#FF00FF">@</font><font color="#0000FF"><b>public 
   </b></font><font color="#000080">STR MSG_ERRO</font><font color="#808080">;
}

+ </font><font color="#0000FF"><b>new</b></font><font color="#808080">;
- </font><font color="#000080">free</font><font color="#808080">;
- </font><font color="#000080">constantes</font><font color="#808080">;
- (</font><font color="#000080">STR</font><font color="#808080">) </font><font color="#000080">retMSGERRO</font><font color="#808080">;

<i>/*--- Rotinas b&aacute;sicas --------------------------------------------------------*/
</i>- (</font><font color="#000080">STR</font><font color="#808080">) </font><font color="#000080">alocaString</font><font color="#808080">: (</font><font color="#0000FF"><b>int</b></font><font color="#808080">) </font><font color="#000080">ntam</font><font color="#808080">;
- (</font><font color="#000080">STR</font><font color="#808080">) </font><font color="#000080">somastr</font><font color="#808080">: (</font><font color="#0000FF"><b>int</b></font><font color="#808080">) </font><font color="#000080">num</font><font color="#808080">, ...;
- (</font><font color="#000080">STR</font><font color="#808080">) </font><font color="#000080">copy</font><font color="#808080">: (</font><font color="#000080">STR</font><font color="#808080">) </font><font color="#000080">string</font><font color="#808080">, ...;
- (</font><font color="#000080">STR</font><font color="#808080">) </font><font color="#000080">trim</font><font color="#808080">: (</font><font color="#000080">STR</font><font color="#808080">) </font><font color="#000080">sTexto</font><font color="#808080">;
- (</font><font color="#000080">STR</font><font color="#808080">) </font><font color="#000080">repete</font><font color="#808080">: (</font><font color="#000080">STR</font><font color="#808080">) </font><font color="#000080">sTexto</font><font color="#808080">, ...;
- (</font><font color="#000080">STR</font><font color="#808080">) </font><font color="#000080">esp</font><font color="#808080">: (</font><font color="#000080">STR</font><font color="#808080">) </font><font color="#000080">sTexto</font><font color="#808080">, ...;
- (</font><font color="#000080">STR</font><font color="#808080">) </font><font color="#000080">zeros</font><font color="#808080">: (</font><font color="#000080">STR</font><font color="#808080">) </font><font color="#000080">sTexto</font><font color="#808080">, ...;
- (</font><font color="#000080">BOOL</font><font color="#808080">) </font><font color="#000080">strRelativa</font><font color="#808080">: (</font><font color="#000080">STR</font><font color="#808080">) </font><font color="#000080">sTexto</font><font color="#808080">, ...;
- (</font><font color="#0000FF"><b>int</b></font><font color="#808080">) </font><font color="#000080">modulo11</font><font color="#808080">: (</font><font color="#000080">STR</font><font color="#808080">) </font><font color="#000080">svalor</font><font color="#808080">, ...;
- (</font><font color="#000080">BOOL</font><font color="#808080">) </font><font color="#000080">validaCPF</font><font color="#808080">: (</font><font color="#000080">STR</font><font color="#808080">) </font><font color="#000080">cpf</font><font color="#808080">;
- (</font><font color="#000080">BOOL</font><font color="#808080">) </font><font color="#000080">validaISBN</font><font color="#808080">: (</font><font color="#000080">STR</font><font color="#808080">) </font><font color="#000080">isbn</font><font color="#808080">;
- (</font><font color="#000080">STR</font><font color="#808080">) </font><font color="#000080">digita</font><font color="#808080">: (</font><font color="#0000FF"><b>int</b></font><font color="#808080">) </font><font color="#000080">nTam</font><font color="#808080">;
- (</font><font color="#000080">STR</font><font color="#808080">) </font><font color="#000080">digitaSenha</font><font color="#808080">: (</font><font color="#000080">STR</font><font color="#808080">) </font><font color="#000080">sRotulo</font><font color="#808080">, ...;
- (</font><font color="#000080">STR</font><font color="#808080">) </font><font color="#000080">validaNumero</font><font color="#808080">: (</font><font color="#000080">STR</font><font color="#808080">) </font><font color="#000080">sRotulo</font><font color="#808080">, ...;
- (</font><font color="#000080">STR</font><font color="#808080">) </font><font color="#000080">validaDataHora</font><font color="#808080">: (</font><font color="#000080">STR</font><font color="#808080">) </font><font color="#000080">sRotulo</font><font color="#808080">, ...;
- (</font><font color="#000080">STR</font><font color="#808080">) </font><font color="#000080">itoa</font><font color="#808080">: (</font><font color="#0000FF"><b>int</b></font><font color="#808080">) </font><font color="#000080">nvalor</font><font color="#808080">, ...;
- (</font><font color="#000080">STR</font><font color="#808080">) </font><font color="#000080">retDataHora</font><font color="#808080">;

<i>/*--- Rotinas de manipula&ccedil;&atilde;o de arquivos -------------------------------------*/
</i>- (</font><font color="#0000FF"><b>long</b></font><font color="#808080">) </font><font color="#000080">tamArq</font><font color="#808080">: (</font><font color="#000080">FILE</font><font color="#808080">*) </font><font color="#000080">sArq</font><font color="#808080">;
- </font><font color="#000080">abrecriaArqs</font><font color="#808080">: (</font><font color="#000080">BOOL</font><font color="#808080">) </font><font color="#000080">bAbre</font><font color="#808080">;
- </font><font color="#000080">fechaArqs</font><font color="#808080">;
- (</font><font color="#000080">STR</font><font color="#808080">) </font><font color="#000080">pesqArq</font><font color="#808080">: (</font><font color="#000080">FILE</font><font color="#808080">*) </font><font color="#000080">sArq</font><font color="#808080">, ...;
- </font><font color="#000080">pesqLinhaExcluida</font><font color="#808080">: (</font><font color="#000080">FILE</font><font color="#808080">*) </font><font color="#000080">sArq</font><font color="#808080">, ...;
- (</font><font color="#000080">STR</font><font color="#808080">) </font><font color="#000080">pesqMaxCod</font><font color="#808080">: (</font><font color="#000080">FILE</font><font color="#808080">*) </font><font color="#000080">sArq</font><font color="#808080">, ...;
- </font><font color="#000080">escreveArq</font><font color="#808080">: (</font><font color="#000080">FILE</font><font color="#808080">*) </font><font color="#000080">sArq</font><font color="#808080">, ...;

<i>/*--- Rotinas de implementa&ccedil;&atilde;o do sistema e de interface ---------------------*/
</i>- (</font><font color="#000080">STR</font><font color="#808080">) </font><font color="#000080">LinhaReg</font><font color="#808080">: (</font><font color="#0000FF"><b>enum </b></font><font color="#000080">ctArqs</font><font color="#808080">) </font><font color="#000080">sreg</font><font color="#808080">;
- (</font><font color="#0000FF"><b>int</b></font><font color="#808080">) </font><font color="#000080">tamReg</font><font color="#808080">: (</font><font color="#0000FF"><b>enum </b></font><font color="#000080">ctArqs</font><font color="#808080">) </font><font color="#000080">sreg</font><font color="#808080">;
- (</font><font color="#000080">STR</font><font color="#808080">) </font><font color="#000080">rotulo</font><font color="#808080">: (</font><font color="#0000FF"><b>enum </b></font><font color="#000080">ctArqs</font><font color="#808080">) </font><font color="#000080">sreg</font><font color="#808080">, ...;
- (</font><font color="#000080">BOOL</font><font color="#808080">) </font><font color="#000080">ContinuaSN</font><font color="#808080">: (</font><font color="#0000FF"><b>int</b></font><font color="#808080">) </font><font color="#000080">nlinha</font><font color="#808080">, ...;
- (</font><font color="#000080">BOOL</font><font color="#808080">) </font><font color="#000080">ListarTodos</font><font color="#808080">: (</font><font color="#000080">FILE</font><font color="#808080">*) </font><font color="#000080">sArq</font><font color="#808080">, ...;
- </font><font color="#000080">ListarRegLigados</font><font color="#808080">: (</font><font color="#000080">FILE</font><font color="#808080">*) </font><font color="#000080">sArq1</font><font color="#808080">, ...;
- (</font><font color="#000080">STR</font><font color="#808080">) </font><font color="#000080">validaEntrada</font><font color="#808080">: (</font><font color="#000080">FILE</font><font color="#808080">*) </font><font color="#000080">sArq</font><font color="#808080">, ...;
- </font><font color="#000080">frmSplash</font><font color="#808080">;
- </font><font color="#000080">frmSobre</font><font color="#808080">;
- (</font><font color="#000080">BOOL</font><font color="#808080">) </font><font color="#000080">frmLogin</font><font color="#808080">;
- </font><font color="#000080">menu</font><font color="#808080">: (</font><font color="#0000FF"><b>int</b></font><font color="#808080">) </font><font color="#000080">num</font><font color="#808080">;
- </font><font color="#000080">frmCadastros</font><font color="#808080">: (</font><font color="#0000FF"><b>enum </b></font><font color="#000080">ctArqs</font><font color="#808080">) </font><font color="#000080">sreg</font><font color="#808080">, ...; 
- </font><font color="#000080">frmConsultas</font><font color="#808080">: (</font><font color="#0000FF"><b>enum </b></font><font color="#000080">ctArqs</font><font color="#808080">) </font><font color="#000080">sreg</font><font color="#808080">, ...;
- </font><font color="#000080">frmAlterarSenha</font><font color="#808080">;
- </font><font color="#000080">btnAcao</font><font color="#808080">: (</font><font color="#0000FF"><b>enum </b></font><font color="#000080">ctArqs</font><font color="#808080">) </font><font color="#000080">sreg</font><font color="#808080">, ...;
- </font><font color="#000080">subMenu</font><font color="#808080">: (</font><font color="#0000FF"><b>int</b></font><font color="#808080">) </font><font color="#000080">nmenu</font><font color="#808080">, ...;
- </font><font color="#000080">usaMenu</font><font color="#808080">: (</font><font color="#0000FF"><b>int</b></font><font color="#808080">) </font><font color="#000080">num</font><font color="#808080">;
- </font><font color="#000080">mostrarDados</font><font color="#808080">: (</font><font color="#0000FF"><b>enum </b></font><font color="#000080">ctArqs</font><font color="#808080">) </font><font color="#000080">sreg</font><font color="#808080">, ...;
- </font><font color="#000080">mostrarSubDados</font><font color="#808080">: (</font><font color="#0000FF"><b>enum </b></font><font color="#000080">ctArqs</font><font color="#808080">) </font><font color="#000080">sreg</font><font color="#808080">, ...;
- </font><font color="#000080">frmCadLigados</font><font color="#808080">: (</font><font color="#0000FF"><b>enum </b></font><font color="#000080">ctArqs</font><font color="#808080">) </font><font color="#000080">sreg</font><font color="#808080">, ...;
- </font><font color="#000080">ExcluirRegLigados</font><font color="#808080">: (</font><font color="#000080">FILE</font><font color="#808080">*) </font><font color="#000080">sArq</font><font color="#808080">, ...;

</font><font color="#FF00FF">@</font><font color="#000080">end

</font><font color="#FF00FF">@</font><font color="#000080">implementation Livrus

</font><font color="#808080"><i>/*------------------------------------------------------------------------------
m&eacute;todo de cria&ccedil;&atilde;o da classe.
------------------------------------------------------------------------------*/
</i>+ </font><font color="#0000FF"><b>new
</b></font><font color="#808080">{
  </font><font color="#000080">self </font><font color="#808080">= [</font><font color="#000080">super </font><font color="#0000FF"><b>new</b></font><font color="#808080">];
  </font><font color="#0000FF"><b>return </b></font><font color="#000080">self</font><font color="#808080">;
}

<i>/*------------------------------------------------------------------------------
m&eacute;todo de destrui&ccedil;&atilde;o e libera&ccedil;&atilde;o da mem&oacute;ria da classe.
------------------------------------------------------------------------------*/
</i>- </font><font color="#000080">free
</font><font color="#808080">{
  </font><font color="#0000FF"><b>return </b></font><font color="#808080">[</font><font color="#000080">super free</font><font color="#808080">];
}

<i>/*------------------------------------------------------------------------------
m&eacute;todo que inicia todas as constantes.
------------------------------------------------------------------------------*/
</i>- </font><font color="#000080">constantes
</font><font color="#808080">{
  </font><font color="#000080">CRLF </font><font color="#808080">= </font><font color="#800000">&quot;\n&quot;</font><font color="#808080">; <i>/* windows */
  </i></font><font color="#000080">TAM_CRLF </font><font color="#808080">= </font><font color="#FF0000">1</font><font color="#808080">;
<i>/* CRLF = &quot;\n&quot;;
   TAM_CRLF = 1; */ /* unix */
/* CRLF = &quot;\r&quot;;
   TAM_CRLF = 1; */ /* macintosh */

  </i></font><font color="#000080">ARQ_ABRE </font><font color="#808080">= </font><font color="#800000">&quot;rt+&quot;</font><font color="#808080">;
  </font><font color="#000080">ARQ_CRIA </font><font color="#808080">= </font><font color="#800000">&quot;wt+&quot;</font><font color="#808080">;

  </font><font color="#000080">QTD_MAX_LINHA </font><font color="#808080">= </font><font color="#FF0000">18</font><font color="#808080">;
  </font><font color="#000080">TAM_MAX_STR </font><font color="#808080">= </font><font color="#FF0000">255</font><font color="#808080">;
  </font><font color="#000080">TAM_MAX_REG </font><font color="#808080">= </font><font color="#FF0000">145</font><font color="#808080">;

  </font><font color="#000080">MSG_ARQERRO </font><font color="#808080">= </font><font color="#800000">&quot;Erro: O arquivo n&atilde;o pode ser aberto.&quot;</font><font color="#808080">;
  </font><font color="#000080">MSG_ARQCERRO </font><font color="#808080">= </font><font color="#800000">&quot;Erro: O arquivo n&atilde;o pode ser criado.&quot;</font><font color="#808080">;
  </font><font color="#000080">MSG_ERRO </font><font color="#808080">= </font><font color="#800000">&quot;Erro: op&ccedil;&atilde;o inv&aacute;lida digite de novo.&quot;</font><font color="#808080">;
  </font><font color="#000080">MSG_OPCAO </font><font color="#808080">= </font><font color="#800000">&quot;Escolha uma op&ccedil;&atilde;o: &quot;</font><font color="#808080">;
  </font><font color="#000080">MSG_PRESS </font><font color="#808080">= </font><font color="#800000">&quot;pressione para continuar...&quot;</font><font color="#808080">;

  </font><font color="#000080">MSG_REGINC </font><font color="#808080">= </font><font color="#800000">&quot;registro incluido!&quot;</font><font color="#808080">;
  </font><font color="#000080">MSG_REGNINC </font><font color="#808080">= </font><font color="#800000">&quot;registro n&atilde;o incluido!&quot;</font><font color="#808080">;
  </font><font color="#000080">MSG_REGALT </font><font color="#808080">= </font><font color="#800000">&quot;registro alterado!&quot;</font><font color="#808080">;
  </font><font color="#000080">MSG_REGNALT </font><font color="#808080">= </font><font color="#800000">&quot;registro n&atilde;o alterado!&quot;</font><font color="#808080">;
  </font><font color="#000080">MSG_REGEXC </font><font color="#808080">= </font><font color="#800000">&quot;registro excluido!&quot;</font><font color="#808080">;
  </font><font color="#000080">MSG_REGNEXC </font><font color="#808080">= </font><font color="#800000">&quot;registro n&atilde;o excluido!&quot;</font><font color="#808080">;
  </font><font color="#000080">MSG_REGEXST </font><font color="#808080">= </font><font color="#800000">&quot;registro j&aacute; existe!&quot;</font><font color="#808080">;

  </font><font color="#000080">MSG_NUMINV </font><font color="#808080">= </font><font color="#800000">&quot;N&uacute;mero inv&aacute;lido ou menor do que 1!&quot;</font><font color="#808080">;
  </font><font color="#000080">MSG_DATAINV </font><font color="#808080">= </font><font color="#800000">&quot;Data inv&aacute;lida!, formato correto (dd/mm/yyyy)&quot;</font><font color="#808080">;
  </font><font color="#000080">MSG_DTHRINV </font><font color="#808080">= </font><font color="#800000">&quot;Data/hora inv&aacute;lida!, formato correto (dd/mm/yyyy hh:mm:ss)&quot;</font><font color="#808080">;
  </font><font color="#000080">MSG_ISBNINV </font><font color="#808080">= </font><font color="#800000">&quot;ISBN inv&aacute;lido!&quot;</font><font color="#808080">;
  </font><font color="#000080">MSG_CPFINV </font><font color="#808080">= </font><font color="#800000">&quot;CPF inv&aacute;lido!&quot;</font><font color="#808080">;
  </font><font color="#000080">MSG_SENCONFERE </font><font color="#808080">= </font><font color="#800000">&quot;senha n&atilde;o confere com a senha atual!&quot;</font><font color="#808080">;
  </font><font color="#000080">MSG_SENCONFIRM </font><font color="#808080">= </font><font color="#800000">&quot;nova senha n&atilde;o confere com a senha confirmada!&quot;</font><font color="#808080">;
  </font><font color="#000080">MSG_LOGINENCON </font><font color="#808080">= </font><font color="#800000">&quot;login n&atilde;o encontrado!&quot;</font><font color="#808080">;
  </font><font color="#000080">MSG_SEMESTOQUE </font><font color="#808080">= </font><font color="#800000">&quot;livro n&atilde;o existe no estoque!&quot;</font><font color="#808080">;

  </font><font color="#000080">ARQ_ASSUNTO </font><font color="#808080">= </font><font color="#800000">&quot;C:/temp/assunto.dat&quot;</font><font color="#808080">;
  </font><font color="#000080">ARQ_AUTOR </font><font color="#808080">= </font><font color="#800000">&quot;C:/temp/autor.dat&quot;</font><font color="#808080">;
  </font><font color="#000080">ARQ_EDITORA </font><font color="#808080">= </font><font color="#800000">&quot;C:/temp/editora.dat&quot;</font><font color="#808080">;
  </font><font color="#000080">ARQ_IDIOMA </font><font color="#808080">= </font><font color="#800000">&quot;C:/temp/idioma.dat&quot;</font><font color="#808080">;
  </font><font color="#000080">ARQ_USUARIO </font><font color="#808080">= </font><font color="#800000">&quot;C:/temp/usuario.dat&quot;</font><font color="#808080">;
  </font><font color="#000080">ARQ_PAIS </font><font color="#808080">= </font><font color="#800000">&quot;C:/temp/pais.dat&quot;</font><font color="#808080">;
  </font><font color="#000080">ARQ_PROFISSAO </font><font color="#808080">= </font><font color="#800000">&quot;C:/temp/profissao.dat&quot;</font><font color="#808080">;
  </font><font color="#000080">ARQ_LIVRO </font><font color="#808080">= </font><font color="#800000">&quot;C:/temp/livro.dat&quot;</font><font color="#808080">;
  </font><font color="#000080">ARQ_LIVASS </font><font color="#808080">= </font><font color="#800000">&quot;C:/temp/livroass.dat&quot;</font><font color="#808080">;
  </font><font color="#000080">ARQ_LIVAUT </font><font color="#808080">= </font><font color="#800000">&quot;C:/temp/livroaut.dat&quot;</font><font color="#808080">;
  </font><font color="#000080">ARQ_CLIENTE </font><font color="#808080">= </font><font color="#800000">&quot;C:/temp/cliente.dat&quot;</font><font color="#808080">;
  </font><font color="#000080">ARQ_ENDERECO </font><font color="#808080">= </font><font color="#800000">&quot;C:/temp/endereco.dat&quot;</font><font color="#808080">;
  </font><font color="#000080">ARQ_VENDA </font><font color="#808080">= </font><font color="#800000">&quot;C:/temp/venda.dat&quot;</font><font color="#808080">;

  </font><font color="#000080">TAM_ASSUNTO </font><font color="#808080">= </font><font color="#FF0000">40</font><font color="#808080">;
  </font><font color="#000080">TAM_AUTOR </font><font color="#808080">= </font><font color="#FF0000">40</font><font color="#808080">;
  </font><font color="#000080">TAM_EDITORA </font><font color="#808080">= </font><font color="#FF0000">60</font><font color="#808080">;
  </font><font color="#000080">TAM_IDIOMA </font><font color="#808080">= </font><font color="#FF0000">30</font><font color="#808080">;
  </font><font color="#000080">TAM_USUARIO </font><font color="#808080">= </font><font color="#FF0000">20</font><font color="#808080">;
  </font><font color="#000080">TAM_PAIS </font><font color="#808080">= </font><font color="#FF0000">53</font><font color="#808080">;
  </font><font color="#000080">TAM_PROFISSAO </font><font color="#808080">= </font><font color="#FF0000">60</font><font color="#808080">;
  </font><font color="#000080">TAM_LIVRO </font><font color="#808080">= </font><font color="#FF0000">143</font><font color="#808080">;
  </font><font color="#000080">TAM_LIVASS </font><font color="#808080">= </font><font color="#FF0000">23</font><font color="#808080">;
  </font><font color="#000080">TAM_LIVAUT </font><font color="#808080">= </font><font color="#FF0000">23</font><font color="#808080">;
  </font><font color="#000080">TAM_CLIENTE </font><font color="#808080">= </font><font color="#FF0000">135</font><font color="#808080">;
  </font><font color="#000080">TAM_ENDERECO </font><font color="#808080">= </font><font color="#FF0000">123</font><font color="#808080">;
  </font><font color="#000080">TAM_VENDA </font><font color="#808080">= </font><font color="#FF0000">56</font><font color="#808080">;
  
  </font><font color="#0000FF"><b>return </b></font><font color="#000080">self</font><font color="#808080">;
}
<i>/*------------------------------------------------------------------------------
m&eacute;todo que retorna a constante de MSGERRO
------------------------------------------------------------------------------*/
</i>- (</font><font color="#000080">STR</font><font color="#808080">) </font><font color="#000080">retMSGERRO
</font><font color="#808080">{
 </font><font color="#0000FF"><b>return </b></font><font color="#000080">MSG_ERRO</font><font color="#808080">;
}

<i>/*------------------------------------------------------------------------------
Fun&ccedil;&atilde;o que aloca uma string na mem&oacute;ria.
ntam - indica o tamanho de caracteres a serem alocados na mem&oacute;ria
retorna - a string alocada
------------------------------------------------------------------------------*/
</i>- (</font><font color="#000080">STR</font><font color="#808080">) </font><font color="#000080">alocaString</font><font color="#808080">: (</font><font color="#0000FF"><b>int</b></font><font color="#808080">) </font><font color="#000080">ntam
</font><font color="#808080">{ 
 </font><font color="#000080">STR strlocal</font><font color="#808080">;

 </font><font color="#000080">strlocal</font><font color="#808080">=(</font><font color="#000080">STR</font><font color="#808080">) </font><font color="#000080">malloc</font><font color="#808080">(</font><font color="#000080">ntam</font><font color="#808080">);
 </font><font color="#0000FF"><b>if </b></font><font color="#808080">(!</font><font color="#000080">strlocal</font><font color="#808080">) </font><font color="#000080">exit</font><font color="#808080">(</font><font color="#FF0000">1</font><font color="#808080">);
 </font><font color="#0000FF"><b>else </b></font><font color="#000080">strlocal</font><font color="#808080">[</font><font color="#FF0000">0</font><font color="#808080">]=</font>'\0'<font color="#808080">;
 
 </font><font color="#0000FF"><b>return </b></font><font color="#000080">strlocal</font><font color="#808080">;
}
<i>/*------------------------------------------------------------------------------
m&eacute;todo que soma determinado n&uacute;mero de strings.
num - indica o n&uacute;mero de strings
... - as strings a serem somadas
retorna - o peda&ccedil;o da string
------------------------------------------------------------------------------*/
</i>- (</font><font color="#000080">STR</font><font color="#808080">) </font><font color="#000080">somastr</font><font color="#808080">: (</font><font color="#0000FF"><b>int</b></font><font color="#808080">) </font><font color="#000080">num</font><font color="#808080">, ...
{
 </font><font color="#0000FF"><b>int </b></font><font color="#000080">ig</font><font color="#808080">,</font><font color="#000080">j</font><font color="#808080">,</font><font color="#000080">t</font><font color="#808080">;
 </font><font color="#000080">STR lstr</font><font color="#808080">, </font><font color="#000080">soma</font><font color="#808080">;
 </font><font color="#000080">va_list argptr</font><font color="#808080">;

 </font><font color="#000080">lstr </font><font color="#808080">= [</font><font color="#000080">self alocaString</font><font color="#808080">: </font><font color="#000080">TAM_MAX_STR </font><font color="#808080">* </font><font color="#FF0000">2</font><font color="#808080">];
 </font><font color="#000080">soma </font><font color="#808080">= [</font><font color="#000080">self alocaString</font><font color="#808080">: </font><font color="#000080">TAM_MAX_STR </font><font color="#808080">* </font><font color="#FF0000">4</font><font color="#808080">];

 </font><font color="#000080">va_start</font><font color="#808080">(</font><font color="#000080">argptr</font><font color="#808080">,</font><font color="#000080">num</font><font color="#808080">);

 </font><font color="#000080">j</font><font color="#808080">=</font><font color="#FF0000">0</font><font color="#808080">; </font><font color="#000080">t</font><font color="#808080">=</font><font color="#FF0000">0</font><font color="#808080">;
 </font><font color="#0000FF"><b>for</b></font><font color="#808080">(;</font><font color="#000080">num</font><font color="#808080">;</font><font color="#000080">num</font><font color="#808080">--){
   </font><font color="#000080">lstr </font><font color="#808080">= </font><font color="#000080">va_arg</font><font color="#808080">(</font><font color="#000080">argptr</font><font color="#808080">,</font><font color="#0000FF"><b>char</b></font><font color="#808080">*);
   </font><font color="#0000FF"><b>for</b></font><font color="#808080">(</font><font color="#000080">ig</font><font color="#808080">=</font><font color="#000080">j</font><font color="#808080">; </font><font color="#000080">ig </font><font color="#808080">&lt; </font><font color="#000080">abs</font><font color="#808080">(</font><font color="#000080">j</font><font color="#808080">+</font><font color="#000080">strlen</font><font color="#808080">(</font><font color="#000080">lstr</font><font color="#808080">)); </font><font color="#000080">ig</font><font color="#808080">++){
      </font><font color="#000080">soma</font><font color="#808080">[</font><font color="#000080">ig</font><font color="#808080">]=</font><font color="#000080">lstr</font><font color="#808080">[</font><font color="#000080">t</font><font color="#808080">];
      </font><font color="#000080">t</font><font color="#808080">++;
    }
   </font><font color="#000080">soma</font><font color="#808080">[</font><font color="#000080">ig</font><font color="#808080">]=</font>'\0'<font color="#808080">;
   </font><font color="#000080">j</font><font color="#808080">=</font><font color="#000080">strlen</font><font color="#808080">(</font><font color="#000080">soma</font><font color="#808080">);
   </font><font color="#000080">t</font><font color="#808080">=</font><font color="#FF0000">0</font><font color="#808080">;
 }
 </font><font color="#000080">va_end</font><font color="#808080">(</font><font color="#000080">argptr</font><font color="#808080">);

 </font><font color="#0000FF"><b>return </b></font><font color="#000080">soma</font><font color="#808080">;
}
<i>/*------------------------------------------------------------------------------
Fun&ccedil;&atilde;o que retorna um peda&ccedil;o de uma string.
string - indica a string
ini - indica a posicao inicial do pedaco
tam - indica o tamanho do pedaco
retorna - o peda&ccedil;o da string
------------------------------------------------------------------------------*/
</i>- (</font><font color="#000080">STR</font><font color="#808080">) </font><font color="#000080">copy</font><font color="#808080">: (</font><font color="#000080">STR</font><font color="#808080">) </font><font color="#000080">string</font><font color="#808080">, ...
{ 
 </font><font color="#000080">STR str1</font><font color="#808080">, </font><font color="#000080">slocal</font><font color="#808080">;
 </font><font color="#0000FF"><b>int </b></font><font color="#000080">i</font><font color="#808080">, </font><font color="#000080">j</font><font color="#808080">, </font><font color="#000080">ini</font><font color="#808080">, </font><font color="#000080">tam</font><font color="#808080">;

</font><font color="#000080">va_list lparams</font><font color="#808080">;
</font><font color="#000080">va_start</font><font color="#808080">(</font><font color="#000080">lparams</font><font color="#808080">, </font><font color="#000080">string</font><font color="#808080">);
</font><font color="#000080">ini </font><font color="#808080">= </font><font color="#000080">va_arg</font><font color="#808080">(</font><font color="#000080">lparams</font><font color="#808080">,</font><font color="#0000FF"><b>int</b></font><font color="#808080">);
</font><font color="#000080">tam </font><font color="#808080">= </font><font color="#000080">va_arg</font><font color="#808080">(</font><font color="#000080">lparams</font><font color="#808080">,</font><font color="#0000FF"><b>int</b></font><font color="#808080">);
</font><font color="#000080">va_end</font><font color="#808080">(</font><font color="#000080">lparams</font><font color="#808080">);

</font><font color="#000080">str1 </font><font color="#808080">= [</font><font color="#000080">self alocaString</font><font color="#808080">: </font><font color="#000080">TAM_MAX_STR</font><font color="#808080">];
</font><font color="#000080">slocal </font><font color="#808080">= [</font><font color="#000080">self alocaString</font><font color="#808080">: </font><font color="#000080">TAM_MAX_STR</font><font color="#808080">];
  
</font><font color="#000080">strcpy</font><font color="#808080">(</font><font color="#000080">slocal</font><font color="#808080">, </font><font color="#000080">string</font><font color="#808080">);
</font><font color="#000080">j</font><font color="#808080">=</font><font color="#FF0000">0</font><font color="#808080">;
</font><font color="#000080">ini</font><font color="#808080">--;
</font><font color="#0000FF"><b>for</b></font><font color="#808080">(</font><font color="#000080">i</font><font color="#808080">=</font><font color="#000080">ini</font><font color="#808080">;</font><font color="#000080">i</font><font color="#808080">&lt;(</font><font color="#000080">ini</font><font color="#808080">+</font><font color="#000080">tam</font><font color="#808080">);</font><font color="#000080">i</font><font color="#808080">++)
 {
   </font><font color="#000080">str1</font><font color="#808080">[</font><font color="#000080">j</font><font color="#808080">]=</font><font color="#000080">slocal</font><font color="#808080">[</font><font color="#000080">i</font><font color="#808080">];
   </font><font color="#000080">j</font><font color="#808080">++;
 }
</font><font color="#000080">str1</font><font color="#808080">[</font><font color="#000080">j</font><font color="#808080">]=</font>'\0'<font color="#808080">;
</font><font color="#000080">free</font><font color="#808080">(</font><font color="#000080">slocal</font><font color="#808080">);
</font><font color="#0000FF"><b>return </b></font><font color="#000080">str1</font><font color="#808080">;
}
<i>/*------------------------------------------------------------------------------
Retira os espa&ccedil;os em branco antes ou depois do texto.
sTexto - o texto a ser retirado os espa&ccedil;os em branco
retorna - o texto sem os espa&ccedil;os em branco
------------------------------------------------------------------------------*/
</i>- (</font><font color="#000080">STR</font><font color="#808080">) </font><font color="#000080">trim</font><font color="#808080">: (</font><font color="#000080">STR</font><font color="#808080">) </font><font color="#000080">sTexto
</font><font color="#808080">{
 </font><font color="#0000FF"><b>int </b></font><font color="#000080">ncont</font><font color="#808080">, </font><font color="#000080">nPosIni</font><font color="#808080">, </font><font color="#000080">nPosFim</font><font color="#808080">;
 </font><font color="#000080">STR sret</font><font color="#808080">, </font><font color="#000080">slocal</font><font color="#808080">;
 </font><font color="#000080">BOOL bQuebra</font><font color="#808080">;

</font><font color="#000080">nPosIni </font><font color="#808080">= </font><font color="#FF0000">0</font><font color="#808080">;
</font><font color="#000080">nPosFim </font><font color="#808080">= </font><font color="#FF0000">0</font><font color="#808080">;
</font><font color="#000080">ncont </font><font color="#808080">= </font><font color="#FF0000">0</font><font color="#808080">;
</font><font color="#000080">bQuebra </font><font color="#808080">= </font><font color="#000080">NO</font><font color="#808080">;
</font><font color="#000080">slocal </font><font color="#808080">= </font><font color="#000080">sTexto</font><font color="#808080">;
</font><font color="#0000FF"><b>while </b></font><font color="#808080">((</font><font color="#000080">ncont</font><font color="#808080">&lt;=</font><font color="#000080">abs</font><font color="#808080">(</font><font color="#000080">strlen</font><font color="#808080">(</font><font color="#000080">slocal</font><font color="#808080">))) &amp;&amp; (</font><font color="#000080">bQuebra</font><font color="#808080">==</font><font color="#000080">NO</font><font color="#808080">))  {
  </font><font color="#0000FF"><b>if </b></font><font color="#808080">(</font><font color="#000080">slocal</font><font color="#808080">[</font><font color="#000080">ncont</font><font color="#808080">]!=</font>' '<font color="#808080">) {
     </font><font color="#000080">nPosIni </font><font color="#808080">= </font><font color="#000080">ncont </font><font color="#808080">+ </font><font color="#FF0000">1</font><font color="#808080">;
     </font><font color="#000080">bQuebra </font><font color="#808080">= </font><font color="#000080">YES</font><font color="#808080">;
  }
  </font><font color="#000080">ncont</font><font color="#808080">++;
}

</font><font color="#000080">ncont </font><font color="#808080">= </font><font color="#000080">strlen</font><font color="#808080">(</font><font color="#000080">slocal</font><font color="#808080">)-</font><font color="#FF0000">1</font><font color="#808080">;
</font><font color="#000080">bQuebra </font><font color="#808080">= </font><font color="#000080">NO</font><font color="#808080">;
</font><font color="#0000FF"><b>while </b></font><font color="#808080">((</font><font color="#000080">ncont </font><font color="#808080">&gt;= </font><font color="#FF0000">0</font><font color="#808080">) &amp;&amp; (</font><font color="#000080">bQuebra</font><font color="#808080">==</font><font color="#000080">NO</font><font color="#808080">)) {
  </font><font color="#0000FF"><b>if </b></font><font color="#808080">(</font><font color="#000080">slocal</font><font color="#808080">[</font><font color="#000080">ncont</font><font color="#808080">]!=</font>' '<font color="#808080">) {
     </font><font color="#000080">nPosFim </font><font color="#808080">= </font><font color="#000080">ncont </font><font color="#808080">+ </font><font color="#FF0000">1</font><font color="#808080">;
     </font><font color="#000080">bQuebra </font><font color="#808080">= </font><font color="#000080">YES</font><font color="#808080">;
  }
  </font><font color="#000080">ncont</font><font color="#808080">--;
}
</font><font color="#000080">nPosFim</font><font color="#808080">=(</font><font color="#000080">nPosFim</font><font color="#808080">-</font><font color="#000080">nPosIni</font><font color="#808080">)+</font><font color="#FF0000">1</font><font color="#808080">;
</font><font color="#000080">sret </font><font color="#808080">= [</font><font color="#000080">self copy</font><font color="#808080">: </font><font color="#000080">slocal</font><font color="#808080">,</font><font color="#000080">nPosIni</font><font color="#808080">,</font><font color="#000080">nPosFim</font><font color="#808080">]; 

</font><font color="#0000FF"><b>return </b></font><font color="#000080">sret</font><font color="#808080">;
}
<i>/*------------------------------------------------------------------------------
Repete um texto um n&uacute;mero determinado de vezes.
sTexto - o texto a ser repetido
nQtd - a quantidade de vezes
retorna - o texto repetido
------------------------------------------------------------------------------*/
</i>- (</font><font color="#000080">STR</font><font color="#808080">) </font><font color="#000080">repete</font><font color="#808080">: (</font><font color="#000080">STR</font><font color="#808080">) </font><font color="#000080">sTexto</font><font color="#808080">, ...
{ 
  </font><font color="#0000FF"><b>int </b></font><font color="#000080">ncont</font><font color="#808080">, </font><font color="#000080">nQtd</font><font color="#808080">;
  </font><font color="#000080">STR sret</font><font color="#808080">;

</font><font color="#000080">va_list lparams</font><font color="#808080">;
</font><font color="#000080">va_start</font><font color="#808080">(</font><font color="#000080">lparams</font><font color="#808080">, </font><font color="#000080">sTexto</font><font color="#808080">);
</font><font color="#000080">nQtd </font><font color="#808080">= </font><font color="#000080">va_arg</font><font color="#808080">(</font><font color="#000080">lparams</font><font color="#808080">,</font><font color="#0000FF"><b>int</b></font><font color="#808080">);
</font><font color="#000080">va_end</font><font color="#808080">(</font><font color="#000080">lparams</font><font color="#808080">);

</font><font color="#000080">sret </font><font color="#808080">= [</font><font color="#000080">self alocaString</font><font color="#808080">: </font><font color="#000080">TAM_MAX_STR</font><font color="#808080">];

</font><font color="#0000FF"><b>for</b></font><font color="#808080">(</font><font color="#000080">ncont </font><font color="#808080">= </font><font color="#FF0000">1</font><font color="#808080">; </font><font color="#000080">ncont </font><font color="#808080">&lt;= </font><font color="#000080">nQtd</font><font color="#808080">; </font><font color="#000080">ncont</font><font color="#808080">++) {
  </font><font color="#000080">sret </font><font color="#808080">= (</font><font color="#000080">STR</font><font color="#808080">) </font><font color="#000080">strcat</font><font color="#808080">(</font><font color="#000080">sret</font><font color="#808080">,</font><font color="#000080">sTexto</font><font color="#808080">);
}

</font><font color="#0000FF"><b>return </b></font><font color="#000080">sret</font><font color="#808080">;
}
<i>/*------------------------------------------------------------------------------
Coloca espa&ccedil;os em branco a mais de acordo com o tamanho m&aacute;ximo do texto.
sTexto - o texto
nTam - tamanho m&aacute;ximo do texto
retorna - o texto com espa&ccedil;os em branco a mais
------------------------------------------------------------------------------*/
</i>- (</font><font color="#000080">STR</font><font color="#808080">) </font><font color="#000080">esp</font><font color="#808080">: (</font><font color="#000080">STR</font><font color="#808080">) </font><font color="#000080">sTexto</font><font color="#808080">, ...
{ 
  </font><font color="#0000FF"><b>int </b></font><font color="#000080">nTam</font><font color="#808080">;
  </font><font color="#000080">STR sret</font><font color="#808080">, </font><font color="#000080">slocal</font><font color="#808080">;

</font><font color="#000080">va_list lparams</font><font color="#808080">;
</font><font color="#000080">va_start</font><font color="#808080">(</font><font color="#000080">lparams</font><font color="#808080">, </font><font color="#000080">sTexto</font><font color="#808080">);
</font><font color="#000080">nTam </font><font color="#808080">= </font><font color="#000080">va_arg</font><font color="#808080">(</font><font color="#000080">lparams</font><font color="#808080">,</font><font color="#0000FF"><b>int</b></font><font color="#808080">);
</font><font color="#000080">va_end</font><font color="#808080">(</font><font color="#000080">lparams</font><font color="#808080">);

</font><font color="#000080">slocal</font><font color="#808080">=[</font><font color="#000080">self alocaString</font><font color="#808080">: </font><font color="#000080">TAM_MAX_STR</font><font color="#808080">];

</font><font color="#000080">strcpy</font><font color="#808080">(</font><font color="#000080">slocal</font><font color="#808080">, </font><font color="#000080">sTexto</font><font color="#808080">);
</font><font color="#000080">sret </font><font color="#808080">= [</font><font color="#000080">self repete</font><font color="#808080">: </font><font color="#800000">&quot; &quot;</font><font color="#808080">,</font><font color="#000080">nTam</font><font color="#808080">-</font><font color="#000080">strlen</font><font color="#808080">(</font><font color="#000080">slocal</font><font color="#808080">)];
</font><font color="#000080">strcat</font><font color="#808080">(</font><font color="#000080">slocal</font><font color="#808080">,</font><font color="#000080">sret</font><font color="#808080">);

</font><font color="#000080">free</font><font color="#808080">(</font><font color="#000080">sret</font><font color="#808080">);
</font><font color="#0000FF"><b>return </b></font><font color="#000080">slocal</font><font color="#808080">;
}
<i>/*------------------------------------------------------------------------------
Escreve zeros na frente de um texto.
stexto - o texto para receber zeros a frente
ntam - o tamanho da string
retorna - o texto com o zeros antes
------------------------------------------------------------------------------*/
</i>- (</font><font color="#000080">STR</font><font color="#808080">) </font><font color="#000080">zeros</font><font color="#808080">: (</font><font color="#000080">STR</font><font color="#808080">) </font><font color="#000080">sTexto</font><font color="#808080">, ...
{ 
  </font><font color="#0000FF"><b>int </b></font><font color="#000080">ncont</font><font color="#808080">, </font><font color="#000080">ntam</font><font color="#808080">;
  </font><font color="#000080">STR saux</font><font color="#808080">;

  </font><font color="#000080">va_list lparams</font><font color="#808080">;
  </font><font color="#000080">va_start</font><font color="#808080">(</font><font color="#000080">lparams</font><font color="#808080">, </font><font color="#000080">sTexto</font><font color="#808080">);
  </font><font color="#000080">ntam </font><font color="#808080">= </font><font color="#000080">va_arg</font><font color="#808080">(</font><font color="#000080">lparams</font><font color="#808080">,</font><font color="#0000FF"><b>int</b></font><font color="#808080">);
  </font><font color="#000080">va_end</font><font color="#808080">(</font><font color="#000080">lparams</font><font color="#808080">);
  
  </font><font color="#000080">saux </font><font color="#808080">= [</font><font color="#000080">self alocaString</font><font color="#808080">: </font><font color="#000080">TAM_MAX_STR</font><font color="#808080">];

  </font><font color="#0000FF"><b>if </b></font><font color="#808080">(</font><font color="#000080">ntam</font><font color="#808080">!=</font><font color="#000080">abs</font><font color="#808080">(</font><font color="#000080">strlen</font><font color="#808080">(</font><font color="#000080">sTexto</font><font color="#808080">))) {
      </font><font color="#0000FF"><b>for</b></font><font color="#808080">(</font><font color="#000080">ncont </font><font color="#808080">= </font><font color="#FF0000">1</font><font color="#808080">; </font><font color="#000080">ncont </font><font color="#808080">&lt;= (</font><font color="#000080">ntam</font><font color="#808080">-</font><font color="#000080">strlen</font><font color="#808080">(</font><font color="#000080">sTexto</font><font color="#808080">)); </font><font color="#000080">ncont</font><font color="#808080">++)
        </font><font color="#000080">saux </font><font color="#808080">= (</font><font color="#000080">STR</font><font color="#808080">) </font><font color="#000080">strcat</font><font color="#808080">(</font><font color="#000080">saux</font><font color="#808080">, </font><font color="#800000">&quot;0&quot;</font><font color="#808080">);
  }
  </font><font color="#0000FF"><b>return </b></font><font color="#808080">(</font><font color="#000080">STR</font><font color="#808080">) </font><font color="#000080">strcat</font><font color="#808080">(</font><font color="#000080">saux</font><font color="#808080">, </font><font color="#000080">sTexto</font><font color="#808080">);
}
<i>/*------------------------------------------------------------------------------
Faz uma pesquisa relativa de um texto atrav&eacute;s de um valor chave.
sTexto - o texto
sChave - a chave a ser pesquisada
retorna - se achou ou n&atilde;o a chave dentro do texto
------------------------------------------------------------------------------*/
</i>- (</font><font color="#000080">BOOL</font><font color="#808080">) </font><font color="#000080">strRelativa</font><font color="#808080">: (</font><font color="#000080">STR</font><font color="#808080">) </font><font color="#000080">sTexto</font><font color="#808080">, ...
{
  </font><font color="#000080">STR sChave</font><font color="#808080">;

  </font><font color="#000080">va_list lparams</font><font color="#808080">;
  </font><font color="#000080">va_start</font><font color="#808080">(</font><font color="#000080">lparams</font><font color="#808080">, </font><font color="#000080">sTexto</font><font color="#808080">);
  </font><font color="#000080">sChave </font><font color="#808080">= </font><font color="#000080">va_arg</font><font color="#808080">(</font><font color="#000080">lparams</font><font color="#808080">,</font><font color="#000080">STR</font><font color="#808080">);
  </font><font color="#000080">va_end</font><font color="#808080">(</font><font color="#000080">lparams</font><font color="#808080">);

  </font><font color="#0000FF"><b>if </b></font><font color="#808080">(</font><font color="#000080">strstr</font><font color="#808080">(</font><font color="#000080">sTexto</font><font color="#808080">,</font><font color="#000080">sChave</font><font color="#808080">)!=</font><font color="#000080">NULL</font><font color="#808080">)
    </font><font color="#0000FF"><b>return </b></font><font color="#000080">YES</font><font color="#808080">;
  </font><font color="#0000FF"><b>else
    return </b></font><font color="#000080">NO</font><font color="#808080">;
}
<i>/*------------------------------------------------------------------------------
Calcula o modulo11 de um valor qualquer.
svalor - a mstring com o n&uacute;mero a ser calculado
ndig - d&iacute;gito do valor a ser calculado
retorna - o d&iacute;gito correto
------------------------------------------------------------------------------*/
</i>- (</font><font color="#0000FF"><b>int</b></font><font color="#808080">) </font><font color="#000080">modulo11</font><font color="#808080">: (</font><font color="#000080">STR</font><font color="#808080">) </font><font color="#000080">svalor</font><font color="#808080">, ...
{ 
  </font><font color="#0000FF"><b>int </b></font><font color="#000080">ndig</font><font color="#808080">, </font><font color="#000080">ncont</font><font color="#808080">, </font><font color="#000080">nsoma</font><font color="#808080">, </font><font color="#000080">nvalor</font><font color="#808080">, </font><font color="#000080">npos</font><font color="#808080">;
  </font><font color="#000080">STR slocal</font><font color="#808080">, </font><font color="#000080">sres</font><font color="#808080">;

  </font><font color="#000080">va_list lparams</font><font color="#808080">;
  </font><font color="#000080">va_start</font><font color="#808080">(</font><font color="#000080">lparams</font><font color="#808080">, </font><font color="#000080">svalor</font><font color="#808080">);
  </font><font color="#000080">ndig </font><font color="#808080">= </font><font color="#000080">va_arg</font><font color="#808080">(</font><font color="#000080">lparams</font><font color="#808080">,</font><font color="#0000FF"><b>int</b></font><font color="#808080">);
  </font><font color="#000080">va_end</font><font color="#808080">(</font><font color="#000080">lparams</font><font color="#808080">);

 </font><font color="#000080">slocal</font><font color="#808080">=[</font><font color="#000080">self alocaString</font><font color="#808080">: </font><font color="#000080">TAM_MAX_STR</font><font color="#808080">];

 </font><font color="#000080">ncont</font><font color="#808080">=</font><font color="#FF0000">1</font><font color="#808080">;
 </font><font color="#0000FF"><b>while </b></font><font color="#808080">(</font><font color="#000080">ncont </font><font color="#808080">&lt;= </font><font color="#FF0000">11</font><font color="#808080">) {
   </font><font color="#000080">slocal</font><font color="#808080">= (</font><font color="#000080">STR</font><font color="#808080">) </font><font color="#000080">strcat</font><font color="#808080">([</font><font color="#000080">self copy</font><font color="#808080">: </font><font color="#000080">svalor</font><font color="#808080">,</font><font color="#000080">ncont</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">],</font><font color="#000080">slocal</font><font color="#808080">);
   </font><font color="#000080">ncont</font><font color="#808080">++;
 }
 </font><font color="#000080">nsoma</font><font color="#808080">=</font><font color="#FF0000">0</font><font color="#808080">;
 </font><font color="#0000FF"><b>if </b></font><font color="#808080">(</font><font color="#000080">ndig </font><font color="#808080">== </font><font color="#FF0000">1</font><font color="#808080">)
   </font><font color="#000080">ncont</font><font color="#808080">=</font><font color="#FF0000">3</font><font color="#808080">;
 </font><font color="#0000FF"><b>else
   </b></font><font color="#000080">ncont</font><font color="#808080">=</font><font color="#FF0000">2</font><font color="#808080">;
 </font><font color="#000080">npos</font><font color="#808080">=</font><font color="#FF0000">2</font><font color="#808080">;
 </font><font color="#0000FF"><b>while </b></font><font color="#808080">(</font><font color="#000080">ncont </font><font color="#808080">&lt;= </font><font color="#FF0000">11</font><font color="#808080">) {
   </font><font color="#000080">sres </font><font color="#808080">= [</font><font color="#000080">self copy</font><font color="#808080">: </font><font color="#000080">slocal</font><font color="#808080">,</font><font color="#000080">ncont</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">];
   </font><font color="#000080">nvalor </font><font color="#808080">= </font><font color="#000080">atoi</font><font color="#808080">(</font><font color="#000080">sres</font><font color="#808080">);
   </font><font color="#000080">nsoma</font><font color="#808080">=</font><font color="#000080">nsoma </font><font color="#808080">+ (</font><font color="#000080">nvalor </font><font color="#808080">* </font><font color="#000080">npos</font><font color="#808080">);
   </font><font color="#000080">ncont</font><font color="#808080">++;
   </font><font color="#000080">npos</font><font color="#808080">++;
 }
 </font><font color="#000080">nsoma</font><font color="#808080">=(</font><font color="#FF0000">11 </font><font color="#808080">- (</font><font color="#000080">nsoma </font><font color="#808080">% </font><font color="#FF0000">11</font><font color="#808080">));

 </font><font color="#000080">free</font><font color="#808080">(</font><font color="#000080">sres</font><font color="#808080">);
 </font><font color="#000080">free</font><font color="#808080">(</font><font color="#000080">slocal</font><font color="#808080">);

 </font><font color="#0000FF"><b>if </b></font><font color="#808080">(</font><font color="#000080">nsoma </font><font color="#808080">&gt; </font><font color="#FF0000">9</font><font color="#808080">)
   </font><font color="#0000FF"><b>return </b></font><font color="#FF0000">0</font><font color="#808080">;
 </font><font color="#0000FF"><b>else
   return </b></font><font color="#000080">nsoma</font><font color="#808080">;
}
<i>/*------------------------------------------------------------------------------
Valida&ccedil;&atilde;o de um n&uacute;mero de CPF qualquer.
cpf - a mstring com o n&uacute;mero do CPF
retorna - se &eacute; valido ou n&atilde;o
------------------------------------------------------------------------------*/
</i>- (</font><font color="#000080">BOOL</font><font color="#808080">) </font><font color="#000080">validaCPF</font><font color="#808080">: (</font><font color="#000080">STR</font><font color="#808080">) </font><font color="#000080">cpf
</font><font color="#808080">{ 
  </font><font color="#000080">STR scpf</font><font color="#808080">, </font><font color="#000080">sres</font><font color="#808080">;
  </font><font color="#0000FF"><b>int </b></font><font color="#000080">nvalor1</font><font color="#808080">, </font><font color="#000080">nvalor2</font><font color="#808080">;

</font><font color="#0000FF"><b>if </b></font><font color="#808080">(</font><font color="#000080">strlen</font><font color="#808080">(</font><font color="#000080">cpf</font><font color="#808080">)==</font><font color="#FF0000">14</font><font color="#808080">) {
  </font><font color="#000080">scpf </font><font color="#808080">= [</font><font color="#000080">self somastr</font><font color="#808080">: </font><font color="#FF0000">4</font><font color="#808080">,[</font><font color="#000080">self copy</font><font color="#808080">: </font><font color="#000080">cpf</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#FF0000">3</font><font color="#808080">],[</font><font color="#000080">self copy</font><font color="#808080">: </font><font color="#000080">cpf</font><font color="#808080">,</font><font color="#FF0000">5</font><font color="#808080">,</font><font color="#FF0000">3</font><font color="#808080">],
          [</font><font color="#000080">self copy</font><font color="#808080">: </font><font color="#000080">cpf</font><font color="#808080">,</font><font color="#FF0000">9</font><font color="#808080">,</font><font color="#FF0000">3</font><font color="#808080">],[</font><font color="#000080">self copy</font><font color="#808080">: </font><font color="#000080">cpf</font><font color="#808080">,</font><font color="#FF0000">13</font><font color="#808080">,</font><font color="#FF0000">2</font><font color="#808080">]];
  </font><font color="#000080">sres </font><font color="#808080">= [</font><font color="#000080">self copy</font><font color="#808080">: </font><font color="#000080">cpf</font><font color="#808080">,</font><font color="#FF0000">13</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">];
  </font><font color="#000080">nvalor1 </font><font color="#808080">= </font><font color="#000080">atoi</font><font color="#808080">(</font><font color="#000080">sres</font><font color="#808080">);
  </font><font color="#000080">strcpy</font><font color="#808080">(</font><font color="#000080">sres</font><font color="#808080">, [</font><font color="#000080">self copy</font><font color="#808080">: </font><font color="#000080">cpf</font><font color="#808080">,</font><font color="#FF0000">14</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">]);
  </font><font color="#000080">nvalor2 </font><font color="#808080">= </font><font color="#000080">atoi</font><font color="#808080">(</font><font color="#000080">sres</font><font color="#808080">);
  </font><font color="#0000FF"><b>if </b></font><font color="#808080">(([</font><font color="#000080">self modulo11</font><font color="#808080">: </font><font color="#000080">scpf</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">]==</font><font color="#000080">nvalor1</font><font color="#808080">) &amp;&amp; 
     ([</font><font color="#000080">self modulo11</font><font color="#808080">: </font><font color="#000080">scpf</font><font color="#808080">,</font><font color="#FF0000">2</font><font color="#808080">]==</font><font color="#000080">nvalor2</font><font color="#808080">)) {
    </font><font color="#0000FF"><b>return </b></font><font color="#000080">YES</font><font color="#808080">;
  } </font><font color="#0000FF"><b>else </b></font><font color="#808080">{
    </font><font color="#0000FF"><b>return </b></font><font color="#000080">NO</font><font color="#808080">;
  }
} </font><font color="#0000FF"><b>else
  return </b></font><font color="#000080">NO</font><font color="#808080">;
}
<i>/*------------------------------------------------------------------------------
Valida&ccedil;&atilde;o de um n&uacute;mero ISBN qualquer.
isbn - a mstring com o n&uacute;mero do ISBN
retorna - se &eacute; valido ou n&atilde;o
------------------------------------------------------------------------------*/
</i>- (</font><font color="#000080">BOOL</font><font color="#808080">) </font><font color="#000080">validaISBN</font><font color="#808080">: (</font><font color="#000080">STR</font><font color="#808080">) </font><font color="#000080">isbn
</font><font color="#808080">{ 
  </font><font color="#000080">STR sisbn</font><font color="#808080">, </font><font color="#000080">sdigito</font><font color="#808080">, </font><font color="#000080">snum</font><font color="#808080">;
  </font><font color="#0000FF"><b>int </b></font><font color="#000080">nvalor</font><font color="#808080">, </font><font color="#000080">nsoma</font><font color="#808080">, </font><font color="#000080">ncont</font><font color="#808080">;

</font><font color="#0000FF"><b>if </b></font><font color="#808080">(</font><font color="#000080">strlen</font><font color="#808080">(</font><font color="#000080">isbn</font><font color="#808080">)==</font><font color="#FF0000">13</font><font color="#808080">) {
  </font><font color="#000080">sisbn </font><font color="#808080">= [</font><font color="#000080">self alocaString</font><font color="#808080">: </font><font color="#000080">TAM_MAX_STR</font><font color="#808080">];

  </font><font color="#000080">sdigito </font><font color="#808080">= [</font><font color="#000080">self copy</font><font color="#808080">: </font><font color="#000080">isbn</font><font color="#808080">, </font><font color="#000080">strlen</font><font color="#808080">(</font><font color="#000080">isbn</font><font color="#808080">), </font><font color="#FF0000">1</font><font color="#808080">];
  </font><font color="#000080">sisbn</font><font color="#808080">[</font><font color="#FF0000">0</font><font color="#808080">]=</font>'\0'<font color="#808080">;
  </font><font color="#0000FF"><b>for</b></font><font color="#808080">(</font><font color="#000080">ncont </font><font color="#808080">= </font><font color="#FF0000">1</font><font color="#808080">; </font><font color="#000080">ncont </font><font color="#808080">&lt;= </font><font color="#000080">abs</font><font color="#808080">(</font><font color="#000080">strlen</font><font color="#808080">(</font><font color="#000080">isbn</font><font color="#808080">)-</font><font color="#FF0000">1</font><font color="#808080">); </font><font color="#000080">ncont</font><font color="#808080">++)  {
    </font><font color="#0000FF"><b>if </b></font><font color="#808080">(</font><font color="#000080">strcmp</font><font color="#808080">([</font><font color="#000080">self copy</font><font color="#808080">: </font><font color="#000080">isbn</font><font color="#808080">,</font><font color="#000080">ncont</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">],</font><font color="#800000">&quot;-&quot;</font><font color="#808080">)!=</font><font color="#FF0000">0</font><font color="#808080">)
      </font><font color="#000080">sisbn </font><font color="#808080">= (</font><font color="#000080">STR</font><font color="#808080">) </font><font color="#000080">strcat</font><font color="#808080">(</font><font color="#000080">sisbn</font><font color="#808080">, [</font><font color="#000080">self copy</font><font color="#808080">: </font><font color="#000080">isbn</font><font color="#808080">,</font><font color="#000080">ncont</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">]);
  }
  </font><font color="#0000FF"><b>if </b></font><font color="#808080">(</font><font color="#000080">strcmp</font><font color="#808080">(</font><font color="#000080">sdigito</font><font color="#808080">, </font><font color="#800000">&quot;X&quot;</font><font color="#808080">)==</font><font color="#FF0000">0</font><font color="#808080">)
    </font><font color="#000080">nsoma </font><font color="#808080">= </font><font color="#FF0000">10</font><font color="#808080">;
  </font><font color="#0000FF"><b>else </b></font><font color="#808080">{
    </font><font color="#000080">nvalor </font><font color="#808080">= </font><font color="#000080">atoi</font><font color="#808080">(</font><font color="#000080">sdigito</font><font color="#808080">);
    </font><font color="#000080">nsoma </font><font color="#808080">= </font><font color="#000080">nvalor</font><font color="#808080">;
  }
  </font><font color="#0000FF"><b>for</b></font><font color="#808080">(</font><font color="#000080">ncont </font><font color="#808080">= </font><font color="#FF0000">1</font><font color="#808080">; </font><font color="#000080">ncont </font><font color="#808080">&lt;= </font><font color="#FF0000">9</font><font color="#808080">; </font><font color="#000080">ncont</font><font color="#808080">++)  {
    </font><font color="#000080">snum </font><font color="#808080">= [</font><font color="#000080">self copy</font><font color="#808080">: </font><font color="#000080">sisbn</font><font color="#808080">, </font><font color="#000080">ncont</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">];
    </font><font color="#000080">nvalor </font><font color="#808080">= </font><font color="#000080">atoi</font><font color="#808080">(</font><font color="#000080">snum</font><font color="#808080">);
    </font><font color="#000080">nsoma</font><font color="#808080">=</font><font color="#000080">nsoma </font><font color="#808080">+ (</font><font color="#000080">nvalor </font><font color="#808080">* (</font><font color="#FF0000">11 </font><font color="#808080">- </font><font color="#000080">ncont</font><font color="#808080">));
  }

  </font><font color="#000080">free</font><font color="#808080">(</font><font color="#000080">sisbn</font><font color="#808080">);
  </font><font color="#000080">free</font><font color="#808080">(</font><font color="#000080">sdigito</font><font color="#808080">);
  </font><font color="#000080">free</font><font color="#808080">(</font><font color="#000080">snum</font><font color="#808080">);

  </font><font color="#0000FF"><b>if </b></font><font color="#808080">((</font><font color="#000080">nsoma </font><font color="#808080">% </font><font color="#FF0000">11</font><font color="#808080">) == </font><font color="#FF0000">0</font><font color="#808080">)
    </font><font color="#0000FF"><b>return </b></font><font color="#000080">YES</font><font color="#808080">;
  </font><font color="#0000FF"><b>else
    return </b></font><font color="#000080">NO</font><font color="#808080">;
} </font><font color="#0000FF"><b>else
  return </b></font><font color="#000080">NO</font><font color="#808080">;
}
<i>/*------------------------------------------------------------------------------
Realiza a digita&ccedil;&atilde;o de algum texto
nTam - o tamanho maximo do texto a ser digitado
retorna - o texto digitado.
------------------------------------------------------------------------------*/
</i>- (</font><font color="#000080">STR</font><font color="#808080">) </font><font color="#000080">digita</font><font color="#808080">: (</font><font color="#0000FF"><b>int</b></font><font color="#808080">) </font><font color="#000080">nTam
</font><font color="#808080">{ </font><font color="#000080">STR sTexto</font><font color="#808080">; 

  </font><font color="#000080">sTexto </font><font color="#808080">= [</font><font color="#000080">self alocaString</font><font color="#808080">: </font><font color="#000080">TAM_MAX_STR</font><font color="#808080">]; 
  </font><font color="#000080">fgets</font><font color="#808080">(</font><font color="#000080">sTexto</font><font color="#808080">, </font><font color="#000080">nTam</font><font color="#808080">, </font><font color="#000080">stdin</font><font color="#808080">);
  </font><font color="#000080">sTexto</font><font color="#808080">[</font><font color="#000080">strlen</font><font color="#808080">(</font><font color="#000080">sTexto</font><font color="#808080">)-</font><font color="#FF0000">1</font><font color="#808080">]=</font>'\0'<font color="#808080">;
  </font><font color="#0000FF"><b>if </b></font><font color="#808080">(</font><font color="#000080">strlen</font><font color="#808080">(</font><font color="#000080">sTexto</font><font color="#808080">)==</font><font color="#FF0000">0</font><font color="#808080">) {
    </font><font color="#000080">fflush</font><font color="#808080">(</font><font color="#000080">stdin</font><font color="#808080">);
    </font><font color="#000080">fgets</font><font color="#808080">(</font><font color="#000080">sTexto</font><font color="#808080">, </font><font color="#000080">nTam</font><font color="#808080">, </font><font color="#000080">stdin</font><font color="#808080">);
    </font><font color="#000080">sTexto</font><font color="#808080">[</font><font color="#000080">strlen</font><font color="#808080">(</font><font color="#000080">sTexto</font><font color="#808080">)-</font><font color="#FF0000">1</font><font color="#808080">]=</font>'\0'<font color="#808080">;    
  }    
  </font><font color="#0000FF"><b>return </b></font><font color="#000080">sTexto</font><font color="#808080">;
}
<i>/*------------------------------------------------------------------------------
Esconde a digita&ccedil;&atilde;o da senha
retorna - a senha digitada
------------------------------------------------------------------------------*/
</i>- (</font><font color="#000080">STR</font><font color="#808080">) </font><font color="#000080">digitaSenha</font><font color="#808080">: (</font><font color="#000080">STR</font><font color="#808080">) </font><font color="#000080">sRotulo</font><font color="#808080">, ...
{ 
  </font><font color="#000080">STR sSenha</font><font color="#808080">;
  </font><font color="#0000FF"><b>char </b></font><font color="#000080">sLetra</font><font color="#808080">;
  </font><font color="#0000FF"><b>int </b></font><font color="#000080">ncont</font><font color="#808080">, </font><font color="#000080">nTamSenha</font><font color="#808080">;

  </font><font color="#000080">va_list lparams</font><font color="#808080">;
  </font><font color="#000080">va_start</font><font color="#808080">(</font><font color="#000080">lparams</font><font color="#808080">, </font><font color="#000080">sRotulo</font><font color="#808080">);
  </font><font color="#000080">nTamSenha </font><font color="#808080">= </font><font color="#000080">va_arg</font><font color="#808080">(</font><font color="#000080">lparams</font><font color="#808080">,</font><font color="#0000FF"><b>int</b></font><font color="#808080">);
  </font><font color="#000080">va_end</font><font color="#808080">(</font><font color="#000080">lparams</font><font color="#808080">);

  </font><font color="#000080">sSenha </font><font color="#808080">= [</font><font color="#000080">self alocaString</font><font color="#808080">: </font><font color="#000080">TAM_MAX_STR</font><font color="#808080">];

  </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#000080">sRotulo</font><font color="#808080">);
<i>/*strcpy(sSenha, [self digita: TAM_MAX_STR]);*/
  </i></font><font color="#000080">ncont  </font><font color="#808080">= </font><font color="#FF0000">0</font><font color="#808080">;
  </font><font color="#000080">sLetra </font><font color="#808080">= </font>'\0'<font color="#808080">;
  </font><font color="#0000FF"><b>while</b></font><font color="#808080">((</font><font color="#000080">sLetra</font><font color="#808080">!=</font>'\r'<font color="#808080">) &amp;&amp; (</font><font color="#000080">ncont </font><font color="#808080">&lt; </font><font color="#000080">nTamSenha</font><font color="#808080">)) {
    </font><font color="#000080">sLetra </font><font color="#808080">= </font><font color="#000080">getch</font><font color="#808080">();
    </font><font color="#0000FF"><b>if </b></font><font color="#808080">(</font><font color="#000080">sLetra</font><font color="#808080">!=</font>'\r'<font color="#808080">) {
       </font><font color="#000080">sSenha</font><font color="#808080">[</font><font color="#000080">ncont</font><font color="#808080">] = </font><font color="#000080">sLetra</font><font color="#808080">;
    }
    </font><font color="#000080">ncont</font><font color="#808080">++;
  }
</font><font color="#000080">sSenha</font><font color="#808080">[</font><font color="#000080">ncont</font><font color="#808080">-</font><font color="#FF0000">1</font><font color="#808080">] = </font>'\0'<font color="#808080">;  
</font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;\n&quot;</font><font color="#808080">);
</font><font color="#000080">fflush</font><font color="#808080">(</font><font color="#000080">stdin</font><font color="#808080">);

</font><font color="#0000FF"><b>return </b></font><font color="#000080">sSenha</font><font color="#808080">;
}
<i>/*------------------------------------------------------------------------------
Valida&ccedil;&atilde;o de um n&uacute;mero qualquer.
sRotulo - o texto antes de se digitar o n&uacute;mero
sNumero - a mstring com o valor do n&uacute;mero
retorna - o sNumero
------------------------------------------------------------------------------*/
</i>- (</font><font color="#000080">STR</font><font color="#808080">) </font><font color="#000080">validaNumero</font><font color="#808080">: (</font><font color="#000080">STR</font><font color="#808080">) </font><font color="#000080">sRotulo</font><font color="#808080">, ...
{ 
  </font><font color="#0000FF"><b>double </b></font><font color="#000080">nnum</font><font color="#808080">;
  </font><font color="#0000FF"><b>int </b></font><font color="#000080">nStatus</font><font color="#808080">;
  </font><font color="#000080">STR sNumero</font><font color="#808080">;

  </font><font color="#000080">va_list lparams</font><font color="#808080">;
  </font><font color="#000080">va_start</font><font color="#808080">(</font><font color="#000080">lparams</font><font color="#808080">, </font><font color="#000080">sRotulo</font><font color="#808080">);
  </font><font color="#000080">sNumero </font><font color="#808080">= </font><font color="#000080">va_arg</font><font color="#808080">(</font><font color="#000080">lparams</font><font color="#808080">,</font><font color="#000080">STR</font><font color="#808080">);
  </font><font color="#000080">va_end</font><font color="#808080">(</font><font color="#000080">lparams</font><font color="#808080">);

 </font><font color="#000080">nStatus </font><font color="#808080">= -</font><font color="#FF0000">1</font><font color="#808080">;
 </font><font color="#0000FF"><b>while </b></font><font color="#808080">(</font><font color="#000080">nStatus</font><font color="#808080">!=</font><font color="#FF0000">0</font><font color="#808080">) {
  </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#000080">sRotulo</font><font color="#808080">);
  </font><font color="#000080">strcpy</font><font color="#808080">(</font><font color="#000080">sNumero</font><font color="#808080">, [</font><font color="#000080">self digita</font><font color="#808080">: </font><font color="#000080">TAM_MAX_STR</font><font color="#808080">]);
  </font><font color="#000080">nnum </font><font color="#808080">= </font><font color="#000080">atof</font><font color="#808080">(</font><font color="#000080">sNumero</font><font color="#808080">);
  </font><font color="#0000FF"><b>if </b></font><font color="#808080">(</font><font color="#000080">nnum </font><font color="#808080">&lt; </font>0.01<font color="#808080">)
     </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;%s\n&quot;</font><font color="#808080">,</font><font color="#000080">MSG_NUMINV</font><font color="#808080">);
  </font><font color="#0000FF"><b>else
     </b></font><font color="#000080">nStatus</font><font color="#808080">=</font><font color="#FF0000">0</font><font color="#808080">;
}
</font><font color="#0000FF"><b>return </b></font><font color="#000080">sNumero</font><font color="#808080">;
}
<i>/*------------------------------------------------------------------------------
Valida&ccedil;&atilde;o de uma data ou data/hora qualquer.
sRotulo - o texto antes de se digitar a data/hora
sDataHora - a mstring com o valor da data/hora
bSoData - indica se vai validar somente uma data sem a hora
retorna - a sDataHora
------------------------------------------------------------------------------*/
</i>- (</font><font color="#000080">STR</font><font color="#808080">) </font><font color="#000080">validaDataHora</font><font color="#808080">: (</font><font color="#000080">STR</font><font color="#808080">) </font><font color="#000080">sRotulo</font><font color="#808080">, ...
{ 
  </font><font color="#000080">BOOL bSoData</font><font color="#808080">, </font><font color="#000080">bvalida</font><font color="#808080">, </font><font color="#000080">bdatavalida</font><font color="#808080">, </font><font color="#000080">bhoravalida</font><font color="#808080">;
  </font><font color="#000080">STR sDataHora</font><font color="#808080">, </font><font color="#000080">sdia</font><font color="#808080">, </font><font color="#000080">smes</font><font color="#808080">, </font><font color="#000080">sano</font><font color="#808080">, </font><font color="#000080">shora</font><font color="#808080">, </font><font color="#000080">smin</font><font color="#808080">, </font><font color="#000080">sseg</font><font color="#808080">;
  </font><font color="#0000FF"><b>int </b></font><font color="#000080">ndia</font><font color="#808080">, </font><font color="#000080">nmes</font><font color="#808080">, </font><font color="#000080">nano</font><font color="#808080">, </font><font color="#000080">nhora</font><font color="#808080">, </font><font color="#000080">nmin</font><font color="#808080">, </font><font color="#000080">nseg</font><font color="#808080">, </font><font color="#000080">nudiames</font><font color="#808080">, </font><font color="#000080">ntam</font><font color="#808080">;

  </font><font color="#000080">va_list lparams</font><font color="#808080">;
  </font><font color="#000080">va_start</font><font color="#808080">(</font><font color="#000080">lparams</font><font color="#808080">, </font><font color="#000080">sRotulo</font><font color="#808080">);
  </font><font color="#000080">sDataHora </font><font color="#808080">= </font><font color="#000080">va_arg</font><font color="#808080">(</font><font color="#000080">lparams</font><font color="#808080">,</font><font color="#000080">STR</font><font color="#808080">);
  </font><font color="#000080">bSoData </font><font color="#808080">= </font><font color="#000080">va_arg</font><font color="#808080">(</font><font color="#000080">lparams</font><font color="#808080">,</font><font color="#0000FF"><b>int</b></font><font color="#808080">);
  </font><font color="#000080">va_end</font><font color="#808080">(</font><font color="#000080">lparams</font><font color="#808080">);

</font><font color="#000080">bvalida </font><font color="#808080">= </font><font color="#000080">NO</font><font color="#808080">;
</font><font color="#000080">bdatavalida </font><font color="#808080">= </font><font color="#000080">NO</font><font color="#808080">;
</font><font color="#000080">bhoravalida </font><font color="#808080">= </font><font color="#000080">NO</font><font color="#808080">;
</font><font color="#000080">nudiames </font><font color="#808080">= </font><font color="#FF0000">0</font><font color="#808080">;
</font><font color="#0000FF"><b>if </b></font><font color="#808080">(</font><font color="#000080">bSoData</font><font color="#808080">==</font><font color="#000080">YES</font><font color="#808080">) </font><font color="#000080">ntam</font><font color="#808080">=</font><font color="#FF0000">10</font><font color="#808080">;
</font><font color="#0000FF"><b>else </b></font><font color="#000080">ntam</font><font color="#808080">=</font><font color="#FF0000">19</font><font color="#808080">;
</font><font color="#0000FF"><b>while </b></font><font color="#808080">(</font><font color="#000080">bvalida</font><font color="#808080">==</font><font color="#000080">NO</font><font color="#808080">) {
  </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#000080">sRotulo</font><font color="#808080">);
  </font><font color="#000080">strcpy</font><font color="#808080">(</font><font color="#000080">sDataHora</font><font color="#808080">, [</font><font color="#000080">self digita</font><font color="#808080">: </font><font color="#000080">TAM_MAX_STR</font><font color="#808080">]);
  </font><font color="#0000FF"><b>if </b></font><font color="#808080">(</font><font color="#000080">strlen</font><font color="#808080">(</font><font color="#000080">sDataHora</font><font color="#808080">)==</font><font color="#000080">ntam</font><font color="#808080">) {
    </font><font color="#000080">sdia </font><font color="#808080">= [</font><font color="#000080">self copy</font><font color="#808080">: </font><font color="#000080">sDataHora</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#FF0000">2</font><font color="#808080">];
    </font><font color="#000080">ndia </font><font color="#808080">= </font><font color="#000080">atoi</font><font color="#808080">(</font><font color="#000080">sdia</font><font color="#808080">);
    </font><font color="#000080">smes </font><font color="#808080">= [</font><font color="#000080">self copy</font><font color="#808080">: </font><font color="#000080">sDataHora</font><font color="#808080">,</font><font color="#FF0000">4</font><font color="#808080">,</font><font color="#FF0000">2</font><font color="#808080">];
    </font><font color="#000080">nmes </font><font color="#808080">= </font><font color="#000080">atoi</font><font color="#808080">(</font><font color="#000080">smes</font><font color="#808080">);
    </font><font color="#000080">sano </font><font color="#808080">= [</font><font color="#000080">self copy</font><font color="#808080">: </font><font color="#000080">sDataHora</font><font color="#808080">,</font><font color="#FF0000">7</font><font color="#808080">,</font><font color="#FF0000">4</font><font color="#808080">];
    </font><font color="#000080">nano </font><font color="#808080">= </font><font color="#000080">atoi</font><font color="#808080">(</font><font color="#000080">sano</font><font color="#808080">);

    </font><font color="#0000FF"><b>if </b></font><font color="#808080">((</font><font color="#000080">nano </font><font color="#808080">&gt;= </font><font color="#FF0000">1</font><font color="#808080">) &amp;&amp; (</font><font color="#000080">nano </font><font color="#808080">&lt;= </font><font color="#FF0000">9999</font><font color="#808080">)) {
      </font><font color="#0000FF"><b>if </b></font><font color="#808080">((</font><font color="#000080">nmes </font><font color="#808080">&gt;= </font><font color="#FF0000">1</font><font color="#808080">) &amp;&amp; (</font><font color="#000080">nmes </font><font color="#808080">&lt;= </font><font color="#FF0000">31</font><font color="#808080">)) {
          </font><font color="#0000FF"><b>switch</b></font><font color="#808080">(</font><font color="#000080">nmes</font><font color="#808080">) {
           </font><font color="#0000FF"><b>case </b></font><font color="#FF0000">1</font><font color="#808080">: </font><font color="#0000FF"><b>case </b></font><font color="#FF0000">3</font><font color="#808080">: </font><font color="#0000FF"><b>case </b></font><font color="#FF0000">5</font><font color="#808080">: </font><font color="#0000FF"><b>case </b></font><font color="#FF0000">7</font><font color="#808080">: </font><font color="#0000FF"><b>case </b></font><font color="#FF0000">8</font><font color="#808080">: 
           </font><font color="#0000FF"><b>case </b></font><font color="#FF0000">10</font><font color="#808080">: </font><font color="#0000FF"><b>case </b></font><font color="#FF0000">12</font><font color="#808080">: </font><font color="#000080">nudiames </font><font color="#808080">= </font><font color="#FF0000">31</font><font color="#808080">; </font><font color="#0000FF"><b>break</b></font><font color="#808080">;
           </font><font color="#0000FF"><b>case </b></font><font color="#FF0000">2</font><font color="#808080">: {
               <i>/* ano bissexto */
               </i></font><font color="#0000FF"><b>if </b></font><font color="#808080">((</font><font color="#000080">nano </font><font color="#808080">% </font><font color="#FF0000">4</font><font color="#808080">)==</font><font color="#FF0000">0</font><font color="#808080">) </font><font color="#000080">nudiames </font><font color="#808080">= </font><font color="#FF0000">29</font><font color="#808080">;
               </font><font color="#0000FF"><b>else </b></font><font color="#000080">nudiames </font><font color="#808080">= </font><font color="#FF0000">28</font><font color="#808080">;
              } </font><font color="#0000FF"><b>break</b></font><font color="#808080">;
           </font><font color="#0000FF"><b>case </b></font><font color="#FF0000">4</font><font color="#808080">: </font><font color="#0000FF"><b>case </b></font><font color="#FF0000">6</font><font color="#808080">: </font><font color="#0000FF"><b>case </b></font><font color="#FF0000">9</font><font color="#808080">: </font><font color="#0000FF"><b>case </b></font><font color="#FF0000">11</font><font color="#808080">: </font><font color="#000080">nudiames </font><font color="#808080">= </font><font color="#FF0000">30</font><font color="#808080">; </font><font color="#0000FF"><b>break</b></font><font color="#808080">;
          }
          </font><font color="#0000FF"><b>if </b></font><font color="#808080">((</font><font color="#000080">ndia </font><font color="#808080">&gt;=</font><font color="#FF0000">1</font><font color="#808080">) &amp;&amp; (</font><font color="#000080">ndia </font><font color="#808080">&lt;=</font><font color="#000080">nudiames</font><font color="#808080">))
             </font><font color="#000080">bdatavalida </font><font color="#808080">= </font><font color="#000080">YES</font><font color="#808080">;
      }
    } 

    </font><font color="#0000FF"><b>if </b></font><font color="#808080">(</font><font color="#000080">bSoData</font><font color="#808080">==</font><font color="#000080">YES</font><font color="#808080">) {
       </font><font color="#0000FF"><b>if </b></font><font color="#808080">(</font><font color="#000080">bdatavalida</font><font color="#808080">==</font><font color="#000080">YES</font><font color="#808080">) 
           </font><font color="#000080">bvalida </font><font color="#808080">= </font><font color="#000080">YES</font><font color="#808080">;
       </font><font color="#0000FF"><b>else 
</b></font>      		 <font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;%s\n&quot;</font><font color="#808080">,</font><font color="#000080">MSG_DATAINV</font><font color="#808080">);
    } </font><font color="#0000FF"><b>else </b></font><font color="#808080">{
      </font><font color="#0000FF"><b>if </b></font><font color="#808080">(</font><font color="#000080">bdatavalida</font><font color="#808080">==</font><font color="#000080">YES</font><font color="#808080">) {
          </font><font color="#000080">shora </font><font color="#808080">= [</font><font color="#000080">self copy</font><font color="#808080">: </font><font color="#000080">sDataHora</font><font color="#808080">,</font><font color="#FF0000">12</font><font color="#808080">,</font><font color="#FF0000">2</font><font color="#808080">];
          </font><font color="#000080">nhora </font><font color="#808080">= </font><font color="#000080">atoi</font><font color="#808080">(</font><font color="#000080">shora</font><font color="#808080">);
          </font><font color="#000080">smin </font><font color="#808080">= [</font><font color="#000080">self copy</font><font color="#808080">: </font><font color="#000080">sDataHora</font><font color="#808080">,</font><font color="#FF0000">15</font><font color="#808080">,</font><font color="#FF0000">2</font><font color="#808080">];
          </font><font color="#000080">nmin </font><font color="#808080">= </font><font color="#000080">atoi</font><font color="#808080">(</font><font color="#000080">smin</font><font color="#808080">);
          </font><font color="#000080">sseg </font><font color="#808080">= [</font><font color="#000080">self copy</font><font color="#808080">: </font><font color="#000080">sDataHora</font><font color="#808080">,</font><font color="#FF0000">18</font><font color="#808080">,</font><font color="#FF0000">2</font><font color="#808080">];
          </font><font color="#000080">nseg </font><font color="#808080">= </font><font color="#000080">atoi</font><font color="#808080">(</font><font color="#000080">sseg</font><font color="#808080">);
  
          </font><font color="#0000FF"><b>if </b></font><font color="#808080">((</font><font color="#000080">nhora </font><font color="#808080">&gt;= </font><font color="#FF0000">0</font><font color="#808080">) &amp;&amp; (</font><font color="#000080">nhora </font><font color="#808080">&lt;= </font><font color="#FF0000">23</font><font color="#808080">)) {
            </font><font color="#0000FF"><b>if </b></font><font color="#808080">((</font><font color="#000080">nmin </font><font color="#808080">&gt;= </font><font color="#FF0000">0</font><font color="#808080">) &amp;&amp; (</font><font color="#000080">nmin </font><font color="#808080">&lt;= </font><font color="#FF0000">59</font><font color="#808080">)) {
              </font><font color="#0000FF"><b>if </b></font><font color="#808080">((</font><font color="#000080">nseg </font><font color="#808080">&gt;= </font><font color="#FF0000">0</font><font color="#808080">) &amp;&amp; (</font><font color="#000080">nseg </font><font color="#808080">&lt;= </font><font color="#FF0000">59</font><font color="#808080">))
                 </font><font color="#000080">bhoravalida </font><font color="#808080">= </font><font color="#000080">YES</font><font color="#808080">;
            }
          }

        </font><font color="#0000FF"><b>if </b></font><font color="#808080">(</font><font color="#000080">bhoravalida</font><font color="#808080">==</font><font color="#000080">YES</font><font color="#808080">) 
</font>     	    <font color="#000080">bvalida </font><font color="#808080">= </font><font color="#000080">YES</font><font color="#808080">;
        </font><font color="#0000FF"><b>else 
</b></font>  		    <font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;%s\n&quot;</font><font color="#808080">,</font><font color="#000080">MSG_DTHRINV</font><font color="#808080">);
      } </font><font color="#0000FF"><b>else
        </b></font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;%s\n&quot;</font><font color="#808080">,</font><font color="#000080">MSG_DTHRINV</font><font color="#808080">);
    }
  } </font><font color="#0000FF"><b>else </b></font><font color="#808080">{
    </font><font color="#0000FF"><b>if </b></font><font color="#808080">(</font><font color="#000080">bSoData</font><font color="#808080">==</font><font color="#000080">YES</font><font color="#808080">) </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;%s\n&quot;</font><font color="#808080">,</font><font color="#000080">MSG_DATAINV</font><font color="#808080">);
    </font><font color="#0000FF"><b>else </b></font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;%s\n&quot;</font><font color="#808080">,</font><font color="#000080">MSG_DTHRINV</font><font color="#808080">);
  }
}
</font><font color="#0000FF"><b>return </b></font><font color="#000080">sDataHora</font><font color="#808080">;
}
<i>/*------------------------------------------------------------------------------
Converte de inteiro para string, n&atilde;o existente em alguns compiladores.
nvalor - o valor do n&uacute;mero inteiro
stexto - a string com o n&uacute;mero inteiro
radix - numeral radix
retorna - a string com o n&uacute;mero inteiro
------------------------------------------------------------------------------*/
</i>- (</font><font color="#000080">STR</font><font color="#808080">) </font><font color="#000080">itoa</font><font color="#808080">: (</font><font color="#0000FF"><b>int</b></font><font color="#808080">) </font><font color="#000080">nvalor</font><font color="#808080">, ...
{ 
 </font><font color="#000080">STR stexto</font><font color="#808080">; 
 </font><font color="#0000FF"><b>int </b></font><font color="#000080">radix</font><font color="#808080">;

 </font><font color="#000080">va_list lparams</font><font color="#808080">;
 </font><font color="#000080">va_start</font><font color="#808080">(</font><font color="#000080">lparams</font><font color="#808080">, </font><font color="#000080">nvalor</font><font color="#808080">);
 </font><font color="#000080">stexto </font><font color="#808080">= </font><font color="#000080">va_arg</font><font color="#808080">(</font><font color="#000080">lparams</font><font color="#808080">,</font><font color="#000080">STR</font><font color="#808080">);
 </font><font color="#000080">radix </font><font color="#808080">= </font><font color="#000080">va_arg</font><font color="#808080">(</font><font color="#000080">lparams</font><font color="#808080">,</font><font color="#0000FF"><b>int</b></font><font color="#808080">);
 </font><font color="#000080">va_end</font><font color="#808080">(</font><font color="#000080">lparams</font><font color="#808080">);

 </font><font color="#000080">gcvt</font><font color="#808080">(</font><font color="#000080">nvalor</font><font color="#808080">, </font><font color="#000080">radix</font><font color="#808080">, </font><font color="#000080">stexto</font><font color="#808080">); 
 </font><font color="#000080">strncpy</font><font color="#808080">(</font><font color="#000080">stexto</font><font color="#808080">, </font><font color="#000080">stexto</font><font color="#808080">, </font><font color="#000080">strlen</font><font color="#808080">(</font><font color="#000080">stexto</font><font color="#808080">)-</font><font color="#FF0000">1</font><font color="#808080">);
 </font><font color="#0000FF"><b>return </b></font><font color="#000080">stexto</font><font color="#808080">;
}
<i>/*------------------------------------------------------------------------------
Retorna a Data e a hora do sistema.
retorna - a data e a hora
------------------------------------------------------------------------------*/
</i>- (</font><font color="#000080">STR</font><font color="#808080">) </font><font color="#000080">retDataHora
</font><font color="#808080">{ 
  </font><font color="#000080">STR sdatahora</font><font color="#808080">;
  </font><font color="#000080">time_t agora</font><font color="#808080">;   
  </font><font color="#0000FF"><b>struct </b></font><font color="#000080">tm </font><font color="#808080">* </font><font color="#000080">tempo</font><font color="#808080">;

  </font><font color="#000080">sdatahora </font><font color="#808080">= [</font><font color="#000080">self alocaString</font><font color="#808080">: </font><font color="#000080">TAM_MAX_STR</font><font color="#808080">];

  </font><font color="#000080">time</font><font color="#808080">(&amp;</font><font color="#000080">agora</font><font color="#808080">);
  </font><font color="#000080">tempo </font><font color="#808080">= </font><font color="#000080">localtime</font><font color="#808080">(&amp;</font><font color="#000080">agora</font><font color="#808080">); 
  </font><font color="#000080">strftime</font><font color="#808080">(</font><font color="#000080">sdatahora</font><font color="#808080">, </font><font color="#000080">TAM_MAX_STR</font><font color="#808080">, </font><font color="#800000">&quot;%d/%m/%Y %H:%M:%S&quot;</font><font color="#808080">, </font><font color="#000080">tempo</font><font color="#808080">);

  </font><font color="#0000FF"><b>return </b></font><font color="#000080">sdatahora</font><font color="#808080">;
}
<i>/*------------------------------------------------------------------------------
Calcula o tamanho do arquivo.
sArq - o arquivo
retorna - o tamanho do arquivo
------------------------------------------------------------------------------*/
</i>- (</font><font color="#0000FF"><b>long</b></font><font color="#808080">) </font><font color="#000080">tamArq</font><font color="#808080">: (</font><font color="#000080">FILE</font><font color="#808080">*) </font><font color="#000080">sArq
</font><font color="#808080">{ </font><font color="#0000FF"><b>long </b></font><font color="#000080">ntam</font><font color="#808080">;

</font><font color="#000080">fseek</font><font color="#808080">(</font><font color="#000080">sArq </font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#000080">SEEK_END</font><font color="#808080">);
</font><font color="#000080">ntam </font><font color="#808080">= </font><font color="#000080">ftell</font><font color="#808080">(</font><font color="#000080">sArq</font><font color="#808080">);
</font><font color="#000080">rewind</font><font color="#808080">(</font><font color="#000080">sArq</font><font color="#808080">);

</font><font color="#0000FF"><b>return </b></font><font color="#000080">ntam</font><font color="#808080">;
}
<i>/*------------------------------------------------------------------------------
Abre ou cria os arquivos do sistema.
bAbre - condi&ccedil;&atilde;o para abrir ou criar os arquivos do sistema
------------------------------------------------------------------------------*/
</i>- </font><font color="#000080">abrecriaArqs</font><font color="#808080">: (</font><font color="#000080">BOOL</font><font color="#808080">) </font><font color="#000080">bAbre
</font><font color="#808080">{
</font><font color="#0000FF"><b>if </b></font><font color="#808080">(</font><font color="#000080">bAbre</font><font color="#808080">==</font><font color="#000080">YES</font><font color="#808080">) {
  </font><font color="#0000FF"><b>if </b></font><font color="#808080">((</font><font color="#000080">tfAssunto </font><font color="#808080">= </font><font color="#000080">fopen</font><font color="#808080">(</font><font color="#000080">ARQ_ASSUNTO</font><font color="#808080">,</font><font color="#000080">ARQ_ABRE</font><font color="#808080">))==</font><font color="#000080">NULL</font><font color="#808080">) {
    </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;%s --&gt; %s\n&quot;</font><font color="#808080">,</font><font color="#000080">MSG_ARQERRO</font><font color="#808080">,</font><font color="#000080">ARQ_ASSUNTO</font><font color="#808080">);
    </font><font color="#000080">exit</font><font color="#808080">(</font><font color="#FF0000">1</font><font color="#808080">);
  }
  </font><font color="#0000FF"><b>if </b></font><font color="#808080">((</font><font color="#000080">tfAutor </font><font color="#808080">= </font><font color="#000080">fopen</font><font color="#808080">(</font><font color="#000080">ARQ_AUTOR</font><font color="#808080">,</font><font color="#000080">ARQ_ABRE</font><font color="#808080">))==</font><font color="#000080">NULL</font><font color="#808080">) {
    </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;%s --&gt; %s\n&quot;</font><font color="#808080">,</font><font color="#000080">MSG_ARQERRO</font><font color="#808080">,</font><font color="#000080">ARQ_AUTOR</font><font color="#808080">);
    </font><font color="#000080">exit</font><font color="#808080">(</font><font color="#FF0000">1</font><font color="#808080">);
  }
  </font><font color="#0000FF"><b>if </b></font><font color="#808080">((</font><font color="#000080">tfEditora</font><font color="#808080">=</font><font color="#000080">fopen</font><font color="#808080">(</font><font color="#000080">ARQ_EDITORA</font><font color="#808080">,</font><font color="#000080">ARQ_ABRE</font><font color="#808080">))==</font><font color="#000080">NULL</font><font color="#808080">) {
    </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;%s --&gt; %s\n&quot;</font><font color="#808080">,</font><font color="#000080">MSG_ARQERRO</font><font color="#808080">,</font><font color="#000080">ARQ_EDITORA</font><font color="#808080">);
    </font><font color="#000080">exit</font><font color="#808080">(</font><font color="#FF0000">1</font><font color="#808080">);
  }
  </font><font color="#0000FF"><b>if </b></font><font color="#808080">((</font><font color="#000080">tfIdioma</font><font color="#808080">=</font><font color="#000080">fopen</font><font color="#808080">(</font><font color="#000080">ARQ_IDIOMA</font><font color="#808080">,</font><font color="#000080">ARQ_ABRE</font><font color="#808080">))==</font><font color="#000080">NULL</font><font color="#808080">) {
    </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;%s --&gt; %s\n&quot;</font><font color="#808080">,</font><font color="#000080">MSG_ARQERRO</font><font color="#808080">,</font><font color="#000080">ARQ_IDIOMA</font><font color="#808080">);
    </font><font color="#000080">exit</font><font color="#808080">(</font><font color="#FF0000">1</font><font color="#808080">);
  }
  </font><font color="#0000FF"><b>if </b></font><font color="#808080">((</font><font color="#000080">tfEndereco</font><font color="#808080">=</font><font color="#000080">fopen</font><font color="#808080">(</font><font color="#000080">ARQ_ENDERECO</font><font color="#808080">,</font><font color="#000080">ARQ_ABRE</font><font color="#808080">))==</font><font color="#000080">NULL</font><font color="#808080">) {
    </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;%s --&gt; %s\n&quot;</font><font color="#808080">,</font><font color="#000080">MSG_ARQERRO</font><font color="#808080">,</font><font color="#000080">ARQ_ENDERECO</font><font color="#808080">);
    </font><font color="#000080">exit</font><font color="#808080">(</font><font color="#FF0000">1</font><font color="#808080">);
  }
  </font><font color="#0000FF"><b>if </b></font><font color="#808080">((</font><font color="#000080">tfPais</font><font color="#808080">=</font><font color="#000080">fopen</font><font color="#808080">(</font><font color="#000080">ARQ_PAIS</font><font color="#808080">,</font><font color="#000080">ARQ_ABRE</font><font color="#808080">))==</font><font color="#000080">NULL</font><font color="#808080">) {
    </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;%s --&gt; %s\n&quot;</font><font color="#808080">,</font><font color="#000080">MSG_ARQERRO</font><font color="#808080">,</font><font color="#000080">ARQ_PAIS</font><font color="#808080">);
    </font><font color="#000080">exit</font><font color="#808080">(</font><font color="#FF0000">1</font><font color="#808080">);
  }
  </font><font color="#0000FF"><b>if </b></font><font color="#808080">((</font><font color="#000080">tfProfissao</font><font color="#808080">=</font><font color="#000080">fopen</font><font color="#808080">(</font><font color="#000080">ARQ_PROFISSAO</font><font color="#808080">,</font><font color="#000080">ARQ_ABRE</font><font color="#808080">))==</font><font color="#000080">NULL</font><font color="#808080">) {
    </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;%s --&gt; %s\n&quot;</font><font color="#808080">,</font><font color="#000080">MSG_ARQERRO</font><font color="#808080">,</font><font color="#000080">ARQ_PROFISSAO</font><font color="#808080">);
    </font><font color="#000080">exit</font><font color="#808080">(</font><font color="#FF0000">1</font><font color="#808080">);
  }
  </font><font color="#0000FF"><b>if </b></font><font color="#808080">((</font><font color="#000080">tfLivro</font><font color="#808080">=</font><font color="#000080">fopen</font><font color="#808080">(</font><font color="#000080">ARQ_LIVRO</font><font color="#808080">,</font><font color="#000080">ARQ_ABRE</font><font color="#808080">))==</font><font color="#000080">NULL</font><font color="#808080">) {
    </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;%s --&gt; %s\n&quot;</font><font color="#808080">,</font><font color="#000080">MSG_ARQERRO</font><font color="#808080">,</font><font color="#000080">ARQ_LIVRO</font><font color="#808080">);
    </font><font color="#000080">exit</font><font color="#808080">(</font><font color="#FF0000">1</font><font color="#808080">);
  }
  </font><font color="#0000FF"><b>if </b></font><font color="#808080">((</font><font color="#000080">tfLivroAss</font><font color="#808080">=</font><font color="#000080">fopen</font><font color="#808080">(</font><font color="#000080">ARQ_LIVASS</font><font color="#808080">,</font><font color="#000080">ARQ_ABRE</font><font color="#808080">))==</font><font color="#000080">NULL</font><font color="#808080">) {
    </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;%s --&gt; %s\n&quot;</font><font color="#808080">,</font><font color="#000080">MSG_ARQERRO</font><font color="#808080">,</font><font color="#000080">ARQ_LIVASS</font><font color="#808080">);
    </font><font color="#000080">exit</font><font color="#808080">(</font><font color="#FF0000">1</font><font color="#808080">);
  }
  </font><font color="#0000FF"><b>if </b></font><font color="#808080">((</font><font color="#000080">tfLivroAut</font><font color="#808080">=</font><font color="#000080">fopen</font><font color="#808080">(</font><font color="#000080">ARQ_LIVAUT</font><font color="#808080">,</font><font color="#000080">ARQ_ABRE</font><font color="#808080">))==</font><font color="#000080">NULL</font><font color="#808080">) {
    </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;%s --&gt; %s\n&quot;</font><font color="#808080">,</font><font color="#000080">MSG_ARQERRO</font><font color="#808080">,</font><font color="#000080">ARQ_LIVAUT</font><font color="#808080">);
    </font><font color="#000080">exit</font><font color="#808080">(</font><font color="#FF0000">1</font><font color="#808080">);
  }
  </font><font color="#0000FF"><b>if </b></font><font color="#808080">((</font><font color="#000080">tfCliente</font><font color="#808080">=</font><font color="#000080">fopen</font><font color="#808080">(</font><font color="#000080">ARQ_CLIENTE</font><font color="#808080">,</font><font color="#000080">ARQ_ABRE</font><font color="#808080">))==</font><font color="#000080">NULL</font><font color="#808080">) {
    </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;%s --&gt; %s\n&quot;</font><font color="#808080">,</font><font color="#000080">MSG_ARQERRO</font><font color="#808080">,</font><font color="#000080">ARQ_CLIENTE</font><font color="#808080">);
    </font><font color="#000080">exit</font><font color="#808080">(</font><font color="#FF0000">1</font><font color="#808080">);
  }
  </font><font color="#0000FF"><b>if </b></font><font color="#808080">((</font><font color="#000080">tfUsuario</font><font color="#808080">=</font><font color="#000080">fopen</font><font color="#808080">(</font><font color="#000080">ARQ_USUARIO</font><font color="#808080">,</font><font color="#000080">ARQ_ABRE</font><font color="#808080">))==</font><font color="#000080">NULL</font><font color="#808080">) {
    </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;%s --&gt; %s\n&quot;</font><font color="#808080">,</font><font color="#000080">MSG_ARQERRO</font><font color="#808080">,</font><font color="#000080">ARQ_USUARIO</font><font color="#808080">);
    </font><font color="#000080">exit</font><font color="#808080">(</font><font color="#FF0000">1</font><font color="#808080">);
  }
  </font><font color="#0000FF"><b>if </b></font><font color="#808080">((</font><font color="#000080">tfVenda</font><font color="#808080">=</font><font color="#000080">fopen</font><font color="#808080">(</font><font color="#000080">ARQ_VENDA</font><font color="#808080">,</font><font color="#000080">ARQ_ABRE</font><font color="#808080">))==</font><font color="#000080">NULL</font><font color="#808080">) {
    </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;%s --&gt; %s\n&quot;</font><font color="#808080">,</font><font color="#000080">MSG_ARQERRO</font><font color="#808080">,</font><font color="#000080">ARQ_VENDA</font><font color="#808080">);
    </font><font color="#000080">exit</font><font color="#808080">(</font><font color="#FF0000">1</font><font color="#808080">);
  }
} </font><font color="#0000FF"><b>else </b></font><font color="#808080">{
  </font><font color="#0000FF"><b>if </b></font><font color="#808080">((</font><font color="#000080">tfAssunto</font><font color="#808080">=</font><font color="#000080">fopen</font><font color="#808080">(</font><font color="#000080">ARQ_ASSUNTO</font><font color="#808080">,</font><font color="#000080">ARQ_CRIA</font><font color="#808080">))==</font><font color="#000080">NULL</font><font color="#808080">) {
    </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;%s --&gt; %s\n&quot;</font><font color="#808080">,</font><font color="#000080">MSG_ARQCERRO</font><font color="#808080">,</font><font color="#000080">ARQ_ASSUNTO</font><font color="#808080">);
    </font><font color="#000080">exit</font><font color="#808080">(</font><font color="#FF0000">1</font><font color="#808080">);
  }
  </font><font color="#0000FF"><b>if </b></font><font color="#808080">((</font><font color="#000080">tfAutor</font><font color="#808080">=</font><font color="#000080">fopen</font><font color="#808080">(</font><font color="#000080">ARQ_AUTOR</font><font color="#808080">,</font><font color="#000080">ARQ_CRIA</font><font color="#808080">))==</font><font color="#000080">NULL</font><font color="#808080">) {
    </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;%s --&gt; %s\n&quot;</font><font color="#808080">,</font><font color="#000080">MSG_ARQCERRO</font><font color="#808080">,</font><font color="#000080">ARQ_AUTOR</font><font color="#808080">);
    </font><font color="#000080">exit</font><font color="#808080">(</font><font color="#FF0000">1</font><font color="#808080">);
  }
  </font><font color="#0000FF"><b>if </b></font><font color="#808080">((</font><font color="#000080">tfEditora</font><font color="#808080">=</font><font color="#000080">fopen</font><font color="#808080">(</font><font color="#000080">ARQ_EDITORA</font><font color="#808080">,</font><font color="#000080">ARQ_CRIA</font><font color="#808080">))==</font><font color="#000080">NULL</font><font color="#808080">) {
    </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;%s --&gt; %s\n&quot;</font><font color="#808080">,</font><font color="#000080">MSG_ARQCERRO</font><font color="#808080">,</font><font color="#000080">ARQ_EDITORA</font><font color="#808080">);
    </font><font color="#000080">exit</font><font color="#808080">(</font><font color="#FF0000">1</font><font color="#808080">);
  }
  </font><font color="#0000FF"><b>if </b></font><font color="#808080">((</font><font color="#000080">tfIdioma</font><font color="#808080">=</font><font color="#000080">fopen</font><font color="#808080">(</font><font color="#000080">ARQ_IDIOMA</font><font color="#808080">,</font><font color="#000080">ARQ_CRIA</font><font color="#808080">))==</font><font color="#000080">NULL</font><font color="#808080">) {
    </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;%s --&gt; %s\n&quot;</font><font color="#808080">,</font><font color="#000080">MSG_ARQCERRO</font><font color="#808080">,</font><font color="#000080">ARQ_IDIOMA</font><font color="#808080">);
    </font><font color="#000080">exit</font><font color="#808080">(</font><font color="#FF0000">1</font><font color="#808080">);
  }
  </font><font color="#0000FF"><b>if </b></font><font color="#808080">((</font><font color="#000080">tfEndereco</font><font color="#808080">=</font><font color="#000080">fopen</font><font color="#808080">(</font><font color="#000080">ARQ_ENDERECO</font><font color="#808080">,</font><font color="#000080">ARQ_CRIA</font><font color="#808080">))==</font><font color="#000080">NULL</font><font color="#808080">) {
    </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;%s --&gt; %s\n&quot;</font><font color="#808080">,</font><font color="#000080">MSG_ARQCERRO</font><font color="#808080">,</font><font color="#000080">ARQ_ENDERECO</font><font color="#808080">);
    </font><font color="#000080">exit</font><font color="#808080">(</font><font color="#FF0000">1</font><font color="#808080">);
  }
  </font><font color="#0000FF"><b>if </b></font><font color="#808080">((</font><font color="#000080">tfPais</font><font color="#808080">=</font><font color="#000080">fopen</font><font color="#808080">(</font><font color="#000080">ARQ_PAIS</font><font color="#808080">,</font><font color="#000080">ARQ_CRIA</font><font color="#808080">))==</font><font color="#000080">NULL</font><font color="#808080">) {
    </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;%s --&gt; %s\n&quot;</font><font color="#808080">,</font><font color="#000080">MSG_ARQCERRO</font><font color="#808080">,</font><font color="#000080">ARQ_PAIS</font><font color="#808080">);
    </font><font color="#000080">exit</font><font color="#808080">(</font><font color="#FF0000">1</font><font color="#808080">);
  }
  </font><font color="#0000FF"><b>if </b></font><font color="#808080">((</font><font color="#000080">tfProfissao</font><font color="#808080">=</font><font color="#000080">fopen</font><font color="#808080">(</font><font color="#000080">ARQ_PROFISSAO</font><font color="#808080">,</font><font color="#000080">ARQ_CRIA</font><font color="#808080">))==</font><font color="#000080">NULL</font><font color="#808080">) {
    </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;%s --&gt; %s\n&quot;</font><font color="#808080">,</font><font color="#000080">MSG_ARQCERRO</font><font color="#808080">,</font><font color="#000080">ARQ_PROFISSAO</font><font color="#808080">);
    </font><font color="#000080">exit</font><font color="#808080">(</font><font color="#FF0000">1</font><font color="#808080">);
  }
  </font><font color="#0000FF"><b>if </b></font><font color="#808080">((</font><font color="#000080">tfLivro</font><font color="#808080">=</font><font color="#000080">fopen</font><font color="#808080">(</font><font color="#000080">ARQ_LIVRO</font><font color="#808080">,</font><font color="#000080">ARQ_CRIA</font><font color="#808080">))==</font><font color="#000080">NULL</font><font color="#808080">) {
    </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;%s --&gt; %s\n&quot;</font><font color="#808080">,</font><font color="#000080">MSG_ARQCERRO</font><font color="#808080">,</font><font color="#000080">ARQ_LIVRO</font><font color="#808080">);
    </font><font color="#000080">exit</font><font color="#808080">(</font><font color="#FF0000">1</font><font color="#808080">);
  }
  </font><font color="#0000FF"><b>if </b></font><font color="#808080">((</font><font color="#000080">tfLivroAss</font><font color="#808080">=</font><font color="#000080">fopen</font><font color="#808080">(</font><font color="#000080">ARQ_LIVASS</font><font color="#808080">,</font><font color="#000080">ARQ_CRIA</font><font color="#808080">))==</font><font color="#000080">NULL</font><font color="#808080">) {
    </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;%s --&gt; %s\n&quot;</font><font color="#808080">,</font><font color="#000080">MSG_ARQCERRO</font><font color="#808080">,</font><font color="#000080">ARQ_LIVASS</font><font color="#808080">);
    </font><font color="#000080">exit</font><font color="#808080">(</font><font color="#FF0000">1</font><font color="#808080">);
  }
  </font><font color="#0000FF"><b>if </b></font><font color="#808080">((</font><font color="#000080">tfLivroAut</font><font color="#808080">=</font><font color="#000080">fopen</font><font color="#808080">(</font><font color="#000080">ARQ_LIVAUT</font><font color="#808080">,</font><font color="#000080">ARQ_CRIA</font><font color="#808080">))==</font><font color="#000080">NULL</font><font color="#808080">) {
    </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;%s --&gt; %s\n&quot;</font><font color="#808080">,</font><font color="#000080">MSG_ARQCERRO</font><font color="#808080">,</font><font color="#000080">ARQ_LIVAUT</font><font color="#808080">);
    </font><font color="#000080">exit</font><font color="#808080">(</font><font color="#FF0000">1</font><font color="#808080">);
  }
  </font><font color="#0000FF"><b>if </b></font><font color="#808080">((</font><font color="#000080">tfCliente</font><font color="#808080">=</font><font color="#000080">fopen</font><font color="#808080">(</font><font color="#000080">ARQ_CLIENTE</font><font color="#808080">,</font><font color="#000080">ARQ_CRIA</font><font color="#808080">))==</font><font color="#000080">NULL</font><font color="#808080">) {
    </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;%s --&gt; %s\n&quot;</font><font color="#808080">,</font><font color="#000080">MSG_ARQCERRO</font><font color="#808080">,</font><font color="#000080">ARQ_CLIENTE</font><font color="#808080">);
    </font><font color="#000080">exit</font><font color="#808080">(</font><font color="#FF0000">1</font><font color="#808080">);
  }
  </font><font color="#0000FF"><b>if </b></font><font color="#808080">((</font><font color="#000080">tfUsuario</font><font color="#808080">=</font><font color="#000080">fopen</font><font color="#808080">(</font><font color="#000080">ARQ_USUARIO</font><font color="#808080">,</font><font color="#000080">ARQ_CRIA</font><font color="#808080">))==</font><font color="#000080">NULL</font><font color="#808080">) {
    </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;%s --&gt; %s\n&quot;</font><font color="#808080">,</font><font color="#000080">MSG_ARQCERRO</font><font color="#808080">,</font><font color="#000080">ARQ_USUARIO</font><font color="#808080">);
    </font><font color="#000080">exit</font><font color="#808080">(</font><font color="#FF0000">1</font><font color="#808080">);
  }
  </font><font color="#0000FF"><b>if </b></font><font color="#808080">((</font><font color="#000080">tfVenda</font><font color="#808080">=</font><font color="#000080">fopen</font><font color="#808080">(</font><font color="#000080">ARQ_VENDA</font><font color="#808080">,</font><font color="#000080">ARQ_CRIA</font><font color="#808080">))==</font><font color="#000080">NULL</font><font color="#808080">) { 
    </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;%s --&gt; %s\n&quot;</font><font color="#808080">,</font><font color="#000080">MSG_ARQCERRO</font><font color="#808080">,</font><font color="#000080">ARQ_VENDA</font><font color="#808080">);
    </font><font color="#000080">exit</font><font color="#808080">(</font><font color="#FF0000">1</font><font color="#808080">);
  }
}
  </font><font color="#0000FF"><b>return </b></font><font color="#000080">self</font><font color="#808080">;
}
<i>/*------------------------------------------------------------------------------
Fecha todos os arquivos abertos.
------------------------------------------------------------------------------*/
</i>- </font><font color="#000080">fechaArqs
</font><font color="#808080">{
 </font><font color="#000080">fclose</font><font color="#808080">(</font><font color="#000080">tfAssunto</font><font color="#808080">);
 </font><font color="#000080">fclose</font><font color="#808080">(</font><font color="#000080">tfAutor</font><font color="#808080">);
 </font><font color="#000080">fclose</font><font color="#808080">(</font><font color="#000080">tfEditora</font><font color="#808080">);
 </font><font color="#000080">fclose</font><font color="#808080">(</font><font color="#000080">tfIdioma</font><font color="#808080">);
 </font><font color="#000080">fclose</font><font color="#808080">(</font><font color="#000080">tfEndereco</font><font color="#808080">);
 </font><font color="#000080">fclose</font><font color="#808080">(</font><font color="#000080">tfPais</font><font color="#808080">);
 </font><font color="#000080">fclose</font><font color="#808080">(</font><font color="#000080">tfProfissao</font><font color="#808080">);
 </font><font color="#000080">fclose</font><font color="#808080">(</font><font color="#000080">tfLivro</font><font color="#808080">);
 </font><font color="#000080">fclose</font><font color="#808080">(</font><font color="#000080">tfLivroAss</font><font color="#808080">);
 </font><font color="#000080">fclose</font><font color="#808080">(</font><font color="#000080">tfLivroAut</font><font color="#808080">);
 </font><font color="#000080">fclose</font><font color="#808080">(</font><font color="#000080">tfCliente</font><font color="#808080">);
 </font><font color="#000080">fclose</font><font color="#808080">(</font><font color="#000080">tfUsuario</font><font color="#808080">);
 </font><font color="#000080">fclose</font><font color="#808080">(</font><font color="#000080">tfVenda</font><font color="#808080">);
 
 </font><font color="#0000FF"><b>return </b></font><font color="#000080">self</font><font color="#808080">;
}
<i>/*------------------------------------------------------------------------------
Pesquisa um registro atrav&eacute;s de um valor chave num arquivo.
sArq - o arquivo
sChave - a chave a ser pesquisada
nPosChave - a posicao inicial da chave dentro do registro
nTamChave - o tamanho da chave dentro do registro
nTamLinha - o tamanho do registro
retorna - o registro pesquisado
------------------------------------------------------------------------------*/
</i>- (</font><font color="#000080">STR</font><font color="#808080">) </font><font color="#000080">pesqArq</font><font color="#808080">: (</font><font color="#000080">FILE</font><font color="#808080">*) </font><font color="#000080">sArq</font><font color="#808080">, ...
{ 
  </font><font color="#000080">STR sChave</font><font color="#808080">, </font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#000080">sres</font><font color="#808080">;
  </font><font color="#000080">BOOL bQuebra</font><font color="#808080">;
  </font><font color="#0000FF"><b>int </b></font><font color="#000080">nPosChave</font><font color="#808080">, </font><font color="#000080">nTamChave</font><font color="#808080">, </font><font color="#000080">nTamLinha</font><font color="#808080">, </font><font color="#000080">nPosicao</font><font color="#808080">;

</font><font color="#000080">va_list lparams</font><font color="#808080">;
</font><font color="#000080">va_start</font><font color="#808080">(</font><font color="#000080">lparams</font><font color="#808080">, </font><font color="#000080">sArq</font><font color="#808080">);
</font><font color="#000080">sChave </font><font color="#808080">= </font><font color="#000080">va_arg</font><font color="#808080">(</font><font color="#000080">lparams</font><font color="#808080">,</font><font color="#000080">STR</font><font color="#808080">);
</font><font color="#000080">nPosChave </font><font color="#808080">= </font><font color="#000080">va_arg</font><font color="#808080">(</font><font color="#000080">lparams</font><font color="#808080">,</font><font color="#0000FF"><b>int</b></font><font color="#808080">);
</font><font color="#000080">nTamChave </font><font color="#808080">= </font><font color="#000080">va_arg</font><font color="#808080">(</font><font color="#000080">lparams</font><font color="#808080">,</font><font color="#0000FF"><b>int</b></font><font color="#808080">);
</font><font color="#000080">nTamLinha </font><font color="#808080">= </font><font color="#000080">va_arg</font><font color="#808080">(</font><font color="#000080">lparams</font><font color="#808080">,</font><font color="#0000FF"><b>int</b></font><font color="#808080">);
</font><font color="#000080">va_end</font><font color="#808080">(</font><font color="#000080">lparams</font><font color="#808080">);

</font><font color="#000080">slinha </font><font color="#808080">= [</font><font color="#000080">self alocaString</font><font color="#808080">: </font><font color="#000080">TAM_MAX_STR</font><font color="#808080">];

</font><font color="#000080">bQuebra </font><font color="#808080">= </font><font color="#000080">NO</font><font color="#808080">;
</font><font color="#000080">fseek</font><font color="#808080">(</font><font color="#000080">sArq</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#000080">SEEK_SET</font><font color="#808080">);
</font><font color="#0000FF"><b>while </b></font><font color="#808080">((!</font><font color="#000080">feof</font><font color="#808080">(</font><font color="#000080">sArq</font><font color="#808080">)) &amp;&amp; (</font><font color="#000080">bQuebra</font><font color="#808080">==</font><font color="#000080">NO</font><font color="#808080">)) {
  </font><font color="#000080">fread</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,(</font><font color="#000080">nTamLinha </font><font color="#808080">+ </font><font color="#000080">TAM_CRLF</font><font color="#808080">),</font><font color="#000080">sArq</font><font color="#808080">);
  </font><font color="#000080">sres </font><font color="#808080">= [</font><font color="#000080">self trim</font><font color="#808080">: [</font><font color="#000080">self copy</font><font color="#808080">: </font><font color="#000080">slinha</font><font color="#808080">,</font><font color="#000080">nPosChave</font><font color="#808080">,</font><font color="#000080">nTamChave</font><font color="#808080">]];
  </font><font color="#0000FF"><b>if </b></font><font color="#808080">(</font><font color="#000080">strcmp</font><font color="#808080">(</font><font color="#000080">sres</font><font color="#808080">, </font><font color="#000080">sChave</font><font color="#808080">)==</font><font color="#FF0000">0</font><font color="#808080">)
     </font><font color="#000080">bQuebra </font><font color="#808080">= </font><font color="#000080">YES</font><font color="#808080">;
}
</font><font color="#000080">nPosicao </font><font color="#808080">= </font><font color="#000080">ftell</font><font color="#808080">(</font><font color="#000080">sArq</font><font color="#808080">)-(</font><font color="#000080">nTamLinha </font><font color="#808080">+ </font><font color="#000080">TAM_CRLF</font><font color="#808080">);
</font><font color="#0000FF"><b>if </b></font><font color="#808080">(</font><font color="#000080">nPosicao </font><font color="#808080">&gt; </font><font color="#FF0000">0</font><font color="#808080">)
   </font><font color="#000080">fseek</font><font color="#808080">(</font><font color="#000080">sArq</font><font color="#808080">, </font><font color="#000080">nPosicao</font><font color="#808080">, </font><font color="#000080">SEEK_SET</font><font color="#808080">);
</font><font color="#0000FF"><b>else
   </b></font><font color="#000080">fseek</font><font color="#808080">(</font><font color="#000080">sArq</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#000080">SEEK_SET</font><font color="#808080">);
</font><font color="#0000FF"><b>if </b></font><font color="#808080">(</font><font color="#000080">strcmp</font><font color="#808080">(</font><font color="#000080">sres</font><font color="#808080">, </font><font color="#000080">sChave</font><font color="#808080">)!=</font><font color="#FF0000">0</font><font color="#808080">) 
   </font><font color="#0000FF"><b>return </b></font><font color="#800000">&quot;&quot;</font><font color="#808080">;
</font><font color="#0000FF"><b>else </b></font><font color="#808080">{
   </font><font color="#000080">sres </font><font color="#808080">= [</font><font color="#000080">self copy</font><font color="#808080">: </font><font color="#000080">slinha</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#000080">nTamLinha</font><font color="#808080">];
   </font><font color="#0000FF"><b>return </b></font><font color="#000080">sres</font><font color="#808080">;
}
}
<i>/*------------------------------------------------------------------------------
Pesquisa se tem linha exclu&iacute;da sen&atilde;o vai para a &uacute;ltima linha do arquivo.
sArq - o arquivo
nTamLinha - o tamanho do registro
------------------------------------------------------------------------------*/
</i>- </font><font color="#000080">pesqLinhaExcluida</font><font color="#808080">: (</font><font color="#000080">FILE</font><font color="#808080">*) </font><font color="#000080">sArq</font><font color="#808080">, ...
{ 
  </font><font color="#0000FF"><b>int </b></font><font color="#000080">nTamLinha</font><font color="#808080">;
  </font><font color="#000080">STR sExcluido</font><font color="#808080">;
 
</font><font color="#000080">va_list lparams</font><font color="#808080">;
</font><font color="#000080">va_start</font><font color="#808080">(</font><font color="#000080">lparams</font><font color="#808080">, </font><font color="#000080">sArq</font><font color="#808080">);
</font><font color="#000080">nTamLinha </font><font color="#808080">= </font><font color="#000080">va_arg</font><font color="#808080">(</font><font color="#000080">lparams</font><font color="#808080">,</font><font color="#0000FF"><b>int</b></font><font color="#808080">);
</font><font color="#000080">va_end</font><font color="#808080">(</font><font color="#000080">lparams</font><font color="#808080">);

</font><font color="#000080">sExcluido </font><font color="#808080">= [</font><font color="#000080">self pesqArq</font><font color="#808080">: </font><font color="#000080">sArq</font><font color="#808080">, </font><font color="#800000">&quot;*&quot;</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#000080">nTamLinha</font><font color="#808080">];
</font><font color="#0000FF"><b>if </b></font><font color="#808080">(</font><font color="#000080">strcmp</font><font color="#808080">(</font><font color="#000080">sExcluido</font><font color="#808080">,</font><font color="#800000">&quot;&quot;</font><font color="#808080">)==</font><font color="#FF0000">0</font><font color="#808080">)
   </font><font color="#000080">fseek</font><font color="#808080">(</font><font color="#000080">sArq</font><font color="#808080">, [</font><font color="#000080">self tamArq</font><font color="#808080">: </font><font color="#000080">sArq</font><font color="#808080">], </font><font color="#000080">SEEK_SET</font><font color="#808080">);
 
</font><font color="#0000FF"><b>return </b></font><font color="#000080">self</font><font color="#808080">;
}
<i>/*------------------------------------------------------------------------------
Pesquisa o maior c&oacute;digo num arquivo.
sArq - o arquivo
nPosChave - a posicao inicial da chave dentro do registro
nTamChave - o tamanho da chave dentro do registro
nTamLinha - o tamanho do registro
retorna - o maior c&oacute;digo
------------------------------------------------------------------------------*/
</i>- (</font><font color="#000080">STR</font><font color="#808080">) </font><font color="#000080">pesqMaxCod</font><font color="#808080">: (</font><font color="#000080">FILE</font><font color="#808080">*) </font><font color="#000080">sArq</font><font color="#808080">, ...
{ 
  </font><font color="#000080">STR slinha</font><font color="#808080">, </font><font color="#000080">sres</font><font color="#808080">;
  </font><font color="#000080">BOOL bQuebra</font><font color="#808080">;
  </font><font color="#0000FF"><b>int </b></font><font color="#000080">nPosChave</font><font color="#808080">, </font><font color="#000080">nTamChave</font><font color="#808080">, </font><font color="#000080">nTamLinha</font><font color="#808080">, </font><font color="#000080">nMaior</font><font color="#808080">, </font><font color="#000080">nCod</font><font color="#808080">;

</font><font color="#000080">va_list lparams</font><font color="#808080">;
</font><font color="#000080">va_start</font><font color="#808080">(</font><font color="#000080">lparams</font><font color="#808080">, </font><font color="#000080">sArq</font><font color="#808080">);
</font><font color="#000080">nPosChave </font><font color="#808080">= </font><font color="#000080">va_arg</font><font color="#808080">(</font><font color="#000080">lparams</font><font color="#808080">,</font><font color="#0000FF"><b>int</b></font><font color="#808080">);
</font><font color="#000080">nTamChave </font><font color="#808080">= </font><font color="#000080">va_arg</font><font color="#808080">(</font><font color="#000080">lparams</font><font color="#808080">,</font><font color="#0000FF"><b>int</b></font><font color="#808080">);
</font><font color="#000080">nTamLinha </font><font color="#808080">= </font><font color="#000080">va_arg</font><font color="#808080">(</font><font color="#000080">lparams</font><font color="#808080">,</font><font color="#0000FF"><b>int</b></font><font color="#808080">);
</font><font color="#000080">va_end</font><font color="#808080">(</font><font color="#000080">lparams</font><font color="#808080">);

</font><font color="#000080">slinha </font><font color="#808080">= [</font><font color="#000080">self alocaString</font><font color="#808080">: </font><font color="#000080">TAM_MAX_STR</font><font color="#808080">];
</font><font color="#000080">bQuebra </font><font color="#808080">= </font><font color="#000080">NO</font><font color="#808080">;
</font><font color="#000080">nMaior </font><font color="#808080">= </font><font color="#FF0000">0</font><font color="#808080">;
</font><font color="#000080">fseek</font><font color="#808080">(</font><font color="#000080">sArq</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#000080">SEEK_SET</font><font color="#808080">);
</font><font color="#0000FF"><b>while </b></font><font color="#808080">((!</font><font color="#000080">feof</font><font color="#808080">(</font><font color="#000080">sArq</font><font color="#808080">)) &amp;&amp; (</font><font color="#000080">bQuebra</font><font color="#808080">==</font><font color="#000080">NO</font><font color="#808080">)) {
  </font><font color="#000080">fread</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,(</font><font color="#000080">nTamLinha </font><font color="#808080">+ </font><font color="#000080">TAM_CRLF</font><font color="#808080">),</font><font color="#000080">sArq</font><font color="#808080">);
  </font><font color="#000080">sres </font><font color="#808080">= [</font><font color="#000080">self trim</font><font color="#808080">: [</font><font color="#000080">self copy</font><font color="#808080">: </font><font color="#000080">slinha</font><font color="#808080">,</font><font color="#000080">nPosChave</font><font color="#808080">,</font><font color="#000080">nTamChave</font><font color="#808080">]];
  </font><font color="#000080">nCod</font><font color="#808080">=</font><font color="#000080">atoi</font><font color="#808080">(</font><font color="#000080">sres</font><font color="#808080">);
  </font><font color="#0000FF"><b>if </b></font><font color="#808080">(</font><font color="#000080">nCod </font><font color="#808080">&gt; </font><font color="#000080">nMaior</font><font color="#808080">)
     </font><font color="#000080">nMaior </font><font color="#808080">= </font><font color="#000080">nCod</font><font color="#808080">;
}
[</font><font color="#000080">self pesqLinhaExcluida</font><font color="#808080">: </font><font color="#000080">sArq</font><font color="#808080">, </font><font color="#000080">nTamLinha</font><font color="#808080">];
</font><font color="#000080">sres </font><font color="#808080">= [</font><font color="#000080">self itoa</font><font color="#808080">: (</font><font color="#000080">nMaior</font><font color="#808080">+</font><font color="#FF0000">1</font><font color="#808080">),</font><font color="#000080">sres</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">];
</font><font color="#000080">free</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">);
</font><font color="#0000FF"><b>return </b></font><font color="#000080">sres</font><font color="#808080">;
}
<i>/*------------------------------------------------------------------------------
Grava os registros num determinado arquivo.
sArq - o arquivo
sTexto - o registro a ser gravado
sMsgAcerto - a mensagem caso o registro foi gravado
sMsgErro - a mensagem caso o registro n&atilde;o foi gravado
------------------------------------------------------------------------------*/
</i>- </font><font color="#000080">escreveArq</font><font color="#808080">: (</font><font color="#000080">FILE</font><font color="#808080">*) </font><font color="#000080">sArq</font><font color="#808080">, ...
{ 
  </font><font color="#000080">STR sTexto</font><font color="#808080">, </font><font color="#000080">sMsgAcerto</font><font color="#808080">, </font><font color="#000080">sMsgErro</font><font color="#808080">;
  </font><font color="#0000FF"><b>int </b></font><font color="#000080">ntam</font><font color="#808080">;

</font><font color="#000080">va_list lparams</font><font color="#808080">;
</font><font color="#000080">va_start</font><font color="#808080">(</font><font color="#000080">lparams</font><font color="#808080">, </font><font color="#000080">sArq</font><font color="#808080">);
</font><font color="#000080">sTexto </font><font color="#808080">= </font><font color="#000080">va_arg</font><font color="#808080">(</font><font color="#000080">lparams</font><font color="#808080">,</font><font color="#000080">STR</font><font color="#808080">);
</font><font color="#000080">sMsgAcerto </font><font color="#808080">= </font><font color="#000080">va_arg</font><font color="#808080">(</font><font color="#000080">lparams</font><font color="#808080">,</font><font color="#000080">STR</font><font color="#808080">);
</font><font color="#000080">sMsgErro </font><font color="#808080">= </font><font color="#000080">va_arg</font><font color="#808080">(</font><font color="#000080">lparams</font><font color="#808080">,</font><font color="#000080">STR</font><font color="#808080">);
</font><font color="#000080">va_end</font><font color="#808080">(</font><font color="#000080">lparams</font><font color="#808080">);

</font><font color="#000080">strcpy</font><font color="#808080">(</font><font color="#000080">sTexto</font><font color="#808080">, (</font><font color="#000080">STR</font><font color="#808080">) </font><font color="#000080">strcat</font><font color="#808080">(</font><font color="#000080">sTexto</font><font color="#808080">,</font><font color="#000080">CRLF</font><font color="#808080">));
</font><font color="#000080">ntam </font><font color="#808080">= </font><font color="#000080">strlen</font><font color="#808080">(</font><font color="#000080">sTexto</font><font color="#808080">);
</font><font color="#0000FF"><b>if </b></font><font color="#808080">(</font><font color="#000080">fwrite</font><font color="#808080">(</font><font color="#000080">sTexto</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#000080">ntam</font><font color="#808080">, </font><font color="#000080">sArq</font><font color="#808080">) == </font><font color="#000080">ntam</font><font color="#808080">)
   </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;%s\n&quot;</font><font color="#808080">,</font><font color="#000080">sMsgAcerto</font><font color="#808080">);
</font><font color="#0000FF"><b>else 
   </b></font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;%s\n&quot;</font><font color="#808080">,</font><font color="#000080">sMsgErro</font><font color="#808080">);

</font><font color="#0000FF"><b>return </b></font><font color="#000080">self</font><font color="#808080">;
}
<i>/*------------------------------------------------------------------------------
Monta o tamanho do registro no arquivo de acordo com o tipo de arquivo.
sreg - o tipo de arquivo
retorna - o registro montado
------------------------------------------------------------------------------*/
</i>- (</font><font color="#000080">STR</font><font color="#808080">) </font><font color="#000080">LinhaReg</font><font color="#808080">: (</font><font color="#0000FF"><b>enum </b></font><font color="#000080">ctArqs</font><font color="#808080">) </font><font color="#000080">sreg
</font><font color="#808080">{ 
  </font><font color="#000080">STR slinha</font><font color="#808080">;

</font><font color="#0000FF"><b>if </b></font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">==</font><font color="#000080">opAssunto</font><font color="#808080">) {
   </font><font color="#000080">slinha </font><font color="#808080">= [</font><font color="#000080">self somastr</font><font color="#808080">: </font><font color="#FF0000">2</font><font color="#808080">,[</font><font color="#000080">self esp</font><font color="#808080">: </font><font color="#000080">tAssunto</font><font color="#808080">.</font><font color="#000080">codigo</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">],
            [</font><font color="#000080">self esp</font><font color="#808080">: </font><font color="#000080">tAssunto</font><font color="#808080">.</font><font color="#000080">assunto</font><font color="#808080">,</font><font color="#FF0000">30</font><font color="#808080">]];
} </font><font color="#0000FF"><b>else if </b></font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">==</font><font color="#000080">opAutor</font><font color="#808080">)
   </font><font color="#000080">slinha </font><font color="#808080">= [</font><font color="#000080">self somastr</font><font color="#808080">: </font><font color="#FF0000">2</font><font color="#808080">,[</font><font color="#000080">self esp</font><font color="#808080">: </font><font color="#000080">tAutor</font><font color="#808080">.</font><font color="#000080">codigo</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">],
            [</font><font color="#000080">self esp</font><font color="#808080">: </font><font color="#000080">tAutor</font><font color="#808080">.</font><font color="#000080">autor</font><font color="#808080">,</font><font color="#FF0000">30</font><font color="#808080">]];
</font><font color="#0000FF"><b>else if </b></font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">==</font><font color="#000080">opEditora</font><font color="#808080">)
   </font><font color="#000080">slinha </font><font color="#808080">= [</font><font color="#000080">self somastr</font><font color="#808080">: </font><font color="#FF0000">2</font><font color="#808080">,[</font><font color="#000080">self esp</font><font color="#808080">: </font><font color="#000080">tEditora</font><font color="#808080">.</font><font color="#000080">codigo</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">],
            [</font><font color="#000080">self esp</font><font color="#808080">: </font><font color="#000080">tEditora</font><font color="#808080">.</font><font color="#000080">editora</font><font color="#808080">,</font><font color="#FF0000">50</font><font color="#808080">]];
</font><font color="#0000FF"><b>else if </b></font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">==</font><font color="#000080">opEndereco</font><font color="#808080">)
   </font><font color="#000080">slinha </font><font color="#808080">= [</font><font color="#000080">self somastr</font><font color="#808080">: </font><font color="#FF0000">6</font><font color="#808080">,[</font><font color="#000080">self esp</font><font color="#808080">: </font><font color="#000080">tEndereco</font><font color="#808080">.</font><font color="#000080">codigo</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">],
   [</font><font color="#000080">self esp</font><font color="#808080">: </font><font color="#000080">tEndereco</font><font color="#808080">.</font><font color="#000080">logradouro</font><font color="#808080">,</font><font color="#FF0000">40</font><font color="#808080">], [</font><font color="#000080">self esp</font><font color="#808080">: </font><font color="#000080">tEndereco</font><font color="#808080">.</font><font color="#000080">bairro</font><font color="#808080">,</font><font color="#FF0000">15</font><font color="#808080">],
   [</font><font color="#000080">self esp</font><font color="#808080">: </font><font color="#000080">tEndereco</font><font color="#808080">.</font><font color="#000080">cep</font><font color="#808080">,</font><font color="#FF0000">8</font><font color="#808080">],[</font><font color="#000080">self esp</font><font color="#808080">: </font><font color="#000080">tEndereco</font><font color="#808080">.</font><font color="#000080">cidade</font><font color="#808080">,</font><font color="#FF0000">30</font><font color="#808080">],
   [</font><font color="#000080">self esp</font><font color="#808080">: </font><font color="#000080">tEndereco</font><font color="#808080">.</font><font color="#000080">estado</font><font color="#808080">,</font><font color="#FF0000">20</font><font color="#808080">]];
</font><font color="#0000FF"><b>else if </b></font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">==</font><font color="#000080">opIdioma</font><font color="#808080">)
   </font><font color="#000080">slinha </font><font color="#808080">= [</font><font color="#000080">self somastr</font><font color="#808080">: </font><font color="#FF0000">2</font><font color="#808080">,[</font><font color="#000080">self esp</font><font color="#808080">: </font><font color="#000080">tIdioma</font><font color="#808080">.</font><font color="#000080">codigo</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">],
            [</font><font color="#000080">self esp</font><font color="#808080">: </font><font color="#000080">tIdioma</font><font color="#808080">.</font><font color="#000080">idioma</font><font color="#808080">,</font><font color="#FF0000">20</font><font color="#808080">]];
</font><font color="#0000FF"><b>else if </b></font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">==</font><font color="#000080">opPais</font><font color="#808080">)
   </font><font color="#000080">slinha </font><font color="#808080">= [</font><font color="#000080">self somastr</font><font color="#808080">: </font><font color="#FF0000">2</font><font color="#808080">,[</font><font color="#000080">self esp</font><font color="#808080">: </font><font color="#000080">tPais</font><font color="#808080">.</font><font color="#000080">codigo</font><font color="#808080">,</font><font color="#FF0000">3</font><font color="#808080">],
            [</font><font color="#000080">self esp</font><font color="#808080">: </font><font color="#000080">tPais</font><font color="#808080">.</font><font color="#000080">pais</font><font color="#808080">,</font><font color="#FF0000">50</font><font color="#808080">]];
</font><font color="#0000FF"><b>else if </b></font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">==</font><font color="#000080">opProfissao</font><font color="#808080">)
   </font><font color="#000080">slinha </font><font color="#808080">= [</font><font color="#000080">self somastr</font><font color="#808080">: </font><font color="#FF0000">2</font><font color="#808080">,[</font><font color="#000080">self esp</font><font color="#808080">: </font><font color="#000080">tProfissao</font><font color="#808080">.</font><font color="#000080">codigo</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">],
            [</font><font color="#000080">self esp</font><font color="#808080">: </font><font color="#000080">tProfissao</font><font color="#808080">.</font><font color="#000080">profissao</font><font color="#808080">,</font><font color="#FF0000">50</font><font color="#808080">]];
</font><font color="#0000FF"><b>else if </b></font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">==</font><font color="#000080">opUsuario</font><font color="#808080">)
   </font><font color="#000080">slinha </font><font color="#808080">= [</font><font color="#000080">self somastr</font><font color="#808080">: </font><font color="#FF0000">2</font><font color="#808080">,[</font><font color="#000080">self esp</font><font color="#808080">: </font><font color="#000080">tUsuario</font><font color="#808080">.</font><font color="#000080">login</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">],
            [</font><font color="#000080">self esp</font><font color="#808080">: </font><font color="#000080">tUsuario</font><font color="#808080">.</font><font color="#000080">senha</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">]];
</font><font color="#0000FF"><b>else if </b></font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">==</font><font color="#000080">opLivro</font><font color="#808080">)
   </font><font color="#000080">slinha </font><font color="#808080">= [</font><font color="#000080">self somastr</font><font color="#808080">: </font><font color="#FF0000">10</font><font color="#808080">,[</font><font color="#000080">self esp</font><font color="#808080">: </font><font color="#000080">tLivro</font><font color="#808080">.</font><font color="#000080">isbn</font><font color="#808080">,</font><font color="#FF0000">13</font><font color="#808080">],
   [</font><font color="#000080">self esp</font><font color="#808080">: </font><font color="#000080">tLivro</font><font color="#808080">.</font><font color="#000080">titulo</font><font color="#808080">,</font><font color="#FF0000">50</font><font color="#808080">], [</font><font color="#000080">self esp</font><font color="#808080">: </font><font color="#000080">tLivro</font><font color="#808080">.</font><font color="#000080">edicao</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">],
   [</font><font color="#000080">self esp</font><font color="#808080">: </font><font color="#000080">tLivro</font><font color="#808080">.</font><font color="#000080">anopubli</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">],[</font><font color="#000080">self esp</font><font color="#808080">: </font><font color="#000080">tLivro</font><font color="#808080">.</font><font color="#000080">codeditora</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">],
   [</font><font color="#000080">self esp</font><font color="#808080">: </font><font color="#000080">tLivro</font><font color="#808080">.</font><font color="#000080">volume</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">],[</font><font color="#000080">self esp</font><font color="#808080">: </font><font color="#000080">tLivro</font><font color="#808080">.</font><font color="#000080">codidioma</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">],
   [</font><font color="#000080">self esp</font><font color="#808080">: </font><font color="#000080">tLivro</font><font color="#808080">.</font><font color="#000080">npaginas</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">], [</font><font color="#000080">self esp</font><font color="#808080">: </font><font color="#000080">tLivro</font><font color="#808080">.</font><font color="#000080">preco</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">],
   [</font><font color="#000080">self esp</font><font color="#808080">: </font><font color="#000080">tLivro</font><font color="#808080">.</font><font color="#000080">qtdestoque</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">]];
</font><font color="#0000FF"><b>else if </b></font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">==</font><font color="#000080">opLivroAss</font><font color="#808080">)
   </font><font color="#000080">slinha </font><font color="#808080">= [</font><font color="#000080">self somastr</font><font color="#808080">: </font><font color="#FF0000">2</font><font color="#808080">,[</font><font color="#000080">self esp</font><font color="#808080">: </font><font color="#000080">tLivroAss</font><font color="#808080">.</font><font color="#000080">isbn</font><font color="#808080">,</font><font color="#FF0000">13</font><font color="#808080">],
            [</font><font color="#000080">self esp</font><font color="#808080">: </font><font color="#000080">tLivroAss</font><font color="#808080">.</font><font color="#000080">codassunto</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">]];
</font><font color="#0000FF"><b>else if </b></font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">==</font><font color="#000080">opLivroAut</font><font color="#808080">)
   </font><font color="#000080">slinha </font><font color="#808080">= [</font><font color="#000080">self somastr</font><font color="#808080">: </font><font color="#FF0000">2</font><font color="#808080">,[</font><font color="#000080">self esp</font><font color="#808080">: </font><font color="#000080">tLivroAut</font><font color="#808080">.</font><font color="#000080">isbn</font><font color="#808080">,</font><font color="#FF0000">13</font><font color="#808080">],
            [</font><font color="#000080">self esp</font><font color="#808080">: </font><font color="#000080">tLivroAut</font><font color="#808080">.</font><font color="#000080">codautor</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">]];
</font><font color="#0000FF"><b>else if </b></font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">==</font><font color="#000080">opCliente</font><font color="#808080">)
   </font><font color="#000080">slinha </font><font color="#808080">= [</font><font color="#000080">self somastr</font><font color="#808080">: </font><font color="#FF0000">10</font><font color="#808080">,[</font><font color="#000080">self esp</font><font color="#808080">: </font><font color="#000080">tCliente</font><font color="#808080">.</font><font color="#000080">cpf</font><font color="#808080">,</font><font color="#FF0000">14</font><font color="#808080">],
   [</font><font color="#000080">self esp</font><font color="#808080">: </font><font color="#000080">tCliente</font><font color="#808080">.</font><font color="#000080">nome</font><font color="#808080">,</font><font color="#FF0000">30</font><font color="#808080">], [</font><font color="#000080">self esp</font><font color="#808080">: </font><font color="#000080">tCliente</font><font color="#808080">.</font><font color="#000080">email</font><font color="#808080">,</font><font color="#FF0000">30</font><font color="#808080">],
   [</font><font color="#000080">self esp</font><font color="#808080">: </font><font color="#000080">tCliente</font><font color="#808080">.</font><font color="#000080">identidade</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">],[</font><font color="#000080">self esp</font><font color="#808080">: </font><font color="#000080">tCliente</font><font color="#808080">.</font><font color="#000080">sexo</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">],
   [</font><font color="#000080">self esp</font><font color="#808080">: </font><font color="#000080">tCliente</font><font color="#808080">.</font><font color="#000080">telefone</font><font color="#808080">,</font><font color="#FF0000">17</font><font color="#808080">],[</font><font color="#000080">self esp</font><font color="#808080">: </font><font color="#000080">tCliente</font><font color="#808080">.</font><font color="#000080">dtnascimento</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">],
   [</font><font color="#000080">self esp</font><font color="#808080">: </font><font color="#000080">tCliente</font><font color="#808080">.</font><font color="#000080">codendereco</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">],[</font><font color="#000080">self esp</font><font color="#808080">: </font><font color="#000080">tCliente</font><font color="#808080">.</font><font color="#000080">codpais</font><font color="#808080">,</font><font color="#FF0000">3</font><font color="#808080">],
   [</font><font color="#000080">self esp</font><font color="#808080">: </font><font color="#000080">tCliente</font><font color="#808080">.</font><font color="#000080">codprofissao</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">]];
</font><font color="#0000FF"><b>else if </b></font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">==</font><font color="#000080">opVenda</font><font color="#808080">)
   </font><font color="#000080">slinha </font><font color="#808080">= [</font><font color="#000080">self somastr</font><font color="#808080">: </font><font color="#FF0000">4</font><font color="#808080">,[</font><font color="#000080">self esp</font><font color="#808080">: </font><font color="#000080">tVenda</font><font color="#808080">.</font><font color="#000080">dthrvenda</font><font color="#808080">,</font><font color="#FF0000">19</font><font color="#808080">],
   [</font><font color="#000080">self esp</font><font color="#808080">: </font><font color="#000080">tVenda</font><font color="#808080">.</font><font color="#000080">cpf</font><font color="#808080">,</font><font color="#FF0000">14</font><font color="#808080">], [</font><font color="#000080">self esp</font><font color="#808080">: </font><font color="#000080">tVenda</font><font color="#808080">.</font><font color="#000080">isbn</font><font color="#808080">,</font><font color="#FF0000">13</font><font color="#808080">],
   [</font><font color="#000080">self esp</font><font color="#808080">: </font><font color="#000080">tVenda</font><font color="#808080">.</font><font color="#000080">precovenda</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">]];

</font><font color="#0000FF"><b>return </b></font><font color="#000080">slinha</font><font color="#808080">;
}
<i>/*------------------------------------------------------------------------------
Retorna o tamanho do registro no arquivo de acordo com o tipo de arquivo.
sreg - o tipo de arquivo
retorna - o tamanho do registro
------------------------------------------------------------------------------*/
</i>- (</font><font color="#0000FF"><b>int</b></font><font color="#808080">) </font><font color="#000080">tamReg</font><font color="#808080">: (</font><font color="#0000FF"><b>enum </b></font><font color="#000080">ctArqs</font><font color="#808080">) </font><font color="#000080">sreg
</font><font color="#808080">{ 
  </font><font color="#0000FF"><b>int </b></font><font color="#000080">nret </font><font color="#808080">= </font><font color="#FF0000">0</font><font color="#808080">;

</font><font color="#0000FF"><b>if </b></font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">==</font><font color="#000080">opAssunto</font><font color="#808080">) </font><font color="#000080">nret </font><font color="#808080">= </font><font color="#000080">TAM_ASSUNTO</font><font color="#808080">;
</font><font color="#0000FF"><b>else if </b></font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">==</font><font color="#000080">opAutor</font><font color="#808080">) </font><font color="#000080">nret </font><font color="#808080">= </font><font color="#000080">TAM_AUTOR</font><font color="#808080">;
</font><font color="#0000FF"><b>else if </b></font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">==</font><font color="#000080">opEditora</font><font color="#808080">) </font><font color="#000080">nret </font><font color="#808080">= </font><font color="#000080">TAM_EDITORA</font><font color="#808080">;
</font><font color="#0000FF"><b>else if </b></font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">==</font><font color="#000080">opEndereco</font><font color="#808080">) </font><font color="#000080">nret </font><font color="#808080">= </font><font color="#000080">TAM_ENDERECO</font><font color="#808080">;
</font><font color="#0000FF"><b>else if </b></font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">==</font><font color="#000080">opIdioma</font><font color="#808080">) </font><font color="#000080">nret </font><font color="#808080">= </font><font color="#000080">TAM_IDIOMA</font><font color="#808080">;
</font><font color="#0000FF"><b>else if </b></font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">==</font><font color="#000080">opPais</font><font color="#808080">) </font><font color="#000080">nret </font><font color="#808080">= </font><font color="#000080">TAM_PAIS</font><font color="#808080">;
</font><font color="#0000FF"><b>else if </b></font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">==</font><font color="#000080">opProfissao</font><font color="#808080">) </font><font color="#000080">nret </font><font color="#808080">= </font><font color="#000080">TAM_PROFISSAO</font><font color="#808080">;
</font><font color="#0000FF"><b>else if </b></font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">==</font><font color="#000080">opUsuario</font><font color="#808080">) </font><font color="#000080">nret </font><font color="#808080">= </font><font color="#000080">TAM_USUARIO</font><font color="#808080">;
</font><font color="#0000FF"><b>else if </b></font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">==</font><font color="#000080">opLivro</font><font color="#808080">) </font><font color="#000080">nret </font><font color="#808080">= </font><font color="#000080">TAM_LIVRO</font><font color="#808080">;
</font><font color="#0000FF"><b>else if </b></font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">==</font><font color="#000080">opLivroAss</font><font color="#808080">) </font><font color="#000080">nret </font><font color="#808080">= </font><font color="#000080">TAM_LIVASS</font><font color="#808080">;
</font><font color="#0000FF"><b>else if </b></font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">==</font><font color="#000080">opLivroAut</font><font color="#808080">) </font><font color="#000080">nret </font><font color="#808080">= </font><font color="#000080">TAM_LIVAUT</font><font color="#808080">;
</font><font color="#0000FF"><b>else if </b></font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">==</font><font color="#000080">opCliente</font><font color="#808080">) </font><font color="#000080">nret </font><font color="#808080">= </font><font color="#000080">TAM_CLIENTE</font><font color="#808080">;
</font><font color="#0000FF"><b>else if </b></font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">==</font><font color="#000080">opVenda</font><font color="#808080">) </font><font color="#000080">nret </font><font color="#808080">= </font><font color="#000080">TAM_VENDA</font><font color="#808080">;

</font><font color="#0000FF"><b>return </b></font><font color="#000080">nret</font><font color="#808080">;
}
<i>/*------------------------------------------------------------------------------
Seleciona o rotulo de cada campo de acordo com o tipo de arquivo.
sreg - o tipo de arquivo
nNum - indica qual rotulo ser&aacute; retornado
retorna - o rotulo
------------------------------------------------------------------------------*/
</i>- (</font><font color="#000080">STR</font><font color="#808080">) </font><font color="#000080">rotulo</font><font color="#808080">: (</font><font color="#0000FF"><b>enum </b></font><font color="#000080">ctArqs</font><font color="#808080">) </font><font color="#000080">sreg</font><font color="#808080">, ...
{  
  </font><font color="#000080">STR sret</font><font color="#808080">; 
  </font><font color="#0000FF"><b>int </b></font><font color="#000080">nNum</font><font color="#808080">;

</font><font color="#000080">va_list lparams</font><font color="#808080">;
</font><font color="#000080">va_start</font><font color="#808080">(</font><font color="#000080">lparams</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">);
</font><font color="#000080">nNum </font><font color="#808080">= </font><font color="#000080">va_arg</font><font color="#808080">(</font><font color="#000080">lparams</font><font color="#808080">,</font><font color="#0000FF"><b>int</b></font><font color="#808080">);
</font><font color="#000080">va_end</font><font color="#808080">(</font><font color="#000080">lparams</font><font color="#808080">);

</font><font color="#000080">sret </font><font color="#808080">= [</font><font color="#000080">self alocaString</font><font color="#808080">: </font><font color="#000080">TAM_MAX_STR</font><font color="#808080">];

</font><font color="#0000FF"><b>if </b></font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">==</font><font color="#000080">opAssunto</font><font color="#808080">) {
   </font><font color="#0000FF"><b>switch</b></font><font color="#808080">(</font><font color="#000080">nNum</font><font color="#808080">) {
     </font><font color="#0000FF"><b>case </b></font><font color="#FF0000">0</font><font color="#808080">: </font><font color="#000080">strcpy</font><font color="#808080">(</font><font color="#000080">sret</font><font color="#808080">, </font><font color="#800000">&quot;Assunto(s) n&atilde;o encontrado(s)!&quot;</font><font color="#808080">); </font><font color="#0000FF"><b>break</b></font><font color="#808080">;
     </font><font color="#0000FF"><b>case </b></font><font color="#FF0000">1</font><font color="#808080">: {
         </font><font color="#000080">strcpy</font><font color="#808080">(</font><font color="#000080">sret</font><font color="#808080">, </font><font color="#800000">&quot;C&oacute;digo do assunto: &quot;</font><font color="#808080">);
         </font><font color="#000080">g_nPosChave </font><font color="#808080">= </font><font color="#FF0000">1</font><font color="#808080">;
         </font><font color="#000080">g_nTamChave </font><font color="#808080">= </font><font color="#FF0000">10</font><font color="#808080">;
        } </font><font color="#0000FF"><b>break</b></font><font color="#808080">;
     </font><font color="#0000FF"><b>case </b></font><font color="#FF0000">2</font><font color="#808080">: {
         </font><font color="#000080">strcpy</font><font color="#808080">(</font><font color="#000080">sret</font><font color="#808080">, </font><font color="#800000">&quot;Assunto: &quot;</font><font color="#808080">);
         </font><font color="#000080">g_nPosChave </font><font color="#808080">= </font><font color="#FF0000">11</font><font color="#808080">;
         </font><font color="#000080">g_nTamChave </font><font color="#808080">= </font><font color="#FF0000">30</font><font color="#808080">;
        } </font><font color="#0000FF"><b>break</b></font><font color="#808080">;
   }
} </font><font color="#0000FF"><b>else if </b></font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">==</font><font color="#000080">opAutor</font><font color="#808080">) {
   </font><font color="#0000FF"><b>switch</b></font><font color="#808080">(</font><font color="#000080">nNum</font><font color="#808080">) {
     </font><font color="#0000FF"><b>case </b></font><font color="#FF0000">0</font><font color="#808080">: </font><font color="#000080">strcpy</font><font color="#808080">(</font><font color="#000080">sret</font><font color="#808080">, </font><font color="#800000">&quot;Autor(es) n&atilde;o encontrado(s)!&quot;</font><font color="#808080">); </font><font color="#0000FF"><b>break</b></font><font color="#808080">;
     </font><font color="#0000FF"><b>case </b></font><font color="#FF0000">1</font><font color="#808080">: {
         </font><font color="#000080">strcpy</font><font color="#808080">(</font><font color="#000080">sret</font><font color="#808080">, </font><font color="#800000">&quot;C&oacute;digo do autor: &quot;</font><font color="#808080">);
         </font><font color="#000080">g_nPosChave </font><font color="#808080">= </font><font color="#FF0000">1</font><font color="#808080">;
         </font><font color="#000080">g_nTamChave </font><font color="#808080">= </font><font color="#FF0000">10</font><font color="#808080">;
        } </font><font color="#0000FF"><b>break</b></font><font color="#808080">;
     </font><font color="#0000FF"><b>case </b></font><font color="#FF0000">2</font><font color="#808080">: {
         </font><font color="#000080">strcpy</font><font color="#808080">(</font><font color="#000080">sret</font><font color="#808080">, </font><font color="#800000">&quot;Autor: &quot;</font><font color="#808080">);
         </font><font color="#000080">g_nPosChave </font><font color="#808080">= </font><font color="#FF0000">11</font><font color="#808080">;
         </font><font color="#000080">g_nTamChave </font><font color="#808080">= </font><font color="#FF0000">30</font><font color="#808080">;
        } </font><font color="#0000FF"><b>break</b></font><font color="#808080">;
   }
} </font><font color="#0000FF"><b>else if </b></font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">==</font><font color="#000080">opEditora</font><font color="#808080">) {
   </font><font color="#0000FF"><b>switch</b></font><font color="#808080">(</font><font color="#000080">nNum</font><font color="#808080">) {
     </font><font color="#0000FF"><b>case </b></font><font color="#FF0000">0</font><font color="#808080">: </font><font color="#000080">strcpy</font><font color="#808080">(</font><font color="#000080">sret</font><font color="#808080">, </font><font color="#800000">&quot;Editora(s) n&atilde;o encontrada(s)!&quot;</font><font color="#808080">); </font><font color="#0000FF"><b>break</b></font><font color="#808080">;
     </font><font color="#0000FF"><b>case </b></font><font color="#FF0000">1</font><font color="#808080">: {
         </font><font color="#000080">strcpy</font><font color="#808080">(</font><font color="#000080">sret</font><font color="#808080">, </font><font color="#800000">&quot;C&oacute;digo da editora: &quot;</font><font color="#808080">);
         </font><font color="#000080">g_nPosChave </font><font color="#808080">= </font><font color="#FF0000">1</font><font color="#808080">;
         </font><font color="#000080">g_nTamChave </font><font color="#808080">= </font><font color="#FF0000">10</font><font color="#808080">;
        } </font><font color="#0000FF"><b>break</b></font><font color="#808080">;
     </font><font color="#0000FF"><b>case </b></font><font color="#FF0000">2</font><font color="#808080">: {
         </font><font color="#000080">strcpy</font><font color="#808080">(</font><font color="#000080">sret</font><font color="#808080">, </font><font color="#800000">&quot;Editora: &quot;</font><font color="#808080">);
         </font><font color="#000080">g_nPosChave </font><font color="#808080">= </font><font color="#FF0000">11</font><font color="#808080">;
         </font><font color="#000080">g_nTamChave </font><font color="#808080">= </font><font color="#FF0000">50</font><font color="#808080">;
        } </font><font color="#0000FF"><b>break</b></font><font color="#808080">;
   }
} </font><font color="#0000FF"><b>else if </b></font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">==</font><font color="#000080">opEndereco</font><font color="#808080">) {
   </font><font color="#0000FF"><b>switch</b></font><font color="#808080">(</font><font color="#000080">nNum</font><font color="#808080">) {
     </font><font color="#0000FF"><b>case </b></font><font color="#FF0000">0</font><font color="#808080">: </font><font color="#000080">strcpy</font><font color="#808080">(</font><font color="#000080">sret</font><font color="#808080">, </font><font color="#800000">&quot;Endere&ccedil;o(s) n&atilde;o encontrado(s)!&quot;</font><font color="#808080">); </font><font color="#0000FF"><b>break</b></font><font color="#808080">;
     </font><font color="#0000FF"><b>case </b></font><font color="#FF0000">1</font><font color="#808080">: {
         </font><font color="#000080">strcpy</font><font color="#808080">(</font><font color="#000080">sret</font><font color="#808080">, </font><font color="#800000">&quot;C&oacute;digo do endere&ccedil;o: &quot;</font><font color="#808080">);
         </font><font color="#000080">g_nPosChave </font><font color="#808080">= </font><font color="#FF0000">1</font><font color="#808080">;
         </font><font color="#000080">g_nTamChave </font><font color="#808080">= </font><font color="#FF0000">10</font><font color="#808080">;
        } </font><font color="#0000FF"><b>break</b></font><font color="#808080">;
     </font><font color="#0000FF"><b>case </b></font><font color="#FF0000">2</font><font color="#808080">: {
         </font><font color="#000080">strcpy</font><font color="#808080">(</font><font color="#000080">sret</font><font color="#808080">, </font><font color="#800000">&quot;Logradouro: &quot;</font><font color="#808080">);
         </font><font color="#000080">g_nPosChave </font><font color="#808080">= </font><font color="#FF0000">11</font><font color="#808080">;
         </font><font color="#000080">g_nTamChave </font><font color="#808080">= </font><font color="#FF0000">40</font><font color="#808080">;
        } </font><font color="#0000FF"><b>break</b></font><font color="#808080">;
     </font><font color="#0000FF"><b>case </b></font><font color="#FF0000">3</font><font color="#808080">: {
         </font><font color="#000080">strcpy</font><font color="#808080">(</font><font color="#000080">sret</font><font color="#808080">, </font><font color="#800000">&quot;Bairro: &quot;</font><font color="#808080">);
         </font><font color="#000080">g_nPosChave </font><font color="#808080">= </font><font color="#FF0000">51</font><font color="#808080">;
         </font><font color="#000080">g_nTamChave </font><font color="#808080">= </font><font color="#FF0000">15</font><font color="#808080">;
        } </font><font color="#0000FF"><b>break</b></font><font color="#808080">;
     </font><font color="#0000FF"><b>case </b></font><font color="#FF0000">4</font><font color="#808080">: {
         </font><font color="#000080">strcpy</font><font color="#808080">(</font><font color="#000080">sret</font><font color="#808080">, </font><font color="#800000">&quot;CEP: &quot;</font><font color="#808080">);
         </font><font color="#000080">g_nPosChave </font><font color="#808080">= </font><font color="#FF0000">66</font><font color="#808080">;
         </font><font color="#000080">g_nTamChave </font><font color="#808080">= </font><font color="#FF0000">8</font><font color="#808080">;
        } </font><font color="#0000FF"><b>break</b></font><font color="#808080">;
     </font><font color="#0000FF"><b>case </b></font><font color="#FF0000">5</font><font color="#808080">: {
         </font><font color="#000080">strcpy</font><font color="#808080">(</font><font color="#000080">sret</font><font color="#808080">, </font><font color="#800000">&quot;Cidade: &quot;</font><font color="#808080">);
         </font><font color="#000080">g_nPosChave </font><font color="#808080">= </font><font color="#FF0000">74</font><font color="#808080">;
         </font><font color="#000080">g_nTamChave </font><font color="#808080">= </font><font color="#FF0000">30</font><font color="#808080">;
        } </font><font color="#0000FF"><b>break</b></font><font color="#808080">;
     </font><font color="#0000FF"><b>case </b></font><font color="#FF0000">6</font><font color="#808080">: {
         </font><font color="#000080">strcpy</font><font color="#808080">(</font><font color="#000080">sret</font><font color="#808080">, </font><font color="#800000">&quot;Estado: &quot;</font><font color="#808080">);
         </font><font color="#000080">g_nPosChave </font><font color="#808080">= </font><font color="#FF0000">104</font><font color="#808080">;
         </font><font color="#000080">g_nTamChave </font><font color="#808080">= </font><font color="#FF0000">20</font><font color="#808080">;
        } </font><font color="#0000FF"><b>break</b></font><font color="#808080">;
   }
} </font><font color="#0000FF"><b>else if </b></font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">==</font><font color="#000080">opIdioma</font><font color="#808080">) {
   </font><font color="#0000FF"><b>switch</b></font><font color="#808080">(</font><font color="#000080">nNum</font><font color="#808080">) {
     </font><font color="#0000FF"><b>case </b></font><font color="#FF0000">0</font><font color="#808080">: </font><font color="#000080">strcpy</font><font color="#808080">(</font><font color="#000080">sret</font><font color="#808080">, </font><font color="#800000">&quot;Idioma(s) n&atilde;o encontrado(s)!&quot;</font><font color="#808080">); </font><font color="#0000FF"><b>break</b></font><font color="#808080">;
     </font><font color="#0000FF"><b>case </b></font><font color="#FF0000">1</font><font color="#808080">: {
         </font><font color="#000080">strcpy</font><font color="#808080">(</font><font color="#000080">sret</font><font color="#808080">, </font><font color="#800000">&quot;C&oacute;digo do idioma: &quot;</font><font color="#808080">);
         </font><font color="#000080">g_nPosChave </font><font color="#808080">= </font><font color="#FF0000">1</font><font color="#808080">;
         </font><font color="#000080">g_nTamChave </font><font color="#808080">= </font><font color="#FF0000">10</font><font color="#808080">;
        } </font><font color="#0000FF"><b>break</b></font><font color="#808080">;
     </font><font color="#0000FF"><b>case </b></font><font color="#FF0000">2</font><font color="#808080">: {
         </font><font color="#000080">strcpy</font><font color="#808080">(</font><font color="#000080">sret</font><font color="#808080">, </font><font color="#800000">&quot;Idioma: &quot;</font><font color="#808080">);
         </font><font color="#000080">g_nPosChave </font><font color="#808080">= </font><font color="#FF0000">11</font><font color="#808080">;
         </font><font color="#000080">g_nTamChave </font><font color="#808080">= </font><font color="#FF0000">20</font><font color="#808080">;
        } </font><font color="#0000FF"><b>break</b></font><font color="#808080">;
   }
} </font><font color="#0000FF"><b>else if </b></font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">==</font><font color="#000080">opPais</font><font color="#808080">) {
   </font><font color="#0000FF"><b>switch</b></font><font color="#808080">(</font><font color="#000080">nNum</font><font color="#808080">) {
     </font><font color="#0000FF"><b>case </b></font><font color="#FF0000">0</font><font color="#808080">: </font><font color="#000080">strcpy</font><font color="#808080">(</font><font color="#000080">sret</font><font color="#808080">, </font><font color="#800000">&quot;Pa&iacute;s(es) n&atilde;o encontrado(s)!&quot;</font><font color="#808080">); </font><font color="#0000FF"><b>break</b></font><font color="#808080">;
     </font><font color="#0000FF"><b>case </b></font><font color="#FF0000">1</font><font color="#808080">: {
         </font><font color="#000080">strcpy</font><font color="#808080">(</font><font color="#000080">sret</font><font color="#808080">, </font><font color="#800000">&quot;C&oacute;digo do pa&iacute;s: &quot;</font><font color="#808080">);
         </font><font color="#000080">g_nPosChave </font><font color="#808080">= </font><font color="#FF0000">1</font><font color="#808080">;
         </font><font color="#000080">g_nTamChave </font><font color="#808080">= </font><font color="#FF0000">3</font><font color="#808080">;
        } </font><font color="#0000FF"><b>break</b></font><font color="#808080">;
     </font><font color="#0000FF"><b>case </b></font><font color="#FF0000">2</font><font color="#808080">: {
         </font><font color="#000080">strcpy</font><font color="#808080">(</font><font color="#000080">sret</font><font color="#808080">, </font><font color="#800000">&quot;Pa&iacute;s: &quot;</font><font color="#808080">);
         </font><font color="#000080">g_nPosChave </font><font color="#808080">= </font><font color="#FF0000">4</font><font color="#808080">;
         </font><font color="#000080">g_nTamChave </font><font color="#808080">= </font><font color="#FF0000">50</font><font color="#808080">;
        } </font><font color="#0000FF"><b>break</b></font><font color="#808080">;
   }
} </font><font color="#0000FF"><b>else if </b></font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">==</font><font color="#000080">opProfissao</font><font color="#808080">) {
   </font><font color="#0000FF"><b>switch</b></font><font color="#808080">(</font><font color="#000080">nNum</font><font color="#808080">) {
     </font><font color="#0000FF"><b>case </b></font><font color="#FF0000">0</font><font color="#808080">: </font><font color="#000080">strcpy</font><font color="#808080">(</font><font color="#000080">sret</font><font color="#808080">, </font><font color="#800000">&quot;Profiss&atilde;o(es) n&atilde;o encontrada(s)!&quot;</font><font color="#808080">); </font><font color="#0000FF"><b>break</b></font><font color="#808080">;
     </font><font color="#0000FF"><b>case </b></font><font color="#FF0000">1</font><font color="#808080">: {
         </font><font color="#000080">strcpy</font><font color="#808080">(</font><font color="#000080">sret</font><font color="#808080">, </font><font color="#800000">&quot;C&oacute;digo da profiss&atilde;o: &quot;</font><font color="#808080">);
         </font><font color="#000080">g_nPosChave </font><font color="#808080">= </font><font color="#FF0000">1</font><font color="#808080">;
         </font><font color="#000080">g_nTamChave </font><font color="#808080">= </font><font color="#FF0000">10</font><font color="#808080">;
        } </font><font color="#0000FF"><b>break</b></font><font color="#808080">;
     </font><font color="#0000FF"><b>case </b></font><font color="#FF0000">2</font><font color="#808080">: {
         </font><font color="#000080">strcpy</font><font color="#808080">(</font><font color="#000080">sret</font><font color="#808080">, </font><font color="#800000">&quot;Profiss&atilde;o: &quot;</font><font color="#808080">);
         </font><font color="#000080">g_nPosChave </font><font color="#808080">= </font><font color="#FF0000">11</font><font color="#808080">;
         </font><font color="#000080">g_nTamChave </font><font color="#808080">= </font><font color="#FF0000">50</font><font color="#808080">;
        } </font><font color="#0000FF"><b>break</b></font><font color="#808080">;
   }
} </font><font color="#0000FF"><b>else if </b></font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">==</font><font color="#000080">opUsuario</font><font color="#808080">) {
   </font><font color="#0000FF"><b>switch</b></font><font color="#808080">(</font><font color="#000080">nNum</font><font color="#808080">) {
     </font><font color="#0000FF"><b>case </b></font><font color="#FF0000">0</font><font color="#808080">: </font><font color="#000080">strcpy</font><font color="#808080">(</font><font color="#000080">sret</font><font color="#808080">, </font><font color="#800000">&quot;login ou senha incorreta, tente de novo!&quot;</font><font color="#808080">); </font><font color="#0000FF"><b>break</b></font><font color="#808080">;
     </font><font color="#0000FF"><b>case </b></font><font color="#FF0000">1</font><font color="#808080">: {
         </font><font color="#000080">strcpy</font><font color="#808080">(</font><font color="#000080">sret</font><font color="#808080">, </font><font color="#800000">&quot;Login: &quot;</font><font color="#808080">);
         </font><font color="#000080">g_nPosChave </font><font color="#808080">= </font><font color="#FF0000">1</font><font color="#808080">;
         </font><font color="#000080">g_nTamChave </font><font color="#808080">= </font><font color="#FF0000">10</font><font color="#808080">;
        } </font><font color="#0000FF"><b>break</b></font><font color="#808080">;
     </font><font color="#0000FF"><b>case </b></font><font color="#FF0000">2</font><font color="#808080">: {
         </font><font color="#000080">strcpy</font><font color="#808080">(</font><font color="#000080">sret</font><font color="#808080">, </font><font color="#800000">&quot;Senha: &quot;</font><font color="#808080">);
         </font><font color="#000080">g_nPosChave </font><font color="#808080">= </font><font color="#FF0000">11</font><font color="#808080">;
         </font><font color="#000080">g_nTamChave </font><font color="#808080">= </font><font color="#FF0000">10</font><font color="#808080">;
        } </font><font color="#0000FF"><b>break</b></font><font color="#808080">;
   }
} </font><font color="#0000FF"><b>else if </b></font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">==</font><font color="#000080">opLivro</font><font color="#808080">) {
   </font><font color="#0000FF"><b>switch</b></font><font color="#808080">(</font><font color="#000080">nNum</font><font color="#808080">) {
     </font><font color="#0000FF"><b>case </b></font><font color="#FF0000">0</font><font color="#808080">: </font><font color="#000080">strcpy</font><font color="#808080">(</font><font color="#000080">sret</font><font color="#808080">, </font><font color="#800000">&quot;Livro(s) n&atilde;o encontrado(s)!&quot;</font><font color="#808080">); </font><font color="#0000FF"><b>break</b></font><font color="#808080">;
     </font><font color="#0000FF"><b>case </b></font><font color="#FF0000">1</font><font color="#808080">: {
         </font><font color="#000080">strcpy</font><font color="#808080">(</font><font color="#000080">sret</font><font color="#808080">, </font><font color="#800000">&quot;ISBN: &quot;</font><font color="#808080">);
         </font><font color="#000080">g_nPosChave </font><font color="#808080">= </font><font color="#FF0000">1</font><font color="#808080">;
         </font><font color="#000080">g_nTamChave </font><font color="#808080">= </font><font color="#FF0000">13</font><font color="#808080">;
        } </font><font color="#0000FF"><b>break</b></font><font color="#808080">;
     </font><font color="#0000FF"><b>case </b></font><font color="#FF0000">2</font><font color="#808080">: {
         </font><font color="#000080">strcpy</font><font color="#808080">(</font><font color="#000080">sret</font><font color="#808080">, </font><font color="#800000">&quot;T&iacute;tulo: &quot;</font><font color="#808080">);
         </font><font color="#000080">g_nPosChave </font><font color="#808080">= </font><font color="#FF0000">14</font><font color="#808080">;
         </font><font color="#000080">g_nTamChave </font><font color="#808080">= </font><font color="#FF0000">50</font><font color="#808080">;
        } </font><font color="#0000FF"><b>break</b></font><font color="#808080">;
     </font><font color="#0000FF"><b>case </b></font><font color="#FF0000">3</font><font color="#808080">: {
         </font><font color="#000080">strcpy</font><font color="#808080">(</font><font color="#000080">sret</font><font color="#808080">, </font><font color="#800000">&quot;Edi&ccedil;&atilde;o: &quot;</font><font color="#808080">);
         </font><font color="#000080">g_nPosChave </font><font color="#808080">= </font><font color="#FF0000">64</font><font color="#808080">;
         </font><font color="#000080">g_nTamChave </font><font color="#808080">= </font><font color="#FF0000">10</font><font color="#808080">;
        } </font><font color="#0000FF"><b>break</b></font><font color="#808080">;
     </font><font color="#0000FF"><b>case </b></font><font color="#FF0000">4</font><font color="#808080">: {
         </font><font color="#000080">strcpy</font><font color="#808080">(</font><font color="#000080">sret</font><font color="#808080">, </font><font color="#800000">&quot;Ano de Publica&ccedil;&atilde;o: &quot;</font><font color="#808080">);
         </font><font color="#000080">g_nPosChave </font><font color="#808080">= </font><font color="#FF0000">74</font><font color="#808080">;
         </font><font color="#000080">g_nTamChave </font><font color="#808080">= </font><font color="#FF0000">10</font><font color="#808080">;
        } </font><font color="#0000FF"><b>break</b></font><font color="#808080">;
     </font><font color="#0000FF"><b>case </b></font><font color="#FF0000">5</font><font color="#808080">: {
         </font><font color="#000080">strcpy</font><font color="#808080">(</font><font color="#000080">sret</font><font color="#808080">, </font><font color="#800000">&quot;C&oacute;digo da editora: &quot;</font><font color="#808080">);
         </font><font color="#000080">g_nPosChave </font><font color="#808080">= </font><font color="#FF0000">84</font><font color="#808080">;
         </font><font color="#000080">g_nTamChave </font><font color="#808080">= </font><font color="#FF0000">10</font><font color="#808080">;
        } </font><font color="#0000FF"><b>break</b></font><font color="#808080">;
     </font><font color="#0000FF"><b>case </b></font><font color="#FF0000">6</font><font color="#808080">: {
         </font><font color="#000080">strcpy</font><font color="#808080">(</font><font color="#000080">sret</font><font color="#808080">, </font><font color="#800000">&quot;Volume: &quot;</font><font color="#808080">);
         </font><font color="#000080">g_nPosChave </font><font color="#808080">= </font><font color="#FF0000">94</font><font color="#808080">;
         </font><font color="#000080">g_nTamChave </font><font color="#808080">= </font><font color="#FF0000">10</font><font color="#808080">;
        } </font><font color="#0000FF"><b>break</b></font><font color="#808080">;
     </font><font color="#0000FF"><b>case </b></font><font color="#FF0000">7</font><font color="#808080">: {
         </font><font color="#000080">strcpy</font><font color="#808080">(</font><font color="#000080">sret</font><font color="#808080">, </font><font color="#800000">&quot;C&oacute;digo do idioma: &quot;</font><font color="#808080">);
         </font><font color="#000080">g_nPosChave </font><font color="#808080">= </font><font color="#FF0000">104</font><font color="#808080">;
         </font><font color="#000080">g_nTamChave </font><font color="#808080">= </font><font color="#FF0000">10</font><font color="#808080">;
        } </font><font color="#0000FF"><b>break</b></font><font color="#808080">;
     </font><font color="#0000FF"><b>case </b></font><font color="#FF0000">8</font><font color="#808080">: {
         </font><font color="#000080">strcpy</font><font color="#808080">(</font><font color="#000080">sret</font><font color="#808080">, </font><font color="#800000">&quot;N&uacute;mero de p&aacute;ginas: &quot;</font><font color="#808080">);
         </font><font color="#000080">g_nPosChave </font><font color="#808080">= </font><font color="#FF0000">114</font><font color="#808080">;
         </font><font color="#000080">g_nTamChave </font><font color="#808080">= </font><font color="#FF0000">10</font><font color="#808080">;
        } </font><font color="#0000FF"><b>break</b></font><font color="#808080">;
     </font><font color="#0000FF"><b>case </b></font><font color="#FF0000">9</font><font color="#808080">: {
         </font><font color="#000080">strcpy</font><font color="#808080">(</font><font color="#000080">sret</font><font color="#808080">, </font><font color="#800000">&quot;Pre&ccedil;o: &quot;</font><font color="#808080">);
         </font><font color="#000080">g_nPosChave </font><font color="#808080">= </font><font color="#FF0000">124</font><font color="#808080">;
         </font><font color="#000080">g_nTamChave </font><font color="#808080">= </font><font color="#FF0000">10</font><font color="#808080">;
        } </font><font color="#0000FF"><b>break</b></font><font color="#808080">;
     </font><font color="#0000FF"><b>case </b></font><font color="#FF0000">10</font><font color="#808080">: {
          </font><font color="#000080">strcpy</font><font color="#808080">(</font><font color="#000080">sret</font><font color="#808080">, </font><font color="#800000">&quot;Qtd. Estoque: &quot;</font><font color="#808080">);
          </font><font color="#000080">g_nPosChave </font><font color="#808080">= </font><font color="#FF0000">134</font><font color="#808080">;
          </font><font color="#000080">g_nTamChave </font><font color="#808080">= </font><font color="#FF0000">10</font><font color="#808080">;
         } </font><font color="#0000FF"><b>break</b></font><font color="#808080">;
   }
} </font><font color="#0000FF"><b>else if </b></font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">==</font><font color="#000080">opLivroAss</font><font color="#808080">) {
   </font><font color="#0000FF"><b>switch</b></font><font color="#808080">(</font><font color="#000080">nNum</font><font color="#808080">) {
     </font><font color="#0000FF"><b>case </b></font><font color="#FF0000">0</font><font color="#808080">: </font><font color="#000080">strcpy</font><font color="#808080">(</font><font color="#000080">sret</font><font color="#808080">, </font><font color="#800000">&quot;Assunto(s) n&atilde;o encontrado(s)!&quot;</font><font color="#808080">); </font><font color="#0000FF"><b>break</b></font><font color="#808080">;
     </font><font color="#0000FF"><b>case </b></font><font color="#FF0000">1</font><font color="#808080">: {
         </font><font color="#000080">strcpy</font><font color="#808080">(</font><font color="#000080">sret</font><font color="#808080">, </font><font color="#800000">&quot;ISBN: &quot;</font><font color="#808080">);
         </font><font color="#000080">g_nPosChave </font><font color="#808080">= </font><font color="#FF0000">1</font><font color="#808080">;
         </font><font color="#000080">g_nTamChave </font><font color="#808080">= </font><font color="#FF0000">13</font><font color="#808080">;
        } </font><font color="#0000FF"><b>break</b></font><font color="#808080">;
     </font><font color="#0000FF"><b>case </b></font><font color="#FF0000">2</font><font color="#808080">: {
         </font><font color="#000080">strcpy</font><font color="#808080">(</font><font color="#000080">sret</font><font color="#808080">, </font><font color="#800000">&quot;C&oacute;digo do assunto: &quot;</font><font color="#808080">);
         </font><font color="#000080">g_nPosChave </font><font color="#808080">= </font><font color="#FF0000">14</font><font color="#808080">;
         </font><font color="#000080">g_nTamChave </font><font color="#808080">= </font><font color="#FF0000">10</font><font color="#808080">;
        } </font><font color="#0000FF"><b>break</b></font><font color="#808080">;
   }
} </font><font color="#0000FF"><b>else if </b></font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">==</font><font color="#000080">opLivroAut</font><font color="#808080">) {
   </font><font color="#0000FF"><b>switch</b></font><font color="#808080">(</font><font color="#000080">nNum</font><font color="#808080">) {
     </font><font color="#0000FF"><b>case </b></font><font color="#FF0000">0</font><font color="#808080">: </font><font color="#000080">strcpy</font><font color="#808080">(</font><font color="#000080">sret</font><font color="#808080">, </font><font color="#800000">&quot;Autor(s) n&atilde;o encontrado(s)!&quot;</font><font color="#808080">); </font><font color="#0000FF"><b>break</b></font><font color="#808080">;
     </font><font color="#0000FF"><b>case </b></font><font color="#FF0000">1</font><font color="#808080">: {
         </font><font color="#000080">strcpy</font><font color="#808080">(</font><font color="#000080">sret</font><font color="#808080">, </font><font color="#800000">&quot;ISBN: &quot;</font><font color="#808080">);
         </font><font color="#000080">g_nPosChave </font><font color="#808080">= </font><font color="#FF0000">1</font><font color="#808080">;
         </font><font color="#000080">g_nTamChave </font><font color="#808080">= </font><font color="#FF0000">13</font><font color="#808080">;
        } </font><font color="#0000FF"><b>break</b></font><font color="#808080">;
     </font><font color="#0000FF"><b>case </b></font><font color="#FF0000">2</font><font color="#808080">: {
         </font><font color="#000080">strcpy</font><font color="#808080">(</font><font color="#000080">sret</font><font color="#808080">, </font><font color="#800000">&quot;C&oacute;digo do autor: &quot;</font><font color="#808080">);
         </font><font color="#000080">g_nPosChave </font><font color="#808080">= </font><font color="#FF0000">14</font><font color="#808080">;
         </font><font color="#000080">g_nTamChave </font><font color="#808080">= </font><font color="#FF0000">10</font><font color="#808080">;
        } </font><font color="#0000FF"><b>break</b></font><font color="#808080">;
   }
} </font><font color="#0000FF"><b>else if </b></font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">==</font><font color="#000080">opCliente</font><font color="#808080">) {
   </font><font color="#0000FF"><b>switch</b></font><font color="#808080">(</font><font color="#000080">nNum</font><font color="#808080">) {
     </font><font color="#0000FF"><b>case </b></font><font color="#FF0000">0</font><font color="#808080">: </font><font color="#000080">strcpy</font><font color="#808080">(</font><font color="#000080">sret</font><font color="#808080">, </font><font color="#800000">&quot;Cliente(s) n&atilde;o encontrado(s)!&quot;</font><font color="#808080">); </font><font color="#0000FF"><b>break</b></font><font color="#808080">;
     </font><font color="#0000FF"><b>case </b></font><font color="#FF0000">1</font><font color="#808080">: {
         </font><font color="#000080">strcpy</font><font color="#808080">(</font><font color="#000080">sret</font><font color="#808080">, </font><font color="#800000">&quot;CPF: &quot;</font><font color="#808080">);
         </font><font color="#000080">g_nPosChave </font><font color="#808080">= </font><font color="#FF0000">1</font><font color="#808080">;
         </font><font color="#000080">g_nTamChave </font><font color="#808080">= </font><font color="#FF0000">14</font><font color="#808080">;
        } </font><font color="#0000FF"><b>break</b></font><font color="#808080">;
     </font><font color="#0000FF"><b>case </b></font><font color="#FF0000">2</font><font color="#808080">: {
         </font><font color="#000080">strcpy</font><font color="#808080">(</font><font color="#000080">sret</font><font color="#808080">, </font><font color="#800000">&quot;Nome: &quot;</font><font color="#808080">);
         </font><font color="#000080">g_nPosChave </font><font color="#808080">= </font><font color="#FF0000">15</font><font color="#808080">;
         </font><font color="#000080">g_nTamChave </font><font color="#808080">= </font><font color="#FF0000">30</font><font color="#808080">;
        } </font><font color="#0000FF"><b>break</b></font><font color="#808080">;
     </font><font color="#0000FF"><b>case </b></font><font color="#FF0000">3</font><font color="#808080">: {
         </font><font color="#000080">strcpy</font><font color="#808080">(</font><font color="#000080">sret</font><font color="#808080">, </font><font color="#800000">&quot;E-mail: &quot;</font><font color="#808080">);
         </font><font color="#000080">g_nPosChave </font><font color="#808080">= </font><font color="#FF0000">45</font><font color="#808080">;
         </font><font color="#000080">g_nTamChave </font><font color="#808080">= </font><font color="#FF0000">30</font><font color="#808080">;
        } </font><font color="#0000FF"><b>break</b></font><font color="#808080">;
     </font><font color="#0000FF"><b>case </b></font><font color="#FF0000">4</font><font color="#808080">: {
         </font><font color="#000080">strcpy</font><font color="#808080">(</font><font color="#000080">sret</font><font color="#808080">, </font><font color="#800000">&quot;Identidade: &quot;</font><font color="#808080">);
         </font><font color="#000080">g_nPosChave </font><font color="#808080">= </font><font color="#FF0000">75</font><font color="#808080">;
         </font><font color="#000080">g_nTamChave </font><font color="#808080">= </font><font color="#FF0000">10</font><font color="#808080">;
        } </font><font color="#0000FF"><b>break</b></font><font color="#808080">;
     </font><font color="#0000FF"><b>case </b></font><font color="#FF0000">5</font><font color="#808080">: {
         </font><font color="#000080">strcpy</font><font color="#808080">(</font><font color="#000080">sret</font><font color="#808080">, </font><font color="#800000">&quot;Sexo: &quot;</font><font color="#808080">);
         </font><font color="#000080">g_nPosChave </font><font color="#808080">= </font><font color="#FF0000">85</font><font color="#808080">;
         </font><font color="#000080">g_nTamChave </font><font color="#808080">= </font><font color="#FF0000">1</font><font color="#808080">;
        } </font><font color="#0000FF"><b>break</b></font><font color="#808080">;
     </font><font color="#0000FF"><b>case </b></font><font color="#FF0000">6</font><font color="#808080">: {
         </font><font color="#000080">strcpy</font><font color="#808080">(</font><font color="#000080">sret</font><font color="#808080">, </font><font color="#800000">&quot;Telefone: &quot;</font><font color="#808080">);
         </font><font color="#000080">g_nPosChave </font><font color="#808080">= </font><font color="#FF0000">86</font><font color="#808080">;
         </font><font color="#000080">g_nTamChave </font><font color="#808080">= </font><font color="#FF0000">17</font><font color="#808080">;
        } </font><font color="#0000FF"><b>break</b></font><font color="#808080">;
     </font><font color="#0000FF"><b>case </b></font><font color="#FF0000">7</font><font color="#808080">: {
         </font><font color="#000080">strcpy</font><font color="#808080">(</font><font color="#000080">sret</font><font color="#808080">, </font><font color="#800000">&quot;Dt. Nascimento: &quot;</font><font color="#808080">);
         </font><font color="#000080">g_nPosChave </font><font color="#808080">= </font><font color="#FF0000">103</font><font color="#808080">;
         </font><font color="#000080">g_nTamChave </font><font color="#808080">= </font><font color="#FF0000">10</font><font color="#808080">;
        } </font><font color="#0000FF"><b>break</b></font><font color="#808080">;
     </font><font color="#0000FF"><b>case </b></font><font color="#FF0000">8</font><font color="#808080">: {
         </font><font color="#000080">strcpy</font><font color="#808080">(</font><font color="#000080">sret</font><font color="#808080">, </font><font color="#800000">&quot;C&oacute;digo do endere&ccedil;o: &quot;</font><font color="#808080">);
         </font><font color="#000080">g_nPosChave </font><font color="#808080">= </font><font color="#FF0000">113</font><font color="#808080">;
         </font><font color="#000080">g_nTamChave </font><font color="#808080">= </font><font color="#FF0000">10</font><font color="#808080">;
        } </font><font color="#0000FF"><b>break</b></font><font color="#808080">;
     </font><font color="#0000FF"><b>case </b></font><font color="#FF0000">9</font><font color="#808080">: {
         </font><font color="#000080">strcpy</font><font color="#808080">(</font><font color="#000080">sret</font><font color="#808080">, </font><font color="#800000">&quot;C&oacute;digo do pa&iacute;s: &quot;</font><font color="#808080">);
         </font><font color="#000080">g_nPosChave </font><font color="#808080">= </font><font color="#FF0000">123</font><font color="#808080">;
         </font><font color="#000080">g_nTamChave </font><font color="#808080">= </font><font color="#FF0000">3</font><font color="#808080">;
        } </font><font color="#0000FF"><b>break</b></font><font color="#808080">;
     </font><font color="#0000FF"><b>case </b></font><font color="#FF0000">10</font><font color="#808080">: {
          </font><font color="#000080">strcpy</font><font color="#808080">(</font><font color="#000080">sret</font><font color="#808080">, </font><font color="#800000">&quot;C&oacute;digo da Profiss&atilde;o: &quot;</font><font color="#808080">);
          </font><font color="#000080">g_nPosChave </font><font color="#808080">= </font><font color="#FF0000">126</font><font color="#808080">;
          </font><font color="#000080">g_nTamChave </font><font color="#808080">= </font><font color="#FF0000">10</font><font color="#808080">;
        } </font><font color="#0000FF"><b>break</b></font><font color="#808080">;
   }
} </font><font color="#0000FF"><b>else if </b></font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">==</font><font color="#000080">opVenda</font><font color="#808080">) {
   </font><font color="#0000FF"><b>switch</b></font><font color="#808080">(</font><font color="#000080">nNum</font><font color="#808080">) {
     </font><font color="#0000FF"><b>case </b></font><font color="#FF0000">0</font><font color="#808080">: </font><font color="#000080">strcpy</font><font color="#808080">(</font><font color="#000080">sret</font><font color="#808080">, </font><font color="#800000">&quot;Venda(s) n&atilde;o encontrada(s)!&quot;</font><font color="#808080">); </font><font color="#0000FF"><b>break</b></font><font color="#808080">;
     </font><font color="#0000FF"><b>case </b></font><font color="#FF0000">1</font><font color="#808080">: {
         </font><font color="#000080">strcpy</font><font color="#808080">(</font><font color="#000080">sret</font><font color="#808080">, </font><font color="#800000">&quot;Data/Hora venda: &quot;</font><font color="#808080">);
         </font><font color="#000080">g_nPosChave </font><font color="#808080">= </font><font color="#FF0000">1</font><font color="#808080">;
         </font><font color="#000080">g_nTamChave </font><font color="#808080">= </font><font color="#FF0000">19</font><font color="#808080">;
        } </font><font color="#0000FF"><b>break</b></font><font color="#808080">;
     </font><font color="#0000FF"><b>case </b></font><font color="#FF0000">2</font><font color="#808080">: {
         </font><font color="#000080">strcpy</font><font color="#808080">(</font><font color="#000080">sret</font><font color="#808080">, </font><font color="#800000">&quot;CPF: &quot;</font><font color="#808080">);
         </font><font color="#000080">g_nPosChave </font><font color="#808080">= </font><font color="#FF0000">20</font><font color="#808080">;
         </font><font color="#000080">g_nTamChave </font><font color="#808080">= </font><font color="#FF0000">14</font><font color="#808080">;
        } </font><font color="#0000FF"><b>break</b></font><font color="#808080">;
     </font><font color="#0000FF"><b>case </b></font><font color="#FF0000">3</font><font color="#808080">: {
         </font><font color="#000080">strcpy</font><font color="#808080">(</font><font color="#000080">sret</font><font color="#808080">, </font><font color="#800000">&quot;ISBN: &quot;</font><font color="#808080">);
         </font><font color="#000080">g_nPosChave </font><font color="#808080">= </font><font color="#FF0000">34</font><font color="#808080">;
         </font><font color="#000080">g_nTamChave </font><font color="#808080">= </font><font color="#FF0000">13</font><font color="#808080">;
        } </font><font color="#0000FF"><b>break</b></font><font color="#808080">;
     </font><font color="#0000FF"><b>case </b></font><font color="#FF0000">4</font><font color="#808080">: {
         </font><font color="#000080">strcpy</font><font color="#808080">(</font><font color="#000080">sret</font><font color="#808080">, </font><font color="#800000">&quot;Pre&ccedil;o de venda: &quot;</font><font color="#808080">);
         </font><font color="#000080">g_nPosChave </font><font color="#808080">= </font><font color="#FF0000">47</font><font color="#808080">;
         </font><font color="#000080">g_nTamChave </font><font color="#808080">= </font><font color="#FF0000">10</font><font color="#808080">;
        } </font><font color="#0000FF"><b>break</b></font><font color="#808080">;
   }
}
</font><font color="#0000FF"><b>return </b></font><font color="#000080">sret</font><font color="#808080">;
}
<i>/*------------------------------------------------------------------------------
Indica se continua ou n&atilde;o mostrando um n&uacute;mero m&aacute;ximo de linhas.
nlinha - a linha a ser continuada
nQtdLinha - a quantidade de linhas a serem mostradas
retorna - se continua ou n&atilde;o
------------------------------------------------------------------------------*/
</i>- (</font><font color="#000080">BOOL</font><font color="#808080">) </font><font color="#000080">ContinuaSN</font><font color="#808080">: (</font><font color="#0000FF"><b>int</b></font><font color="#808080">) </font><font color="#000080">nlinha</font><font color="#808080">, ...
{ 
  </font><font color="#000080">BOOL bSOp</font><font color="#808080">, </font><font color="#000080">bret</font><font color="#808080">;
  </font><font color="#0000FF"><b>char </b></font><font color="#000080">opCSubMenu</font><font color="#808080">;
  </font><font color="#0000FF"><b>int </b></font><font color="#000080">nQtdLinha</font><font color="#808080">;

</font><font color="#000080">va_list lparams</font><font color="#808080">;
</font><font color="#000080">va_start</font><font color="#808080">(</font><font color="#000080">lparams</font><font color="#808080">, </font><font color="#000080">nlinha</font><font color="#808080">);
</font><font color="#000080">nQtdLinha </font><font color="#808080">= </font><font color="#000080">va_arg</font><font color="#808080">(</font><font color="#000080">lparams</font><font color="#808080">,</font><font color="#0000FF"><b>int</b></font><font color="#808080">);
</font><font color="#000080">va_end</font><font color="#808080">(</font><font color="#000080">lparams</font><font color="#808080">);

</font><font color="#000080">bret </font><font color="#808080">= </font><font color="#000080">NO</font><font color="#808080">;
</font><font color="#0000FF"><b>if </b></font><font color="#808080">(</font><font color="#000080">nlinha </font><font color="#808080">&gt; </font><font color="#FF0000">0</font><font color="#808080">) {
  </font><font color="#0000FF"><b>if </b></font><font color="#808080">((</font><font color="#000080">nlinha </font><font color="#808080">% </font><font color="#000080">nQtdLinha</font><font color="#808080">) == </font><font color="#FF0000">0</font><font color="#808080">) {
      </font><font color="#000080">bSOp </font><font color="#808080">= </font><font color="#000080">YES</font><font color="#808080">;
      </font><font color="#0000FF"><b>while</b></font><font color="#808080">(</font><font color="#000080">bSOp</font><font color="#808080">) {
       [</font><font color="#000080">self menu</font><font color="#808080">: </font><font color="#FF0000">13</font><font color="#808080">];
       </font><font color="#000080">fflush</font><font color="#808080">(</font><font color="#000080">stdin</font><font color="#808080">);
       </font><font color="#000080">fscanf</font><font color="#808080">(</font><font color="#000080">stdin</font><font color="#808080">, </font><font color="#800000">&quot;%s&quot;</font><font color="#808080">, &amp;</font><font color="#000080">opCSubMenu</font><font color="#808080">);
       </font><font color="#0000FF"><b>if </b></font><font color="#808080">((</font><font color="#000080">opCSubMenu</font><font color="#808080">==</font>'S'<font color="#808080">) || (</font><font color="#000080">opCSubMenu</font><font color="#808080">==</font>'s'<font color="#808080">)) </font><font color="#000080">bSOp </font><font color="#808080">= </font><font color="#000080">NO</font><font color="#808080">;
       </font><font color="#0000FF"><b>else if </b></font><font color="#808080">((</font><font color="#000080">opCSubMenu</font><font color="#808080">==</font>'N'<font color="#808080">) || (</font><font color="#000080">opCSubMenu</font><font color="#808080">==</font>'n'<font color="#808080">)) {
          </font><font color="#000080">bret </font><font color="#808080">= </font><font color="#000080">YES</font><font color="#808080">;
          </font><font color="#000080">bSOp </font><font color="#808080">= </font><font color="#000080">NO</font><font color="#808080">;
       } </font><font color="#0000FF"><b>else </b></font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;%s\n&quot;</font><font color="#808080">,</font><font color="#000080">MSG_ERRO</font><font color="#808080">);
      }
  }
}
</font><font color="#0000FF"><b>return </b></font><font color="#000080">bret</font><font color="#808080">;
}
<i>/*------------------------------------------------------------------------------
Lista v&aacute;rios registros de acordo com a pesquisa feita.
sArq - o arquivo
sreg - o tipo de arquivo
sChave - a chave a ser pesquisada
nPosChave - a posicao inicial da chave dentro do registro
nTamChave - o tamanho da chave dentro do registro
nTamLinha - o tamanho do registro
nQtdLinha - a quantidade de linhas a serem mostradas
retorna - se encontrou algum registro
------------------------------------------------------------------------------*/
</i>- (</font><font color="#000080">BOOL</font><font color="#808080">) </font><font color="#000080">ListarTodos</font><font color="#808080">: (</font><font color="#000080">FILE</font><font color="#808080">*) </font><font color="#000080">sArq</font><font color="#808080">, ...
{ 
  </font><font color="#0000FF"><b>enum </b></font><font color="#000080">ctArqs sreg</font><font color="#808080">;
  </font><font color="#000080">STR sChave</font><font color="#808080">, </font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#000080">sres</font><font color="#808080">;
  </font><font color="#000080">BOOL bPesqRelativa</font><font color="#808080">, </font><font color="#000080">bQuebra</font><font color="#808080">, </font><font color="#000080">bAchou</font><font color="#808080">, </font><font color="#000080">bRet</font><font color="#808080">;
  </font><font color="#0000FF"><b>int </b></font><font color="#000080">nPosChave</font><font color="#808080">, </font><font color="#000080">nTamChave</font><font color="#808080">, </font><font color="#000080">nTamLinha</font><font color="#808080">, </font><font color="#000080">nQtdLinha</font><font color="#808080">, </font><font color="#000080">nCont</font><font color="#808080">;

</font><font color="#000080">va_list lparams</font><font color="#808080">;
</font><font color="#000080">va_start</font><font color="#808080">(</font><font color="#000080">lparams</font><font color="#808080">, </font><font color="#000080">sArq</font><font color="#808080">);
</font><font color="#000080">sreg </font><font color="#808080">= </font><font color="#000080">va_arg</font><font color="#808080">(</font><font color="#000080">lparams</font><font color="#808080">,</font><font color="#0000FF"><b>enum </b></font><font color="#000080">ctArqs</font><font color="#808080">);
</font><font color="#000080">sChave </font><font color="#808080">= </font><font color="#000080">va_arg</font><font color="#808080">(</font><font color="#000080">lparams</font><font color="#808080">,</font><font color="#000080">STR</font><font color="#808080">);
</font><font color="#000080">nPosChave </font><font color="#808080">= </font><font color="#000080">va_arg</font><font color="#808080">(</font><font color="#000080">lparams</font><font color="#808080">,</font><font color="#0000FF"><b>int</b></font><font color="#808080">); 
</font><font color="#000080">nTamChave </font><font color="#808080">= </font><font color="#000080">va_arg</font><font color="#808080">(</font><font color="#000080">lparams</font><font color="#808080">,</font><font color="#0000FF"><b>int</b></font><font color="#808080">); 
</font><font color="#000080">nTamLinha </font><font color="#808080">= </font><font color="#000080">va_arg</font><font color="#808080">(</font><font color="#000080">lparams</font><font color="#808080">,</font><font color="#0000FF"><b>int</b></font><font color="#808080">); 
</font><font color="#000080">nQtdLinha </font><font color="#808080">= </font><font color="#000080">va_arg</font><font color="#808080">(</font><font color="#000080">lparams</font><font color="#808080">,</font><font color="#0000FF"><b>int</b></font><font color="#808080">); 
</font><font color="#000080">bPesqRelativa </font><font color="#808080">= </font><font color="#000080">va_arg</font><font color="#808080">(</font><font color="#000080">lparams</font><font color="#808080">,</font><font color="#0000FF"><b>int</b></font><font color="#808080">);
</font><font color="#000080">va_end</font><font color="#808080">(</font><font color="#000080">lparams</font><font color="#808080">);
  
</font><font color="#000080">slinha </font><font color="#808080">= [</font><font color="#000080">self alocaString</font><font color="#808080">: </font><font color="#000080">TAM_MAX_STR</font><font color="#808080">];
</font><font color="#000080">bRet </font><font color="#808080">= </font><font color="#000080">NO</font><font color="#808080">;
</font><font color="#000080">bQuebra </font><font color="#808080">= </font><font color="#000080">NO</font><font color="#808080">;
</font><font color="#000080">nCont </font><font color="#808080">= </font><font color="#FF0000">0</font><font color="#808080">;
[</font><font color="#000080">self mostrarDados</font><font color="#808080">: </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">];
</font><font color="#000080">fseek</font><font color="#808080">(</font><font color="#000080">sArq</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#000080">SEEK_SET</font><font color="#808080">);
</font><font color="#0000FF"><b>while </b></font><font color="#808080">((!</font><font color="#000080">feof</font><font color="#808080">(</font><font color="#000080">sArq</font><font color="#808080">)) &amp;&amp; (</font><font color="#000080">bQuebra</font><font color="#808080">==</font><font color="#000080">NO</font><font color="#808080">)) {
  </font><font color="#000080">fread</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,(</font><font color="#000080">nTamLinha </font><font color="#808080">+ </font><font color="#000080">TAM_CRLF</font><font color="#808080">),</font><font color="#000080">sArq</font><font color="#808080">);

  </font><font color="#0000FF"><b>if </b></font><font color="#808080">(</font><font color="#000080">bPesqRelativa</font><font color="#808080">==</font><font color="#000080">YES</font><font color="#808080">) {
    </font><font color="#000080">sres </font><font color="#808080">= [</font><font color="#000080">self trim</font><font color="#808080">: [</font><font color="#000080">self copy</font><font color="#808080">: </font><font color="#000080">slinha</font><font color="#808080">,</font><font color="#000080">nPosChave</font><font color="#808080">,</font><font color="#000080">nTamChave</font><font color="#808080">]];
    </font><font color="#0000FF"><b>if </b></font><font color="#808080">([</font><font color="#000080">self strRelativa</font><font color="#808080">: </font><font color="#000080">sres</font><font color="#808080">,</font><font color="#000080">sChave</font><font color="#808080">]==</font><font color="#000080">YES</font><font color="#808080">) {
       </font><font color="#000080">bAchou </font><font color="#808080">= </font><font color="#000080">YES</font><font color="#808080">;
       </font><font color="#000080">bRet </font><font color="#808080">= </font><font color="#000080">YES</font><font color="#808080">;
       </font><font color="#000080">free</font><font color="#808080">(</font><font color="#000080">sres</font><font color="#808080">);
    } </font><font color="#0000FF"><b>else </b></font><font color="#808080">{
       </font><font color="#000080">bAchou </font><font color="#808080">= </font><font color="#000080">NO</font><font color="#808080">;
       </font><font color="#000080">free</font><font color="#808080">(</font><font color="#000080">sres</font><font color="#808080">);
    }   
  } </font><font color="#0000FF"><b>else </b></font><font color="#808080">{
    </font><font color="#000080">bAchou </font><font color="#808080">= </font><font color="#000080">YES</font><font color="#808080">;
    </font><font color="#000080">bRet </font><font color="#808080">= </font><font color="#000080">YES</font><font color="#808080">;
  }

  </font><font color="#0000FF"><b>if </b></font><font color="#808080">(</font><font color="#000080">bAchou</font><font color="#808080">==</font><font color="#000080">YES </font><font color="#808080">&amp;&amp; (!</font><font color="#000080">feof</font><font color="#808080">(</font><font color="#000080">sArq</font><font color="#808080">))) {
    [</font><font color="#000080">self mostrarDados</font><font color="#808080">: </font><font color="#000080">sreg</font><font color="#808080">, [</font><font color="#000080">self copy</font><font color="#808080">: </font><font color="#000080">slinha</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#000080">nTamLinha</font><font color="#808080">], </font><font color="#FF0000">3</font><font color="#808080">];
    </font><font color="#000080">nCont</font><font color="#808080">++;
  }

  </font><font color="#000080">bQuebra </font><font color="#808080">= [</font><font color="#000080">self ContinuaSN</font><font color="#808080">: </font><font color="#000080">nCont</font><font color="#808080">, </font><font color="#000080">nQtdLinha</font><font color="#808080">];
}
</font><font color="#000080">free</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">);
</font><font color="#0000FF"><b>return </b></font><font color="#000080">bRet</font><font color="#808080">;
}
<i>/*------------------------------------------------------------------------------
Lista v&aacute;rios registros entre arquivos de acordo com a pesquisa feita.
sArq1 - o arquivo de liga&ccedil;&atilde;o
sreg1 - o tipo de arquivo de liga&ccedil;&atilde;o
nPosChave1 - a posicao inicial da primeira chave no arquivo de liga&ccedil;&atilde;o
nTamChave1 - o tamanho da primeira chave no arquivo de liga&ccedil;&atilde;o
nPosChave2 - a posicao inicial da segunda chave do arquivo de liga&ccedil;&atilde;o
nTamChave2 - o tamanho da segunda chave do arquivo de liga&ccedil;&atilde;o
sChave - a chave a ser pesquisada no arquivo de liga&ccedil;&atilde;o
sArq2 - o arquivo a ser pesquisado
sreg2 - o tipo de arquivo a ser pesquisado
nPosChave3 - a posicao inicial da chave do arquivo pesquisado
nQtdLinha - a quantidade de linhas a serem mostradas
------------------------------------------------------------------------------*/
</i>- </font><font color="#000080">ListarRegLigados</font><font color="#808080">: (</font><font color="#000080">FILE</font><font color="#808080">*) </font><font color="#000080">sArq1</font><font color="#808080">, ...
{ 
  </font><font color="#0000FF"><b>enum </b></font><font color="#000080">ctArqs sreg1</font><font color="#808080">, </font><font color="#000080">sreg2</font><font color="#808080">;
  </font><font color="#000080">FILE</font><font color="#808080">* </font><font color="#000080">sArq2</font><font color="#808080">;
  </font><font color="#000080">STR sChave</font><font color="#808080">, </font><font color="#000080">slinha1</font><font color="#808080">, </font><font color="#000080">sCodigo1</font><font color="#808080">, </font><font color="#000080">sCodigo2</font><font color="#808080">, </font><font color="#000080">slinha2</font><font color="#808080">;
  </font><font color="#000080">BOOL bQuebra</font><font color="#808080">, </font><font color="#000080">bRet</font><font color="#808080">;
  </font><font color="#0000FF"><b>int </b></font><font color="#000080">nPosChave1</font><font color="#808080">, </font><font color="#000080">nTamChave1</font><font color="#808080">, </font><font color="#000080">nPosChave2</font><font color="#808080">, </font><font color="#000080">nTamChave2</font><font color="#808080">, 
      </font><font color="#000080">nPosChave3</font><font color="#808080">, </font><font color="#000080">nQtdLinha</font><font color="#808080">, </font><font color="#000080">nCont</font><font color="#808080">;
  
</font><font color="#000080">va_list lparams</font><font color="#808080">;
</font><font color="#000080">va_start</font><font color="#808080">(</font><font color="#000080">lparams</font><font color="#808080">, </font><font color="#000080">sArq1</font><font color="#808080">);
</font><font color="#000080">sreg1 </font><font color="#808080">= </font><font color="#000080">va_arg</font><font color="#808080">(</font><font color="#000080">lparams</font><font color="#808080">,</font><font color="#0000FF"><b>enum </b></font><font color="#000080">ctArqs</font><font color="#808080">);
</font><font color="#000080">nPosChave1 </font><font color="#808080">= </font><font color="#000080">va_arg</font><font color="#808080">(</font><font color="#000080">lparams</font><font color="#808080">,</font><font color="#0000FF"><b>int</b></font><font color="#808080">); 
</font><font color="#000080">nTamChave1 </font><font color="#808080">= </font><font color="#000080">va_arg</font><font color="#808080">(</font><font color="#000080">lparams</font><font color="#808080">,</font><font color="#0000FF"><b>int</b></font><font color="#808080">); 
</font><font color="#000080">nPosChave2 </font><font color="#808080">= </font><font color="#000080">va_arg</font><font color="#808080">(</font><font color="#000080">lparams</font><font color="#808080">,</font><font color="#0000FF"><b>int</b></font><font color="#808080">); 
</font><font color="#000080">nTamChave2 </font><font color="#808080">= </font><font color="#000080">va_arg</font><font color="#808080">(</font><font color="#000080">lparams</font><font color="#808080">,</font><font color="#0000FF"><b>int</b></font><font color="#808080">); 
</font><font color="#000080">sChave </font><font color="#808080">= </font><font color="#000080">va_arg</font><font color="#808080">(</font><font color="#000080">lparams</font><font color="#808080">,</font><font color="#000080">STR</font><font color="#808080">);
</font><font color="#000080">sArq2 </font><font color="#808080">= </font><font color="#000080">va_arg</font><font color="#808080">(</font><font color="#000080">lparams</font><font color="#808080">,</font><font color="#000080">FILE</font><font color="#808080">*);
</font><font color="#000080">sreg2 </font><font color="#808080">= </font><font color="#000080">va_arg</font><font color="#808080">(</font><font color="#000080">lparams</font><font color="#808080">,</font><font color="#0000FF"><b>enum </b></font><font color="#000080">ctArqs</font><font color="#808080">);
</font><font color="#000080">nPosChave3 </font><font color="#808080">= </font><font color="#000080">va_arg</font><font color="#808080">(</font><font color="#000080">lparams</font><font color="#808080">,</font><font color="#0000FF"><b>int</b></font><font color="#808080">); 
</font><font color="#000080">nQtdLinha </font><font color="#808080">= </font><font color="#000080">va_arg</font><font color="#808080">(</font><font color="#000080">lparams</font><font color="#808080">,</font><font color="#0000FF"><b>int</b></font><font color="#808080">); 
</font><font color="#000080">va_end</font><font color="#808080">(</font><font color="#000080">lparams</font><font color="#808080">);

</font><font color="#000080">slinha1 </font><font color="#808080">= [</font><font color="#000080">self alocaString</font><font color="#808080">: </font><font color="#000080">TAM_MAX_STR</font><font color="#808080">];
</font><font color="#000080">bRet </font><font color="#808080">= </font><font color="#000080">NO</font><font color="#808080">;
</font><font color="#000080">nCont </font><font color="#808080">= </font><font color="#FF0000">0</font><font color="#808080">;
</font><font color="#000080">bQuebra </font><font color="#808080">= </font><font color="#000080">NO</font><font color="#808080">;
[</font><font color="#000080">self mostrarDados</font><font color="#808080">: </font><font color="#000080">sreg2</font><font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">];
</font><font color="#000080">fseek</font><font color="#808080">(</font><font color="#000080">sArq1</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#000080">SEEK_SET</font><font color="#808080">);
</font><font color="#0000FF"><b>while </b></font><font color="#808080">((!</font><font color="#000080">feof</font><font color="#808080">(</font><font color="#000080">sArq1</font><font color="#808080">)) &amp;&amp; (</font><font color="#000080">bQuebra</font><font color="#808080">==</font><font color="#000080">NO</font><font color="#808080">)) {
  </font><font color="#000080">fread</font><font color="#808080">(</font><font color="#000080">slinha1</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,([</font><font color="#000080">self tamReg</font><font color="#808080">: </font><font color="#000080">sreg1</font><font color="#808080">] + </font><font color="#000080">TAM_CRLF</font><font color="#808080">),</font><font color="#000080">sArq1</font><font color="#808080">);
  </font><font color="#000080">sCodigo1 </font><font color="#808080">= [</font><font color="#000080">self trim</font><font color="#808080">: [</font><font color="#000080">self copy</font><font color="#808080">: </font><font color="#000080">slinha1</font><font color="#808080">,</font><font color="#000080">nPosChave1</font><font color="#808080">,</font><font color="#000080">nTamChave1</font><font color="#808080">]];
  </font><font color="#0000FF"><b>if </b></font><font color="#808080">(</font><font color="#000080">strcmp</font><font color="#808080">(</font><font color="#000080">sCodigo1</font><font color="#808080">,</font><font color="#000080">sChave</font><font color="#808080">)==</font><font color="#FF0000">0</font><font color="#808080">) {
    </font><font color="#000080">sCodigo2 </font><font color="#808080">= [</font><font color="#000080">self trim</font><font color="#808080">: [</font><font color="#000080">self copy</font><font color="#808080">: </font><font color="#000080">slinha1</font><font color="#808080">,</font><font color="#000080">nPosChave2</font><font color="#808080">,</font><font color="#000080">nTamChave2</font><font color="#808080">]];
    </font><font color="#000080">slinha2 </font><font color="#808080">= [</font><font color="#000080">self pesqArq</font><font color="#808080">: </font><font color="#000080">sArq2</font><font color="#808080">, </font><font color="#000080">sCodigo2</font><font color="#808080">, </font><font color="#000080">nPosChave3</font><font color="#808080">, </font><font color="#000080">nTamChave2</font><font color="#808080">, 
              [</font><font color="#000080">self tamReg</font><font color="#808080">: </font><font color="#000080">sreg2</font><font color="#808080">]];
    [</font><font color="#000080">self mostrarDados</font><font color="#808080">: </font><font color="#000080">sreg2</font><font color="#808080">, 
          [</font><font color="#000080">self copy</font><font color="#808080">: </font><font color="#000080">slinha2</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, [</font><font color="#000080">self tamReg </font><font color="#808080">:</font><font color="#000080">sreg2</font><font color="#808080">] ], </font><font color="#FF0000">3</font><font color="#808080">];
    </font><font color="#000080">bRet </font><font color="#808080">= </font><font color="#000080">YES</font><font color="#808080">;
    </font><font color="#000080">nCont</font><font color="#808080">++;
  }
  </font><font color="#000080">bQuebra </font><font color="#808080">= [</font><font color="#000080">self ContinuaSN</font><font color="#808080">: </font><font color="#000080">nCont</font><font color="#808080">, </font><font color="#000080">nQtdLinha</font><font color="#808080">];
}
</font><font color="#0000FF"><b>if </b></font><font color="#808080">(</font><font color="#000080">bRet</font><font color="#808080">==</font><font color="#000080">NO</font><font color="#808080">)
   </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;%s\n&quot;</font><font color="#808080">,[</font><font color="#000080">self rotulo</font><font color="#808080">: </font><font color="#000080">sreg2</font><font color="#808080">,</font><font color="#FF0000">0</font><font color="#808080">]);
</font><font color="#000080">free</font><font color="#808080">(</font><font color="#000080">slinha1</font><font color="#808080">);   
</font><font color="#0000FF"><b>return </b></font><font color="#000080">self</font><font color="#808080">;
}
<i>/*------------------------------------------------------------------------------
Valida a entrada de registros de acordo com a pesquisa feita.
sArq - o arquivo
sreg - o tipo de arquivo
nTexto - o numero do r&oacute;tulo da entrada
sEntrada - a chave a ser pesquisada e validada
nTentativas - o n&uacute;mero m&aacute;ximo de tentativas
bPesqRelativa - indica se vai realizar uma pesquisa relativa
bTipoEntrada - indica o tipo de entrada
retorna - o registro pesquisado e validado
------------------------------------------------------------------------------*/
</i>- (</font><font color="#000080">STR</font><font color="#808080">) </font><font color="#000080">validaEntrada</font><font color="#808080">: (</font><font color="#000080">FILE</font><font color="#808080">*) </font><font color="#000080">sArq</font><font color="#808080">, ...
{ 
  </font><font color="#0000FF"><b>enum </b></font><font color="#000080">ctArqs sreg</font><font color="#808080">;
  </font><font color="#0000FF"><b>enum </b></font><font color="#000080">ctTipo bTipoEntrada</font><font color="#808080">;
  </font><font color="#000080">BOOL bPesqRelativa</font><font color="#808080">, </font><font color="#000080">bQuebra</font><font color="#808080">;
  </font><font color="#000080">STR sEntrada</font><font color="#808080">, </font><font color="#000080">sres</font><font color="#808080">, </font><font color="#000080">sTexto</font><font color="#808080">, </font><font color="#000080">sMsgErro</font><font color="#808080">, </font><font color="#000080">sLocal</font><font color="#808080">;
  </font><font color="#0000FF"><b>int </b></font><font color="#000080">nTexto</font><font color="#808080">, </font><font color="#000080">nTentativas</font><font color="#808080">, </font><font color="#000080">ncont</font><font color="#808080">, </font><font color="#000080">nPosChave</font><font color="#808080">, </font><font color="#000080">nTamChave</font><font color="#808080">, </font><font color="#000080">nTamLinha</font><font color="#808080">;

</font><font color="#000080">va_list lparams</font><font color="#808080">;
</font><font color="#000080">va_start</font><font color="#808080">(</font><font color="#000080">lparams</font><font color="#808080">, </font><font color="#000080">sArq</font><font color="#808080">);
</font><font color="#000080">sreg </font><font color="#808080">= </font><font color="#000080">va_arg</font><font color="#808080">(</font><font color="#000080">lparams</font><font color="#808080">,</font><font color="#0000FF"><b>enum </b></font><font color="#000080">ctArqs</font><font color="#808080">);
</font><font color="#000080">nTexto </font><font color="#808080">= </font><font color="#000080">va_arg</font><font color="#808080">(</font><font color="#000080">lparams</font><font color="#808080">,</font><font color="#0000FF"><b>int</b></font><font color="#808080">); 
</font><font color="#000080">sEntrada </font><font color="#808080">= </font><font color="#000080">va_arg</font><font color="#808080">(</font><font color="#000080">lparams</font><font color="#808080">,</font><font color="#000080">STR</font><font color="#808080">);
</font><font color="#000080">nTentativas </font><font color="#808080">= </font><font color="#000080">va_arg</font><font color="#808080">(</font><font color="#000080">lparams</font><font color="#808080">,</font><font color="#0000FF"><b>int</b></font><font color="#808080">); 
</font><font color="#000080">bPesqRelativa </font><font color="#808080">= </font><font color="#000080">va_arg</font><font color="#808080">(</font><font color="#000080">lparams</font><font color="#808080">,</font><font color="#0000FF"><b>int</b></font><font color="#808080">); 
</font><font color="#000080">bTipoEntrada </font><font color="#808080">= </font><font color="#000080">va_arg</font><font color="#808080">(</font><font color="#000080">lparams</font><font color="#808080">,</font><font color="#0000FF"><b>enum </b></font><font color="#000080">ctTipo</font><font color="#808080">);
</font><font color="#000080">va_end</font><font color="#808080">(</font><font color="#000080">lparams</font><font color="#808080">);

</font><font color="#000080">sres </font><font color="#808080">= [</font><font color="#000080">self alocaString</font><font color="#808080">: </font><font color="#000080">TAM_MAX_STR</font><font color="#808080">];
</font><font color="#000080">sLocal </font><font color="#808080">= [</font><font color="#000080">self alocaString</font><font color="#808080">: </font><font color="#000080">TAM_MAX_STR</font><font color="#808080">];

</font><font color="#000080">strcpy</font><font color="#808080">(</font><font color="#000080">sLocal</font><font color="#808080">, </font><font color="#000080">sEntrada</font><font color="#808080">);

</font><font color="#000080">nTamLinha </font><font color="#808080">= [</font><font color="#000080">self tamReg</font><font color="#808080">: </font><font color="#000080">sreg</font><font color="#808080">];
</font><font color="#000080">sMsgErro </font><font color="#808080">= [</font><font color="#000080">self rotulo</font><font color="#808080">: </font><font color="#000080">sreg</font><font color="#808080">,</font><font color="#FF0000">0</font><font color="#808080">];
</font><font color="#000080">sTexto </font><font color="#808080">= [</font><font color="#000080">self rotulo</font><font color="#808080">: </font><font color="#000080">sreg</font><font color="#808080">,</font><font color="#000080">nTexto</font><font color="#808080">];
</font><font color="#000080">nPosChave </font><font color="#808080">= </font><font color="#000080">g_nPosChave</font><font color="#808080">;
</font><font color="#000080">nTamChave </font><font color="#808080">= </font><font color="#000080">g_nTamChave</font><font color="#808080">;

</font><font color="#000080">ncont </font><font color="#808080">= </font><font color="#FF0000">1</font><font color="#808080">;
</font><font color="#000080">bQuebra </font><font color="#808080">= </font><font color="#000080">NO</font><font color="#808080">;
  </font><font color="#0000FF"><b>while </b></font><font color="#808080">((</font><font color="#000080">bQuebra</font><font color="#808080">==</font><font color="#000080">NO</font><font color="#808080">) &amp;&amp; (</font><font color="#000080">ncont </font><font color="#808080">&lt;= </font><font color="#000080">nTentativas </font><font color="#808080">)) {
    </font><font color="#0000FF"><b>if </b></font><font color="#808080">(</font><font color="#000080">bTipoEntrada</font><font color="#808080">==</font><font color="#000080">opTexto</font><font color="#808080">) {
      </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#000080">sTexto</font><font color="#808080">);
      </font><font color="#000080">strcpy</font><font color="#808080">(</font><font color="#000080">sLocal</font><font color="#808080">, [</font><font color="#000080">self digita</font><font color="#808080">: </font><font color="#000080">TAM_MAX_STR</font><font color="#808080">]);
    } </font><font color="#0000FF"><b>else if </b></font><font color="#808080">(</font><font color="#000080">bTipoEntrada</font><font color="#808080">==</font><font color="#000080">opNumero</font><font color="#808080">)
       </font><font color="#000080">strcpy</font><font color="#808080">(</font><font color="#000080">sLocal</font><font color="#808080">, [</font><font color="#000080">self validaNumero</font><font color="#808080">: </font><font color="#000080">sTexto</font><font color="#808080">,</font><font color="#000080">sLocal</font><font color="#808080">]);
    </font><font color="#0000FF"><b>else if </b></font><font color="#808080">(</font><font color="#000080">bTipoEntrada</font><font color="#808080">==</font><font color="#000080">opData</font><font color="#808080">)
       </font><font color="#000080">strcpy</font><font color="#808080">(</font><font color="#000080">sLocal</font><font color="#808080">, [</font><font color="#000080">self validaDataHora</font><font color="#808080">: </font><font color="#000080">sTexto</font><font color="#808080">,</font><font color="#000080">sLocal</font><font color="#808080">,</font><font color="#000080">YES</font><font color="#808080">]);
    </font><font color="#0000FF"><b>else if </b></font><font color="#808080">(</font><font color="#000080">bTipoEntrada</font><font color="#808080">==</font><font color="#000080">opDataHora</font><font color="#808080">)
       </font><font color="#000080">strcpy</font><font color="#808080">(</font><font color="#000080">sLocal</font><font color="#808080">, [</font><font color="#000080">self validaDataHora</font><font color="#808080">: </font><font color="#000080">sTexto</font><font color="#808080">,</font><font color="#000080">sLocal</font><font color="#808080">,</font><font color="#000080">NO</font><font color="#808080">]);
    </font><font color="#0000FF"><b>else if </b></font><font color="#808080">(</font><font color="#000080">bTipoEntrada</font><font color="#808080">==</font><font color="#000080">opSenha</font><font color="#808080">) {
       </font><font color="#000080">strcpy</font><font color="#808080">(</font><font color="#000080">sLocal</font><font color="#808080">, [</font><font color="#000080">self digitaSenha</font><font color="#808080">: </font><font color="#000080">sTexto</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">]);
    }

    </font><font color="#0000FF"><b>if </b></font><font color="#808080">(</font><font color="#000080">bPesqRelativa</font><font color="#808080">==</font><font color="#000080">YES</font><font color="#808080">) {
       </font><font color="#0000FF"><b>if </b></font><font color="#808080">([</font><font color="#000080">self ListarTodos</font><font color="#808080">: </font><font color="#000080">sArq</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#000080">sLocal</font><font color="#808080">, 
            </font><font color="#000080">nPosChave</font><font color="#808080">, </font><font color="#000080">nTamChave</font><font color="#808080">, </font><font color="#000080">nTamLinha</font><font color="#808080">, </font><font color="#000080">QTD_MAX_LINHA</font><font color="#808080">, </font><font color="#000080">YES</font><font color="#808080">]==</font><font color="#000080">YES</font><font color="#808080">)
        </font><font color="#000080">strcpy</font><font color="#808080">(</font><font color="#000080">sres</font><font color="#808080">, </font><font color="#800000">&quot; &quot;</font><font color="#808080">);
    } </font><font color="#0000FF"><b>else
       </b></font><font color="#000080">sres </font><font color="#808080">= [</font><font color="#000080">self pesqArq</font><font color="#808080">: </font><font color="#000080">sArq</font><font color="#808080">, </font><font color="#000080">sLocal</font><font color="#808080">, </font><font color="#000080">nPosChave</font><font color="#808080">, </font><font color="#000080">nTamChave</font><font color="#808080">, </font><font color="#000080">nTamLinha</font><font color="#808080">];

    </font><font color="#0000FF"><b>if </b></font><font color="#808080">(</font><font color="#000080">strcmp</font><font color="#808080">(</font><font color="#000080">sres</font><font color="#808080">,</font><font color="#800000">&quot;&quot;</font><font color="#808080">)==</font><font color="#FF0000">0</font><font color="#808080">)
       </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;%s\n&quot;</font><font color="#808080">,</font><font color="#000080">sMsgErro</font><font color="#808080">);
    </font><font color="#0000FF"><b>else
       </b></font><font color="#000080">bQuebra </font><font color="#808080">= </font><font color="#000080">YES</font><font color="#808080">;

    </font><font color="#000080">ncont</font><font color="#808080">++;
  }
</font><font color="#0000FF"><b>return </b></font><font color="#000080">sres</font><font color="#808080">;
}
<i>/*------------------------------------------------------------------------------
Mostra a tela de splash do sistema.
------------------------------------------------------------------------------*/
</i>- </font><font color="#000080">frmSplash
</font><font color="#808080">{ </font><font color="#0000FF"><b>int </b></font><font color="#000080">cont</font><font color="#808080">;

 </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;*---------------------------------------&quot; </font><font color="#FF00FF">\
 </font><font color="#800000">&quot;-------------------------------------*\n&quot;</font><font color="#808080">);
 </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;| LL    II VV   VV RRRRR  UU  UU   SSSS &quot; </font><font color="#FF00FF">\
 </font><font color="#800000">&quot;VV   VV II RRRRR  TTTT UU  UU   SSSS |\n&quot;</font><font color="#808080">);
 </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;| LL    II  VV VV  RR   R UU  UU  SS    &quot; </font><font color="#FF00FF">\
 </font><font color="#800000">&quot; VV VV  II RR   R  TT  UU  UU  SS    |\n&quot;</font><font color="#808080">);
 </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;| LL    II   VVV   RRRRR  UU  UU    SS  &quot; </font><font color="#FF00FF">\
 </font><font color="#800000">&quot;  VVV   II RRRRR   TT  UU  UU    SS  |\n&quot;</font><font color="#808080">);
 </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;| LLLLL II    V    RR   R  UUUU  SSSS   &quot; </font><font color="#FF00FF">\
 </font><font color="#800000">&quot;   V    II RR   R  TT   UUUU  SSSS   |\n&quot;</font><font color="#808080">);
 </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;*---------------------------------------&quot; </font><font color="#FF00FF">\
 </font><font color="#800000">&quot;-------------------------------------*\n&quot;</font><font color="#808080">);
 </font><font color="#0000FF"><b>for</b></font><font color="#808080">(</font><font color="#000080">cont </font><font color="#808080">= </font><font color="#FF0000">1</font><font color="#808080">; </font><font color="#000080">cont </font><font color="#808080">&lt;= </font><font color="#FF0000">18</font><font color="#808080">; </font><font color="#000080">cont</font><font color="#808080">++) </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;\n&quot;</font><font color="#808080">);
 </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#000080">MSG_PRESS</font><font color="#808080">);
 </font><font color="#000080">fgetc</font><font color="#808080">(</font><font color="#000080">stdin</font><font color="#808080">);
 </font><font color="#0000FF"><b>return </b></font><font color="#000080">self</font><font color="#808080">;
}
<i>/*------------------------------------------------------------------------------
Mostra a tela de sobre do sistema.
------------------------------------------------------------------------------*/
</i>- </font><font color="#000080">frmSobre
</font><font color="#808080">{ </font><font color="#0000FF"><b>int </b></font><font color="#000080">cont</font><font color="#808080">;
  </font><font color="#0000FF"><b>char </b></font><font color="#000080">opcao</font><font color="#808080">;

 </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;*------------------------------------------------------------*\n&quot;</font><font color="#808080">);
 </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;|  LL        II  VV       VV  RRRRRRR   UU    UU   SSSSSSS   |\n&quot;</font><font color="#808080">);
 </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;|  LL        II   VV     VV   RR     R  UU    UU  SS         |\n&quot;</font><font color="#808080">);
 </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;|  LL        II    VV   VV    RR     R  UU    UU   SSSS      |\n&quot;</font><font color="#808080">);
 </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;|  LL        II     VV VV     RRRRRRR   UU    UU     SSSS    |\n&quot;</font><font color="#808080">);
 </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;|  LLLL      II      VVV      RR RR     UU    UU        SS   |\n&quot;</font><font color="#808080">);
 </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;|  LLLLLLLL  II       V       RR   RR    UUUUUU   SSSSSSSS   |\n&quot;</font><font color="#808080">);
 </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;|                                                            |\n&quot;</font><font color="#808080">);
 </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;|  VV       VV  II  RRRRRRR   TTTTTTTT  UU    UU   SSSSSSS   |\n&quot;</font><font color="#808080">);
 </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;|   VV     VV   II  RR     R     TT     UU    UU  SS         |\n&quot;</font><font color="#808080">);
 </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;|    VV   VV    II  RR     R     TT     UU    UU   SSSS      |\n&quot;</font><font color="#808080">);
 </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;|     VV VV     II  RRRRRRR      TT     UU    UU     SSSS    |\n&quot;</font><font color="#808080">);
 </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;|      VVV      II  RR RR        TT     UU    UU        SS   |\n&quot;</font><font color="#808080">);
 </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;|       V       II  RR   RR      TT      UUUUUU   SSSSSSSS   |\n&quot;</font><font color="#808080">);
 </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;|                                                            |\n&quot;</font><font color="#808080">);
 </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;|                                               Versao 1.0.0 |\n&quot;</font><font color="#808080">);
 </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;| Sistema integrante do projeto Livrus Virtus.               |\n&quot;</font><font color="#808080">);
 </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;| Todos os direitos reservados para Henrique F. de Souza.    |\n&quot;</font><font color="#808080">);
 </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;| Versao programada na linguagem Objective-C.                |\n&quot;</font><font color="#808080">);
 </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;*------------------------------------------------------------*\n&quot;</font><font color="#808080">);
 </font><font color="#0000FF"><b>for</b></font><font color="#808080">(</font><font color="#000080">cont </font><font color="#808080">= </font><font color="#FF0000">1</font><font color="#808080">; </font><font color="#000080">cont </font><font color="#808080">&lt;= </font><font color="#FF0000">4</font><font color="#808080">; </font><font color="#000080">cont</font><font color="#808080">++) </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;\n&quot;</font><font color="#808080">);
 </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#000080">MSG_PRESS</font><font color="#808080">);
 </font><font color="#000080">fscanf</font><font color="#808080">(</font><font color="#000080">stdin</font><font color="#808080">, </font><font color="#800000">&quot;%c%c&quot;</font><font color="#808080">, &amp;</font><font color="#000080">opcao</font><font color="#808080">, &amp;</font><font color="#000080">opcao</font><font color="#808080">);
 </font><font color="#0000FF"><b>return </b></font><font color="#000080">self</font><font color="#808080">; 
}
<i>/*------------------------------------------------------------------------------
Mostra a tela de login do sistema.
retorna - se o login foi validado corretamente
------------------------------------------------------------------------------*/
</i>- (</font><font color="#000080">BOOL</font><font color="#808080">) </font><font color="#000080">frmLogin
</font><font color="#808080">{ </font><font color="#000080">BOOL bret</font><font color="#808080">;
  </font><font color="#000080">STR slinha</font><font color="#808080">;

  </font><font color="#000080">bret </font><font color="#808080">= </font><font color="#000080">NO</font><font color="#808080">;
  </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;*--------------------------------------------------------------*\n&quot;</font><font color="#808080">);
  </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;| Login do sistema                                             |\n&quot;</font><font color="#808080">);
  </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;*--------------------------------------------------------------*\n&quot;</font><font color="#808080">);
  </font><font color="#000080">slinha </font><font color="#808080">= [</font><font color="#000080">self validaEntrada</font><font color="#808080">: </font><font color="#000080">tfUsuario</font><font color="#808080">, </font><font color="#000080">opUsuario</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#000080">tUsuario</font><font color="#808080">.</font><font color="#000080">login</font><font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">,
        </font><font color="#000080">NO</font><font color="#808080">, </font><font color="#000080">opTexto</font><font color="#808080">];
  </font><font color="#0000FF"><b>if </b></font><font color="#808080">(</font><font color="#000080">strcmp</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">,</font><font color="#800000">&quot;&quot;</font><font color="#808080">)!=</font><font color="#FF0000">0</font><font color="#808080">) {
     </font><font color="#000080">strcpy</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">, [</font><font color="#000080">self validaEntrada</font><font color="#808080">: </font><font color="#000080">tfUsuario</font><font color="#808080">, </font><font color="#000080">opUsuario</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">, 
        </font><font color="#000080">tUsuario</font><font color="#808080">.</font><font color="#000080">senha</font><font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">, </font><font color="#000080">NO</font><font color="#808080">, </font><font color="#000080">opSenha</font><font color="#808080">]);
     </font><font color="#0000FF"><b>if </b></font><font color="#808080">(</font><font color="#000080">strcmp</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">,</font><font color="#800000">&quot;&quot;</font><font color="#808080">)!=</font><font color="#FF0000">0</font><font color="#808080">) {
        </font><font color="#000080">strcpy</font><font color="#808080">(</font><font color="#000080">tUsuario</font><font color="#808080">.</font><font color="#000080">login</font><font color="#808080">, [</font><font color="#000080">self trim</font><font color="#808080">: [</font><font color="#000080">self copy</font><font color="#808080">: </font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">]]);
        </font><font color="#000080">strcpy</font><font color="#808080">(</font><font color="#000080">tUsuario</font><font color="#808080">.</font><font color="#000080">senha</font><font color="#808080">, [</font><font color="#000080">self trim</font><font color="#808080">: [</font><font color="#000080">self copy</font><font color="#808080">: </font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">11</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">]]);
        </font><font color="#000080">bret </font><font color="#808080">= </font><font color="#000080">YES</font><font color="#808080">;
     }
  }
  </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;\n&quot;</font><font color="#808080">);
  </font><font color="#0000FF"><b>return </b></font><font color="#000080">bret</font><font color="#808080">;
}
<i>/*------------------------------------------------------------------------------
Mostra os menus do sistema.
num - o n&uacute;mero do menu
------------------------------------------------------------------------------*/
</i>- </font><font color="#000080">menu</font><font color="#808080">: (</font><font color="#0000FF"><b>int</b></font><font color="#808080">) </font><font color="#000080">num
</font><font color="#808080">{
 </font><font color="#0000FF"><b>if </b></font><font color="#808080">(</font><font color="#000080">num</font><font color="#808080">==</font><font color="#FF0000">1</font><font color="#808080">) {
  </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;*--------------------------------------------------------------*\n&quot;</font><font color="#808080">);
  </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;| (C)adastros        (P)esquisas     (V)endas        (O)p&ccedil;&otilde;es  |\n&quot;</font><font color="#808080">);
  </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;*--------------------------------------------------------------*\n&quot;</font><font color="#808080">);
 } </font><font color="#0000FF"><b>else if </b></font><font color="#808080">(</font><font color="#000080">num</font><font color="#808080">==</font><font color="#FF0000">2</font><font color="#808080">) {
   </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;*---------------------------------*\n&quot;</font><font color="#808080">);
   </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;| 01. Cadastro de Assuntos        |\n&quot;</font><font color="#808080">);
   </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;| 02. Cadastro de Autores         |\n&quot;</font><font color="#808080">);
   </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;| 03. Cadastro de Editoras        |\n&quot;</font><font color="#808080">);
   </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;| 04. Cadastro de Endere&ccedil;os       |\n&quot;</font><font color="#808080">);
   </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;| 05. Cadastro de Idiomas         |\n&quot;</font><font color="#808080">);
   </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;| 06. Cadastro de Pa&iacute;ses          |\n&quot;</font><font color="#808080">);
   </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;| 07. Cadastro de Profiss&otilde;es      |\n&quot;</font><font color="#808080">);
   </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;| 08. Cadastro de Clientes        |\n&quot;</font><font color="#808080">);
   </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;| 09. Cadastro de Livros          |\n&quot;</font><font color="#808080">);
   </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;| 10. Voltar ao menu              |\n&quot;</font><font color="#808080">);
   </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;*---------------------------------*\n&quot;</font><font color="#808080">);
 } </font><font color="#0000FF"><b>else if </b></font><font color="#808080">(</font><font color="#000080">num</font><font color="#808080">==</font><font color="#FF0000">3</font><font color="#808080">) {
   </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;*---------------------------------*\n&quot;</font><font color="#808080">);
   </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;| 01. Consulta de Assuntos        |\n&quot;</font><font color="#808080">);
   </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;| 02. Consulta de Autores         |\n&quot;</font><font color="#808080">);
   </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;| 03. Consulta de Editoras        |\n&quot;</font><font color="#808080">);
   </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;| 04. Consulta de Endere&ccedil;os       |\n&quot;</font><font color="#808080">);
   </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;| 05. Consulta de Idiomas         |\n&quot;</font><font color="#808080">);
   </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;| 06. Consulta de Pa&iacute;ses          |\n&quot;</font><font color="#808080">);
   </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;| 07. Consulta de Profiss&otilde;es      |\n&quot;</font><font color="#808080">);
   </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;| 08. Consulta de Clientes        |\n&quot;</font><font color="#808080">);
   </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;| 09. Consulta de Livros          |\n&quot;</font><font color="#808080">);
   </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;| 10. Voltar ao menu              |\n&quot;</font><font color="#808080">);
   </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;*---------------------------------*\n&quot;</font><font color="#808080">);
 } </font><font color="#0000FF"><b>else if </b></font><font color="#808080">(</font><font color="#000080">num</font><font color="#808080">==</font><font color="#FF0000">4</font><font color="#808080">) {
   </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;*---------------------------------*\n&quot;</font><font color="#808080">);
   </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;| 01. Vender Livros               |\n&quot;</font><font color="#808080">);
   </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;| 02. Vendas Realizadas           |\n&quot;</font><font color="#808080">);
   </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;| 03. Voltar ao menu              |\n&quot;</font><font color="#808080">);
   </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;*---------------------------------*\n&quot;</font><font color="#808080">);
 } </font><font color="#0000FF"><b>else if </b></font><font color="#808080">(</font><font color="#000080">num</font><font color="#808080">==</font><font color="#FF0000">5</font><font color="#808080">) {
   </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;*---------------------------------*\n&quot;</font><font color="#808080">);
   </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;| 01. Alterar senha               |\n&quot;</font><font color="#808080">);
   </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;| 02. Sobre o sistema             |\n&quot;</font><font color="#808080">);
   </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;| 03. Sair do sistema             |\n&quot;</font><font color="#808080">);
   </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;| 04. Voltar ao menu              |\n&quot;</font><font color="#808080">);
   </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;*---------------------------------*\n&quot;</font><font color="#808080">);
 } </font><font color="#0000FF"><b>else if </b></font><font color="#808080">(</font><font color="#000080">num</font><font color="#808080">==</font><font color="#FF0000">6</font><font color="#808080">) {
   </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;*--------------------------------------------------------------*\n&quot;</font><font color="#808080">);
   </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;| (1) Novo  (2) Pesquisar   (3) Voltar ao menu                 |\n&quot;</font><font color="#808080">);
   </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;*--------------------------------------------------------------*\n&quot;</font><font color="#808080">);
 } </font><font color="#0000FF"><b>else if </b></font><font color="#808080">(</font><font color="#000080">num</font><font color="#808080">==</font><font color="#FF0000">7</font><font color="#808080">) {
   </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;*--------------------------------------------------------------*\n&quot;</font><font color="#808080">);
   </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;| (1) Salvar inclus&atilde;o       (2) Voltar ao menu                 |\n&quot;</font><font color="#808080">);
   </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;*--------------------------------------------------------------*\n&quot;</font><font color="#808080">);
 } </font><font color="#0000FF"><b>else if </b></font><font color="#808080">(</font><font color="#000080">num</font><font color="#808080">==</font><font color="#FF0000">8</font><font color="#808080">) {
   </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;*--------------------------------------------------------------*\n&quot;</font><font color="#808080">);
   </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;| (1) Alterar       (2) Excluir     (3) Voltar ao menu         |\n&quot;</font><font color="#808080">);
   </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;*--------------------------------------------------------------*\n&quot;</font><font color="#808080">);
 } </font><font color="#0000FF"><b>else if </b></font><font color="#808080">(</font><font color="#000080">num</font><font color="#808080">==</font><font color="#FF0000">9</font><font color="#808080">) {
   </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;*--------------------------------------------------------------*\n&quot;</font><font color="#808080">);
   </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;| (1) Salvar altera&ccedil;&atilde;o      (2) Voltar ao menu                 |\n&quot;</font><font color="#808080">);
   </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;*--------------------------------------------------------------*\n&quot;</font><font color="#808080">);
 } </font><font color="#0000FF"><b>else if </b></font><font color="#808080">(</font><font color="#000080">num</font><font color="#808080">==</font><font color="#FF0000">10</font><font color="#808080">) {
   </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;*--------------------------------------------------------------*\n&quot;</font><font color="#808080">);
   </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;| Certeza de excluir? (S/N)                                    |\n&quot;</font><font color="#808080">);
   </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;*--------------------------------------------------------------*\n&quot;</font><font color="#808080">);
 } </font><font color="#0000FF"><b>else if </b></font><font color="#808080">(</font><font color="#000080">num</font><font color="#808080">==</font><font color="#FF0000">11</font><font color="#808080">) {
   </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;*--------------------------------------------------------------*\n&quot;</font><font color="#808080">);
   </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;| Deseja sair do sistema? (S/N)                                |\n&quot;</font><font color="#808080">);
   </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;*--------------------------------------------------------------*\n&quot;</font><font color="#808080">);
 } </font><font color="#0000FF"><b>else if </b></font><font color="#808080">(</font><font color="#000080">num</font><font color="#808080">==</font><font color="#FF0000">12</font><font color="#808080">) {
   </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;*--------------------------------------------------------------*\n&quot;</font><font color="#808080">);
   </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;| (1) Pesquisar  (2) Listar todos   (3) Voltar ao menu         |\n&quot;</font><font color="#808080">);
   </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;*--------------------------------------------------------------*\n&quot;</font><font color="#808080">);
 } </font><font color="#0000FF"><b>else if </b></font><font color="#808080">(</font><font color="#000080">num</font><font color="#808080">==</font><font color="#FF0000">13</font><font color="#808080">) {
   </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;*--------------------------------------------------------------*\n&quot;</font><font color="#808080">);
   </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;| Deseja continuar? (S/N)                                      |\n&quot;</font><font color="#808080">);
   </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;*--------------------------------------------------------------*\n&quot;</font><font color="#808080">);
 } </font><font color="#0000FF"><b>else if </b></font><font color="#808080">(</font><font color="#000080">num</font><font color="#808080">==</font><font color="#FF0000">14</font><font color="#808080">) {
   </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;*--------------------------------------------------------------*\n&quot;</font><font color="#808080">);
   </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;| Salvar inclus&atilde;o (S/N)                                        |\n&quot;</font><font color="#808080">);
   </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;*--------------------------------------------------------------*\n&quot;</font><font color="#808080">);
 }
 </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#000080">MSG_OPCAO</font><font color="#808080">);
 </font><font color="#0000FF"><b>return </b></font><font color="#000080">self</font><font color="#808080">;
}
<i>/*------------------------------------------------------------------------------
Realiza os cadastros de acordo com o tipo de arquivo.
sreg - o tipo de arquivo
sacao - a a&ccedil;&atilde;o a ser realizada
------------------------------------------------------------------------------*/
</i>- </font><font color="#000080">frmCadastros</font><font color="#808080">: (</font><font color="#0000FF"><b>enum </b></font><font color="#000080">ctArqs</font><font color="#808080">) </font><font color="#000080">sreg</font><font color="#808080">, ... 
{ 
  </font><font color="#0000FF"><b>enum </b></font><font color="#000080">ctAcao sacao</font><font color="#808080">;
  </font><font color="#000080">STR slinha</font><font color="#808080">;

</font><font color="#000080">va_list lparams</font><font color="#808080">;
</font><font color="#000080">va_start</font><font color="#808080">(</font><font color="#000080">lparams</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">);
</font><font color="#000080">sacao </font><font color="#808080">= </font><font color="#000080">va_arg</font><font color="#808080">(</font><font color="#000080">lparams</font><font color="#808080">,</font><font color="#0000FF"><b>enum </b></font><font color="#000080">ctAcao</font><font color="#808080">);
</font><font color="#000080">va_end</font><font color="#808080">(</font><font color="#000080">lparams</font><font color="#808080">);

</font><font color="#0000FF"><b>if </b></font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">==</font><font color="#000080">opAssunto</font><font color="#808080">) {
   </font><font color="#0000FF"><b>if </b></font><font color="#808080">(</font><font color="#000080">sacao</font><font color="#808080">==</font><font color="#000080">opNovo</font><font color="#808080">) {
      </font><font color="#000080">strcpy</font><font color="#808080">(</font><font color="#000080">tAssunto</font><font color="#808080">.</font><font color="#000080">codigo</font><font color="#808080">, [</font><font color="#000080">self pesqMaxCod</font><font color="#808080">: </font><font color="#000080">tfAssunto</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">, [</font><font color="#000080">self tamReg</font><font color="#808080">: </font><font color="#000080">sreg</font><font color="#808080">]]);
      [</font><font color="#000080">self mostrarDados</font><font color="#808080">: </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">];
      [</font><font color="#000080">self subMenu</font><font color="#808080">: </font><font color="#FF0000">7</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">];
   } </font><font color="#0000FF"><b>else if </b></font><font color="#808080">(</font><font color="#000080">sacao</font><font color="#808080">==</font><font color="#000080">opPesquisar</font><font color="#808080">) {
     </font><font color="#000080">slinha </font><font color="#808080">= [</font><font color="#000080">self validaEntrada</font><font color="#808080">: </font><font color="#000080">tfAssunto</font><font color="#808080">,</font><font color="#000080">sreg</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#000080">tAssunto</font><font color="#808080">.</font><font color="#000080">codigo</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#000080">NO</font><font color="#808080">,</font><font color="#000080">opNumero</font><font color="#808080">];
      </font><font color="#0000FF"><b>if </b></font><font color="#808080">(</font><font color="#000080">strcmp</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">,</font><font color="#800000">&quot;&quot;</font><font color="#808080">)!=</font><font color="#FF0000">0</font><font color="#808080">) {
        [</font><font color="#000080">self mostrarDados</font><font color="#808080">: </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">];
        [</font><font color="#000080">self mostrarDados</font><font color="#808080">: </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">];
        [</font><font color="#000080">self subMenu</font><font color="#808080">: </font><font color="#FF0000">8</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">];
      }
   } </font><font color="#0000FF"><b>else if </b></font><font color="#808080">(</font><font color="#000080">sacao</font><font color="#808080">==</font><font color="#000080">opAlterar</font><font color="#808080">) {
      [</font><font color="#000080">self mostrarDados</font><font color="#808080">: </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">];
      [</font><font color="#000080">self subMenu</font><font color="#808080">: </font><font color="#FF0000">9</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">];
   } </font><font color="#0000FF"><b>else if </b></font><font color="#808080">(</font><font color="#000080">sacao</font><font color="#808080">==</font><font color="#000080">opExcluir</font><font color="#808080">) {
      [</font><font color="#000080">self subMenu</font><font color="#808080">: </font><font color="#FF0000">10</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">];
   }
} </font><font color="#0000FF"><b>else if </b></font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">==</font><font color="#000080">opAutor</font><font color="#808080">) {
   </font><font color="#0000FF"><b>if </b></font><font color="#808080">(</font><font color="#000080">sacao</font><font color="#808080">==</font><font color="#000080">opNovo</font><font color="#808080">) {
      </font><font color="#000080">strcpy</font><font color="#808080">(</font><font color="#000080">tAutor</font><font color="#808080">.</font><font color="#000080">codigo</font><font color="#808080">, [</font><font color="#000080">self pesqMaxCod</font><font color="#808080">: </font><font color="#000080">tfAutor</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">, [</font><font color="#000080">self tamReg</font><font color="#808080">: </font><font color="#000080">sreg</font><font color="#808080">]]);
      [</font><font color="#000080">self mostrarDados</font><font color="#808080">: </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">];
      [</font><font color="#000080">self subMenu</font><font color="#808080">: </font><font color="#FF0000">7</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">];
   } </font><font color="#0000FF"><b>else if </b></font><font color="#808080">(</font><font color="#000080">sacao</font><font color="#808080">==</font><font color="#000080">opPesquisar</font><font color="#808080">) {
      </font><font color="#000080">slinha </font><font color="#808080">= [</font><font color="#000080">self validaEntrada</font><font color="#808080">: </font><font color="#000080">tfAutor</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#000080">tAutor</font><font color="#808080">.</font><font color="#000080">codigo</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#000080">NO</font><font color="#808080">,</font><font color="#000080">opNumero</font><font color="#808080">];
      </font><font color="#0000FF"><b>if </b></font><font color="#808080">(</font><font color="#000080">strcmp</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">,</font><font color="#800000">&quot;&quot;</font><font color="#808080">)!=</font><font color="#FF0000">0</font><font color="#808080">) {
        [</font><font color="#000080">self mostrarDados</font><font color="#808080">: </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">];
        [</font><font color="#000080">self mostrarDados</font><font color="#808080">: </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">];
        [</font><font color="#000080">self subMenu</font><font color="#808080">: </font><font color="#FF0000">8</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">];
      }
   } </font><font color="#0000FF"><b>else if </b></font><font color="#808080">(</font><font color="#000080">sacao</font><font color="#808080">==</font><font color="#000080">opAlterar</font><font color="#808080">) {
      [</font><font color="#000080">self mostrarDados</font><font color="#808080">: </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">];
      [</font><font color="#000080">self subMenu</font><font color="#808080">: </font><font color="#FF0000">9</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">];
   } </font><font color="#0000FF"><b>else if </b></font><font color="#808080">(</font><font color="#000080">sacao</font><font color="#808080">==</font><font color="#000080">opExcluir</font><font color="#808080">) {
      [</font><font color="#000080">self subMenu</font><font color="#808080">: </font><font color="#FF0000">10</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">];
   }
} </font><font color="#0000FF"><b>else if </b></font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">==</font><font color="#000080">opEditora</font><font color="#808080">) {
   </font><font color="#0000FF"><b>if </b></font><font color="#808080">(</font><font color="#000080">sacao</font><font color="#808080">==</font><font color="#000080">opNovo</font><font color="#808080">) {
      </font><font color="#000080">strcpy</font><font color="#808080">(</font><font color="#000080">tEditora</font><font color="#808080">.</font><font color="#000080">codigo</font><font color="#808080">, [</font><font color="#000080">self pesqMaxCod</font><font color="#808080">: </font><font color="#000080">tfEditora</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">, [</font><font color="#000080">self tamReg</font><font color="#808080">: </font><font color="#000080">sreg</font><font color="#808080">]]);
      [</font><font color="#000080">self mostrarDados</font><font color="#808080">: </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">];
      [</font><font color="#000080">self subMenu</font><font color="#808080">: </font><font color="#FF0000">7</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">];
   } </font><font color="#0000FF"><b>else if </b></font><font color="#808080">(</font><font color="#000080">sacao</font><font color="#808080">==</font><font color="#000080">opPesquisar</font><font color="#808080">) {
      </font><font color="#000080">slinha </font><font color="#808080">= [</font><font color="#000080">self validaEntrada</font><font color="#808080">: </font><font color="#000080">tfEditora</font><font color="#808080">,</font><font color="#000080">sreg</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#000080">tEditora</font><font color="#808080">.</font><font color="#000080">codigo</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#000080">NO</font><font color="#808080">,</font><font color="#000080">opNumero</font><font color="#808080">];
      </font><font color="#0000FF"><b>if </b></font><font color="#808080">(</font><font color="#000080">strcmp</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">,</font><font color="#800000">&quot;&quot;</font><font color="#808080">)!=</font><font color="#FF0000">0</font><font color="#808080">) {
        [</font><font color="#000080">self mostrarDados</font><font color="#808080">: </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">];
        [</font><font color="#000080">self mostrarDados</font><font color="#808080">: </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">];
        [</font><font color="#000080">self subMenu</font><font color="#808080">: </font><font color="#FF0000">8</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">];
      }
   } </font><font color="#0000FF"><b>else if </b></font><font color="#808080">(</font><font color="#000080">sacao</font><font color="#808080">==</font><font color="#000080">opAlterar</font><font color="#808080">) {
      [</font><font color="#000080">self mostrarDados</font><font color="#808080">: </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">];
      [</font><font color="#000080">self subMenu</font><font color="#808080">: </font><font color="#FF0000">9</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">];
   } </font><font color="#0000FF"><b>else if </b></font><font color="#808080">(</font><font color="#000080">sacao</font><font color="#808080">==</font><font color="#000080">opExcluir</font><font color="#808080">) {
      [</font><font color="#000080">self subMenu</font><font color="#808080">: </font><font color="#FF0000">10</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">];
   }
} </font><font color="#0000FF"><b>else if </b></font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">==</font><font color="#000080">opEndereco</font><font color="#808080">) {
   </font><font color="#0000FF"><b>if </b></font><font color="#808080">(</font><font color="#000080">sacao</font><font color="#808080">==</font><font color="#000080">opNovo</font><font color="#808080">) {
      </font><font color="#000080">strcpy</font><font color="#808080">(</font><font color="#000080">tEndereco</font><font color="#808080">.</font><font color="#000080">codigo</font><font color="#808080">, [</font><font color="#000080">self pesqMaxCod</font><font color="#808080">: </font><font color="#000080">tfEndereco</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">, [</font><font color="#000080">self tamReg</font><font color="#808080">: </font><font color="#000080">sreg</font><font color="#808080">]]);
      [</font><font color="#000080">self mostrarDados</font><font color="#808080">: </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">];
      [</font><font color="#000080">self subMenu</font><font color="#808080">: </font><font color="#FF0000">7</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">];
   } </font><font color="#0000FF"><b>else if </b></font><font color="#808080">(</font><font color="#000080">sacao</font><font color="#808080">==</font><font color="#000080">opPesquisar</font><font color="#808080">) {
      </font><font color="#000080">slinha </font><font color="#808080">= [</font><font color="#000080">self validaEntrada</font><font color="#808080">: </font><font color="#000080">tfEndereco</font><font color="#808080">,</font><font color="#000080">sreg</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#000080">tEndereco</font><font color="#808080">.</font><font color="#000080">codigo</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,
              </font><font color="#000080">NO</font><font color="#808080">,</font><font color="#000080">opNumero</font><font color="#808080">];
      </font><font color="#0000FF"><b>if </b></font><font color="#808080">(</font><font color="#000080">strcmp</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">,</font><font color="#800000">&quot;&quot;</font><font color="#808080">)!=</font><font color="#FF0000">0</font><font color="#808080">) {
        [</font><font color="#000080">self mostrarDados</font><font color="#808080">: </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">];
        [</font><font color="#000080">self mostrarDados</font><font color="#808080">: </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">];
        [</font><font color="#000080">self subMenu</font><font color="#808080">: </font><font color="#FF0000">8</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">];
      }
   } </font><font color="#0000FF"><b>else if </b></font><font color="#808080">(</font><font color="#000080">sacao</font><font color="#808080">==</font><font color="#000080">opAlterar</font><font color="#808080">) {
      [</font><font color="#000080">self mostrarDados</font><font color="#808080">: </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">];
      [</font><font color="#000080">self subMenu</font><font color="#808080">: </font><font color="#FF0000">9</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">];
   } </font><font color="#0000FF"><b>else if </b></font><font color="#808080">(</font><font color="#000080">sacao</font><font color="#808080">==</font><font color="#000080">opExcluir</font><font color="#808080">) {
      [</font><font color="#000080">self subMenu</font><font color="#808080">: </font><font color="#FF0000">10</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">];
   }
} </font><font color="#0000FF"><b>else if </b></font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">==</font><font color="#000080">opIdioma</font><font color="#808080">) {
   </font><font color="#0000FF"><b>if </b></font><font color="#808080">(</font><font color="#000080">sacao</font><font color="#808080">==</font><font color="#000080">opNovo</font><font color="#808080">) {
      </font><font color="#000080">strcpy</font><font color="#808080">(</font><font color="#000080">tIdioma</font><font color="#808080">.</font><font color="#000080">codigo</font><font color="#808080">, [</font><font color="#000080">self pesqMaxCod</font><font color="#808080">: </font><font color="#000080">tfIdioma</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">, [</font><font color="#000080">self tamReg</font><font color="#808080">: </font><font color="#000080">sreg</font><font color="#808080">]]);
      [</font><font color="#000080">self mostrarDados</font><font color="#808080">: </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">];
      [</font><font color="#000080">self subMenu</font><font color="#808080">: </font><font color="#FF0000">7</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">];
   } </font><font color="#0000FF"><b>else if </b></font><font color="#808080">(</font><font color="#000080">sacao</font><font color="#808080">==</font><font color="#000080">opPesquisar</font><font color="#808080">) {
      </font><font color="#000080">slinha </font><font color="#808080">= [</font><font color="#000080">self validaEntrada</font><font color="#808080">: </font><font color="#000080">tfIdioma</font><font color="#808080">,</font><font color="#000080">sreg</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#000080">tIdioma</font><font color="#808080">.</font><font color="#000080">codigo</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#000080">NO</font><font color="#808080">,</font><font color="#000080">opNumero</font><font color="#808080">];
      </font><font color="#0000FF"><b>if </b></font><font color="#808080">(</font><font color="#000080">strcmp</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">,</font><font color="#800000">&quot;&quot;</font><font color="#808080">)!=</font><font color="#FF0000">0</font><font color="#808080">) {
        [</font><font color="#000080">self mostrarDados</font><font color="#808080">: </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">];
        [</font><font color="#000080">self mostrarDados</font><font color="#808080">: </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">];
        [</font><font color="#000080">self subMenu</font><font color="#808080">: </font><font color="#FF0000">8</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">];
      }
   } </font><font color="#0000FF"><b>else if </b></font><font color="#808080">(</font><font color="#000080">sacao</font><font color="#808080">==</font><font color="#000080">opAlterar</font><font color="#808080">) {
      [</font><font color="#000080">self mostrarDados</font><font color="#808080">: </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">];
      [</font><font color="#000080">self subMenu</font><font color="#808080">: </font><font color="#FF0000">9</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">];
   } </font><font color="#0000FF"><b>else if </b></font><font color="#808080">(</font><font color="#000080">sacao</font><font color="#808080">==</font><font color="#000080">opExcluir</font><font color="#808080">) {
      [</font><font color="#000080">self subMenu</font><font color="#808080">: </font><font color="#FF0000">10</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">];
   }
} </font><font color="#0000FF"><b>else if </b></font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">==</font><font color="#000080">opPais</font><font color="#808080">) {
   </font><font color="#0000FF"><b>if </b></font><font color="#808080">(</font><font color="#000080">sacao</font><font color="#808080">==</font><font color="#000080">opNovo</font><font color="#808080">) {
      </font><font color="#000080">printf</font><font color="#808080">([</font><font color="#000080">self rotulo</font><font color="#808080">: </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">]);
      </font><font color="#000080">strcpy</font><font color="#808080">(</font><font color="#000080">tPais</font><font color="#808080">.</font><font color="#000080">codigo</font><font color="#808080">, [</font><font color="#000080">self digita</font><font color="#808080">: </font><font color="#0000FF"><b>sizeof</b></font><font color="#808080">(</font><font color="#000080">tPais</font><font color="#808080">.</font><font color="#000080">codigo</font><font color="#808080">)]);
      </font><font color="#000080">slinha </font><font color="#808080">= [</font><font color="#000080">self pesqArq</font><font color="#808080">: </font><font color="#000080">tfPais</font><font color="#808080">, </font><font color="#000080">tPais</font><font color="#808080">.</font><font color="#000080">codigo</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">, [</font><font color="#000080">self tamReg</font><font color="#808080">: </font><font color="#000080">sreg</font><font color="#808080">]];
      </font><font color="#0000FF"><b>if </b></font><font color="#808080">(</font><font color="#000080">strcmp</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">,</font><font color="#800000">&quot;&quot;</font><font color="#808080">)==</font><font color="#FF0000">0</font><font color="#808080">) {
         [</font><font color="#000080">self pesqLinhaExcluida</font><font color="#808080">: </font><font color="#000080">tfPais</font><font color="#808080">, [</font><font color="#000080">self tamReg</font><font color="#808080">: </font><font color="#000080">sreg</font><font color="#808080">]];
         [</font><font color="#000080">self mostrarDados</font><font color="#808080">: </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">];
         [</font><font color="#000080">self subMenu</font><font color="#808080">: </font><font color="#FF0000">7</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">];
      } </font><font color="#0000FF"><b>else </b></font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;%s\n&quot;</font><font color="#808080">,</font><font color="#000080">MSG_REGEXST</font><font color="#808080">);
   } </font><font color="#0000FF"><b>else if </b></font><font color="#808080">(</font><font color="#000080">sacao</font><font color="#808080">==</font><font color="#000080">opPesquisar</font><font color="#808080">) {
      </font><font color="#000080">slinha </font><font color="#808080">= [</font><font color="#000080">self validaEntrada</font><font color="#808080">: </font><font color="#000080">tfPais</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#000080">tPais</font><font color="#808080">.</font><font color="#000080">codigo</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#000080">NO</font><font color="#808080">, </font><font color="#000080">opTexto</font><font color="#808080">];
      </font><font color="#0000FF"><b>if </b></font><font color="#808080">(</font><font color="#000080">strcmp</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">,</font><font color="#800000">&quot;&quot;</font><font color="#808080">)!=</font><font color="#FF0000">0</font><font color="#808080">) {
        [</font><font color="#000080">self mostrarDados</font><font color="#808080">: </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">];
        [</font><font color="#000080">self mostrarDados</font><font color="#808080">: </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">];
        [</font><font color="#000080">self subMenu</font><font color="#808080">: </font><font color="#FF0000">8</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">];
      }
   } </font><font color="#0000FF"><b>else if </b></font><font color="#808080">(</font><font color="#000080">sacao</font><font color="#808080">==</font><font color="#000080">opAlterar</font><font color="#808080">) {
      </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;%s%s\n&quot;</font><font color="#808080">,[</font><font color="#000080">self rotulo</font><font color="#808080">: </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">], </font><font color="#000080">tPais</font><font color="#808080">.</font><font color="#000080">codigo</font><font color="#808080">);
      [</font><font color="#000080">self mostrarDados</font><font color="#808080">: </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">];
      [</font><font color="#000080">self subMenu</font><font color="#808080">: </font><font color="#FF0000">9</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">];
   } </font><font color="#0000FF"><b>else if </b></font><font color="#808080">(</font><font color="#000080">sacao</font><font color="#808080">==</font><font color="#000080">opExcluir</font><font color="#808080">) {
      [</font><font color="#000080">self subMenu</font><font color="#808080">: </font><font color="#FF0000">10</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">];
   }
} </font><font color="#0000FF"><b>else if </b></font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">==</font><font color="#000080">opProfissao</font><font color="#808080">) {
   </font><font color="#0000FF"><b>if </b></font><font color="#808080">(</font><font color="#000080">sacao</font><font color="#808080">==</font><font color="#000080">opNovo</font><font color="#808080">) {
      </font><font color="#000080">strcpy</font><font color="#808080">(</font><font color="#000080">tProfissao</font><font color="#808080">.</font><font color="#000080">codigo</font><font color="#808080">, [</font><font color="#000080">self pesqMaxCod</font><font color="#808080">: </font><font color="#000080">tfProfissao</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">, [</font><font color="#000080">self tamReg</font><font color="#808080">: </font><font color="#000080">sreg</font><font color="#808080">]]);
      [</font><font color="#000080">self mostrarDados</font><font color="#808080">: </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">];
      [</font><font color="#000080">self subMenu</font><font color="#808080">: </font><font color="#FF0000">7</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">];
   } </font><font color="#0000FF"><b>else if </b></font><font color="#808080">(</font><font color="#000080">sacao</font><font color="#808080">==</font><font color="#000080">opPesquisar</font><font color="#808080">) {
      </font><font color="#000080">slinha </font><font color="#808080">= [</font><font color="#000080">self validaEntrada</font><font color="#808080">: </font><font color="#000080">tfProfissao</font><font color="#808080">,</font><font color="#000080">sreg</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#000080">tProfissao</font><font color="#808080">.</font><font color="#000080">codigo</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,
              </font><font color="#000080">NO</font><font color="#808080">,</font><font color="#000080">opNumero</font><font color="#808080">];
      </font><font color="#0000FF"><b>if </b></font><font color="#808080">(</font><font color="#000080">strcmp</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">,</font><font color="#800000">&quot;&quot;</font><font color="#808080">)!=</font><font color="#FF0000">0</font><font color="#808080">) {
        [</font><font color="#000080">self mostrarDados</font><font color="#808080">: </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">];
        [</font><font color="#000080">self mostrarDados</font><font color="#808080">: </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">];
        [</font><font color="#000080">self subMenu</font><font color="#808080">: </font><font color="#FF0000">8</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">];
      }
   } </font><font color="#0000FF"><b>else if </b></font><font color="#808080">(</font><font color="#000080">sacao</font><font color="#808080">==</font><font color="#000080">opAlterar</font><font color="#808080">) {
      [</font><font color="#000080">self mostrarDados</font><font color="#808080">: </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">];
      [</font><font color="#000080">self subMenu</font><font color="#808080">: </font><font color="#FF0000">9</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">];
   } </font><font color="#0000FF"><b>else if </b></font><font color="#808080">(</font><font color="#000080">sacao</font><font color="#808080">==</font><font color="#000080">opExcluir</font><font color="#808080">) {
      [</font><font color="#000080">self subMenu</font><font color="#808080">: </font><font color="#FF0000">10</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">];
   }
} </font><font color="#0000FF"><b>else if </b></font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">==</font><font color="#000080">opLivro</font><font color="#808080">) {
   </font><font color="#0000FF"><b>if </b></font><font color="#808080">(</font><font color="#000080">sacao</font><font color="#808080">==</font><font color="#000080">opNovo</font><font color="#808080">) {
      </font><font color="#000080">printf</font><font color="#808080">([</font><font color="#000080">self rotulo</font><font color="#808080">: </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">]);
      </font><font color="#000080">strcpy</font><font color="#808080">(</font><font color="#000080">tLivro</font><font color="#808080">.</font><font color="#000080">isbn</font><font color="#808080">, [</font><font color="#000080">self digita</font><font color="#808080">: </font><font color="#0000FF"><b>sizeof</b></font><font color="#808080">(</font><font color="#000080">tLivro</font><font color="#808080">.</font><font color="#000080">isbn</font><font color="#808080">)]);
      </font><font color="#0000FF"><b>if </b></font><font color="#808080">([</font><font color="#000080">self validaISBN</font><font color="#808080">: </font><font color="#000080">tLivro</font><font color="#808080">.</font><font color="#000080">isbn</font><font color="#808080">]==</font><font color="#000080">YES</font><font color="#808080">) {
          </font><font color="#000080">slinha </font><font color="#808080">= [</font><font color="#000080">self pesqArq</font><font color="#808080">: </font><font color="#000080">tfLivro</font><font color="#808080">, </font><font color="#000080">tLivro</font><font color="#808080">.</font><font color="#000080">isbn</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">13</font><font color="#808080">, [</font><font color="#000080">self tamReg</font><font color="#808080">: </font><font color="#000080">sreg</font><font color="#808080">]];
          </font><font color="#0000FF"><b>if </b></font><font color="#808080">(</font><font color="#000080">strcmp</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">,</font><font color="#800000">&quot;&quot;</font><font color="#808080">)==</font><font color="#FF0000">0</font><font color="#808080">) {
             [</font><font color="#000080">self pesqLinhaExcluida</font><font color="#808080">: </font><font color="#000080">tfLivro</font><font color="#808080">, [</font><font color="#000080">self tamReg</font><font color="#808080">: </font><font color="#000080">sreg</font><font color="#808080">]];
             [</font><font color="#000080">self mostrarDados</font><font color="#808080">: </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">];
             [</font><font color="#000080">self subMenu</font><font color="#808080">: </font><font color="#FF0000">7</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">];
             [</font><font color="#000080">self frmCadLigados</font><font color="#808080">: </font><font color="#000080">opLivroAss</font><font color="#808080">, </font><font color="#000080">opNovo</font><font color="#808080">, </font><font color="#000080">tLivro</font><font color="#808080">.</font><font color="#000080">isbn</font><font color="#808080">];
             [</font><font color="#000080">self frmCadLigados</font><font color="#808080">: </font><font color="#000080">opLivroAut</font><font color="#808080">, </font><font color="#000080">opNovo</font><font color="#808080">, </font><font color="#000080">tLivro</font><font color="#808080">.</font><font color="#000080">isbn</font><font color="#808080">];
          } </font><font color="#0000FF"><b>else </b></font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;%s\n&quot;</font><font color="#808080">,</font><font color="#000080">MSG_REGEXST</font><font color="#808080">);
      } </font><font color="#0000FF"><b>else </b></font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;%s\n&quot;</font><font color="#808080">,</font><font color="#000080">MSG_ISBNINV</font><font color="#808080">);
   } </font><font color="#0000FF"><b>else if </b></font><font color="#808080">(</font><font color="#000080">sacao</font><font color="#808080">==</font><font color="#000080">opPesquisar</font><font color="#808080">) {
      </font><font color="#000080">slinha </font><font color="#808080">= [</font><font color="#000080">self validaEntrada</font><font color="#808080">: </font><font color="#000080">tfLivro</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#000080">tLivro</font><font color="#808080">.</font><font color="#000080">isbn</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#000080">NO</font><font color="#808080">,</font><font color="#000080">opTexto</font><font color="#808080">];
      </font><font color="#0000FF"><b>if </b></font><font color="#808080">(</font><font color="#000080">strcmp</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">,</font><font color="#800000">&quot;&quot;</font><font color="#808080">)!=</font><font color="#FF0000">0</font><font color="#808080">) {
         [</font><font color="#000080">self mostrarDados</font><font color="#808080">: </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">];
         [</font><font color="#000080">self mostrarDados</font><font color="#808080">: </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">];
         [</font><font color="#000080">self subMenu</font><font color="#808080">: </font><font color="#FF0000">8</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">];
      }
   } </font><font color="#0000FF"><b>else if </b></font><font color="#808080">(</font><font color="#000080">sacao</font><font color="#808080">==</font><font color="#000080">opAlterar</font><font color="#808080">) {
      </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;%s%s\n&quot;</font><font color="#808080">,[</font><font color="#000080">self rotulo</font><font color="#808080">: </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">], </font><font color="#000080">tLivro</font><font color="#808080">.</font><font color="#000080">isbn</font><font color="#808080">);
      [</font><font color="#000080">self mostrarDados</font><font color="#808080">: </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">];
      [</font><font color="#000080">self subMenu</font><font color="#808080">: </font><font color="#FF0000">9</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">];
      [</font><font color="#000080">self frmCadLigados</font><font color="#808080">: </font><font color="#000080">opLivroAss</font><font color="#808080">, </font><font color="#000080">opExcluir</font><font color="#808080">, </font><font color="#000080">tLivro</font><font color="#808080">.</font><font color="#000080">isbn</font><font color="#808080">];
      </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;%s\n&quot;</font><font color="#808080">,</font><font color="#800000">&quot;Assuntos dos livros exclu&iacute;dos, inclua novos!&quot;</font><font color="#808080">);
      [</font><font color="#000080">self frmCadLigados</font><font color="#808080">: </font><font color="#000080">opLivroAss</font><font color="#808080">, </font><font color="#000080">opNovo</font><font color="#808080">, </font><font color="#000080">tLivro</font><font color="#808080">.</font><font color="#000080">isbn</font><font color="#808080">];
      [</font><font color="#000080">self frmCadLigados</font><font color="#808080">: </font><font color="#000080">opLivroAut</font><font color="#808080">, </font><font color="#000080">opExcluir</font><font color="#808080">, </font><font color="#000080">tLivro</font><font color="#808080">.</font><font color="#000080">isbn</font><font color="#808080">];
      </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;%s\n&quot;</font><font color="#808080">,</font><font color="#800000">&quot;Autores dos livros exclu&iacute;dos, inclua novos!&quot;</font><font color="#808080">);
      [</font><font color="#000080">self frmCadLigados</font><font color="#808080">: </font><font color="#000080">opLivroAut</font><font color="#808080">, </font><font color="#000080">opNovo</font><font color="#808080">, </font><font color="#000080">tLivro</font><font color="#808080">.</font><font color="#000080">isbn</font><font color="#808080">];
   } </font><font color="#0000FF"><b>else if </b></font><font color="#808080">(</font><font color="#000080">sacao</font><font color="#808080">==</font><font color="#000080">opExcluir</font><font color="#808080">) {
      [</font><font color="#000080">self subMenu</font><font color="#808080">: </font><font color="#FF0000">10</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">];
      </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;%s\n&quot;</font><font color="#808080">,</font><font color="#800000">&quot;Assuntos dos livros sendo exclu&iacute;dos!&quot;</font><font color="#808080">);
      [</font><font color="#000080">self frmCadLigados</font><font color="#808080">: </font><font color="#000080">opLivroAss</font><font color="#808080">, </font><font color="#000080">opExcluir</font><font color="#808080">, </font><font color="#000080">tLivro</font><font color="#808080">.</font><font color="#000080">isbn</font><font color="#808080">];
      </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;%s\n&quot;</font><font color="#808080">,</font><font color="#800000">&quot;Autores dos livros sendo exclu&iacute;dos!&quot;</font><font color="#808080">);
      [</font><font color="#000080">self frmCadLigados</font><font color="#808080">: </font><font color="#000080">opLivroAut</font><font color="#808080">, </font><font color="#000080">opExcluir</font><font color="#808080">, </font><font color="#000080">tLivro</font><font color="#808080">.</font><font color="#000080">isbn</font><font color="#808080">];
   }
} </font><font color="#0000FF"><b>else if </b></font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">==</font><font color="#000080">opCliente</font><font color="#808080">) {
   </font><font color="#0000FF"><b>if </b></font><font color="#808080">(</font><font color="#000080">sacao</font><font color="#808080">==</font><font color="#000080">opNovo</font><font color="#808080">) {
      </font><font color="#000080">printf</font><font color="#808080">([</font><font color="#000080">self rotulo</font><font color="#808080">: </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">]);
      </font><font color="#000080">strcpy</font><font color="#808080">(</font><font color="#000080">tCliente</font><font color="#808080">.</font><font color="#000080">cpf</font><font color="#808080">, [</font><font color="#000080">self digita</font><font color="#808080">: </font><font color="#0000FF"><b>sizeof</b></font><font color="#808080">(</font><font color="#000080">tCliente</font><font color="#808080">.</font><font color="#000080">cpf</font><font color="#808080">)]);
      </font><font color="#0000FF"><b>if </b></font><font color="#808080">([</font><font color="#000080">self validaCPF</font><font color="#808080">: </font><font color="#000080">tCliente</font><font color="#808080">.</font><font color="#000080">cpf</font><font color="#808080">]==</font><font color="#000080">YES</font><font color="#808080">) {
          </font><font color="#000080">slinha </font><font color="#808080">= [</font><font color="#000080">self pesqArq</font><font color="#808080">: </font><font color="#000080">tfCliente</font><font color="#808080">, </font><font color="#000080">tCliente</font><font color="#808080">.</font><font color="#000080">cpf</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">14</font><font color="#808080">, [</font><font color="#000080">self tamReg</font><font color="#808080">: </font><font color="#000080">sreg</font><font color="#808080">]];
          </font><font color="#0000FF"><b>if </b></font><font color="#808080">(</font><font color="#000080">strcmp</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">,</font><font color="#800000">&quot;&quot;</font><font color="#808080">)==</font><font color="#FF0000">0</font><font color="#808080">) {
             [</font><font color="#000080">self pesqLinhaExcluida</font><font color="#808080">: </font><font color="#000080">tfCliente</font><font color="#808080">, [</font><font color="#000080">self tamReg</font><font color="#808080">: </font><font color="#000080">sreg</font><font color="#808080">]];
             [</font><font color="#000080">self mostrarDados</font><font color="#808080">: </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">];
             [</font><font color="#000080">self subMenu</font><font color="#808080">: </font><font color="#FF0000">7</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">];
          } </font><font color="#0000FF"><b>else </b></font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;%s\n&quot;</font><font color="#808080">,</font><font color="#000080">MSG_REGEXST</font><font color="#808080">);
      } </font><font color="#0000FF"><b>else </b></font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;%s\n&quot;</font><font color="#808080">,</font><font color="#000080">MSG_CPFINV</font><font color="#808080">);
   } </font><font color="#0000FF"><b>else if </b></font><font color="#808080">(</font><font color="#000080">sacao</font><font color="#808080">==</font><font color="#000080">opPesquisar</font><font color="#808080">) {
      </font><font color="#000080">slinha </font><font color="#808080">= [</font><font color="#000080">self validaEntrada</font><font color="#808080">: </font><font color="#000080">tfCliente</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#000080">tCliente</font><font color="#808080">.</font><font color="#000080">cpf</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#000080">NO</font><font color="#808080">,</font><font color="#000080">opTexto</font><font color="#808080">];
      </font><font color="#0000FF"><b>if </b></font><font color="#808080">(</font><font color="#000080">strcmp</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">,</font><font color="#800000">&quot;&quot;</font><font color="#808080">)!=</font><font color="#FF0000">0</font><font color="#808080">) {
         [</font><font color="#000080">self mostrarDados</font><font color="#808080">: </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">];
         [</font><font color="#000080">self mostrarDados</font><font color="#808080">: </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">];
         [</font><font color="#000080">self subMenu</font><font color="#808080">: </font><font color="#FF0000">8</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">];
      }
   } </font><font color="#0000FF"><b>else if </b></font><font color="#808080">(</font><font color="#000080">sacao</font><font color="#808080">==</font><font color="#000080">opAlterar</font><font color="#808080">) {
      </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;%s%s\n&quot;</font><font color="#808080">,[</font><font color="#000080">self rotulo</font><font color="#808080">: </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">], </font><font color="#000080">tCliente</font><font color="#808080">.</font><font color="#000080">cpf</font><font color="#808080">);
      [</font><font color="#000080">self mostrarDados</font><font color="#808080">: </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">];
      [</font><font color="#000080">self subMenu</font><font color="#808080">: </font><font color="#FF0000">9</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">];
   } </font><font color="#0000FF"><b>else if </b></font><font color="#808080">(</font><font color="#000080">sacao</font><font color="#808080">==</font><font color="#000080">opExcluir</font><font color="#808080">) {
      [</font><font color="#000080">self subMenu</font><font color="#808080">: </font><font color="#FF0000">10</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">];
   }
} </font><font color="#0000FF"><b>else if </b></font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">==</font><font color="#000080">opVenda</font><font color="#808080">) {
   </font><font color="#0000FF"><b>if </b></font><font color="#808080">(</font><font color="#000080">sacao</font><font color="#808080">==</font><font color="#000080">opNovo</font><font color="#808080">) {
      </font><font color="#000080">strcpy</font><font color="#808080">(</font><font color="#000080">tVenda</font><font color="#808080">.</font><font color="#000080">dthrvenda</font><font color="#808080">, [</font><font color="#000080">self retDataHora</font><font color="#808080">]);
      </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;%s%s\n&quot;</font><font color="#808080">,[</font><font color="#000080">self rotulo</font><font color="#808080">: </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">], </font><font color="#000080">tVenda</font><font color="#808080">.</font><font color="#000080">dthrvenda</font><font color="#808080">);
      </font><font color="#000080">slinha </font><font color="#808080">= [</font><font color="#000080">self pesqArq</font><font color="#808080">: </font><font color="#000080">tfVenda</font><font color="#808080">, </font><font color="#000080">tVenda</font><font color="#808080">.</font><font color="#000080">dthrvenda</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">19</font><font color="#808080">, [</font><font color="#000080">self tamReg</font><font color="#808080">: </font><font color="#000080">sreg</font><font color="#808080">]];
      </font><font color="#0000FF"><b>if </b></font><font color="#808080">(</font><font color="#000080">strcmp</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">,</font><font color="#800000">&quot;&quot;</font><font color="#808080">)==</font><font color="#FF0000">0</font><font color="#808080">) {
         </font><font color="#000080">slinha </font><font color="#808080">= [</font><font color="#000080">self validaEntrada</font><font color="#808080">: </font><font color="#000080">tfCliente</font><font color="#808080">,</font><font color="#000080">opCliente</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#000080">tVenda</font><font color="#808080">.</font><font color="#000080">cpf</font><font color="#808080">,</font><font color="#FF0000">3</font><font color="#808080">,
                 </font><font color="#000080">NO</font><font color="#808080">,</font><font color="#000080">opTexto</font><font color="#808080">];
         </font><font color="#0000FF"><b>if </b></font><font color="#808080">(</font><font color="#000080">strcmp</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">,</font><font color="#800000">&quot;&quot;</font><font color="#808080">)!=</font><font color="#FF0000">0</font><font color="#808080">) {
            </font><font color="#000080">strcpy</font><font color="#808080">(</font><font color="#000080">tVenda</font><font color="#808080">.</font><font color="#000080">cpf</font><font color="#808080">, [</font><font color="#000080">self trim</font><font color="#808080">: [</font><font color="#000080">self copy</font><font color="#808080">: </font><font color="#000080">slinha</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#FF0000">14</font><font color="#808080">]]);
            </font><font color="#0000FF"><b>if </b></font><font color="#808080">([</font><font color="#000080">self validaCPF</font><font color="#808080">: </font><font color="#000080">tVenda</font><font color="#808080">.</font><font color="#000080">cpf</font><font color="#808080">]==</font><font color="#000080">YES</font><font color="#808080">) {
               </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot; %s&quot;</font><font color="#808080">,[</font><font color="#000080">self rotulo</font><font color="#808080">: </font><font color="#000080">opCliente</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">]); <i>/* Nome */
               </i></font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;%s\n&quot;</font><font color="#808080">,[</font><font color="#000080">self copy</font><font color="#808080">: </font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#000080">g_nPosChave</font><font color="#808080">, </font><font color="#000080">g_nTamChave</font><font color="#808080">]);
               [</font><font color="#000080">self frmCadLigados</font><font color="#808080">: </font><font color="#000080">opVenda</font><font color="#808080">, </font><font color="#000080">opNovo</font><font color="#808080">, </font><font color="#000080">tVenda</font><font color="#808080">.</font><font color="#000080">cpf</font><font color="#808080">];
            } </font><font color="#0000FF"><b>else </b></font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;%s\n&quot;</font><font color="#808080">,</font><font color="#000080">MSG_CPFINV</font><font color="#808080">);
         }
      } </font><font color="#0000FF"><b>else </b></font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;%s\n&quot;</font><font color="#808080">,</font><font color="#000080">MSG_REGEXST</font><font color="#808080">);
   } </font><font color="#0000FF"><b>else if </b></font><font color="#808080">(</font><font color="#000080">sacao</font><font color="#808080">==</font><font color="#000080">opPesquisar</font><font color="#808080">) {
      </font><font color="#000080">slinha </font><font color="#808080">= [</font><font color="#000080">self validaEntrada</font><font color="#808080">: </font><font color="#000080">tfVenda</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#000080">tVenda</font><font color="#808080">.</font><font color="#000080">dthrvenda</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,
              </font><font color="#000080">NO</font><font color="#808080">,</font><font color="#000080">opDataHora</font><font color="#808080">];
      </font><font color="#0000FF"><b>if </b></font><font color="#808080">(</font><font color="#000080">strcmp</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">,</font><font color="#800000">&quot;&quot;</font><font color="#808080">)!=</font><font color="#FF0000">0</font><font color="#808080">) {
        [</font><font color="#000080">self mostrarDados</font><font color="#808080">: </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">];
        [</font><font color="#000080">self mostrarDados</font><font color="#808080">: </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">];
        [</font><font color="#000080">self subMenu</font><font color="#808080">: </font><font color="#FF0000">8</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">];
      }
   }
}
</font><font color="#0000FF"><b>return </b></font><font color="#000080">self</font><font color="#808080">;
}
<i>/*------------------------------------------------------------------------------
Realiza as consultas de acordo com o tipo de arquivo.
sreg - o tipo de arquivo
sacao - a a&ccedil;&atilde;o a ser realizada
------------------------------------------------------------------------------*/
</i>- </font><font color="#000080">frmConsultas</font><font color="#808080">: (</font><font color="#0000FF"><b>enum </b></font><font color="#000080">ctArqs</font><font color="#808080">) </font><font color="#000080">sreg</font><font color="#808080">, ...
{ 
 </font><font color="#0000FF"><b>enum </b></font><font color="#000080">ctAcao sacao</font><font color="#808080">;
 </font><font color="#000080">STR slinha</font><font color="#808080">;

</font><font color="#000080">va_list lparams</font><font color="#808080">;
</font><font color="#000080">va_start</font><font color="#808080">(</font><font color="#000080">lparams</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">);
</font><font color="#000080">sacao </font><font color="#808080">= </font><font color="#000080">va_arg</font><font color="#808080">(</font><font color="#000080">lparams</font><font color="#808080">,</font><font color="#0000FF"><b>enum </b></font><font color="#000080">ctAcao</font><font color="#808080">);
</font><font color="#000080">va_end</font><font color="#808080">(</font><font color="#000080">lparams</font><font color="#808080">);

</font><font color="#000080">slinha </font><font color="#808080">= [</font><font color="#000080">self alocaString</font><font color="#808080">: </font><font color="#000080">TAM_MAX_STR</font><font color="#808080">];

</font><font color="#0000FF"><b>if </b></font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">==</font><font color="#000080">opAssunto</font><font color="#808080">) {
   </font><font color="#0000FF"><b>if </b></font><font color="#808080">(</font><font color="#000080">sacao</font><font color="#808080">==</font><font color="#000080">opPesquisar</font><font color="#808080">)
      </font><font color="#000080">slinha </font><font color="#808080">= [</font><font color="#000080">self validaEntrada</font><font color="#808080">: </font><font color="#000080">tfAssunto</font><font color="#808080">,</font><font color="#000080">sreg</font><font color="#808080">,</font><font color="#FF0000">2</font><font color="#808080">,</font><font color="#000080">tAssunto</font><font color="#808080">.</font><font color="#000080">assunto</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#000080">YES</font><font color="#808080">,</font><font color="#000080">opTexto</font><font color="#808080">];
   </font><font color="#0000FF"><b>else if </b></font><font color="#808080">(</font><font color="#000080">sacao</font><font color="#808080">==</font><font color="#000080">opListarTodos</font><font color="#808080">) {
      </font><font color="#0000FF"><b>if </b></font><font color="#808080">([</font><font color="#000080">self ListarTodos</font><font color="#808080">: </font><font color="#000080">tfAssunto</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, [</font><font color="#000080">self tamReg</font><font color="#808080">: </font><font color="#000080">sreg</font><font color="#808080">],
        </font><font color="#000080">QTD_MAX_LINHA</font><font color="#808080">, </font><font color="#000080">NO</font><font color="#808080">] == </font><font color="#000080">NO</font><font color="#808080">)
        </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;%s\n&quot;</font><font color="#808080">,[</font><font color="#000080">self rotulo</font><font color="#808080">: </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">]);
   }
} </font><font color="#0000FF"><b>else if </b></font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">==</font><font color="#000080">opAutor</font><font color="#808080">) {
   </font><font color="#0000FF"><b>if </b></font><font color="#808080">(</font><font color="#000080">sacao</font><font color="#808080">==</font><font color="#000080">opPesquisar</font><font color="#808080">)
      </font><font color="#000080">slinha </font><font color="#808080">= [</font><font color="#000080">self validaEntrada</font><font color="#808080">: </font><font color="#000080">tfAutor</font><font color="#808080">,</font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">, </font><font color="#000080">tAutor</font><font color="#808080">.</font><font color="#000080">autor</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#000080">YES</font><font color="#808080">,</font><font color="#000080">opTexto</font><font color="#808080">];
   </font><font color="#0000FF"><b>else if </b></font><font color="#808080">(</font><font color="#000080">sacao</font><font color="#808080">==</font><font color="#000080">opListarTodos</font><font color="#808080">) {
      </font><font color="#0000FF"><b>if </b></font><font color="#808080">([</font><font color="#000080">self ListarTodos</font><font color="#808080">: </font><font color="#000080">tfAutor</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, [</font><font color="#000080">self tamReg</font><font color="#808080">: </font><font color="#000080">sreg</font><font color="#808080">],
        </font><font color="#000080">QTD_MAX_LINHA</font><font color="#808080">, </font><font color="#000080">NO</font><font color="#808080">] == </font><font color="#000080">NO</font><font color="#808080">)
        </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;%s\n&quot;</font><font color="#808080">,[</font><font color="#000080">self rotulo</font><font color="#808080">: </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">]);
   }
} </font><font color="#0000FF"><b>else if </b></font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">==</font><font color="#000080">opEditora</font><font color="#808080">) {
   </font><font color="#0000FF"><b>if </b></font><font color="#808080">(</font><font color="#000080">sacao</font><font color="#808080">==</font><font color="#000080">opPesquisar</font><font color="#808080">)
      </font><font color="#000080">slinha </font><font color="#808080">= [</font><font color="#000080">self validaEntrada</font><font color="#808080">: </font><font color="#000080">tfEditora</font><font color="#808080">,</font><font color="#000080">sreg</font><font color="#808080">,</font><font color="#FF0000">2</font><font color="#808080">,</font><font color="#000080">tEditora</font><font color="#808080">.</font><font color="#000080">editora</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#000080">YES</font><font color="#808080">,</font><font color="#000080">opTexto</font><font color="#808080">];
   </font><font color="#0000FF"><b>else if </b></font><font color="#808080">(</font><font color="#000080">sacao</font><font color="#808080">==</font><font color="#000080">opListarTodos</font><font color="#808080">) {
      </font><font color="#0000FF"><b>if </b></font><font color="#808080">([</font><font color="#000080">self ListarTodos</font><font color="#808080">: </font><font color="#000080">tfEditora</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, [</font><font color="#000080">self tamReg</font><font color="#808080">: </font><font color="#000080">sreg</font><font color="#808080">],
        </font><font color="#000080">QTD_MAX_LINHA</font><font color="#808080">, </font><font color="#000080">NO</font><font color="#808080">] == </font><font color="#000080">NO</font><font color="#808080">)
        </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;%s\n&quot;</font><font color="#808080">,[</font><font color="#000080">self rotulo</font><font color="#808080">: </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">]);
   }
} </font><font color="#0000FF"><b>else if </b></font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">==</font><font color="#000080">opEndereco</font><font color="#808080">) {
   </font><font color="#0000FF"><b>if </b></font><font color="#808080">(</font><font color="#000080">sacao</font><font color="#808080">==</font><font color="#000080">opPesquisar</font><font color="#808080">)
      </font><font color="#000080">slinha </font><font color="#808080">= [</font><font color="#000080">self validaEntrada</font><font color="#808080">: </font><font color="#000080">tfEndereco</font><font color="#808080">,</font><font color="#000080">sreg</font><font color="#808080">,</font><font color="#FF0000">2</font><font color="#808080">,</font><font color="#000080">tEndereco</font><font color="#808080">.</font><font color="#000080">logradouro</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,
              </font><font color="#000080">YES</font><font color="#808080">,</font><font color="#000080">opTexto</font><font color="#808080">];
   </font><font color="#0000FF"><b>else if </b></font><font color="#808080">(</font><font color="#000080">sacao</font><font color="#808080">==</font><font color="#000080">opListarTodos</font><font color="#808080">) {
      </font><font color="#0000FF"><b>if </b></font><font color="#808080">([</font><font color="#000080">self ListarTodos</font><font color="#808080">: </font><font color="#000080">tfEndereco</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, [</font><font color="#000080">self tamReg</font><font color="#808080">: </font><font color="#000080">sreg</font><font color="#808080">],
         </font><font color="#FF0000">3</font><font color="#808080">, </font><font color="#000080">NO</font><font color="#808080">] == </font><font color="#000080">NO</font><font color="#808080">)
        </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;%s\n&quot;</font><font color="#808080">,[</font><font color="#000080">self rotulo</font><font color="#808080">: </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">]);
   }
} </font><font color="#0000FF"><b>else if </b></font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">==</font><font color="#000080">opIdioma</font><font color="#808080">) {
   </font><font color="#0000FF"><b>if </b></font><font color="#808080">(</font><font color="#000080">sacao</font><font color="#808080">==</font><font color="#000080">opPesquisar</font><font color="#808080">)
      </font><font color="#000080">slinha </font><font color="#808080">= [</font><font color="#000080">self validaEntrada</font><font color="#808080">: </font><font color="#000080">tfIdioma</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">, </font><font color="#000080">tIdioma</font><font color="#808080">.</font><font color="#000080">idioma</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#000080">YES</font><font color="#808080">,</font><font color="#000080">opTexto</font><font color="#808080">];
   </font><font color="#0000FF"><b>else if </b></font><font color="#808080">(</font><font color="#000080">sacao</font><font color="#808080">==</font><font color="#000080">opListarTodos</font><font color="#808080">) {
      </font><font color="#0000FF"><b>if </b></font><font color="#808080">([</font><font color="#000080">self ListarTodos</font><font color="#808080">: </font><font color="#000080">tfIdioma</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, [</font><font color="#000080">self tamReg</font><font color="#808080">: </font><font color="#000080">sreg</font><font color="#808080">],
        </font><font color="#000080">QTD_MAX_LINHA</font><font color="#808080">, </font><font color="#000080">NO</font><font color="#808080">] == </font><font color="#000080">NO</font><font color="#808080">)
        </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;%s\n&quot;</font><font color="#808080">,[</font><font color="#000080">self rotulo</font><font color="#808080">: </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">]);
   }
} </font><font color="#0000FF"><b>else if </b></font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">==</font><font color="#000080">opPais</font><font color="#808080">) {
   </font><font color="#0000FF"><b>if </b></font><font color="#808080">(</font><font color="#000080">sacao</font><font color="#808080">==</font><font color="#000080">opPesquisar</font><font color="#808080">)
      </font><font color="#000080">slinha </font><font color="#808080">= [</font><font color="#000080">self validaEntrada</font><font color="#808080">: </font><font color="#000080">tfPais</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">, </font><font color="#000080">tPais</font><font color="#808080">.</font><font color="#000080">pais</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#000080">YES</font><font color="#808080">,</font><font color="#000080">opTexto</font><font color="#808080">];
   </font><font color="#0000FF"><b>else if </b></font><font color="#808080">(</font><font color="#000080">sacao</font><font color="#808080">==</font><font color="#000080">opListarTodos</font><font color="#808080">) {
      </font><font color="#0000FF"><b>if </b></font><font color="#808080">([</font><font color="#000080">self ListarTodos</font><font color="#808080">: </font><font color="#000080">tfPais</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, [</font><font color="#000080">self tamReg</font><font color="#808080">: </font><font color="#000080">sreg</font><font color="#808080">],
        </font><font color="#000080">QTD_MAX_LINHA</font><font color="#808080">, </font><font color="#000080">NO</font><font color="#808080">] == </font><font color="#000080">NO</font><font color="#808080">)
        </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;%s\n&quot;</font><font color="#808080">,[</font><font color="#000080">self rotulo</font><font color="#808080">: </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">]);
   }
} </font><font color="#0000FF"><b>else if </b></font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">==</font><font color="#000080">opProfissao</font><font color="#808080">) {
   </font><font color="#0000FF"><b>if </b></font><font color="#808080">(</font><font color="#000080">sacao</font><font color="#808080">==</font><font color="#000080">opPesquisar</font><font color="#808080">)
     </font><font color="#000080">slinha </font><font color="#808080">= [</font><font color="#000080">self validaEntrada</font><font color="#808080">: </font><font color="#000080">tfProfissao</font><font color="#808080">,</font><font color="#000080">sreg</font><font color="#808080">,</font><font color="#FF0000">2</font><font color="#808080">,</font><font color="#000080">tProfissao</font><font color="#808080">.</font><font color="#000080">profissao</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,
             </font><font color="#000080">YES</font><font color="#808080">,</font><font color="#000080">opTexto</font><font color="#808080">];
   </font><font color="#0000FF"><b>else if </b></font><font color="#808080">(</font><font color="#000080">sacao</font><font color="#808080">==</font><font color="#000080">opListarTodos</font><font color="#808080">) {
      </font><font color="#0000FF"><b>if </b></font><font color="#808080">([</font><font color="#000080">self ListarTodos</font><font color="#808080">: </font><font color="#000080">tfProfissao</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, [</font><font color="#000080">self tamReg</font><font color="#808080">: </font><font color="#000080">sreg</font><font color="#808080">],
        </font><font color="#000080">QTD_MAX_LINHA</font><font color="#808080">, </font><font color="#000080">NO</font><font color="#808080">] == </font><font color="#000080">NO</font><font color="#808080">)
        </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;%s\n&quot;</font><font color="#808080">,[</font><font color="#000080">self rotulo</font><font color="#808080">: </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">]);
   }
} </font><font color="#0000FF"><b>else if </b></font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">==</font><font color="#000080">opLivro</font><font color="#808080">) {
   </font><font color="#0000FF"><b>if </b></font><font color="#808080">(</font><font color="#000080">sacao</font><font color="#808080">==</font><font color="#000080">opPesquisar</font><font color="#808080">)
      </font><font color="#000080">slinha </font><font color="#808080">= [</font><font color="#000080">self validaEntrada</font><font color="#808080">: </font><font color="#000080">tfLivro</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">, </font><font color="#000080">tLivro</font><font color="#808080">.</font><font color="#000080">titulo</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#000080">YES</font><font color="#808080">,</font><font color="#000080">opTexto</font><font color="#808080">];
   </font><font color="#0000FF"><b>else if </b></font><font color="#808080">(</font><font color="#000080">sacao</font><font color="#808080">==</font><font color="#000080">opListarTodos</font><font color="#808080">) {
      </font><font color="#0000FF"><b>if </b></font><font color="#808080">([</font><font color="#000080">self ListarTodos</font><font color="#808080">: </font><font color="#000080">tfLivro</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, [</font><font color="#000080">self tamReg</font><font color="#808080">: </font><font color="#000080">sreg</font><font color="#808080">],
        </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#000080">NO</font><font color="#808080">] == </font><font color="#000080">NO</font><font color="#808080">)
        </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;%s\n&quot;</font><font color="#808080">,[</font><font color="#000080">self rotulo</font><font color="#808080">: </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">]);
   }
} </font><font color="#0000FF"><b>else if </b></font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">==</font><font color="#000080">opCliente</font><font color="#808080">) {
   </font><font color="#0000FF"><b>if </b></font><font color="#808080">(</font><font color="#000080">sacao</font><font color="#808080">==</font><font color="#000080">opPesquisar</font><font color="#808080">)
      </font><font color="#000080">slinha </font><font color="#808080">= [</font><font color="#000080">self validaEntrada</font><font color="#808080">: </font><font color="#000080">tfCliente</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">, </font><font color="#000080">tCliente</font><font color="#808080">.</font><font color="#000080">nome</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#000080">YES</font><font color="#808080">,</font><font color="#000080">opTexto</font><font color="#808080">];
   </font><font color="#0000FF"><b>else if </b></font><font color="#808080">(</font><font color="#000080">sacao</font><font color="#808080">==</font><font color="#000080">opListarTodos</font><font color="#808080">) {
      </font><font color="#0000FF"><b>if </b></font><font color="#808080">([</font><font color="#000080">self ListarTodos</font><font color="#808080">: </font><font color="#000080">tfCliente</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, [</font><font color="#000080">self tamReg</font><font color="#808080">: </font><font color="#000080">sreg</font><font color="#808080">],
        </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#000080">NO</font><font color="#808080">] == </font><font color="#000080">NO</font><font color="#808080">)
        </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;%s\n&quot;</font><font color="#808080">,[</font><font color="#000080">self rotulo</font><font color="#808080">: </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">]);
   }
} </font><font color="#0000FF"><b>else if </b></font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">==</font><font color="#000080">opVenda</font><font color="#808080">) {
   </font><font color="#0000FF"><b>if </b></font><font color="#808080">(</font><font color="#000080">sacao</font><font color="#808080">==</font><font color="#000080">opPesquisar</font><font color="#808080">)
      </font><font color="#000080">slinha </font><font color="#808080">= [</font><font color="#000080">self validaEntrada</font><font color="#808080">: </font><font color="#000080">tfVenda</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">, </font><font color="#000080">tVenda</font><font color="#808080">.</font><font color="#000080">cpf</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#000080">YES</font><font color="#808080">,</font><font color="#000080">opTexto</font><font color="#808080">];
   </font><font color="#0000FF"><b>else if </b></font><font color="#808080">(</font><font color="#000080">sacao</font><font color="#808080">==</font><font color="#000080">opListarTodos</font><font color="#808080">) {
      </font><font color="#0000FF"><b>if </b></font><font color="#808080">([</font><font color="#000080">self ListarTodos</font><font color="#808080">: </font><font color="#000080">tfVenda</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, [</font><font color="#000080">self tamReg</font><font color="#808080">: </font><font color="#000080">sreg</font><font color="#808080">],
        </font><font color="#000080">QTD_MAX_LINHA</font><font color="#808080">, </font><font color="#000080">NO</font><font color="#808080">] == </font><font color="#000080">NO</font><font color="#808080">)
        </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;%s\n&quot;</font><font color="#808080">,[</font><font color="#000080">self rotulo</font><font color="#808080">: </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">]);
   }
}
</font><font color="#0000FF"><b>return </b></font><font color="#000080">self</font><font color="#808080">;
}
<i>/*------------------------------------------------------------------------------
Mostra a tela de altera&ccedil;&atilde;o de senha do sistema e realiza a altera&ccedil;&atilde;o.
------------------------------------------------------------------------------*/
</i>- </font><font color="#000080">frmAlterarSenha
</font><font color="#808080">{ 
  </font><font color="#000080">BOOL bQuebra</font><font color="#808080">;
  </font><font color="#000080">STR sres</font><font color="#808080">, </font><font color="#000080">sSenhaAtual</font><font color="#808080">, </font><font color="#000080">sNovaSenha</font><font color="#808080">, </font><font color="#000080">sConfirmaSenha</font><font color="#808080">;
  </font><font color="#0000FF"><b>int </b></font><font color="#000080">nopcao</font><font color="#808080">;

</font><font color="#000080">sSenhaAtual </font><font color="#808080">= [</font><font color="#000080">self alocaString</font><font color="#808080">: </font><font color="#000080">TAM_MAX_STR</font><font color="#808080">];
</font><font color="#000080">sNovaSenha </font><font color="#808080">= [</font><font color="#000080">self alocaString</font><font color="#808080">: </font><font color="#000080">TAM_MAX_STR</font><font color="#808080">];
</font><font color="#000080">sConfirmaSenha </font><font color="#808080">= [</font><font color="#000080">self alocaString</font><font color="#808080">: </font><font color="#000080">TAM_MAX_STR</font><font color="#808080">];

</font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;%s%s\n&quot;</font><font color="#808080">,[</font><font color="#000080">self rotulo</font><font color="#808080">: </font><font color="#000080">opUsuario</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">], </font><font color="#000080">tUsuario</font><font color="#808080">.</font><font color="#000080">login</font><font color="#808080">);
</font><font color="#000080">nopcao </font><font color="#808080">= </font><font color="#FF0000">1</font><font color="#808080">;
</font><font color="#000080">bQuebra </font><font color="#808080">= </font><font color="#000080">NO</font><font color="#808080">;
</font><font color="#0000FF"><b>while </b></font><font color="#808080">(</font><font color="#000080">bQuebra</font><font color="#808080">==</font><font color="#000080">NO</font><font color="#808080">) {
  </font><font color="#0000FF"><b>switch</b></font><font color="#808080">(</font><font color="#000080">nopcao</font><font color="#808080">) {
   </font><font color="#0000FF"><b>case </b></font><font color="#FF0000">1</font><font color="#808080">: {
       </font><font color="#000080">strcpy</font><font color="#808080">(</font><font color="#000080">sSenhaAtual</font><font color="#808080">, [</font><font color="#000080">self digitaSenha</font><font color="#808080">: </font><font color="#800000">&quot;Senha Atual: &quot;</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">]);
       </font><font color="#0000FF"><b>if </b></font><font color="#808080">(</font><font color="#000080">strcmp</font><font color="#808080">(</font><font color="#000080">sSenhaAtual</font><font color="#808080">,</font><font color="#000080">tUsuario</font><font color="#808080">.</font><font color="#000080">senha</font><font color="#808080">)!=</font><font color="#FF0000">0</font><font color="#808080">) {
          </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;%s\n&quot;</font><font color="#808080">,</font><font color="#000080">MSG_SENCONFERE</font><font color="#808080">);
          </font><font color="#000080">bQuebra </font><font color="#808080">= </font><font color="#000080">YES</font><font color="#808080">;
       } </font><font color="#0000FF"><b>else </b></font><font color="#000080">nopcao </font><font color="#808080">= </font><font color="#FF0000">2</font><font color="#808080">;
      } </font><font color="#0000FF"><b>break</b></font><font color="#808080">;
   </font><font color="#0000FF"><b>case </b></font><font color="#FF0000">2</font><font color="#808080">: {
       </font><font color="#000080">strcpy</font><font color="#808080">(</font><font color="#000080">sNovaSenha</font><font color="#808080">, [</font><font color="#000080">self digitaSenha</font><font color="#808080">: </font><font color="#800000">&quot;Nova Senha: &quot;</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">]);
       </font><font color="#000080">strcpy</font><font color="#808080">(</font><font color="#000080">sConfirmaSenha</font><font color="#808080">, [</font><font color="#000080">self digitaSenha</font><font color="#808080">: </font><font color="#800000">&quot;Confirma Senha: &quot;</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">]);
       </font><font color="#0000FF"><b>if </b></font><font color="#808080">(</font><font color="#000080">strcmp</font><font color="#808080">(</font><font color="#000080">sNovaSenha</font><font color="#808080">,</font><font color="#000080">sConfirmaSenha</font><font color="#808080">)!=</font><font color="#FF0000">0</font><font color="#808080">) {
          </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;%s\n&quot;</font><font color="#808080">,</font><font color="#000080">MSG_SENCONFIRM</font><font color="#808080">);
          </font><font color="#000080">bQuebra </font><font color="#808080">= </font><font color="#000080">YES</font><font color="#808080">;
       } </font><font color="#0000FF"><b>else </b></font><font color="#000080">nopcao </font><font color="#808080">= </font><font color="#FF0000">3</font><font color="#808080">;
      } </font><font color="#0000FF"><b>break</b></font><font color="#808080">;
   </font><font color="#0000FF"><b>case </b></font><font color="#FF0000">3</font><font color="#808080">: {
       </font><font color="#000080">sres </font><font color="#808080">= [</font><font color="#000080">self pesqArq</font><font color="#808080">: </font><font color="#000080">tfUsuario</font><font color="#808080">, </font><font color="#000080">tUsuario</font><font color="#808080">.</font><font color="#000080">login</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">, [</font><font color="#000080">self tamReg</font><font color="#808080">: </font><font color="#000080">opUsuario</font><font color="#808080">]];
       </font><font color="#0000FF"><b>if </b></font><font color="#808080">(</font><font color="#000080">strcmp</font><font color="#808080">(</font><font color="#000080">sres</font><font color="#808080">,</font><font color="#800000">&quot;&quot;</font><font color="#808080">)==</font><font color="#FF0000">0</font><font color="#808080">)
         </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;%s\n&quot;</font><font color="#808080">,</font><font color="#000080">MSG_LOGINENCON</font><font color="#808080">);
       </font><font color="#0000FF"><b>else </b></font><font color="#808080">{
         </font><font color="#000080">strcpy</font><font color="#808080">(</font><font color="#000080">tUsuario</font><font color="#808080">.</font><font color="#000080">senha</font><font color="#808080">, </font><font color="#000080">sConfirmaSenha</font><font color="#808080">);
         [</font><font color="#000080">self subMenu</font><font color="#808080">: </font><font color="#FF0000">9</font><font color="#808080">,</font><font color="#000080">opUsuario</font><font color="#808080">];
         </font><font color="#000080">bQuebra </font><font color="#808080">= </font><font color="#000080">YES</font><font color="#808080">;
       }
       </font><font color="#000080">free</font><font color="#808080">(</font><font color="#000080">sres</font><font color="#808080">);
      } </font><font color="#0000FF"><b>break</b></font><font color="#808080">;
  }
}
</font><font color="#000080">free</font><font color="#808080">(</font><font color="#000080">sSenhaAtual</font><font color="#808080">);
</font><font color="#000080">free</font><font color="#808080">(</font><font color="#000080">sNovaSenha</font><font color="#808080">);
</font><font color="#000080">free</font><font color="#808080">(</font><font color="#000080">sConfirmaSenha</font><font color="#808080">);
</font><font color="#0000FF"><b>return </b></font><font color="#000080">self</font><font color="#808080">;
}
<i>/*------------------------------------------------------------------------------
Executa uma a&ccedil;&atilde;o de grava&ccedil;&atilde;o de acordo com o tipo de arquivo.
sreg - o tipo de arquivo
sacao - a a&ccedil;&atilde;o a ser realizada
------------------------------------------------------------------------------*/
</i>- </font><font color="#000080">btnAcao</font><font color="#808080">: (</font><font color="#0000FF"><b>enum </b></font><font color="#000080">ctArqs</font><font color="#808080">) </font><font color="#000080">sreg</font><font color="#808080">, ...
{
  </font><font color="#0000FF"><b>enum </b></font><font color="#000080">ctAcao sacao</font><font color="#808080">;

</font><font color="#000080">va_list lparams</font><font color="#808080">;
</font><font color="#000080">va_start</font><font color="#808080">(</font><font color="#000080">lparams</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">);
</font><font color="#000080">sacao </font><font color="#808080">= </font><font color="#000080">va_arg</font><font color="#808080">(</font><font color="#000080">lparams</font><font color="#808080">,</font><font color="#0000FF"><b>enum </b></font><font color="#000080">ctAcao</font><font color="#808080">);
</font><font color="#000080">va_end</font><font color="#808080">(</font><font color="#000080">lparams</font><font color="#808080">);

</font><font color="#0000FF"><b>if </b></font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">==</font><font color="#000080">opAssunto</font><font color="#808080">) {
   </font><font color="#0000FF"><b>if </b></font><font color="#808080">(</font><font color="#000080">sacao</font><font color="#808080">==</font><font color="#000080">opSalvarInclusao</font><font color="#808080">)
      [</font><font color="#000080">self escreveArq</font><font color="#808080">: </font><font color="#000080">tfAssunto</font><font color="#808080">, [</font><font color="#000080">self LinhaReg</font><font color="#808080">: </font><font color="#000080">sreg</font><font color="#808080">], </font><font color="#000080">MSG_REGINC</font><font color="#808080">, </font><font color="#000080">MSG_REGNINC</font><font color="#808080">];
   </font><font color="#0000FF"><b>else if </b></font><font color="#808080">(</font><font color="#000080">sacao</font><font color="#808080">==</font><font color="#000080">opSalvarAlteracao</font><font color="#808080">)
      [</font><font color="#000080">self escreveArq</font><font color="#808080">: </font><font color="#000080">tfAssunto</font><font color="#808080">, [</font><font color="#000080">self LinhaReg</font><font color="#808080">: </font><font color="#000080">sreg</font><font color="#808080">], </font><font color="#000080">MSG_REGALT</font><font color="#808080">, </font><font color="#000080">MSG_REGNALT</font><font color="#808080">];
   </font><font color="#0000FF"><b>else if </b></font><font color="#808080">(</font><font color="#000080">sacao</font><font color="#808080">==</font><font color="#000080">opConfirmaExclusao</font><font color="#808080">)
      [</font><font color="#000080">self escreveArq</font><font color="#808080">: </font><font color="#000080">tfAssunto</font><font color="#808080">, [</font><font color="#000080">self repete</font><font color="#808080">: </font><font color="#800000">&quot;*&quot;</font><font color="#808080">,[</font><font color="#000080">self tamReg</font><font color="#808080">: </font><font color="#000080">sreg</font><font color="#808080">]], </font><font color="#000080">MSG_REGEXC</font><font color="#808080">, </font><font color="#000080">MSG_REGNEXC</font><font color="#808080">];
} </font><font color="#0000FF"><b>else if </b></font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">==</font><font color="#000080">opAutor</font><font color="#808080">) {
   </font><font color="#0000FF"><b>if </b></font><font color="#808080">(</font><font color="#000080">sacao</font><font color="#808080">==</font><font color="#000080">opSalvarInclusao</font><font color="#808080">)
      [</font><font color="#000080">self escreveArq</font><font color="#808080">: </font><font color="#000080">tfAutor</font><font color="#808080">, [</font><font color="#000080">self LinhaReg</font><font color="#808080">: </font><font color="#000080">sreg</font><font color="#808080">], </font><font color="#000080">MSG_REGINC</font><font color="#808080">, </font><font color="#000080">MSG_REGNINC</font><font color="#808080">];
   </font><font color="#0000FF"><b>else if </b></font><font color="#808080">(</font><font color="#000080">sacao</font><font color="#808080">==</font><font color="#000080">opSalvarAlteracao</font><font color="#808080">)
      [</font><font color="#000080">self escreveArq</font><font color="#808080">: </font><font color="#000080">tfAutor</font><font color="#808080">, [</font><font color="#000080">self LinhaReg</font><font color="#808080">: </font><font color="#000080">sreg</font><font color="#808080">], </font><font color="#000080">MSG_REGALT</font><font color="#808080">, </font><font color="#000080">MSG_REGNALT</font><font color="#808080">];
   </font><font color="#0000FF"><b>else if </b></font><font color="#808080">(</font><font color="#000080">sacao</font><font color="#808080">==</font><font color="#000080">opConfirmaExclusao</font><font color="#808080">)
      [</font><font color="#000080">self escreveArq</font><font color="#808080">: </font><font color="#000080">tfAutor</font><font color="#808080">, [</font><font color="#000080">self repete</font><font color="#808080">: </font><font color="#800000">&quot;*&quot;</font><font color="#808080">,[</font><font color="#000080">self tamReg</font><font color="#808080">: </font><font color="#000080">sreg</font><font color="#808080">]], </font><font color="#000080">MSG_REGEXC</font><font color="#808080">, </font><font color="#000080">MSG_REGNEXC</font><font color="#808080">];
} </font><font color="#0000FF"><b>else if </b></font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">==</font><font color="#000080">opEditora</font><font color="#808080">) {
   </font><font color="#0000FF"><b>if </b></font><font color="#808080">(</font><font color="#000080">sacao</font><font color="#808080">==</font><font color="#000080">opSalvarInclusao</font><font color="#808080">)
      [</font><font color="#000080">self escreveArq</font><font color="#808080">: </font><font color="#000080">tfEditora</font><font color="#808080">, [</font><font color="#000080">self LinhaReg</font><font color="#808080">: </font><font color="#000080">sreg</font><font color="#808080">], </font><font color="#000080">MSG_REGINC</font><font color="#808080">, </font><font color="#000080">MSG_REGNINC</font><font color="#808080">];
   </font><font color="#0000FF"><b>else if </b></font><font color="#808080">(</font><font color="#000080">sacao</font><font color="#808080">==</font><font color="#000080">opSalvarAlteracao</font><font color="#808080">)
      [</font><font color="#000080">self escreveArq</font><font color="#808080">: </font><font color="#000080">tfEditora</font><font color="#808080">, [</font><font color="#000080">self LinhaReg</font><font color="#808080">: </font><font color="#000080">sreg</font><font color="#808080">], </font><font color="#000080">MSG_REGALT</font><font color="#808080">, </font><font color="#000080">MSG_REGNALT</font><font color="#808080">];
   </font><font color="#0000FF"><b>else if </b></font><font color="#808080">(</font><font color="#000080">sacao</font><font color="#808080">==</font><font color="#000080">opConfirmaExclusao</font><font color="#808080">)
      [</font><font color="#000080">self escreveArq</font><font color="#808080">: </font><font color="#000080">tfEditora</font><font color="#808080">, [</font><font color="#000080">self repete</font><font color="#808080">: </font><font color="#800000">&quot;*&quot;</font><font color="#808080">,[</font><font color="#000080">self tamReg</font><font color="#808080">: </font><font color="#000080">sreg</font><font color="#808080">]], </font><font color="#000080">MSG_REGEXC</font><font color="#808080">, </font><font color="#000080">MSG_REGNEXC</font><font color="#808080">];
} </font><font color="#0000FF"><b>else if </b></font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">==</font><font color="#000080">opEndereco</font><font color="#808080">) {
   </font><font color="#0000FF"><b>if </b></font><font color="#808080">(</font><font color="#000080">sacao</font><font color="#808080">==</font><font color="#000080">opSalvarInclusao</font><font color="#808080">)
      [</font><font color="#000080">self escreveArq</font><font color="#808080">: </font><font color="#000080">tfEndereco</font><font color="#808080">, [</font><font color="#000080">self LinhaReg</font><font color="#808080">: </font><font color="#000080">sreg</font><font color="#808080">], </font><font color="#000080">MSG_REGINC</font><font color="#808080">, </font><font color="#000080">MSG_REGNINC</font><font color="#808080">];
   </font><font color="#0000FF"><b>else if </b></font><font color="#808080">(</font><font color="#000080">sacao</font><font color="#808080">==</font><font color="#000080">opSalvarAlteracao</font><font color="#808080">)
      [</font><font color="#000080">self escreveArq</font><font color="#808080">: </font><font color="#000080">tfEndereco</font><font color="#808080">, [</font><font color="#000080">self LinhaReg</font><font color="#808080">: </font><font color="#000080">sreg</font><font color="#808080">], </font><font color="#000080">MSG_REGALT</font><font color="#808080">, </font><font color="#000080">MSG_REGNALT</font><font color="#808080">];
   </font><font color="#0000FF"><b>else if </b></font><font color="#808080">(</font><font color="#000080">sacao</font><font color="#808080">==</font><font color="#000080">opConfirmaExclusao</font><font color="#808080">)
      [</font><font color="#000080">self escreveArq</font><font color="#808080">: </font><font color="#000080">tfEndereco</font><font color="#808080">, [</font><font color="#000080">self repete</font><font color="#808080">: </font><font color="#800000">&quot;*&quot;</font><font color="#808080">,[</font><font color="#000080">self tamReg</font><font color="#808080">: </font><font color="#000080">sreg</font><font color="#808080">]], </font><font color="#000080">MSG_REGEXC</font><font color="#808080">, </font><font color="#000080">MSG_REGNEXC</font><font color="#808080">];
} </font><font color="#0000FF"><b>else if </b></font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">==</font><font color="#000080">opIdioma</font><font color="#808080">) {
   </font><font color="#0000FF"><b>if </b></font><font color="#808080">(</font><font color="#000080">sacao</font><font color="#808080">==</font><font color="#000080">opSalvarInclusao</font><font color="#808080">)
      [</font><font color="#000080">self escreveArq</font><font color="#808080">: </font><font color="#000080">tfIdioma</font><font color="#808080">, [</font><font color="#000080">self LinhaReg</font><font color="#808080">: </font><font color="#000080">sreg</font><font color="#808080">], </font><font color="#000080">MSG_REGINC</font><font color="#808080">, </font><font color="#000080">MSG_REGNINC</font><font color="#808080">];
   </font><font color="#0000FF"><b>else if </b></font><font color="#808080">(</font><font color="#000080">sacao</font><font color="#808080">==</font><font color="#000080">opSalvarAlteracao</font><font color="#808080">)
      [</font><font color="#000080">self escreveArq</font><font color="#808080">: </font><font color="#000080">tfIdioma</font><font color="#808080">, [</font><font color="#000080">self LinhaReg</font><font color="#808080">: </font><font color="#000080">sreg</font><font color="#808080">], </font><font color="#000080">MSG_REGALT</font><font color="#808080">, </font><font color="#000080">MSG_REGNALT</font><font color="#808080">];
   </font><font color="#0000FF"><b>else if </b></font><font color="#808080">(</font><font color="#000080">sacao</font><font color="#808080">==</font><font color="#000080">opConfirmaExclusao</font><font color="#808080">)
      [</font><font color="#000080">self escreveArq</font><font color="#808080">: </font><font color="#000080">tfIdioma</font><font color="#808080">, [</font><font color="#000080">self repete</font><font color="#808080">: </font><font color="#800000">&quot;*&quot;</font><font color="#808080">,[</font><font color="#000080">self tamReg</font><font color="#808080">: </font><font color="#000080">sreg</font><font color="#808080">]], </font><font color="#000080">MSG_REGEXC</font><font color="#808080">, </font><font color="#000080">MSG_REGNEXC</font><font color="#808080">];
} </font><font color="#0000FF"><b>else if </b></font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">==</font><font color="#000080">opPais</font><font color="#808080">) {
   </font><font color="#0000FF"><b>if </b></font><font color="#808080">(</font><font color="#000080">sacao</font><font color="#808080">==</font><font color="#000080">opSalvarInclusao</font><font color="#808080">)
      [</font><font color="#000080">self escreveArq</font><font color="#808080">: </font><font color="#000080">tfPais</font><font color="#808080">, [</font><font color="#000080">self LinhaReg</font><font color="#808080">: </font><font color="#000080">sreg</font><font color="#808080">], </font><font color="#000080">MSG_REGINC</font><font color="#808080">, </font><font color="#000080">MSG_REGNINC</font><font color="#808080">];
   </font><font color="#0000FF"><b>else if </b></font><font color="#808080">(</font><font color="#000080">sacao</font><font color="#808080">==</font><font color="#000080">opSalvarAlteracao</font><font color="#808080">)
      [</font><font color="#000080">self escreveArq</font><font color="#808080">: </font><font color="#000080">tfPais</font><font color="#808080">, [</font><font color="#000080">self LinhaReg</font><font color="#808080">: </font><font color="#000080">sreg</font><font color="#808080">], </font><font color="#000080">MSG_REGALT</font><font color="#808080">, </font><font color="#000080">MSG_REGNALT</font><font color="#808080">];
   </font><font color="#0000FF"><b>else if </b></font><font color="#808080">(</font><font color="#000080">sacao</font><font color="#808080">==</font><font color="#000080">opConfirmaExclusao</font><font color="#808080">)
      [</font><font color="#000080">self escreveArq</font><font color="#808080">: </font><font color="#000080">tfPais</font><font color="#808080">, [</font><font color="#000080">self repete</font><font color="#808080">: </font><font color="#800000">&quot;*&quot;</font><font color="#808080">,[</font><font color="#000080">self tamReg</font><font color="#808080">: </font><font color="#000080">sreg</font><font color="#808080">]], </font><font color="#000080">MSG_REGEXC</font><font color="#808080">, </font><font color="#000080">MSG_REGNEXC</font><font color="#808080">];
} </font><font color="#0000FF"><b>else if </b></font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">==</font><font color="#000080">opProfissao</font><font color="#808080">) {
   </font><font color="#0000FF"><b>if </b></font><font color="#808080">(</font><font color="#000080">sacao</font><font color="#808080">==</font><font color="#000080">opSalvarInclusao</font><font color="#808080">)
      [</font><font color="#000080">self escreveArq</font><font color="#808080">: </font><font color="#000080">tfProfissao</font><font color="#808080">, [</font><font color="#000080">self LinhaReg</font><font color="#808080">: </font><font color="#000080">sreg</font><font color="#808080">], </font><font color="#000080">MSG_REGINC</font><font color="#808080">, </font><font color="#000080">MSG_REGNINC</font><font color="#808080">];
   </font><font color="#0000FF"><b>else if </b></font><font color="#808080">(</font><font color="#000080">sacao</font><font color="#808080">==</font><font color="#000080">opSalvarAlteracao</font><font color="#808080">)
      [</font><font color="#000080">self escreveArq</font><font color="#808080">: </font><font color="#000080">tfProfissao</font><font color="#808080">, [</font><font color="#000080">self LinhaReg</font><font color="#808080">: </font><font color="#000080">sreg</font><font color="#808080">], </font><font color="#000080">MSG_REGALT</font><font color="#808080">, </font><font color="#000080">MSG_REGNALT</font><font color="#808080">];
   </font><font color="#0000FF"><b>else if </b></font><font color="#808080">(</font><font color="#000080">sacao</font><font color="#808080">==</font><font color="#000080">opConfirmaExclusao</font><font color="#808080">)
     [</font><font color="#000080">self escreveArq</font><font color="#808080">: </font><font color="#000080">tfProfissao</font><font color="#808080">, [</font><font color="#000080">self repete</font><font color="#808080">: </font><font color="#800000">&quot;*&quot;</font><font color="#808080">,[</font><font color="#000080">self tamReg</font><font color="#808080">: </font><font color="#000080">sreg</font><font color="#808080">]], </font><font color="#000080">MSG_REGEXC</font><font color="#808080">, </font><font color="#000080">MSG_REGNEXC</font><font color="#808080">];
} </font><font color="#0000FF"><b>else if </b></font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">==</font><font color="#000080">opLivro</font><font color="#808080">) {
   </font><font color="#0000FF"><b>if </b></font><font color="#808080">(</font><font color="#000080">sacao</font><font color="#808080">==</font><font color="#000080">opSalvarInclusao</font><font color="#808080">)
      [</font><font color="#000080">self escreveArq</font><font color="#808080">: </font><font color="#000080">tfLivro</font><font color="#808080">, [</font><font color="#000080">self LinhaReg</font><font color="#808080">: </font><font color="#000080">sreg</font><font color="#808080">], </font><font color="#000080">MSG_REGINC</font><font color="#808080">, </font><font color="#000080">MSG_REGNINC</font><font color="#808080">];
   </font><font color="#0000FF"><b>else if </b></font><font color="#808080">(</font><font color="#000080">sacao</font><font color="#808080">==</font><font color="#000080">opSalvarAlteracao</font><font color="#808080">)
      [</font><font color="#000080">self escreveArq</font><font color="#808080">: </font><font color="#000080">tfLivro</font><font color="#808080">, [</font><font color="#000080">self LinhaReg</font><font color="#808080">: </font><font color="#000080">sreg</font><font color="#808080">], </font><font color="#000080">MSG_REGALT</font><font color="#808080">, </font><font color="#000080">MSG_REGNALT</font><font color="#808080">];
   </font><font color="#0000FF"><b>else if </b></font><font color="#808080">(</font><font color="#000080">sacao</font><font color="#808080">==</font><font color="#000080">opConfirmaExclusao</font><font color="#808080">)
      [</font><font color="#000080">self escreveArq</font><font color="#808080">: </font><font color="#000080">tfLivro</font><font color="#808080">, [</font><font color="#000080">self repete</font><font color="#808080">: </font><font color="#800000">&quot;*&quot;</font><font color="#808080">,[</font><font color="#000080">self tamReg</font><font color="#808080">: </font><font color="#000080">sreg</font><font color="#808080">]], </font><font color="#000080">MSG_REGEXC</font><font color="#808080">, </font><font color="#000080">MSG_REGNEXC</font><font color="#808080">];
} </font><font color="#0000FF"><b>else if </b></font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">==</font><font color="#000080">opLivroAss</font><font color="#808080">) {
   </font><font color="#0000FF"><b>if </b></font><font color="#808080">(</font><font color="#000080">sacao</font><font color="#808080">==</font><font color="#000080">opSalvarInclusao</font><font color="#808080">)
      [</font><font color="#000080">self escreveArq</font><font color="#808080">: </font><font color="#000080">tfLivroAss</font><font color="#808080">, [</font><font color="#000080">self LinhaReg</font><font color="#808080">: </font><font color="#000080">sreg</font><font color="#808080">], </font><font color="#000080">MSG_REGINC</font><font color="#808080">, </font><font color="#000080">MSG_REGNINC</font><font color="#808080">];
   </font><font color="#0000FF"><b>else if </b></font><font color="#808080">(</font><font color="#000080">sacao</font><font color="#808080">==</font><font color="#000080">opSalvarAlteracao</font><font color="#808080">)
      [</font><font color="#000080">self escreveArq</font><font color="#808080">: </font><font color="#000080">tfLivroAss</font><font color="#808080">, [</font><font color="#000080">self LinhaReg</font><font color="#808080">: </font><font color="#000080">sreg</font><font color="#808080">], </font><font color="#000080">MSG_REGALT</font><font color="#808080">, </font><font color="#000080">MSG_REGNALT</font><font color="#808080">];
   </font><font color="#0000FF"><b>else if </b></font><font color="#808080">(</font><font color="#000080">sacao</font><font color="#808080">==</font><font color="#000080">opConfirmaExclusao</font><font color="#808080">)
      [</font><font color="#000080">self escreveArq</font><font color="#808080">: </font><font color="#000080">tfLivroAss</font><font color="#808080">, [</font><font color="#000080">self repete</font><font color="#808080">: </font><font color="#800000">&quot;*&quot;</font><font color="#808080">,[</font><font color="#000080">self tamReg</font><font color="#808080">: </font><font color="#000080">sreg</font><font color="#808080">]], </font><font color="#000080">MSG_REGEXC</font><font color="#808080">, </font><font color="#000080">MSG_REGNEXC</font><font color="#808080">];
} </font><font color="#0000FF"><b>else if </b></font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">==</font><font color="#000080">opLivroAut</font><font color="#808080">) {
   </font><font color="#0000FF"><b>if </b></font><font color="#808080">(</font><font color="#000080">sacao</font><font color="#808080">==</font><font color="#000080">opSalvarInclusao</font><font color="#808080">)
      [</font><font color="#000080">self escreveArq</font><font color="#808080">: </font><font color="#000080">tfLivroAut</font><font color="#808080">, [</font><font color="#000080">self LinhaReg</font><font color="#808080">: </font><font color="#000080">sreg</font><font color="#808080">], </font><font color="#000080">MSG_REGINC</font><font color="#808080">, </font><font color="#000080">MSG_REGNINC</font><font color="#808080">];
   </font><font color="#0000FF"><b>else if </b></font><font color="#808080">(</font><font color="#000080">sacao</font><font color="#808080">==</font><font color="#000080">opSalvarAlteracao</font><font color="#808080">)
      [</font><font color="#000080">self escreveArq</font><font color="#808080">: </font><font color="#000080">tfLivroAut</font><font color="#808080">, [</font><font color="#000080">self LinhaReg</font><font color="#808080">: </font><font color="#000080">sreg</font><font color="#808080">], </font><font color="#000080">MSG_REGALT</font><font color="#808080">, </font><font color="#000080">MSG_REGNALT</font><font color="#808080">];
   </font><font color="#0000FF"><b>else if </b></font><font color="#808080">(</font><font color="#000080">sacao</font><font color="#808080">==</font><font color="#000080">opConfirmaExclusao</font><font color="#808080">)
      [</font><font color="#000080">self escreveArq</font><font color="#808080">: </font><font color="#000080">tfLivroAut</font><font color="#808080">, [</font><font color="#000080">self repete</font><font color="#808080">: </font><font color="#800000">&quot;*&quot;</font><font color="#808080">,[</font><font color="#000080">self tamReg</font><font color="#808080">: </font><font color="#000080">sreg</font><font color="#808080">]], </font><font color="#000080">MSG_REGEXC</font><font color="#808080">, </font><font color="#000080">MSG_REGNEXC</font><font color="#808080">];
} </font><font color="#0000FF"><b>else if </b></font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">==</font><font color="#000080">opCliente</font><font color="#808080">) {
   </font><font color="#0000FF"><b>if </b></font><font color="#808080">(</font><font color="#000080">sacao</font><font color="#808080">==</font><font color="#000080">opSalvarInclusao</font><font color="#808080">)
      [</font><font color="#000080">self escreveArq</font><font color="#808080">: </font><font color="#000080">tfCliente</font><font color="#808080">, [</font><font color="#000080">self LinhaReg</font><font color="#808080">: </font><font color="#000080">sreg</font><font color="#808080">], </font><font color="#000080">MSG_REGINC</font><font color="#808080">, </font><font color="#000080">MSG_REGNINC</font><font color="#808080">];
   </font><font color="#0000FF"><b>else if </b></font><font color="#808080">(</font><font color="#000080">sacao</font><font color="#808080">==</font><font color="#000080">opSalvarAlteracao</font><font color="#808080">)
      [</font><font color="#000080">self escreveArq</font><font color="#808080">: </font><font color="#000080">tfCliente</font><font color="#808080">, [</font><font color="#000080">self LinhaReg</font><font color="#808080">: </font><font color="#000080">sreg</font><font color="#808080">], </font><font color="#000080">MSG_REGALT</font><font color="#808080">, </font><font color="#000080">MSG_REGNALT</font><font color="#808080">];
   </font><font color="#0000FF"><b>else if </b></font><font color="#808080">(</font><font color="#000080">sacao</font><font color="#808080">==</font><font color="#000080">opConfirmaExclusao</font><font color="#808080">)
      [</font><font color="#000080">self escreveArq</font><font color="#808080">: </font><font color="#000080">tfCliente</font><font color="#808080">, [</font><font color="#000080">self repete</font><font color="#808080">: </font><font color="#800000">&quot;*&quot;</font><font color="#808080">,[</font><font color="#000080">self tamReg</font><font color="#808080">: </font><font color="#000080">sreg</font><font color="#808080">]], </font><font color="#000080">MSG_REGEXC</font><font color="#808080">, </font><font color="#000080">MSG_REGNEXC</font><font color="#808080">];
} </font><font color="#0000FF"><b>else if </b></font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">==</font><font color="#000080">opVenda</font><font color="#808080">) {
   </font><font color="#0000FF"><b>if </b></font><font color="#808080">(</font><font color="#000080">sacao</font><font color="#808080">==</font><font color="#000080">opSalvarInclusao</font><font color="#808080">)
      [</font><font color="#000080">self escreveArq</font><font color="#808080">: </font><font color="#000080">tfVenda</font><font color="#808080">, [</font><font color="#000080">self LinhaReg</font><font color="#808080">: </font><font color="#000080">sreg</font><font color="#808080">], </font><font color="#000080">MSG_REGINC</font><font color="#808080">, </font><font color="#000080">MSG_REGNINC</font><font color="#808080">];
   </font><font color="#0000FF"><b>else if </b></font><font color="#808080">(</font><font color="#000080">sacao</font><font color="#808080">==</font><font color="#000080">opSalvarAlteracao</font><font color="#808080">)
      [</font><font color="#000080">self escreveArq</font><font color="#808080">: </font><font color="#000080">tfVenda</font><font color="#808080">, [</font><font color="#000080">self LinhaReg</font><font color="#808080">: </font><font color="#000080">sreg</font><font color="#808080">], </font><font color="#000080">MSG_REGALT</font><font color="#808080">, </font><font color="#000080">MSG_REGNALT</font><font color="#808080">];
   </font><font color="#0000FF"><b>else if </b></font><font color="#808080">(</font><font color="#000080">sacao</font><font color="#808080">==</font><font color="#000080">opConfirmaExclusao</font><font color="#808080">)
      [</font><font color="#000080">self escreveArq</font><font color="#808080">: </font><font color="#000080">tfVenda</font><font color="#808080">, [</font><font color="#000080">self repete</font><font color="#808080">: </font><font color="#800000">&quot;*&quot;</font><font color="#808080">,[</font><font color="#000080">self tamReg</font><font color="#808080">: </font><font color="#000080">sreg</font><font color="#808080">]], </font><font color="#000080">MSG_REGEXC</font><font color="#808080">, </font><font color="#000080">MSG_REGNEXC</font><font color="#808080">];
} </font><font color="#0000FF"><b>else if </b></font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">==</font><font color="#000080">opUsuario</font><font color="#808080">) {
   </font><font color="#0000FF"><b>if </b></font><font color="#808080">(</font><font color="#000080">sacao</font><font color="#808080">==</font><font color="#000080">opSalvarAlteracao</font><font color="#808080">)
      [</font><font color="#000080">self escreveArq</font><font color="#808080">: </font><font color="#000080">tfUsuario</font><font color="#808080">, [</font><font color="#000080">self LinhaReg</font><font color="#808080">: </font><font color="#000080">sreg</font><font color="#808080">], </font><font color="#000080">MSG_REGALT</font><font color="#808080">, </font><font color="#000080">MSG_REGNALT</font><font color="#808080">];
}
</font><font color="#0000FF"><b>return </b></font><font color="#000080">self</font><font color="#808080">;
}
<i>/*------------------------------------------------------------------------------
Seleciona o menu e/ou a tela certa de acordo com o tipo de arquivo.
nmenu - o n&uacute;mero do menu
sreg - o tipo de arquivo
------------------------------------------------------------------------------*/
</i>- </font><font color="#000080">subMenu</font><font color="#808080">: (</font><font color="#0000FF"><b>int</b></font><font color="#808080">) </font><font color="#000080">nmenu</font><font color="#808080">, ...
{ 
  </font><font color="#0000FF"><b>enum </b></font><font color="#000080">ctArqs sreg</font><font color="#808080">;
  </font><font color="#0000FF"><b>int </b></font><font color="#000080">opSubMenu</font><font color="#808080">;
  </font><font color="#0000FF"><b>char </b></font><font color="#000080">opCSubMenu</font><font color="#808080">;
  </font><font color="#000080">BOOL bSOp</font><font color="#808080">;

</font><font color="#000080">va_list lparams</font><font color="#808080">;
</font><font color="#000080">va_start</font><font color="#808080">(</font><font color="#000080">lparams</font><font color="#808080">, </font><font color="#000080">nmenu</font><font color="#808080">);
</font><font color="#000080">sreg </font><font color="#808080">= </font><font color="#000080">va_arg</font><font color="#808080">(</font><font color="#000080">lparams</font><font color="#808080">,</font><font color="#0000FF"><b>enum </b></font><font color="#000080">ctArqs</font><font color="#808080">);
</font><font color="#000080">va_end</font><font color="#808080">(</font><font color="#000080">lparams</font><font color="#808080">);

</font><font color="#000080">bSOp </font><font color="#808080">= </font><font color="#000080">YES</font><font color="#808080">;
</font><font color="#0000FF"><b>switch</b></font><font color="#808080">(</font><font color="#000080">nmenu</font><font color="#808080">) {
 </font><font color="#0000FF"><b>case </b></font><font color="#FF0000">6</font><font color="#808080">:{
    </font><font color="#0000FF"><b>while</b></font><font color="#808080">(</font><font color="#000080">bSOp</font><font color="#808080">) {
     [</font><font color="#000080">self menu</font><font color="#808080">: </font><font color="#000080">nmenu</font><font color="#808080">];
     </font><font color="#000080">fscanf</font><font color="#808080">(</font><font color="#000080">stdin</font><font color="#808080">, </font><font color="#800000">&quot;%d&quot;</font><font color="#808080">, &amp;</font><font color="#000080">opSubMenu</font><font color="#808080">);
     </font><font color="#0000FF"><b>switch</b></font><font color="#808080">(</font><font color="#000080">opSubMenu</font><font color="#808080">) {
      </font><font color="#0000FF"><b>case </b></font><font color="#FF0000">1</font><font color="#808080">: [</font><font color="#000080">self frmCadastros</font><font color="#808080">: </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#000080">opNovo</font><font color="#808080">]; </font><font color="#0000FF"><b>break</b></font><font color="#808080">;
      </font><font color="#0000FF"><b>case </b></font><font color="#FF0000">2</font><font color="#808080">: [</font><font color="#000080">self frmCadastros</font><font color="#808080">: </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#000080">opPesquisar</font><font color="#808080">]; </font><font color="#0000FF"><b>break</b></font><font color="#808080">;
      </font><font color="#0000FF"><b>case </b></font><font color="#FF0000">3</font><font color="#808080">: </font><font color="#000080">bSOp </font><font color="#808080">= </font><font color="#000080">NO</font><font color="#808080">; </font><font color="#0000FF"><b>break</b></font><font color="#808080">;
</font>	  <font color="#0000FF"><b>default</b></font><font color="#808080">: </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;%s\n&quot;</font><font color="#808080">,</font><font color="#000080">MSG_ERRO</font><font color="#808080">);
     }
    }
   } </font><font color="#0000FF"><b>break</b></font><font color="#808080">;
 </font><font color="#0000FF"><b>case </b></font><font color="#FF0000">7</font><font color="#808080">:{
    </font><font color="#0000FF"><b>while</b></font><font color="#808080">(</font><font color="#000080">bSOp</font><font color="#808080">) {
     [</font><font color="#000080">self menu</font><font color="#808080">: </font><font color="#000080">nmenu</font><font color="#808080">];
     </font><font color="#000080">fscanf</font><font color="#808080">(</font><font color="#000080">stdin</font><font color="#808080">, </font><font color="#800000">&quot;%d&quot;</font><font color="#808080">, &amp;</font><font color="#000080">opSubMenu</font><font color="#808080">);
     </font><font color="#0000FF"><b>switch</b></font><font color="#808080">(</font><font color="#000080">opSubMenu</font><font color="#808080">) {
      </font><font color="#0000FF"><b>case </b></font><font color="#FF0000">1</font><font color="#808080">: { [</font><font color="#000080">self btnAcao</font><font color="#808080">: </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#000080">opSalvarInclusao</font><font color="#808080">]; </font><font color="#000080">bSOp </font><font color="#808080">= </font><font color="#000080">NO</font><font color="#808080">; } </font><font color="#0000FF"><b>break</b></font><font color="#808080">;
      </font><font color="#0000FF"><b>case </b></font><font color="#FF0000">2</font><font color="#808080">: </font><font color="#000080">bSOp </font><font color="#808080">= </font><font color="#000080">NO</font><font color="#808080">; </font><font color="#0000FF"><b>break</b></font><font color="#808080">;
</font>	  <font color="#0000FF"><b>default</b></font><font color="#808080">: </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;%s\n&quot;</font><font color="#808080">,</font><font color="#000080">MSG_ERRO</font><font color="#808080">);
     }
    }
   } </font><font color="#0000FF"><b>break</b></font><font color="#808080">;
 </font><font color="#0000FF"><b>case </b></font><font color="#FF0000">8</font><font color="#808080">:{
    </font><font color="#0000FF"><b>while</b></font><font color="#808080">(</font><font color="#000080">bSOp</font><font color="#808080">) {
     [</font><font color="#000080">self menu</font><font color="#808080">: </font><font color="#000080">nmenu</font><font color="#808080">];
     </font><font color="#000080">fscanf</font><font color="#808080">(</font><font color="#000080">stdin</font><font color="#808080">, </font><font color="#800000">&quot;%d&quot;</font><font color="#808080">, &amp;</font><font color="#000080">opSubMenu</font><font color="#808080">);     
     </font><font color="#0000FF"><b>switch</b></font><font color="#808080">(</font><font color="#000080">opSubMenu</font><font color="#808080">) {
      </font><font color="#0000FF"><b>case </b></font><font color="#FF0000">1</font><font color="#808080">: { [</font><font color="#000080">self frmCadastros</font><font color="#808080">: </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#000080">opAlterar</font><font color="#808080">]; </font><font color="#000080">bSOp </font><font color="#808080">= </font><font color="#000080">NO</font><font color="#808080">; } </font><font color="#0000FF"><b>break</b></font><font color="#808080">;
      </font><font color="#0000FF"><b>case </b></font><font color="#FF0000">2</font><font color="#808080">: { [</font><font color="#000080">self frmCadastros</font><font color="#808080">: </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#000080">opExcluir</font><font color="#808080">]; </font><font color="#000080">bSOp </font><font color="#808080">= </font><font color="#000080">NO</font><font color="#808080">; } </font><font color="#0000FF"><b>break</b></font><font color="#808080">;
      </font><font color="#0000FF"><b>case </b></font><font color="#FF0000">3</font><font color="#808080">: </font><font color="#000080">bSOp </font><font color="#808080">= </font><font color="#000080">NO</font><font color="#808080">; </font><font color="#0000FF"><b>break</b></font><font color="#808080">;
      </font><font color="#0000FF"><b>default</b></font><font color="#808080">: </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;%s\n&quot;</font><font color="#808080">,</font><font color="#000080">MSG_ERRO</font><font color="#808080">);
     }
    }
   } </font><font color="#0000FF"><b>break</b></font><font color="#808080">;
 </font><font color="#0000FF"><b>case </b></font><font color="#FF0000">9</font><font color="#808080">:{
    </font><font color="#0000FF"><b>while</b></font><font color="#808080">(</font><font color="#000080">bSOp</font><font color="#808080">) {
     [</font><font color="#000080">self menu</font><font color="#808080">: </font><font color="#000080">nmenu</font><font color="#808080">];
     </font><font color="#000080">fscanf</font><font color="#808080">(</font><font color="#000080">stdin</font><font color="#808080">, </font><font color="#800000">&quot;%d&quot;</font><font color="#808080">, &amp;</font><font color="#000080">opSubMenu</font><font color="#808080">);     
     </font><font color="#0000FF"><b>switch</b></font><font color="#808080">(</font><font color="#000080">opSubMenu</font><font color="#808080">) {
      </font><font color="#0000FF"><b>case </b></font><font color="#FF0000">1</font><font color="#808080">: { [</font><font color="#000080">self btnAcao</font><font color="#808080">: </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#000080">opSalvarAlteracao</font><font color="#808080">]; </font><font color="#000080">bSOp </font><font color="#808080">= </font><font color="#000080">NO</font><font color="#808080">; } </font><font color="#0000FF"><b>break</b></font><font color="#808080">;
      </font><font color="#0000FF"><b>case </b></font><font color="#FF0000">2</font><font color="#808080">: </font><font color="#000080">bSOp </font><font color="#808080">= </font><font color="#000080">NO</font><font color="#808080">; </font><font color="#0000FF"><b>break</b></font><font color="#808080">;
      </font><font color="#0000FF"><b>default</b></font><font color="#808080">: </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;%s\n&quot;</font><font color="#808080">,</font><font color="#000080">MSG_ERRO</font><font color="#808080">);
     }
    }
   } </font><font color="#0000FF"><b>break</b></font><font color="#808080">;
 </font><font color="#0000FF"><b>case </b></font><font color="#FF0000">10</font><font color="#808080">:{
    </font><font color="#0000FF"><b>while</b></font><font color="#808080">(</font><font color="#000080">bSOp</font><font color="#808080">) {
     [</font><font color="#000080">self menu</font><font color="#808080">: </font><font color="#000080">nmenu</font><font color="#808080">];
     </font><font color="#000080">fscanf</font><font color="#808080">(</font><font color="#000080">stdin</font><font color="#808080">, </font><font color="#800000">&quot;%s&quot;</font><font color="#808080">, &amp;</font><font color="#000080">opCSubMenu</font><font color="#808080">);     
     </font><font color="#0000FF"><b>if </b></font><font color="#808080">((</font><font color="#000080">opCSubMenu</font><font color="#808080">==</font>'S'<font color="#808080">) || (</font><font color="#000080">opCSubMenu</font><font color="#808080">==</font>'s'<font color="#808080">)) {
        [</font><font color="#000080">self btnAcao</font><font color="#808080">: </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#000080">opConfirmaExclusao</font><font color="#808080">];
        </font><font color="#000080">bSOp </font><font color="#808080">= </font><font color="#000080">NO</font><font color="#808080">;
     } </font><font color="#0000FF"><b>else if </b></font><font color="#808080">((</font><font color="#000080">opCSubMenu</font><font color="#808080">==</font>'N'<font color="#808080">) || (</font><font color="#000080">opCSubMenu</font><font color="#808080">==</font>'n'<font color="#808080">)) </font><font color="#000080">bSOp </font><font color="#808080">= </font><font color="#000080">NO</font><font color="#808080">;
     </font><font color="#0000FF"><b>else </b></font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;%s\n&quot;</font><font color="#808080">,</font><font color="#000080">MSG_ERRO</font><font color="#808080">);
    }
   } </font><font color="#0000FF"><b>break</b></font><font color="#808080">;
 </font><font color="#0000FF"><b>case </b></font><font color="#FF0000">12</font><font color="#808080">:{
    </font><font color="#0000FF"><b>while</b></font><font color="#808080">(</font><font color="#000080">bSOp</font><font color="#808080">) {
     [</font><font color="#000080">self menu</font><font color="#808080">: </font><font color="#000080">nmenu</font><font color="#808080">];
     </font><font color="#000080">fscanf</font><font color="#808080">(</font><font color="#000080">stdin</font><font color="#808080">, </font><font color="#800000">&quot;%d&quot;</font><font color="#808080">, &amp;</font><font color="#000080">opSubMenu</font><font color="#808080">);     
     </font><font color="#0000FF"><b>switch</b></font><font color="#808080">(</font><font color="#000080">opSubMenu</font><font color="#808080">) {
      </font><font color="#0000FF"><b>case </b></font><font color="#FF0000">1</font><font color="#808080">: [</font><font color="#000080">self frmConsultas</font><font color="#808080">: </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#000080">opPesquisar</font><font color="#808080">]; </font><font color="#0000FF"><b>break</b></font><font color="#808080">;
      </font><font color="#0000FF"><b>case </b></font><font color="#FF0000">2</font><font color="#808080">: [</font><font color="#000080">self frmConsultas</font><font color="#808080">: </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#000080">opListarTodos</font><font color="#808080">]; </font><font color="#0000FF"><b>break</b></font><font color="#808080">;
      </font><font color="#0000FF"><b>case </b></font><font color="#FF0000">3</font><font color="#808080">: </font><font color="#000080">bSOp </font><font color="#808080">= </font><font color="#000080">NO</font><font color="#808080">; </font><font color="#0000FF"><b>break</b></font><font color="#808080">;
      </font><font color="#0000FF"><b>default</b></font><font color="#808080">: </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;%s\n&quot;</font><font color="#808080">,</font><font color="#000080">MSG_ERRO</font><font color="#808080">);
     }
    }
   } </font><font color="#0000FF"><b>break</b></font><font color="#808080">;
 </font><font color="#0000FF"><b>case </b></font><font color="#FF0000">14</font><font color="#808080">:{
    </font><font color="#0000FF"><b>while</b></font><font color="#808080">(</font><font color="#000080">bSOp</font><font color="#808080">) {
     [</font><font color="#000080">self menu</font><font color="#808080">: </font><font color="#000080">nmenu</font><font color="#808080">];
     </font><font color="#000080">fscanf</font><font color="#808080">(</font><font color="#000080">stdin</font><font color="#808080">, </font><font color="#800000">&quot;%s&quot;</font><font color="#808080">, &amp;</font><font color="#000080">opCSubMenu</font><font color="#808080">);     
     </font><font color="#0000FF"><b>if </b></font><font color="#808080">((</font><font color="#000080">opCSubMenu</font><font color="#808080">==</font>'S'<font color="#808080">) || (</font><font color="#000080">opCSubMenu</font><font color="#808080">==</font>'s'<font color="#808080">)) {
        [</font><font color="#000080">self btnAcao</font><font color="#808080">: </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#000080">opSalvarInclusao</font><font color="#808080">];
        </font><font color="#000080">bSOp </font><font color="#808080">= </font><font color="#000080">NO</font><font color="#808080">;
        </font><font color="#000080">g_SalvarInclusao </font><font color="#808080">= </font><font color="#000080">YES</font><font color="#808080">;
     } </font><font color="#0000FF"><b>else if </b></font><font color="#808080">((</font><font color="#000080">opCSubMenu</font><font color="#808080">==</font>'N'<font color="#808080">) || (</font><font color="#000080">opCSubMenu</font><font color="#808080">==</font>'n'<font color="#808080">)) </font><font color="#000080">bSOp </font><font color="#808080">= </font><font color="#000080">NO</font><font color="#808080">;
     </font><font color="#0000FF"><b>else </b></font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;%s\n&quot;</font><font color="#808080">,</font><font color="#000080">MSG_ERRO</font><font color="#808080">);
    }
   } </font><font color="#0000FF"><b>break</b></font><font color="#808080">;
}
</font><font color="#0000FF"><b>return </b></font><font color="#000080">self</font><font color="#808080">;
}
<i>/*------------------------------------------------------------------------------
Seleciona o submenu e/ou a tela certa de acordo com n&uacute;mero do menu.
nmenu - o n&uacute;mero do menu
------------------------------------------------------------------------------*/
</i>- </font><font color="#000080">usaMenu</font><font color="#808080">: (</font><font color="#0000FF"><b>int</b></font><font color="#808080">) </font><font color="#000080">num
</font><font color="#808080">{ </font><font color="#0000FF"><b>int </b></font><font color="#000080">opSubMenu</font><font color="#808080">;
  </font><font color="#000080">BOOL bSOp</font><font color="#808080">;
  </font><font color="#0000FF"><b>char </b></font><font color="#000080">opSair</font><font color="#808080">;

 </font><font color="#000080">bSOp </font><font color="#808080">= </font><font color="#000080">YES</font><font color="#808080">;
 </font><font color="#0000FF"><b>if </b></font><font color="#808080">(</font><font color="#000080">num </font><font color="#808080">== </font><font color="#FF0000">1</font><font color="#808080">) { <i>/* Cadastros */
   </i></font><font color="#0000FF"><b>while</b></font><font color="#808080">(</font><font color="#000080">bSOp</font><font color="#808080">) {
     [</font><font color="#000080">self menu</font><font color="#808080">: </font><font color="#FF0000">2</font><font color="#808080">];
     </font><font color="#000080">fscanf</font><font color="#808080">(</font><font color="#000080">stdin</font><font color="#808080">, </font><font color="#800000">&quot;%d&quot;</font><font color="#808080">, &amp;</font><font color="#000080">opSubMenu</font><font color="#808080">);     
     </font><font color="#0000FF"><b>switch</b></font><font color="#808080">(</font><font color="#000080">opSubMenu</font><font color="#808080">) {
      </font><font color="#0000FF"><b>case </b></font><font color="#FF0000">1</font><font color="#808080">: [</font><font color="#000080">self subMenu</font><font color="#808080">: </font><font color="#FF0000">6</font><font color="#808080">, </font><font color="#000080">opAssunto</font><font color="#808080">]; </font><font color="#0000FF"><b>break</b></font><font color="#808080">;
      </font><font color="#0000FF"><b>case </b></font><font color="#FF0000">2</font><font color="#808080">: [</font><font color="#000080">self subMenu</font><font color="#808080">: </font><font color="#FF0000">6</font><font color="#808080">, </font><font color="#000080">opAutor</font><font color="#808080">]; </font><font color="#0000FF"><b>break</b></font><font color="#808080">;
      </font><font color="#0000FF"><b>case </b></font><font color="#FF0000">3</font><font color="#808080">: [</font><font color="#000080">self subMenu</font><font color="#808080">: </font><font color="#FF0000">6</font><font color="#808080">, </font><font color="#000080">opEditora</font><font color="#808080">]; </font><font color="#0000FF"><b>break</b></font><font color="#808080">;
      </font><font color="#0000FF"><b>case </b></font><font color="#FF0000">4</font><font color="#808080">: [</font><font color="#000080">self subMenu</font><font color="#808080">: </font><font color="#FF0000">6</font><font color="#808080">, </font><font color="#000080">opEndereco</font><font color="#808080">]; </font><font color="#0000FF"><b>break</b></font><font color="#808080">;
      </font><font color="#0000FF"><b>case </b></font><font color="#FF0000">5</font><font color="#808080">: [</font><font color="#000080">self subMenu</font><font color="#808080">: </font><font color="#FF0000">6</font><font color="#808080">, </font><font color="#000080">opIdioma</font><font color="#808080">]; </font><font color="#0000FF"><b>break</b></font><font color="#808080">;
      </font><font color="#0000FF"><b>case </b></font><font color="#FF0000">6</font><font color="#808080">: [</font><font color="#000080">self subMenu</font><font color="#808080">: </font><font color="#FF0000">6</font><font color="#808080">, </font><font color="#000080">opPais</font><font color="#808080">]; </font><font color="#0000FF"><b>break</b></font><font color="#808080">;
      </font><font color="#0000FF"><b>case </b></font><font color="#FF0000">7</font><font color="#808080">: [</font><font color="#000080">self subMenu</font><font color="#808080">: </font><font color="#FF0000">6</font><font color="#808080">, </font><font color="#000080">opProfissao</font><font color="#808080">]; </font><font color="#0000FF"><b>break</b></font><font color="#808080">;
      </font><font color="#0000FF"><b>case </b></font><font color="#FF0000">8</font><font color="#808080">: [</font><font color="#000080">self subMenu</font><font color="#808080">: </font><font color="#FF0000">6</font><font color="#808080">, </font><font color="#000080">opCliente</font><font color="#808080">]; </font><font color="#0000FF"><b>break</b></font><font color="#808080">;
      </font><font color="#0000FF"><b>case </b></font><font color="#FF0000">9</font><font color="#808080">: [</font><font color="#000080">self subMenu</font><font color="#808080">: </font><font color="#FF0000">6</font><font color="#808080">, </font><font color="#000080">opLivro</font><font color="#808080">]; </font><font color="#0000FF"><b>break</b></font><font color="#808080">;
      </font><font color="#0000FF"><b>case </b></font><font color="#FF0000">10</font><font color="#808080">: </font><font color="#000080">bSOp </font><font color="#808080">= </font><font color="#000080">NO</font><font color="#808080">; </font><font color="#0000FF"><b>break</b></font><font color="#808080">;
      </font><font color="#0000FF"><b>default</b></font><font color="#808080">: </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;%s\n&quot;</font><font color="#808080">,</font><font color="#000080">MSG_ERRO</font><font color="#808080">);
     }
   }
 } </font><font color="#0000FF"><b>else if </b></font><font color="#808080">(</font><font color="#000080">num </font><font color="#808080">== </font><font color="#FF0000">2</font><font color="#808080">) { <i>/* Pesquisas */
   </i></font><font color="#0000FF"><b>while</b></font><font color="#808080">(</font><font color="#000080">bSOp</font><font color="#808080">) {
     [</font><font color="#000080">self menu</font><font color="#808080">: </font><font color="#FF0000">3</font><font color="#808080">];
     </font><font color="#000080">fscanf</font><font color="#808080">(</font><font color="#000080">stdin</font><font color="#808080">, </font><font color="#800000">&quot;%d&quot;</font><font color="#808080">, &amp;</font><font color="#000080">opSubMenu</font><font color="#808080">);     
     </font><font color="#0000FF"><b>switch</b></font><font color="#808080">(</font><font color="#000080">opSubMenu</font><font color="#808080">) {
      </font><font color="#0000FF"><b>case </b></font><font color="#FF0000">1</font><font color="#808080">: [</font><font color="#000080">self subMenu</font><font color="#808080">: </font><font color="#FF0000">12</font><font color="#808080">, </font><font color="#000080">opAssunto</font><font color="#808080">]; </font><font color="#0000FF"><b>break</b></font><font color="#808080">;
      </font><font color="#0000FF"><b>case </b></font><font color="#FF0000">2</font><font color="#808080">: [</font><font color="#000080">self subMenu</font><font color="#808080">: </font><font color="#FF0000">12</font><font color="#808080">, </font><font color="#000080">opAutor</font><font color="#808080">]; </font><font color="#0000FF"><b>break</b></font><font color="#808080">;
      </font><font color="#0000FF"><b>case </b></font><font color="#FF0000">3</font><font color="#808080">: [</font><font color="#000080">self subMenu</font><font color="#808080">: </font><font color="#FF0000">12</font><font color="#808080">, </font><font color="#000080">opEditora</font><font color="#808080">]; </font><font color="#0000FF"><b>break</b></font><font color="#808080">;
      </font><font color="#0000FF"><b>case </b></font><font color="#FF0000">4</font><font color="#808080">: [</font><font color="#000080">self subMenu</font><font color="#808080">: </font><font color="#FF0000">12</font><font color="#808080">, </font><font color="#000080">opEndereco</font><font color="#808080">]; </font><font color="#0000FF"><b>break</b></font><font color="#808080">;
      </font><font color="#0000FF"><b>case </b></font><font color="#FF0000">5</font><font color="#808080">: [</font><font color="#000080">self subMenu</font><font color="#808080">: </font><font color="#FF0000">12</font><font color="#808080">, </font><font color="#000080">opIdioma</font><font color="#808080">]; </font><font color="#0000FF"><b>break</b></font><font color="#808080">;
      </font><font color="#0000FF"><b>case </b></font><font color="#FF0000">6</font><font color="#808080">: [</font><font color="#000080">self subMenu</font><font color="#808080">: </font><font color="#FF0000">12</font><font color="#808080">, </font><font color="#000080">opPais</font><font color="#808080">]; </font><font color="#0000FF"><b>break</b></font><font color="#808080">;
      </font><font color="#0000FF"><b>case </b></font><font color="#FF0000">7</font><font color="#808080">: [</font><font color="#000080">self subMenu</font><font color="#808080">: </font><font color="#FF0000">12</font><font color="#808080">, </font><font color="#000080">opProfissao</font><font color="#808080">]; </font><font color="#0000FF"><b>break</b></font><font color="#808080">;
      </font><font color="#0000FF"><b>case </b></font><font color="#FF0000">8</font><font color="#808080">: [</font><font color="#000080">self subMenu</font><font color="#808080">: </font><font color="#FF0000">12</font><font color="#808080">, </font><font color="#000080">opCliente</font><font color="#808080">]; </font><font color="#0000FF"><b>break</b></font><font color="#808080">;
      </font><font color="#0000FF"><b>case </b></font><font color="#FF0000">9</font><font color="#808080">: [</font><font color="#000080">self subMenu</font><font color="#808080">: </font><font color="#FF0000">12</font><font color="#808080">, </font><font color="#000080">opLivro</font><font color="#808080">]; </font><font color="#0000FF"><b>break</b></font><font color="#808080">;
      </font><font color="#0000FF"><b>case </b></font><font color="#FF0000">10</font><font color="#808080">: </font><font color="#000080">bSOp </font><font color="#808080">= </font><font color="#000080">NO</font><font color="#808080">; </font><font color="#0000FF"><b>break</b></font><font color="#808080">;
      </font><font color="#0000FF"><b>default</b></font><font color="#808080">: </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;%s\n&quot;</font><font color="#808080">,</font><font color="#000080">MSG_ERRO</font><font color="#808080">);
     }
   }
 } </font><font color="#0000FF"><b>else if </b></font><font color="#808080">(</font><font color="#000080">num </font><font color="#808080">== </font><font color="#FF0000">3</font><font color="#808080">) { <i>/* Vendas */
   </i></font><font color="#0000FF"><b>while</b></font><font color="#808080">(</font><font color="#000080">bSOp</font><font color="#808080">) {
     [</font><font color="#000080">self menu</font><font color="#808080">: </font><font color="#FF0000">4</font><font color="#808080">];
     </font><font color="#000080">fscanf</font><font color="#808080">(</font><font color="#000080">stdin</font><font color="#808080">, </font><font color="#800000">&quot;%d&quot;</font><font color="#808080">, &amp;</font><font color="#000080">opSubMenu</font><font color="#808080">);     
     </font><font color="#0000FF"><b>switch</b></font><font color="#808080">(</font><font color="#000080">opSubMenu</font><font color="#808080">) {
      </font><font color="#0000FF"><b>case </b></font><font color="#FF0000">1</font><font color="#808080">: [</font><font color="#000080">self subMenu</font><font color="#808080">: </font><font color="#FF0000">6</font><font color="#808080">, </font><font color="#000080">opVenda</font><font color="#808080">]; </font><font color="#0000FF"><b>break</b></font><font color="#808080">;
      </font><font color="#0000FF"><b>case </b></font><font color="#FF0000">2</font><font color="#808080">: [</font><font color="#000080">self subMenu</font><font color="#808080">: </font><font color="#FF0000">12</font><font color="#808080">, </font><font color="#000080">opVenda</font><font color="#808080">]; </font><font color="#0000FF"><b>break</b></font><font color="#808080">;
      </font><font color="#0000FF"><b>case </b></font><font color="#FF0000">3</font><font color="#808080">: </font><font color="#000080">bSOp </font><font color="#808080">= </font><font color="#000080">NO</font><font color="#808080">; </font><font color="#0000FF"><b>break</b></font><font color="#808080">;
      </font><font color="#0000FF"><b>default</b></font><font color="#808080">: </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;%s\n&quot;</font><font color="#808080">,</font><font color="#000080">MSG_ERRO</font><font color="#808080">);
     }
   }
 } </font><font color="#0000FF"><b>else if </b></font><font color="#808080">(</font><font color="#000080">num </font><font color="#808080">== </font><font color="#FF0000">4</font><font color="#808080">) { <i>/* Opcoes */
   </i></font><font color="#0000FF"><b>while</b></font><font color="#808080">(</font><font color="#000080">bSOp</font><font color="#808080">) {
     [</font><font color="#000080">self menu</font><font color="#808080">: </font><font color="#FF0000">5</font><font color="#808080">];
     </font><font color="#000080">fscanf</font><font color="#808080">(</font><font color="#000080">stdin</font><font color="#808080">, </font><font color="#800000">&quot;%d&quot;</font><font color="#808080">, &amp;</font><font color="#000080">opSubMenu</font><font color="#808080">);
     </font><font color="#000080">fflush</font><font color="#808080">(</font><font color="#000080">stdin</font><font color="#808080">);     
     </font><font color="#0000FF"><b>switch</b></font><font color="#808080">(</font><font color="#000080">opSubMenu</font><font color="#808080">) {
      </font><font color="#0000FF"><b>case </b></font><font color="#FF0000">1</font><font color="#808080">: [</font><font color="#000080">self frmAlterarSenha</font><font color="#808080">]; </font><font color="#0000FF"><b>break</b></font><font color="#808080">;
      </font><font color="#0000FF"><b>case </b></font><font color="#FF0000">2</font><font color="#808080">: [</font><font color="#000080">self frmSobre</font><font color="#808080">]; </font><font color="#0000FF"><b>break</b></font><font color="#808080">;
      </font><font color="#0000FF"><b>case </b></font><font color="#FF0000">3</font><font color="#808080">: {
           [</font><font color="#000080">self menu</font><font color="#808080">: </font><font color="#FF0000">11</font><font color="#808080">];
           </font><font color="#000080">fscanf</font><font color="#808080">(</font><font color="#000080">stdin</font><font color="#808080">, </font><font color="#800000">&quot;%s&quot;</font><font color="#808080">, &amp;</font><font color="#000080">opSair</font><font color="#808080">);           
           </font><font color="#0000FF"><b>if </b></font><font color="#808080">((</font><font color="#000080">opSair</font><font color="#808080">==</font>'S'<font color="#808080">) || (</font><font color="#000080">opSair</font><font color="#808080">==</font>'s'<font color="#808080">)) {
              [</font><font color="#000080">self fechaArqs</font><font color="#808080">];
              </font><font color="#000080">exit</font><font color="#808080">(</font><font color="#FF0000">0</font><font color="#808080">);
           }
         } </font><font color="#0000FF"><b>break</b></font><font color="#808080">;
      </font><font color="#0000FF"><b>case </b></font><font color="#FF0000">4</font><font color="#808080">: </font><font color="#000080">bSOp </font><font color="#808080">= </font><font color="#000080">NO</font><font color="#808080">; </font><font color="#0000FF"><b>break</b></font><font color="#808080">;
      </font><font color="#0000FF"><b>default</b></font><font color="#808080">: </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;%s\n&quot;</font><font color="#808080">,</font><font color="#000080">MSG_ERRO</font><font color="#808080">);
     }
   }
 }
</font><font color="#0000FF"><b>return </b></font><font color="#000080">self</font><font color="#808080">;
}
<i>/*------------------------------------------------------------------------------
Mostra as entradas e as sa&iacute;das do sistema.
sreg - o tipo de arquivo
slinha - o registro com os dados
nOpcao - indica qual op&ccedil;&atilde;o ser&aacute; mostrada
------------------------------------------------------------------------------*/
</i>- </font><font color="#000080">mostrarDados</font><font color="#808080">: (</font><font color="#0000FF"><b>enum </b></font><font color="#000080">ctArqs</font><font color="#808080">) </font><font color="#000080">sreg</font><font color="#808080">, ...
{ 
 </font><font color="#000080">STR slinha</font><font color="#808080">; 
 </font><font color="#0000FF"><b>int </b></font><font color="#000080">nOpcao</font><font color="#808080">;

</font><font color="#000080">va_list lparams</font><font color="#808080">;
</font><font color="#000080">va_start</font><font color="#808080">(</font><font color="#000080">lparams</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">);
</font><font color="#000080">slinha </font><font color="#808080">= </font><font color="#000080">va_arg</font><font color="#808080">(</font><font color="#000080">lparams</font><font color="#808080">,</font><font color="#000080">STR</font><font color="#808080">);
</font><font color="#000080">nOpcao </font><font color="#808080">= </font><font color="#000080">va_arg</font><font color="#808080">(</font><font color="#000080">lparams</font><font color="#808080">,</font><font color="#0000FF"><b>int</b></font><font color="#808080">);
</font><font color="#000080">va_end</font><font color="#808080">(</font><font color="#000080">lparams</font><font color="#808080">);

</font><font color="#0000FF"><b>if </b></font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">==</font><font color="#000080">opAssunto</font><font color="#808080">) {
   </font><font color="#0000FF"><b>switch</b></font><font color="#808080">(</font><font color="#000080">nOpcao</font><font color="#808080">) {
    </font><font color="#0000FF"><b>case </b></font><font color="#FF0000">1</font><font color="#808080">: {
        </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;%s%s\n&quot;</font><font color="#808080">,[</font><font color="#000080">self rotulo</font><font color="#808080">: </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">], </font><font color="#000080">tAssunto</font><font color="#808080">.</font><font color="#000080">codigo</font><font color="#808080">);
        </font><font color="#000080">printf</font><font color="#808080">([</font><font color="#000080">self rotulo</font><font color="#808080">: </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">]);
        </font><font color="#000080">strcpy</font><font color="#808080">(</font><font color="#000080">tAssunto</font><font color="#808080">.</font><font color="#000080">assunto</font><font color="#808080">, [</font><font color="#000080">self digita</font><font color="#808080">: </font><font color="#0000FF"><b>sizeof</b></font><font color="#808080">(</font><font color="#000080">tAssunto</font><font color="#808080">.</font><font color="#000080">assunto</font><font color="#808080">)]);
       } </font><font color="#0000FF"><b>break</b></font><font color="#808080">;
    </font><font color="#0000FF"><b>case </b></font><font color="#FF0000">2</font><font color="#808080">: {
        </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;C&oacute;digo     Assunto\n&quot;</font><font color="#808080">);
        </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;------     -------\n&quot;</font><font color="#808080">);
       } </font><font color="#0000FF"><b>break</b></font><font color="#808080">;
    </font><font color="#0000FF"><b>case </b></font><font color="#FF0000">3</font><font color="#808080">: {
        </font><font color="#000080">strcpy</font><font color="#808080">(</font><font color="#000080">tAssunto</font><font color="#808080">.</font><font color="#000080">codigo</font><font color="#808080">, [</font><font color="#000080">self trim</font><font color="#808080">: [</font><font color="#000080">self copy</font><font color="#808080">: </font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">]]);
        </font><font color="#000080">strcpy</font><font color="#808080">(</font><font color="#000080">tAssunto</font><font color="#808080">.</font><font color="#000080">assunto</font><font color="#808080">, [</font><font color="#000080">self trim</font><font color="#808080">: [</font><font color="#000080">self copy</font><font color="#808080">: </font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">11</font><font color="#808080">, </font><font color="#FF0000">30</font><font color="#808080">]]);
        </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;%s %s\n&quot;</font><font color="#808080">,[</font><font color="#000080">self esp</font><font color="#808080">: </font><font color="#000080">tAssunto</font><font color="#808080">.</font><font color="#000080">codigo</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">],[</font><font color="#000080">self esp</font><font color="#808080">: </font><font color="#000080">tAssunto</font><font color="#808080">.</font><font color="#000080">assunto</font><font color="#808080">,</font><font color="#FF0000">30</font><font color="#808080">]);
       } </font><font color="#0000FF"><b>break</b></font><font color="#808080">;
   }
} </font><font color="#0000FF"><b>else if </b></font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">==</font><font color="#000080">opAutor</font><font color="#808080">) {
   </font><font color="#0000FF"><b>switch</b></font><font color="#808080">(</font><font color="#000080">nOpcao</font><font color="#808080">) {
    </font><font color="#0000FF"><b>case </b></font><font color="#FF0000">1</font><font color="#808080">: {
        </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;%s%s\n&quot;</font><font color="#808080">,[</font><font color="#000080">self rotulo</font><font color="#808080">: </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">], </font><font color="#000080">tAutor</font><font color="#808080">.</font><font color="#000080">codigo</font><font color="#808080">);
        </font><font color="#000080">printf</font><font color="#808080">([</font><font color="#000080">self rotulo</font><font color="#808080">: </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">]);
        </font><font color="#000080">strcpy</font><font color="#808080">(</font><font color="#000080">tAutor</font><font color="#808080">.</font><font color="#000080">autor</font><font color="#808080">, [</font><font color="#000080">self digita</font><font color="#808080">: </font><font color="#0000FF"><b>sizeof</b></font><font color="#808080">(</font><font color="#000080">tAutor</font><font color="#808080">.</font><font color="#000080">autor</font><font color="#808080">)]);
       } </font><font color="#0000FF"><b>break</b></font><font color="#808080">;
    </font><font color="#0000FF"><b>case </b></font><font color="#FF0000">2</font><font color="#808080">: {
        </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;C&oacute;digo     Autor\n&quot;</font><font color="#808080">);
        </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;------     -----\n&quot;</font><font color="#808080">);
       } </font><font color="#0000FF"><b>break</b></font><font color="#808080">;
    </font><font color="#0000FF"><b>case </b></font><font color="#FF0000">3</font><font color="#808080">: {
        </font><font color="#000080">strcpy</font><font color="#808080">(</font><font color="#000080">tAutor</font><font color="#808080">.</font><font color="#000080">codigo</font><font color="#808080">, [</font><font color="#000080">self trim</font><font color="#808080">: [</font><font color="#000080">self copy</font><font color="#808080">: </font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">]]);
        </font><font color="#000080">strcpy</font><font color="#808080">(</font><font color="#000080">tAutor</font><font color="#808080">.</font><font color="#000080">autor</font><font color="#808080">, [</font><font color="#000080">self trim</font><font color="#808080">: [</font><font color="#000080">self copy</font><font color="#808080">: </font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">11</font><font color="#808080">, </font><font color="#FF0000">30</font><font color="#808080">]]);
        </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;%s %s\n&quot;</font><font color="#808080">,[</font><font color="#000080">self esp</font><font color="#808080">: </font><font color="#000080">tAutor</font><font color="#808080">.</font><font color="#000080">codigo</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">],[</font><font color="#000080">self esp</font><font color="#808080">: </font><font color="#000080">tAutor</font><font color="#808080">.</font><font color="#000080">autor</font><font color="#808080">,</font><font color="#FF0000">30</font><font color="#808080">]);
       } </font><font color="#0000FF"><b>break</b></font><font color="#808080">;
   }
} </font><font color="#0000FF"><b>else if </b></font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">==</font><font color="#000080">opEditora</font><font color="#808080">) {
   </font><font color="#0000FF"><b>switch</b></font><font color="#808080">(</font><font color="#000080">nOpcao</font><font color="#808080">) {
    </font><font color="#0000FF"><b>case </b></font><font color="#FF0000">1</font><font color="#808080">: {
        </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;%s%s\n&quot;</font><font color="#808080">,[</font><font color="#000080">self rotulo</font><font color="#808080">: </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">], </font><font color="#000080">tEditora</font><font color="#808080">.</font><font color="#000080">codigo</font><font color="#808080">);
        </font><font color="#000080">printf</font><font color="#808080">([</font><font color="#000080">self rotulo</font><font color="#808080">: </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">]);
        </font><font color="#000080">strcpy</font><font color="#808080">(</font><font color="#000080">tEditora</font><font color="#808080">.</font><font color="#000080">editora</font><font color="#808080">, [</font><font color="#000080">self digita</font><font color="#808080">: </font><font color="#0000FF"><b>sizeof</b></font><font color="#808080">(</font><font color="#000080">tEditora</font><font color="#808080">.</font><font color="#000080">editora</font><font color="#808080">)]);
       } </font><font color="#0000FF"><b>break</b></font><font color="#808080">;
    </font><font color="#0000FF"><b>case </b></font><font color="#FF0000">2</font><font color="#808080">: {
        </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;C&oacute;digo     Editora\n&quot;</font><font color="#808080">);
        </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;------     -------\n&quot;</font><font color="#808080">);
       } </font><font color="#0000FF"><b>break</b></font><font color="#808080">;
    </font><font color="#0000FF"><b>case </b></font><font color="#FF0000">3</font><font color="#808080">: {
        </font><font color="#000080">strcpy</font><font color="#808080">(</font><font color="#000080">tEditora</font><font color="#808080">.</font><font color="#000080">codigo</font><font color="#808080">, [</font><font color="#000080">self trim</font><font color="#808080">: [</font><font color="#000080">self copy</font><font color="#808080">: </font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">]]);
        </font><font color="#000080">strcpy</font><font color="#808080">(</font><font color="#000080">tEditora</font><font color="#808080">.</font><font color="#000080">editora</font><font color="#808080">, [</font><font color="#000080">self trim</font><font color="#808080">: [</font><font color="#000080">self copy</font><font color="#808080">: </font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">11</font><font color="#808080">, </font><font color="#FF0000">50</font><font color="#808080">]]);
        </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;%s %s\n&quot;</font><font color="#808080">,[</font><font color="#000080">self esp</font><font color="#808080">: </font><font color="#000080">tEditora</font><font color="#808080">.</font><font color="#000080">codigo</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">],[</font><font color="#000080">self esp</font><font color="#808080">: </font><font color="#000080">tEditora</font><font color="#808080">.</font><font color="#000080">editora</font><font color="#808080">,</font><font color="#FF0000">50</font><font color="#808080">]);
       } </font><font color="#0000FF"><b>break</b></font><font color="#808080">;
   }
} </font><font color="#0000FF"><b>else if </b></font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">==</font><font color="#000080">opEndereco</font><font color="#808080">) {
   </font><font color="#0000FF"><b>switch</b></font><font color="#808080">(</font><font color="#000080">nOpcao</font><font color="#808080">) {
    </font><font color="#0000FF"><b>case </b></font><font color="#FF0000">1</font><font color="#808080">: {
        </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;%s%s&quot;</font><font color="#808080">,[</font><font color="#000080">self rotulo</font><font color="#808080">: </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">], </font><font color="#000080">tEndereco</font><font color="#808080">.</font><font color="#000080">codigo</font><font color="#808080">);
        </font><font color="#000080">printf</font><font color="#808080">([</font><font color="#000080">self rotulo</font><font color="#808080">: </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">]);
        </font><font color="#000080">strcpy</font><font color="#808080">(</font><font color="#000080">tEndereco</font><font color="#808080">.</font><font color="#000080">logradouro</font><font color="#808080">, [</font><font color="#000080">self digita</font><font color="#808080">: </font><font color="#0000FF"><b>sizeof</b></font><font color="#808080">(</font><font color="#000080">tEndereco</font><font color="#808080">.</font><font color="#000080">logradouro</font><font color="#808080">)]);
        </font><font color="#000080">printf</font><font color="#808080">([</font><font color="#000080">self rotulo</font><font color="#808080">: </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">]);
        </font><font color="#000080">strcpy</font><font color="#808080">(</font><font color="#000080">tEndereco</font><font color="#808080">.</font><font color="#000080">bairro</font><font color="#808080">, [</font><font color="#000080">self digita</font><font color="#808080">: </font><font color="#0000FF"><b>sizeof</b></font><font color="#808080">(</font><font color="#000080">tEndereco</font><font color="#808080">.</font><font color="#000080">bairro</font><font color="#808080">)]);
        </font><font color="#000080">printf</font><font color="#808080">([</font><font color="#000080">self rotulo</font><font color="#808080">: </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">4</font><font color="#808080">]);
        </font><font color="#000080">strcpy</font><font color="#808080">(</font><font color="#000080">tEndereco</font><font color="#808080">.</font><font color="#000080">cep</font><font color="#808080">, [</font><font color="#000080">self digita</font><font color="#808080">: </font><font color="#0000FF"><b>sizeof</b></font><font color="#808080">(</font><font color="#000080">tEndereco</font><font color="#808080">.</font><font color="#000080">cep</font><font color="#808080">)]);
        </font><font color="#000080">printf</font><font color="#808080">([</font><font color="#000080">self rotulo</font><font color="#808080">: </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">5</font><font color="#808080">]);
        </font><font color="#000080">strcpy</font><font color="#808080">(</font><font color="#000080">tEndereco</font><font color="#808080">.</font><font color="#000080">cidade</font><font color="#808080">, [</font><font color="#000080">self digita</font><font color="#808080">: </font><font color="#0000FF"><b>sizeof</b></font><font color="#808080">(</font><font color="#000080">tEndereco</font><font color="#808080">.</font><font color="#000080">cidade</font><font color="#808080">)]);
        </font><font color="#000080">printf</font><font color="#808080">([</font><font color="#000080">self rotulo</font><font color="#808080">: </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">6</font><font color="#808080">]);
        </font><font color="#000080">strcpy</font><font color="#808080">(</font><font color="#000080">tEndereco</font><font color="#808080">.</font><font color="#000080">estado</font><font color="#808080">, [</font><font color="#000080">self digita</font><font color="#808080">: </font><font color="#0000FF"><b>sizeof</b></font><font color="#808080">(</font><font color="#000080">tEndereco</font><font color="#808080">.</font><font color="#000080">estado</font><font color="#808080">)]);
       } </font><font color="#0000FF"><b>break</b></font><font color="#808080">;
    </font><font color="#0000FF"><b>case </b></font><font color="#FF0000">3</font><font color="#808080">: {
        </font><font color="#000080">strcpy</font><font color="#808080">(</font><font color="#000080">tEndereco</font><font color="#808080">.</font><font color="#000080">codigo</font><font color="#808080">, [</font><font color="#000080">self trim</font><font color="#808080">: [</font><font color="#000080">self copy</font><font color="#808080">: </font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">]]);
        </font><font color="#000080">strcpy</font><font color="#808080">(</font><font color="#000080">tEndereco</font><font color="#808080">.</font><font color="#000080">logradouro</font><font color="#808080">, [</font><font color="#000080">self trim</font><font color="#808080">: [</font><font color="#000080">self copy</font><font color="#808080">: </font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">11</font><font color="#808080">, </font><font color="#FF0000">40</font><font color="#808080">]]);
        </font><font color="#000080">strcpy</font><font color="#808080">(</font><font color="#000080">tEndereco</font><font color="#808080">.</font><font color="#000080">bairro</font><font color="#808080">, [</font><font color="#000080">self trim</font><font color="#808080">: [</font><font color="#000080">self copy</font><font color="#808080">: </font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">51</font><font color="#808080">, </font><font color="#FF0000">15</font><font color="#808080">]]);
        </font><font color="#000080">strcpy</font><font color="#808080">(</font><font color="#000080">tEndereco</font><font color="#808080">.</font><font color="#000080">cep</font><font color="#808080">, [</font><font color="#000080">self trim</font><font color="#808080">: [</font><font color="#000080">self copy</font><font color="#808080">: </font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">66</font><font color="#808080">, </font><font color="#FF0000">8</font><font color="#808080">]]);
        </font><font color="#000080">strcpy</font><font color="#808080">(</font><font color="#000080">tEndereco</font><font color="#808080">.</font><font color="#000080">cidade</font><font color="#808080">, [</font><font color="#000080">self trim</font><font color="#808080">: [</font><font color="#000080">self copy</font><font color="#808080">: </font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">74</font><font color="#808080">, </font><font color="#FF0000">30</font><font color="#808080">]]);
        </font><font color="#000080">strcpy</font><font color="#808080">(</font><font color="#000080">tEndereco</font><font color="#808080">.</font><font color="#000080">estado</font><font color="#808080">, [</font><font color="#000080">self trim</font><font color="#808080">: [</font><font color="#000080">self copy</font><font color="#808080">: </font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">104</font><font color="#808080">, </font><font color="#FF0000">20</font><font color="#808080">]]);
        </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;--------------------\n&quot;</font><font color="#808080">);
        </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;%s%s\n&quot;</font><font color="#808080">,[</font><font color="#000080">self rotulo</font><font color="#808080">: </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">], </font><font color="#000080">tEndereco</font><font color="#808080">.</font><font color="#000080">codigo</font><font color="#808080">);
        </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;%s%s\n&quot;</font><font color="#808080">,[</font><font color="#000080">self rotulo</font><font color="#808080">: </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">], </font><font color="#000080">tEndereco</font><font color="#808080">.</font><font color="#000080">logradouro</font><font color="#808080">);
        </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;%s%s\n&quot;</font><font color="#808080">,[</font><font color="#000080">self rotulo</font><font color="#808080">: </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">], </font><font color="#000080">tEndereco</font><font color="#808080">.</font><font color="#000080">bairro</font><font color="#808080">);
        </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;%s%s\n&quot;</font><font color="#808080">,[</font><font color="#000080">self rotulo</font><font color="#808080">: </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">4</font><font color="#808080">], </font><font color="#000080">tEndereco</font><font color="#808080">.</font><font color="#000080">cep</font><font color="#808080">);
        </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;%s%s\n&quot;</font><font color="#808080">,[</font><font color="#000080">self rotulo</font><font color="#808080">: </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">5</font><font color="#808080">], </font><font color="#000080">tEndereco</font><font color="#808080">.</font><font color="#000080">cidade</font><font color="#808080">);
        </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;%s%s\n&quot;</font><font color="#808080">,[</font><font color="#000080">self rotulo</font><font color="#808080">: </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">6</font><font color="#808080">], </font><font color="#000080">tEndereco</font><font color="#808080">.</font><font color="#000080">estado</font><font color="#808080">);
       } </font><font color="#0000FF"><b>break</b></font><font color="#808080">;
   }
} </font><font color="#0000FF"><b>else if </b></font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">==</font><font color="#000080">opIdioma</font><font color="#808080">) {
   </font><font color="#0000FF"><b>switch</b></font><font color="#808080">(</font><font color="#000080">nOpcao</font><font color="#808080">) {
    </font><font color="#0000FF"><b>case </b></font><font color="#FF0000">1</font><font color="#808080">: {
        </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;%s%s\n&quot;</font><font color="#808080">,[</font><font color="#000080">self rotulo</font><font color="#808080">: </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">], </font><font color="#000080">tIdioma</font><font color="#808080">.</font><font color="#000080">codigo</font><font color="#808080">);
        </font><font color="#000080">printf</font><font color="#808080">([</font><font color="#000080">self rotulo</font><font color="#808080">: </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">]);
        </font><font color="#000080">strcpy</font><font color="#808080">(</font><font color="#000080">tIdioma</font><font color="#808080">.</font><font color="#000080">idioma</font><font color="#808080">, [</font><font color="#000080">self digita</font><font color="#808080">: </font><font color="#0000FF"><b>sizeof</b></font><font color="#808080">(</font><font color="#000080">tIdioma</font><font color="#808080">.</font><font color="#000080">idioma</font><font color="#808080">)]);
       } </font><font color="#0000FF"><b>break</b></font><font color="#808080">; 
    </font><font color="#0000FF"><b>case </b></font><font color="#FF0000">2</font><font color="#808080">: {
        </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;C&oacute;digo     Idioma\n&quot;</font><font color="#808080">);
        </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;------     ------\n&quot;</font><font color="#808080">);
       } </font><font color="#0000FF"><b>break</b></font><font color="#808080">;
    </font><font color="#0000FF"><b>case </b></font><font color="#FF0000">3</font><font color="#808080">: {
        </font><font color="#000080">strcpy</font><font color="#808080">(</font><font color="#000080">tIdioma</font><font color="#808080">.</font><font color="#000080">codigo</font><font color="#808080">, [</font><font color="#000080">self trim</font><font color="#808080">: [</font><font color="#000080">self copy</font><font color="#808080">: </font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">]]);
        </font><font color="#000080">strcpy</font><font color="#808080">(</font><font color="#000080">tIdioma</font><font color="#808080">.</font><font color="#000080">idioma</font><font color="#808080">, [</font><font color="#000080">self trim</font><font color="#808080">: [</font><font color="#000080">self copy</font><font color="#808080">: </font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">11</font><font color="#808080">, </font><font color="#FF0000">20</font><font color="#808080">]]);
        </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;%s %s\n&quot;</font><font color="#808080">,[</font><font color="#000080">self esp</font><font color="#808080">: </font><font color="#000080">tIdioma</font><font color="#808080">.</font><font color="#000080">codigo</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">],[</font><font color="#000080">self esp</font><font color="#808080">: </font><font color="#000080">tIdioma</font><font color="#808080">.</font><font color="#000080">idioma</font><font color="#808080">,</font><font color="#FF0000">20</font><font color="#808080">]);
       } </font><font color="#0000FF"><b>break</b></font><font color="#808080">;
   }
} </font><font color="#0000FF"><b>else if </b></font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">==</font><font color="#000080">opPais</font><font color="#808080">) {
   </font><font color="#0000FF"><b>switch</b></font><font color="#808080">(</font><font color="#000080">nOpcao</font><font color="#808080">) {
    </font><font color="#0000FF"><b>case </b></font><font color="#FF0000">1</font><font color="#808080">: {
        </font><font color="#000080">printf</font><font color="#808080">([</font><font color="#000080">self rotulo</font><font color="#808080">: </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">]);
        </font><font color="#000080">strcpy</font><font color="#808080">(</font><font color="#000080">tPais</font><font color="#808080">.</font><font color="#000080">pais</font><font color="#808080">, [</font><font color="#000080">self digita</font><font color="#808080">: </font><font color="#0000FF"><b>sizeof</b></font><font color="#808080">(</font><font color="#000080">tPais</font><font color="#808080">.</font><font color="#000080">pais</font><font color="#808080">)]);
       } </font><font color="#0000FF"><b>break</b></font><font color="#808080">;
    </font><font color="#0000FF"><b>case </b></font><font color="#FF0000">2</font><font color="#808080">: {
        </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;C&oacute;digo Pa&iacute;s\n&quot;</font><font color="#808080">);
        </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;------ ----\n&quot;</font><font color="#808080">);
       } </font><font color="#0000FF"><b>break</b></font><font color="#808080">;
    </font><font color="#0000FF"><b>case </b></font><font color="#FF0000">3</font><font color="#808080">: {
        </font><font color="#000080">strcpy</font><font color="#808080">(</font><font color="#000080">tPais</font><font color="#808080">.</font><font color="#000080">codigo</font><font color="#808080">, [</font><font color="#000080">self trim</font><font color="#808080">: [</font><font color="#000080">self copy</font><font color="#808080">: </font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">]]);
        </font><font color="#000080">strcpy</font><font color="#808080">(</font><font color="#000080">tPais</font><font color="#808080">.</font><font color="#000080">pais</font><font color="#808080">, [</font><font color="#000080">self trim</font><font color="#808080">: [</font><font color="#000080">self copy</font><font color="#808080">: </font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">4</font><font color="#808080">, </font><font color="#FF0000">50</font><font color="#808080">]]);
        </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;%s    %s\n&quot;</font><font color="#808080">,[</font><font color="#000080">self esp</font><font color="#808080">: </font><font color="#000080">tPais</font><font color="#808080">.</font><font color="#000080">codigo</font><font color="#808080">,</font><font color="#FF0000">3</font><font color="#808080">],[</font><font color="#000080">self esp</font><font color="#808080">: </font><font color="#000080">tPais</font><font color="#808080">.</font><font color="#000080">pais</font><font color="#808080">,</font><font color="#FF0000">50</font><font color="#808080">]);
       } </font><font color="#0000FF"><b>break</b></font><font color="#808080">;
   }
} </font><font color="#0000FF"><b>else if </b></font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">==</font><font color="#000080">opProfissao</font><font color="#808080">) {
   </font><font color="#0000FF"><b>switch</b></font><font color="#808080">(</font><font color="#000080">nOpcao</font><font color="#808080">) {
    </font><font color="#0000FF"><b>case </b></font><font color="#FF0000">1</font><font color="#808080">: {
        </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;%s%s\n&quot;</font><font color="#808080">,[</font><font color="#000080">self rotulo</font><font color="#808080">: </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">], </font><font color="#000080">tProfissao</font><font color="#808080">.</font><font color="#000080">codigo</font><font color="#808080">);
        </font><font color="#000080">printf</font><font color="#808080">([</font><font color="#000080">self rotulo</font><font color="#808080">: </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">]);
        </font><font color="#000080">strcpy</font><font color="#808080">(</font><font color="#000080">tProfissao</font><font color="#808080">.</font><font color="#000080">profissao</font><font color="#808080">, [</font><font color="#000080">self digita</font><font color="#808080">: </font><font color="#0000FF"><b>sizeof</b></font><font color="#808080">(</font><font color="#000080">tProfissao</font><font color="#808080">.</font><font color="#000080">profissao</font><font color="#808080">)]);
       } </font><font color="#0000FF"><b>break</b></font><font color="#808080">;
    </font><font color="#0000FF"><b>case </b></font><font color="#FF0000">2</font><font color="#808080">: {
        </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;C&oacute;digo     Profiss&atilde;o\n&quot;</font><font color="#808080">);
        </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;------     ---------\n&quot;</font><font color="#808080">);
       } </font><font color="#0000FF"><b>break</b></font><font color="#808080">;
    </font><font color="#0000FF"><b>case </b></font><font color="#FF0000">3</font><font color="#808080">: {
        </font><font color="#000080">strcpy</font><font color="#808080">(</font><font color="#000080">tProfissao</font><font color="#808080">.</font><font color="#000080">codigo</font><font color="#808080">, [</font><font color="#000080">self trim</font><font color="#808080">: [</font><font color="#000080">self copy</font><font color="#808080">: </font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">]]);
        </font><font color="#000080">strcpy</font><font color="#808080">(</font><font color="#000080">tProfissao</font><font color="#808080">.</font><font color="#000080">profissao</font><font color="#808080">, [</font><font color="#000080">self trim</font><font color="#808080">: [</font><font color="#000080">self copy</font><font color="#808080">: </font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">11</font><font color="#808080">, </font><font color="#FF0000">50</font><font color="#808080">]]);
        </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;%s %s\n&quot;</font><font color="#808080">,[</font><font color="#000080">self esp</font><font color="#808080">: </font><font color="#000080">tProfissao</font><font color="#808080">.</font><font color="#000080">codigo</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">],
                [</font><font color="#000080">self esp</font><font color="#808080">: </font><font color="#000080">tProfissao</font><font color="#808080">.</font><font color="#000080">profissao</font><font color="#808080">,</font><font color="#FF0000">50</font><font color="#808080">]);
       } </font><font color="#0000FF"><b>break</b></font><font color="#808080">;
   }
} </font><font color="#0000FF"><b>else if </b></font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">==</font><font color="#000080">opLivro</font><font color="#808080">) {
   </font><font color="#0000FF"><b>switch</b></font><font color="#808080">(</font><font color="#000080">nOpcao</font><font color="#808080">) {
    </font><font color="#0000FF"><b>case </b></font><font color="#FF0000">1</font><font color="#808080">: {
        </font><font color="#000080">printf</font><font color="#808080">([</font><font color="#000080">self rotulo</font><font color="#808080">: </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">]);
        </font><font color="#000080">strcpy</font><font color="#808080">(</font><font color="#000080">tLivro</font><font color="#808080">.</font><font color="#000080">titulo</font><font color="#808080">, [</font><font color="#000080">self digita</font><font color="#808080">: </font><font color="#0000FF"><b>sizeof</b></font><font color="#808080">(</font><font color="#000080">tLivro</font><font color="#808080">.</font><font color="#000080">titulo</font><font color="#808080">)]);
        </font><font color="#000080">strcpy</font><font color="#808080">(</font><font color="#000080">tLivro</font><font color="#808080">.</font><font color="#000080">edicao</font><font color="#808080">, [</font><font color="#000080">self validaNumero</font><font color="#808080">: [</font><font color="#000080">self rotulo</font><font color="#808080">: </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">], </font><font color="#000080">tLivro</font><font color="#808080">.</font><font color="#000080">edicao</font><font color="#808080">]);
        </font><font color="#000080">strcpy</font><font color="#808080">(</font><font color="#000080">tLivro</font><font color="#808080">.</font><font color="#000080">anopubli</font><font color="#808080">, [</font><font color="#000080">self validaNumero</font><font color="#808080">: [</font><font color="#000080">self rotulo</font><font color="#808080">: </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">4</font><font color="#808080">], </font><font color="#000080">tLivro</font><font color="#808080">.</font><font color="#000080">anopubli</font><font color="#808080">]);
        [</font><font color="#000080">self mostrarSubDados</font><font color="#808080">: </font><font color="#000080">opLivro</font><font color="#808080">, </font><font color="#000080">opEditora</font><font color="#808080">, </font><font color="#000080">NO</font><font color="#808080">];
        </font><font color="#000080">strcpy</font><font color="#808080">(</font><font color="#000080">tLivro</font><font color="#808080">.</font><font color="#000080">volume</font><font color="#808080">, [</font><font color="#000080">self validaNumero</font><font color="#808080">: [</font><font color="#000080">self rotulo</font><font color="#808080">: </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">6</font><font color="#808080">], </font><font color="#000080">tLivro</font><font color="#808080">.</font><font color="#000080">volume</font><font color="#808080">]);
        [</font><font color="#000080">self mostrarSubDados</font><font color="#808080">: </font><font color="#000080">opLivro</font><font color="#808080">, </font><font color="#000080">opIdioma</font><font color="#808080">, </font><font color="#000080">NO</font><font color="#808080">];
        </font><font color="#000080">strcpy</font><font color="#808080">(</font><font color="#000080">tLivro</font><font color="#808080">.</font><font color="#000080">npaginas</font><font color="#808080">, [</font><font color="#000080">self validaNumero</font><font color="#808080">: [</font><font color="#000080">self rotulo</font><font color="#808080">: </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">8</font><font color="#808080">], </font><font color="#000080">tLivro</font><font color="#808080">.</font><font color="#000080">npaginas</font><font color="#808080">]);
        </font><font color="#000080">strcpy</font><font color="#808080">(</font><font color="#000080">tLivro</font><font color="#808080">.</font><font color="#000080">preco</font><font color="#808080">, [</font><font color="#000080">self validaNumero</font><font color="#808080">: [</font><font color="#000080">self rotulo</font><font color="#808080">: </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">9</font><font color="#808080">], </font><font color="#000080">tLivro</font><font color="#808080">.</font><font color="#000080">preco</font><font color="#808080">]);
        </font><font color="#000080">strcpy</font><font color="#808080">(</font><font color="#000080">tLivro</font><font color="#808080">.</font><font color="#000080">qtdestoque</font><font color="#808080">, [</font><font color="#000080">self validaNumero</font><font color="#808080">: [</font><font color="#000080">self rotulo</font><font color="#808080">: </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">], 
        </font><font color="#000080">tLivro</font><font color="#808080">.</font><font color="#000080">qtdestoque</font><font color="#808080">]);
       } </font><font color="#0000FF"><b>break</b></font><font color="#808080">;
    </font><font color="#0000FF"><b>case </b></font><font color="#FF0000">3</font><font color="#808080">: {
        </font><font color="#000080">strcpy</font><font color="#808080">(</font><font color="#000080">tLivro</font><font color="#808080">.</font><font color="#000080">isbn</font><font color="#808080">, [</font><font color="#000080">self trim</font><font color="#808080">: [</font><font color="#000080">self copy</font><font color="#808080">: </font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">13</font><font color="#808080">]]);
        </font><font color="#000080">strcpy</font><font color="#808080">(</font><font color="#000080">tLivro</font><font color="#808080">.</font><font color="#000080">titulo</font><font color="#808080">, [</font><font color="#000080">self trim</font><font color="#808080">: [</font><font color="#000080">self copy</font><font color="#808080">: </font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">14</font><font color="#808080">, </font><font color="#FF0000">50</font><font color="#808080">]]);
        </font><font color="#000080">strcpy</font><font color="#808080">(</font><font color="#000080">tLivro</font><font color="#808080">.</font><font color="#000080">edicao</font><font color="#808080">, [</font><font color="#000080">self trim</font><font color="#808080">: [</font><font color="#000080">self copy</font><font color="#808080">: </font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">64</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">]]);
        </font><font color="#000080">strcpy</font><font color="#808080">(</font><font color="#000080">tLivro</font><font color="#808080">.</font><font color="#000080">anopubli</font><font color="#808080">, [</font><font color="#000080">self trim</font><font color="#808080">: [</font><font color="#000080">self copy</font><font color="#808080">: </font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">74</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">]]);
        </font><font color="#000080">strcpy</font><font color="#808080">(</font><font color="#000080">tLivro</font><font color="#808080">.</font><font color="#000080">codeditora</font><font color="#808080">, [</font><font color="#000080">self trim</font><font color="#808080">: [</font><font color="#000080">self copy</font><font color="#808080">: </font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">84</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">]]);
        </font><font color="#000080">strcpy</font><font color="#808080">(</font><font color="#000080">tLivro</font><font color="#808080">.</font><font color="#000080">volume</font><font color="#808080">, [</font><font color="#000080">self trim</font><font color="#808080">: [</font><font color="#000080">self copy</font><font color="#808080">: </font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">94</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">]]);
        </font><font color="#000080">strcpy</font><font color="#808080">(</font><font color="#000080">tLivro</font><font color="#808080">.</font><font color="#000080">codidioma</font><font color="#808080">, [</font><font color="#000080">self trim</font><font color="#808080">: [</font><font color="#000080">self copy</font><font color="#808080">: </font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">104</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">]]);
        </font><font color="#000080">strcpy</font><font color="#808080">(</font><font color="#000080">tLivro</font><font color="#808080">.</font><font color="#000080">npaginas</font><font color="#808080">, [</font><font color="#000080">self trim</font><font color="#808080">: [</font><font color="#000080">self copy</font><font color="#808080">: </font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">114</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">]]);
        </font><font color="#000080">strcpy</font><font color="#808080">(</font><font color="#000080">tLivro</font><font color="#808080">.</font><font color="#000080">preco</font><font color="#808080">, [</font><font color="#000080">self trim</font><font color="#808080">: [</font><font color="#000080">self copy</font><font color="#808080">: </font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">124</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">]]);
        </font><font color="#000080">strcpy</font><font color="#808080">(</font><font color="#000080">tLivro</font><font color="#808080">.</font><font color="#000080">qtdestoque</font><font color="#808080">, [</font><font color="#000080">self trim</font><font color="#808080">: [</font><font color="#000080">self copy</font><font color="#808080">: </font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">134</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">]]);
        </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;--------------------\n&quot;</font><font color="#808080">);
        </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;%s%s\n&quot;</font><font color="#808080">,[</font><font color="#000080">self rotulo</font><font color="#808080">: </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">], </font><font color="#000080">tLivro</font><font color="#808080">.</font><font color="#000080">isbn</font><font color="#808080">);
        </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;%s%s\n&quot;</font><font color="#808080">,[</font><font color="#000080">self rotulo</font><font color="#808080">: </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">], </font><font color="#000080">tLivro</font><font color="#808080">.</font><font color="#000080">titulo</font><font color="#808080">);
        </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;%s%s\n&quot;</font><font color="#808080">,[</font><font color="#000080">self rotulo</font><font color="#808080">: </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">], </font><font color="#000080">tLivro</font><font color="#808080">.</font><font color="#000080">edicao</font><font color="#808080">);
        </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;%s%s\n&quot;</font><font color="#808080">,[</font><font color="#000080">self rotulo</font><font color="#808080">: </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">4</font><font color="#808080">], </font><font color="#000080">tLivro</font><font color="#808080">.</font><font color="#000080">anopubli</font><font color="#808080">);
        </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;%s%s\n&quot;</font><font color="#808080">,[</font><font color="#000080">self rotulo</font><font color="#808080">: </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">5</font><font color="#808080">], </font><font color="#000080">tLivro</font><font color="#808080">.</font><font color="#000080">codeditora</font><font color="#808080">);
        [</font><font color="#000080">self mostrarSubDados</font><font color="#808080">: </font><font color="#000080">opLivro</font><font color="#808080">, </font><font color="#000080">opEditora</font><font color="#808080">, </font><font color="#000080">YES</font><font color="#808080">];
        </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;%s%s\n&quot;</font><font color="#808080">,[</font><font color="#000080">self rotulo</font><font color="#808080">: </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">6</font><font color="#808080">], </font><font color="#000080">tLivro</font><font color="#808080">.</font><font color="#000080">volume</font><font color="#808080">);
        </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;%s%s\n&quot;</font><font color="#808080">,[</font><font color="#000080">self rotulo</font><font color="#808080">: </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">7</font><font color="#808080">], </font><font color="#000080">tLivro</font><font color="#808080">.</font><font color="#000080">codidioma</font><font color="#808080">);
        [</font><font color="#000080">self mostrarSubDados</font><font color="#808080">: </font><font color="#000080">opLivro</font><font color="#808080">, </font><font color="#000080">opIdioma</font><font color="#808080">, </font><font color="#000080">YES</font><font color="#808080">];
        </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;%s%s\n&quot;</font><font color="#808080">,[</font><font color="#000080">self rotulo</font><font color="#808080">: </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">8</font><font color="#808080">], </font><font color="#000080">tLivro</font><font color="#808080">.</font><font color="#000080">npaginas</font><font color="#808080">);
        </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;%s%s\n&quot;</font><font color="#808080">,[</font><font color="#000080">self rotulo</font><font color="#808080">: </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">9</font><font color="#808080">], </font><font color="#000080">tLivro</font><font color="#808080">.</font><font color="#000080">preco</font><font color="#808080">);
        </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;%s%s\n&quot;</font><font color="#808080">,[</font><font color="#000080">self rotulo</font><font color="#808080">: </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">], </font><font color="#000080">tLivro</font><font color="#808080">.</font><font color="#000080">qtdestoque</font><font color="#808080">);
        [</font><font color="#000080">self ListarRegLigados</font><font color="#808080">: </font><font color="#000080">tfLivroAss</font><font color="#808080">, </font><font color="#000080">opLivroAss</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">13</font><font color="#808080">, </font><font color="#FF0000">14</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">, </font><font color="#000080">tLivro</font><font color="#808080">.</font><font color="#000080">isbn</font><font color="#808080">,
                         </font><font color="#000080">tfAssunto</font><font color="#808080">, </font><font color="#000080">opAssunto</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">4</font><font color="#808080">];
        [</font><font color="#000080">self ListarRegLigados</font><font color="#808080">: </font><font color="#000080">tfLivroAut</font><font color="#808080">, </font><font color="#000080">opLivroAut</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">13</font><font color="#808080">, </font><font color="#FF0000">14</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">, </font><font color="#000080">tLivro</font><font color="#808080">.</font><font color="#000080">isbn</font><font color="#808080">,
                         </font><font color="#000080">tfAutor</font><font color="#808080">, </font><font color="#000080">opAutor</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">4</font><font color="#808080">];
       } </font><font color="#0000FF"><b>break</b></font><font color="#808080">;
   }
} </font><font color="#0000FF"><b>else if </b></font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">==</font><font color="#000080">opCliente</font><font color="#808080">) {
   </font><font color="#0000FF"><b>switch</b></font><font color="#808080">(</font><font color="#000080">nOpcao</font><font color="#808080">) {
    </font><font color="#0000FF"><b>case </b></font><font color="#FF0000">1</font><font color="#808080">: {
        </font><font color="#000080">printf</font><font color="#808080">([</font><font color="#000080">self rotulo</font><font color="#808080">: </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">]);
        </font><font color="#000080">strcpy</font><font color="#808080">(</font><font color="#000080">tCliente</font><font color="#808080">.</font><font color="#000080">nome</font><font color="#808080">, [</font><font color="#000080">self digita</font><font color="#808080">: </font><font color="#0000FF"><b>sizeof</b></font><font color="#808080">(</font><font color="#000080">tCliente</font><font color="#808080">.</font><font color="#000080">nome</font><font color="#808080">)]);
        </font><font color="#000080">printf</font><font color="#808080">([</font><font color="#000080">self rotulo</font><font color="#808080">: </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">]);
        </font><font color="#000080">strcpy</font><font color="#808080">(</font><font color="#000080">tCliente</font><font color="#808080">.</font><font color="#000080">email</font><font color="#808080">, [</font><font color="#000080">self digita</font><font color="#808080">: </font><font color="#0000FF"><b>sizeof</b></font><font color="#808080">(</font><font color="#000080">tCliente</font><font color="#808080">.</font><font color="#000080">email</font><font color="#808080">)]);
        </font><font color="#000080">printf</font><font color="#808080">([</font><font color="#000080">self rotulo</font><font color="#808080">: </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">4</font><font color="#808080">]);
        </font><font color="#000080">strcpy</font><font color="#808080">(</font><font color="#000080">tCliente</font><font color="#808080">.</font><font color="#000080">identidade</font><font color="#808080">, [</font><font color="#000080">self digita</font><font color="#808080">: </font><font color="#0000FF"><b>sizeof</b></font><font color="#808080">(</font><font color="#000080">tCliente</font><font color="#808080">.</font><font color="#000080">identidade</font><font color="#808080">)]);
        </font><font color="#000080">printf</font><font color="#808080">([</font><font color="#000080">self rotulo</font><font color="#808080">: </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">5</font><font color="#808080">]);
        </font><font color="#000080">strcpy</font><font color="#808080">(</font><font color="#000080">tCliente</font><font color="#808080">.</font><font color="#000080">sexo</font><font color="#808080">, [</font><font color="#000080">self digita</font><font color="#808080">: </font><font color="#0000FF"><b>sizeof</b></font><font color="#808080">(</font><font color="#000080">tCliente</font><font color="#808080">.</font><font color="#000080">sexo</font><font color="#808080">)]);
        </font><font color="#000080">printf</font><font color="#808080">([</font><font color="#000080">self rotulo</font><font color="#808080">: </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">6</font><font color="#808080">]);
        </font><font color="#000080">strcpy</font><font color="#808080">(</font><font color="#000080">tCliente</font><font color="#808080">.</font><font color="#000080">telefone</font><font color="#808080">, [</font><font color="#000080">self digita</font><font color="#808080">: </font><font color="#0000FF"><b>sizeof</b></font><font color="#808080">(</font><font color="#000080">tCliente</font><font color="#808080">.</font><font color="#000080">telefone</font><font color="#808080">)]);
        </font><font color="#000080">strcpy</font><font color="#808080">(</font><font color="#000080">tCliente</font><font color="#808080">.</font><font color="#000080">dtnascimento</font><font color="#808080">, [</font><font color="#000080">self validaDataHora</font><font color="#808080">: 
              [</font><font color="#000080">self rotulo</font><font color="#808080">: </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">7</font><font color="#808080">], </font><font color="#000080">tCliente</font><font color="#808080">.</font><font color="#000080">dtnascimento</font><font color="#808080">, </font><font color="#000080">YES</font><font color="#808080">]);
        [</font><font color="#000080">self mostrarSubDados</font><font color="#808080">: </font><font color="#000080">opCliente</font><font color="#808080">, </font><font color="#000080">opEndereco</font><font color="#808080">, </font><font color="#000080">NO</font><font color="#808080">];
        [</font><font color="#000080">self mostrarSubDados</font><font color="#808080">: </font><font color="#000080">opCliente</font><font color="#808080">, </font><font color="#000080">opPais</font><font color="#808080">, </font><font color="#000080">NO</font><font color="#808080">];
        [</font><font color="#000080">self mostrarSubDados</font><font color="#808080">: </font><font color="#000080">opCliente</font><font color="#808080">, </font><font color="#000080">opProfissao</font><font color="#808080">, </font><font color="#000080">NO</font><font color="#808080">];
       } </font><font color="#0000FF"><b>break</b></font><font color="#808080">;
    </font><font color="#0000FF"><b>case </b></font><font color="#FF0000">3</font><font color="#808080">: {
        </font><font color="#000080">strcpy</font><font color="#808080">(</font><font color="#000080">tCliente</font><font color="#808080">.</font><font color="#000080">cpf</font><font color="#808080">, [</font><font color="#000080">self trim</font><font color="#808080">: [</font><font color="#000080">self copy</font><font color="#808080">: </font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">14</font><font color="#808080">]]);
        </font><font color="#000080">strcpy</font><font color="#808080">(</font><font color="#000080">tCliente</font><font color="#808080">.</font><font color="#000080">nome</font><font color="#808080">, [</font><font color="#000080">self trim</font><font color="#808080">: [</font><font color="#000080">self copy</font><font color="#808080">: </font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">15</font><font color="#808080">, </font><font color="#FF0000">30</font><font color="#808080">]]);
        </font><font color="#000080">strcpy</font><font color="#808080">(</font><font color="#000080">tCliente</font><font color="#808080">.</font><font color="#000080">email</font><font color="#808080">, [</font><font color="#000080">self trim</font><font color="#808080">: [</font><font color="#000080">self copy</font><font color="#808080">: </font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">45</font><font color="#808080">, </font><font color="#FF0000">30</font><font color="#808080">]]);
        </font><font color="#000080">strcpy</font><font color="#808080">(</font><font color="#000080">tCliente</font><font color="#808080">.</font><font color="#000080">identidade</font><font color="#808080">, [</font><font color="#000080">self trim</font><font color="#808080">: [</font><font color="#000080">self copy</font><font color="#808080">: </font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">75</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">]]);
        </font><font color="#000080">strcpy</font><font color="#808080">(</font><font color="#000080">tCliente</font><font color="#808080">.</font><font color="#000080">sexo</font><font color="#808080">, [</font><font color="#000080">self trim</font><font color="#808080">: [</font><font color="#000080">self copy</font><font color="#808080">: </font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">85</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">]]);
        </font><font color="#000080">strcpy</font><font color="#808080">(</font><font color="#000080">tCliente</font><font color="#808080">.</font><font color="#000080">telefone</font><font color="#808080">, [</font><font color="#000080">self trim</font><font color="#808080">: [</font><font color="#000080">self copy</font><font color="#808080">: </font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">86</font><font color="#808080">, </font><font color="#FF0000">17</font><font color="#808080">]]);
        </font><font color="#000080">strcpy</font><font color="#808080">(</font><font color="#000080">tCliente</font><font color="#808080">.</font><font color="#000080">dtnascimento</font><font color="#808080">, [</font><font color="#000080">self trim</font><font color="#808080">: [</font><font color="#000080">self copy</font><font color="#808080">: </font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">103</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">]]);
        </font><font color="#000080">strcpy</font><font color="#808080">(</font><font color="#000080">tCliente</font><font color="#808080">.</font><font color="#000080">codendereco</font><font color="#808080">, [</font><font color="#000080">self trim</font><font color="#808080">: [</font><font color="#000080">self copy</font><font color="#808080">: </font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">113</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">]]);
        </font><font color="#000080">strcpy</font><font color="#808080">(</font><font color="#000080">tCliente</font><font color="#808080">.</font><font color="#000080">codpais</font><font color="#808080">, [</font><font color="#000080">self trim</font><font color="#808080">: [</font><font color="#000080">self copy</font><font color="#808080">: </font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">123</font><font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">]]);
        </font><font color="#000080">strcpy</font><font color="#808080">(</font><font color="#000080">tCliente</font><font color="#808080">.</font><font color="#000080">codprofissao</font><font color="#808080">, [</font><font color="#000080">self trim</font><font color="#808080">: [</font><font color="#000080">self copy</font><font color="#808080">: </font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">126</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">]]);
        </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;--------------------\n&quot;</font><font color="#808080">);
        </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;%s%s\n&quot;</font><font color="#808080">,[</font><font color="#000080">self rotulo</font><font color="#808080">: </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">], </font><font color="#000080">tCliente</font><font color="#808080">.</font><font color="#000080">cpf</font><font color="#808080">);
        </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;%s%s\n&quot;</font><font color="#808080">,[</font><font color="#000080">self rotulo</font><font color="#808080">: </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">], </font><font color="#000080">tCliente</font><font color="#808080">.</font><font color="#000080">nome</font><font color="#808080">);
        </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;%s%s\n&quot;</font><font color="#808080">,[</font><font color="#000080">self rotulo</font><font color="#808080">: </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">], </font><font color="#000080">tCliente</font><font color="#808080">.</font><font color="#000080">email</font><font color="#808080">);
        </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;%s%s\n&quot;</font><font color="#808080">,[</font><font color="#000080">self rotulo</font><font color="#808080">: </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">4</font><font color="#808080">], </font><font color="#000080">tCliente</font><font color="#808080">.</font><font color="#000080">identidade</font><font color="#808080">);
        </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;%s%s\n&quot;</font><font color="#808080">,[</font><font color="#000080">self rotulo</font><font color="#808080">: </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">5</font><font color="#808080">], </font><font color="#000080">tCliente</font><font color="#808080">.</font><font color="#000080">sexo</font><font color="#808080">);
        </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;%s%s\n&quot;</font><font color="#808080">,[</font><font color="#000080">self rotulo</font><font color="#808080">: </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">6</font><font color="#808080">], </font><font color="#000080">tCliente</font><font color="#808080">.</font><font color="#000080">telefone</font><font color="#808080">);
        </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;%s%s\n&quot;</font><font color="#808080">,[</font><font color="#000080">self rotulo</font><font color="#808080">: </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">7</font><font color="#808080">], </font><font color="#000080">tCliente</font><font color="#808080">.</font><font color="#000080">dtnascimento</font><font color="#808080">);
        </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;%s%s\n&quot;</font><font color="#808080">,[</font><font color="#000080">self rotulo</font><font color="#808080">: </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">8</font><font color="#808080">], </font><font color="#000080">tCliente</font><font color="#808080">.</font><font color="#000080">codendereco</font><font color="#808080">);
        [</font><font color="#000080">self mostrarSubDados</font><font color="#808080">: </font><font color="#000080">opCliente</font><font color="#808080">, </font><font color="#000080">opEndereco</font><font color="#808080">, </font><font color="#000080">YES</font><font color="#808080">];
        </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;%s%s\n&quot;</font><font color="#808080">,[</font><font color="#000080">self rotulo</font><font color="#808080">: </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">9</font><font color="#808080">], </font><font color="#000080">tCliente</font><font color="#808080">.</font><font color="#000080">codpais</font><font color="#808080">);
        [</font><font color="#000080">self mostrarSubDados</font><font color="#808080">: </font><font color="#000080">opCliente</font><font color="#808080">, </font><font color="#000080">opPais</font><font color="#808080">, </font><font color="#000080">YES</font><font color="#808080">];
        </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;%s%s\n&quot;</font><font color="#808080">,[</font><font color="#000080">self rotulo</font><font color="#808080">: </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">], </font><font color="#000080">tCliente</font><font color="#808080">.</font><font color="#000080">codprofissao</font><font color="#808080">);
        [</font><font color="#000080">self mostrarSubDados</font><font color="#808080">: </font><font color="#000080">opCliente</font><font color="#808080">, </font><font color="#000080">opProfissao</font><font color="#808080">, </font><font color="#000080">YES</font><font color="#808080">];
       } </font><font color="#0000FF"><b>break</b></font><font color="#808080">;
   }
} </font><font color="#0000FF"><b>else if </b></font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">==</font><font color="#000080">opVenda</font><font color="#808080">) {
   </font><font color="#0000FF"><b>switch</b></font><font color="#808080">(</font><font color="#000080">nOpcao</font><font color="#808080">) {
    </font><font color="#0000FF"><b>case </b></font><font color="#FF0000">1</font><font color="#808080">: [</font><font color="#000080">self mostrarSubDados</font><font color="#808080">: </font><font color="#000080">opVenda</font><font color="#808080">,</font><font color="#000080">opVenda</font><font color="#808080">, </font><font color="#000080">NO</font><font color="#808080">]; </font><font color="#0000FF"><b>break</b></font><font color="#808080">;
    </font><font color="#0000FF"><b>case </b></font><font color="#FF0000">2</font><font color="#808080">: {
        </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;DataHoraVenda       CPF            ISBN          &quot; </font><font color="#FF00FF">\
        </font><font color="#800000">&quot;Pre&ccedil;oVenda\n&quot;</font><font color="#808080">);
        </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;-------------       ---            ----          &quot; </font><font color="#FF00FF">\
        </font><font color="#800000">&quot;----------\n&quot;</font><font color="#808080">);
       } </font><font color="#0000FF"><b>break</b></font><font color="#808080">;
    </font><font color="#0000FF"><b>case </b></font><font color="#FF0000">3</font><font color="#808080">: {
        </font><font color="#000080">strcpy</font><font color="#808080">(</font><font color="#000080">tVenda</font><font color="#808080">.</font><font color="#000080">dthrvenda</font><font color="#808080">, [</font><font color="#000080">self trim</font><font color="#808080">: [</font><font color="#000080">self copy</font><font color="#808080">: </font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">19</font><font color="#808080">]]);
        </font><font color="#000080">strcpy</font><font color="#808080">(</font><font color="#000080">tVenda</font><font color="#808080">.</font><font color="#000080">cpf</font><font color="#808080">, [</font><font color="#000080">self trim</font><font color="#808080">: [</font><font color="#000080">self copy</font><font color="#808080">: </font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">20</font><font color="#808080">, </font><font color="#FF0000">14</font><font color="#808080">]]);
        </font><font color="#000080">strcpy</font><font color="#808080">(</font><font color="#000080">tVenda</font><font color="#808080">.</font><font color="#000080">isbn</font><font color="#808080">, [</font><font color="#000080">self trim</font><font color="#808080">: [</font><font color="#000080">self copy</font><font color="#808080">: </font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">34</font><font color="#808080">, </font><font color="#FF0000">13</font><font color="#808080">]]);
        </font><font color="#000080">strcpy</font><font color="#808080">(</font><font color="#000080">tVenda</font><font color="#808080">.</font><font color="#000080">precovenda</font><font color="#808080">, [</font><font color="#000080">self trim</font><font color="#808080">: [</font><font color="#000080">self copy</font><font color="#808080">: </font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#FF0000">47</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">]]);
        </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;%s %s %s %s\n&quot;</font><font color="#808080">,[</font><font color="#000080">self esp</font><font color="#808080">: </font><font color="#000080">tVenda</font><font color="#808080">.</font><font color="#000080">dthrvenda</font><font color="#808080">,</font><font color="#FF0000">19</font><font color="#808080">],[</font><font color="#000080">self esp</font><font color="#808080">: </font><font color="#000080">tVenda</font><font color="#808080">.</font><font color="#000080">cpf</font><font color="#808080">,</font><font color="#FF0000">14</font><font color="#808080">],
        [</font><font color="#000080">self esp</font><font color="#808080">: </font><font color="#000080">tVenda</font><font color="#808080">.</font><font color="#000080">isbn</font><font color="#808080">,</font><font color="#FF0000">13</font><font color="#808080">],[</font><font color="#000080">self esp</font><font color="#808080">: </font><font color="#000080">tVenda</font><font color="#808080">.</font><font color="#000080">precovenda</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">]);
       } </font><font color="#0000FF"><b>break</b></font><font color="#808080">;
   }
}
</font><font color="#0000FF"><b>return </b></font><font color="#000080">self</font><font color="#808080">;
}
<i>/*------------------------------------------------------------------------------
Mostra as sub inform&ccedil;&otilde;es de entrada e de sa&iacute;da.
sreg - o tipo de arquivo
ssubreg - o subtipo de arquivo
bSoMostrar - se vai s&oacute; mostrar na sa&iacute;da
------------------------------------------------------------------------------*/
</i>- </font><font color="#000080">mostrarSubDados</font><font color="#808080">: (</font><font color="#0000FF"><b>enum </b></font><font color="#000080">ctArqs</font><font color="#808080">) </font><font color="#000080">sreg</font><font color="#808080">, ...
{ 
 </font><font color="#0000FF"><b>enum </b></font><font color="#000080">ctArqs ssubreg</font><font color="#808080">;
 </font><font color="#000080">BOOL bSoMostrar</font><font color="#808080">;
 </font><font color="#000080">STR sRegistro</font><font color="#808080">, </font><font color="#000080">sPreco</font><font color="#808080">;
 </font><font color="#0000FF"><b>int </b></font><font color="#000080">nMaxTentativas</font><font color="#808080">;

</font><font color="#000080">va_list lparams</font><font color="#808080">;
</font><font color="#000080">va_start</font><font color="#808080">(</font><font color="#000080">lparams</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">);
</font><font color="#000080">ssubreg </font><font color="#808080">= </font><font color="#000080">va_arg</font><font color="#808080">(</font><font color="#000080">lparams</font><font color="#808080">,</font><font color="#0000FF"><b>enum </b></font><font color="#000080">ctArqs</font><font color="#808080">);
</font><font color="#000080">bSoMostrar </font><font color="#808080">= </font><font color="#000080">va_arg</font><font color="#808080">(</font><font color="#000080">lparams</font><font color="#808080">,</font><font color="#0000FF"><b>int</b></font><font color="#808080">);
</font><font color="#000080">va_end</font><font color="#808080">(</font><font color="#000080">lparams</font><font color="#808080">);

</font><font color="#000080">nMaxTentativas </font><font color="#808080">= </font><font color="#FF0000">3</font><font color="#808080">;
</font><font color="#0000FF"><b>if </b></font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">==</font><font color="#000080">opLivro</font><font color="#808080">) {
  </font><font color="#0000FF"><b>if </b></font><font color="#808080">(</font><font color="#000080">ssubreg</font><font color="#808080">==</font><font color="#000080">opEditora</font><font color="#808080">) {
    </font><font color="#0000FF"><b>if </b></font><font color="#808080">(</font><font color="#000080">bSoMostrar</font><font color="#808080">==</font><font color="#000080">YES</font><font color="#808080">)
       </font><font color="#000080">sRegistro </font><font color="#808080">= [</font><font color="#000080">self pesqArq</font><font color="#808080">: </font><font color="#000080">tfEditora</font><font color="#808080">,</font><font color="#000080">tLivro</font><font color="#808080">.</font><font color="#000080">codeditora</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">,[</font><font color="#000080">self tamReg</font><font color="#808080">: </font><font color="#000080">opEditora</font><font color="#808080">]];
    </font><font color="#0000FF"><b>else
       </b></font><font color="#000080">sRegistro </font><font color="#808080">= [</font><font color="#000080">self validaEntrada</font><font color="#808080">: </font><font color="#000080">tfEditora</font><font color="#808080">,</font><font color="#000080">ssubreg</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#000080">tLivro</font><font color="#808080">.</font><font color="#000080">codeditora</font><font color="#808080">,
                  </font><font color="#000080">nMaxTentativas</font><font color="#808080">,</font><font color="#000080">NO</font><font color="#808080">,</font><font color="#000080">opNumero</font><font color="#808080">];
    </font><font color="#0000FF"><b>if </b></font><font color="#808080">(</font><font color="#000080">strcmp</font><font color="#808080">(</font><font color="#000080">sRegistro</font><font color="#808080">,</font><font color="#800000">&quot;&quot;</font><font color="#808080">)!=</font><font color="#FF0000">0</font><font color="#808080">) {
      </font><font color="#000080">strcpy</font><font color="#808080">(</font><font color="#000080">tLivro</font><font color="#808080">.</font><font color="#000080">codeditora</font><font color="#808080">, [</font><font color="#000080">self trim</font><font color="#808080">: [</font><font color="#000080">self copy</font><font color="#808080">: </font><font color="#000080">sRegistro</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">]]);
      </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot; %s&quot;</font><font color="#808080">,[</font><font color="#000080">self rotulo</font><font color="#808080">: </font><font color="#000080">opEditora</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">]);
      </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;%s\n&quot;</font><font color="#808080">,[</font><font color="#000080">self copy</font><font color="#808080">: </font><font color="#000080">sRegistro</font><font color="#808080">, </font><font color="#000080">g_nPosChave</font><font color="#808080">, </font><font color="#000080">g_nTamChave</font><font color="#808080">]);
    }
  } </font><font color="#0000FF"><b>else if </b></font><font color="#808080">(</font><font color="#000080">ssubreg</font><font color="#808080">==</font><font color="#000080">opIdioma</font><font color="#808080">) {
    </font><font color="#0000FF"><b>if </b></font><font color="#808080">(</font><font color="#000080">bSoMostrar</font><font color="#808080">==</font><font color="#000080">YES</font><font color="#808080">)
       </font><font color="#000080">sRegistro </font><font color="#808080">= [</font><font color="#000080">self pesqArq</font><font color="#808080">: </font><font color="#000080">tfIdioma</font><font color="#808080">, </font><font color="#000080">tLivro</font><font color="#808080">.</font><font color="#000080">codidioma</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">,[</font><font color="#000080">self tamReg</font><font color="#808080">: </font><font color="#000080">opIdioma</font><font color="#808080">]];
    </font><font color="#0000FF"><b>else
       </b></font><font color="#000080">sRegistro </font><font color="#808080">= [</font><font color="#000080">self validaEntrada</font><font color="#808080">: </font><font color="#000080">tfIdioma</font><font color="#808080">,</font><font color="#000080">ssubreg</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#000080">tLivro</font><font color="#808080">.</font><font color="#000080">codidioma</font><font color="#808080">,
                  </font><font color="#000080">nMaxTentativas</font><font color="#808080">,</font><font color="#000080">NO</font><font color="#808080">,</font><font color="#000080">opNumero</font><font color="#808080">];
    </font><font color="#0000FF"><b>if </b></font><font color="#808080">(</font><font color="#000080">strcmp</font><font color="#808080">(</font><font color="#000080">sRegistro</font><font color="#808080">,</font><font color="#800000">&quot;&quot;</font><font color="#808080">)!=</font><font color="#FF0000">0</font><font color="#808080">) {
      </font><font color="#000080">strcpy</font><font color="#808080">(</font><font color="#000080">tLivro</font><font color="#808080">.</font><font color="#000080">codidioma</font><font color="#808080">, [</font><font color="#000080">self trim</font><font color="#808080">: [</font><font color="#000080">self copy</font><font color="#808080">: </font><font color="#000080">sRegistro</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">]]);
      </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot; %s&quot;</font><font color="#808080">,[</font><font color="#000080">self rotulo</font><font color="#808080">: </font><font color="#000080">opIdioma</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">]);
      </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;%s\n&quot;</font><font color="#808080">,[</font><font color="#000080">self copy</font><font color="#808080">: </font><font color="#000080">sRegistro</font><font color="#808080">, </font><font color="#000080">g_nPosChave</font><font color="#808080">, </font><font color="#000080">g_nTamChave</font><font color="#808080">]);
    }
  }
} </font><font color="#0000FF"><b>else if </b></font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">==</font><font color="#000080">opCliente</font><font color="#808080">) {
  </font><font color="#0000FF"><b>if </b></font><font color="#808080">(</font><font color="#000080">ssubreg</font><font color="#808080">==</font><font color="#000080">opEndereco</font><font color="#808080">) {
    </font><font color="#0000FF"><b>if </b></font><font color="#808080">(</font><font color="#000080">bSoMostrar</font><font color="#808080">==</font><font color="#000080">YES</font><font color="#808080">)
       </font><font color="#000080">sRegistro </font><font color="#808080">= [</font><font color="#000080">self pesqArq</font><font color="#808080">: </font><font color="#000080">tfEndereco</font><font color="#808080">, </font><font color="#000080">tCliente</font><font color="#808080">.</font><font color="#000080">codendereco</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">,
                  [</font><font color="#000080">self tamReg</font><font color="#808080">: </font><font color="#000080">opEndereco</font><font color="#808080">]];
    </font><font color="#0000FF"><b>else
       </b></font><font color="#000080">sRegistro </font><font color="#808080">= [</font><font color="#000080">self validaEntrada</font><font color="#808080">: </font><font color="#000080">tfEndereco</font><font color="#808080">,</font><font color="#000080">ssubreg</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#000080">tCliente</font><font color="#808080">.</font><font color="#000080">codendereco</font><font color="#808080">,
                  </font><font color="#000080">nMaxTentativas</font><font color="#808080">,</font><font color="#000080">NO</font><font color="#808080">,</font><font color="#000080">opNumero</font><font color="#808080">];
    </font><font color="#0000FF"><b>if </b></font><font color="#808080">(</font><font color="#000080">strcmp</font><font color="#808080">(</font><font color="#000080">sRegistro</font><font color="#808080">,</font><font color="#800000">&quot;&quot;</font><font color="#808080">)!=</font><font color="#FF0000">0</font><font color="#808080">) {
      </font><font color="#000080">strcpy</font><font color="#808080">(</font><font color="#000080">tCliente</font><font color="#808080">.</font><font color="#000080">codendereco</font><font color="#808080">, [</font><font color="#000080">self trim</font><font color="#808080">: [</font><font color="#000080">self copy</font><font color="#808080">: </font><font color="#000080">sRegistro</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">]]);
      </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot; %s&quot;</font><font color="#808080">,[</font><font color="#000080">self rotulo</font><font color="#808080">: </font><font color="#000080">opEndereco</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">]);
      </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;%s\n&quot;</font><font color="#808080">,[</font><font color="#000080">self copy</font><font color="#808080">: </font><font color="#000080">sRegistro</font><font color="#808080">, </font><font color="#000080">g_nPosChave</font><font color="#808080">, </font><font color="#000080">g_nTamChave</font><font color="#808080">]);
      </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot; %s&quot;</font><font color="#808080">,[</font><font color="#000080">self rotulo</font><font color="#808080">: </font><font color="#000080">opEndereco</font><font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">]);
      </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;%s\n&quot;</font><font color="#808080">,[</font><font color="#000080">self copy</font><font color="#808080">: </font><font color="#000080">sRegistro</font><font color="#808080">, </font><font color="#000080">g_nPosChave</font><font color="#808080">, </font><font color="#000080">g_nTamChave</font><font color="#808080">]);
      </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot; %s&quot;</font><font color="#808080">,[</font><font color="#000080">self rotulo</font><font color="#808080">: </font><font color="#000080">opEndereco</font><font color="#808080">, </font><font color="#FF0000">4</font><font color="#808080">]);
      </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;%s\n&quot;</font><font color="#808080">,[</font><font color="#000080">self copy</font><font color="#808080">: </font><font color="#000080">sRegistro</font><font color="#808080">, </font><font color="#000080">g_nPosChave</font><font color="#808080">, </font><font color="#000080">g_nTamChave</font><font color="#808080">]);
      </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot; %s&quot;</font><font color="#808080">,[</font><font color="#000080">self rotulo</font><font color="#808080">: </font><font color="#000080">opEndereco</font><font color="#808080">, </font><font color="#FF0000">5</font><font color="#808080">]);
      </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;%s\n&quot;</font><font color="#808080">,[</font><font color="#000080">self copy</font><font color="#808080">: </font><font color="#000080">sRegistro</font><font color="#808080">, </font><font color="#000080">g_nPosChave</font><font color="#808080">, </font><font color="#000080">g_nTamChave</font><font color="#808080">]);
      </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot; %s&quot;</font><font color="#808080">,[</font><font color="#000080">self rotulo</font><font color="#808080">: </font><font color="#000080">opEndereco</font><font color="#808080">, </font><font color="#FF0000">6</font><font color="#808080">]);
      </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;%s\n&quot;</font><font color="#808080">,[</font><font color="#000080">self copy</font><font color="#808080">: </font><font color="#000080">sRegistro</font><font color="#808080">, </font><font color="#000080">g_nPosChave</font><font color="#808080">, </font><font color="#000080">g_nTamChave</font><font color="#808080">]);
    }
  } </font><font color="#0000FF"><b>else if </b></font><font color="#808080">(</font><font color="#000080">ssubreg</font><font color="#808080">==</font><font color="#000080">opPais</font><font color="#808080">) {
    </font><font color="#0000FF"><b>if </b></font><font color="#808080">(</font><font color="#000080">bSoMostrar</font><font color="#808080">==</font><font color="#000080">YES</font><font color="#808080">)
       </font><font color="#000080">sRegistro </font><font color="#808080">= [</font><font color="#000080">self pesqArq</font><font color="#808080">: </font><font color="#000080">tfPais</font><font color="#808080">, </font><font color="#000080">tCliente</font><font color="#808080">.</font><font color="#000080">codpais</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">3</font><font color="#808080">, [</font><font color="#000080">self tamReg</font><font color="#808080">: </font><font color="#000080">opPais</font><font color="#808080">]];
    </font><font color="#0000FF"><b>else
       </b></font><font color="#000080">sRegistro </font><font color="#808080">= [</font><font color="#000080">self validaEntrada</font><font color="#808080">: </font><font color="#000080">tfPais</font><font color="#808080">,</font><font color="#000080">ssubreg</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#000080">tCliente</font><font color="#808080">.</font><font color="#000080">codpais</font><font color="#808080">,
                  </font><font color="#000080">nMaxTentativas</font><font color="#808080">,</font><font color="#000080">NO</font><font color="#808080">,</font><font color="#000080">opTexto</font><font color="#808080">];
    </font><font color="#0000FF"><b>if </b></font><font color="#808080">(</font><font color="#000080">strcmp</font><font color="#808080">(</font><font color="#000080">sRegistro</font><font color="#808080">,</font><font color="#800000">&quot;&quot;</font><font color="#808080">)!=</font><font color="#FF0000">0</font><font color="#808080">) {
      </font><font color="#000080">strcpy</font><font color="#808080">(</font><font color="#000080">tCliente</font><font color="#808080">.</font><font color="#000080">codpais</font><font color="#808080">, [</font><font color="#000080">self trim</font><font color="#808080">: [</font><font color="#000080">self copy</font><font color="#808080">: </font><font color="#000080">sRegistro</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#FF0000">3</font><font color="#808080">]]);
      </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot; %s&quot;</font><font color="#808080">,[</font><font color="#000080">self rotulo</font><font color="#808080">: </font><font color="#000080">opPais</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">]);
      </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;%s\n&quot;</font><font color="#808080">,[</font><font color="#000080">self copy</font><font color="#808080">: </font><font color="#000080">sRegistro</font><font color="#808080">, </font><font color="#000080">g_nPosChave</font><font color="#808080">, </font><font color="#000080">g_nTamChave</font><font color="#808080">]);
    }
  } </font><font color="#0000FF"><b>else if </b></font><font color="#808080">(</font><font color="#000080">ssubreg</font><font color="#808080">==</font><font color="#000080">opProfissao</font><font color="#808080">) {
    </font><font color="#0000FF"><b>if </b></font><font color="#808080">(</font><font color="#000080">bSoMostrar</font><font color="#808080">==</font><font color="#000080">YES</font><font color="#808080">)
       </font><font color="#000080">sRegistro </font><font color="#808080">= [</font><font color="#000080">self pesqArq</font><font color="#808080">: </font><font color="#000080">tfProfissao</font><font color="#808080">, </font><font color="#000080">tCliente</font><font color="#808080">.</font><font color="#000080">codprofissao</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">,
                  [</font><font color="#000080">self tamReg</font><font color="#808080">: </font><font color="#000080">opProfissao</font><font color="#808080">]];
    </font><font color="#0000FF"><b>else
       </b></font><font color="#000080">sRegistro </font><font color="#808080">= [</font><font color="#000080">self validaEntrada</font><font color="#808080">: </font><font color="#000080">tfProfissao</font><font color="#808080">,</font><font color="#000080">ssubreg</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#000080">tCliente</font><font color="#808080">.</font><font color="#000080">codprofissao</font><font color="#808080">,
                  </font><font color="#000080">nMaxTentativas</font><font color="#808080">,</font><font color="#000080">NO</font><font color="#808080">,</font><font color="#000080">opNumero</font><font color="#808080">];
    </font><font color="#0000FF"><b>if </b></font><font color="#808080">(</font><font color="#000080">strcmp</font><font color="#808080">(</font><font color="#000080">sRegistro</font><font color="#808080">,</font><font color="#800000">&quot;&quot;</font><font color="#808080">)!=</font><font color="#FF0000">0</font><font color="#808080">) {
      </font><font color="#000080">strcpy</font><font color="#808080">(</font><font color="#000080">tCliente</font><font color="#808080">.</font><font color="#000080">codprofissao</font><font color="#808080">, [</font><font color="#000080">self trim</font><font color="#808080">: [</font><font color="#000080">self copy</font><font color="#808080">: </font><font color="#000080">sRegistro</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">]]);
      </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot; %s&quot;</font><font color="#808080">,[</font><font color="#000080">self rotulo</font><font color="#808080">: </font><font color="#000080">opProfissao</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">]);
      </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;%s\n&quot;</font><font color="#808080">,[</font><font color="#000080">self copy</font><font color="#808080">: </font><font color="#000080">sRegistro</font><font color="#808080">, </font><font color="#000080">g_nPosChave</font><font color="#808080">, </font><font color="#000080">g_nTamChave</font><font color="#808080">]);
    }
  }
} </font><font color="#0000FF"><b>else if </b></font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">==</font><font color="#000080">opVenda</font><font color="#808080">) {
  </font><font color="#000080">sRegistro </font><font color="#808080">= [</font><font color="#000080">self pesqArq</font><font color="#808080">: </font><font color="#000080">tfLivro</font><font color="#808080">, </font><font color="#000080">tVenda</font><font color="#808080">.</font><font color="#000080">isbn</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">13</font><font color="#808080">, [</font><font color="#000080">self tamReg</font><font color="#808080">: </font><font color="#000080">opLivro</font><font color="#808080">]];
  </font><font color="#0000FF"><b>if </b></font><font color="#808080">(</font><font color="#000080">strcmp</font><font color="#808080">(</font><font color="#000080">sRegistro</font><font color="#808080">,</font><font color="#800000">&quot;&quot;</font><font color="#808080">)!=</font><font color="#FF0000">0</font><font color="#808080">) {
    </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot; %s&quot;</font><font color="#808080">,[</font><font color="#000080">self rotulo</font><font color="#808080">: </font><font color="#000080">opLivro</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">]); <i>/* Titulo */
    </i></font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;%s\n&quot;</font><font color="#808080">,[</font><font color="#000080">self copy</font><font color="#808080">: </font><font color="#000080">sRegistro</font><font color="#808080">, </font><font color="#000080">g_nPosChave</font><font color="#808080">, </font><font color="#000080">g_nTamChave</font><font color="#808080">]);
    </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot; %s&quot;</font><font color="#808080">,[</font><font color="#000080">self rotulo</font><font color="#808080">: </font><font color="#000080">opLivro</font><font color="#808080">, </font><font color="#FF0000">9</font><font color="#808080">]); <i>/* Preco */
    </i></font><font color="#000080">sPreco </font><font color="#808080">= [</font><font color="#000080">self copy</font><font color="#808080">: </font><font color="#000080">sRegistro</font><font color="#808080">, </font><font color="#000080">g_nPosChave</font><font color="#808080">, </font><font color="#000080">g_nTamChave</font><font color="#808080">];
    </font><font color="#000080">g_nPreco </font><font color="#808080">= </font><font color="#000080">atof</font><font color="#808080">(</font><font color="#000080">sPreco</font><font color="#808080">);
    </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;%s\n&quot;</font><font color="#808080">,</font><font color="#000080">sPreco</font><font color="#808080">);
  }
}
</font><font color="#0000FF"><b>return </b></font><font color="#000080">self</font><font color="#808080">;
}
<i>/*------------------------------------------------------------------------------
Realiza os cadastros dos arquivos que se ligam a outros arquivos.
sreg - o tipo de arquivo
sacao - a a&ccedil;&atilde;o a ser realizada
sCodigo - um das chaves do arquivo de liga&ccedil;&atilde;o
------------------------------------------------------------------------------*/
</i>- </font><font color="#000080">frmCadLigados</font><font color="#808080">: (</font><font color="#0000FF"><b>enum </b></font><font color="#000080">ctArqs</font><font color="#808080">) </font><font color="#000080">sreg</font><font color="#808080">, ...
{ 
  </font><font color="#0000FF"><b>enum </b></font><font color="#000080">ctAcao sacao</font><font color="#808080">;
  </font><font color="#0000FF"><b>int </b></font><font color="#000080">nQtd</font><font color="#808080">, </font><font color="#000080">nCont</font><font color="#808080">, </font><font color="#000080">nQtdEstoque</font><font color="#808080">;
  </font><font color="#0000FF"><b>double </b></font><font color="#000080">nTotalPreco</font><font color="#808080">;
  </font><font color="#000080">STR sCodigo</font><font color="#808080">, </font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#000080">sTotalPreco</font><font color="#808080">, </font><font color="#000080">sPreco</font><font color="#808080">, </font><font color="#000080">sQtd</font><font color="#808080">;

</font><font color="#000080">va_list lparams</font><font color="#808080">;
</font><font color="#000080">va_start</font><font color="#808080">(</font><font color="#000080">lparams</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">);
</font><font color="#000080">sacao </font><font color="#808080">= </font><font color="#000080">va_arg</font><font color="#808080">(</font><font color="#000080">lparams</font><font color="#808080">,</font><font color="#0000FF"><b>enum </b></font><font color="#000080">ctAcao</font><font color="#808080">);
</font><font color="#000080">sCodigo </font><font color="#808080">= </font><font color="#000080">va_arg</font><font color="#808080">(</font><font color="#000080">lparams</font><font color="#808080">,</font><font color="#000080">STR</font><font color="#808080">);
</font><font color="#000080">va_end</font><font color="#808080">(</font><font color="#000080">lparams</font><font color="#808080">);

</font><font color="#000080">sQtd </font><font color="#808080">= [</font><font color="#000080">self alocaString</font><font color="#808080">: </font><font color="#000080">TAM_MAX_STR</font><font color="#808080">];

</font><font color="#0000FF"><b>if </b></font><font color="#808080">(</font><font color="#000080">sacao</font><font color="#808080">==</font><font color="#000080">opNovo</font><font color="#808080">) {
  </font><font color="#000080">nCont </font><font color="#808080">= </font><font color="#FF0000">1</font><font color="#808080">;
  </font><font color="#0000FF"><b>if </b></font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">==</font><font color="#000080">opLivroAss</font><font color="#808080">) {
    </font><font color="#000080">strcpy</font><font color="#808080">(</font><font color="#000080">sQtd</font><font color="#808080">, [</font><font color="#000080">self validaNumero</font><font color="#808080">: </font><font color="#800000">&quot;Quantos assuntos quer cadastrar?: &quot;</font><font color="#808080">,</font><font color="#000080">sQtd</font><font color="#808080">]);
    </font><font color="#000080">nQtd </font><font color="#808080">= </font><font color="#000080">atoi</font><font color="#808080">(</font><font color="#000080">sQtd</font><font color="#808080">);
    </font><font color="#000080">fseek</font><font color="#808080">(</font><font color="#000080">tfLivroAss</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#000080">SEEK_SET</font><font color="#808080">);
    </font><font color="#0000FF"><b>while </b></font><font color="#808080">(</font><font color="#000080">nCont </font><font color="#808080">&lt;= </font><font color="#000080">nQtd</font><font color="#808080">) {
      </font><font color="#000080">strcpy</font><font color="#808080">(</font><font color="#000080">tLivroAss</font><font color="#808080">.</font><font color="#000080">isbn</font><font color="#808080">, </font><font color="#000080">sCodigo</font><font color="#808080">);
      </font><font color="#000080">printf</font><font color="#808080">([</font><font color="#000080">self rotulo</font><font color="#808080">: </font><font color="#000080">opLivroAss</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">]);
      </font><font color="#000080">strcpy</font><font color="#808080">(</font><font color="#000080">tLivroAss</font><font color="#808080">.</font><font color="#000080">codassunto</font><font color="#808080">, [</font><font color="#000080">self digita</font><font color="#808080">: </font><font color="#0000FF"><b>sizeof</b></font><font color="#808080">(</font><font color="#000080">tLivroAss</font><font color="#808080">.</font><font color="#000080">codassunto</font><font color="#808080">)]);
      </font><font color="#000080">slinha </font><font color="#808080">= [</font><font color="#000080">self pesqArq</font><font color="#808080">: </font><font color="#000080">tfAssunto</font><font color="#808080">, </font><font color="#000080">tLivroAss</font><font color="#808080">.</font><font color="#000080">codassunto</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">,[</font><font color="#000080">self tamReg</font><font color="#808080">: </font><font color="#000080">opAssunto</font><font color="#808080">]];
      </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot; %s&quot;</font><font color="#808080">,[</font><font color="#000080">self rotulo</font><font color="#808080">: </font><font color="#000080">opAssunto</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">]);
      </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;%s\n&quot;</font><font color="#808080">,[</font><font color="#000080">self copy</font><font color="#808080">: </font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#000080">g_nPosChave</font><font color="#808080">, </font><font color="#000080">g_nTamChave</font><font color="#808080">]);
      [</font><font color="#000080">self pesqLinhaExcluida</font><font color="#808080">: </font><font color="#000080">tfLivroAss</font><font color="#808080">, [</font><font color="#000080">self tamReg</font><font color="#808080">: </font><font color="#000080">sreg</font><font color="#808080">]];
      [</font><font color="#000080">self subMenu</font><font color="#808080">: </font><font color="#FF0000">14</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">];
      </font><font color="#000080">nCont</font><font color="#808080">++;
    }
  } </font><font color="#0000FF"><b>else if </b></font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">==</font><font color="#000080">opLivroAut</font><font color="#808080">) {
    </font><font color="#000080">strcpy</font><font color="#808080">(</font><font color="#000080">sQtd</font><font color="#808080">, [</font><font color="#000080">self validaNumero</font><font color="#808080">: </font><font color="#800000">&quot;Quantos autores quer cadastrar?: &quot;</font><font color="#808080">,</font><font color="#000080">sQtd</font><font color="#808080">]);
    </font><font color="#000080">nQtd </font><font color="#808080">= </font><font color="#000080">atoi</font><font color="#808080">(</font><font color="#000080">sQtd</font><font color="#808080">);
    </font><font color="#000080">fseek</font><font color="#808080">(</font><font color="#000080">tfLivroAut</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#000080">SEEK_SET</font><font color="#808080">);
    </font><font color="#0000FF"><b>while </b></font><font color="#808080">(</font><font color="#000080">nCont </font><font color="#808080">&lt;= </font><font color="#000080">nQtd</font><font color="#808080">) {
      </font><font color="#000080">strcpy</font><font color="#808080">(</font><font color="#000080">tLivroAut</font><font color="#808080">.</font><font color="#000080">isbn</font><font color="#808080">, </font><font color="#000080">sCodigo</font><font color="#808080">);
      </font><font color="#000080">printf</font><font color="#808080">([</font><font color="#000080">self rotulo</font><font color="#808080">: </font><font color="#000080">opLivroAut</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">]);
      </font><font color="#000080">strcpy</font><font color="#808080">(</font><font color="#000080">tLivroAut</font><font color="#808080">.</font><font color="#000080">codautor</font><font color="#808080">, [</font><font color="#000080">self digita</font><font color="#808080">: </font><font color="#0000FF"><b>sizeof</b></font><font color="#808080">(</font><font color="#000080">tLivroAut</font><font color="#808080">.</font><font color="#000080">codautor</font><font color="#808080">)]);
      </font><font color="#000080">slinha </font><font color="#808080">= [</font><font color="#000080">self pesqArq</font><font color="#808080">: </font><font color="#000080">tfAutor</font><font color="#808080">, </font><font color="#000080">tLivroAut</font><font color="#808080">.</font><font color="#000080">codautor</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">,[</font><font color="#000080">self tamReg</font><font color="#808080">: </font><font color="#000080">opAutor</font><font color="#808080">]];
      </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot; %s&quot;</font><font color="#808080">,[</font><font color="#000080">self rotulo</font><font color="#808080">: </font><font color="#000080">opAutor</font><font color="#808080">, </font><font color="#FF0000">2</font><font color="#808080">]);
      </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;%s\n&quot;</font><font color="#808080">,[</font><font color="#000080">self copy</font><font color="#808080">: </font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#000080">g_nPosChave</font><font color="#808080">, </font><font color="#000080">g_nTamChave</font><font color="#808080">]);
      [</font><font color="#000080">self pesqLinhaExcluida</font><font color="#808080">: </font><font color="#000080">tfLivroAut</font><font color="#808080">, [</font><font color="#000080">self tamReg</font><font color="#808080">: </font><font color="#000080">sreg</font><font color="#808080">]];
      [</font><font color="#000080">self subMenu</font><font color="#808080">: </font><font color="#FF0000">14</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">];
      </font><font color="#000080">nCont</font><font color="#808080">++;
    }
  } </font><font color="#0000FF"><b>else if </b></font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">==</font><font color="#000080">opVenda</font><font color="#808080">) {
    </font><font color="#000080">sPreco </font><font color="#808080">= [</font><font color="#000080">self alocaString</font><font color="#808080">: </font><font color="#000080">TAM_MAX_STR</font><font color="#808080">];
    </font><font color="#000080">sTotalPreco </font><font color="#808080">= [</font><font color="#000080">self alocaString</font><font color="#808080">: </font><font color="#000080">TAM_MAX_STR</font><font color="#808080">];    
    </font><font color="#000080">strcpy</font><font color="#808080">(</font><font color="#000080">sQtd</font><font color="#808080">, [</font><font color="#000080">self validaNumero</font><font color="#808080">: </font><font color="#800000">&quot;Quantos livros quer vender?: &quot;</font><font color="#808080">,</font><font color="#000080">sQtd</font><font color="#808080">]);
    </font><font color="#000080">nQtd </font><font color="#808080">= </font><font color="#000080">atoi</font><font color="#808080">(</font><font color="#000080">sQtd</font><font color="#808080">);
    </font><font color="#000080">nTotalPreco </font><font color="#808080">= </font><font color="#FF0000">0</font><font color="#808080">;
    </font><font color="#0000FF"><b>while </b></font><font color="#808080">(</font><font color="#000080">nCont </font><font color="#808080">&lt;= </font><font color="#000080">nQtd</font><font color="#808080">) {
      </font><font color="#000080">slinha </font><font color="#808080">= [</font><font color="#000080">self validaEntrada</font><font color="#808080">: </font><font color="#000080">tfLivro</font><font color="#808080">,</font><font color="#000080">opLivro</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#000080">tVenda</font><font color="#808080">.</font><font color="#000080">isbn</font><font color="#808080">,</font><font color="#FF0000">3</font><font color="#808080">,</font><font color="#000080">NO</font><font color="#808080">,</font><font color="#000080">opTexto</font><font color="#808080">];
      </font><font color="#0000FF"><b>if </b></font><font color="#808080">(</font><font color="#000080">strcmp</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">,</font><font color="#800000">&quot;&quot;</font><font color="#808080">)!=</font><font color="#FF0000">0</font><font color="#808080">) {
        </font><font color="#000080">strcpy</font><font color="#808080">(</font><font color="#000080">tVenda</font><font color="#808080">.</font><font color="#000080">isbn</font><font color="#808080">, [</font><font color="#000080">self trim</font><font color="#808080">: [</font><font color="#000080">self copy</font><font color="#808080">: </font><font color="#000080">slinha</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#FF0000">13</font><font color="#808080">]]);
        </font><font color="#0000FF"><b>if </b></font><font color="#808080">([</font><font color="#000080">self validaISBN</font><font color="#808080">: </font><font color="#000080">tVenda</font><font color="#808080">.</font><font color="#000080">isbn</font><font color="#808080">]==</font><font color="#000080">YES</font><font color="#808080">) {
          [</font><font color="#000080">self mostrarDados</font><font color="#808080">: </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">];
          </font><font color="#000080">strcpy</font><font color="#808080">(</font><font color="#000080">tLivro</font><font color="#808080">.</font><font color="#000080">qtdestoque</font><font color="#808080">, [</font><font color="#000080">self trim</font><font color="#808080">: [</font><font color="#000080">self copy</font><font color="#808080">: </font><font color="#000080">slinha</font><font color="#808080">,</font><font color="#FF0000">134</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">]]);
          </font><font color="#000080">nQtdEstoque </font><font color="#808080">= </font><font color="#000080">atoi</font><font color="#808080">(</font><font color="#000080">tLivro</font><font color="#808080">.</font><font color="#000080">qtdestoque</font><font color="#808080">);
          </font><font color="#0000FF"><b>if </b></font><font color="#808080">(</font><font color="#000080">nQtdEstoque </font><font color="#808080">&gt; </font><font color="#FF0000">0</font><font color="#808080">) {
             </font><font color="#000080">nTotalPreco </font><font color="#808080">= </font><font color="#000080">nTotalPreco </font><font color="#808080">+ </font><font color="#000080">g_nPreco</font><font color="#808080">;
             <i>/* sPreco = fcvt(g_nPreco, 7, &amp;decimal, &amp;sinal); */  
             </i></font><font color="#000080">gcvt</font><font color="#808080">(</font><font color="#000080">g_nPreco</font><font color="#808080">, </font><font color="#FF0000">7</font><font color="#808080">, </font><font color="#000080">sPreco</font><font color="#808080">);
             </font><font color="#000080">strcpy</font><font color="#808080">(</font><font color="#000080">tVenda</font><font color="#808080">.</font><font color="#000080">precovenda</font><font color="#808080">, </font><font color="#000080">sPreco</font><font color="#808080">);
             </font><font color="#000080">g_SalvarInclusao </font><font color="#808080">= </font><font color="#000080">NO</font><font color="#808080">;
             [</font><font color="#000080">self subMenu</font><font color="#808080">: </font><font color="#FF0000">14</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">];
             </font><font color="#0000FF"><b>if </b></font><font color="#808080">(</font><font color="#000080">g_SalvarInclusao</font><font color="#808080">==</font><font color="#000080">YES</font><font color="#808080">) {
                </font><font color="#000080">slinha </font><font color="#808080">= [</font><font color="#000080">self pesqArq</font><font color="#808080">: </font><font color="#000080">tfLivro</font><font color="#808080">, </font><font color="#000080">tVenda</font><font color="#808080">.</font><font color="#000080">isbn</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">13</font><font color="#808080">, 
                            [</font><font color="#000080">self tamReg</font><font color="#808080">: </font><font color="#000080">opLivro</font><font color="#808080">]];
                </font><font color="#0000FF"><b>if </b></font><font color="#808080">(</font><font color="#000080">strcmp</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">,</font><font color="#800000">&quot;&quot;</font><font color="#808080">)!=</font><font color="#FF0000">0</font><font color="#808080">) {
                   </font><font color="#000080">nQtdEstoque </font><font color="#808080">= </font><font color="#000080">nQtdEstoque</font><font color="#808080">-</font><font color="#FF0000">1</font><font color="#808080">;
                   </font><font color="#000080">strcpy</font><font color="#808080">(</font><font color="#000080">tLivro</font><font color="#808080">.</font><font color="#000080">qtdestoque</font><font color="#808080">, 
                          [</font><font color="#000080">self itoa</font><font color="#808080">: </font><font color="#000080">nQtdEstoque</font><font color="#808080">,</font><font color="#000080">tLivro</font><font color="#808080">.</font><font color="#000080">qtdestoque</font><font color="#808080">, </font><font color="#FF0000">10</font><font color="#808080">]);
                   </font><font color="#000080">slinha</font><font color="#808080">= (</font><font color="#000080">STR</font><font color="#808080">) </font><font color="#000080">strcat</font><font color="#808080">([</font><font color="#000080">self copy</font><font color="#808080">: </font><font color="#000080">slinha</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font><font color="#FF0000">133</font><font color="#808080">],
                                        [</font><font color="#000080">self esp</font><font color="#808080">: </font><font color="#000080">tLivro</font><font color="#808080">.</font><font color="#000080">qtdestoque</font><font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">]);
                   [</font><font color="#000080">self escreveArq</font><font color="#808080">: </font><font color="#000080">tfLivro</font><font color="#808080">, </font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">, </font><font color="#800000">&quot;&quot;</font><font color="#808080">];
                }
             }
             </font><font color="#000080">nCont</font><font color="#808080">++;
          } </font><font color="#0000FF"><b>else </b></font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;%s\n&quot;</font><font color="#808080">,</font><font color="#000080">MSG_SEMESTOQUE</font><font color="#808080">);
        } </font><font color="#0000FF"><b>else </b></font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;%s\n&quot;</font><font color="#808080">,</font><font color="#000080">MSG_ISBNINV</font><font color="#808080">);
      }
    }
    </font><font color="#000080">nTotalPreco </font><font color="#808080">= </font><font color="#000080">atof</font><font color="#808080">(</font><font color="#000080">sTotalPreco</font><font color="#808080">);
    </font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;Total de %s%f\n&quot;</font><font color="#808080">,[</font><font color="#000080">self rotulo</font><font color="#808080">: </font><font color="#000080">sreg</font><font color="#808080">,</font><font color="#FF0000">4</font><font color="#808080">],</font><font color="#000080">nTotalPreco</font><font color="#808080">);
    </font><font color="#000080">free</font><font color="#808080">(</font><font color="#000080">sTotalPreco</font><font color="#808080">);
    </font><font color="#000080">free</font><font color="#808080">(</font><font color="#000080">sPreco</font><font color="#808080">);
  }
} </font><font color="#0000FF"><b>else if </b></font><font color="#808080">(</font><font color="#000080">sacao</font><font color="#808080">==</font><font color="#000080">opExcluir</font><font color="#808080">) {
  </font><font color="#0000FF"><b>if </b></font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">==</font><font color="#000080">opLivroAss</font><font color="#808080">) {
     [</font><font color="#000080">self ExcluirRegLigados</font><font color="#808080">: </font><font color="#000080">tfLivroAss</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">13</font><font color="#808080">, </font><font color="#000080">sCodigo</font><font color="#808080">];
  } </font><font color="#0000FF"><b>else if </b></font><font color="#808080">(</font><font color="#000080">sreg</font><font color="#808080">==</font><font color="#000080">opLivroAut</font><font color="#808080">) {
     [</font><font color="#000080">self ExcluirRegLigados</font><font color="#808080">: </font><font color="#000080">tfLivroAut</font><font color="#808080">, </font><font color="#000080">sreg</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">13</font><font color="#808080">, </font><font color="#000080">sCodigo</font><font color="#808080">];
  }
}
</font><font color="#0000FF"><b>return </b></font><font color="#000080">self</font><font color="#808080">;
}
<i>/*------------------------------------------------------------------------------
Realiza a exclus&atilde;o dos arquivos de liga&ccedil;&atilde;o.
sArq - o arquivo de liga&ccedil;&atilde;o
sreg - o tipo de arquivo de liga&ccedil;&atilde;o
nPosChave - a posicao inicial da chave dentro do registro
nTamChave - o tamanho da chave dentro do registro
sChave - a chave a ser excluida
------------------------------------------------------------------------------*/
</i>- </font><font color="#000080">ExcluirRegLigados</font><font color="#808080">: (</font><font color="#000080">FILE</font><font color="#808080">*) </font><font color="#000080">sArq</font><font color="#808080">, ...
{ 
  </font><font color="#0000FF"><b>enum </b></font><font color="#000080">ctArqs sreg</font><font color="#808080">;
  </font><font color="#0000FF"><b>int </b></font><font color="#000080">nPosChave</font><font color="#808080">, </font><font color="#000080">nTamChave</font><font color="#808080">;
  </font><font color="#000080">STR sChave</font><font color="#808080">, </font><font color="#000080">slinha</font><font color="#808080">, </font><font color="#000080">sCodigo</font><font color="#808080">;

</font><font color="#000080">va_list lparams</font><font color="#808080">;
</font><font color="#000080">va_start</font><font color="#808080">(</font><font color="#000080">lparams</font><font color="#808080">, </font><font color="#000080">sArq</font><font color="#808080">);
</font><font color="#000080">sreg </font><font color="#808080">= </font><font color="#000080">va_arg</font><font color="#808080">(</font><font color="#000080">lparams</font><font color="#808080">,</font><font color="#0000FF"><b>enum </b></font><font color="#000080">ctArqs</font><font color="#808080">);
</font><font color="#000080">nPosChave </font><font color="#808080">= </font><font color="#000080">va_arg</font><font color="#808080">(</font><font color="#000080">lparams</font><font color="#808080">,</font><font color="#0000FF"><b>int</b></font><font color="#808080">);
</font><font color="#000080">nTamChave </font><font color="#808080">= </font><font color="#000080">va_arg</font><font color="#808080">(</font><font color="#000080">lparams</font><font color="#808080">,</font><font color="#0000FF"><b>int</b></font><font color="#808080">);
</font><font color="#000080">sChave </font><font color="#808080">= </font><font color="#000080">va_arg</font><font color="#808080">(</font><font color="#000080">lparams</font><font color="#808080">,</font><font color="#000080">STR</font><font color="#808080">);
</font><font color="#000080">va_end</font><font color="#808080">(</font><font color="#000080">lparams</font><font color="#808080">);

</font><font color="#000080">slinha </font><font color="#808080">= [</font><font color="#000080">self alocaString</font><font color="#808080">: </font><font color="#000080">TAM_MAX_REG</font><font color="#808080">];

  </font><font color="#000080">fseek</font><font color="#808080">(</font><font color="#000080">sArq</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#000080">SEEK_SET</font><font color="#808080">);
  </font><font color="#0000FF"><b>while </b></font><font color="#808080">(!</font><font color="#000080">feof</font><font color="#808080">(</font><font color="#000080">sArq</font><font color="#808080">)) {
    </font><font color="#000080">fread</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,([</font><font color="#000080">self tamReg</font><font color="#808080">: </font><font color="#000080">sreg</font><font color="#808080">] + </font><font color="#000080">TAM_CRLF</font><font color="#808080">),</font><font color="#000080">sArq</font><font color="#808080">);
    </font><font color="#000080">sCodigo </font><font color="#808080">= [</font><font color="#000080">self trim</font><font color="#808080">: [</font><font color="#000080">self copy</font><font color="#808080">: </font><font color="#000080">slinha</font><font color="#808080">,</font><font color="#000080">nPosChave</font><font color="#808080">,</font><font color="#000080">nTamChave</font><font color="#808080">]];
    </font><font color="#0000FF"><b>if </b></font><font color="#808080">(</font><font color="#000080">strcmp</font><font color="#808080">(</font><font color="#000080">sCodigo</font><font color="#808080">,</font><font color="#000080">sChave</font><font color="#808080">)==</font><font color="#FF0000">0</font><font color="#808080">)
       [</font><font color="#000080">self btnAcao</font><font color="#808080">: </font><font color="#000080">sreg</font><font color="#808080">,</font><font color="#000080">opConfirmaExclusao</font><font color="#808080">];
  }
</font><font color="#000080">free</font><font color="#808080">(</font><font color="#000080">slinha</font><font color="#808080">);
</font><font color="#0000FF"><b>return </b></font><font color="#000080">self</font><font color="#808080">;
}
</font><font color="#FF00FF">@</font><font color="#000080">end
</font><font color="#808080"><i>/*------------------------------------------------------------------------------
Parte inicial do c&oacute;digo
------------------------------------------------------------------------------*/
</i></font><font color="#0000FF"><b>int </b></font><font color="#000080">main</font><font color="#808080">(</font><font color="#0000FF"><b>int </b></font><font color="#000080">argc</font><font color="#808080">, </font><font color="#0000FF"><b>char </b></font><font color="#808080">*</font><font color="#000080">argv</font><font color="#808080">[]) {
  </font><font color="#000080">id livrus</font><font color="#808080">;
  </font><font color="#000080">BOOL bopcao</font><font color="#808080">;
  </font><font color="#0000FF"><b>char </b></font><font color="#000080">opmenu</font><font color="#808080">;
 
  <i>//Livrus *livrus = [[Livrus alloc] init];
 </i></font><font color="#000080">livrus </font><font color="#808080">= [</font><font color="#000080">Livrus </font><font color="#0000FF"><b>new</b></font><font color="#808080">];
 [</font><font color="#000080">livrus constantes</font><font color="#808080">];

 </font><font color="#0000FF"><b>if </b></font><font color="#808080">((</font><font color="#000080">argc </font><font color="#808080">&gt; </font><font color="#FF0000">0</font><font color="#808080">) &amp;&amp; (</font><font color="#000080">strcmp</font><font color="#808080">(</font><font color="#000080">argv</font><font color="#808080">[</font><font color="#FF0000">0</font><font color="#808080">],</font><font color="#800000">&quot;-cria&quot;</font><font color="#808080">)==</font><font color="#FF0000">0</font><font color="#808080">))
   [</font><font color="#000080">livrus abrecriaArqs</font><font color="#808080">: </font><font color="#000080">NO</font><font color="#808080">];
 </font><font color="#0000FF"><b>else </b></font><font color="#808080">{
   [</font><font color="#000080">livrus frmSplash</font><font color="#808080">];
   [</font><font color="#000080">livrus abrecriaArqs</font><font color="#808080">: </font><font color="#000080">YES</font><font color="#808080">];
   </font><font color="#0000FF"><b>if </b></font><font color="#808080">([</font><font color="#000080">livrus frmLogin</font><font color="#808080">]==</font><font color="#000080">YES</font><font color="#808080">) {
     </font><font color="#000080">bopcao </font><font color="#808080">= </font><font color="#000080">YES</font><font color="#808080">;
     </font><font color="#0000FF"><b>while</b></font><font color="#808080">(</font><font color="#000080">bopcao</font><font color="#808080">==</font><font color="#000080">YES</font><font color="#808080">) {
       [</font><font color="#000080">livrus menu</font><font color="#808080">: </font><font color="#FF0000">1</font><font color="#808080">];
       </font><font color="#000080">fscanf</font><font color="#808080">(</font><font color="#000080">stdin</font><font color="#808080">, </font><font color="#800000">&quot;%s&quot;</font><font color="#808080">, &amp;</font><font color="#000080">opmenu</font><font color="#808080">);
       </font><font color="#0000FF"><b>if </b></font><font color="#808080">((</font><font color="#000080">opmenu</font><font color="#808080">==</font>'C'<font color="#808080">) || (</font><font color="#000080">opmenu</font><font color="#808080">==</font>'c'<font color="#808080">)) [</font><font color="#000080">livrus usaMenu</font><font color="#808080">: </font><font color="#FF0000">1</font><font color="#808080">];
       </font><font color="#0000FF"><b>else if </b></font><font color="#808080">((</font><font color="#000080">opmenu</font><font color="#808080">==</font>'P'<font color="#808080">) || (</font><font color="#000080">opmenu</font><font color="#808080">==</font>'p'<font color="#808080">)) [</font><font color="#000080">livrus usaMenu</font><font color="#808080">: </font><font color="#FF0000">2</font><font color="#808080">];
       </font><font color="#0000FF"><b>else if </b></font><font color="#808080">((</font><font color="#000080">opmenu</font><font color="#808080">==</font>'V'<font color="#808080">) || (</font><font color="#000080">opmenu</font><font color="#808080">==</font>'v'<font color="#808080">)) [</font><font color="#000080">livrus usaMenu</font><font color="#808080">: </font><font color="#FF0000">3</font><font color="#808080">];
       </font><font color="#0000FF"><b>else if </b></font><font color="#808080">((</font><font color="#000080">opmenu</font><font color="#808080">==</font>'O'<font color="#808080">) || (</font><font color="#000080">opmenu</font><font color="#808080">==</font>'o'<font color="#808080">)) [</font><font color="#000080">livrus usaMenu</font><font color="#808080">: </font><font color="#FF0000">4</font><font color="#808080">];
       </font><font color="#0000FF"><b>else </b></font><font color="#000080">printf</font><font color="#808080">(</font><font color="#800000">&quot;%s\n&quot;</font><font color="#808080">,[</font><font color="#000080">livrus retMSGERRO</font><font color="#808080">]);
       </font><font color="#000080">fflush</font><font color="#808080">(</font><font color="#000080">stdin</font><font color="#808080">);
       </font><font color="#000080">bopcao </font><font color="#808080">= </font><font color="#000080">YES</font><font color="#808080">;
     }
   } </font><font color="#0000FF"><b>else </b></font><font color="#808080">{
     [</font><font color="#000080">livrus fechaArqs</font><font color="#808080">];
     [</font><font color="#000080">livrus free</font><font color="#808080">];
     </font><font color="#000080">exit</font><font color="#808080">(</font><font color="#FF0000">0</font><font color="#808080">);
   }
 }
 [</font><font color="#000080">livrus free</font><font color="#808080">];
 </font><font color="#0000FF"><b>return </b></font><font color="#FF0000">0</font><font color="#808080">;
}
</font></font>
</code></pre>
</body>
</html>