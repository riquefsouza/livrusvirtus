<html>
<head>
<title>Livrus Virtus - Console - Ada</title>
</head>
<!-- Generated by ConTEXT HTML exporter -->
<body text="#000000" bgcolor="#FFFFFF">
<pre>
<code><font  face="Courier New"><font color="#FF0000">-- ----------------------------------------------------------------------------
-- Sistema integrante do projeto Livrus Virtus.
-- Todos os direitos reservados para Henrique F. de Souza.
-- Vers&atilde;o programada na linguagem ada.
-- ----------------------------------------------------------------------------
-- program Livrus

</font><font color="#0000FF">with </font>System<font color="#808080">.</font>Val_Int<font color="#808080">; </font><font color="#0000FF">use </font>System<font color="#808080">.</font>Val_Int<font color="#808080">;
</font><font color="#0000FF">with </font>System<font color="#808080">.</font>Val_Real<font color="#808080">; </font><font color="#0000FF">use </font>System<font color="#808080">.</font>Val_Real<font color="#808080">;
</font><font color="#0000FF">with </font>Ada<font color="#808080">.</font>Command_Line<font color="#808080">; </font><font color="#0000FF">use </font>Ada<font color="#808080">.</font>Command_Line<font color="#808080">;
</font><font color="#0000FF">with </font>Ada<font color="#808080">.</font>Text_IO<font color="#808080">; </font><font color="#0000FF">use </font>Ada<font color="#808080">.</font>Text_IO<font color="#808080">;
</font><font color="#0000FF">with </font>Text_IO<font color="#808080">; </font><font color="#0000FF">use </font>Text_IO<font color="#808080">;
</font><font color="#0000FF">with </font>Direct_IO<font color="#808080">;
</font><font color="#0000FF">with </font>Ada<font color="#808080">.</font>Integer_Text_IO<font color="#808080">; </font><font color="#0000FF">use </font>Ada<font color="#808080">.</font>Integer_Text_IO<font color="#808080">;
</font><font color="#0000FF">with </font>Ada<font color="#808080">.</font>FLoat_Text_IO<font color="#808080">; </font><font color="#0000FF">use </font>Ada<font color="#808080">.</font>Float_Text_IO<font color="#808080">;
</font><font color="#0000FF">with </font>Ada<font color="#808080">.</font>Characters<font color="#808080">; </font><font color="#0000FF">use </font>Ada<font color="#808080">.</font>Characters<font color="#808080">;
</font><font color="#0000FF">with </font>Ada<font color="#808080">.</font>Strings<font color="#808080">; </font><font color="#0000FF">use </font>Ada<font color="#808080">.</font>Strings<font color="#808080">;
</font><font color="#0000FF">with </font>Ada<font color="#808080">.</font>Strings<font color="#808080">.</font>Unbounded<font color="#808080">; </font><font color="#0000FF">use </font>Ada<font color="#808080">.</font>Strings<font color="#808080">.</font>Unbounded<font color="#808080">;
</font><font color="#0000FF">with </font>Ada<font color="#808080">.</font>Calendar<font color="#808080">; </font><font color="#0000FF">use </font>Ada<font color="#808080">.</font>Calendar<font color="#808080">;

</font><font color="#0000FF">procedure </font>livrus <font color="#0000FF">is

  subtype </font>ustring <font color="#0000FF">is </font>unbounded_string<font color="#808080">;

  </font><font color="#0000FF">type </font>regAssunto <font color="#0000FF">is record
     </font>codigo<font color="#808080">: </font>ustring<font color="#808080">; </font><font color="#FF0000">-- 10
     </font>assunto<font color="#808080">: </font>ustring<font color="#808080">; </font><font color="#FF0000">-- 30
  </font><font color="#0000FF">end record</font><font color="#808080">;
  </font><font color="#0000FF">type </font>regAutor <font color="#0000FF">is record
   </font>codigo<font color="#808080">: </font>ustring<font color="#808080">; </font><font color="#FF0000">-- 10
   </font>autor<font color="#808080">: </font>ustring<font color="#808080">; </font><font color="#FF0000">-- 30
  </font><font color="#0000FF">end record</font><font color="#808080">;
  </font><font color="#0000FF">type </font>regEditora <font color="#0000FF">is record
   </font>codigo<font color="#808080">: </font>ustring<font color="#808080">; </font><font color="#FF0000">-- 10
   </font>editora<font color="#808080">: </font>ustring<font color="#808080">; </font><font color="#FF0000">-- 50
  </font><font color="#0000FF">end record</font><font color="#808080">;
  </font><font color="#0000FF">type </font>regIdioma <font color="#0000FF">is record
   </font>codigo<font color="#808080">: </font>ustring<font color="#808080">; </font><font color="#FF0000">-- 10
   </font>idioma<font color="#808080">: </font>ustring<font color="#808080">; </font><font color="#FF0000">-- 20
  </font><font color="#0000FF">end record</font><font color="#808080">;
  </font><font color="#0000FF">type </font>regUsuario <font color="#0000FF">is record
   </font>login<font color="#808080">: </font>ustring<font color="#808080">; </font><font color="#FF0000">-- 10
   </font>senha<font color="#808080">: </font>ustring<font color="#808080">; </font><font color="#FF0000">-- 10
  </font><font color="#0000FF">end record</font><font color="#808080">;
  </font><font color="#0000FF">type </font>regPais <font color="#0000FF">is record
   </font>codigo<font color="#808080">: </font>ustring<font color="#808080">; </font><font color="#FF0000">-- 3
   </font>pais<font color="#808080">: </font>ustring<font color="#808080">; </font><font color="#FF0000">-- 50
  </font><font color="#0000FF">end record</font><font color="#808080">;
  </font><font color="#0000FF">type </font>regProfissao <font color="#0000FF">is record
   </font>codigo<font color="#808080">: </font>ustring<font color="#808080">; </font><font color="#FF0000">-- 10
   </font>profissao<font color="#808080">: </font>ustring<font color="#808080">; </font><font color="#FF0000">-- 50
  </font><font color="#0000FF">end record</font><font color="#808080">;
  </font><font color="#0000FF">type </font>regLivro <font color="#0000FF">is record
   </font>isbn<font color="#808080">: </font>ustring<font color="#808080">; </font><font color="#FF0000">-- 13
   </font>titulo<font color="#808080">: </font>ustring<font color="#808080">; </font><font color="#FF0000">-- 50
   </font>edicao<font color="#808080">: </font>ustring<font color="#808080">; </font><font color="#FF0000">-- 10
   </font>anopubli<font color="#808080">: </font>ustring<font color="#808080">; </font><font color="#FF0000">-- 10
   </font>codeditora<font color="#808080">: </font>ustring<font color="#808080">; </font><font color="#FF0000">-- 10
   </font>volume<font color="#808080">: </font>ustring<font color="#808080">; </font><font color="#FF0000">-- 10
   </font>codidioma<font color="#808080">: </font>ustring<font color="#808080">; </font><font color="#FF0000">-- 10
   </font>npaginas<font color="#808080">: </font>ustring<font color="#808080">; </font><font color="#FF0000">-- 10
   </font>preco<font color="#808080">: </font>ustring<font color="#808080">; </font><font color="#FF0000">-- 10
   </font>qtdestoque<font color="#808080">: </font>ustring<font color="#808080">; </font><font color="#FF0000">-- 10
  </font><font color="#0000FF">end record</font><font color="#808080">;
  </font><font color="#0000FF">type </font>regLivroAss <font color="#0000FF">is record
   </font>isbn<font color="#808080">: </font>ustring<font color="#808080">; </font><font color="#FF0000">-- 13
   </font>codassunto<font color="#808080">: </font>ustring<font color="#808080">; </font><font color="#FF0000">-- 10
  </font><font color="#0000FF">end record</font><font color="#808080">;
  </font><font color="#0000FF">type </font>regLivroAut <font color="#0000FF">is record
   </font>isbn<font color="#808080">: </font>ustring<font color="#808080">; </font><font color="#FF0000">-- 13
   </font>codautor<font color="#808080">: </font>ustring<font color="#808080">; </font><font color="#FF0000">-- 10
  </font><font color="#0000FF">end record</font><font color="#808080">;
  </font><font color="#0000FF">type </font>regCliente <font color="#0000FF">is record
   </font>cpf<font color="#808080">: </font>ustring<font color="#808080">; </font><font color="#FF0000">-- 14
   </font>nome<font color="#808080">: </font>ustring<font color="#808080">; </font><font color="#FF0000">-- 30
   </font>email<font color="#808080">: </font>ustring<font color="#808080">; </font><font color="#FF0000">-- 30
   </font>identidade<font color="#808080">: </font>ustring<font color="#808080">; </font><font color="#FF0000">-- 10
   </font>sexo<font color="#808080">: </font>ustring<font color="#808080">; </font><font color="#FF0000">-- 1
   </font>telefone<font color="#808080">: </font>ustring<font color="#808080">; </font><font color="#FF0000">-- 17
   </font>dtnascimento<font color="#808080">: </font>ustring<font color="#808080">; </font><font color="#FF0000">-- 10
   </font>codendereco<font color="#808080">: </font>ustring<font color="#808080">; </font><font color="#FF0000">-- 10
   </font>codpais<font color="#808080">: </font>ustring<font color="#808080">; </font><font color="#FF0000">-- 3
   </font>codprofissao<font color="#808080">: </font>ustring<font color="#808080">; </font><font color="#FF0000">-- 10
  </font><font color="#0000FF">end record</font><font color="#808080">;
  </font><font color="#0000FF">type </font>regEndereco <font color="#0000FF">is record
   </font>codigo<font color="#808080">: </font>ustring<font color="#808080">; </font><font color="#FF0000">-- 10
   </font>logradouro<font color="#808080">: </font>ustring<font color="#808080">; </font><font color="#FF0000">-- 40
   </font>bairro<font color="#808080">: </font>ustring<font color="#808080">; </font><font color="#FF0000">-- 15
   </font>cep<font color="#808080">: </font>ustring<font color="#808080">; </font><font color="#FF0000">-- 8
   </font>cidade<font color="#808080">: </font>ustring<font color="#808080">; </font><font color="#FF0000">-- 30
   </font>estado<font color="#808080">: </font>ustring<font color="#808080">; </font><font color="#FF0000">-- 20
  </font><font color="#0000FF">end record</font><font color="#808080">;
  </font><font color="#0000FF">type </font>regVenda <font color="#0000FF">is record
   </font>dthrvenda<font color="#808080">: </font>ustring<font color="#808080">; </font><font color="#FF0000">-- (19) data/hora da venda dd/mm/yyyy hh:mm:ss 
   </font>cpf<font color="#808080">: </font>ustring<font color="#808080">; </font><font color="#FF0000">-- 14
   </font>isbn<font color="#808080">: </font>ustring<font color="#808080">; </font><font color="#FF0000">-- 13
   </font>precovenda<font color="#808080">: </font>ustring<font color="#808080">; </font><font color="#FF0000">-- 10
  </font><font color="#0000FF">end record</font><font color="#808080">;

  </font><font color="#0000FF">type </font>ctTipo <font color="#0000FF">is </font><font color="#808080">(</font>opTexto<font color="#808080">, </font>opNumero<font color="#808080">, </font>opData<font color="#808080">, </font>opDataHora<font color="#808080">, </font>opSenha<font color="#808080">);
  </font><font color="#0000FF">type </font>ctArqs <font color="#0000FF">is </font><font color="#808080">(</font>opAssunto<font color="#808080">, </font>opAutor<font color="#808080">, </font>opEditora<font color="#808080">, </font>opEndereco<font color="#808080">, </font>opIdioma<font color="#808080">, </font>opPais<font color="#808080">,
                </font>opProfissao<font color="#808080">, </font>opCliente<font color="#808080">, </font>opLivro<font color="#808080">, </font>opLivroAss<font color="#808080">, </font>opLivroAut<font color="#808080">,
                </font>opUsuario<font color="#808080">, </font>opVenda<font color="#808080">);
  </font><font color="#0000FF">type </font>ctAcao <font color="#0000FF">is </font><font color="#808080">(</font>opNovo<font color="#808080">, </font>opAlterar<font color="#808080">, </font>opPesquisar<font color="#808080">, </font>opSalvarInclusao<font color="#808080">,
              </font>opSalvarAlteracao<font color="#808080">, </font>opExcluir<font color="#808080">, </font>opConfirmaExclusao<font color="#808080">, </font>opListarTodos<font color="#808080">);
  </font><font color="#0000FF">type </font>ctTArqs <font color="#0000FF">is </font><font color="#808080">(</font>taAssunto<font color="#808080">, </font>taAutor<font color="#808080">, </font>taEditora<font color="#808080">, </font>taEndereco<font color="#808080">, </font>taIdioma<font color="#808080">, </font>taPais<font color="#808080">,
                </font>taProfissao<font color="#808080">, </font>taCliente<font color="#808080">, </font>taLivro<font color="#808080">, </font>taLivroAss<font color="#808080">, </font>taLivroAut<font color="#808080">,
                </font>taUsuario<font color="#808080">, </font>taVenda<font color="#808080">);

</font><font color="#FF0000">-- constantes 

  </font>CRLF<font color="#808080">: </font><font color="#0000FF">constant </font>string <font color="#808080">:= </font>Character<font color="#808080">'</font>val<font color="#808080">(</font><font color="#FF00FF">13</font><font color="#808080">) &amp; </font>Character<font color="#808080">'</font>val<font color="#808080">(</font><font color="#FF00FF">10</font><font color="#808080">); </font><font color="#FF0000">-- windows --
  </font>TAM_CRLF<font color="#808080">: </font><font color="#0000FF">constant </font>integer <font color="#808080">:= </font><font color="#FF00FF">2</font><font color="#808080">;
</font><font color="#FF0000">--  CRLF: constant string := Character'val(10);
--  TAM_CRLF: constant integer := 1; -- unix --
--  CRLF: string := constant Character'val(13);
--  TAM_CRLF: constant integer := 1; -- macintosh --

  </font>QTD_MAX_LINHA<font color="#808080">: </font><font color="#0000FF">constant </font>integer <font color="#808080">:= </font><font color="#FF00FF">18</font><font color="#808080">;
  </font>TAM_MAX_STR<font color="#808080">: </font><font color="#0000FF">constant </font>integer <font color="#808080">:= </font><font color="#FF00FF">255</font><font color="#808080">;

  </font>MSG_ARQERRO<font color="#808080">: </font><font color="#0000FF">constant </font>string <font color="#808080">:= </font><font color="#008080">&quot;Erro: O arquivo n&atilde;o pode ser aberto.&quot;</font><font color="#808080">;
  </font>MSG_ERRO<font color="#808080">: </font><font color="#0000FF">constant </font>string <font color="#808080">:= </font><font color="#008080">&quot;Erro: op&ccedil;&atilde;o inv&aacute;lida digite de novo&quot;</font><font color="#808080">;
  </font>MSG_OPCAO<font color="#808080">: </font><font color="#0000FF">constant </font>string <font color="#808080">:= </font><font color="#008080">&quot;Escolha uma op&ccedil;&atilde;o: &quot;</font><font color="#808080">;
  </font>MSG_PRESS<font color="#808080">: </font><font color="#0000FF">constant </font>string <font color="#808080">:= </font><font color="#008080">&quot;pressione para continuar...&quot;</font><font color="#808080">;

  </font>MSG_REGINC<font color="#808080">: </font><font color="#0000FF">constant </font>string <font color="#808080">:= </font><font color="#008080">&quot;registro incluido!&quot;</font><font color="#808080">;
  </font>MSG_REGNINC<font color="#808080">: </font><font color="#0000FF">constant </font>string <font color="#808080">:= </font><font color="#008080">&quot;registro n&atilde;o incluido!&quot;</font><font color="#808080">;
  </font>MSG_REGALT<font color="#808080">: </font><font color="#0000FF">constant </font>string <font color="#808080">:= </font><font color="#008080">&quot;registro alterado!&quot;</font><font color="#808080">;
  </font>MSG_REGNALT<font color="#808080">: </font><font color="#0000FF">constant </font>string <font color="#808080">:= </font><font color="#008080">&quot;registro n&atilde;o alterado!&quot;</font><font color="#808080">;
  </font>MSG_REGEXC<font color="#808080">: </font><font color="#0000FF">constant </font>string <font color="#808080">:= </font><font color="#008080">&quot;registro excluido!&quot;</font><font color="#808080">;
  </font>MSG_REGNEXC<font color="#808080">: </font><font color="#0000FF">constant </font>string <font color="#808080">:= </font><font color="#008080">&quot;registro n&atilde;o excluido!&quot;</font><font color="#808080">;
  </font>MSG_REGEXST<font color="#808080">: </font><font color="#0000FF">constant </font>string <font color="#808080">:= </font><font color="#008080">&quot;registro j&aacute; existe!&quot;</font><font color="#808080">;

  </font>MSG_NUMINV<font color="#808080">: </font><font color="#0000FF">constant </font>string <font color="#808080">:= </font><font color="#008080">&quot;N&uacute;mero inv&aacute;lido ou menor do que 1!&quot;</font><font color="#808080">;
  </font>MSG_DATAINV<font color="#808080">: </font><font color="#0000FF">constant </font>string <font color="#808080">:= </font><font color="#008080">&quot;Data inv&aacute;lida!, formato correto (dd/mm/yyyy)&quot;</font><font color="#808080">;
  </font>MSG_DTHRINV<font color="#808080">: </font><font color="#0000FF">constant </font>string <font color="#808080">:= </font><font color="#008080">&quot;Data/hora inv&aacute;lida!, formato correto (dd/mm/yyyy hh:mm:ss)&quot;</font><font color="#808080">;
  </font>MSG_ISBNINV<font color="#808080">: </font><font color="#0000FF">constant </font>string <font color="#808080">:= </font><font color="#008080">&quot;ISBN inv&aacute;lido!&quot;</font><font color="#808080">;
  </font>MSG_CPFINV<font color="#808080">: </font><font color="#0000FF">constant </font>string <font color="#808080">:= </font><font color="#008080">&quot;CPF inv&aacute;lido!&quot;</font><font color="#808080">;
  </font>MSG_SENCONFERE<font color="#808080">: </font><font color="#0000FF">constant </font>string <font color="#808080">:= </font><font color="#008080">&quot;senha n&atilde;o confere com a senha atual!&quot;</font><font color="#808080">;
  </font>MSG_SENCONFIRM<font color="#808080">: </font><font color="#0000FF">constant </font>string <font color="#808080">:= </font><font color="#008080">&quot;nova senha n&atilde;o confere com a senha confirmada!&quot;</font><font color="#808080">;
  </font>MSG_LOGINENCON<font color="#808080">: </font><font color="#0000FF">constant </font>string <font color="#808080">:= </font><font color="#008080">&quot;login n&atilde;o encontrado!&quot;</font><font color="#808080">;
  </font>MSG_SEMESTOQUE<font color="#808080">: </font><font color="#0000FF">constant </font>string <font color="#808080">:= </font><font color="#008080">&quot;livro n&atilde;o existe no estoque!&quot;</font><font color="#808080">;

  </font>ARQ_ASSUNTO<font color="#808080">: </font><font color="#0000FF">constant </font>string <font color="#808080">:= </font><font color="#008080">&quot;assunto.dat&quot;</font><font color="#808080">;
  </font>ARQ_AUTOR<font color="#808080">: </font><font color="#0000FF">constant </font>string <font color="#808080">:= </font><font color="#008080">&quot;autor.dat&quot;</font><font color="#808080">;
  </font>ARQ_EDITORA<font color="#808080">: </font><font color="#0000FF">constant </font>string <font color="#808080">:= </font><font color="#008080">&quot;editora.dat&quot;</font><font color="#808080">;
  </font>ARQ_IDIOMA<font color="#808080">: </font><font color="#0000FF">constant </font>string <font color="#808080">:= </font><font color="#008080">&quot;idioma.dat&quot;</font><font color="#808080">;
  </font>ARQ_USUARIO<font color="#808080">: </font><font color="#0000FF">constant </font>string <font color="#808080">:= </font><font color="#008080">&quot;usuario.dat&quot;</font><font color="#808080">;
  </font>ARQ_PAIS<font color="#808080">: </font><font color="#0000FF">constant </font>string <font color="#808080">:= </font><font color="#008080">&quot;pais.dat&quot;</font><font color="#808080">;
  </font>ARQ_PROFISSAO<font color="#808080">: </font><font color="#0000FF">constant </font>string <font color="#808080">:= </font><font color="#008080">&quot;profiss.dat&quot;</font><font color="#808080">;
  </font>ARQ_LIVRO<font color="#808080">: </font><font color="#0000FF">constant </font>string <font color="#808080">:= </font><font color="#008080">&quot;livro.dat&quot;</font><font color="#808080">;
  </font>ARQ_LIVASS<font color="#808080">: </font><font color="#0000FF">constant </font>string <font color="#808080">:= </font><font color="#008080">&quot;livroass.dat&quot;</font><font color="#808080">;
  </font>ARQ_LIVAUT<font color="#808080">: </font><font color="#0000FF">constant </font>string <font color="#808080">:= </font><font color="#008080">&quot;livroaut.dat&quot;</font><font color="#808080">;
  </font>ARQ_CLIENTE<font color="#808080">: </font><font color="#0000FF">constant </font>string <font color="#808080">:= </font><font color="#008080">&quot;cliente.dat&quot;</font><font color="#808080">;
  </font>ARQ_ENDERECO<font color="#808080">: </font><font color="#0000FF">constant </font>string <font color="#808080">:= </font><font color="#008080">&quot;endereco.dat&quot;</font><font color="#808080">;
  </font>ARQ_VENDA<font color="#808080">: </font><font color="#0000FF">constant </font>string <font color="#808080">:= </font><font color="#008080">&quot;venda.dat&quot;</font><font color="#808080">;

  </font>TAM_ASSUNTO<font color="#808080">: </font><font color="#0000FF">constant </font>integer <font color="#808080">:= </font><font color="#FF00FF">40 </font><font color="#808080">+ </font>TAM_CRLF<font color="#808080">;
  </font>TAM_AUTOR<font color="#808080">: </font><font color="#0000FF">constant </font>integer <font color="#808080">:= </font><font color="#FF00FF">40 </font><font color="#808080">+ </font>TAM_CRLF<font color="#808080">;
  </font>TAM_EDITORA<font color="#808080">: </font><font color="#0000FF">constant </font>integer <font color="#808080">:= </font><font color="#FF00FF">60 </font><font color="#808080">+ </font>TAM_CRLF<font color="#808080">;
  </font>TAM_IDIOMA<font color="#808080">: </font><font color="#0000FF">constant </font>integer <font color="#808080">:= </font><font color="#FF00FF">30 </font><font color="#808080">+ </font>TAM_CRLF<font color="#808080">;
  </font>TAM_USUARIO<font color="#808080">: </font><font color="#0000FF">constant </font>integer <font color="#808080">:= </font><font color="#FF00FF">20 </font><font color="#808080">+ </font>TAM_CRLF<font color="#808080">;
  </font>TAM_PAIS<font color="#808080">: </font><font color="#0000FF">constant </font>integer <font color="#808080">:= </font><font color="#FF00FF">53 </font><font color="#808080">+ </font>TAM_CRLF<font color="#808080">;
  </font>TAM_PROFISSAO<font color="#808080">: </font><font color="#0000FF">constant </font>integer <font color="#808080">:= </font><font color="#FF00FF">60 </font><font color="#808080">+ </font>TAM_CRLF<font color="#808080">;
  </font>TAM_LIVRO<font color="#808080">: </font><font color="#0000FF">constant </font>integer <font color="#808080">:= </font><font color="#FF00FF">143 </font><font color="#808080">+ </font>TAM_CRLF<font color="#808080">;
  </font>TAM_LIVASS<font color="#808080">: </font><font color="#0000FF">constant </font>integer <font color="#808080">:= </font><font color="#FF00FF">23 </font><font color="#808080">+ </font>TAM_CRLF<font color="#808080">;
  </font>TAM_LIVAUT<font color="#808080">: </font><font color="#0000FF">constant </font>integer <font color="#808080">:= </font><font color="#FF00FF">23 </font><font color="#808080">+ </font>TAM_CRLF<font color="#808080">;
  </font>TAM_CLIENTE<font color="#808080">: </font><font color="#0000FF">constant </font>integer <font color="#808080">:= </font><font color="#FF00FF">135 </font><font color="#808080">+ </font>TAM_CRLF<font color="#808080">;
  </font>TAM_ENDERECO<font color="#808080">: </font><font color="#0000FF">constant </font>integer <font color="#808080">:= </font><font color="#FF00FF">123 </font><font color="#808080">+ </font>TAM_CRLF<font color="#808080">;
  </font>TAM_VENDA<font color="#808080">: </font><font color="#0000FF">constant </font>integer <font color="#808080">:= </font><font color="#FF00FF">56 </font><font color="#808080">+ </font>TAM_CRLF<font color="#808080">;

</font><font color="#FF0000">-- variaveis globais --
 </font>bopcao<font color="#808080">: </font>boolean<font color="#808080">:=</font>false<font color="#808080">;
 </font>opmenu<font color="#808080">: </font>character<font color="#808080">;
 </font>g_nPosChave<font color="#808080">, </font>g_nTamChave<font color="#808080">: </font>integer<font color="#808080">:=</font><font color="#FF00FF">0</font><font color="#808080">;
 </font>g_nPreco<font color="#808080">: </font>float <font color="#808080">:= </font><font color="#FF00FF">0</font><font color="#808080">.</font><font color="#FF00FF">0</font><font color="#808080">;
 </font>g_SalvarInclusao<font color="#808080">: </font>boolean<font color="#808080">:=</font>false<font color="#808080">;

 </font>tAssunto<font color="#808080">: </font>regAssunto<font color="#808080">;
 </font>tAutor<font color="#808080">: </font>regAutor<font color="#808080">;
 </font>tEditora<font color="#808080">: </font>regEditora<font color="#808080">;
 </font>tIdioma<font color="#808080">: </font>regIdioma<font color="#808080">;
 </font>tEndereco<font color="#808080">: </font>regEndereco<font color="#808080">;
 </font>tPais<font color="#808080">: </font>regPais<font color="#808080">;
 </font>tProfissao<font color="#808080">: </font>regProfissao<font color="#808080">;
 </font>tLivro<font color="#808080">: </font>regLivro<font color="#808080">;
 </font>tLivroAss<font color="#808080">: </font>regLivroAss<font color="#808080">;
 </font>tLivroAut<font color="#808080">: </font>regLivroAut<font color="#808080">;
 </font>tCliente<font color="#808080">: </font>regCliente<font color="#808080">;
 </font>tUsuario<font color="#808080">: </font>regUsuario<font color="#808080">;
 </font>tVenda<font color="#808080">: </font>regVenda<font color="#808080">;

 </font><font color="#0000FF">subtype </font>blocoAssunto <font color="#0000FF">is </font>String<font color="#808080">(</font><font color="#FF00FF">1 </font><font color="#808080">.. </font>TAM_ASSUNTO<font color="#808080">);
 </font><font color="#0000FF">package </font>AssuntoIO <font color="#0000FF">is new </font>Direct_IO<font color="#808080">(</font>blocoAssunto<font color="#808080">); </font><font color="#0000FF">use </font>AssuntoIO<font color="#808080">;
 </font>tfAssunto <font color="#808080">: </font>AssuntoIO<font color="#808080">.</font>File_Type<font color="#808080">; 
 </font>blAssunto <font color="#808080">: </font>blocoAssunto<font color="#808080">;

 </font><font color="#0000FF">subtype </font>blocoAutor <font color="#0000FF">is </font>String<font color="#808080">(</font><font color="#FF00FF">1 </font><font color="#808080">.. </font>TAM_AUTOR<font color="#808080">);
 </font><font color="#0000FF">package </font>AutorIO <font color="#0000FF">is new </font>Direct_IO<font color="#808080">(</font>blocoAutor<font color="#808080">); </font><font color="#0000FF">use </font>AutorIO<font color="#808080">;
 </font>tfAutor <font color="#808080">: </font>AutorIO<font color="#808080">.</font>File_Type<font color="#808080">; 
 </font>blAutor <font color="#808080">: </font>blocoAutor<font color="#808080">;

 </font><font color="#0000FF">subtype </font>blocoEditora <font color="#0000FF">is </font>String<font color="#808080">(</font><font color="#FF00FF">1 </font><font color="#808080">.. </font>TAM_EDITORA<font color="#808080">);
 </font><font color="#0000FF">package </font>EditoraIO <font color="#0000FF">is new </font>Direct_IO<font color="#808080">(</font>blocoEditora<font color="#808080">); </font><font color="#0000FF">use </font>EditoraIO<font color="#808080">;
 </font>tfEditora <font color="#808080">: </font>EditoraIO<font color="#808080">.</font>File_Type<font color="#808080">;
 </font>blEditora <font color="#808080">: </font>blocoEditora<font color="#808080">;

 </font><font color="#0000FF">subtype </font>blocoIdioma <font color="#0000FF">is </font>String<font color="#808080">(</font><font color="#FF00FF">1 </font><font color="#808080">.. </font>TAM_IDIOMA<font color="#808080">);
 </font><font color="#0000FF">package </font>IdiomaIO <font color="#0000FF">is new </font>Direct_IO<font color="#808080">(</font>blocoIdioma<font color="#808080">); </font><font color="#0000FF">use </font>IdiomaIO<font color="#808080">;
 </font>tfIdioma <font color="#808080">: </font>IdiomaIO<font color="#808080">.</font>File_Type<font color="#808080">;
 </font>blIdioma <font color="#808080">: </font>blocoIdioma<font color="#808080">;

 </font><font color="#0000FF">subtype </font>blocoEndereco <font color="#0000FF">is </font>String<font color="#808080">(</font><font color="#FF00FF">1 </font><font color="#808080">.. </font>TAM_ENDERECO<font color="#808080">);
 </font><font color="#0000FF">package </font>EnderecoIO <font color="#0000FF">is new </font>Direct_IO<font color="#808080">(</font>blocoEndereco<font color="#808080">); </font><font color="#0000FF">use </font>EnderecoIO<font color="#808080">;
 </font>tfEndereco <font color="#808080">: </font>EnderecoIO<font color="#808080">.</font>File_Type<font color="#808080">;
 </font>blEndereco <font color="#808080">: </font>blocoEndereco<font color="#808080">;

 </font><font color="#0000FF">subtype </font>blocoPais <font color="#0000FF">is </font>String<font color="#808080">(</font><font color="#FF00FF">1 </font><font color="#808080">.. </font>TAM_PAIS<font color="#808080">);
 </font><font color="#0000FF">package </font>PaisIO <font color="#0000FF">is new </font>Direct_IO<font color="#808080">(</font>blocoPais<font color="#808080">); </font><font color="#0000FF">use </font>PaisIO<font color="#808080">;
 </font>tfPais <font color="#808080">: </font>PaisIO<font color="#808080">.</font>File_Type<font color="#808080">;
 </font>blPais <font color="#808080">: </font>blocoPais<font color="#808080">;

 </font><font color="#0000FF">subtype </font>blocoProfissao <font color="#0000FF">is </font>String<font color="#808080">(</font><font color="#FF00FF">1 </font><font color="#808080">.. </font>TAM_PROFISSAO<font color="#808080">);
 </font><font color="#0000FF">package </font>ProfissaoIO <font color="#0000FF">is new </font>Direct_IO<font color="#808080">(</font>blocoProfissao<font color="#808080">); </font><font color="#0000FF">use </font>ProfissaoIO<font color="#808080">;
 </font>tfProfissao <font color="#808080">: </font>ProfissaoIO<font color="#808080">.</font>File_Type<font color="#808080">;
 </font>blProfissao <font color="#808080">: </font>blocoProfissao<font color="#808080">;

 </font><font color="#0000FF">subtype </font>blocoLivro <font color="#0000FF">is </font>String<font color="#808080">(</font><font color="#FF00FF">1 </font><font color="#808080">.. </font>TAM_LIVRO<font color="#808080">);
 </font><font color="#0000FF">package </font>LivroIO <font color="#0000FF">is new </font>Direct_IO<font color="#808080">(</font>blocoLivro<font color="#808080">); </font><font color="#0000FF">use </font>LivroIO<font color="#808080">;
 </font>tfLivro <font color="#808080">: </font>LivroIO<font color="#808080">.</font>File_Type<font color="#808080">;
 </font>blLivro <font color="#808080">: </font>blocoLivro<font color="#808080">;

 </font><font color="#0000FF">subtype </font>blocoLivroAss <font color="#0000FF">is </font>String<font color="#808080">(</font><font color="#FF00FF">1 </font><font color="#808080">.. </font>TAM_LIVASS<font color="#808080">);
 </font><font color="#0000FF">package </font>LivroAssIO <font color="#0000FF">is new </font>Direct_IO<font color="#808080">(</font>blocoLivroAss<font color="#808080">); </font><font color="#0000FF">use </font>LivroAssIO<font color="#808080">;
 </font>tfLivroAss <font color="#808080">: </font>LivroAssIO<font color="#808080">.</font>File_Type<font color="#808080">;
 </font>blLivroAss <font color="#808080">: </font>blocoLivroAss<font color="#808080">;

 </font><font color="#0000FF">subtype </font>blocoLivroAut <font color="#0000FF">is </font>String<font color="#808080">(</font><font color="#FF00FF">1 </font><font color="#808080">.. </font>TAM_LIVAUT<font color="#808080">);
 </font><font color="#0000FF">package </font>LivroAutIO <font color="#0000FF">is new </font>Direct_IO<font color="#808080">(</font>blocoLivroAut<font color="#808080">); </font><font color="#0000FF">use </font>LivroAutIO<font color="#808080">;
 </font>tfLivroAut <font color="#808080">: </font>LivroAutIO<font color="#808080">.</font>File_Type<font color="#808080">;
 </font>blLivroAut <font color="#808080">: </font>blocoLivroAut<font color="#808080">;

 </font><font color="#0000FF">subtype </font>blocoCliente <font color="#0000FF">is </font>String<font color="#808080">(</font><font color="#FF00FF">1 </font><font color="#808080">.. </font>TAM_CLIENTE<font color="#808080">);
 </font><font color="#0000FF">package </font>ClienteIO <font color="#0000FF">is new </font>Direct_IO<font color="#808080">(</font>blocoCliente<font color="#808080">); </font><font color="#0000FF">use </font>ClienteIO<font color="#808080">;
 </font>tfCliente <font color="#808080">: </font>ClienteIO<font color="#808080">.</font>File_Type<font color="#808080">;
 </font>blCliente <font color="#808080">: </font>blocoCliente<font color="#808080">;

 </font><font color="#0000FF">subtype </font>blocoUsuario <font color="#0000FF">is </font>String<font color="#808080">(</font><font color="#FF00FF">1 </font><font color="#808080">.. </font>TAM_USUARIO<font color="#808080">);
 </font><font color="#0000FF">package </font>UsuarioIO <font color="#0000FF">is new </font>Direct_IO<font color="#808080">(</font>blocoUsuario<font color="#808080">); </font><font color="#0000FF">use </font>UsuarioIO<font color="#808080">;
 </font>tfUsuario <font color="#808080">: </font>UsuarioIO<font color="#808080">.</font>File_Type<font color="#808080">;
 </font>blUsuario <font color="#808080">: </font>blocoUsuario<font color="#808080">;

 </font><font color="#0000FF">subtype </font>blocoVenda <font color="#0000FF">is </font>String<font color="#808080">(</font><font color="#FF00FF">1 </font><font color="#808080">.. </font>TAM_VENDA<font color="#808080">);
 </font><font color="#0000FF">package </font>VendaIO <font color="#0000FF">is new </font>Direct_IO<font color="#808080">(</font>blocoVenda<font color="#808080">); </font><font color="#0000FF">use </font>VendaIO<font color="#808080">;
 </font>tfVenda <font color="#808080">: </font>VendaIO<font color="#808080">.</font>File_Type<font color="#808080">;
 </font>blVenda <font color="#808080">: </font>blocoVenda<font color="#808080">;

</font><font color="#FF0000">-- Rotinas b&aacute;sicas ------------------------------------------------------------
</font><font color="#0000FF">procedure </font>get_line<font color="#808080">(</font>sEntrada <font color="#808080">: </font><font color="#0000FF">out </font>ustring<font color="#808080">);
</font><font color="#0000FF">procedure </font>itoa <font color="#808080">(</font>valor <font color="#808080">: </font><font color="#0000FF">in </font>integer<font color="#808080">; </font>s <font color="#808080">: </font><font color="#0000FF">in out </font>string<font color="#808080">);
</font><font color="#0000FF">function </font>itam<font color="#808080">(</font>it<font color="#808080">: </font><font color="#0000FF">in </font>integer<font color="#808080">) </font><font color="#0000FF">return </font>integer<font color="#808080">;
</font><font color="#0000FF">procedure </font>itostr<font color="#808080">(</font>num<font color="#808080">: </font><font color="#0000FF">in </font>integer<font color="#808080">; </font>str<font color="#808080">: </font><font color="#0000FF">in out </font>ustring<font color="#808080">);
</font><font color="#0000FF">function </font>Repete<font color="#808080">(</font>sTexto<font color="#808080">: </font><font color="#0000FF">in </font>string<font color="#808080">; </font>nQtd<font color="#808080">: </font><font color="#0000FF">in </font>integer<font color="#808080">) </font><font color="#0000FF">return </font>ustring<font color="#808080">;
</font><font color="#0000FF">function </font>copy<font color="#808080">(</font>str<font color="#808080">: </font><font color="#0000FF">in </font>ustring<font color="#808080">; </font>ini<font color="#808080">,</font>tam<font color="#808080">: </font><font color="#0000FF">in </font>integer<font color="#808080">) </font><font color="#0000FF">return </font>ustring<font color="#808080">;
</font><font color="#0000FF">function </font>esp<font color="#808080">(</font>sTexto<font color="#808080">: </font><font color="#0000FF">in </font>ustring<font color="#808080">; </font>nTam<font color="#808080">: </font><font color="#0000FF">in </font>integer<font color="#808080">) </font><font color="#0000FF">return </font>ustring<font color="#808080">;
</font><font color="#0000FF">function </font>zeros<font color="#808080">(</font>stexto<font color="#808080">: </font>ustring<font color="#808080">; </font>ntam<font color="#808080">: </font><font color="#0000FF">in </font>integer<font color="#808080">) </font><font color="#0000FF">return </font>ustring<font color="#808080">;
</font><font color="#0000FF">function </font>strRelativa<font color="#808080">(</font>sTexto<font color="#808080">, </font>sChave<font color="#808080">: </font><font color="#0000FF">in </font>ustring<font color="#808080">) </font><font color="#0000FF">return </font>boolean<font color="#808080">;
</font><font color="#0000FF">function </font>modulo11<font color="#808080">(</font>svalor<font color="#808080">: </font><font color="#0000FF">in </font>ustring<font color="#808080">; </font>ndig<font color="#808080">: </font><font color="#0000FF">in </font>integer<font color="#808080">) </font><font color="#0000FF">return </font>integer<font color="#808080">;
</font><font color="#0000FF">function </font>validaCPF<font color="#808080">(</font>cpf<font color="#808080">: </font><font color="#0000FF">in </font>ustring<font color="#808080">) </font><font color="#0000FF">return </font>boolean<font color="#808080">;
</font><font color="#0000FF">function </font>validaISBN<font color="#808080">(</font>isbn<font color="#808080">: </font><font color="#0000FF">in </font>ustring<font color="#808080">) </font><font color="#0000FF">return </font>boolean<font color="#808080">;
</font><font color="#0000FF">function </font>digitaSenha<font color="#808080">(</font>sRotulo<font color="#808080">: </font><font color="#0000FF">in </font>ustring<font color="#808080">; </font>nTamSenha<font color="#808080">: </font><font color="#0000FF">in </font>integer<font color="#808080">) </font><font color="#0000FF">return </font>ustring<font color="#808080">;
</font><font color="#0000FF">function </font>validaFloat<font color="#808080">(</font>sNumero<font color="#808080">: </font><font color="#0000FF">in </font>string<font color="#808080">) </font><font color="#0000FF">return </font>float<font color="#808080">;
</font><font color="#0000FF">function </font>validaNumero<font color="#808080">(</font>sRotulo<font color="#808080">, </font>sNumero<font color="#808080">: </font><font color="#0000FF">in </font>ustring<font color="#808080">) </font><font color="#0000FF">return </font>ustring<font color="#808080">;
</font><font color="#0000FF">function </font>validaDataHora<font color="#808080">(</font>sRotulo<font color="#808080">, </font>sDataHora<font color="#808080">: </font><font color="#0000FF">in </font>ustring<font color="#808080">; 
         </font>bSoData<font color="#808080">: </font><font color="#0000FF">in </font>boolean<font color="#808080">) </font><font color="#0000FF">return </font>ustring<font color="#808080">;
</font><font color="#0000FF">function </font>retDataHora <font color="#0000FF">return </font>ustring<font color="#808080">;

</font><font color="#FF0000">-- Rotinas de manipula&ccedil;&atilde;o de arquivos -----------------------------------------
</font><font color="#0000FF">function </font>tamArq<font color="#808080">(</font>sArq<font color="#808080">: </font><font color="#0000FF">in </font>ctTArqs<font color="#808080">) </font><font color="#0000FF">return </font>integer<font color="#808080">;
</font><font color="#0000FF">function </font>fimArq<font color="#808080">(</font>sArq<font color="#808080">: </font><font color="#0000FF">in </font>ctTArqs<font color="#808080">) </font><font color="#0000FF">return </font>boolean<font color="#808080">;
</font><font color="#0000FF">function </font>posArq<font color="#808080">(</font>sArq<font color="#808080">: </font><font color="#0000FF">in </font>ctTArqs<font color="#808080">) </font><font color="#0000FF">return </font>integer<font color="#808080">;
</font><font color="#0000FF">procedure </font>seekArq<font color="#808080">(</font>sArq<font color="#808080">: </font><font color="#0000FF">in </font>ctTArqs<font color="#808080">; </font>npos<font color="#808080">: </font><font color="#0000FF">in </font>integer<font color="#808080">);
</font><font color="#0000FF">function </font>lerArq<font color="#808080">(</font>sArq<font color="#808080">: </font><font color="#0000FF">in </font>ctTArqs<font color="#808080">) </font><font color="#0000FF">return </font>ustring<font color="#808080">;
</font><font color="#0000FF">procedure </font>gravarArq<font color="#808080">(</font>sArq<font color="#808080">: </font><font color="#0000FF">in </font>ctTArqs<font color="#808080">; </font>sTexto<font color="#808080">: </font><font color="#0000FF">in </font>ustring<font color="#808080">);
</font><font color="#0000FF">procedure </font>abrecriaArqs<font color="#808080">(</font>bAbre<font color="#808080">: </font><font color="#0000FF">in </font>boolean<font color="#808080">);
</font><font color="#0000FF">procedure </font>fechaArqs<font color="#808080">;
</font><font color="#0000FF">function </font>pesqArq<font color="#808080">(</font>sArq<font color="#808080">: </font><font color="#0000FF">in </font>ctTArqs<font color="#808080">; </font>sChave<font color="#808080">: </font><font color="#0000FF">in </font>ustring<font color="#808080">; </font>nPosChave<font color="#808080">,
         </font>nTamChave<font color="#808080">, </font>nTamLinha<font color="#808080">: </font><font color="#0000FF">in </font>integer<font color="#808080">) </font><font color="#0000FF">return </font>ustring<font color="#808080">;
</font><font color="#0000FF">procedure </font>pesqLinhaExcluida<font color="#808080">(</font>sArq<font color="#808080">: </font><font color="#0000FF">in </font>ctTArqs<font color="#808080">; </font>nTamLinha<font color="#808080">: </font><font color="#0000FF">in </font>integer<font color="#808080">);
</font><font color="#0000FF">function </font>pesqMaxCod<font color="#808080">(</font>sArq<font color="#808080">: </font><font color="#0000FF">in </font>ctTArqs<font color="#808080">; </font>nPosChave<font color="#808080">,
        </font>nTamChave<font color="#808080">, </font>nTamLinha<font color="#808080">: </font><font color="#0000FF">in </font>integer<font color="#808080">) </font><font color="#0000FF">return </font>ustring<font color="#808080">;
</font><font color="#0000FF">procedure </font>escreveArq<font color="#808080">(</font>sArq<font color="#808080">: </font><font color="#0000FF">in </font>ctTArqs<font color="#808080">; </font>sTexto<font color="#808080">: </font><font color="#0000FF">in </font>ustring<font color="#808080">;
</font>	sMsgAcerto<font color="#808080">, </font>sMsgErro<font color="#808080">: </font><font color="#0000FF">in </font>string<font color="#808080">);

</font><font color="#FF0000">-- Rotinas de implementa&ccedil;&atilde;o do sistema e de interface -------------------------
</font><font color="#0000FF">function </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">: </font><font color="#0000FF">in </font>ctArqs<font color="#808080">) </font><font color="#0000FF">return </font>ustring<font color="#808080">;
</font><font color="#0000FF">function </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">: </font><font color="#0000FF">in </font>ctArqs<font color="#808080">) </font><font color="#0000FF">return </font>integer<font color="#808080">;
</font><font color="#0000FF">function </font>rotulo<font color="#808080">(</font>sreg<font color="#808080">: </font><font color="#0000FF">in </font>ctArqs<font color="#808080">; </font>nNum<font color="#808080">: </font><font color="#0000FF">in </font>integer<font color="#808080">) </font><font color="#0000FF">return </font>ustring<font color="#808080">;
</font><font color="#0000FF">function </font>ContinuaSN<font color="#808080">(</font>nlinha<font color="#808080">, </font>nQtdLinha<font color="#808080">: </font><font color="#0000FF">in </font>integer<font color="#808080">) </font><font color="#0000FF">return </font>boolean<font color="#808080">;
</font><font color="#0000FF">function </font>ListarTodos<font color="#808080">(</font>sArq<font color="#808080">: </font><font color="#0000FF">in </font>ctTArqs<font color="#808080">; </font>sreg<font color="#808080">: </font><font color="#0000FF">in </font>ctArqs<font color="#808080">; </font>sChave<font color="#808080">: </font><font color="#0000FF">in </font>ustring<font color="#808080">;
         </font>nPosChave<font color="#808080">, </font>nTamChave<font color="#808080">, </font>nTamLinha<font color="#808080">, </font>nQtdLinha<font color="#808080">: </font><font color="#0000FF">in </font>integer<font color="#808080">;
         </font>bPesqRelativa<font color="#808080">: </font><font color="#0000FF">in </font>boolean<font color="#808080">) </font><font color="#0000FF">return </font>boolean<font color="#808080">;
</font><font color="#0000FF">procedure </font>ListarRegLigados<font color="#808080">(</font>sArq1<font color="#808080">: </font><font color="#0000FF">in </font>ctTArqs<font color="#808080">; </font>sreg1<font color="#808080">: </font><font color="#0000FF">in </font>ctArqs<font color="#808080">; </font>nPosChave1<font color="#808080">,
          </font>nTamChave1<font color="#808080">, </font>nPosChave2<font color="#808080">, </font>nTamChave2<font color="#808080">: </font><font color="#0000FF">in </font>integer<font color="#808080">; </font>sChave<font color="#808080">: </font><font color="#0000FF">in </font>ustring<font color="#808080">;
     </font>sArq2<font color="#808080">: </font><font color="#0000FF">in </font>ctTArqs<font color="#808080">; </font>sreg2<font color="#808080">: </font><font color="#0000FF">in </font>ctArqs<font color="#808080">; </font>nPosChave3<font color="#808080">, </font>nQtdLinha<font color="#808080">: </font><font color="#0000FF">in </font>integer<font color="#808080">);
</font><font color="#0000FF">function </font>validaEntrada<font color="#808080">(</font>sArq<font color="#808080">: </font><font color="#0000FF">in </font>ctTArqs<font color="#808080">; </font>sreg<font color="#808080">: </font><font color="#0000FF">in </font>ctArqs<font color="#808080">; </font>nTexto<font color="#808080">: </font><font color="#0000FF">in </font>integer<font color="#808080">;
        </font>sEntrada<font color="#808080">: </font><font color="#0000FF">in </font>ustring<font color="#808080">; </font>nTentativas<font color="#808080">: </font><font color="#0000FF">in </font>integer<font color="#808080">;
        </font>bPesqRelativa<font color="#808080">: </font><font color="#0000FF">in </font>boolean<font color="#808080">; </font>bTipoEntrada<font color="#808080">: </font><font color="#0000FF">in </font>ctTipo<font color="#808080">) </font><font color="#0000FF">return </font>ustring<font color="#808080">;
</font><font color="#0000FF">procedure </font>frmSplash<font color="#808080">;
</font><font color="#0000FF">procedure </font>frmSobre<font color="#808080">;
</font><font color="#0000FF">function </font>frmLogin <font color="#0000FF">return </font>boolean<font color="#808080">;
</font><font color="#0000FF">procedure </font>menu<font color="#808080">(</font>num<font color="#808080">: </font><font color="#0000FF">in </font>integer<font color="#808080">);
</font><font color="#0000FF">procedure </font>frmCadastros<font color="#808080">(</font>sreg<font color="#808080">: </font><font color="#0000FF">in </font>ctArqs<font color="#808080">; </font>sacao<font color="#808080">: </font><font color="#0000FF">in </font>ctAcao<font color="#808080">);
</font><font color="#0000FF">procedure </font>frmConsultas<font color="#808080">(</font>sreg<font color="#808080">: </font><font color="#0000FF">in </font>ctArqs<font color="#808080">; </font>sacao<font color="#808080">: </font><font color="#0000FF">in </font>ctAcao<font color="#808080">);
</font><font color="#0000FF">procedure </font>frmAlterarSenha<font color="#808080">;
</font><font color="#0000FF">procedure </font>btnAcao<font color="#808080">(</font>sreg<font color="#808080">: </font><font color="#0000FF">in </font>ctArqs<font color="#808080">; </font>sacao<font color="#808080">: </font><font color="#0000FF">in </font>ctAcao<font color="#808080">);
</font><font color="#0000FF">procedure </font>subMenu<font color="#808080">(</font>nmenu<font color="#808080">: </font><font color="#0000FF">in </font>integer<font color="#808080">; </font>sreg<font color="#808080">: </font><font color="#0000FF">in </font>ctArqs<font color="#808080">);
</font><font color="#0000FF">procedure </font>usaMenu<font color="#808080">(</font>num<font color="#808080">: </font><font color="#0000FF">in </font>integer<font color="#808080">);
</font><font color="#0000FF">procedure </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">: </font><font color="#0000FF">in </font>ctArqs<font color="#808080">; </font>slinha<font color="#808080">: </font><font color="#0000FF">in </font>ustring<font color="#808080">; </font>nOpcao<font color="#808080">: </font><font color="#0000FF">in </font>integer<font color="#808080">);
</font><font color="#0000FF">procedure </font>mostrarSubDados<font color="#808080">(</font>sreg<font color="#808080">, </font>ssubreg<font color="#808080">: </font><font color="#0000FF">in </font>ctArqs<font color="#808080">; </font>bSoMostrar<font color="#808080">: </font><font color="#0000FF">in </font>boolean<font color="#808080">);
</font><font color="#0000FF">procedure </font>frmCadLigados<font color="#808080">(</font>sreg<font color="#808080">: </font><font color="#0000FF">in </font>ctArqs<font color="#808080">; </font>sacao<font color="#808080">: </font><font color="#0000FF">in </font>ctAcao<font color="#808080">; </font>sCodigo<font color="#808080">: </font><font color="#0000FF">in </font>ustring<font color="#808080">);
</font><font color="#0000FF">procedure </font>ExcluirRegLigados<font color="#808080">(</font>sArq<font color="#808080">: </font><font color="#0000FF">in </font>ctTArqs<font color="#808080">; </font>sreg<font color="#808080">: </font><font color="#0000FF">in </font>ctArqs<font color="#808080">; </font>nPosChave<font color="#808080">,
          </font>nTamChave<font color="#808080">: </font><font color="#0000FF">in </font>integer<font color="#808080">; </font>sChave<font color="#808080">: </font><font color="#0000FF">in </font>ustring<font color="#808080">);

</font><font color="#0000FF">function </font>U<font color="#808080">(</font>origem <font color="#808080">: </font><font color="#0000FF">in </font>String<font color="#808080">) </font><font color="#0000FF">return </font>Unbounded_String
<font color="#0000FF">renames </font>To_Unbounded_String<font color="#808080">;

</font><font color="#0000FF">function </font>S<font color="#808080">(</font>origem <font color="#808080">: </font><font color="#0000FF">in </font>UString<font color="#808080">) </font><font color="#0000FF">return </font>String
<font color="#0000FF">renames </font>To_String<font color="#808080">;

</font><font color="#0000FF">procedure </font>put<font color="#808080">(</font>origem<font color="#808080">: </font><font color="#0000FF">in </font>UString<font color="#808080">) </font><font color="#0000FF">is
begin
 </font>put<font color="#808080">(</font>S<font color="#808080">(</font>origem<font color="#808080">));
</font><font color="#0000FF">end </font>put<font color="#808080">;

</font><font color="#0000FF">procedure </font>put_line<font color="#808080">(</font>origem<font color="#808080">: </font><font color="#0000FF">in </font>UString<font color="#808080">) </font><font color="#0000FF">is
begin
 </font>put_line<font color="#808080">(</font>S<font color="#808080">(</font>origem<font color="#808080">));
</font><font color="#0000FF">end </font>put_line<font color="#808080">;

</font><font color="#0000FF">procedure </font>get_line<font color="#808080">(</font>sEntrada<font color="#808080">: </font><font color="#0000FF">out </font>character<font color="#808080">) </font><font color="#0000FF">is
</font>slocal<font color="#808080">: </font>string<font color="#808080">(</font><font color="#FF00FF">1</font><font color="#808080">..</font>TAM_MAX_STR<font color="#808080">);
</font>nultimo<font color="#808080">: </font>Natural<font color="#808080">:=</font><font color="#FF00FF">1</font><font color="#808080">;
</font><font color="#0000FF">begin
</font>get_line<font color="#808080">(</font>slocal<font color="#808080">,</font>nultimo<font color="#808080">);
</font>sEntrada<font color="#808080">:=</font>slocal<font color="#808080">(</font><font color="#FF00FF">1</font><font color="#808080">);
</font><font color="#0000FF">end</font><font color="#808080">;

</font><font color="#FF0000">-- ----------------------------------------------------------------------------
-- le uma ustring do teclado
-- sEntrada o valor a ser retornado
-- ----------------------------------------------------------------------------
</font><font color="#0000FF">procedure </font>get_line<font color="#808080">(</font>sEntrada <font color="#808080">: </font><font color="#0000FF">out </font>ustring<font color="#808080">) </font><font color="#0000FF">is
    
  function </font>mais_entrada <font color="#0000FF">return </font>Unbounded_String <font color="#0000FF">is
     </font>entrada<font color="#808080">: </font>String<font color="#808080">(</font><font color="#FF00FF">1</font><font color="#808080">..</font>TAM_MAX_STR<font color="#808080">);
     </font>nultimo<font color="#808080">: </font>Natural<font color="#808080">;
  </font><font color="#0000FF">begin
     </font>Get_Line<font color="#808080">(</font>Current_Input<font color="#808080">, </font>entrada<font color="#808080">, </font>nultimo<font color="#808080">);
     </font><font color="#0000FF">if </font>nultimo <font color="#808080">&lt; </font>entrada<font color="#808080">'</font>Last <font color="#0000FF">then
        return </font>U<font color="#808080">(</font>entrada<font color="#808080">(</font><font color="#FF00FF">1</font><font color="#808080">..</font>nultimo<font color="#808080">));
     </font><font color="#0000FF">else
        return </font>U<font color="#808080">(</font>entrada<font color="#808080">(</font><font color="#FF00FF">1</font><font color="#808080">..</font>nultimo<font color="#808080">)) &amp; </font>mais_entrada<font color="#808080">;
     </font><font color="#0000FF">end if</font><font color="#808080">;
  </font><font color="#0000FF">end </font>mais_entrada<font color="#808080">;
</font><font color="#0000FF">begin
  </font>sEntrada <font color="#808080">:= </font>mais_entrada<font color="#808080">;
</font><font color="#0000FF">end </font>get_line<font color="#808080">;

</font><font color="#FF0000">-- ----------------------------------------------------------------------------
-- converte de um valor inteiro para uma string
-- valor - indica o inteiro
-- S - a string
-- radix - o base numerica
-- ----------------------------------------------------------------------------
</font><font color="#0000FF">procedure </font>itoa <font color="#808080">(</font>valor <font color="#808080">: </font>integer<font color="#808080">; </font>s <font color="#808080">: </font><font color="#0000FF">in out </font>string<font color="#808080">) </font><font color="#0000FF">is
</font>pos <font color="#808080">: </font>integer <font color="#808080">:= </font>s<font color="#808080">'</font>first<font color="#808080">;
</font>nn<font color="#808080">, </font>digit <font color="#808080">: </font>integer<font color="#808080">;

  </font><font color="#0000FF">function </font>log10approx <font color="#808080">(</font>n <font color="#808080">: </font>integer<font color="#808080">) </font><font color="#0000FF">return </font>integer <font color="#0000FF">is
    </font>nn<font color="#808080">, </font>count <font color="#808080">: </font>integer<font color="#808080">;
  </font><font color="#0000FF">begin
    </font>nn <font color="#808080">:= </font>n<font color="#808080">;
    </font>count <font color="#808080">:= </font><font color="#FF00FF">0</font><font color="#808080">;
    </font><font color="#0000FF">while </font>nn <font color="#808080">&gt;= </font><font color="#FF00FF">10 </font><font color="#0000FF">loop
        </font>count <font color="#808080">:= </font>count <font color="#808080">+ </font><font color="#FF00FF">1</font><font color="#808080">;
        </font>nn <font color="#808080">:= </font>nn <font color="#808080">/ </font><font color="#FF00FF">10</font><font color="#808080">;
    </font><font color="#0000FF">end loop</font><font color="#808080">;
    </font><font color="#0000FF">return </font>count<font color="#808080">;
  </font><font color="#0000FF">end </font>log10approx<font color="#808080">;

</font><font color="#0000FF">begin
  if </font>valor <font color="#808080">= </font><font color="#FF00FF">0 </font><font color="#0000FF">then
       </font>s<font color="#808080">(</font>pos<font color="#808080">) := '</font><font color="#FF00FF">0</font><font color="#808080">';
       </font><font color="#0000FF">return</font><font color="#808080">;
  </font><font color="#0000FF">end if</font><font color="#808080">;
  
  </font><font color="#0000FF">if </font>valor <font color="#808080">&lt; </font><font color="#FF00FF">0 </font><font color="#0000FF">then
       </font>s<font color="#808080">(</font>pos<font color="#808080">) := '-';
       </font>pos <font color="#808080">:= </font>pos <font color="#808080">+ </font><font color="#FF00FF">1</font><font color="#808080">;
       </font>nn <font color="#808080">:= -</font>valor<font color="#808080">;
  </font><font color="#0000FF">else
       </font>nn <font color="#808080">:= </font>valor<font color="#808080">;
  </font><font color="#0000FF">end if</font><font color="#808080">;
  
  </font>pos <font color="#808080">:= </font>log10approx<font color="#808080">(</font>nn<font color="#808080">) + </font>pos<font color="#808080">;
  
  </font><font color="#0000FF">if </font>s<font color="#808080">'</font>first<font color="#808080">+</font>pos<font color="#808080">-</font><font color="#FF00FF">1 </font><font color="#808080">&gt; </font>s<font color="#808080">'</font>last <font color="#0000FF">then
       for </font>i <font color="#0000FF">in </font>s<font color="#808080">'</font>first<font color="#808080">..</font>s<font color="#808080">'</font>last <font color="#0000FF">loop
             </font>s<font color="#808080">(</font>i<font color="#808080">) := '*';
       </font><font color="#0000FF">end loop</font><font color="#808080">;
       </font><font color="#0000FF">return</font><font color="#808080">;
  </font><font color="#0000FF">end if</font><font color="#808080">;
  
  </font><font color="#0000FF">while </font>nn <font color="#808080">&gt;= </font><font color="#FF00FF">1 </font><font color="#0000FF">loop
       </font>digit <font color="#808080">:= </font>nn <font color="#0000FF">rem </font><font color="#FF00FF">10</font><font color="#808080">;
       </font>nn <font color="#808080">:= </font>nn <font color="#808080">/ </font><font color="#FF00FF">10</font><font color="#808080">;
       </font>s<font color="#808080">(</font>pos<font color="#808080">) := </font>character<font color="#808080">'</font>val<font color="#808080">(</font>character<font color="#808080">'</font>pos<font color="#808080">('</font><font color="#FF00FF">0</font><font color="#808080">') + </font>digit<font color="#808080">);
       </font>pos <font color="#808080">:= </font>pos <font color="#808080">- </font><font color="#FF00FF">1</font><font color="#808080">;
  </font><font color="#0000FF">end loop</font><font color="#808080">;
</font><font color="#0000FF">end </font>itoa<font color="#808080">;

</font><font color="#FF0000">-- ----------------------------------------------------------------------------
-- funcao que retorna o tamanho de um inteiro
-- it - indica o inteiro
-- ----------------------------------------------------------------------------
</font><font color="#0000FF">function </font>itam<font color="#808080">(</font>it<font color="#808080">: </font><font color="#0000FF">in </font>integer<font color="#808080">) </font><font color="#0000FF">return </font>integer <font color="#0000FF">is
 </font>nRet<font color="#808080">:</font>integer<font color="#808080">:=</font><font color="#FF00FF">0</font><font color="#808080">;
</font><font color="#0000FF">begin
if </font>it <font color="#808080">&lt;= </font><font color="#FF00FF">9 </font><font color="#0000FF">then
  </font>nRet<font color="#808080">:=</font><font color="#FF00FF">1</font><font color="#808080">;
</font><font color="#0000FF">end if</font><font color="#808080">;
</font><font color="#0000FF">if </font>it <font color="#808080">&lt;= </font><font color="#FF00FF">99 </font><font color="#0000FF">and </font>it <font color="#808080">&gt; </font><font color="#FF00FF">9  </font><font color="#0000FF">then
  </font>nRet<font color="#808080">:=</font><font color="#FF00FF">2</font><font color="#808080">;
</font><font color="#0000FF">end if</font><font color="#808080">;
</font><font color="#0000FF">if </font>it <font color="#808080">&lt;= </font><font color="#FF00FF">999 </font><font color="#0000FF">and </font>it <font color="#808080">&gt; </font><font color="#FF00FF">99 </font><font color="#0000FF">then
  </font>nRet<font color="#808080">:=</font><font color="#FF00FF">3</font><font color="#808080">;
</font><font color="#0000FF">end if</font><font color="#808080">;
</font><font color="#0000FF">if </font>it <font color="#808080">&lt;= </font><font color="#FF00FF">9999 </font><font color="#0000FF">and </font>it <font color="#808080">&gt; </font><font color="#FF00FF">999 </font><font color="#0000FF">then
  </font>nRet<font color="#808080">:=</font><font color="#FF00FF">4</font><font color="#808080">;
</font><font color="#0000FF">end if</font><font color="#808080">;
</font><font color="#0000FF">if </font>it <font color="#808080">&lt;= </font><font color="#FF00FF">99999 </font><font color="#0000FF">and </font>it <font color="#808080">&gt; </font><font color="#FF00FF">9999 </font><font color="#0000FF">then
  </font>nRet<font color="#808080">:=</font><font color="#FF00FF">5</font><font color="#808080">;
</font><font color="#0000FF">end if</font><font color="#808080">;
</font><font color="#0000FF">if </font>it <font color="#808080">&lt;= </font><font color="#FF00FF">999999 </font><font color="#0000FF">and </font>it <font color="#808080">&gt; </font><font color="#FF00FF">99999 </font><font color="#0000FF">then
  </font>nRet<font color="#808080">:=</font><font color="#FF00FF">6</font><font color="#808080">;
</font><font color="#0000FF">end if</font><font color="#808080">;
</font><font color="#0000FF">if </font>it <font color="#808080">&lt;= </font><font color="#FF00FF">9999999 </font><font color="#0000FF">and </font>it <font color="#808080">&gt; </font><font color="#FF00FF">999999 </font><font color="#0000FF">then
  </font>nRet<font color="#808080">:=</font><font color="#FF00FF">7</font><font color="#808080">;
</font><font color="#0000FF">end if</font><font color="#808080">;
</font><font color="#0000FF">return </font>nRet<font color="#808080">;
</font><font color="#0000FF">end </font>itam<font color="#808080">;

</font><font color="#FF0000">-- ----------------------------------------------------------------------------
-- procedimento que converte de inteiro para ustring
-- num - indica o inteiro
-- str - indica a ustring
-- ----------------------------------------------------------------------------
</font><font color="#0000FF">procedure </font>itostr<font color="#808080">(</font>num<font color="#808080">: </font><font color="#0000FF">in </font>integer<font color="#808080">;</font>str<font color="#808080">: </font><font color="#0000FF">in out </font>ustring<font color="#808080">) </font><font color="#0000FF">is
 </font>sS<font color="#808080">:</font>string<font color="#808080">(</font><font color="#FF00FF">1</font><font color="#808080">..</font>itam<font color="#808080">(</font>num<font color="#808080">));
</font><font color="#0000FF">begin
 </font>itoa<font color="#808080">(</font>num<font color="#808080">,</font>sS<font color="#808080">);
 </font>str<font color="#808080">:=</font>copy<font color="#808080">(</font>U<font color="#808080">(</font>sS<font color="#808080">),</font><font color="#FF00FF">1</font><font color="#808080">,</font>itam<font color="#808080">(</font>num<font color="#808080">));
</font><font color="#0000FF">end </font>itostr<font color="#808080">;

</font><font color="#FF0000">-- ----------------------------------------------------------------------------
-- Repete um texto um n&uacute;mero determinado de vezes.
-- sTexto - o texto a ser repetido
-- nQtd - a quantidade de vezes
-- retorna - o texto repetido
-- ----------------------------------------------------------------------------
</font><font color="#0000FF">function </font>Repete<font color="#808080">(</font>sTexto<font color="#808080">: </font><font color="#0000FF">in </font>string<font color="#808080">; </font>nQtd<font color="#808080">: </font><font color="#0000FF">in </font>integer<font color="#808080">) </font><font color="#0000FF">return </font>ustring <font color="#0000FF">is
 </font>cont <font color="#808080">: </font>integer<font color="#808080">;
 </font>Esp <font color="#808080">: </font>ustring<font color="#808080">;
</font><font color="#0000FF">begin
 </font>cont<font color="#808080">:=</font><font color="#FF00FF">1</font><font color="#808080">;
 </font>Esp<font color="#808080">:=</font>null_unbounded_string<font color="#808080">;
 </font><font color="#0000FF">while </font><font color="#808080">(</font>cont <font color="#808080">&lt;= </font>nQtd<font color="#808080">) </font><font color="#0000FF">loop
    </font>Esp<font color="#808080">:=</font>Esp <font color="#808080">&amp; </font>sTexto<font color="#808080">;
    </font>cont<font color="#808080">:=</font>cont <font color="#808080">+ </font><font color="#FF00FF">1</font><font color="#808080">;
 </font><font color="#0000FF">end loop</font><font color="#808080">;
</font><font color="#0000FF">return </font>Esp<font color="#808080">;
</font><font color="#0000FF">end </font>repete<font color="#808080">;

</font><font color="#FF0000">-- ----------------------------------------------------------------------------
-- Fun&ccedil;&atilde;o que retorna um peda&ccedil;o de uma string.
-- str - indica a string
-- ini - indica a posicao inicial do pedaco
-- tam - indica o tamanho do pedaco
-- retorna - o peda&ccedil;o da string
-- ----------------------------------------------------------------------------
</font><font color="#0000FF">function </font>copy<font color="#808080">(</font>str<font color="#808080">: </font><font color="#0000FF">in </font>ustring<font color="#808080">; </font>ini<font color="#808080">,</font>tam<font color="#808080">: </font><font color="#0000FF">in </font>integer<font color="#808080">) </font><font color="#0000FF">return </font>ustring <font color="#0000FF">is
 </font>ts<font color="#808080">:</font>integer<font color="#808080">:=</font><font color="#FF00FF">0</font><font color="#808080">;
</font><font color="#0000FF">begin
if </font>tam <font color="#808080">&gt; (</font>length<font color="#808080">(</font>str<font color="#808080">)-</font>ini<font color="#808080">)+</font><font color="#FF00FF">1 </font><font color="#0000FF">then
   </font>ts<font color="#808080">:=(</font>length<font color="#808080">(</font>str<font color="#808080">)-</font>ini<font color="#808080">)+</font><font color="#FF00FF">1</font><font color="#808080">;
</font><font color="#0000FF">else
   </font>ts<font color="#808080">:=</font>tam<font color="#808080">;
</font><font color="#0000FF">end if</font><font color="#808080">;
</font><font color="#0000FF">return </font>U<font color="#808080">(</font>slice<font color="#808080">(</font>str<font color="#808080">,</font>ini<font color="#808080">,</font>ini<font color="#808080">+</font>ts<font color="#808080">-</font><font color="#FF00FF">1</font><font color="#808080">));
</font><font color="#0000FF">end </font>copy<font color="#808080">;

</font><font color="#FF0000">-- ----------------------------------------------------------------------------
-- Coloca espa&ccedil;os em branco a mais de acordo com o tamanho m&aacute;ximo do texto.
-- sTexto - o texto
-- nTam - tamanho m&aacute;ximo do texto
-- retorna - o texto com espa&ccedil;os em branco a mais
-- ----------------------------------------------------------------------------
</font><font color="#0000FF">function </font>esp<font color="#808080">(</font>sTexto<font color="#808080">: </font><font color="#0000FF">in </font>ustring<font color="#808080">; </font>nTam<font color="#808080">: </font><font color="#0000FF">in </font>integer<font color="#808080">) </font><font color="#0000FF">return </font>ustring <font color="#0000FF">is
begin
return </font>sTexto <font color="#808080">&amp; </font>repete<font color="#808080">(</font><font color="#008080">&quot; &quot;</font><font color="#808080">,</font>nTam<font color="#808080">-</font>length<font color="#808080">(</font>sTexto<font color="#808080">));
</font><font color="#0000FF">end </font>esp<font color="#808080">;

</font><font color="#FF0000">-- ----------------------------------------------------------------------------
-- Escreve zeros na frente de um texto.
-- stexto - o texto para receber zeros a frente
-- ntam - o tamanho da string
-- retorna - o texto com o zeros antes
-- ----------------------------------------------------------------------------
</font><font color="#0000FF">function </font>zeros<font color="#808080">(</font>stexto<font color="#808080">: </font>ustring<font color="#808080">; </font>ntam<font color="#808080">: </font><font color="#0000FF">in </font>integer<font color="#808080">) </font><font color="#0000FF">return </font>ustring <font color="#0000FF">is
</font>ncont<font color="#808080">: </font>integer <font color="#808080">:= </font><font color="#FF00FF">0</font><font color="#808080">;
</font>saux<font color="#808080">: </font>ustring<font color="#808080">;
</font><font color="#0000FF">begin
  </font>saux<font color="#808080">:=</font>null_unbounded_string<font color="#808080">;
  </font><font color="#0000FF">if </font>ntam<font color="#808080">/=</font>length<font color="#808080">(</font>stexto<font color="#808080">) </font><font color="#0000FF">then
      for </font>ncont <font color="#0000FF">in </font><font color="#FF00FF">1</font><font color="#808080">..</font>ntam<font color="#808080">-</font>length<font color="#808080">(</font>stexto<font color="#808080">) </font><font color="#0000FF">loop
        </font>saux<font color="#808080">:=</font>saux <font color="#808080">&amp; </font><font color="#008080">&quot;0&quot;</font><font color="#808080">;
      </font><font color="#0000FF">end loop</font><font color="#808080">;
  </font><font color="#0000FF">end if</font><font color="#808080">;
  </font><font color="#0000FF">return </font>saux <font color="#808080">&amp; </font>stexto<font color="#808080">;
</font><font color="#0000FF">end </font>zeros<font color="#808080">;

</font><font color="#FF0000">-- ----------------------------------------------------------------------------
-- Faz uma pesquisa relativa de um texto atrav&eacute;s de um valor chave.
-- sTexto - o texto
-- sChave - a chave a ser pesquisada
-- retorna - se achou ou n&atilde;o a chave dentro do texto
-- ----------------------------------------------------------------------------
</font><font color="#0000FF">function </font>strRelativa<font color="#808080">(</font>sTexto<font color="#808080">, </font>sChave<font color="#808080">: </font><font color="#0000FF">in </font>ustring<font color="#808080">) </font><font color="#0000FF">return </font>boolean <font color="#0000FF">is
    </font>nCont<font color="#808080">, </font>nTamChave<font color="#808080">, </font>nTamTexto<font color="#808080">: </font>integer<font color="#808080">;
    </font>bret<font color="#808080">: </font>boolean<font color="#808080">;
    </font>sPedaco<font color="#808080">: </font>ustring<font color="#808080">;
</font><font color="#0000FF">begin
</font>bret<font color="#808080">:=</font>false<font color="#808080">;
</font>nCont<font color="#808080">:=</font><font color="#FF00FF">1</font><font color="#808080">;
</font>nTamChave<font color="#808080">:=</font>length<font color="#808080">(</font>sChave<font color="#808080">);
</font>nTamTexto<font color="#808080">:=</font>length<font color="#808080">(</font>sTexto<font color="#808080">);
</font><font color="#0000FF">if </font>nTamChave <font color="#808080">&lt;= </font>nTamTexto <font color="#0000FF">then
  while </font>nCont <font color="#808080">&lt;= (</font>nTamTexto<font color="#808080">-</font>nTamChave<font color="#808080">+</font><font color="#FF00FF">1</font><font color="#808080">) </font><font color="#0000FF">loop
     </font>sPedaco<font color="#808080">:=</font>copy<font color="#808080">(</font>sTexto<font color="#808080">,</font>nCont<font color="#808080">,</font>nTamChave<font color="#808080">);
     </font><font color="#0000FF">if </font>sPedaco<font color="#808080">=</font>sChave <font color="#0000FF">then
        </font>bret<font color="#808080">:=</font>true<font color="#808080">;
     </font><font color="#0000FF">end if</font><font color="#808080">; 
     </font>nCont<font color="#808080">:=</font>nCont<font color="#808080">+</font><font color="#FF00FF">1</font><font color="#808080">;
  </font><font color="#0000FF">end loop</font><font color="#808080">;
</font><font color="#0000FF">end if</font><font color="#808080">;
</font><font color="#0000FF">return </font>bret<font color="#808080">;
</font><font color="#0000FF">end </font>strRelativa<font color="#808080">;

</font><font color="#FF0000">-- ----------------------------------------------------------------------------
-- Calcula o modulo11 de um valor qualquer.
-- svalor - a string com o n&uacute;mero a ser calculado
-- ndig - d&iacute;gito do valor a ser calculado
-- retorna - o d&iacute;gito correto
-- ----------------------------------------------------------------------------
</font><font color="#0000FF">function </font>modulo11<font color="#808080">(</font>svalor<font color="#808080">: </font><font color="#0000FF">in </font>ustring<font color="#808080">; </font>ndig<font color="#808080">: </font><font color="#0000FF">in </font>integer<font color="#808080">) </font><font color="#0000FF">return </font>integer <font color="#0000FF">is
</font>ncont<font color="#808080">, </font>nsoma<font color="#808080">, </font>nvalor<font color="#808080">, </font>npos<font color="#808080">: </font>integer<font color="#808080">;
</font>sres<font color="#808080">, </font>slocal<font color="#808080">: </font>ustring<font color="#808080">;
</font><font color="#0000FF">begin
 </font>ncont<font color="#808080">:=</font><font color="#FF00FF">1</font><font color="#808080">;
 </font>sres<font color="#808080">:=</font>null_unbounded_string<font color="#808080">;
 </font><font color="#0000FF">while </font>ncont <font color="#808080">&lt;= </font><font color="#FF00FF">11 </font><font color="#0000FF">loop
   </font>slocal<font color="#808080">:=</font>copy<font color="#808080">(</font>svalor<font color="#808080">,</font>ncont<font color="#808080">,</font><font color="#FF00FF">1</font><font color="#808080">) &amp; </font>slocal<font color="#808080">;
   </font>ncont<font color="#808080">:=</font>ncont<font color="#808080">+</font><font color="#FF00FF">1</font><font color="#808080">;
 </font><font color="#0000FF">end loop</font><font color="#808080">;
 </font>nsoma<font color="#808080">:=</font><font color="#FF00FF">0</font><font color="#808080">;
 </font><font color="#0000FF">if </font>ndig<font color="#808080">=</font><font color="#FF00FF">1 </font><font color="#0000FF">then
   </font>ncont<font color="#808080">:=</font><font color="#FF00FF">3</font><font color="#808080">;
 </font><font color="#0000FF">else
   </font>ncont<font color="#808080">:=</font><font color="#FF00FF">2</font><font color="#808080">;
 </font><font color="#0000FF">end if</font><font color="#808080">;
 </font>npos<font color="#808080">:=</font><font color="#FF00FF">2</font><font color="#808080">;
 </font><font color="#0000FF">while </font>ncont <font color="#808080">&lt;= </font><font color="#FF00FF">11 </font><font color="#0000FF">loop
   </font>sres<font color="#808080">:=</font>copy<font color="#808080">(</font>slocal<font color="#808080">,</font>ncont<font color="#808080">,</font><font color="#FF00FF">1</font><font color="#808080">);
   </font>nvalor<font color="#808080">:=</font>Value_Integer<font color="#808080">(</font>S<font color="#808080">(</font>sres<font color="#808080">));
   </font>nsoma<font color="#808080">:=</font>nsoma <font color="#808080">+ (</font>nvalor <font color="#808080">* </font>npos<font color="#808080">);
   </font>ncont<font color="#808080">:=</font>ncont<font color="#808080">+</font><font color="#FF00FF">1</font><font color="#808080">;
   </font>npos<font color="#808080">:=</font>npos<font color="#808080">+</font><font color="#FF00FF">1</font><font color="#808080">;
 </font><font color="#0000FF">end loop</font><font color="#808080">;
 </font>nsoma<font color="#808080">:=(</font><font color="#FF00FF">11 </font><font color="#808080">- (</font>nsoma <font color="#0000FF">mod </font><font color="#FF00FF">11</font><font color="#808080">));

</font><font color="#0000FF">if </font>nsoma <font color="#808080">&gt; </font><font color="#FF00FF">9 </font><font color="#0000FF">then
  return </font><font color="#FF00FF">0</font><font color="#808080">;
</font><font color="#0000FF">else
  return </font>nsoma<font color="#808080">;
</font><font color="#0000FF">end if</font><font color="#808080">;

</font><font color="#0000FF">end </font>modulo11<font color="#808080">;
</font><font color="#FF0000">-- ----------------------------------------------------------------------------
-- Valida&ccedil;&atilde;o de um n&uacute;mero de CPF qualquer.
-- cpf - a string com o n&uacute;mero do CPF
-- retorna - se &eacute; valido ou n&atilde;o
-- ----------------------------------------------------------------------------
</font><font color="#0000FF">function </font>validaCPF<font color="#808080">(</font>cpf<font color="#808080">: </font><font color="#0000FF">in </font>ustring<font color="#808080">) </font><font color="#0000FF">return </font>boolean <font color="#0000FF">is
</font>scpf<font color="#808080">, </font>sres<font color="#808080">: </font>ustring<font color="#808080">;
</font>nvalor1<font color="#808080">, </font>nvalor2<font color="#808080">: </font>integer<font color="#808080">;
</font><font color="#0000FF">begin
if </font><font color="#808080">(</font>length<font color="#808080">(</font>cpf<font color="#808080">)=</font><font color="#FF00FF">14</font><font color="#808080">) </font><font color="#0000FF">then
  </font>scpf<font color="#808080">:=</font>copy<font color="#808080">(</font>cpf<font color="#808080">,</font><font color="#FF00FF">1</font><font color="#808080">,</font><font color="#FF00FF">3</font><font color="#808080">) &amp; </font>copy<font color="#808080">(</font>cpf<font color="#808080">,</font><font color="#FF00FF">5</font><font color="#808080">,</font><font color="#FF00FF">3</font><font color="#808080">) &amp; </font>copy<font color="#808080">(</font>cpf<font color="#808080">,</font><font color="#FF00FF">9</font><font color="#808080">,</font><font color="#FF00FF">3</font><font color="#808080">) &amp; </font>copy<font color="#808080">(</font>cpf<font color="#808080">,</font><font color="#FF00FF">13</font><font color="#808080">,</font><font color="#FF00FF">2</font><font color="#808080">);
  </font>sres<font color="#808080">:=</font>copy<font color="#808080">(</font>cpf<font color="#808080">,</font><font color="#FF00FF">13</font><font color="#808080">,</font><font color="#FF00FF">1</font><font color="#808080">);
  </font>nvalor1<font color="#808080">:=</font>Value_Integer<font color="#808080">(</font>S<font color="#808080">(</font>sres<font color="#808080">));
  </font>sres<font color="#808080">:=</font>copy<font color="#808080">(</font>cpf<font color="#808080">,</font><font color="#FF00FF">14</font><font color="#808080">,</font><font color="#FF00FF">1</font><font color="#808080">);
  </font>nvalor2<font color="#808080">:=</font>Value_Integer<font color="#808080">(</font>S<font color="#808080">(</font>sres<font color="#808080">));
  </font><font color="#0000FF">if </font><font color="#808080">((</font>modulo11<font color="#808080">(</font>scpf<font color="#808080">,</font><font color="#FF00FF">1</font><font color="#808080">)=</font>nvalor1<font color="#808080">) </font><font color="#0000FF">and </font><font color="#808080">(</font>modulo11<font color="#808080">(</font>scpf<font color="#808080">,</font><font color="#FF00FF">2</font><font color="#808080">)=</font>nvalor2<font color="#808080">)) </font><font color="#0000FF">then
    return </font>true<font color="#808080">;
  </font><font color="#0000FF">else
    return </font>false<font color="#808080">;
  </font><font color="#0000FF">end if</font><font color="#808080">;
</font><font color="#0000FF">else
  return </font>false<font color="#808080">;
</font><font color="#0000FF">end if</font><font color="#808080">;
</font><font color="#0000FF">end </font>validaCPF<font color="#808080">;

</font><font color="#FF0000">-- ----------------------------------------------------------------------------
-- Valida&ccedil;&atilde;o de um n&uacute;mero ISBN qualquer.
-- isbn - a string com o n&uacute;mero do ISBN
-- retorna - se &eacute; valido ou n&atilde;o
-- ----------------------------------------------------------------------------
</font><font color="#0000FF">function </font>validaISBN<font color="#808080">(</font>isbn<font color="#808080">: </font><font color="#0000FF">in </font>ustring<font color="#808080">) </font><font color="#0000FF">return </font>boolean <font color="#0000FF">is
</font>snum<font color="#808080">, </font>sdigito<font color="#808080">, </font>sisbn<font color="#808080">: </font>ustring<font color="#808080">;
</font>nvalor<font color="#808080">, </font>nsoma<font color="#808080">, </font>ncont<font color="#808080">: </font>integer<font color="#808080">:=</font><font color="#FF00FF">0</font><font color="#808080">;
</font><font color="#0000FF">begin
if </font><font color="#808080">(</font>length<font color="#808080">(</font>isbn<font color="#808080">)=</font><font color="#FF00FF">13</font><font color="#808080">) </font><font color="#0000FF">then
  </font>sdigito <font color="#808080">:= </font>copy<font color="#808080">(</font>isbn<font color="#808080">, </font>length<font color="#808080">(</font>isbn<font color="#808080">), </font><font color="#FF00FF">1</font><font color="#808080">);
  </font>sisbn<font color="#808080">:=</font>null_unbounded_string<font color="#808080">;
  </font><font color="#0000FF">for </font>ncont <font color="#0000FF">in </font><font color="#FF00FF">1</font><font color="#808080">..</font>length<font color="#808080">(</font>isbn<font color="#808080">)-</font><font color="#FF00FF">1 </font><font color="#0000FF">loop
    if </font><font color="#808080">(</font>copy<font color="#808080">(</font>isbn<font color="#808080">,</font>ncont<font color="#808080">,</font><font color="#FF00FF">1</font><font color="#808080">)/=</font><font color="#008080">&quot;-&quot;</font><font color="#808080">) </font><font color="#0000FF">then
      </font>sisbn<font color="#808080">:=</font>sisbn <font color="#808080">&amp; </font>copy<font color="#808080">(</font>isbn<font color="#808080">,</font>ncont<font color="#808080">,</font><font color="#FF00FF">1</font><font color="#808080">);
    </font><font color="#0000FF">end if</font><font color="#808080">;
  </font><font color="#0000FF">end loop</font><font color="#808080">;

  </font><font color="#0000FF">if </font>sdigito <font color="#808080">= </font><font color="#008080">&quot;X&quot; </font><font color="#0000FF">then
    </font>nsoma <font color="#808080">:= </font><font color="#FF00FF">10</font><font color="#808080">;
  </font><font color="#0000FF">else
    </font>nvalor<font color="#808080">:=</font>Value_Integer<font color="#808080">(</font>S<font color="#808080">(</font>sdigito<font color="#808080">));
    </font>nsoma <font color="#808080">:= </font>nvalor<font color="#808080">;
  </font><font color="#0000FF">end if</font><font color="#808080">;
  </font><font color="#0000FF">for </font>ncont <font color="#0000FF">in </font><font color="#FF00FF">1</font><font color="#808080">..</font><font color="#FF00FF">9 </font><font color="#0000FF">loop
    </font>snum<font color="#808080">:=</font>copy<font color="#808080">(</font>sisbn<font color="#808080">, </font>ncont<font color="#808080">, </font><font color="#FF00FF">1</font><font color="#808080">);
    </font>nvalor<font color="#808080">:=</font>Value_Integer<font color="#808080">(</font>S<font color="#808080">(</font>snum<font color="#808080">));
    </font>nsoma<font color="#808080">:=</font>nsoma <font color="#808080">+ (</font>nvalor <font color="#808080">* (</font><font color="#FF00FF">11 </font><font color="#808080">- </font>ncont<font color="#808080">));
  </font><font color="#0000FF">end loop</font><font color="#808080">;
  </font><font color="#0000FF">If </font><font color="#808080">(</font>nsoma <font color="#0000FF">mod </font><font color="#FF00FF">11</font><font color="#808080">) = </font><font color="#FF00FF">0 </font><font color="#0000FF">Then
    return </font>true<font color="#808080">;
  </font><font color="#0000FF">else
    return </font>false<font color="#808080">;
  </font><font color="#0000FF">end if</font><font color="#808080">;
</font><font color="#0000FF">else
  return </font>false<font color="#808080">;
</font><font color="#0000FF">end if</font><font color="#808080">;
</font><font color="#0000FF">end </font>validaISBN<font color="#808080">;
</font><font color="#FF0000">-- ----------------------------------------------------------------------------
-- Esconde a digita&ccedil;&atilde;o da senha
-- retorna - a senha digitada
-- ----------------------------------------------------------------------------
</font><font color="#0000FF">function </font>digitaSenha<font color="#808080">(</font>sRotulo<font color="#808080">: </font><font color="#0000FF">in </font>ustring<font color="#808080">; </font>nTamSenha<font color="#808080">: </font><font color="#0000FF">in </font>integer<font color="#808080">) 
         </font><font color="#0000FF">return </font>ustring <font color="#0000FF">is
</font>sSenha<font color="#808080">: </font>ustring<font color="#808080">;
</font>sLetra<font color="#808080">: </font>character<font color="#808080">;
</font>ncont<font color="#808080">: </font>integer<font color="#808080">;
</font><font color="#0000FF">begin
</font>put<font color="#808080">(</font>sRotulo<font color="#808080">);
</font>ncont<font color="#808080">:= </font><font color="#FF00FF">0</font><font color="#808080">;
</font>sSenha<font color="#808080">:=</font>null_unbounded_string<font color="#808080">;
</font>sLetra<font color="#808080">:=</font>Character<font color="#808080">'</font>val<font color="#808080">(</font><font color="#FF00FF">0</font><font color="#808080">);
</font><font color="#0000FF">while </font><font color="#808080">(</font>sLetra<font color="#808080">/=</font>Character<font color="#808080">'</font>val<font color="#808080">(</font><font color="#FF00FF">13</font><font color="#808080">)) </font><font color="#0000FF">and </font><font color="#808080">(</font>ncont <font color="#808080">&lt; </font>nTamSenha<font color="#808080">) </font><font color="#0000FF">loop
  </font>get_immediate<font color="#808080">(</font>sLetra<font color="#808080">);
  </font><font color="#0000FF">if </font>sLetra<font color="#808080">/=</font>Character<font color="#808080">'</font>val<font color="#808080">(</font><font color="#FF00FF">13</font><font color="#808080">) </font><font color="#0000FF">then
     </font>sSenha<font color="#808080">:=</font>sSenha <font color="#808080">&amp; </font>sLetra<font color="#808080">;
  </font><font color="#0000FF">end if</font><font color="#808080">;
  </font>ncont<font color="#808080">:=</font>ncont<font color="#808080">+</font><font color="#FF00FF">1</font><font color="#808080">;
</font><font color="#0000FF">end loop</font><font color="#808080">;
</font><font color="#0000FF">return </font>sSenha<font color="#808080">;
</font><font color="#0000FF">end </font>digitaSenha<font color="#808080">;

</font><font color="#FF0000">-- ----------------------------------------------------------------------------
-- Valida&ccedil;&atilde;o de um n&uacute;mero com ponto flutuante.
-- sNumero - a string com o valor do n&uacute;mero
-- retorna - o numero ou 0.0 se errado
-- ----------------------------------------------------------------------------
</font><font color="#0000FF">function </font>validaFloat<font color="#808080">(</font>sNumero<font color="#808080">: </font><font color="#0000FF">in </font>string<font color="#808080">) </font><font color="#0000FF">return </font>float <font color="#0000FF">is
</font><font color="#FF0000">-- nnum: integer;
</font>nnum<font color="#808080">: </font>float<font color="#808080">;
</font><font color="#0000FF">begin
  </font><font color="#FF0000">-- nnum:=Value_Integer(sNumero);
  </font>nnum<font color="#808080">:=</font>float<font color="#808080">(</font>Value_Real<font color="#808080">(</font>sNumero<font color="#808080">));
  </font><font color="#0000FF">return </font>nnum<font color="#808080">;
</font><font color="#0000FF">exception
  when </font>Program_Error <font color="#808080">| </font>Constraint_Error <font color="#808080">=&gt; </font><font color="#0000FF">return </font><font color="#FF00FF">0</font><font color="#808080">.</font><font color="#FF00FF">0</font><font color="#808080">;</font>	 
  <font color="#0000FF">when others </font><font color="#808080">=&gt; </font><font color="#0000FF">return </font><font color="#FF00FF">0</font><font color="#808080">.</font><font color="#FF00FF">0</font><font color="#808080">; 
</font><font color="#0000FF">end </font>validaFloat<font color="#808080">;

</font><font color="#FF0000">-- ----------------------------------------------------------------------------
-- Valida&ccedil;&atilde;o de um n&uacute;mero qualquer.
-- sRotulo - o texto antes de se digitar o n&uacute;mero
-- sNumero - a string com o valor do n&uacute;mero
-- retorna - o sNumero
-- ----------------------------------------------------------------------------
</font><font color="#0000FF">function </font>validaNumero<font color="#808080">(</font>sRotulo<font color="#808080">, </font>sNumero<font color="#808080">: </font><font color="#0000FF">in </font>ustring<font color="#808080">) </font><font color="#0000FF">return </font>ustring <font color="#0000FF">is
</font>nnum<font color="#808080">: </font>float<font color="#808080">;
</font>nStatus<font color="#808080">: </font>integer<font color="#808080">;
</font>slNumero<font color="#808080">: </font>ustring<font color="#808080">;
</font><font color="#0000FF">begin
</font>nStatus<font color="#808080">:=-</font><font color="#FF00FF">1</font><font color="#808080">;
</font><font color="#0000FF">while </font><font color="#808080">(</font>nStatus<font color="#808080">/=</font><font color="#FF00FF">0</font><font color="#808080">) </font><font color="#0000FF">loop
  </font>put<font color="#808080">(</font>sRotulo<font color="#808080">);
  </font>get_line<font color="#808080">(</font>slNumero<font color="#808080">);
  </font>nnum<font color="#808080">:=</font>validaFloat<font color="#808080">(</font>S<font color="#808080">(</font>slNumero<font color="#808080">));
  </font><font color="#0000FF">if </font><font color="#808080">(</font>nnum <font color="#808080">&lt; </font><font color="#FF00FF">0</font><font color="#808080">.</font><font color="#FF00FF">01</font><font color="#808080">) </font><font color="#0000FF">then
     </font>put_line<font color="#808080">(</font>MSG_NUMINV<font color="#808080">);
  </font><font color="#0000FF">else
     </font>nStatus<font color="#808080">:=</font><font color="#FF00FF">0</font><font color="#808080">;
  </font><font color="#0000FF">end if</font><font color="#808080">;
</font><font color="#0000FF">end loop</font><font color="#808080">;

</font><font color="#0000FF">return </font>slNumero<font color="#808080">;
</font><font color="#0000FF">end </font>validaNumero<font color="#808080">;

</font><font color="#FF0000">-- ----------------------------------------------------------------------------
-- Valida&ccedil;&atilde;o de uma data ou data/hora qualquer.
-- sRotulo - o texto antes de se digitar a data/hora
-- sDataHora - a string com o valor da data/hora
-- bSoData - indica se vai validar somente uma data sem a hora
-- retorna - a sDataHora
-- ----------------------------------------------------------------------------
</font><font color="#0000FF">function </font>validaDataHora<font color="#808080">(</font>sRotulo<font color="#808080">, </font>sDataHora<font color="#808080">: </font><font color="#0000FF">in </font>ustring<font color="#808080">; 
         </font>bSoData<font color="#808080">: </font><font color="#0000FF">in </font>boolean<font color="#808080">) </font><font color="#0000FF">return </font>ustring <font color="#0000FF">is
</font>bvalida<font color="#808080">, </font>bdatavalida<font color="#808080">, </font>bhoravalida<font color="#808080">: </font>boolean<font color="#808080">;
</font>sdia<font color="#808080">, </font>smes<font color="#808080">, </font>sano<font color="#808080">, </font>shora<font color="#808080">, </font>smin<font color="#808080">, </font>sseg<font color="#808080">: </font>ustring<font color="#808080">;
</font>ndia<font color="#808080">, </font>nmes<font color="#808080">, </font>nano<font color="#808080">, </font>nhora<font color="#808080">, </font>nmin<font color="#808080">, </font>nseg<font color="#808080">, </font>nudiames<font color="#808080">: </font>integer<font color="#808080">;
</font>ntam<font color="#808080">: </font>integer<font color="#808080">;
</font>slDataHora<font color="#808080">: </font>ustring<font color="#808080">;
</font><font color="#0000FF">begin
</font>bvalida<font color="#808080">:=</font>false<font color="#808080">;
</font>bdatavalida<font color="#808080">:=</font>false<font color="#808080">;
</font>bhoravalida<font color="#808080">:=</font>false<font color="#808080">;
</font>nudiames<font color="#808080">:=</font><font color="#FF00FF">0</font><font color="#808080">;

</font><font color="#0000FF">if </font>bSoData<font color="#808080">=</font>true <font color="#0000FF">then </font>ntam<font color="#808080">:=</font><font color="#FF00FF">10</font><font color="#808080">;
</font><font color="#0000FF">else </font>ntam<font color="#808080">:=</font><font color="#FF00FF">19</font><font color="#808080">;
</font><font color="#0000FF">end if</font><font color="#808080">;
</font><font color="#0000FF">while </font><font color="#808080">(</font>bvalida<font color="#808080">=</font>false<font color="#808080">) </font><font color="#0000FF">loop
  </font>put<font color="#808080">(</font>sRotulo<font color="#808080">);
  </font>get_line<font color="#808080">(</font>slDataHora<font color="#808080">);
  </font><font color="#0000FF">if </font>length<font color="#808080">(</font>slDataHora<font color="#808080">)=</font>ntam <font color="#0000FF">then
    </font>sdia<font color="#808080">:=</font>copy<font color="#808080">(</font>slDataHora<font color="#808080">,</font><font color="#FF00FF">1</font><font color="#808080">,</font><font color="#FF00FF">2</font><font color="#808080">);
    </font>ndia<font color="#808080">:=</font>Value_Integer<font color="#808080">(</font>S<font color="#808080">(</font>sdia<font color="#808080">));
    </font>smes<font color="#808080">:=</font>copy<font color="#808080">(</font>slDataHora<font color="#808080">,</font><font color="#FF00FF">4</font><font color="#808080">,</font><font color="#FF00FF">2</font><font color="#808080">);
    </font>nmes<font color="#808080">:=</font>Value_Integer<font color="#808080">(</font>S<font color="#808080">(</font>smes<font color="#808080">));
    </font>sano<font color="#808080">:=</font>copy<font color="#808080">(</font>slDataHora<font color="#808080">,</font><font color="#FF00FF">7</font><font color="#808080">,</font><font color="#FF00FF">4</font><font color="#808080">);
    </font>nano<font color="#808080">:=</font>Value_Integer<font color="#808080">(</font>S<font color="#808080">(</font>sano<font color="#808080">));
  
    </font><font color="#0000FF">if </font><font color="#808080">(</font>nano <font color="#808080">&gt;= </font><font color="#FF00FF">1</font><font color="#808080">) </font><font color="#0000FF">and </font><font color="#808080">(</font>nano <font color="#808080">&lt;= </font><font color="#FF00FF">9999</font><font color="#808080">) </font><font color="#0000FF">then
      if </font><font color="#808080">(</font>nmes <font color="#808080">&gt;= </font><font color="#FF00FF">1</font><font color="#808080">) </font><font color="#0000FF">and </font><font color="#808080">(</font>nmes <font color="#808080">&lt;= </font><font color="#FF00FF">31</font><font color="#808080">) </font><font color="#0000FF">then
          case </font>nmes <font color="#0000FF">is
            when </font><font color="#FF00FF">1 </font><font color="#808080">| </font><font color="#FF00FF">3 </font><font color="#808080">| </font><font color="#FF00FF">5 </font><font color="#808080">| </font><font color="#FF00FF">7 </font><font color="#808080">| </font><font color="#FF00FF">8 </font><font color="#808080">| </font><font color="#FF00FF">10 </font><font color="#808080">| </font><font color="#FF00FF">12 </font><font color="#808080">=&gt; </font>nudiames<font color="#808080">:=</font><font color="#FF00FF">31</font><font color="#808080">;
            </font><font color="#0000FF">when </font><font color="#FF00FF">2 </font><font color="#808080">=&gt;
               </font><font color="#FF0000">-- ano bissexto --
               </font><font color="#0000FF">if </font><font color="#808080">(</font>nano <font color="#0000FF">mod </font><font color="#FF00FF">4</font><font color="#808080">)=</font><font color="#FF00FF">0 </font><font color="#0000FF">then </font>nudiames<font color="#808080">:=</font><font color="#FF00FF">29</font><font color="#808080">;
               </font><font color="#0000FF">else </font>nudiames<font color="#808080">:=</font><font color="#FF00FF">28</font><font color="#808080">;              
               </font><font color="#0000FF">end if</font><font color="#808080">;
            </font><font color="#0000FF">when </font><font color="#FF00FF">4 </font><font color="#808080">| </font><font color="#FF00FF">6 </font><font color="#808080">| </font><font color="#FF00FF">9 </font><font color="#808080">| </font><font color="#FF00FF">11 </font><font color="#808080">=&gt; </font>nudiames<font color="#808080">:=</font><font color="#FF00FF">30</font><font color="#808080">;
            </font><font color="#0000FF">when others </font><font color="#808080">=&gt; </font><font color="#0000FF">null</font><font color="#808080">;  
          </font><font color="#0000FF">end case</font><font color="#808080">;
          </font><font color="#0000FF">if </font><font color="#808080">(</font>ndia <font color="#808080">&gt;=</font><font color="#FF00FF">1</font><font color="#808080">) </font><font color="#0000FF">and </font><font color="#808080">(</font>ndia <font color="#808080">&lt;=</font>nudiames<font color="#808080">) </font><font color="#0000FF">then
             </font>bdatavalida<font color="#808080">:=</font>true<font color="#808080">;
          </font><font color="#0000FF">end if</font><font color="#808080">;
      </font><font color="#0000FF">end if</font><font color="#808080">;
    </font><font color="#0000FF">end if</font><font color="#808080">;
  
    </font><font color="#0000FF">if </font>bSoData <font color="#0000FF">then
       if </font>bdatavalida <font color="#0000FF">then </font>bvalida<font color="#808080">:=</font>true<font color="#808080">;
       </font><font color="#0000FF">else </font>put_line<font color="#808080">(</font>MSG_DATAINV<font color="#808080">);
       </font><font color="#0000FF">end if</font><font color="#808080">;
    </font><font color="#0000FF">else
      if </font>bdatavalida <font color="#0000FF">then
          </font>shora<font color="#808080">:=</font>copy<font color="#808080">(</font>slDataHora<font color="#808080">,</font><font color="#FF00FF">12</font><font color="#808080">,</font><font color="#FF00FF">2</font><font color="#808080">);
          </font>nhora<font color="#808080">:=</font>Value_Integer<font color="#808080">(</font>S<font color="#808080">(</font>shora<font color="#808080">));
          </font>smin<font color="#808080">:=</font>copy<font color="#808080">(</font>slDataHora<font color="#808080">,</font><font color="#FF00FF">15</font><font color="#808080">,</font><font color="#FF00FF">2</font><font color="#808080">);
          </font>nmin<font color="#808080">:=</font>Value_Integer<font color="#808080">(</font>S<font color="#808080">(</font>smin<font color="#808080">));
          </font>sseg<font color="#808080">:=</font>copy<font color="#808080">(</font>slDataHora<font color="#808080">,</font><font color="#FF00FF">18</font><font color="#808080">,</font><font color="#FF00FF">2</font><font color="#808080">);
          </font>nseg<font color="#808080">:=</font>Value_Integer<font color="#808080">(</font>S<font color="#808080">(</font>sseg<font color="#808080">));
  
          </font><font color="#0000FF">if </font><font color="#808080">(</font>nhora <font color="#808080">&gt;= </font><font color="#FF00FF">0</font><font color="#808080">) </font><font color="#0000FF">and </font><font color="#808080">(</font>nhora <font color="#808080">&lt;= </font><font color="#FF00FF">23</font><font color="#808080">) </font><font color="#0000FF">then
            if </font><font color="#808080">(</font>nmin <font color="#808080">&gt;= </font><font color="#FF00FF">0</font><font color="#808080">) </font><font color="#0000FF">and </font><font color="#808080">(</font>nmin <font color="#808080">&lt;= </font><font color="#FF00FF">59</font><font color="#808080">) </font><font color="#0000FF">then
              if </font><font color="#808080">(</font>nseg <font color="#808080">&gt;= </font><font color="#FF00FF">0</font><font color="#808080">) </font><font color="#0000FF">and </font><font color="#808080">(</font>nseg <font color="#808080">&lt;= </font><font color="#FF00FF">59</font><font color="#808080">) </font><font color="#0000FF">then
                 </font>bhoravalida<font color="#808080">:=</font>true<font color="#808080">;
              </font><font color="#0000FF">end if</font><font color="#808080">;
            </font><font color="#0000FF">end if</font><font color="#808080">;
          </font><font color="#0000FF">end if</font><font color="#808080">; 
  
          </font><font color="#0000FF">if </font>bhoravalida <font color="#0000FF">then </font>bvalida<font color="#808080">:=</font>true<font color="#808080">;
          </font><font color="#0000FF">else </font>put_line<font color="#808080">(</font>MSG_DTHRINV<font color="#808080">);
          </font><font color="#0000FF">end if</font><font color="#808080">;
      </font><font color="#0000FF">else
        </font>put_line<font color="#808080">(</font>MSG_DTHRINV<font color="#808080">);
      </font><font color="#0000FF">end if</font><font color="#808080">;
    </font><font color="#0000FF">end if</font><font color="#808080">;
  </font><font color="#0000FF">else
    if </font>bSoData<font color="#808080">=</font>true <font color="#0000FF">then </font>put_line<font color="#808080">(</font>MSG_DATAINV<font color="#808080">);
    </font><font color="#0000FF">else </font>put_line<font color="#808080">(</font>MSG_DTHRINV<font color="#808080">);
    </font><font color="#0000FF">end if</font><font color="#808080">;
  </font><font color="#0000FF">end if</font><font color="#808080">;
</font><font color="#0000FF">end loop</font><font color="#808080">;
</font><font color="#0000FF">return </font>slDataHora<font color="#808080">;
</font><font color="#0000FF">end </font>validaDataHora<font color="#808080">;

</font><font color="#FF0000">-- ----------------------------------------------------------------------------
-- Retorna a Data e a hora do sistema.
-- retorna - a data e a hora
-- ----------------------------------------------------------------------------
</font><font color="#0000FF">function </font>retDataHora <font color="#0000FF">return </font>ustring <font color="#0000FF">is
</font>y <font color="#808080">: </font>year_number<font color="#808080">;
</font>m <font color="#808080">: </font>month_number<font color="#808080">;
</font>d <font color="#808080">: </font>day_number<font color="#808080">;
</font>h<font color="#808080">, </font>mn<font color="#808080">, </font>s<font color="#808080">, </font>dd<font color="#808080">, </font>dh <font color="#808080">: </font>natural<font color="#808080">;
</font>dia<font color="#808080">,</font>mes<font color="#808080">,</font>ano<font color="#808080">,</font>hora<font color="#808080">,</font>min<font color="#808080">,</font>seg<font color="#808080">: </font>ustring<font color="#808080">;
</font><font color="#0000FF">begin
  </font>d<font color="#808080">:=</font>integer<font color="#808080">(</font>day<font color="#808080">(</font>clock<font color="#808080">));
  </font>m<font color="#808080">:=</font>integer<font color="#808080">(</font>month<font color="#808080">(</font>clock<font color="#808080">));
  </font>y<font color="#808080">:=</font>integer<font color="#808080">(</font>year<font color="#808080">(</font>clock<font color="#808080">));
  </font>itostr<font color="#808080">(</font>d<font color="#808080">,</font>dia<font color="#808080">);
  </font>itostr<font color="#808080">(</font>m<font color="#808080">,</font>mes<font color="#808080">);
  </font>itostr<font color="#808080">(</font>y<font color="#808080">,</font>ano<font color="#808080">);

  </font>dd<font color="#808080">:=</font>natural<font color="#808080">(</font>seconds<font color="#808080">(</font>clock<font color="#808080">));
  </font>dh<font color="#808080">:=</font>natural<font color="#808080">(</font>dd<font color="#808080">/</font><font color="#FF00FF">60</font><font color="#808080">);
  </font>s<font color="#808080">:=</font>natural<font color="#808080">(</font>dd <font color="#0000FF">rem </font><font color="#FF00FF">60</font><font color="#808080">);
  </font>mn<font color="#808080">:=</font>dh <font color="#0000FF">rem </font><font color="#FF00FF">60</font><font color="#808080">;
  </font>h<font color="#808080">:=</font>dh <font color="#808080">/ </font><font color="#FF00FF">60</font><font color="#808080">;

  </font>itostr<font color="#808080">(</font>s<font color="#808080">,</font>seg<font color="#808080">);
  </font>itostr<font color="#808080">(</font>mn<font color="#808080">,</font>min<font color="#808080">);
  </font>itostr<font color="#808080">(</font>h<font color="#808080">,</font>hora<font color="#808080">);

  </font><font color="#0000FF">return </font>zeros<font color="#808080">(</font>dia<font color="#808080">,</font><font color="#FF00FF">2</font><font color="#808080">) &amp; </font><font color="#008080">&quot;/&quot; </font><font color="#808080">&amp; </font>zeros<font color="#808080">(</font>mes<font color="#808080">,</font><font color="#FF00FF">2</font><font color="#808080">) &amp; </font><font color="#008080">&quot;/&quot; </font><font color="#808080">&amp; </font>zeros<font color="#808080">(</font>ano<font color="#808080">,</font><font color="#FF00FF">4</font><font color="#808080">) &amp; </font><font color="#008080">&quot; &quot; </font><font color="#808080">&amp;
  </font>zeros<font color="#808080">(</font>hora<font color="#808080">,</font><font color="#FF00FF">2</font><font color="#808080">) &amp; </font><font color="#008080">&quot;:&quot; </font><font color="#808080">&amp; </font>zeros<font color="#808080">(</font>min<font color="#808080">,</font><font color="#FF00FF">2</font><font color="#808080">) &amp; </font><font color="#008080">&quot;:&quot; </font><font color="#808080">&amp; </font>zeros<font color="#808080">(</font>seg<font color="#808080">,</font><font color="#FF00FF">2</font><font color="#808080">);
</font><font color="#0000FF">end </font>retDataHora<font color="#808080">;

</font><font color="#FF0000">-- ----------------------------------------------------------------------------
-- Calcula o tamanho do arquivo.
-- sArq - o arquivo
-- retorna - o tamanho do arquivo
-- ----------------------------------------------------------------------------
</font><font color="#0000FF">function </font>tamArq<font color="#808080">(</font>sArq<font color="#808080">: </font><font color="#0000FF">in </font>ctTArqs<font color="#808080">) </font><font color="#0000FF">return </font>integer <font color="#0000FF">is
</font>ntam<font color="#808080">: </font>integer<font color="#808080">:=</font><font color="#FF00FF">0</font><font color="#808080">;
</font><font color="#0000FF">begin
case </font>sArq <font color="#0000FF">is
  when </font>taAssunto <font color="#808080">=&gt; </font>ntam<font color="#808080">:=</font>integer<font color="#808080">(</font>AssuntoIO<font color="#808080">.</font>size<font color="#808080">(</font>tfAssunto<font color="#808080">));
  </font><font color="#0000FF">when </font>taAutor <font color="#808080">=&gt; </font>ntam<font color="#808080">:=</font>integer<font color="#808080">(</font>AutorIO<font color="#808080">.</font>size<font color="#808080">(</font>tfAutor<font color="#808080">));
  </font><font color="#0000FF">when </font>taEditora <font color="#808080">=&gt; </font>ntam<font color="#808080">:=</font>integer<font color="#808080">(</font>EditoraIO<font color="#808080">.</font>size<font color="#808080">(</font>tfEditora<font color="#808080">));
  </font><font color="#0000FF">when </font>taIdioma <font color="#808080">=&gt; </font>ntam<font color="#808080">:=</font>integer<font color="#808080">(</font>IdiomaIO<font color="#808080">.</font>size<font color="#808080">(</font>tfIdioma<font color="#808080">));
  </font><font color="#0000FF">when </font>taEndereco <font color="#808080">=&gt; </font>ntam<font color="#808080">:=</font>integer<font color="#808080">(</font>EnderecoIO<font color="#808080">.</font>size<font color="#808080">(</font>tfEndereco<font color="#808080">));
  </font><font color="#0000FF">when </font>taPais <font color="#808080">=&gt; </font>ntam<font color="#808080">:=</font>integer<font color="#808080">(</font>PaisIO<font color="#808080">.</font>size<font color="#808080">(</font>tfPais<font color="#808080">));
  </font><font color="#0000FF">when </font>taProfissao <font color="#808080">=&gt; </font>ntam<font color="#808080">:=</font>integer<font color="#808080">(</font>ProfissaoIO<font color="#808080">.</font>size<font color="#808080">(</font>tfProfissao<font color="#808080">));
  </font><font color="#0000FF">when </font>taLivro <font color="#808080">=&gt; </font>ntam<font color="#808080">:=</font>integer<font color="#808080">(</font>LivroIO<font color="#808080">.</font>size<font color="#808080">(</font>tfLivro<font color="#808080">));
  </font><font color="#0000FF">when </font>taLivroAss <font color="#808080">=&gt; </font>ntam<font color="#808080">:=</font>integer<font color="#808080">(</font>LivroAssIO<font color="#808080">.</font>size<font color="#808080">(</font>tfLivroAss<font color="#808080">));
  </font><font color="#0000FF">when </font>taLivroAut <font color="#808080">=&gt; </font>ntam<font color="#808080">:=</font>integer<font color="#808080">(</font>LivroAutIO<font color="#808080">.</font>size<font color="#808080">(</font>tfLivroAut<font color="#808080">));
  </font><font color="#0000FF">when </font>taCliente <font color="#808080">=&gt; </font>ntam<font color="#808080">:=</font>integer<font color="#808080">(</font>ClienteIO<font color="#808080">.</font>size<font color="#808080">(</font>tfCliente<font color="#808080">));
  </font><font color="#0000FF">when </font>taUsuario <font color="#808080">=&gt; </font>ntam<font color="#808080">:=</font>integer<font color="#808080">(</font>UsuarioIO<font color="#808080">.</font>size<font color="#808080">(</font>tfUsuario<font color="#808080">));
  </font><font color="#0000FF">when </font>taVenda <font color="#808080">=&gt; </font>ntam<font color="#808080">:=</font>integer<font color="#808080">(</font>VendaIO<font color="#808080">.</font>size<font color="#808080">(</font>tfVenda<font color="#808080">));
  </font><font color="#0000FF">when others </font><font color="#808080">=&gt; </font>ntam<font color="#808080">:=</font><font color="#FF00FF">0</font><font color="#808080">;  
</font><font color="#0000FF">end case</font><font color="#808080">;
</font><font color="#0000FF">return </font>ntam<font color="#808080">;
</font><font color="#0000FF">end </font>tamArq<font color="#808080">;

</font><font color="#FF0000">-- ----------------------------------------------------------------------------
-- verifica se chegou ao fim do arquivo.
-- sArq - o arquivo
-- retorna - se chegou ao fim
-- ----------------------------------------------------------------------------
</font><font color="#0000FF">function </font>fimArq<font color="#808080">(</font>sArq<font color="#808080">: </font><font color="#0000FF">in </font>ctTArqs<font color="#808080">) </font><font color="#0000FF">return </font>boolean <font color="#0000FF">is
</font>bfim<font color="#808080">: </font>boolean<font color="#808080">:=</font>false<font color="#808080">;
</font><font color="#0000FF">begin
case </font>sArq <font color="#0000FF">is
  when </font>taAssunto <font color="#808080">=&gt; </font>bfim<font color="#808080">:=</font>AssuntoIO<font color="#808080">.</font>End_of_file<font color="#808080">(</font>tfAssunto<font color="#808080">);
  </font><font color="#0000FF">when </font>taAutor <font color="#808080">=&gt; </font>bfim<font color="#808080">:=</font>AutorIO<font color="#808080">.</font>End_of_file<font color="#808080">(</font>tfAutor<font color="#808080">);
  </font><font color="#0000FF">when </font>taEditora <font color="#808080">=&gt; </font>bfim<font color="#808080">:=</font>EditoraIO<font color="#808080">.</font>End_of_file<font color="#808080">(</font>tfEditora<font color="#808080">);
  </font><font color="#0000FF">when </font>taIdioma <font color="#808080">=&gt; </font>bfim<font color="#808080">:=</font>IdiomaIO<font color="#808080">.</font>End_of_file<font color="#808080">(</font>tfIdioma<font color="#808080">);
  </font><font color="#0000FF">when </font>taEndereco <font color="#808080">=&gt; </font>bfim<font color="#808080">:=</font>EnderecoIO<font color="#808080">.</font>End_of_file<font color="#808080">(</font>tfEndereco<font color="#808080">);
  </font><font color="#0000FF">when </font>taPais <font color="#808080">=&gt; </font>bfim<font color="#808080">:=</font>PaisIO<font color="#808080">.</font>End_of_file<font color="#808080">(</font>tfPais<font color="#808080">);
  </font><font color="#0000FF">when </font>taProfissao <font color="#808080">=&gt; </font>bfim<font color="#808080">:=</font>ProfissaoIO<font color="#808080">.</font>End_of_file<font color="#808080">(</font>tfProfissao<font color="#808080">);
  </font><font color="#0000FF">when </font>taLivro <font color="#808080">=&gt; </font>bfim<font color="#808080">:=</font>LivroIO<font color="#808080">.</font>End_of_file<font color="#808080">(</font>tfLivro<font color="#808080">);
  </font><font color="#0000FF">when </font>taLivroAss <font color="#808080">=&gt; </font>bfim<font color="#808080">:=</font>LivroAssIO<font color="#808080">.</font>End_of_file<font color="#808080">(</font>tfLivroAss<font color="#808080">);
  </font><font color="#0000FF">when </font>taLivroAut <font color="#808080">=&gt; </font>bfim<font color="#808080">:=</font>LivroAutIO<font color="#808080">.</font>End_of_file<font color="#808080">(</font>tfLivroAut<font color="#808080">);
  </font><font color="#0000FF">when </font>taCliente <font color="#808080">=&gt; </font>bfim<font color="#808080">:=</font>ClienteIO<font color="#808080">.</font>End_of_file<font color="#808080">(</font>tfCliente<font color="#808080">);
  </font><font color="#0000FF">when </font>taUsuario <font color="#808080">=&gt; </font>bfim<font color="#808080">:=</font>UsuarioIO<font color="#808080">.</font>End_of_file<font color="#808080">(</font>tfUsuario<font color="#808080">);
  </font><font color="#0000FF">when </font>taVenda <font color="#808080">=&gt; </font>bfim<font color="#808080">:=</font>VendaIO<font color="#808080">.</font>End_of_file<font color="#808080">(</font>tfVenda<font color="#808080">);
  </font><font color="#0000FF">when others </font><font color="#808080">=&gt; </font>bfim<font color="#808080">:=</font>false<font color="#808080">;  
</font><font color="#0000FF">end case</font><font color="#808080">;
</font><font color="#0000FF">return </font>bfim<font color="#808080">;
</font><font color="#0000FF">end </font>fimArq<font color="#808080">;

</font><font color="#FF0000">-- ----------------------------------------------------------------------------
-- retorna a posicao dentro do arquivo.
-- sArq - o arquivo
-- retorna - a posicao dentro do arquivo
-- ----------------------------------------------------------------------------
</font><font color="#0000FF">function </font>posArq<font color="#808080">(</font>sArq<font color="#808080">: </font><font color="#0000FF">in </font>ctTArqs<font color="#808080">) </font><font color="#0000FF">return </font>integer <font color="#0000FF">is
</font>npos<font color="#808080">: </font>integer<font color="#808080">:=</font><font color="#FF00FF">0</font><font color="#808080">;
</font><font color="#0000FF">begin
case </font>sArq <font color="#0000FF">is
  when </font>taAssunto <font color="#808080">=&gt; </font>npos<font color="#808080">:=</font>integer<font color="#808080">(</font>AssuntoIO<font color="#808080">.</font>index<font color="#808080">(</font>tfAssunto<font color="#808080">));
  </font><font color="#0000FF">when </font>taAutor <font color="#808080">=&gt; </font>npos<font color="#808080">:=</font>integer<font color="#808080">(</font>AutorIO<font color="#808080">.</font>index<font color="#808080">(</font>tfAutor<font color="#808080">));
  </font><font color="#0000FF">when </font>taEditora <font color="#808080">=&gt; </font>npos<font color="#808080">:=</font>integer<font color="#808080">(</font>EditoraIO<font color="#808080">.</font>index<font color="#808080">(</font>tfEditora<font color="#808080">));
  </font><font color="#0000FF">when </font>taIdioma <font color="#808080">=&gt; </font>npos<font color="#808080">:=</font>integer<font color="#808080">(</font>IdiomaIO<font color="#808080">.</font>index<font color="#808080">(</font>tfIdioma<font color="#808080">));
  </font><font color="#0000FF">when </font>taEndereco <font color="#808080">=&gt; </font>npos<font color="#808080">:=</font>integer<font color="#808080">(</font>EnderecoIO<font color="#808080">.</font>index<font color="#808080">(</font>tfEndereco<font color="#808080">));
  </font><font color="#0000FF">when </font>taPais <font color="#808080">=&gt; </font>npos<font color="#808080">:=</font>integer<font color="#808080">(</font>PaisIO<font color="#808080">.</font>index<font color="#808080">(</font>tfPais<font color="#808080">));
  </font><font color="#0000FF">when </font>taProfissao <font color="#808080">=&gt; </font>npos<font color="#808080">:=</font>integer<font color="#808080">(</font>ProfissaoIO<font color="#808080">.</font>index<font color="#808080">(</font>tfProfissao<font color="#808080">));
  </font><font color="#0000FF">when </font>taLivro <font color="#808080">=&gt; </font>npos<font color="#808080">:=</font>integer<font color="#808080">(</font>LivroIO<font color="#808080">.</font>index<font color="#808080">(</font>tfLivro<font color="#808080">));
  </font><font color="#0000FF">when </font>taLivroAss <font color="#808080">=&gt; </font>npos<font color="#808080">:=</font>integer<font color="#808080">(</font>LivroAssIO<font color="#808080">.</font>index<font color="#808080">(</font>tfLivroAss<font color="#808080">));
  </font><font color="#0000FF">when </font>taLivroAut <font color="#808080">=&gt; </font>npos<font color="#808080">:=</font>integer<font color="#808080">(</font>LivroAutIO<font color="#808080">.</font>index<font color="#808080">(</font>tfLivroAut<font color="#808080">));
  </font><font color="#0000FF">when </font>taCliente <font color="#808080">=&gt; </font>npos<font color="#808080">:=</font>integer<font color="#808080">(</font>ClienteIO<font color="#808080">.</font>index<font color="#808080">(</font>tfCliente<font color="#808080">));
  </font><font color="#0000FF">when </font>taUsuario <font color="#808080">=&gt; </font>npos<font color="#808080">:=</font>integer<font color="#808080">(</font>UsuarioIO<font color="#808080">.</font>index<font color="#808080">(</font>tfUsuario<font color="#808080">));
  </font><font color="#0000FF">when </font>taVenda <font color="#808080">=&gt; </font>npos<font color="#808080">:=</font>integer<font color="#808080">(</font>VendaIO<font color="#808080">.</font>index<font color="#808080">(</font>tfVenda<font color="#808080">));
  </font><font color="#0000FF">when others </font><font color="#808080">=&gt; </font>npos<font color="#808080">:=</font><font color="#FF00FF">0</font><font color="#808080">;  
</font><font color="#0000FF">end case</font><font color="#808080">;
</font><font color="#0000FF">return </font>npos<font color="#808080">;
</font><font color="#0000FF">end </font>posArq<font color="#808080">;

</font><font color="#FF0000">-- ----------------------------------------------------------------------------
-- realiza a operacao de posicionar dentro do arquivo o ponteiro de pesquisa.
-- sArq - o arquivo
-- npos - a posicao do ponteiro
-- ----------------------------------------------------------------------------
</font><font color="#0000FF">procedure </font>seekArq<font color="#808080">(</font>sArq<font color="#808080">: </font><font color="#0000FF">in </font>ctTArqs<font color="#808080">; </font>npos<font color="#808080">: </font><font color="#0000FF">in </font>integer<font color="#808080">) </font><font color="#0000FF">is
begin
case </font>sArq <font color="#0000FF">is
  when </font>taAssunto <font color="#808080">=&gt; </font>AssuntoIO<font color="#808080">.</font>set_index<font color="#808080">(</font>tfAssunto<font color="#808080">,
                    </font>AssuntoIO<font color="#808080">.</font>Positive_Count<font color="#808080">(</font>npos<font color="#808080">));
  </font><font color="#0000FF">when </font>taAutor <font color="#808080">=&gt; </font>AutorIO<font color="#808080">.</font>set_index<font color="#808080">(</font>tfAutor<font color="#808080">, </font>AutorIO<font color="#808080">.</font>Positive_Count<font color="#808080">(</font>npos<font color="#808080">));
  </font><font color="#0000FF">when </font>taEditora <font color="#808080">=&gt; </font>EditoraIO<font color="#808080">.</font>set_index<font color="#808080">(</font>tfEditora<font color="#808080">,
                    </font>EditoraIO<font color="#808080">.</font>Positive_Count<font color="#808080">(</font>npos<font color="#808080">));
  </font><font color="#0000FF">when </font>taIdioma <font color="#808080">=&gt; </font>IdiomaIO<font color="#808080">.</font>set_index<font color="#808080">(</font>tfIdioma<font color="#808080">,</font>IdiomaIO<font color="#808080">.</font>Positive_Count<font color="#808080">(</font>npos<font color="#808080">));
  </font><font color="#0000FF">when </font>taEndereco <font color="#808080">=&gt; </font>EnderecoIO<font color="#808080">.</font>set_index<font color="#808080">(</font>tfEndereco<font color="#808080">,
                     </font>EnderecoIO<font color="#808080">.</font>Positive_Count<font color="#808080">(</font>npos<font color="#808080">));
  </font><font color="#0000FF">when </font>taPais <font color="#808080">=&gt; </font>PaisIO<font color="#808080">.</font>set_index<font color="#808080">(</font>tfPais<font color="#808080">, </font>PaisIO<font color="#808080">.</font>Positive_Count<font color="#808080">(</font>npos<font color="#808080">));
  </font><font color="#0000FF">when </font>taProfissao <font color="#808080">=&gt; </font>ProfissaoIO<font color="#808080">.</font>set_index<font color="#808080">(</font>tfProfissao<font color="#808080">,
                      </font>ProfissaoIO<font color="#808080">.</font>Positive_Count<font color="#808080">(</font>npos<font color="#808080">));
  </font><font color="#0000FF">when </font>taLivro <font color="#808080">=&gt; </font>LivroIO<font color="#808080">.</font>set_index<font color="#808080">(</font>tfLivro<font color="#808080">, </font>LivroIO<font color="#808080">.</font>Positive_Count<font color="#808080">(</font>npos<font color="#808080">));
  </font><font color="#0000FF">when </font>taLivroAss <font color="#808080">=&gt; </font>LivroAssIO<font color="#808080">.</font>set_index<font color="#808080">(</font>tfLivroAss<font color="#808080">, 
                     </font>LivroAssIO<font color="#808080">.</font>Positive_Count<font color="#808080">(</font>npos<font color="#808080">));
  </font><font color="#0000FF">when </font>taLivroAut <font color="#808080">=&gt; </font>LivroAutIO<font color="#808080">.</font>set_index<font color="#808080">(</font>tfLivroAut<font color="#808080">, 
                     </font>LivroAutIO<font color="#808080">.</font>Positive_Count<font color="#808080">(</font>npos<font color="#808080">));
  </font><font color="#0000FF">when </font>taCliente <font color="#808080">=&gt; </font>ClienteIO<font color="#808080">.</font>set_index<font color="#808080">(</font>tfCliente<font color="#808080">, 
                    </font>ClienteIO<font color="#808080">.</font>Positive_Count<font color="#808080">(</font>npos<font color="#808080">));
  </font><font color="#0000FF">when </font>taUsuario <font color="#808080">=&gt; </font>UsuarioIO<font color="#808080">.</font>set_index<font color="#808080">(</font>tfUsuario<font color="#808080">, 
                    </font>UsuarioIO<font color="#808080">.</font>Positive_Count<font color="#808080">(</font>npos<font color="#808080">));
  </font><font color="#0000FF">when </font>taVenda <font color="#808080">=&gt; </font>VendaIO<font color="#808080">.</font>set_index<font color="#808080">(</font>tfVenda<font color="#808080">, </font>VendaIO<font color="#808080">.</font>Positive_Count<font color="#808080">(</font>npos<font color="#808080">));
  </font><font color="#0000FF">when others </font><font color="#808080">=&gt; </font><font color="#0000FF">null</font><font color="#808080">;  
</font><font color="#0000FF">end case</font><font color="#808080">;
</font><font color="#0000FF">end </font>seekArq<font color="#808080">;

</font><font color="#FF0000">-- ----------------------------------------------------------------------------
-- realiza a leitura de um registro no arquivo.
-- sArq - o arquivo
-- ----------------------------------------------------------------------------
</font><font color="#0000FF">function </font>lerArq<font color="#808080">(</font>sArq<font color="#808080">: </font><font color="#0000FF">in </font>ctTArqs<font color="#808080">) </font><font color="#0000FF">return </font>ustring <font color="#0000FF">is
</font>sret<font color="#808080">: </font>ustring<font color="#808080">:=</font>U<font color="#808080">(</font><font color="#008080">&quot;&quot;</font><font color="#808080">);
</font><font color="#0000FF">begin
case </font>sArq <font color="#0000FF">is
  when </font>taAssunto <font color="#808080">=&gt; </font>AssuntoIO<font color="#808080">.</font>read<font color="#808080">(</font>tfAssunto<font color="#808080">,</font>blAssunto<font color="#808080">); </font>sret<font color="#808080">:=</font>U<font color="#808080">(</font>blAssunto<font color="#808080">);
  </font><font color="#0000FF">when </font>taAutor <font color="#808080">=&gt; </font>AutorIO<font color="#808080">.</font>read<font color="#808080">(</font>tfAutor<font color="#808080">, </font>blAutor<font color="#808080">); </font>sret<font color="#808080">:=</font>U<font color="#808080">(</font>blAutor<font color="#808080">);
  </font><font color="#0000FF">when </font>taEditora <font color="#808080">=&gt; </font>EditoraIO<font color="#808080">.</font>read<font color="#808080">(</font>tfEditora<font color="#808080">, </font>blEditora<font color="#808080">); </font>sret<font color="#808080">:=</font>U<font color="#808080">(</font>blEditora<font color="#808080">);
  </font><font color="#0000FF">when </font>taIdioma <font color="#808080">=&gt; </font>IdiomaIO<font color="#808080">.</font>read<font color="#808080">(</font>tfIdioma<font color="#808080">, </font>blIdioma<font color="#808080">); </font>sret<font color="#808080">:=</font>U<font color="#808080">(</font>blIdioma<font color="#808080">);
  </font><font color="#0000FF">when </font>taEndereco <font color="#808080">=&gt; </font>EnderecoIO<font color="#808080">.</font>read<font color="#808080">(</font>tfEndereco<font color="#808080">, </font>blEndereco<font color="#808080">); 
                     </font>sret<font color="#808080">:=</font>U<font color="#808080">(</font>blEndereco<font color="#808080">);
  </font><font color="#0000FF">when </font>taPais <font color="#808080">=&gt; </font>PaisIO<font color="#808080">.</font>read<font color="#808080">(</font>tfPais<font color="#808080">, </font>blPais<font color="#808080">); </font>sret<font color="#808080">:=</font>U<font color="#808080">(</font>blPais<font color="#808080">);
  </font><font color="#0000FF">when </font>taProfissao <font color="#808080">=&gt; </font>ProfissaoIO<font color="#808080">.</font>read<font color="#808080">(</font>tfProfissao<font color="#808080">, </font>blProfissao<font color="#808080">); 
                      </font>sret<font color="#808080">:=</font>U<font color="#808080">(</font>blProfissao<font color="#808080">);
  </font><font color="#0000FF">when </font>taLivro <font color="#808080">=&gt; </font>LivroIO<font color="#808080">.</font>read<font color="#808080">(</font>tfLivro<font color="#808080">, </font>blLivro<font color="#808080">); </font>sret<font color="#808080">:=</font>U<font color="#808080">(</font>blLivro<font color="#808080">);
  </font><font color="#0000FF">when </font>taLivroAss <font color="#808080">=&gt; </font>LivroAssIO<font color="#808080">.</font>read<font color="#808080">(</font>tfLivroAss<font color="#808080">, </font>blLivroAss<font color="#808080">); 
                     </font>sret<font color="#808080">:=</font>U<font color="#808080">(</font>blLivroAss<font color="#808080">);
  </font><font color="#0000FF">when </font>taLivroAut <font color="#808080">=&gt; </font>LivroAutIO<font color="#808080">.</font>read<font color="#808080">(</font>tfLivroAut<font color="#808080">, </font>blLivroAut<font color="#808080">);
</font>	             sret<font color="#808080">:=</font>U<font color="#808080">(</font>blLivroAut<font color="#808080">);
  </font><font color="#0000FF">when </font>taCliente <font color="#808080">=&gt; </font>ClienteIO<font color="#808080">.</font>read<font color="#808080">(</font>tfCliente<font color="#808080">, </font>blCliente<font color="#808080">); </font>sret<font color="#808080">:=</font>U<font color="#808080">(</font>blCliente<font color="#808080">);
  </font><font color="#0000FF">when </font>taUsuario <font color="#808080">=&gt; </font>UsuarioIO<font color="#808080">.</font>read<font color="#808080">(</font>tfUsuario<font color="#808080">, </font>blUsuario<font color="#808080">); </font>sret<font color="#808080">:=</font>U<font color="#808080">(</font>blUsuario<font color="#808080">);
  </font><font color="#0000FF">when </font>taVenda <font color="#808080">=&gt; </font>VendaIO<font color="#808080">.</font>read<font color="#808080">(</font>tfVenda<font color="#808080">, </font>blVenda<font color="#808080">); </font>sret<font color="#808080">:=</font>U<font color="#808080">(</font>blVenda<font color="#808080">);
  </font><font color="#0000FF">when others </font><font color="#808080">=&gt; </font>sret<font color="#808080">:=</font>U<font color="#808080">(</font><font color="#008080">&quot;&quot;</font><font color="#808080">);  
</font><font color="#0000FF">end case</font><font color="#808080">;
</font><font color="#0000FF">return </font>sret<font color="#808080">;
</font><font color="#0000FF">end </font>lerArq<font color="#808080">;
     
</font><font color="#FF0000">-- ----------------------------------------------------------------------------
-- realiza a escrita de um registro no arquivo.
-- sArq - o arquivo
-- ----------------------------------------------------------------------------
</font><font color="#0000FF">procedure </font>gravarArq<font color="#808080">(</font>sArq<font color="#808080">: </font><font color="#0000FF">in </font>ctTArqs<font color="#808080">; </font>sTexto<font color="#808080">: </font><font color="#0000FF">in </font>ustring<font color="#808080">) </font><font color="#0000FF">is
begin
case </font>sArq <font color="#0000FF">is
  when </font>taAssunto <font color="#808080">=&gt; </font>blAssunto<font color="#808080">:=</font>S<font color="#808080">(</font>sTexto<font color="#808080">) &amp; </font>CRLF<font color="#808080">;
                    </font>AssuntoIO<font color="#808080">.</font>write<font color="#808080">(</font>tfAssunto<font color="#808080">,</font>blAssunto<font color="#808080">);
  </font><font color="#0000FF">when </font>taAutor <font color="#808080">=&gt; </font>blAutor<font color="#808080">:=</font>S<font color="#808080">(</font>sTexto<font color="#808080">) &amp; </font>CRLF<font color="#808080">;
                  </font>AutorIO<font color="#808080">.</font>write<font color="#808080">(</font>tfAutor<font color="#808080">, </font>blAutor<font color="#808080">);
  </font><font color="#0000FF">when </font>taEditora <font color="#808080">=&gt; </font>blEditora<font color="#808080">:=</font>S<font color="#808080">(</font>sTexto<font color="#808080">) &amp; </font>CRLF<font color="#808080">;
                    </font>EditoraIO<font color="#808080">.</font>write<font color="#808080">(</font>tfEditora<font color="#808080">, </font>blEditora<font color="#808080">);
  </font><font color="#0000FF">when </font>taIdioma <font color="#808080">=&gt; </font>blIdioma<font color="#808080">:=</font>S<font color="#808080">(</font>sTexto<font color="#808080">) &amp; </font>CRLF<font color="#808080">;
                   </font>IdiomaIO<font color="#808080">.</font>write<font color="#808080">(</font>tfIdioma<font color="#808080">, </font>blIdioma<font color="#808080">);
  </font><font color="#0000FF">when </font>taEndereco <font color="#808080">=&gt; </font>blEndereco<font color="#808080">:=</font>S<font color="#808080">(</font>sTexto<font color="#808080">) &amp; </font>CRLF<font color="#808080">;
                     </font>EnderecoIO<font color="#808080">.</font>write<font color="#808080">(</font>tfEndereco<font color="#808080">, </font>blEndereco<font color="#808080">);
  </font><font color="#0000FF">when </font>taPais <font color="#808080">=&gt; </font>blPais<font color="#808080">:=</font>S<font color="#808080">(</font>sTexto<font color="#808080">) &amp; </font>CRLF<font color="#808080">;
                 </font>PaisIO<font color="#808080">.</font>write<font color="#808080">(</font>tfPais<font color="#808080">, </font>blPais<font color="#808080">);
  </font><font color="#0000FF">when </font>taProfissao <font color="#808080">=&gt; </font>blProfissao<font color="#808080">:=</font>S<font color="#808080">(</font>sTexto<font color="#808080">) &amp; </font>CRLF<font color="#808080">;
                      </font>ProfissaoIO<font color="#808080">.</font>write<font color="#808080">(</font>tfProfissao<font color="#808080">, </font>blProfissao<font color="#808080">);
  </font><font color="#0000FF">when </font>taLivro <font color="#808080">=&gt; </font>blLivro<font color="#808080">:=</font>S<font color="#808080">(</font>sTexto<font color="#808080">) &amp; </font>CRLF<font color="#808080">;
                  </font>LivroIO<font color="#808080">.</font>write<font color="#808080">(</font>tfLivro<font color="#808080">, </font>blLivro<font color="#808080">);
  </font><font color="#0000FF">when </font>taLivroAss <font color="#808080">=&gt; </font>blLivroAss<font color="#808080">:=</font>S<font color="#808080">(</font>sTexto<font color="#808080">) &amp; </font>CRLF<font color="#808080">;
                     </font>LivroAssIO<font color="#808080">.</font>write<font color="#808080">(</font>tfLivroAss<font color="#808080">, </font>blLivroAss<font color="#808080">);
  </font><font color="#0000FF">when </font>taLivroAut <font color="#808080">=&gt; </font>blLivroAut<font color="#808080">:=</font>S<font color="#808080">(</font>sTexto<font color="#808080">) &amp; </font>CRLF<font color="#808080">;
                     </font>LivroAutIO<font color="#808080">.</font>write<font color="#808080">(</font>tfLivroAut<font color="#808080">, </font>blLivroAut<font color="#808080">);
  </font><font color="#0000FF">when </font>taCliente <font color="#808080">=&gt; </font>blCliente<font color="#808080">:=</font>S<font color="#808080">(</font>sTexto<font color="#808080">) &amp; </font>CRLF<font color="#808080">;
                    </font>ClienteIO<font color="#808080">.</font>write<font color="#808080">(</font>tfCliente<font color="#808080">, </font>blCliente<font color="#808080">);
  </font><font color="#0000FF">when </font>taUsuario <font color="#808080">=&gt; </font>blUsuario<font color="#808080">:=</font>S<font color="#808080">(</font>sTexto<font color="#808080">) &amp; </font>CRLF<font color="#808080">;
                    </font>UsuarioIO<font color="#808080">.</font>write<font color="#808080">(</font>tfUsuario<font color="#808080">, </font>blUsuario<font color="#808080">);
  </font><font color="#0000FF">when </font>taVenda <font color="#808080">=&gt; </font>blVenda<font color="#808080">:=</font>S<font color="#808080">(</font>sTexto<font color="#808080">) &amp; </font>CRLF<font color="#808080">;
                  </font>VendaIO<font color="#808080">.</font>write<font color="#808080">(</font>tfVenda<font color="#808080">, </font>blVenda<font color="#808080">);
  </font><font color="#0000FF">when others </font><font color="#808080">=&gt; </font><font color="#0000FF">null</font><font color="#808080">;  
</font><font color="#0000FF">end case</font><font color="#808080">;
</font><font color="#0000FF">end </font>gravarArq<font color="#808080">;

</font><font color="#FF0000">-- ----------------------------------------------------------------------------
-- Abre ou cria os arquivos do sistema.
-- bAbre - condi&ccedil;&atilde;o para abrir ou criar os arquivos do sistema
-- ----------------------------------------------------------------------------
</font><font color="#0000FF">procedure </font>abrecriaArqs<font color="#808080">(</font>bAbre<font color="#808080">: </font><font color="#0000FF">in </font>boolean<font color="#808080">) </font><font color="#0000FF">is
begin
if </font>bAbre <font color="#0000FF">then
  if </font>AssuntoIO<font color="#808080">.</font>is_open<font color="#808080">(</font>tfAssunto<font color="#808080">)=</font>false <font color="#0000FF">then
    </font>AssuntoIO<font color="#808080">.</font>open<font color="#808080">(</font>tfAssunto<font color="#808080">,</font>AssuntoIO<font color="#808080">.</font>Inout_File<font color="#808080">,</font>ARQ_ASSUNTO<font color="#808080">);
  </font><font color="#0000FF">else </font>put_line<font color="#808080">(</font>MSG_ARQERRO <font color="#808080">&amp; </font><font color="#008080">&quot; --&gt; &quot; </font><font color="#808080">&amp; </font>ARQ_ASSUNTO<font color="#808080">);
  </font><font color="#0000FF">end if</font><font color="#808080">; 
  </font><font color="#0000FF">if </font>AutorIO<font color="#808080">.</font>is_open<font color="#808080">(</font>tfAutor<font color="#808080">)=</font>false <font color="#0000FF">then
    </font>AutorIO<font color="#808080">.</font>open<font color="#808080">(</font>tfAutor<font color="#808080">,</font>AutorIO<font color="#808080">.</font>Inout_File<font color="#808080">,</font>ARQ_AUTOR<font color="#808080">);
  </font><font color="#0000FF">else </font>put_line<font color="#808080">(</font>MSG_ARQERRO <font color="#808080">&amp; </font><font color="#008080">&quot; --&gt; &quot; </font><font color="#808080">&amp; </font>ARQ_AUTOR<font color="#808080">);
  </font><font color="#0000FF">end if</font><font color="#808080">; 
  </font><font color="#0000FF">if </font>EditoraIO<font color="#808080">.</font>is_open<font color="#808080">(</font>tfEditora<font color="#808080">)=</font>false <font color="#0000FF">then
    </font>EditoraIO<font color="#808080">.</font>open<font color="#808080">(</font>tfEditora<font color="#808080">,</font>EditoraIO<font color="#808080">.</font>Inout_File<font color="#808080">,</font>ARQ_EDITORA<font color="#808080">);
  </font><font color="#0000FF">else </font>put_line<font color="#808080">(</font>MSG_ARQERRO <font color="#808080">&amp; </font><font color="#008080">&quot; --&gt; &quot; </font><font color="#808080">&amp; </font>ARQ_EDITORA<font color="#808080">);
  </font><font color="#0000FF">end if</font><font color="#808080">; 
  </font><font color="#0000FF">if </font>IdiomaIO<font color="#808080">.</font>is_open<font color="#808080">(</font>tfIdioma<font color="#808080">)=</font>false <font color="#0000FF">then
    </font>IdiomaIO<font color="#808080">.</font>open<font color="#808080">(</font>tfIdioma<font color="#808080">,</font>IdiomaIO<font color="#808080">.</font>Inout_File<font color="#808080">,</font>ARQ_IDIOMA<font color="#808080">);
  </font><font color="#0000FF">else </font>put_line<font color="#808080">(</font>MSG_ARQERRO <font color="#808080">&amp; </font><font color="#008080">&quot; --&gt; &quot; </font><font color="#808080">&amp; </font>ARQ_IDIOMA<font color="#808080">);
  </font><font color="#0000FF">end if</font><font color="#808080">; 
  </font><font color="#0000FF">if </font>EnderecoIO<font color="#808080">.</font>is_open<font color="#808080">(</font>tfEndereco<font color="#808080">)=</font>false <font color="#0000FF">then
    </font>EnderecoIO<font color="#808080">.</font>open<font color="#808080">(</font>tfEndereco<font color="#808080">,</font>EnderecoIO<font color="#808080">.</font>Inout_File<font color="#808080">,</font>ARQ_ENDERECO<font color="#808080">);
  </font><font color="#0000FF">else </font>put_line<font color="#808080">(</font>MSG_ARQERRO <font color="#808080">&amp; </font><font color="#008080">&quot; --&gt; &quot; </font><font color="#808080">&amp; </font>ARQ_ENDERECO<font color="#808080">);
  </font><font color="#0000FF">end if</font><font color="#808080">; 
  </font><font color="#0000FF">if </font>PaisIO<font color="#808080">.</font>is_open<font color="#808080">(</font>tfPais<font color="#808080">)=</font>false <font color="#0000FF">then
    </font>PaisIO<font color="#808080">.</font>open<font color="#808080">(</font>tfPais<font color="#808080">,</font>PaisIO<font color="#808080">.</font>Inout_File<font color="#808080">,</font>ARQ_PAIS<font color="#808080">);
  </font><font color="#0000FF">else </font>put_line<font color="#808080">(</font>MSG_ARQERRO <font color="#808080">&amp; </font><font color="#008080">&quot; --&gt; &quot; </font><font color="#808080">&amp; </font>ARQ_PAIS<font color="#808080">);
  </font><font color="#0000FF">end if</font><font color="#808080">; 
  </font><font color="#0000FF">if </font>ProfissaoIO<font color="#808080">.</font>is_open<font color="#808080">(</font>tfProfissao<font color="#808080">)=</font>false <font color="#0000FF">then
    </font>ProfissaoIO<font color="#808080">.</font>open<font color="#808080">(</font>tfProfissao<font color="#808080">,</font>ProfissaoIO<font color="#808080">.</font>Inout_File<font color="#808080">,</font>ARQ_PROFISSAO<font color="#808080">);
  </font><font color="#0000FF">else </font>put_line<font color="#808080">(</font>MSG_ARQERRO <font color="#808080">&amp; </font><font color="#008080">&quot; --&gt; &quot; </font><font color="#808080">&amp; </font>ARQ_PROFISSAO<font color="#808080">);
  </font><font color="#0000FF">end if</font><font color="#808080">; 
  </font><font color="#0000FF">if </font>LivroIO<font color="#808080">.</font>is_open<font color="#808080">(</font>tfLivro<font color="#808080">)=</font>false <font color="#0000FF">then
    </font>LivroIO<font color="#808080">.</font>open<font color="#808080">(</font>tfLivro<font color="#808080">,</font>LivroIO<font color="#808080">.</font>Inout_File<font color="#808080">,</font>ARQ_LIVRO<font color="#808080">);
  </font><font color="#0000FF">else </font>put_line<font color="#808080">(</font>MSG_ARQERRO <font color="#808080">&amp; </font><font color="#008080">&quot; --&gt; &quot; </font><font color="#808080">&amp; </font>ARQ_LIVRO<font color="#808080">);
  </font><font color="#0000FF">end if</font><font color="#808080">; 
  </font><font color="#0000FF">if </font>LivroAssIO<font color="#808080">.</font>is_open<font color="#808080">(</font>tfLivroAss<font color="#808080">)=</font>false <font color="#0000FF">then
    </font>LivroAssIO<font color="#808080">.</font>open<font color="#808080">(</font>tfLivroAss<font color="#808080">,</font>LivroAssIO<font color="#808080">.</font>Inout_File<font color="#808080">,</font>ARQ_LIVASS<font color="#808080">);
  </font><font color="#0000FF">else </font>put_line<font color="#808080">(</font>MSG_ARQERRO <font color="#808080">&amp; </font><font color="#008080">&quot; --&gt; &quot; </font><font color="#808080">&amp; </font>ARQ_LIVASS<font color="#808080">);
  </font><font color="#0000FF">end if</font><font color="#808080">; 
  </font><font color="#0000FF">if </font>LivroAutIO<font color="#808080">.</font>is_open<font color="#808080">(</font>tfLivroAut<font color="#808080">)=</font>false <font color="#0000FF">then
    </font>LivroAutIO<font color="#808080">.</font>open<font color="#808080">(</font>tfLivroAut<font color="#808080">,</font>LivroAutIO<font color="#808080">.</font>Inout_File<font color="#808080">,</font>ARQ_LIVAUT<font color="#808080">);
  </font><font color="#0000FF">else </font>put_line<font color="#808080">(</font>MSG_ARQERRO <font color="#808080">&amp; </font><font color="#008080">&quot; --&gt; &quot; </font><font color="#808080">&amp; </font>ARQ_LIVAUT<font color="#808080">);
  </font><font color="#0000FF">end if</font><font color="#808080">; 
  </font><font color="#0000FF">if </font>ClienteIO<font color="#808080">.</font>is_open<font color="#808080">(</font>tfCliente<font color="#808080">)=</font>false <font color="#0000FF">then
    </font>ClienteIO<font color="#808080">.</font>open<font color="#808080">(</font>tfCliente<font color="#808080">,</font>ClienteIO<font color="#808080">.</font>Inout_File<font color="#808080">,</font>ARQ_CLIENTE<font color="#808080">);
  </font><font color="#0000FF">else </font>put_line<font color="#808080">(</font>MSG_ARQERRO <font color="#808080">&amp; </font><font color="#008080">&quot; --&gt; &quot; </font><font color="#808080">&amp; </font>ARQ_CLIENTE<font color="#808080">);
  </font><font color="#0000FF">end if</font><font color="#808080">; 
  </font><font color="#0000FF">if </font>UsuarioIO<font color="#808080">.</font>is_open<font color="#808080">(</font>tfUsuario<font color="#808080">)=</font>false <font color="#0000FF">then
    </font>UsuarioIO<font color="#808080">.</font>open<font color="#808080">(</font>tfUsuario<font color="#808080">,</font>UsuarioIO<font color="#808080">.</font>Inout_File<font color="#808080">,</font>ARQ_USUARIO<font color="#808080">);
  </font><font color="#0000FF">else </font>put_line<font color="#808080">(</font>MSG_ARQERRO <font color="#808080">&amp; </font><font color="#008080">&quot; --&gt; &quot; </font><font color="#808080">&amp; </font>ARQ_USUARIO<font color="#808080">);
  </font><font color="#0000FF">end if</font><font color="#808080">; 
  </font><font color="#0000FF">if </font>VendaIO<font color="#808080">.</font>is_open<font color="#808080">(</font>tfVenda<font color="#808080">)=</font>false <font color="#0000FF">then
    </font>VendaIO<font color="#808080">.</font>open<font color="#808080">(</font>tfVenda<font color="#808080">,</font>VendaIO<font color="#808080">.</font>Inout_File<font color="#808080">,</font>ARQ_VENDA<font color="#808080">);
  </font><font color="#0000FF">else </font>put_line<font color="#808080">(</font>MSG_ARQERRO <font color="#808080">&amp; </font><font color="#008080">&quot; --&gt; &quot; </font><font color="#808080">&amp; </font>ARQ_VENDA<font color="#808080">);
  </font><font color="#0000FF">end if</font><font color="#808080">; 
</font><font color="#0000FF">else
  </font>AssuntoIO<font color="#808080">.</font>create<font color="#808080">(</font>tfAssunto<font color="#808080">,</font>AssuntoIO<font color="#808080">.</font>Inout_File<font color="#808080">,</font>ARQ_ASSUNTO<font color="#808080">);
  </font>AutorIO<font color="#808080">.</font>create<font color="#808080">(</font>tfAutor<font color="#808080">,</font>AutorIO<font color="#808080">.</font>Inout_File<font color="#808080">,</font>ARQ_AUTOR<font color="#808080">);
  </font>EditoraIO<font color="#808080">.</font>create<font color="#808080">(</font>tfEditora<font color="#808080">,</font>EditoraIO<font color="#808080">.</font>Inout_File<font color="#808080">,</font>ARQ_EDITORA<font color="#808080">);
  </font>IdiomaIO<font color="#808080">.</font>create<font color="#808080">(</font>tfIdioma<font color="#808080">,</font>IdiomaIO<font color="#808080">.</font>Inout_File<font color="#808080">,</font>ARQ_IDIOMA<font color="#808080">);
  </font>EnderecoIO<font color="#808080">.</font>create<font color="#808080">(</font>tfEndereco<font color="#808080">,</font>EnderecoIO<font color="#808080">.</font>Inout_File<font color="#808080">,</font>ARQ_ENDERECO<font color="#808080">);
  </font>PaisIO<font color="#808080">.</font>create<font color="#808080">(</font>tfPais<font color="#808080">,</font>PaisIO<font color="#808080">.</font>Inout_File<font color="#808080">,</font>ARQ_PAIS<font color="#808080">);
  </font>ProfissaoIO<font color="#808080">.</font>create<font color="#808080">(</font>tfProfissao<font color="#808080">,</font>ProfissaoIO<font color="#808080">.</font>Inout_File<font color="#808080">,</font>ARQ_PROFISSAO<font color="#808080">);
  </font>LivroIO<font color="#808080">.</font>create<font color="#808080">(</font>tfLivro<font color="#808080">,</font>LivroIO<font color="#808080">.</font>Inout_File<font color="#808080">,</font>ARQ_LIVRO<font color="#808080">);
  </font>LivroAssIO<font color="#808080">.</font>create<font color="#808080">(</font>tfLivroAss<font color="#808080">,</font>LivroAssIO<font color="#808080">.</font>Inout_File<font color="#808080">,</font>ARQ_LIVASS<font color="#808080">);
  </font>LivroAutIO<font color="#808080">.</font>create<font color="#808080">(</font>tfLivroAut<font color="#808080">,</font>LivroAutIO<font color="#808080">.</font>Inout_File<font color="#808080">,</font>ARQ_LIVAUT<font color="#808080">);
  </font>ClienteIO<font color="#808080">.</font>create<font color="#808080">(</font>tfCliente<font color="#808080">,</font>ClienteIO<font color="#808080">.</font>Inout_File<font color="#808080">,</font>ARQ_CLIENTE<font color="#808080">);
  </font>UsuarioIO<font color="#808080">.</font>create<font color="#808080">(</font>tfUsuario<font color="#808080">,</font>UsuarioIO<font color="#808080">.</font>Inout_File<font color="#808080">,</font>ARQ_USUARIO<font color="#808080">);
  </font>VendaIO<font color="#808080">.</font>create<font color="#808080">(</font>tfVenda<font color="#808080">,</font>VendaIO<font color="#808080">.</font>Inout_File<font color="#808080">,</font>ARQ_VENDA<font color="#808080">);
</font><font color="#0000FF">end if</font><font color="#808080">;
</font><font color="#0000FF">end </font>abrecriaArqs<font color="#808080">;

</font><font color="#FF0000">-- ----------------------------------------------------------------------------
-- Fecha todos os arquivos abertos.
-- ----------------------------------------------------------------------------
</font><font color="#0000FF">procedure </font>fechaArqs <font color="#0000FF">is
begin
 </font>close<font color="#808080">(</font>tfAssunto<font color="#808080">);
 </font>close<font color="#808080">(</font>tfAutor<font color="#808080">);
 </font>close<font color="#808080">(</font>tfEditora<font color="#808080">);
 </font>close<font color="#808080">(</font>tfIdioma<font color="#808080">);
 </font>close<font color="#808080">(</font>tfEndereco<font color="#808080">);
 </font>close<font color="#808080">(</font>tfPais<font color="#808080">);
 </font>close<font color="#808080">(</font>tfProfissao<font color="#808080">);
 </font>close<font color="#808080">(</font>tfLivro<font color="#808080">);
 </font>close<font color="#808080">(</font>tfLivroAss<font color="#808080">);
 </font>close<font color="#808080">(</font>tfLivroAut<font color="#808080">);
 </font>close<font color="#808080">(</font>tfCliente<font color="#808080">);
 </font>close<font color="#808080">(</font>tfUsuario<font color="#808080">);
 </font>close<font color="#808080">(</font>tfVenda<font color="#808080">);
</font><font color="#0000FF">end </font>fechaArqs<font color="#808080">;

</font><font color="#FF0000">-- ----------------------------------------------------------------------------
-- Pesquisa um registro atrav&eacute;s de um valor chave num arquivo.
-- sArq - o arquivo
-- sChave - a chave a ser pesquisada
-- nPosChave - a posicao inicial da chave dentro do registro
-- nTamChave - o tamanho da chave dentro do registro
-- nTamLinha - o tamanho do registro
-- retorna - o registro pesquisado
-- ----------------------------------------------------------------------------
</font><font color="#0000FF">function </font>pesqArq<font color="#808080">(</font>sArq<font color="#808080">: </font><font color="#0000FF">in </font>ctTArqs<font color="#808080">; </font>sChave<font color="#808080">: </font><font color="#0000FF">in </font>ustring<font color="#808080">; </font>nPosChave<font color="#808080">,
        </font>nTamChave<font color="#808080">, </font>nTamLinha<font color="#808080">: </font><font color="#0000FF">in </font>integer<font color="#808080">) </font><font color="#0000FF">return </font>ustring <font color="#0000FF">is
</font>slinha<font color="#808080">: </font>ustring<font color="#808080">;
</font>sRes<font color="#808080">: </font>ustring<font color="#808080">;
</font>bQuebra<font color="#808080">: </font>boolean<font color="#808080">;
</font>nPosicao<font color="#808080">: </font>integer<font color="#808080">;
</font><font color="#0000FF">begin
</font>bQuebra<font color="#808080">:=</font>false<font color="#808080">;
</font>seekArq<font color="#808080">(</font>sArq<font color="#808080">, </font><font color="#FF00FF">1</font><font color="#808080">);
</font><font color="#0000FF">while </font><font color="#808080">(</font>not fimArq<font color="#808080">(</font>sArq<font color="#808080">)) </font><font color="#0000FF">and </font><font color="#808080">(</font>bQuebra<font color="#808080">=</font>false<font color="#808080">) </font><font color="#0000FF">loop
  </font>slinha<font color="#808080">:=</font>lerArq<font color="#808080">(</font>sArq<font color="#808080">);
  </font>sres<font color="#808080">:=</font>trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha<font color="#808080">,</font>nPosChave<font color="#808080">,</font>nTamChave<font color="#808080">), </font>Both<font color="#808080">);
  </font><font color="#0000FF">if </font>sres<font color="#808080">=</font>sChave <font color="#0000FF">then
     </font>bQuebra<font color="#808080">:=</font>true<font color="#808080">;
  </font><font color="#0000FF">end if</font><font color="#808080">;
</font><font color="#0000FF">end loop</font><font color="#808080">;
</font>nPosicao<font color="#808080">:=</font>posArq<font color="#808080">(</font>sArq<font color="#808080">)-(</font>nTamLinha <font color="#808080">+ </font>TAM_CRLF<font color="#808080">);
</font><font color="#0000FF">if </font>nPosicao <font color="#808080">&gt; </font><font color="#FF00FF">0 </font><font color="#0000FF">then
   </font>seekArq<font color="#808080">(</font>sArq<font color="#808080">, </font>nPosicao<font color="#808080">);
</font><font color="#0000FF">else
   </font>seekArq<font color="#808080">(</font>sArq<font color="#808080">, </font><font color="#FF00FF">1</font><font color="#808080">);
</font><font color="#0000FF">end if</font><font color="#808080">;
</font><font color="#0000FF">if </font>sRes<font color="#808080">/=</font>sChave <font color="#0000FF">then
   return </font>U<font color="#808080">(</font><font color="#008080">&quot;&quot;</font><font color="#808080">);
</font><font color="#0000FF">else
   return </font>copy<font color="#808080">(</font>slinha<font color="#808080">,</font><font color="#FF00FF">1</font><font color="#808080">,</font>nTamLinha<font color="#808080">);
</font><font color="#0000FF">end if</font><font color="#808080">;
</font><font color="#0000FF">end </font>pesqArq<font color="#808080">;

</font><font color="#FF0000">-- ----------------------------------------------------------------------------
-- Pesquisa se tem linha exclu&iacute;da sen&atilde;o vai para a &uacute;ltima linha do arquivo.
-- sArq - o arquivo
-- nTamLinha - o tamanho do registro
-- ----------------------------------------------------------------------------
</font><font color="#0000FF">procedure </font>pesqLinhaExcluida<font color="#808080">(</font>sArq<font color="#808080">: </font><font color="#0000FF">in </font>ctTArqs<font color="#808080">; </font>nTamLinha<font color="#808080">: </font><font color="#0000FF">in </font>integer<font color="#808080">) </font><font color="#0000FF">is
</font>sExcluido<font color="#808080">: </font>ustring<font color="#808080">;
</font><font color="#0000FF">begin
</font>sExcluido<font color="#808080">:=</font>pesqArq<font color="#808080">(</font>sArq<font color="#808080">, </font>U<font color="#808080">(</font><font color="#008080">&quot;*&quot;</font><font color="#808080">), </font><font color="#FF00FF">1</font><font color="#808080">, </font><font color="#FF00FF">1</font><font color="#808080">, </font>nTamLinha<font color="#808080">);
</font><font color="#0000FF">if </font>sExcluido<font color="#808080">=</font>U<font color="#808080">(</font><font color="#008080">&quot;&quot;</font><font color="#808080">) </font><font color="#0000FF">then
   </font>seekArq<font color="#808080">(</font>sArq<font color="#808080">, </font>tamArq<font color="#808080">(</font>sArq<font color="#808080">));
</font><font color="#0000FF">end if</font><font color="#808080">;
</font><font color="#0000FF">end </font>pesqLinhaExcluida<font color="#808080">;

</font><font color="#FF0000">-- ----------------------------------------------------------------------------
-- Pesquisa o maior c&oacute;digo num arquivo.
-- sArq - o arquivo
-- nPosChave - a posicao inicial da chave dentro do registro
-- nTamChave - o tamanho da chave dentro do registro
-- nTamLinha - o tamanho do registro
-- retorna - o maior c&oacute;digo
-- ----------------------------------------------------------------------------
</font><font color="#0000FF">function </font>pesqMaxCod<font color="#808080">(</font>sArq<font color="#808080">: </font><font color="#0000FF">in </font>ctTArqs<font color="#808080">; </font>nPosChave<font color="#808080">,
        </font>nTamChave<font color="#808080">, </font>nTamLinha<font color="#808080">: </font><font color="#0000FF">in </font>integer<font color="#808080">) </font><font color="#0000FF">return </font>ustring <font color="#0000FF">is
</font>slinha<font color="#808080">, </font>sRes<font color="#808080">: </font>ustring<font color="#808080">;
</font>bQuebra<font color="#808080">: </font>boolean<font color="#808080">;
</font>nMaior<font color="#808080">, </font>nCod<font color="#808080">: </font>integer<font color="#808080">;
</font><font color="#0000FF">begin
</font>bQuebra<font color="#808080">:=</font>false<font color="#808080">;
</font>nMaior<font color="#808080">:=</font><font color="#FF00FF">0</font><font color="#808080">;
</font>seekArq<font color="#808080">(</font>sArq<font color="#808080">, </font><font color="#FF00FF">1</font><font color="#808080">);
</font><font color="#0000FF">while </font><font color="#808080">(</font>not fimArq<font color="#808080">(</font>sArq<font color="#808080">)) </font><font color="#0000FF">and </font><font color="#808080">(</font>bQuebra<font color="#808080">=</font>false<font color="#808080">) </font><font color="#0000FF">loop
  </font>slinha<font color="#808080">:=</font>lerArq<font color="#808080">(</font>sArq<font color="#808080">);
  </font>sres<font color="#808080">:=</font>trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha<font color="#808080">,</font>nPosChave<font color="#808080">,</font>nTamChave<font color="#808080">), </font>Both<font color="#808080">);
  </font>ncod<font color="#808080">:=</font>Value_Integer<font color="#808080">(</font>S<font color="#808080">(</font>sres<font color="#808080">));
  </font><font color="#0000FF">if </font>nCod <font color="#808080">&gt; </font>nMaior <font color="#0000FF">then
     </font>nMaior<font color="#808080">:=</font>nCod<font color="#808080">;
  </font><font color="#0000FF">end if</font><font color="#808080">;
</font><font color="#0000FF">end loop</font><font color="#808080">;
</font>pesqLinhaExcluida<font color="#808080">(</font>sArq<font color="#808080">, </font>nTamLinha<font color="#808080">);
</font>itostr<font color="#808080">((</font>nMaior<font color="#808080">+</font><font color="#FF00FF">1</font><font color="#808080">),</font>sres<font color="#808080">);
</font><font color="#0000FF">return </font>sres<font color="#808080">;
</font><font color="#0000FF">end </font>pesqMaxCod<font color="#808080">;

</font><font color="#FF0000">-- ----------------------------------------------------------------------------
-- Grava os registros num determinado arquivo.
-- sArq - o arquivo
-- sTexto - o registro a ser gravado
-- sMsgAcerto - a mensagem caso o registro foi gravado
-- sMsgErro - a mensagem caso o registro n&atilde;o foi gravado
-- ----------------------------------------------------------------------------
</font><font color="#0000FF">procedure </font>escreveArq<font color="#808080">(</font>sArq<font color="#808080">: </font><font color="#0000FF">in </font>ctTArqs<font color="#808080">; </font>sTexto<font color="#808080">: </font><font color="#0000FF">in </font>ustring<font color="#808080">; </font>sMsgAcerto<font color="#808080">,
</font>	sMsgErro<font color="#808080">: </font><font color="#0000FF">in </font>string<font color="#808080">) </font><font color="#0000FF">is
begin
</font>gravarArq<font color="#808080">(</font>sArq<font color="#808080">, </font>sTexto<font color="#808080">);
</font><font color="#FF0000">-- if nStatus &gt; 0 then
   </font>put_line<font color="#808080">(</font>sMsgAcerto<font color="#808080">);
</font><font color="#FF0000">-- else
--   put_line(sMsgErro);
-- end if;
</font><font color="#0000FF">end </font>escreveArq<font color="#808080">;

</font><font color="#FF0000">-- ----------------------------------------------------------------------------
-- Monta o tamanho do registro no arquivo de acordo com o tipo de arquivo.
-- sreg - o tipo de arquivo
-- retorna - o registro montado
-- ----------------------------------------------------------------------------
</font><font color="#0000FF">function </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">: </font><font color="#0000FF">in </font>ctArqs<font color="#808080">) </font><font color="#0000FF">return </font>ustring <font color="#0000FF">is
</font>slinha<font color="#808080">: </font>ustring<font color="#808080">;
</font><font color="#0000FF">begin
</font>slinha<font color="#808080">:=</font>U<font color="#808080">(</font><font color="#008080">&quot;&quot;</font><font color="#808080">);
</font><font color="#0000FF">if </font>sreg<font color="#808080">=</font>opAssunto <font color="#0000FF">then
   </font>slinha<font color="#808080">:=</font>esp<font color="#808080">(</font>tAssunto<font color="#808080">.</font>codigo<font color="#808080">,</font><font color="#FF00FF">10</font><font color="#808080">) &amp; </font>esp<font color="#808080">(</font>tAssunto<font color="#808080">.</font>assunto<font color="#808080">,</font><font color="#FF00FF">30</font><font color="#808080">);
</font><font color="#0000FF">elsif </font>sreg<font color="#808080">=</font>opAutor <font color="#0000FF">then
   </font>slinha<font color="#808080">:=</font>esp<font color="#808080">(</font>tAutor<font color="#808080">.</font>codigo<font color="#808080">,</font><font color="#FF00FF">10</font><font color="#808080">) &amp; </font>esp<font color="#808080">(</font>tAutor<font color="#808080">.</font>autor<font color="#808080">,</font><font color="#FF00FF">30</font><font color="#808080">);
</font><font color="#0000FF">elsif </font>sreg<font color="#808080">=</font>opEditora <font color="#0000FF">then
   </font>slinha<font color="#808080">:=</font>esp<font color="#808080">(</font>tEditora<font color="#808080">.</font>codigo<font color="#808080">,</font><font color="#FF00FF">10</font><font color="#808080">) &amp; </font>esp<font color="#808080">(</font>tEditora<font color="#808080">.</font>editora<font color="#808080">,</font><font color="#FF00FF">50</font><font color="#808080">);
</font><font color="#0000FF">elsif </font>sreg<font color="#808080">=</font>opEndereco <font color="#0000FF">then
   </font>slinha<font color="#808080">:=</font>esp<font color="#808080">(</font>tEndereco<font color="#808080">.</font>codigo<font color="#808080">,</font><font color="#FF00FF">10</font><font color="#808080">) &amp; </font>esp<font color="#808080">(</font>tEndereco<font color="#808080">.</font>logradouro<font color="#808080">,</font><font color="#FF00FF">40</font><font color="#808080">) &amp; 
   </font>esp<font color="#808080">(</font>tEndereco<font color="#808080">.</font>bairro<font color="#808080">,</font><font color="#FF00FF">15</font><font color="#808080">) &amp; </font>esp<font color="#808080">(</font>tEndereco<font color="#808080">.</font>cep<font color="#808080">,</font><font color="#FF00FF">8</font><font color="#808080">) &amp; 
   </font>esp<font color="#808080">(</font>tEndereco<font color="#808080">.</font>cidade<font color="#808080">,</font><font color="#FF00FF">30</font><font color="#808080">) &amp; </font>esp<font color="#808080">(</font>tEndereco<font color="#808080">.</font>estado<font color="#808080">,</font><font color="#FF00FF">20</font><font color="#808080">);
</font><font color="#0000FF">elsif </font>sreg<font color="#808080">=</font>opIdioma <font color="#0000FF">then
   </font>slinha<font color="#808080">:=</font>esp<font color="#808080">(</font>tIdioma<font color="#808080">.</font>codigo<font color="#808080">,</font><font color="#FF00FF">10</font><font color="#808080">) &amp; </font>esp<font color="#808080">(</font>tIdioma<font color="#808080">.</font>idioma<font color="#808080">,</font><font color="#FF00FF">20</font><font color="#808080">);
</font><font color="#0000FF">elsif </font>sreg<font color="#808080">=</font>opPais <font color="#0000FF">then
   </font>slinha<font color="#808080">:=</font>esp<font color="#808080">(</font>tPais<font color="#808080">.</font>codigo<font color="#808080">,</font><font color="#FF00FF">3</font><font color="#808080">) &amp; </font>esp<font color="#808080">(</font>tPais<font color="#808080">.</font>pais<font color="#808080">,</font><font color="#FF00FF">50</font><font color="#808080">);
</font><font color="#0000FF">elsif </font>sreg<font color="#808080">=</font>opProfissao <font color="#0000FF">then
   </font>slinha<font color="#808080">:=</font>esp<font color="#808080">(</font>tProfissao<font color="#808080">.</font>codigo<font color="#808080">,</font><font color="#FF00FF">10</font><font color="#808080">) &amp; </font>esp<font color="#808080">(</font>tProfissao<font color="#808080">.</font>profissao<font color="#808080">,</font><font color="#FF00FF">50</font><font color="#808080">);
</font><font color="#0000FF">elsif </font>sreg<font color="#808080">=</font>opUsuario <font color="#0000FF">then
   </font>slinha<font color="#808080">:=</font>esp<font color="#808080">(</font>tUsuario<font color="#808080">.</font>login<font color="#808080">,</font><font color="#FF00FF">10</font><font color="#808080">) &amp; </font>esp<font color="#808080">(</font>tUsuario<font color="#808080">.</font>senha<font color="#808080">,</font><font color="#FF00FF">10</font><font color="#808080">);
</font><font color="#0000FF">elsif </font>sreg<font color="#808080">=</font>opLivro <font color="#0000FF">then
   </font>slinha<font color="#808080">:=</font>esp<font color="#808080">(</font>tLivro<font color="#808080">.</font>isbn<font color="#808080">,</font><font color="#FF00FF">13</font><font color="#808080">) &amp; </font>esp<font color="#808080">(</font>tLivro<font color="#808080">.</font>titulo<font color="#808080">,</font><font color="#FF00FF">50</font><font color="#808080">) &amp; </font>esp<font color="#808080">(</font>tLivro<font color="#808080">.</font>edicao<font color="#808080">,</font><font color="#FF00FF">10</font><font color="#808080">) &amp; 
   </font>esp<font color="#808080">(</font>tLivro<font color="#808080">.</font>anopubli<font color="#808080">,</font><font color="#FF00FF">10</font><font color="#808080">) &amp; </font>esp<font color="#808080">(</font>tLivro<font color="#808080">.</font>codeditora<font color="#808080">,</font><font color="#FF00FF">10</font><font color="#808080">) &amp; </font>esp<font color="#808080">(</font>tLivro<font color="#808080">.</font>volume<font color="#808080">,</font><font color="#FF00FF">10</font><font color="#808080">) &amp; 
   </font>esp<font color="#808080">(</font>tLivro<font color="#808080">.</font>codidioma<font color="#808080">,</font><font color="#FF00FF">10</font><font color="#808080">) &amp; </font>esp<font color="#808080">(</font>tLivro<font color="#808080">.</font>npaginas<font color="#808080">,</font><font color="#FF00FF">10</font><font color="#808080">) &amp; </font>esp<font color="#808080">(</font>tLivro<font color="#808080">.</font>preco<font color="#808080">,</font><font color="#FF00FF">10</font><font color="#808080">) &amp; 
   </font>esp<font color="#808080">(</font>tLivro<font color="#808080">.</font>qtdestoque<font color="#808080">,</font><font color="#FF00FF">10</font><font color="#808080">);
</font><font color="#0000FF">elsif </font>sreg<font color="#808080">=</font>opLivroAss <font color="#0000FF">then
   </font>slinha<font color="#808080">:=</font>esp<font color="#808080">(</font>tLivroAss<font color="#808080">.</font>isbn<font color="#808080">,</font><font color="#FF00FF">13</font><font color="#808080">) &amp; </font>esp<font color="#808080">(</font>tlivroAss<font color="#808080">.</font>codassunto<font color="#808080">,</font><font color="#FF00FF">10</font><font color="#808080">);
</font><font color="#0000FF">elsif </font>sreg<font color="#808080">=</font>opLivroAut <font color="#0000FF">then
   </font>slinha<font color="#808080">:=</font>esp<font color="#808080">(</font>tLivroAut<font color="#808080">.</font>isbn<font color="#808080">,</font><font color="#FF00FF">13</font><font color="#808080">) &amp; </font>esp<font color="#808080">(</font>tlivroAut<font color="#808080">.</font>codautor<font color="#808080">,</font><font color="#FF00FF">10</font><font color="#808080">);
</font><font color="#0000FF">elsif </font>sreg<font color="#808080">=</font>opCliente <font color="#0000FF">then
   </font>slinha<font color="#808080">:=</font>esp<font color="#808080">(</font>tCliente<font color="#808080">.</font>cpf<font color="#808080">,</font><font color="#FF00FF">14</font><font color="#808080">) &amp; </font>esp<font color="#808080">(</font>tCliente<font color="#808080">.</font>nome<font color="#808080">,</font><font color="#FF00FF">30</font><font color="#808080">) &amp; </font>esp<font color="#808080">(</font>tCliente<font color="#808080">.</font>email<font color="#808080">,</font><font color="#FF00FF">30</font><font color="#808080">) &amp; 
   </font>esp<font color="#808080">(</font>tCliente<font color="#808080">.</font>identidade<font color="#808080">,</font><font color="#FF00FF">10</font><font color="#808080">) &amp; </font>esp<font color="#808080">(</font>tCliente<font color="#808080">.</font>sexo<font color="#808080">,</font><font color="#FF00FF">1</font><font color="#808080">) &amp; </font>esp<font color="#808080">(</font>tCliente<font color="#808080">.</font>telefone<font color="#808080">,</font><font color="#FF00FF">17</font><font color="#808080">) &amp; 
   </font>esp<font color="#808080">(</font>tCliente<font color="#808080">.</font>dtnascimento<font color="#808080">,</font><font color="#FF00FF">10</font><font color="#808080">) &amp; </font>esp<font color="#808080">(</font>tCliente<font color="#808080">.</font>codendereco<font color="#808080">,</font><font color="#FF00FF">10</font><font color="#808080">) &amp; 
   </font>esp<font color="#808080">(</font>tCliente<font color="#808080">.</font>codpais<font color="#808080">,</font><font color="#FF00FF">3</font><font color="#808080">) &amp; </font>esp<font color="#808080">(</font>tCliente<font color="#808080">.</font>codprofissao<font color="#808080">,</font><font color="#FF00FF">10</font><font color="#808080">);
</font><font color="#0000FF">elsif </font>sreg<font color="#808080">=</font>opVenda <font color="#0000FF">then
   </font>slinha<font color="#808080">:=</font>esp<font color="#808080">(</font>tVenda<font color="#808080">.</font>dthrvenda<font color="#808080">,</font><font color="#FF00FF">19</font><font color="#808080">) &amp; </font>esp<font color="#808080">(</font>tVenda<font color="#808080">.</font>cpf<font color="#808080">,</font><font color="#FF00FF">14</font><font color="#808080">) &amp; </font>esp<font color="#808080">(</font>tVenda<font color="#808080">.</font>isbn<font color="#808080">,</font><font color="#FF00FF">13</font><font color="#808080">) &amp; 
   </font>esp<font color="#808080">(</font>tVenda<font color="#808080">.</font>precovenda<font color="#808080">,</font><font color="#FF00FF">10</font><font color="#808080">);
</font><font color="#0000FF">end if</font><font color="#808080">;
</font><font color="#0000FF">return </font>slinha<font color="#808080">;
</font><font color="#0000FF">end </font>LinhaReg<font color="#808080">;

</font><font color="#FF0000">-- ----------------------------------------------------------------------------
-- Retorna o tamanho do registro no arquivo de acordo com o tipo de arquivo.
-- sreg - o tipo de arquivo
-- retorna - o tamanho do registro
-- ----------------------------------------------------------------------------
</font><font color="#0000FF">function </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">: </font><font color="#0000FF">in </font>ctArqs<font color="#808080">) </font><font color="#0000FF">return </font>integer <font color="#0000FF">is
</font>nret<font color="#808080">: </font>integer<font color="#808080">;
</font><font color="#0000FF">begin
</font>nret<font color="#808080">:=</font><font color="#FF00FF">0</font><font color="#808080">;
</font><font color="#0000FF">if </font>sreg<font color="#808080">=</font>opAssunto <font color="#0000FF">then </font>nret<font color="#808080">:=</font>TAM_ASSUNTO<font color="#808080">;
</font><font color="#0000FF">elsif </font>sreg<font color="#808080">=</font>opAutor <font color="#0000FF">then </font>nret<font color="#808080">:=</font>TAM_AUTOR<font color="#808080">;
</font><font color="#0000FF">elsif </font>sreg<font color="#808080">=</font>opEditora <font color="#0000FF">then </font>nret<font color="#808080">:=</font>TAM_EDITORA<font color="#808080">;
</font><font color="#0000FF">elsif </font>sreg<font color="#808080">=</font>opEndereco <font color="#0000FF">then </font>nret<font color="#808080">:=</font>TAM_ENDERECO<font color="#808080">;
</font><font color="#0000FF">elsif </font>sreg<font color="#808080">=</font>opIdioma <font color="#0000FF">then </font>nret<font color="#808080">:=</font>TAM_IDIOMA<font color="#808080">;
</font><font color="#0000FF">elsif </font>sreg<font color="#808080">=</font>opPais <font color="#0000FF">then </font>nret<font color="#808080">:=</font>TAM_PAIS<font color="#808080">;
</font><font color="#0000FF">elsif </font>sreg<font color="#808080">=</font>opProfissao <font color="#0000FF">then </font>nret<font color="#808080">:=</font>TAM_PROFISSAO<font color="#808080">;
</font><font color="#0000FF">elsif </font>sreg<font color="#808080">=</font>opUsuario <font color="#0000FF">then </font>nret<font color="#808080">:=</font>TAM_USUARIO<font color="#808080">;
</font><font color="#0000FF">elsif </font>sreg<font color="#808080">=</font>opLivro <font color="#0000FF">then </font>nret<font color="#808080">:=</font>TAM_LIVRO<font color="#808080">;
</font><font color="#0000FF">elsif </font>sreg<font color="#808080">=</font>opLivroAss <font color="#0000FF">then </font>nret<font color="#808080">:=</font>TAM_LIVASS<font color="#808080">;
</font><font color="#0000FF">elsif </font>sreg<font color="#808080">=</font>opLivroAut <font color="#0000FF">then </font>nret<font color="#808080">:=</font>TAM_LIVAUT<font color="#808080">;
</font><font color="#0000FF">elsif </font>sreg<font color="#808080">=</font>opCliente <font color="#0000FF">then </font>nret<font color="#808080">:=</font>TAM_CLIENTE<font color="#808080">;
</font><font color="#0000FF">elsif </font>sreg<font color="#808080">=</font>opVenda <font color="#0000FF">then </font>nret<font color="#808080">:=</font>TAM_VENDA<font color="#808080">;
</font><font color="#0000FF">end if</font><font color="#808080">;
</font><font color="#0000FF">return </font>nret<font color="#808080">;
</font><font color="#0000FF">end </font>tamReg<font color="#808080">;

</font><font color="#FF0000">-- ----------------------------------------------------------------------------
-- Seleciona o rotulo de cada campo de acordo com o tipo de arquivo.
-- sreg - o tipo de arquivo
-- nNum - indica qual rotulo ser&aacute; retornado
-- retorna - o rotulo
-- ----------------------------------------------------------------------------
</font><font color="#0000FF">function </font>rotulo<font color="#808080">(</font>sreg<font color="#808080">: </font><font color="#0000FF">in </font>ctArqs<font color="#808080">; </font>nNum<font color="#808080">: </font><font color="#0000FF">in </font>integer<font color="#808080">) </font><font color="#0000FF">return </font>ustring <font color="#0000FF">is
</font>sret<font color="#808080">: </font>ustring<font color="#808080">;
</font><font color="#0000FF">begin
if </font>sreg<font color="#808080">=</font>opAssunto <font color="#0000FF">then
   case </font>nNum <font color="#0000FF">is
     when </font><font color="#FF00FF">0 </font><font color="#808080">=&gt; </font>sret<font color="#808080">:=</font>U<font color="#808080">(</font><font color="#008080">&quot;Assunto(s) n&atilde;o encontrado(s)!&quot;</font><font color="#808080">);
     </font><font color="#0000FF">when </font><font color="#FF00FF">1 </font><font color="#808080">=&gt; </font>sret<font color="#808080">:=</font>U<font color="#808080">(</font><font color="#008080">&quot;C&oacute;digo do assunto: &quot;</font><font color="#808080">);
          </font>g_nPosChave<font color="#808080">:=</font><font color="#FF00FF">1</font><font color="#808080">;
          </font>g_nTamChave<font color="#808080">:=</font><font color="#FF00FF">10</font><font color="#808080">;
     </font><font color="#0000FF">when </font><font color="#FF00FF">2 </font><font color="#808080">=&gt; </font>sret<font color="#808080">:=</font>U<font color="#808080">(</font><font color="#008080">&quot;Assunto: &quot;</font><font color="#808080">);
          </font>g_nPosChave<font color="#808080">:=</font><font color="#FF00FF">11</font><font color="#808080">;
          </font>g_nTamChave<font color="#808080">:=</font><font color="#FF00FF">30</font><font color="#808080">;
     </font><font color="#0000FF">when others </font><font color="#808080">=&gt; </font><font color="#0000FF">null</font><font color="#808080">;
   </font><font color="#0000FF">end case</font><font color="#808080">;
</font><font color="#0000FF">elsif </font>sreg<font color="#808080">=</font>opAutor <font color="#0000FF">then
   case </font>nNum <font color="#0000FF">is
     when </font><font color="#FF00FF">0 </font><font color="#808080">=&gt; </font>sret<font color="#808080">:=</font>U<font color="#808080">(</font><font color="#008080">&quot;Autor(es) n&atilde;o encontrado(s)!&quot;</font><font color="#808080">);
     </font><font color="#0000FF">when </font><font color="#FF00FF">1 </font><font color="#808080">=&gt; </font>sret<font color="#808080">:=</font>U<font color="#808080">(</font><font color="#008080">&quot;C&oacute;digo do autor: &quot;</font><font color="#808080">);
          </font>g_nPosChave<font color="#808080">:=</font><font color="#FF00FF">1</font><font color="#808080">;
          </font>g_nTamChave<font color="#808080">:=</font><font color="#FF00FF">10</font><font color="#808080">;
     </font><font color="#0000FF">when </font><font color="#FF00FF">2 </font><font color="#808080">=&gt; </font>sret<font color="#808080">:=</font>U<font color="#808080">(</font><font color="#008080">&quot;Autor: &quot;</font><font color="#808080">);
          </font>g_nPosChave<font color="#808080">:=</font><font color="#FF00FF">11</font><font color="#808080">;
          </font>g_nTamChave<font color="#808080">:=</font><font color="#FF00FF">30</font><font color="#808080">;
     </font><font color="#0000FF">when others </font><font color="#808080">=&gt; </font><font color="#0000FF">null</font><font color="#808080">;
   </font><font color="#0000FF">end case</font><font color="#808080">;
</font><font color="#0000FF">elsif </font>sreg<font color="#808080">=</font>opEditora <font color="#0000FF">then
   case </font>nNum <font color="#0000FF">is
     when </font><font color="#FF00FF">0 </font><font color="#808080">=&gt; </font>sret<font color="#808080">:=</font>U<font color="#808080">(</font><font color="#008080">&quot;Editora(s) n&atilde;o encontrada(s)!&quot;</font><font color="#808080">);
     </font><font color="#0000FF">when </font><font color="#FF00FF">1 </font><font color="#808080">=&gt; </font>sret<font color="#808080">:=</font>U<font color="#808080">(</font><font color="#008080">&quot;C&oacute;digo da editora: &quot;</font><font color="#808080">);
          </font>g_nPosChave<font color="#808080">:=</font><font color="#FF00FF">1</font><font color="#808080">;
          </font>g_nTamChave<font color="#808080">:=</font><font color="#FF00FF">10</font><font color="#808080">;
     </font><font color="#0000FF">when </font><font color="#FF00FF">2 </font><font color="#808080">=&gt; </font>sret<font color="#808080">:=</font>U<font color="#808080">(</font><font color="#008080">&quot;Editora: &quot;</font><font color="#808080">);
          </font>g_nPosChave<font color="#808080">:=</font><font color="#FF00FF">11</font><font color="#808080">;
          </font>g_nTamChave<font color="#808080">:=</font><font color="#FF00FF">50</font><font color="#808080">;
     </font><font color="#0000FF">when others </font><font color="#808080">=&gt; </font><font color="#0000FF">null</font><font color="#808080">;
   </font><font color="#0000FF">end case</font><font color="#808080">;
</font><font color="#0000FF">elsif </font>sreg<font color="#808080">=</font>opEndereco <font color="#0000FF">then
   case </font>nNum <font color="#0000FF">is
     when </font><font color="#FF00FF">0 </font><font color="#808080">=&gt; </font>sret<font color="#808080">:=</font>U<font color="#808080">(</font><font color="#008080">&quot;Endere&ccedil;o(s) n&atilde;o encontrado(s)!&quot;</font><font color="#808080">);
     </font><font color="#0000FF">when </font><font color="#FF00FF">1 </font><font color="#808080">=&gt; </font>sret<font color="#808080">:=</font>U<font color="#808080">(</font><font color="#008080">&quot;C&oacute;digo do endere&ccedil;o: &quot;</font><font color="#808080">);
          </font>g_nPosChave<font color="#808080">:=</font><font color="#FF00FF">1</font><font color="#808080">;
          </font>g_nTamChave<font color="#808080">:=</font><font color="#FF00FF">10</font><font color="#808080">;
     </font><font color="#0000FF">when </font><font color="#FF00FF">2 </font><font color="#808080">=&gt; </font>sret<font color="#808080">:=</font>U<font color="#808080">(</font><font color="#008080">&quot;Logradouro: &quot;</font><font color="#808080">);
          </font>g_nPosChave<font color="#808080">:=</font><font color="#FF00FF">11</font><font color="#808080">;
          </font>g_nTamChave<font color="#808080">:=</font><font color="#FF00FF">40</font><font color="#808080">;
     </font><font color="#0000FF">when </font><font color="#FF00FF">3 </font><font color="#808080">=&gt; </font>sret<font color="#808080">:=</font>U<font color="#808080">(</font><font color="#008080">&quot;Bairro: &quot;</font><font color="#808080">);
          </font>g_nPosChave<font color="#808080">:=</font><font color="#FF00FF">51</font><font color="#808080">;
          </font>g_nTamChave<font color="#808080">:=</font><font color="#FF00FF">15</font><font color="#808080">;
     </font><font color="#0000FF">when </font><font color="#FF00FF">4 </font><font color="#808080">=&gt; </font>sret<font color="#808080">:=</font>U<font color="#808080">(</font><font color="#008080">&quot;CEP: &quot;</font><font color="#808080">);
          </font>g_nPosChave<font color="#808080">:=</font><font color="#FF00FF">66</font><font color="#808080">;
          </font>g_nTamChave<font color="#808080">:=</font><font color="#FF00FF">8</font><font color="#808080">;
     </font><font color="#0000FF">when </font><font color="#FF00FF">5 </font><font color="#808080">=&gt; </font>sret<font color="#808080">:=</font>U<font color="#808080">(</font><font color="#008080">&quot;Cidade: &quot;</font><font color="#808080">);
          </font>g_nPosChave<font color="#808080">:=</font><font color="#FF00FF">74</font><font color="#808080">;
          </font>g_nTamChave<font color="#808080">:=</font><font color="#FF00FF">30</font><font color="#808080">;
     </font><font color="#0000FF">when </font><font color="#FF00FF">6 </font><font color="#808080">=&gt; </font>sret<font color="#808080">:=</font>U<font color="#808080">(</font><font color="#008080">&quot;Estado: &quot;</font><font color="#808080">);
          </font>g_nPosChave<font color="#808080">:=</font><font color="#FF00FF">104</font><font color="#808080">;
          </font>g_nTamChave<font color="#808080">:=</font><font color="#FF00FF">20</font><font color="#808080">;
     </font><font color="#0000FF">when others </font><font color="#808080">=&gt; </font><font color="#0000FF">null</font><font color="#808080">;
   </font><font color="#0000FF">end case</font><font color="#808080">;
</font><font color="#0000FF">elsif </font>sreg<font color="#808080">=</font>opIdioma <font color="#0000FF">then
   case </font>nNum <font color="#0000FF">is
     when </font><font color="#FF00FF">0 </font><font color="#808080">=&gt; </font>sret<font color="#808080">:=</font>U<font color="#808080">(</font><font color="#008080">&quot;Idioma(s) n&atilde;o encontrado(s)!&quot;</font><font color="#808080">);
     </font><font color="#0000FF">when </font><font color="#FF00FF">1 </font><font color="#808080">=&gt; </font>sret<font color="#808080">:=</font>U<font color="#808080">(</font><font color="#008080">&quot;C&oacute;digo do idioma: &quot;</font><font color="#808080">);
          </font>g_nPosChave<font color="#808080">:=</font><font color="#FF00FF">1</font><font color="#808080">;
          </font>g_nTamChave<font color="#808080">:=</font><font color="#FF00FF">10</font><font color="#808080">;
     </font><font color="#0000FF">when </font><font color="#FF00FF">2 </font><font color="#808080">=&gt; </font>sret<font color="#808080">:=</font>U<font color="#808080">(</font><font color="#008080">&quot;Idioma: &quot;</font><font color="#808080">);
          </font>g_nPosChave<font color="#808080">:=</font><font color="#FF00FF">11</font><font color="#808080">;
          </font>g_nTamChave<font color="#808080">:=</font><font color="#FF00FF">20</font><font color="#808080">;
     </font><font color="#0000FF">when others </font><font color="#808080">=&gt; </font><font color="#0000FF">null</font><font color="#808080">;
   </font><font color="#0000FF">end case</font><font color="#808080">;
</font><font color="#0000FF">elsif </font>sreg<font color="#808080">=</font>opPais <font color="#0000FF">then
   case </font>nNum <font color="#0000FF">is
     when </font><font color="#FF00FF">0 </font><font color="#808080">=&gt; </font>sret<font color="#808080">:=</font>U<font color="#808080">(</font><font color="#008080">&quot;Pa&iacute;s(es) n&atilde;o encontrado(s)!&quot;</font><font color="#808080">);
     </font><font color="#0000FF">when </font><font color="#FF00FF">1 </font><font color="#808080">=&gt; </font>sret<font color="#808080">:=</font>U<font color="#808080">(</font><font color="#008080">&quot;C&oacute;digo do pa&iacute;s: &quot;</font><font color="#808080">);
          </font>g_nPosChave<font color="#808080">:=</font><font color="#FF00FF">1</font><font color="#808080">;
          </font>g_nTamChave<font color="#808080">:=</font><font color="#FF00FF">3</font><font color="#808080">;
     </font><font color="#0000FF">when </font><font color="#FF00FF">2 </font><font color="#808080">=&gt; </font>sret<font color="#808080">:=</font>U<font color="#808080">(</font><font color="#008080">&quot;Pa&iacute;s: &quot;</font><font color="#808080">);
          </font>g_nPosChave<font color="#808080">:=</font><font color="#FF00FF">4</font><font color="#808080">;
          </font>g_nTamChave<font color="#808080">:=</font><font color="#FF00FF">50</font><font color="#808080">;
     </font><font color="#0000FF">when others </font><font color="#808080">=&gt; </font><font color="#0000FF">null</font><font color="#808080">;
   </font><font color="#0000FF">end case</font><font color="#808080">;
</font><font color="#0000FF">elsif </font>sreg<font color="#808080">=</font>opProfissao <font color="#0000FF">then
   case </font>nNum <font color="#0000FF">is
     when </font><font color="#FF00FF">0 </font><font color="#808080">=&gt; </font>sret<font color="#808080">:=</font>U<font color="#808080">(</font><font color="#008080">&quot;Profiss&atilde;o(es) n&atilde;o encontrada(s)!&quot;</font><font color="#808080">);
     </font><font color="#0000FF">when </font><font color="#FF00FF">1 </font><font color="#808080">=&gt; </font>sret<font color="#808080">:=</font>U<font color="#808080">(</font><font color="#008080">&quot;C&oacute;digo da profiss&atilde;o: &quot;</font><font color="#808080">);
          </font>g_nPosChave<font color="#808080">:=</font><font color="#FF00FF">1</font><font color="#808080">;
          </font>g_nTamChave<font color="#808080">:=</font><font color="#FF00FF">10</font><font color="#808080">;
     </font><font color="#0000FF">when </font><font color="#FF00FF">2 </font><font color="#808080">=&gt; </font>sret<font color="#808080">:=</font>U<font color="#808080">(</font><font color="#008080">&quot;Profiss&atilde;o: &quot;</font><font color="#808080">);
          </font>g_nPosChave<font color="#808080">:=</font><font color="#FF00FF">11</font><font color="#808080">;
          </font>g_nTamChave<font color="#808080">:=</font><font color="#FF00FF">50</font><font color="#808080">;
     </font><font color="#0000FF">when others </font><font color="#808080">=&gt; </font><font color="#0000FF">null</font><font color="#808080">;
   </font><font color="#0000FF">end case</font><font color="#808080">;
</font><font color="#0000FF">elsif </font>sreg<font color="#808080">=</font>opUsuario <font color="#0000FF">then
   case </font>nNum <font color="#0000FF">is
     when </font><font color="#FF00FF">0 </font><font color="#808080">=&gt; </font>sret<font color="#808080">:=</font>U<font color="#808080">(</font><font color="#008080">&quot;login ou senha incorreta, tente de novo!&quot;</font><font color="#808080">);
     </font><font color="#0000FF">when </font><font color="#FF00FF">1 </font><font color="#808080">=&gt; </font>sret<font color="#808080">:=</font>U<font color="#808080">(</font><font color="#008080">&quot;Login: &quot;</font><font color="#808080">);
          </font>g_nPosChave<font color="#808080">:=</font><font color="#FF00FF">1</font><font color="#808080">;
          </font>g_nTamChave<font color="#808080">:=</font><font color="#FF00FF">10</font><font color="#808080">;
     </font><font color="#0000FF">when </font><font color="#FF00FF">2 </font><font color="#808080">=&gt; </font>sret<font color="#808080">:=</font>U<font color="#808080">(</font><font color="#008080">&quot;Senha: &quot;</font><font color="#808080">);
          </font>g_nPosChave<font color="#808080">:=</font><font color="#FF00FF">11</font><font color="#808080">;
          </font>g_nTamChave<font color="#808080">:=</font><font color="#FF00FF">10</font><font color="#808080">;
     </font><font color="#0000FF">when others </font><font color="#808080">=&gt; </font><font color="#0000FF">null</font><font color="#808080">;
   </font><font color="#0000FF">end case</font><font color="#808080">;
</font><font color="#0000FF">elsif </font>sreg<font color="#808080">=</font>opLivro <font color="#0000FF">then
   case </font>nNum <font color="#0000FF">is
     when </font><font color="#FF00FF">0 </font><font color="#808080">=&gt; </font>sret<font color="#808080">:=</font>U<font color="#808080">(</font><font color="#008080">&quot;Livro(s) n&atilde;o encontrado(s)!&quot;</font><font color="#808080">);
     </font><font color="#0000FF">when </font><font color="#FF00FF">1 </font><font color="#808080">=&gt; </font>sret<font color="#808080">:=</font>U<font color="#808080">(</font><font color="#008080">&quot;ISBN: &quot;</font><font color="#808080">);
          </font>g_nPosChave<font color="#808080">:=</font><font color="#FF00FF">1</font><font color="#808080">;
          </font>g_nTamChave<font color="#808080">:=</font><font color="#FF00FF">13</font><font color="#808080">;
     </font><font color="#0000FF">when </font><font color="#FF00FF">2 </font><font color="#808080">=&gt; </font>sret<font color="#808080">:=</font>U<font color="#808080">(</font><font color="#008080">&quot;T&iacute;tulo: &quot;</font><font color="#808080">);
          </font>g_nPosChave<font color="#808080">:=</font><font color="#FF00FF">14</font><font color="#808080">;
          </font>g_nTamChave<font color="#808080">:=</font><font color="#FF00FF">50</font><font color="#808080">;
     </font><font color="#0000FF">when </font><font color="#FF00FF">3 </font><font color="#808080">=&gt; </font>sret<font color="#808080">:=</font>U<font color="#808080">(</font><font color="#008080">&quot;Edi&ccedil;&atilde;o: &quot;</font><font color="#808080">);
          </font>g_nPosChave<font color="#808080">:=</font><font color="#FF00FF">64</font><font color="#808080">;
          </font>g_nTamChave<font color="#808080">:=</font><font color="#FF00FF">10</font><font color="#808080">;
     </font><font color="#0000FF">when </font><font color="#FF00FF">4 </font><font color="#808080">=&gt; </font>sret<font color="#808080">:=</font>U<font color="#808080">(</font><font color="#008080">&quot;Ano de Publica&ccedil;&atilde;o: &quot;</font><font color="#808080">);
          </font>g_nPosChave<font color="#808080">:=</font><font color="#FF00FF">74</font><font color="#808080">;
          </font>g_nTamChave<font color="#808080">:=</font><font color="#FF00FF">10</font><font color="#808080">;
     </font><font color="#0000FF">when </font><font color="#FF00FF">5 </font><font color="#808080">=&gt; </font>sret<font color="#808080">:=</font>U<font color="#808080">(</font><font color="#008080">&quot;C&oacute;digo da editora: &quot;</font><font color="#808080">);
          </font>g_nPosChave<font color="#808080">:=</font><font color="#FF00FF">84</font><font color="#808080">;
          </font>g_nTamChave<font color="#808080">:=</font><font color="#FF00FF">10</font><font color="#808080">;
     </font><font color="#0000FF">when </font><font color="#FF00FF">6 </font><font color="#808080">=&gt; </font>sret<font color="#808080">:=</font>U<font color="#808080">(</font><font color="#008080">&quot;Volume: &quot;</font><font color="#808080">);
          </font>g_nPosChave<font color="#808080">:=</font><font color="#FF00FF">94</font><font color="#808080">;
          </font>g_nTamChave<font color="#808080">:=</font><font color="#FF00FF">10</font><font color="#808080">;
     </font><font color="#0000FF">when </font><font color="#FF00FF">7 </font><font color="#808080">=&gt; </font>sret<font color="#808080">:=</font>U<font color="#808080">(</font><font color="#008080">&quot;C&oacute;digo do idioma: &quot;</font><font color="#808080">);
          </font>g_nPosChave<font color="#808080">:=</font><font color="#FF00FF">104</font><font color="#808080">;
          </font>g_nTamChave<font color="#808080">:=</font><font color="#FF00FF">10</font><font color="#808080">;
     </font><font color="#0000FF">when </font><font color="#FF00FF">8 </font><font color="#808080">=&gt; </font>sret<font color="#808080">:=</font>U<font color="#808080">(</font><font color="#008080">&quot;N&uacute;mero de p&aacute;ginas: &quot;</font><font color="#808080">);
          </font>g_nPosChave<font color="#808080">:=</font><font color="#FF00FF">114</font><font color="#808080">;
          </font>g_nTamChave<font color="#808080">:=</font><font color="#FF00FF">10</font><font color="#808080">;
     </font><font color="#0000FF">when </font><font color="#FF00FF">9 </font><font color="#808080">=&gt; </font>sret<font color="#808080">:=</font>U<font color="#808080">(</font><font color="#008080">&quot;Pre&ccedil;o: &quot;</font><font color="#808080">);
          </font>g_nPosChave<font color="#808080">:=</font><font color="#FF00FF">124</font><font color="#808080">;
          </font>g_nTamChave<font color="#808080">:=</font><font color="#FF00FF">10</font><font color="#808080">;
     </font><font color="#0000FF">when </font><font color="#FF00FF">10 </font><font color="#808080">=&gt; </font>sret<font color="#808080">:=</font>U<font color="#808080">(</font><font color="#008080">&quot;Qtd. Estoque: &quot;</font><font color="#808080">);
           </font>g_nPosChave<font color="#808080">:=</font><font color="#FF00FF">134</font><font color="#808080">;
           </font>g_nTamChave<font color="#808080">:=</font><font color="#FF00FF">10</font><font color="#808080">;
     </font><font color="#0000FF">when others </font><font color="#808080">=&gt; </font><font color="#0000FF">null</font><font color="#808080">;
   </font><font color="#0000FF">end case</font><font color="#808080">;
</font><font color="#0000FF">elsif </font>sreg<font color="#808080">=</font>opLivroAss <font color="#0000FF">then
   case </font>nNum <font color="#0000FF">is
     when </font><font color="#FF00FF">0 </font><font color="#808080">=&gt; </font>sret<font color="#808080">:=</font>U<font color="#808080">(</font><font color="#008080">&quot;Assunto(s) n&atilde;o encontrado(s)!&quot;</font><font color="#808080">);
     </font><font color="#0000FF">when </font><font color="#FF00FF">1 </font><font color="#808080">=&gt; </font>sret<font color="#808080">:=</font>U<font color="#808080">(</font><font color="#008080">&quot;ISBN: &quot;</font><font color="#808080">);
          </font>g_nPosChave<font color="#808080">:=</font><font color="#FF00FF">1</font><font color="#808080">;
          </font>g_nTamChave<font color="#808080">:=</font><font color="#FF00FF">13</font><font color="#808080">;
     </font><font color="#0000FF">when </font><font color="#FF00FF">2 </font><font color="#808080">=&gt; </font>sret<font color="#808080">:=</font>U<font color="#808080">(</font><font color="#008080">&quot;C&oacute;digo do assunto: &quot;</font><font color="#808080">);
          </font>g_nPosChave<font color="#808080">:=</font><font color="#FF00FF">14</font><font color="#808080">;
          </font>g_nTamChave<font color="#808080">:=</font><font color="#FF00FF">10</font><font color="#808080">;
     </font><font color="#0000FF">when others </font><font color="#808080">=&gt; </font><font color="#0000FF">null</font><font color="#808080">;
   </font><font color="#0000FF">end case</font><font color="#808080">;
</font><font color="#0000FF">elsif </font>sreg<font color="#808080">=</font>opLivroAut <font color="#0000FF">then
   case </font>nNum <font color="#0000FF">is
     when </font><font color="#FF00FF">0 </font><font color="#808080">=&gt; </font>sret<font color="#808080">:=</font>U<font color="#808080">(</font><font color="#008080">&quot;Autor(s) n&atilde;o encontrado(s)!&quot;</font><font color="#808080">);
     </font><font color="#0000FF">when </font><font color="#FF00FF">1 </font><font color="#808080">=&gt; </font>sret<font color="#808080">:=</font>U<font color="#808080">(</font><font color="#008080">&quot;ISBN: &quot;</font><font color="#808080">);
          </font>g_nPosChave<font color="#808080">:=</font><font color="#FF00FF">1</font><font color="#808080">;
          </font>g_nTamChave<font color="#808080">:=</font><font color="#FF00FF">13</font><font color="#808080">;
     </font><font color="#0000FF">when </font><font color="#FF00FF">2 </font><font color="#808080">=&gt; </font>sret<font color="#808080">:=</font>U<font color="#808080">(</font><font color="#008080">&quot;C&oacute;digo do autor: &quot;</font><font color="#808080">);
          </font>g_nPosChave<font color="#808080">:=</font><font color="#FF00FF">14</font><font color="#808080">;
          </font>g_nTamChave<font color="#808080">:=</font><font color="#FF00FF">10</font><font color="#808080">;
     </font><font color="#0000FF">when others </font><font color="#808080">=&gt; </font><font color="#0000FF">null</font><font color="#808080">;
   </font><font color="#0000FF">end case</font><font color="#808080">;
</font><font color="#0000FF">elsif </font>sreg<font color="#808080">=</font>opCliente <font color="#0000FF">then
   case </font>nNum <font color="#0000FF">is
     when </font><font color="#FF00FF">0 </font><font color="#808080">=&gt; </font>sret<font color="#808080">:=</font>U<font color="#808080">(</font><font color="#008080">&quot;Cliente(s) n&atilde;o encontrado(s)!&quot;</font><font color="#808080">);
     </font><font color="#0000FF">when </font><font color="#FF00FF">1 </font><font color="#808080">=&gt; </font>sret<font color="#808080">:=</font>U<font color="#808080">(</font><font color="#008080">&quot;CPF: &quot;</font><font color="#808080">);
          </font>g_nPosChave<font color="#808080">:=</font><font color="#FF00FF">1</font><font color="#808080">;
          </font>g_nTamChave<font color="#808080">:=</font><font color="#FF00FF">14</font><font color="#808080">;
     </font><font color="#0000FF">when </font><font color="#FF00FF">2 </font><font color="#808080">=&gt; </font>sret<font color="#808080">:=</font>U<font color="#808080">(</font><font color="#008080">&quot;Nome: &quot;</font><font color="#808080">);
          </font>g_nPosChave<font color="#808080">:=</font><font color="#FF00FF">15</font><font color="#808080">;
          </font>g_nTamChave<font color="#808080">:=</font><font color="#FF00FF">30</font><font color="#808080">;
     </font><font color="#0000FF">when </font><font color="#FF00FF">3 </font><font color="#808080">=&gt; </font>sret<font color="#808080">:=</font>U<font color="#808080">(</font><font color="#008080">&quot;E-mail: &quot;</font><font color="#808080">);
          </font>g_nPosChave<font color="#808080">:=</font><font color="#FF00FF">45</font><font color="#808080">;
          </font>g_nTamChave<font color="#808080">:=</font><font color="#FF00FF">30</font><font color="#808080">;
     </font><font color="#0000FF">when </font><font color="#FF00FF">4 </font><font color="#808080">=&gt; </font>sret<font color="#808080">:=</font>U<font color="#808080">(</font><font color="#008080">&quot;Identidade: &quot;</font><font color="#808080">);
          </font>g_nPosChave<font color="#808080">:=</font><font color="#FF00FF">75</font><font color="#808080">;
          </font>g_nTamChave<font color="#808080">:=</font><font color="#FF00FF">10</font><font color="#808080">;
     </font><font color="#0000FF">when </font><font color="#FF00FF">5 </font><font color="#808080">=&gt; </font>sret<font color="#808080">:=</font>U<font color="#808080">(</font><font color="#008080">&quot;Sexo: &quot;</font><font color="#808080">);
          </font>g_nPosChave<font color="#808080">:=</font><font color="#FF00FF">85</font><font color="#808080">;
          </font>g_nTamChave<font color="#808080">:=</font><font color="#FF00FF">1</font><font color="#808080">;
     </font><font color="#0000FF">when </font><font color="#FF00FF">6 </font><font color="#808080">=&gt; </font>sret<font color="#808080">:=</font>U<font color="#808080">(</font><font color="#008080">&quot;Telefone: &quot;</font><font color="#808080">);
          </font>g_nPosChave<font color="#808080">:=</font><font color="#FF00FF">86</font><font color="#808080">;
          </font>g_nTamChave<font color="#808080">:=</font><font color="#FF00FF">17</font><font color="#808080">;
     </font><font color="#0000FF">when </font><font color="#FF00FF">7 </font><font color="#808080">=&gt; </font>sret<font color="#808080">:=</font>U<font color="#808080">(</font><font color="#008080">&quot;Dt. Nascimento: &quot;</font><font color="#808080">);
          </font>g_nPosChave<font color="#808080">:=</font><font color="#FF00FF">103</font><font color="#808080">;
          </font>g_nTamChave<font color="#808080">:=</font><font color="#FF00FF">10</font><font color="#808080">;
     </font><font color="#0000FF">when </font><font color="#FF00FF">8 </font><font color="#808080">=&gt; </font>sret<font color="#808080">:=</font>U<font color="#808080">(</font><font color="#008080">&quot;C&oacute;digo do endere&ccedil;o: &quot;</font><font color="#808080">);
          </font>g_nPosChave<font color="#808080">:=</font><font color="#FF00FF">113</font><font color="#808080">;
          </font>g_nTamChave<font color="#808080">:=</font><font color="#FF00FF">10</font><font color="#808080">;
     </font><font color="#0000FF">when </font><font color="#FF00FF">9 </font><font color="#808080">=&gt; </font>sret<font color="#808080">:=</font>U<font color="#808080">(</font><font color="#008080">&quot;C&oacute;digo do pa&iacute;s: &quot;</font><font color="#808080">);
          </font>g_nPosChave<font color="#808080">:=</font><font color="#FF00FF">123</font><font color="#808080">;
          </font>g_nTamChave<font color="#808080">:=</font><font color="#FF00FF">3</font><font color="#808080">;
     </font><font color="#0000FF">when </font><font color="#FF00FF">10 </font><font color="#808080">=&gt; </font>sret<font color="#808080">:=</font>U<font color="#808080">(</font><font color="#008080">&quot;C&oacute;digo da Profiss&atilde;o: &quot;</font><font color="#808080">);
           </font>g_nPosChave<font color="#808080">:=</font><font color="#FF00FF">126</font><font color="#808080">;
           </font>g_nTamChave<font color="#808080">:=</font><font color="#FF00FF">10</font><font color="#808080">;
     </font><font color="#0000FF">when others </font><font color="#808080">=&gt; </font><font color="#0000FF">null</font><font color="#808080">;
   </font><font color="#0000FF">end case</font><font color="#808080">;
</font><font color="#0000FF">elsif </font>sreg<font color="#808080">=</font>opVenda <font color="#0000FF">then
   case </font>nNum <font color="#0000FF">is
     when </font><font color="#FF00FF">0 </font><font color="#808080">=&gt; </font>sret<font color="#808080">:=</font>U<font color="#808080">(</font><font color="#008080">&quot;Venda(s) n&atilde;o encontrada(s)!&quot;</font><font color="#808080">);
     </font><font color="#0000FF">when </font><font color="#FF00FF">1 </font><font color="#808080">=&gt; </font>sret<font color="#808080">:=</font>U<font color="#808080">(</font><font color="#008080">&quot;Data/Hora venda: &quot;</font><font color="#808080">);
          </font>g_nPosChave<font color="#808080">:=</font><font color="#FF00FF">1</font><font color="#808080">;
          </font>g_nTamChave<font color="#808080">:=</font><font color="#FF00FF">19</font><font color="#808080">;
     </font><font color="#0000FF">when </font><font color="#FF00FF">2 </font><font color="#808080">=&gt; </font>sret<font color="#808080">:=</font>U<font color="#808080">(</font><font color="#008080">&quot;CPF: &quot;</font><font color="#808080">);
          </font>g_nPosChave<font color="#808080">:=</font><font color="#FF00FF">20</font><font color="#808080">;
          </font>g_nTamChave<font color="#808080">:=</font><font color="#FF00FF">14</font><font color="#808080">;
     </font><font color="#0000FF">when </font><font color="#FF00FF">3 </font><font color="#808080">=&gt; </font>sret<font color="#808080">:=</font>U<font color="#808080">(</font><font color="#008080">&quot;ISBN: &quot;</font><font color="#808080">);
          </font>g_nPosChave<font color="#808080">:=</font><font color="#FF00FF">34</font><font color="#808080">;
          </font>g_nTamChave<font color="#808080">:=</font><font color="#FF00FF">13</font><font color="#808080">;
     </font><font color="#0000FF">when </font><font color="#FF00FF">4 </font><font color="#808080">=&gt; </font>sret<font color="#808080">:=</font>U<font color="#808080">(</font><font color="#008080">&quot;Pre&ccedil;o de venda: &quot;</font><font color="#808080">);
          </font>g_nPosChave<font color="#808080">:=</font><font color="#FF00FF">47</font><font color="#808080">;
          </font>g_nTamChave<font color="#808080">:=</font><font color="#FF00FF">10</font><font color="#808080">;
     </font><font color="#0000FF">when others </font><font color="#808080">=&gt; </font><font color="#0000FF">null</font><font color="#808080">;
   </font><font color="#0000FF">end case</font><font color="#808080">;
</font><font color="#0000FF">end if</font><font color="#808080">;

</font><font color="#0000FF">return </font>sret<font color="#808080">;
</font><font color="#0000FF">end </font>rotulo<font color="#808080">;

</font><font color="#FF0000">-- ----------------------------------------------------------------------------
-- Indica se continua ou n&atilde;o mostrando um n&uacute;mero m&aacute;ximo de linhas.
-- nlinha - a linha a ser continuada
-- nQtdLinha - a quantidade de linhas a serem mostradas
-- retorna - se continua ou n&atilde;o
-- ----------------------------------------------------------------------------
</font><font color="#0000FF">function </font>ContinuaSN<font color="#808080">(</font>nlinha<font color="#808080">, </font>nQtdLinha<font color="#808080">: </font><font color="#0000FF">in </font>integer<font color="#808080">) </font><font color="#0000FF">return </font>boolean <font color="#0000FF">is
</font>bSOp<font color="#808080">, </font>bret<font color="#808080">: </font>boolean<font color="#808080">;
</font>opCSubMenu<font color="#808080">: </font>character<font color="#808080">;
</font><font color="#0000FF">begin
</font>bret<font color="#808080">:=</font>false<font color="#808080">;
</font><font color="#0000FF">if </font>nlinha <font color="#808080">&gt; </font><font color="#FF00FF">0 </font><font color="#0000FF">then
  if </font><font color="#808080">(</font>nlinha <font color="#0000FF">mod </font>nQtdLinha<font color="#808080">) = </font><font color="#FF00FF">0 </font><font color="#0000FF">then
      </font>bSOp<font color="#808080">:=</font>true<font color="#808080">;
      </font><font color="#0000FF">while</font><font color="#808080">(</font>bSOp<font color="#808080">) </font><font color="#0000FF">loop
        </font>menu<font color="#808080">(</font><font color="#FF00FF">13</font><font color="#808080">);
        </font>get_line<font color="#808080">(</font>opCSubMenu<font color="#808080">);
        </font><font color="#0000FF">if </font><font color="#808080">(</font>opCSubMenu<font color="#808080">='</font>S<font color="#808080">') </font><font color="#0000FF">or </font><font color="#808080">(</font>opCSubMenu<font color="#808080">='</font>s<font color="#808080">') </font><font color="#0000FF">then </font>bSOp<font color="#808080">:=</font>false<font color="#808080">;
        </font><font color="#0000FF">elsif </font><font color="#808080">(</font>opCSubMenu<font color="#808080">='</font>N<font color="#808080">') </font><font color="#0000FF">or </font><font color="#808080">(</font>opCSubMenu<font color="#808080">='</font>n<font color="#808080">') </font><font color="#0000FF">then
          </font>bret<font color="#808080">:=</font>true<font color="#808080">;
          </font>bSOp<font color="#808080">:=</font>false<font color="#808080">;
        </font><font color="#0000FF">else </font>put_line<font color="#808080">(</font>MSG_ERRO<font color="#808080">);
        </font><font color="#0000FF">end if</font><font color="#808080">; 
      </font><font color="#0000FF">end loop</font><font color="#808080">;
  </font><font color="#0000FF">end if</font><font color="#808080">;
</font><font color="#0000FF">end if</font><font color="#808080">;

</font><font color="#0000FF">return </font>bret<font color="#808080">;
</font><font color="#0000FF">end </font>ContinuaSN<font color="#808080">;
</font><font color="#FF0000">-- ----------------------------------------------------------------------------
-- Lista v&aacute;rios registros de acordo com a pesquisa feita.
-- sArq - o arquivo
-- sreg - o tipo de arquivo
-- sChave - a chave a ser pesquisada
-- nPosChave - a posicao inicial da chave dentro do registro
-- nTamChave - o tamanho da chave dentro do registro
-- nTamLinha - o tamanho do registro
-- nQtdLinha - a quantidade de linhas a serem mostradas
-- retorna - se encontrou algum registro
-- ----------------------------------------------------------------------------
</font><font color="#0000FF">function </font>ListarTodos<font color="#808080">(</font>sArq<font color="#808080">: </font><font color="#0000FF">in </font>ctTArqs<font color="#808080">; </font>sreg<font color="#808080">: </font><font color="#0000FF">in </font>ctArqs<font color="#808080">; </font>sChave<font color="#808080">: </font><font color="#0000FF">in </font>ustring<font color="#808080">;
   </font>nPosChave<font color="#808080">, </font>nTamChave<font color="#808080">, </font>nTamLinha<font color="#808080">, </font>nQtdLinha<font color="#808080">: </font><font color="#0000FF">in </font>integer<font color="#808080">;
   </font>bPesqRelativa<font color="#808080">: </font><font color="#0000FF">in </font>boolean<font color="#808080">) </font><font color="#0000FF">return </font>boolean <font color="#0000FF">is
</font>slinha<font color="#808080">: </font>ustring<font color="#808080">;
</font>bQuebra<font color="#808080">, </font>bAchou<font color="#808080">, </font>bRet<font color="#808080">: </font>boolean<font color="#808080">;
</font>nCont<font color="#808080">: </font>integer<font color="#808080">;
</font>sres<font color="#808080">: </font>ustring<font color="#808080">;
</font><font color="#0000FF">begin
</font>bRet<font color="#808080">:=</font>false<font color="#808080">;
</font>bQuebra<font color="#808080">:=</font>false<font color="#808080">;
</font>nCont<font color="#808080">:=</font><font color="#FF00FF">0</font><font color="#808080">;
</font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font>U<font color="#808080">(</font><font color="#008080">&quot;&quot;</font><font color="#808080">), </font><font color="#FF00FF">2</font><font color="#808080">);
</font>seekArq<font color="#808080">(</font>sArq<font color="#808080">, </font><font color="#FF00FF">1</font><font color="#808080">);
</font><font color="#0000FF">while </font><font color="#808080">(</font>not fimArq<font color="#808080">(</font>sArq<font color="#808080">)) </font><font color="#0000FF">and </font><font color="#808080">(</font>bQuebra<font color="#808080">=</font>false<font color="#808080">) </font><font color="#0000FF">loop
  </font>slinha<font color="#808080">:=</font>lerArq<font color="#808080">(</font>sArq<font color="#808080">);

  </font><font color="#0000FF">if </font>bPesqRelativa <font color="#0000FF">then
    </font>sres<font color="#808080">:=</font>trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha<font color="#808080">,</font>nPosChave<font color="#808080">,</font>nTamChave<font color="#808080">), </font>Both<font color="#808080">);
    </font><font color="#0000FF">if </font>strRelativa<font color="#808080">(</font>sres<font color="#808080">,</font>sChave<font color="#808080">) </font><font color="#0000FF">then 
       </font>bAchou<font color="#808080">:=</font>true<font color="#808080">;
       </font>bRet<font color="#808080">:=</font>true<font color="#808080">;
    </font><font color="#0000FF">else
       </font>bAchou<font color="#808080">:=</font>false<font color="#808080">;
    </font><font color="#0000FF">end if</font><font color="#808080">;
  </font><font color="#0000FF">else
    </font>bAchou<font color="#808080">:=</font>true<font color="#808080">;
    </font>bRet<font color="#808080">:=</font>true<font color="#808080">;
  </font><font color="#0000FF">end if</font><font color="#808080">;

  </font><font color="#0000FF">if </font>bAchou <font color="#0000FF">then
    </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font>copy<font color="#808080">(</font>slinha<font color="#808080">,</font><font color="#FF00FF">1</font><font color="#808080">,</font>nTamLinha<font color="#808080">), </font><font color="#FF00FF">3</font><font color="#808080">);
    </font>nCont<font color="#808080">:=</font>nCont<font color="#808080">+</font><font color="#FF00FF">1</font><font color="#808080">;
  </font><font color="#0000FF">end if</font><font color="#808080">;

  </font>bQuebra<font color="#808080">:=</font>ContinuaSN<font color="#808080">(</font>nCont<font color="#808080">, </font>nQtdLinha<font color="#808080">);
</font><font color="#0000FF">end loop</font><font color="#808080">;
</font><font color="#0000FF">return </font>bret<font color="#808080">;
</font><font color="#0000FF">end </font>ListarTodos<font color="#808080">;

</font><font color="#FF0000">-- ----------------------------------------------------------------------------
-- Lista v&aacute;rios registros entre arquivos de acordo com a pesquisa feita.
-- sArq1 - o arquivo de liga&ccedil;&atilde;o
-- sreg1 - o tipo de arquivo de liga&ccedil;&atilde;o
-- nPosChave1 - a posicao inicial da primeira chave no arquivo de liga&ccedil;&atilde;o
-- nTamChave1 - o tamanho da primeira chave no arquivo de liga&ccedil;&atilde;o
-- nPosChave2 - a posicao inicial da segunda chave do arquivo de liga&ccedil;&atilde;o
-- nTamChave2 - o tamanho da segunda chave do arquivo de liga&ccedil;&atilde;o
-- sChave - a chave a ser pesquisada no arquivo de liga&ccedil;&atilde;o
-- sArq2 - o arquivo a ser pesquisado
-- sreg2 - o tipo de arquivo a ser pesquisado
-- nPosChave3 - a posicao inicial da chave do arquivo pesquisado
-- nQtdLinha - a quantidade de linhas a serem mostradas
-- ----------------------------------------------------------------------------
</font><font color="#0000FF">procedure </font>ListarRegLigados<font color="#808080">(</font>sArq1<font color="#808080">: </font><font color="#0000FF">in </font>ctTArqs<font color="#808080">; </font>sreg1<font color="#808080">: </font><font color="#0000FF">in </font>ctArqs<font color="#808080">; </font>nPosChave1<font color="#808080">,
</font>nTamChave1<font color="#808080">, </font>nPosChave2<font color="#808080">, </font>nTamChave2<font color="#808080">: </font><font color="#0000FF">in </font>integer<font color="#808080">; </font>sChave<font color="#808080">: </font>ustring<font color="#808080">;
</font>sArq2<font color="#808080">: </font><font color="#0000FF">in </font>ctTArqs<font color="#808080">; </font>sreg2<font color="#808080">: </font><font color="#0000FF">in </font>ctArqs<font color="#808080">; </font>nPosChave3<font color="#808080">, </font>nQtdLinha<font color="#808080">: </font><font color="#0000FF">in </font>integer<font color="#808080">) </font><font color="#0000FF">is
</font>slinha1<font color="#808080">: </font>ustring<font color="#808080">;
</font>bQuebra<font color="#808080">, </font>bRet<font color="#808080">: </font>boolean<font color="#808080">;
</font>nCont<font color="#808080">: </font>integer<font color="#808080">;
</font>sCodigo1<font color="#808080">, </font>sCodigo2<font color="#808080">, </font>slinha2<font color="#808080">: </font>ustring<font color="#808080">;
</font><font color="#0000FF">begin
</font>bRet<font color="#808080">:=</font>false<font color="#808080">;
</font>nCont<font color="#808080">:=</font><font color="#FF00FF">0</font><font color="#808080">;
</font>bQuebra<font color="#808080">:=</font>false<font color="#808080">;
</font>mostrarDados<font color="#808080">(</font>sreg2<font color="#808080">, </font>U<font color="#808080">(</font><font color="#008080">&quot;&quot;</font><font color="#808080">), </font><font color="#FF00FF">2</font><font color="#808080">);
</font>seekArq<font color="#808080">(</font>sArq1<font color="#808080">, </font><font color="#FF00FF">1</font><font color="#808080">);
</font><font color="#0000FF">while </font><font color="#808080">(</font>not fimArq<font color="#808080">(</font>sArq1<font color="#808080">)) </font><font color="#0000FF">and </font><font color="#808080">(</font>bQuebra<font color="#808080">=</font>false<font color="#808080">) </font><font color="#0000FF">loop
  </font>slinha1<font color="#808080">:=</font>lerArq<font color="#808080">(</font>sArq1<font color="#808080">);
  </font>sCodigo1<font color="#808080">:=</font>trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha1<font color="#808080">,</font>nPosChave1<font color="#808080">,</font>nTamChave1<font color="#808080">), </font>Both<font color="#808080">);
  </font><font color="#0000FF">if </font>sCodigo1<font color="#808080">=</font>sChave <font color="#0000FF">then
    </font>sCodigo2<font color="#808080">:=</font>trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha1<font color="#808080">,</font>nPosChave2<font color="#808080">,</font>nTamChave2<font color="#808080">), </font>Both<font color="#808080">);
    </font>slinha2<font color="#808080">:=</font>pesqArq<font color="#808080">(</font>sArq2<font color="#808080">, </font>sCodigo2<font color="#808080">, </font>nPosChave3<font color="#808080">, </font>nTamChave2<font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg2<font color="#808080">));
    </font>mostrarDados<font color="#808080">(</font>sreg2<font color="#808080">, </font>copy<font color="#808080">(</font>slinha2<font color="#808080">, </font><font color="#FF00FF">1</font><font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg2<font color="#808080">)), </font><font color="#FF00FF">3</font><font color="#808080">);
    </font>bRet<font color="#808080">:=</font>true<font color="#808080">;
    </font>nCont<font color="#808080">:=</font>nCont<font color="#808080">+</font><font color="#FF00FF">1</font><font color="#808080">;
  </font><font color="#0000FF">end if</font><font color="#808080">;
  </font>bQuebra<font color="#808080">:=</font>ContinuaSN<font color="#808080">(</font>nCont<font color="#808080">, </font>nQtdLinha<font color="#808080">);
</font><font color="#0000FF">end loop</font><font color="#808080">;
</font><font color="#0000FF">if </font>bRet<font color="#808080">=</font>false <font color="#0000FF">then
   </font>put_line<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg2<font color="#808080">,</font><font color="#FF00FF">0</font><font color="#808080">));
</font><font color="#0000FF">end if</font><font color="#808080">;
</font><font color="#0000FF">end </font>ListarRegLigados<font color="#808080">;

</font><font color="#FF0000">-- ----------------------------------------------------------------------------
-- Valida a entrada de registros de acordo com a pesquisa feita.
-- sArq - o arquivo
-- sreg - o tipo de arquivo
-- nTexto - o numero do r&oacute;tulo da entrada
-- sEntrada - a chave a ser pesquisada e validada
-- nTentativas - o n&uacute;mero m&aacute;ximo de tentativas
-- bPesqRelativa - indica se vai realizar uma pesquisa relativa
-- bTipoEntrada - indica o tipo de entrada
-- retorna - o registro pesquisado e validado
-- ----------------------------------------------------------------------------
</font><font color="#0000FF">function </font>validaEntrada<font color="#808080">(</font>sArq<font color="#808080">: </font><font color="#0000FF">in </font>ctTArqs<font color="#808080">; </font>sreg<font color="#808080">: </font><font color="#0000FF">in </font>ctArqs<font color="#808080">; </font>nTexto<font color="#808080">: </font><font color="#0000FF">in </font>integer<font color="#808080">;
        </font>sEntrada<font color="#808080">: </font><font color="#0000FF">in </font>ustring<font color="#808080">; </font>nTentativas<font color="#808080">: </font><font color="#0000FF">in </font>integer<font color="#808080">;
        </font>bPesqRelativa<font color="#808080">: </font><font color="#0000FF">in </font>boolean<font color="#808080">; </font>bTipoEntrada<font color="#808080">: </font><font color="#0000FF">in </font>ctTipo<font color="#808080">) </font><font color="#0000FF">return </font>ustring <font color="#0000FF">is
</font>bQuebra<font color="#808080">: </font>boolean<font color="#808080">;
</font>sres<font color="#808080">, </font>sTexto<font color="#808080">, </font>sMsgErro<font color="#808080">: </font>ustring<font color="#808080">;
</font>ncont<font color="#808080">, </font>nPosChave<font color="#808080">, </font>nTamChave<font color="#808080">, </font>nTamLinha<font color="#808080">: </font>integer<font color="#808080">;
</font>slocal<font color="#808080">: </font>ustring<font color="#808080">;
</font><font color="#0000FF">begin
</font>nTamLinha<font color="#808080">:=</font>tamReg<font color="#808080">(</font>sreg<font color="#808080">);
</font>sMsgErro<font color="#808080">:=</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">,</font><font color="#FF00FF">0</font><font color="#808080">);
</font>sTexto<font color="#808080">:=</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">,</font>nTexto<font color="#808080">);
</font>nPosChave<font color="#808080">:=</font>g_nPosChave<font color="#808080">;
</font>nTamChave<font color="#808080">:=</font>g_nTamChave<font color="#808080">;

</font>ncont<font color="#808080">:=</font><font color="#FF00FF">1</font><font color="#808080">;
</font>bQuebra<font color="#808080">:=</font>false<font color="#808080">;
  </font><font color="#0000FF">while </font><font color="#808080">(</font>bQuebra<font color="#808080">=</font>false<font color="#808080">) </font><font color="#0000FF">and </font><font color="#808080">(</font>ncont <font color="#808080">&lt;= </font>nTentativas <font color="#808080">) </font><font color="#0000FF">loop
    if </font>bTipoEntrada<font color="#808080">=</font>opTexto <font color="#0000FF">then
      </font>put<font color="#808080">(</font>sTexto<font color="#808080">);
      </font>get_line<font color="#808080">(</font>slocal<font color="#808080">);
    </font><font color="#0000FF">elsif </font>bTipoEntrada<font color="#808080">=</font>opNumero <font color="#0000FF">then
       </font>slocal<font color="#808080">:=</font>validaNumero<font color="#808080">(</font>sTexto<font color="#808080">, </font>sEntrada<font color="#808080">);
    </font><font color="#0000FF">elsif </font>bTipoEntrada<font color="#808080">=</font>opData <font color="#0000FF">then
       </font>slocal<font color="#808080">:=</font>validaDataHora<font color="#808080">(</font>sTexto<font color="#808080">, </font>sEntrada<font color="#808080">, </font>true<font color="#808080">);
    </font><font color="#0000FF">elsif </font>bTipoEntrada<font color="#808080">=</font>opDataHora <font color="#0000FF">then
       </font>slocal<font color="#808080">:=</font>validaDataHora<font color="#808080">(</font>sTexto<font color="#808080">, </font>sEntrada<font color="#808080">, </font>false<font color="#808080">);
    </font><font color="#0000FF">elsif </font>bTipoEntrada<font color="#808080">=</font>opSenha <font color="#0000FF">then
       </font>slocal<font color="#808080">:=</font>digitaSenha<font color="#808080">(</font>sTexto<font color="#808080">, </font><font color="#FF00FF">10</font><font color="#808080">);
    </font><font color="#0000FF">end if</font><font color="#808080">;

    </font><font color="#0000FF">if </font>bPesqRelativa <font color="#0000FF">then
       if </font>ListarTodos<font color="#808080">(</font>sArq<font color="#808080">, </font>sreg<font color="#808080">, </font>slocal<font color="#808080">, </font>nPosChave<font color="#808080">, </font>nTamChave<font color="#808080">, </font>nTamLinha<font color="#808080">,
       </font>QTD_MAX_LINHA<font color="#808080">, </font>true<font color="#808080">) </font><font color="#0000FF">then
         </font>sres<font color="#808080">:=</font>U<font color="#808080">(</font><font color="#008080">&quot; &quot;</font><font color="#808080">);
       </font><font color="#0000FF">end if</font><font color="#808080">;
    </font><font color="#0000FF">else
       </font>sres<font color="#808080">:=</font>pesqArq<font color="#808080">(</font>sArq<font color="#808080">, </font>slocal<font color="#808080">, </font>nPosChave<font color="#808080">, </font>nTamChave<font color="#808080">, </font>nTamLinha<font color="#808080">);
    </font><font color="#0000FF">end if</font><font color="#808080">;

    </font><font color="#0000FF">if </font>sres<font color="#808080">=</font>U<font color="#808080">(</font><font color="#008080">&quot;&quot;</font><font color="#808080">) </font><font color="#0000FF">then
       </font>put_line<font color="#808080">(</font>sMsgErro<font color="#808080">);
    </font><font color="#0000FF">else
       </font>bQuebra<font color="#808080">:=</font>true<font color="#808080">;
    </font><font color="#0000FF">end if</font><font color="#808080">;

    </font>ncont<font color="#808080">:=</font>ncont<font color="#808080">+</font><font color="#FF00FF">1</font><font color="#808080">;
  </font><font color="#0000FF">end loop</font><font color="#808080">;
</font><font color="#0000FF">return </font>sres<font color="#808080">;
</font><font color="#0000FF">end </font>validaEntrada<font color="#808080">;

</font><font color="#FF0000">-- ----------------------------------------------------------------------------
-- Mostra a tela de splash do sistema.
-- ----------------------------------------------------------------------------
</font><font color="#0000FF">procedure </font>frmSplash <font color="#0000FF">is
 </font>cont<font color="#808080">: </font>integer <font color="#808080">:= </font><font color="#FF00FF">0</font><font color="#808080">;
 </font>ch<font color="#808080">: </font>character<font color="#808080">;
</font><font color="#0000FF">begin
 </font>Put_Line<font color="#808080">(</font><font color="#008080">&quot;*---------------------------------------&quot; </font><font color="#808080">&amp;
 </font><font color="#008080">&quot;-------------------------------------*&quot;</font><font color="#808080">);
 </font>Put_Line<font color="#808080">(</font><font color="#008080">&quot;| LL    II VV   VV RRRRR  UU  UU   SSSS &quot; </font><font color="#808080">&amp;
 </font><font color="#008080">&quot;VV   VV II RRRRR  TTTT UU  UU   SSSS |&quot;</font><font color="#808080">);
 </font>Put_Line<font color="#808080">(</font><font color="#008080">&quot;| LL    II  VV VV  RR   R UU  UU  SS    &quot; </font><font color="#808080">&amp;
 </font><font color="#008080">&quot; VV VV  II RR   R  TT  UU  UU  SS    |&quot;</font><font color="#808080">);
 </font>Put_Line<font color="#808080">(</font><font color="#008080">&quot;| LL    II   VVV   RRRRR  UU  UU    SS  &quot; </font><font color="#808080">&amp;
 </font><font color="#008080">&quot;  VVV   II RRRRR   TT  UU  UU    SS  |&quot;</font><font color="#808080">);
 </font>Put_Line<font color="#808080">(</font><font color="#008080">&quot;| LLLLL II    V    RR   R  UUUU  SSSS   &quot; </font><font color="#808080">&amp;
 </font><font color="#008080">&quot;   V    II RR   R  TT   UUUU  SSSS   |&quot;</font><font color="#808080">);
 </font>Put_Line<font color="#808080">(</font><font color="#008080">&quot;*---------------------------------------&quot; </font><font color="#808080">&amp;
 </font><font color="#008080">&quot;-------------------------------------*&quot;</font><font color="#808080">);
 </font><font color="#0000FF">for </font>cont <font color="#0000FF">in </font><font color="#FF00FF">1</font><font color="#808080">..</font><font color="#FF00FF">18 </font><font color="#0000FF">loop 
   </font>Put_Line<font color="#808080">(</font><font color="#008080">&quot;&quot;</font><font color="#808080">);
 </font><font color="#0000FF">end loop</font><font color="#808080">;
 </font>Put<font color="#808080">(</font>MSG_PRESS<font color="#808080">);
 </font>get_immediate<font color="#808080">(</font>ch<font color="#808080">);
 </font>Put_Line<font color="#808080">(</font><font color="#008080">&quot;&quot;</font><font color="#808080">);
</font><font color="#0000FF">end </font>frmSplash<font color="#808080">;

</font><font color="#FF0000">-- ----------------------------------------------------------------------------
-- Mostra a tela de sobre do sistema.
-- ----------------------------------------------------------------------------
</font><font color="#0000FF">procedure </font>frmSobre <font color="#0000FF">is
</font>cont<font color="#808080">: </font>integer<font color="#808080">:=</font><font color="#FF00FF">0</font><font color="#808080">;
</font>ch<font color="#808080">: </font>character<font color="#808080">;
</font><font color="#0000FF">begin
 </font>put_line<font color="#808080">(</font><font color="#008080">&quot;*------------------------------------------------------------*&quot;</font><font color="#808080">);
 </font>put_line<font color="#808080">(</font><font color="#008080">&quot;|  LL        II  VV       VV  RRRRRRR   UU    UU   SSSSSSS   |&quot;</font><font color="#808080">);
 </font>put_line<font color="#808080">(</font><font color="#008080">&quot;|  LL        II   VV     VV   RR     R  UU    UU  SS         |&quot;</font><font color="#808080">);
 </font>put_line<font color="#808080">(</font><font color="#008080">&quot;|  LL        II    VV   VV    RR     R  UU    UU   SSSS      |&quot;</font><font color="#808080">);
 </font>put_line<font color="#808080">(</font><font color="#008080">&quot;|  LL        II     VV VV     RRRRRRR   UU    UU     SSSS    |&quot;</font><font color="#808080">);
 </font>put_line<font color="#808080">(</font><font color="#008080">&quot;|  LLLL      II      VVV      RR RR     UU    UU        SS   |&quot;</font><font color="#808080">);
 </font>put_line<font color="#808080">(</font><font color="#008080">&quot;|  LLLLLLLL  II       V       RR   RR    UUUUUU   SSSSSSSS   |&quot;</font><font color="#808080">);
 </font>put_line<font color="#808080">(</font><font color="#008080">&quot;|                                                            |&quot;</font><font color="#808080">);
 </font>put_line<font color="#808080">(</font><font color="#008080">&quot;|  VV       VV  II  RRRRRRR   TTTTTTTT  UU    UU   SSSSSSS   |&quot;</font><font color="#808080">);
 </font>put_line<font color="#808080">(</font><font color="#008080">&quot;|   VV     VV   II  RR     R     TT     UU    UU  SS         |&quot;</font><font color="#808080">);
 </font>put_line<font color="#808080">(</font><font color="#008080">&quot;|    VV   VV    II  RR     R     TT     UU    UU   SSSS      |&quot;</font><font color="#808080">);
 </font>put_line<font color="#808080">(</font><font color="#008080">&quot;|     VV VV     II  RRRRRRR      TT     UU    UU     SSSS    |&quot;</font><font color="#808080">);
 </font>put_line<font color="#808080">(</font><font color="#008080">&quot;|      VVV      II  RR RR        TT     UU    UU        SS   |&quot;</font><font color="#808080">);
 </font>put_line<font color="#808080">(</font><font color="#008080">&quot;|       V       II  RR   RR      TT      UUUUUU   SSSSSSSS   |&quot;</font><font color="#808080">);
 </font>put_line<font color="#808080">(</font><font color="#008080">&quot;|                                                            |&quot;</font><font color="#808080">);
 </font>put_line<font color="#808080">(</font><font color="#008080">&quot;|                                               Versao 1.0.0 |&quot;</font><font color="#808080">);
 </font>put_line<font color="#808080">(</font><font color="#008080">&quot;| Sistema integrante do projeto Livrus Virtus.               |&quot;</font><font color="#808080">);
 </font>put_line<font color="#808080">(</font><font color="#008080">&quot;| Todos os direitos reservados para Henrique F. de Souza.    |&quot;</font><font color="#808080">);
 </font>put_line<font color="#808080">(</font><font color="#008080">&quot;| Versao programada na linguagem ada.                        |&quot;</font><font color="#808080">);
 </font>put_line<font color="#808080">(</font><font color="#008080">&quot;*------------------------------------------------------------*&quot;</font><font color="#808080">);
 </font><font color="#0000FF">for </font>cont <font color="#0000FF">in </font><font color="#FF00FF">1</font><font color="#808080">..</font><font color="#FF00FF">4 </font><font color="#0000FF">loop 
   </font>put_line<font color="#808080">(</font><font color="#008080">&quot;&quot;</font><font color="#808080">);
 </font><font color="#0000FF">end loop</font><font color="#808080">; 
 </font>put<font color="#808080">(</font>MSG_PRESS<font color="#808080">);
 </font>get_immediate<font color="#808080">(</font>ch<font color="#808080">);
 </font>Put_Line<font color="#808080">(</font><font color="#008080">&quot;&quot;</font><font color="#808080">);
</font><font color="#0000FF">end </font>frmSobre<font color="#808080">;

</font><font color="#FF0000">-- ----------------------------------------------------------------------------
-- Mostra a tela de login do sistema.
-- retorna - se o login foi validado corretamente
-- ----------------------------------------------------------------------------
</font><font color="#0000FF">function </font>frmLogin <font color="#0000FF">return </font>boolean <font color="#0000FF">is
</font>bret<font color="#808080">: </font>boolean<font color="#808080">;
</font>slinha<font color="#808080">: </font>ustring<font color="#808080">;
</font><font color="#0000FF">begin
  </font>bret<font color="#808080">:=</font>false<font color="#808080">;
  </font>put_line<font color="#808080">(</font><font color="#008080">&quot;*--------------------------------------------------------------*&quot;</font><font color="#808080">);
  </font>put_line<font color="#808080">(</font><font color="#008080">&quot;| Login do sistema                                             |&quot;</font><font color="#808080">);
  </font>put_line<font color="#808080">(</font><font color="#008080">&quot;*--------------------------------------------------------------*&quot;</font><font color="#808080">);
  </font>slinha<font color="#808080">:=</font>validaEntrada<font color="#808080">(</font>taUsuario<font color="#808080">, </font>opUsuario<font color="#808080">, </font><font color="#FF00FF">1</font><font color="#808080">, </font>tUsuario<font color="#808080">.</font>login<font color="#808080">, </font><font color="#FF00FF">3</font><font color="#808080">,
        </font>false<font color="#808080">, </font>opTexto<font color="#808080">);
  </font><font color="#0000FF">if </font>slinha<font color="#808080">/=</font>U<font color="#808080">(</font><font color="#008080">&quot;&quot;</font><font color="#808080">) </font><font color="#0000FF">then
     </font>slinha<font color="#808080">:=</font>validaEntrada<font color="#808080">(</font>taUsuario<font color="#808080">, </font>opUsuario<font color="#808080">, </font><font color="#FF00FF">2</font><font color="#808080">, </font>tUsuario<font color="#808080">.</font>senha<font color="#808080">, </font><font color="#FF00FF">3</font><font color="#808080">,
        </font>false<font color="#808080">, </font>opSenha<font color="#808080">);
     </font><font color="#0000FF">if </font>slinha<font color="#808080">/=</font>U<font color="#808080">(</font><font color="#008080">&quot;&quot;</font><font color="#808080">) </font><font color="#0000FF">then
        </font>tUsuario<font color="#808080">.</font>login<font color="#808080">:=</font>trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF00FF">1</font><font color="#808080">, </font><font color="#FF00FF">10</font><font color="#808080">), </font>Both<font color="#808080">);
        </font>tUsuario<font color="#808080">.</font>senha<font color="#808080">:=</font>trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF00FF">11</font><font color="#808080">, </font><font color="#FF00FF">10</font><font color="#808080">), </font>Both<font color="#808080">);
        </font>bret<font color="#808080">:=</font>true<font color="#808080">;
     </font><font color="#0000FF">end if</font><font color="#808080">;
  </font><font color="#0000FF">end if</font><font color="#808080">;
  </font>put_line<font color="#808080">(</font><font color="#008080">&quot;&quot;</font><font color="#808080">);
  </font><font color="#0000FF">return </font>bret<font color="#808080">;
</font><font color="#0000FF">end </font>frmLogin<font color="#808080">;

</font><font color="#FF0000">-- ----------------------------------------------------------------------------
-- Mostra os menus do sistema.
-- num - o n&uacute;mero do menu
-- ----------------------------------------------------------------------------
</font><font color="#0000FF">procedure </font>menu<font color="#808080">(</font>num<font color="#808080">: </font><font color="#0000FF">in </font>integer<font color="#808080">) </font><font color="#0000FF">is
begin
 if </font><font color="#808080">(</font>num<font color="#808080">=</font><font color="#FF00FF">1</font><font color="#808080">) </font><font color="#0000FF">then
  </font>put_line<font color="#808080">(</font><font color="#008080">&quot;*--------------------------------------------------------------*&quot;</font><font color="#808080">);
  </font>put_line<font color="#808080">(</font><font color="#008080">&quot;| (C)adastros        (P)esquisas     (V)endas        (O)p&ccedil;&otilde;es  |&quot;</font><font color="#808080">);
  </font>put_line<font color="#808080">(</font><font color="#008080">&quot;*--------------------------------------------------------------*&quot;</font><font color="#808080">);
 </font><font color="#0000FF">elsif </font><font color="#808080">(</font>num<font color="#808080">=</font><font color="#FF00FF">2</font><font color="#808080">) </font><font color="#0000FF">then
   </font>put_line<font color="#808080">(</font><font color="#008080">&quot;*---------------------------------*&quot;</font><font color="#808080">);
   </font>put_line<font color="#808080">(</font><font color="#008080">&quot;| 01. Cadastro de Assuntos        |&quot;</font><font color="#808080">);
   </font>put_line<font color="#808080">(</font><font color="#008080">&quot;| 02. Cadastro de Autores         |&quot;</font><font color="#808080">);
   </font>put_line<font color="#808080">(</font><font color="#008080">&quot;| 03. Cadastro de Editoras        |&quot;</font><font color="#808080">);
   </font>put_line<font color="#808080">(</font><font color="#008080">&quot;| 04. Cadastro de Endere&ccedil;os       |&quot;</font><font color="#808080">);
   </font>put_line<font color="#808080">(</font><font color="#008080">&quot;| 05. Cadastro de Idiomas         |&quot;</font><font color="#808080">);
   </font>put_line<font color="#808080">(</font><font color="#008080">&quot;| 06. Cadastro de Pa&iacute;ses          |&quot;</font><font color="#808080">);
   </font>put_line<font color="#808080">(</font><font color="#008080">&quot;| 07. Cadastro de Profiss&otilde;es      |&quot;</font><font color="#808080">);
   </font>put_line<font color="#808080">(</font><font color="#008080">&quot;| 08. Cadastro de Clientes        |&quot;</font><font color="#808080">);
   </font>put_line<font color="#808080">(</font><font color="#008080">&quot;| 09. Cadastro de Livros          |&quot;</font><font color="#808080">);
   </font>put_line<font color="#808080">(</font><font color="#008080">&quot;| 10. Voltar ao menu              |&quot;</font><font color="#808080">);
   </font>put_line<font color="#808080">(</font><font color="#008080">&quot;*---------------------------------*&quot;</font><font color="#808080">);
 </font><font color="#0000FF">elsif </font><font color="#808080">(</font>num<font color="#808080">=</font><font color="#FF00FF">3</font><font color="#808080">) </font><font color="#0000FF">then
   </font>put_line<font color="#808080">(</font><font color="#008080">&quot;*---------------------------------*&quot;</font><font color="#808080">);
   </font>put_line<font color="#808080">(</font><font color="#008080">&quot;| 01. Consulta de Assuntos        |&quot;</font><font color="#808080">);
   </font>put_line<font color="#808080">(</font><font color="#008080">&quot;| 02. Consulta de Autores         |&quot;</font><font color="#808080">);
   </font>put_line<font color="#808080">(</font><font color="#008080">&quot;| 03. Consulta de Editoras        |&quot;</font><font color="#808080">);
   </font>put_line<font color="#808080">(</font><font color="#008080">&quot;| 04. Consulta de Endere&ccedil;os       |&quot;</font><font color="#808080">);
   </font>put_line<font color="#808080">(</font><font color="#008080">&quot;| 05. Consulta de Idiomas         |&quot;</font><font color="#808080">);
   </font>put_line<font color="#808080">(</font><font color="#008080">&quot;| 06. Consulta de Pa&iacute;ses          |&quot;</font><font color="#808080">);
   </font>put_line<font color="#808080">(</font><font color="#008080">&quot;| 07. Consulta de Profiss&otilde;es      |&quot;</font><font color="#808080">);
   </font>put_line<font color="#808080">(</font><font color="#008080">&quot;| 08. Consulta de Clientes        |&quot;</font><font color="#808080">);
   </font>put_line<font color="#808080">(</font><font color="#008080">&quot;| 09. Consulta de Livros          |&quot;</font><font color="#808080">);
   </font>put_line<font color="#808080">(</font><font color="#008080">&quot;| 10. Voltar ao menu              |&quot;</font><font color="#808080">);
   </font>put_line<font color="#808080">(</font><font color="#008080">&quot;*---------------------------------*&quot;</font><font color="#808080">);
 </font><font color="#0000FF">elsif </font><font color="#808080">(</font>num<font color="#808080">=</font><font color="#FF00FF">4</font><font color="#808080">) </font><font color="#0000FF">then
   </font>put_line<font color="#808080">(</font><font color="#008080">&quot;*---------------------------------*&quot;</font><font color="#808080">);
   </font>put_line<font color="#808080">(</font><font color="#008080">&quot;| 01. Vender Livros               |&quot;</font><font color="#808080">);
   </font>put_line<font color="#808080">(</font><font color="#008080">&quot;| 02. Vendas Realizadas           |&quot;</font><font color="#808080">);
   </font>put_line<font color="#808080">(</font><font color="#008080">&quot;| 03. Voltar ao menu              |&quot;</font><font color="#808080">);
   </font>put_line<font color="#808080">(</font><font color="#008080">&quot;*---------------------------------*&quot;</font><font color="#808080">);
 </font><font color="#0000FF">elsif </font><font color="#808080">(</font>num<font color="#808080">=</font><font color="#FF00FF">5</font><font color="#808080">) </font><font color="#0000FF">then
   </font>put_line<font color="#808080">(</font><font color="#008080">&quot;*---------------------------------*&quot;</font><font color="#808080">);
   </font>put_line<font color="#808080">(</font><font color="#008080">&quot;| 01. Alterar senha               |&quot;</font><font color="#808080">);
   </font>put_line<font color="#808080">(</font><font color="#008080">&quot;| 02. Sobre o sistema             |&quot;</font><font color="#808080">);
   </font>put_line<font color="#808080">(</font><font color="#008080">&quot;| 03. Sair do sistema             |&quot;</font><font color="#808080">);
   </font>put_line<font color="#808080">(</font><font color="#008080">&quot;| 04. Voltar ao menu              |&quot;</font><font color="#808080">);
   </font>put_line<font color="#808080">(</font><font color="#008080">&quot;*---------------------------------*&quot;</font><font color="#808080">);
 </font><font color="#0000FF">elsif </font><font color="#808080">(</font>num<font color="#808080">=</font><font color="#FF00FF">6</font><font color="#808080">) </font><font color="#0000FF">then
   </font>put_line<font color="#808080">(</font><font color="#008080">&quot;*--------------------------------------------------------------*&quot;</font><font color="#808080">);
   </font>put_line<font color="#808080">(</font><font color="#008080">&quot;| (1) Novo  (2) Pesquisar   (3) Voltar ao menu                 |&quot;</font><font color="#808080">);
   </font>put_line<font color="#808080">(</font><font color="#008080">&quot;*--------------------------------------------------------------*&quot;</font><font color="#808080">);
 </font><font color="#0000FF">elsif </font><font color="#808080">(</font>num<font color="#808080">=</font><font color="#FF00FF">7</font><font color="#808080">) </font><font color="#0000FF">then
   </font>put_line<font color="#808080">(</font><font color="#008080">&quot;*--------------------------------------------------------------*&quot;</font><font color="#808080">);
   </font>put_line<font color="#808080">(</font><font color="#008080">&quot;| (1) Salvar inclus&atilde;o       (2) Voltar ao menu                 |&quot;</font><font color="#808080">);
   </font>put_line<font color="#808080">(</font><font color="#008080">&quot;*--------------------------------------------------------------*&quot;</font><font color="#808080">);
 </font><font color="#0000FF">elsif </font><font color="#808080">(</font>num<font color="#808080">=</font><font color="#FF00FF">8</font><font color="#808080">) </font><font color="#0000FF">then
   </font>put_line<font color="#808080">(</font><font color="#008080">&quot;*--------------------------------------------------------------*&quot;</font><font color="#808080">);
   </font>put_line<font color="#808080">(</font><font color="#008080">&quot;| (1) Alterar       (2) Excluir     (3) Voltar ao menu         |&quot;</font><font color="#808080">);
   </font>put_line<font color="#808080">(</font><font color="#008080">&quot;*--------------------------------------------------------------*&quot;</font><font color="#808080">);
 </font><font color="#0000FF">elsif </font><font color="#808080">(</font>num<font color="#808080">=</font><font color="#FF00FF">9</font><font color="#808080">) </font><font color="#0000FF">then
   </font>put_line<font color="#808080">(</font><font color="#008080">&quot;*--------------------------------------------------------------*&quot;</font><font color="#808080">);
   </font>put_line<font color="#808080">(</font><font color="#008080">&quot;| (1) Salvar altera&ccedil;&atilde;o      (2) Voltar ao menu                 |&quot;</font><font color="#808080">);
   </font>put_line<font color="#808080">(</font><font color="#008080">&quot;*--------------------------------------------------------------*&quot;</font><font color="#808080">);
 </font><font color="#0000FF">elsif </font><font color="#808080">(</font>num<font color="#808080">=</font><font color="#FF00FF">10</font><font color="#808080">) </font><font color="#0000FF">then
   </font>put_line<font color="#808080">(</font><font color="#008080">&quot;*--------------------------------------------------------------*&quot;</font><font color="#808080">);
   </font>put_line<font color="#808080">(</font><font color="#008080">&quot;| Certeza de excluir? (S/N)                                    |&quot;</font><font color="#808080">);
   </font>put_line<font color="#808080">(</font><font color="#008080">&quot;*--------------------------------------------------------------*&quot;</font><font color="#808080">);
 </font><font color="#0000FF">elsif </font><font color="#808080">(</font>num<font color="#808080">=</font><font color="#FF00FF">11</font><font color="#808080">) </font><font color="#0000FF">then
   </font>put_line<font color="#808080">(</font><font color="#008080">&quot;*--------------------------------------------------------------*&quot;</font><font color="#808080">);
   </font>put_line<font color="#808080">(</font><font color="#008080">&quot;| Deseja sair do sistema? (S/N)                                |&quot;</font><font color="#808080">);
   </font>put_line<font color="#808080">(</font><font color="#008080">&quot;*--------------------------------------------------------------*&quot;</font><font color="#808080">);
 </font><font color="#0000FF">elsif </font><font color="#808080">(</font>num<font color="#808080">=</font><font color="#FF00FF">12</font><font color="#808080">) </font><font color="#0000FF">then
   </font>put_line<font color="#808080">(</font><font color="#008080">&quot;*--------------------------------------------------------------*&quot;</font><font color="#808080">);
   </font>put_line<font color="#808080">(</font><font color="#008080">&quot;| (1) Pesquisar  (2) Listar todos   (3) Voltar ao menu         |&quot;</font><font color="#808080">);
   </font>put_line<font color="#808080">(</font><font color="#008080">&quot;*--------------------------------------------------------------*&quot;</font><font color="#808080">);
 </font><font color="#0000FF">elsif </font><font color="#808080">(</font>num<font color="#808080">=</font><font color="#FF00FF">13</font><font color="#808080">) </font><font color="#0000FF">then
   </font>put_line<font color="#808080">(</font><font color="#008080">&quot;*--------------------------------------------------------------*&quot;</font><font color="#808080">);
   </font>put_line<font color="#808080">(</font><font color="#008080">&quot;| Deseja continuar? (S/N)                                      |&quot;</font><font color="#808080">);
   </font>put_line<font color="#808080">(</font><font color="#008080">&quot;*--------------------------------------------------------------*&quot;</font><font color="#808080">);
 </font><font color="#0000FF">elsif </font><font color="#808080">(</font>num<font color="#808080">=</font><font color="#FF00FF">14</font><font color="#808080">) </font><font color="#0000FF">then
   </font>put_line<font color="#808080">(</font><font color="#008080">&quot;*--------------------------------------------------------------*&quot;</font><font color="#808080">);
   </font>put_line<font color="#808080">(</font><font color="#008080">&quot;| Salvar inclus&atilde;o (S/N)                                        |&quot;</font><font color="#808080">);
   </font>put_line<font color="#808080">(</font><font color="#008080">&quot;*--------------------------------------------------------------*&quot;</font><font color="#808080">);
 </font><font color="#0000FF">end if</font><font color="#808080">;
 </font>put<font color="#808080">(</font>MSG_OPCAO<font color="#808080">);
</font><font color="#0000FF">end </font>menu<font color="#808080">;

</font><font color="#FF0000">-- ----------------------------------------------------------------------------
-- Realiza os cadastros de acordo com o tipo de arquivo.
-- sreg - o tipo de arquivo
-- sacao - a a&ccedil;&atilde;o a ser realizada
-- ----------------------------------------------------------------------------
</font><font color="#0000FF">procedure </font>frmCadastros<font color="#808080">(</font>sreg<font color="#808080">: </font><font color="#0000FF">in </font>ctArqs<font color="#808080">; </font>sacao<font color="#808080">: </font><font color="#0000FF">in </font>ctAcao<font color="#808080">) </font><font color="#0000FF">is
</font>slinha<font color="#808080">: </font>ustring<font color="#808080">;
</font><font color="#0000FF">begin
if </font>sreg<font color="#808080">=</font>opAssunto <font color="#0000FF">then
   if </font>sacao<font color="#808080">=</font>opNovo <font color="#0000FF">then
      </font>tAssunto<font color="#808080">.</font>codigo<font color="#808080">:=</font>pesqMaxCod<font color="#808080">(</font>taAssunto<font color="#808080">, </font><font color="#FF00FF">1</font><font color="#808080">, </font><font color="#FF00FF">10</font><font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">));
      </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font>U<font color="#808080">(</font><font color="#008080">&quot;&quot;</font><font color="#808080">), </font><font color="#FF00FF">1</font><font color="#808080">);
      </font>subMenu<font color="#808080">(</font><font color="#FF00FF">7</font><font color="#808080">, </font>sreg<font color="#808080">);
   </font><font color="#0000FF">elsif </font>sacao<font color="#808080">=</font>opPesquisar <font color="#0000FF">then
     </font>slinha<font color="#808080">:=</font>validaEntrada<font color="#808080">(</font>taAssunto<font color="#808080">,</font>sreg<font color="#808080">,</font><font color="#FF00FF">1</font><font color="#808080">,</font>tAssunto<font color="#808080">.</font>codigo<font color="#808080">,</font><font color="#FF00FF">1</font><font color="#808080">,</font>false<font color="#808080">,</font>opNumero<font color="#808080">);
      </font><font color="#0000FF">if </font>slinha<font color="#808080">/=</font>U<font color="#808080">(</font><font color="#008080">&quot;&quot;</font><font color="#808080">) </font><font color="#0000FF">then
        </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font>U<font color="#808080">(</font><font color="#008080">&quot;&quot;</font><font color="#808080">), </font><font color="#FF00FF">2</font><font color="#808080">);
        </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font>slinha<font color="#808080">, </font><font color="#FF00FF">3</font><font color="#808080">);
        </font>subMenu<font color="#808080">(</font><font color="#FF00FF">8</font><font color="#808080">, </font>sreg<font color="#808080">);
      </font><font color="#0000FF">end if</font><font color="#808080">;
   </font><font color="#0000FF">elsif </font>sacao<font color="#808080">=</font>opAlterar <font color="#0000FF">then
      </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font>U<font color="#808080">(</font><font color="#008080">&quot;&quot;</font><font color="#808080">), </font><font color="#FF00FF">1</font><font color="#808080">);
      </font>subMenu<font color="#808080">(</font><font color="#FF00FF">9</font><font color="#808080">, </font>sreg<font color="#808080">);
   </font><font color="#0000FF">elsif </font>sacao<font color="#808080">=</font>opExcluir <font color="#0000FF">then
      </font>subMenu<font color="#808080">(</font><font color="#FF00FF">10</font><font color="#808080">, </font>sreg<font color="#808080">);
   </font><font color="#0000FF">end if</font><font color="#808080">;
</font><font color="#0000FF">elsif </font>sreg<font color="#808080">=</font>opAutor <font color="#0000FF">then
   if </font>sacao<font color="#808080">=</font>opNovo <font color="#0000FF">then
      </font>tAutor<font color="#808080">.</font>codigo<font color="#808080">:=</font>pesqMaxCod<font color="#808080">(</font>taAutor<font color="#808080">, </font><font color="#FF00FF">1</font><font color="#808080">, </font><font color="#FF00FF">10</font><font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">));
      </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font>U<font color="#808080">(</font><font color="#008080">&quot;&quot;</font><font color="#808080">), </font><font color="#FF00FF">1</font><font color="#808080">);
      </font>subMenu<font color="#808080">(</font><font color="#FF00FF">7</font><font color="#808080">, </font>sreg<font color="#808080">);
   </font><font color="#0000FF">elsif </font>sacao<font color="#808080">=</font>opPesquisar <font color="#0000FF">then
      </font>slinha<font color="#808080">:=</font>validaEntrada<font color="#808080">(</font>taAutor<font color="#808080">, </font>sreg<font color="#808080">, </font><font color="#FF00FF">1</font><font color="#808080">, </font>tAutor<font color="#808080">.</font>codigo<font color="#808080">,</font><font color="#FF00FF">1</font><font color="#808080">,</font>false<font color="#808080">,</font>opNumero<font color="#808080">);
      </font><font color="#0000FF">if </font>slinha<font color="#808080">/=</font>U<font color="#808080">(</font><font color="#008080">&quot;&quot;</font><font color="#808080">) </font><font color="#0000FF">then
        </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font>U<font color="#808080">(</font><font color="#008080">&quot;&quot;</font><font color="#808080">), </font><font color="#FF00FF">2</font><font color="#808080">);
        </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font>slinha<font color="#808080">, </font><font color="#FF00FF">3</font><font color="#808080">);
        </font>subMenu<font color="#808080">(</font><font color="#FF00FF">8</font><font color="#808080">, </font>sreg<font color="#808080">);
      </font><font color="#0000FF">end if</font><font color="#808080">;
   </font><font color="#0000FF">elsif </font>sacao<font color="#808080">=</font>opAlterar <font color="#0000FF">then
      </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font>U<font color="#808080">(</font><font color="#008080">&quot;&quot;</font><font color="#808080">), </font><font color="#FF00FF">1</font><font color="#808080">);
      </font>subMenu<font color="#808080">(</font><font color="#FF00FF">9</font><font color="#808080">, </font>sreg<font color="#808080">);
   </font><font color="#0000FF">elsif </font>sacao<font color="#808080">=</font>opExcluir <font color="#0000FF">then
      </font>subMenu<font color="#808080">(</font><font color="#FF00FF">10</font><font color="#808080">, </font>sreg<font color="#808080">);
   </font><font color="#0000FF">end if</font><font color="#808080">;
</font><font color="#0000FF">elsif </font>sreg<font color="#808080">=</font>opEditora <font color="#0000FF">then
   if </font>sacao<font color="#808080">=</font>opNovo <font color="#0000FF">then
      </font>tEditora<font color="#808080">.</font>codigo<font color="#808080">:=</font>pesqMaxCod<font color="#808080">(</font>taEditora<font color="#808080">, </font><font color="#FF00FF">1</font><font color="#808080">, </font><font color="#FF00FF">10</font><font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">));
      </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font>U<font color="#808080">(</font><font color="#008080">&quot;&quot;</font><font color="#808080">), </font><font color="#FF00FF">1</font><font color="#808080">);
      </font>subMenu<font color="#808080">(</font><font color="#FF00FF">7</font><font color="#808080">, </font>sreg<font color="#808080">);
   </font><font color="#0000FF">elsif </font>sacao<font color="#808080">=</font>opPesquisar <font color="#0000FF">then
     </font>slinha<font color="#808080">:=</font>validaEntrada<font color="#808080">(</font>taEditora<font color="#808080">,</font>sreg<font color="#808080">,</font><font color="#FF00FF">1</font><font color="#808080">,</font>tEditora<font color="#808080">.</font>codigo<font color="#808080">,</font><font color="#FF00FF">1</font><font color="#808080">,</font>false<font color="#808080">,</font>opNumero<font color="#808080">);
      </font><font color="#0000FF">if </font>slinha<font color="#808080">/=</font>U<font color="#808080">(</font><font color="#008080">&quot;&quot;</font><font color="#808080">) </font><font color="#0000FF">then
        </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font>U<font color="#808080">(</font><font color="#008080">&quot;&quot;</font><font color="#808080">), </font><font color="#FF00FF">2</font><font color="#808080">);
        </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font>slinha<font color="#808080">, </font><font color="#FF00FF">3</font><font color="#808080">);
        </font>subMenu<font color="#808080">(</font><font color="#FF00FF">8</font><font color="#808080">, </font>sreg<font color="#808080">);
      </font><font color="#0000FF">end if</font><font color="#808080">;
   </font><font color="#0000FF">elsif </font>sacao<font color="#808080">=</font>opAlterar <font color="#0000FF">then
      </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font>U<font color="#808080">(</font><font color="#008080">&quot;&quot;</font><font color="#808080">), </font><font color="#FF00FF">1</font><font color="#808080">);
      </font>subMenu<font color="#808080">(</font><font color="#FF00FF">9</font><font color="#808080">, </font>sreg<font color="#808080">);
   </font><font color="#0000FF">elsif </font>sacao<font color="#808080">=</font>opExcluir <font color="#0000FF">then
      </font>subMenu<font color="#808080">(</font><font color="#FF00FF">10</font><font color="#808080">, </font>sreg<font color="#808080">);
   </font><font color="#0000FF">end if</font><font color="#808080">;
</font><font color="#0000FF">elsif </font>sreg<font color="#808080">=</font>opEndereco <font color="#0000FF">then
   if </font>sacao<font color="#808080">=</font>opNovo <font color="#0000FF">then
      </font>tEndereco<font color="#808080">.</font>codigo<font color="#808080">:=</font>pesqMaxCod<font color="#808080">(</font>taEndereco<font color="#808080">, </font><font color="#FF00FF">1</font><font color="#808080">, </font><font color="#FF00FF">10</font><font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">));
      </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font>U<font color="#808080">(</font><font color="#008080">&quot;&quot;</font><font color="#808080">), </font><font color="#FF00FF">1</font><font color="#808080">);
      </font>subMenu<font color="#808080">(</font><font color="#FF00FF">7</font><font color="#808080">, </font>sreg<font color="#808080">);
   </font><font color="#0000FF">elsif </font>sacao<font color="#808080">=</font>opPesquisar <font color="#0000FF">then
      </font>slinha<font color="#808080">:=</font>validaEntrada<font color="#808080">(</font>taEndereco<font color="#808080">,</font>sreg<font color="#808080">,</font><font color="#FF00FF">1</font><font color="#808080">,</font>tEndereco<font color="#808080">.</font>codigo<font color="#808080">,</font><font color="#FF00FF">1</font><font color="#808080">,
              </font>false<font color="#808080">,</font>opNumero<font color="#808080">);
      </font><font color="#0000FF">if </font>slinha<font color="#808080">/=</font>U<font color="#808080">(</font><font color="#008080">&quot;&quot;</font><font color="#808080">) </font><font color="#0000FF">then
        </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font>U<font color="#808080">(</font><font color="#008080">&quot;&quot;</font><font color="#808080">), </font><font color="#FF00FF">2</font><font color="#808080">);
        </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font>slinha<font color="#808080">, </font><font color="#FF00FF">3</font><font color="#808080">);
        </font>subMenu<font color="#808080">(</font><font color="#FF00FF">8</font><font color="#808080">, </font>sreg<font color="#808080">);
      </font><font color="#0000FF">end if</font><font color="#808080">;
   </font><font color="#0000FF">elsif </font>sacao<font color="#808080">=</font>opAlterar <font color="#0000FF">then
      </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font>U<font color="#808080">(</font><font color="#008080">&quot;&quot;</font><font color="#808080">), </font><font color="#FF00FF">1</font><font color="#808080">);
      </font>subMenu<font color="#808080">(</font><font color="#FF00FF">9</font><font color="#808080">, </font>sreg<font color="#808080">);
   </font><font color="#0000FF">elsif </font>sacao<font color="#808080">=</font>opExcluir <font color="#0000FF">then
      </font>subMenu<font color="#808080">(</font><font color="#FF00FF">10</font><font color="#808080">, </font>sreg<font color="#808080">);
   </font><font color="#0000FF">end if</font><font color="#808080">;
</font><font color="#0000FF">elsif </font>sreg<font color="#808080">=</font>opIdioma <font color="#0000FF">then
   if </font>sacao<font color="#808080">=</font>opNovo <font color="#0000FF">then
      </font>tIdioma<font color="#808080">.</font>codigo<font color="#808080">:=</font>pesqMaxCod<font color="#808080">(</font>taIdioma<font color="#808080">, </font><font color="#FF00FF">1</font><font color="#808080">, </font><font color="#FF00FF">10</font><font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">));
      </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font>U<font color="#808080">(</font><font color="#008080">&quot;&quot;</font><font color="#808080">), </font><font color="#FF00FF">1</font><font color="#808080">);
      </font>subMenu<font color="#808080">(</font><font color="#FF00FF">7</font><font color="#808080">, </font>sreg<font color="#808080">);
   </font><font color="#0000FF">elsif </font>sacao<font color="#808080">=</font>opPesquisar <font color="#0000FF">then
      </font>slinha<font color="#808080">:=</font>validaEntrada<font color="#808080">(</font>taIdioma<font color="#808080">,</font>sreg<font color="#808080">,</font><font color="#FF00FF">1</font><font color="#808080">,</font>tIdioma<font color="#808080">.</font>codigo<font color="#808080">,</font><font color="#FF00FF">1</font><font color="#808080">,</font>false<font color="#808080">,</font>opNumero<font color="#808080">);
      </font><font color="#0000FF">if </font>slinha<font color="#808080">/=</font>U<font color="#808080">(</font><font color="#008080">&quot;&quot;</font><font color="#808080">) </font><font color="#0000FF">then
        </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font>U<font color="#808080">(</font><font color="#008080">&quot;&quot;</font><font color="#808080">), </font><font color="#FF00FF">2</font><font color="#808080">);
        </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font>slinha<font color="#808080">, </font><font color="#FF00FF">3</font><font color="#808080">);
        </font>subMenu<font color="#808080">(</font><font color="#FF00FF">8</font><font color="#808080">, </font>sreg<font color="#808080">);
      </font><font color="#0000FF">end if</font><font color="#808080">;
   </font><font color="#0000FF">elsif </font>sacao<font color="#808080">=</font>opAlterar <font color="#0000FF">then
      </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font>U<font color="#808080">(</font><font color="#008080">&quot;&quot;</font><font color="#808080">), </font><font color="#FF00FF">1</font><font color="#808080">);
      </font>subMenu<font color="#808080">(</font><font color="#FF00FF">9</font><font color="#808080">, </font>sreg<font color="#808080">);
   </font><font color="#0000FF">elsif </font>sacao<font color="#808080">=</font>opExcluir <font color="#0000FF">then
      </font>subMenu<font color="#808080">(</font><font color="#FF00FF">10</font><font color="#808080">, </font>sreg<font color="#808080">);
   </font><font color="#0000FF">end if</font><font color="#808080">;
</font><font color="#0000FF">elsif </font>sreg<font color="#808080">=</font>opPais <font color="#0000FF">then
   if </font>sacao<font color="#808080">=</font>opNovo <font color="#0000FF">then
      </font>put<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF00FF">1</font><font color="#808080">));
      </font>get_line<font color="#808080">(</font>tPais<font color="#808080">.</font>codigo<font color="#808080">);
      </font>slinha<font color="#808080">:=</font>pesqArq<font color="#808080">(</font>taPais<font color="#808080">, </font>tPais<font color="#808080">.</font>codigo<font color="#808080">, </font><font color="#FF00FF">1</font><font color="#808080">, </font><font color="#FF00FF">3</font><font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">));
      </font><font color="#0000FF">if </font>slinha<font color="#808080">=</font>U<font color="#808080">(</font><font color="#008080">&quot;&quot;</font><font color="#808080">) </font><font color="#0000FF">then
         </font>pesqLinhaExcluida<font color="#808080">(</font>taPais<font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">));
         </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font>U<font color="#808080">(</font><font color="#008080">&quot;&quot;</font><font color="#808080">), </font><font color="#FF00FF">1</font><font color="#808080">);
         </font>subMenu<font color="#808080">(</font><font color="#FF00FF">7</font><font color="#808080">, </font>sreg<font color="#808080">);
      </font><font color="#0000FF">else </font>put_line<font color="#808080">(</font>MSG_REGEXST<font color="#808080">);
      </font><font color="#0000FF">end if</font><font color="#808080">;
   </font><font color="#0000FF">elsif </font>sacao<font color="#808080">=</font>opPesquisar <font color="#0000FF">then
      </font>slinha<font color="#808080">:=</font>validaEntrada<font color="#808080">(</font>taPais<font color="#808080">, </font>sreg<font color="#808080">, </font><font color="#FF00FF">1</font><font color="#808080">, </font>tPais<font color="#808080">.</font>codigo<font color="#808080">, </font><font color="#FF00FF">1</font><font color="#808080">, </font>false<font color="#808080">, </font>opTexto<font color="#808080">);
      </font><font color="#0000FF">if </font>slinha<font color="#808080">/=</font>U<font color="#808080">(</font><font color="#008080">&quot;&quot;</font><font color="#808080">) </font><font color="#0000FF">then
        </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font>U<font color="#808080">(</font><font color="#008080">&quot;&quot;</font><font color="#808080">), </font><font color="#FF00FF">2</font><font color="#808080">);
        </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font>slinha<font color="#808080">, </font><font color="#FF00FF">3</font><font color="#808080">);
        </font>subMenu<font color="#808080">(</font><font color="#FF00FF">8</font><font color="#808080">, </font>sreg<font color="#808080">);
      </font><font color="#0000FF">end if</font><font color="#808080">;
   </font><font color="#0000FF">elsif </font>sacao<font color="#808080">=</font>opAlterar <font color="#0000FF">then
      </font>put_line<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF00FF">1</font><font color="#808080">) &amp; </font>tPais<font color="#808080">.</font>codigo<font color="#808080">);
      </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font>U<font color="#808080">(</font><font color="#008080">&quot;&quot;</font><font color="#808080">), </font><font color="#FF00FF">1</font><font color="#808080">);
      </font>subMenu<font color="#808080">(</font><font color="#FF00FF">9</font><font color="#808080">, </font>sreg<font color="#808080">);
   </font><font color="#0000FF">elsif </font>sacao<font color="#808080">=</font>opExcluir <font color="#0000FF">then
      </font>subMenu<font color="#808080">(</font><font color="#FF00FF">10</font><font color="#808080">, </font>sreg<font color="#808080">);
   </font><font color="#0000FF">end if</font><font color="#808080">;
</font><font color="#0000FF">elsif </font>sreg<font color="#808080">=</font>opProfissao <font color="#0000FF">then
   if </font>sacao<font color="#808080">=</font>opNovo <font color="#0000FF">then
      </font>tProfissao<font color="#808080">.</font>codigo<font color="#808080">:=</font>pesqMaxCod<font color="#808080">(</font>taProfissao<font color="#808080">, </font><font color="#FF00FF">1</font><font color="#808080">, </font><font color="#FF00FF">10</font><font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">));
      </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font>U<font color="#808080">(</font><font color="#008080">&quot;&quot;</font><font color="#808080">), </font><font color="#FF00FF">1</font><font color="#808080">);
      </font>subMenu<font color="#808080">(</font><font color="#FF00FF">7</font><font color="#808080">, </font>sreg<font color="#808080">);
   </font><font color="#0000FF">elsif </font>sacao<font color="#808080">=</font>opPesquisar <font color="#0000FF">then
      </font>slinha<font color="#808080">:=</font>validaEntrada<font color="#808080">(</font>taProfissao<font color="#808080">,</font>sreg<font color="#808080">,</font><font color="#FF00FF">1</font><font color="#808080">,</font>tProfissao<font color="#808080">.</font>codigo<font color="#808080">,</font><font color="#FF00FF">1</font><font color="#808080">,
              </font>false<font color="#808080">,</font>opNumero<font color="#808080">);
      </font><font color="#0000FF">if </font>slinha<font color="#808080">/=</font>U<font color="#808080">(</font><font color="#008080">&quot;&quot;</font><font color="#808080">) </font><font color="#0000FF">then
        </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font>U<font color="#808080">(</font><font color="#008080">&quot;&quot;</font><font color="#808080">), </font><font color="#FF00FF">2</font><font color="#808080">);
        </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font>slinha<font color="#808080">, </font><font color="#FF00FF">3</font><font color="#808080">);
        </font>subMenu<font color="#808080">(</font><font color="#FF00FF">8</font><font color="#808080">, </font>sreg<font color="#808080">);
      </font><font color="#0000FF">end if</font><font color="#808080">;
   </font><font color="#0000FF">elsif </font>sacao<font color="#808080">=</font>opAlterar <font color="#0000FF">then
      </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font>U<font color="#808080">(</font><font color="#008080">&quot;&quot;</font><font color="#808080">), </font><font color="#FF00FF">1</font><font color="#808080">);
      </font>subMenu<font color="#808080">(</font><font color="#FF00FF">9</font><font color="#808080">, </font>sreg<font color="#808080">);
   </font><font color="#0000FF">elsif </font>sacao<font color="#808080">=</font>opExcluir <font color="#0000FF">then
      </font>subMenu<font color="#808080">(</font><font color="#FF00FF">10</font><font color="#808080">, </font>sreg<font color="#808080">);
   </font><font color="#0000FF">end if</font><font color="#808080">;
</font><font color="#0000FF">elsif </font>sreg<font color="#808080">=</font>opLivro <font color="#0000FF">then
   if </font>sacao<font color="#808080">=</font>opNovo <font color="#0000FF">then
      </font>put<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF00FF">1</font><font color="#808080">));
      </font>get_line<font color="#808080">(</font>tLivro<font color="#808080">.</font>isbn<font color="#808080">);
      </font><font color="#0000FF">if </font>validaISBN<font color="#808080">(</font>tLivro<font color="#808080">.</font>isbn<font color="#808080">) </font><font color="#0000FF">then
          </font>slinha<font color="#808080">:=</font>pesqArq<font color="#808080">(</font>taLivro<font color="#808080">, </font>tLivro<font color="#808080">.</font>isbn<font color="#808080">, </font><font color="#FF00FF">1</font><font color="#808080">, </font><font color="#FF00FF">13</font><font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">));
          </font><font color="#0000FF">if </font>slinha<font color="#808080">=</font>U<font color="#808080">(</font><font color="#008080">&quot;&quot;</font><font color="#808080">) </font><font color="#0000FF">then
             </font>pesqLinhaExcluida<font color="#808080">(</font>taLivro<font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">));
             </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font>U<font color="#808080">(</font><font color="#008080">&quot;&quot;</font><font color="#808080">), </font><font color="#FF00FF">1</font><font color="#808080">);
             </font>subMenu<font color="#808080">(</font><font color="#FF00FF">7</font><font color="#808080">, </font>sreg<font color="#808080">);
             </font>frmCadLigados<font color="#808080">(</font>opLivroAss<font color="#808080">, </font>opNovo<font color="#808080">, </font>tLivro<font color="#808080">.</font>isbn<font color="#808080">);
             </font>frmCadLigados<font color="#808080">(</font>opLivroAut<font color="#808080">, </font>opNovo<font color="#808080">, </font>tLivro<font color="#808080">.</font>isbn<font color="#808080">);
          </font><font color="#0000FF">else </font>put_line<font color="#808080">(</font>MSG_REGEXST<font color="#808080">);
          </font><font color="#0000FF">end if</font><font color="#808080">;
      </font><font color="#0000FF">else </font>put_line<font color="#808080">(</font>MSG_ISBNINV<font color="#808080">);
      </font><font color="#0000FF">end if</font><font color="#808080">; 
   </font><font color="#0000FF">elsif </font>sacao<font color="#808080">=</font>opPesquisar <font color="#0000FF">then
      </font>slinha<font color="#808080">:=</font>validaEntrada<font color="#808080">(</font>taLivro<font color="#808080">, </font>sreg<font color="#808080">, </font><font color="#FF00FF">1</font><font color="#808080">, </font>tLivro<font color="#808080">.</font>isbn<font color="#808080">, </font><font color="#FF00FF">1</font><font color="#808080">,</font>false<font color="#808080">,</font>opTexto<font color="#808080">);
      </font><font color="#0000FF">if </font>slinha<font color="#808080">/=</font>U<font color="#808080">(</font><font color="#008080">&quot;&quot;</font><font color="#808080">) </font><font color="#0000FF">then
         </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font>U<font color="#808080">(</font><font color="#008080">&quot;&quot;</font><font color="#808080">), </font><font color="#FF00FF">2</font><font color="#808080">);
         </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font>slinha<font color="#808080">, </font><font color="#FF00FF">3</font><font color="#808080">);
         </font>subMenu<font color="#808080">(</font><font color="#FF00FF">8</font><font color="#808080">, </font>sreg<font color="#808080">);
      </font><font color="#0000FF">end if</font><font color="#808080">;
   </font><font color="#0000FF">elsif </font>sacao<font color="#808080">=</font>opAlterar <font color="#0000FF">then
      </font>put_line<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF00FF">1</font><font color="#808080">) &amp; </font>tLivro<font color="#808080">.</font>isbn<font color="#808080">);
      </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font>U<font color="#808080">(</font><font color="#008080">&quot;&quot;</font><font color="#808080">), </font><font color="#FF00FF">1</font><font color="#808080">);
      </font>subMenu<font color="#808080">(</font><font color="#FF00FF">9</font><font color="#808080">, </font>sreg<font color="#808080">);
      </font>frmCadLigados<font color="#808080">(</font>opLivroAss<font color="#808080">, </font>opExcluir<font color="#808080">, </font>tLivro<font color="#808080">.</font>isbn<font color="#808080">);
      </font>put_line<font color="#808080">(</font><font color="#008080">&quot;Assuntos dos livros exclu&iacute;dos, inclua novos!&quot;</font><font color="#808080">);
      </font>frmCadLigados<font color="#808080">(</font>opLivroAss<font color="#808080">, </font>opNovo<font color="#808080">, </font>tLivro<font color="#808080">.</font>isbn<font color="#808080">);
      </font>frmCadLigados<font color="#808080">(</font>opLivroAut<font color="#808080">, </font>opExcluir<font color="#808080">, </font>tLivro<font color="#808080">.</font>isbn<font color="#808080">);
      </font>put_line<font color="#808080">(</font><font color="#008080">&quot;Autores dos livros exclu&iacute;dos, inclua novos!&quot;</font><font color="#808080">);
      </font>frmCadLigados<font color="#808080">(</font>opLivroAut<font color="#808080">, </font>opNovo<font color="#808080">, </font>tLivro<font color="#808080">.</font>isbn<font color="#808080">);
   </font><font color="#0000FF">elsif </font>sacao<font color="#808080">=</font>opExcluir <font color="#0000FF">then
      </font>subMenu<font color="#808080">(</font><font color="#FF00FF">10</font><font color="#808080">, </font>sreg<font color="#808080">);
      </font>put_line<font color="#808080">(</font><font color="#008080">&quot;Assuntos dos livros sendo exclu&iacute;dos!&quot;</font><font color="#808080">);
      </font>frmCadLigados<font color="#808080">(</font>opLivroAss<font color="#808080">, </font>opExcluir<font color="#808080">, </font>tLivro<font color="#808080">.</font>isbn<font color="#808080">);
      </font>put_line<font color="#808080">(</font><font color="#008080">&quot;Autores dos livros sendo exclu&iacute;dos!&quot;</font><font color="#808080">);
      </font>frmCadLigados<font color="#808080">(</font>opLivroAut<font color="#808080">, </font>opExcluir<font color="#808080">, </font>tLivro<font color="#808080">.</font>isbn<font color="#808080">);
   </font><font color="#0000FF">end if</font><font color="#808080">;
</font><font color="#0000FF">elsif </font>sreg<font color="#808080">=</font>opCliente <font color="#0000FF">then
   if </font>sacao<font color="#808080">=</font>opNovo <font color="#0000FF">then
      </font>put<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF00FF">1</font><font color="#808080">));
      </font>get_line<font color="#808080">(</font>tCliente<font color="#808080">.</font>cpf<font color="#808080">);
      </font><font color="#0000FF">if </font>validaCPF<font color="#808080">(</font>tCliente<font color="#808080">.</font>cpf<font color="#808080">) </font><font color="#0000FF">then
          </font>slinha<font color="#808080">:=</font>pesqArq<font color="#808080">(</font>taCliente<font color="#808080">, </font>tCliente<font color="#808080">.</font>cpf<font color="#808080">, </font><font color="#FF00FF">1</font><font color="#808080">, </font><font color="#FF00FF">14</font><font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">));
          </font><font color="#0000FF">if </font>slinha<font color="#808080">=</font>U<font color="#808080">(</font><font color="#008080">&quot;&quot;</font><font color="#808080">) </font><font color="#0000FF">then
             </font>pesqLinhaExcluida<font color="#808080">(</font>taCliente<font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">));
             </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font>U<font color="#808080">(</font><font color="#008080">&quot;&quot;</font><font color="#808080">), </font><font color="#FF00FF">1</font><font color="#808080">);
             </font>subMenu<font color="#808080">(</font><font color="#FF00FF">7</font><font color="#808080">, </font>sreg<font color="#808080">);
          </font><font color="#0000FF">else </font>put_line<font color="#808080">(</font>MSG_REGEXST<font color="#808080">);
          </font><font color="#0000FF">end if</font><font color="#808080">; 
      </font><font color="#0000FF">else </font>put_line<font color="#808080">(</font>MSG_CPFINV<font color="#808080">);
      </font><font color="#0000FF">end if</font><font color="#808080">;
   </font><font color="#0000FF">elsif </font>sacao<font color="#808080">=</font>opPesquisar <font color="#0000FF">then
      </font>slinha<font color="#808080">:=</font>validaEntrada<font color="#808080">(</font>taCliente<font color="#808080">, </font>sreg<font color="#808080">, </font><font color="#FF00FF">1</font><font color="#808080">, </font>tCliente<font color="#808080">.</font>cpf<font color="#808080">,</font><font color="#FF00FF">1</font><font color="#808080">,</font>false<font color="#808080">,</font>opTexto<font color="#808080">);
      </font><font color="#0000FF">if </font>slinha<font color="#808080">/=</font>U<font color="#808080">(</font><font color="#008080">&quot;&quot;</font><font color="#808080">) </font><font color="#0000FF">then
         </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font>U<font color="#808080">(</font><font color="#008080">&quot;&quot;</font><font color="#808080">), </font><font color="#FF00FF">2</font><font color="#808080">);
         </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font>slinha<font color="#808080">, </font><font color="#FF00FF">3</font><font color="#808080">);
         </font>subMenu<font color="#808080">(</font><font color="#FF00FF">8</font><font color="#808080">, </font>sreg<font color="#808080">);
      </font><font color="#0000FF">end if</font><font color="#808080">;
   </font><font color="#0000FF">elsif </font>sacao<font color="#808080">=</font>opAlterar <font color="#0000FF">then
      </font>put_line<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF00FF">1</font><font color="#808080">) &amp; </font>tCliente<font color="#808080">.</font>cpf<font color="#808080">);
      </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font>U<font color="#808080">(</font><font color="#008080">&quot;&quot;</font><font color="#808080">), </font><font color="#FF00FF">1</font><font color="#808080">);
      </font>subMenu<font color="#808080">(</font><font color="#FF00FF">9</font><font color="#808080">, </font>sreg<font color="#808080">);
   </font><font color="#0000FF">elsif </font>sacao<font color="#808080">=</font>opExcluir <font color="#0000FF">then
      </font>subMenu<font color="#808080">(</font><font color="#FF00FF">10</font><font color="#808080">, </font>sreg<font color="#808080">);
   </font><font color="#0000FF">end if</font><font color="#808080">;
</font><font color="#0000FF">elsif </font>sreg<font color="#808080">=</font>opVenda <font color="#0000FF">then
   if </font>sacao<font color="#808080">=</font>opNovo <font color="#0000FF">then
      </font>tVenda<font color="#808080">.</font>dthrvenda<font color="#808080">:=</font>retDataHora<font color="#808080">;
      </font>put_line<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF00FF">1</font><font color="#808080">) &amp; </font>tVenda<font color="#808080">.</font>dthrvenda<font color="#808080">);
      </font>slinha<font color="#808080">:=</font>pesqArq<font color="#808080">(</font>taVenda<font color="#808080">, </font>tVenda<font color="#808080">.</font>dthrvenda<font color="#808080">, </font><font color="#FF00FF">1</font><font color="#808080">, </font><font color="#FF00FF">19</font><font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">));
      </font><font color="#0000FF">if </font>slinha<font color="#808080">=</font>U<font color="#808080">(</font><font color="#008080">&quot;&quot;</font><font color="#808080">) </font><font color="#0000FF">then
         </font>slinha<font color="#808080">:=</font>validaEntrada<font color="#808080">(</font>taCliente<font color="#808080">,</font>opCliente<font color="#808080">,</font><font color="#FF00FF">1</font><font color="#808080">,</font>tVenda<font color="#808080">.</font>cpf<font color="#808080">,</font><font color="#FF00FF">3</font><font color="#808080">,
                 </font>false<font color="#808080">,</font>opTexto<font color="#808080">);
         </font><font color="#0000FF">if </font>slinha<font color="#808080">/=</font>U<font color="#808080">(</font><font color="#008080">&quot;&quot;</font><font color="#808080">) </font><font color="#0000FF">then
            </font>tVenda<font color="#808080">.</font>cpf<font color="#808080">:=</font>trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha<font color="#808080">,</font><font color="#FF00FF">1</font><font color="#808080">,</font><font color="#FF00FF">14</font><font color="#808080">), </font>Both<font color="#808080">);
            </font><font color="#0000FF">if </font>validaCPF<font color="#808080">(</font>tVenda<font color="#808080">.</font>cpf<font color="#808080">) </font><font color="#0000FF">then
               </font>put<font color="#808080">(</font><font color="#008080">&quot; &quot; </font><font color="#808080">&amp; </font>rotulo<font color="#808080">(</font>opCliente<font color="#808080">, </font><font color="#FF00FF">2</font><font color="#808080">)); </font><font color="#FF0000">-- Nome --
               </font>put_line<font color="#808080">(</font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font>g_nPosChave<font color="#808080">, </font>g_nTamChave<font color="#808080">));
               </font>frmCadLigados<font color="#808080">(</font>opVenda<font color="#808080">, </font>opNovo<font color="#808080">, </font>tVenda<font color="#808080">.</font>cpf<font color="#808080">);
            </font><font color="#0000FF">else </font>put_line<font color="#808080">(</font>MSG_CPFINV<font color="#808080">);
            </font><font color="#0000FF">end if</font><font color="#808080">;
         </font><font color="#0000FF">end if</font><font color="#808080">;
      </font><font color="#0000FF">else </font>put_line<font color="#808080">(</font>MSG_REGEXST<font color="#808080">);
      </font><font color="#0000FF">end if</font><font color="#808080">;
   </font><font color="#0000FF">elsif </font>sacao<font color="#808080">=</font>opPesquisar <font color="#0000FF">then
      </font>slinha<font color="#808080">:=</font>validaEntrada<font color="#808080">(</font>taVenda<font color="#808080">, </font>sreg<font color="#808080">, </font><font color="#FF00FF">1</font><font color="#808080">, </font>tVenda<font color="#808080">.</font>dthrvenda<font color="#808080">,</font><font color="#FF00FF">1</font><font color="#808080">,
              </font>false<font color="#808080">,</font>opDataHora<font color="#808080">);
      </font><font color="#0000FF">if </font>slinha<font color="#808080">/=</font>U<font color="#808080">(</font><font color="#008080">&quot;&quot;</font><font color="#808080">) </font><font color="#0000FF">then
        </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font>U<font color="#808080">(</font><font color="#008080">&quot;&quot;</font><font color="#808080">), </font><font color="#FF00FF">2</font><font color="#808080">);
        </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font>slinha<font color="#808080">, </font><font color="#FF00FF">3</font><font color="#808080">);
        </font>subMenu<font color="#808080">(</font><font color="#FF00FF">8</font><font color="#808080">, </font>sreg<font color="#808080">);
      </font><font color="#0000FF">end if</font><font color="#808080">;
   </font><font color="#0000FF">end if</font><font color="#808080">;
</font><font color="#0000FF">end if</font><font color="#808080">;

</font><font color="#0000FF">end </font>frmCadastros<font color="#808080">;

</font><font color="#FF0000">-- ----------------------------------------------------------------------------
-- Realiza as consultas de acordo com o tipo de arquivo.
-- sreg - o tipo de arquivo
-- sacao - a a&ccedil;&atilde;o a ser realizada
-- ----------------------------------------------------------------------------
</font><font color="#0000FF">procedure </font>frmConsultas<font color="#808080">(</font>sreg<font color="#808080">: </font><font color="#0000FF">in </font>ctArqs<font color="#808080">; </font>sacao<font color="#808080">: </font><font color="#0000FF">in </font>ctAcao<font color="#808080">) </font><font color="#0000FF">is
</font>slinha<font color="#808080">: </font>ustring<font color="#808080">;
</font><font color="#0000FF">begin
if </font>sreg<font color="#808080">=</font>opAssunto <font color="#0000FF">then
   if </font>sacao<font color="#808080">=</font>opPesquisar <font color="#0000FF">then
      </font>slinha<font color="#808080">:=</font>validaEntrada<font color="#808080">(</font>taAssunto<font color="#808080">,</font>sreg<font color="#808080">,</font><font color="#FF00FF">2</font><font color="#808080">,</font>tAssunto<font color="#808080">.</font>assunto<font color="#808080">,</font><font color="#FF00FF">1</font><font color="#808080">,</font>true<font color="#808080">,</font>opTexto<font color="#808080">);
   </font><font color="#0000FF">elsif </font>sacao<font color="#808080">=</font>opListarTodos <font color="#0000FF">then
      if </font>ListarTodos<font color="#808080">(</font>taAssunto<font color="#808080">, </font>sreg<font color="#808080">, </font>U<font color="#808080">(</font><font color="#008080">&quot;&quot;</font><font color="#808080">), </font><font color="#FF00FF">0</font><font color="#808080">, </font><font color="#FF00FF">0</font><font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">),
        </font>QTD_MAX_LINHA<font color="#808080">, </font>false<font color="#808080">) = </font>false <font color="#0000FF">then
        </font>put_line<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF00FF">0</font><font color="#808080">));
      </font><font color="#0000FF">end if</font><font color="#808080">;
   </font><font color="#0000FF">end if</font><font color="#808080">;
</font><font color="#0000FF">elsif </font>sreg<font color="#808080">=</font>opAutor <font color="#0000FF">then
   if </font>sacao<font color="#808080">=</font>opPesquisar <font color="#0000FF">then
      </font>slinha<font color="#808080">:=</font>validaEntrada<font color="#808080">(</font>taAutor<font color="#808080">,</font>sreg<font color="#808080">, </font><font color="#FF00FF">2</font><font color="#808080">, </font>tAutor<font color="#808080">.</font>autor<font color="#808080">, </font><font color="#FF00FF">1</font><font color="#808080">, </font>true<font color="#808080">,</font>opTexto<font color="#808080">);
   </font><font color="#0000FF">elsif </font>sacao<font color="#808080">=</font>opListarTodos <font color="#0000FF">then
      if </font>ListarTodos<font color="#808080">(</font>taAutor<font color="#808080">, </font>sreg<font color="#808080">, </font>U<font color="#808080">(</font><font color="#008080">&quot;&quot;</font><font color="#808080">), </font><font color="#FF00FF">0</font><font color="#808080">, </font><font color="#FF00FF">0</font><font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">),
        </font>QTD_MAX_LINHA<font color="#808080">, </font>false<font color="#808080">) = </font>false <font color="#0000FF">then
        </font>put_line<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF00FF">0</font><font color="#808080">));
      </font><font color="#0000FF">end if</font><font color="#808080">;
   </font><font color="#0000FF">end if</font><font color="#808080">;
</font><font color="#0000FF">elsif </font>sreg<font color="#808080">=</font>opEditora <font color="#0000FF">then
   if </font>sacao<font color="#808080">=</font>opPesquisar <font color="#0000FF">then
      </font>slinha<font color="#808080">:=</font>validaEntrada<font color="#808080">(</font>taEditora<font color="#808080">,</font>sreg<font color="#808080">,</font><font color="#FF00FF">2</font><font color="#808080">,</font>tEditora<font color="#808080">.</font>editora<font color="#808080">,</font><font color="#FF00FF">1</font><font color="#808080">,</font>true<font color="#808080">,</font>opTexto<font color="#808080">);
   </font><font color="#0000FF">elsif </font>sacao<font color="#808080">=</font>opListarTodos <font color="#0000FF">then
      if </font>ListarTodos<font color="#808080">(</font>taEditora<font color="#808080">, </font>sreg<font color="#808080">, </font>U<font color="#808080">(</font><font color="#008080">&quot;&quot;</font><font color="#808080">), </font><font color="#FF00FF">0</font><font color="#808080">, </font><font color="#FF00FF">0</font><font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">),
        </font>QTD_MAX_LINHA<font color="#808080">, </font>false<font color="#808080">) = </font>false <font color="#0000FF">then
        </font>put_line<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF00FF">0</font><font color="#808080">));
      </font><font color="#0000FF">end if</font><font color="#808080">;
   </font><font color="#0000FF">end if</font><font color="#808080">;
</font><font color="#0000FF">elsif </font>sreg<font color="#808080">=</font>opEndereco <font color="#0000FF">then
   if </font>sacao<font color="#808080">=</font>opPesquisar <font color="#0000FF">then
      </font>slinha<font color="#808080">:=</font>validaEntrada<font color="#808080">(</font>taEndereco<font color="#808080">,</font>sreg<font color="#808080">,</font><font color="#FF00FF">2</font><font color="#808080">,</font>tEndereco<font color="#808080">.</font>Logradouro<font color="#808080">,</font><font color="#FF00FF">1</font><font color="#808080">,
              </font>true<font color="#808080">,</font>opTexto<font color="#808080">);
   </font><font color="#0000FF">elsif </font>sacao<font color="#808080">=</font>opListarTodos <font color="#0000FF">then
      if </font>ListarTodos<font color="#808080">(</font>taEndereco<font color="#808080">, </font>sreg<font color="#808080">, </font>U<font color="#808080">(</font><font color="#008080">&quot;&quot;</font><font color="#808080">), </font><font color="#FF00FF">0</font><font color="#808080">, </font><font color="#FF00FF">0</font><font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">),
         </font><font color="#FF00FF">3</font><font color="#808080">, </font>false<font color="#808080">) = </font>false <font color="#0000FF">then
        </font>put_line<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF00FF">0</font><font color="#808080">));
      </font><font color="#0000FF">end if</font><font color="#808080">;
   </font><font color="#0000FF">end if</font><font color="#808080">;
</font><font color="#0000FF">elsif </font>sreg<font color="#808080">=</font>opIdioma <font color="#0000FF">then
   if </font>sacao<font color="#808080">=</font>opPesquisar <font color="#0000FF">then
      </font>slinha<font color="#808080">:=</font>validaEntrada<font color="#808080">(</font>taIdioma<font color="#808080">, </font>sreg<font color="#808080">, </font><font color="#FF00FF">2</font><font color="#808080">, </font>tIdioma<font color="#808080">.</font>idioma<font color="#808080">,</font><font color="#FF00FF">1</font><font color="#808080">,</font>true<font color="#808080">,</font>opTexto<font color="#808080">);
   </font><font color="#0000FF">elsif </font>sacao<font color="#808080">=</font>opListarTodos <font color="#0000FF">then
      if </font>ListarTodos<font color="#808080">(</font>taIdioma<font color="#808080">, </font>sreg<font color="#808080">, </font>U<font color="#808080">(</font><font color="#008080">&quot;&quot;</font><font color="#808080">), </font><font color="#FF00FF">0</font><font color="#808080">, </font><font color="#FF00FF">0</font><font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">),
        </font>QTD_MAX_LINHA<font color="#808080">, </font>false<font color="#808080">) = </font>false <font color="#0000FF">then
        </font>put_line<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF00FF">0</font><font color="#808080">));
      </font><font color="#0000FF">end if</font><font color="#808080">;
   </font><font color="#0000FF">end if</font><font color="#808080">;
</font><font color="#0000FF">elsif </font>sreg<font color="#808080">=</font>opPais <font color="#0000FF">then
   if </font>sacao<font color="#808080">=</font>opPesquisar <font color="#0000FF">then
      </font>slinha<font color="#808080">:=</font>validaEntrada<font color="#808080">(</font>taPais<font color="#808080">, </font>sreg<font color="#808080">, </font><font color="#FF00FF">2</font><font color="#808080">, </font>tPais<font color="#808080">.</font>pais<font color="#808080">, </font><font color="#FF00FF">1</font><font color="#808080">, </font>true<font color="#808080">,</font>opTexto<font color="#808080">);
   </font><font color="#0000FF">elsif </font>sacao<font color="#808080">=</font>opListarTodos <font color="#0000FF">then
      if </font>ListarTodos<font color="#808080">(</font>taPais<font color="#808080">, </font>sreg<font color="#808080">, </font>U<font color="#808080">(</font><font color="#008080">&quot;&quot;</font><font color="#808080">), </font><font color="#FF00FF">0</font><font color="#808080">, </font><font color="#FF00FF">0</font><font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">),
        </font>QTD_MAX_LINHA<font color="#808080">, </font>false<font color="#808080">) = </font>false <font color="#0000FF">then
        </font>put_line<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF00FF">0</font><font color="#808080">));
      </font><font color="#0000FF">end if</font><font color="#808080">;
   </font><font color="#0000FF">end if</font><font color="#808080">;
</font><font color="#0000FF">elsif </font>sreg<font color="#808080">=</font>opProfissao <font color="#0000FF">then
   if </font>sacao<font color="#808080">=</font>opPesquisar <font color="#0000FF">then
     </font>slinha<font color="#808080">:=</font>validaEntrada<font color="#808080">(</font>taProfissao<font color="#808080">,</font>sreg<font color="#808080">,</font><font color="#FF00FF">2</font><font color="#808080">,</font>tProfissao<font color="#808080">.</font>profissao<font color="#808080">,</font><font color="#FF00FF">1</font><font color="#808080">,
             </font>true<font color="#808080">,</font>opTexto<font color="#808080">);
   </font><font color="#0000FF">elsif </font>sacao<font color="#808080">=</font>opListarTodos <font color="#0000FF">then
      if </font>ListarTodos<font color="#808080">(</font>taProfissao<font color="#808080">, </font>sreg<font color="#808080">, </font>U<font color="#808080">(</font><font color="#008080">&quot;&quot;</font><font color="#808080">), </font><font color="#FF00FF">0</font><font color="#808080">, </font><font color="#FF00FF">0</font><font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">),
        </font>QTD_MAX_LINHA<font color="#808080">, </font>false<font color="#808080">) = </font>false <font color="#0000FF">then
        </font>put_line<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF00FF">0</font><font color="#808080">));
      </font><font color="#0000FF">end if</font><font color="#808080">;
   </font><font color="#0000FF">end if</font><font color="#808080">;
</font><font color="#0000FF">elsif </font>sreg<font color="#808080">=</font>opLivro <font color="#0000FF">then
   if </font>sacao<font color="#808080">=</font>opPesquisar <font color="#0000FF">then
      </font>slinha<font color="#808080">:=</font>validaEntrada<font color="#808080">(</font>taLivro<font color="#808080">, </font>sreg<font color="#808080">, </font><font color="#FF00FF">2</font><font color="#808080">, </font>tLivro<font color="#808080">.</font>titulo<font color="#808080">, </font><font color="#FF00FF">1</font><font color="#808080">, </font>true<font color="#808080">,</font>opTexto<font color="#808080">);
   </font><font color="#0000FF">elsif </font>sacao<font color="#808080">=</font>opListarTodos <font color="#0000FF">then
      if </font>ListarTodos<font color="#808080">(</font>taLivro<font color="#808080">, </font>sreg<font color="#808080">, </font>U<font color="#808080">(</font><font color="#008080">&quot;&quot;</font><font color="#808080">), </font><font color="#FF00FF">0</font><font color="#808080">, </font><font color="#FF00FF">0</font><font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">),
        </font><font color="#FF00FF">1</font><font color="#808080">, </font>false<font color="#808080">) = </font>false <font color="#0000FF">then
        </font>put_line<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF00FF">0</font><font color="#808080">));
      </font><font color="#0000FF">end if</font><font color="#808080">;
   </font><font color="#0000FF">end if</font><font color="#808080">;
</font><font color="#0000FF">elsif </font>sreg<font color="#808080">=</font>opCliente <font color="#0000FF">then
   if </font>sacao<font color="#808080">=</font>opPesquisar <font color="#0000FF">then
      </font>slinha<font color="#808080">:=</font>validaEntrada<font color="#808080">(</font>taCliente<font color="#808080">, </font>sreg<font color="#808080">, </font><font color="#FF00FF">2</font><font color="#808080">, </font>tCliente<font color="#808080">.</font>nome<font color="#808080">,</font><font color="#FF00FF">1</font><font color="#808080">,</font>true<font color="#808080">,</font>opTexto<font color="#808080">);
   </font><font color="#0000FF">elsif </font>sacao<font color="#808080">=</font>opListarTodos <font color="#0000FF">then
      if </font>ListarTodos<font color="#808080">(</font>taCliente<font color="#808080">, </font>sreg<font color="#808080">, </font>U<font color="#808080">(</font><font color="#008080">&quot;&quot;</font><font color="#808080">), </font><font color="#FF00FF">0</font><font color="#808080">, </font><font color="#FF00FF">0</font><font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">),
        </font><font color="#FF00FF">1</font><font color="#808080">, </font>false<font color="#808080">) = </font>false <font color="#0000FF">then
        </font>put_line<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF00FF">0</font><font color="#808080">));
      </font><font color="#0000FF">end if</font><font color="#808080">;
   </font><font color="#0000FF">end if</font><font color="#808080">;
</font><font color="#0000FF">elsif </font>sreg<font color="#808080">=</font>opVenda <font color="#0000FF">then
   if </font>sacao<font color="#808080">=</font>opPesquisar <font color="#0000FF">then
      </font>slinha<font color="#808080">:=</font>validaEntrada<font color="#808080">(</font>taVenda<font color="#808080">, </font>sreg<font color="#808080">, </font><font color="#FF00FF">2</font><font color="#808080">, </font>tVenda<font color="#808080">.</font>cpf<font color="#808080">, </font><font color="#FF00FF">1</font><font color="#808080">, </font>true<font color="#808080">,</font>opTexto<font color="#808080">);
   </font><font color="#0000FF">elsif </font>sacao<font color="#808080">=</font>opListarTodos <font color="#0000FF">then
      if </font>ListarTodos<font color="#808080">(</font>taVenda<font color="#808080">, </font>sreg<font color="#808080">, </font>U<font color="#808080">(</font><font color="#008080">&quot;&quot;</font><font color="#808080">), </font><font color="#FF00FF">0</font><font color="#808080">, </font><font color="#FF00FF">0</font><font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">),
        </font>QTD_MAX_LINHA<font color="#808080">, </font>false<font color="#808080">) = </font>false <font color="#0000FF">then
        </font>put_line<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF00FF">0</font><font color="#808080">));
      </font><font color="#0000FF">end if</font><font color="#808080">; 
   </font><font color="#0000FF">end if</font><font color="#808080">;
</font><font color="#0000FF">end if</font><font color="#808080">;
</font><font color="#0000FF">if </font>slinha<font color="#808080">=</font>U<font color="#808080">(</font><font color="#008080">&quot;&quot;</font><font color="#808080">) </font><font color="#0000FF">then
   </font>put<font color="#808080">(</font><font color="#008080">&quot;&quot;</font><font color="#808080">);
</font><font color="#0000FF">end if</font><font color="#808080">;
</font><font color="#0000FF">end </font>frmConsultas<font color="#808080">;

</font><font color="#FF0000">-- ----------------------------------------------------------------------------
-- Mostra a tela de altera&ccedil;&atilde;o de senha do sistema e realiza a altera&ccedil;&atilde;o.
-- ----------------------------------------------------------------------------
</font><font color="#0000FF">procedure </font>frmAlterarSenha <font color="#0000FF">is
</font>bQuebra<font color="#808080">: </font>boolean<font color="#808080">;
</font>sres<font color="#808080">, </font>sSenhaAtual<font color="#808080">, </font>sNovaSenha<font color="#808080">, </font>sConfirmaSenha<font color="#808080">: </font>ustring<font color="#808080">;
</font>nopcao<font color="#808080">: </font>integer<font color="#808080">;
</font><font color="#0000FF">begin
</font>put_line<font color="#808080">(</font>rotulo<font color="#808080">(</font>opUsuario<font color="#808080">, </font><font color="#FF00FF">1</font><font color="#808080">) &amp; </font>tUsuario<font color="#808080">.</font>login<font color="#808080">);
</font>nopcao<font color="#808080">:=</font><font color="#FF00FF">1</font><font color="#808080">;
</font>bQuebra<font color="#808080">:=</font>false<font color="#808080">;
</font><font color="#0000FF">while </font><font color="#808080">(</font>bQuebra<font color="#808080">=</font>false<font color="#808080">) </font><font color="#0000FF">loop
  case </font>nopcao <font color="#0000FF">is
     when </font><font color="#FF00FF">1 </font><font color="#808080">=&gt;
       </font>sSenhaAtual<font color="#808080">:=</font>digitaSenha<font color="#808080">(</font>U<font color="#808080">(</font><font color="#008080">&quot;Senha Atual: &quot;</font><font color="#808080">),</font><font color="#FF00FF">10</font><font color="#808080">);
       </font><font color="#0000FF">if </font>sSenhaAtual<font color="#808080">/=</font>tUsuario<font color="#808080">.</font>senha <font color="#0000FF">then
          </font>put_line<font color="#808080">(</font>MSG_SENCONFERE<font color="#808080">);
          </font>bQuebra<font color="#808080">:=</font>true<font color="#808080">;
       </font><font color="#0000FF">else </font>nopcao<font color="#808080">:=</font><font color="#FF00FF">2</font><font color="#808080">;
       </font><font color="#0000FF">end if</font><font color="#808080">;
   </font><font color="#0000FF">when </font><font color="#FF00FF">2 </font><font color="#808080">=&gt;
       </font>sNovaSenha<font color="#808080">:=</font>digitaSenha<font color="#808080">(</font>U<font color="#808080">(</font><font color="#008080">&quot;Nova Senha: &quot;</font><font color="#808080">),</font><font color="#FF00FF">10</font><font color="#808080">);
       </font>sConfirmaSenha<font color="#808080">:=</font>digitaSenha<font color="#808080">(</font>U<font color="#808080">(</font><font color="#008080">&quot;Confirma Senha: &quot;</font><font color="#808080">),</font><font color="#FF00FF">10</font><font color="#808080">);
       </font><font color="#0000FF">if </font>sNovaSenha<font color="#808080">/=</font>sConfirmaSenha <font color="#0000FF">then
          </font>put_line<font color="#808080">(</font>MSG_SENCONFIRM<font color="#808080">);
          </font>bQuebra<font color="#808080">:=</font>true<font color="#808080">;
       </font><font color="#0000FF">else </font>nopcao<font color="#808080">:=</font><font color="#FF00FF">3</font><font color="#808080">;
       </font><font color="#0000FF">end if</font><font color="#808080">;
   </font><font color="#0000FF">when </font><font color="#FF00FF">3 </font><font color="#808080">=&gt;
       </font>sres<font color="#808080">:=</font>pesqArq<font color="#808080">(</font>taUsuario<font color="#808080">, </font>tUsuario<font color="#808080">.</font>login<font color="#808080">, </font><font color="#FF00FF">1</font><font color="#808080">, </font><font color="#FF00FF">10</font><font color="#808080">, </font>tamReg<font color="#808080">(</font>opUsuario<font color="#808080">));
       </font><font color="#0000FF">if </font>sres<font color="#808080">=</font>U<font color="#808080">(</font><font color="#008080">&quot;&quot;</font><font color="#808080">) </font><font color="#0000FF">then
         </font>put_line<font color="#808080">(</font>MSG_LOGINENCON<font color="#808080">);
       </font><font color="#0000FF">else
         </font>tUsuario<font color="#808080">.</font>senha<font color="#808080">:=</font>sConfirmaSenha<font color="#808080">;
         </font>subMenu<font color="#808080">(</font><font color="#FF00FF">9</font><font color="#808080">,</font>opUsuario<font color="#808080">);
         </font>bQuebra<font color="#808080">:=</font>true<font color="#808080">;
       </font><font color="#0000FF">end if</font><font color="#808080">;
   </font><font color="#0000FF">when others </font><font color="#808080">=&gt; </font><font color="#0000FF">null</font><font color="#808080">;
  </font><font color="#0000FF">end case</font><font color="#808080">;
</font><font color="#0000FF">end loop</font><font color="#808080">;

</font><font color="#0000FF">end </font>frmAlterarSenha<font color="#808080">;
</font><font color="#FF0000">-- ----------------------------------------------------------------------------
-- Executa uma a&ccedil;&atilde;o de grava&ccedil;&atilde;o de acordo com o tipo de arquivo.
-- sreg - o tipo de arquivo
-- sacao - a a&ccedil;&atilde;o a ser realizada
-- ----------------------------------------------------------------------------
</font><font color="#0000FF">procedure </font>btnAcao<font color="#808080">(</font>sreg<font color="#808080">: </font><font color="#0000FF">in </font>ctArqs<font color="#808080">; </font>sacao<font color="#808080">: </font><font color="#0000FF">in </font>ctAcao<font color="#808080">) </font><font color="#0000FF">is
begin
if </font>sreg<font color="#808080">=</font>opAssunto <font color="#0000FF">then
   if </font>sacao<font color="#808080">=</font>opSalvarInclusao <font color="#0000FF">then
      </font>escreveArq<font color="#808080">(</font>taAssunto<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGINC<font color="#808080">, </font>MSG_REGNINC<font color="#808080">);
   </font><font color="#0000FF">elsif </font>sacao<font color="#808080">=</font>opSalvarAlteracao <font color="#0000FF">then
      </font>escreveArq<font color="#808080">(</font>taAssunto<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGALT<font color="#808080">, </font>MSG_REGNALT<font color="#808080">);
   </font><font color="#0000FF">elsif </font>sacao<font color="#808080">=</font>opConfirmaExclusao <font color="#0000FF">then
      </font>escreveArq<font color="#808080">(</font>taAssunto<font color="#808080">, </font>repete<font color="#808080">(</font><font color="#008080">&quot;*&quot;</font><font color="#808080">,</font>tamReg<font color="#808080">(</font>sreg<font color="#808080">)), </font>MSG_REGEXC<font color="#808080">, </font>MSG_REGNEXC<font color="#808080">);
   </font><font color="#0000FF">end if</font><font color="#808080">;
</font><font color="#0000FF">elsif </font>sreg<font color="#808080">=</font>opAutor <font color="#0000FF">then
   if </font>sacao<font color="#808080">=</font>opSalvarInclusao <font color="#0000FF">then
      </font>escreveArq<font color="#808080">(</font>taAutor<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGINC<font color="#808080">, </font>MSG_REGNINC<font color="#808080">);
   </font><font color="#0000FF">elsif </font>sacao<font color="#808080">=</font>opSalvarAlteracao <font color="#0000FF">then
      </font>escreveArq<font color="#808080">(</font>taAutor<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGALT<font color="#808080">, </font>MSG_REGNALT<font color="#808080">);
   </font><font color="#0000FF">elsif </font>sacao<font color="#808080">=</font>opConfirmaExclusao <font color="#0000FF">then
      </font>escreveArq<font color="#808080">(</font>taAutor<font color="#808080">, </font>repete<font color="#808080">(</font><font color="#008080">&quot;*&quot;</font><font color="#808080">,</font>tamReg<font color="#808080">(</font>sreg<font color="#808080">)), </font>MSG_REGEXC<font color="#808080">, </font>MSG_REGNEXC<font color="#808080">);
   </font><font color="#0000FF">end if</font><font color="#808080">;
</font><font color="#0000FF">elsif </font>sreg<font color="#808080">=</font>opEditora <font color="#0000FF">then
   if </font>sacao<font color="#808080">=</font>opSalvarInclusao <font color="#0000FF">then
      </font>escreveArq<font color="#808080">(</font>taEditora<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGINC<font color="#808080">, </font>MSG_REGNINC<font color="#808080">);
   </font><font color="#0000FF">elsif </font>sacao<font color="#808080">=</font>opSalvarAlteracao <font color="#0000FF">then
      </font>escreveArq<font color="#808080">(</font>taEditora<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGALT<font color="#808080">, </font>MSG_REGNALT<font color="#808080">);
   </font><font color="#0000FF">elsif </font>sacao<font color="#808080">=</font>opConfirmaExclusao <font color="#0000FF">then
      </font>escreveArq<font color="#808080">(</font>taEditora<font color="#808080">, </font>repete<font color="#808080">(</font><font color="#008080">&quot;*&quot;</font><font color="#808080">,</font>tamReg<font color="#808080">(</font>sreg<font color="#808080">)), </font>MSG_REGEXC<font color="#808080">, </font>MSG_REGNEXC<font color="#808080">);
   </font><font color="#0000FF">end if</font><font color="#808080">;
</font><font color="#0000FF">elsif </font>sreg<font color="#808080">=</font>opEndereco <font color="#0000FF">then
   if </font>sacao<font color="#808080">=</font>opSalvarInclusao <font color="#0000FF">then
      </font>escreveArq<font color="#808080">(</font>taEndereco<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGINC<font color="#808080">, </font>MSG_REGNINC<font color="#808080">);
   </font><font color="#0000FF">elsif </font>sacao<font color="#808080">=</font>opSalvarAlteracao <font color="#0000FF">then
      </font>escreveArq<font color="#808080">(</font>taEndereco<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGALT<font color="#808080">, </font>MSG_REGNALT<font color="#808080">);
   </font><font color="#0000FF">elsif </font>sacao<font color="#808080">=</font>opConfirmaExclusao <font color="#0000FF">then
      </font>escreveArq<font color="#808080">(</font>taEndereco<font color="#808080">, </font>repete<font color="#808080">(</font><font color="#008080">&quot;*&quot;</font><font color="#808080">,</font>tamReg<font color="#808080">(</font>sreg<font color="#808080">)), </font>MSG_REGEXC<font color="#808080">, </font>MSG_REGNEXC<font color="#808080">);
   </font><font color="#0000FF">end if</font><font color="#808080">;
</font><font color="#0000FF">elsif </font>sreg<font color="#808080">=</font>opIdioma <font color="#0000FF">then
   if </font>sacao<font color="#808080">=</font>opSalvarInclusao <font color="#0000FF">then
      </font>escreveArq<font color="#808080">(</font>taIdioma<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGINC<font color="#808080">, </font>MSG_REGNINC<font color="#808080">);
   </font><font color="#0000FF">elsif </font>sacao<font color="#808080">=</font>opSalvarAlteracao <font color="#0000FF">then
      </font>escreveArq<font color="#808080">(</font>taIdioma<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGALT<font color="#808080">, </font>MSG_REGNALT<font color="#808080">);
   </font><font color="#0000FF">elsif </font>sacao<font color="#808080">=</font>opConfirmaExclusao <font color="#0000FF">then
      </font>escreveArq<font color="#808080">(</font>taIdioma<font color="#808080">, </font>repete<font color="#808080">(</font><font color="#008080">&quot;*&quot;</font><font color="#808080">,</font>tamReg<font color="#808080">(</font>sreg<font color="#808080">)), </font>MSG_REGEXC<font color="#808080">, </font>MSG_REGNEXC<font color="#808080">);
   </font><font color="#0000FF">end if</font><font color="#808080">;
</font><font color="#0000FF">elsif </font>sreg<font color="#808080">=</font>opPais <font color="#0000FF">then
   if </font>sacao<font color="#808080">=</font>opSalvarInclusao <font color="#0000FF">then
      </font>escreveArq<font color="#808080">(</font>taPais<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGINC<font color="#808080">, </font>MSG_REGNINC<font color="#808080">);
   </font><font color="#0000FF">elsif </font>sacao<font color="#808080">=</font>opSalvarAlteracao <font color="#0000FF">then
      </font>escreveArq<font color="#808080">(</font>taPais<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGALT<font color="#808080">, </font>MSG_REGNALT<font color="#808080">);
   </font><font color="#0000FF">elsif </font>sacao<font color="#808080">=</font>opConfirmaExclusao <font color="#0000FF">then
      </font>escreveArq<font color="#808080">(</font>taPais<font color="#808080">, </font>repete<font color="#808080">(</font><font color="#008080">&quot;*&quot;</font><font color="#808080">,</font>tamReg<font color="#808080">(</font>sreg<font color="#808080">)), </font>MSG_REGEXC<font color="#808080">, </font>MSG_REGNEXC<font color="#808080">);
   </font><font color="#0000FF">end if</font><font color="#808080">;
</font><font color="#0000FF">elsif </font>sreg<font color="#808080">=</font>opProfissao <font color="#0000FF">then
   if </font>sacao<font color="#808080">=</font>opSalvarInclusao <font color="#0000FF">then
      </font>escreveArq<font color="#808080">(</font>taProfissao<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGINC<font color="#808080">, </font>MSG_REGNINC<font color="#808080">);
   </font><font color="#0000FF">elsif </font>sacao<font color="#808080">=</font>opSalvarAlteracao <font color="#0000FF">then
      </font>escreveArq<font color="#808080">(</font>taProfissao<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGALT<font color="#808080">, </font>MSG_REGNALT<font color="#808080">);
   </font><font color="#0000FF">elsif </font>sacao<font color="#808080">=</font>opConfirmaExclusao <font color="#0000FF">then
      </font>escreveArq<font color="#808080">(</font>taProfissao<font color="#808080">, </font>repete<font color="#808080">(</font><font color="#008080">&quot;*&quot;</font><font color="#808080">,</font>tamReg<font color="#808080">(</font>sreg<font color="#808080">)), </font>MSG_REGEXC<font color="#808080">, </font>MSG_REGNEXC<font color="#808080">);
   </font><font color="#0000FF">end if</font><font color="#808080">;
</font><font color="#0000FF">elsif </font>sreg<font color="#808080">=</font>opLivro <font color="#0000FF">then
   if </font>sacao<font color="#808080">=</font>opSalvarInclusao <font color="#0000FF">then
      </font>escreveArq<font color="#808080">(</font>taLivro<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGINC<font color="#808080">, </font>MSG_REGNINC<font color="#808080">);
   </font><font color="#0000FF">elsif </font>sacao<font color="#808080">=</font>opSalvarAlteracao <font color="#0000FF">then
      </font>escreveArq<font color="#808080">(</font>taLivro<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGALT<font color="#808080">, </font>MSG_REGNALT<font color="#808080">);
   </font><font color="#0000FF">elsif </font>sacao<font color="#808080">=</font>opConfirmaExclusao <font color="#0000FF">then
      </font>escreveArq<font color="#808080">(</font>taLivro<font color="#808080">, </font>repete<font color="#808080">(</font><font color="#008080">&quot;*&quot;</font><font color="#808080">,</font>tamReg<font color="#808080">(</font>sreg<font color="#808080">)), </font>MSG_REGEXC<font color="#808080">, </font>MSG_REGNEXC<font color="#808080">);
   </font><font color="#0000FF">end if</font><font color="#808080">;
</font><font color="#0000FF">elsif </font>sreg<font color="#808080">=</font>opLivroAss <font color="#0000FF">then
   if </font>sacao<font color="#808080">=</font>opSalvarInclusao <font color="#0000FF">then
      </font>escreveArq<font color="#808080">(</font>taLivroAss<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGINC<font color="#808080">, </font>MSG_REGNINC<font color="#808080">);
   </font><font color="#0000FF">elsif </font>sacao<font color="#808080">=</font>opSalvarAlteracao <font color="#0000FF">then
      </font>escreveArq<font color="#808080">(</font>taLivroAss<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGALT<font color="#808080">, </font>MSG_REGNALT<font color="#808080">);
   </font><font color="#0000FF">elsif </font>sacao<font color="#808080">=</font>opConfirmaExclusao <font color="#0000FF">then
      </font>escreveArq<font color="#808080">(</font>taLivroAss<font color="#808080">, </font>repete<font color="#808080">(</font><font color="#008080">&quot;*&quot;</font><font color="#808080">,</font>tamReg<font color="#808080">(</font>sreg<font color="#808080">)), </font>MSG_REGEXC<font color="#808080">, </font>MSG_REGNEXC<font color="#808080">);
   </font><font color="#0000FF">end if</font><font color="#808080">;
</font><font color="#0000FF">elsif </font>sreg<font color="#808080">=</font>opLivroAut <font color="#0000FF">then
   if </font>sacao<font color="#808080">=</font>opSalvarInclusao <font color="#0000FF">then
      </font>escreveArq<font color="#808080">(</font>taLivroAut<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGINC<font color="#808080">, </font>MSG_REGNINC<font color="#808080">);
   </font><font color="#0000FF">elsif </font>sacao<font color="#808080">=</font>opSalvarAlteracao <font color="#0000FF">then
      </font>escreveArq<font color="#808080">(</font>taLivroAut<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGALT<font color="#808080">, </font>MSG_REGNALT<font color="#808080">);
   </font><font color="#0000FF">elsif </font>sacao<font color="#808080">=</font>opConfirmaExclusao <font color="#0000FF">then
      </font>escreveArq<font color="#808080">(</font>taLivroAut<font color="#808080">, </font>repete<font color="#808080">(</font><font color="#008080">&quot;*&quot;</font><font color="#808080">,</font>tamReg<font color="#808080">(</font>sreg<font color="#808080">)), </font>MSG_REGEXC<font color="#808080">, </font>MSG_REGNEXC<font color="#808080">);
   </font><font color="#0000FF">end if</font><font color="#808080">;
</font><font color="#0000FF">elsif </font>sreg<font color="#808080">=</font>opCliente <font color="#0000FF">then
   if </font>sacao<font color="#808080">=</font>opSalvarInclusao <font color="#0000FF">then
      </font>escreveArq<font color="#808080">(</font>taCliente<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGINC<font color="#808080">, </font>MSG_REGNINC<font color="#808080">);
   </font><font color="#0000FF">elsif </font>sacao<font color="#808080">=</font>opSalvarAlteracao <font color="#0000FF">then
      </font>escreveArq<font color="#808080">(</font>taCliente<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGALT<font color="#808080">, </font>MSG_REGNALT<font color="#808080">);
   </font><font color="#0000FF">elsif </font>sacao<font color="#808080">=</font>opConfirmaExclusao <font color="#0000FF">then
      </font>escreveArq<font color="#808080">(</font>taCliente<font color="#808080">, </font>repete<font color="#808080">(</font><font color="#008080">&quot;*&quot;</font><font color="#808080">,</font>tamReg<font color="#808080">(</font>sreg<font color="#808080">)), </font>MSG_REGEXC<font color="#808080">, </font>MSG_REGNEXC<font color="#808080">);
   </font><font color="#0000FF">end if</font><font color="#808080">;
</font><font color="#0000FF">elsif </font>sreg<font color="#808080">=</font>opVenda <font color="#0000FF">then
   if </font>sacao<font color="#808080">=</font>opSalvarInclusao <font color="#0000FF">then
      </font>escreveArq<font color="#808080">(</font>taVenda<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGINC<font color="#808080">, </font>MSG_REGNINC<font color="#808080">);
   </font><font color="#0000FF">elsif </font>sacao<font color="#808080">=</font>opSalvarAlteracao <font color="#0000FF">then
      </font>escreveArq<font color="#808080">(</font>taVenda<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGALT<font color="#808080">, </font>MSG_REGNALT<font color="#808080">);
   </font><font color="#0000FF">elsif </font>sacao<font color="#808080">=</font>opConfirmaExclusao <font color="#0000FF">then
      </font>escreveArq<font color="#808080">(</font>taVenda<font color="#808080">, </font>repete<font color="#808080">(</font><font color="#008080">&quot;*&quot;</font><font color="#808080">,</font>tamReg<font color="#808080">(</font>sreg<font color="#808080">)), </font>MSG_REGEXC<font color="#808080">, </font>MSG_REGNEXC<font color="#808080">);
   </font><font color="#0000FF">end if</font><font color="#808080">;
</font><font color="#0000FF">elsif </font>sreg<font color="#808080">=</font>opUsuario <font color="#0000FF">then
   if </font>sacao<font color="#808080">=</font>opSalvarAlteracao <font color="#0000FF">then
      </font>escreveArq<font color="#808080">(</font>taUsuario<font color="#808080">, </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">), </font>MSG_REGALT<font color="#808080">, </font>MSG_REGNALT<font color="#808080">);
   </font><font color="#0000FF">end if</font><font color="#808080">;
</font><font color="#0000FF">end if</font><font color="#808080">;
</font><font color="#0000FF">end </font>btnAcao<font color="#808080">;
</font><font color="#FF0000">-- ----------------------------------------------------------------------------
-- Seleciona o menu e/ou a tela certa de acordo com o tipo de arquivo.
-- nmenu - o n&uacute;mero do menu
-- sreg - o tipo de arquivo
-- ----------------------------------------------------------------------------
</font><font color="#0000FF">procedure </font>subMenu<font color="#808080">(</font>nmenu<font color="#808080">: </font><font color="#0000FF">in </font>integer<font color="#808080">; </font>sreg<font color="#808080">: </font><font color="#0000FF">in </font>ctArqs<font color="#808080">) </font><font color="#0000FF">is
</font>opSubMenu<font color="#808080">: </font>character<font color="#808080">;
</font>opCSubMenu<font color="#808080">: </font>character<font color="#808080">;
</font>bSOp<font color="#808080">: </font>boolean<font color="#808080">;
</font><font color="#0000FF">begin
</font>bSOp<font color="#808080">:=</font>true<font color="#808080">;
</font><font color="#0000FF">case </font>nmenu <font color="#0000FF">is
 when </font><font color="#FF00FF">6 </font><font color="#808080">=&gt;
    </font><font color="#0000FF">while</font><font color="#808080">(</font>bSOp<font color="#808080">) </font><font color="#0000FF">loop
       </font>menu<font color="#808080">(</font>nmenu<font color="#808080">);
       </font>get_line<font color="#808080">(</font>opSubMenu<font color="#808080">);
       </font><font color="#0000FF">case</font><font color="#808080">(</font>opSubMenu<font color="#808080">) </font><font color="#0000FF">is
          when </font><font color="#808080">'</font><font color="#FF00FF">1</font><font color="#808080">' =&gt; </font>frmCadastros<font color="#808080">(</font>sreg<font color="#808080">, </font>opNovo<font color="#808080">);
          </font><font color="#0000FF">when </font><font color="#808080">'</font><font color="#FF00FF">2</font><font color="#808080">' =&gt; </font>frmCadastros<font color="#808080">(</font>sreg<font color="#808080">, </font>opPesquisar<font color="#808080">);
          </font><font color="#0000FF">when </font><font color="#808080">'</font><font color="#FF00FF">3</font><font color="#808080">' =&gt; </font>bSOp<font color="#808080">:=</font>false<font color="#808080">;
          </font><font color="#0000FF">when others </font><font color="#808080">=&gt; </font>put_line<font color="#808080">(</font>MSG_ERRO<font color="#808080">);
       </font><font color="#0000FF">end case</font><font color="#808080">;
    </font><font color="#0000FF">end loop</font><font color="#808080">;
 </font><font color="#0000FF">when </font><font color="#FF00FF">7 </font><font color="#808080">=&gt;
    </font><font color="#0000FF">while</font><font color="#808080">(</font>bSOp<font color="#808080">) </font><font color="#0000FF">loop
       </font>menu<font color="#808080">(</font>nmenu<font color="#808080">);
       </font>get_line<font color="#808080">(</font>opSubMenu<font color="#808080">);
       </font><font color="#0000FF">case</font><font color="#808080">(</font>opSubMenu<font color="#808080">) </font><font color="#0000FF">is
          when </font><font color="#808080">'</font><font color="#FF00FF">1</font><font color="#808080">' =&gt; </font>btnAcao<font color="#808080">(</font>sreg<font color="#808080">, </font>opSalvarInclusao<font color="#808080">); </font>bSOp<font color="#808080">:=</font>false<font color="#808080">;
          </font><font color="#0000FF">when </font><font color="#808080">'</font><font color="#FF00FF">2</font><font color="#808080">' =&gt; </font>bSOp<font color="#808080">:=</font>false<font color="#808080">;
          </font><font color="#0000FF">when others </font><font color="#808080">=&gt; </font>put_line<font color="#808080">(</font>MSG_ERRO<font color="#808080">);
       </font><font color="#0000FF">end case</font><font color="#808080">;
    </font><font color="#0000FF">end loop</font><font color="#808080">;
 </font><font color="#0000FF">when </font><font color="#FF00FF">8 </font><font color="#808080">=&gt;
    </font><font color="#0000FF">while</font><font color="#808080">(</font>bSOp<font color="#808080">) </font><font color="#0000FF">loop
     </font>menu<font color="#808080">(</font>nmenu<font color="#808080">);
     </font>get_line<font color="#808080">(</font>opSubMenu<font color="#808080">);
     </font><font color="#0000FF">case</font><font color="#808080">(</font>opSubMenu<font color="#808080">) </font><font color="#0000FF">is
      when </font><font color="#808080">'</font><font color="#FF00FF">1</font><font color="#808080">' =&gt; </font>frmCadastros<font color="#808080">(</font>sreg<font color="#808080">, </font>opAlterar<font color="#808080">); </font>bSOp<font color="#808080">:=</font>false<font color="#808080">;
      </font><font color="#0000FF">when </font><font color="#808080">'</font><font color="#FF00FF">2</font><font color="#808080">' =&gt; </font>frmCadastros<font color="#808080">(</font>sreg<font color="#808080">, </font>opExcluir<font color="#808080">); </font>bSOp<font color="#808080">:=</font>false<font color="#808080">;
      </font><font color="#0000FF">when </font><font color="#808080">'</font><font color="#FF00FF">3</font><font color="#808080">' =&gt; </font>bSOp<font color="#808080">:=</font>false<font color="#808080">;
      </font><font color="#0000FF">when others </font><font color="#808080">=&gt; </font>put_line<font color="#808080">(</font>MSG_ERRO<font color="#808080">);
     </font><font color="#0000FF">end case</font><font color="#808080">;
    </font><font color="#0000FF">end loop</font><font color="#808080">;
 </font><font color="#0000FF">when </font><font color="#FF00FF">9 </font><font color="#808080">=&gt;
    </font><font color="#0000FF">while</font><font color="#808080">(</font>bSOp<font color="#808080">) </font><font color="#0000FF">loop
       </font>menu<font color="#808080">(</font>nmenu<font color="#808080">);
       </font>get_line<font color="#808080">(</font>opSubMenu<font color="#808080">);
       </font><font color="#0000FF">case</font><font color="#808080">(</font>opSubMenu<font color="#808080">) </font><font color="#0000FF">is
          when </font><font color="#808080">'</font><font color="#FF00FF">1</font><font color="#808080">' =&gt; </font>btnAcao<font color="#808080">(</font>sreg<font color="#808080">, </font>opSalvarAlteracao<font color="#808080">); </font>bSOp<font color="#808080">:=</font>false<font color="#808080">;
          </font><font color="#0000FF">when </font><font color="#808080">'</font><font color="#FF00FF">2</font><font color="#808080">' =&gt; </font>bSOp<font color="#808080">:=</font>false<font color="#808080">;
          </font><font color="#0000FF">when others </font><font color="#808080">=&gt; </font>put_line<font color="#808080">(</font>MSG_ERRO<font color="#808080">);
       </font><font color="#0000FF">end case</font><font color="#808080">;
    </font><font color="#0000FF">end loop</font><font color="#808080">;
 </font><font color="#0000FF">when </font><font color="#FF00FF">10 </font><font color="#808080">=&gt;
    </font><font color="#0000FF">while</font><font color="#808080">(</font>bSOp<font color="#808080">) </font><font color="#0000FF">loop
       </font>menu<font color="#808080">(</font>nmenu<font color="#808080">);
       </font>get_line<font color="#808080">(</font>opCSubMenu<font color="#808080">);
       </font><font color="#0000FF">if </font><font color="#808080">(</font>opCSubMenu<font color="#808080">='</font>S<font color="#808080">') </font><font color="#0000FF">or </font><font color="#808080">(</font>opCSubMenu<font color="#808080">='</font>s<font color="#808080">') </font><font color="#0000FF">then
          </font>btnAcao<font color="#808080">(</font>sreg<font color="#808080">, </font>opConfirmaExclusao<font color="#808080">);
          </font>bSOp<font color="#808080">:=</font>false<font color="#808080">;
       </font><font color="#0000FF">elsif </font><font color="#808080">(</font>opCSubMenu<font color="#808080">='</font>N<font color="#808080">') </font><font color="#0000FF">or </font><font color="#808080">(</font>opCSubMenu<font color="#808080">='</font>n<font color="#808080">') </font><font color="#0000FF">then </font>bSOp<font color="#808080">:=</font>false<font color="#808080">;
       </font><font color="#0000FF">else </font>put_line<font color="#808080">(</font>MSG_ERRO<font color="#808080">);
       </font><font color="#0000FF">end if</font><font color="#808080">;
    </font><font color="#0000FF">end loop</font><font color="#808080">;
 </font><font color="#0000FF">when </font><font color="#FF00FF">12 </font><font color="#808080">=&gt;
    </font><font color="#0000FF">while</font><font color="#808080">(</font>bSOp<font color="#808080">) </font><font color="#0000FF">loop
       </font>menu<font color="#808080">(</font>nmenu<font color="#808080">);
       </font>get_line<font color="#808080">(</font>opSubMenu<font color="#808080">);
       </font><font color="#0000FF">case</font><font color="#808080">(</font>opSubMenu<font color="#808080">) </font><font color="#0000FF">is
          when </font><font color="#808080">'</font><font color="#FF00FF">1</font><font color="#808080">' =&gt; </font>frmConsultas<font color="#808080">(</font>sreg<font color="#808080">, </font>opPesquisar<font color="#808080">);
          </font><font color="#0000FF">when </font><font color="#808080">'</font><font color="#FF00FF">2</font><font color="#808080">' =&gt; </font>frmConsultas<font color="#808080">(</font>sreg<font color="#808080">, </font>opListarTodos<font color="#808080">);
          </font><font color="#0000FF">when </font><font color="#808080">'</font><font color="#FF00FF">3</font><font color="#808080">' =&gt; </font>bSOp<font color="#808080">:=</font>false<font color="#808080">;
          </font><font color="#0000FF">when others </font><font color="#808080">=&gt; </font>put_line<font color="#808080">(</font>MSG_ERRO<font color="#808080">);
       </font><font color="#0000FF">end case</font><font color="#808080">;
    </font><font color="#0000FF">end loop</font><font color="#808080">;
 </font><font color="#0000FF">when </font><font color="#FF00FF">14 </font><font color="#808080">=&gt;
    </font><font color="#0000FF">while</font><font color="#808080">(</font>bSOp<font color="#808080">) </font><font color="#0000FF">loop
       </font>menu<font color="#808080">(</font>nmenu<font color="#808080">);
       </font>get_line<font color="#808080">(</font>opCSubMenu<font color="#808080">);
       </font><font color="#0000FF">if </font><font color="#808080">(</font>opCSubMenu<font color="#808080">='</font>S<font color="#808080">') </font><font color="#0000FF">or </font><font color="#808080">(</font>opCSubMenu<font color="#808080">='</font>s<font color="#808080">') </font><font color="#0000FF">then
          </font>btnAcao<font color="#808080">(</font>sreg<font color="#808080">, </font>opSalvarInclusao<font color="#808080">);
          </font>bSOp<font color="#808080">:=</font>false<font color="#808080">;
          </font>g_SalvarInclusao<font color="#808080">:=</font>true<font color="#808080">;
       </font><font color="#0000FF">elsif </font><font color="#808080">(</font>opCSubMenu<font color="#808080">='</font>N<font color="#808080">') </font><font color="#0000FF">or </font><font color="#808080">(</font>opCSubMenu<font color="#808080">='</font>n<font color="#808080">') </font><font color="#0000FF">then </font>bSOp<font color="#808080">:=</font>false<font color="#808080">;
       </font><font color="#0000FF">else </font>put_line<font color="#808080">(</font>MSG_ERRO<font color="#808080">);
       </font><font color="#0000FF">end if</font><font color="#808080">;
    </font><font color="#0000FF">end loop</font><font color="#808080">;
 </font><font color="#0000FF">when others </font><font color="#808080">=&gt; </font><font color="#0000FF">null</font><font color="#808080">;
</font><font color="#0000FF">end case</font><font color="#808080">;

</font><font color="#0000FF">end </font>subMenu<font color="#808080">;
</font><font color="#FF0000">-- ----------------------------------------------------------------------------
-- Seleciona o submenu e/ou a tela certa de acordo com n&uacute;mero do menu.
-- nmenu - o n&uacute;mero do menu
-- ----------------------------------------------------------------------------
</font><font color="#0000FF">procedure </font>usaMenu<font color="#808080">(</font>num<font color="#808080">: </font><font color="#0000FF">in </font>integer<font color="#808080">) </font><font color="#0000FF">is
</font>opSubMenu<font color="#808080">: </font>ustring<font color="#808080">;
</font>bSOp<font color="#808080">: </font>boolean<font color="#808080">;
</font>opSair<font color="#808080">: </font>character<font color="#808080">;
</font><font color="#0000FF">begin
 </font>bSOp<font color="#808080">:=</font>true<font color="#808080">;
 </font><font color="#0000FF">if </font>num <font color="#808080">= </font><font color="#FF00FF">1 </font><font color="#0000FF">then </font><font color="#FF0000">--  Cadastros --
   </font><font color="#0000FF">while</font><font color="#808080">(</font>bSOp<font color="#808080">) </font><font color="#0000FF">loop
     </font>menu<font color="#808080">(</font><font color="#FF00FF">2</font><font color="#808080">);
     </font>get_line<font color="#808080">(</font>opSubMenu<font color="#808080">);
     </font><font color="#0000FF">if </font>opSubMenu <font color="#808080">= </font>U<font color="#808080">(</font><font color="#008080">&quot;1&quot;</font><font color="#808080">) </font><font color="#0000FF">then </font>subMenu<font color="#808080">(</font><font color="#FF00FF">6</font><font color="#808080">, </font>opAssunto<font color="#808080">);
     </font><font color="#0000FF">elsif </font>opSubMenu <font color="#808080">= </font>U<font color="#808080">(</font><font color="#008080">&quot;2&quot;</font><font color="#808080">) </font><font color="#0000FF">then </font>subMenu<font color="#808080">(</font><font color="#FF00FF">6</font><font color="#808080">, </font>opAutor<font color="#808080">);
     </font><font color="#0000FF">elsif </font>opSubMenu <font color="#808080">= </font>U<font color="#808080">(</font><font color="#008080">&quot;3&quot;</font><font color="#808080">) </font><font color="#0000FF">then </font>subMenu<font color="#808080">(</font><font color="#FF00FF">6</font><font color="#808080">, </font>opEditora<font color="#808080">);
     </font><font color="#0000FF">elsif </font>opSubMenu <font color="#808080">= </font>U<font color="#808080">(</font><font color="#008080">&quot;4&quot;</font><font color="#808080">) </font><font color="#0000FF">then </font>subMenu<font color="#808080">(</font><font color="#FF00FF">6</font><font color="#808080">, </font>opEndereco<font color="#808080">);
     </font><font color="#0000FF">elsif </font>opSubMenu <font color="#808080">= </font>U<font color="#808080">(</font><font color="#008080">&quot;5&quot;</font><font color="#808080">) </font><font color="#0000FF">then </font>subMenu<font color="#808080">(</font><font color="#FF00FF">6</font><font color="#808080">, </font>opIdioma<font color="#808080">);
     </font><font color="#0000FF">elsif </font>opSubMenu <font color="#808080">= </font>U<font color="#808080">(</font><font color="#008080">&quot;6&quot;</font><font color="#808080">) </font><font color="#0000FF">then </font>subMenu<font color="#808080">(</font><font color="#FF00FF">6</font><font color="#808080">, </font>opPais<font color="#808080">);
     </font><font color="#0000FF">elsif </font>opSubMenu <font color="#808080">= </font>U<font color="#808080">(</font><font color="#008080">&quot;7&quot;</font><font color="#808080">) </font><font color="#0000FF">then </font>subMenu<font color="#808080">(</font><font color="#FF00FF">6</font><font color="#808080">, </font>opProfissao<font color="#808080">);
     </font><font color="#0000FF">elsif </font>opSubMenu <font color="#808080">= </font>U<font color="#808080">(</font><font color="#008080">&quot;8&quot;</font><font color="#808080">) </font><font color="#0000FF">then </font>subMenu<font color="#808080">(</font><font color="#FF00FF">6</font><font color="#808080">, </font>opCliente<font color="#808080">);
     </font><font color="#0000FF">elsif </font>opSubMenu <font color="#808080">= </font>U<font color="#808080">(</font><font color="#008080">&quot;9&quot;</font><font color="#808080">) </font><font color="#0000FF">then </font>subMenu<font color="#808080">(</font><font color="#FF00FF">6</font><font color="#808080">, </font>opLivro<font color="#808080">);
     </font><font color="#0000FF">elsif </font>opSubMenu <font color="#808080">= </font>U<font color="#808080">(</font><font color="#008080">&quot;10&quot;</font><font color="#808080">) </font><font color="#0000FF">then </font>bSOp<font color="#808080">:=</font>false<font color="#808080">;
     </font><font color="#0000FF">else </font>put_line<font color="#808080">(</font>MSG_ERRO<font color="#808080">);
     </font><font color="#0000FF">end if</font><font color="#808080">;
   </font><font color="#0000FF">end loop</font><font color="#808080">;
 </font><font color="#0000FF">elsif </font>num <font color="#808080">= </font><font color="#FF00FF">2 </font><font color="#0000FF">then </font><font color="#FF0000">--  Pesquisas --
   </font><font color="#0000FF">while</font><font color="#808080">(</font>bSOp<font color="#808080">) </font><font color="#0000FF">loop
     </font>menu<font color="#808080">(</font><font color="#FF00FF">3</font><font color="#808080">);
     </font>get_line<font color="#808080">(</font>opSubMenu<font color="#808080">);
     </font><font color="#0000FF">if </font>opSubMenu <font color="#808080">= </font>U<font color="#808080">(</font><font color="#008080">&quot;1&quot;</font><font color="#808080">) </font><font color="#0000FF">then </font>subMenu<font color="#808080">(</font><font color="#FF00FF">12</font><font color="#808080">, </font>opAssunto<font color="#808080">);
     </font><font color="#0000FF">elsif </font>opSubMenu <font color="#808080">= </font>U<font color="#808080">(</font><font color="#008080">&quot;2&quot;</font><font color="#808080">) </font><font color="#0000FF">then </font>subMenu<font color="#808080">(</font><font color="#FF00FF">12</font><font color="#808080">, </font>opAutor<font color="#808080">);
     </font><font color="#0000FF">elsif </font>opSubMenu <font color="#808080">= </font>U<font color="#808080">(</font><font color="#008080">&quot;3&quot;</font><font color="#808080">) </font><font color="#0000FF">then </font>subMenu<font color="#808080">(</font><font color="#FF00FF">12</font><font color="#808080">, </font>opEditora<font color="#808080">);
     </font><font color="#0000FF">elsif </font>opSubMenu <font color="#808080">= </font>U<font color="#808080">(</font><font color="#008080">&quot;4&quot;</font><font color="#808080">) </font><font color="#0000FF">then </font>subMenu<font color="#808080">(</font><font color="#FF00FF">12</font><font color="#808080">, </font>opEndereco<font color="#808080">);
     </font><font color="#0000FF">elsif </font>opSubMenu <font color="#808080">= </font>U<font color="#808080">(</font><font color="#008080">&quot;5&quot;</font><font color="#808080">) </font><font color="#0000FF">then </font>subMenu<font color="#808080">(</font><font color="#FF00FF">12</font><font color="#808080">, </font>opIdioma<font color="#808080">);
     </font><font color="#0000FF">elsif </font>opSubMenu <font color="#808080">= </font>U<font color="#808080">(</font><font color="#008080">&quot;6&quot;</font><font color="#808080">) </font><font color="#0000FF">then </font>subMenu<font color="#808080">(</font><font color="#FF00FF">12</font><font color="#808080">, </font>opPais<font color="#808080">);
     </font><font color="#0000FF">elsif </font>opSubMenu <font color="#808080">= </font>U<font color="#808080">(</font><font color="#008080">&quot;7&quot;</font><font color="#808080">) </font><font color="#0000FF">then </font>subMenu<font color="#808080">(</font><font color="#FF00FF">12</font><font color="#808080">, </font>opProfissao<font color="#808080">);
     </font><font color="#0000FF">elsif </font>opSubMenu <font color="#808080">= </font>U<font color="#808080">(</font><font color="#008080">&quot;8&quot;</font><font color="#808080">) </font><font color="#0000FF">then </font>subMenu<font color="#808080">(</font><font color="#FF00FF">12</font><font color="#808080">, </font>opCliente<font color="#808080">);
     </font><font color="#0000FF">elsif </font>opSubMenu <font color="#808080">= </font>U<font color="#808080">(</font><font color="#008080">&quot;9&quot;</font><font color="#808080">) </font><font color="#0000FF">then </font>subMenu<font color="#808080">(</font><font color="#FF00FF">12</font><font color="#808080">, </font>opLivro<font color="#808080">);
     </font><font color="#0000FF">elsif </font>opSubMenu <font color="#808080">= </font>U<font color="#808080">(</font><font color="#008080">&quot;10&quot;</font><font color="#808080">) </font><font color="#0000FF">then </font>bSOp<font color="#808080">:=</font>false<font color="#808080">;
     </font><font color="#0000FF">else </font>put_line<font color="#808080">(</font>MSG_ERRO<font color="#808080">);
     </font><font color="#0000FF">end if</font><font color="#808080">;
   </font><font color="#0000FF">end loop</font><font color="#808080">;
 </font><font color="#0000FF">elsif </font>num <font color="#808080">= </font><font color="#FF00FF">3 </font><font color="#0000FF">then </font><font color="#FF0000">--  Vendas --
   </font><font color="#0000FF">while</font><font color="#808080">(</font>bSOp<font color="#808080">) </font><font color="#0000FF">loop
     </font>menu<font color="#808080">(</font><font color="#FF00FF">4</font><font color="#808080">);
     </font>get_line<font color="#808080">(</font>opSubMenu<font color="#808080">);
     </font><font color="#0000FF">if </font>opSubMenu <font color="#808080">= </font>U<font color="#808080">(</font><font color="#008080">&quot;1&quot;</font><font color="#808080">) </font><font color="#0000FF">then </font>subMenu<font color="#808080">(</font><font color="#FF00FF">6</font><font color="#808080">, </font>opVenda<font color="#808080">);
     </font><font color="#0000FF">elsif </font>opSubMenu <font color="#808080">= </font>U<font color="#808080">(</font><font color="#008080">&quot;2&quot;</font><font color="#808080">) </font><font color="#0000FF">then </font>subMenu<font color="#808080">(</font><font color="#FF00FF">12</font><font color="#808080">, </font>opVenda<font color="#808080">);
     </font><font color="#0000FF">elsif </font>opSubMenu <font color="#808080">= </font>U<font color="#808080">(</font><font color="#008080">&quot;3&quot;</font><font color="#808080">) </font><font color="#0000FF">then </font>bSOp<font color="#808080">:=</font>false<font color="#808080">;
     </font><font color="#0000FF">else </font>put_line<font color="#808080">(</font>MSG_ERRO<font color="#808080">);
     </font><font color="#0000FF">end if</font><font color="#808080">;
   </font><font color="#0000FF">end loop</font><font color="#808080">;
 </font><font color="#0000FF">elsif </font>num <font color="#808080">= </font><font color="#FF00FF">4 </font><font color="#0000FF">then </font><font color="#FF0000">--  Opcoes --
   </font><font color="#0000FF">while</font><font color="#808080">(</font>bSOp<font color="#808080">) </font><font color="#0000FF">loop
     </font>menu<font color="#808080">(</font><font color="#FF00FF">5</font><font color="#808080">);
     </font>get_line<font color="#808080">(</font>opSubMenu<font color="#808080">);
     </font><font color="#0000FF">if </font>opSubMenu <font color="#808080">= </font>U<font color="#808080">(</font><font color="#008080">&quot;1&quot;</font><font color="#808080">) </font><font color="#0000FF">then </font>frmAlterarSenha<font color="#808080">;
     </font><font color="#0000FF">elsif </font>opSubMenu <font color="#808080">= </font>U<font color="#808080">(</font><font color="#008080">&quot;2&quot;</font><font color="#808080">) </font><font color="#0000FF">then </font>frmSobre<font color="#808080">;
     </font><font color="#0000FF">elsif </font>opSubMenu <font color="#808080">= </font>U<font color="#808080">(</font><font color="#008080">&quot;3&quot;</font><font color="#808080">) </font><font color="#0000FF">then
         </font>menu<font color="#808080">(</font><font color="#FF00FF">11</font><font color="#808080">);
         </font>get_line<font color="#808080">(</font>opSair<font color="#808080">);
         </font><font color="#0000FF">if </font><font color="#808080">(</font>opSair<font color="#808080">='</font>S<font color="#808080">') </font><font color="#0000FF">or </font><font color="#808080">(</font>opSair<font color="#808080">='</font>s<font color="#808080">') </font><font color="#0000FF">then
            </font>fechaArqs<font color="#808080">;
            </font>bopcao<font color="#808080">:=</font>false<font color="#808080">;
            </font>bSOp<font color="#808080">:=</font>false<font color="#808080">;
         </font><font color="#0000FF">end if</font><font color="#808080">;
     </font><font color="#0000FF">elsif </font>opSubMenu <font color="#808080">= </font>U<font color="#808080">(</font><font color="#008080">&quot;4&quot;</font><font color="#808080">) </font><font color="#0000FF">then </font>bSOp<font color="#808080">:=</font>false<font color="#808080">;
     </font><font color="#0000FF">else </font>put_line<font color="#808080">(</font>MSG_ERRO<font color="#808080">);
     </font><font color="#0000FF">end if</font><font color="#808080">;
   </font><font color="#0000FF">end loop</font><font color="#808080">;
 </font><font color="#0000FF">end if</font><font color="#808080">;
</font><font color="#0000FF">end </font>usaMenu<font color="#808080">;

</font><font color="#FF0000">-- ----------------------------------------------------------------------------
-- Mostra as entradas e as sa&iacute;das do sistema.
-- sreg - o tipo de arquivo
-- slinha - o registro com os dados
-- nOpcao - indica qual op&ccedil;&atilde;o ser&aacute; mostrada
-- ----------------------------------------------------------------------------
</font><font color="#0000FF">procedure </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">: </font><font color="#0000FF">in </font>ctArqs<font color="#808080">; </font>slinha<font color="#808080">: </font><font color="#0000FF">in </font>ustring<font color="#808080">; 
          </font>nOpcao<font color="#808080">: </font><font color="#0000FF">in </font>integer<font color="#808080">) </font><font color="#0000FF">is
begin
if </font>sreg<font color="#808080">=</font>opAssunto <font color="#0000FF">then
   case </font>nOpcao <font color="#0000FF">is
    when </font><font color="#FF00FF">1 </font><font color="#808080">=&gt;
        </font>put_line<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF00FF">1</font><font color="#808080">) &amp; </font>tAssunto<font color="#808080">.</font>codigo<font color="#808080">);
        </font>put<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF00FF">2</font><font color="#808080">));
        </font>get_line<font color="#808080">(</font>tAssunto<font color="#808080">.</font>assunto<font color="#808080">);
    </font><font color="#0000FF">when </font><font color="#FF00FF">2 </font><font color="#808080">=&gt;
        </font>put_line<font color="#808080">(</font><font color="#008080">&quot;C&oacute;digo     Assunto&quot;</font><font color="#808080">);
        </font>put_line<font color="#808080">(</font><font color="#008080">&quot;------     -------&quot;</font><font color="#808080">);
    </font><font color="#0000FF">when </font><font color="#FF00FF">3 </font><font color="#808080">=&gt;
        </font>tAssunto<font color="#808080">.</font>codigo<font color="#808080">:=</font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF00FF">1</font><font color="#808080">, </font><font color="#FF00FF">10</font><font color="#808080">);
        </font>tAssunto<font color="#808080">.</font>assunto<font color="#808080">:=</font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF00FF">11</font><font color="#808080">, </font><font color="#FF00FF">30</font><font color="#808080">);
        </font>put_line<font color="#808080">(</font>tAssunto<font color="#808080">.</font>codigo <font color="#808080">&amp; </font><font color="#008080">&quot; &quot; </font><font color="#808080">&amp; </font>tAssunto<font color="#808080">.</font>assunto<font color="#808080">);
    </font><font color="#0000FF">when others </font><font color="#808080">=&gt; </font><font color="#0000FF">null</font><font color="#808080">;
   </font><font color="#0000FF">end case</font><font color="#808080">;
</font><font color="#0000FF">elsif </font>sreg<font color="#808080">=</font>opAutor <font color="#0000FF">then
   case </font>nOpcao <font color="#0000FF">is
    when </font><font color="#FF00FF">1 </font><font color="#808080">=&gt;
        </font>put_line<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF00FF">1</font><font color="#808080">) &amp; </font>tAutor<font color="#808080">.</font>codigo<font color="#808080">);
        </font>put<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF00FF">2</font><font color="#808080">));
        </font>get_line<font color="#808080">(</font>tAutor<font color="#808080">.</font>autor<font color="#808080">);
    </font><font color="#0000FF">when </font><font color="#FF00FF">2 </font><font color="#808080">=&gt;
        </font>put_line<font color="#808080">(</font><font color="#008080">&quot;C&oacute;digo     Autor&quot;</font><font color="#808080">);
        </font>put_line<font color="#808080">(</font><font color="#008080">&quot;------     -----&quot;</font><font color="#808080">);
    </font><font color="#0000FF">when </font><font color="#FF00FF">3 </font><font color="#808080">=&gt;
        </font>tAutor<font color="#808080">.</font>codigo<font color="#808080">:=</font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF00FF">1</font><font color="#808080">, </font><font color="#FF00FF">10</font><font color="#808080">);
        </font>tAutor<font color="#808080">.</font>autor<font color="#808080">:=</font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF00FF">11</font><font color="#808080">, </font><font color="#FF00FF">30</font><font color="#808080">);
        </font>put_line<font color="#808080">(</font>tAutor<font color="#808080">.</font>codigo <font color="#808080">&amp; </font><font color="#008080">&quot; &quot; </font><font color="#808080">&amp; </font>tAutor<font color="#808080">.</font>autor<font color="#808080">);
    </font><font color="#0000FF">when others </font><font color="#808080">=&gt; </font><font color="#0000FF">null</font><font color="#808080">;
   </font><font color="#0000FF">end case</font><font color="#808080">;
</font><font color="#0000FF">elsif </font>sreg<font color="#808080">=</font>opEditora <font color="#0000FF">then
   case </font>nOpcao <font color="#0000FF">is
    when </font><font color="#FF00FF">1 </font><font color="#808080">=&gt;
        </font>put_line<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF00FF">1</font><font color="#808080">) &amp; </font>tEditora<font color="#808080">.</font>codigo<font color="#808080">);
        </font>put<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF00FF">2</font><font color="#808080">));
        </font>get_line<font color="#808080">(</font>tEditora<font color="#808080">.</font>editora<font color="#808080">);
    </font><font color="#0000FF">when </font><font color="#FF00FF">2 </font><font color="#808080">=&gt;
        </font>put_line<font color="#808080">(</font><font color="#008080">&quot;C&oacute;digo     Editora&quot;</font><font color="#808080">);
        </font>put_line<font color="#808080">(</font><font color="#008080">&quot;------     -------&quot;</font><font color="#808080">);
    </font><font color="#0000FF">when </font><font color="#FF00FF">3 </font><font color="#808080">=&gt;
        </font>tEditora<font color="#808080">.</font>codigo<font color="#808080">:=</font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF00FF">1</font><font color="#808080">, </font><font color="#FF00FF">10</font><font color="#808080">);
        </font>tEditora<font color="#808080">.</font>editora<font color="#808080">:=</font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF00FF">11</font><font color="#808080">, </font><font color="#FF00FF">50</font><font color="#808080">);
        </font>put_line<font color="#808080">(</font>tEditora<font color="#808080">.</font>codigo <font color="#808080">&amp; </font><font color="#008080">&quot; &quot; </font><font color="#808080">&amp; </font>tEditora<font color="#808080">.</font>editora<font color="#808080">);
    </font><font color="#0000FF">when others </font><font color="#808080">=&gt; </font><font color="#0000FF">null</font><font color="#808080">;
   </font><font color="#0000FF">end case</font><font color="#808080">;
</font><font color="#0000FF">elsif </font>sreg<font color="#808080">=</font>opEndereco <font color="#0000FF">then
   case </font>nOpcao <font color="#0000FF">is
    when </font><font color="#FF00FF">1 </font><font color="#808080">=&gt;
        </font>put_line<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF00FF">1</font><font color="#808080">) &amp; </font>tEndereco<font color="#808080">.</font>codigo<font color="#808080">);
        </font>put<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF00FF">2</font><font color="#808080">));
        </font>get_line<font color="#808080">(</font>tEndereco<font color="#808080">.</font>Logradouro<font color="#808080">);
        </font>put<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF00FF">3</font><font color="#808080">));
        </font>get_line<font color="#808080">(</font>tEndereco<font color="#808080">.</font>bairro<font color="#808080">);
        </font>put<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF00FF">4</font><font color="#808080">));
        </font>get_line<font color="#808080">(</font>tEndereco<font color="#808080">.</font>cep<font color="#808080">);
        </font>put<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF00FF">5</font><font color="#808080">));
        </font>get_line<font color="#808080">(</font>tEndereco<font color="#808080">.</font>cidade<font color="#808080">);
        </font>put<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF00FF">6</font><font color="#808080">));
        </font>get_line<font color="#808080">(</font>tEndereco<font color="#808080">.</font>estado<font color="#808080">);
    </font><font color="#0000FF">when </font><font color="#FF00FF">3 </font><font color="#808080">=&gt;
        </font>tEndereco<font color="#808080">.</font>codigo<font color="#808080">:=</font>trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF00FF">1</font><font color="#808080">, </font><font color="#FF00FF">10</font><font color="#808080">), </font>Both<font color="#808080">);
        </font>tEndereco<font color="#808080">.</font>logradouro<font color="#808080">:=</font>trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF00FF">11</font><font color="#808080">, </font><font color="#FF00FF">40</font><font color="#808080">), </font>Both<font color="#808080">);
        </font>tEndereco<font color="#808080">.</font>bairro<font color="#808080">:=</font>trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF00FF">51</font><font color="#808080">, </font><font color="#FF00FF">15</font><font color="#808080">), </font>Both<font color="#808080">);
        </font>tEndereco<font color="#808080">.</font>cep<font color="#808080">:=</font>trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF00FF">66</font><font color="#808080">, </font><font color="#FF00FF">8</font><font color="#808080">), </font>Both<font color="#808080">);
        </font>tEndereco<font color="#808080">.</font>cidade<font color="#808080">:=</font>trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF00FF">74</font><font color="#808080">, </font><font color="#FF00FF">30</font><font color="#808080">), </font>Both<font color="#808080">);
        </font>tEndereco<font color="#808080">.</font>estado<font color="#808080">:=</font>trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF00FF">104</font><font color="#808080">, </font><font color="#FF00FF">20</font><font color="#808080">), </font>Both<font color="#808080">);
        </font>put_line<font color="#808080">(</font><font color="#008080">&quot;--------------------&quot;</font><font color="#808080">);
        </font>put_line<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF00FF">1</font><font color="#808080">) &amp; </font>tEndereco<font color="#808080">.</font>codigo<font color="#808080">);
        </font>put_line<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF00FF">2</font><font color="#808080">) &amp; </font>tEndereco<font color="#808080">.</font>Logradouro<font color="#808080">);
        </font>put_line<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF00FF">3</font><font color="#808080">) &amp; </font>tEndereco<font color="#808080">.</font>bairro<font color="#808080">);
        </font>put_line<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF00FF">4</font><font color="#808080">) &amp; </font>tEndereco<font color="#808080">.</font>cep<font color="#808080">);
        </font>put_line<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF00FF">5</font><font color="#808080">) &amp; </font>tEndereco<font color="#808080">.</font>cidade<font color="#808080">);
        </font>put_line<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF00FF">6</font><font color="#808080">) &amp; </font>tEndereco<font color="#808080">.</font>estado<font color="#808080">);
    </font><font color="#0000FF">when others </font><font color="#808080">=&gt; </font><font color="#0000FF">null</font><font color="#808080">;
   </font><font color="#0000FF">end case</font><font color="#808080">;
</font><font color="#0000FF">elsif </font>sreg<font color="#808080">=</font>opIdioma <font color="#0000FF">then
   case </font>nOpcao <font color="#0000FF">is
    when </font><font color="#FF00FF">1 </font><font color="#808080">=&gt;
        </font>put_line<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF00FF">1</font><font color="#808080">) &amp; </font>tIdioma<font color="#808080">.</font>codigo<font color="#808080">);
        </font>put<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF00FF">2</font><font color="#808080">));
        </font>get_line<font color="#808080">(</font>tIdioma<font color="#808080">.</font>idioma<font color="#808080">);
    </font><font color="#0000FF">when </font><font color="#FF00FF">2 </font><font color="#808080">=&gt;
        </font>put_line<font color="#808080">(</font><font color="#008080">&quot;C&oacute;digo     Idioma&quot;</font><font color="#808080">);
        </font>put_line<font color="#808080">(</font><font color="#008080">&quot;------     ------&quot;</font><font color="#808080">);
    </font><font color="#0000FF">when </font><font color="#FF00FF">3 </font><font color="#808080">=&gt;
        </font>tIdioma<font color="#808080">.</font>codigo<font color="#808080">:=</font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF00FF">1</font><font color="#808080">, </font><font color="#FF00FF">10</font><font color="#808080">);
        </font>tIdioma<font color="#808080">.</font>idioma<font color="#808080">:=</font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF00FF">11</font><font color="#808080">, </font><font color="#FF00FF">20</font><font color="#808080">);
        </font>put_line<font color="#808080">(</font>tIdioma<font color="#808080">.</font>codigo <font color="#808080">&amp; </font><font color="#008080">&quot; &quot; </font><font color="#808080">&amp; </font>tIdioma<font color="#808080">.</font>idioma<font color="#808080">);
    </font><font color="#0000FF">when others </font><font color="#808080">=&gt; </font><font color="#0000FF">null</font><font color="#808080">;
   </font><font color="#0000FF">end case</font><font color="#808080">;
</font><font color="#0000FF">elsif </font>sreg<font color="#808080">=</font>opPais <font color="#0000FF">then
   case </font>nOpcao <font color="#0000FF">is
    when </font><font color="#FF00FF">1 </font><font color="#808080">=&gt;
        </font>put<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF00FF">2</font><font color="#808080">));
        </font>get_line<font color="#808080">(</font>tPais<font color="#808080">.</font>pais<font color="#808080">);
    </font><font color="#0000FF">when </font><font color="#FF00FF">2 </font><font color="#808080">=&gt;
        </font>put_line<font color="#808080">(</font><font color="#008080">&quot;C&oacute;digo Pa&iacute;s&quot;</font><font color="#808080">);
        </font>put_line<font color="#808080">(</font><font color="#008080">&quot;------ ----&quot;</font><font color="#808080">);
    </font><font color="#0000FF">when </font><font color="#FF00FF">3 </font><font color="#808080">=&gt;
        </font>tPais<font color="#808080">.</font>codigo<font color="#808080">:=</font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF00FF">1</font><font color="#808080">, </font><font color="#FF00FF">3</font><font color="#808080">);
        </font>tPais<font color="#808080">.</font>pais<font color="#808080">:=</font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF00FF">4</font><font color="#808080">, </font><font color="#FF00FF">50</font><font color="#808080">);
        </font>put_line<font color="#808080">(</font>tPais<font color="#808080">.</font>codigo <font color="#808080">&amp; </font><font color="#008080">&quot;    &quot; </font><font color="#808080">&amp; </font>tPais<font color="#808080">.</font>pais<font color="#808080">);
    </font><font color="#0000FF">when others </font><font color="#808080">=&gt; </font><font color="#0000FF">null</font><font color="#808080">;
   </font><font color="#0000FF">end case</font><font color="#808080">;
</font><font color="#0000FF">elsif </font>sreg<font color="#808080">=</font>opProfissao <font color="#0000FF">then
   case </font>nOpcao <font color="#0000FF">is
    when </font><font color="#FF00FF">1 </font><font color="#808080">=&gt;
        </font>put_line<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF00FF">1</font><font color="#808080">) &amp; </font>tProfissao<font color="#808080">.</font>codigo<font color="#808080">);
        </font>put<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF00FF">2</font><font color="#808080">));
        </font>get_line<font color="#808080">(</font>tProfissao<font color="#808080">.</font>profissao<font color="#808080">);
    </font><font color="#0000FF">when </font><font color="#FF00FF">2 </font><font color="#808080">=&gt;
        </font>put_line<font color="#808080">(</font><font color="#008080">&quot;C&oacute;digo     Profiss&atilde;o&quot;</font><font color="#808080">);
        </font>put_line<font color="#808080">(</font><font color="#008080">&quot;------     ---------&quot;</font><font color="#808080">);
    </font><font color="#0000FF">when </font><font color="#FF00FF">3 </font><font color="#808080">=&gt;
        </font>tProfissao<font color="#808080">.</font>codigo<font color="#808080">:=</font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF00FF">1</font><font color="#808080">, </font><font color="#FF00FF">10</font><font color="#808080">);
        </font>tProfissao<font color="#808080">.</font>profissao<font color="#808080">:=</font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF00FF">11</font><font color="#808080">, </font><font color="#FF00FF">50</font><font color="#808080">);
        </font>put_line<font color="#808080">(</font>tProfissao<font color="#808080">.</font>codigo <font color="#808080">&amp; </font><font color="#008080">&quot; &quot; </font><font color="#808080">&amp; </font>tProfissao<font color="#808080">.</font>profissao<font color="#808080">);
    </font><font color="#0000FF">when others </font><font color="#808080">=&gt; </font><font color="#0000FF">null</font><font color="#808080">;
   </font><font color="#0000FF">end case</font><font color="#808080">;
</font><font color="#0000FF">elsif </font>sreg<font color="#808080">=</font>opLivro <font color="#0000FF">then
   case </font>nOpcao <font color="#0000FF">is
    when </font><font color="#FF00FF">1 </font><font color="#808080">=&gt;
        </font>put<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF00FF">2</font><font color="#808080">));
        </font>get_line<font color="#808080">(</font>tLivro<font color="#808080">.</font>titulo<font color="#808080">);
        </font>tLivro<font color="#808080">.</font>edicao<font color="#808080">:=</font>validaNumero<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF00FF">3</font><font color="#808080">), </font>tLivro<font color="#808080">.</font>edicao<font color="#808080">);
        </font>tLivro<font color="#808080">.</font>anopubli<font color="#808080">:=</font>validaNumero<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF00FF">4</font><font color="#808080">), </font>tLivro<font color="#808080">.</font>anopubli<font color="#808080">);
        </font>mostrarSubDados<font color="#808080">(</font>opLivro<font color="#808080">, </font>opEditora<font color="#808080">, </font>false<font color="#808080">);
        </font>tLivro<font color="#808080">.</font>volume<font color="#808080">:=</font>validaNumero<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF00FF">6</font><font color="#808080">), </font>tLivro<font color="#808080">.</font>volume<font color="#808080">);
        </font>mostrarSubDados<font color="#808080">(</font>opLivro<font color="#808080">, </font>opIdioma<font color="#808080">, </font>false<font color="#808080">);
        </font>tLivro<font color="#808080">.</font>npaginas<font color="#808080">:=</font>validaNumero<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF00FF">8</font><font color="#808080">), </font>tLivro<font color="#808080">.</font>npaginas<font color="#808080">);
        </font>tLivro<font color="#808080">.</font>preco<font color="#808080">:=</font>validaNumero<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF00FF">9</font><font color="#808080">), </font>tLivro<font color="#808080">.</font>preco<font color="#808080">);
        </font>tLivro<font color="#808080">.</font>qtdestoque<font color="#808080">:=</font>validaNumero<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF00FF">10</font><font color="#808080">), </font>tLivro<font color="#808080">.</font>qtdestoque<font color="#808080">);
    </font><font color="#0000FF">when </font><font color="#FF00FF">3 </font><font color="#808080">=&gt;
        </font>tLivro<font color="#808080">.</font>isbn<font color="#808080">:=</font>trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF00FF">1</font><font color="#808080">, </font><font color="#FF00FF">13</font><font color="#808080">), </font>Both<font color="#808080">);
        </font>tLivro<font color="#808080">.</font>titulo<font color="#808080">:=</font>trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF00FF">14</font><font color="#808080">, </font><font color="#FF00FF">50</font><font color="#808080">), </font>Both<font color="#808080">);
        </font>tLivro<font color="#808080">.</font>edicao<font color="#808080">:=</font>trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF00FF">64</font><font color="#808080">, </font><font color="#FF00FF">10</font><font color="#808080">), </font>Both<font color="#808080">);
        </font>tLivro<font color="#808080">.</font>anopubli<font color="#808080">:=</font>trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF00FF">74</font><font color="#808080">, </font><font color="#FF00FF">10</font><font color="#808080">), </font>Both<font color="#808080">);
        </font>tLivro<font color="#808080">.</font>codeditora<font color="#808080">:=</font>trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF00FF">84</font><font color="#808080">, </font><font color="#FF00FF">10</font><font color="#808080">), </font>Both<font color="#808080">);
        </font>tLivro<font color="#808080">.</font>volume<font color="#808080">:=</font>trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF00FF">94</font><font color="#808080">, </font><font color="#FF00FF">10</font><font color="#808080">), </font>Both<font color="#808080">);
        </font>tLivro<font color="#808080">.</font>codidioma<font color="#808080">:=</font>trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF00FF">104</font><font color="#808080">, </font><font color="#FF00FF">10</font><font color="#808080">), </font>Both<font color="#808080">);
        </font>tLivro<font color="#808080">.</font>npaginas<font color="#808080">:=</font>trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF00FF">114</font><font color="#808080">, </font><font color="#FF00FF">10</font><font color="#808080">), </font>Both<font color="#808080">);
        </font>tLivro<font color="#808080">.</font>preco<font color="#808080">:=</font>trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF00FF">124</font><font color="#808080">, </font><font color="#FF00FF">10</font><font color="#808080">), </font>Both<font color="#808080">);
        </font>tLivro<font color="#808080">.</font>qtdestoque<font color="#808080">:=</font>trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF00FF">134</font><font color="#808080">, </font><font color="#FF00FF">10</font><font color="#808080">), </font>Both<font color="#808080">);
        </font>put_line<font color="#808080">(</font><font color="#008080">&quot;--------------------&quot;</font><font color="#808080">);
        </font>put_line<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF00FF">1</font><font color="#808080">) &amp; </font>tLivro<font color="#808080">.</font>isbn<font color="#808080">);
        </font>put_line<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF00FF">2</font><font color="#808080">) &amp; </font>tLivro<font color="#808080">.</font>titulo<font color="#808080">);
        </font>put_line<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF00FF">3</font><font color="#808080">) &amp; </font>tLivro<font color="#808080">.</font>edicao<font color="#808080">);
        </font>put_line<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF00FF">4</font><font color="#808080">) &amp; </font>tLivro<font color="#808080">.</font>anopubli<font color="#808080">);
        </font>put_line<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF00FF">5</font><font color="#808080">) &amp; </font>tLivro<font color="#808080">.</font>codeditora<font color="#808080">);
        </font>mostrarSubDados<font color="#808080">(</font>opLivro<font color="#808080">, </font>opEditora<font color="#808080">, </font>true<font color="#808080">);
        </font>put_line<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF00FF">6</font><font color="#808080">) &amp; </font>tLivro<font color="#808080">.</font>volume<font color="#808080">);
        </font>put_line<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF00FF">7</font><font color="#808080">) &amp; </font>tLivro<font color="#808080">.</font>codidioma<font color="#808080">);
        </font>mostrarSubDados<font color="#808080">(</font>opLivro<font color="#808080">, </font>opIdioma<font color="#808080">, </font>true<font color="#808080">);
        </font>put_line<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF00FF">8</font><font color="#808080">) &amp; </font>tLivro<font color="#808080">.</font>npaginas<font color="#808080">);
        </font>put_line<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF00FF">9</font><font color="#808080">) &amp; </font>tLivro<font color="#808080">.</font>preco<font color="#808080">);
        </font>put_line<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF00FF">10</font><font color="#808080">) &amp; </font>tLivro<font color="#808080">.</font>qtdestoque<font color="#808080">);
        </font>ListarRegLigados<font color="#808080">(</font>taLivroAss<font color="#808080">, </font>opLivroAss<font color="#808080">, </font><font color="#FF00FF">1</font><font color="#808080">, </font><font color="#FF00FF">13</font><font color="#808080">, </font><font color="#FF00FF">14</font><font color="#808080">, </font><font color="#FF00FF">10</font><font color="#808080">, </font>tLivro<font color="#808080">.</font>isbn<font color="#808080">,
                         </font>taAssunto<font color="#808080">, </font>opAssunto<font color="#808080">, </font><font color="#FF00FF">1</font><font color="#808080">, </font><font color="#FF00FF">4</font><font color="#808080">);
        </font>ListarRegLigados<font color="#808080">(</font>taLivroAut<font color="#808080">, </font>opLivroAut<font color="#808080">, </font><font color="#FF00FF">1</font><font color="#808080">, </font><font color="#FF00FF">13</font><font color="#808080">, </font><font color="#FF00FF">14</font><font color="#808080">, </font><font color="#FF00FF">10</font><font color="#808080">, </font>tLivro<font color="#808080">.</font>isbn<font color="#808080">,
                         </font>taAutor<font color="#808080">, </font>opAutor<font color="#808080">, </font><font color="#FF00FF">1</font><font color="#808080">, </font><font color="#FF00FF">4</font><font color="#808080">);
    </font><font color="#0000FF">when others </font><font color="#808080">=&gt; </font><font color="#0000FF">null</font><font color="#808080">;
   </font><font color="#0000FF">end case</font><font color="#808080">;
</font><font color="#0000FF">elsif </font>sreg<font color="#808080">=</font>opCliente <font color="#0000FF">then
   case </font>nOpcao <font color="#0000FF">is
    when </font><font color="#FF00FF">1 </font><font color="#808080">=&gt;
        </font>put<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF00FF">2</font><font color="#808080">));
        </font>get_line<font color="#808080">(</font>tCliente<font color="#808080">.</font>nome<font color="#808080">);
        </font>put<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF00FF">3</font><font color="#808080">));
        </font>get_line<font color="#808080">(</font>tCliente<font color="#808080">.</font>email<font color="#808080">);
        </font>put<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF00FF">4</font><font color="#808080">));
        </font>get_line<font color="#808080">(</font>tCliente<font color="#808080">.</font>identidade<font color="#808080">);
        </font>put<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF00FF">5</font><font color="#808080">));
        </font>get_line<font color="#808080">(</font>tCliente<font color="#808080">.</font>sexo<font color="#808080">);
        </font>put<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF00FF">6</font><font color="#808080">));
        </font>get_line<font color="#808080">(</font>tCliente<font color="#808080">.</font>telefone<font color="#808080">);
        </font>tCliente<font color="#808080">.</font>dtnascimento<font color="#808080">:=
                </font>validaDataHora<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF00FF">7</font><font color="#808080">), </font>tCliente<font color="#808080">.</font>dtnascimento<font color="#808080">, </font>true<font color="#808080">);
        </font>mostrarSubDados<font color="#808080">(</font>opCliente<font color="#808080">, </font>opEndereco<font color="#808080">, </font>false<font color="#808080">);
        </font>mostrarSubDados<font color="#808080">(</font>opCliente<font color="#808080">, </font>opPais<font color="#808080">, </font>false<font color="#808080">);
        </font>mostrarSubDados<font color="#808080">(</font>opCliente<font color="#808080">, </font>opProfissao<font color="#808080">, </font>false<font color="#808080">);
    </font><font color="#0000FF">when </font><font color="#FF00FF">3 </font><font color="#808080">=&gt;
        </font>tCliente<font color="#808080">.</font>cpf<font color="#808080">:=</font>trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF00FF">1</font><font color="#808080">, </font><font color="#FF00FF">14</font><font color="#808080">), </font>Both<font color="#808080">);
        </font>tCliente<font color="#808080">.</font>nome<font color="#808080">:=</font>trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF00FF">15</font><font color="#808080">, </font><font color="#FF00FF">30</font><font color="#808080">), </font>Both<font color="#808080">);
        </font>tCliente<font color="#808080">.</font>email<font color="#808080">:=</font>trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF00FF">45</font><font color="#808080">, </font><font color="#FF00FF">30</font><font color="#808080">), </font>Both<font color="#808080">);
        </font>tCliente<font color="#808080">.</font>identidade<font color="#808080">:=</font>trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF00FF">75</font><font color="#808080">, </font><font color="#FF00FF">10</font><font color="#808080">), </font>Both<font color="#808080">);
        </font>tCliente<font color="#808080">.</font>sexo<font color="#808080">:=</font>trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF00FF">85</font><font color="#808080">, </font><font color="#FF00FF">1</font><font color="#808080">), </font>Both<font color="#808080">);
        </font>tCliente<font color="#808080">.</font>telefone<font color="#808080">:=</font>trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF00FF">86</font><font color="#808080">, </font><font color="#FF00FF">17</font><font color="#808080">), </font>Both<font color="#808080">);
        </font>tCliente<font color="#808080">.</font>dtnascimento<font color="#808080">:=</font>trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF00FF">103</font><font color="#808080">, </font><font color="#FF00FF">10</font><font color="#808080">), </font>Both<font color="#808080">);
        </font>tCliente<font color="#808080">.</font>codendereco<font color="#808080">:=</font>trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF00FF">113</font><font color="#808080">, </font><font color="#FF00FF">10</font><font color="#808080">), </font>Both<font color="#808080">);
        </font>tCliente<font color="#808080">.</font>codpais<font color="#808080">:=</font>trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF00FF">123</font><font color="#808080">, </font><font color="#FF00FF">3</font><font color="#808080">), </font>Both<font color="#808080">);
        </font>tCliente<font color="#808080">.</font>codprofissao<font color="#808080">:=</font>trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF00FF">126</font><font color="#808080">, </font><font color="#FF00FF">10</font><font color="#808080">), </font>Both<font color="#808080">);
        </font>put_line<font color="#808080">(</font><font color="#008080">&quot;--------------------&quot;</font><font color="#808080">);
        </font>put_line<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF00FF">1</font><font color="#808080">) &amp; </font>tCliente<font color="#808080">.</font>cpf<font color="#808080">);
        </font>put_line<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF00FF">2</font><font color="#808080">) &amp; </font>tCliente<font color="#808080">.</font>nome<font color="#808080">);
        </font>put_line<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF00FF">3</font><font color="#808080">) &amp; </font>tCliente<font color="#808080">.</font>email<font color="#808080">);
        </font>put_line<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF00FF">4</font><font color="#808080">) &amp; </font>tCliente<font color="#808080">.</font>identidade<font color="#808080">);
        </font>put_line<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF00FF">5</font><font color="#808080">) &amp; </font>tCliente<font color="#808080">.</font>sexo<font color="#808080">);
        </font>put_line<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF00FF">6</font><font color="#808080">) &amp; </font>tCliente<font color="#808080">.</font>telefone<font color="#808080">);
        </font>put_line<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF00FF">7</font><font color="#808080">) &amp; </font>tCliente<font color="#808080">.</font>dtnascimento<font color="#808080">);
        </font>put_line<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF00FF">8</font><font color="#808080">) &amp; </font>tCliente<font color="#808080">.</font>codendereco<font color="#808080">);
        </font>mostrarSubDados<font color="#808080">(</font>opCliente<font color="#808080">, </font>opEndereco<font color="#808080">, </font>true<font color="#808080">);
        </font>put_line<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF00FF">9</font><font color="#808080">) &amp; </font>tCliente<font color="#808080">.</font>codpais<font color="#808080">);
        </font>mostrarSubDados<font color="#808080">(</font>opCliente<font color="#808080">, </font>opPais<font color="#808080">, </font>true<font color="#808080">);
        </font>put_line<font color="#808080">(</font>rotulo<font color="#808080">(</font>sreg<font color="#808080">, </font><font color="#FF00FF">10</font><font color="#808080">) &amp; </font>tCliente<font color="#808080">.</font>codprofissao<font color="#808080">);
        </font>mostrarSubDados<font color="#808080">(</font>opCliente<font color="#808080">, </font>opProfissao<font color="#808080">, </font>true<font color="#808080">);
    </font><font color="#0000FF">when others </font><font color="#808080">=&gt; </font><font color="#0000FF">null</font><font color="#808080">;
   </font><font color="#0000FF">end case</font><font color="#808080">;
</font><font color="#0000FF">elsif </font>sreg<font color="#808080">=</font>opVenda <font color="#0000FF">then
   case </font>nOpcao <font color="#0000FF">is
    when </font><font color="#FF00FF">1 </font><font color="#808080">=&gt; </font>mostrarSubDados<font color="#808080">(</font>opVenda<font color="#808080">,</font>opVenda<font color="#808080">, </font>false<font color="#808080">);
    </font><font color="#0000FF">when </font><font color="#FF00FF">2 </font><font color="#808080">=&gt;
        </font>put_line<font color="#808080">(</font><font color="#008080">&quot;DataHoraVenda       CPF            ISBN          &quot; </font><font color="#808080">&amp;
        </font><font color="#008080">&quot;Pre&ccedil;oVenda&quot;</font><font color="#808080">);
        </font>put_line<font color="#808080">(</font><font color="#008080">&quot;-------------       ---            ----          &quot; </font><font color="#808080">&amp;
        </font><font color="#008080">&quot;----------&quot;</font><font color="#808080">);
    </font><font color="#0000FF">when </font><font color="#FF00FF">3 </font><font color="#808080">=&gt;
        </font>tVenda<font color="#808080">.</font>dthrvenda<font color="#808080">:=</font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF00FF">1</font><font color="#808080">, </font><font color="#FF00FF">19</font><font color="#808080">);
        </font>tVenda<font color="#808080">.</font>cpf<font color="#808080">:=</font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF00FF">20</font><font color="#808080">, </font><font color="#FF00FF">14</font><font color="#808080">);
        </font>tVenda<font color="#808080">.</font>isbn<font color="#808080">:=</font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF00FF">34</font><font color="#808080">, </font><font color="#FF00FF">13</font><font color="#808080">);
        </font>tVenda<font color="#808080">.</font>precovenda<font color="#808080">:=</font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font><font color="#FF00FF">47</font><font color="#808080">, </font><font color="#FF00FF">10</font><font color="#808080">);
        </font>put_line<font color="#808080">(</font>tVenda<font color="#808080">.</font>dthrvenda <font color="#808080">&amp; </font><font color="#008080">&quot; &quot; </font><font color="#808080">&amp; </font>tVenda<font color="#808080">.</font>cpf <font color="#808080">&amp; </font><font color="#008080">&quot; &quot; </font><font color="#808080">&amp; 
        </font>tVenda<font color="#808080">.</font>isbn <font color="#808080">&amp; </font><font color="#008080">&quot; &quot; </font><font color="#808080">&amp; </font>tVenda<font color="#808080">.</font>precovenda<font color="#808080">);
    </font><font color="#0000FF">when others </font><font color="#808080">=&gt; </font><font color="#0000FF">null</font><font color="#808080">;
   </font><font color="#0000FF">end case</font><font color="#808080">;
</font><font color="#0000FF">end if</font><font color="#808080">;

</font><font color="#0000FF">end </font>mostrarDados<font color="#808080">;
</font><font color="#FF0000">-- ----------------------------------------------------------------------------
-- Mostra as sub inform&ccedil;&otilde;es de entrada e de sa&iacute;da.
-- sreg - o tipo de arquivo
-- ssubreg - o subtipo de arquivo
-- bSoMostrar - se vai s&oacute; mostrar na sa&iacute;da 
-- ----------------------------------------------------------------------------
</font><font color="#0000FF">procedure </font>mostrarSubDados<font color="#808080">(</font>sreg<font color="#808080">, </font>ssubreg<font color="#808080">: </font><font color="#0000FF">in </font>ctArqs<font color="#808080">; </font>bSoMostrar<font color="#808080">: </font><font color="#0000FF">in </font>boolean<font color="#808080">) </font><font color="#0000FF">is
</font>sRegistro<font color="#808080">, </font>sPreco<font color="#808080">: </font>ustring<font color="#808080">;
</font>nMaxTentativas<font color="#808080">: </font>integer<font color="#808080">;
</font><font color="#0000FF">begin
</font>nMaxTentativas<font color="#808080">:=</font><font color="#FF00FF">3</font><font color="#808080">;
</font><font color="#0000FF">if </font>sreg<font color="#808080">=</font>opLivro <font color="#0000FF">then
  if </font>ssubreg<font color="#808080">=</font>opEditora <font color="#0000FF">then
    if </font>bSoMostrar <font color="#0000FF">then
       </font>sRegistro<font color="#808080">:=</font>pesqArq<font color="#808080">(</font>taEditora<font color="#808080">,</font>tLivro<font color="#808080">.</font>codeditora<font color="#808080">,</font><font color="#FF00FF">1</font><font color="#808080">,</font><font color="#FF00FF">10</font><font color="#808080">,</font>tamReg<font color="#808080">(</font>opEditora<font color="#808080">));
    </font><font color="#0000FF">else
       </font>sRegistro<font color="#808080">:=</font>validaEntrada<font color="#808080">(</font>taEditora<font color="#808080">,</font>ssubreg<font color="#808080">,</font><font color="#FF00FF">1</font><font color="#808080">,</font>tLivro<font color="#808080">.</font>codeditora<font color="#808080">,
                  </font>nMaxTentativas<font color="#808080">,</font>false<font color="#808080">,</font>opNumero<font color="#808080">);
    </font><font color="#0000FF">end if</font><font color="#808080">;
    </font><font color="#0000FF">if </font>sRegistro<font color="#808080">/=</font>U<font color="#808080">(</font><font color="#008080">&quot;&quot;</font><font color="#808080">) </font><font color="#0000FF">then
      </font>tLivro<font color="#808080">.</font>codeditora<font color="#808080">:=</font>trim<font color="#808080">(</font>copy<font color="#808080">(</font>sRegistro<font color="#808080">,</font><font color="#FF00FF">1</font><font color="#808080">,</font><font color="#FF00FF">10</font><font color="#808080">), </font>Both<font color="#808080">);
      </font>put<font color="#808080">(</font><font color="#008080">&quot; &quot; </font><font color="#808080">&amp; </font>rotulo<font color="#808080">(</font>opEditora<font color="#808080">, </font><font color="#FF00FF">2</font><font color="#808080">));
      </font>put_line<font color="#808080">(</font>copy<font color="#808080">(</font>sRegistro<font color="#808080">, </font>g_nPosChave<font color="#808080">, </font>g_nTamChave<font color="#808080">));
    </font><font color="#0000FF">end if</font><font color="#808080">;
  </font><font color="#0000FF">elsif </font>ssubreg<font color="#808080">=</font>opIdioma <font color="#0000FF">then
    if </font>bSoMostrar <font color="#0000FF">then
       </font>sRegistro<font color="#808080">:=</font>pesqArq<font color="#808080">(</font>taIdioma<font color="#808080">, </font>tLivro<font color="#808080">.</font>codidioma<font color="#808080">, </font><font color="#FF00FF">1</font><font color="#808080">, </font><font color="#FF00FF">10</font><font color="#808080">,</font>tamReg<font color="#808080">(</font>opIdioma<font color="#808080">));
    </font><font color="#0000FF">else
       </font>sRegistro<font color="#808080">:=</font>validaEntrada<font color="#808080">(</font>taIdioma<font color="#808080">,</font>ssubreg<font color="#808080">,</font><font color="#FF00FF">1</font><font color="#808080">,</font>tLivro<font color="#808080">.</font>codidioma<font color="#808080">,
                  </font>nMaxTentativas<font color="#808080">,</font>false<font color="#808080">,</font>opNumero<font color="#808080">);
    </font><font color="#0000FF">end if</font><font color="#808080">;
    </font><font color="#0000FF">if </font>sRegistro<font color="#808080">/=</font>U<font color="#808080">(</font><font color="#008080">&quot;&quot;</font><font color="#808080">) </font><font color="#0000FF">then
      </font>tLivro<font color="#808080">.</font>codidioma<font color="#808080">:=</font>trim<font color="#808080">(</font>copy<font color="#808080">(</font>sRegistro<font color="#808080">,</font><font color="#FF00FF">1</font><font color="#808080">,</font><font color="#FF00FF">10</font><font color="#808080">), </font>Both<font color="#808080">);
      </font>put<font color="#808080">(</font><font color="#008080">&quot; &quot; </font><font color="#808080">&amp; </font>rotulo<font color="#808080">(</font>opIdioma<font color="#808080">, </font><font color="#FF00FF">2</font><font color="#808080">));
      </font>put_line<font color="#808080">(</font>copy<font color="#808080">(</font>sRegistro<font color="#808080">, </font>g_nPosChave<font color="#808080">, </font>g_nTamChave<font color="#808080">));
    </font><font color="#0000FF">end if</font><font color="#808080">;
  </font><font color="#0000FF">end if</font><font color="#808080">;
</font><font color="#0000FF">elsif </font>sreg<font color="#808080">=</font>opCliente <font color="#0000FF">then
  if </font>ssubreg<font color="#808080">=</font>opEndereco <font color="#0000FF">then
    if </font>bSoMostrar <font color="#0000FF">then
       </font>sRegistro<font color="#808080">:=</font>pesqArq<font color="#808080">(</font>taEndereco<font color="#808080">, </font>tCliente<font color="#808080">.</font>codendereco<font color="#808080">, </font><font color="#FF00FF">1</font><font color="#808080">, </font><font color="#FF00FF">10</font><font color="#808080">,
                  </font>tamReg<font color="#808080">(</font>opEndereco<font color="#808080">));
    </font><font color="#0000FF">else
       </font>sRegistro<font color="#808080">:=</font>validaEntrada<font color="#808080">(</font>taEndereco<font color="#808080">,</font>ssubreg<font color="#808080">,</font><font color="#FF00FF">1</font><font color="#808080">,</font>tCliente<font color="#808080">.</font>codendereco<font color="#808080">,
                  </font>nMaxTentativas<font color="#808080">,</font>false<font color="#808080">,</font>opNumero<font color="#808080">);
    </font><font color="#0000FF">end if</font><font color="#808080">;
    </font><font color="#0000FF">if </font>sRegistro<font color="#808080">/=</font>U<font color="#808080">(</font><font color="#008080">&quot;&quot;</font><font color="#808080">) </font><font color="#0000FF">then
      </font>tCliente<font color="#808080">.</font>codendereco<font color="#808080">:=</font>trim<font color="#808080">(</font>copy<font color="#808080">(</font>sRegistro<font color="#808080">,</font><font color="#FF00FF">1</font><font color="#808080">,</font><font color="#FF00FF">10</font><font color="#808080">), </font>Both<font color="#808080">);
      </font>put<font color="#808080">(</font><font color="#008080">&quot; &quot; </font><font color="#808080">&amp; </font>rotulo<font color="#808080">(</font>opEndereco<font color="#808080">, </font><font color="#FF00FF">2</font><font color="#808080">));
      </font>put_line<font color="#808080">(</font>copy<font color="#808080">(</font>sRegistro<font color="#808080">, </font>g_nPosChave<font color="#808080">, </font>g_nTamChave<font color="#808080">));
      </font>put<font color="#808080">(</font><font color="#008080">&quot; &quot; </font><font color="#808080">&amp; </font>rotulo<font color="#808080">(</font>opEndereco<font color="#808080">, </font><font color="#FF00FF">3</font><font color="#808080">));
      </font>put_line<font color="#808080">(</font>copy<font color="#808080">(</font>sRegistro<font color="#808080">, </font>g_nPosChave<font color="#808080">, </font>g_nTamChave<font color="#808080">));
      </font>put<font color="#808080">(</font><font color="#008080">&quot; &quot; </font><font color="#808080">&amp; </font>rotulo<font color="#808080">(</font>opEndereco<font color="#808080">, </font><font color="#FF00FF">4</font><font color="#808080">));
      </font>put_line<font color="#808080">(</font>copy<font color="#808080">(</font>sRegistro<font color="#808080">, </font>g_nPosChave<font color="#808080">, </font>g_nTamChave<font color="#808080">));
      </font>put<font color="#808080">(</font><font color="#008080">&quot; &quot; </font><font color="#808080">&amp; </font>rotulo<font color="#808080">(</font>opEndereco<font color="#808080">, </font><font color="#FF00FF">5</font><font color="#808080">));
      </font>put_line<font color="#808080">(</font>copy<font color="#808080">(</font>sRegistro<font color="#808080">, </font>g_nPosChave<font color="#808080">, </font>g_nTamChave<font color="#808080">));
      </font>put<font color="#808080">(</font><font color="#008080">&quot; &quot; </font><font color="#808080">&amp; </font>rotulo<font color="#808080">(</font>opEndereco<font color="#808080">, </font><font color="#FF00FF">6</font><font color="#808080">));
      </font>put_line<font color="#808080">(</font>copy<font color="#808080">(</font>sRegistro<font color="#808080">, </font>g_nPosChave<font color="#808080">, </font>g_nTamChave<font color="#808080">));
    </font><font color="#0000FF">end if</font><font color="#808080">;
  </font><font color="#0000FF">elsif </font>ssubreg<font color="#808080">=</font>opPais <font color="#0000FF">then
    if </font>bSoMostrar <font color="#0000FF">then
       </font>sRegistro<font color="#808080">:=</font>pesqArq<font color="#808080">(</font>taPais<font color="#808080">, </font>tCliente<font color="#808080">.</font>codpais<font color="#808080">, </font><font color="#FF00FF">1</font><font color="#808080">, </font><font color="#FF00FF">3</font><font color="#808080">, </font>tamReg<font color="#808080">(</font>opPais<font color="#808080">));
    </font><font color="#0000FF">else
       </font>sRegistro<font color="#808080">:=</font>validaEntrada<font color="#808080">(</font>taPais<font color="#808080">,</font>ssubreg<font color="#808080">,</font><font color="#FF00FF">1</font><font color="#808080">,</font>tCliente<font color="#808080">.</font>codpais<font color="#808080">,
                  </font>nMaxTentativas<font color="#808080">,</font>false<font color="#808080">,</font>opTexto<font color="#808080">);
    </font><font color="#0000FF">end if</font><font color="#808080">;
    </font><font color="#0000FF">if </font>sRegistro<font color="#808080">/=</font>U<font color="#808080">(</font><font color="#008080">&quot;&quot;</font><font color="#808080">) </font><font color="#0000FF">then
      </font>tCliente<font color="#808080">.</font>codpais<font color="#808080">:=</font>trim<font color="#808080">(</font>copy<font color="#808080">(</font>sRegistro<font color="#808080">,</font><font color="#FF00FF">1</font><font color="#808080">,</font><font color="#FF00FF">3</font><font color="#808080">), </font>Both<font color="#808080">);
      </font>put<font color="#808080">(</font><font color="#008080">&quot; &quot; </font><font color="#808080">&amp; </font>rotulo<font color="#808080">(</font>opPais<font color="#808080">, </font><font color="#FF00FF">2</font><font color="#808080">));
      </font>put_line<font color="#808080">(</font>copy<font color="#808080">(</font>sRegistro<font color="#808080">, </font>g_nPosChave<font color="#808080">, </font>g_nTamChave<font color="#808080">));
    </font><font color="#0000FF">end if</font><font color="#808080">;
  </font><font color="#0000FF">elsif </font>ssubreg<font color="#808080">=</font>opProfissao <font color="#0000FF">then
    if </font>bSoMostrar <font color="#0000FF">then
       </font>sRegistro<font color="#808080">:=</font>pesqArq<font color="#808080">(</font>taProfissao<font color="#808080">, </font>tCliente<font color="#808080">.</font>codprofissao<font color="#808080">, </font><font color="#FF00FF">1</font><font color="#808080">, </font><font color="#FF00FF">10</font><font color="#808080">,
                  </font>tamReg<font color="#808080">(</font>opProfissao<font color="#808080">));
    </font><font color="#0000FF">else
       </font>sRegistro<font color="#808080">:=</font>validaEntrada<font color="#808080">(</font>taProfissao<font color="#808080">,</font>ssubreg<font color="#808080">,</font><font color="#FF00FF">1</font><font color="#808080">,</font>tCliente<font color="#808080">.</font>codprofissao<font color="#808080">,
                  </font>nMaxTentativas<font color="#808080">,</font>false<font color="#808080">,</font>opNumero<font color="#808080">);
    </font><font color="#0000FF">end if</font><font color="#808080">;
    </font><font color="#0000FF">if </font>sRegistro<font color="#808080">/=</font>U<font color="#808080">(</font><font color="#008080">&quot;&quot;</font><font color="#808080">) </font><font color="#0000FF">then
      </font>tCliente<font color="#808080">.</font>codprofissao<font color="#808080">:=</font>trim<font color="#808080">(</font>copy<font color="#808080">(</font>sRegistro<font color="#808080">,</font><font color="#FF00FF">1</font><font color="#808080">,</font><font color="#FF00FF">10</font><font color="#808080">), </font>Both<font color="#808080">);
      </font>put<font color="#808080">(</font><font color="#008080">&quot; &quot; </font><font color="#808080">&amp; </font>rotulo<font color="#808080">(</font>opProfissao<font color="#808080">, </font><font color="#FF00FF">2</font><font color="#808080">));
      </font>put_line<font color="#808080">(</font>copy<font color="#808080">(</font>sRegistro<font color="#808080">, </font>g_nPosChave<font color="#808080">, </font>g_nTamChave<font color="#808080">));
    </font><font color="#0000FF">end if</font><font color="#808080">;
  </font><font color="#0000FF">end if</font><font color="#808080">;
</font><font color="#0000FF">elsif </font>sreg<font color="#808080">=</font>opVenda <font color="#0000FF">then
  </font>sRegistro<font color="#808080">:=</font>pesqArq<font color="#808080">(</font>taLivro<font color="#808080">, </font>tVenda<font color="#808080">.</font>isbn<font color="#808080">, </font><font color="#FF00FF">1</font><font color="#808080">, </font><font color="#FF00FF">13</font><font color="#808080">, </font>tamReg<font color="#808080">(</font>opLivro<font color="#808080">));
  </font><font color="#0000FF">if </font>sRegistro<font color="#808080">/=</font>U<font color="#808080">(</font><font color="#008080">&quot;&quot;</font><font color="#808080">) </font><font color="#0000FF">then
    </font>put<font color="#808080">(</font><font color="#008080">&quot; &quot; </font><font color="#808080">&amp; </font>rotulo<font color="#808080">(</font>opLivro<font color="#808080">, </font><font color="#FF00FF">2</font><font color="#808080">)); </font><font color="#FF0000">-- Titulo -- 
    </font>put_line<font color="#808080">(</font>copy<font color="#808080">(</font>sRegistro<font color="#808080">, </font>g_nPosChave<font color="#808080">, </font>g_nTamChave<font color="#808080">));
    </font>put<font color="#808080">(</font><font color="#008080">&quot; &quot; </font><font color="#808080">&amp; </font>rotulo<font color="#808080">(</font>opLivro<font color="#808080">, </font><font color="#FF00FF">9</font><font color="#808080">)); </font><font color="#FF0000">-- Preco --
    </font>sPreco<font color="#808080">:=</font>copy<font color="#808080">(</font>sRegistro<font color="#808080">, </font>g_nPosChave<font color="#808080">, </font>g_nTamChave<font color="#808080">);
    </font>g_nPreco<font color="#808080">:=</font>float<font color="#808080">(</font>Value_Real<font color="#808080">(</font>S<font color="#808080">(</font>sPreco<font color="#808080">)));
    </font>put_line<font color="#808080">(</font>sPreco<font color="#808080">);
  </font><font color="#0000FF">end if</font><font color="#808080">;
</font><font color="#0000FF">end if</font><font color="#808080">;
</font><font color="#0000FF">end </font>mostrarSubDados<font color="#808080">;
</font><font color="#FF0000">-- ----------------------------------------------------------------------------
-- Realiza os cadastros dos arquivos que se ligam a outros arquivos.
-- sreg - o tipo de arquivo
-- sacao - a a&ccedil;&atilde;o a ser realizada
-- sCodigo - um das chaves do arquivo de liga&ccedil;&atilde;o
-- ----------------------------------------------------------------------------
</font><font color="#0000FF">procedure </font>frmCadLigados<font color="#808080">(</font>sreg<font color="#808080">: </font><font color="#0000FF">in </font>ctArqs<font color="#808080">; </font>sacao<font color="#808080">: </font><font color="#0000FF">in </font>ctAcao<font color="#808080">; </font>sCodigo<font color="#808080">: </font><font color="#0000FF">in </font>ustring<font color="#808080">) </font><font color="#0000FF">is
</font>nQtd<font color="#808080">, </font>nCont<font color="#808080">, </font>nQtdEstoque<font color="#808080">: </font>integer<font color="#808080">;
</font>nTotalPreco<font color="#808080">: </font>float<font color="#808080">;
</font>slinha<font color="#808080">, </font>sTotalPreco<font color="#808080">, </font>sPreco<font color="#808080">, </font>sQtd<font color="#808080">: </font>ustring<font color="#808080">;
</font><font color="#0000FF">begin
if </font>sacao<font color="#808080">=</font>opNovo <font color="#0000FF">then
  </font>nCont<font color="#808080">:=</font><font color="#FF00FF">1</font><font color="#808080">;
  </font><font color="#0000FF">if </font>sreg<font color="#808080">=</font>opLivroAss <font color="#0000FF">then
    </font>sQtd<font color="#808080">:=</font>validaNumero<font color="#808080">(</font>U<font color="#808080">(</font><font color="#008080">&quot;Quantos assuntos quer cadastrar?: &quot;</font><font color="#808080">), </font>sQtd<font color="#808080">);
    </font>nQtd<font color="#808080">:=</font>Value_Integer<font color="#808080">(</font>S<font color="#808080">(</font>sQtd<font color="#808080">));
    </font>seekArq<font color="#808080">(</font>taLivroAss<font color="#808080">, </font><font color="#FF00FF">1</font><font color="#808080">);
    </font><font color="#0000FF">while </font>nCont <font color="#808080">&lt;= </font>nQtd <font color="#0000FF">loop
      </font>tLivroAss<font color="#808080">.</font>isbn<font color="#808080">:=</font>sCodigo<font color="#808080">;
      </font>put<font color="#808080">(</font>rotulo<font color="#808080">(</font>opLivroAss<font color="#808080">, </font><font color="#FF00FF">2</font><font color="#808080">));
      </font>get_line<font color="#808080">(</font>tLivroAss<font color="#808080">.</font>codassunto<font color="#808080">);
      </font>slinha<font color="#808080">:=</font>pesqArq<font color="#808080">(</font>taAssunto<font color="#808080">, </font>tLivroAss<font color="#808080">.</font>codassunto<font color="#808080">,</font><font color="#FF00FF">1</font><font color="#808080">,</font><font color="#FF00FF">10</font><font color="#808080">,</font>tamReg<font color="#808080">(</font>opAssunto<font color="#808080">));
      </font>put<font color="#808080">(</font><font color="#008080">&quot; &quot; </font><font color="#808080">&amp; </font>rotulo<font color="#808080">(</font>opAssunto<font color="#808080">, </font><font color="#FF00FF">2</font><font color="#808080">));
      </font>put_line<font color="#808080">(</font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font>g_nPosChave<font color="#808080">, </font>g_nTamChave<font color="#808080">));
      </font>pesqLinhaExcluida<font color="#808080">(</font>taLivroAss<font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">));
      </font>subMenu<font color="#808080">(</font><font color="#FF00FF">14</font><font color="#808080">, </font>sreg<font color="#808080">);
      </font>nCont<font color="#808080">:=</font>nCont<font color="#808080">+</font><font color="#FF00FF">1</font><font color="#808080">;
    </font><font color="#0000FF">end loop</font><font color="#808080">;
  </font><font color="#0000FF">elsif </font>sreg<font color="#808080">=</font>opLivroAut <font color="#0000FF">then
    </font>sQtd<font color="#808080">:=</font>validaNumero<font color="#808080">(</font>U<font color="#808080">(</font><font color="#008080">&quot;Quantos autores quer cadastrar?: &quot;</font><font color="#808080">),</font>sQtd<font color="#808080">);
    </font>nQtd<font color="#808080">:=</font>Value_Integer<font color="#808080">(</font>S<font color="#808080">(</font>sQtd<font color="#808080">));
    </font>seekArq<font color="#808080">(</font>taLivroAut<font color="#808080">, </font><font color="#FF00FF">1</font><font color="#808080">);
    </font><font color="#0000FF">while </font>nCont <font color="#808080">&lt;= </font>nQtd <font color="#0000FF">loop
      </font>tLivroAut<font color="#808080">.</font>isbn<font color="#808080">:=</font>sCodigo<font color="#808080">;
      </font>put<font color="#808080">(</font>rotulo<font color="#808080">(</font>opLivroAut<font color="#808080">, </font><font color="#FF00FF">2</font><font color="#808080">));
      </font>get_line<font color="#808080">(</font>tLivroAut<font color="#808080">.</font>codautor<font color="#808080">);
      </font>slinha<font color="#808080">:=</font>pesqArq<font color="#808080">(</font>taAutor<font color="#808080">, </font>tLivroAut<font color="#808080">.</font>codautor<font color="#808080">,</font><font color="#FF00FF">1</font><font color="#808080">,</font><font color="#FF00FF">10</font><font color="#808080">,</font>tamReg<font color="#808080">(</font>opAutor<font color="#808080">));
      </font>put<font color="#808080">(</font><font color="#008080">&quot; &quot; </font><font color="#808080">&amp; </font>rotulo<font color="#808080">(</font>opAutor<font color="#808080">, </font><font color="#FF00FF">2</font><font color="#808080">));
      </font>put_line<font color="#808080">(</font>copy<font color="#808080">(</font>slinha<font color="#808080">, </font>g_nPosChave<font color="#808080">, </font>g_nTamChave<font color="#808080">));
      </font>pesqLinhaExcluida<font color="#808080">(</font>taLivroAut<font color="#808080">, </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">));
      </font>subMenu<font color="#808080">(</font><font color="#FF00FF">14</font><font color="#808080">, </font>sreg<font color="#808080">);
      </font>nCont<font color="#808080">:=</font>nCont<font color="#808080">+</font><font color="#FF00FF">1</font><font color="#808080">;
    </font><font color="#0000FF">end loop</font><font color="#808080">;
  </font><font color="#0000FF">elsif </font>sreg<font color="#808080">=</font>opVenda <font color="#0000FF">then
    </font>sQtd<font color="#808080">:=</font>validaNumero<font color="#808080">(</font>U<font color="#808080">(</font><font color="#008080">&quot;Quantos livros quer vender?: &quot;</font><font color="#808080">),</font>sQtd<font color="#808080">);
    </font>nQtd<font color="#808080">:=</font>Value_Integer<font color="#808080">(</font>S<font color="#808080">(</font>sQtd<font color="#808080">));
    </font>nTotalPreco<font color="#808080">:=</font><font color="#FF00FF">0</font><font color="#808080">.</font><font color="#FF00FF">0</font><font color="#808080">;
    </font><font color="#0000FF">while </font>nCont <font color="#808080">&lt;= </font>nQtd <font color="#0000FF">loop
      </font>slinha<font color="#808080">:=</font>validaEntrada<font color="#808080">(</font>taLivro<font color="#808080">,</font>opLivro<font color="#808080">,</font><font color="#FF00FF">1</font><font color="#808080">,</font>tVenda<font color="#808080">.</font>isbn<font color="#808080">,</font><font color="#FF00FF">3</font><font color="#808080">,</font>false<font color="#808080">,</font>opTexto<font color="#808080">);
      </font><font color="#0000FF">if </font>slinha<font color="#808080">/=</font>U<font color="#808080">(</font><font color="#008080">&quot;&quot;</font><font color="#808080">) </font><font color="#0000FF">then
        </font>tVenda<font color="#808080">.</font>isbn<font color="#808080">:=</font>trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha<font color="#808080">,</font><font color="#FF00FF">1</font><font color="#808080">,</font><font color="#FF00FF">13</font><font color="#808080">), </font>Both<font color="#808080">);
        </font><font color="#0000FF">if </font>validaISBN<font color="#808080">(</font>tVenda<font color="#808080">.</font>isbn<font color="#808080">) </font><font color="#0000FF">then
          </font>mostrarDados<font color="#808080">(</font>sreg<font color="#808080">, </font>U<font color="#808080">(</font><font color="#008080">&quot;&quot;</font><font color="#808080">), </font><font color="#FF00FF">1</font><font color="#808080">);
          </font>tLivro<font color="#808080">.</font>qtdestoque<font color="#808080">:=</font>trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha<font color="#808080">,</font><font color="#FF00FF">134</font><font color="#808080">,</font><font color="#FF00FF">10</font><font color="#808080">), </font>Both<font color="#808080">);
          </font>nQtdEstoque<font color="#808080">:=</font>Value_Integer<font color="#808080">(</font>S<font color="#808080">(</font>tLivro<font color="#808080">.</font>qtdestoque<font color="#808080">));
          </font><font color="#0000FF">if </font>nQtdEstoque <font color="#808080">&gt; </font><font color="#FF00FF">0 </font><font color="#0000FF">then
             </font>nTotalPreco<font color="#808080">:=</font>nTotalPreco <font color="#808080">+ </font>g_nPreco<font color="#808080">;
             </font><font color="#FF0000">-- sPreco:=floattostr(g_nPreco);
             </font>tVenda<font color="#808080">.</font>precovenda<font color="#808080">:=</font>sPreco<font color="#808080">;
             </font>g_SalvarInclusao<font color="#808080">:=</font>false<font color="#808080">;
             </font>subMenu<font color="#808080">(</font><font color="#FF00FF">14</font><font color="#808080">, </font>sreg<font color="#808080">);
             </font><font color="#0000FF">if </font>g_SalvarInclusao <font color="#0000FF">then
                </font>slinha<font color="#808080">:=</font>pesqArq<font color="#808080">(</font>taLivro<font color="#808080">, </font>tVenda<font color="#808080">.</font>isbn<font color="#808080">, </font><font color="#FF00FF">1</font><font color="#808080">, </font><font color="#FF00FF">13</font><font color="#808080">, </font>tamReg<font color="#808080">(</font>opLivro<font color="#808080">));
                </font><font color="#0000FF">if </font>slinha<font color="#808080">/=</font>U<font color="#808080">(</font><font color="#008080">&quot;&quot;</font><font color="#808080">) </font><font color="#0000FF">then
                   </font>nQtdEstoque<font color="#808080">:=</font>nQtdEstoque<font color="#808080">-</font><font color="#FF00FF">1</font><font color="#808080">;
                   </font>itostr<font color="#808080">(</font>nQtdEstoque<font color="#808080">, </font>tLivro<font color="#808080">.</font>qtdestoque<font color="#808080">);
                   </font>slinha<font color="#808080">:=</font>copy<font color="#808080">(</font>slinha<font color="#808080">,</font><font color="#FF00FF">1</font><font color="#808080">,</font><font color="#FF00FF">133</font><font color="#808080">) &amp; </font>esp<font color="#808080">(</font>tLivro<font color="#808080">.</font>qtdestoque<font color="#808080">,</font><font color="#FF00FF">10</font><font color="#808080">);
                   </font>escreveArq<font color="#808080">(</font>taLivro<font color="#808080">, </font>slinha<font color="#808080">, </font><font color="#008080">&quot;&quot;</font><font color="#808080">, </font><font color="#008080">&quot;&quot;</font><font color="#808080">);
                </font><font color="#0000FF">end if</font><font color="#808080">;
             </font><font color="#0000FF">end if</font><font color="#808080">;
             </font>nCont<font color="#808080">:=</font>nCont<font color="#808080">+</font><font color="#FF00FF">1</font><font color="#808080">;
          </font><font color="#0000FF">else </font>put_line<font color="#808080">(</font>MSG_SEMESTOQUE<font color="#808080">);
          </font><font color="#0000FF">end if</font><font color="#808080">;
        </font><font color="#0000FF">else </font>put_line<font color="#808080">(</font>MSG_ISBNINV<font color="#808080">);
        </font><font color="#0000FF">end if</font><font color="#808080">;
      </font><font color="#0000FF">end if</font><font color="#808080">;
    </font><font color="#0000FF">end loop</font><font color="#808080">;
</font><font color="#FF0000">--    sTotalPreco:=floattostr(nTotalPreco);
    </font>put_line<font color="#808080">(</font><font color="#008080">&quot;Total de &quot; </font><font color="#808080">&amp; </font>rotulo<font color="#808080">(</font>sreg<font color="#808080">,</font><font color="#FF00FF">4</font><font color="#808080">) &amp; </font>sTotalPreco<font color="#808080">);
  </font><font color="#0000FF">end if</font><font color="#808080">;
</font><font color="#0000FF">elsif </font>sacao<font color="#808080">=</font>opExcluir <font color="#0000FF">then
  if </font>sreg<font color="#808080">=</font>opLivroAss <font color="#0000FF">then
     </font>ExcluirRegLigados<font color="#808080">(</font>taLivroAss<font color="#808080">, </font>sreg<font color="#808080">, </font><font color="#FF00FF">1</font><font color="#808080">, </font><font color="#FF00FF">13</font><font color="#808080">, </font>sCodigo<font color="#808080">);
  </font><font color="#0000FF">elsif </font>sreg<font color="#808080">=</font>opLivroAut <font color="#0000FF">then
     </font>ExcluirRegLigados<font color="#808080">(</font>taLivroAut<font color="#808080">, </font>sreg<font color="#808080">, </font><font color="#FF00FF">1</font><font color="#808080">, </font><font color="#FF00FF">13</font><font color="#808080">, </font>sCodigo<font color="#808080">);
  </font><font color="#0000FF">end if</font><font color="#808080">;
</font><font color="#0000FF">end if</font><font color="#808080">;

</font><font color="#0000FF">end </font>frmCadLigados<font color="#808080">;
</font><font color="#FF0000">-- ----------------------------------------------------------------------------
-- Realiza a exclus&atilde;o dos arquivos de liga&ccedil;&atilde;o.
-- sArq - o arquivo de liga&ccedil;&atilde;o
-- sreg - o tipo de arquivo de liga&ccedil;&atilde;o
-- nPosChave - a posicao inicial da chave dentro do registro
-- nTamChave - o tamanho da chave dentro do registro
-- sChave - a chave a ser excluida
-- ----------------------------------------------------------------------------
</font><font color="#0000FF">procedure </font>ExcluirRegLigados<font color="#808080">(</font>sArq<font color="#808080">: </font><font color="#0000FF">in </font>ctTArqs<font color="#808080">; </font>sreg<font color="#808080">: </font><font color="#0000FF">in </font>ctArqs<font color="#808080">; </font>nPosChave<font color="#808080">,
</font>nTamChave<font color="#808080">: </font><font color="#0000FF">in </font>integer<font color="#808080">; </font>sChave<font color="#808080">: </font><font color="#0000FF">in </font>ustring<font color="#808080">) </font><font color="#0000FF">is
</font>slinha<font color="#808080">: </font>ustring<font color="#808080">;
</font>sCodigo<font color="#808080">: </font>ustring<font color="#808080">;
</font><font color="#0000FF">begin
  </font>seekArq<font color="#808080">(</font>sArq<font color="#808080">, </font><font color="#FF00FF">1</font><font color="#808080">);
  </font><font color="#0000FF">while </font><font color="#808080">(</font>not fimArq<font color="#808080">(</font>sArq<font color="#808080">)) </font><font color="#0000FF">loop
    </font>slinha<font color="#808080">:=</font>lerArq<font color="#808080">(</font>sArq<font color="#808080">);
    </font>sCodigo<font color="#808080">:=</font>trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha<font color="#808080">,</font>nPosChave<font color="#808080">,</font>nTamChave<font color="#808080">), </font>Both<font color="#808080">);
    </font><font color="#0000FF">if </font>sCodigo<font color="#808080">=</font>sChave <font color="#0000FF">then
       </font>btnAcao<font color="#808080">(</font>sreg<font color="#808080">, </font>opConfirmaExclusao<font color="#808080">);
    </font><font color="#0000FF">end if</font><font color="#808080">;
  </font><font color="#0000FF">end loop</font><font color="#808080">;
</font><font color="#0000FF">end </font>ExcluirRegLigados<font color="#808080">;

</font><font color="#FF0000">-- ----------------------------------------------------------------------------
-- Parte inicial do c&oacute;digo
-- ----------------------------------------------------------------------------
</font><font color="#0000FF">begin
 if </font><font color="#808080">(</font>Argument_Count <font color="#808080">&gt; </font><font color="#FF00FF">0</font><font color="#808080">) </font><font color="#0000FF">then
    if </font><font color="#808080">(</font>Argument<font color="#808080">(</font><font color="#FF00FF">1</font><font color="#808080">)=</font><font color="#008080">&quot;-cria&quot;</font><font color="#808080">) </font><font color="#0000FF">then
      </font>abrecriaArqs<font color="#808080">(</font>false<font color="#808080">);
    </font><font color="#0000FF">end if</font><font color="#808080">;
 </font><font color="#0000FF">else
   </font>frmSplash<font color="#808080">;
   </font>abrecriaArqs<font color="#808080">(</font>true<font color="#808080">);
   </font><font color="#0000FF">if </font>frmLogin <font color="#0000FF">then
     </font>bopcao<font color="#808080">:=</font>true<font color="#808080">;
     </font><font color="#0000FF">while</font><font color="#808080">(</font>bopcao<font color="#808080">) </font><font color="#0000FF">loop
       </font>menu<font color="#808080">(</font><font color="#FF00FF">1</font><font color="#808080">);
       </font>get_line<font color="#808080">(</font>opmenu<font color="#808080">);
       </font><font color="#0000FF">if </font><font color="#808080">(</font>opmenu<font color="#808080">='</font>C<font color="#808080">') </font><font color="#0000FF">or </font><font color="#808080">(</font>opmenu<font color="#808080">='</font>c<font color="#808080">') </font><font color="#0000FF">then </font>usaMenu<font color="#808080">(</font><font color="#FF00FF">1</font><font color="#808080">);
       </font><font color="#0000FF">elsif </font><font color="#808080">(</font>opmenu<font color="#808080">='</font>P<font color="#808080">') </font><font color="#0000FF">or </font><font color="#808080">(</font>opmenu<font color="#808080">='</font>p<font color="#808080">') </font><font color="#0000FF">then </font>usaMenu<font color="#808080">(</font><font color="#FF00FF">2</font><font color="#808080">);
       </font><font color="#0000FF">elsif </font><font color="#808080">(</font>opmenu<font color="#808080">='</font>V<font color="#808080">') </font><font color="#0000FF">or </font><font color="#808080">(</font>opmenu<font color="#808080">='</font>v<font color="#808080">') </font><font color="#0000FF">then </font>usaMenu<font color="#808080">(</font><font color="#FF00FF">3</font><font color="#808080">);
       </font><font color="#0000FF">elsif </font><font color="#808080">(</font>opmenu<font color="#808080">='</font>O<font color="#808080">') </font><font color="#0000FF">or </font><font color="#808080">(</font>opmenu<font color="#808080">='</font>o<font color="#808080">') </font><font color="#0000FF">then </font>usaMenu<font color="#808080">(</font><font color="#FF00FF">4</font><font color="#808080">);
       </font><font color="#0000FF">else </font>Put_Line<font color="#808080">(</font>MSG_ERRO<font color="#808080">);
       </font><font color="#0000FF">end if</font><font color="#808080">;
     </font><font color="#0000FF">end loop</font><font color="#808080">;
   </font><font color="#0000FF">else
     </font>fechaArqs<font color="#808080">;
   </font><font color="#0000FF">end if</font><font color="#808080">;
 </font><font color="#0000FF">end if</font><font color="#808080">;

</font><font color="#0000FF">end </font>livrus<font color="#808080">;
</font></font>
</code></pre>
</body>
</html>