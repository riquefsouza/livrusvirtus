<html>
<head>
<title>Livrus Virtus - Console - Modula-2 - Implementação - FTS - Arquivos</title>
</head>
<!-- Generated by ConTEXT HTML exporter -->
<body text="#000000" bgcolor="#FFFFFF">
<pre>
<code><font  face="Courier New"><font color="#0000FF">IMPLEMENTATION MODULE </font>Arquivos<font color="#808080">;


</font><font color="#0000FF">FROM </font>SYSTEM <font color="#0000FF">IMPORT  WORD</font><font color="#808080">, </font>ADR<font color="#808080">, </font>ADDRESS<font color="#808080">;
</font><font color="#0000FF">FROM </font>ASCII <font color="#0000FF">IMPORT </font>nul<font color="#808080">, </font>cr<font color="#808080">, </font>lf<font color="#808080">;
</font><font color="#0000FF">FROM </font>Rotinas <font color="#0000FF">IMPORT </font>String<font color="#808080">, </font>WriteLinha<font color="#808080">, </font>trim<font color="#808080">, </font>copy<font color="#808080">, </font>esp<font color="#808080">, </font>stemp<font color="#808080">, </font>Ss<font color="#808080">,
     </font>SomaStr<font color="#808080">, </font>equal<font color="#808080">;
</font><font color="#0000FF">FROM </font>NumberConversion <font color="#0000FF">IMPORT </font>StringToCard<font color="#808080">, </font>CardToString<font color="#808080">;
</font><font color="#0000FF">FROM </font>Strings <font color="#0000FF">IMPORT </font>Length<font color="#808080">, </font>Append<font color="#808080">, </font>Copy<font color="#808080">, </font>CompareStr<font color="#808080">;
</font><font color="#0000FF">FROM </font>FileSystem <font color="#0000FF">IMPORT </font>File<font color="#808080">, </font>Lookup<font color="#808080">, </font>ReadNBytes<font color="#808080">, </font>SetPos<font color="#808080">, </font>WriteNBytes<font color="#808080">,
     </font>Response<font color="#808080">, </font>Close<font color="#808080">, </font>GetPos<font color="#808080">;
</font><font color="#0000FF">IMPORT </font>FileSystem<font color="#808080">; (* Length *)

(*------------------------------------------------------------------------------
</font>Calcula o tamanho do arquivo.
sArq <font color="#808080">- </font>o arquivo
retorna <font color="#808080">- </font>o tamanho do arquivo
<font color="#808080">------------------------------------------------------------------------------*)
</font><font color="#0000FF">PROCEDURE </font>tamArq<font color="#808080">(</font><font color="#0000FF">VAR </font>sArq<font color="#808080">: </font>File<font color="#808080">): </font><font color="#0000FF">CARDINAL</font><font color="#808080">;
</font><font color="#0000FF">VAR </font>nmaxtam<font color="#808080">, </font>nmintam<font color="#808080">: </font><font color="#0000FF">CARDINAL</font><font color="#808080">;
</font><font color="#0000FF">BEGIN
</font>FileSystem.Length<font color="#808080">(</font>sArq<font color="#808080">, </font>nmaxtam<font color="#808080">, </font>nmintam<font color="#808080">);
</font><font color="#0000FF">RETURN </font>nmaxtam<font color="#808080">;
</font><font color="#0000FF">END </font>tamArq<font color="#808080">;

(*------------------------------------------------------------------------------
</font>Verifica se chegou ao fim do arquivo.
sArq <font color="#808080">- </font>o arquivo
ntam <font color="#808080">- </font>o tamanho do arquivo
retorna <font color="#808080">- </font>se chegou ao fim do arquivo
<font color="#808080">------------------------------------------------------------------------------*)
</font><font color="#0000FF">PROCEDURE </font>fimArq<font color="#808080">(</font><font color="#0000FF">VAR </font>sArq<font color="#808080">: </font>File<font color="#808080">): </font><font color="#0000FF">BOOLEAN</font><font color="#808080">;
</font><font color="#0000FF">BEGIN
  RETURN </font>sArq.eof<font color="#808080">;
</font><font color="#0000FF">END </font>fimArq<font color="#808080">;

(*------------------------------------------------------------------------------
</font>L<font color="#808080">&ecirc; </font>uma linha do arquivo.
sArq <font color="#808080">- </font>o arquivo
nTamLinha <font color="#808080">- </font>o tamanho da linha
nTamCRLF <font color="#808080">- </font>o tamanho do retorno da linha
npos <font color="#808080">- </font>posicao dentro do arquivo
retorna <font color="#808080">- </font>o texto lido
<font color="#808080">------------------------------------------------------------------------------*)
</font><font color="#0000FF">PROCEDURE </font>lerArq<font color="#808080">(</font><font color="#0000FF">VAR </font>sArq<font color="#808080">: </font>File<font color="#808080">; </font>nTamLinha<font color="#808080">, </font>nTamCRLF<font color="#808080">: </font><font color="#0000FF">CARDINAL</font><font color="#808080">;
</font><font color="#0000FF">VAR </font>npos<font color="#808080">: </font><font color="#0000FF">CARDINAL</font><font color="#808080">): </font>String<font color="#808080">;
</font><font color="#0000FF">VAR </font>nLidos<font color="#808080">: </font><font color="#0000FF">CARDINAL</font><font color="#808080">;
    </font>slinha<font color="#808080">: </font>String<font color="#808080">;
</font><font color="#0000FF">BEGIN
</font>ReadNBytes<font color="#808080">(</font>sArq<font color="#808080">, </font>ADR<font color="#808080">(</font>slinha<font color="#808080">), </font>nTamLinha<font color="#808080">, </font>nLidos<font color="#808080">);
</font><font color="#0000FF">IF </font>nLidos <font color="#808080">&lt;&gt; </font>nTamLinha <font color="#0000FF">THEN
   </font>slinha<font color="#808080">:=</font><font color="#800000">''</font><font color="#808080">;
</font><font color="#0000FF">ELSE
  </font>slinha<font color="#808080">[</font>nTamLinha<font color="#808080">]:=</font>nul<font color="#808080">;
  </font>npos<font color="#808080">:=</font>npos <font color="#808080">+ (</font>nTamLinha <font color="#808080">+ </font>nTamCRLF<font color="#808080">);
  </font>SetPos<font color="#808080">(</font>tfAssunto<font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font>npos<font color="#808080">);
</font><font color="#0000FF">END</font><font color="#808080">;
</font><font color="#0000FF">RETURN </font>slinha<font color="#808080">;
</font><font color="#0000FF">END </font>lerArq<font color="#808080">;

(*------------------------------------------------------------------------------
</font>Grava uma linha no arquivo.
sArq <font color="#808080">- </font>o arquivo
nTamLinha <font color="#808080">- </font>o tamanho da linha
nTamCRLF <font color="#808080">- </font>o tamanho do retorno da linha
sLinha <font color="#808080">- </font>o texto a ser gravado
<font color="#808080">------------------------------------------------------------------------------*)
</font><font color="#0000FF">PROCEDURE </font>gravarArq<font color="#808080">(</font><font color="#0000FF">VAR </font>sArq<font color="#808080">: </font>File<font color="#808080">; </font>nTamLinha<font color="#808080">, </font>nTamCRLF<font color="#808080">: </font><font color="#0000FF">CARDINAL</font><font color="#808080">;
          </font>slinha<font color="#808080">: </font>String<font color="#808080">): </font><font color="#0000FF">CARDINAL</font><font color="#808080">;
</font><font color="#0000FF">VAR </font>ngravados<font color="#808080">: </font><font color="#0000FF">CARDINAL</font><font color="#808080">;
</font><font color="#0000FF">BEGIN
</font>WriteNBytes<font color="#808080">(</font>sArq<font color="#808080">, </font>ADR<font color="#808080">(</font>slinha<font color="#808080">), (</font>nTamLinha <font color="#808080">+ </font>nTamCRLF<font color="#808080">), </font>ngravados<font color="#808080">);
</font><font color="#0000FF">RETURN </font>ngravados<font color="#808080">;
</font><font color="#0000FF">END </font>gravarArq<font color="#808080">;

(*------------------------------------------------------------------------------
</font>Abre ou cria os arquivos do sistema.
bAbre <font color="#808080">- </font>condi<font color="#808080">&ccedil;&atilde;</font>o para abrir ou criar os arquivos do sistema
<font color="#808080">------------------------------------------------------------------------------*)
</font><font color="#0000FF">PROCEDURE </font>abrecriaArqs<font color="#808080">(</font>bAbre<font color="#808080">: </font><font color="#0000FF">BOOLEAN</font><font color="#808080">);
</font><font color="#0000FF">BEGIN
 IF </font>bAbre <font color="#0000FF">THEN 
   </font>Lookup<font color="#808080">(</font>tfAssunto<font color="#808080">, </font>ARQ_ASSUNTO<font color="#808080">, </font>FALSE<font color="#808080">);
   </font><font color="#0000FF">IF </font>tfAssunto.res<font color="#808080">=</font>notdone <font color="#0000FF">THEN
      </font>WriteLinha<font color="#808080">(</font>Ss<font color="#808080">(</font>Ss<font color="#808080">(</font>MSG_ARQERRO<font color="#808080">, </font><font color="#800000">' --&gt; '</font><font color="#808080">), </font>ARQ_ASSUNTO<font color="#808080">));
   </font><font color="#0000FF">END</font><font color="#808080">; 
   </font>Lookup<font color="#808080">(</font>tfAutor<font color="#808080">, </font>ARQ_AUTOR<font color="#808080">, </font>FALSE<font color="#808080">);
   </font><font color="#0000FF">IF </font>tfAutor.res<font color="#808080">=</font>notdone <font color="#0000FF">THEN
      </font>WriteLinha<font color="#808080">(</font>Ss<font color="#808080">(</font>Ss<font color="#808080">(</font>MSG_ARQERRO<font color="#808080">, </font><font color="#800000">' --&gt; '</font><font color="#808080">), </font>ARQ_AUTOR<font color="#808080">));
   </font><font color="#0000FF">END</font><font color="#808080">; 
   </font>Lookup<font color="#808080">(</font>tfEditora<font color="#808080">, </font>ARQ_EDITORA<font color="#808080">, </font>FALSE<font color="#808080">);
   </font><font color="#0000FF">IF </font>tfEditora.res<font color="#808080">=</font>notdone <font color="#0000FF">THEN
      </font>WriteLinha<font color="#808080">(</font>Ss<font color="#808080">(</font>Ss<font color="#808080">(</font>MSG_ARQERRO<font color="#808080">, </font><font color="#800000">' --&gt; '</font><font color="#808080">), </font>ARQ_EDITORA<font color="#808080">));
   </font><font color="#0000FF">END</font><font color="#808080">; 
   </font>Lookup<font color="#808080">(</font>tfIdioma<font color="#808080">, </font>ARQ_IDIOMA<font color="#808080">, </font>FALSE<font color="#808080">);
   </font><font color="#0000FF">IF </font>tfIdioma.res<font color="#808080">=</font>notdone <font color="#0000FF">THEN
      </font>WriteLinha<font color="#808080">(</font>Ss<font color="#808080">(</font>Ss<font color="#808080">(</font>MSG_ARQERRO<font color="#808080">, </font><font color="#800000">' --&gt; '</font><font color="#808080">), </font>ARQ_IDIOMA<font color="#808080">));
   </font><font color="#0000FF">END</font><font color="#808080">; 
   </font>Lookup<font color="#808080">(</font>tfEndereco<font color="#808080">, </font>ARQ_ENDERECO<font color="#808080">, </font>FALSE<font color="#808080">);
   </font><font color="#0000FF">IF </font>tfEndereco.res<font color="#808080">=</font>notdone <font color="#0000FF">THEN
      </font>WriteLinha<font color="#808080">(</font>Ss<font color="#808080">(</font>Ss<font color="#808080">(</font>MSG_ARQERRO<font color="#808080">, </font><font color="#800000">' --&gt; '</font><font color="#808080">), </font>ARQ_ENDERECO<font color="#808080">));
   </font><font color="#0000FF">END</font><font color="#808080">; 
   </font>Lookup<font color="#808080">(</font>tfPais<font color="#808080">, </font>ARQ_PAIS<font color="#808080">, </font>FALSE<font color="#808080">);
   </font><font color="#0000FF">IF </font>tfPais.res<font color="#808080">=</font>notdone <font color="#0000FF">THEN
      </font>WriteLinha<font color="#808080">(</font>Ss<font color="#808080">(</font>Ss<font color="#808080">(</font>MSG_ARQERRO<font color="#808080">, </font><font color="#800000">' --&gt; '</font><font color="#808080">), </font>ARQ_PAIS<font color="#808080">));
   </font><font color="#0000FF">END</font><font color="#808080">; 
   </font>Lookup<font color="#808080">(</font>tfProfissao<font color="#808080">, </font>ARQ_PROFISSAO<font color="#808080">, </font>FALSE<font color="#808080">);
   </font><font color="#0000FF">IF </font>tfProfissao.res<font color="#808080">=</font>notdone <font color="#0000FF">THEN
      </font>WriteLinha<font color="#808080">(</font>Ss<font color="#808080">(</font>Ss<font color="#808080">(</font>MSG_ARQERRO<font color="#808080">, </font><font color="#800000">' --&gt; '</font><font color="#808080">), </font>ARQ_PROFISSAO<font color="#808080">));
   </font><font color="#0000FF">END</font><font color="#808080">; 
   </font>Lookup<font color="#808080">(</font>tfLivro<font color="#808080">, </font>ARQ_LIVRO<font color="#808080">, </font>FALSE<font color="#808080">);
   </font><font color="#0000FF">IF </font>tfLivro.res<font color="#808080">=</font>notdone <font color="#0000FF">THEN
      </font>WriteLinha<font color="#808080">(</font>Ss<font color="#808080">(</font>Ss<font color="#808080">(</font>MSG_ARQERRO<font color="#808080">, </font><font color="#800000">' --&gt; '</font><font color="#808080">), </font>ARQ_LIVRO<font color="#808080">));
   </font><font color="#0000FF">END</font><font color="#808080">; 
   </font>Lookup<font color="#808080">(</font>tfLivroAss<font color="#808080">, </font>ARQ_LIVASS<font color="#808080">, </font>FALSE<font color="#808080">);
   </font><font color="#0000FF">IF </font>tfLivroAss.res<font color="#808080">=</font>notdone <font color="#0000FF">THEN
      </font>WriteLinha<font color="#808080">(</font>Ss<font color="#808080">(</font>Ss<font color="#808080">(</font>MSG_ARQERRO<font color="#808080">, </font><font color="#800000">' --&gt; '</font><font color="#808080">), </font>ARQ_LIVASS<font color="#808080">));
   </font><font color="#0000FF">END</font><font color="#808080">; 
   </font>Lookup<font color="#808080">(</font>tfLivroAut<font color="#808080">, </font>ARQ_LIVAUT<font color="#808080">, </font>FALSE<font color="#808080">);
   </font><font color="#0000FF">IF </font>tfLivroAut.res<font color="#808080">=</font>notdone <font color="#0000FF">THEN
      </font>WriteLinha<font color="#808080">(</font>Ss<font color="#808080">(</font>Ss<font color="#808080">(</font>MSG_ARQERRO<font color="#808080">, </font><font color="#800000">' --&gt; '</font><font color="#808080">), </font>ARQ_LIVAUT<font color="#808080">));
   </font><font color="#0000FF">END</font><font color="#808080">; 
   </font>Lookup<font color="#808080">(</font>tfCliente<font color="#808080">, </font>ARQ_CLIENTE<font color="#808080">, </font>FALSE<font color="#808080">);
   </font><font color="#0000FF">IF </font>tfCliente.res<font color="#808080">=</font>notdone <font color="#0000FF">THEN
      </font>WriteLinha<font color="#808080">(</font>Ss<font color="#808080">(</font>Ss<font color="#808080">(</font>MSG_ARQERRO<font color="#808080">, </font><font color="#800000">' --&gt; '</font><font color="#808080">), </font>ARQ_CLIENTE<font color="#808080">));
   </font><font color="#0000FF">END</font><font color="#808080">; 
   </font>Lookup<font color="#808080">(</font>tfUsuario<font color="#808080">, </font>ARQ_USUARIO<font color="#808080">, </font>FALSE<font color="#808080">);
   </font><font color="#0000FF">IF </font>tfUsuario.res<font color="#808080">=</font>notdone <font color="#0000FF">THEN
      </font>WriteLinha<font color="#808080">(</font>Ss<font color="#808080">(</font>Ss<font color="#808080">(</font>MSG_ARQERRO<font color="#808080">, </font><font color="#800000">' --&gt; '</font><font color="#808080">), </font>ARQ_USUARIO<font color="#808080">));
   </font><font color="#0000FF">END</font><font color="#808080">; 
   </font>Lookup<font color="#808080">(</font>tfVenda<font color="#808080">, </font>ARQ_VENDA<font color="#808080">, </font>FALSE<font color="#808080">);
   </font><font color="#0000FF">IF </font>tfVenda.res<font color="#808080">=</font>notdone <font color="#0000FF">THEN
      </font>WriteLinha<font color="#808080">(</font>Ss<font color="#808080">(</font>Ss<font color="#808080">(</font>MSG_ARQERRO<font color="#808080">, </font><font color="#800000">' --&gt; '</font><font color="#808080">), </font>ARQ_VENDA<font color="#808080">));
   </font><font color="#0000FF">END</font><font color="#808080">; 
 </font><font color="#0000FF">ELSE 
   </font>Lookup<font color="#808080">(</font>tfAssunto<font color="#808080">, </font>ARQ_ASSUNTO<font color="#808080">, </font>TRUE<font color="#808080">);
   </font><font color="#0000FF">IF </font>tfAssunto.res<font color="#808080">=</font>notdone <font color="#0000FF">THEN
      </font>WriteLinha<font color="#808080">(</font>Ss<font color="#808080">(</font>Ss<font color="#808080">(</font>MSG_ARQCERRO<font color="#808080">, </font><font color="#800000">' --&gt; '</font><font color="#808080">), </font>ARQ_ASSUNTO<font color="#808080">));
   </font><font color="#0000FF">END</font><font color="#808080">; 
   </font>Lookup<font color="#808080">(</font>tfAutor<font color="#808080">, </font>ARQ_AUTOR<font color="#808080">, </font>TRUE<font color="#808080">);
   </font><font color="#0000FF">IF </font>tfAutor.res<font color="#808080">=</font>notdone <font color="#0000FF">THEN
      </font>WriteLinha<font color="#808080">(</font>Ss<font color="#808080">(</font>Ss<font color="#808080">(</font>MSG_ARQCERRO<font color="#808080">, </font><font color="#800000">' --&gt; '</font><font color="#808080">), </font>ARQ_AUTOR<font color="#808080">));
   </font><font color="#0000FF">END</font><font color="#808080">; 
   </font>Lookup<font color="#808080">(</font>tfEditora<font color="#808080">, </font>ARQ_EDITORA<font color="#808080">, </font>TRUE<font color="#808080">);
   </font><font color="#0000FF">IF </font>tfEditora.res<font color="#808080">=</font>notdone <font color="#0000FF">THEN
      </font>WriteLinha<font color="#808080">(</font>Ss<font color="#808080">(</font>Ss<font color="#808080">(</font>MSG_ARQCERRO<font color="#808080">, </font><font color="#800000">' --&gt; '</font><font color="#808080">), </font>ARQ_EDITORA<font color="#808080">));
   </font><font color="#0000FF">END</font><font color="#808080">; 
   </font>Lookup<font color="#808080">(</font>tfIdioma<font color="#808080">, </font>ARQ_IDIOMA<font color="#808080">, </font>TRUE<font color="#808080">);
   </font><font color="#0000FF">IF </font>tfIdioma.res<font color="#808080">=</font>notdone <font color="#0000FF">THEN
      </font>WriteLinha<font color="#808080">(</font>Ss<font color="#808080">(</font>Ss<font color="#808080">(</font>MSG_ARQCERRO<font color="#808080">, </font><font color="#800000">' --&gt; '</font><font color="#808080">), </font>ARQ_IDIOMA<font color="#808080">));
   </font><font color="#0000FF">END</font><font color="#808080">; 
   </font>Lookup<font color="#808080">(</font>tfEndereco<font color="#808080">, </font>ARQ_ENDERECO<font color="#808080">, </font>TRUE<font color="#808080">);
   </font><font color="#0000FF">IF </font>tfEndereco.res<font color="#808080">=</font>notdone <font color="#0000FF">THEN
      </font>WriteLinha<font color="#808080">(</font>Ss<font color="#808080">(</font>Ss<font color="#808080">(</font>MSG_ARQCERRO<font color="#808080">, </font><font color="#800000">' --&gt; '</font><font color="#808080">), </font>ARQ_ENDERECO<font color="#808080">));
   </font><font color="#0000FF">END</font><font color="#808080">; 
   </font>Lookup<font color="#808080">(</font>tfPais<font color="#808080">, </font>ARQ_PAIS<font color="#808080">, </font>TRUE<font color="#808080">);
   </font><font color="#0000FF">IF </font>tfPais.res<font color="#808080">=</font>notdone <font color="#0000FF">THEN
      </font>WriteLinha<font color="#808080">(</font>Ss<font color="#808080">(</font>Ss<font color="#808080">(</font>MSG_ARQCERRO<font color="#808080">, </font><font color="#800000">' --&gt; '</font><font color="#808080">), </font>ARQ_PAIS<font color="#808080">));
   </font><font color="#0000FF">END</font><font color="#808080">; 
   </font>Lookup<font color="#808080">(</font>tfProfissao<font color="#808080">, </font>ARQ_PROFISSAO<font color="#808080">, </font>TRUE<font color="#808080">);
   </font><font color="#0000FF">IF </font>tfProfissao.res<font color="#808080">=</font>notdone <font color="#0000FF">THEN
      </font>WriteLinha<font color="#808080">(</font>Ss<font color="#808080">(</font>Ss<font color="#808080">(</font>MSG_ARQCERRO<font color="#808080">, </font><font color="#800000">' --&gt; '</font><font color="#808080">), </font>ARQ_PROFISSAO<font color="#808080">));
   </font><font color="#0000FF">END</font><font color="#808080">; 
   </font>Lookup<font color="#808080">(</font>tfLivro<font color="#808080">, </font>ARQ_LIVRO<font color="#808080">, </font>TRUE<font color="#808080">);
   </font><font color="#0000FF">IF </font>tfLivro.res<font color="#808080">=</font>notdone <font color="#0000FF">THEN
      </font>WriteLinha<font color="#808080">(</font>Ss<font color="#808080">(</font>Ss<font color="#808080">(</font>MSG_ARQCERRO<font color="#808080">, </font><font color="#800000">' --&gt; '</font><font color="#808080">), </font>ARQ_LIVRO<font color="#808080">));
   </font><font color="#0000FF">END</font><font color="#808080">; 
   </font>Lookup<font color="#808080">(</font>tfLivroAss<font color="#808080">, </font>ARQ_LIVASS<font color="#808080">, </font>TRUE<font color="#808080">);
   </font><font color="#0000FF">IF </font>tfLivroAss.res<font color="#808080">=</font>notdone <font color="#0000FF">THEN
      </font>WriteLinha<font color="#808080">(</font>Ss<font color="#808080">(</font>Ss<font color="#808080">(</font>MSG_ARQCERRO<font color="#808080">, </font><font color="#800000">' --&gt; '</font><font color="#808080">), </font>ARQ_LIVASS<font color="#808080">));
   </font><font color="#0000FF">END</font><font color="#808080">; 
   </font>Lookup<font color="#808080">(</font>tfLivroAut<font color="#808080">, </font>ARQ_LIVAUT<font color="#808080">, </font>TRUE<font color="#808080">);
   </font><font color="#0000FF">IF </font>tfLivroAut.res<font color="#808080">=</font>notdone <font color="#0000FF">THEN
      </font>WriteLinha<font color="#808080">(</font>Ss<font color="#808080">(</font>Ss<font color="#808080">(</font>MSG_ARQCERRO<font color="#808080">, </font><font color="#800000">' --&gt; '</font><font color="#808080">), </font>ARQ_LIVAUT<font color="#808080">));
   </font><font color="#0000FF">END</font><font color="#808080">; 
   </font>Lookup<font color="#808080">(</font>tfCliente<font color="#808080">, </font>ARQ_CLIENTE<font color="#808080">, </font>TRUE<font color="#808080">);
   </font><font color="#0000FF">IF </font>tfCliente.res<font color="#808080">=</font>notdone <font color="#0000FF">THEN
      </font>WriteLinha<font color="#808080">(</font>Ss<font color="#808080">(</font>Ss<font color="#808080">(</font>MSG_ARQCERRO<font color="#808080">, </font><font color="#800000">' --&gt; '</font><font color="#808080">), </font>ARQ_CLIENTE<font color="#808080">));
   </font><font color="#0000FF">END</font><font color="#808080">; 
   </font>Lookup<font color="#808080">(</font>tfUsuario<font color="#808080">, </font>ARQ_USUARIO<font color="#808080">, </font>TRUE<font color="#808080">);
   </font><font color="#0000FF">IF </font>tfUsuario.res<font color="#808080">=</font>notdone <font color="#0000FF">THEN
      </font>WriteLinha<font color="#808080">(</font>Ss<font color="#808080">(</font>Ss<font color="#808080">(</font>MSG_ARQCERRO<font color="#808080">, </font><font color="#800000">' --&gt; '</font><font color="#808080">), </font>ARQ_USUARIO<font color="#808080">));
   </font><font color="#0000FF">END</font><font color="#808080">; 
   </font>Lookup<font color="#808080">(</font>tfVenda<font color="#808080">, </font>ARQ_VENDA<font color="#808080">, </font>TRUE<font color="#808080">);
   </font><font color="#0000FF">IF </font>tfVenda.res<font color="#808080">=</font>notdone <font color="#0000FF">THEN
      </font>WriteLinha<font color="#808080">(</font>Ss<font color="#808080">(</font>Ss<font color="#808080">(</font>MSG_ARQCERRO<font color="#808080">, </font><font color="#800000">' --&gt; '</font><font color="#808080">), </font>ARQ_VENDA<font color="#808080">));
   </font><font color="#0000FF">END</font><font color="#808080">; 
 </font><font color="#0000FF">END</font><font color="#808080">;
</font><font color="#0000FF">END </font>abrecriaArqs<font color="#808080">;
(*------------------------------------------------------------------------------
</font>Fecha todos os arquivos abertos.
<font color="#808080">------------------------------------------------------------------------------*)
</font><font color="#0000FF">PROCEDURE </font>fechaArqs<font color="#808080">();
</font><font color="#0000FF">BEGIN
 </font>Close<font color="#808080">(</font>tfAssunto<font color="#808080">);
 </font>Close<font color="#808080">(</font>tfAutor<font color="#808080">);
 </font>Close<font color="#808080">(</font>tfEditora<font color="#808080">);
 </font>Close<font color="#808080">(</font>tfIdioma<font color="#808080">);
 </font>Close<font color="#808080">(</font>tfEndereco<font color="#808080">);
 </font>Close<font color="#808080">(</font>tfPais<font color="#808080">);
 </font>Close<font color="#808080">(</font>tfProfissao<font color="#808080">);
 </font>Close<font color="#808080">(</font>tfLivro<font color="#808080">);
 </font>Close<font color="#808080">(</font>tfLivroAss<font color="#808080">);
 </font>Close<font color="#808080">(</font>tfLivroAut<font color="#808080">);
 </font>Close<font color="#808080">(</font>tfCliente<font color="#808080">);
 </font>Close<font color="#808080">(</font>tfUsuario<font color="#808080">);
 </font>Close<font color="#808080">(</font>tfVenda<font color="#808080">);
</font><font color="#0000FF">END </font>fechaArqs<font color="#808080">;

(*------------------------------------------------------------------------------
</font>Pesquisa um registro atrav<font color="#808080">&eacute;</font>s de um valor chave num arquivo.
sArq <font color="#808080">- </font>o arquivo
sChave <font color="#808080">- </font>a chave a ser pesquisada
nPosChave <font color="#808080">- </font>a posicao inicial da chave dentro do registro
nTamChave <font color="#808080">- </font>o tamanho da chave dentro do registro
nTamLinha <font color="#808080">- </font>o tamanho do registro
retorna <font color="#808080">- </font>o registro pesquisado
<font color="#808080">------------------------------------------------------------------------------*)
</font><font color="#0000FF">PROCEDURE </font>pesqArq<font color="#808080">(</font><font color="#0000FF">VAR </font>sArq<font color="#808080">: </font>File<font color="#808080">; </font>sChave<font color="#808080">: </font>String<font color="#808080">; </font>nPosChave<font color="#808080">,
        </font>nTamChave<font color="#808080">, </font>nTamLinha<font color="#808080">: </font><font color="#0000FF">CARDINAL</font><font color="#808080">): </font>String<font color="#808080">;
</font><font color="#0000FF">VAR </font>slinha<font color="#808080">: </font>String<font color="#808080">;
    </font>sres<font color="#808080">: </font>String<font color="#808080">;
    </font>bQuebra<font color="#808080">: </font><font color="#0000FF">BOOLEAN</font><font color="#808080">;
    </font>nPosicao<font color="#808080">, </font>npos<font color="#808080">: </font><font color="#0000FF">CARDINAL</font><font color="#808080">;
</font><font color="#0000FF">BEGIN
</font>bQuebra<font color="#808080">:=</font>FALSE<font color="#808080">;
</font>npos<font color="#808080">:=</font><font color="#FF0000">0</font><font color="#808080">;
</font>SetPos<font color="#808080">(</font>sArq<font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">);
</font><font color="#0000FF">WHILE </font><font color="#808080">(</font><font color="#0000FF">NOT </font>fimArq<font color="#808080">(</font>sArq<font color="#808080">)) </font><font color="#0000FF">AND </font><font color="#808080">(</font>bQuebra<font color="#808080">=</font>FALSE<font color="#808080">) </font><font color="#0000FF">DO 
  </font>slinha<font color="#808080">:=</font>lerArq<font color="#808080">(</font>sArq<font color="#808080">, </font>nTamLinha<font color="#808080">, </font>TAM_CRLF<font color="#808080">, </font>npos<font color="#808080">);
  </font>sres<font color="#808080">:=</font>trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha<font color="#808080">,</font>nPosChave<font color="#808080">,</font>nTamChave<font color="#808080">));
  </font><font color="#0000FF">IF </font>CompareStr<font color="#808080">(</font>sres<font color="#808080">, </font>sChave<font color="#808080">)=</font>equal <font color="#0000FF">THEN
     </font>bQuebra<font color="#808080">:=</font>TRUE<font color="#808080">;
  </font><font color="#0000FF">END</font><font color="#808080">;
</font><font color="#0000FF">END</font><font color="#808080">;
</font>GetPos<font color="#808080">(</font>sArq<font color="#808080">, </font>npos<font color="#808080">, </font>nPosicao<font color="#808080">);
</font>nPosicao<font color="#808080">:=</font>nPosicao<font color="#808080">-(</font>nTamLinha <font color="#808080">+ </font>TAM_CRLF<font color="#808080">);
</font><font color="#0000FF">IF </font>nPosicao <font color="#808080">&gt; </font><font color="#FF0000">0 </font><font color="#0000FF">THEN
   </font>SetPos<font color="#808080">(</font>sArq<font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font>nPosicao<font color="#808080">);
</font><font color="#0000FF">ELSE
   </font>SetPos<font color="#808080">(</font>sArq<font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">);
</font><font color="#0000FF">END</font><font color="#808080">;
</font><font color="#0000FF">IF </font>CompareStr<font color="#808080">(</font>sres<font color="#808080">,</font>sChave<font color="#808080">)&lt;&gt;</font>equal <font color="#0000FF">THEN
   </font>sres<font color="#808080">:=</font><font color="#800000">''</font><font color="#808080">;
   </font><font color="#0000FF">RETURN </font>sres<font color="#808080">;
</font><font color="#0000FF">ELSE
   RETURN </font>copy<font color="#808080">(</font>slinha<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">,</font>nTamLinha<font color="#808080">);
</font><font color="#0000FF">END</font><font color="#808080">;
</font><font color="#0000FF">END </font>pesqArq<font color="#808080">;
(*------------------------------------------------------------------------------
</font>Pesquisa se tem linha exclu<font color="#808080">&iacute;</font>da sen<font color="#808080">&atilde;</font>o vai para a <font color="#808080">&uacute;</font>ltima linha do arquivo.
sArq <font color="#808080">- </font>o arquivo
nTamLinha <font color="#808080">- </font>o tamanho do registro
<font color="#808080">------------------------------------------------------------------------------*)
</font><font color="#0000FF">PROCEDURE </font>pesqLinhaExcluida<font color="#808080">(</font><font color="#0000FF">VAR </font>sArq<font color="#808080">: </font>File<font color="#808080">; </font>nTamLinha<font color="#808080">: </font><font color="#0000FF">CARDINAL</font><font color="#808080">);
</font><font color="#0000FF">VAR </font>sExcluido<font color="#808080">: </font>String<font color="#808080">;
</font><font color="#0000FF">BEGIN
</font>sExcluido<font color="#808080">:=</font>pesqArq<font color="#808080">(</font>sArq<font color="#808080">, </font><font color="#800000">'*'</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font><font color="#FF0000">1</font><font color="#808080">, </font>nTamLinha<font color="#808080">);
</font><font color="#0000FF">IF </font>CompareStr<font color="#808080">(</font>sExcluido<font color="#808080">,</font><font color="#800000">''</font><font color="#808080">)=</font>equal <font color="#0000FF">THEN
   </font>SetPos<font color="#808080">(</font>sArq<font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font>tamArq<font color="#808080">(</font>sArq<font color="#808080">));
</font><font color="#0000FF">END</font><font color="#808080">;
</font><font color="#0000FF">END </font>pesqLinhaExcluida<font color="#808080">;
(*------------------------------------------------------------------------------
</font>Pesquisa o maior c<font color="#808080">&oacute;</font>digo num arquivo.
sArq <font color="#808080">- </font>o arquivo
nPosChave <font color="#808080">- </font>a posicao inicial da chave dentro do registro
nTamChave <font color="#808080">- </font>o tamanho da chave dentro do registro
nTamLinha <font color="#808080">- </font>o tamanho do registro
retorna <font color="#808080">- </font>o maior c<font color="#808080">&oacute;</font>digo
<font color="#808080">------------------------------------------------------------------------------*)
</font><font color="#0000FF">PROCEDURE </font>pesqMaxCod<font color="#808080">(</font><font color="#0000FF">VAR </font>sArq<font color="#808080">: </font>File<font color="#808080">; </font>nPosChave<font color="#808080">,
        </font>nTamChave<font color="#808080">, </font>nTamLinha<font color="#808080">: </font><font color="#0000FF">CARDINAL</font><font color="#808080">): </font>String<font color="#808080">;
</font><font color="#0000FF">VAR </font>slinha<font color="#808080">: </font>String<font color="#808080">;
    </font>sres<font color="#808080">: </font>String<font color="#808080">;
    </font>bQuebra<font color="#808080">: </font><font color="#0000FF">BOOLEAN</font><font color="#808080">;
    </font>nMaior<font color="#808080">, </font>nCod<font color="#808080">, </font>npos<font color="#808080">: </font><font color="#0000FF">CARDINAL</font><font color="#808080">;
    </font>nStatus<font color="#808080">: </font><font color="#0000FF">BOOLEAN</font><font color="#808080">;
</font><font color="#0000FF">BEGIN
</font>bQuebra<font color="#808080">:=</font>FALSE<font color="#808080">;
</font>nMaior<font color="#808080">:=</font><font color="#FF0000">0</font><font color="#808080">;
</font>npos<font color="#808080">:=</font><font color="#FF0000">0</font><font color="#808080">;
</font>SetPos<font color="#808080">(</font>sArq<font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">, </font><font color="#FF0000">0</font><font color="#808080">);
</font><font color="#0000FF">WHILE </font><font color="#808080">(</font><font color="#0000FF">NOT </font>fimArq<font color="#808080">(</font>sArq<font color="#808080">)) </font><font color="#0000FF">AND </font><font color="#808080">(</font>bQuebra<font color="#808080">=</font>FALSE<font color="#808080">) </font><font color="#0000FF">DO 
  </font>slinha<font color="#808080">:=</font>lerArq<font color="#808080">(</font>sArq<font color="#808080">, </font>nTamLinha<font color="#808080">, </font>TAM_CRLF<font color="#808080">, </font>npos<font color="#808080">);  
  </font>sres<font color="#808080">:=</font>trim<font color="#808080">(</font>copy<font color="#808080">(</font>slinha<font color="#808080">,</font>nPosChave<font color="#808080">,</font>nTamChave<font color="#808080">));     
  </font>StringToCard<font color="#808080">(</font>sres<font color="#808080">, </font>nCod<font color="#808080">, </font>nStatus<font color="#808080">);
  </font><font color="#0000FF">IF </font>nCod <font color="#808080">&gt; </font>nMaior <font color="#0000FF">THEN
     </font>nMaior<font color="#808080">:=</font>nCod<font color="#808080">;
  </font><font color="#0000FF">END</font><font color="#808080">;   
</font><font color="#0000FF">END</font><font color="#808080">;
</font>pesqLinhaExcluida<font color="#808080">(</font>sArq<font color="#808080">, </font>nTamLinha<font color="#808080">);
</font>CardToString<font color="#808080">((</font>nMaior<font color="#808080">+</font><font color="#FF0000">1</font><font color="#808080">), </font>sres<font color="#808080">, </font><font color="#FF0000">7</font><font color="#808080">);
</font><font color="#0000FF">RETURN </font>trim<font color="#808080">(</font>sres<font color="#808080">);
</font><font color="#0000FF">END </font>pesqMaxCod<font color="#808080">;
(*------------------------------------------------------------------------------
</font>Grava os registros num determinado arquivo.
sArq <font color="#808080">- </font>o arquivo
sTexto <font color="#808080">- </font>o registro a ser gravado
sMsgAcerto <font color="#808080">- </font>a mensagem caso o registro foi gravado
sMsgErro <font color="#808080">- </font>a mensagem caso o registro n<font color="#808080">&atilde;</font>o foi gravado
<font color="#808080">------------------------------------------------------------------------------*)
</font><font color="#0000FF">PROCEDURE </font>escreveArq<font color="#808080">(</font><font color="#0000FF">VAR </font>sArq<font color="#808080">: </font>File<font color="#808080">; </font>sTexto<font color="#808080">, </font>sMsgAcerto<font color="#808080">,
</font>	sMsgErro<font color="#808080">: </font>String<font color="#808080">);
</font><font color="#0000FF">VAR </font>ntam<font color="#808080">, </font>nStatus<font color="#808080">: </font><font color="#0000FF">CARDINAL</font><font color="#808080">;
</font><font color="#0000FF">BEGIN
</font>ntam<font color="#808080">:=</font>Length<font color="#808080">(</font>sTexto<font color="#808080">);
(*</font>Append<font color="#808080">(</font>sTexto<font color="#808080">, </font>CRLF<font color="#808080">);*)
</font>sTexto<font color="#808080">[</font>ntam<font color="#808080">]:=</font>cr<font color="#808080">;
</font>sTexto<font color="#808080">[</font>ntam<font color="#808080">+</font><font color="#FF0000">1</font><font color="#808080">]:=</font>lf<font color="#808080">;
</font>nStatus<font color="#808080">:=</font>gravarArq<font color="#808080">(</font>sArq<font color="#808080">, </font>ntam<font color="#808080">, </font>TAM_CRLF<font color="#808080">, </font>sTexto<font color="#808080">);
</font><font color="#0000FF">IF </font>nStatus <font color="#808080">&gt; </font><font color="#FF0000">0 </font><font color="#0000FF">THEN
   </font>WriteLinha<font color="#808080">(</font>sMsgAcerto<font color="#808080">);
</font><font color="#0000FF">ELSE
   </font>WriteLinha<font color="#808080">(</font>sMsgErro<font color="#808080">);
</font><font color="#0000FF">END</font><font color="#808080">;
</font><font color="#0000FF">END </font>escreveArq<font color="#808080">;
(*------------------------------------------------------------------------------
</font>Retorna o tamanho do registro no arquivo de acordo com o tipo de arquivo.
sreg <font color="#808080">- </font>o tipo de arquivo
retorna <font color="#808080">- </font>o tamanho do registro
<font color="#808080">------------------------------------------------------------------------------*)
</font><font color="#0000FF">PROCEDURE </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">: </font>ctArqs<font color="#808080">): </font><font color="#0000FF">CARDINAL</font><font color="#808080">;
</font><font color="#0000FF">VAR </font>nret<font color="#808080">: </font><font color="#0000FF">CARDINAL</font><font color="#808080">;
</font><font color="#0000FF">BEGIN
</font>nret<font color="#808080">:=</font><font color="#FF0000">0</font><font color="#808080">;
</font><font color="#0000FF">IF </font>sreg<font color="#808080">=</font>opAssunto <font color="#0000FF">THEN </font>nret<font color="#808080">:=</font>TAM_ASSUNTO<font color="#808080">;
</font><font color="#0000FF">ELSIF </font>sreg<font color="#808080">=</font>opAutor <font color="#0000FF">THEN </font>nret<font color="#808080">:=</font>TAM_AUTOR<font color="#808080">;
</font><font color="#0000FF">ELSIF </font>sreg<font color="#808080">=</font>opEditora <font color="#0000FF">THEN </font>nret<font color="#808080">:=</font>TAM_EDITORA<font color="#808080">;
</font><font color="#0000FF">ELSIF </font>sreg<font color="#808080">=</font>opEndereco <font color="#0000FF">THEN </font>nret<font color="#808080">:=</font>TAM_ENDERECO<font color="#808080">;
</font><font color="#0000FF">ELSIF </font>sreg<font color="#808080">=</font>opIdioma <font color="#0000FF">THEN </font>nret<font color="#808080">:=</font>TAM_IDIOMA<font color="#808080">;
</font><font color="#0000FF">ELSIF </font>sreg<font color="#808080">=</font>opPais <font color="#0000FF">THEN </font>nret<font color="#808080">:=</font>TAM_PAIS<font color="#808080">;
</font><font color="#0000FF">ELSIF </font>sreg<font color="#808080">=</font>opProfissao <font color="#0000FF">THEN </font>nret<font color="#808080">:=</font>TAM_PROFISSAO<font color="#808080">;
</font><font color="#0000FF">ELSIF </font>sreg<font color="#808080">=</font>opUsuario <font color="#0000FF">THEN </font>nret<font color="#808080">:=</font>TAM_USUARIO<font color="#808080">;
</font><font color="#0000FF">ELSIF </font>sreg<font color="#808080">=</font>opLivro <font color="#0000FF">THEN </font>nret<font color="#808080">:=</font>TAM_LIVRO<font color="#808080">;
</font><font color="#0000FF">ELSIF </font>sreg<font color="#808080">=</font>opLivroAss <font color="#0000FF">THEN </font>nret<font color="#808080">:=</font>TAM_LIVASS<font color="#808080">;
</font><font color="#0000FF">ELSIF </font>sreg<font color="#808080">=</font>opLivroAut <font color="#0000FF">THEN </font>nret<font color="#808080">:=</font>TAM_LIVAUT<font color="#808080">;
</font><font color="#0000FF">ELSIF </font>sreg<font color="#808080">=</font>opCliente <font color="#0000FF">THEN </font>nret<font color="#808080">:=</font>TAM_CLIENTE<font color="#808080">;
</font><font color="#0000FF">ELSIF </font>sreg<font color="#808080">=</font>opVenda <font color="#0000FF">THEN </font>nret<font color="#808080">:=</font>TAM_VENDA<font color="#808080">;
</font><font color="#0000FF">END</font><font color="#808080">;
</font><font color="#0000FF">RETURN </font>nret<font color="#808080">;
</font><font color="#0000FF">END </font>tamReg<font color="#808080">;

(*------------------------------------------------------------------------------
</font>Monta o tamanho do registro no arquivo de acordo com o tipo de arquivo.
sreg <font color="#808080">- </font>o tipo de arquivo
retorna <font color="#808080">- </font>o registro montado
<font color="#808080">------------------------------------------------------------------------------*)
</font><font color="#0000FF">PROCEDURE </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">: </font>ctArqs<font color="#808080">): </font>String<font color="#808080">;
</font><font color="#0000FF">VAR </font>slinha<font color="#808080">: </font>String<font color="#808080">;
</font><font color="#0000FF">BEGIN
</font>slinha<font color="#808080">:=</font><font color="#800000">''</font><font color="#808080">;
</font><font color="#0000FF">IF </font>sreg<font color="#808080">=</font>opAssunto <font color="#0000FF">THEN
   </font>slinha<font color="#808080">:=</font>Ss<font color="#808080">(</font>esp<font color="#808080">(</font>tAssunto.codigo<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">),</font>esp<font color="#808080">(</font>tAssunto.assunto<font color="#808080">,</font><font color="#FF0000">30</font><font color="#808080">));
</font><font color="#0000FF">ELSIF </font>sreg<font color="#808080">=</font>opAutor <font color="#0000FF">THEN   
   </font>slinha<font color="#808080">:=</font>Ss<font color="#808080">(</font>esp<font color="#808080">(</font>tAutor.codigo<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">),</font>esp<font color="#808080">(</font>tAutor.autor<font color="#808080">,</font><font color="#FF0000">30</font><font color="#808080">));
</font><font color="#0000FF">ELSIF </font>sreg<font color="#808080">=</font>opEditora <font color="#0000FF">THEN
   </font>slinha<font color="#808080">:=</font>Ss<font color="#808080">(</font>esp<font color="#808080">(</font>tEditora.codigo<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">),</font>esp<font color="#808080">(</font>tEditora.editora<font color="#808080">,</font><font color="#FF0000">50</font><font color="#808080">));
</font><font color="#0000FF">ELSIF </font>sreg<font color="#808080">=</font>opEndereco <font color="#0000FF">THEN
   </font>stemp<font color="#808080">[</font><font color="#FF0000">0</font><font color="#808080">]:=</font>esp<font color="#808080">(</font>tEndereco.codigo<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">);
   </font>stemp<font color="#808080">[</font><font color="#FF0000">1</font><font color="#808080">]:=</font>esp<font color="#808080">(</font>tEndereco.logradouro<font color="#808080">,</font><font color="#FF0000">40</font><font color="#808080">);
   </font>stemp<font color="#808080">[</font><font color="#FF0000">2</font><font color="#808080">]:=</font>esp<font color="#808080">(</font>tEndereco.bairro<font color="#808080">,</font><font color="#FF0000">15</font><font color="#808080">);
   </font>stemp<font color="#808080">[</font><font color="#FF0000">3</font><font color="#808080">]:=</font>esp<font color="#808080">(</font>tEndereco.cep<font color="#808080">,</font><font color="#FF0000">8</font><font color="#808080">);
   </font>stemp<font color="#808080">[</font><font color="#FF0000">4</font><font color="#808080">]:=</font>esp<font color="#808080">(</font>tEndereco.cidade<font color="#808080">,</font><font color="#FF0000">30</font><font color="#808080">);
   </font>stemp<font color="#808080">[</font><font color="#FF0000">5</font><font color="#808080">]:=</font>esp<font color="#808080">(</font>tEndereco.estado<font color="#808080">,</font><font color="#FF0000">20</font><font color="#808080">);
   </font>slinha<font color="#808080">:=</font>SomaStr<font color="#808080">(</font><font color="#FF0000">6</font><font color="#808080">,</font>stemp<font color="#808080">);
</font><font color="#0000FF">ELSIF </font>sreg<font color="#808080">=</font>opIdioma <font color="#0000FF">THEN   
   </font>slinha<font color="#808080">:=</font>Ss<font color="#808080">(</font>esp<font color="#808080">(</font>tIdioma.codigo<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">),</font>esp<font color="#808080">(</font>tIdioma.idioma<font color="#808080">,</font><font color="#FF0000">20</font><font color="#808080">));
</font><font color="#0000FF">ELSIF </font>sreg<font color="#808080">=</font>opPais <font color="#0000FF">THEN   
   </font>slinha<font color="#808080">:=</font>Ss<font color="#808080">(</font>esp<font color="#808080">(</font>tPais.codigo<font color="#808080">,</font><font color="#FF0000">3</font><font color="#808080">),</font>esp<font color="#808080">(</font>tPais.pais<font color="#808080">,</font><font color="#FF0000">50</font><font color="#808080">));
</font><font color="#0000FF">ELSIF </font>sreg<font color="#808080">=</font>opProfissao <font color="#0000FF">THEN   
   </font>slinha<font color="#808080">:=</font>Ss<font color="#808080">(</font>esp<font color="#808080">(</font>tProfissao.codigo<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">),</font>esp<font color="#808080">(</font>tProfissao.profissao<font color="#808080">,</font><font color="#FF0000">50</font><font color="#808080">));
</font><font color="#0000FF">ELSIF </font>sreg<font color="#808080">=</font>opUsuario <font color="#0000FF">THEN   
   </font>slinha<font color="#808080">:=</font>Ss<font color="#808080">(</font>esp<font color="#808080">(</font>tUsuario.login<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">),</font>esp<font color="#808080">(</font>tUsuario.senha<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">));
</font><font color="#0000FF">ELSIF </font>sreg<font color="#808080">=</font>opLivro <font color="#0000FF">THEN
   </font>stemp<font color="#808080">[</font><font color="#FF0000">0</font><font color="#808080">]:=</font>esp<font color="#808080">(</font>tLivro.isbn<font color="#808080">,</font><font color="#FF0000">13</font><font color="#808080">);
   </font>stemp<font color="#808080">[</font><font color="#FF0000">1</font><font color="#808080">]:=</font>esp<font color="#808080">(</font>tLivro.titulo<font color="#808080">,</font><font color="#FF0000">50</font><font color="#808080">);
   </font>stemp<font color="#808080">[</font><font color="#FF0000">2</font><font color="#808080">]:=</font>esp<font color="#808080">(</font>tLivro.edicao<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">);
   </font>stemp<font color="#808080">[</font><font color="#FF0000">3</font><font color="#808080">]:=</font>esp<font color="#808080">(</font>tLivro.anopubli<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">);
   </font>stemp<font color="#808080">[</font><font color="#FF0000">4</font><font color="#808080">]:=</font>esp<font color="#808080">(</font>tLivro.codeditora<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">);
   </font>stemp<font color="#808080">[</font><font color="#FF0000">5</font><font color="#808080">]:=</font>esp<font color="#808080">(</font>tLivro.volume<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">);
   </font>stemp<font color="#808080">[</font><font color="#FF0000">6</font><font color="#808080">]:=</font>esp<font color="#808080">(</font>tLivro.codidioma<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">);
   </font>stemp<font color="#808080">[</font><font color="#FF0000">7</font><font color="#808080">]:=</font>esp<font color="#808080">(</font>tLivro.npaginas<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">);
   </font>stemp<font color="#808080">[</font><font color="#FF0000">8</font><font color="#808080">]:=</font>esp<font color="#808080">(</font>tLivro.preco<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">);
   </font>stemp<font color="#808080">[</font><font color="#FF0000">9</font><font color="#808080">]:=</font>esp<font color="#808080">(</font>tLivro.qtdestoque<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">);
   </font>slinha<font color="#808080">:=</font>SomaStr<font color="#808080">(</font><font color="#FF0000">10</font><font color="#808080">,</font>stemp<font color="#808080">);
</font><font color="#0000FF">ELSIF </font>sreg<font color="#808080">=</font>opLivroAss <font color="#0000FF">THEN
   </font>slinha<font color="#808080">:=</font>Ss<font color="#808080">(</font>esp<font color="#808080">(</font>tLivroAss.isbn<font color="#808080">,</font><font color="#FF0000">13</font><font color="#808080">),</font>esp<font color="#808080">(</font>tLivroAss.codassunto<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">));
</font><font color="#0000FF">ELSIF </font>sreg<font color="#808080">=</font>opLivroAut <font color="#0000FF">THEN   
   </font>slinha<font color="#808080">:=</font>Ss<font color="#808080">(</font>esp<font color="#808080">(</font>tLivroAut.isbn<font color="#808080">,</font><font color="#FF0000">13</font><font color="#808080">),</font>esp<font color="#808080">(</font>tLivroAut.codautor<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">));
</font><font color="#0000FF">ELSIF </font>sreg<font color="#808080">=</font>opCliente <font color="#0000FF">THEN
   </font>stemp<font color="#808080">[</font><font color="#FF0000">0</font><font color="#808080">]:=</font>esp<font color="#808080">(</font>tCliente.cpf<font color="#808080">,</font><font color="#FF0000">14</font><font color="#808080">);
   </font>stemp<font color="#808080">[</font><font color="#FF0000">1</font><font color="#808080">]:=</font>esp<font color="#808080">(</font>tCliente.nome<font color="#808080">,</font><font color="#FF0000">30</font><font color="#808080">);
   </font>stemp<font color="#808080">[</font><font color="#FF0000">2</font><font color="#808080">]:=</font>esp<font color="#808080">(</font>tCliente.email<font color="#808080">,</font><font color="#FF0000">30</font><font color="#808080">);
   </font>stemp<font color="#808080">[</font><font color="#FF0000">3</font><font color="#808080">]:=</font>esp<font color="#808080">(</font>tCliente.identidade<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">);
   </font>stemp<font color="#808080">[</font><font color="#FF0000">4</font><font color="#808080">]:=</font>esp<font color="#808080">(</font>tCliente.sexo<font color="#808080">,</font><font color="#FF0000">1</font><font color="#808080">);
   </font>stemp<font color="#808080">[</font><font color="#FF0000">5</font><font color="#808080">]:=</font>esp<font color="#808080">(</font>tCliente.telefone<font color="#808080">,</font><font color="#FF0000">17</font><font color="#808080">);
   </font>stemp<font color="#808080">[</font><font color="#FF0000">6</font><font color="#808080">]:=</font>esp<font color="#808080">(</font>tCliente.dtnascimento<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">);
   </font>stemp<font color="#808080">[</font><font color="#FF0000">7</font><font color="#808080">]:=</font>esp<font color="#808080">(</font>tCliente.codendereco<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">);
   </font>stemp<font color="#808080">[</font><font color="#FF0000">8</font><font color="#808080">]:=</font>esp<font color="#808080">(</font>tCliente.codpais<font color="#808080">,</font><font color="#FF0000">3</font><font color="#808080">);
   </font>stemp<font color="#808080">[</font><font color="#FF0000">9</font><font color="#808080">]:=</font>esp<font color="#808080">(</font>tCliente.codprofissao<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">);
   </font>slinha<font color="#808080">:=</font>SomaStr<font color="#808080">(</font><font color="#FF0000">10</font><font color="#808080">,</font>stemp<font color="#808080">);
</font><font color="#0000FF">ELSIF </font>sreg<font color="#808080">=</font>opVenda <font color="#0000FF">THEN
   </font>stemp<font color="#808080">[</font><font color="#FF0000">0</font><font color="#808080">]:=</font>esp<font color="#808080">(</font>tVenda.dthrvenda<font color="#808080">,</font><font color="#FF0000">19</font><font color="#808080">);
   </font>stemp<font color="#808080">[</font><font color="#FF0000">1</font><font color="#808080">]:=</font>esp<font color="#808080">(</font>tVenda.cpf<font color="#808080">,</font><font color="#FF0000">14</font><font color="#808080">);
   </font>stemp<font color="#808080">[</font><font color="#FF0000">2</font><font color="#808080">]:=</font>esp<font color="#808080">(</font>tVenda.isbn<font color="#808080">,</font><font color="#FF0000">13</font><font color="#808080">);
   </font>stemp<font color="#808080">[</font><font color="#FF0000">3</font><font color="#808080">]:=</font>esp<font color="#808080">(</font>tVenda.precovenda<font color="#808080">,</font><font color="#FF0000">10</font><font color="#808080">);
   </font>slinha<font color="#808080">:=</font>SomaStr<font color="#808080">(</font><font color="#FF0000">4</font><font color="#808080">,</font>stemp<font color="#808080">);
</font><font color="#0000FF">END</font><font color="#808080">;

</font><font color="#0000FF">RETURN </font>slinha<font color="#808080">;
</font><font color="#0000FF">END </font>LinhaReg<font color="#808080">;

</font><font color="#0000FF">END </font>Arquivos.
</font>
</code></pre>
</body>
</html>