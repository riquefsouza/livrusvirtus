<html>
<head>
<title>Livrus Virtus - Console - Modula-2 - Definição - GPM - Arquivos</title>
</head>
<!-- Generated by ConTEXT HTML exporter -->
<body text="#000000" bgcolor="#FFFFFF">
<pre>
<code><font  face="Courier New"><font color="#0000FF">DEFINITION MODULE </font>Arquivos<font color="#808080">;

</font><font color="#0000FF">FROM </font>Ascii <font color="#0000FF">IMPORT </font>lf<font color="#808080">, </font>cr<font color="#808080">;
</font><font color="#0000FF">FROM </font>Rotinas <font color="#0000FF">IMPORT </font>String<font color="#808080">;
</font><font color="#0000FF">FROM </font>RndFile <font color="#0000FF">IMPORT </font>ChanId<font color="#808080">;

</font><font color="#0000FF">TYPE
  </font>regAssunto <font color="#808080">= </font><font color="#0000FF">RECORD
   </font>codigo<font color="#808080">: </font>String<font color="#808080">; (* ARRAY[1..10] OF CHAR; *)
   </font>assunto<font color="#808080">: </font>String<font color="#808080">; (* ARRAY[1..30] OF CHAR; *)
  </font><font color="#0000FF">END</font><font color="#808080">;
  </font>regAutor <font color="#808080">= </font><font color="#0000FF">RECORD
   </font>codigo<font color="#808080">: </font>String<font color="#808080">; (* ARRAY[1..10] OF CHAR; *)
   </font>autor<font color="#808080">: </font>String<font color="#808080">; (* ARRAY[1..30] OF CHAR; *)
  </font><font color="#0000FF">END</font><font color="#808080">;
  </font>regEditora <font color="#808080">= </font><font color="#0000FF">RECORD
   </font>codigo<font color="#808080">: </font>String<font color="#808080">; (* ARRAY[1..10] OF CHAR; *)
   </font>editora<font color="#808080">: </font>String<font color="#808080">; (* ARRAY[1..50] OF CHAR; *)
  </font><font color="#0000FF">END</font><font color="#808080">;
  </font>regIdioma <font color="#808080">= </font><font color="#0000FF">RECORD
   </font>codigo<font color="#808080">: </font>String<font color="#808080">; (* ARRAY[1..10] OF CHAR; *)
   </font>idioma<font color="#808080">: </font>String<font color="#808080">; (* ARRAY[1..20] OF CHAR; *)
  </font><font color="#0000FF">END</font><font color="#808080">;
  </font>regUsuario <font color="#808080">= </font><font color="#0000FF">RECORD
   </font>login<font color="#808080">: </font>String<font color="#808080">; (* ARRAY[1..10] OF CHAR; *)
   </font>senha<font color="#808080">: </font>String<font color="#808080">; (* ARRAY[1..10] OF CHAR; *)
  </font><font color="#0000FF">END</font><font color="#808080">;
  </font>regPais <font color="#808080">= </font><font color="#0000FF">RECORD
   </font>codigo<font color="#808080">: </font>String<font color="#808080">; (* ARRAY[1..3] OF CHAR; *)
   </font>pais<font color="#808080">: </font>String<font color="#808080">; (* ARRAY[1..50] OF CHAR; *)
  </font><font color="#0000FF">END</font><font color="#808080">;
  </font>regProfissao <font color="#808080">= </font><font color="#0000FF">RECORD
   </font>codigo<font color="#808080">: </font>String<font color="#808080">; (* ARRAY[1..10] OF CHAR; *)
   </font>profissao<font color="#808080">: </font>String<font color="#808080">; (* ARRAY[1..50] OF CHAR; *)
  </font><font color="#0000FF">END</font><font color="#808080">;
  </font>regLivro <font color="#808080">= </font><font color="#0000FF">RECORD
   </font>isbn<font color="#808080">: </font>String<font color="#808080">; (* ARRAY[1..13] OF CHAR; *)
   </font>titulo<font color="#808080">: </font>String<font color="#808080">; (* ARRAY[1..50] OF CHAR; *)
   </font>edicao<font color="#808080">: </font>String<font color="#808080">; (* ARRAY[1..10] OF CHAR; *)
   </font>anopubli<font color="#808080">: </font>String<font color="#808080">; (* ARRAY[1..10] OF CHAR; *)
   </font>codeditora<font color="#808080">: </font>String<font color="#808080">; (* ARRAY[1..10] OF CHAR; *)
   </font>volume<font color="#808080">: </font>String<font color="#808080">; (* ARRAY[1..10] OF CHAR; *)
   </font>codidioma<font color="#808080">: </font>String<font color="#808080">; (* ARRAY[1..10] OF CHAR; *)
   </font>npaginas<font color="#808080">: </font>String<font color="#808080">; (* ARRAY[1..10] OF CHAR; *)
   </font>preco<font color="#808080">: </font>String<font color="#808080">; (* ARRAY[1..10] OF CHAR; *)
   </font>qtdestoque<font color="#808080">: </font>String<font color="#808080">; (* ARRAY[1..10] OF CHAR; *)
  </font><font color="#0000FF">END</font><font color="#808080">;
  </font>regLivroAss <font color="#808080">= </font><font color="#0000FF">RECORD
   </font>isbn<font color="#808080">: </font>String<font color="#808080">; (* ARRAY[1..13] OF CHAR; *)
   </font>codassunto<font color="#808080">: </font>String<font color="#808080">; (* ARRAY[1..10] OF CHAR; *)
  </font><font color="#0000FF">END</font><font color="#808080">;
  </font>regLivroAut <font color="#808080">= </font><font color="#0000FF">RECORD
   </font>isbn<font color="#808080">: </font>String<font color="#808080">; (* ARRAY[1..13] OF CHAR; *)
   </font>codautor<font color="#808080">: </font>String<font color="#808080">; (* ARRAY[1..10] OF CHAR; *)
  </font><font color="#0000FF">END</font><font color="#808080">;
  </font>regCliente <font color="#808080">= </font><font color="#0000FF">RECORD
   </font>cpf<font color="#808080">: </font>String<font color="#808080">; (* ARRAY[1..14] OF CHAR; *)
   </font>nome<font color="#808080">: </font>String<font color="#808080">; (* ARRAY[1..30] OF CHAR; *)
   </font>email<font color="#808080">: </font>String<font color="#808080">; (* ARRAY[1..30] OF CHAR; *)
   </font>identidade<font color="#808080">: </font>String<font color="#808080">; (* ARRAY[1..10] OF CHAR; *)
   </font>sexo<font color="#808080">: </font>String<font color="#808080">; (* CHAR; *)
   </font>telefone<font color="#808080">: </font>String<font color="#808080">; (* ARRAY[1..17] OF CHAR; *)
   </font>dtnascimento<font color="#808080">: </font>String<font color="#808080">; (* ARRAY[1..10] OF CHAR; *)
   </font>codendereco<font color="#808080">: </font>String<font color="#808080">; (* ARRAY[1..10] OF CHAR; *)
   </font>codpais<font color="#808080">: </font>String<font color="#808080">; (* ARRAY[1..3] OF CHAR; *)
   </font>codprofissao<font color="#808080">: </font>String<font color="#808080">; (* ARRAY[1..10] OF CHAR; *)
  </font><font color="#0000FF">END</font><font color="#808080">;
  </font>regEndereco <font color="#808080">= </font><font color="#0000FF">RECORD
   </font>codigo<font color="#808080">: </font>String<font color="#808080">; (* ARRAY[1..10] OF CHAR; *)
   </font>logradouro<font color="#808080">: </font>String<font color="#808080">; (* ARRAY[1..40] OF CHAR; *)
   </font>bairro<font color="#808080">: </font>String<font color="#808080">; (* ARRAY[1..15] OF CHAR; *)
   </font>cep<font color="#808080">: </font>String<font color="#808080">; (* ARRAY[1..8] OF CHAR; *)
   </font>cidade<font color="#808080">: </font>String<font color="#808080">; (* ARRAY[1..30] OF CHAR; *)
   </font>estado<font color="#808080">: </font>String<font color="#808080">; (* ARRAY[1..20] OF CHAR; *)
  </font><font color="#0000FF">END</font><font color="#808080">;
  </font>regVenda <font color="#808080">= </font><font color="#0000FF">RECORD   
   </font>dthrvenda<font color="#808080">: </font>String<font color="#808080">; (* (19) data/hora da venda dd/mm/yyyy hh:mm:ss *)
   </font>cpf<font color="#808080">: </font>String<font color="#808080">; (* ARRAY[1..14] OF CHAR; *)
   </font>isbn<font color="#808080">: </font>String<font color="#808080">; (* ARRAY[1..13] OF CHAR; *)
   </font>precovenda<font color="#808080">: </font>String<font color="#808080">; (* ARRAY[1..10] OF CHAR; *)
  </font><font color="#0000FF">END</font><font color="#808080">; 

  </font>tregistro <font color="#808080">= </font><font color="#0000FF">ARRAY</font><font color="#808080">[</font><font color="#FF0000">0</font>..145<font color="#808080">] </font><font color="#0000FF">OF CHAR</font><font color="#808080">;
  </font>ctTipo <font color="#808080">= (</font>opTexto<font color="#808080">, </font>opNumero<font color="#808080">, </font>opData<font color="#808080">, </font>opDataHora<font color="#808080">, </font>opSenha<font color="#808080">);
  </font>ctArqs <font color="#808080">= (</font>opAssunto<font color="#808080">, </font>opAutor<font color="#808080">, </font>opEditora<font color="#808080">, </font>opEndereco<font color="#808080">, </font>opIdioma<font color="#808080">, </font>opPais<font color="#808080">,
                </font>opProfissao<font color="#808080">, </font>opCliente<font color="#808080">, </font>opLivro<font color="#808080">, </font>opLivroAss<font color="#808080">, </font>opLivroAut<font color="#808080">,
                </font>opUsuario<font color="#808080">, </font>opVenda<font color="#808080">);
  </font>ctAcao <font color="#808080">= (</font>opNovo<font color="#808080">, </font>opAlterar<font color="#808080">, </font>opPesquisar<font color="#808080">, </font>opSalvarInclusao<font color="#808080">,
              </font>opSalvarAlteracao<font color="#808080">, </font>opExcluir<font color="#808080">, </font>opConfirmaExclusao<font color="#808080">, </font>opListarTodos<font color="#808080">);

</font><font color="#0000FF">CONST
</font><font color="#808080">(* </font>windows <font color="#808080">*)
  </font>CRLF <font color="#808080">= </font>cr <font color="#808080">+ </font>lf<font color="#808080">;  
  </font>TAM_CRLF <font color="#808080">= </font><font color="#FF0000">2</font><font color="#808080">;
(* </font>unix <font color="#808080">*)
(*  </font>CRLF <font color="#808080">= </font>lf<font color="#808080">;
   </font>TAM_CRLF <font color="#808080">= </font><font color="#FF0000">1</font><font color="#808080">; *) 
(* </font>macintosh <font color="#808080">*)
(*  </font>CRLF <font color="#808080">= </font>cr<font color="#808080">;
   </font>TAM_CRLF <font color="#808080">= </font><font color="#FF0000">1</font><font color="#808080">; *) 

  </font>MSG_ARQERRO <font color="#808080">= </font><font color="#800000">'Erro: O arquivo n&atilde;o pode ser aberto.'</font><font color="#808080">;
  </font>MSG_ARQCERRO <font color="#808080">= </font><font color="#800000">'Erro: O arquivo n&atilde;o pode ser criado.'</font><font color="#808080">;

  </font>ARQ_ASSUNTO <font color="#808080">= </font><font color="#800000">'assunto.dat'</font><font color="#808080">;
  </font>ARQ_AUTOR <font color="#808080">= </font><font color="#800000">'autor.dat'</font><font color="#808080">;
  </font>ARQ_EDITORA <font color="#808080">= </font><font color="#800000">'editora.dat'</font><font color="#808080">;
  </font>ARQ_IDIOMA <font color="#808080">= </font><font color="#800000">'idioma.dat'</font><font color="#808080">;
  </font>ARQ_USUARIO <font color="#808080">= </font><font color="#800000">'usuario.dat'</font><font color="#808080">;
  </font>ARQ_PAIS <font color="#808080">= </font><font color="#800000">'pais.dat'</font><font color="#808080">;
  </font>ARQ_PROFISSAO <font color="#808080">= </font><font color="#800000">'profiss.dat'</font><font color="#808080">;
  </font>ARQ_LIVRO <font color="#808080">= </font><font color="#800000">'livro.dat'</font><font color="#808080">;
  </font>ARQ_LIVASS <font color="#808080">= </font><font color="#800000">'livroass.dat'</font><font color="#808080">;
  </font>ARQ_LIVAUT <font color="#808080">= </font><font color="#800000">'livroaut.dat'</font><font color="#808080">;
  </font>ARQ_CLIENTE <font color="#808080">= </font><font color="#800000">'cliente.dat'</font><font color="#808080">;
  </font>ARQ_ENDERECO <font color="#808080">= </font><font color="#800000">'endereco.dat'</font><font color="#808080">;
  </font>ARQ_VENDA <font color="#808080">= </font><font color="#800000">'venda.dat'</font><font color="#808080">;

  </font>TAM_ASSUNTO <font color="#808080">= </font><font color="#FF0000">40</font><font color="#808080">;
  </font>TAM_AUTOR <font color="#808080">= </font><font color="#FF0000">40</font><font color="#808080">;
  </font>TAM_EDITORA <font color="#808080">= </font><font color="#FF0000">60</font><font color="#808080">;
  </font>TAM_IDIOMA <font color="#808080">= </font><font color="#FF0000">30</font><font color="#808080">;
  </font>TAM_USUARIO <font color="#808080">= </font><font color="#FF0000">20</font><font color="#808080">;
  </font>TAM_PAIS <font color="#808080">= </font><font color="#FF0000">53</font><font color="#808080">;
  </font>TAM_PROFISSAO <font color="#808080">= </font><font color="#FF0000">60</font><font color="#808080">;
  </font>TAM_LIVRO <font color="#808080">= </font><font color="#FF0000">143</font><font color="#808080">;
  </font>TAM_LIVASS <font color="#808080">= </font><font color="#FF0000">23</font><font color="#808080">;
  </font>TAM_LIVAUT <font color="#808080">= </font><font color="#FF0000">23</font><font color="#808080">;
  </font>TAM_CLIENTE <font color="#808080">= </font><font color="#FF0000">135</font><font color="#808080">;
  </font>TAM_ENDERECO <font color="#808080">= </font><font color="#FF0000">123</font><font color="#808080">;
  </font>TAM_VENDA <font color="#808080">= </font><font color="#FF0000">56</font><font color="#808080">;

</font><font color="#0000FF">VAR

 </font>tAssunto<font color="#808080">: </font>regAssunto<font color="#808080">;
 </font>tAutor<font color="#808080">: </font>regAutor<font color="#808080">;
 </font>tEditora<font color="#808080">: </font>regEditora<font color="#808080">;
 </font>tIdioma<font color="#808080">: </font>regIdioma<font color="#808080">;
 </font>tEndereco<font color="#808080">: </font>regEndereco<font color="#808080">;
 </font>tPais<font color="#808080">: </font>regPais<font color="#808080">;
 </font>tProfissao<font color="#808080">: </font>regProfissao<font color="#808080">;
 </font>tLivro<font color="#808080">: </font>regLivro<font color="#808080">;
 </font>tLivroAss<font color="#808080">: </font>regLivroAss<font color="#808080">;
 </font>tLivroAut<font color="#808080">: </font>regLivroAut<font color="#808080">;
 </font>tCliente<font color="#808080">: </font>regCliente<font color="#808080">;
 </font>tUsuario<font color="#808080">: </font>regUsuario<font color="#808080">;
 </font>tVenda<font color="#808080">: </font>regVenda<font color="#808080">; 

 </font>tfAssunto<font color="#808080">, </font>tfAutor<font color="#808080">, </font>tfEditora<font color="#808080">, </font>tfIdioma<font color="#808080">, </font>tfEndereco<font color="#808080">, </font>tfPais<font color="#808080">, </font>tfProfissao<font color="#808080">,
 </font>tfLivro<font color="#808080">, </font>tfLivroAss<font color="#808080">, </font>tfLivroAut<font color="#808080">, </font>tfCliente<font color="#808080">, </font>tfUsuario<font color="#808080">, </font>tfVenda<font color="#808080">: </font>ChanId<font color="#808080">;

(*--- </font>Rotinas de manipula<font color="#808080">&ccedil;&atilde;</font>o de arquivos <font color="#808080">------------------------------------*)
</font><font color="#0000FF">PROCEDURE </font>tamArq<font color="#808080">(</font><font color="#0000FF">VAR </font>sArq<font color="#808080">: </font>ChanId<font color="#808080">): </font><font color="#0000FF">CARDINAL</font><font color="#808080">;
</font><font color="#0000FF">PROCEDURE </font>fimArq<font color="#808080">(</font><font color="#0000FF">VAR </font>sArq<font color="#808080">: </font>ChanId<font color="#808080">): </font><font color="#0000FF">BOOLEAN</font><font color="#808080">;
</font><font color="#0000FF">PROCEDURE </font>lerArq<font color="#808080">(</font><font color="#0000FF">VAR </font>sArq<font color="#808080">: </font>ChanId<font color="#808080">; </font>nTamLinha<font color="#808080">, </font>nTamCRLF<font color="#808080">: </font><font color="#0000FF">CARDINAL</font><font color="#808080">; 
          </font><font color="#0000FF">VAR </font>npos<font color="#808080">: </font><font color="#0000FF">CARDINAL</font><font color="#808080">): </font>String<font color="#808080">;
</font><font color="#0000FF">PROCEDURE </font>gravarArq<font color="#808080">(</font><font color="#0000FF">VAR </font>sArq<font color="#808080">: </font>ChanId<font color="#808080">; </font>nTamLinha<font color="#808080">, 
          </font>nTamCRLF<font color="#808080">: </font><font color="#0000FF">CARDINAL</font><font color="#808080">; </font>sLinha<font color="#808080">: </font>String<font color="#808080">);
</font><font color="#0000FF">PROCEDURE </font>abrecriaArqs<font color="#808080">(</font>bAbre<font color="#808080">: </font><font color="#0000FF">BOOLEAN</font><font color="#808080">);
</font><font color="#0000FF">PROCEDURE </font>fechaArqs<font color="#808080">(); 
</font><font color="#0000FF">PROCEDURE </font>pesqArq<font color="#808080">(</font><font color="#0000FF">VAR </font>sArq<font color="#808080">: </font>ChanId<font color="#808080">; </font>sChave<font color="#808080">: </font>String<font color="#808080">; </font>nPosChave<font color="#808080">,
         </font>nTamChave<font color="#808080">, </font>nTamLinha<font color="#808080">: </font><font color="#0000FF">CARDINAL</font><font color="#808080">): </font>String<font color="#808080">;
</font><font color="#0000FF">PROCEDURE </font>pesqLinhaExcluida<font color="#808080">(</font><font color="#0000FF">VAR </font>sArq<font color="#808080">: </font>ChanId<font color="#808080">; </font>nTamLinha<font color="#808080">: </font><font color="#0000FF">CARDINAL</font><font color="#808080">);
</font><font color="#0000FF">PROCEDURE </font>pesqMaxCod<font color="#808080">(</font><font color="#0000FF">VAR </font>sArq<font color="#808080">: </font>ChanId<font color="#808080">; </font>nPosChave<font color="#808080">,
        </font>nTamChave<font color="#808080">, </font>nTamLinha<font color="#808080">: </font><font color="#0000FF">CARDINAL</font><font color="#808080">): </font>String<font color="#808080">;
</font><font color="#0000FF">PROCEDURE </font>escreveArq<font color="#808080">(</font><font color="#0000FF">VAR </font>sArq<font color="#808080">: </font>ChanId<font color="#808080">; </font>sTexto<font color="#808080">,
</font>	sMsgAcerto<font color="#808080">, </font>sMsgErro<font color="#808080">: </font>String<font color="#808080">);
</font><font color="#0000FF">PROCEDURE </font>tamReg<font color="#808080">(</font>sreg<font color="#808080">: </font>ctArqs<font color="#808080">): </font><font color="#0000FF">CARDINAL</font><font color="#808080">;
</font><font color="#0000FF">PROCEDURE </font>LinhaReg<font color="#808080">(</font>sreg<font color="#808080">: </font>ctArqs<font color="#808080">): </font>String<font color="#808080">;

</font><font color="#0000FF">END </font>Arquivos.
</font>
</code></pre>
</body>
</html>